         TITLE '*********** IDCIO05:  EXCP I/O ADAPTOR SERVICE ROUTINE *
                ********'
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCIO05  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCIO05   77.354'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @02,4095(,@12)                                      0002
         LA    @10,4095(,@02)                                      0002
         LA    @08,4095(,@10)                                      0002
         LA    @11,4095(,@08)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@02                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@08                                   0002
         USING @PSTART+16380,@11                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0002
         USING @DATD,@09                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @09,8(,@13)                                         0002
         LR    @13,@09                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                      LOCATION TABLE        @ZA11014*/
*                                                                  0469
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE POINT 'IO05' IN TRACE TABLE                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*   OLDERID2=NEWERID2;                                             0470
         L     @03,@PC00001                                        0470
         L     @03,GDTTR2(,@03)                                    0470
         L     @15,@PC00001                                        0470
         L     @01,GDTTR2(,@15)                                    0470
         MVC   @TS00001(95),NEWERID2(@01)                          0470
         MVC   OLDERID2(95,@03),@TS00001                           0470
*   NEWID2='IO05';                  /*                       @Y30LB35*/
*                                                                  0471
         L     @03,@PC00001                                        0471
         L     @03,GDTTR2(,@03)                                    0471
         MVC   NEWID2(4,@03),@CC03779                              0471
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FULL REGION DUMP POINT 'IOIN'                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0472
*   IF GDTDBG=NULLPTR THEN                                         0472
         L     @03,@PC00001                                        0472
         L     @03,GDTDBG(,@03)                                    0472
         LTR   @03,@03                                             0472
         BZ    @RT00472                                            0472
*     ;                                                            0473
*   ELSE                                                           0474
*     CALL IDCDB010(GDTTBL,'IOIN'); /*                       @Y30LB35
*                                                            @Y30LB35*/
         L     @03,@PC00001                                        0474
         ST    @03,@AL00001                                        0474
         LA    @03,@CC04110                                        0474
         ST    @03,@AL00001+4                                      0474
         MVI   @AL00001+4,X'80'                                    0474
         L     @03,@PC00001                                        0474
         L     @15,GDTDBG(,@03)                                    0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*   TESTRC=0;                       /*                       @Y30LB35
*                                                            @Y30LB35*/
*                                                                  0475
@RT00472 SLR   @03,@03                                             0475
         STH   @03,TESTRC                                          0475
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO DARGLIST FOR MSGS            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   DDSTRU=ADDR(PRINTARG);          /*                       @Y30LB35*/
         LA    @03,PRINTARG                                        0476
         ST    @03,DDSTRU                                          0476
*                                                                  0477
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE REQUEST NAME INTO CALLER'S PARMLIST              @Y30LB35*/
*   /* THIS WILL AID TO DETERMINE IF LIST WAS                @Y30LB35*/
*   /* PASSED IF A DUMP IS BEING READ.                       @Y30LB35*/
*   /* IF THE FIRST 8 CHARACTERS                             @Y30LB35*/
*   /* IN A DUMP CONTAINS THE REQUEST NAME                   @Y30LB35*/
*   /* WHICH CAN BE "GET","PUT", "OPEN", OR "CLOSE"          @Y30LB35*/
*   /* IT SHOULD INDICATE THAT THIS MOD WAS CALLED.          @Y30LB35*/
*   /* THE CALL TO CLOSE IS DONE WITHOUT A PARMLST.          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0477
*   IF REQUEST^=CLOSE               /*                       @Y30LB35*/
*     THEN                                                         0477
         L     @03,@PC00001+4                                      0477
         CLC   REQUEST(8,@03),CLOSE                                0477
         BE    @RF00477                                            0477
*     ARGHEAD=REQUEST;              /*                       @Y30LB35*/
*                                                                  0478
         L     @03,@PC00001+8                                      0478
         L     @15,@PC00001+4                                      0478
         MVC   ARGHEAD(8,@03),REQUEST(@15)                         0478
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION IS MADE                        @Y30LB35*/
*   /* AS TO WHICH SERVICE IS REQUESTED.                     @Y30LB35*/
*   /* OPENPROC IS CALLED IF THE REQUEST IS "OPEN"           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0479
*   IF REQUEST=OPEN                 /*                       @Y30LB35*/
*     THEN                                                         0479
@RF00477 L     @03,@PC00001+4                                      0479
         CLC   REQUEST(8,@03),OPEN                                 0479
         BNE   @RF00479                                            0479
*     CALL OPENPROC;                /*                       @Y30LB35
*                                                            @Y30LB35*/
         BAL   @14,OPENPROC                                        0480
*   ELSE                            /*                       @Y30LB35*/
*                                                                  0481
*     /***************************************************************/
*     /*                                                             */
*     /* PUTGET IS CALLED IF REQUEST IS "GET" OR "PUT"       @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0481
*     IF REQUEST=PUT×REQUEST=GET    /*                       @Y30LB35*/
*       THEN                                                       0481
         B     @RC00479                                            0481
@RF00479 L     @03,@PC00001+4                                      0481
         CLC   REQUEST(8,@03),PUT                                  0481
         BE    @RT00481                                            0481
         L     @03,@PC00001+4                                      0481
         CLC   REQUEST(8,@03),GET                                  0481
         BNE   @RF00481                                            0481
@RT00481 DS    0H                                                  0482
*       CALL PUTGET;                /*                       @Y30LB35
*                                                            @Y30LB35*/
         BAL   @14,PUTGET                                          0482
*     ELSE                          /*                       @Y30LB35*/
*                                                                  0483
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE IS CALLED IF REQUEST IS "CLOSE"             @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0483
*       IF REQUEST=CLOSE            /*                       @Y30LB35*/
*         THEN                                                     0483
         B     @RC00481                                            0483
@RF00481 L     @03,@PC00001+4                                      0483
         CLC   REQUEST(8,@03),CLOSE                                0483
         BNE   @RF00483                                            0483
*         CALL CLOSEPRC;            /*                       @Y30LB35
*                                                            @ZA11014*/
         BAL   @14,CLOSEPRC                                        0484
*       ELSE                        /*                       @ZA11014*/
*                                                                  0485
*         /***********************************************************/
*         /*                                                         */
*         /* OPENR IS CALLED IF REQUEST IS "OPENR"           @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0485
*         IF REQUEST=RVOPENR        /*                       @ZA11014*/
*           THEN                                                   0485
         B     @RC00483                                            0485
@RF00483 L     @03,@PC00001+4                                      0485
         CLC   REQUEST(8,@03),RVOPENR                              0485
         BNE   @RF00485                                            0485
*           CALL OPENR;             /*                       @ZA11014
*                                                            @ZA11014*/
         BAL   @14,OPENR                                           0486
*         ELSE                      /*                       @ZA11014*/
*                                                                  0487
*           /*********************************************************/
*           /*                                                       */
*           /* READKD IS CALLED IF REQUEST IS "READKD"       @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0487
*           IF REQUEST=RVREADKD     /*                       @ZA11014*/
*             THEN                                                 0487
         B     @RC00485                                            0487
@RF00485 L     @03,@PC00001+4                                      0487
         CLC   REQUEST(8,@03),RVREADKD                             0487
         BNE   @RF00487                                            0487
*             CALL READKD;          /*                       @ZA11014
*                                                            @ZA11014*/
         BAL   @14,READKD                                          0488
*           ELSE                    /*                       @ZA11014*/
*                                                                  0489
*             /*******************************************************/
*             /*                                                     */
*             /* READCNT IS CALLED IF REQUEST IS "READCNT"   @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0489
*             IF REQUEST=RVRDCNT    /*                       @ZA11014*/
*               THEN                                               0489
         B     @RC00487                                            0489
@RF00487 L     @03,@PC00001+4                                      0489
         CLC   REQUEST(8,@03),RVRDCNT                              0489
         BNE   @RF00489                                            0489
*               CALL READCNT;       /*                       @ZA11014
*                                                            @ZA11014*/
         BAL   @14,READCNT                                         0490
*             ELSE                  /*                       @ZA11014*/
*                                                                  0491
*               /*****************************************************/
*               /*                                                   */
*               /* SPACCR IS CALLED IF REQUEST IS "SPACCR"   @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0491
*               IF REQUEST=RVSPACCR /*                       @ZA11014*/
*                 THEN                                             0491
         B     @RC00489                                            0491
@RF00489 L     @03,@PC00001+4                                      0491
         CLC   REQUEST(8,@03),RVSPACCR                             0491
         BNE   @RF00491                                            0491
*                 CALL SPACCR;      /*                       @ZA11014
*                                                            @ZA11014*/
         BAL   @14,SPACCR                                          0492
*               ELSE                /*                       @ZA11014*/
*                                                                  0493
*                 /***************************************************/
*                 /*                                                 */
*                 /* FWRITE IS CALLED IF REQUEST IS "FWRITE" @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0493
*                 IF REQUEST=RVFWRITE/*                      @ZA11014*/
*                   THEN                                           0493
         B     @RC00491                                            0493
@RF00491 L     @03,@PC00001+4                                      0493
         CLC   REQUEST(8,@03),RVFWRITE                             0493
         BNE   @RF00493                                            0493
*                   CALL FWRITE;    /*                       @ZA11014
*                                                            @ZA11014*/
         BAL   @14,FWRITE                                          0494
*                 ELSE              /*                       @ZA11014*/
*                                                                  0495
*                   /*************************************************/
*                   /*                                               */
*                   /* WRITEREC IS CALLED IF REQUEST IS "WRITEREC"   */
*                   /*                                       @ZA11014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0495
*                   IF REQUEST=RVWRITER/*                    @ZA11014*/
*                     THEN                                         0495
         B     @RC00493                                            0495
@RF00493 L     @03,@PC00001+4                                      0495
         CLC   REQUEST(8,@03),RVWRITER                             0495
         BNE   @RF00495                                            0495
*                     CALL WRITEREC;/*                       @ZA11014
*                                                            @ZA11014
*                                                            @Y30LB35*/
         BAL   @14,WRITEREC                                        0496
*                   ELSE            /*                       @Y30LB35*/
*                                                                  0497
*                     /***********************************************/
*                     /*                                             */
*                     /* UABORT 40 IS ISSUED IF REQUEST IS INVALID   */
*                     /*                                     @Y30LB35*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0497
*                     DO;                                          0497
         B     @RC00495                                            0497
@RF00495 DS    0H                                                  0498
*                       RESPECIFY                                  0498
*                        (REG13,                                   0498
*                         REG14,                                   0498
*                         REG15) RSTD;                             0498
*                       REG15=40;                                  0499
         LA    REG15,40                                            0499
*                       REG14=GDTABT;                              0500
         L     @03,@PC00001                                        0500
         L     REG14,GDTABT(,@03)                                  0500
*                       REG13=GDTABH;                              0501
         L     @03,@PC00001                                        0501
         L     REG13,GDTABH(,@03)                                  0501
*                       GEN(BR    REG14);                          0502
         BR    REG14
*                       RESPECIFY                                  0503
*                        (REG13,                                   0503
*                         REG14,                                   0503
*                         REG15) UNRSTD;                           0503
*                     END;          /*                       @Y30LB35
*                                                            @Y30LB35*/
*                                                                  0504
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FULL REGION DUMP POINT 'IOEX'                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0505
*   IF GDTDBG=NULLPTR THEN                                         0505
@RC00495 DS    0H                                                  0505
@RC00493 DS    0H                                                  0505
@RC00491 DS    0H                                                  0505
@RC00489 DS    0H                                                  0505
@RC00487 DS    0H                                                  0505
@RC00485 DS    0H                                                  0505
@RC00483 DS    0H                                                  0505
@RC00481 DS    0H                                                  0505
@RC00479 L     @03,@PC00001                                        0505
         L     @03,GDTDBG(,@03)                                    0505
         LTR   @03,@03                                             0505
         BZ    @RT00505                                            0505
*     ;                                                            0506
*   ELSE                                                           0507
*     CALL IDCDB010(GDTTBL,'IOEX'); /*                       @Y30LB35*/
*                                                                  0507
         L     @03,@PC00001                                        0507
         ST    @03,@AL00001                                        0507
         LA    @03,@CC04120                                        0507
         ST    @03,@AL00001+4                                      0507
         MVI   @AL00001+4,X'80'                                    0507
         L     @03,@PC00001                                        0507
         L     @15,GDTDBG(,@03)                                    0507
         LA    @01,@AL00001                                        0507
         BALR  @14,@15                                             0507
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CALLER WITH RETURN             @Y30LB35*/
*   /* CODE IN REGISTER 15 OF 4 ERROR OR 0 SUCCESS           @Y30LB35*/
*   /* A RETURN CODE INDICATING SPECIFIC RESULTS             @ZA11014*/
*   /* WILL BE SET IF THE CALL WAS FOR A REPAIRV             @ZA11014*/
*   /* FUNCTION                                              @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*   CALL IDCSAEP0(GDTTBL,MODID,TESTRC);                            0508
*                                                                  0508
@RT00505 L     @03,@PC00001                                        0508
         ST    @03,@AL00001                                        0508
         LA    @03,MODID                                           0508
         ST    @03,@AL00001+4                                      0508
         LA    @03,TESTRC                                          0508
         ST    @03,@AL00001+8                                      0508
         MVI   @AL00001+8,X'80'                                    0508
         L     @03,@PC00001                                        0508
         L     @15,GDTEPL(,@03)                                    0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0509
*                                   /*                       @Y30LB35*/
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
         LH    @03,TESTRC                                          0509
         L     @13,4(,@13)                                         0509
         L     @00,@SIZDATD                                        0509
         LR    @01,@09                                             0509
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@03                                             0509
         L     @14,12(,@13)                                        0509
         LM    @00,@12,20(@13)                                     0509
         BR    @14                                                 0509
*                                                                  0510
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - OPENPROC                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  CALL SUBPROCEDURE BLDBLK TO SETUP IOXCTLBK   @Y30LB35*/
*/*             DETERMINE WHICH TYPE OPEN HAS BEEN           @Y30LB35*/
*/*             REQUESTED, AND CALL APPROPRIATE SUBPROCEDURE @Y30LB35*/
*/*             OPNNEW, OPNTAB, OPNLAB, OPNVTOC, OR OPNPASS  @Z40LB35*/
*/*             IF THE RETURN CODE IS FOUND TO BE RCOK(0)    @Y30LB35*/
*/*             THEN THE IOXCTLBK IS CHAINED UP TO THE       @Y30LB35*/
*/*             IODIOX OPEN CHAIN.  IF THE RETURN CODE FROM  @Y30LB35*/
*/*             SUBPROCEDURE IS NOT ZERO, THE CONTROL BLOCK  @Y30LB35*/
*/*             IS FREED AND THE RETURN CODE RCFAIL(4) IS    @Y30LB35*/
*/*             RETURNED.                                    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED THIS PROC       @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     EXOPT FROM EXOARG                            @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXTYPE IN IOXCTLBK                          @Y30LB35*/
*/*             IODIOX  IN IODATA                            @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR FROM OPNLAB           @Y30LB35*/
*/*                           4, ERROR FROM OPNNEW           @Y30LB35*/
*/*                           4, ERROR FROM OPNPASS          @Y30LB35*/
*/*                           4, ERROR FROM OPNTAB           @Y30LB35*/
*/*                           4, ERROR FROM OPNVTOC          @Z40LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0510
*                                   /*                       @Y30LB35*/
*OPENPROC:                                                         0510
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0510
OPENPROC STM   @14,@12,@SA00002                                    0510
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOOE' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0511
*   OLDERID2=NEWERID2;                                             0511
         L     @03,@PC00001                                        0511
         L     @03,GDTTR2(,@03)                                    0511
         L     @15,@PC00001                                        0511
         L     @01,GDTTR2(,@15)                                    0511
         MVC   @TS00001(95),NEWERID2(@01)                          0511
         MVC   OLDERID2(95,@03),@TS00001                           0511
*   NEWID2='IOOE';                  /*                       @Y30LB35*/
*                                                                  0512
         L     @03,@PC00001                                        0512
         L     @03,GDTTR2(,@03)                                    0512
         MVC   NEWID2(4,@03),@CC04124                              0512
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL BLDBLK TO GET CORE FOR AND INITIALIZE            @Y30LB35*/
*   /* IOXCTLBK                                              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0513
*   CALL BLDBLK;                    /*                       @Y30LB35*/
         BAL   @14,BLDBLK                                          0513
*   RESPECIFY                                                      0514
*     RTNREG RSTD;                                                 0514
*   TESTRC=RTNREG;                                                 0515
         STH   RTNREG,TESTRC                                       0515
*   RESPECIFY                                                      0516
*     RTNREG UNRSTD;                /*                       @Y30LB35*/
*                                                                  0516
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE RETURN CODE FROM BLDBLK IS ZERO         @Y30LB35*/
*   /* THE SUBPROCEDURE OPNNEW, OPNPASS, OPNTAB,             @Y30LB35*/
*   /* OR OPNLAB IS CALLED.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0517
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  0517
         LH    @03,TESTRC                                          0517
         LTR   @03,@03                                             0517
         BNZ   @RF00517                                            0517
*     /***************************************************************/
*     /*                                                             */
*     /* THE SUBPROCEDURE NEWVOL IS CALLED IF CALLER         @Y30LB35*/
*     /* HAS SET THE EXONEW.                                 @Y30LB35*/
*     /* THE IOXTYPE IS SET WITH TYPE NEWVOL CODE.           @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0518
*     IF EXONEW=ON                  /*                       @Y30LB35*/
*       THEN                        /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0518
         TM    EXONEW(@03),B'00010000'                             0518
         BNO   @RF00518                                            0518
*       DO;                         /*                       @Y30LB35*/
*         IOXTYPE=NEWVOL;           /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0520
         MVC   IOXTYPE(1,@03),NEWVOL                               0520
*         CALL OPNNEW;              /*                       @Y30LB35*/
         BAL   @14,OPNNEW                                          0521
*         RESPECIFY                                                0522
*           RTNREG RSTD;                                           0522
*         TESTRC=RTNREG;                                           0523
         STH   RTNREG,TESTRC                                       0523
*         RESPECIFY                                                0524
*           RTNREG UNRSTD;          /*                       @Y30LB35*/
*       END;                        /*                       @Y30LB35
*                                                            @Y30LB35*/
*     ELSE                          /*                       @Y30LB35*/
*                                                                  0526
*       /*************************************************************/
*       /*                                                           */
*       /* THE SUBPROCEDURE OPNTAB IS CALLED IF CALLER       @Y30LB35*/
*       /* HAS SET THE EXOTAB.                               @Y30LB35*/
*       /* THE IOXTYPE IS SET WITH TYPE TABLE CODE.          @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0526
*       IF EXOTAB=ON                /*                       @Y30LB35*/
*         THEN                      /*                       @Y30LB35*/
         B     @RC00518                                            0526
@RF00518 L     @03,@PC00001+8                                      0526
         TM    EXOTAB(@03),B'10000000'                             0526
         BNO   @RF00526                                            0526
*         DO;                       /*                       @Y30LB35*/
*           IOXTYPE=TABLE;          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0528
         MVC   IOXTYPE(1,@03),TABLE                                0528
*           CALL OPNTAB;            /*                       @Y30LB35*/
         BAL   @14,OPNTAB                                          0529
*           RESPECIFY                                              0530
*             RTNREG RSTD;                                         0530
*           TESTRC=RTNREG;                                         0531
         STH   RTNREG,TESTRC                                       0531
*           RESPECIFY                                              0532
*             RTNREG UNRSTD;        /*                       @Y30LB35*/
*         END;                      /*                       @Y30LB35*/
*       ELSE                        /*                       @Y30LB35*/
*                                                                  0534
*         /***********************************************************/
*         /*                                                         */
*         /* THE SUBPROCEDURE OPNLAB IS CALLED IF CALLER     @Y30LB35*/
*         /* HAS SET THE EXOLAB.                             @Y30LB35*/
*         /* THE IOXTYPE IS SET WITH TYPE LAB CODE.          @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0534
*         IF EXOLAB=ON              /*                       @Y30LB35*/
*           THEN                    /*                       @Y30LB35*/
         B     @RC00526                                            0534
@RF00526 L     @03,@PC00001+8                                      0534
         TM    EXOLAB(@03),B'01000000'                             0534
         BNO   @RF00534                                            0534
*           DO;                     /*                       @Y30LB35*/
*             IOXTYPE=LAB;          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0536
         MVC   IOXTYPE(1,@03),LAB                                  0536
*             CALL OPNLAB;          /*                       @Y30LB35*/
         BAL   @14,OPNLAB                                          0537
*             RESPECIFY                                            0538
*               RTNREG RSTD;                                       0538
*             TESTRC=RTNREG;                                       0539
         STH   RTNREG,TESTRC                                       0539
*             RESPECIFY                                            0540
*               RTNREG UNRSTD;      /*                       @Y30LB35*/
*           END;                    /*                       @Y30LB35
*                                                            @Y30LB35*/
*         ELSE                      /*                       @Y30LB35*/
*                                                                  0542
*           /*********************************************************/
*           /*                                                       */
*           /* THE SUBPROCEDURE OPNPASS IS CALLED IF CALLER  @Y30LB35*/
*           /* HAS SET THE EXOPASS.                          @Y30LB35*/
*           /* THE IOXTYPE IS SET WITH TYPE PASSWORD CODE.   @Y30LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0542
*           IF EXOPASS=ON           /*                       @Y30LB35*/
*             THEN                  /*                       @Y30LB35*/
         B     @RC00534                                            0542
@RF00534 L     @03,@PC00001+8                                      0542
         TM    EXOPASS(@03),B'00100000'                            0542
         BNO   @RF00542                                            0542
*             DO;                   /*                       @Y30LB35*/
*               IOXTYPE=PASSWORD;   /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0544
         MVC   IOXTYPE(1,@03),PASSWORD                             0544
*               CALL OPNPASS;       /*                       @Y30LB35*/
         BAL   @14,OPNPASS                                         0545
*               RESPECIFY                                          0546
*                 RTNREG RSTD;                                     0546
*               TESTRC=RTNREG;                                     0547
         STH   RTNREG,TESTRC                                       0547
*               RESPECIFY                                          0548
*                 RTNREG UNRSTD;    /*                       @Y30LB35*/
*             END;                  /*                       @Y30LB35*/
*           ELSE                    /*                       @Z40LB35*/
*                                                                  0550
*             /*******************************************************/
*             /*                                                     */
*             /* THE SUBPROCEDURE OPNVTOC IS CALLED IF CALLER        */
*             /*                                             @Z40LB35*/
*             /* HAS SET THE EXOVTOC.                        @Z40LB35*/
*             /* THE IOXTYPE IS SET WITH TYPE VTOC CODE.     @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0550
*             IF EXOVTOC=ON         /*                       @Z40LB35*/
*               THEN                /*                       @Z40LB35*/
         B     @RC00542                                            0550
@RF00542 L     @03,@PC00001+8                                      0550
         TM    EXOVTOC(@03),B'00001000'                            0550
         BNO   @RF00550                                            0550
*               DO;                 /*                       @Z40LB35*/
*                 IOXTYPE=VTOC;     /*                       @Z40LB35*/
         L     @03,IOCTLBKP                                        0552
         MVC   IOXTYPE(1,@03),VTOC                                 0552
*                 CALL OPNVTOC;     /*                       @Z40LB35*/
         BAL   @14,OPNVTOC                                         0553
*                 RESPECIFY                                        0554
*                   RTNREG RSTD;                                   0554
*                 TESTRC=RTNREG;                                   0555
         STH   RTNREG,TESTRC                                       0555
*                 RESPECIFY                                        0556
*                   RTNREG UNRSTD;  /*                       @Z40LB35*/
*               END;                /*                       @Z40LB35*/
*             ELSE                  /*                       @Z40LB35*/
*                                                                  0558
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE UABORT CODE 40 IF INVALID CODE      @Y30LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0558
*               DO;                                                0558
         B     @RC00550                                            0558
@RF00550 DS    0H                                                  0559
*                 RESPECIFY                                        0559
*                  (REG13,                                         0559
*                   REG14,                                         0559
*                   REG15) RSTD;                                   0559
*                 REG15=40;                                        0560
         LA    REG15,40                                            0560
*                 REG14=GDTABT;                                    0561
         L     @03,@PC00001                                        0561
         L     REG14,GDTABT(,@03)                                  0561
*                 REG13=GDTABH;                                    0562
         L     @03,@PC00001                                        0562
         L     REG13,GDTABH(,@03)                                  0562
*                 GEN(BR    REG14);                                0563
         BR    REG14
*                 RESPECIFY                                        0564
*                  (REG13,                                         0564
*                   REG14,                                         0564
*                   REG15) UNRSTD;                                 0564
*               END;                /*                       @Z40LB35*/
*                                                                  0566
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE TEST IS MADE TO DETERMINE WHETHER            @Y30LB35*/
*   /* THE OPEN WAS SUCCESSFUL OR NOT. IF NOT                @Y30LB35*/
*   /* THE CONTROL BLOCK IS FREED UP AND THE                 @Y30LB35*/
*   /* IOXCTLBK POINTER FIELD IS ZEROED IN THE               @Y30LB35*/
*   /* CALLER'S CORE.                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0566
*   IF TESTRC^=0&USERIOBP^=NULLPTR  /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RC00550 DS    0H                                                  0566
@RC00542 DS    0H                                                  0566
@RC00534 DS    0H                                                  0566
@RC00526 DS    0H                                                  0566
@RC00518 DS    0H                                                  0566
@RF00517 LH    @03,TESTRC                                          0566
         LTR   @03,@03                                             0566
         BZ    @RF00566                                            0566
         L     @03,@PC00001+8                                      0566
         L     @03,EXOCTLBK(,@03)                                  0566
         L     @03,USERIOBP(,@03)                                  0566
         LTR   @03,@03                                             0566
         BZ    @RF00566                                            0566
*     DO;                           /*                       @Y30LB35*/
*       CALL IDCSAFS0(GDTTBL,IOCTLBKP);/*                    @Y30LB35*/
         L     @03,@PC00001                                        0568
         ST    @03,@AL00001                                        0568
         LA    @03,IOCTLBKP                                        0568
         ST    @03,@AL00001+4                                      0568
         L     @03,@PC00001                                        0568
         L     @15,GDTFSP(,@03)                                    0568
         LA    @01,@AL00001                                        0568
         BALR  @14,@15                                             0568
*       USERIOBP=NULLPTR;           /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0569
         L     @03,EXOCTLBK(,@03)                                  0569
         SLR   @15,@15                                             0569
         ST    @15,USERIOBP(,@03)                                  0569
*     END;                          /*                       @Y30LB35*/
*                                                                  0570
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE OPEN IS SUCCESSFUL, THEN IT IS                 @Y30LB35*/
*   /* PUT IN THE FRONT OF IODIOX CHAIN AND                  @Y30LB35*/
*   /* THE IOXOPN IS SET ON TO INDICATE THAT THE             @Y30LB35*/
*   /* DCB HAS BEEN OPENED.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0571
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RF00566 LH    @03,TESTRC                                          0571
         LTR   @03,@03                                             0571
         BNZ   @RF00571                                            0571
*     DO;                           /*                       @Y30LB35*/
*       IOXCHAIN=IODIOX;            /*                       @Y30LB35*/
         L     @03,@PC00001                                        0573
         L     @03,GDTIOH(,@03)                                    0573
         L     @03,IODIOX(,@03)                                    0573
         L     @01,IOCTLBKP                                        0573
         ST    @03,IOXCHAIN(,@01)                                  0573
*       IODIOX=ADDR(IOXCTLBK);      /*                       @Y30LB35*/
         L     @03,@PC00001                                        0574
         L     @03,GDTIOH(,@03)                                    0574
         L     @15,IOCTLBKP                                        0574
         ST    @15,IODIOX(,@03)                                    0574
*       IOXOPN=ON;                  /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0575
         OI    IOXOPN(@03),B'10000000'                             0575
*     END;                          /*                       @Y30LB35*/
*                                                                  0576
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO IDCIO05 - THE                  @Y30LB35*/
*   /* MAIN PROCEDURE. THE RETURN CODE IS PASSED             @Y30LB35*/
*   /* WITH UNSUCCESSFUL CODE OF 4 OR SUCCESSFUL 0.          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0577
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF00571 LH    @15,TESTRC                                          0577
         L     @14,@SA00002                                        0577
         LM    @00,@12,@SA00002+8                                  0577
         BR    @14                                                 0577
*   END OPENPROC;                   /*                       @Y30LB35*/
*                                                                  0579
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - PUTGET                                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  DETERMINE WHICH TYPE CCW STRING IS NEEDED    @Y30LB35*/
*/*             AND CALL APPROPRIATE SUBPROCEDURE OF         @Y30LB35*/
*/*             BLDCCWP1, BLDCCWP2, OR BLDCCWG.  CALL        @Y30LB35*/
*/*             ISSUEXCP TO ISSUE EXCP AND RETURN TO IDCIO05 @Y30LB35*/
*/*             WITH THE RETURN CODE.                        @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     EXGCTLBK FROM EXGAGL                         @Y30LB35*/
*/*             EXPCTLBK FROM EXPAGL                         @Y30LB35*/
*/*             IOXTYPE  FROM IOXCTLBK                       @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOCTLBKP                                     @Y30LB35*/
*/*             DCBPTR                                       @Y30LB35*/
*/*             IOBSTPTR                                     @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN ISSUEXCP           @Y30LB35*/
*/*                           4, ERROR IN BLDCCWP1           @Y30LB35*/
*/*                           4, ERROR IN BLDCCWP2           @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0579
*                                   /*                       @Y30LB35*/
*PUTGET:                                                           0579
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0579
PUTGET   STM   @14,@12,@SA00003                                    0579
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOPG' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0580
*   OLDERID2=NEWERID2;                                             0580
         L     @03,@PC00001                                        0580
         L     @03,GDTTR2(,@03)                                    0580
         L     @15,@PC00001                                        0580
         L     @01,GDTTR2(,@15)                                    0580
         MVC   @TS00001(95),NEWERID2(@01)                          0580
         MVC   OLDERID2(95,@03),@TS00001                           0580
*   NEWID2='IOPG';                  /*                       @Y30LB35*/
*                                                                  0581
         L     @03,@PC00001                                        0581
         L     @03,GDTTR2(,@03)                                    0581
         MVC   NEWID2(4,@03),@CC04134                              0581
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUESTING "GET" THE POINTER IS EXGCTLBK           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0582
*   IF REQUEST=GET                  /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  0582
         L     @03,@PC00001+4                                      0582
         CLC   REQUEST(8,@03),GET                                  0582
         BNE   @RF00582                                            0582
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP ADDRESSABILITY TO IOXCTLBK                   @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0583
*     IOCTLBKP=EXGCTLBK;            /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0583
         L     @03,EXGCTLBK(,@03)                                  0583
         ST    @03,IOCTLBKP                                        0583
*   ELSE                            /*                       @Y30LB35*/
*                                                                  0584
*     /***************************************************************/
*     /*                                                             */
*     /* IF REQUESTING "PUT" THE POINTER IS EXPCTLBK         @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0584
*     IOCTLBKP=EXPCTLBK;            /*                       @Y30LB35*/
*                                                                  0584
         B     @RC00582                                            0584
@RF00582 L     @03,@PC00001+8                                      0584
         L     @03,EXPCTLBK(,@03)                                  0584
         ST    @03,IOCTLBKP                                        0584
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDRESSABILITY IS SET UP FOR THE DCB AND IOB          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*   DCBPTR=ADDR(IOXDCB);            /*                       @Y30LB35*/
@RC00582 L     @03,IOCTLBKP                                        0585
         LA    @03,IOXDCB(,@03)                                    0585
         ST    @03,DCBPTR                                          0585
*   IOBSTPTR=ADDR(IOXIOB);          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0586
         LA    @03,IOXIOB(,@03)                                    0586
         ST    @03,IOBSTPTR                                        0586
*                                                                  0587
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT THE CCW STRING IS BUILT                 @Y30LB35*/
*   /* BY CALLING ONE OF CCW BUILDING PROCEDURES             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0587
*   IF REQUEST=GET                  /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @03,@PC00001+4                                      0587
         CLC   REQUEST(8,@03),GET                                  0587
         BNE   @RF00587                                            0587
*     DO;                           /*                       @Y30LB35*/
*                                                                  0588
*       /*************************************************************/
*       /*                                                           */
*       /* IF CALLER IS RETRIEVING RECORDS, THE              @Y30LB35*/
*       /* BLDCCWG IS CALLED TO BUILD READ KEY DATA CCWS     @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0589
*       CALL BLDCCWG;               /*                       @Y30LB35*/
         BAL   @14,BLDCCWG                                         0589
*       RESPECIFY                                                  0590
*         RTNREG RSTD;                                             0590
*       TESTRC=RTNREG;                                             0591
         STH   RTNREG,TESTRC                                       0591
*       RESPECIFY                                                  0592
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*   ELSE                            /*                       @Y30LB35*/
*     IF IOXTYPE=NEWVOL             /*                       @Y30LB35*/
*       THEN                        /*                       @Y30LB35*/
         B     @RC00587                                            0594
@RF00587 L     @03,IOCTLBKP                                        0594
         CLC   IOXTYPE(1,@03),NEWVOL                               0594
         BNE   @RF00594                                            0594
*       DO;                         /*                       @Y30LB35*/
*                                                                  0595
*         /***********************************************************/
*         /*                                                         */
*         /* IF CALLER IS INITIALIZING A NEW VOLUME,         @Y30LB35*/
*         /* BLDCCWP1 IS CALLED TO BUILD WRITE               @Y30LB35*/
*         /* COUNT KEY DATA                                  @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0596
*         CALL BLDCCWP1;            /*                       @Y30LB35*/
         BAL   @14,BLDCCWP1                                        0596
*         RESPECIFY                                                0597
*           RTNREG RSTD;                                           0597
*         TESTRC=RTNREG;                                           0598
         STH   RTNREG,TESTRC                                       0598
*         RESPECIFY                                                0599
*           RTNREG UNRSTD;          /*                       @Y30LB35*/
*       END;                        /*                       @Y30LB35*/
*     ELSE                          /*                       @Y30LB35*/
*       DO;                         /*                       @Y30LB35*/
*                                                                  0601
         B     @RC00594                                            0601
@RF00594 DS    0H                                                  0602
*         /***********************************************************/
*         /*                                                         */
*         /* IF CALLER IS UPDATING AN EXISTING RECORD,       @Y30LB35*/
*         /* BLDCCWP2 IS CALLED TO BUILD WRITE KEY DATA      @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0602
*         CALL BLDCCWP2;            /*                       @Y30LB35*/
         BAL   @14,BLDCCWP2                                        0602
*         RESPECIFY                                                0603
*           RTNREG RSTD;                                           0603
*         TESTRC=RTNREG;                                           0604
         STH   RTNREG,TESTRC                                       0604
*         RESPECIFY                                                0605
*           RTNREG UNRSTD;          /*                       @Y30LB35*/
*       END;                        /*                       @Y30LB35*/
*                                                                  0607
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE PREVIOUS PROCEDURES WERE                @Y30LB35*/
*   /* SUCCESSFUL THE I/O CAN NOW BE PERFORMED.              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0607
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RC00594 DS    0H                                                  0607
@RC00587 LH    @03,TESTRC                                          0607
         LTR   @03,@03                                             0607
         BNZ   @RF00607                                            0607
*     DO;                           /*                       @Y30LB35*/
*                                                                  0608
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUEXCP IS CALLED TO PERFORM THE I/O             @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0609
*       CALL ISSUEXCP;              /*                       @Y30LB35*/
         BAL   @14,ISSUEXCP                                        0609
*       RESPECIFY                                                  0610
*         RTNREG RSTD;                                             0610
*       TESTRC=RTNREG;                                             0611
         STH   RTNREG,TESTRC                                       0611
*       RESPECIFY                                                  0612
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*                                                                  0613
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO IDCIO05 WITH CODE              @Y30LB35*/
*   /* ZERO SUCCESSFUL OR FOUR ERROR IN REG15                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF00607 LH    @15,TESTRC                                          0614
         L     @14,@SA00003                                        0614
         LM    @00,@12,@SA00003+8                                  0614
         BR    @14                                                 0614
*   END PUTGET;                     /*                       @Y30LB35*/
*                                                                  0616
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - CLOSEPRC                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  DETEMINES WHICH TYPE CLOSE IS NEEDED AND     @Y30LB35*/
*/*             CALLS CLOSENEW OR CLOSESTD.  THE             @Y30LB35*/
*/*             IOXCTLBK IS UNCHAINED FROM THE IODIOX CHAIN  @Y30LB35*/
*/*             AND THE CORE IS FREED.                       @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOCTLBKP FROM CALLER                         @Y30LB35*/
*/*             IOXTYPE FROM THE IOXCTLBK                    @Y30LB35*/
*/*             IODIOX FROM THE HISTORICAL DATA AREA         @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXCHAIN IN IOXCTLBK                         @Y30LB35*/
*/*             IODIOX IN HISTORICAL DATA AREA               @Y30LB35*/
*/*             IOCTLBKP                                     @Y30LB35*/
*/*             DCBPTR                                       @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN CLOSENEW           @Y30LB35*/
*/*                           4, ERROR IN CLOSESTD           @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0616
*                                   /*                       @Y30LB35*/
*CLOSEPRC:                                                         0616
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0616
CLOSEPRC STM   @14,@12,@SA00004                                    0616
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOCL' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0617
*   OLDERID2=NEWERID2;                                             0617
         L     @03,@PC00001                                        0617
         L     @03,GDTTR2(,@03)                                    0617
         L     @15,@PC00001                                        0617
         L     @01,GDTTR2(,@15)                                    0617
         MVC   @TS00001(95),NEWERID2(@01)                          0617
         MVC   OLDERID2(95,@03),@TS00001                           0617
*   NEWID2='IOCL';                  /*                       @Y30LB35*/
*                                                                  0618
         L     @03,@PC00001                                        0618
         L     @03,GDTTR2(,@03)                                    0618
         MVC   NEWID2(4,@03),@CC04142                              0618
*   /*****************************************************************/
*   /*                                                               */
*   /* THE ONLY PARM REQUIRED IS IOXCTLBK PTR                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*   IF ARGLIST^=NULLPTR THEN        /*                       @Y30LB35*/
*                                                                  0619
         L     @03,@PC00001+8                                      0619
         L     @03,ARGLIST(,@03)                                   0619
         LTR   @03,@03                                             0619
         BZ    @RF00619                                            0619
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP ADDRESSABILITY TO THE CONTROL BLOCK          @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0620
*     IOCTLBKP=ARGLIST;             /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0620
         L     @03,ARGLIST(,@03)                                   0620
         ST    @03,IOCTLBKP                                        0620
*   ELSE                            /*                       @Y30LB35*/
*                                                                  0621
*     /***************************************************************/
*     /*                                                             */
*     /* IF CALLER FAILED TO PASS POINTER, ONLY THING        @Y30LB35*/
*     /* LEFT TO DO IS ISSUE UABORT(40).                     @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0621
*     DO;                                                          0621
         B     @RC00619                                            0621
@RF00619 DS    0H                                                  0622
*       RESPECIFY                                                  0622
*        (REG13,                                                   0622
*         REG14,                                                   0622
*         REG15) RSTD;                                             0622
*       REG15=40;                                                  0623
         LA    REG15,40                                            0623
*       REG14=GDTABT;                                              0624
         L     @03,@PC00001                                        0624
         L     REG14,GDTABT(,@03)                                  0624
*       REG13=GDTABH;                                              0625
         L     @03,@PC00001                                        0625
         L     REG13,GDTABH(,@03)                                  0625
*       GEN(BR    REG14);                                          0626
         BR    REG14
*       RESPECIFY                                                  0627
*        (REG13,                                                   0627
*         REG14,                                                   0627
*         REG15) UNRSTD;                                           0627
*     END;                          /*                       @Y30LB35*/
*                                                                  0629
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO DCB                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0629
*   DCBPTR=ADDR(IOXDCB);            /*                       @Y30LB35*/
*                                                                  0629
@RC00619 L     @03,IOCTLBKP                                        0629
         LA    @03,IOXDCB(,@03)                                    0629
         ST    @03,DCBPTR                                          0629
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION WHICH TYPE CLOSE               @Y30LB35*/
*   /* IS IN ORDER.                                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0630
*   IF IOXTYPE=NEWVOL×IOXTYPE=VTOCHDR THEN/*                 @ZA11014*/
         L     @03,IOCTLBKP                                        0630
         CLC   IOXTYPE(1,@03),NEWVOL                               0630
         BE    @RT00630                                            0630
         L     @03,IOCTLBKP                                        0630
         CLC   IOXTYPE(1,@03),VTOCHDR                              0630
         BNE   @RF00630                                            0630
@RT00630 DS    0H                                                  0631
*     DO;                           /*                       @Y30LB35*/
*                                                                  0631
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CALLER WAS INITIALIZING A NEW              @Y30LB35*/
*       /* VOLUME OR IF A REPAIRV VTOC HEADER REQUEST        @ZA11014*/
*       /* THEN A PSEUDO OPEN WAS PERFORMED                  @ZA11014*/
*       /* BY SVC82. SVC82 MUST BE CALLED FOR CLOSE.         @Y30LB35*/
*       /* THE PROC CLOSENEW IS CALLED AND                   @Y30LB35*/
*       /* WILL SET UP AND ISSUE SVC82.                      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0632
*       CALL CLOSENEW;              /*                       @Y30LB35*/
         BAL   @14,CLOSENEW                                        0632
*       RESPECIFY                                                  0633
*         RTNREG RSTD;                                             0633
*       TESTRC=RTNREG;                                             0634
         STH   RTNREG,TESTRC                                       0634
*       RESPECIFY                                                  0635
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*   ELSE                            /*                       @Y30LB35*/
*                                                                  0637
*     /***************************************************************/
*     /*                                                             */
*     /* ANY OF THE OTHER TYPES CAN BE CLOSE WITH            @Y30LB35*/
*     /* THE STANDARD CLOSE.                                 @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0637
*     IF IOXTYPE=PASSWORD×IOXTYPE=LAB×IOXTYPE=TABLE×IOXTYPE=VTOC×  0637
*         IOXTYPE=REPDS             /*                       @ZA11014*/
*       THEN                        /*                       @Y30LB35*/
         B     @RC00630                                            0637
@RF00630 L     @03,IOCTLBKP                                        0637
         CLC   IOXTYPE(1,@03),PASSWORD                             0637
         BE    @RT00637                                            0637
         L     @03,IOCTLBKP                                        0637
         CLC   IOXTYPE(1,@03),LAB                                  0637
         BE    @RT00637                                            0637
         L     @03,IOCTLBKP                                        0637
         CLC   IOXTYPE(1,@03),TABLE                                0637
         BE    @RT00637                                            0637
         L     @03,IOCTLBKP                                        0637
         CLC   IOXTYPE(1,@03),VTOC                                 0637
         BE    @RT00637                                            0637
         L     @03,IOCTLBKP                                        0637
         CLC   IOXTYPE(1,@03),REPDS                                0637
         BNE   @RF00637                                            0637
@RT00637 DS    0H                                                  0638
*       DO;                         /*                       @Y30LB35*/
*                                                                  0638
*         /***********************************************************/
*         /*                                                         */
*         /* THE PROC CLOSESTD SETS UP & PERFORMS THE CLOSE          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0639
*         CALL CLOSESTD;            /*                       @Y30LB35*/
         BAL   @14,CLOSESTD                                        0639
*         RESPECIFY                                                0640
*           RTNREG RSTD;                                           0640
*         TESTRC=RTNREG;                                           0641
         STH   RTNREG,TESTRC                                       0641
*         RESPECIFY                                                0642
*           RTNREG UNRSTD;          /*                       @Y30LB35*/
*       END;                        /*                       @Y30LB35*/
*     ELSE                          /*                       @Y30LB35*/
*                                                                  0644
*       /*************************************************************/
*       /*                                                           */
*       /* IF REQUEST IS INVALID, THEN UABORT (40)           @Y30LB35*/
*       /* WILL BE ISSUED                                    @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0644
*       DO;                                                        0644
         B     @RC00637                                            0644
@RF00637 DS    0H                                                  0645
*         RESPECIFY                                                0645
*          (REG13,                                                 0645
*           REG14,                                                 0645
*           REG15) RSTD;                                           0645
*         REG15=40;                                                0646
         LA    REG15,40                                            0646
*         REG14=GDTABT;                                            0647
         L     @03,@PC00001                                        0647
         L     REG14,GDTABT(,@03)                                  0647
*         REG13=GDTABH;                                            0648
         L     @03,@PC00001                                        0648
         L     REG13,GDTABH(,@03)                                  0648
*         GEN(BR    REG14);                                        0649
         BR    REG14
*         RESPECIFY                                                0650
*          (REG13,                                                 0650
*           REG14,                                                 0650
*           REG15) UNRSTD;                                         0650
*       END;                        /*                       @Y30LB35*/
*                                                                  0652
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO REMOVE THE IOXCTLBK FROM IODIOX             @Y30LB35*/
*   /* OPEN CHAIN.                                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0652
*   ADDCHAIN=ADDR(IODIOX);          /*                       @Y30LB35*/
*                                                                  0652
@RC00637 DS    0H                                                  0652
@RC00630 L     @03,@PC00001                                        0652
         L     @03,GDTIOH(,@03)                                    0652
         LA    @03,IODIOX(,@03)                                    0652
         ST    @03,ADDCHAIN                                        0652
*   /*****************************************************************/
*   /*                                                               */
*   /* THE ADDRESS PASSED BY CALLER IS COMPARED IN           @Y30LB35*/
*   /* CHAIN UNTIL IT IS FOUND.                              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*   DO UNCHAIN=1 BY 1 WHILE CHAINPTR^=ADDR(IOXCTLBK);              0653
         LA    @03,1                                               0653
         ST    @03,UNCHAIN                                         0653
         B     @DE00653                                            0653
@DL00653 DS    0H                                                  0654
*     ADDCHAIN=CHAINPTR;            /*                       @Y30LB35*/
         L     @03,ADDCHAIN                                        0654
         L     @03,CHAINPTR(,@03)                                  0654
         ST    @03,ADDCHAIN                                        0654
*   END;                            /*                       @Y30LB35*/
*                                                                  0655
         LA    @03,1                                               0655
         AL    @03,UNCHAIN                                         0655
         ST    @03,UNCHAIN                                         0655
@DE00653 L     @03,ADDCHAIN                                        0655
         CLC   CHAINPTR(4,@03),IOCTLBKP                            0655
         BNE   @DL00653                                            0655
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THAT THE IOXCTLBK HAS BEEN LOCATED                @Y30LB35*/
*   /* IT IS REMOVED.                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0656
*   CHAINPTR=IOXCHAIN;              /*                       @Y30LB35*/
*                                                                  0656
         L     @03,IOCTLBKP                                        0656
         L     @03,IOXCHAIN(,@03)                                  0656
         L     @01,ADDCHAIN                                        0656
         ST    @03,CHAINPTR(,@01)                                  0656
*   /*****************************************************************/
*   /*                                                               */
*   /* THE IOXCLOSE FLAG IS SET ON TO INDICATE               @Y30LB35*/
*   /* THAT THE DCB IS CLOSED IN CASE                        @Y30LB35*/
*   /* THIS CONTROL BLOCK HAS BEEN LOCATED                   @Y30LB35*/
*   /* IN A DUMP.                                            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0657
*   IOXCLOSE=ON;                    /*                       @Y30LB35*/
*                                                                  0657
         L     @03,IOCTLBKP                                        0657
         OI    IOXCLOSE(@03),B'00100000'                           0657
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THE CONTROL BLOCK IS FREED.                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0658
*   CALL IDCSAFS0(GDTTBL,IOCTLBKP); /*                       @Y30LB35*/
*                                                                  0658
         L     @03,@PC00001                                        0658
         ST    @03,@AL00001                                        0658
         LA    @03,IOCTLBKP                                        0658
         ST    @03,@AL00001+4                                      0658
         L     @03,@PC00001                                        0658
         L     @15,GDTFSP(,@03)                                    0658
         LA    @01,@AL00001                                        0658
         BALR  @14,@15                                             0658
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO IDCIO05 WITH                   @Y30LB35*/
*   /* THE CODE 4 FOR ERROR OR 0 SUCCESSFUL                  @Y30LB35*/
*   /* IN REGISTER 15.                                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0659
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
         LH    @15,TESTRC                                          0659
         L     @14,@SA00004                                        0659
         LM    @00,@12,@SA00004+8                                  0659
         BR    @14                                                 0659
*   END CLOSEPRC;                   /*                       @Y30LB35*/
*                                                                  0661
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - OPNPASS                                 @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO TEST     @Y30LB35*/
*/*             PASSWORD PROTECTED DATA SETS TO DETERMINE IF @Y30LB35*/
*/*             THE OPERATOR CAN SUPPLY THE PASSWORDS. THE   @Y30LB35*/
*/*             STEPS USED TO DETERMINE THIS IS:             @Y30LB35*/
*/*             ISSUES USTAE, SAVES REGISTERS FOR PASSWORD   @Y30LB35*/
*/*             ABEND, ISSUE OPEN TYPE=J, AND ISSUES USTAE.  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     EXODSN FROM EXOAGL                           @Y30LB35*/
*/*             EXOVSN FROM EXOAGL                           @Y30LB35*/
*/*             EXOREAD FROM EXOAGL                          @Y30LB35*/
*/*             IOXDCB FROM IOXCTLBK                         @Y30LB35*/
*/*             SAHSTA FROM HISTORICAL DATA AREA             @Y30LB35*/
*/*             OPENLIST                                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    JFCBDSNM IN IOXJFCB                          @Y30LB35*/
*/*             JFCVSL IN IOXJFCB                            @Y30LB35*/
*/*             JFCAVOLS(1) IN IOXJFCB                       @Y30LB35*/
*/*             JFCNWRIT IN IOXJFCB                          @ZM01114*/
*/*             STAIO05 IN STAEPARM                          @Y30LB35*/
*/*             STARTSAV IN STAEPRAM                         @Y30LB35*/
*/*             DCBOFLWR IN IOXDCB                           @Y30LB35*/
*/*             PARMLIST                                     @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR BAD PASSWORD          @Y30LB35*/
*/*                           4, ERROR CHECKOPN              @Y30LB35*/
*/*                           4, ERROR IN USTAE              @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0661
*                                   /*                       @Y30LB35*/
*OPNPASS:                                                          0661
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0661
OPNPASS  STM   @14,@12,@SA00005                                    0661
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0662
*   DCL                                                            0662
*     USERDSN CHAR(44) BASED(EXODSN);/*                      @Y30LB35
*                                      ADDRESSABILITY        @Y30LB35
*                                      TO CALLER'S DSN       @Y30LB35*/
*                                   /*                       @ZA11014*/
*                                                                  0663
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOOP' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0663
*   OLDERID2=NEWERID2;                                             0663
         L     @03,@PC00001                                        0663
         L     @03,GDTTR2(,@03)                                    0663
         L     @15,@PC00001                                        0663
         L     @01,GDTTR2(,@15)                                    0663
         MVC   @TS00001(95),NEWERID2(@01)                          0663
         MVC   OLDERID2(95,@03),@TS00001                           0663
*   NEWID2='IOOP';                  /*                       @Y30LB35*/
*                                                                  0664
         L     @03,@PC00001                                        0664
         L     @03,GDTTR2(,@03)                                    0664
         MVC   NEWID2(4,@03),@CC04149                              0664
*   /*****************************************************************/
*   /*                                                               */
*   /* INHIBIT PERM JFCB UPDATE DURING OPENJ                 @ZM01114*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0665
*   JFCNWRIT=ON;                    /*                       @ZM01114*/
*                                                                  0665
         L     @03,JFCBPTR                                         0665
         OI    JFCNWRIT(@03),B'00001000'                           0665
*   /*****************************************************************/
*   /*                                                               */
*   /* A TEST IS MADE TO SEE IF CALLER WANTS                 @Y30LB35*/
*   /* TO UPDATE THE DSN IN THE JFCB.                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0666
*   IF EXODSN^=NULLPTR              /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0666
         L     @03,EXODSN(,@03)                                    0666
         LTR   @03,@03                                             0666
         BZ    @RF00666                                            0666
*     JFCBDSNM=USERDSN;             /*                       @Y30LB35*/
*                                                                  0667
         L     @03,JFCBPTR                                         0667
         L     @15,@PC00001+8                                      0667
         L     @01,EXODSN(,@15)                                    0667
         MVC   JFCBDSNM(44,@03),USERDSN(@01)                       0667
*   /*****************************************************************/
*   /*                                                               */
*   /* A TEST IS MADE TO SEE IF CALLER WANTS                 @Y30LB35*/
*   /* TO UPDATE THE VOL SER IN THE JFCB.                    @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0668
*   IF EXOVSN^=NULLPTR              /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RF00666 L     @03,@PC00001+8                                      0668
         L     @03,EXOVSN(,@03)                                    0668
         LTR   @03,@03                                             0668
         BZ    @RF00668                                            0668
*     DO;                           /*                       @Y30LB35*/
*                                                                  0669
*       /*************************************************************/
*       /*                                                           */
*       /* SET FLAG TO INDICATE THE VOL SER HAS BEEN         @Y30LB35*/
*       /* HAS BEEN CHANGED AND MOVE IN NEW VOL SER.         @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0670
*       JFCVSL=ON;                  /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         0670
         OI    JFCVSL(@03),B'01000000'                             0670
*       JFCAVOLS(1)=VOLLAB;         /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         0671
         L     @15,@PC00001+8                                      0671
         L     @01,EXOVSN(,@15)                                    0671
         MVC   JFCAVOLS(6,@03),VOLLAB(@01)                         0671
*     END;                          /*                       @Y30LB35*/
*                                                                  0672
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION IS MADE IF USTAE               @Y30LB35*/
*   /* SHOULD BE INVOKED TO ESTABLISH A RECOVERY             @Y30LB35*/
*   /* ENVIRONMENT OR NOT.                                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0673
*   IF SAHSTA=NULLPTR               /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RF00668 L     @03,@PC00001                                        0673
         L     @03,GDTSAH(,@03)                                    0673
         L     @03,SAHSTA(,@03)                                    0673
         LTR   @03,@03                                             0673
         BNZ   @RF00673                                            0673
*     DO;                           /*                       @Y30LB35*/
*                                                                  0674
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP RECOVERY ENVIRONMENT.                      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0675
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Y30LB35*/
         L     @03,@PC00001                                        0675
         ST    @03,@AL00001                                        0675
         LA    @03,SET                                             0675
         ST    @03,@AL00001+4                                      0675
         MVI   @AL00001+4,X'80'                                    0675
         L     @03,@PC00001                                        0675
         L     @15,GDTSTA(,@03)                                    0675
         LA    @01,@AL00001                                        0675
         BALR  @14,@15                                             0675
*       RESPECIFY                                                  0676
*         RTNREG RSTD;                                             0676
*       TESTRC=RTNREG;                                             0677
         STH   RTNREG,TESTRC                                       0677
*       RESPECIFY                                                  0678
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*                                                                  0678
*       /*************************************************************/
*       /*                                                           */
*       /* SET CANSTAE ON TO MAKE SURE USTAE IS ISSUED       @Y30LB35*/
*       /* ON EXIT.                                          @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0679
*       CANSTAE=ON;                 /*                       @Y30LB35*/
         OI    CANSTAE,B'10000000'                                 0679
*     END;                          /*                       @Y30LB35*/
*   ELSE                            /*                       @Y30LB35*/
*                                                                  0681
*     /***************************************************************/
*     /*                                                             */
*     /* SET CANSTAE OFF TO PREVENT THE USTAE                @Y30LB35*/
*     /* CANCELLATION                                        @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0681
*     CANSTAE=OFF;                  /*                       @Y30LB35*/
         B     @RC00673                                            0681
@RF00673 NI    CANSTAE,B'01111111'                                 0681
*                                                                  0682
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO DETERMINE IF USTAE WAS SUCCESSFUL             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0682
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RC00673 LH    @03,TESTRC                                          0682
         LTR   @03,@03                                             0682
         BNZ   @RF00682                                            0682
*     DO;                           /*                       @Y30LB35*/
*                                                                  0683
*       /*************************************************************/
*       /*                                                           */
*       /* THE NECESSARY SET UP IS DONE HERE TO RETRY        @Y30LB35*/
*       /* IF THE OPERATOR CANNOT PROVIDE THE PROPER         @Y30LB35*/
*       /* PASSWORD.                                         @Y30LB35*/
*       /* THE REGISTERS ARE SAVED AND THE STAIO05 FLAG      @Y30LB35*/
*       /* IS SET TO INDICATE TO IDCSA10 THAT A RETRY        @Y30LB35*/
*       /* IS NEEDED.                                        @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0684
*       RESPECIFY                                                  0684
*        (REG1,                                                    0684
*         REG3) RSTD;               /*                       @Y30LB35*/
*       REG3=ADDR(SAVEREGS);        /*                       @Y30LB35*/
         LA    REG3,SAVEREGS                                       0685
*       GEN(STM  0,15,0(REG3));     /*                       @Y30LB35*/
         STM  0,15,0(REG3)
*       STARTSAV=ADDR(SAVEREGS);    /*                       @Y30LB35*/
         L     @15,@PC00001                                        0687
         L     @15,GDTSAH(,@15)                                    0687
         L     @15,SAHSTA(,@15)                                    0687
         LA    @00,SAVEREGS                                        0687
         ST    @00,STARTSAV(,@15)                                  0687
*       STAIO05=ON;                 /*                       @Y30LB35*/
         L     @15,@PC00001                                        0688
         L     @15,GDTSAH(,@15)                                    0688
         L     @15,SAHSTA(,@15)                                    0688
         OI    STAIO05(@15),B'10000000'                            0688
*       STARTADD=ADDR(RETRY);       /*                       @Y30LB35*/
*                                                                  0689
         L     @15,@PC00001                                        0689
         L     @15,GDTSAH(,@15)                                    0689
         L     @15,SAHSTA(,@15)                                    0689
         LA    @00,RETRY                                           0689
         ST    @00,STARTADD(,@15)                                  0689
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE INITIALIZATION FOR THE OPEN IS DONE.     @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0690
*       PARMLIST=''B;               /*                       @Y30LB35*/
         XC    PARMLIST(20),PARMLIST                               0690
*       PARMLIST=OPENLIST;          /*                       @Y30LB35*/
         MVI   PARMLIST+8,C' '                                     0691
         MVC   PARMLIST+9(11),PARMLIST+8                           0691
         MVC   PARMLIST(8),OPENLIST                                0691
*       REG3=ADDR(IOXDCB);          /*                       @Y30LB35*/
         L     REG3,IOCTLBKP                                       0692
         LA    REG3,IOXDCB(,REG3)                                  0692
*       REG1=ADDR(PARMLIST);        /*                       @Y30LB35*/
*                                                                  0693
         LA    REG1,PARMLIST                                       0693
*       /*************************************************************/
*       /*                                                           */
*       /* IF CALLER HAS SET EXOREAD THEN HE WANTS TO        @Y30LB35*/
*       /* TEST FOR A READ PASSWORD.                         @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0694
*       IF EXOREAD=ON               /*                       @Y30LB35*/
*         THEN                      /*                       @Y30LB35*/
*                                                                  0694
         L     @15,@PC00001+8                                      0694
         TM    EXOREAD(@15),B'10000000'                            0694
         BNO   @RF00694                                            0694
*         /***********************************************************/
*         /*                                                         */
*         /* OPEN FOR INPUT(READ ONLY) IS ISSUED.            @Y30LB35*/
*         /* IF A PASSWORD ABEND OCCURS (ABEND 913)          @Y30LB35*/
*         /* DURING OPEN THE PROC, RETRY WILL                @Y30LB35*/
*         /* BE ENTERED WHICH WILL ISSUE "RETURN TO          @Y30LB35*/
*         /* AFTEROPN" WITH A FOUR CODE IN REG15.            @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0695
*LOPEN1:                                                           0695
*         GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);           0695
LOPEN1   OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J
*       ELSE                        /*                       @Y30LB35*/
*                                                                  0696
*         /***********************************************************/
*         /*                                                         */
*         /* OPEN FOR OUTPUT(WRITE) IS ISSUED                @Y30LB35*/
*         /* TO TEST FOR WRITE PASSWORDS.                    @Y30LB35*/
*         /* THE SAME PROCESS WILL OCCUR IF                  @Y30LB35*/
*         /* A PASSWORD ABEND OCCURS.                        @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0696
*LOPEN2:                                                           0696
*         GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);          0696
         B     @RC00694                                            0696
@RF00694 DS    0H                                                  0696
LOPEN2   OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J
*       RESPECIFY                                                  0697
*        (REG1,                                                    0697
*         REG3) UNRSTD;             /*                       @Y30LB35*/
@RC00694 DS    0H                                                  0698
*       RESPECIFY                                                  0698
*        (RTNREG) RSTD;             /*                       @Y30LB35*/
*       RTNREG=0;                   /*                       @Y30LB35*/
         SLR   RTNREG,RTNREG                                       0699
*       RESPECIFY                                                  0700
*        (RTNREG) UNRSTD;           /*                       @Y30LB35*/
*                                                                  0700
*       /*************************************************************/
*       /*                                                           */
*       /* THE LABEL AFTEROPN WILL BE RETURNED TO IF         @Y30LB35*/
*       /* THE PROC RETRY IS ENTERED. THIS WILL ALLOW        @Y30LB35*/
*       /* FOR AN ORDERLY EXIT CONSISTENT WITH STRUCTURED            */
*       /* PROGRAMMING.                                      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0701
*AFTEROPN:                          /*                       @Y30LB35*/
*       RESPECIFY                                                  0701
*         RTNREG RSTD;                                             0701
AFTEROPN DS    0H                                                  0702
*       TESTRC=RTNREG;                                             0702
         STH   RTNREG,TESTRC                                       0702
*       RESPECIFY                                                  0703
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*                                                                  0705
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE ABEND 913 DID NOT OCCUR                 @Y30LB35*/
*   /* ADDITIONAL PROCESSING CAN TAKE PLACE.                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0705
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RF00682 LH    @03,TESTRC                                          0705
         LTR   @03,@03                                             0705
         BNZ   @RF00705                                            0705
*     DO;                           /*                       @Y30LB35*/
*                                                                  0706
*       /*************************************************************/
*       /*                                                           */
*       /* BEFORE ANY FURTHER PROCESSING THE                 @Y30LB35*/
*       /* DCBOFLWR WILL BE TURNED OFF TO PREVENT CLOSE      @Y30LB35*/
*       /* FROM WRITING AND END-OF-FILE MARK.                @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0707
*       DCBOFLWR=OFF;               /*                       @Y30LB35*/
*                                                                  0707
         L     @03,DCBPTR                                          0707
         NI    DCBOFLWR+40(@03),B'01111111'                        0707
*       /*************************************************************/
*       /*                                                           */
*       /* CHECKOPN WILL BE CALLED TO DETERMINE IF           @Y30LB35*/
*       /* DCBOFLGS WAS SET INDICATING THAT THE OPEN         @Y30LB35*/
*       /* WAS PERFORMED OR THAT OUR DCB ABEND EXIT          @Y30LB35*/
*       /* WAS NOT ENTERED.                                  @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0708
*       CALL CHECKOPN;              /*                       @Y30LB35*/
         BAL   @14,CHECKOPN                                        0708
*       RESPECIFY                                                  0709
*         RTNREG RSTD;                                             0709
*       TESTRC=RTNREG;                                             0710
         STH   RTNREG,TESTRC                                       0710
*       RESPECIFY                                                  0711
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*                                                                  0713
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE RECOVERY ENVIRONMENT WAS                @Y30LB35*/
*   /* ESTABLISHED, IT NOW CAN BE REMOVED.                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0713
*   IF CANSTAE=ON                   /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  0713
@RF00705 TM    CANSTAE,B'10000000'                                 0713
         BNO   @RF00713                                            0713
*     /***************************************************************/
*     /*                                                             */
*     /* THE USTAE IS ISSUED TO CANCEL THE RECOVERY          @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0714
*     CALL IDCSAST0(GDTTBL,CANCEL); /*                       @Y30LB35*/
         L     @03,@PC00001                                        0714
         ST    @03,@AL00001                                        0714
         LA    @03,CANCEL                                          0714
         ST    @03,@AL00001+4                                      0714
         MVI   @AL00001+4,X'80'                                    0714
         L     @03,@PC00001                                        0714
         L     @15,GDTSTA(,@03)                                    0714
         LA    @01,@AL00001                                        0714
         BALR  @14,@15                                             0714
*   ELSE                            /*                       @Y30LB35*/
*     IF STAOFF=ON                  /*                       @Y30LB35*/
*       THEN                        /*                       @Y30LB35*/
*                                                                  0715
         B     @RC00713                                            0715
@RF00713 L     @03,@PC00001                                        0715
         L     @03,GDTSAH(,@03)                                    0715
         L     @03,SAHSTA(,@03)                                    0715
         TM    STAOFF(@03),B'01000000'                             0715
         BNO   @RF00715                                            0715
*       /*************************************************************/
*       /*                                                           */
*       /* THE USTAE IS ISSUED TO REESTABLISH RECOVERY       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0716
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Y30LB35*/
*                                                                  0716
         L     @03,@PC00001                                        0716
         ST    @03,@AL00001                                        0716
         LA    @03,SET                                             0716
         ST    @03,@AL00001+4                                      0716
         MVI   @AL00001+4,X'80'                                    0716
         L     @03,@PC00001                                        0716
         L     @15,GDTSTA(,@03)                                    0716
         LA    @01,@AL00001                                        0716
         BALR  @14,@15                                             0716
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE CONTROL IS RETURNED TO OPENPROC              @Y30LB35*/
*   /* WITH A CODE 4 OR 0 IN REGISTER 15.                    @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF00715 DS    0H                                                  0717
@RC00713 LH    @15,TESTRC                                          0717
         L     @14,@SA00005                                        0717
         LM    @00,@12,@SA00005+8                                  0717
         BR    @14                                                 0717
*   END OPNPASS;                    /*                       @Y30LB35*/
*                                                                  0719
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - OPNVTOC                                 @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO OPEN THE @Z40LB35*/
*/*             VOLUME VTOC FOR PROCESSING OF THE DSCBS. THE @Z40LB35*/
*/*             STEPS USED TO DETERMINE THIS IS:             @Z40LB35*/
*/*             ISSUES USTAE, SAVES REGISTERS FOR OPEN       @Z40LB35*/
*/*             ABEND, ISSUE OPEN TYPE=J, AND ISSUES USTAE.  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     EXOVSN FROM EXOAGL                           @Z40LB35*/
*/*             EXOREAD FROM EXOAGL                          @Z40LB35*/
*/*             IOXDCB FROM IOXCTLBK                         @Z40LB35*/
*/*             SAHSTA FROM HISTORICAL DATA AREA             @Z40LB35*/
*/*             OPENLIST                                     @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    JFCBDSNM IN IOXJFCB                          @Z40LB35*/
*/*             JFCVSL IN IOXJFCB                            @Z40LB35*/
*/*             JFCAVOLS(1) IN IOXJFCB                       @Z40LB35*/
*/*             JFCNWRIT IN IOXJFCB                          @ZM01114*/
*/*             STAVTOC IN STAEPARM                          @Z40LB35*/
*/*             STARTSAV IN STAEPRAM                         @Z40LB35*/
*/*             DCBOFLWR IN IOXDCB                           @Z40LB35*/
*/*             PARMLIST                                     @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR ABEND IN OPEN         @Z40LB35*/
*/*                           4, ERROR CHECKOPN              @Z40LB35*/
*/*                           4, ERROR IN USTAE              @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0719
*                                   /*                       @Z40LB35*/
*OPNVTOC:                                                          0719
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0719
OPNVTOC  STM   @14,@12,@SA00006                                    0719
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0720
*                                                                  0720
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOOV' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0720
*   OLDERID2=NEWERID2;                                             0720
         L     @03,@PC00001                                        0720
         L     @03,GDTTR2(,@03)                                    0720
         L     @15,@PC00001                                        0720
         L     @01,GDTTR2(,@15)                                    0720
         MVC   @TS00001(95),NEWERID2(@01)                          0720
         MVC   OLDERID2(95,@03),@TS00001                           0720
*   NEWID2='IOOV';                  /*                       @Z40LB35*/
*                                                                  0721
         L     @03,@PC00001                                        0721
         L     @03,GDTTR2(,@03)                                    0721
         MVC   NEWID2(4,@03),@CC04162                              0721
*   /*****************************************************************/
*   /*                                                               */
*   /* INHIBIT PERM JFCB UPDATE DURING OPENJ                 @ZM01114*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0722
*   JFCNWRIT=ON;                    /*                       @ZM01114*/
*                                                                  0722
         L     @03,JFCBPTR                                         0722
         OI    JFCNWRIT(@03),B'00001000'                           0722
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE VTOC DSN IN THE JFCB - X'04'S                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0723
*   JFCBDSNM=VTOCDSN;               /*                       @Z40LB35*/
*                                                                  0723
         L     @03,JFCBPTR                                         0723
         MVC   JFCBDSNM(44,@03),VTOCDSN                            0723
*   /*****************************************************************/
*   /*                                                               */
*   /* A TEST IS MADE TO SEE IF CALLER WANTS                 @Z40LB35*/
*   /* TO UPDATE THE VOL SER IN THE JFCB.                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0724
*   IF EXOVSN^=NULLPTR              /*                       @Z40LB35*/
*     THEN                          /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0724
         L     @03,EXOVSN(,@03)                                    0724
         LTR   @03,@03                                             0724
         BZ    @RF00724                                            0724
*     DO;                           /*                       @Z40LB35*/
*                                                                  0725
*       /*************************************************************/
*       /*                                                           */
*       /* SET FLAG TO INDICATE THE VOL SER                  @Z40LB35*/
*       /* HAS BEEN CHANGED AND MOVE IN NEW VOL SER.         @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*       JFCVSL=ON;                  /*                       @Z40LB35*/
         L     @03,JFCBPTR                                         0726
         OI    JFCVSL(@03),B'01000000'                             0726
*       JFCAVOLS(1)=VOLLAB;         /*                       @Z40LB35*/
         L     @03,JFCBPTR                                         0727
         L     @15,@PC00001+8                                      0727
         L     @01,EXOVSN(,@15)                                    0727
         MVC   JFCAVOLS(6,@03),VOLLAB(@01)                         0727
*     END;                          /*                       @Z40LB35*/
*                                                                  0728
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION IS MADE IF USTAE               @Z40LB35*/
*   /* SHOULD BE INVOKED TO ESTABLISH A RECOVERY             @Z40LB35*/
*   /* ENVIRONMENT OR NOT.                                   @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0729
*   IF SAHSTA=NULLPTR               /*                       @Z40LB35*/
*     THEN                          /*                       @Z40LB35*/
@RF00724 L     @03,@PC00001                                        0729
         L     @03,GDTSAH(,@03)                                    0729
         L     @03,SAHSTA(,@03)                                    0729
         LTR   @03,@03                                             0729
         BNZ   @RF00729                                            0729
*     DO;                           /*                       @Z40LB35*/
*                                                                  0730
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP RECOVERY ENVIRONMENT.                      @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0731
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Z40LB35*/
         L     @03,@PC00001                                        0731
         ST    @03,@AL00001                                        0731
         LA    @03,SET                                             0731
         ST    @03,@AL00001+4                                      0731
         MVI   @AL00001+4,X'80'                                    0731
         L     @03,@PC00001                                        0731
         L     @15,GDTSTA(,@03)                                    0731
         LA    @01,@AL00001                                        0731
         BALR  @14,@15                                             0731
*       RESPECIFY                                                  0732
*         RTNREG RSTD;                                             0732
*       TESTRC=RTNREG;                                             0733
         STH   RTNREG,TESTRC                                       0733
*       RESPECIFY                                                  0734
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*                                                                  0734
*       /*************************************************************/
*       /*                                                           */
*       /* SET CANSTAE ON TO MAKE SURE USTAE IS ISSUED       @Z40LB35*/
*       /* ON EXIT.                                          @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0735
*       CANSTAE=ON;                 /*                       @Z40LB35*/
         OI    CANSTAE,B'10000000'                                 0735
*     END;                          /*                       @Z40LB35*/
*   ELSE                            /*                       @Z40LB35*/
*                                                                  0737
*     /***************************************************************/
*     /*                                                             */
*     /* SET CANSTAE OFF TO PREVENT THE USTAE                @Z40LB35*/
*     /* CANCELLATION                                        @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0737
*     CANSTAE=OFF;                  /*                       @Z40LB35*/
         B     @RC00729                                            0737
@RF00729 NI    CANSTAE,B'01111111'                                 0737
*                                                                  0738
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO DETERMINE IF USTAE WAS SUCCESSFUL             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0738
*   IF TESTRC=0                     /*                       @Z40LB35*/
*     THEN                          /*                       @Z40LB35*/
@RC00729 LH    @03,TESTRC                                          0738
         LTR   @03,@03                                             0738
         BNZ   @RF00738                                            0738
*     DO;                           /*                       @Z40LB35*/
*                                                                  0739
*       /*************************************************************/
*       /*                                                           */
*       /* THE NECESSARY SET UP IS DONE HERE TO RETRY        @Z40LB35*/
*       /* IF AN ABEND OCCURS DURING THE OPENING OF VTOC     @Z40LB35*/
*       /* THE REGISTERS ARE SAVED AND THE STAVTOC FLAG      @Z40LB35*/
*       /* IS SET TO INDICATE TO IDCSA10 THAT A RETRY        @Z40LB35*/
*       /* IS NEEDED.                                        @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0740
*       RESPECIFY                                                  0740
*        (REG1,                                                    0740
*         REG3) RSTD;               /*                       @Z40LB35*/
*       REG3=ADDR(SAVEREGS);        /*                       @Z40LB35*/
         LA    REG3,SAVEREGS                                       0741
*       GEN(STM  0,15,0(REG3));     /*                       @Z40LB35*/
         STM  0,15,0(REG3)
*       STARTSAV=ADDR(SAVEREGS);    /*                       @Z40LB35*/
         L     @15,@PC00001                                        0743
         L     @15,GDTSAH(,@15)                                    0743
         L     @15,SAHSTA(,@15)                                    0743
         LA    @00,SAVEREGS                                        0743
         ST    @00,STARTSAV(,@15)                                  0743
*       STAVTOC=ON;                 /*                       @Z40LB35*/
         L     @15,@PC00001                                        0744
         L     @15,GDTSAH(,@15)                                    0744
         L     @15,SAHSTA(,@15)                                    0744
         OI    STAVTOC(@15),B'00100000'                            0744
*       STARTADD=ADDR(RETRY);       /*                       @Z40LB35*/
*                                                                  0745
         L     @15,@PC00001                                        0745
         L     @15,GDTSAH(,@15)                                    0745
         L     @15,SAHSTA(,@15)                                    0745
         LA    @00,RETRY                                           0745
         ST    @00,STARTADD(,@15)                                  0745
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE INITIALIZATION FOR THE OPEN IS DONE.     @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0746
*       PARMLIST=''B;               /*                       @Z40LB35*/
         XC    PARMLIST(20),PARMLIST                               0746
*       PARMLIST=OPENLIST;          /*                       @Z40LB35*/
         MVI   PARMLIST+8,C' '                                     0747
         MVC   PARMLIST+9(11),PARMLIST+8                           0747
         MVC   PARMLIST(8),OPENLIST                                0747
*       REG3=ADDR(IOXDCB);          /*                       @Z40LB35*/
         L     REG3,IOCTLBKP                                       0748
         LA    REG3,IOXDCB(,REG3)                                  0748
*       REG1=ADDR(PARMLIST);        /*                       @Z40LB35*/
*                                                                  0749
         LA    REG1,PARMLIST                                       0749
*       /*************************************************************/
*       /*                                                           */
*       /* IF CALLER HAS SET EXOREAD THEN HE WANTS TO        @Z40LB35*/
*       /* OPEN FOR A READ ONLY.                             @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0750
*       IF EXOREAD=ON               /*                       @Z40LB35*/
*         THEN                      /*                       @Z40LB35*/
*                                                                  0750
         L     @15,@PC00001+8                                      0750
         TM    EXOREAD(@15),B'10000000'                            0750
         BNO   @RF00750                                            0750
*         /***********************************************************/
*         /*                                                         */
*         /* OPEN FOR INPUT(READ ONLY) IS ISSUED.            @Z40LB35*/
*         /* IF AN ABEND OCCURS                              @Z40LB35*/
*         /* DURING OPEN, THE PROC RETRY WILL                @Z40LB35*/
*         /* BE ENTERED WHICH WILL ISSUE "RETURN TO          @Z40LB35*/
*         /* AFTEROP2" WITH A FOUR CODE IN REG15.            @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0751
*LOPEN7:                                                           0751
*         GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);           0751
LOPEN7   OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J
*       ELSE                        /*                       @Z40LB35*/
*                                                                  0752
*         /***********************************************************/
*         /*                                                         */
*         /* OPEN FOR OUTPUT(WRITE) IS ISSUED.               @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0752
*LOPEN8:                                                           0752
*         GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);          0752
         B     @RC00750                                            0752
@RF00750 DS    0H                                                  0752
LOPEN8   OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J
*       RESPECIFY                                                  0753
*        (REG1,                                                    0753
*         REG3) UNRSTD;             /*                       @Z40LB35*/
@RC00750 DS    0H                                                  0754
*       RESPECIFY                                                  0754
*        (RTNREG) RSTD;             /*                       @Z40LB35*/
*       RTNREG=0;                   /*                       @Z40LB35*/
         SLR   RTNREG,RTNREG                                       0755
*       RESPECIFY                                                  0756
*        (RTNREG) UNRSTD;           /*                       @Z40LB35*/
*                                                                  0756
*       /*************************************************************/
*       /*                                                           */
*       /* THE LABEL AFTEROP2 WILL BE RETURNED TO IF         @Z40LB35*/
*       /* THE PROC RETRY IS ENTERED. THIS WILL ALLOW        @Z40LB35*/
*       /* FOR AN ORDERLY EXIT CONSISTENT WITH STRUCTURED            */
*       /* PROGRAMMING.                                      @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0757
*AFTEROP2:                          /*                       @Z40LB35*/
*       RESPECIFY                                                  0757
*         RTNREG RSTD;                                             0757
AFTEROP2 DS    0H                                                  0758
*       TESTRC=RTNREG;                                             0758
         STH   RTNREG,TESTRC                                       0758
*       RESPECIFY                                                  0759
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0761
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING AN ABEND DID NOT OCCUR                      @Z40LB35*/
*   /* ADDITIONAL PROCESSING CAN TAKE PLACE.                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0761
*   IF TESTRC=0                     /*                       @Z40LB35*/
*     THEN                          /*                       @Z40LB35*/
@RF00738 LH    @03,TESTRC                                          0761
         LTR   @03,@03                                             0761
         BNZ   @RF00761                                            0761
*     DO;                           /*                       @Z40LB35*/
*                                                                  0762
*       /*************************************************************/
*       /*                                                           */
*       /* CHECKOPN WILL BE CALLED TO DETERMINE IF           @Z40LB35*/
*       /* DCBOFLGS WAS SET INDICATING THAT THE OPEN         @Z40LB35*/
*       /* WAS PERFORMED OR THAT OUR DCB ABEND EXIT          @Z40LB35*/
*       /* WAS NOT ENTERED.                                  @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0763
*       CALL CHECKOPN;              /*                       @Z40LB35*/
         BAL   @14,CHECKOPN                                        0763
*       RESPECIFY                                                  0764
*         RTNREG RSTD;                                             0764
*       TESTRC=RTNREG;                                             0765
         STH   RTNREG,TESTRC                                       0765
*       RESPECIFY                                                  0766
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*                                                                  0766
*       /*************************************************************/
*       /*                                                           */
*       /* BEFORE ANY FURTHER PROCESSING THE                 @Z40LB35*/
*       /* DCBOFLWR WILL BE TURNED OFF TO PREVENT CLOSE      @Z40LB35*/
*       /* FROM WRITING AND END-OF-FILE MARK.                @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0767
*       DCBOFLWR=OFF;               /*                       @Z40LB35*/
         L     @03,DCBPTR                                          0767
         NI    DCBOFLWR+40(@03),B'01111111'                        0767
*       IF TESTRC=0 THEN            /*                       @Z40LB35*/
         LH    @03,TESTRC                                          0768
         LTR   @03,@03                                             0768
         BNZ   @RF00768                                            0768
*         DO;                       /*                       @Z40LB35*/
*                                                                  0769
*           /*********************************************************/
*           /*                                                       */
*           /* HERE THE STEPS ARE TAKEN TO RETURN THE        @Z40LB35*/
*           /* DATA SET EXTENTS TO THE CALLER.               @Z40LB35*/
*           /* ADDRESSABILITY IS SET UP TO THE DEB           @Z40LB35*/
*           /* AND THE BEGINNING AND ENDING CCHH'S           @Z40LB35*/
*           /* ARE RETURNED.                                 @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0770
*           DEBPTR=DCBDEBAD;        /*                       @Z40LB35*/
         L     @03,DCBPTR                                          0770
         L     @03,DCBDEBAD+40(,@03)                               0770
         ST    @03,DEBPTR                                          0770
*           RTNEXTS=''B;            /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0771
         L     @03,EXOEXT(,@03)                                    0771
         XC    RTNEXTS(10,@03),RTNEXTS(@03)                        0771
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              0772
         LA    @03,32                                              0772
         AL    @03,DEBPTR                                          0772
         ST    @03,DEBDAPTR                                        0772
*           BEGCC=DEBSTRCC;         /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0773
         L     @03,EXOEXT(,@03)                                    0773
         L     @01,DEBDAPTR                                        0773
         MVC   BEGCC(2,@03),DEBSTRCC(@01)                          0773
*           BEGHH=DEBSTRHH;         /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0774
         L     @03,EXOEXT(,@03)                                    0774
         L     @01,DEBDAPTR                                        0774
         MVC   BEGHH(2,@03),DEBSTRHH(@01)                          0774
*           ENDCC=DEBENDCC;         /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0775
         L     @03,EXOEXT(,@03)                                    0775
         L     @01,DEBDAPTR                                        0775
         MVC   ENDCC(2,@03),DEBENDCC(@01)                          0775
*           ENDHH=DEBENDHH;         /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0776
         L     @03,EXOEXT(,@03)                                    0776
         L     @01,DEBDAPTR                                        0776
         MVC   ENDHH(2,@03),DEBENDHH(@01)                          0776
*         END;                      /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
@RF00768 DS    0H                                                  0779
*                                                                  0779
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE RECOVERY ENVIRONMENT WAS                @Z40LB35*/
*   /* ESTABLISHED, IT NOW CAN BE REMOVED.                   @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0779
*   IF CANSTAE=ON                   /*                       @Z40LB35*/
*     THEN                          /*                       @Z40LB35*/
*                                                                  0779
@RF00761 TM    CANSTAE,B'10000000'                                 0779
         BNO   @RF00779                                            0779
*     /***************************************************************/
*     /*                                                             */
*     /* THE USTAE IS ISSUED TO CANCEL THE RECOVERY          @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0780
*     CALL IDCSAST0(GDTTBL,CANCEL); /*                       @Z40LB35*/
         L     @03,@PC00001                                        0780
         ST    @03,@AL00001                                        0780
         LA    @03,CANCEL                                          0780
         ST    @03,@AL00001+4                                      0780
         MVI   @AL00001+4,X'80'                                    0780
         L     @03,@PC00001                                        0780
         L     @15,GDTSTA(,@03)                                    0780
         LA    @01,@AL00001                                        0780
         BALR  @14,@15                                             0780
*   ELSE                            /*                       @Z40LB35*/
*     IF STAOFF=ON                  /*                       @Z40LB35*/
*       THEN                        /*                       @Z40LB35*/
*                                                                  0781
         B     @RC00779                                            0781
@RF00779 L     @03,@PC00001                                        0781
         L     @03,GDTSAH(,@03)                                    0781
         L     @03,SAHSTA(,@03)                                    0781
         TM    STAOFF(@03),B'01000000'                             0781
         BNO   @RF00781                                            0781
*       /*************************************************************/
*       /*                                                           */
*       /* THE USTAE IS ISSUED TO REESTABLISH RECOVERY       @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0782
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Z40LB35*/
*                                                                  0782
         L     @03,@PC00001                                        0782
         ST    @03,@AL00001                                        0782
         LA    @03,SET                                             0782
         ST    @03,@AL00001+4                                      0782
         MVI   @AL00001+4,X'80'                                    0782
         L     @03,@PC00001                                        0782
         L     @15,GDTSTA(,@03)                                    0782
         LA    @01,@AL00001                                        0782
         BALR  @14,@15                                             0782
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE CONTROL IS RETURNED TO OPENPROC              @Z40LB35*/
*   /* WITH A CODE 4 OR 0 IN REGISTER 15.                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0783
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00781 DS    0H                                                  0783
@RC00779 LH    @15,TESTRC                                          0783
         L     @14,@SA00006                                        0783
         LM    @00,@12,@SA00006+8                                  0783
         BR    @14                                                 0783
*   END OPNVTOC;                    /*                       @Z40LB35*/
*                                                                  0785
*/********************************************************************/
*/*                                                          #Y30LB35*/
*/* PROCEDURE NAME - OPNTAB                                  #Y30LB35*/
*/*                                                          #Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO OPEN THE #Y30LB35*/
*/*             THE DATA SET CONTAINING THE MSS HARDWARE     #Y30LB35*/
*/*             TABLES. THE STEPS USED TO DETERMINE THIS ARE:#Y30LB35*/
*/*             ISSUES OPEN, CALLS CHECKOPN AND RETURNS      #Y30LB35*/
*/*             DEB EXTENTS.                                 #Y30LB35*/
*/*                                                          #Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    #Y30LB35*/
*/*                                                          #Y30LB35*/
*/* INPUT -     EXOREAD  IN EXOAGL                           #Y30LB35*/
*/*             DCBDEBAD IN IOXDCB                           #Y30LB35*/
*/*             DEBSTRCC IN DEBBASIC                         #Y30LB35*/
*/*             DEBSTRHH IN DEBBASIC                         @Y30LB35*/
*/*             DEBENDCC IN DEBBASIC                         @Y30LB35*/
*/*             DEBENDHH IN DEBBASIC                         @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DCBOFLWR IN IOXDCB                           @Y30LB35*/
*/*             BEGCC IN CALLER'S CORE                       @Y30LB35*/
*/*             BEGHH IN CALLER'S CORE                       @Y30LB35*/
*/*             ENDCC IN CALLER'S CORE                       @Y30LB35*/
*/*             ENDHH IN CALLER'S CORE                       @Y30LB35*/
*/*             PARMLIST                                     @Y30LB35*/
*/*             DEBPTR                                       @Y30LB35*/
*/*             DEBDAPTR                                     @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN CHECKOPN           @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0785
*                                   /*                       @Y30LB35*/
*OPNTAB:                                                           0785
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0785
OPNTAB   STM   @14,@12,@SA00007                                    0785
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOOT' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0786
*   OLDERID2=NEWERID2;                                             0786
         L     @03,@PC00001                                        0786
         L     @03,GDTTR2(,@03)                                    0786
         L     @15,@PC00001                                        0786
         L     @01,GDTTR2(,@15)                                    0786
         MVC   @TS00001(95),NEWERID2(@01)                          0786
         MVC   OLDERID2(95,@03),@TS00001                           0786
*   NEWID2='IOOT';                  /*                       @Y30LB35*/
*                                                                  0787
         L     @03,@PC00001                                        0787
         L     @03,GDTTR2(,@03)                                    0787
         MVC   NEWID2(4,@03),@CC04172                              0787
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PARMLIST IS SET UP HERE FOR THE OPEN              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0788
*   RESPECIFY                                                      0788
*    (REG1,                                                        0788
*     REG3) RSTD;                   /*                       @Y30LB35*/
*   REG1=ADDR(PARMLIST);            /*                       @Y30LB35*/
         LA    REG1,PARMLIST                                       0789
*   REG3=ADDR(IOXDCB);              /*                       @Y30LB35*/
         L     REG3,IOCTLBKP                                       0790
         LA    REG3,IOXDCB(,REG3)                                  0790
*   PARMLIST=''B;                   /*                       @Y30LB35*/
         XC    PARMLIST(20),PARMLIST                               0791
*   PARMLIST=OPENLIST;              /*                       @Y30LB35*/
         MVI   PARMLIST+8,C' '                                     0792
         MVC   PARMLIST+9(11),PARMLIST+8                           0792
         MVC   PARMLIST(8),OPENLIST                                0792
*                                                                  0793
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE EXOREAD BIT IS SET THE DSN WILL                @Y30LB35*/
*   /* BE OPENED FOR INPUT(READ ONLY)                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0793
*   IF EXOREAD=ON                   /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0793
         TM    EXOREAD(@15),B'10000000'                            0793
         BNO   @RF00793                                            0793
*LOPEN3:                                                           0794
*     GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)));/*              @Y30LB35*/
LOPEN3   OPEN ((REG3),INPUT),MF=(E,(REG1))
*   ELSE                            /*                       @Y30LB35*/
*                                                                  0795
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE BIT IS NOT SET THEN IT WILL BE FOR           @Y30LB35*/
*     /* OUTPUT.                                             @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0795
*LOPEN4:                                                           0795
*     GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)));/*             @Y30LB35*/
*                                                                  0795
         B     @RC00793                                            0795
@RF00793 DS    0H                                                  0795
LOPEN4   OPEN ((REG3),OUTPUT),MF=(E,(REG1))
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECKOPN IS CALLED TO DETERMINE WHETHER               @Y30LB35*/
*   /* THE OPEN WAS SUCCESSFUL AND THAT THE DCB              @Y30LB35*/
*   /* ABEND EXIT WAS NOT TAKEN.                             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0796
*   CALL CHECKOPN;                  /*                       @Y30LB35*/
@RC00793 BAL   @14,CHECKOPN                                        0796
*   RESPECIFY                                                      0797
*     RTNREG RSTD;                                                 0797
*   TESTRC=RTNREG;                                                 0798
         STH   RTNREG,TESTRC                                       0798
*   RESPECIFY                                                      0799
*     RTNREG UNRSTD;                /*                       @Y30LB35*/
*                                                                  0800
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE OPEN WAS SUCCESSFUL, THE FINAL                 @Y30LB35*/
*   /* SET UP IS PERFORMED.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0800
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         LH    @00,TESTRC                                          0800
         LTR   @00,@00                                             0800
         BNZ   @RF00800                                            0800
*     DO;                           /*                       @Y30LB35*/
*                                                                  0801
*       /*************************************************************/
*       /*                                                           */
*       /* THE DCBOFLWR BIT IS SET OFF TO ENSURE THAT        @Y30LB35*/
*       /* CLOSE DOES NOT WRITE AN END-OF-FILE.              @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0802
*       DCBOFLWR=OFF;               /*                       @Y30LB35*/
*                                                                  0802
         L     @15,DCBPTR                                          0802
         NI    DCBOFLWR+40(@15),B'01111111'                        0802
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE STEPS ARE TAKEN TO RETURN THE            @Y30LB35*/
*       /* DATA SET EXTENTS TO THE CALLER.                   @Y30LB35*/
*       /* ADDRESSABILITY IS SET UP TO THE DEB               @Y30LB35*/
*       /* AND THE BEGINNING AND ENDING CCHH'S               @Y30LB35*/
*       /* ARE RETURNED.                                     @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0803
*       DEBPTR=DCBDEBAD;            /*                       @Y30LB35*/
         L     @15,DCBPTR                                          0803
         L     @00,DCBDEBAD+40(,@15)                               0803
         ST    @00,DEBPTR                                          0803
*       RTNEXTS=''B;                /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0804
         L     @15,EXOEXT(,@15)                                    0804
         XC    RTNEXTS(10,@15),RTNEXTS(@15)                        0804
*       DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);                  0805
         LA    @00,32                                              0805
         AL    @00,DEBPTR                                          0805
         ST    @00,DEBDAPTR                                        0805
*       BEGCC=DEBSTRCC;             /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0806
         L     @15,EXOEXT(,@15)                                    0806
         L     @14,DEBDAPTR                                        0806
         MVC   BEGCC(2,@15),DEBSTRCC(@14)                          0806
*       BEGHH=DEBSTRHH;             /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0807
         L     @15,EXOEXT(,@15)                                    0807
         L     @14,DEBDAPTR                                        0807
         MVC   BEGHH(2,@15),DEBSTRHH(@14)                          0807
*       ENDCC=DEBENDCC;             /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0808
         L     @15,EXOEXT(,@15)                                    0808
         L     @14,DEBDAPTR                                        0808
         MVC   ENDCC(2,@15),DEBENDCC(@14)                          0808
*       ENDHH=DEBENDHH;             /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0809
         L     @15,EXOEXT(,@15)                                    0809
         L     @14,DEBDAPTR                                        0809
         MVC   ENDHH(2,@15),DEBENDHH(@14)                          0809
*     END;                          /*                       @Y30LB35*/
*   RESPECIFY                                                      0811
*    (REG1,                                                        0811
*     REG3) UNRSTD;                 /*                       @Y30LB35*/
*                                                                  0811
@RF00800 DS    0H                                                  0812
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE CONTROL IS RETURNED TO OPENPROC                  @Y30LB35*/
*   /* THE RETURN CODE IS RETURNED IN REGISTER 15            @Y30LB35*/
*   /* - 4 CODE INDICATES ERROR AND 0 SUCCESSFUL.            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0812
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
         LH    @15,TESTRC                                          0812
         L     @14,@SA00007                                        0812
         LM    @00,@12,@SA00007+8                                  0812
         BR    @14                                                 0812
*   END OPNTAB;                     /*                       @Y30LB35*/
*                                                                  0814
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - OPNLAB                                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             OPEN THE VOLUME SUCH THAT I/O CAN BE         @Y30LB35*/
*/*             PERFORMED TO THE VOLUME LABEL RECORD         @Y30LB35*/
*/*             (CYL 0 TRK 0 REC 3).  THIS IS DONE BY        @Y30LB35*/
*/*             THE FOLLOWING STEPS:                         @Y30LB35*/
*/*             UPDATE JFCB, ISSUE OPEN TYPE=J, ISSUE        @Y30LB35*/
*/*             MODESET(KEY ZERO), MODIFY DEB EXTENT, AND    @Y30LB35*/
*/*             MODESET(PROBLEM PROGRAM KEY)                 @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     EXOVSN IN EXOAGL                             @Y30LB35*/
*/*             IOXDCB IN IOXCTLBK                           @Y30LB35*/
*/*             DCBDEBAD IN IOXDCB                           @Y30LB35*/
*/*             DEBBASIC                                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    JFCBDSNM IN IOXJFCB                          @Y30LB35*/
*/*             JFCNWRIT IN IOXJFCB                          @Y30LB35*/
*/*             JFCVSL IN IOXJFCB                            @Y30LB35*/
*/*             JFCAVOLS(1) IN IOXJFCB                       @Y30LB35*/
*/*             DCBOFLWR IN IOXDCB                           @Y30LB35*/
*/*             DEBSTRCC IN DEBBASIC                         @Y30LB35*/
*/*             DEBSTRHH IN DEBBASIC                         @Y30LB35*/
*/*             DEBPTR                                       @Y30LB35*/
*/*             DEBDAPTR                                     @Y30LB35*/
*/*             MODEPARM                                     @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN CHECKOPN           @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0814
*                                   /*                       @Y30LB35*/
*OPNLAB:                                                           0814
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0814
OPNLAB   STM   @14,@12,@SA00008                                    0814
*   /*****************************************************************/
*   /*                                                               */
*   /* THE NEXT TWO CONSTANTS ARE USED TO ALLOW              @Y30LB35*/
*   /* ACCESS TO THE BEGINNING OF THE VOLUME.                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0815
*   DCL                                                            0815
*     CYLZERO CHAR(2) STATIC INIT('0000'X);/*                @Y30LB35
*                                      CYLINDER ZERO         @Y30LB35*/
*   DCL                                                            0816
*     TRKZERO CHAR(2) STATIC INIT('0000'X);/*                @Y30LB35
*                                      TRACK ZERO            @Y30LB35*/
*                                                                  0816
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE IS THE MACRO LIST FORM OF                        @Y30LB35*/
*   /* MODESET MF(L,MOD1) KEY(ZERO) MODE(SUP)                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0817
*   DCL                                                            0817
*     1 MOD1 STATIC BDY(WORD),      /* DEFINE LIST                   */
*      2 MOD101 BIT(8) INIT('00000000'B),/* OR MASK                  */
*      2 MOD102 BIT(8) INIT('00000000'B),/* AND MASK                 */
*      2 MOD103 BIT(8) INIT('00000000'B),/* RESERVED                 */
*      2 MOD104 BIT(8) INIT('00111100'B);/*                  @Y30LB35*/
*                                                                  0817
*   /*****************************************************************/
*   /*                                                               */
*   /* MODESET MF(L,MOD2) KEY(NZERO) MODE(PROB)                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0818
*   DCL                                                            0818
*     1 MOD2 STATIC BDY(WORD),      /* DEFINE LIST                   */
*      2 MOD201 BIT(8) INIT('00000000'B),/* OR MASK                  */
*      2 MOD202 BIT(8) INIT('00000000'B),/* AND MASK                 */
*      2 MOD203 BIT(8) INIT('00000000'B),/* RESERVED                 */
*      2 MOD204 BIT(8) INIT('00100100'B);/*                  @Y30LB35*/
*                                                                  0818
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS DEFINES DYNAMIC STORAGE FOR MODESET              @Y30LB35*/
*   /* PARMLISTS.                                            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0819
*   DCL                                                            0819
*     MODEPARM CHAR(LENGTH(MOD1)) BDY(WORD);/*               @Y30LB35*/
*                                                                  0820
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOOL' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0820
*   OLDERID2=NEWERID2;                                             0820
         L     @03,@PC00001                                        0820
         L     @03,GDTTR2(,@03)                                    0820
         L     @15,@PC00001                                        0820
         L     @01,GDTTR2(,@15)                                    0820
         MVC   @TS00001(95),NEWERID2(@01)                          0820
         MVC   OLDERID2(95,@03),@TS00001                           0820
*   NEWID2='IOOL';                  /*                       @Y30LB35
*                                                            @Y30LB35*/
*                                                                  0821
         L     @03,@PC00001                                        0821
         L     @03,GDTTR2(,@03)                                    0821
         MVC   NEWID2(4,@03),@CC04197                              0821
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE JFCB TO OPEN VTOC                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*   JFCBDSNM=VTOCDSN;               /*                       @Z40LB35*/
         L     @03,JFCBPTR                                         0822
         MVC   JFCBDSNM(44,@03),VTOCDSN                            0822
*   JFCNWRIT=ON;                    /*                       @Y30LB35*/
*                                                                  0823
         L     @03,JFCBPTR                                         0823
         OI    JFCNWRIT(@03),B'00001000'                           0823
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CALLER HAS PROVIDED THE VOLSER                     @Y30LB35*/
*   /* IT IS MOVED INTO THE JFCB.                            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0824
*   IF EXOVSN^=NULLPTR              /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0824
         L     @03,EXOVSN(,@03)                                    0824
         LTR   @03,@03                                             0824
         BZ    @RF00824                                            0824
*     DO;                           /*                       @Y30LB35*/
*       JFCVSL=ON;                  /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         0826
         OI    JFCVSL(@03),B'01000000'                             0826
*       JFCAVOLS(1)=VOLLAB;         /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         0827
         L     @15,@PC00001+8                                      0827
         L     @01,EXOVSN(,@15)                                    0827
         MVC   JFCAVOLS(6,@03),VOLLAB(@01)                         0827
*     END;                          /*                       @Y30LB35*/
*                                                                  0828
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PARMLISTS ARE INITIALIZED FOR THE OPEN            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0829
*   PARMLIST=''B;                   /*                       @Y30LB35*/
@RF00824 XC    PARMLIST(20),PARMLIST                               0829
*   PARMLIST=OPENLIST;              /*                       @Y30LB35*/
         MVI   PARMLIST+8,C' '                                     0830
         MVC   PARMLIST+9(11),PARMLIST+8                           0830
         MVC   PARMLIST(8),OPENLIST                                0830
*   RESPECIFY                                                      0831
*    (REG3,                                                        0831
*     REG1) RSTD;                   /*                       @Y30LB35*/
*   REG3=ADDR(IOXDCB);              /*                       @Y30LB35*/
         L     REG3,IOCTLBKP                                       0832
         LA    REG3,IOXDCB(,REG3)                                  0832
*   REG1=ADDR(PARMLIST);            /*                       @Y30LB35*/
*                                                                  0833
         LA    REG1,PARMLIST                                       0833
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CALLER HAS SET EXOREAD, THEN                   @Y30LB35*/
*   /* THE DATA SET WILL BE OPENED FOR INPUT(READ)           @Y30LB35*/
*   /* ONLY                                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0834
*   IF EXOREAD=ON                   /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @15,@PC00001+8                                      0834
         TM    EXOREAD(@15),B'10000000'                            0834
         BNO   @RF00834                                            0834
*LOPEN5:                                                           0835
*     GEN(OPEN  ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);              0835
*                                                                  0835
LOPEN5   OPEN  ((REG3),INPUT),MF=(E,(REG1)),TYPE=J
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE EXOREAD IS NOT SET IT IS OPENED                @Y30LB35*/
*   /* FOR OUTPUT.                                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0836
*   ELSE                            /*                       @Y30LB35*/
*LOPEN6:                                                           0836
*     GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);/*      @Y30LB35*/
         B     @RC00834                                            0836
@RF00834 DS    0H                                                  0836
LOPEN6   OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J
*                                                                  0837
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE CHECKOPN IS CALLED TO DETERMINE                  @Y30LB35*/
*   /* IF THE OPEN WAS SUCCESSFUL.                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0837
*   CALL CHECKOPN;                  /*                       @Y30LB35*/
@RC00834 BAL   @14,CHECKOPN                                        0837
*   RESPECIFY                                                      0838
*     RTNREG RSTD;                                                 0838
*   TESTRC=RTNREG;                                                 0839
         STH   RTNREG,TESTRC                                       0839
*   RESPECIFY                                                      0840
*     RTNREG UNRSTD;                /*                       @Y30LB35*/
*                                                                  0840
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE OPEN WAS SUCCESSFUL THE FINAL                  @Y30LB35*/
*   /* INITIALIZATION IS PERFORMED.                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         LH    @00,TESTRC                                          0841
         LTR   @00,@00                                             0841
         BNZ   @RF00841                                            0841
*     DO;                           /*                       @Y30LB35*/
*                                                                  0842
*       /*************************************************************/
*       /*                                                           */
*       /* THE DCBOFLWR IS SET OFF TO PREVENT CLOSE          @Y30LB35*/
*       /* FROM WRITING AN END-OF-FILE MARK.                 @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0843
*       DCBOFLWR=OFF;               /*                       @Y30LB35*/
*                                                                  0843
         L     @15,DCBPTR                                          0843
         NI    DCBOFLWR+40(@15),B'01111111'                        0843
*       /*************************************************************/
*       /*                                                           */
*       /* HERE PREPARATIONS ARE MADE TO ISSUE               @Y30LB35*/
*       /* MODESET INTO SUPERVISOR KEY.                      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0844
*       MODEPARM=''B;               /*                       @Y30LB35*/
         XC    MODEPARM(4),MODEPARM                                0844
*       MODEPARM=MOD1;              /*                       @Y30LB35*/
         L     @00,MOD1                                            0845
         ST    @00,MODEPARM                                        0845
*       RESPECIFY                                                  0846
*        (REG3,                                                    0846
*         REG1) RSTD;               /*                       @Y30LB35*/
*       REG3=MODEPARM;              /*                       @Y30LB35*/
*                                                                  0847
         L     REG3,MODEPARM                                       0847
*       /*************************************************************/
*       /*                                                           */
*       /* BEFORE THE MODESET IS ISSUED, THE DEB PTRS        @Y30LB35*/
*       /* ARE SET UP.                                       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0848
*       DEBPTR=DCBDEBAD;            /*                       @Y30LB35*/
         L     @15,DCBPTR                                          0848
         L     @00,DCBDEBAD+40(,@15)                               0848
         ST    @00,DEBPTR                                          0848
*       DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);                  0849
*                                                                  0849
         LA    @00,32                                              0849
         AL    @00,DEBPTR                                          0849
         ST    @00,DEBDAPTR                                        0849
*       /*************************************************************/
*       /*                                                           */
*       /* THE MODESET WILL GET US INTO SUPERVISOR           @Y30LB35*/
*       /* STATE KEY ZERO. THIS WILL ALLOW US TO             @Y30LB35*/
*       /* MODIFY THE DEB WHICH IS IN PROTECTED CORE.        @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0850
*LMODE1:                                                           0850
*       DO;                         /* MODESET MF(E,REG3)            */
LMODE1   DS    0H                                                  0851
*         RESPECIFY                                                0851
*           GPR01F RESTRICTED;                                     0851
*         GPR01F=REG3;              /* MODESET PARMLIST              */
         LR    GPR01F,REG3                                         0852
*         SVC(107);                 /* ISSUE MODESET SVC             */
         SVC   107                                                 0853
*         RESPECIFY                                                0854
*          (GPR01F) UNRESTRICTED;                                  0854
*       END;                        /* MODESET MF(E,REG3)    @Y30LB35*/
*                                                                  0856
*       /*************************************************************/
*       /*                                                           */
*       /* NOW THAT WE ARE IN KEY ZERO THE DEB IS            @Y30LB35*/
*       /* ALTERED BY SETTING THE BEGIN DEB EXTENT           @Y30LB35*/
*       /* TO ALLOW ACCESS TO THE BEGINNING OF THE           @Y30LB35*/
*       /* VOLUME WHERE THE VOLUME LABEL IS LOCATED.         @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0856
*       DEBSTRCC=CYLZERO;           /*                       @Y30LB35*/
         L     @15,DEBDAPTR                                        0856
         MVC   DEBSTRCC(2,@15),CYLZERO                             0856
*       DEBSTRHH=TRKZERO;           /*                       @Y30LB35*/
*                                                                  0857
         L     @15,DEBDAPTR                                        0857
         MVC   DEBSTRHH(2,@15),TRKZERO                             0857
*       /*************************************************************/
*       /*                                                           */
*       /* NOW THAT THE DEB HAS BEEN MODIFIED,               @Y30LB35*/
*       /* THE MODESET PARMLIST IS INITIALIZE                @Y30LB35*/
*       /* ONCE AGAIN TO RETURN US TO THE                    @Y30LB35*/
*       /* PROBLEM PROGRAM KEY.                              @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0858
*       MODEPARM=''B;               /*                       @Y30LB35*/
         XC    MODEPARM(4),MODEPARM                                0858
*       MODEPARM=MOD2;              /*                       @Y30LB35*/
         L     @00,MOD2                                            0859
         ST    @00,MODEPARM                                        0859
*       REG3=MODEPARM;              /*                       @Y30LB35*/
*                                                                  0860
         L     REG3,MODEPARM                                       0860
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE MODESET IS ISSUED-PROB PROGARM KEY       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0861
*LMODE2:                                                           0861
*       DO;                         /* MODESET MF(E,REG3)            */
LMODE2   DS    0H                                                  0862
*         RESPECIFY                                                0862
*           GPR01F RESTRICTED;                                     0862
*         GPR01F=REG3;              /* MODESET PARMLIST              */
         LR    GPR01F,REG3                                         0863
*         SVC(107);                 /* ISSUE MODESET SVC             */
         SVC   107                                                 0864
*         RESPECIFY                                                0865
*          (GPR01F) UNRESTRICTED;                                  0865
*       END;                        /* MODESET MF(E,REG3)    @Y30LB35*/
*       RESPECIFY                                                  0867
*        (REG3,                                                    0867
*         REG1) UNRSTD;             /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*                                                                  0868
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO OPENPROC WITH                  @Y30LB35*/
*   /* THE RETURN CODE IN REGISTER 15 WHICH                  @Y30LB35*/
*   /* WILL BE 4 TO INDICATE ERROR OR 0 SUCCESSFUL.          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0869
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF00841 LH    @15,TESTRC                                          0869
         L     @14,@SA00008                                        0869
         LM    @00,@12,@SA00008+8                                  0869
         BR    @14                                                 0869
*   END OPNLAB;                     /*                       @Y30LB35*/
*                                                                  0871
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - OPNNEW                                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  ISSUES SVC 82 (DASDR SVC)                    @Y30LB35*/
*/*             TO PERFORM A PSEUDO OPEN                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     EXOUCB IN EXOAGL                             @Y30LB35*/
*/*             IOXDCB                                       @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DCBOFLWR IN IOXDCB                           @Y30LB35*/
*/*             SV82LIST                                     @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0871
*OPNNEW:                                                           0871
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0871
OPNNEW   STM   @14,@12,12(@13)                                     0871
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOON' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0872
*   OLDERID2=NEWERID2;                                             0872
         L     @03,@PC00001                                        0872
         L     @03,GDTTR2(,@03)                                    0872
         L     @15,@PC00001                                        0872
         L     @01,GDTTR2(,@15)                                    0872
         MVC   @TS00001(95),NEWERID2(@01)                          0872
         MVC   OLDERID2(95,@03),@TS00001                           0872
*   NEWID2='IOON';                  /*                       @Y30LB35*/
*                                                                  0873
         L     @03,@PC00001                                        0873
         L     @03,GDTTR2(,@03)                                    0873
         MVC   NEWID2(4,@03),@CC04211                              0873
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE SVC 82 INPUT PARMLIST IS                     @Y30LB35*/
*   /* INITIALIZED.                                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0874
*   SV82LIST=''B;                   /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        0874
         XC    SV82LIST(16,@03),SV82LIST(@03)                      0874
*   SV82CODE=SVC82OPN;              /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        0875
         MVC   SV82CODE(1,@03),SVC82OPN                            0875
*   SV82UCBP=EXOUCB;                /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        0876
         L     @15,@PC00001+8                                      0876
         MVC   SV82UCBP(3,@03),EXOUCB+1(@15)                       0876
*   SV82DCBP=ADDR(IOXDCB);          /*                       @Y30LB35*/
*                                                                  0877
         LA    @03,SVC82ARG                                        0877
         L     @01,IOCTLBKP                                        0877
         LA    @15,IOXDCB(,@01)                                    0877
         ST    @15,SV82DCBP(,@03)                                  0877
*   /*****************************************************************/
*   /*                                                               */
*   /* THE DCBOFLWR FLAG IS SET OFF JUST IN CASE             @Y30LB35*/
*   /* THE DCB IS CLOSED BY TERMINATION MANAGEMENT           @Y30LB35*/
*   /* FOR SOME REASON LIKE TIME OUT ABEND.                  @Y30LB35*/
*   /* THIS WILL KEEP THE CLOSE SVC FROM TRYING              @Y30LB35*/
*   /* TO WRITE AN END-OF-FILE MARK.                         @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0878
*   DCBOFLWR=OFF;                   /*                       @Y30LB35*/
         L     @03,DCBPTR                                          0878
         NI    DCBOFLWR+40(@03),B'01111111'                        0878
*   RESPECIFY                                                      0879
*     REG1 RESTRICTED;              /*                       @Y30LB35*/
*   REG1=ADDR(SV82LIST);            /*                       @Y30LB35*/
         LA    REG1,SVC82ARG                                       0880
*                                                                  0881
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THE SVC 82 (DASDR) IS ISSUED TO                   @Y30LB35*/
*   /* PERFORM A PSEUDO OPEN WHICH BUILDS                    @Y30LB35*/
*   /* THE DEB, CHAINS IT TO THE TCB DEB CHAIN,              @Y30LB35*/
*   /* AND INSERTS THE DEB INTO THE SYSTEM                   @Y30LB35*/
*   /* DEB TABLE.                                            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0881
*L82SVC1:                           /*                       @Y30LB35*/
*   SVC(82);                        /*                       @Y30LB35*/
L82SVC1  SVC   82                                                  0881
*   RESPECIFY                                                      0882
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/
*   TESTRC=0;                       /*                       @Y30LB35*/
*                                                                  0883
         SLR   @03,@03                                             0883
         STH   @03,TESTRC                                          0883
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO OPENPROC                       @Y30LB35*/
*   /* WITH A RETURN CODE ZERO AS CURRENTLY                  @Y30LB35*/
*   /* THERE A NO POSSIBLE ERRORS WHICH WILL                 @Y30LB35*/
*   /* NOT ABEND THE TASK.                                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0884
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
         LH    @15,TESTRC                                          0884
         L     @14,12(,@13)                                        0884
         LM    @00,@12,20(@13)                                     0884
         BR    @14                                                 0884
*   END OPNNEW;                     /*                       @Y30LB35*/
*                                                                  0886
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - BLDBLK                                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             INITIALIZE CONTROL BLOCKS TO PERFORM I/O     @Y30LB35*/
*/*             PROCESSING.  THIS IS DONE BY THE FOLLOWING   @Y30LB35*/
*/*             STEPS:                                       @Y30LB35*/
*/*             ISSUES UGSPACE, INITIALIZES THE IOXCTLBK     @Y30LB35*/
*/*             INITIALIZES THE IOXIOB, AND CALL READJFCB.   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THE ERROR MESSAGE IDC2371I IS ISSUED IF      @Y30LB35*/
*/*             THE UGSPACE IS UNSUCCESSFUL.                 @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     EXOLAB IN EXOAGL                             @Y30LB35*/
*/*             EXOTAB IN EXOAGL                             @Y30LB35*/
*/*             EXOPASS IN EXOAGL                            @Y30LB35*/
*/*             EXONEW IN EXOAGL                             @Y30LB35*/
*/*             USERDDN IN CALLER'S CORE                     @Y30LB35*/
*/*             IOXCTLBK                                     @Y30LB35*/
*/*             BLKSIZE                                      @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DCBDDNAM IN IOXDCB                           @Y30LB35*/
*/*             DCBEXLSA IN IOXDCB                           @Y30LB35*/
*/*             IOBCMDCH IN IOXIOB                           @Y30LB35*/
*/*             IOBECBPT IN IOXIOB                           @Y30LB35*/
*/*             IOBSTART IN IOXIOB                           @Y30LB35*/
*/*             IOBDCBPT IN IOXIOB                           @Y30LB35*/
*/*             USERIOBP IN CALLER'S CORE                    @Y30LB35*/
*/*             BLKSIZE                                      @Y30LB35*/
*/*             IOXCTLBK                                     @Y30LB35*/
*/*             IOBSTPTR                                     @Y30LB35*/
*/*             DCBPTR                                       @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN UGSPACE            @Y30LB35*/
*/*                           4, ERROR IN READJFCB           @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0886
*                                   /*                       @Y30LB35*/
*BLDBLK:                                                           0886
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0886
BLDBLK   STM   @14,@12,@SA00010                                    0886
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0887
*   DCL                                                            0887
*     BLKSIZE FIXED(31);            /*                       @Y30LB35
*                                      VARIABLE TO CALCULATE @Y30LB35
*                                      THE IOXCTLBK SIZE.    @Y30LB35*/
*   DCL                                                            0888
*     NEWCCWLN FIXED(15) INIT(1448) STATIC;/*                @Z40LB35
*                                      IF NEW VOLUME,        @Y30LB35
*                                      THIS WILL BE          @Y30LB35
*                                      SIZE OF THE CCWS      @Y30LB35*/
*   DCL                                                            0889
*     LABCCWLN FIXED(15) INIT(80) STATIC;/*                  @Z40LB35
*                                      IF VOLUME LABEL,      @Y30LB35
*                                      THIS WILL BE          @Y30LB35
*                                      SIZE OF THE CCWS      @Y30LB35*/
*   DCL                                                            0890
*     TABCCWLN FIXED(15) INIT(400) STATIC;/*                 @Z40LB35
*                                      IF TABLES,            @Y30LB35
*                                      THIS WILL BE          @Y30LB35
*                                      SIZE OF THE CCWS      @Y30LB35*/
*   DCL                                                            0891
*     VTOCCWLN FIXED(15) INIT(400) STATIC;/*                 @Z40LB35
*                                      IF VTOC,              @Z40LB35
*                                      THIS WILL BE          @Z40LB35
*                                      SIZE OF THE CCWS      @Z40LB35*/
*   DCL                                                            0892
*     RPRWCCLN FIXED(15) INIT(4000) STATIC;/*                @0Z11014
*                                      IF REPAIRV, THIS WILL @0Z11014
*                                      BE SIZE OF THE CCWS   @ZA11014*/
*   DCL                                                            0893
*     DCBEXCP GEND CHAR(LENGTH(IHADCB));/*                   @Y30LB35*/
*   DCL                                                            0894
*     DCBEXCP1 GEND CHAR(LENGTH(IHADCB)/*                    @ZA11014*/
*         +LENGTH(IHADCS28)         /*                       @ZA11014*/
*         +LENGTH(IHADCS44));       /*                       @ZA11014
*                                      BE SIZE OF THE CCWS   @ZA11014
*                                      ASSEM TO PLS          @Y30LB35
*                                      ADDRESSABILITY OF DCB @Y30LB35*/
*                                                                  0894
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CONSTANTS WILL BE PLACED IN             @Y30LB35*/
*   /* FRONT OF THE VARIOUS CONTROL BLOCKS TO                @Y30LB35*/
*   /* AID IN LOCATING THEM IN A DUMP.                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0895
*   DCL                                                            0895
*     IDIOX CHAR(8) CONSTANT('IOXCTLBK');/*                  @Y30LB35
*                                      ID FOR IOXCTLBK       @Y30LB35*/
*   DCL                                                            0896
*     IDIOXDCB CHAR(4) CONSTANT('DCB ');/*                   @Y30LB35
*                                      ID FOR DCB            @Y30LB35*/
*   DCL                                                            0897
*     IDIOXECB CHAR(4) CONSTANT('ECB ');/*                   @Y30LB35
*                                      ID FOR ECB            @Y30LB35*/
*   DCL                                                            0898
*     IDIOXIOB CHAR(4) CONSTANT('IOB ');/*                   @Y30LB35
*                                      ID FOR IOB            @Y30LB35*/
*   DCL                                                            0899
*     IDIOXEX CHAR(4) CONSTANT('XLST');/*                    @Y30LB35
*                                      ID FOR DCB EXT. LIST  @Y30LB35*/
*   DCL                                                            0900
*     IDJFCB CHAR(4) CONSTANT('JFCB');/*                     @Y30LB35
*                                      ID FOR JFCB           @Y30LB35*/
*   DCL                                                            0901
*     IDIOXCCW CHAR(4) CONSTANT('CCW ');/*                   @Y30LB35
*                                      ID FOR CCWS           @Y30LB35*/
*                                                                  0902
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOBB' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0902
*   OLDERID2=NEWERID2;                                             0902
         L     @03,@PC00001                                        0902
         L     @03,GDTTR2(,@03)                                    0902
         L     @15,@PC00001                                        0902
         L     @01,GDTTR2(,@15)                                    0902
         MVC   @TS00001(95),NEWERID2(@01)                          0902
         MVC   OLDERID2(95,@03),@TS00001                           0902
*   NEWID2='IOBB';                  /*                       @Y30LB35*/
*                                                                  0903
         L     @03,@PC00001                                        0903
         L     @03,GDTTR2(,@03)                                    0903
         MVC   NEWID2(4,@03),@CC04243                              0903
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CALLER WILL BE INITIALIZING                    @Y30LB35*/
*   /* A NEW VOLUME, IOXCTLBK SIZE WILL BE AS                @Y30LB35*/
*   /* FOLLOWS.                                              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0904
*   IF EXONEW=ON                    /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  0904
         L     @03,@PC00001+8                                      0904
         TM    EXONEW(@03),B'00010000'                             0904
         BNO   @RF00904                                            0904
*     /***************************************************************/
*     /*                                                             */
*     /* BLOCKSIZE WILL BE THE BASIC STRUCTURE               @Y30LB35*/
*     /* PLUS THE CCWS FOR WRITING COUNT KEY DATA            @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0905
*     BLKSIZE=LENGTH(IOCTLBK)+NEWCCWLN;/*                    @Y30LB35*/
         LA    @03,384                                             0905
         AH    @03,NEWCCWLN                                        0905
         ST    @03,BLKSIZE                                         0905
*   ELSE                            /*                       @ZA11014*/
*                                                                  0906
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE CALLER WILL ONLY OPEN                        @ZA11014*/
*     /* FOR REPAIRV PROCESSING, THE STORAGE                 @ZA11014*/
*     /* OBTAINED FOR THE CCWS WILL BE LARGE                 @ZA11014*/
*     /* ENOUGH FOR THE READ CCWS, THE WRITE CCWS, AND       @ZA11014*/
*     /* THE VERIFY READ CCWS                                @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0906
*     IF EXOREP=ON                  /*                       @ZA11014*/
*       THEN                        /*                       @ZA11014*/
*                                                                  0906
         B     @RC00904                                            0906
@RF00904 L     @03,@PC00001+8                                      0906
         TM    EXOREP(@03),B'00000100'                             0906
         BNO   @RF00906                                            0906
*       /*************************************************************/
*       /*                                                           */
*       /* BLOCKSIZE WILL ONLY BE THE BASIC STRUCTURE        @ZA11014*/
*       /* PLUS THE CCWS FOR READING AND WRITING             @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0907
*       BLKSIZE=LENGTH(IOCTLBK)+RPRWCCLN;/*                  @ZA11014*/
         LA    @03,384                                             0907
         AH    @03,RPRWCCLN                                        0907
         ST    @03,BLKSIZE                                         0907
*     ELSE                          /*                       @Y30LB35*/
*                                                                  0908
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CALLER WILL BE PROCESSING THE VOLUME       @Y30LB35*/
*       /* LABEL, THE IOXCTLBK SIZE WILL BE AS FOLLOWS.      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0908
*       IF EXOLAB=ON                /*                       @Y30LB35*/
*         THEN                      /*                       @Y30LB35*/
*                                                                  0908
         B     @RC00906                                            0908
@RF00906 L     @03,@PC00001+8                                      0908
         TM    EXOLAB(@03),B'01000000'                             0908
         BNO   @RF00908                                            0908
*         /***********************************************************/
*         /*                                                         */
*         /* BLOCKSIZE WILL BE THE BASIC STRUCTURE           @Y30LB35*/
*         /* PLUS THE CCWS FOR WRITING KEY AND DATA          @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0909
*         BLKSIZE=LENGTH(IOCTLBK)+LABCCWLN;/*                @Y30LB35*/
         LA    @03,384                                             0909
         AH    @03,LABCCWLN                                        0909
         ST    @03,BLKSIZE                                         0909
*       ELSE                        /*                       @Y30LB35*/
*                                                                  0910
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE CALLER WILL BE PROCESSING THE MSS        @Y30LB35*/
*         /* TABLES, THE IOXCTLBK SIZE WILL BE AS FOLLOWS.   @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0910
*         IF EXOTAB=ON              /*                       @Y30LB35*/
*           THEN                    /*                       @Y30LB35*/
*                                                                  0910
         B     @RC00908                                            0910
@RF00908 L     @03,@PC00001+8                                      0910
         TM    EXOTAB(@03),B'10000000'                             0910
         BNO   @RF00910                                            0910
*           /*********************************************************/
*           /*                                                       */
*           /* BLOCKSIZE WILL BE THE BASIC STRUCTURE         @Y30LB35*/
*           /* PLUS THE CCWS FOR READING KEY AND DATA        @Y30LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0911
*           BLKSIZE=LENGTH(IOCTLBK)+TABCCWLN;/*              @Y30LB35*/
         LA    @03,384                                             0911
         AH    @03,TABCCWLN                                        0911
         ST    @03,BLKSIZE                                         0911
*         ELSE                      /*                       @Z40LB35*/
*                                                                  0912
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE CALLER WILL BE PROCESSING THE VTOC,    @Z40LB35*/
*           /* THE IOXCTLBK SIZE WILL BE AS FOLLOWS.         @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0912
*           IF EXOVTOC=ON           /*                       @Z40LB35*/
*             THEN                  /*                       @Z40LB35*/
*                                                                  0912
         B     @RC00910                                            0912
@RF00910 L     @03,@PC00001+8                                      0912
         TM    EXOVTOC(@03),B'00001000'                            0912
         BNO   @RF00912                                            0912
*             /*******************************************************/
*             /*                                                     */
*             /* BLOCKSIZE WILL BE THE BASIC STRUCTURE       @Z40LB35*/
*             /* PLUS THE CCWS FOR READING KEY AND DATA      @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0913
*             BLKSIZE=LENGTH(IOCTLBK)+VTOCCWLN;/*            @Z40LB35*/
         LA    @03,384                                             0913
         AH    @03,VTOCCWLN                                        0913
         ST    @03,BLKSIZE                                         0913
*           ELSE                    /*                       @Z40LB35*/
*                                                                  0914
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE CALLER WILL ONLY OPEN THE            @Y30LB35*/
*             /* DATA SET TO DETERMINE IF THE OPERATOR       @Y30LB35*/
*             /* CAN SUPPLY THE CORRECT PASSWORD, THEN       @Y30LB35*/
*             /* THERE WILL NOT BE ANY STORAGE OBTAINED      @Y30LB35*/
*             /* FOR THE CCW STRING.                         @Y30LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0914
*             IF EXOPASS=ON         /*                       @Z40LB35*/
*               THEN                /*                       @Z40LB35*/
*                                                                  0914
         B     @RC00912                                            0914
@RF00912 L     @03,@PC00001+8                                      0914
         TM    EXOPASS(@03),B'00100000'                            0914
         BNO   @RF00914                                            0914
*               /*****************************************************/
*               /*                                                   */
*               /* BLOCKSIZE WILL ONLY BE THE SIZE OF THE    @Y30LB35*/
*               /* IOXCTLBK BASIC STRUCTURE.                 @Y30LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0915
*               BLKSIZE=LENGTH(IOCTLBK)+8;/*                 @ZA16127*/
         MVC   BLKSIZE(4),@CF04409                                 0915
*             ELSE                  /*                       @Z40LB35*/
*                                                                  0916
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE TESTS ARE NEGITIVE AS TO WHICH     @Y30LB35*/
*               /* TYPE I/O PROCESSING IS DESIRED, THEN THERE        */
*               /*                                           @Y30LB35*/
*               /* IS A BAD PARM LIST AND UABORT(40) IS ISSUED.      */
*               /*                                           @Y30LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0916
*               DO;                                                0916
         B     @RC00914                                            0916
@RF00914 DS    0H                                                  0917
*                 RESPECIFY                                        0917
*                  (REG13,                                         0917
*                   REG14,                                         0917
*                   REG15) RSTD;                                   0917
*                 REG15=40;                                        0918
         LA    REG15,40                                            0918
*                 REG14=GDTABT;                                    0919
         L     @03,@PC00001                                        0919
         L     REG14,GDTABT(,@03)                                  0919
*                 REG13=GDTABH;                                    0920
         L     @03,@PC00001                                        0920
         L     REG13,GDTABH(,@03)                                  0920
*                 GEN(BR    REG14);                                0921
         BR    REG14
*                 RESPECIFY                                        0922
*                  (REG13,                                         0922
*                   REG14,                                         0922
*                   REG15) UNRSTD;                                 0922
*               END;                /*                       @Z40LB35*/
*                                                                  0923
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CORE IS GETTEN FOR THE IOXCTLBK.                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0924
*   CALL IDCSAGS0(GDTTBL,BLKSIZE,IOCTLBKP,SETZERO);/*        @Y30LB35*/
@RC00914 DS    0H                                                  0924
@RC00912 DS    0H                                                  0924
@RC00910 DS    0H                                                  0924
@RC00908 DS    0H                                                  0924
@RC00906 DS    0H                                                  0924
@RC00904 L     @03,@PC00001                                        0924
         ST    @03,@AL00001                                        0924
         LA    @03,BLKSIZE                                         0924
         ST    @03,@AL00001+4                                      0924
         LA    @03,IOCTLBKP                                        0924
         ST    @03,@AL00001+8                                      0924
         LA    @03,SETZERO                                         0924
         ST    @03,@AL00001+12                                     0924
         MVI   @AL00001+12,X'80'                                   0924
         L     @03,@PC00001                                        0924
         L     @15,GDTGSP(,@03)                                    0924
         LA    @01,@AL00001                                        0924
         BALR  @14,@15                                             0924
*   RESPECIFY                                                      0925
*     RTNREG RSTD;                                                 0925
*   TESTRC=RTNREG;                                                 0926
         STH   RTNREG,TESTRC                                       0926
*   RESPECIFY                                                      0927
*     RTNREG UNRSTD;                /*                       @Y30LB35*/
*                                                                  0928
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE UGSPACE WAS SUCCESSFUL, THE             @Y30LB35*/
*   /* IOXCTLBK IS INITIALIZED HERE.                         @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0928
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         LH    @03,TESTRC                                          0928
         LTR   @03,@03                                             0928
         BNZ   @RF00928                                            0928
*     DO;                           /*                       @Y30LB35*/
*                                                                  0929
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE CONTROL BLOCK CHARACTER                  @Y30LB35*/
*       /* IDENTIFICATIONS ARE MOVED INTO IOXCTLBK           @Y30LB35*/
*       /* SO THAT THEY WILL IMMEDIATLY PRECEDE EACH         @Y30LB35*/
*       /* CONTROL BLOCK. THIS IS BEING DONE SO THAT         @Y30LB35*/
*       /* WHEN A DUMP IS BEING READ EACH CONTROL BLOCK      @Y30LB35*/
*       /* CAN BE FOUND.                                     @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0930
*       IOXID=IDIOX;                /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0930
         MVC   IOXID(8,@03),@CC04230                               0930
*       IOXDCBID=IDIOXDCB;          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0931
         MVC   IOXDCBID(4,@03),@CC04232                            0931
*       IOXECBID=IDIOXECB;          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0932
         MVC   IOXECBID(4,@03),@CC04234                            0932
*       IOXIOBID=IDIOXIOB;          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0933
         MVC   IOXIOBID(4,@03),@CC04236                            0933
*       IOXEXID=IDIOXEX;            /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0934
         MVC   IOXEXID(4,@03),@CC04238                             0934
*       IOXJFCBI=IDJFCB;            /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0935
         MVC   IOXJFCBI(4,@03),@CC04240                            0935
*       IOXCCWID=IDIOXCCW;          /*                       @Y30LB35*/
*                                                                  0936
         L     @03,IOCTLBKP                                        0936
         MVC   IOXCCWID(4,@03),@CC04242                            0936
*       /*************************************************************/
*       /*                                                           */
*       /* THE MODEL DCB IS MOVED INTO IT PLACE IN THE       @Y30LB35*/
*       /* IOXCTLBK                                          @Y30LB35*/
*       /* FOR REPAIRV PROCESSING A DCB WITH THE             @ZA11014*/
*       /* ABNORMAL END APPENDAGE ADDITION IS MOVED IN       @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0937
*       IF EXOREP=ON                /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
         L     @03,@PC00001+8                                      0937
         TM    EXOREP(@03),B'00000100'                             0937
         BNO   @RF00937                                            0937
*         IOXDCB=DCBEXCP1;          /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        0938
         MVC   IOXDCB(72,@03),DCBEXCP1                             0938
*       ELSE                        /*                       @ZA11014*/
*         IOXDCB=DCBEXCP;           /*                       @ZA11014*/
*                                                                  0939
         B     @RC00937                                            0939
@RF00937 L     @03,IOCTLBKP                                        0939
         MVI   IOXDCB+52(@03),C' '                                 0939
         MVC   IOXDCB+53(19,@03),IOXDCB+52(@03)                    0939
         MVC   IOXDCB(52,@03),DCBEXCP                              0939
*       /*************************************************************/
*       /*                                                           */
*       /* THE DCB EXTENT LIST USED IN OPEN AND CLOSE        @Y30LB35*/
*       /* IS MOVED INTO THE IOXCTLBK.                       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0940
*       IOXEXLST=EXLIST;            /*                       @Y30LB35*/
@RC00937 L     @03,IOCTLBKP                                        0940
         MVC   IOXEXLST(8,@03),EXLIST                              0940
*                                                                  0941
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE UCB ADDRESS IS MOVED INTO THE            @Y30LB35*/
*       /* IOXCTLBK                                          @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0941
*       IOXUCBP=EXOUCB;             /*                       @Y30LB35*/
*                                                                  0941
         L     @03,@PC00001+8                                      0941
         L     @03,EXOUCB(,@03)                                    0941
         L     @01,IOCTLBKP                                        0941
         ST    @03,IOXUCBP(,@01)                                   0941
*       /*************************************************************/
*       /*                                                           */
*       /* THE POINTER IS STORED INTO CALLER'S CORE          @Y30LB35*/
*       /* TO BE PASSED BACK ON SUBSEQUENT CALLS.            @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0942
*       USERIOBP=IOCTLBKP;          /*                       @Y30LB35*/
*                                                                  0942
         L     @03,@PC00001+8                                      0942
         L     @03,EXOCTLBK(,@03)                                  0942
         L     @15,IOCTLBKP                                        0942
         ST    @15,USERIOBP(,@03)                                  0942
*       /*************************************************************/
*       /*                                                           */
*       /* ADDRESSABILITY IS SET UP FOR DCB AND DCB          @Y30LB35*/
*       /* EXTENT LIST                                       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0943
*       DCBPTR=ADDR(IOXDCB);        /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0943
         LA    @03,IOXDCB(,@03)                                    0943
         ST    @03,DCBPTR                                          0943
*       DCBEXLSA=ADDR(IOXEXLST);    /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0944
         LA    @03,IOXEXLST(,@03)                                  0944
         L     @01,DCBPTR                                          0944
         STCM  @03,7,DCBEXLSA+28(@01)                              0944
*                                                                  0945
*       /*************************************************************/
*       /*                                                           */
*       /* IF CALLER HAS PASSED THE DDNAME, IT IS            @Y30LB35*/
*       /* MOVED INTO THE DCB AND IOXCTLBK.                  @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0945
*       IF EXODDN^=NULLPTR THEN     /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0945
         L     @03,EXODDN(,@03)                                    0945
         LTR   @03,@03                                             0945
         BZ    @RF00945                                            0945
*         DO;                       /*                       @Y30LB35*/
*           DCBDDNAM=USERDDN;       /*                       @Y30LB35*/
         L     @03,DCBPTR                                          0947
         L     @15,@PC00001+8                                      0947
         L     @01,EXODDN(,@15)                                    0947
         MVC   DCBDDNAM+40(8,@03),USERDDN(@01)                     0947
*           IOXDDN=USERDDN;         /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0948
         L     @15,@PC00001+8                                      0948
         L     @01,EXODDN(,@15)                                    0948
         MVC   IOXDDN(8,@03),USERDDN(@01)                          0948
*         END;                      /*                       @Y30LB35*/
*       ELSE                        /*                       @Y30LB35*/
*                                                                  0950
*         /***********************************************************/
*         /*                                                         */
*         /* THE DDNAME IS REQUIRED; THEREFORE,              @Y30LB35*/
*         /* THE UABORT(40) IS ISSUED IF                     @Y30LB35*/
*         /* CALLER FORGOT TO PASS IT.                       @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0950
*         DO;                                                      0950
         B     @RC00945                                            0950
@RF00945 DS    0H                                                  0951
*           RESPECIFY                                              0951
*            (REG13,                                               0951
*             REG14,                                               0951
*             REG15) RSTD;                                         0951
*           REG15=40;                                              0952
         LA    REG15,40                                            0952
*           REG14=GDTABT;                                          0953
         L     @03,@PC00001                                        0953
         L     REG14,GDTABT(,@03)                                  0953
*           REG13=GDTABH;                                          0954
         L     @03,@PC00001                                        0954
         L     REG13,GDTABH(,@03)                                  0954
*           GEN(BR    REG14);                                      0955
         BR    REG14
*           RESPECIFY                                              0956
*            (REG13,                                               0956
*             REG14,                                               0956
*             REG15) UNRSTD;                                       0956
*         END;                      /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*                                                                  0958
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE FROM UGSPACE IS                    @Y30LB35*/
*   /* NOT ZERO THEN THE MESSAGE "IDC2371I                   @Y30LB35*/
*   /* UNABLE TO OBTAIN CORE FOR I/O PROCESSING"             @Y30LB35*/
*   /* IS SENT TO THE SYSPRINT LISTING.                      @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0959
*   ELSE                            /*                       @Y30LB35*/
*     DO;                           /*                       @Y30LB35*/
*                                                                  0959
         B     @RC00928                                            0959
@RF00928 DS    0H                                                  0960
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE DARGLIST TO SEND TO UPRINT.        @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0960
*       DARGLIST=''B;               /*                       @Y30LB35*/
         L     @03,DDSTRU                                          0960
         XC    DARGLIST(20,@03),DARGLIST(@03)                      0960
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          0961
         MVC   DARGSMOD(3,@03),@CC03785                            0961
*       DARGSENT=MSG2371I;          /*                       @Y30LB35*/
*                                                                  0962
         L     @03,DDSTRU                                          0962
         MVI   DARGSENT(@03),X'02'                                 0962
*       /*************************************************************/
*       /*                                                           */
*       /* CALL UPRINT TO ISSUED ERROR MESSAGE.              @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0963
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/
         L     @03,@PC00001                                        0963
         ST    @03,@AL00001                                        0963
         LA    @03,@CF00119                                        0963
         ST    @03,@AL00001+4                                      0963
         LA    @03,DDSTRU                                          0963
         ST    @03,@AL00001+8                                      0963
         MVI   @AL00001+8,X'80'                                    0963
         L     @03,@PC00001                                        0963
         L     @15,GDTPRT(,@03)                                    0963
         LA    @01,@AL00001                                        0963
         BALR  @14,@15                                             0963
*     END;                          /*                       @Y30LB35*/
*                                                                  0965
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE A TEST WILL BE MADE TO DETERMINE                 @Y30LB35*/
*   /* IF THE IOB CAN BE INITIALIZED.                        @Y30LB35*/
*   /* THE IOB IS NOT REQUIRED FOR PASSWORD                  @Y30LB35*/
*   /* PROCESSING AND IS NOT INITIALIZED.                    @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*   IF TESTRC=0&EXOPASS^=ON         /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RC00928 LH    @03,TESTRC                                          0965
         LTR   @03,@03                                             0965
         BNZ   @RF00965                                            0965
         L     @03,@PC00001+8                                      0965
         TM    EXOPASS(@03),B'00100000'                            0965
         BO    @RF00965                                            0965
*     DO;                           /*                       @Y30LB35*/
*                                                                  0966
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZATION OF THE IOB                         @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0967
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @Y30LB35*/
*                                                                  0967
         L     @03,IOCTLBKP                                        0967
         LA    @03,IOXIOB(,@03)                                    0967
         ST    @03,IOBSTPTR                                        0967
*       /*************************************************************/
*       /*                                                           */
*       /* SET CCW COMMAND CHAINING BIT ON                   @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0968
*       IOBCMDCH=ON;                /*                       @Y30LB35*/
*                                                                  0968
         L     @03,IOBSTPTR                                        0968
         OI    IOBCMDCH(@03),B'01000000'                           0968
*       /*************************************************************/
*       /*                                                           */
*       /* ADDRESSABILITY TO ECB, CCWS STRING, AND DCB       @Y30LB35*/
*       /* IS SET UP.                                        @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0969
*       IOBECBPT=ADDR(IOXECB);      /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0969
         LA    @03,IOXECB(,@03)                                    0969
         L     @01,IOBSTPTR                                        0969
         ST    @03,IOBECBPT(,@01)                                  0969
*       IOBSTART=ADDR(IOXCCWS);     /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0970
         LA    @03,IOXCCWS(,@03)                                   0970
         L     @01,IOBSTPTR                                        0970
         ST    @03,IOBSTART(,@01)                                  0970
*       IOBDCBPT=ADDR(IOXDCB);      /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0971
         LA    @03,IOXDCB(,@03)                                    0971
         L     @01,IOBSTPTR                                        0971
         ST    @03,IOBDCBPT(,@01)                                  0971
*     END;                          /*                       @Y30LB35*/
*                                                                  0973
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE PROCESS TO HERE WAS SUCCESSFUL,                @Y30LB35*/
*   /* READJFCB PROC IS CALLED TO OBTAIN THE JFCB.           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0973
*   IF TESTRC=0                     /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RF00965 LH    @03,TESTRC                                          0973
         LTR   @03,@03                                             0973
         BNZ   @RF00973                                            0973
*     DO;                           /*                       @Y30LB35*/
*       CALL READJFCB;              /*                       @Y30LB35*/
         BAL   @14,READJFCB                                        0975
*       RESPECIFY                                                  0976
*         RTNREG RSTD;                                             0976
*       TESTRC=RTNREG;                                             0977
         STH   RTNREG,TESTRC                                       0977
*       RESPECIFY                                                  0978
*         RTNREG UNRSTD;            /*                       @Y30LB35*/
*     END;                          /*                       @Y30LB35*/
*                                                                  0979
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO OPENPROC WITH                  @Y30LB35*/
*   /* A RETURN CODE OF 0 SUCCESSFUL OR 4 ERROR.             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0980
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF00973 LH    @15,TESTRC                                          0980
         L     @14,@SA00010                                        0980
         LM    @00,@12,@SA00010+8                                  0980
         BR    @14                                                 0980
*   END BLDBLK;                     /*                       @Y30LB35*/
*                                                                  0982
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - BLDCCWP1                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             BUILD CCW'S TO WRITE "COUNT KEY DATA"        @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     USERCCHH IN CALLER'S CORE                    @Y30LB35*/
*/*             EXPCCHHR IN EXPAGL                           @Y30LB35*/
*/*             EXPDAYLN(X) IN EXPDATAB                      @Y30LB35*/
*/*             EXPKEYLN(X) IN EXPDATAB                      @Y30LB35*/
*/*             EXPDATAL(X) IN EXPDATAB                      @Y30LB35*/
*/*             EXPRECNO IN EXPDATAB                         @Y30LB35*/
*/*             CCWSIDEQ                                     @Y30LB35*/
*/*             CCWTIC                                       @Y30LB35*/
*/*             CCWWCKD                                      @Y30LB35*/
*/*             CCWDATA                                      @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXCCW(X) IN IOXCTLBK                        @Y30LB35*/
*/*             CNTCCHHR IN IOXCTLBK                         @Y30LB35*/
*/*             CNTRECNO IN IOXCTLBK                         @Y30LB35*/
*/*             CNTKEYLN IN IOXCTLBK                         @Y30LB35*/
*/*             CNTDATLN IN IOXCTLBK                         @Y30LB35*/
*/*             WRITECNT IN IOXCTLBK                         @Y30LB35*/
*/*             READCNTA IN IOXCTLBK                         @ZA11014*/
*/*             IOBSEEK  IN IOXIOB                           @Y30LB35*/
*/*             CCWCMDCH IN IOXCCW                           @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  0982
*                                   /*                       @Y30LB35*/
*BLDCCWP1:                                                         0982
*   PROC;                           /*                       @Y30LB35*/
*                                                                  0982
BLDCCWP1 STM   @14,@12,12(@13)                                     0982
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOP1' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0983
*   OLDERID2=NEWERID2;                                             0983
         L     @03,@PC00001                                        0983
         L     @03,GDTTR2(,@03)                                    0983
         L     @15,@PC00001                                        0983
         L     @01,GDTTR2(,@15)                                    0983
         MVC   @TS00001(95),NEWERID2(@01)                          0983
         MVC   OLDERID2(95,@03),@TS00001                           0983
*   NEWID2='IOP1';                  /*                       @Y30LB35*/
*                                                                  0984
         L     @03,@PC00001                                        0984
         L     @03,GDTTR2(,@03)                                    0984
         MVC   NEWID2(4,@03),@CC04248                              0984
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE STARTS THE INITIALIZATION OF THE CCWS            @Y30LB35*/
*   /* THE FIRST THING DONE IS THE MODEL CCW                 @Y30LB35*/
*   /* SEARCH I.D. EQUAL IS MOVE INTO CCWS                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0985
*   IOXCCW(1)=CCWSIDEQ;             /*                       @Y30LB35*/
*                                                                  0985
         L     @03,IOCTLBKP                                        0985
         MVC   IOXCCW(8,@03),CCWSIDEQ                              0985
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CCW ARRAY COUNTER TO THE 1ST CCW           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0986
*   CCWCNT=1;                       /*                       @Y30LB35*/
*                                                                  0986
         MVC   CCWCNT(2),@CH00222                                  0986
*   /*****************************************************************/
*   /*                                                               */
*   /* THE NEXT FIVE INSTRUCTIONS INITIALIZES THE            @Y30LB35*/
*   /* SEARCH AND IOBSEEK CCHHR VALUE.                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0987
*   USERCHRP=EXPCCHHR;              /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      0987
         L     @03,EXPCCHHR(,@03)                                  0987
         ST    @03,USERCHRP                                        0987
*   TEMPCCHH=''B;                   /*                       @Y30LB35*/
         XC    TEMPCCHH(8),TEMPCCHH                                0988
*   TEMPCHR=USERCCHH;               /*                       @Y30LB35*/
         L     @03,USERCHRP                                        0989
         MVC   TEMPCHR(5),USERCCHH(@03)                            0989
*   IOBSEEK=TEMPCCHH;               /*                       @Y30LB35*/
         L     @03,IOBSTPTR                                        0990
         MVC   IOBSEEK(8,@03),TEMPCCHH                             0990
*   CCWADDR=ADDR(IOBCC);            /*                       @Y30LB35*/
*                                                                  0991
         LH    @03,CCWCNT                                          0991
         SLA   @03,3                                               0991
         L     @01,IOCTLBKP                                        0991
         LA    @03,IOXCCW-8(@03,@01)                               0991
         L     @01,IOBSTPTR                                        0991
         LA    @15,IOBCC(,@01)                                     0991
         STCM  @15,7,CCWADDR(@03)                                  0991
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE SECOND CCW IS INITIALIZED WITH               @Y30LB35*/
*   /* THE TRANSFER IN CHANNEL (TIC) CCW.                    @Y30LB35*/
*   /* THIS WILL ALLOW THE CHANNEL TO LOOP                   @Y30LB35*/
*   /* UNTIL IT FINDS THE CCHHR IN THE SEARCH.               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0992
*   IOXCCW(2)=CCWTIC;               /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        0992
         MVC   IOXCCW+8(8,@03),CCWTIC                              0992
*   CCWCNT=2;                       /*                       @Y30LB35*/
         MVC   CCWCNT(2),@CH00036                                  0993
*   CCWADDR=ADDR(IOXCCW(1));        /*                       @Y30LB35*/
*                                                                  0994
         LH    @03,CCWCNT                                          0994
         SLA   @03,3                                               0994
         L     @01,IOCTLBKP                                        0994
         LA    @03,IOXCCW-8(@03,@01)                               0994
         L     @01,IOCTLBKP                                        0994
         LA    @15,IOXCCW(,@01)                                    0994
         STCM  @15,7,CCWADDR(@03)                                  0994
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CCW READ AND CCW WRITE COUNTER ARE                @Y30LB35*/
*   /* INITIALIZED TO ZERO.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0995
*   WRITECNT=ZERO;                  /*                       @Y30LB35*/
         LH    @03,ZERO                                            0995
         STH   @03,WRITECNT                                        0995
*   READCNTA=ZERO;                  /*                       @ZA11014*/
*                                                                  0996
         LH    @03,ZERO                                            0996
         STH   @03,READCNTA                                        0996
*   /*****************************************************************/
*   /*                                                               */
*   /* THE LASTCCW IS CALCULATED AND USED TO                 @Y30LB35*/
*   /* CONTROL THE LOOP USED TO BUILD THE                    @Y30LB35*/
*   /* WRITE COUNT KEY AND DATA CCWS FOR                     @Y30LB35*/
*   /* ALL THE NEW RECORDS BEING WRITTEN.                    @Y30LB35*/
*   /* ALSO DONE IS THE INITIALIZATION OF                    @Y30LB35*/
*   /* COUNTER VARIABLE USED THE REFERENCE                   @Y30LB35*/
*   /* EXPARRAY.                                             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0997
*   LASTCCW=(EXPRECNO*TWOCCWS)+TWOCCWS;/*                    @Y30LB35*/
         L     @03,@PC00001+8                                      0997
         L     @03,EXPDATA(,@03)                                   0997
         L     @03,EXPRECNO(,@03)                                  0997
         MH    @03,TWOCCWS                                         0997
         AH    @03,TWOCCWS                                         0997
         STH   @03,LASTCCW                                         0997
*   ARRINDEX=1;                     /*                       @Y30LB35*/
         MVC   ARRINDEX(2),@CH00222                                0998
*                                                                  0999
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE LOOPING WILL BE PERFORMED WHILE                  @Y30LB35*/
*   /* THE WRITE COUNT KEY AND DATA CCWS ARE BUILT.          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0999
*   DO CCWCNT=THREECCW BY TWOCCWS WHILE CCWCNT<=LASTCCW;           0999
*                                                                  0999
         LH    @03,THREECCW                                        0999
         STH   @03,CCWCNT                                          0999
         B     @DE00999                                            0999
@DL00999 DS    0H                                                  1000
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE IN MODEL WRITE COUNT KEY AND DATA CCW          @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1000
*     IOXCCW(CCWCNT)=CCWWCKD;       /*                       @Y30LB35*/
*                                                                  1000
         LH    @03,CCWCNT                                          1000
         SLA   @03,3                                               1000
         L     @01,IOCTLBKP                                        1000
         ALR   @01,@03                                             1000
         MVC   IOXCCW-8(8,@01),CCWWCKD                             1000
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT CCW WRITE COUNT BY 1.                     @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1001
*     WRITECNT=WRITECNT+1;          /*                       @Y30LB35*/
*                                                                  1001
         LH    @03,WRITECNT                                        1001
         LA    @03,1(,@03)                                         1001
         STH   @03,WRITECNT                                        1001
*     /***************************************************************/
*     /*                                                             */
*     /* FILL IN THE ADDR & LENGTH OF COUNT INTO             @Y30LB35*/
*     /* THE CCW.                                            @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1002
*     CCWADDR=ADDR(COUNT);          /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1002
         SLA   @03,3                                               1002
         L     @01,IOCTLBKP                                        1002
         LA    @03,IOXCCW-8(@03,@01)                               1002
         LH    @15,ARRINDEX                                        1002
         SLA   @15,3                                               1002
         L     @01,IOCTLBKP                                        1002
         LA    @15,IOXCOUNT-8(@15,@01)                             1002
         STCM  @15,7,CCWADDR(@03)                                  1002
*     CCWDATLN=LENGTH(COUNT);       /*                       @Y30LB35*/
*                                                                  1003
         LH    @03,CCWCNT                                          1003
         SLA   @03,3                                               1003
         L     @01,IOCTLBKP                                        1003
         LA    @03,IOXCCW-8(@03,@01)                               1003
         MVC   CCWDATLN(2,@03),@CH00038                            1003
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE THE COUNT FIELD.                         @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1004
*     COUNT=CCWDATA;                /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1004
         SLA   @03,3                                               1004
         L     @01,IOCTLBKP                                        1004
         LA    @03,IOXCOUNT-8(@03,@01)                             1004
         MVC   COUNT(8,@03),CCWDATA                                1004
*     CNTCCHHR=TEMPCHR;             /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1005
         SLA   @03,3                                               1005
         L     @01,IOCTLBKP                                        1005
         LA    @03,IOXCOUNT-8(@03,@01)                             1005
         MVC   CNTCCHHR(5,@03),TEMPCHR                             1005
*     CNTRECNO=ARRINDEX;            /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1006
         SLA   @03,3                                               1006
         L     @01,IOCTLBKP                                        1006
         LA    @03,IOXCOUNT-8(@03,@01)                             1006
         LH    @15,ARRINDEX                                        1006
         STC   @15,CNTRECNO(,@03)                                  1006
*     CNTKEYLN=EXPKEYLN(ARRINDEX);  /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1007
         SLA   @03,3                                               1007
         L     @01,IOCTLBKP                                        1007
         LA    @03,IOXCOUNT-8(@03,@01)                             1007
         LH    @15,ARRINDEX                                        1007
         SLA   @15,3                                               1007
         L     @14,@PC00001+8                                      1007
         L     @01,EXPDATA(,@14)                                   1007
         SLR   @14,@14                                             1007
         IC    @14,EXPKEYLN-8(@15,@01)                             1007
         STC   @14,CNTKEYLN(,@03)                                  1007
*     CNTDATLN=EXPDATAL(ARRINDEX);  /*                       @Y30LB35*/
*                                                                  1008
         LH    @03,ARRINDEX                                        1008
         SLA   @03,3                                               1008
         L     @01,IOCTLBKP                                        1008
         LA    @03,IOXCOUNT-8(@03,@01)                             1008
         LH    @15,ARRINDEX                                        1008
         SLA   @15,3                                               1008
         L     @14,@PC00001+8                                      1008
         L     @01,EXPDATA(,@14)                                   1008
         LH    @15,EXPDATAL-8(@15,@01)                             1008
         STH   @15,CNTDATLN(,@03)                                  1008
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT TO USER NEXT EXPARRAY ITEM.               @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1009
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1009
         LA    @03,1(,@03)                                         1009
         STH   @03,ARRINDEX                                        1009
*   END;                            /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1010
         AH    @03,TWOCCWS                                         1010
         STH   @03,CCWCNT                                          1010
@DE00999 LH    @03,CCWCNT                                          1010
         CH    @03,LASTCCW                                         1010
         BNH   @DL00999                                            1010
*                                                                  1011
*   /*****************************************************************/
*   /*                                                               */
*   /* REINITIALIZE THE ARRINDEX VALUE TO THE                @Y30LB35*/
*   /* FIRST EXPARRAY ITEM.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1011
*   ARRINDEX=1;                     /*                       @Y30LB35*/
*                                                                  1011
         MVC   ARRINDEX(2),@CH00222                                1011
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE WE GO BACK AND SET UP                            @Y30LB35*/
*   /* THE DATA CCW FOR EVERY WRITE CCW                      @Y30LB35*/
*   /* THAT WAS INITIALIZED IN THE PRIOR LOOP.               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1012
*   DO CCWCNT=FOURCCWS BY TWOCCWS WHILE CCWCNT<=LASTCCW;           1012
*                                                                  1012
         LH    @03,FOURCCWS                                        1012
         STH   @03,CCWCNT                                          1012
         B     @DE01012                                            1012
@DL01012 DS    0H                                                  1013
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE IN THE MODEL DATA CCW                          @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1013
*     IOXCCW(CCWCNT)=CCWDATA;       /*                       @Y30LB35*/
*                                                                  1013
         LH    @03,CCWCNT                                          1013
         SLA   @03,3                                               1013
         L     @01,IOCTLBKP                                        1013
         ALR   @01,@03                                             1013
         MVC   IOXCCW-8(8,@01),CCWDATA                             1013
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE THE DATA CCW                             @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1014
*     CCWADDR=EXPDATAP(ARRINDEX);   /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1014
         SLA   @03,3                                               1014
         L     @01,IOCTLBKP                                        1014
         LA    @03,IOXCCW-8(@03,@01)                               1014
         LH    @15,ARRINDEX                                        1014
         SLA   @15,3                                               1014
         L     @14,@PC00001+8                                      1014
         L     @01,EXPDATA(,@14)                                   1014
         AL    @01,@CF04420                                        1014
         L     @15,EXPDATAP-4(@15,@01)                             1014
         STCM  @15,7,CCWADDR(@03)                                  1014
*     CCWDATLN=EXPKEYLN(ARRINDEX)+EXPDATAL(ARRINDEX);              1015
*                                                                  1015
         LH    @03,CCWCNT                                          1015
         SLA   @03,3                                               1015
         L     @01,IOCTLBKP                                        1015
         LA    @03,IOXCCW-8(@03,@01)                               1015
         LH    @15,ARRINDEX                                        1015
         SLA   @15,3                                               1015
         L     @14,@PC00001+8                                      1015
         L     @01,EXPDATA(,@14)                                   1015
         LH    @14,ARRINDEX                                        1015
         SLA   @14,3                                               1015
         L     @07,@PC00001+8                                      1015
         L     @07,EXPDATA(,@07)                                   1015
         SLR   @00,@00                                             1015
         IC    @00,EXPKEYLN-8(@15,@01)                             1015
         AH    @00,EXPDATAL-8(@14,@07)                             1015
         STH   @00,CCWDATLN(,@03)                                  1015
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT THE EXPARRAY ITEM BY 1                    @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1016
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1016
         LA    @03,1(,@03)                                         1016
         STH   @03,ARRINDEX                                        1016
*   END;                            /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1017
         AH    @03,TWOCCWS                                         1017
         STH   @03,CCWCNT                                          1017
@DE01012 LH    @03,CCWCNT                                          1017
         CH    @03,LASTCCW                                         1017
         BNH   @DL01012                                            1017
*                                                                  1018
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THAT WE HAVE INITIALIZED OUR CCW                  @Y30LB35*/
*   /* STRING WITH ALL THE WRITE CCWS AND                    @Y30LB35*/
*   /* THEIR ASSOCIATED COUNT FIELDS, WE                     @Y30LB35*/
*   /* SEARCH BACK TO THE BEGINNING OF THE                   @Y30LB35*/
*   /* TRACK TO CHECK ALL THE RECORDS BY                     @Y30LB35*/
*   /* READING THE SAME RECORDS THAT WE                      @Y30LB35*/
*   /* WROTE OUT ON OUR FIRST PASS AROUND                    @Y30LB35*/
*   /* THE TRACK.                                            @Y30LB35*/
*   /* WE FIRST SET UP THE SEARCH AND TIC                    @Y30LB35*/
*   /* CCWS.                                                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1018
*   IOXCCW((EXPRECNO*TWOCCWS)+THREECCW)=IOXCCW(1);                 1018
         L     @03,@PC00001+8                                      1018
         L     @03,EXPDATA(,@03)                                   1018
         L     @03,EXPRECNO(,@03)                                  1018
         MH    @03,TWOCCWS                                         1018
         AH    @03,THREECCW                                        1018
         SLA   @03,3                                               1018
         L     @01,IOCTLBKP                                        1018
         ALR   @01,@03                                             1018
         L     @03,IOCTLBKP                                        1018
         MVC   @TS00001(8),IOXCCW(@03)                             1018
         MVC   IOXCCW-8(8,@01),@TS00001                            1018
*   IOXCCW((EXPRECNO*TWOCCWS)+FOURCCWS)=IOXCCW(2);                 1019
*                                                                  1019
         L     @03,@PC00001+8                                      1019
         L     @03,EXPDATA(,@03)                                   1019
         L     @03,EXPRECNO(,@03)                                  1019
         MH    @03,TWOCCWS                                         1019
         AH    @03,FOURCCWS                                        1019
         SLA   @03,3                                               1019
         L     @01,IOCTLBKP                                        1019
         ALR   @01,@03                                             1019
         L     @03,IOCTLBKP                                        1019
         MVC   IOXCCW-8(8,@01),IOXCCW+8(@03)                       1019
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CCW COUNTER TO THE CCW                 @Y30LB35*/
*   /* TRANSFER IN CHANNEL (TIC)                             @Y30LB35*/
*   /* THIS WILL ALLOW THE INITIALIZATION                    @Y30LB35*/
*   /* TIC ADDRESS.                                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1020
*   CCWCNT=(EXPRECNO*TWOCCWS)+FOURCCWS;/*                    @Y30LB35*/
*                                                                  1020
         L     @03,@PC00001+8                                      1020
         L     @03,EXPDATA(,@03)                                   1020
         L     @03,EXPRECNO(,@03)                                  1020
         MH    @03,TWOCCWS                                         1020
         AH    @03,FOURCCWS                                        1020
         STH   @03,CCWCNT                                          1020
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE TIC ADDRESS.                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1021
*   CCWADDR=ADDR(IOXCCW((EXPRECNO*TWOCCWS)+THREECCW));             1021
*                                                                  1021
         LH    @03,CCWCNT                                          1021
         SLA   @03,3                                               1021
         L     @01,IOCTLBKP                                        1021
         LA    @03,IOXCCW-8(@03,@01)                               1021
         L     @15,@PC00001+8                                      1021
         L     @01,EXPDATA(,@15)                                   1021
         L     @15,EXPRECNO(,@01)                                  1021
         MH    @15,TWOCCWS                                         1021
         AH    @15,THREECCW                                        1021
         SLA   @15,3                                               1021
         L     @01,IOCTLBKP                                        1021
         LA    @15,IOXCCW-8(@15,@01)                               1021
         STCM  @15,7,CCWADDR(@03)                                  1021
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE LASTCCW FOR THE BUILD                      @Y30LB35*/
*   /* CCW READ LOOP.                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1022
*   LASTCCW=(EXPRECNO*THREECCW)+FOURCCWS;/*                  @Y30LB35*/
*                                                                  1022
         L     @03,@PC00001+8                                      1022
         L     @03,EXPDATA(,@03)                                   1022
         L     @03,EXPRECNO(,@03)                                  1022
         MH    @03,THREECCW                                        1022
         AH    @03,FOURCCWS                                        1022
         STH   @03,LASTCCW                                         1022
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE EXPARRAY ARRINDEX TO 1                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1023
*   ARRINDEX=1;                     /*                       @Y30LB35*/
*                                                                  1023
         MVC   ARRINDEX(2),@CH00222                                1023
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE LOOPING IS DONE TO BUILD THE                 @Y30LB35*/
*   /* READ COUNT KEY AND DATA CCWS.                         @Y30LB35*/
*   /* IT SHOULD BE NOTED THE THE DATA                       @Y30LB35*/
*   /* TRANSFER IS SET TO SUPPRESS THE                       @Y30LB35*/
*   /* DATA FROM BEING READ BACK INTO CORE                   @Y30LB35*/
*   /* AS THE READS ARE BEING DONE TO                        @Y30LB35*/
*   /* TEST TO SEE IF THE NEW RECORDS ARE                    @Y30LB35*/
*   /* THERE AND ARE READABLE.                               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1024
*   DO CCWCNT=((EXPRECNO*TWOCCWS)+FIVECCWS) BY 1 WHILE CCWCNT<=LASTCCW;
         L     @03,@PC00001+8                                      1024
         L     @03,EXPDATA(,@03)                                   1024
         L     @03,EXPRECNO(,@03)                                  1024
         MH    @03,TWOCCWS                                         1024
         AH    @03,FIVECCWS                                        1024
         STH   @03,CCWCNT                                          1024
         B     @DE01024                                            1024
@DL01024 DS    0H                                                  1025
*                                   /*                       @Y30LB35*/
*                                                                  1025
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE THE MODEL READ COUNT KEY AND DATA              @Y30LB35*/
*     /* CCW INTO THE CCW STRING.                            @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1025
*     IOXCCW(CCWCNT)=CCWRCKD;       /*                       @Y30LB35*/
*                                                                  1025
         LH    @03,CCWCNT                                          1025
         SLA   @03,3                                               1025
         L     @01,IOCTLBKP                                        1025
         ALR   @01,@03                                             1025
         MVC   IOXCCW-8(8,@01),CCWRCKD                             1025
*     /***************************************************************/
*     /*                                                             */
*     /* TURN ON THE SUPPRESS DATA TRANSFET BIT              @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1026
*     CCWSUPP=ON;                   /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1026
         SLA   @03,3                                               1026
         L     @01,IOCTLBKP                                        1026
         LA    @03,IOXCCW-8(@03,@01)                               1026
         OI    CCWSUPP(@03),B'00010000'                            1026
*                                                                  1027
*     /***************************************************************/
*     /*                                                             */
*     /* ZERO OUT THE DATA ADDRESS                           @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1027
*     CCWADDR=''B;                  /*                       @Y30LB35*/
*                                                                  1027
         LH    @03,CCWCNT                                          1027
         SLA   @03,3                                               1027
         L     @01,IOCTLBKP                                        1027
         LA    @03,IOXCCW-8(@03,@01)                               1027
         SLR   @15,@15                                             1027
         STCM  @15,7,CCWADDR(@03)                                  1027
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE THE DATA LENGTH                          @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1028
*     CCWDATLN=LENGTH(COUNT)+EXPDATAL(ARRINDEX)+EXPKEYLN(ARRINDEX);/*
*                                                            @Y30LB35*/
*                                                                  1028
         LH    @03,CCWCNT                                          1028
         SLA   @03,3                                               1028
         L     @01,IOCTLBKP                                        1028
         LA    @03,IOXCCW-8(@03,@01)                               1028
         LH    @15,ARRINDEX                                        1028
         SLA   @15,3                                               1028
         L     @14,@PC00001+8                                      1028
         L     @01,EXPDATA(,@14)                                   1028
         LA    @14,8                                               1028
         AH    @14,EXPDATAL-8(@15,@01)                             1028
         LH    @15,ARRINDEX                                        1028
         SLA   @15,3                                               1028
         L     @07,@PC00001+8                                      1028
         L     @01,EXPDATA(,@07)                                   1028
         SLR   @00,@00                                             1028
         IC    @00,EXPKEYLN-8(@15,@01)                             1028
         ALR   @14,@00                                             1028
         STH   @14,CCWDATLN(,@03)                                  1028
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT THE EXPARRAY ARRINDEX                     @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1029
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1029
         LA    @03,1(,@03)                                         1029
         STH   @03,ARRINDEX                                        1029
*   END;                            /*                       @Y30LB35*/
*                                                                  1030
         LA    @03,1                                               1030
         AH    @03,CCWCNT                                          1030
         STH   @03,CCWCNT                                          1030
@DE01024 LH    @03,CCWCNT                                          1030
         CH    @03,LASTCCW                                         1030
         BNH   @DL01024                                            1030
*   /*****************************************************************/
*   /*                                                               */
*   /* BACK UP TO THE LAST CCW                               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1031
*   CCWCNT=CCWCNT-1;                /*                       @Y30LB35*/
*                                                                  1031
         LH    @03,CCWCNT                                          1031
         BCTR  @03,0                                               1031
         STH   @03,CCWCNT                                          1031
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN OFF THE COMMAND CHAINING BIT                     @Y30LB35*/
*   /* TO INDICATE THAT THIS IS THE END                      @Y30LB35*/
*   /* OF THE CCW STRING.                                    @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1032
*   CCWCMDCH=OFF;                   /*                       @Y30LB35*/
*                                                                  1032
         LH    @03,CCWCNT                                          1032
         SLA   @03,3                                               1032
         L     @01,IOCTLBKP                                        1032
         LA    @03,IOXCCW-8(@03,@01)                               1032
         NI    CCWCMDCH(@03),B'10111111'                           1032
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO PUTGET                         @Y30LB35*/
*   /* WITH A ZERO RETURN CODE IN REGISTER 15                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1033
*   RETURN CODE(0);                 /*                       @Y30LB35*/
         SLR   @15,@15                                             1033
         L     @14,12(,@13)                                        1033
         LM    @00,@12,20(@13)                                     1033
         BR    @14                                                 1033
*   END BLDCCWP1;                   /*                       @Y30LB35*/
*                                                                  1035
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - BLDCCWP2                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             BUILD CCW'S TO WRITE "KEY" DATA              @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     USERCCHH IN CALLER'S CORE                    @Y30LB35*/
*/*             EXPCCHHR IN EXPAGL                           @Y30LB35*/
*/*             EXPDAYLN(X) IN EXPDATAB                      @Y30LB35*/
*/*             EXPKEYLN(X) IN EXPDATAB                      @Y30LB35*/
*/*             EXPDATAL(X) IN EXPDATAB                      @Y30LB35*/
*/*             EXPRECNO IN EXPDATAB                         @Y30LB35*/
*/*             CCWSIDEQ                                     @Y30LB35*/
*/*             CCWTIC                                       @Y30LB35*/
*/*             CCWWKD                                       @Y30LB35*/
*/*             CCWDATA                                      @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXCCW(X) IN IOXCTLBK                        @Y30LB35*/
*/*             WRITECNT IN IOXCTLBK                         @Y30LB35*/
*/*             READCNTA IN IOXCTLBK                         @ZA11014*/
*/*             IOBSEEK  IN IOXIOB                           @Y30LB35*/
*/*             CCWCMDCH IN IOXCCW                           @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1035
*                                   /*                       @Y30LB35*/
*BLDCCWP2:                                                         1035
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1035
BLDCCWP2 STM   @14,@12,12(@13)                                     1035
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOP2' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1036
*   OLDERID2=NEWERID2;                                             1036
         L     @03,@PC00001                                        1036
         L     @03,GDTTR2(,@03)                                    1036
         L     @15,@PC00001                                        1036
         L     @01,GDTTR2(,@15)                                    1036
         MVC   @TS00001(95),NEWERID2(@01)                          1036
         MVC   OLDERID2(95,@03),@TS00001                           1036
*   NEWID2='IOP2';                  /*                       @Y30LB35*/
*                                                                  1037
         L     @03,@PC00001                                        1037
         L     @03,GDTTR2(,@03)                                    1037
         MVC   NEWID2(4,@03),@CC04252                              1037
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE STARTS THE INITIALIZATION OF THE CCWS            @Y30LB35*/
*   /* THE FIRST THING DONE IS THE MODEL CCW                 @Y30LB35*/
*   /* SEARCH I.D. EQUAL IS MOVED INTO CCW STRING            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1038
*   IOXCCW(1)=CCWSIDEQ;             /*                       @Y30LB35*/
*                                                                  1038
         L     @03,IOCTLBKP                                        1038
         MVC   IOXCCW(8,@03),CCWSIDEQ                              1038
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CCW ARRAY COUNTER TO THE 1ST CCW           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1039
*   CCWCNT=1;                       /*                       @Y30LB35*/
*                                                                  1039
         MVC   CCWCNT(2),@CH00222                                  1039
*   /*****************************************************************/
*   /*                                                               */
*   /* THE NEXT FIVE INSTRUCTIONS INITIALIZES THE            @Y30LB35*/
*   /* SEARCH AND IOBSEEK CCHHR VALUE.                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1040
*   USERCHRP=EXPCCHHR;              /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      1040
         L     @03,EXPCCHHR(,@03)                                  1040
         ST    @03,USERCHRP                                        1040
*   TEMPCCHH=''B;                   /*                       @Y30LB35*/
         XC    TEMPCCHH(8),TEMPCCHH                                1041
*   TEMPCHR=USERCCHH;               /*                       @Y30LB35*/
         L     @03,USERCHRP                                        1042
         MVC   TEMPCHR(5),USERCCHH(@03)                            1042
*   IOBSEEK=TEMPCCHH;               /*                       @Y30LB35*/
         L     @03,IOBSTPTR                                        1043
         MVC   IOBSEEK(8,@03),TEMPCCHH                             1043
*   CCWADDR=ADDR(IOBCC);            /*                       @Y30LB35*/
*                                                                  1044
         LH    @03,CCWCNT                                          1044
         SLA   @03,3                                               1044
         L     @01,IOCTLBKP                                        1044
         LA    @03,IOXCCW-8(@03,@01)                               1044
         L     @01,IOBSTPTR                                        1044
         LA    @15,IOBCC(,@01)                                     1044
         STCM  @15,7,CCWADDR(@03)                                  1044
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE SECOND CCW IS INITIALIZED WITH               @Y30LB35*/
*   /* THE TRANSFER IN CHANNEL(TIC) CCW.                     @Y30LB35*/
*   /* THIS WILL ALLOW THE CHANNEL TO LOOP                   @Y30LB35*/
*   /* UNTIL IT FINDS THE CCHHR IN THE SEARCH.               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1045
*   IOXCCW(2)=CCWTIC;               /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1045
         MVC   IOXCCW+8(8,@03),CCWTIC                              1045
*   CCWCNT=TWOCCWS;                 /*                       @Y30LB35*/
         LH    @03,TWOCCWS                                         1046
         STH   @03,CCWCNT                                          1046
*   CCWADDR=ADDR(IOXCCW(1));        /*                       @Y30LB35*/
*                                                                  1047
         LH    @03,CCWCNT                                          1047
         SLA   @03,3                                               1047
         L     @01,IOCTLBKP                                        1047
         LA    @03,IOXCCW-8(@03,@01)                               1047
         L     @01,IOCTLBKP                                        1047
         LA    @15,IOXCCW(,@01)                                    1047
         STCM  @15,7,CCWADDR(@03)                                  1047
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CCW READ AND CCW WRITE COUNTER ARE                @Y30LB35*/
*   /* INITIALIZED TO ZERO.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   WRITECNT=ZERO;                  /*                       @Y30LB35*/
         LH    @03,ZERO                                            1048
         STH   @03,WRITECNT                                        1048
*   READCNTA=ZERO;                  /*                       @ZA11014*/
*                                                                  1049
         LH    @03,ZERO                                            1049
         STH   @03,READCNTA                                        1049
*   /*****************************************************************/
*   /*                                                               */
*   /* THE LASTCCW IS CALCULATED AND USED TO                 @Y30LB35*/
*   /* CONTROL THE LOOP USED TO BUILD THE                    @Y30LB35*/
*   /* WRITE KEY AND DATA CCWS FOR                           @Y30LB35*/
*   /* ALL THE NEW RECORDS BEING WRITTEN.                    @Y30LB35*/
*   /* ALSO DONE IS THE INITIALIZATION OF                    @Y30LB35*/
*   /* ARRINDEX VARIABLE USED THE REFERENCE                  @Y30LB35*/
*   /* EXPARRAY.                                             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1050
*   LASTCCW=EXPRECNO+TWOCCWS;       /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      1050
         L     @03,EXPDATA(,@03)                                   1050
         LH    @15,TWOCCWS                                         1050
         AL    @15,EXPRECNO(,@03)                                  1050
         STH   @15,LASTCCW                                         1050
*   ARRINDEX=1;                     /*                       @Y30LB35*/
*                                                                  1051
         MVC   ARRINDEX(2),@CH00222                                1051
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE LOOPING WILL BE PERFORMED WHILE                  @Y30LB35*/
*   /* THE WRITE KEY DATA CCWS FOR                           @Y30LB35*/
*   /* UPDATING RECORDS ARE BUILT.                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1052
*   DO CCWCNT=THREECCW BY 1 WHILE CCWCNT<=LASTCCW;/*         @Y30LB35*/
*                                                                  1052
         LH    @03,THREECCW                                        1052
         STH   @03,CCWCNT                                          1052
         B     @DE01052                                            1052
@DL01052 DS    0H                                                  1053
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE IN MODEL WRITE KEY AND DATA CCW                @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1053
*     IOXCCW(CCWCNT)=CCWWKD;        /*                       @Y30LB35*/
*                                                                  1053
         LH    @03,CCWCNT                                          1053
         SLA   @03,3                                               1053
         L     @01,IOCTLBKP                                        1053
         ALR   @01,@03                                             1053
         MVC   IOXCCW-8(8,@01),CCWWKD                              1053
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT CCW WRITE COUNTER BY 1.                   @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1054
*     WRITECNT=WRITECNT+1;          /*                       @Y30LB35*/
*                                                                  1054
         LH    @03,WRITECNT                                        1054
         LA    @03,1(,@03)                                         1054
         STH   @03,WRITECNT                                        1054
*     /***************************************************************/
*     /*                                                             */
*     /* FILL IN THE DYNAMIC INFORMATION INTO THE            @Y30LB35*/
*     /* CCW.                                                @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1055
*     CCWADDR=EXPDATAP(ARRINDEX);   /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1055
         SLA   @03,3                                               1055
         L     @01,IOCTLBKP                                        1055
         LA    @03,IOXCCW-8(@03,@01)                               1055
         LH    @15,ARRINDEX                                        1055
         SLA   @15,3                                               1055
         L     @14,@PC00001+8                                      1055
         L     @01,EXPDATA(,@14)                                   1055
         AL    @01,@CF04420                                        1055
         L     @15,EXPDATAP-4(@15,@01)                             1055
         STCM  @15,7,CCWADDR(@03)                                  1055
*     CCWDATLN=EXPKEYLN(ARRINDEX)+EXPDATAL(ARRINDEX);              1056
*                                                                  1056
         LH    @03,CCWCNT                                          1056
         SLA   @03,3                                               1056
         L     @01,IOCTLBKP                                        1056
         LA    @03,IOXCCW-8(@03,@01)                               1056
         LH    @15,ARRINDEX                                        1056
         SLA   @15,3                                               1056
         L     @14,@PC00001+8                                      1056
         L     @01,EXPDATA(,@14)                                   1056
         LH    @14,ARRINDEX                                        1056
         SLA   @14,3                                               1056
         L     @07,@PC00001+8                                      1056
         L     @07,EXPDATA(,@07)                                   1056
         SLR   @00,@00                                             1056
         IC    @00,EXPKEYLN-8(@15,@01)                             1056
         AH    @00,EXPDATAL-8(@14,@07)                             1056
         STH   @00,CCWDATLN(,@03)                                  1056
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT THE EXPARRAY ITEM BY 1                    @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1057
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1057
         LA    @03,1(,@03)                                         1057
         STH   @03,ARRINDEX                                        1057
*   END;                            /*                       @Y30LB35*/
         LA    @03,1                                               1058
         AH    @03,CCWCNT                                          1058
         STH   @03,CCWCNT                                          1058
@DE01052 LH    @03,CCWCNT                                          1058
         CH    @03,LASTCCW                                         1058
         BNH   @DL01052                                            1058
*                                                                  1059
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THAT WE HAVE INITIALIZED OUR CCW                  @Y30LB35*/
*   /* STRING WITH ALL THE WRITE CCWS,                       @Y30LB35*/
*   /* WE SEARCH BACK TO THE BEGINNING OF THE                @Y30LB35*/
*   /* TRACK TO CHECK ALL THE RECORDS BY                     @Y30LB35*/
*   /* READING THE SAME RECORDS THAT WE HAVE                 @Y30LB35*/
*   /* WRITTEN OUT ON OUR FIRST PASS AROUND                  @Y30LB35*/
*   /* THE TRACK.                                            @Y30LB35*/
*   /* WE FIRST SET UP THE SEARCH AND TIC                    @Y30LB35*/
*   /* CCWS.                                                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1059
*   IOXCCW(EXPRECNO+THREECCW)=IOXCCW(1);/*                   @Y30LB35*/
         L     @03,@PC00001+8                                      1059
         L     @03,EXPDATA(,@03)                                   1059
         LH    @15,THREECCW                                        1059
         AL    @15,EXPRECNO(,@03)                                  1059
         SLA   @15,3                                               1059
         L     @03,IOCTLBKP                                        1059
         ALR   @03,@15                                             1059
         L     @01,IOCTLBKP                                        1059
         MVC   @TS00001(8),IOXCCW(@01)                             1059
         MVC   IOXCCW-8(8,@03),@TS00001                            1059
*   IOXCCW(EXPRECNO+FOURCCWS)=IOXCCW(2);/*                   @Y30LB35*/
*                                                                  1060
         L     @03,@PC00001+8                                      1060
         L     @03,EXPDATA(,@03)                                   1060
         LH    @15,FOURCCWS                                        1060
         AL    @15,EXPRECNO(,@03)                                  1060
         SLA   @15,3                                               1060
         L     @03,IOCTLBKP                                        1060
         ALR   @03,@15                                             1060
         L     @01,IOCTLBKP                                        1060
         MVC   IOXCCW-8(8,@03),IOXCCW+8(@01)                       1060
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CCW COUNTER TO THE CCW                 @Y30LB35*/
*   /* TRANSFER IN CHANNEL (TIC)                             @Y30LB35*/
*   /* THIS WILL ALLOW THE INITIALIZATION                    @Y30LB35*/
*   /* TIC ADDRESS.                                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1061
*   CCWCNT=EXPRECNO+FOURCCWS;       /*                       @Y30LB35*/
*                                                                  1061
         L     @03,@PC00001+8                                      1061
         L     @03,EXPDATA(,@03)                                   1061
         LH    @15,FOURCCWS                                        1061
         AL    @15,EXPRECNO(,@03)                                  1061
         STH   @15,CCWCNT                                          1061
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE TIC ADDRESS.                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1062
*   CCWADDR=ADDR(IOXCCW((EXPRECNO)+THREECCW));/*             @Y30LB35*/
*                                                                  1062
         LH    @03,CCWCNT                                          1062
         SLA   @03,3                                               1062
         L     @01,IOCTLBKP                                        1062
         LA    @03,IOXCCW-8(@03,@01)                               1062
         L     @15,@PC00001+8                                      1062
         L     @01,EXPDATA(,@15)                                   1062
         LH    @15,THREECCW                                        1062
         AL    @15,EXPRECNO(,@01)                                  1062
         SLA   @15,3                                               1062
         L     @01,IOCTLBKP                                        1062
         LA    @15,IOXCCW-8(@15,@01)                               1062
         STCM  @15,7,CCWADDR(@03)                                  1062
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE LASTCCW FOR THE BUILD                      @Y30LB35*/
*   /* CCW READ LOOP.                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1063
*   LASTCCW=(EXPRECNO*TWOCCWS)+FOURCCWS;/*                   @Y30LB35*/
*                                                                  1063
         L     @03,@PC00001+8                                      1063
         L     @03,EXPDATA(,@03)                                   1063
         L     @03,EXPRECNO(,@03)                                  1063
         MH    @03,TWOCCWS                                         1063
         AH    @03,FOURCCWS                                        1063
         STH   @03,LASTCCW                                         1063
*   /*****************************************************************/
*   /*                                                               */
*   /* REINITIALIZE THE COUNTER VALUE TO THE                 @Y30LB35*/
*   /* FIRST EXPARRAY ITEM.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1064
*   ARRINDEX=1;                     /*                       @Y30LB35*/
         MVC   ARRINDEX(2),@CH00222                                1064
*                                                                  1065
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE LOOPING IS DONE TO BUILD THE                 @Y30LB35*/
*   /* READ KEY AND DATA CCWS.                               @Y30LB35*/
*   /* IT SHOULD BE NOTED THAT THE DATA                      @Y30LB35*/
*   /* TRANSFER IS SUPPRESSED. THIS READ                     @Y30LB35*/
*   /* IS BEING DONE TO TEST TO SEE IF                       @Y30LB35*/
*   /* THE NEW RECORDS ARE THERE AND READABLE.               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1065
*   DO CCWCNT=(EXPRECNO+FIVECCWS) BY 1/*                     @Y30LB35*/
*         WHILE CCWCNT<=LASTCCW;    /*                       @Y30LB35*/
*                                                                  1065
         L     @03,@PC00001+8                                      1065
         L     @03,EXPDATA(,@03)                                   1065
         LH    @15,FIVECCWS                                        1065
         AL    @15,EXPRECNO(,@03)                                  1065
         STH   @15,CCWCNT                                          1065
         B     @DE01065                                            1065
@DL01065 DS    0H                                                  1066
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE THE MODEL READ KEY AND DATA                    @Y30LB35*/
*     /* CCW INTO THE CCW STRING.                            @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1066
*     IOXCCW(CCWCNT)=CCWRKD;        /*                       @Y30LB35*/
*                                                                  1066
         LH    @03,CCWCNT                                          1066
         SLA   @03,3                                               1066
         L     @01,IOCTLBKP                                        1066
         ALR   @01,@03                                             1066
         MVC   IOXCCW-8(8,@01),CCWRKD                              1066
*     /***************************************************************/
*     /*                                                             */
*     /* TURN ON THE SUPPRESS DATA TRANSFER BIT              @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1067
*     CCWSUPP=ON;                   /*                       @Y30LB35*/
*                                                                  1067
         LH    @03,CCWCNT                                          1067
         SLA   @03,3                                               1067
         L     @01,IOCTLBKP                                        1067
         LA    @03,IOXCCW-8(@03,@01)                               1067
         OI    CCWSUPP(@03),B'00010000'                            1067
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE DATA ADDRESS TO ZERO                     @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1068
*     CCWADDR=''B;                  /*                       @Y30LB35*/
*                                                                  1068
         LH    @03,CCWCNT                                          1068
         SLA   @03,3                                               1068
         L     @01,IOCTLBKP                                        1068
         LA    @03,IOXCCW-8(@03,@01)                               1068
         SLR   @15,@15                                             1068
         STCM  @15,7,CCWADDR(@03)                                  1068
*     /***************************************************************/
*     /*                                                             */
*     /* SET DATA LENGTH                                     @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1069
*     CCWDATLN=EXPDATAL(ARRINDEX)+EXPKEYLN(ARRINDEX);              1069
*                                                                  1069
         LH    @03,CCWCNT                                          1069
         SLA   @03,3                                               1069
         L     @01,IOCTLBKP                                        1069
         LA    @03,IOXCCW-8(@03,@01)                               1069
         LH    @15,ARRINDEX                                        1069
         SLA   @15,3                                               1069
         L     @14,@PC00001+8                                      1069
         L     @01,EXPDATA(,@14)                                   1069
         LH    @14,ARRINDEX                                        1069
         SLA   @14,3                                               1069
         L     @07,@PC00001+8                                      1069
         L     @07,EXPDATA(,@07)                                   1069
         SLR   @06,@06                                             1069
         IC    @06,EXPKEYLN-8(@14,@07)                             1069
         AH    @06,EXPDATAL-8(@15,@01)                             1069
         STH   @06,CCWDATLN(,@03)                                  1069
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT THE EXPARRAY COUNTER                      @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1070
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/
         LH    @03,ARRINDEX                                        1070
         LA    @03,1(,@03)                                         1070
         STH   @03,ARRINDEX                                        1070
*   END;                            /*                       @Y30LB35*/
         LA    @15,1                                               1071
         AH    @15,CCWCNT                                          1071
         STH   @15,CCWCNT                                          1071
@DE01065 LH    @03,CCWCNT                                          1071
         CH    @03,LASTCCW                                         1071
         BNH   @DL01065                                            1071
*                                                                  1072
*   /*****************************************************************/
*   /*                                                               */
*   /* BACK UP THE LAST CCW                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1072
*   CCWCNT=CCWCNT-1;                /*                       @Y30LB35*/
*                                                                  1072
         LH    @03,CCWCNT                                          1072
         BCTR  @03,0                                               1072
         STH   @03,CCWCNT                                          1072
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN OFF THE COMMAND CHAING BIT                       @Y30LB35*/
*   /* TO INDICATE THAT THIS IS THE END                      @Y30LB35*/
*   /* OF THE CCW STRING.                                    @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1073
*   CCWCMDCH=OFF;                   /*                       @Y30LB35*/
*                                                                  1073
         LH    @03,CCWCNT                                          1073
         SLA   @03,3                                               1073
         L     @01,IOCTLBKP                                        1073
         LA    @03,IOXCCW-8(@03,@01)                               1073
         NI    CCWCMDCH(@03),B'10111111'                           1073
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO PUTGET                         @Y30LB35*/
*   /* WITH A ZERO RETURN CODE IN REGISTER 15                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1074
*   RETURN CODE(0);                 /*                       @Y30LB35*/
         SLR   @15,@15                                             1074
         L     @14,12(,@13)                                        1074
         LM    @00,@12,20(@13)                                     1074
         BR    @14                                                 1074
*   END BLDCCWP2;                   /*                       @Y30LB35*/
*                                                                  1076
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - BLDCCWG                                 @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             BUILD CCW'S TO READ "KEY DATA"               @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     USERCCHH IN CALLER'S CORE                    @Y30LB35*/
*/*             EXGCCHH1 IN EXGAGL                           @Y30LB35*/
*/*             EXGCCHH2 IN EXGAGL                           @Y30LB35*/
*/*             EXGDAYLN IN EXGDATAB                         @Y30LB35*/
*/*             EXGKEYLN IN EXGDATAB                         @Y30LB35*/
*/*             EXGDATAL IN EXGDATAB                         @Y30LB35*/
*/*             EXGRECNO IN EXGDATAB                         @Y30LB35*/
*/*             CCWSIDEQ                                     @Y30LB35*/
*/*             CCWTIC                                       @Y30LB35*/
*/*             CCWWKD                                       @Y30LB35*/
*/*             CCWDATA                                      @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXCCW(X) IOXCTLBK                           @Y30LB35*/
*/*             WRITECNT IN IOXCTLBK                         @Y30LB35*/
*/*             READCNTA IN IOXCTLBK                         @ZA11014*/
*/*             IOBSEEK  IN IOXIOB                           @Y30LB35*/
*/*             CCWCMDCH IN IOXCCW                           @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1076
*                                   /*                       @Y30LB35*/
*BLDCCWG:                                                          1076
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1076
BLDCCWG  STM   @14,@12,12(@13)                                     1076
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOG1' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1077
*   OLDERID2=NEWERID2;                                             1077
         L     @03,@PC00001                                        1077
         L     @03,GDTTR2(,@03)                                    1077
         L     @15,@PC00001                                        1077
         L     @01,GDTTR2(,@15)                                    1077
         MVC   @TS00001(95),NEWERID2(@01)                          1077
         MVC   OLDERID2(95,@03),@TS00001                           1077
*   NEWID2='IOG1';                  /*                       @Y30LB35*/
*                                                                  1078
         L     @03,@PC00001                                        1078
         L     @03,GDTTR2(,@03)                                    1078
         MVC   NEWID2(4,@03),@CC04256                              1078
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE STARTS THE INITIALIZATION OF THE CCWS            @Y30LB35*/
*   /* THE FIRST THING DONE IS THE MODEL CCW                 @Y30LB35*/
*   /* SEARCH I.D. EQUAL IS MOVE INTO CCWS                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1079
*   IOXCCW(1)=CCWSIDEQ;             /*                       @Y30LB35*/
*                                                                  1079
         L     @03,IOCTLBKP                                        1079
         MVC   IOXCCW(8,@03),CCWSIDEQ                              1079
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CCW ARRAY COUNTER TO THE 1ST CCW           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1080
*   CCWCNT=1;                       /*                       @Y30LB35*/
*                                                                  1080
         MVC   CCWCNT(2),@CH00222                                  1080
*   /*****************************************************************/
*   /*                                                               */
*   /* THE NEXT SIX INSTRUCTIONS INITIALIZES THE             @Y30LB35*/
*   /* SEARCH AND IOBSEEK CCHHR VALUE.                       @Y30LB35*/
*   /* FIRST A DETERMINATION IS MADE IF                      @Y30LB35*/
*   /* THE CALLER HAS PASSED THE SEEK CCHHR                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1081
*   IF EXGCCHH1^=NULLPTR            /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      1081
         L     @03,EXGCCHH1(,@03)                                  1081
         LTR   @03,@03                                             1081
         BZ    @RF01081                                            1081
*     USERCHRP=EXGCCHH1;            /*                       @Y30LB35*/
*                                                                  1082
         L     @03,@PC00001+8                                      1082
         L     @03,EXGCCHH1(,@03)                                  1082
         ST    @03,USERCHRP                                        1082
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SEEK CCHHR WAS NOT PASSED,                     @Y30LB35*/
*   /* THE CCHHR OF THE SEARCH IS USED.                      @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1083
*   ELSE                            /*                       @Y30LB35*/
*     USERCHRP=EXGCCHH2;            /*                       @Y30LB35*/
         B     @RC01081                                            1083
@RF01081 L     @03,@PC00001+8                                      1083
         L     @03,EXGCCHH2(,@03)                                  1083
         ST    @03,USERCHRP                                        1083
*   TEMPCCHH=''B;                   /*                       @Y30LB35*/
@RC01081 XC    TEMPCCHH(8),TEMPCCHH                                1084
*   TEMPCHR=USERCCHH;               /*                       @Y30LB35*/
         L     @03,USERCHRP                                        1085
         MVC   TEMPCHR(5),USERCCHH(@03)                            1085
*   IOBSEEK=TEMPCCHH;               /*                       @Y30LB35*/
         L     @03,IOBSTPTR                                        1086
         MVC   IOBSEEK(8,@03),TEMPCCHH                             1086
*   CCWADDR=EXGCCHH2;               /*                       @Y30LB35*/
*                                                                  1087
         LH    @03,CCWCNT                                          1087
         SLA   @03,3                                               1087
         L     @01,IOCTLBKP                                        1087
         LA    @03,IOXCCW-8(@03,@01)                               1087
         L     @15,@PC00001+8                                      1087
         MVC   CCWADDR(3,@03),EXGCCHH2+1(@15)                      1087
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE SECOND CCW IS INITIALIZED WITH               @Y30LB35*/
*   /* THE TRANSFER IN CHANNEL(TIC) CCW.                     @Y30LB35*/
*   /* THIS WILL ALLOW THE CHANNEL TO LOOP                   @Y30LB35*/
*   /* UNTIL IT FINDS THE CCHHR IN THE SEARCH.               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1088
*   IOXCCW(2)=CCWTIC;               /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1088
         MVC   IOXCCW+8(8,@03),CCWTIC                              1088
*   CCWCNT=TWOCCWS;                 /*                       @Y30LB35*/
         LH    @03,TWOCCWS                                         1089
         STH   @03,CCWCNT                                          1089
*   CCWADDR=ADDR(IOXCCW(1));        /*                       @Y30LB35*/
*                                                                  1090
         LH    @03,CCWCNT                                          1090
         SLA   @03,3                                               1090
         L     @01,IOCTLBKP                                        1090
         LA    @03,IOXCCW-8(@03,@01)                               1090
         L     @01,IOCTLBKP                                        1090
         LA    @15,IOXCCW(,@01)                                    1090
         STCM  @15,7,CCWADDR(@03)                                  1090
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CCW READ AND CCW WRITE COUNTERS ARE               @Y30LB35*/
*   /* INITIALIZED TO ZERO.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1091
*   WRITECNT=ZERO;                  /*                       @Y30LB35*/
         LH    @03,ZERO                                            1091
         STH   @03,WRITECNT                                        1091
*   READCNTA=ZERO;                  /*                       @ZA11014*/
         LH    @03,ZERO                                            1092
         STH   @03,READCNTA                                        1092
*                                                                  1093
*   /*****************************************************************/
*   /*                                                               */
*   /* THE LASTCCW IS CALCULATED AND USED TO                 @Y30LB35*/
*   /* CONTROL THE LOOP USED TO BUILD THE                    @Y30LB35*/
*   /* READ KEY AND DATA CCWS FOR                            @Y30LB35*/
*   /* ALL THE RECORDS BEING READ.                           @Y30LB35*/
*   /* ALSO DONE IS THE INITIALIZATION OF                    @Y30LB35*/
*   /* OFFSET VARIABLE USED TO ADDRESS THE                   @Y30LB35*/
*   /* DATA RECORDS.                                         @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1093
*   LASTCCW=EXGRECNO+TWOCCWS;       /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      1093
         LH    @15,TWOCCWS                                         1093
         AL    @15,EXGRECNO(,@03)                                  1093
         STH   @15,LASTCCW                                         1093
*   OFFSET=ZERO;                    /*                       @Y30LB35*/
*                                                                  1094
         LH    @03,ZERO                                            1094
         STH   @03,OFFSET                                          1094
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE LOOPING WILL BE PERFORMED WHILE                  @Y30LB35*/
*   /* THE READ KEY AND DATA CCWS ARE BUILT.                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1095
*   DO CCWCNT=THREECCW TO LASTCCW;  /*                       @Y30LB35*/
*                                                                  1095
         LH    @03,THREECCW                                        1095
         B     @DE01095                                            1095
@DL01095 DS    0H                                                  1096
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE IN MODEL READ KEY DATA CCW                     @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1096
*     IOXCCW(CCWCNT)=CCWRKD;        /*                       @Y30LB35*/
*                                                                  1096
         LH    @03,CCWCNT                                          1096
         SLA   @03,3                                               1096
         L     @01,IOCTLBKP                                        1096
         ALR   @01,@03                                             1096
         MVC   IOXCCW-8(8,@01),CCWRKD                              1096
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT THE READ COUNTER                          @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1097
*     READCNTA=READCNTA+1;          /*                       @ZA11014*/
*                                                                  1097
         LH    @03,READCNTA                                        1097
         LA    @03,1(,@03)                                         1097
         STH   @03,READCNTA                                        1097
*     /***************************************************************/
*     /*                                                             */
*     /* FILL IN THE DATA ADDRESS AND DATA LENGTH            @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1098
*     CCWADDR=EXGDATAP+OFFSET;      /*                       @Y30LB35*/
         LH    @03,CCWCNT                                          1098
         SLA   @03,3                                               1098
         L     @01,IOCTLBKP                                        1098
         LA    @03,IOXCCW-8(@03,@01)                               1098
         L     @15,@PC00001+8                                      1098
         LH    @14,OFFSET                                          1098
         AL    @14,EXGDATAP(,@15)                                  1098
         STCM  @14,7,CCWADDR(@03)                                  1098
*     CCWDATLN=EXGKEYLN+EXGDATAL;   /*                       @Y30LB35*/
*                                                                  1099
         LH    @03,CCWCNT                                          1099
         SLA   @03,3                                               1099
         L     @01,IOCTLBKP                                        1099
         LA    @03,IOXCCW-8(@03,@01)                               1099
         L     @15,@PC00001+8                                      1099
         L     @14,@PC00001+8                                      1099
         SLR   @07,@07                                             1099
         IC    @07,EXGKEYLN(,@15)                                  1099
         AH    @07,EXGDATAL(,@14)                                  1099
         STH   @07,CCWDATLN(,@03)                                  1099
*     /***************************************************************/
*     /*                                                             */
*     /* ADVANCE THE DATA ADDRESS OFFSET FOR NEXT CCW        @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1100
*     OFFSET=OFFSET+EXGKEYLN+EXGDATAL;/*                     @Y30LB35*/
         L     @03,@PC00001+8                                      1100
         SLR   @15,@15                                             1100
         IC    @15,EXGKEYLN(,@03)                                  1100
         AH    @15,OFFSET                                          1100
         L     @03,@PC00001+8                                      1100
         AH    @15,EXGDATAL(,@03)                                  1100
         STH   @15,OFFSET                                          1100
*   END;                            /*                       @Y30LB35*/
*                                                                  1101
         LA    @03,1                                               1101
         AH    @03,CCWCNT                                          1101
@DE01095 STH   @03,CCWCNT                                          1101
         CH    @03,LASTCCW                                         1101
         BNH   @DL01095                                            1101
*   /*****************************************************************/
*   /*                                                               */
*   /* BACK UP TO THE LAST CCW                               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1102
*   CCWCNT=CCWCNT-1;                /*                       @Y30LB35*/
*                                                                  1102
         LH    @03,CCWCNT                                          1102
         BCTR  @03,0                                               1102
         STH   @03,CCWCNT                                          1102
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN OFF THE COMMAND CHAINING BIT TO                  @Y30LB35*/
*   /* INDICATE THAT THIS IS END OF CCWS                     @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1103
*   CCWCMDCH=OFF;                   /*                       @Y30LB35*/
*                                                                  1103
         LH    @03,CCWCNT                                          1103
         SLA   @03,3                                               1103
         L     @01,IOCTLBKP                                        1103
         LA    @03,IOXCCW-8(@03,@01)                               1103
         NI    CCWCMDCH(@03),B'10111111'                           1103
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO PUTGET                         @Y30LB35*/
*   /* WITH A ZERO RETURN CODE IN REGISTER 15                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1104
*   TESTRC=0;                       /*                       @Y30LB35*/
         SLR   @03,@03                                             1104
         STH   @03,TESTRC                                          1104
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
         LH    @15,TESTRC                                          1105
         L     @14,12(,@13)                                        1105
         LM    @00,@12,20(@13)                                     1105
         BR    @14                                                 1105
*   END BLDCCWG;                    /*                       @Y30LB35*/
*                                                                  1107
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - ISSUEXCP                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             ISSUE THE I/O.  THIS IS DONE BY THE          @Y30LB35*/
*/*             FOLLOWING STEPS:                             @Y30LB35*/
*/*             ISSUES EXCP MACRO, ISSUES WAIT MACRO,        @Y30LB35*/
*/*             TESTS FOR I/O ERRORS AND CALLS SYNAD         @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOXIOB IN IOXCTLBK                           @Y30LB35*/
*/*             IOXECB IN IOXCTLBK                           @Y30LB35*/
*/*             READCNTA                                     @ZA11014*/
*/*             WRITECNT                                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXREADS IN IOXCTLBK                         @Y30LB35*/
*/*             IOXWRITE IN IOXCTLBK                         @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, IF I/O ERROR                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1107
*                                   /*                       @Y30LB35*/
*ISSUEXCP:                                                         1107
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1107
ISSUEXCP STM   @14,@12,@SA00014                                    1107
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1108
*   DCL                                                            1108
*     SUCCESS CHAR(1) STATIC INIT('7F'X);/*                  @Y30LB35*/
*                                                                  1109
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOXC' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1109
*   OLDERID2=NEWERID2;                                             1109
         L     @03,@PC00001                                        1109
         L     @03,GDTTR2(,@03)                                    1109
         L     @15,@PC00001                                        1109
         L     @01,GDTTR2(,@15)                                    1109
         MVC   @TS00001(95),NEWERID2(@01)                          1109
         MVC   OLDERID2(95,@03),@TS00001                           1109
*   NEWID2='IOXC';                  /*                       @Y30LB35*/
*                                                                  1110
         L     @03,@PC00001                                        1110
         L     @03,GDTTR2(,@03)                                    1110
         MVC   NEWID2(4,@03),@CC04262                              1110
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE ECB FOR IOS TO POST                    @Y30LB35*/
*   /* AFTER THE I/O HAS COMPLETED.                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1111
*   ECBPTR=ADDR(IOXECB);            /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1111
         LA    @03,IOXECB(,@03)                                    1111
         ST    @03,ECBPTR                                          1111
*   ECB=''B;                        /*                       @Y30LB35*/
         L     @03,ECBPTR                                          1112
         XC    ECB(4,@03),ECB(@03)                                 1112
*   TESTRC=0;                       /*                       @ZA28050*/
*                                                                  1113
         SLR   @03,@03                                             1113
         STH   @03,TESTRC                                          1113
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO THE IOB                      @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1114
*   RESPECIFY                                                      1114
*     REG1 RESTRICTED;              /*                       @Y30LB35*/
*   REG1=ADDR(IOXIOB);              /*                       @Y30LB35*/
*                                                                  1115
         L     REG1,IOCTLBKP                                       1115
         LA    REG1,IOXIOB(,REG1)                                  1115
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE EXCP TO PERFORM THE I/O                     @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1116
*LEXCP1:                                                           1116
*   GEN(EXCP   (REG1));             /*                       @Y30LB35*/
LEXCP1   EXCP   (REG1)
*   RESPECIFY                                                      1117
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/
*                                                                  1118
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE A TEST IS MADE TO DETERMINE WHETHER              @Y30LB35*/
*   /* THE I/O HAS COMPLETED IF NOT THE                      @Y30LB35*/
*   /* WAIT MACRO SHOULD BE ISSUED.                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1118
*   IF ECBPOSTB^=ON                 /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  1118
         L     @03,ECBPTR                                          1118
         TM    ECBPOSTB(@03),B'01000000'                           1118
         BO    @RF01118                                            1118
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE THE WAIT MACRO FOR THE I/O TO                 @Y30LB35*/
*     /* COMPLETE.                                           @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1119
*LWAIT1:                                                           1119
*     DO;                           /* WAIT ECB(ECB)                 */
LWAIT1   DS    0H                                                  1120
*       RESPECIFY                                                  1120
*        (GPR00P,                                                  1120
*         GPR01P) RESTRICTED;                                      1120
*       GPR00P=1;                   /* LOAD WAIT COUNT               */
         LA    GPR00P,1                                            1121
*       GPR01P=ADDR(ECB);           /* ADDRESS OF ECB                */
         L     GPR01P,ECBPTR                                       1122
*       SVC(1);                     /* WAIT SVC                      */
         SVC   1                                                   1123
*       RESPECIFY                                                  1124
*        (GPR00P,                                                  1124
*         GPR01P) UNRESTRICTED;                                    1124
*     END;                          /* WAIT ECB(ECB)         @Y30LB35*/
*                                                                  1125
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR A SUCCESSFUL I/O OPERATION                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1126
*   IF ECBCC^=SUCCESS               /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
@RF01118 L     @03,ECBPTR                                          1126
         CLC   ECBCC(1,@03),SUCCESS                                1126
         BE    @RF01126                                            1126
*     DO;                           /*                       @Y30LB35*/
*                                                                  1127
*       /*************************************************************/
*       /*                                                           */
*       /* UNSUCCESSFUL COMPLETION - CHECK TO SEE IF         @ZA11014*/
*       /* IT WAS A REPAIRV CALL                             @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1128
*       IF REQUEST^=OPEN            /*                       @ZA11014*/
*           &REQUEST^=PUT           /*                       @ZA11014*/
*           &REQUEST^=GET           /*                       @ZA11014*/
*           &REQUEST^=CLOSE         /*                       @ZA11014*/
*                                                                  1128
*       /*************************************************************/
*       /*                                                           */
*       /* A REPAIRV REQUEST-CHECK OTHER POSSIBLE            @ZA11014*/
*       /* POST CODES                                        @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1128
*         THEN                      /*                       @ZA11014*/
         L     @03,@PC00001+4                                      1128
         CLC   REQUEST(8,@03),OPEN                                 1128
         BE    @RF01128                                            1128
         L     @03,@PC00001+4                                      1128
         CLC   REQUEST(8,@03),PUT                                  1128
         BE    @RF01128                                            1128
         L     @03,@PC00001+4                                      1128
         CLC   REQUEST(8,@03),GET                                  1128
         BE    @RF01128                                            1128
         L     @03,@PC00001+4                                      1128
         CLC   REQUEST(8,@03),CLOSE                                1128
         BE    @RF01128                                            1128
*         DO;                       /*                       @ZA28050*/
*                                                                  1129
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF END OF FILE RECORD READ              @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1130
*           IF ECBCC=PCEOFIND       /*                       @ZA11014*/
*                                                                  1130
*           /*********************************************************/
*           /*                                                       */
*           /* SET RETURN CODE TO END OF FILE READ           @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1130
*             THEN                  /*                       @ZA11014*/
         L     @03,ECBPTR                                          1130
         CLC   ECBCC(1,@03),PCEOFIND                               1130
         BNE   @RF01130                                            1130
*             TESTRC=RCABEOFR;      /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABEOFR                                        1131
         STH   @03,TESTRC                                          1131
*           ELSE                    /*                       @ZA11014*/
*                                                                  1132
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF DESTAGE ERROR                      @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1132
*             IF ECBCC=PCDSTERR     /*                       @ZA11014*/
*                                                                  1132
*             /*******************************************************/
*             /*                                                     */
*             /* THEN SET DESTAGE ERROR RETURN CODE          @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1132
*               THEN                /*                       @ZA11014*/
         B     @RC01130                                            1132
@RF01130 L     @03,ECBPTR                                          1132
         CLC   ECBCC(1,@03),PCDSTERR                               1132
         BNE   @RF01132                                            1132
*               TESTRC=RCABDS;      /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABDS                                          1133
         STH   @03,TESTRC                                          1133
*             ELSE                  /*                       @ZA11014*/
*                                                                  1134
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK IF STAGE ERROR                      @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1134
*               IF ECBCC=PCSTGERR   /*                       @ZA11014*/
*                                                                  1134
*               /*****************************************************/
*               /*                                                   */
*               /* THEN SET STAGE ERROR RETURN CODE          @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1134
*                 THEN              /*                       @ZA11014*/
         B     @RC01132                                            1134
@RF01132 L     @03,ECBPTR                                          1134
         CLC   ECBCC(1,@03),PCSTGERR                               1134
         BNE   @RF01134                                            1134
*                 TESTRC=RCABST;    /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABST                                          1135
         STH   @03,TESTRC                                          1135
*               ELSE                /*                       @ZA11014*/
*                                                                  1136
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK IF OVERFLOW RECORD READ           @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1136
*                 IF ECBCC=PCOVFOK  /*                       @ZA11014*/
*                                                                  1136
*                 /***************************************************/
*                 /*                                                 */
*                 /* THEN SET OVERFLOW REC-DATA OK           @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1136
*                   THEN            /*                       @ZA11014*/
         B     @RC01134                                            1136
@RF01134 L     @03,ECBPTR                                          1136
         CLC   ECBCC(1,@03),PCOVFOK                                1136
         BNE   @RF01136                                            1136
*                   TESTRC=RCABOV;  /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABOV                                          1137
         STH   @03,TESTRC                                          1137
*                 ELSE              /*                       @ZA11014*/
*                                                                  1138
*                   /*************************************************/
*                   /*                                               */
*                   /* CHECK IF RECORD NOT FOUND             @ZA11014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1138
*                   IF ECBCC=PCNRF  /*                       @ZA11014*/
*                                                                  1138
*                   /*************************************************/
*                   /*                                               */
*                   /* THEN SET NO RECORD FOUND RETURN CODE  @ZA11014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1138
*                     THEN          /*                       @ZA11014*/
         B     @RC01136                                            1138
@RF01136 L     @03,ECBPTR                                          1138
         CLC   ECBCC(1,@03),PCNRF                                  1138
         BNE   @RF01138                                            1138
*                     TESTRC=RCABNRF;/*                      @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABNRF                                         1139
         STH   @03,TESTRC                                          1139
*                   ELSE            /*                       @ZA11014*/
*                                                                  1140
*                     /***********************************************/
*                     /*                                             */
*                     /* CHECK IF SYNC BYTE MISSING          @ZA11014*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1140
*                     IF ECBCC=PCSYNCER/*                    @ZA11014*/
*                                                                  1140
*                     /***********************************************/
*                     /*                                             */
*                     /* THEN SET SYNC BYTE MISSING RETURN CODE      */
*                     /*                                     @ZA11014*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1140
*                       THEN        /*                       @ZA11014*/
         B     @RC01138                                            1140
@RF01138 L     @03,ECBPTR                                          1140
         CLC   ECBCC(1,@03),PCSYNCER                               1140
         BNE   @RF01140                                            1140
*                       TESTRC=RCABSYNC;/*                   @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABSYNC                                        1141
         STH   @03,TESTRC                                          1141
*                     ELSE          /*                       @ZA11014*/
*                                                                  1142
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK IF PERMANENT DATA CHECK     @ZA11014*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1142
*                       IF ECBCC=PCDATCHK/*                  @ZA11014*/
*                                                                  1142
*                       /*********************************************/
*                       /*                                           */
*                       /* THEN SET DATA CHECK RETURN CODE   @ZA11014*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1142
*                         THEN      /*                       @ZA11014*/
         B     @RC01140                                            1142
@RF01140 L     @03,ECBPTR                                          1142
         CLC   ECBCC(1,@03),PCDATCHK                               1142
         BNE   @RF01142                                            1142
*                         TESTRC=RCABDTCK;/*                 @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCABDTCK                                        1143
         STH   @03,TESTRC                                          1143
*         END;                      /*                       @ZA28050
*                                                            @ZA11014*/
*                                                                  1144
@RF01142 DS    0H                                                  1144
@RC01140 DS    0H                                                  1144
@RC01138 DS    0H                                                  1144
@RC01136 DS    0H                                                  1144
@RC01134 DS    0H                                                  1144
@RC01132 DS    0H                                                  1144
@RC01130 DS    0H                                                  1145
*       /*************************************************************/
*       /*                                                           */
*       /* NOT A REPAIRV REQUEST-OR NOT A REPAIRV            @ZA11014*/
*       /* POST CODE                                         @ZA11014*/
*       /* IF I/O WAS UNSUCCESSFUL, THE                      @Y30LB35*/
*       /* SYNAD PROC IS CALLED TO HANDLE                    @Y30LB35*/
*       /* THE ERROR.                                        @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1145
*       IF TESTRC=0 THEN            /*                       @ZA28050*/
@RF01128 LH    @03,TESTRC                                          1145
         LTR   @03,@03                                             1145
         BNZ   @RF01145                                            1145
*         DO;                       /*                       @ZA28050*/
*           CALL SYNAD;             /*                       @Y30LB35*/
         BAL   @14,SYNAD                                           1147
*           TESTRC=4;               /*                       @Y30LB35*/
         MVC   TESTRC(2),@CH00045                                  1148
*         END;                      /*                       @ZA28050*/
*     END;                          /* I/O UNSUCCESSFUL      @ZA11014*/
*                                                                  1151
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE I/O WAS SUCCESSFUL, THE SUCCESSFUL             @Y30LB35*/
*   /* READS AND WRITES ARE ADDED TO PREVIOUS ONES.          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1151
*   ELSE                            /*                       @Y30LB35*/
*     DO;                           /*                       @Y30LB35*/
*                                                                  1151
         B     @RC01126                                            1151
@RF01126 DS    0H                                                  1152
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT THE READ AND WRITE COUNTERS             @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1152
*       IOXREADS=IOXREADS+READCNTA; /*                       @ZA11014*/
         LH    @03,READCNTA                                        1152
         L     @01,IOCTLBKP                                        1152
         AL    @03,IOXREADS(,@01)                                  1152
         L     @01,IOCTLBKP                                        1152
         ST    @03,IOXREADS(,@01)                                  1152
*       IOXWRITE=IOXWRITE+WRITECNT; /*                       @Y30LB35*/
         LH    @03,WRITECNT                                        1153
         L     @01,IOCTLBKP                                        1153
         AL    @03,IOXWRITE(,@01)                                  1153
         L     @01,IOCTLBKP                                        1153
         ST    @03,IOXWRITE(,@01)                                  1153
*     END;                          /*                       @Y30LB35*/
*                                                                  1154
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED WITH                              @ZA11014*/
*   /* A RETURN CODE 0 IF SUCCESSFUL OR 4 IF ERRORS          @Y30LB35*/
*   /* FOR NON-REPAIRV REQUESTS                              @ZA11014*/
*   /* FOR REPAIRV REQUESTS THE RETURN CODE COULD            @ZA11014*/
*   /* INDICATE THE POST CODE FROM THE ABE APPENDAGE@ZA11014         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RC01126 LH    @15,TESTRC                                          1155
         L     @14,@SA00014                                        1155
         LM    @00,@12,@SA00014+8                                  1155
         BR    @14                                                 1155
*   END ISSUEXCP;                   /*                       @Y30LB35*/
*                                                                  1157
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - CLOSESTD                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             CLEAN UP AND CLOSE THE DCB BEING PROCESSED.  @Y30LB35*/
*/*             THIS IS DONE BY THE FOLLOWING STEPS:         @Y30LB35*/
*/*             ISSUES CLOSE MACRO AND ISSUES UPRINT         @Y30LB35*/
*/*             IF IOXABEND BIT IS SET.                      @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             MSG IDC2374I IS ISSUED IF CLOSE EXIT TAKEN   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOXTYPE IN IOXCTLBK                          @Y30LB35*/
*/*             IOXABEND IN IOXCTLBK                         @Y30LB35*/
*/*             CLOSELST                                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DARGSMOD IN DARGLIST                         @Y30LB35*/
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/
*/*             DARGDBP IN DARGLIST                          @Y30LB35*/
*/*             DARGILP IN DARGLIST                          @Y30LB35*/
*/*             JFCBPTR                                      @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN CLOSE              @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1157
*                                   /*                       @Y30LB35*/
*CLOSESTD:                                                         1157
*   PROC;                           /*                       @Y30LB35*/
CLOSESTD STM   @14,@12,@SA00015                                    1157
*   RESPECIFY                                                      1158
*    (REG1,                                                        1158
*     REG3) RSTD;                   /*                       @Y30LB35*/
*                                                                  1158
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOCS' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1159
*   OLDERID2=NEWERID2;                                             1159
         L     @15,@PC00001                                        1159
         L     @15,GDTTR2(,@15)                                    1159
         L     @14,@PC00001                                        1159
         L     @14,GDTTR2(,@14)                                    1159
         MVC   @TS00001(95),NEWERID2(@14)                          1159
         MVC   OLDERID2(95,@15),@TS00001                           1159
*   NEWID2='IOCS';                  /*                       @Y30LB35*/
*                                                                  1160
         L     @15,@PC00001                                        1160
         L     @15,GDTTR2(,@15)                                    1160
         MVC   NEWID2(4,@15),@CC04271                              1160
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CLOSE PARMS ARE INITIALIZED                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1161
*   REG1=ADDR(PARMLIST);            /*                       @Y30LB35*/
         LA    REG1,PARMLIST                                       1161
*   PARMLIST=''B;                   /*                       @Y30LB35*/
         XC    PARMLIST(20),PARMLIST                               1162
*   PARMLIST=CLOSELST;              /*                       @Y30LB35*/
         MVI   PARMLIST+8,C' '                                     1163
         MVC   PARMLIST+9(11),PARMLIST+8                           1163
         MVC   PARMLIST(8),CLOSELST                                1163
*   REG3=ADDR(IOXDCB);              /*                       @Y30LB35*/
         L     REG3,IOCTLBKP                                       1164
         LA    REG3,IOXDCB(,REG3)                                  1164
*                                                                  1165
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE IS ISSUED CLOSING THE DCB                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1165
*LCLOSE1:                                                          1165
*   GEN(CLOSE ((REG3)),MF=(E,(REG1)));/*                     @Y30LB35*/
LCLOSE1  CLOSE ((REG3)),MF=(E,(REG1))
*   RESPECIFY                                                      1166
*    (REG1,                                                        1166
*     REG3) UNRSTD;                 /*                       @Y30LB35*/
*                                                                  1166
*   /*****************************************************************/
*   /*                                                               */
*   /* A TEST IS MADE TO DETERMINE IF CLOSE                  @Y30LB35*/
*   /* WAS SUCCESSFUL OR THE CLOSE ABEND EXIT                @Y30LB35*/
*   /* WAS ENTERED.                                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1167
*   IF IOXABEND=ON                  /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1167
         TM    IOXABEND(@03),B'01000000'                           1167
         BNO   @RF01167                                            1167
*     DO;                           /*                       @Y30LB35*/
*                                                                  1168
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE DARGLIST                           @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1169
*       DARGLIST=''B;               /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1169
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1169
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1170
         MVC   DARGSMOD(3,@03),@CC03785                            1170
*       DARGSENT=MSG2374I;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1171
         MVI   DARGSENT(@03),X'07'                                 1171
*                                                                  1172
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHETHER THE DSN NAME                    @Y30LB35*/
*       /* SHOULD BE USED AS THE INSERT                      @Y30LB35*/
*       /* OR THE NAME "VTOC"                                @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1172
*       IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/* @Y30LB35*/
         L     @03,IOCTLBKP                                        1172
         CLC   IOXTYPE(1,@03),LAB                                  1172
         BE    @RF01172                                            1172
         L     @03,IOCTLBKP                                        1172
         CLC   IOXTYPE(1,@03),NEWVOL                               1172
         BE    @RF01172                                            1172
         L     @03,IOCTLBKP                                        1172
         CLC   IOXTYPE(1,@03),VTOC                                 1172
         BE    @RF01172                                            1172
*         DO;                       /*                       @Y30LB35*/
*                                                                  1173
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE THE DSN INSERT PTRS                @Y30LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1174
*           JFCBPTR=ADDR(IOXJFCB);  /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1174
         LA    @03,IOXJFCB(,@03)                                   1174
         ST    @03,JFCBPTR                                         1174
*           DARGDBP=ADDR(JFCBDSNM); /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         1175
         L     @01,DDSTRU                                          1175
         ST    @03,DARGDBP(,@01)                                   1175
*           DARGILP=LENGTH(JFCBDSNM);/*                      @Y30LB35*/
         L     @03,DDSTRU                                          1176
         MVC   DARGILP(2,@03),@CH00849                             1176
*         END;                      /*                       @Y30LB35*/
*       ELSE                        /*                       @Y30LB35*/
*         DO;                       /*                       @Y30LB35*/
*                                                                  1178
         B     @RC01172                                            1178
@RF01172 DS    0H                                                  1179
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE THE "VTOC" INSERT PTRS             @Y30LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1179
*           DARGDBP=ADDR(VTOCINST); /*                       @Y30LB35*/
         LA    @03,VTOCINST                                        1179
         L     @01,DDSTRU                                          1179
         ST    @03,DARGDBP(,@01)                                   1179
*           DARGILP=LENGTH(VTOCINST);/*                      @Y30LB35*/
         L     @03,DDSTRU                                          1180
         MVC   DARGILP(2,@03),@CH00045                             1180
*         END;                      /*                       @Y30LB35*/
*                                                                  1181
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT TO SEND MESSAGE TO SYSPRINT          @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1182
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/
*                                                                  1182
@RC01172 L     @03,@PC00001                                        1182
         ST    @03,@AL00001                                        1182
         LA    @03,@CF00119                                        1182
         ST    @03,@AL00001+4                                      1182
         LA    @03,DDSTRU                                          1182
         ST    @03,@AL00001+8                                      1182
         MVI   @AL00001+8,X'80'                                    1182
         L     @03,@PC00001                                        1182
         L     @15,GDTPRT(,@03)                                    1182
         LA    @01,@AL00001                                        1182
         BALR  @14,@15                                             1182
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP ERROR CODE RCFAIL(4)                       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1183
*       TESTRC=4;                   /*                       @Y30LB35*/
         MVC   TESTRC(2),@CH00045                                  1183
*     END;                          /*                       @Y30LB35*/
*                                                                  1184
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CLOSEPRC WITH RETURN           @Y30LB35*/
*   /* CODE IN REG 15 OF 0 SUCCESSFUL OR 4 ERROR.            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1185
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF01167 LH    @15,TESTRC                                          1185
         L     @14,@SA00015                                        1185
         LM    @00,@12,@SA00015+8                                  1185
         BR    @14                                                 1185
*   END CLOSESTD;                   /*                       @Y30LB35*/
*                                                                  1187
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - CLOSENEW                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             CLEAN UP AND CLOSE THE DCB BEING PROCESSED.  @Y30LB35*/
*/*             THE DIFFERENCE BETWEEN THIS ROUTINE AND      @Y30LB35*/
*/*             CLOSESTD IS THAT A PSEUDO OPEN WAS PERFORMED @Y30LB35*/
*/*             BY SVC 82 INITIALLY.                         @Y30LB35*/
*/*             THIS IS DONE BY ISSUING SVC 82 (DASDR SVC)   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOXUCBP IN IOXCTLBK                          @Y30LB35*/
*/*             DCBDEBAD IN IOXDCB                           @Y30LB35*/
*/*             SVC82CLS                                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    SV82CODE IN SV82LIST                         @Y30LB35*/
*/*             SV82UCBP IN SV82LIST                         @Y30LB35*/
*/*             SV82DEBP IN SV82LIST                         @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1187
*                                   /*                       @Y30LB35*/
*CLOSENEW:                                                         1187
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1187
CLOSENEW STM   @14,@12,12(@13)                                     1187
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOON' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1188
*   OLDERID2=NEWERID2;                                             1188
         L     @03,@PC00001                                        1188
         L     @03,GDTTR2(,@03)                                    1188
         L     @15,@PC00001                                        1188
         L     @01,GDTTR2(,@15)                                    1188
         MVC   @TS00001(95),NEWERID2(@01)                          1188
         MVC   OLDERID2(95,@03),@TS00001                           1188
*   NEWID2='IOON';                  /*                       @Y30LB35*/
*                                                                  1189
         L     @03,@PC00001                                        1189
         L     @03,GDTTR2(,@03)                                    1189
         MVC   NEWID2(4,@03),@CC04211                              1189
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SVC 82 ARGUMENT LIST FOR                   @Y30LB35*/
*   /* PSEUDO CLOSE                                          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1190
*   SV82LIST=''B;                   /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        1190
         XC    SV82LIST(16,@03),SV82LIST(@03)                      1190
*   SV82CODE=SVC82CLS;              /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        1191
         MVC   SV82CODE(1,@03),SVC82CLS                            1191
*   SV82UCBP=IOXUCBP;               /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        1192
         L     @01,IOCTLBKP                                        1192
         MVC   SV82UCBP(3,@03),IOXUCBP+1(@01)                      1192
*   SV82DEBP=DCBDEBAD;              /*                       @Y30LB35*/
         LA    @03,SVC82ARG                                        1193
         L     @01,DCBPTR                                          1193
         L     @15,DCBDEBAD+40(,@01)                               1193
         ST    @15,SV82DEBP(,@03)                                  1193
*   RESPECIFY                                                      1194
*     REG1 RESTRICTED;              /*                       @Y30LB35*/
*   REG1=ADDR(SV82LIST);            /*                       @Y30LB35*/
         LA    REG1,SVC82ARG                                       1195
*                                                                  1196
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE SVC 82 TO CLOSE DCB                             @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1196
*L82SVC2:                           /*                       @Y30LB35*/
*   SVC(82);                        /*                       @Y30LB35*/
L82SVC2  SVC   82                                                  1196
*   RESPECIFY                                                      1197
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/
*                                                                  1197
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CLOSEPRC WITH                  @Y30LB35*/
*   /* RETURN CODE IN REGISTER 15 0.                         @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1198
*   RETURN CODE(0);                 /*                       @Y30LB35*/
         SLR   @15,@15                                             1198
         L     @14,12(,@13)                                        1198
         LM    @00,@12,20(@13)                                     1198
         BR    @14                                                 1198
*   END CLOSENEW;                   /*                       @Y30LB35*/
*                                                                  1200
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - CHECKOPN                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  TESTS TO SEE IF OPEN ABEND EXIT              @Y30LB35*/
*/*             WAS NOT ENTERED OR DCBOFLAGS INDICATES DCB   @Y30LB35*/
*/*             NOT OPENED AND ISSUES UPRINT MACRO.          @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             MSG IDC3300I IS ISSUED IF OPEN FAILED        @Y30LB35*/
*/*             MSG IDC2372I IS ISSUED IF OPEN ABEND TAKEN   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOXABEND IN IOXCTLBK                         @Y30LB35*/
*/*             DCBOFOPN IN IOXDCB                           @Y30LB35*/
*/*             IOXTYPE IN IOXCTLBK                          @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DARGSMOD IN DARGLIST                         @Y30LB35*/
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/
*/*             DARGDBP IN DARGLIST                          @Y30LB35*/
*/*             DARGILP IN DARGLIST                          @Y30LB35*/
*/*             USERIOBP IN CALLER'S CORE                    @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR DCB NOT OPENED        @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1200
*                                   /*                       @Y30LB35*/
*CHECKOPN:                                                         1200
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1200
CHECKOPN STM   @14,@12,@SA00017                                    1200
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOCK' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1201
*   OLDERID2=NEWERID2;                                             1201
         L     @03,@PC00001                                        1201
         L     @03,GDTTR2(,@03)                                    1201
         L     @15,@PC00001                                        1201
         L     @01,GDTTR2(,@15)                                    1201
         MVC   @TS00001(95),NEWERID2(@01)                          1201
         MVC   OLDERID2(95,@03),@TS00001                           1201
*   NEWID2='IOCK';                  /*                       @Y30LB35*/
*                                                                  1202
         L     @03,@PC00001                                        1202
         L     @03,GDTTR2(,@03)                                    1202
         MVC   NEWID2(4,@03),@CC04282                              1202
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE IF OPEN ABEND EXIT WAS ENTERED            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1203
*   IF IOXABEND=ON                  /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1203
         TM    IOXABEND(@03),B'01000000'                           1203
         BNO   @RF01203                                            1203
*     DO;                           /*                       @Y30LB35*/
*                                                                  1204
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE DARGLIST TO ISSUE                      @Y30LB35*/
*       /* "IDC2372I OPEN ABEND EXIT (DSN/VTOC)"             @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1205
*       DARGLIST=''B;               /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1205
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1205
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1206
         MVC   DARGSMOD(3,@03),@CC03785                            1206
*       DARGSENT=MSG2372I;          /*                       @Y30LB35*/
*                                                                  1207
         L     @03,DDSTRU                                          1207
         MVI   DARGSENT(@03),X'03'                                 1207
*       /*************************************************************/
*       /*                                                           */
*       /* TEST TO SEE IF INSERT "VTOC" SHOULD BE USED       @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1208
*       IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/* @Y30LB35*/
*                                                                  1208
         L     @03,IOCTLBKP                                        1208
         CLC   IOXTYPE(1,@03),LAB                                  1208
         BE    @RF01208                                            1208
         L     @03,IOCTLBKP                                        1208
         CLC   IOXTYPE(1,@03),NEWVOL                               1208
         BE    @RF01208                                            1208
         L     @03,IOCTLBKP                                        1208
         CLC   IOXTYPE(1,@03),VTOC                                 1208
         BE    @RF01208                                            1208
*         /***********************************************************/
*         /*                                                         */
*         /* THE DSN SHOULD BE USED AND IS INITIALIZED       @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1209
*         DO;                       /*                       @Y30LB35*/
*           DARGDBP=ADDR(JFCBDSNM); /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         1210
         L     @01,DDSTRU                                          1210
         ST    @03,DARGDBP(,@01)                                   1210
*           DARGILP=LENGTH(JFCBDSNM);/*                      @Y30LB35*/
         L     @03,DDSTRU                                          1211
         MVC   DARGILP(2,@03),@CH00849                             1211
*         END;                      /*                       @Y30LB35*/
*                                                                  1212
*       /*************************************************************/
*       /*                                                           */
*       /* IF NOT THE "VTOC" IS INITIALIZED INSTEAD          @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1213
*       ELSE                        /*                       @Y30LB35*/
*         DO;                       /*                       @Y30LB35*/
         B     @RC01208                                            1213
@RF01208 DS    0H                                                  1214
*           DARGDBP=ADDR(VTOCINST); /*                       @Y30LB35*/
         LA    @03,VTOCINST                                        1214
         L     @01,DDSTRU                                          1214
         ST    @03,DARGDBP(,@01)                                   1214
*           DARGILP=LENGTH(VTOCINST);/*                      @Y30LB35*/
         L     @03,DDSTRU                                          1215
         MVC   DARGILP(2,@03),@CH00045                             1215
*         END;                      /*                       @Y30LB35*/
*                                                                  1216
*       /*************************************************************/
*       /*                                                           */
*       /* CALL UPRINT TO ISSUE THE ERROR MESSAGE            @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1217
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/
*                                                                  1217
@RC01208 L     @03,@PC00001                                        1217
         ST    @03,@AL00001                                        1217
         LA    @03,@CF00119                                        1217
         ST    @03,@AL00001+4                                      1217
         LA    @03,DDSTRU                                          1217
         ST    @03,@AL00001+8                                      1217
         MVI   @AL00001+8,X'80'                                    1217
         L     @03,@PC00001                                        1217
         L     @15,GDTPRT(,@03)                                    1217
         LA    @01,@AL00001                                        1217
         BALR  @14,@15                                             1217
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE ERROR CODE TO RCFAIL(4)                   @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1218
*       TESTRC=4;                   /*                       @Y30LB35*/
         MVC   TESTRC(2),@CH00045                                  1218
*     END;                          /*                       @Y30LB35*/
*                                                                  1220
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE IF THE DCBOFLAG X'10' IS SET              @Y30LB35*/
*   /* INDICATING THE DATA SET WAS OPENED OR NOT.            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1220
*   IF IOXABEND^=ON&DCBOFOPN^=ON    /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  1220
@RF01203 L     @03,IOCTLBKP                                        1220
         TM    IOXABEND(@03),B'01000000'                           1220
         BO    @RF01220                                            1220
         L     @03,DCBPTR                                          1220
         TM    DCBOFOPN+40(@03),B'00010000'                        1220
         BO    @RF01220                                            1220
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE DCBOFLAG IN DCBOFLAGS IS NOT                 @Y30LB35*/
*     /* SET PREPARE THE DARGLIST TO ISSUE                   @Y30LB35*/
*     /* "IDC3300I UNABLE TO OPEN (DSN/VTOC)"                @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1221
*     DO;                           /*                       @Y30LB35*/
*       DARGLIST=''B;               /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1222
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1222
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1223
         MVC   DARGSMOD(3,@03),@CC03785                            1223
*       DARGSENT=MSG3300I;          /*                       @Y30LB35*/
*                                                                  1224
         L     @03,DDSTRU                                          1224
         MVI   DARGSENT(@03),X'04'                                 1224
*       /*************************************************************/
*       /*                                                           */
*       /* TEST WHICH INSERT IS IN ORDER                     @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1225
*       IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/* @Y30LB35*/
*                                                                  1225
         L     @03,IOCTLBKP                                        1225
         CLC   IOXTYPE(1,@03),LAB                                  1225
         BE    @RF01225                                            1225
         L     @03,IOCTLBKP                                        1225
         CLC   IOXTYPE(1,@03),NEWVOL                               1225
         BE    @RF01225                                            1225
         L     @03,IOCTLBKP                                        1225
         CLC   IOXTYPE(1,@03),VTOC                                 1225
         BE    @RF01225                                            1225
*         /***********************************************************/
*         /*                                                         */
*         /* IF USER IS WORKING ON DATASET PREPARE           @Y30LB35*/
*         /* THE DSN INSERT.                                 @Y30LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1226
*         DO;                       /*                       @Y30LB35*/
*           DARGDBP=ADDR(JFCBDSNM); /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         1227
         L     @01,DDSTRU                                          1227
         ST    @03,DARGDBP(,@01)                                   1227
*           DARGILP=LENGTH(JFCBDSNM);/*                      @Y30LB35*/
         L     @03,DDSTRU                                          1228
         MVC   DARGILP(2,@03),@CH00849                             1228
*         END;                      /*                       @Y30LB35*/
*                                                                  1230
*       /*************************************************************/
*       /*                                                           */
*       /* IF USER IS WORKING ON VTOC PREPARE                @Y30LB35*/
*       /* "VTOC" INSERT.                                    @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1230
*       ELSE                        /*                       @Y30LB35*/
*         DO;                       /*                       @Y30LB35*/
         B     @RC01225                                            1230
@RF01225 DS    0H                                                  1231
*           DARGDBP=ADDR(VTOCINST); /*                       @Y30LB35*/
         LA    @03,VTOCINST                                        1231
         L     @01,DDSTRU                                          1231
         ST    @03,DARGDBP(,@01)                                   1231
*           DARGILP=LENGTH(VTOCINST);/*                      @Y30LB35*/
         L     @03,DDSTRU                                          1232
         MVC   DARGILP(2,@03),@CH00045                             1232
*         END;                      /*                       @Y30LB35*/
*                                                                  1233
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT TO SEND ERROR MESSAGE                @Y30LB35*/
*       /* TO THE SYSPRINT                                   @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1234
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/
*                                                                  1234
@RC01225 L     @03,@PC00001                                        1234
         ST    @03,@AL00001                                        1234
         LA    @03,@CF00119                                        1234
         ST    @03,@AL00001+4                                      1234
         LA    @03,DDSTRU                                          1234
         ST    @03,@AL00001+8                                      1234
         MVI   @AL00001+8,X'80'                                    1234
         L     @03,@PC00001                                        1234
         L     @15,GDTPRT(,@03)                                    1234
         LA    @01,@AL00001                                        1234
         BALR  @14,@15                                             1234
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE ERROR CODE RCFAIL(4)                      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1235
*       TESTRC=4;                   /*                       @Y30LB35*/
         MVC   TESTRC(2),@CH00045                                  1235
*     END;                          /*                       @Y30LB35*/
*                                                                  1236
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CALLING PROC                   @Y30LB35*/
*   /* WITH A RETURN CODE 0 OR 4 IN REGISTER 15              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1237
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF01220 LH    @15,TESTRC                                          1237
         L     @14,@SA00017                                        1237
         LM    @00,@12,@SA00017+8                                  1237
         BR    @14                                                 1237
*   END CHECKOPN;                   /*                       @Y30LB35*/
*                                                                  1239
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - RETRY                                   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  RETRY FROM A RACF OR PASSWORD ABEND          @G24LB31*/
*/*             FROM THE SYSTEM                              @G24LB31*/
*/*             OR VTOC OPEN ABEND ISSUE UPRINT, AND RETURN  @Z40LB35*/
*/*             TO THE INSTRUCTION AFTER THE OPEN MACRO.     @Z40LB35*/
*/*                                                          @Y30LB35*/
*/*             MESSAGE IDC2373I IS ISSUED FOR BAD PASSWORD  @G24LB31*/
*/*             MSG IDC2917I IS ISSUED FOR NO RACF PROFILE   @G24LB31*/
*/*             MSG IDC2918I IS ISSUED FOR BAD RACF CHECK    @G24LB31*/
*/*                                                          @Y30LB35*/
*/* INPUT -     STAEWORK FROM SYSTEM                         @Y30LB35*/
*/*             SAHSTA FROM HISTORIAL DATA AREA              @Y30LB35*/
*/*             IOXJFCB IN IOXCTLBK                          @Y30LB35*/
*/*             STAEPARM                                     @Y30LB35*/
*/*             STARTSAV                                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DARGSMOD IN DARGLIST                         @Y30LB35*/
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/
*/*             DARGILP  IN DARGLIST                         @Y30LB35*/
*/*             DARGDBP  IN DARGLIST                         @Y30LB35*/
*/*             REGISTERS 0 THRU 14                          @Y30LB35*/
*/*             JFCBPTR                                      @Y30LB35*/
*/*             REGISTER 15 = 4, PASSWORD ABEND              @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1239
*RETRY:                                                            1239
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB35*/
*                                                                  1239
RETRY    DS    0H                                                  1240
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1240
*   DCL                                                            1240
*     SDWAPTR REGISTER(4) RSTD;     /*                       @Y30LB35
*                                      POINTER TO SDWA       @Y30LB35*/
*                                                                  1241
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTRICT REGISTERS AND SET UP                         @Y30LB35*/
*   /* ADDRESSABILITY TO STAEPARM.                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1241
*   RESPECIFY                                                      1241
*     STAEPARM BASED(SDWAPARM);     /*                       @Y30LB35*/
*   RESPECIFY                                                      1242
*    (REG3,                                                        1242
*     REG1,                                                        1242
*     REG0) RSTD;                   /*                       @Y30LB35*/
*                                                                  1242
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDRESSABILITY TO SDWA                                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1243
*   SDWAPTR=REG1;                   /*                       @Y30LB35*/
*                                                                  1243
         LR    SDWAPTR,REG1                                        1243
*   /*****************************************************************/
*   /*                                                               */
*   /* PICK UP SAVE AREA ADDRESS AND RESTORE                 @Y30LB35*/
*   /* REGISTERS TO THE CONTENTS BEFORE THE                  @Y30LB35*/
*   /* USTAE WAS ISSUED IN THE OPNPASS PROC.                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1244
*   REG3=STARTSAV;                  /*                       @Y30LB35*/
         L     @05,SDWAPARM(,SDWAPTR)                              1244
         L     REG3,STARTSAV(,@05)                                 1244
*   GEN(LM  REG5,REG15,20(REG3));   /*                       @Y30LB35*/
         LM  REG5,REG15,20(REG3)
*   GEN(L   REG2,8(REG3));          /*                       @Y30LB35*/
*                                                                  1246
         L   REG2,8(REG3)
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THAT THE REGISTERS HAVE BEEN RESTORED             @Y30LB35*/
*   /* THE ADDRESSABILITY TO STAEPARM CAN BE                 @Y30LB35*/
*   /* REESTABLISHED.                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1247
*   RESPECIFY                                                      1247
*     STAEPARM BASED(SAHSTA);       /*                       @Y30LB35*/
*                                                                  1247
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IORT' IN TRACE TABLE              @Y30LB35*/
*   /* THIS WOULD ORDINARILY BE THE FIRST                    @Y30LB35*/
*   /* INSTRUCTION IN THE PROCEDURE, HOWEVER,                @Y30LB35*/
*   /* THE ADDRESS OF SDWA MUST BE MOVED FROM                @Y30LB35*/
*   /* REGISTER 1 BEFORE PLS USES REG1.                      @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1248
*   OLDERID2=NEWERID2;                                             1248
         L     @05,@PC00001                                        1248
         L     @05,GDTTR2(,@05)                                    1248
         L     @15,@PC00001                                        1248
         L     @15,GDTTR2(,@15)                                    1248
         MVC   @TS00001(95),NEWERID2(@15)                          1248
         MVC   OLDERID2(95,@05),@TS00001                           1248
*   NEWID2='IORT';                  /*                       @Y30LB35*/
*                                                                  1249
         L     @05,@PC00001                                        1249
         L     @05,GDTTR2(,@05)                                    1249
         MVC   NEWID2(4,@05),@CC04288                              1249
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE A TEST IS MADE TO DETERMINE IF VTOC              @Z40LB35*/
*   /* ABEND OR A RACF/PASSWORD ABEND HAS OCCURRED           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1250
*   IF STAIO05=ON THEN                                             1250
         L     @05,@PC00001                                        1250
         L     @05,GDTSAH(,@05)                                    1250
         L     @05,SAHSTA(,@05)                                    1250
         TM    STAIO05(@05),B'10000000'                            1250
         BNO   @RF01250                                            1250
*     DO;                           /*                       @Z40LB35*/
*                                                                  1251
*       /*************************************************************/
*       /*                                                           */
*       /* TURN OFF RETRY BIT                                @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1252
*       STAIO05=OFF;                /*                       @Z40LB35*/
*                                                                  1252
         L     @05,@PC00001                                        1252
         L     @05,GDTSAH(,@05)                                    1252
         L     @05,SAHSTA(,@05)                                    1252
         NI    STAIO05(@05),B'01111111'                            1252
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO THE DARGLIST TO SETUP MSG FOR PRINTING       @G24LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1253
*       DARGLIST=''B;               /*                       @Z40LB35*/
*                                                                  1253
         L     @05,DDSTRU                                          1253
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1253
*       /*************************************************************/
*       /*                                                           */
*       /* REESTABLISH ADDRESSABILITY TO THE JFCB            @Y30LB35*/
*       /* AND CONTINUE TO SET DARGLIST                      @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1254
*       JFCBPTR=ADDR(IOXJFCB);      /*                       @Z40LB35*/
         L     @05,IOCTLBKP                                        1254
         LA    @05,IOXJFCB(,@05)                                   1254
         ST    @05,JFCBPTR                                         1254
*       DARGDBP=ADDR(JFCBDSNM);     /*                       @Z40LB35*/
         L     @05,JFCBPTR                                         1255
         L     @15,DDSTRU                                          1255
         ST    @05,DARGDBP(,@15)                                   1255
*       DARGILP=LENGTH(JFCBDSNM);   /*                       @Z40LB35*/
*                                                                  1256
         L     @05,DDSTRU                                          1256
         MVC   DARGILP(2,@05),@CH00849                             1256
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK ABEND RET.CODE AND SETUP APPRO MSG.         @G24LB31*/
*       /* NOTE THAT A VSAM DATASPACE OPENED WITH A DCB      @G24LB31*/
*       /* AS NON-VSAM WILL ABEND WITH 913-0C NOT -56/60     @G24LB31*/
*       /* IF A RACF AUTHORIZATION CHECK FAILS FOR IT.       @G24LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1257
*       IF SDWAGR15=RCPSWD12 THEN   /*                       @G24LB31*/
         CLC   SDWAGR15(4,SDWAPTR),RCPSWD12                        1257
         BNE   @RF01257                                            1257
*         DO;                       /*                       @G24LB31*/
*           DARGSMOD=IO05MSGS;      /*                       @Z40LB35*/
         L     @05,DDSTRU                                          1259
         MVC   DARGSMOD(3,@05),@CC03785                            1259
*           DARGSENT=MSG2376I;      /* INVALID RACF/PSWD     @G24LB31*/
         L     @05,DDSTRU                                          1260
         MVI   DARGSENT(@05),X'0A'                                 1260
*         END;                      /*                       @G24LB31*/
*       ELSE                        /*                       @G24LB31*/
*         IF SDWAGR15=RCRACF56 THEN /*                       @G24LB31*/
         B     @RC01257                                            1262
@RF01257 CLC   SDWAGR15(4,SDWAPTR),RCRACF56                        1262
         BNE   @RF01262                                            1262
*           DO;                     /*                       @G24LB31*/
*             DARGSMOD=SA0MSGS;     /*                       @G24LB31*/
         L     @05,DDSTRU                                          1264
         MVC   DARGSMOD(3,@05),@CC03787                            1264
*             DARGSENT=MSG2918I;    /* NOT RACF AUTH         @G24LB31*/
         L     @05,DDSTRU                                          1265
         MVI   DARGSENT(@05),X'0A'                                 1265
*           END;                    /*                       @G24LB31*/
*         ELSE                      /*                       @G24LB31*/
*           IF SDWAGR15=RCRACF60 THEN/*                      @G24LB31*/
         B     @RC01262                                            1267
@RF01262 CLC   SDWAGR15(4,SDWAPTR),RCRACF60                        1267
         BNE   @RF01267                                            1267
*             DO;                   /*                       @G24LB31*/
*               DARGSMOD=SA0MSGS;   /*                       @G24LB31*/
         L     @05,DDSTRU                                          1269
         MVC   DARGSMOD(3,@05),@CC03787                            1269
*               DARGSENT=MSG2917I;  /* NO RACF PROFILE       @G24LB31*/
         L     @05,DDSTRU                                          1270
         MVI   DARGSENT(@05),X'09'                                 1270
*             END;                  /*                       @G24LB31*/
*     END;                          /*                       @Z40LB35*/
*   ELSE                                                           1273
*                                                                  1273
*     /***************************************************************/
*     /*                                                             */
*     /* IF VTOC ABEND, PREPARE ABEND ENTERED MESSAGE        @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1273
*     DO;                           /*                       @Z40LB35*/
*                                                                  1273
         B     @RC01250                                            1273
@RF01250 DS    0H                                                  1274
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE DARGLIST TO ISSUE                      @Z40LB35*/
*       /* "IDC2372I OPEN ABEND EXIT (VTOC)"                 @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1274
*       DARGLIST=''B;               /*                       @Z40LB35*/
         L     @05,DDSTRU                                          1274
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1274
*       DARGSMOD=IO05MSGS;          /*                       @Z40LB35*/
         L     @05,DDSTRU                                          1275
         MVC   DARGSMOD(3,@05),@CC03785                            1275
*       DARGSENT=MSG2372I;          /*                       @Z40LB35*/
         L     @05,DDSTRU                                          1276
         MVI   DARGSENT(@05),X'03'                                 1276
*       DARGDBP=ADDR(VTOCINST);     /*                       @Z40LB35*/
         LA    @05,VTOCINST                                        1277
         L     @15,DDSTRU                                          1277
         ST    @05,DARGDBP(,@15)                                   1277
*       DARGILP=LENGTH(VTOCINST);   /*                       @Z40LB35*/
         L     @05,DDSTRU                                          1278
         MVC   DARGILP(2,@05),@CH00045                             1278
*     END;                          /*                       @Z40LB35*/
*                                                                  1279
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE MESSAGE IS SENT TO USERS LISTING             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1280
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  #Y30LB35*/
*                                                                  1280
@RC01250 L     @05,@PC00001                                        1280
         ST    @05,@AL00001                                        1280
         LA    @05,@CF00119                                        1280
         ST    @05,@AL00001+4                                      1280
         LA    @05,DDSTRU                                          1280
         ST    @05,@AL00001+8                                      1280
         MVI   @AL00001+8,X'80'                                    1280
         L     @05,@PC00001                                        1280
         L     @15,GDTPRT(,@05)                                    1280
         LA    @01,@AL00001                                        1280
         BALR  @14,@15                                             1280
*   /*****************************************************************/
*   /*                                                               */
*   /* THE SDWA IS FREED UP AS IT IS NO LONGER               @G24LB31*/
*   /* NEEDED.                                               @G24LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1281
*   REG0=LENGTH(SDWA);              /*                       @G24LB31*/
         LA    REG0,512                                            1281
*   REG1=ADDR(SDWA);                /*                       @G24LB31*/
         LR    REG1,SDWAPTR                                        1282
*LFREM1:                                                           1283
*   GEN(FREEMAIN  R,LV=(0),A=(1));  /*                       @G24LB31*/
LFREM1   FREEMAIN  R,LV=(0),A=(1)
*   RESPECIFY                                                      1284
*    (REG1,                                                        1284
*     REG0) UNRSTD;                 /*                       @G24LB31*/
*                                                                  1284
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE REGISTERS ARE RESTORED AND                   #Y30LB35*/
*   /* CONTROL IS RETURNED TO THE INSTRUCTION                @Y30LB35*/
*   /* AFTER THE OPEN SVC                                    @Y30LB35*/
*   /* THE RETURN CODE IS SET TO RCFAIL(4)                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1285
*   REG3=ADDR(SAVEREGS);            /*                       @Y30LB35*/
         LA    REG3,SAVEREGS                                       1285
*   GEN(LM  REG0,REG15,0(REG3));    /*                       @Y30LB35*/
*                                                                  1286
         LM  REG0,REG15,0(REG3)
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION IS MADE WHERE TO               @Z40LB35*/
*   /* RETURN - TO OPNVTOC OR OPNPASS                        @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1287
*   IF STAVTOC=ON THEN              /*                       @Z40LB35*/
         L     @05,@PC00001                                        1287
         L     @05,GDTSAH(,@05)                                    1287
         L     @05,SAHSTA(,@05)                                    1287
         TM    STAVTOC(@05),B'00100000'                            1287
         BNO   @RF01287                                            1287
*     DO;                           /*                       @Z40LB35*/
*                                                                  1288
*       /*************************************************************/
*       /*                                                           */
*       /* TURN OFF RETRY BIT                                @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1289
*       STAVTOC=OFF;                /*                       @Z40LB35*/
*                                                                  1289
         L     @05,@PC00001                                        1289
         L     @05,GDTSAH(,@05)                                    1289
         L     @05,SAHSTA(,@05)                                    1289
         NI    STAVTOC(@05),B'11011111'                            1289
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE INSTRUCTION AFTER OPEN              @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1290
*       RETURN TO AFTEROP2 CODE(4); /*                       @Z40LB35*/
         LA    @14,AFTEROP2                                        1290
         LA    @15,4                                               1290
@EL00018 DS    0H                                                  1290
@EF00018 DS    0H                                                  1290
@ER00018 BR    @14                                                 1290
*     END;                          /*                       @Z40LB35*/
*   ELSE                            /*                       @Z40LB35*/
*     RETURN TO AFTEROPN CODE(4);   /*                       @Z40LB35*/
@RF01287 LA    @14,AFTEROPN                                        1292
         LA    @15,4                                               1292
         BR    @14                                                 1292
*   RESPECIFY                                                      1293
*    (REG3) UNRSTD;                 /*                       @Y30LB35*/
*   END RETRY;                      /*                       @Y30LB35*/
*                                                                  1295
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - SYNAD                                   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             HANDLE SYNAD ERRORS BY ISSUING MESSAGES.     @Y30LB35*/
*/*             THIS IS DONE BY THE FOLLOWING STEPS:         @Y30LB35*/
*/*             ISSUES SYNADAF MACRO, ISSUES UPRINT,         @Y30LB35*/
*/*             ISSUES SYNADRLS, AND ISSUES UPRINT.          @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THE MESSAGES IDC3313I & IDC2375I ARE ISSUED. @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOXIOB IN IOXCTLBK                           @Y30LB35*/
*/*             IOXDDN IN IOXCTLBK                           @Y30LB35*/
*/*             IOXTYPE FORM IOXCTLBK                        @Y30LB35*/
*/*             IOXJFCB FROM IOXCTLBK                        @Y30LB35*/
*/*             SYNADMSG FROM SYNADAF MACRO                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    SYNDNAME IN SYNADMSG                         @Y30LB35*/
*/*             DARGSMOD IN DARGLIST                         @Y30LB35*/
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/
*/*             DARGDBP  IN DARGLIST                         @Y30LB35*/
*/*             DARGILP  IN DARGLIST                         @Y30LB35*/
*/*             IOXSYNAD IN IOXCTLBK                         @Y30LB35*/
*/*             DCBTIOT  IN IOXDCB                           @Y30LB35*/
*/*             JFCBPTR                                      @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1295
*                                   /*                       @Y30LB35*/
*SYNAD:                                                            1295
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1295
SYNAD    STM   @14,@12,@SA00019                                    1295
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1296
*   DCL                                                            1296
*     SYNMSGAD PTR(31) BDY(WORD);   /*                       @Y30LB35*/
*   DCL                                                            1297
*     1 ERRORMSG BASED(SYNMSGAD),   /*                       @Y30LB35*/
*      2 * CHAR(68),                /*                       @Y30LB35*/
*      2 SYNADMSG,                  /*                       @Y30LB35*/
*       3 * CHAR(7),                /*                       @Y30LB35*/
*       3 SYNDNAME CHAR(8),         /*                       @Y30LB35*/
*       3 * CHAR(45);               /*                       @Y30LB35*/
*                                                                  1298
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOSN' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1298
*   OLDERID2=NEWERID2;                                             1298
         L     @03,@PC00001                                        1298
         L     @03,GDTTR2(,@03)                                    1298
         L     @15,@PC00001                                        1298
         L     @01,GDTTR2(,@15)                                    1298
         MVC   @TS00001(95),NEWERID2(@01)                          1298
         MVC   OLDERID2(95,@03),@TS00001                           1298
*   NEWID2='IOSN';                  /*                       @Y30LB35*/
*                                                                  1299
         L     @03,@PC00001                                        1299
         L     @03,GDTTR2(,@03)                                    1299
         MVC   NEWID2(4,@03),@CC04303                              1299
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FULL REGION DUMP POINT 'IOSY'                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1300
*   IF GDTDBG=NULLPTR THEN                                         1300
         L     @03,@PC00001                                        1300
         L     @03,GDTDBG(,@03)                                    1300
         LTR   @03,@03                                             1300
         BZ    @RT01300                                            1300
*     ;                                                            1301
*   ELSE                                                           1302
*     CALL IDCDB010(GDTTBL,'IOSY'); /*                       @Y30LB35*/
*                                                                  1302
         L     @03,@PC00001                                        1302
         ST    @03,@AL00001                                        1302
         LA    @03,@CC04304                                        1302
         ST    @03,@AL00001+4                                      1302
         MVI   @AL00001+4,X'80'                                    1302
         L     @03,@PC00001                                        1302
         L     @15,GDTDBG(,@03)                                    1302
         LA    @01,@AL00001                                        1302
         BALR  @14,@15                                             1302
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE IOXSYNAD BIT TO INDICATE SYNAD TAKEN          @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1303
*   IOXSYNAD=ON;                    /*                       @Y30LB35*/
@RT01300 L     @03,IOCTLBKP                                        1303
         OI    IOXSYNAD(@03),B'00010000'                           1303
*   RESPECIFY                                                      1304
*    (REG1) RSTD;                   /*                       @Y30LB35*/
*                                                                  1304
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE ADDRESS TO THE FAILING                 @Y30LB35*/
*   /* IOB AND ISSUE SYNADAF TO BUILD THE                    @Y30LB35*/
*   /* SYNAD ERROR MESSAGE.                                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1305
*   REG1=ADDR(IOXIOB);              /*                       @Y30LB35*/
         L     REG1,IOCTLBKP                                       1305
         LA    REG1,IOXIOB(,REG1)                                  1305
*LSYNF1:                                                           1306
*   GEN(SYNADAF ACSMETH=EXCP);      /*                       @Y30LB35*/
*                                                                  1306
LSYNF1   SYNADAF ACSMETH=EXCP
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE ADDRESS OF THE SYNAD MESSAGE                 @Y30LB35*/
*   /* BUFFER.                                               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1307
*   SYNMSGAD=REG1;                  /*                       @Y30LB35*/
*                                                                  1307
         ST    REG1,SYNMSGAD                                       1307
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN THE DDNAME FIELD INTO THE                     @Y30LB35*/
*   /* MESSAGE.                                              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1308
*   SYNDNAME=IOXDDN;                /*                       @Y30LB35*/
*                                                                  1308
         L     @03,SYNMSGAD                                        1308
         L     @15,IOCTLBKP                                        1308
         MVC   SYNDNAME(8,@03),IOXDDN(@15)                         1308
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE DARGLIST TO ISSUE                      @Y30LB35*/
*   /* "IDC3313I (SYNAD MESSAGE)"                            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1309
*   DARGLIST=''B;                   /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1309
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1309
*   DARGSMOD=IO05MSGS;              /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1310
         MVC   DARGSMOD(3,@03),@CC03785                            1310
*   DARGSENT=MSG3313I;              /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1311
         MVI   DARGSENT(@03),X'05'                                 1311
*   DARGDBP=ADDR(SYNADMSG);         /*                       @Y30LB35*/
         L     @03,SYNMSGAD                                        1312
         LA    @03,SYNADMSG(,@03)                                  1312
         L     @15,DDSTRU                                          1312
         ST    @03,DARGDBP(,@15)                                   1312
*   DARGILP=LENGTH(SYNADMSG);       /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1313
         MVC   DARGILP(2,@03),@CH01813                             1313
*   RESPECIFY                                                      1314
*    (REG1) UNRSTD;                 /*                       @Y30LB35*/
*                                                                  1314
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UPRINT TO SEND THE ERROR MESSAGE                @Y30LB35*/
*   /* TO SYSPRINT                                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1315
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB35*/
         L     @03,@PC00001                                        1315
         ST    @03,@AL00001                                        1315
         LA    @03,@CF00119                                        1315
         ST    @03,@AL00001+4                                      1315
         LA    @03,DDSTRU                                          1315
         ST    @03,@AL00001+8                                      1315
         MVI   @AL00001+8,X'80'                                    1315
         L     @03,@PC00001                                        1315
         L     @15,GDTPRT(,@03)                                    1315
         LA    @01,@AL00001                                        1315
         BALR  @14,@15                                             1315
*   RESPECIFY                                                      1316
*    (REG1) RSTD;                   /*                       @Y30LB35*/
*                                                                  1316
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE ADDRESS INTO REGISTER 1                @Y30LB35*/
*   /* FOR SYNADRLS TO FREE THE SYNAD BUFFER.                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1317
*   REG1=SYNMSGAD;                  /*                       @Y30LB35*/
         L     REG1,SYNMSGAD                                       1317
*LSYNR1:                                                           1318
*   GEN(SYNADRLS);                  /*                       @Y30LB35*/
*                                                                  1318
LSYNR1   SYNADRLS
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE IOXSYNAD BIT TO INDICATE THAT A SYNAD         @Y30LB35*/
*   /* WAS TAKEN FOR THIS DCB.                               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1319
*   IOXSYNAD=ON;                    /*                       @Y30LB35*/
*                                                                  1319
         L     @03,IOCTLBKP                                        1319
         OI    IOXSYNAD(@03),B'00010000'                           1319
*   /*****************************************************************/
*   /*                                                               */
*   /* REINITIALIZE THE DARGLIST TO ISSUE                    @Y30LB35*/
*   /* THE SECOND LEVEL MESSAGE                              @Y30LB35*/
*   /* "IDC2375I I/O ERROR (DSN/VTOC)"                       @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1320
*   DARGLIST=''B;                   /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1320
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1320
*   DARGSMOD=IO05MSGS;              /*                       @Y30LB35*/
*                                                                  1321
         L     @03,DDSTRU                                          1321
         MVC   DARGSMOD(3,@03),@CC03785                            1321
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE WHICH INSERT IS NEEDED                      @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1322
*   IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/*     @Y30LB35*/
         L     @03,IOCTLBKP                                        1322
         CLC   IOXTYPE(1,@03),LAB                                  1322
         BE    @RF01322                                            1322
         L     @03,IOCTLBKP                                        1322
         CLC   IOXTYPE(1,@03),NEWVOL                               1322
         BE    @RF01322                                            1322
         L     @03,IOCTLBKP                                        1322
         CLC   IOXTYPE(1,@03),VTOC                                 1322
         BE    @RF01322                                            1322
*     DO;                           /*                       @Y30LB35*/
*                                                                  1323
*       /*************************************************************/
*       /*                                                           */
*       /* IF I/O WAS ON A DATA SET PREPARE                  @Y30LB35*/
*       /* MESSAGE "IDC2375I ** I/O ERROR - (DSN)"           @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1324
*       DARGSENT=MSG2375A;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1324
         MVI   DARGSENT(@03),X'08'                                 1324
*       JFCBPTR=ADDR(IOXJFCB);      /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1325
         LA    @03,IOXJFCB(,@03)                                   1325
         ST    @03,JFCBPTR                                         1325
*       DARGDBP=ADDR(JFCBDSNM);     /*                       @Y30LB35*/
         L     @03,JFCBPTR                                         1326
         L     @15,DDSTRU                                          1326
         ST    @03,DARGDBP(,@15)                                   1326
*       DARGILP=LENGTH(JFCBDSNM);   /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1327
         MVC   DARGILP(2,@03),@CH00849                             1327
*     END;                          /*                       @Y30LB35*/
*                                                                  1328
*   /*****************************************************************/
*   /*                                                               */
*   /* IF I/O ERROR WAS ON THE VTOC THEN                     @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1329
*   ELSE                            /*                       @Z40LB35*/
*     IF IOXTYPE=VTOC×IOXTYPE=VTOCHDR THEN/*                 @ZA11014*/
         B     @RC01322                                            1329
@RF01322 L     @03,IOCTLBKP                                        1329
         CLC   IOXTYPE(1,@03),VTOC                                 1329
         BE    @RT01329                                            1329
         L     @03,IOCTLBKP                                        1329
         CLC   IOXTYPE(1,@03),VTOCHDR                              1329
         BNE   @RF01329                                            1329
@RT01329 DS    0H                                                  1330
*       DO;                         /*                       @Z40LB35*/
*                                                                  1330
*         /***********************************************************/
*         /*                                                         */
*         /* IF I/O WAS ON A DATA SET PREPARE                @Z40LB35*/
*         /* MESSAGE "IDC2375I ** I/O ERROR - VTOC"          @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1331
*         DARGSENT=MSG2375A;        /*                       @Z40LB35*/
         L     @03,DDSTRU                                          1331
         MVI   DARGSENT(@03),X'08'                                 1331
*         DARGDBP=ADDR('VTOC');     /*                       @Z40LB35*/
         LA    @03,@CC03929                                        1332
         L     @15,DDSTRU                                          1332
         ST    @03,DARGDBP(,@15)                                   1332
*         DARGILP=LENGTH('VTOc');   /*                       @Z40LB35*/
         L     @03,DDSTRU                                          1333
         MVC   DARGILP(2,@03),@CH00045                             1333
*       END;                        /*                       @Z40LB35*/
*                                                                  1334
*   /*****************************************************************/
*   /*                                                               */
*   /* PREPARE "IDC2375I ** I/O ERROR PROCESSING             @Y30LB35*/
*   /* VOLUME LABEL"                                         @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1335
*     ELSE                          /*                       @Z40LB35*/
*       DARGSENT=MSG2375B;          /*                       @Z40LB35*/
         B     @RC01329                                            1335
@RF01329 L     @03,DDSTRU                                          1335
         MVI   DARGSENT(@03),X'09'                                 1335
*   RESPECIFY                                                      1336
*    (REG1) UNRSTD;                 /*                       @Y30LB35*/
*                                                                  1336
@RC01329 DS    0H                                                  1336
@RC01322 DS    0H                                                  1337
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UPRINT TO SEND THE ERROR                        @Y30LB35*/
*   /* MESSAGE TO SYSPRINT                                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1337
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB35*/
*                                                                  1337
         L     @03,@PC00001                                        1337
         ST    @03,@AL00001                                        1337
         LA    @03,@CF00119                                        1337
         ST    @03,@AL00001+4                                      1337
         LA    @03,DDSTRU                                          1337
         ST    @03,@AL00001+8                                      1337
         MVI   @AL00001+8,X'80'                                    1337
         L     @03,@PC00001                                        1337
         L     @15,GDTPRT(,@03)                                    1337
         LA    @01,@AL00001                                        1337
         BALR  @14,@15                                             1337
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE RETURN CODE IN REG15 TO ZERO AND              @Y30LB35*/
*   /* RETURN TO ISSUEXCP.                                   @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1338
*   TESTRC=0;                       /*                       @Y30LB35*/
         SLR   @03,@03                                             1338
         STH   @03,TESTRC                                          1338
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
         LH    @15,TESTRC                                          1339
         L     @14,@SA00019                                        1339
         LM    @00,@12,@SA00019+8                                  1339
         BR    @14                                                 1339
*   END SYNAD;                      /*                       @Y30LB35*/
*                                                                  1341
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - OCABEND                                 @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             TAKE CONTROL WHEN THE SVC'S OPEN OR          @Y30LB35*/
*/*             CLOSE ENCOUNTERS AN ABEND SITUATION.         @Y30LB35*/
*/*             THE FOLLOWING STEPS ARE PERFORMED:           @Y30LB35*/
*/*             SET IOXABEND FLAG IN IOXCTLBK                @Y30LB35*/
*/*             SAVE ABEND CODE IN IOXACODE OF IOXCTLBK      @Y30LB35*/
*/*             SAVE RETURN CODE IN IOXRCODE OF IOXCTLBK     @Y30LB35*/
*/*             SET OCOPTION IN OPNCLOSE                     @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     OPNCLOSE FORM SYSTEM                         @Y30LB35*/
*/*             OCABCODE FROM OPNCLOSE                       @Y30LB35*/
*/*             OCREASON FROM OPNCLOSE                       @Y30LB35*/
*/*             OCOPTION FROM OPNCLOSE                       @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    IOXABEND IN IOXCTLBK                         @Y30LB35*/
*/*             IOXACODE IN IOXCTLBK                         @Y30LB35*/
*/*             IOXRCODE IN IOXCTLBK                         @Y30LB35*/
*/*             OCOPTION IN OPNCLOSE                         @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1341
*OCABEND:                                                          1341
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1341
OCABEND  STM   @14,@12,@SA00020                                    1341
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1342
*   DCL                                                            1342
*     OCPARM PTR(31) BDY(WORD);     /*                       @Y30LB35
*                                      OPEN CLOSE PARM PTR   @Y30LB35*/
*   DCL                                                            1343
*     IGNORE FIXED(8) STATIC INIT('04'X);/*                  @Y30LB35
*                                      CODE TO TELL SVC      @Y30LB35
*                                      IGNORE AND CONTINUE   @Y30LB35*/
*                                                                  1343
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE OVERLAY STRUCTURE FOR THE                 @Y30LB35*/
*   /* PARMS PASSED BY SVC TO THIS PROCEDURE.                @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1344
*   DCL                                                            1344
*     1 OPNCLOSE BASED(OCPARM) BDY(WORD),/*                  @Y30LB35*/
*      2 OCABCODE FIXED(15),        /*                       @Y30LB35
*                                      ABEND CODE            @Y30LB35*/
*      2 OCREASON FIXED(8),         /*                       @Y30LB35
*                                      REASON CODE           @Y30LB35*/
*      2 OCOPTION FIXED(8);         /*                       @Y30LB35
*                                      MY OPTION             @Y30LB35*/
*                                                                  1345
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE PARMLIST POINTER                                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1345
*   OCPARM=REG1;                    /*                       @Y30LB35*/
*                                                                  1345
         ST    REG1,OCPARM                                         1345
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOOC' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1346
*   OLDERID2=NEWERID2;                                             1346
         L     @03,@PC00001                                        1346
         L     @03,GDTTR2(,@03)                                    1346
         L     @15,@PC00001                                        1346
         L     @01,GDTTR2(,@15)                                    1346
         MVC   @TS00001(95),NEWERID2(@01)                          1346
         MVC   OLDERID2(95,@03),@TS00001                           1346
*   NEWID2='IOOC';                  /*                       @Y30LB35*/
*                                                                  1347
         L     @03,@PC00001                                        1347
         L     @03,GDTTR2(,@03)                                    1347
         MVC   NEWID2(4,@03),@CC04319                              1347
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FULL REGION DUMP POINT 'IOAB'                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1348
*   IF GDTDBG=NULLPTR THEN                                         1348
         L     @03,@PC00001                                        1348
         L     @03,GDTDBG(,@03)                                    1348
         LTR   @03,@03                                             1348
         BZ    @RT01348                                            1348
*     ;                                                            1349
*   ELSE                                                           1350
*     CALL IDCDB010(GDTTBL,'IOAB'); /*                       @Y30LB35*/
         L     @03,@PC00001                                        1350
         ST    @03,@AL00001                                        1350
         LA    @03,@CC04320                                        1350
         ST    @03,@AL00001+4                                      1350
         MVI   @AL00001+4,X'80'                                    1350
         L     @03,@PC00001                                        1350
         L     @15,GDTDBG(,@03)                                    1350
         LA    @01,@AL00001                                        1350
         BALR  @14,@15                                             1350
*   RESPECIFY                                                      1351
*    (REG1,                                                        1351
*     REG14) RSTD;                  /*                       @Y30LB35*/
*                                                                  1351
@RT01348 DS    0H                                                  1352
*   /*****************************************************************/
*   /*                                                               */
*   /* SET IOXABEND FLAG TO INDICATE THAT                    @Y30LB35*/
*   /* THIS ROUTINE WAS GIVEN CONTROL AFTER                  @Y30LB35*/
*   /* THE SVC RETURNS TO PROCESSING.                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1352
*   IOXABEND=ON;                    /*                       @Y30LB35*/
*                                                                  1352
         L     @15,IOCTLBKP                                        1352
         OI    IOXABEND(@15),B'01000000'                           1352
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE ABEND CODE AND RETURN CODE                       @Y30LB35*/
*   /* FOR PROBLEM DETERMINATION IF DUMP TAKEN               @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1353
*   IOXACODE=OCABCODE;              /*                       @Y30LB35*/
         L     @15,OCPARM                                          1353
         LH    @15,OCABCODE(,@15)                                  1353
         L     @03,IOCTLBKP                                        1353
         STH   @15,IOXACODE(,@03)                                  1353
*   IOXRCODE=OCREASON;              /*                       @Y30LB35*/
*                                                                  1354
         L     @15,OCPARM                                          1354
         SLR   @03,@03                                             1354
         IC    @03,OCREASON(,@15)                                  1354
         L     @15,IOCTLBKP                                        1354
         STH   @03,IOXRCODE(,@15)                                  1354
*   /*****************************************************************/
*   /*                                                               */
*   /* SET OPTION CODE TO IGNORE PROBLEM                     @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1355
*   OCOPTION=IGNORE;                /*                       @Y30LB35*/
         IC    @15,IGNORE                                          1355
         L     @03,OCPARM                                          1355
         STC   @15,OCOPTION(,@03)                                  1355
*   RESPECIFY                                                      1356
*    (REG1,                                                        1356
*     REG14) UNRSTD;                /*                       @Y30LB35*/
*   END OCABEND;                    /*                       @Y30LB35*/
@EL00020 DS    0H                                                  1357
@EF00020 DS    0H                                                  1357
@ER00020 LM    @14,@12,@SA00020                                    1357
         BR    @14                                                 1357
*                                                                  1358
*/********************************************************************/
*/*                                                          @Y30LB35*/
*/* PROCEDURE NAME - READJFCB                                @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/
*/*             OBTAIN THE JFCB TO BE USED IN MESSAGES AND   @Y30LB35*/
*/*             OPEN TYPE=J.  THE FOLLOWING STEPS ARE USED:  @Y30LB35*/
*/*             ISSUES RDJFCB AND ISSUES UPRINT IF NECESSARY @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*             MESSAGE IDC2370I IS ISSUED IF RDJFCB ERROR   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* INPUT -     IOXEXLST FROM IOXCTLBK                       @Y30LB35*/
*/*             IOXJFCB FROM IOXCTLBK                        @Y30LB35*/
*/*             IOXDCB FROM IOXCTLBK                         @Y30LB35*/
*/*             USERDDN FROM CALLER'S CORE                   @Y30LB35*/
*/*                                                          @Y30LB35*/
*/* OUTPUT -    DCBEXLSA IN IOXDCB                           @Y30LB35*/
*/*             IOXJFCBP IN IOXCTLBK                         @Y30LB35*/
*/*             DARGSMOD IN DARGLIST                         @Y30LB35*/
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/
*/*             DARGDBP  IN DARGLIST                         @Y30LB35*/
*/*             DARGILP  IN DARGLIST                         @Y30LB35*/
*/*             DARGCNT  IN DARGLIST                         @Y30LB35*/
*/*             DARGINS(1) IN DARGARY                        @Y30LB35*/
*/*             DARGINL(1) IN DARGARY                        @Y30LB35*/
*/*             DARGDTM(1) IN DARGARY                        @Y30LB35*/
*/*             RDJFCBPM                                     @Y30LB35*/
*/*             JFCBPTR                                      @Y30LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/
*/*                           4, ERROR IN RDJFCB             @Y30LB35*/
*/*                                                          @Y30LB35*/
*/********************************************************************/
*                                                                  1358
*                                   /*                       @Y30LB35*/
*READJFCB:                                                         1358
*   PROC;                           /*                       @Y30LB35*/
*                                                                  1358
READJFCB STM   @14,@12,@SA00021                                    1358
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1359
*   DCL                                                            1359
*     JFCBLST CHAR(4) GEND;         /*                       @Y30LB35
*                                      ASSEM TO PLS          @Y30LB35*/
*                                                                  1359
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING IS THE PARMLIST                         @Y30LB35*/
*   /* PASSED TO RDJFCB.                                     @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1360
*   DCL                                                            1360
*     1 RDJFCBPM BDY(WORD),         /*                       @Y30LB35*/
*      2 RDJFCBCD CHAR(1),          /*                       @Y30LB35
*                                      RDJFCB CODE           @Y30LB35*/
*      2 RDJFCBAD PTR(24);          /*                       @Y30LB35
*                                      ADDR OF RTN AREA      @Y30LB35*/
*                                                                  1360
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING IS THE ASSEM RDJFCB LIST FORM           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1361
*   GENERATE DATA;                                                 1361
*                                                                  1362
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IORJ' IN TRACE TABLE              @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1362
*   OLDERID2=NEWERID2;                                             1362
         L     @03,@PC00001                                        1362
         L     @03,GDTTR2(,@03)                                    1362
         L     @15,@PC00001                                        1362
         L     @01,GDTTR2(,@15)                                    1362
         MVC   @TS00001(95),NEWERID2(@01)                          1362
         MVC   OLDERID2(95,@03),@TS00001                           1362
*   NEWID2='IORJ';                  /*                       @Y30LB35*/
*                                                                  1363
         L     @03,@PC00001                                        1363
         L     @03,GDTTR2(,@03)                                    1363
         MVC   NEWID2(4,@03),@CC04328                              1363
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP DCBEXLSA WITH OPEN EXTENT LIST                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1364
*   DCBEXLSA=ADDR(IOXEXLST);        /*                       @Y30LB35*/
*                                                                  1364
         L     @03,IOCTLBKP                                        1364
         LA    @03,IOXEXLST(,@03)                                  1364
         L     @01,DCBPTR                                          1364
         STCM  @03,7,DCBEXLSA+28(@01)                              1364
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE ADDRESSABILITY TO JFCB                     @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1365
*   IOXJFCBP=ADDR(IOXJFCB);         /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1365
         LA    @03,IOXJFCB(,@03)                                   1365
         L     @01,IOCTLBKP                                        1365
         STCM  @03,7,IOXJFCBP(@01)                                 1365
*   JFCBPTR=ADDR(IOXJFCB);          /*                       @Y30LB35*/
         L     @03,IOCTLBKP                                        1366
         LA    @03,IOXJFCB(,@03)                                   1366
         ST    @03,JFCBPTR                                         1366
*   RESPECIFY                                                      1367
*     REG1 RESTRICTED;              /*                       @Y30LB35*/
*                                                                  1367
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE LIST FORM RDJFCB TO DYNAMIC AREA                 @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1368
*   RDJFCBPM=JFCBLST;               /*                       @Y30LB35*/
*                                                                  1368
         MVC   RDJFCBPM(4),JFCBLST                                 1368
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE DCB ADDRESS INTO LIST                            @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1369
*   RDJFCBAD=ADDR(IOXDCB);          /*                       @Y30LB35*/
*                                                                  1369
         L     @03,IOCTLBKP                                        1369
         LA    @03,IOXDCB(,@03)                                    1369
         STCM  @03,7,RDJFCBAD                                      1369
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE EXECUTE FORM OF RDJFCB TO RETRIEVE JFCB         @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1370
*LRDJF1:                                                           1370
*   GEN(RDJFCB  MF=(E,RDJFCBPM));   /*                       @Y30LB35*/
LRDJF1   RDJFCB  MF=(E,RDJFCBPM)
*   RESPECIFY                                                      1371
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/
*   RESPECIFY                                                      1372
*     RTNREG RSTD;                                                 1372
*   TESTRC=RTNREG;                                                 1373
         STH   RTNREG,TESTRC                                       1373
*   RESPECIFY                                                      1374
*     RTNREG UNRSTD;                /*                       @Y30LB35*/
*                                                                  1374
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE IF RDJFCB WAS SUCCESSFUL                  @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1375
*   IF TESTRC^=0                    /*                       @Y30LB35*/
*     THEN                          /*                       @Y30LB35*/
*                                                                  1375
         LH    @03,TESTRC                                          1375
         LTR   @03,@03                                             1375
         BZ    @RF01375                                            1375
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT SUCCESSFUL PREPARE TO ISSUE                  @Y30LB35*/
*     /* "IDC2375I UNABLE TO READ JFCB                       @Y30LB35*/
*     /* FOR DD ENTRY (DDNAME) RDJFCB CODE (XX)"             @Y30LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1376
*     DO;                           /*                       @Y30LB35*/
*                                                                  1376
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE DARGLIST                           @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1377
*       DARGLIST=''B;               /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1377
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1377
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1378
         MVC   DARGSMOD(3,@03),@CC03785                            1378
*       DARGSENT=MSG2370I;          /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1379
         MVI   DARGSENT(@03),X'01'                                 1379
*       DARGDBP=ADDR(USERDDN);      /*                       @Y30LB35*/
         L     @03,@PC00001+8                                      1380
         L     @03,EXODDN(,@03)                                    1380
         L     @01,DDSTRU                                          1380
         ST    @03,DARGDBP(,@01)                                   1380
*       DARGILP=LENGTH(USERDDN);    /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1381
         MVC   DARGILP(2,@03),@CH00038                             1381
*       DARGCNT=1;                  /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1382
         MVC   DARGCNT(2,@03),@CH00222                             1382
*       DARGINS(1)=1;               /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1383
         MVC   DARGINS(2,@03),@CH00222                             1383
*       DARGINL(1)=LENGTH(TESTRC);  /*                       @Y30LB35*/
         L     @03,DDSTRU                                          1384
         MVC   DARGINL(2,@03),@CH00036                             1384
*       DARGDTM(1)=ADDR(TESTRC);    /*                       @Y30LB35*/
*                                                                  1385
         LA    @03,TESTRC                                          1385
         L     @01,DDSTRU                                          1385
         ST    @03,DARGDTM(,@01)                                   1385
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT TO ISSUE ERROR                       @Y30LB35*/
*       /* MESSAGE TO SYSPRINT                               @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1386
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/
*                                                                  1386
         L     @03,@PC00001                                        1386
         ST    @03,@AL00001                                        1386
         LA    @03,@CF00119                                        1386
         ST    @03,@AL00001+4                                      1386
         LA    @03,DDSTRU                                          1386
         ST    @03,@AL00001+8                                      1386
         MVI   @AL00001+8,X'80'                                    1386
         L     @03,@PC00001                                        1386
         L     @15,GDTPRT(,@03)                                    1386
         LA    @01,@AL00001                                        1386
         BALR  @14,@15                                             1386
*       /*************************************************************/
*       /*                                                           */
*       /* SET ERROR CODE RCFAIL(4)                          @Y30LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1387
*       TESTRC=4;                   /*                       @Y30LB35*/
         MVC   TESTRC(2),@CH00045                                  1387
*     END;                          /*                       @Y30LB35*/
*                                                                  1388
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO BLDBLK WITH THE RETURN                      @Y30LB35*/
*   /* CODE IN REGISTER 15 OF 0 SUCCESSFUL                   @Y30LB35*/
*   /* OR 4 ERROR.                                           @Y30LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1389
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/
@RF01375 LH    @15,TESTRC                                          1389
         L     @14,@SA00021                                        1389
         LM    @00,@12,@SA00021+8                                  1389
         BR    @14                                                 1389
*   END READJFCB;                   /*                       @Y30LB35*/
*                                                                  1391
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - OPENR                                  @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - CALL SUBPROCEDURE BLDBLK TO SETUP IOXCTLBK   @ZA11014*/
*/*             AND READ THE JFCB                            @ZA11014*/
*/*             IF A VTOC HEAD REQUEST, CALL SUBPORCEDURE    @ZA11014*/
*/*              OPNVTH TO DO A PSEUDO OPEN ON THE VTOC HEADE@ZA11014*/
*/*             OTHERWISE ISSUE AN OPEN TYPE=J FOR THE       @ZA11014*/
*/*              REQUESTED DATA SET OR VTOC                  @ZA11014*/
*/*             CALL CHECKOPN TO SEE IF OPEN WAS SUCCESSFUL  @ZA11014*/
*/*             ISSUES A MODESET TO GET INTO KEY ZERO        @ZA11014*/
*/*             MODIFIES DEB FILE MASK AND EXTENTS IF NEEDED @ZA11014*/
*/*             ISSUES MODESET BACK TO PROBLEM PROG KEY      @ZA11014*/
*/*             RETURN                                       @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXOREP FROM EXOARG                              @ZA11014*/
*/*          EXOSPK FROM EXOARG                              @ZA11014*/
*/*          EXORDS FROM EXOARG                              @ZA11014*/
*/*          EXORVT FROM EXOARG                              @ZA11014*/
*/*          EXOVTH FROM EXOARG                              @ZA11014*/
*/*          EXOREAD FROM EXOARG                             @ZA11014*/
*/*          EXODDN FROM EXOARG                              @ZA11014*/
*/*          EXODSN FROM EXOARG                              @ZA11014*/
*/*          EXOUCB FROM EXOARG                              @ZA11014*/
*/*          EXOEXT FROM EXOARG                              @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - EXOCTLBK IN EXOARG                             @ZA11014*/
*/*           EXOEXT   IN EXOARG                             @ZA11014*/
*/*           JFCBDSNM IN IOXJFCB                            @ZA11014*/
*/*           JFCNWRIT IN IOXJFCB                            @ZA11014*/
*/*           DCBOFLWR IN IOXDCB                             @ZA11014*/
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1391
*                                   /*                       @ZA11014*/
*OPENR:                                                            1391
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1391
OPENR    STM   @14,@12,@SA00022                                    1391
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1392
*   OLDERID2=NEWERID2;                                             1392
         L     @03,@PC00001                                        1392
         L     @03,GDTTR2(,@03)                                    1392
         L     @15,@PC00001                                        1392
         L     @01,GDTTR2(,@15)                                    1392
         MVC   @TS00001(95),NEWERID2(@01)                          1392
         MVC   OLDERID2(95,@03),@TS00001                           1392
*   NEWID2='IOOR';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1393
         L     @03,@PC00001                                        1393
         L     @03,GDTTR2(,@03)                                    1393
         MVC   NEWID2(4,@03),@CC04334                              1393
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL BLDBLK TO BUILD THE IOX CONTROL BLOCK            @ZA11014*/
*   /* AND READ THE JFCB                                     @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1394
*   CALL BLDBLK;                    /*                       @ZA11014*/
         BAL   @14,BLDBLK                                          1394
*   RESPECIFY                                                      1395
*     RTNREG RSTD;                                                 1395
*   TESTRC=RTNREG;                                                 1396
         STH   RTNREG,TESTRC                                       1396
*   RESPECIFY                                                      1397
*     RTNREG UNRSTD;                /*                       @ZA11014
*                                                            @ZA11014*/
*   IF TESTRC=0                     /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1398
         LH    @03,TESTRC                                          1398
         LTR   @03,@03                                             1398
         BNZ   @RF01398                                            1398
*     /***************************************************************/
*     /*                                                             */
*     /* RETURN FROM BLDBLK OK-CONTINUE                      @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1399
*     DO;                           /*                       @ZA11014*/
*       IF EXOVTH=ON×EXORVS=ON      /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1400
         L     @03,@PC00001+8                                      1400
         TM    EXOVTH(@03),B'00010001'                             1400
         BZ    @RF01400                                            1400
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESSING VTOC HEADER                          @ZA11014*/
*         /* SET VTOC AS INPUT TYPE AND CALL OPNVTH          @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1401
*         DO;                       /*                       @ZA11014*/
*           IOXTYPE=VTOCHDR;        /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1402
         MVC   IOXTYPE(1,@03),VTOCHDR                              1402
*           CALL OPNVTH;            /*                       @ZA11014*/
         BAL   @14,OPNVTH                                          1403
*           RESPECIFY                                              1404
*             RTNREG RSTD;                                         1404
*           TESTRC=RTNREG;                                         1405
         STH   RTNREG,TESTRC                                       1405
*           RESPECIFY                                              1406
*             RTNREG UNRSTD;        /*                       @ZA11014*/
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*       ELSE                        /*                       @ZA11014*/
*                                                                  1408
*         /***********************************************************/
*         /*                                                         */
*         /* NOT VTOC HEADER-VTOC, DS OR STAGING PACK        @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1408
*         DO;                       /*                       @ZA11014*/
*                                                                  1408
         B     @RC01400                                            1408
@RF01400 DS    0H                                                  1409
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP THE JFCB FOR THE OPEN                  @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1409
*           JFCNWRIT=ON;            /*                       @ZA11014
*                                                            @ZA11014*/
         L     @03,JFCBPTR                                         1409
         OI    JFCNWRIT(@03),B'00001000'                           1409
*           IF EXORVT=ON×EXOSPK=ON  /*                       @ZA11014*/
*             THEN                  /*                       @ZA11014*/
*                                                                  1410
         L     @03,@PC00001+8                                      1410
         TM    EXORVT(@03),B'00001010'                             1410
         BZ    @RF01410                                            1410
*             /*******************************************************/
*             /*                                                     */
*             /* WORKING ON VTOC                             @ZA11014*/
*             /* SET INPUT TYPE AND JFCB TO VTOC             @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1411
*             DO;                   /*                       @ZA11014*/
*               IOXTYPE=VTOC;       /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1412
         MVC   IOXTYPE(1,@03),VTOC                                 1412
*               JFCBDSNM=VTOCDSN;   /*                       @ZA11014*/
         L     @03,JFCBPTR                                         1413
         MVC   JFCBDSNM(44,@03),VTOCDSN                            1413
*             END;                  /*                       @ZA11014
*                                                            @ZA11014*/
*           ELSE                    /*                       @ZA11014*/
*                                                                  1415
*             /*******************************************************/
*             /*                                                     */
*             /* DATA SET REQUEST                            @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1415
*             DO;                   /*                       @ZA11014*/
         B     @RC01410                                            1415
@RF01410 DS    0H                                                  1416
*               IOXTYPE=REPDS;      /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1416
         MVC   IOXTYPE(1,@03),REPDS                                1416
*               JFCBDSNM=USERDSN;   /*                       @ZA11014*/
         L     @03,JFCBPTR                                         1417
         L     @15,@PC00001+8                                      1417
         L     @01,EXODSN(,@15)                                    1417
         MVC   JFCBDSNM(44,@03),USERDSN(@01)                       1417
*             END;                  /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1418
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP FOR OPEN                               @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1419
*           RESPECIFY                                              1419
*            (REG1,                                                1419
*             REG3) RSTD;           /*                       @ZA11014*/
@RC01410 DS    0H                                                  1420
*           PARMLIST=''B;           /*                       @ZA11014*/
         XC    PARMLIST(20),PARMLIST                               1420
*           PARMLIST=OPENLIST;      /*                       @ZA11014*/
         MVI   PARMLIST+8,C' '                                     1421
         MVC   PARMLIST+9(11),PARMLIST+8                           1421
         MVC   PARMLIST(8),OPENLIST                                1421
*           REG3=ADDR(IOXDCB);      /*                       @ZA11014*/
         L     REG3,IOCTLBKP                                       1422
         LA    REG3,IOXDCB(,REG3)                                  1422
*           REG1=ADDR(PARMLIST);    /*                       @ZA11014
*                                                            @ZA11014*/
         LA    REG1,PARMLIST                                       1423
*           IF EXOREAD=ON           /*                       @ZA11014*/
*             THEN                  /*                       @ZA11014*/
*                                                                  1424
         L     @15,@PC00001+8                                      1424
         TM    EXOREAD(@15),B'10000000'                            1424
         BNO   @RF01424                                            1424
*             /*******************************************************/
*             /*                                                     */
*             /* OPEN FOR READ ONLY                          @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1425
*LRVOPN1:                                                          1425
*             GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);/*     1425
*                                                            @ZA11014*/
LRVOPN1  OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J
*           ELSE                    /*                       @ZA11014*/
*                                                                  1426
*             /*******************************************************/
*             /*                                                     */
*             /* OPEN FOR OUTPUT                             @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1426
*LRVOPN2:                                                          1426
*             GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);/*    1426
*                                                            @ZA11014*/
         B     @RC01424                                            1426
@RF01424 DS    0H                                                  1426
LRVOPN2  OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J
*           RESPECIFY                                              1427
*            (REG1,                                                1427
*             REG3) UNRSTD;         /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1427
@RC01424 DS    0H                                                  1428
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK TO SEE IF OPEN WENT OK                  @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1428
*           CALL CHECKOPN;          /*                       @ZA11014*/
         BAL   @14,CHECKOPN                                        1428
*           RESPECIFY                                              1429
*             RTNREG RSTD;                                         1429
*           TESTRC=RTNREG;                                         1430
         STH   RTNREG,TESTRC                                       1430
*           RESPECIFY                                              1431
*             RTNREG UNRSTD;        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1432
*           /*********************************************************/
*           /*                                                       */
*           /* CONTINUE PROCESSING IF OPEN WAS OK            @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1432
*           IF TESTRC=0             /*                       @ZA11014*/
*             THEN                  /*                       @ZA11014*/
         LH    @03,TESTRC                                          1432
         LTR   @03,@03                                             1432
         BNZ   @RF01432                                            1432
*             DO;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1433
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP ADDRESSABILITY TO CONTROL BLOCKS   @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1434
*               DCBPTR=ADDR(IOXDCB);/*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1434
         LA    @03,IOXDCB(,@03)                                    1434
         ST    @03,DCBPTR                                          1434
*               DEBPTR=DCBDEBAD;    /*                       @ZA11014*/
         L     @03,DCBPTR                                          1435
         L     @03,DCBDEBAD+40(,@03)                               1435
         ST    @03,DEBPTR                                          1435
*               DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);/*  @ZA11014*/
         LA    @03,32                                              1436
         AL    @03,DEBPTR                                          1436
         ST    @03,DEBDAPTR                                        1436
*               IOBSTPTR=ADDR(IOXIOB);/*                     @ZA11014
*                                                            @ZA11014*/
*                                                                  1437
         L     @03,IOCTLBKP                                        1437
         LA    @03,IOXIOB(,@03)                                    1437
         ST    @03,IOBSTPTR                                        1437
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE IOB SEEK AREA                  @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1438
*               IOBSEEK=''B;        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1438
         L     @03,IOBSTPTR                                        1438
         XC    IOBSEEK(8,@03),IOBSEEK(@03)                         1438
*               /*****************************************************/
*               /*                                                   */
*               /* PREVENT CLOSE FROM WRITING EOF            @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1439
*               DCBOFLWR=OFF;       /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1439
         L     @03,DCBPTR                                          1439
         NI    DCBOFLWR+40(@03),B'01111111'                        1439
*               /*****************************************************/
*               /*                                                   */
*               /* SET IOB EXTENT VALUE TO ZERO              @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1440
*               IOBM=ZERO;          /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1440
         LH    @03,ZERO                                            1440
         L     @01,IOBSTPTR                                        1440
         STC   @03,IOBM(,@01)                                      1440
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP AND ISSUE MODESET TO GET INTO KEY ZERO     */
*               /*                                           @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1441
*               MODEPARM=''B;       /*                       @ZA11014*/
         XC    MODEPARM(4),MODEPARM                                1441
*               MODEPARM=MOD1;      /*                       @ZA11014*/
         L     @03,MOD1                                            1442
         ST    @03,MODEPARM                                        1442
*               RESPECIFY                                          1443
*                (REG1,                                            1443
*                 REG3) RSTD;       /*                       @ZA11014*/
*               REG3=MODEPARM;      /*                       @ZA11014*/
         L     REG3,MODEPARM                                       1444
*LRVMODE1:                                                         1445
*               DO;                 /* MODESET MF(E,REG3)            */
LRVMODE1 DS    0H                                                  1446
*                 RESPECIFY                                        1446
*                   GPR01F RESTRICTED;                             1446
*                 GPR01F=REG3;      /* MODESET PARMLIST              */
         LR    GPR01F,REG3                                         1447
*                 SVC(107);         /* ISSUE MODESET SVC             */
         SVC   107                                                 1448
*                 RESPECIFY                                        1449
*                  (GPR01F) UNRESTRICTED;                          1449
*               END;                /* MODESET MF(E,REG3)    @ZA11014
*                                                            @ZA11014*/
*                                                                  1450
*               /*****************************************************/
*               /*                                                   */
*               /* SET FILE MASK TO INHIBIT HEAD SWITCHING   @ZA11014*/
*               /* WE ARE ALWAYS IN THE FIRST EXTENT         @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1451
*               DEBDVMOD=DEBDVMOD×INHDFLMK;/*                @ZA11014
*                                                            @ZA11014*/
*                                                                  1451
         L     @15,DEBDAPTR                                        1451
         OC    DEBDVMOD(1,@15),INHDFLMK                            1451
*               /*****************************************************/
*               /*                                                   */
*               /* IF A DATA SET REQUEST, SET DEB EXTENT     @ZA11014*/
*               /* EQUAL TO THE EXTENT ENTRY SENT BY CALLER  @ZA11014*/
*               /* IT MAPS INTO THE XTNT TABLE ENTRY BUILD   @ZA11014*/
*               /* BY REPAIRV                                @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1452
*               IF EXORDS=ON        /*                       @ZA11014*/
*                 THEN              /*                       @ZA11014*/
         L     @15,@PC00001+8                                      1452
         TM    EXORDS(@15),B'00000100'                             1452
         BNO   @RF01452                                            1452
*                 DO;               /*                       @ZA11014*/
*                   DEBSTRCC=VSMBCC;/*                       @ZA11014*/
         L     @15,@PC00001+8                                      1454
         L     @15,EXOEXT(,@15)                                    1454
         LH    @00,VSMBCC(,@15)                                    1454
         L     @15,DEBDAPTR                                        1454
         STH   @00,DEBSTRCC(,@15)                                  1454
*                   DEBSTRHH=VSMBHH;/*                       @ZA11014*/
         L     @15,@PC00001+8                                      1455
         L     @15,EXOEXT(,@15)                                    1455
         LH    @00,VSMBHH(,@15)                                    1455
         L     @15,DEBDAPTR                                        1455
         STH   @00,DEBSTRHH(,@15)                                  1455
*                   DEBENDCC=VSMECC;/*                       @ZA11014*/
         L     @15,@PC00001+8                                      1456
         L     @15,EXOEXT(,@15)                                    1456
         LH    @00,VSMECC(,@15)                                    1456
         L     @15,DEBDAPTR                                        1456
         STH   @00,DEBENDCC(,@15)                                  1456
*                   DEBENDHH=VSMEHH;/*                       @ZA11014*/
         L     @15,@PC00001+8                                      1457
         L     @15,EXOEXT(,@15)                                    1457
         LH    @00,VSMEHH(,@15)                                    1457
         L     @15,DEBDAPTR                                        1457
         STH   @00,DEBENDHH(,@15)                                  1457
*                   DEBNMTRK=VSMEHH-VSMBHH+1;/*              @ZA11014*/
         L     @15,@PC00001+8                                      1458
         L     @15,EXOEXT(,@15)                                    1458
         L     @14,@PC00001+8                                      1458
         L     @14,EXOEXT(,@14)                                    1458
         LH    @00,VSMEHH(,@15)                                    1458
         SH    @00,VSMBHH(,@14)                                    1458
         AL    @00,@CF00222                                        1458
         L     @15,DEBDAPTR                                        1458
         STH   @00,DEBNMTRK(,@15)                                  1458
*                 END;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1459
*               /*****************************************************/
*               /*                                                   */
*               /* RESTRICT ACCESS TO ONE CYLINDER IF STAGING        */
*               /*                                           @ZA11014*/
*               /* PACK REQUEST - ALWAYS FIRST EXTENT        @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1460
*               IF EXOSPK=ON        /*                       @ZA11014*/
*                 THEN              /*                       @ZA11014*/
*                                                                  1460
@RF01452 L     @15,@PC00001+8                                      1460
         TM    EXOSPK(@15),B'00001000'                             1460
         BNO   @RF01460                                            1460
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET CYLINDER ADDRESS FROM INPUT IN      @ZA11014*/
*                 /* EXOEXT-TRACKS RUN FROM ZERO TO MAX      @ZA11014*/
*                 /* SPECIFIED IN EXOEXT                     @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1461
*                 DO;               /*                       @ZA11014*/
*                   DEBSTRCC=BEGCC; /*                       @ZA11014*/
         L     @15,DEBDAPTR                                        1462
         L     @14,@PC00001+8                                      1462
         L     @14,EXOEXT(,@14)                                    1462
         MVC   DEBSTRCC(2,@15),BEGCC(@14)                          1462
*                   DEBSTRHH=ZERO;  /*                       @ZA11014*/
         LH    @00,ZERO                                            1463
         L     @15,DEBDAPTR                                        1463
         STH   @00,DEBSTRHH(,@15)                                  1463
*                   DEBENDCC=BEGCC; /*                       @ZA11014*/
         L     @15,DEBDAPTR                                        1464
         L     @14,@PC00001+8                                      1464
         L     @14,EXOEXT(,@14)                                    1464
         MVC   DEBENDCC(2,@15),BEGCC(@14)                          1464
*                   DEBENDHH=BEGHH; /*                       @ZA11014*/
         L     @15,DEBDAPTR                                        1465
         L     @14,@PC00001+8                                      1465
         L     @14,EXOEXT(,@14)                                    1465
         MVC   DEBENDHH(2,@15),BEGHH(@14)                          1465
*                   DEBNMTRK=DEBENDHH-DEBSTRHH+1;/*          @ZA11014*/
         L     @15,DEBDAPTR                                        1466
         LH    @00,DEBENDHH(,@15)                                  1466
         N     @00,@CF04424                                        1466
         L     @15,DEBDAPTR                                        1466
         LH    @15,DEBSTRHH(,@15)                                  1466
         N     @15,@CF04424                                        1466
         SLR   @00,@15                                             1466
         AL    @00,@CF00222                                        1466
         L     @15,DEBDAPTR                                        1466
         STH   @00,DEBNMTRK(,@15)                                  1466
*                 END;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1467
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO PROBLEM PROG KEY                @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1468
*               MODEPARM=''B;       /*                       @ZA11014*/
@RF01460 XC    MODEPARM(4),MODEPARM                                1468
*               MODEPARM=MOD2;      /*                       @ZA11014*/
         L     @00,MOD2                                            1469
         ST    @00,MODEPARM                                        1469
*               REG3=MODEPARM;      /*                       @ZA11014*/
         L     REG3,MODEPARM                                       1470
*LRVMODE2:                                                         1471
*               DO;                 /* MODESET MF(E,REG3)            */
LRVMODE2 DS    0H                                                  1472
*                 RESPECIFY                                        1472
*                   GPR01F RESTRICTED;                             1472
*                 GPR01F=REG3;      /* MODESET PARMLIST              */
         LR    GPR01F,REG3                                         1473
*                 SVC(107);         /* ISSUE MODESET SVC             */
         SVC   107                                                 1474
*                 RESPECIFY                                        1475
*                  (GPR01F) UNRESTRICTED;                          1475
*               END;                /* MODESET MF(E,REG3)    @ZA11014*/
*               RESPECIFY                                          1477
*                (REG1,                                            1477
*                 REG3) UNRSTD;     /*                       @ZA11014*/
*               RESPECIFY                                          1478
*                (REG1) UNRSTD;     /*                       @ZA11014*/
*                                                                  1478
*               /*****************************************************/
*               /*                                                   */
*               /* SET RETURN CODE TO OK                     @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1479
*               TESTRC=0;           /*                       @ZA11014
*                                                            @ZA11014*/
         SLR   @03,@03                                             1479
         STH   @03,TESTRC                                          1479
*             END;                  /* RC OK CHECKOPN        @ZA11014*/
*         END;                      /* NOT VTOC HDR REQ      @ZA11014*/
@RF01432 DS    0H                                                  1482
*     END;                          /* RC OK TO BLDBLK       @ZA11014*/
*                                                                  1482
@RC01400 DS    0H                                                  1483
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE TEST IS MADE TO DETERMINE WHETHER            @ZA11014*/
*   /* THE OPEN WAS SUCCESSFUL OR NOT. IF NOT                @ZA11014*/
*   /* THE CONTROL BLOCK IS FREED UP AND THE                 @ZA11014*/
*   /* IOXCTLBK POINTER FIELD IS ZEROED IN THE               @ZA11014*/
*   /* CALLER'S CORE.                                        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1483
*   IF TESTRC^=0&USERIOBP^=NULLPTR  /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
@RF01398 LH    @03,TESTRC                                          1483
         LTR   @03,@03                                             1483
         BZ    @RF01483                                            1483
         L     @03,@PC00001+8                                      1483
         L     @03,EXOCTLBK(,@03)                                  1483
         L     @03,USERIOBP(,@03)                                  1483
         LTR   @03,@03                                             1483
         BZ    @RF01483                                            1483
*     DO;                           /*                       @ZA11014*/
*       CALL IDCSAFS0(GDTTBL,IOCTLBKP);/*                    @ZA11014*/
         L     @03,@PC00001                                        1485
         ST    @03,@AL00001                                        1485
         LA    @03,IOCTLBKP                                        1485
         ST    @03,@AL00001+4                                      1485
         L     @03,@PC00001                                        1485
         L     @15,GDTFSP(,@03)                                    1485
         LA    @01,@AL00001                                        1485
         BALR  @14,@15                                             1485
*       USERIOBP=NULLPTR;           /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1486
         L     @03,EXOCTLBK(,@03)                                  1486
         SLR   @15,@15                                             1486
         ST    @15,USERIOBP(,@03)                                  1486
*     END;                          /*                       @ZA11014*/
*                                                                  1487
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE OPEN IS SUCCESSFUL, THEN IT IS                 @ZA11014*/
*   /* PUT IN THE FRONT OF IODIOX CHAIN AND                  @ZA11014*/
*   /* THE IOXOPN IS SET ON TO INDICATE THAT THE             @ZA11014*/
*   /* DCB HAS BEEN OPENED.                                  @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1488
*   IF TESTRC=0                     /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
@RF01483 LH    @03,TESTRC                                          1488
         LTR   @03,@03                                             1488
         BNZ   @RF01488                                            1488
*     DO;                           /*                       @ZA11014*/
*       IOXCHAIN=IODIOX;            /*                       @ZA11014*/
         L     @03,@PC00001                                        1490
         L     @03,GDTIOH(,@03)                                    1490
         L     @03,IODIOX(,@03)                                    1490
         L     @01,IOCTLBKP                                        1490
         ST    @03,IOXCHAIN(,@01)                                  1490
*       IODIOX=ADDR(IOXCTLBK);      /*                       @ZA11014*/
         L     @03,@PC00001                                        1491
         L     @03,GDTIOH(,@03)                                    1491
         L     @15,IOCTLBKP                                        1491
         ST    @15,IODIOX(,@03)                                    1491
*       IOXOPN=ON;                  /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1492
         OI    IOXOPN(@03),B'10000000'                             1492
*     END;                          /*                       @ZA11014*/
*                                                                  1493
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO IDCIO05 - THE                  @ZA11014*/
*   /* MAIN PROCEDURE. THE RETURN CODE PASSED                @ZA11014*/
*   /* IS THE RETURN CODE FROM THE OPEN                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1494
*                                   /*                       @ZA11014*/
*   RETURN CODE(TESTRC);            /*                       @ZA11014
*                                                            @ZA11014*/
@RF01488 LH    @15,TESTRC                                          1494
         L     @14,@SA00022                                        1494
         LM    @00,@12,@SA00022+8                                  1494
         BR    @14                                                 1494
*   END OPENR;                      /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1496
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - READCNT                                @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - IF FIRST TIME CALLS SUBPROCEDURE SETCCW      @ZA11014*/
*/*              TO BUILD A CCW LIST TO READ THE COUNT FIELDS@ZA11014*/
*/*              FOR THE RECORDS ON THE REQUESTED TRACK,     @ZA11014*/
*/*              AND INITIALIZES COUNTERS                    @ZA11014*/
*/*             CALLS SUBPROCEDURE ISSUEXCP TO DO I/O        @ZA11014*/
*/*             CALCULATES THE NUMBER OF RECORDS READ        @ZA11014*/
*/*             DETERMINES IF ANY REOCRD NUMBERS ARE MISSING @ZA11014*/
*/*             SETS THE COUNT RETURN CODES IN THE LOCATION  @ZA11014*/
*/*              TABLE ENTRIES FOR THE COUNTS READ THIS CALL @ZA11014*/
*/*             RETURNS                                      @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/
*/*          EXCC     FROM EXWRARG                           @ZA11014*/
*/*          EXHH     FROM EXWRARG                           @ZA11014*/
*/*          EXSPACE  FROM EXWRARG                           @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - EXCCWCNT IN EXWRARG                            @ZA11014*/
*/*           EXSPACE IN EXWRARG                             @ZA11014*/
*/*           COUNT FIELD IN RBUFF OF RIOAREA                @ZA11014*/
*/*           COUNT FIELD RETURN CODES IN LOCATION TABLE     @ZA11014*/
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1496
*                                   /*                       @ZA11014*/
*READCNT:                                                          1496
*   PROC;                           /*                       @ZA11014*/
*                                                                  1496
READCNT  STM   @14,@12,@SA00023                                    1496
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOCT' IN TRACE TABLE              @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1497
*   OLDERID2=NEWERID2;                                             1497
         L     @03,@PC00001                                        1497
         L     @03,GDTTR2(,@03)                                    1497
         L     @15,@PC00001                                        1497
         L     @01,GDTTR2(,@15)                                    1497
         MVC   @TS00001(95),NEWERID2(@01)                          1497
         MVC   OLDERID2(95,@03),@TS00001                           1497
*   NEWID2='IOCT';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1498
         L     @03,@PC00001                                        1498
         L     @03,GDTTR2(,@03)                                    1498
         MVC   NEWID2(4,@03),@CC04347                              1498
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO IOXCTLBK AND RIOAREA         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1499
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1499
         L     @03,EXRWCTBL(,@03)                                  1499
         ST    @03,IOCTLBKP                                        1499
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1500
         L     @03,@PC00001+8                                      1500
         L     @03,EXRWIOAR(,@03)                                  1500
         ST    @03,RRIOARPT                                        1500
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THIS IS THE FST TIME                     @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1501
*   IF RFIRST=FSTIME                /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1501
         L     @03,RRIOARPT                                        1501
         CLC   RFIRST(1,@03),FSTIME                                1501
         BNE   @RF01501                                            1501
*     /***************************************************************/
*     /*                                                             */
*     /* IF THIS IS FIRST TIME, SET UP CCW CHAIN             @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1502
*     DO;                           /*                       @ZA11014*/
*       RFIRST=NTFSTIME;            /*                       @ZA11014*/
         IC    @03,NTFSTIME                                        1503
         L     @01,RRIOARPT                                        1503
         STC   @03,RFIRST(,@01)                                    1503
*       CALL SETCCW;                /*                       @ZA11014*/
         BAL   @14,SETCCW                                          1504
*       RESPECIFY                                                  1505
*         RTNREG RSTD;                                             1505
*       TESTRC=RTNREG;                                             1506
         STH   RTNREG,TESTRC                                       1506
*       RESPECIFY                                                  1507
*         RTNREG UNRSTD;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1507
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE LOCATION TABLE ENTRIES TO ZERO         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1508
*       DO RCTR=1 TO LOCENT;        /*                       @ZA11014*/
         LA    @03,1                                               1508
         B     @DE01508                                            1508
@DL01508 DS    0H                                                  1509
*         LOCTAB(RCTR)=LOCTAB(RCTR)&&LOCTAB(RCTR);/*         @ZA11014*/
         LH    @03,RCTR                                            1509
         MH    @03,@CH00279                                        1509
         L     @15,@PC00001+8                                      1509
         L     @01,EXLOCPTR(,@15)                                  1509
         ALR   @01,@03                                             1509
         AL    @01,@CF04425                                        1509
         XC    LOCTAB(20,@01),LOCTAB(@01)                          1509
*       END;                        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1510
         LA    @03,1                                               1510
         AH    @03,RCTR                                            1510
@DE01508 STH   @03,RCTR                                            1510
         CH    @03,LOCENT                                          1510
         BNH   @DL01508                                            1510
*       /*************************************************************/
*       /*                                                           */
*       /* SET LOCATION TABLE ADDR OF RECORD ZERO            @ZA20252*/
*       /* TO THE BEGINNING OF THE BUFFER                    @ZA20252*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1511
*                                   /*                       @ZA20252*/
*       LOCADDR(1)=ADDR(RBUFF);     /*                       @ZA20252
*                                                            @ZA20252*/
*                                                                  1511
         L     @03,@PC00001+8                                      1511
         L     @03,EXLOCPTR(,@03)                                  1511
         L     @01,RRIOARPT                                        1511
         LA    @15,RBUFF(,@01)                                     1511
         ST    @15,LOCADDR(,@03)                                   1511
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE LAST RECORD NUM                        @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1512
*       LSTRECNM=1;                 /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1512
         L     @03,@PC00001+8                                      1512
         MVC   LSTRECNM(2,@03),@CH00222                            1512
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE TOTAL OF COUNT FIELDS PROCCESSED       @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1513
*       RECCNTSV=1;                 /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1513
         L     @03,@PC00001+8                                      1513
         MVC   RECCNTSV(2,@03),@CH00222                            1513
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE DCB AND IOB POINTERS                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1514
*       DCBPTR=ADDR(IOXDCB);        /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1514
         LA    @03,IOXDCB(,@03)                                    1514
         ST    @03,DCBPTR                                          1514
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1515
         L     @03,IOCTLBKP                                        1515
         LA    @03,IOXIOB(,@03)                                    1515
         ST    @03,IOBSTPTR                                        1515
*       /*************************************************************/
*       /*                                                           */
*       /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE     @ZA11014*/
*       /* IOBSEEK CCHHR VALUE                               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1516
*       IOBCC=EXCC;                 /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1516
         L     @01,IOBSTPTR                                        1516
         MVC   IOBCC(2,@01),EXCC(@03)                              1516
*       IOBHH=EXHH;                 /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1517
         L     @01,IOBSTPTR                                        1517
         MVC   IOBHH(2,@01),EXHH(@03)                              1517
*       IOBR=EXRECNUM;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1518
         L     @03,@PC00001+8                                      1518
         IC    @15,EXRECNUM(,@03)                                  1518
         L     @03,IOBSTPTR                                        1518
         STC   @15,IOBR(,@03)                                      1518
*       /*************************************************************/
*       /*                                                           */
*       /* INIT THE START ADDR OF THE CCW CHAIN IN IOB       @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1519
*       IOBSTART=ADDR(IOXCCWS);     /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
         L     @03,IOCTLBKP                                        1519
         LA    @03,IOXCCWS(,@03)                                   1519
         L     @01,IOBSTPTR                                        1519
         ST    @03,IOBSTART(,@01)                                  1519
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*   ELSE                                                           1521
*     ;                             /* NOT FIRST TIME        @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1521
@RF01501 DS    0H                                                  1522
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE EXCP TO PERFORM THE I/O                         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1522
*   CALL ISSUEXCP;                  /*                       @ZA11014*/
         BAL   @14,ISSUEXCP                                        1522
*   RESPECIFY                                                      1523
*     RTNREG RSTD;                                                 1523
*   TESTRC=RTNREG;                                                 1524
         STH   RTNREG,TESTRC                                       1524
*   RESPECIFY                                                      1525
*     RTNREG UNRSTD;                /*                       @ZA11014*/
*                                                                  1525
*   /*****************************************************************/
*   /*                                                               */
*   /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS         */
*   /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW ADDITIONAL   */
*   /* I/O. SO WE CLEAR THEM HERE.                           @ZA17169*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1526
*   IF TESTRC^=0 THEN               /*                       @ZA17169*/
         LH    @03,TESTRC                                          1526
         LTR   @03,@03                                             1526
         BZ    @RF01526                                            1526
*     DCBIFEC='00'B;                /*                       @ZA17169
*                                                            @ZA11014*/
         L     @03,DCBPTR                                          1527
         NI    DCBIFEC+40(@03),B'00111111'                         1527
*                                                                  1528
*   /*****************************************************************/
*   /*                                                               */
*   /* **************************************************@ZA11014    */
*   /*                                                       @ZA11014*/
*   /* THIS CODE CALCULATES THE NUM OF CCW'S EXEC            @ZA11014*/
*   /* AND SETS THE READ COUNT RETURN CODES IN THE           @ZA11014*/
*   /* LOCATION TABLE                                        @ZA11014*/
*   /*                                                       @ZA11014*/
*   /* IT ALSO DETERMINES IF ANY RECORD NUMS ARE MISSING@ZA11014 AND */
*   /* IF SO, IT WILL SET THE COUNT RETURN CODE TO@ZA11014 'RECORD   */
*   /* NOT FOUND' AND THE DATA ADDRESS TO ALL@ZA11014 ONES           */
*   /* ('FFFFFFFF')                                          @ZA11014*/
*   /*                                                       @ZA11014*/
*   /*                                                       @ZA11014*/
*   /*                                                       @ZA11014*/
*   /*                                                       @ZA11014*/
*   /* **************************************************@ZA11014    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1528
*                                   /*                       @ZA11014*/
*                                                                  1528
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID TO 'IOC1'                                @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1528
*   OLDERID2=NEWERID2;                                             1528
@RF01526 L     @03,@PC00001                                        1528
         L     @03,GDTTR2(,@03)                                    1528
         L     @15,@PC00001                                        1528
         L     @01,GDTTR2(,@15)                                    1528
         MVC   @TS00001(95),NEWERID2(@01)                          1528
         MVC   OLDERID2(95,@03),@TS00001                           1528
*   NEWID2='IOC1';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1529
         L     @03,@PC00001                                        1529
         L     @03,GDTTR2(,@03)                                    1529
         MVC   NEWID2(4,@03),@CC04350                              1529
*   /*****************************************************************/
*   /*                                                               */
*   /* CALC NUMB OF CCWS IN STRING THAT HAVE BEEN EXEC'D     @ZA11014*/
*   /* SAVE ADDR OF NEXT CCW TO EXECUTE                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1530
*   SVCCWPTR=IOBCMDA;               /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
         L     @03,@PC00001+8                                      1530
         L     @01,IOBSTPTR                                        1530
         MVC   SVCCWPTR(3,@03),IOBCMDA(@01)                        1530
*   CNTCCWS=(IOBCMDA-ADDR(IOXCCWS))/CCWSIZE;/*               @ZA11014
*                                                            @ZA11014*/
*                                                                  1531
         L     @03,IOCTLBKP                                        1531
         LA    @03,IOXCCWS(,@03)                                   1531
         LR    @00,@03                                             1531
         LCR   @00,@00                                             1531
         L     @03,IOBSTPTR                                        1531
         L     @03,IOBCMDA-1(,@03)                                 1531
         LA    @03,0(,@03)                                         1531
         ALR   @00,@03                                             1531
         SRDA  @00,32                                              1531
         LH    @03,CCWSIZE                                         1531
         DR    @00,@03                                             1531
         STH   @01,CNTCCWS                                         1531
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF AT LEAST ONE COUNT FIELDS READ               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1532
*   IF CNTCCWS>NONRDCT              /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
         LH    @03,CNTCCWS                                         1532
         CH    @03,NONRDCT                                         1532
         BNH   @RF01532                                            1532
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1533
*       /*************************************************************/
*       /*                                                           */
*       /* AT LEAST ONE COUNT FIELD HAS BEEN READ            @ZA11014*/
*       /* CALC INDEX INTO CCW LIST                          @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1534
*       CCWCNT=NONRDCT+RECCNTSV;    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1534
         L     @03,@PC00001+8                                      1534
         LH    @15,NONRDCT                                         1534
         AH    @15,RECCNTSV(,@03)                                  1534
         STH   @15,CCWCNT                                          1534
*       /*************************************************************/
*       /*                                                           */
*       /* RESET THE COUNT OF CCWS TO EXAMINE THIS PASS      @ZA11014*/
*       /* RECCNT WILL ALWAYS BE ONE LESS THAN THE LAST      @ZA11014*/
*       /* CCW EXECUTED, SINCE THAT RECORD'S COUNT FIELD@ZA11014     */
*       /* CANNOT BE EXAMINED THIS TIME                      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1535
*       RECCNT=CNTCCWS-NONRDCT-RECCNTSV;/*                   @ZA11014
*                                                            @ZA11014*/
*                                                                  1535
         L     @03,@PC00001+8                                      1535
         LH    @15,CNTCCWS                                         1535
         SH    @15,NONRDCT                                         1535
         L     @14,@PC00001+8                                      1535
         SH    @15,RECCNTSV(,@14)                                  1535
         STH   @15,RECCNT(,@03)                                    1535
*       /*************************************************************/
*       /*                                                           */
*       /* EXAMINE THE COUNT FIELDS ALREADY READ             @ZA11014*/
*       /* TO DETERMINE IF ANY RECORD NUMBERS ARE MISSIN@ZA11014     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1536
*                                   /*                       @ZA11014*/
*                                                                  1536
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE LOOP CONTROL                           @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1536
*       RCTR=1;                     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1536
         MVC   RCTR(2),@CH00222                                    1536
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP FOR THE NUMBER OF COUNT FIELDS READ          @ZA11014*/
*       /* THE OTHER CHECKS ENSURE THAT THE LOOP             @ZA11014*/
*       /* DOES NOT BECOME INFINITE                          @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1537
*                                   /*                       @ZA11014*/
*       DO WHILE RCTR^>RECCNT&RECCNT^=ZERO/*                 @ZA11014*/
*             &LSTRECNM^=MAXRECS;   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1537
         B     @DE01537                                            1537
@DL01537 DS    0H                                                  1538
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO SEE IF COUNT FIELD IN BUFFER           @ZA11014*/
*         /* IS LAST RECORD NUMBER, OR IF THE CCW            @ZA11014*/
*         /* IS A SPACE COUNT                                @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1538
*         IF LSTRECNM=CCWADDR->RBREC×CCWOP=SPCNTOP/*         @ZA11014*/
*           THEN                    /*                       @ZA11014*/
*                                                                  1538
         L     @03,@PC00001+8                                      1538
         LH    @15,CCWCNT                                          1538
         SLA   @15,3                                               1538
         L     @01,IOCTLBKP                                        1538
         LA    @15,IOXCCW-8(@15,@01)                               1538
         L     @01,CCWADDR-1(,@15)                                 1538
         LH    @03,LSTRECNM(,@03)                                  1538
         SLR   @00,@00                                             1538
         IC    @00,RBREC(,@01)                                     1538
         CR    @03,@00                                             1538
         BE    @RT01538                                            1538
         LH    @03,CCWCNT                                          1538
         SLA   @03,3                                               1538
         L     @01,IOCTLBKP                                        1538
         LA    @03,IOXCCW-8(@03,@01)                               1538
         CLC   CCWOP(1,@03),SPCNTOP                                1538
         BNE   @RF01538                                            1538
@RT01538 DS    0H                                                  1539
*           /*********************************************************/
*           /*                                                       */
*           /* COUNT FIELD IN BUFFER IS FOR THIS REC NU@ZA11014      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1539
*           DO;                     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1539
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT POINTER TO CCW CHAIN AND          @ZA11014*/
*             /* INCREMENT NEXT RECORD NUMBER                @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1540
*                                   /*                       @ZA11014*/
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1540
         LA    @03,1(,@03)                                         1540
         STH   @03,CCWCNT                                          1540
*             LSTRECNM=LSTRECNM+1;  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1541
         L     @03,@PC00001+8                                      1541
         L     @15,@PC00001+8                                      1541
         LA    @14,1                                               1541
         AH    @14,LSTRECNM(,@15)                                  1541
         STH   @14,LSTRECNM(,@03)                                  1541
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT DO WHILE CONTROL                  @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1542
*             RCTR=RCTR+1;          /*                       @ZA11014*/
         LH    @03,RCTR                                            1542
         LA    @03,1(,@03)                                         1542
         STH   @03,RCTR                                            1542
*           END;                    /*                       @ZA11014
*                                                            @ZA11014*/
*         ELSE                      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1544
*           /*********************************************************/
*           /*                                                       */
*           /* RECORD NUMBERS DO NOT MATCH-REC NOT FND       @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1544
*           DO;                     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1544
         B     @RC01538                                            1544
@RF01538 DS    0H                                                  1545
*             /*******************************************************/
*             /*                                                     */
*             /* SET LOCTAB COUNT RET CODE TO REC NOT FND@ZA11014 SET*/
*             /* LOCTAB ADDRESS TO 'FFFFFFFF'                @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1545
*             LOCRCNT(LSTRECNM+1)=RCABNRF;/*                 @ZA11014*/
         L     @03,@PC00001+8                                      1545
         LH    @03,LSTRECNM(,@03)                                  1545
         MH    @03,@CH00279                                        1545
         L     @15,@PC00001+8                                      1545
         L     @01,EXLOCPTR(,@15)                                  1545
         LH    @00,RCABNRF                                         1545
         STH   @00,LOCRCNT(@03,@01)                                1545
*             LOCADDR(LSTRECNM+1)=NTFNDPTR;/*                @ZA11014
*                                                            @ZA11014*/
*                                                                  1546
         L     @03,@PC00001+8                                      1546
         LH    @03,LSTRECNM(,@03)                                  1546
         MH    @03,@CH00279                                        1546
         L     @15,@PC00001+8                                      1546
         L     @01,EXLOCPTR(,@15)                                  1546
         ICM   @00,15,NTFNDPTR                                     1546
         ST    @00,LOCADDR(@03,@01)                                1546
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT NEXT RECORD NUMBER                @ZA11014*/
*             /* DO NOT INCREMENT CCW PTR OR LOOP CONTRO@ZA11014     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1547
*             LSTRECNM=LSTRECNM+1;  /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1547
         L     @15,@PC00001+8                                      1547
         LA    @14,1                                               1547
         AH    @14,LSTRECNM(,@15)                                  1547
         STH   @14,LSTRECNM(,@03)                                  1547
*           END;                    /*                       @ZA11014
*                                                            @ZA11014*/
*       END;                        /* END DO WHILE@ZA11014  @ZA11014*/
*                                                                  1549
@RC01538 DS    0H                                                  1549
@DE01537 L     @03,@PC00001+8                                      1549
         LH    @15,RCTR                                            1549
         CH    @15,RECCNT(,@03)                                    1549
         BH    @DC01537                                            1549
         L     @03,@PC00001+8                                      1549
         CLC   RECCNT(2,@03),ZERO                                  1549
         BE    @DC01537                                            1549
         L     @03,@PC00001+8                                      1549
         CLC   LSTRECNM(2,@03),MAXRECS                             1549
         BNE   @DL01537                                            1549
@DC01537 DS    0H                                                  1550
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK WHY EXITED FROM DO WHILE                    @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1550
*       IF LSTRECNM=>MAXRECS        /*                       @ZA11014
*                                                            @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1550
         L     @03,@PC00001+8                                      1550
         LH    @03,LSTRECNM(,@03)                                  1550
         CH    @03,MAXRECS                                         1550
         BL    @RF01550                                            1550
*         /***********************************************************/
*         /*                                                         */
*         /* CNT FIELD READ IS GARBAGE-UNEXP RESULT@ZA11014          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1551
*         TESTRC=RCSRUEX;           /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCSRUEX                                         1551
         STH   @03,TESTRC                                          1551
*       ELSE                        /*                       @ZA11014*/
*         DO;                       /*                       @ZA11014*/
*                                                                  1552
         B     @RC01550                                            1552
@RF01550 DS    0H                                                  1553
*           /*********************************************************/
*           /*                                                       */
*           /* ALL COUNTS HAVE BEEN EXAMINED EXCEPT          @ZA11014*/
*           /* THE LAST ONE FOR THE LAST CCW EXECUTED@ZA11014 SET THE*/
*           /* CURRENT RETURN CODE INTO LOCTA@ZA11014 ENTRY FOR      */
*           /* LATEST RECORD NUMBER                          @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1553
*           LOCRCNT(LSTRECNM+1)=TESTRC;/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1553
         L     @03,@PC00001+8                                      1553
         LH    @03,LSTRECNM(,@03)                                  1553
         MH    @03,@CH00279                                        1553
         L     @15,@PC00001+8                                      1553
         L     @01,EXLOCPTR(,@15)                                  1553
         LH    @00,TESTRC                                          1553
         STH   @00,LOCRCNT(@03,@01)                                1553
*           /*********************************************************/
*           /*                                                       */
*           /* UPDATE NUM OF CNT FIELDS EXAMINED             @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1554
*           RECCNTSV=RECCNTSV+RECCNT;/*                      @ZA11014
*                                                            @ZA11014*/
*                                                                  1554
         L     @03,@PC00001+8                                      1554
         L     @15,@PC00001+8                                      1554
         L     @14,@PC00001+8                                      1554
         LH    @15,RECCNTSV(,@15)                                  1554
         AH    @15,RECCNT(,@14)                                    1554
         STH   @15,RECCNTSV(,@03)                                  1554
*           /*********************************************************/
*           /*                                                       */
*           /* SET NUM OF LAST REC READ BACK TO CALLE@ZA11014        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1555
*           EXCCWCNT=LSTRECNM;      /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1555
         L     @15,@PC00001+8                                      1555
         LH    @15,LSTRECNM(,@15)                                  1555
         STH   @15,EXCCWCNT(,@03)                                  1555
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1556
*       /*************************************************************/
*       /*                                                           */
*       /* END OF DO FOR ONE COUNT FIELD                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1557
*     END;                          /*                       @ZA11014*/
*                                                                  1557
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURNED FROM UEXCP BEFORE FIRST READ COUNT           @ZA11014*/
*   /* CHECK TO SEE IF PROCESSING RECORD 0                   @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1558
*   ELSE                            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1558
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF NOT R0                                     @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1558
*     IF CNTCCWS^=R0CHNLOC          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1558
*     /***************************************************************/
*     /*                                                             */
*     /* BEFORE FIRST READ COUNT, BUT NOT R0 READ            @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1558
*       THEN                        /*                       @ZA11014*/
*                                                                  1558
         B     @RC01532                                            1558
@RF01532 CLC   CNTCCWS(2),R0CHNLOC                                 1558
         BE    @RF01558                                            1558
*       /*************************************************************/
*       /*                                                           */
*       /* SET RETURN CODE TO UNEXPECTED RESULTS             @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1559
*       TESTRC=RCSRUEX;             /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCSRUEX                                         1559
         STH   @03,TESTRC                                          1559
*     ELSE                          /*                       @ZA11014*/
*                                                                  1560
*       /*************************************************************/
*       /*                                                           */
*       /* LAST CCW READ WAS READ R0                         @ZA11014*/
*       /* RETURN WITH NUM LAST REC READ AS R0               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1560
*       EXCCWCNT=ZERO;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1560
         B     @RC01558                                            1560
@RF01558 L     @03,@PC00001+8                                      1560
         LH    @15,ZERO                                            1560
         STH   @15,EXCCWCNT(,@03)                                  1560
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH RETURN CODE FROM ISSUEXCP                 @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1561
*   RETURN CODE(TESTRC);            /*                       @ZA11014
*                                                            @ZA11014*/
@RC01558 DS    0H                                                  1561
@RC01532 LH    @15,TESTRC                                          1561
         L     @14,@SA00023                                        1561
         LM    @00,@12,@SA00023+8                                  1561
         BR    @14                                                 1561
*   END READCNT;                    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1563
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - READKD                                 @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - IF FIRST TIME CALLS SUBPROCEDURE SETKDCCW    @ZA11014*/
*/*              TO BUILD A CCW LIST TO READ THE COUNT       @ZA11014*/
*/*              KEY AND DATA FIELDS                         @ZA11014*/
*/*              FOR THE RECORDS ON THE REQUESTED TRACK,     @ZA11014*/
*/*              AND INITIALIZES COUNTERS                    @ZA11014*/
*/*             IF NOT THE FIRST TIME, CALLS SUBPROCEDURE    @ZA11014*/
*/*              ADJCCW TO BYPASS THOSE RECORDS ALREADY READ @ZA11014*/
*/*             CALLS SUBPROCEDURE ISSUEXCP TO DO I/O        @ZA11014*/
*/*             CALCULATES THE NUMBER OF RECORDS READ        @ZA11014*/
*/*             SETS THE KEY/DATA RET CODES IN THE LOCATION  @ZA11014*/
*/*              TABLE ENTRIES FOR THE RECORDS READ THIS CALL@ZA11014*/
*/*             RETURNS                                      @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/
*/*          EXCC     FROM EXWRARG                           @ZA11014*/
*/*          EXHH     FROM EXWRARG                           @ZA11014*/
*/*          EXLOCPTR FROM EXWRARG                           @ZA11014*/
*/*          EXSPACE  FROM EXWRARG                           @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - EXCCWCNT IN EXWRARG                            @ZA11014*/
*/*           RECORDS IN RBUFF OF RIOAREA                    @ZA11014*/
*/*           EXSPACE IN EXWRARG                             @ZA11014*/
*/*           KEY/DATA    RETURN CODES IN LOCATION TABLE     @ZA11014*/
*/*           RETURN CODE OF LAST RECORD READ IN REG 15      @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1563
*READKD:                                                           1563
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1563
READKD   STM   @14,@12,@SA00024                                    1563
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'IOCT' IN TRACE TABLE              @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1564
*   OLDERID2=NEWERID2;                                             1564
         L     @03,@PC00001                                        1564
         L     @03,GDTTR2(,@03)                                    1564
         L     @15,@PC00001                                        1564
         L     @01,GDTTR2(,@15)                                    1564
         MVC   @TS00001(95),NEWERID2(@01)                          1564
         MVC   OLDERID2(95,@03),@TS00001                           1564
*   NEWID2='IOKD';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1565
         L     @03,@PC00001                                        1565
         L     @03,GDTTR2(,@03)                                    1565
         MVC   NEWID2(4,@03),@CC04354                              1565
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO IOXCTLBK AND RIOAREA         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1566
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1566
         L     @03,EXRWCTBL(,@03)                                  1566
         ST    @03,IOCTLBKP                                        1566
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1567
         L     @03,@PC00001+8                                      1567
         L     @03,EXRWIOAR(,@03)                                  1567
         ST    @03,RRIOARPT                                        1567
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THIS IS THE FST TIME                     @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1568
*   IF RFIRST=FSTIME                /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1568
         L     @03,RRIOARPT                                        1568
         CLC   RFIRST(1,@03),FSTIME                                1568
         BNE   @RF01568                                            1568
*     /***************************************************************/
*     /*                                                             */
*     /* IF THIS IS FIRST TIME, SET UP CCW CHAIN             @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1569
*     DO;                           /*                       @ZA11014*/
*       RFIRST=NTFSTIME;            /*                       @ZA11014*/
         IC    @03,NTFSTIME                                        1570
         L     @01,RRIOARPT                                        1570
         STC   @03,RFIRST(,@01)                                    1570
*       CALL SETKDCCW;              /*                       @ZA11014*/
         BAL   @14,SETKDCCW                                        1571
*       RESPECIFY                                                  1572
*         RTNREG RSTD;                                             1572
*       TESTRC=RTNREG;                                             1573
         STH   RTNREG,TESTRC                                       1573
*       RESPECIFY                                                  1574
*         RTNREG UNRSTD;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1574
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE LAST RECORD NUM PROCESSED              @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1575
*       LSTRECNM=1;                 /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1575
         L     @03,@PC00001+8                                      1575
         MVC   LSTRECNM(2,@03),@CH00222                            1575
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE TOTAL OF CCWS PROCESSED                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1576
*       RECCNTSV=1;                 /*                       @ZA11014*/
*                                                                  1576
         L     @03,@PC00001+8                                      1576
         MVC   RECCNTSV(2,@03),@CH00222                            1576
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE DCB AND IOB POINTERS                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1577
*       DCBPTR=ADDR(IOXDCB);        /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1577
         LA    @03,IOXDCB(,@03)                                    1577
         ST    @03,DCBPTR                                          1577
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1578
         L     @03,IOCTLBKP                                        1578
         LA    @03,IOXIOB(,@03)                                    1578
         ST    @03,IOBSTPTR                                        1578
*       /*************************************************************/
*       /*                                                           */
*       /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE     @ZA11014*/
*       /* IOBSEEK CCHHR VALUE                               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1579
*       IOBCC=EXCC;                 /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1579
         L     @01,IOBSTPTR                                        1579
         MVC   IOBCC(2,@01),EXCC(@03)                              1579
*       IOBHH=EXHH;                 /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1580
         L     @01,IOBSTPTR                                        1580
         MVC   IOBHH(2,@01),EXHH(@03)                              1580
*       IOBR=EXRECNUM;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1581
         L     @03,@PC00001+8                                      1581
         IC    @15,EXRECNUM(,@03)                                  1581
         L     @03,IOBSTPTR                                        1581
         STC   @15,IOBR(,@03)                                      1581
*       /*************************************************************/
*       /*                                                           */
*       /* INIT THE START ADDR OF THE CCW CHAIN IN IOB       @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1582
*       IOBSTART=ADDR(IOXCCWS);     /*                       @ZA11014
*                                                            @ZA11014*/
         L     @03,IOCTLBKP                                        1582
         LA    @03,IOXCCWS(,@03)                                   1582
         L     @01,IOBSTPTR                                        1582
         ST    @03,IOBSTART(,@01)                                  1582
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*   ELSE                            /*                       @ZA11014*/
*                                                                  1584
*     /***************************************************************/
*     /*                                                             */
*     /* NOT FIRST TIME-DONT REEXECUTE CCWS ALREADY RD@ZA11014       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1584
*     DO;                           /*                       @ZA11014*/
         B     @RC01568                                            1584
@RF01568 DS    0H                                                  1585
*       CALL ADJCCW;                /*                       @ZA11014*/
         BAL   @14,ADJCCW                                          1585
*       RESPECIFY                                                  1586
*         RTNREG RSTD;                                             1586
*       TESTRC=RTNREG;                                             1587
         STH   RTNREG,TESTRC                                       1587
*       RESPECIFY                                                  1588
*         RTNREG UNRSTD;            /*                       @ZA11014*/
*     END;                          /*                       @ZA11014*/
*                                                                  1590
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF UNEXPECTED RESULTS FROM CCW BUILDING           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1590
*   IF TESTRC^=RCSRUEX              /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1590
@RC01568 CLC   TESTRC(2),RCSRUEX                                   1590
         BE    @RF01590                                            1590
*     /***************************************************************/
*     /*                                                             */
*     /* OK TO CONTINUE                                      @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1591
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1591
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE EXCP TO PERFORM THE I/O                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1592
*       CALL ISSUEXCP;              /*                       @ZA11014*/
         BAL   @14,ISSUEXCP                                        1592
*       RESPECIFY                                                  1593
*         RTNREG RSTD;                                             1593
*       TESTRC=RTNREG;                                             1594
         STH   RTNREG,TESTRC                                       1594
*       RESPECIFY                                                  1595
*         RTNREG UNRSTD;            /*                       @ZA11014*/
*                                                                  1595
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS     */
*       /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW          */
*       /* ADDITIONAL I/O. SO WE CLEAR THEM HERE.            @ZA17169*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1596
*       IF TESTRC^=0 THEN           /*                       @ZA17169*/
         LH    @03,TESTRC                                          1596
         LTR   @03,@03                                             1596
         BZ    @RF01596                                            1596
*         DCBIFEC='00'B;            /*                       @ZA17169*/
*                                                                  1597
         L     @03,DCBPTR                                          1597
         NI    DCBIFEC+40(@03),B'00111111'                         1597
*       /*************************************************************/
*       /*                                                           */
*       /* **********************************************@ZA11014    */
*       /*                                                   @ZA11014*/
*       /* THIS CODE CALCULATES THE NUM OF CCW'S EXEC        @ZA11014*/
*       /* AND SETS THE READ KEY/DATA RET CODES IN THE       @ZA11014*/
*       /* LOCATION TABLE                                    @ZA11014*/
*       /*                                                   @ZA11014*/
*       /*                                                   @ZA11014*/
*       /*                                                   @ZA11014*/
*       /*                                                   @ZA11014*/
*       /*                                                   @ZA11014*/
*       /* **********************************************@ZA11014    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1598
*                                   /*                       @ZA11014*/
*                                                                  1598
*       /*************************************************************/
*       /*                                                           */
*       /* SET TRACE ID TO 'IOK2'                            @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1598
*       OLDERID2=NEWERID2;                                         1598
@RF01596 L     @03,@PC00001                                        1598
         L     @03,GDTTR2(,@03)                                    1598
         L     @15,@PC00001                                        1598
         L     @01,GDTTR2(,@15)                                    1598
         MVC   @TS00001(95),NEWERID2(@01)                          1598
         MVC   OLDERID2(95,@03),@TS00001                           1598
*       NEWID2='IOK2';              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1599
         L     @03,@PC00001                                        1599
         L     @03,GDTTR2(,@03)                                    1599
         MVC   NEWID2(4,@03),@CC04357                              1599
*       /*************************************************************/
*       /*                                                           */
*       /* CALC NUMB OF CCWS THAT HAVE BEEN EXEC'D           @ZA11014*/
*       /* SAVE ADDR OF NEXT CCW TO EXECUTE                  @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1600
*       SVCCWPTR=IOBCMDA;           /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1600
         L     @01,IOBSTPTR                                        1600
         MVC   SVCCWPTR(3,@03),IOBCMDA(@01)                        1600
*       CNTCCWS=(IOBCMDA-ADDR(IOXCCWS))/CCWSIZE;/*           @ZA11014
*                                                            @ZA11014*/
*                                                                  1601
         L     @03,IOCTLBKP                                        1601
         LA    @03,IOXCCWS(,@03)                                   1601
         LR    @00,@03                                             1601
         LCR   @00,@00                                             1601
         L     @03,IOBSTPTR                                        1601
         L     @03,IOBCMDA-1(,@03)                                 1601
         LA    @03,0(,@03)                                         1601
         ALR   @00,@03                                             1601
         SRDA  @00,32                                              1601
         LH    @03,CCWSIZE                                         1601
         DR    @00,@03                                             1601
         STH   @01,CNTCCWS                                         1601
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF THIS PASS WE READ AT LEAST AS     @ZA11014*/
*       /* MANY CCWS AS WE DID LAST PASS                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1602
*       IF CNTCCWS<RECCNTSV         /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1602
         L     @03,@PC00001+8                                      1602
         LH    @15,CNTCCWS                                         1602
         CH    @15,RECCNTSV(,@03)                                  1602
         BNL   @RF01602                                            1602
*         /***********************************************************/
*         /*                                                         */
*         /* FEWER CCWS EXECUTED THIS TIME -                 @ZA11014*/
*         /* SET UNCORRECTABE I/O ERROR IN ALL LOCTAB        @ZA11014*/
*         /* ENTRIES BEYOND THE LAST ONE READ LAST PAS@ZA11014 AND   */
*         /* THEN RETURN WITH KD RETURN CODE OF TH@ZA11014 REQUESTED */
*         /* RECORD                                          @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1603
*         DO;                       /*                       @ZA11014*/
*           DO RCTR=(EXCCWCNT+1) TO LOCENT;/*                @ZA11014*/
         L     @03,@PC00001+8                                      1604
         LA    @15,1                                               1604
         AH    @15,EXCCWCNT(,@03)                                  1604
         B     @DE01604                                            1604
@DL01604 DS    0H                                                  1605
*             LOCADDR(RCTR)=NTFNDPTR;/*                      @ZA11014*/
         LH    @03,RCTR                                            1605
         MH    @03,@CH00279                                        1605
         L     @15,@PC00001+8                                      1605
         L     @01,EXLOCPTR(,@15)                                  1605
         ICM   @00,15,NTFNDPTR                                     1605
         AL    @01,@CF04425                                        1605
         ST    @00,LOCADDR(@03,@01)                                1605
*             LOCRCKD(RCTR)=RCSRUNCO;/*                      @ZA11014*/
         LH    @03,RCTR                                            1606
         MH    @03,@CH00279                                        1606
         L     @15,@PC00001+8                                      1606
         L     @01,EXLOCPTR(,@15)                                  1606
         LH    @00,RCSRUNCO                                        1606
         AL    @01,@CF04427                                        1606
         STH   @00,LOCRCKD-6(@03,@01)                              1606
*           END;                    /*                       @ZA11014
*                                                            @ZA11014*/
         LA    @15,1                                               1607
         AH    @15,RCTR                                            1607
@DE01604 STH   @15,RCTR                                            1607
         CH    @15,LOCENT                                          1607
         BNH   @DL01604                                            1607
*           TESTRC=LOCRCKD(EXRECNUM+1);/*                    @ZA11014*/
         L     @03,@PC00001+8                                      1608
         SLR   @15,@15                                             1608
         IC    @15,EXRECNUM(,@03)                                  1608
         MH    @15,@CH00279                                        1608
         L     @03,@PC00001+8                                      1608
         L     @03,EXLOCPTR(,@03)                                  1608
         LH    @03,LOCRCKD(@15,@03)                                1608
         STH   @03,TESTRC                                          1608
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*       ELSE                        /*                       @ZA11014*/
*         DO;                       /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1610
         B     @RC01602                                            1610
@RF01602 DS    0H                                                  1611
*           /*********************************************************/
*           /*                                                       */
*           /* ENSURE AT LEAST RECORD ONE HAS BEEN READ      @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1611
*           IF CNTCCWS>NONRDCT      /*                       @ZA11014*/
*             THEN                  /*                       @ZA11014*/
         LH    @03,CNTCCWS                                         1611
         CH    @03,NONRDCT                                         1611
         BNH   @RF01611                                            1611
*             DO;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1612
*               /*****************************************************/
*               /*                                                   */
*               /* AT LEAST RECORD 1 HAS BEEN READ           @ZA11014*/
*               /* CALC INDEX INTO CCW LIST                  @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1613
*               CCWCNT=NONRDCT+RECCNTSV;/*                   @ZA11014
*                                                            @ZA11014*/
*                                                                  1613
         L     @03,@PC00001+8                                      1613
         LH    @15,NONRDCT                                         1613
         AH    @15,RECCNTSV(,@03)                                  1613
         STH   @15,CCWCNT                                          1613
*               /*****************************************************/
*               /*                                                   */
*               /* CALCULATE NUM OF CCWS IN LOOP THIS PASS   @ZA11014*/
*               /* RECCNT WILL ALWAYS BE ONE LESS THAN LAST  @ZA11014*/
*               /* CCW EXECUTED SINCE THAT CCW               @ZA11014*/
*               /* WILL BE EXAMINED WHEN OUT OF LOOP         @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1614
*               RECCNT=CNTCCWS-NONRDCT-RECCNTSV;/*           @ZA11014
*                                                            @ZA11014*/
*                                                                  1614
         L     @03,@PC00001+8                                      1614
         LH    @15,CNTCCWS                                         1614
         SH    @15,NONRDCT                                         1614
         L     @14,@PC00001+8                                      1614
         SH    @15,RECCNTSV(,@14)                                  1614
         STH   @15,RECCNT(,@03)                                    1614
*               /*****************************************************/
*               /*                                                   */
*               /* EXAMINE THE RECORDS ALREADY READ AND SET  @ZA11014*/
*               /* THE KEY/DATA RETURN CODES TO OK           @ZA11014*/
*               /* SPACE COUNT CCWS WILL BE BYPASSED         @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1615
*                                   /*                       @ZA11014*/
*                                                                  1615
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE LOOP CONTROL                   @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1615
*               RCTR=1;             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1615
         MVC   RCTR(2),@CH00222                                    1615
*               /*****************************************************/
*               /*                                                   */
*               /* LOOP FOR THE NUMBER OF CCWS EXECUTED      @ZA11014*/
*               /* THE OTHER CHECKS ENSURE THAT THE LOOP     @ZA11014*/
*               /* DOES NOT BECOME INFINITE                  @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1616
*                                   /*                       @ZA11014*/
*               DO WHILE RCTR^>RECCNT&RECCNT^=ZERO/*         @ZA11014*/
*                     &LSTRECNM^=MAXRECS;/*                  @ZA11014
*                                                            @ZA11014*/
*                                                                  1616
         B     @DE01616                                            1616
@DL01616 DS    0H                                                  1617
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK TO SEE IF RECORD FOR THIS RECORD  @ZA11014*/
*                 /* NUMBER EXISTS                           @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1617
*                 IF LOCADDR(LSTRECNM+1)^=NTFNDPTR/*         @ZA11014*/
*                   THEN            /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1617
         LH    @03,LSTRECNM(,@03)                                  1617
         MH    @03,@CH00279                                        1617
         L     @15,@PC00001+8                                      1617
         L     @01,EXLOCPTR(,@15)                                  1617
         L     @03,LOCADDR(@03,@01)                                1617
         ICM   @15,15,NTFNDPTR                                     1617
         CLR   @03,@15                                             1617
         BE    @RF01617                                            1617
*                   DO;             /*                       @ZA11014*/
*                                                                  1618
*                     /***********************************************/
*                     /*                                             */
*                     /* THIS ENTRY FOR PROPER RECORD NUMBER @ZA11014*/
*                     /* LOOP FOR THE NUMBER OF CCWS EXECUTED@0Z11014*/
*                     /* THIS TIME TO DETERMINE HOW MANY RECS@0Z11014*/
*                     /* WERE ACTUALLY READ - COUNT CCWS DONT@0Z11014*/
*                     /* COUNT                               @0Z11014*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1619
*                     IF CCWOP^=SPCNTOP&CCWOP^=RDCNTOP/*     @0Z11014*/
*                       THEN        /*                       @ZA11014*/
*                                                                  1619
         LH    @03,CCWCNT                                          1619
         SLA   @03,3                                               1619
         L     @01,IOCTLBKP                                        1619
         LA    @03,IOXCCW-8(@03,@01)                               1619
         CLC   CCWOP(1,@03),SPCNTOP                                1619
         BE    @RF01619                                            1619
         LH    @03,CCWCNT                                          1619
         SLA   @03,3                                               1619
         L     @01,IOCTLBKP                                        1619
         LA    @03,IOXCCW-8(@03,@01)                               1619
         CLC   CCWOP(1,@03),RDCNTOP                                1619
         BE    @RF01619                                            1619
*                       /*********************************************/
*                       /*                                           */
*                       /* NOT A COUNT CCW                   @0Z11014*/
*                       /* INCREMENT TO NEXT RECORD NUM      @ZA11014*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1620
*                       DO;         /*                       @ZA11014*/
*                         LSTRECNM=LSTRECNM+1;/*             @ZA11014*/
         L     @03,@PC00001+8                                      1621
         L     @15,@PC00001+8                                      1621
         LA    @14,1                                               1621
         AH    @14,LSTRECNM(,@15)                                  1621
         STH   @14,LSTRECNM(,@03)                                  1621
*                       END;        /*                       @ZA11014*/
*                     ELSE                                         1623
*                       ;           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1623
@RF01619 DS    0H                                                  1624
*                     /***********************************************/
*                     /*                                             */
*                     /* INCREMENT POINTER IN CCW CHAIN      @ZA11014*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1624
*                     CCWCNT=CCWCNT+1;/*                     @ZA11014
*                                                            @ZA11014*/
*                                                                  1624
         LH    @03,CCWCNT                                          1624
         LA    @03,1(,@03)                                         1624
         STH   @03,CCWCNT                                          1624
*                     /***********************************************/
*                     /*                                             */
*                     /* INCREMENT DO WHILE CONTROL          @ZA11014*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1625
*                     RCTR=RCTR+1;  /*                       @ZA11014*/
         LH    @03,RCTR                                            1625
         LA    @03,1(,@03)                                         1625
         STH   @03,RCTR                                            1625
*                   END;            /*                       @ZA11014
*                                                            @ZA11014*/
*                 ELSE              /*                       @ZA11014*/
*                                                                  1627
*                   /*************************************************/
*                   /*                                               */
*                   /* RECORD NUMBER DOESNT EXIST            @ZA11014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1627
*                   DO;             /*                       @ZA11014*/
*                                                                  1627
         B     @RC01617                                            1627
@RF01617 DS    0H                                                  1628
*                     /***********************************************/
*                     /*                                             */
*                     /* INCREMENT NEXT RECORD NUMBER        @ZA11014*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1628
*                     LSTRECNM=LSTRECNM+1;/*                 @ZA11014*/
         L     @03,@PC00001+8                                      1628
         L     @15,@PC00001+8                                      1628
         LA    @14,1                                               1628
         AH    @14,LSTRECNM(,@15)                                  1628
         STH   @14,LSTRECNM(,@03)                                  1628
*                   END;            /*                       @ZA11014
*                                                            @ZA11014*/
*               END;                /* END DO WHILE@ZA11014  @ZA11014*/
*                                                                  1630
@RC01617 DS    0H                                                  1630
@DE01616 L     @03,@PC00001+8                                      1630
         LH    @15,RCTR                                            1630
         CH    @15,RECCNT(,@03)                                    1630
         BH    @DC01616                                            1630
         L     @03,@PC00001+8                                      1630
         CLC   RECCNT(2,@03),ZERO                                  1630
         BE    @DC01616                                            1630
         L     @03,@PC00001+8                                      1630
         CLC   LSTRECNM(2,@03),MAXRECS                             1630
         BNE   @DL01616                                            1630
@DC01616 DS    0H                                                  1631
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK WHY EXITED FROM DO WHILE            @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1631
*               IF LSTRECNM=>MAXRECS×CCWOP=SPCNTOP/*         @ZA11014*/
*                   ×CCWOP=RDCNTOP  /*                       @0Z11014*/
*                 THEN              /*                       @ZA11014*/
*                                                                  1631
         L     @03,@PC00001+8                                      1631
         LH    @03,LSTRECNM(,@03)                                  1631
         CH    @03,MAXRECS                                         1631
         BNL   @RT01631                                            1631
         LH    @03,CCWCNT                                          1631
         SLA   @03,3                                               1631
         L     @01,IOCTLBKP                                        1631
         LA    @03,IOXCCW-8(@03,@01)                               1631
         CLC   CCWOP(1,@03),SPCNTOP                                1631
         BE    @RT01631                                            1631
         LH    @03,CCWCNT                                          1631
         SLA   @03,3                                               1631
         L     @01,IOCTLBKP                                        1631
         LA    @03,IOXCCW-8(@03,@01)                               1631
         CLC   CCWOP(1,@03),RDCNTOP                                1631
         BNE   @RF01631                                            1631
@RT01631 DS    0H                                                  1632
*                 /***************************************************/
*                 /*                                                 */
*                 /* LAST RECORD GREATER THAN MAXIMUM        @ZA11014*/
*                 /* ON TRACK- OR STOPPED ON COUNT           @0Z11014*/
*                 /* READ WHICH IS A NO-NO                   @0Z11014*/
*                 /* A PROBLEM EXISTS--UNEXPECTED RESUL@ZA11014      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1632
*                 TESTRC=RCSRUEX;   /*                       @ZA11014*/
         LH    @03,RCSRUEX                                         1632
         STH   @03,TESTRC                                          1632
*               ELSE                /*                       @ZA11014*/
*                 DO;               /*                       @ZA11014*/
*                                                                  1633
         B     @RC01631                                            1633
@RF01631 DS    0H                                                  1634
*                   /*************************************************/
*                   /*                                               */
*                   /* ALL THE KEY/DATA RET CDS HAVE BEEN@ZA11014 SET*/
*                   /* EXCEPT FOR LAST CCW EXEC'ED           @ZA11014*/
*                   /* UNLESS LAST CCW WAS FOR EOF.          @ZA25908*/
*                   /* SET THE CURRENT RET CODE IN LOCTAB@ZA11014    */
*                   /* ENTRY FOR LATEST RECORD NUMBER        @ZA11014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1634
*                   IF LOCRCKD(LSTRECNM+1)=RCNOERR THEN/*    @ZA25908*/
         L     @03,@PC00001+8                                      1634
         LH    @03,LSTRECNM(,@03)                                  1634
         MH    @03,@CH00279                                        1634
         L     @15,@PC00001+8                                      1634
         L     @01,EXLOCPTR(,@15)                                  1634
         LH    @03,LOCRCKD(@03,@01)                                1634
         CH    @03,RCNOERR                                         1634
         BNE   @RF01634                                            1634
*                     LOCRCKD(LSTRECNM+1)=TESTRC;/*          @ZA25908
*                                                            @ZA11014*/
*                                                                  1635
         L     @03,@PC00001+8                                      1635
         LH    @03,LSTRECNM(,@03)                                  1635
         MH    @03,@CH00279                                        1635
         L     @15,@PC00001+8                                      1635
         L     @01,EXLOCPTR(,@15)                                  1635
         LH    @00,TESTRC                                          1635
         STH   @00,LOCRCKD(@03,@01)                                1635
*                   /*************************************************/
*                   /*                                               */
*                   /* UPDATE NUM OF CCWS PROCESSED SO FA@ZA11014    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1636
*                   RECCNTSV=RECCNTSV+RECCNT;/*              @0Z11014
*                                                            @ZA11014*/
*                                                                  1636
@RF01634 L     @03,@PC00001+8                                      1636
         L     @15,@PC00001+8                                      1636
         L     @14,@PC00001+8                                      1636
         LH    @15,RECCNTSV(,@15)                                  1636
         AH    @15,RECCNT(,@14)                                    1636
         STH   @15,RECCNTSV(,@03)                                  1636
*                   /*************************************************/
*                   /*                                               */
*                   /* SET LAST REC NUM READ IN RDARG        @ZA11014*/
*                   /* IF LAST CCW EXECUTED WAS A READ       @ZA11014*/
*                   /* KEY/DATA IT IS POSSIBLE THAT THE      @ZA11014*/
*                   /* DATA WAS NOT TRANSFERRED-THUS         @ZA11014*/
*                   /* ENSURE THAT WE GET CALLED AGAIN       @ZA11014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1637
*                   IF CCWOP=RDKDOP /*                       @ZA11014*/
*                     THEN          /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1637
         SLA   @03,3                                               1637
         L     @01,IOCTLBKP                                        1637
         LA    @03,IOXCCW-8(@03,@01)                               1637
         CLC   CCWOP(1,@03),RDKDOP                                 1637
         BNE   @RF01637                                            1637
*                     EXCCWCNT=LSTRECNM-1;/*                 @ZA11014*/
         L     @03,@PC00001+8                                      1638
         L     @15,@PC00001+8                                      1638
         LH    @15,LSTRECNM(,@15)                                  1638
         BCTR  @15,0                                               1638
         STH   @15,EXCCWCNT(,@03)                                  1638
*                   ELSE            /*                       @ZA11014*/
*                     EXCCWCNT=LSTRECNM;/*                   @ZA11014
*                                                            @ZA11014*/
         B     @RC01637                                            1639
@RF01637 L     @03,@PC00001+8                                      1639
         L     @15,@PC00001+8                                      1639
         LH    @15,LSTRECNM(,@15)                                  1639
         STH   @15,EXCCWCNT(,@03)                                  1639
*                 END;              /*                       @ZA11014*/
*                                                                  1640
*               /*****************************************************/
*               /*                                                   */
*               /* END OF AT LEAST RECORD ONE HAS BEEN READ  @ZA11014*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1641
*             END;                  /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1641
*           /*********************************************************/
*           /*                                                       */
*           /* RETURNED FROM UEXCP BEFORE RECORD ONE READ    @ZA11014*/
*           /* UNEXPECTED RESULTS                            @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1642
*           ELSE                    /*                       @ZA11014*/
*                                                                  1642
*             /*******************************************************/
*             /*                                                     */
*             /* SET TESTRC                                  @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1642
*             TESTRC=RCSRUEX;       /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1642
         B     @RC01611                                            1642
@RF01611 LH    @03,RCSRUEX                                         1642
         STH   @03,TESTRC                                          1642
*           /*********************************************************/
*           /*                                                       */
*           /* GOT AT LEAST AS FAR AS LAST TIME ELSE         @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1643
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1643
@RC01611 DS    0H                                                  1644
*       /*************************************************************/
*       /*                                                           */
*       /* END OF OK TO CONTINUE                             @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1644
*     END;                          /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1644
@RC01602 DS    0H                                                  1645
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH RETURN CODE FROM ISSUEXCP                 @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1645
*   RETURN CODE(TESTRC);            /*                       @ZA11014
*                                                            @ZA11014*/
@RF01590 LH    @15,TESTRC                                          1645
         L     @14,@SA00024                                        1645
         LM    @00,@12,@SA00024+8                                  1645
         BR    @14                                                 1645
*   END READKD;                     /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1647
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - SETCCW                                 @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - BUILTS THE FOLLOWING CCW LIST TO READ IN ALL @ZA11014*/
*/*              THE COUNT FIELDS ON A TRACK                 @ZA11014*/
*/*                                                          @ZA11014*/
*/*                 SET SECTOR ZERO                          @ZA11014*/
*/*                 READ R0                                  @ZA11014*/
*/*                 TIC *+8                                  @ZA11014*/
*/*                 READ COUNT                               @ZA11014*/
*/*                     ^                                    @ZA11014*/
*/*                     ^                                    @ZA11014*/
*/*                 READ COUNT                               @ZA11014*/
*/*                                                          @ZA11014*/
*/*              IT BUILDS A CCW LIST OF 122 READ COUNTS TO  @ZA20248*/
*/*              ENSURE ALL POSSIBLE RECORDS WILL BE READ    @ZA11014*/
*/*             RETURNS                                      @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - CCW LIST IN IOXCCWS                            @ZA11014*/
*/*           RETURN CODE OF ZERO IN REGISTER 15             @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1647
*                                   /*                       @ZA11014*/
*SETCCW:                                                           1647
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1647
SETCCW   STM   @14,@12,12(@13)                                     1647
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1648
*   OLDERID2=NEWERID2;                                             1648
         L     @03,@PC00001                                        1648
         L     @03,GDTTR2(,@03)                                    1648
         L     @15,@PC00001                                        1648
         L     @01,GDTTR2(,@15)                                    1648
         MVC   @TS00001(95),NEWERID2(@01)                          1648
         MVC   OLDERID2(95,@03),@TS00001                           1648
*   NEWID2='IOCW';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1649
         L     @03,@PC00001                                        1649
         L     @03,GDTTR2(,@03)                                    1649
         MVC   NEWID2(4,@03),@CC04361                              1649
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT INDEX INTO CCW LIST TO START AT BEG OF CHN       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1650
*   CCWCNT=1;                       /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1650
         MVC   CCWCNT(2),@CH00222                                  1650
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FIRST CCW TO 'SET SECTOR ZERO'                    @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1651
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1651
         SLA   @03,3                                               1651
         L     @01,IOCTLBKP                                        1651
         LA    @03,IOXCCW-8(@03,@01)                               1651
         MVC   CCW(8,@03),CCWRSSEC                                 1651
*   CCWADDR=ADDR(ZERO);             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1652
         LH    @03,CCWCNT                                          1652
         SLA   @03,3                                               1652
         L     @01,IOCTLBKP                                        1652
         LA    @03,IOXCCW-8(@03,@01)                               1652
         LA    @15,ZERO                                            1652
         STCM  @15,7,CCWADDR(@03)                                  1652
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT ADDR OF WHERE TO READ COUNTS INTO                @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1653
*   RCNTPTR=ADDR(RBUFF);            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1653
         L     @03,RRIOARPT                                        1653
         LA    @03,RBUFF(,@03)                                     1653
         STCM  @03,7,RCNTPTR                                       1653
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT CCW INDEX POINTER                           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1654
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1654
         LH    @03,CCWCNT                                          1654
         LA    @03,1(,@03)                                         1654
         STH   @03,CCWCNT                                          1654
*   /*****************************************************************/
*   /*                                                               */
*   /* SET READ R0 CCW                                       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1655
*   CCW=CCWRRR0;                    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1655
         LH    @03,CCWCNT                                          1655
         SLA   @03,3                                               1655
         L     @01,IOCTLBKP                                        1655
         LA    @03,IOXCCW-8(@03,@01)                               1655
         MVC   CCW(8,@03),CCWRRR0                                  1655
*   /*****************************************************************/
*   /*                                                               */
*   /* READ INTO BUFFER                                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1656
*   CCWADDR=RCNTPTR;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1656
         LH    @03,CCWCNT                                          1656
         SLA   @03,3                                               1656
         L     @01,IOCTLBKP                                        1656
         LA    @03,IOXCCW-8(@03,@01)                               1656
         MVC   CCWADDR(3,@03),RCNTPTR                              1656
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT PAST R0 COUNT AND DATA IN BUFFER            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1657
*   RCNTPTR=RCNTPTR+LENR0;          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1657
         L     @03,RCNTPTR-1                                       1657
         LA    @03,0(,@03)                                         1657
         AH    @03,LENR0                                           1657
         STCM  @03,7,RCNTPTR                                       1657
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT CCW INDEX POINTER                           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1658
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1658
         LH    @03,CCWCNT                                          1658
         LA    @03,1(,@03)                                         1658
         STH   @03,CCWCNT                                          1658
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO TIC TO *+8 IN CASE HAVE TO OVERLAY LATE@ZA11014     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1659
*   CCW=CCWTIC;                     /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1659
         SLA   @03,3                                               1659
         L     @01,IOCTLBKP                                        1659
         LA    @03,IOXCCW-8(@03,@01)                               1659
         MVC   CCW(8,@03),CCWTIC                                   1659
*   CCWADDR=ADDR(IOXCCW(CCWCNT+1)); /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1660
         LH    @03,CCWCNT                                          1660
         SLA   @03,3                                               1660
         L     @01,IOCTLBKP                                        1660
         LA    @03,IOXCCW-8(@03,@01)                               1660
         LH    @15,CCWCNT                                          1660
         SLA   @15,3                                               1660
         L     @01,IOCTLBKP                                        1660
         LA    @15,IOXCCW(@15,@01)                                 1660
         STCM  @15,7,CCWADDR(@03)                                  1660
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT CCW INDEX POINTER                           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1661
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1661
         LH    @03,CCWCNT                                          1661
         LA    @03,1(,@03)                                         1661
         STH   @03,CCWCNT                                          1661
*   /*****************************************************************/
*   /*                                                               */
*   /* SET REST OF CCWS TO READ COUNT CCWS                   @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1662
*   DO CCWCNT=CCWCNT TO(MAXRECS+NONRDCT);/*                  @ZA11014
*                                                            @ZA11014*/
*                                                                  1662
         LH    @03,CCWCNT                                          1662
         B     @DE01662                                            1662
@DL01662 DS    0H                                                  1663
*     /***************************************************************/
*     /*                                                             */
*     /* SET CCW TO READ COUNT - INTO BUFFER                 @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1663
*     CCW=CCWRRCNT;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1663
         SLA   @03,3                                               1663
         L     @01,IOCTLBKP                                        1663
         LA    @03,IOXCCW-8(@03,@01)                               1663
         MVC   CCW(8,@03),CCWRRCNT                                 1663
*     CCWADDR=RCNTPTR;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1664
         LH    @03,CCWCNT                                          1664
         SLA   @03,3                                               1664
         L     @01,IOCTLBKP                                        1664
         LA    @03,IOXCCW-8(@03,@01)                               1664
         MVC   CCWADDR(3,@03),RCNTPTR                              1664
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT POINTER IN BUFFER                         @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1665
*     RCNTPTR=RCNTPTR+LENCNT;       /*                       @ZA11014*/
         L     @03,RCNTPTR-1                                       1665
         LA    @03,0(,@03)                                         1665
         AH    @03,LENCNT                                          1665
         STCM  @03,7,RCNTPTR                                       1665
*   END;                            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1666
         LA    @03,1                                               1666
         AH    @03,CCWCNT                                          1666
         STH   @03,CCWCNT                                          1666
@DE01662 LH    @15,MAXRECS                                         1666
         AH    @15,NONRDCT                                         1666
         CR    @03,@15                                             1666
         BNH   @DL01662                                            1666
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INDEX TO LAST READ COUNT                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1667
*   CCWCNT=CCWCNT-1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1667
         LH    @03,CCWCNT                                          1667
         BCTR  @03,0                                               1667
         STH   @03,CCWCNT                                          1667
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN OFF COMMAND CHAINING BIT                         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1668
*   CCWCMDCH=OFF;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1668
         LH    @03,CCWCNT                                          1668
         SLA   @03,3                                               1668
         L     @01,IOCTLBKP                                        1668
         LA    @03,IOXCCW-8(@03,@01)                               1668
         NI    CCWCMDCH(@03),B'10111111'                           1668
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RETURN CODE OK                                    @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1669
*   TESTRC=0;                       /*                       @ZA11014*/
         SLR   @03,@03                                             1669
         STH   @03,TESTRC                                          1669
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/
         LH    @15,TESTRC                                          1670
         L     @14,12(,@13)                                        1670
         LM    @00,@12,20(@13)                                     1670
         BR    @14                                                 1670
*   END SETCCW;                     /*                       @ZA11014*/
*                                                                  1672
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - SPACCR                                 @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - TO BYPASS A CCW IN THE READ COUNT CHAIN      @ZA11014*/
*/*              WHOSE COUNT FIELD IS BAD                    @ZA11014*/
*/*             FOR A RECORD ZERO REQUEST THE READ RECORD    @ZA11014*/
*/*              ZERO CCW WILL BE REPLACED WITH A SEARCH     @ZA11014*/
*/*              ID EQUAL ON RECORD ZERO                     @ZA11014*/
*/*             FOR A NON-RECORD ZERO REQUEST, THE READ COUNT@ZA11014*/
*/*              CCW WILL BE REPLACED BY A SPACE COUNT CCW   @ZA11014*/
*/*             RETURNS                                      @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - CCW LIST IN IOXCCWS                             @ZA11014*/
*/*          EXCCWCNT FROM EXWRARG                           @ZA11014*/
*/*          EXRWKDLN FROM EXWRARG                           @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - MODIFIED CCW CHAIN                             @ZA11014*/
*/*           RETURN CODE OF ZERO IN REGISTER 15             @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1672
*                                   /*                       @ZA11014*/
*SPACCR:                                                           1672
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1672
SPACCR   STM   @14,@12,12(@13)                                     1672
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1673
*   OLDERID2=NEWERID2;                                             1673
         L     @03,@PC00001                                        1673
         L     @03,GDTTR2(,@03)                                    1673
         L     @15,@PC00001                                        1673
         L     @01,GDTTR2(,@15)                                    1673
         MVC   @TS00001(95),NEWERID2(@01)                          1673
         MVC   OLDERID2(95,@03),@TS00001                           1673
*   NEWID2='IOSP';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1674
         L     @03,@PC00001                                        1674
         L     @03,GDTTR2(,@03)                                    1674
         MVC   NEWID2(4,@03),@CC04365                              1674
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP IOX CONTROL BLOCK POINTER AND RIOAREA PTR      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1675
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1675
         L     @03,EXRWCTBL(,@03)                                  1675
         ST    @03,IOCTLBKP                                        1675
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1676
         L     @03,@PC00001+8                                      1676
         L     @03,EXRWIOAR(,@03)                                  1676
         ST    @03,RRIOARPT                                        1676
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO R0 COUNT FIELD            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1677
*   RESPECIFY                                                      1677
*     RBUF BASED(ADDR(RBUFF));      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1677
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF REQUEST IS FOR RECORD ZERO            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1678
*   IF EXCCWCNT=ZERO                /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1678
         L     @03,@PC00001+8                                      1678
         CLC   EXCCWCNT(2,@03),ZERO                                1678
         BNE   @RF01678                                            1678
*     /***************************************************************/
*     /*                                                             */
*     /* R0 REQUEST-OVERLAY READ CCW WITH SEARCH ID EQ       @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1679
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1679
*       /*************************************************************/
*       /*                                                           */
*       /* SET CCW INDEX TO READ R0 CCW                      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1680
*       CCWCNT=R0CHNLOC;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1680
         LH    @03,R0CHNLOC                                        1680
         STH   @03,CCWCNT                                          1680
*       /*************************************************************/
*       /*                                                           */
*       /* OVERLAY READ CCW WITH SEARCH ID EQ                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1681
*       CCW=CCWSIDEQ;               /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1681
         LH    @03,CCWCNT                                          1681
         SLA   @03,3                                               1681
         L     @01,IOCTLBKP                                        1681
         LA    @03,IOXCCW-8(@03,@01)                               1681
         MVC   CCW(8,@03),CCWSIDEQ                                 1681
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH ADDR TO R0 COUNT FIELD                 @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1682
*       CCWADDR=ADDR(RBCCHHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1682
         LH    @03,CCWCNT                                          1682
         SLA   @03,3                                               1682
         L     @01,IOCTLBKP                                        1682
         LA    @03,IOXCCW-8(@03,@01)                               1682
         LA    @15,282                                             1682
         AL    @15,RRIOARPT                                        1682
         STCM  @15,7,CCWADDR(@03)                                  1682
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT TO TIC CCW                              @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1683
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1683
         LH    @03,CCWCNT                                          1683
         LA    @03,1(,@03)                                         1683
         STH   @03,CCWCNT                                          1683
*       /*************************************************************/
*       /*                                                           */
*       /* ENSURE TIC-SET TO TIC TO SID ON R0                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1684
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1684
         SLA   @03,3                                               1684
         L     @01,IOCTLBKP                                        1684
         LA    @03,IOXCCW-8(@03,@01)                               1684
         MVC   CCW(8,@03),CCWTIC                                   1684
*       CCWADDR=ADDR(IOXCCW(R0CHNLOC));/*                    @ZA11014*/
         LH    @03,CCWCNT                                          1685
         SLA   @03,3                                               1685
         L     @01,IOCTLBKP                                        1685
         LA    @03,IOXCCW-8(@03,@01)                               1685
         LH    @15,R0CHNLOC                                        1685
         SLA   @15,3                                               1685
         L     @01,IOCTLBKP                                        1685
         LA    @15,IOXCCW-8(@15,@01)                               1685
         STCM  @15,7,CCWADDR(@03)                                  1685
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1686
*   /*****************************************************************/
*   /*                                                               */
*   /* NON-R0 REQUEST                                        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1687
*   ELSE                            /*                       @ZA11014*/
*                                                                  1687
*     /***************************************************************/
*     /*                                                             */
*     /* CALC WHICH CCW IN CHAIN TO BYPASS                   @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1687
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1687
         B     @RC01678                                            1687
@RF01678 DS    0H                                                  1688
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE INDEX INTO CCW CHAIN TO REQ REC NUM@ZA11014    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1688
*       CCWNDX=EXCCWCNT;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1688
         L     @03,@PC00001+8                                      1688
         LH    @03,EXCCWCNT(,@03)                                  1688
         STH   @03,CCWNDX                                          1688
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK ALL LOCTAB ENTRIES SO FAR TO SEE            @ZA11014*/
*       /* IF ANY RECORD NUMBERS ARE MISSING                 @ZA11014*/
*       /* IF SO, ADJUST INDEX INTO CCWLIST                  @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1689
*       DO RCTR=2 TO EXCCWCNT;      /*                       @ZA11014*/
         LA    @03,2                                               1689
         B     @DE01689                                            1689
@DL01689 DS    0H                                                  1690
*         IF LOCADDR(RCTR)=NTFNDPTR /*                       @ZA11014*/
*           THEN                    /*                       @ZA11014*/
*                                                                  1690
         LH    @03,RCTR                                            1690
         MH    @03,@CH00279                                        1690
         L     @15,@PC00001+8                                      1690
         L     @01,EXLOCPTR(,@15)                                  1690
         AL    @01,@CF04425                                        1690
         L     @03,LOCADDR(@03,@01)                                1690
         ICM   @15,15,NTFNDPTR                                     1690
         CLR   @03,@15                                             1690
         BNE   @RF01690                                            1690
*           /*********************************************************/
*           /*                                                       */
*           /* THIS RECORD FOUND-NOT IN CHAIN                @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1691
*           CCWNDX=CCWNDX-1;        /*                       @ZA11014*/
         LH    @03,CCWNDX                                          1691
         BCTR  @03,0                                               1691
         STH   @03,CCWNDX                                          1691
*         ELSE                                                     1692
*           ;                       /*                       @ZA11014*/
@RF01690 DS    0H                                                  1693
*       END;                        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1693
         LA    @03,1                                               1693
         AH    @03,RCTR                                            1693
@DE01689 STH   @03,RCTR                                            1693
         L     @15,@PC00001+8                                      1693
         CH    @03,EXCCWCNT(,@15)                                  1693
         BNH   @DL01689                                            1693
*       /*************************************************************/
*       /*                                                           */
*       /* SET CCW INDEX TO PROPER ENTRY                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1694
*       CCWCNT=CCWNDX+NONRDCT;      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1694
         LH    @03,CCWNDX                                          1694
         AH    @03,NONRDCT                                         1694
         STH   @03,CCWCNT                                          1694
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHICH LEN ENTRY TO USE AND REPLACE      @ZA11014*/
*       /* CCW IN STRING WITH SPACE COUNT FOR THAT LENGTH    @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1695
*       IF EXRWKDLN=NULLPTR         /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1695
         L     @03,@PC00001+8                                      1695
         L     @03,EXRWKDLN(,@03)                                  1695
         LTR   @03,@03                                             1695
         BNZ   @RF01695                                            1695
*         /***********************************************************/
*         /*                                                         */
*         /* LEN NOT SUPPLIED-LEN IN COUNT FIELD GOOD        @ZA11014*/
*         /* SAVE IT IN LOCTAB AND REPLACE CCW               @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1696
*         DO;                       /*                       @ZA11014*/
*           LOCKLEN(EXCCWCNT+1)=CCWADDR->RBKL;/*             @ZA11014*/
         L     @03,@PC00001+8                                      1697
         LH    @03,EXCCWCNT(,@03)                                  1697
         MH    @03,@CH00279                                        1697
         L     @15,@PC00001+8                                      1697
         L     @01,EXLOCPTR(,@15)                                  1697
         LH    @15,CCWCNT                                          1697
         SLA   @15,3                                               1697
         L     @14,IOCTLBKP                                        1697
         LA    @15,IOXCCW-8(@15,@14)                               1697
         L     @15,CCWADDR-1(,@15)                                 1697
         SLR   @14,@14                                             1697
         IC    @14,RBKL(,@15)                                      1697
         STC   @14,LOCKLEN(@03,@01)                                1697
*           LOCDLEN(EXCCWCNT+1)=CCWADDR->RBDL;/*             @ZA11014
*                                                            @ZA11014*/
*                                                                  1698
         L     @03,@PC00001+8                                      1698
         LH    @03,EXCCWCNT(,@03)                                  1698
         MH    @03,@CH00279                                        1698
         L     @15,@PC00001+8                                      1698
         L     @01,EXLOCPTR(,@15)                                  1698
         LH    @15,CCWCNT                                          1698
         SLA   @15,3                                               1698
         L     @14,IOCTLBKP                                        1698
         LA    @15,IOXCCW-8(@15,@14)                               1698
         L     @15,CCWADDR-1(,@15)                                 1698
         LH    @00,RBDL(,@15)                                      1698
         STH   @00,LOCDLEN(@03,@01)                                1698
*           /*********************************************************/
*           /*                                                       */
*           /* SET SPACE COUNT CCW                           @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1699
*           CCW=CCWRSPCT;           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1699
         LH    @03,CCWCNT                                          1699
         SLA   @03,3                                               1699
         L     @01,IOCTLBKP                                        1699
         LA    @03,IOXCCW-8(@03,@01)                               1699
         MVC   CCW(8,@03),CCWRSPCT                                 1699
*           /*********************************************************/
*           /*                                                       */
*           /* SET LEN POINTER                               @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1700
*           CCWADDR=ADDR(LOCKLEN(EXCCWCNT+1));/*             @ZA11014*/
         LH    @03,CCWCNT                                          1700
         SLA   @03,3                                               1700
         L     @01,IOCTLBKP                                        1700
         LA    @03,IOXCCW-8(@03,@01)                               1700
         L     @15,@PC00001+8                                      1700
         LH    @15,EXCCWCNT(,@15)                                  1700
         MH    @15,@CH00279                                        1700
         L     @14,@PC00001+8                                      1700
         L     @01,EXLOCPTR(,@14)                                  1700
         LA    @15,LOCKLEN(@15,@01)                                1700
         STCM  @15,7,CCWADDR(@03)                                  1700
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*       ELSE                        /*                       @ZA11014*/
*                                                                  1702
*         /***********************************************************/
*         /*                                                         */
*         /* LEN POINTER SUPPLIED                            @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1702
*         DO;                       /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1702
         B     @RC01695                                            1702
@RF01695 DS    0H                                                  1703
*           /*********************************************************/
*           /*                                                       */
*           /* SET SPACE COUNT CCW                           @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1703
*           CCW=CCWRSPCT;           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1703
         LH    @03,CCWCNT                                          1703
         SLA   @03,3                                               1703
         L     @01,IOCTLBKP                                        1703
         LA    @03,IOXCCW-8(@03,@01)                               1703
         MVC   CCW(8,@03),CCWRSPCT                                 1703
*           /*********************************************************/
*           /*                                                       */
*           /* SET LEN                                       @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1704
*           CCWADDR=EXRWKDLN;       /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1704
         SLA   @03,3                                               1704
         L     @01,IOCTLBKP                                        1704
         LA    @03,IOXCCW-8(@03,@01)                               1704
         L     @15,@PC00001+8                                      1704
         MVC   CCWADDR(3,@03),EXRWKDLN+1(@15)                      1704
*         END;                      /*                       @ZA11014*/
*     END;                          /* NON-R0 REQUEST        @ZA11014
*                                                            @ZA11014*/
*                                                                  1706
@RC01695 DS    0H                                                  1707
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH RETURN CODE OK                            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1707
*   TESTRC=0;                       /*                       @ZA11014*/
@RC01678 SLR   @03,@03                                             1707
         STH   @03,TESTRC                                          1707
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/
         LH    @15,TESTRC                                          1708
         L     @14,12(,@13)                                        1708
         LM    @00,@12,20(@13)                                     1708
         BR    @14                                                 1708
*   END SPACCR;                     /*                       @ZA11014*/
*                                                                  1710
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - SETKDCCW                               @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - BUILDS THE FOLLOWING CCW STRING TO READ THE  @ZA11014*/
*/*              COUNT, KEY AND DATA (OR JUST KEY AND DATA   @ZA11014*/
*/*              IF THE COUNT FIELD WAS BAD) OF A SPECIFIED  @ZA11014*/
*/*              NUMBER OF RECORDS ON A TRACK                @ZA11014*/
*/*                                                          @ZA11014*/
*/*                SET SECTOR 0                              @ZA11014*/
*/*                SEARCH ID EQUAL (R0)                      @ZA11014*/
*/*                TIC *-8                                   @ZA11014*/
*/*                READ CKD  OR  SPACE COUNT                 @ZA11014*/
*/*                              READ KEY/DATA               @ZA11014*/
*/*                          ^                               @ZA11014*/
*/*                          ^                               @ZA11014*/
*/*                READ CKD  OR  SPACE COUNT                 @ZA11014*/
*/*                              READ KEY/DATA               @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*              IT WILL FILL IN THE LOCATION TABLE ENTRIES  @ZA11014*/
*/*               FOR EACH RECORD WITH THE ADDRESS OF WHERE  @ZA11014*/
*/*               THE RECORD WILL BE READ (COUNT FIELD LOC)  @ZA11014*/
*/*                                                          @ZA11014*/
*/*              RETURNS                                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/
*/*          EXLOCTAB FROM EXWRARG                           @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - CCW LIST IN IOXCCWS                            @ZA11014*/
*/*           UPDATED LOCATION TABLE ADDRESS ENTRIES         @ZA11014*/
*/*           RETURN CODE OF ZERO IN REGISTER 15             @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1710
*                                   /*                       @ZA11014*/
*SETKDCCW:                                                         1710
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1710
SETKDCCW STM   @14,@12,12(@13)                                     1710
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1711
*   OLDERID2=NEWERID2;                                             1711
         L     @03,@PC00001                                        1711
         L     @03,GDTTR2(,@03)                                    1711
         L     @15,@PC00001                                        1711
         L     @01,GDTTR2(,@15)                                    1711
         MVC   @TS00001(95),NEWERID2(@01)                          1711
         MVC   OLDERID2(95,@03),@TS00001                           1711
*   NEWID2='IOKS';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1712
         L     @03,@PC00001                                        1712
         L     @03,GDTTR2(,@03)                                    1712
         MVC   NEWID2(4,@03),@CC04371                              1712
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP POINTERS TO IOXCTLBK AND RIOAREA               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1713
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1713
         L     @03,EXRWCTBL(,@03)                                  1713
         ST    @03,IOCTLBKP                                        1713
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1714
         L     @03,@PC00001+8                                      1714
         L     @03,EXRWIOAR(,@03)                                  1714
         ST    @03,RRIOARPT                                        1714
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CCW STRING WILL INITIALLY BE BUILT IN             @ZA11014*/
*   /* THE CCW BUFFER AREA FOLLOWING THE READ COUNT          @ZA11014*/
*   /* CCW CHAIN BECAUSE READ COUNT CCW INFORMATION IS       @ZA11014*/
*   /* NEEDED IN BUILDING THE CCWS                           @ZA11014*/
*   /*                                                       @ZA11014*/
*   /* THE CHAIN WILL THEN BE MOVED TO THE BEGINNING         @ZA11014*/
*   /* OF THE CCW BUFFER                                     @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1715
*                                   /*                       @ZA11014*/
*                                                                  1715
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CCW INDEX POINTER TO                       @ZA11014*/
*   /* BEGIN BEYOND LAST READ COUNT CCW                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1715
*   CCWCNT=MAXRECS+NONRDCT+1;       /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1715
         LH    @03,MAXRECS                                         1715
         AH    @03,NONRDCT                                         1715
         LA    @03,1(,@03)                                         1715
         STH   @03,CCWCNT                                          1715
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE POINTER TO COUNT RECORDS IN BUFFER         @ZA11014*/
*   /* SET UP ADDRESSABILITY TO IT                           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1716
*   RCNTPTR=ADDR(RBUFF);            /*                       @ZA11014*/
         L     @03,RRIOARPT                                        1716
         LA    @03,RBUFF(,@03)                                     1716
         STCM  @03,7,RCNTPTR                                       1716
*   RFY                                                            1717
*     RBUF BASED(RCNTPTR);          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1717
*   /*****************************************************************/
*   /*                                                               */
*   /* SET LOCATION TABLE ADDR OF RECORD ZERO                @ZA11014*/
*   /* TO THE BEGINNING OF THE BUFFER                        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1718
*   LOCADDR(1)=RCNTPTR;             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1718
         L     @03,@PC00001+8                                      1718
         L     @03,EXLOCPTR(,@03)                                  1718
         L     @15,RCNTPTR-1                                       1718
         LA    @15,0(,@15)                                         1718
         ST    @15,LOCADDR(,@03)                                   1718
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE ADDR OF WHERE TO READ DATA INTO            @ZA11014*/
*   /* RECORD ZERO HAS ALREADY BEEN READ-BYPASS IT           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1719
*   RDKDADDR=ADDR(RBUFF)+LENR0;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1719
         L     @03,RRIOARPT                                        1719
         LA    @03,RBUFF(,@03)                                     1719
         AH    @03,LENR0                                           1719
         STCM  @03,7,RDKDADDR                                      1719
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INDEX TO RECORD ONE READ COUNT FIELD              @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1720
*   RDOPCNT=NONRDCT+1;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1720
         LH    @03,NONRDCT                                         1720
         LA    @03,1(,@03)                                         1720
         STH   @03,RDOPCNT                                         1720
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FIRST CCW IN CHAIN TO SET SECTOR ZERO             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1721
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1721
         SLA   @03,3                                               1721
         L     @01,IOCTLBKP                                        1721
         LA    @03,IOXCCW-8(@03,@01)                               1721
         MVC   CCW(8,@03),CCWRSSEC                                 1721
*   CCWADDR=ADDR(ZERO);             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1722
         LH    @03,CCWCNT                                          1722
         SLA   @03,3                                               1722
         L     @01,IOCTLBKP                                        1722
         LA    @03,IOXCCW-8(@03,@01)                               1722
         LA    @15,ZERO                                            1722
         STCM  @15,7,CCWADDR(@03)                                  1722
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT POINTER IN CCW CHAIN                        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1723
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1723
         LH    @03,CCWCNT                                          1723
         LA    @03,1(,@03)                                         1723
         STH   @03,CCWCNT                                          1723
*   /*****************************************************************/
*   /*                                                               */
*   /* SET NEXT CCW TO SEARCH ID EQUAL FOR RECORD ZERO       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1724
*   CCW=CCWSIDEQ;                   /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1724
         SLA   @03,3                                               1724
         L     @01,IOCTLBKP                                        1724
         LA    @03,IOXCCW-8(@03,@01)                               1724
         MVC   CCW(8,@03),CCWSIDEQ                                 1724
*   CCWADDR=ADDR(RBCCHHR);          /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1725
         LH    @03,CCWCNT                                          1725
         SLA   @03,3                                               1725
         L     @01,IOCTLBKP                                        1725
         LA    @03,IOXCCW-8(@03,@01)                               1725
         MVC   CCWADDR(3,@03),RCNTPTR                              1725
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT POINTER IN CCW CHAIN                        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1726
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1726
         LH    @03,CCWCNT                                          1726
         LA    @03,1(,@03)                                         1726
         STH   @03,CCWCNT                                          1726
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TIC TO ADDR IN BUFFER WHERE SID EQ FOR R0         @ZA11014*/
*   /* WILL EVENTUALLY BE                                    @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1727
*   CCW=CCWTIC;                     /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1727
         SLA   @03,3                                               1727
         L     @01,IOCTLBKP                                        1727
         LA    @03,IOXCCW-8(@03,@01)                               1727
         MVC   CCW(8,@03),CCWTIC                                   1727
*   CCWADDR=ADDR(IOXCCW(R0CHNLOC)); /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1728
         LH    @03,CCWCNT                                          1728
         SLA   @03,3                                               1728
         L     @01,IOCTLBKP                                        1728
         LA    @03,IOXCCW-8(@03,@01)                               1728
         LH    @15,R0CHNLOC                                        1728
         SLA   @15,3                                               1728
         L     @01,IOCTLBKP                                        1728
         LA    @15,IOXCCW-8(@15,@01)                               1728
         STCM  @15,7,CCWADDR(@03)                                  1728
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT POINTER IN CCW CHAIN                        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1729
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1729
         LH    @03,CCWCNT                                          1729
         LA    @03,1(,@03)                                         1729
         STH   @03,CCWCNT                                          1729
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT POINTER TO COUNTS PAST R0                   @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1730
*   RCNTPTR=RCNTPTR+LENR0;          /*                       @ZA11014
*                                                            @ZA11014*/
         L     @03,RCNTPTR-1                                       1730
         LA    @03,0(,@03)                                         1730
         AH    @03,LENR0                                           1730
         STCM  @03,7,RCNTPTR                                       1730
*                                                                  1731
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE REMAINDER OF THE CCW CHAIN AS EITHER        @ZA11014*/
*   /* READ COUNT, KEY DATA COMMANDS                         @ZA11014*/
*   /* OR SPACE COUNT CCWS FOLLOWED BY READ KEY/DATA         @ZA11014*/
*   /* COMMANDS DEPENDING UPON WHETHER THE ORIGINAL          @ZA11014*/
*   /* COUNT FIELD FOR A PARTICULAR RECORD WAS BYPASSED      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1731
*                                   /*                       @ZA11014*/
*   DO RCTR=1 TO RNUMREC;           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1731
         LA    @03,1                                               1731
         B     @DE01731                                            1731
@DL01731 DS    0H                                                  1732
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF RECORD NUMBER MISSING                      @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1732
*     IF LOCADDR(RCTR+1)^=NTFNDPTR  /*                       @ZA11014*/
*       THEN                        /*                       @ZA11014*/
*                                                                  1732
         LH    @03,RCTR                                            1732
         MH    @03,@CH00279                                        1732
         L     @15,@PC00001+8                                      1732
         L     @01,EXLOCPTR(,@15)                                  1732
         L     @03,LOCADDR(@03,@01)                                1732
         ICM   @15,15,NTFNDPTR                                     1732
         CLR   @03,@15                                             1732
         BE    @RF01732                                            1732
*       /*************************************************************/
*       /*                                                           */
*       /* THIS RECORD NUMBER IS ON THE TRACK                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1733
*       DO;                         /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1733
*         /***********************************************************/
*         /*                                                         */
*         /* SET TRACE ID                                    @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1734
*         OLDERID2=NEWERID2;                                       1734
         L     @03,@PC00001                                        1734
         L     @03,GDTTR2(,@03)                                    1734
         L     @15,@PC00001                                        1734
         L     @01,GDTTR2(,@15)                                    1734
         MVC   @TS00001(95),NEWERID2(@01)                          1734
         MVC   OLDERID2(95,@03),@TS00001                           1734
*         NEWID2='IOK3';            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1735
         L     @03,@PC00001                                        1735
         L     @03,GDTTR2(,@03)                                    1735
         MVC   NEWID2(4,@03),@CC04373                              1735
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF OP CODE OF COUNT CHAIN A SPACE CNT     @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1736
*         IF ADDR(IOXCCW(RDOPCNT))->CCWOP^=SPCNTOP/*         @ZA11014*/
*           THEN                    /*                       @ZA11014*/
*                                                                  1736
         LH    @03,RDOPCNT                                         1736
         SLA   @03,3                                               1736
         L     @01,IOCTLBKP                                        1736
         LA    @03,IOXCCW-8(@03,@01)                               1736
         CLC   CCWOP(1,@03),SPCNTOP                                1736
         BE    @RF01736                                            1736
*           /*********************************************************/
*           /*                                                       */
*           /* OP CODE MUST BE READ COUNT                    @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1737
*           DO;                     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1737
*             /*******************************************************/
*             /*                                                     */
*             /* SET CCW TO READ COUNT                       @0Z11014*/
*             /* DATA TRANSFER OK/COMMAND CHAINING ON        @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1738
*             CCW=CCWRRCNT;         /*                       @0Z11014*/
         LH    @03,CCWCNT                                          1738
         SLA   @03,3                                               1738
         L     @01,IOCTLBKP                                        1738
         LA    @03,IOXCCW-8(@03,@01)                               1738
         MVC   CCW(8,@03),CCWRRCNT                                 1738
*             CCWSUPP=OFF;          /*                       @ZA11014*/
*             CCWCMDCH=ON;          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1740
         LH    @03,CCWCNT                                          1740
         SLA   @03,3                                               1740
         L     @01,IOCTLBKP                                        1740
         LA    @03,IOXCCW-8(@03,@01)                               1740
         OI    CCWCMDCH(@03),B'01000000'                           1740
         NI    CCWSUPP(@03),B'11101111'                            1740
*             /*******************************************************/
*             /*                                                     */
*             /* SET CCW ADDR TO BEGINNING OF COUNT          @0Z11014*/
*             /* SET ADDR IN LOCATION TABLE                  @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1741
*             CCWADDR=RDKDADDR;     /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1741
         SLA   @03,3                                               1741
         L     @01,IOCTLBKP                                        1741
         LA    @03,IOXCCW-8(@03,@01)                               1741
         MVC   CCWADDR(3,@03),RDKDADDR                             1741
*             LOCADDR(RCTR+1)=RDKDADDR;/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1742
         LH    @03,RCTR                                            1742
         MH    @03,@CH00279                                        1742
         L     @15,@PC00001+8                                      1742
         L     @01,EXLOCPTR(,@15)                                  1742
         L     @00,RDKDADDR-1                                      1742
         ICM   @00,8,@CB03783                                      1742
         ST    @00,LOCADDR(@03,@01)                                1742
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT TO NEXT CCW                       @0Z11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1743
*             CCWCNT=CCWCNT+1;      /*                       @0Z11014
*                                                            @0Z11014*/
*                                                                  1743
         LH    @03,CCWCNT                                          1743
         LA    @03,1(,@03)                                         1743
         STH   @03,CCWCNT                                          1743
*             /*******************************************************/
*             /*                                                     */
*             /* SET CCW TO READ KEY AND DATA                @0Z11014*/
*             /* DATA TRANSFER OK/COMMAND CHAINING ON        @0Z11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1744
*             CCW=CCWRRKD;          /*                       @0Z11014*/
         LH    @03,CCWCNT                                          1744
         SLA   @03,3                                               1744
         L     @01,IOCTLBKP                                        1744
         LA    @03,IOXCCW-8(@03,@01)                               1744
         MVC   CCW(8,@03),CCWRRKD                                  1744
*             CCWSUPP=OFF;          /*                       @0Z11014*/
*             CCWCMDCH=ON;          /*                       @0Z11014
*                                                            @0Z11014*/
*                                                                  1746
         LH    @03,CCWCNT                                          1746
         SLA   @03,3                                               1746
         L     @01,IOCTLBKP                                        1746
         LA    @03,IOXCCW-8(@03,@01)                               1746
         OI    CCWCMDCH(@03),B'01000000'                           1746
         NI    CCWSUPP(@03),B'11101111'                            1746
*             /*******************************************************/
*             /*                                                     */
*             /* CCWADDR IS ADDRESS OF KEY/DATA FIELDS       @0Z11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1747
*             CCWADDR=RDKDADDR+LENCNT;/*                     @0Z11014
*                                                            @0Z11014*/
*                                                                  1747
         LH    @03,CCWCNT                                          1747
         SLA   @03,3                                               1747
         L     @01,IOCTLBKP                                        1747
         LA    @03,IOXCCW-8(@03,@01)                               1747
         L     @15,RDKDADDR-1                                      1747
         LA    @15,0(,@15)                                         1747
         AH    @15,LENCNT                                          1747
         STCM  @15,7,CCWADDR(@03)                                  1747
*             /*******************************************************/
*             /*                                                     */
*             /* CALCULATE DATA LEN FROM PREVIOUSLY READ     @ZA11014*/
*             /* COUNT FIELD                                 @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1748
*             CCWDATLN=RBKL+RBDL;   /*                       @0Z11014
*                                                            @ZA11014*/
*                                                                  1748
         LH    @03,CCWCNT                                          1748
         SLA   @03,3                                               1748
         L     @01,IOCTLBKP                                        1748
         LA    @03,IOXCCW-8(@03,@01)                               1748
         L     @01,RCNTPTR-1                                       1748
         L     @15,RCNTPTR-1                                       1748
         SLR   @00,@00                                             1748
         IC    @00,RBKL(,@01)                                      1748
         AH    @00,RBDL(,@15)                                      1748
         STH   @00,CCWDATLN(,@03)                                  1748
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT INDEX INTO READ COUNT CCW CHAI@ZA11014    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1749
*             RDOPCNT=RDOPCNT+1;    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1749
         LH    @03,RDOPCNT                                         1749
         LA    @03,1(,@03)                                         1749
         STH   @03,RDOPCNT                                         1749
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT POINTER TO COUNT FIELDS IN BUF@ZA11014    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1750
*             RCNTPTR=RCNTPTR+LENCNT;/*                      @ZA11014
*                                                            @ZA11014*/
*                                                                  1750
         L     @03,RCNTPTR-1                                       1750
         LA    @03,0(,@03)                                         1750
         AH    @03,LENCNT                                          1750
         STCM  @03,7,RCNTPTR                                       1750
*             /*******************************************************/
*             /*                                                     */
*             /* CALC NEXT AVAIL LOC IN BUFFER FOR READIN@ZA11014    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1751
*             RDKDADDR=RDKDADDR+CCWDATLN+LENCNT;/*           @0Z11014
*                                                            @ZA11014*/
*                                                                  1751
         LH    @03,CCWCNT                                          1751
         SLA   @03,3                                               1751
         L     @01,IOCTLBKP                                        1751
         LA    @03,IOXCCW-8(@03,@01)                               1751
         L     @15,RDKDADDR-1                                      1751
         LA    @15,0(,@15)                                         1751
         AH    @15,CCWDATLN(,@03)                                  1751
         AH    @15,LENCNT                                          1751
         STCM  @15,7,RDKDADDR                                      1751
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF THIS RECORD IS AN END OF FILE      @ZA11014*/
*             /* RECORD-IF IT IS CHANGE THE READ K/D         @ZA11014*/
*             /* TO A TIC TO BYPASS READING THE ZERO         @ZA11014*/
*             /* LENGTH RECORD                               @ZA11014*/
*             /* SET THE RETURN CODE IN THE LOCATION         @ZA11014*/
*             /* TABLE FOR THIS RECORD TO EOF                @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1752
*             IF CCWDATLN=0         /*                       @ZA11014*/
*               THEN                /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1752
         SLA   @03,3                                               1752
         L     @01,IOCTLBKP                                        1752
         LA    @03,IOXCCW-8(@03,@01)                               1752
         LH    @03,CCWDATLN(,@03)                                  1752
         LTR   @03,@03                                             1752
         BNZ   @RF01752                                            1752
*               DO;                 /*                       @ZA11014*/
*                 CCW=CCWTIC;       /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1754
         SLA   @03,3                                               1754
         L     @01,IOCTLBKP                                        1754
         LA    @03,IOXCCW-8(@03,@01)                               1754
         MVC   CCW(8,@03),CCWTIC                                   1754
*                 CCWADDR=ADDR(IOXCCW(CCWCNT+1));/*          @ZA11014*/
         LH    @03,CCWCNT                                          1755
         SLA   @03,3                                               1755
         L     @01,IOCTLBKP                                        1755
         LA    @03,IOXCCW-8(@03,@01)                               1755
         LH    @15,CCWCNT                                          1755
         SLA   @15,3                                               1755
         L     @01,IOCTLBKP                                        1755
         LA    @15,IOXCCW(@15,@01)                                 1755
         STCM  @15,7,CCWADDR(@03)                                  1755
*                 LOCRCKD(RCTR+1)=RCABEOFR;/*                @ZA11014
*                                                            @ZA11014*/
*                                                                  1756
         LH    @03,RCTR                                            1756
         MH    @03,@CH00279                                        1756
         L     @15,@PC00001+8                                      1756
         L     @01,EXLOCPTR(,@15)                                  1756
         LH    @00,RCABEOFR                                        1756
         STH   @00,LOCRCKD(@03,@01)                                1756
*                 /***************************************************/
*                 /*                                                 */
*                 /* INCREMENT READ IN BUFFER POINTER        @ZA11014*/
*                 /* TO LEAVE ROOM FOR THE EOF MESSAGE       @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1757
*                 RDKDADDR=RDKDADDR+9;/*                     @ZA11014
*                                                            @ZA11014*/
         L     @03,RDKDADDR-1                                      1757
         LA    @03,9(,@03)                                         1757
         STCM  @03,7,RDKDADDR                                      1757
*               END;                /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1758
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT PTR TO READ CKD CCW CHAIN         @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1759
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014*/
@RF01752 LH    @03,CCWCNT                                          1759
         LA    @03,1(,@03)                                         1759
         STH   @03,CCWCNT                                          1759
*           END;                    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1760
*         /***********************************************************/
*         /*                                                         */
*         /* SPACE COUNT CCW IN COUNT BUFFER                 @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1761
*         ELSE                      /*                       @ZA11014*/
*                                                                  1761
*           /*********************************************************/
*           /*                                                       */
*           /* COPY SPACE COUNT AND DO READ KEY/DATA         @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1761
*           DO;                     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1761
         B     @RC01736                                            1761
@RF01736 DS    0H                                                  1762
*             /*******************************************************/
*             /*                                                     */
*             /* SET TRACE ID                                @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1762
*             OLDERID2=NEWERID2;                                   1762
         L     @03,@PC00001                                        1762
         L     @03,GDTTR2(,@03)                                    1762
         L     @15,@PC00001                                        1762
         L     @01,GDTTR2(,@15)                                    1762
         MVC   @TS00001(95),NEWERID2(@01)                          1762
         MVC   OLDERID2(95,@03),@TS00001                           1762
*             NEWID2='IOK4';        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1763
         L     @03,@PC00001                                        1763
         L     @03,GDTTR2(,@03)                                    1763
         MVC   NEWID2(4,@03),@CC04374                              1763
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE SPACE COUNT CCW TO NEW CHAIN           @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1764
*             CCW=ADDR(IOXCCW(RDOPCNT))->CCW;/*              @ZA11014
*                                                            @ZA11014*/
*                                                                  1764
         LH    @03,CCWCNT                                          1764
         SLA   @03,3                                               1764
         L     @01,IOCTLBKP                                        1764
         LA    @03,IOXCCW-8(@03,@01)                               1764
         LH    @15,RDOPCNT                                         1764
         SLA   @15,3                                               1764
         L     @01,IOCTLBKP                                        1764
         LA    @15,IOXCCW-8(@15,@01)                               1764
         MVC   CCW(8,@03),CCW(@15)                                 1764
*             /*******************************************************/
*             /*                                                     */
*             /* SAVE BAD COUNT FIELD TO MOVE IN BUFFER      @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1765
*             LOCCNTFD(RCTR+1)=RBUFCNT;/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1765
         LH    @03,RCTR                                            1765
         MH    @03,@CH00279                                        1765
         L     @15,@PC00001+8                                      1765
         L     @01,EXLOCPTR(,@15)                                  1765
         ALR   @01,@03                                             1765
         L     @03,RCNTPTR-1                                       1765
         MVC   LOCCNTFD(8,@01),RBUFCNT(@03)                        1765
*             /*******************************************************/
*             /*                                                     */
*             /* SET ADDR IN LOCTAB TO BEG OF COUNT FLD      @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1766
*             LOCADDR(RCTR+1)=RDKDADDR;/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1766
         LH    @03,RCTR                                            1766
         MH    @03,@CH00279                                        1766
         L     @15,@PC00001+8                                      1766
         L     @01,EXLOCPTR(,@15)                                  1766
         L     @00,RDKDADDR-1                                      1766
         ICM   @00,8,@CB03783                                      1766
         ST    @00,LOCADDR(@03,@01)                                1766
*             /*******************************************************/
*             /*                                                     */
*             /* SET ADDR FOR KEY/DATA READ                  @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1767
*             RDKDADDR=RDKDADDR+LENCNT;/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1767
         L     @03,RDKDADDR-1                                      1767
         LA    @03,0(,@03)                                         1767
         AH    @03,LENCNT                                          1767
         STCM  @03,7,RDKDADDR                                      1767
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT POINTER IN CCW CHAIN              @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1768
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1768
         LH    @03,CCWCNT                                          1768
         LA    @03,1(,@03)                                         1768
         STH   @03,CCWCNT                                          1768
*             /*******************************************************/
*             /*                                                     */
*             /* SET CCW TO READ KEY/DATA                    @ZA11014*/
*             /* TRANSFER DATA/COMMAND CHAIN ON              @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1769
*             CCW=CCWRRKD;          /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1769
         SLA   @03,3                                               1769
         L     @01,IOCTLBKP                                        1769
         LA    @03,IOXCCW-8(@03,@01)                               1769
         MVC   CCW(8,@03),CCWRRKD                                  1769
*             CCWSUPP=OFF;          /*                       @ZA11014*/
*             CCWCMDCH=ON;          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1771
         LH    @03,CCWCNT                                          1771
         SLA   @03,3                                               1771
         L     @01,IOCTLBKP                                        1771
         LA    @03,IOXCCW-8(@03,@01)                               1771
         OI    CCWCMDCH(@03),B'01000000'                           1771
         NI    CCWSUPP(@03),B'11101111'                            1771
*             /*******************************************************/
*             /*                                                     */
*             /* SET CCW ADDR TO READ INTO BUFFER            @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1772
*             CCWADDR=RDKDADDR;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1772
         LH    @03,CCWCNT                                          1772
         SLA   @03,3                                               1772
         L     @01,IOCTLBKP                                        1772
         LA    @03,IOXCCW-8(@03,@01)                               1772
         MVC   CCWADDR(3,@03),RDKDADDR                             1772
*             /*******************************************************/
*             /*                                                     */
*             /* CALC LEN TO READ FROM LEN POINTER           @ZA11014*/
*             /* IN SPACE COUNT CCW                          @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1773
*             CCWDATLN=ADDR(IOXCCW(CCWCNT-1))/*              @ZA11014*/
*                 ->CCWADDR->FLDKEYLN+/*                     @ZA11014*/
*                 ADDR(IOXCCW(CCWCNT-1))/*                   @ZA11014*/
*                 ->CCWADDR->FLDDATLN;/*                     @ZA11014
*                                                            @ZA11014*/
*                                                                  1773
         LH    @03,CCWCNT                                          1773
         SLA   @03,3                                               1773
         L     @01,IOCTLBKP                                        1773
         LA    @03,IOXCCW-8(@03,@01)                               1773
         LH    @15,CCWCNT                                          1773
         SLA   @15,3                                               1773
         L     @01,IOCTLBKP                                        1773
         LA    @15,IOXCCW-16(@15,@01)                              1773
         L     @01,CCWADDR-1(,@15)                                 1773
         LH    @15,CCWCNT                                          1773
         SLA   @15,3                                               1773
         L     @14,IOCTLBKP                                        1773
         LA    @15,IOXCCW-16(@15,@14)                              1773
         L     @15,CCWADDR-1(,@15)                                 1773
         SLR   @00,@00                                             1773
         IC    @00,FLDKEYLN(,@01)                                  1773
         SLR   @14,@14                                             1773
         ICM   @14,3,FLDDATLN(@15)                                 1773
         ALR   @00,@14                                             1773
         STH   @00,CCWDATLN(,@03)                                  1773
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT INDEX INTO READ COUNT CCW CHAI@ZA11014    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1774
*             RDOPCNT=RDOPCNT+1;    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1774
         LH    @03,RDOPCNT                                         1774
         LA    @03,1(,@03)                                         1774
         STH   @03,RDOPCNT                                         1774
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT POINTER TO COUNT FIELDS IN BUF@ZA11014    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1775
*             RCNTPTR=RCNTPTR+LENCNT;/*                      @ZA11014
*                                                            @ZA11014*/
*                                                                  1775
         L     @03,RCNTPTR-1                                       1775
         LA    @03,0(,@03)                                         1775
         AH    @03,LENCNT                                          1775
         STCM  @03,7,RCNTPTR                                       1775
*             /*******************************************************/
*             /*                                                     */
*             /* CALC NEXT AVAIL LOC IN BUFFER FOR READ      @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1776
*             RDKDADDR=RDKDADDR+CCWDATLN;/*                  @ZA11014
*                                                            @ZA11014*/
*                                                                  1776
         LH    @03,CCWCNT                                          1776
         SLA   @03,3                                               1776
         L     @01,IOCTLBKP                                        1776
         LA    @03,IOXCCW-8(@03,@01)                               1776
         L     @15,RDKDADDR-1                                      1776
         LA    @15,0(,@15)                                         1776
         AH    @15,CCWDATLN(,@03)                                  1776
         STCM  @15,7,RDKDADDR                                      1776
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF THIS RECORD IS AN END OF FILE      @ZA11014*/
*             /* RECORD-IF IT IS CHANGE THE READ K/D         @ZA11014*/
*             /* TO A TIC TO BYPASS READING THE ZERO         @ZA11014*/
*             /* LENGTH RECORD                               @ZA11014*/
*             /* SET THE RETURN CODE IN THE LOCATION         @ZA11014*/
*             /* TABLE FOR THIS RECORD TO EOF                @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1777
*             IF CCWDATLN=0         /*                       @ZA11014*/
*               THEN                /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1777
         SLA   @03,3                                               1777
         L     @01,IOCTLBKP                                        1777
         LA    @03,IOXCCW-8(@03,@01)                               1777
         LH    @03,CCWDATLN(,@03)                                  1777
         LTR   @03,@03                                             1777
         BNZ   @RF01777                                            1777
*               DO;                 /*                       @ZA11014*/
*                 CCW=CCWTIC;       /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1779
         SLA   @03,3                                               1779
         L     @01,IOCTLBKP                                        1779
         LA    @03,IOXCCW-8(@03,@01)                               1779
         MVC   CCW(8,@03),CCWTIC                                   1779
*                 CCWADDR=ADDR(IOXCCW(CCWCNT+1));/*          @ZA11014*/
         LH    @03,CCWCNT                                          1780
         SLA   @03,3                                               1780
         L     @01,IOCTLBKP                                        1780
         LA    @03,IOXCCW-8(@03,@01)                               1780
         LH    @15,CCWCNT                                          1780
         SLA   @15,3                                               1780
         L     @01,IOCTLBKP                                        1780
         LA    @15,IOXCCW(@15,@01)                                 1780
         STCM  @15,7,CCWADDR(@03)                                  1780
*                 LOCRCKD(RCTR+1)=RCABEOFR;/*                @ZA11014
*                                                            @ZA11014*/
*                                                                  1781
         LH    @03,RCTR                                            1781
         MH    @03,@CH00279                                        1781
         L     @15,@PC00001+8                                      1781
         L     @01,EXLOCPTR(,@15)                                  1781
         LH    @00,RCABEOFR                                        1781
         STH   @00,LOCRCKD(@03,@01)                                1781
*                 /***************************************************/
*                 /*                                                 */
*                 /* INCREMENT READ IN BUFFER POINTER        @ZA11014*/
*                 /* TO LEAVE ROOM FOR THE EOF MESSAGE       @ZA11014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1782
*                 RDKDADDR=RDKDADDR+9;/*                     @ZA11014
*                                                            @ZA11014*/
         L     @03,RDKDADDR-1                                      1782
         LA    @03,9(,@03)                                         1782
         STCM  @03,7,RDKDADDR                                      1782
*               END;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1783
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT PTR TO READ CKD CCW CHAIN         @ZA11014*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1784
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014
*                                                            @ZA11014*/
@RF01777 LH    @03,CCWCNT                                          1784
         LA    @03,1(,@03)                                         1784
         STH   @03,CCWCNT                                          1784
*           END;                    /*                       @ZA11014*/
*       END;                        /* THIS REC ON TRACK     @ZA11014
*                                                            @ZA11014*/
*                                                                  1786
*     /***************************************************************/
*     /*                                                             */
*     /* ELSE THIS RECORD NUM NOT ON TRACK-IGNORE            @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1787
*     ELSE                                                         1787
*       ;                           /*                       @ZA11014*/
@RF01732 DS    0H                                                  1788
*   END;                            /* END ITERATIVE DO      @ZA11014
*                                                            @ZA11014*/
*                                                                  1788
@RC01732 LA    @03,1                                               1788
         AH    @03,RCTR                                            1788
@DE01731 STH   @03,RCTR                                            1788
         L     @01,RRIOARPT                                        1788
         CH    @03,RNUMREC(,@01)                                   1788
         BNH   @DL01731                                            1788
*   /*****************************************************************/
*   /*                                                               */
*   /* CCW CHAIN IS BUILT - MOVE IT TO BEGINNING             @ZA11014*/
*   /* OF CCW BUFFER                                         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1789
*                                   /*                       @ZA11014*/
*                                                                  1789
*   /*****************************************************************/
*   /*                                                               */
*   /* GET LAST CCW BUILT                                    @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1789
*   LASTCCW=CCWCNT-1;               /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1789
         LH    @03,CCWCNT                                          1789
         BCTR  @03,0                                               1789
         STH   @03,LASTCCW                                         1789
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF LAST CCW IS A TIC--IF IT IS           @ZA11014*/
*   /* CHANGE IT TO A NOP TO PREVENT THE CCW STRING          @ZA11014*/
*   /* FROM RUNNING OFF THE END OF THE EARTH                 @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1790
*   IF ADDR(IOXCCW(LASTCCW))->CCWOP=TICOP/*                  @ZA11014*/
*     THEN                          /*                       @ZA11014*/
         LH    @03,LASTCCW                                         1790
         SLA   @03,3                                               1790
         L     @01,IOCTLBKP                                        1790
         LA    @03,IOXCCW-8(@03,@01)                               1790
         CLC   CCWOP(1,@03),TICOP                                  1790
         BNE   @RF01790                                            1790
*     ADDR(IOXCCW(LASTCCW))->CCW=CCWRNOP;/*                  @ZA11014
*                                                            @ZA11014*/
*                                                                  1791
         LH    @03,LASTCCW                                         1791
         SLA   @03,3                                               1791
         L     @01,IOCTLBKP                                        1791
         LA    @03,IOXCCW-8(@03,@01)                               1791
         MVC   CCW(8,@03),CCWRNOP                                  1791
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN OFF COMMAND CHAINING IN LAST CCW                 @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1792
*   ADDR(IOXCCW(LASTCCW))->CCWCMDCH=OFF;/*                   @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1792
@RF01790 LH    @03,LASTCCW                                         1792
         SLA   @03,3                                               1792
         L     @01,IOCTLBKP                                        1792
         LA    @03,IOXCCW-8(@03,@01)                               1792
         NI    CCWCMDCH(@03),B'10111111'                           1792
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE WHERE NEW STRING IS TO START INDEX         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1793
*   CCWCNT=1;                       /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1793
         MVC   CCWCNT(2),@CH00222                                  1793
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE ALL THE NEW CCWS JUST BUILT                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1794
*   DO RCTR=(MAXRECS+NONRDCT+1) TO LASTCCW;/*                @ZA11014*/
         LH    @03,MAXRECS                                         1794
         AH    @03,NONRDCT                                         1794
         AL    @03,@CF00222                                        1794
         B     @DE01794                                            1794
@DL01794 DS    0H                                                  1795
*     CCW=ADDR(IOXCCW(RCTR))->CCW;  /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1795
         SLA   @03,3                                               1795
         L     @01,IOCTLBKP                                        1795
         LA    @03,IOXCCW-8(@03,@01)                               1795
         LH    @15,RCTR                                            1795
         SLA   @15,3                                               1795
         L     @01,IOCTLBKP                                        1795
         LA    @15,IOXCCW-8(@15,@01)                               1795
         MVC   CCW(8,@03),CCW(@15)                                 1795
*     CCWCNT=CCWCNT+1;              /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1796
         LA    @03,1(,@03)                                         1796
         STH   @03,CCWCNT                                          1796
*   END;                            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1797
         LA    @03,1                                               1797
         AH    @03,RCTR                                            1797
@DE01794 STH   @03,RCTR                                            1797
         CH    @03,LASTCCW                                         1797
         BNH   @DL01794                                            1797
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH LOCTAB TO SEE IF ANY COUNT FIELDS SAVED        @ZA11014*/
*   /* IF SO-MOVE INTO READ IN BUFFER LOCATION               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1798
*   DO RCTR=2 TO(RNUMREC+1);        /*                       @ZA11014*/
         LA    @03,2                                               1798
         B     @DE01798                                            1798
@DL01798 DS    0H                                                  1799
*     IF LOCCNTFD(RCTR)^=ZEROS      /*                       @ZA11014*/
*       THEN                        /*                       @ZA11014*/
*                                                                  1799
         LH    @03,RCTR                                            1799
         MH    @03,@CH00279                                        1799
         L     @15,@PC00001+8                                      1799
         L     @01,EXLOCPTR(,@15)                                  1799
         ALR   @01,@03                                             1799
         AL    @01,@CF04428                                        1799
         CLC   LOCCNTFD-8(8,@01),ZEROS                             1799
         BE    @RF01799                                            1799
*       /*************************************************************/
*       /*                                                           */
*       /* COUNT FIELD SAVED-MOVE IT INTO BUFFER             @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1800
*       LOCADDR(RCTR)->RBUFCNT=LOCCNTFD(RCTR);/*             @ZA11014
*                                                            @ZA11014*/
*                                                                  1800
         LH    @03,RCTR                                            1800
         MH    @03,@CH00279                                        1800
         L     @15,@PC00001+8                                      1800
         L     @01,EXLOCPTR(,@15)                                  1800
         AL    @01,@CF04425                                        1800
         L     @03,LOCADDR(@03,@01)                                1800
         LH    @15,RCTR                                            1800
         MH    @15,@CH00279                                        1800
         L     @14,@PC00001+8                                      1800
         L     @01,EXLOCPTR(,@14)                                  1800
         ALR   @01,@15                                             1800
         AL    @01,@CF04428                                        1800
         MVC   RBUFCNT(8,@03),LOCCNTFD-8(@01)                      1800
*     /***************************************************************/
*     /*                                                             */
*     /* ELSE INCREMENT TO NEXT ENTRY                        @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1801
*     ELSE                                                         1801
*       ;                           /*                       @ZA11014*/
@RF01799 DS    0H                                                  1802
*   END;                            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1802
         LA    @03,1                                               1802
         AH    @03,RCTR                                            1802
@DE01798 STH   @03,RCTR                                            1802
         LA    @15,1                                               1802
         L     @14,RRIOARPT                                        1802
         AH    @15,RNUMREC(,@14)                                   1802
         CR    @03,@15                                             1802
         BNH   @DL01798                                            1802
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RETURN CODE TO OK                                 @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1803
*   TESTRC=0;                       /*                       @ZA11014*/
         SLR   @03,@03                                             1803
         STH   @03,TESTRC                                          1803
*   RETURN CODE(TESTRC);            /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @15,TESTRC                                          1804
         L     @14,12(,@13)                                        1804
         LM    @00,@12,20(@13)                                     1804
         BR    @14                                                 1804
*   END SETKDCCW;                   /*                       @ZA11014*/
*                                   /*                       @ZA11014*/
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - ADJCCW                                       @ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE - MODIFY THE EXISTING CCW STRING              @ZA11014*/
*/*              BUILT BY SETKDCCW SO  READING CAN CONTINUE  @ZA11014*/
*/*              BEYOND A BAD KEY OR DATA FIELD              @ZA11014*/
*/*                                                          @ZA11014*/
*/*              THE CCW FOR THE KEY OR DATA IN ERROR WILL BE@ZA11014*/
*/*               CHANGED TO A TIC IF THE CCW WAS A READ     @ZA11014*/
*/*               KEY/DATA CCW, OR TO A READ COUNT IF THE    @ZA11014*/
*/*               CCW WAS A READ COUNT/KEY/DATA CCW          @ZA11014*/
*/*                                                          @ZA11014*/
*/*              ALL READ CCWS PREVIOUSLY EXECUTED WILL HAVE @ZA11014*/
*/*              DATA TRANSFER SURPRESSED                    @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - SVCCWPTR CONTAINS THE SAVED ADDR OF THE         @ZA11014*/
*/*                   VALUE IN THE CSW AFTER THE LAST        @ZA11014*/
*/*                   CALL TO READKD                         @ZA11014*/
*/*          IOCTLBKP                                        @ZA11014*/
*/*          CCWLIST IN IOXCCWS                              @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - MODIFIED CCW LIST IN IOXCCWS                   @ZA11014*/
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1806
*                                   /*                       @ZA11014*/
*ADJCCW:                                                           1806
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1806
ADJCCW   STM   @14,@12,12(@13)                                     1806
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1807
*   OLDERID2=NEWERID2;                                             1807
         L     @03,@PC00001                                        1807
         L     @03,GDTTR2(,@03)                                    1807
         L     @15,@PC00001                                        1807
         L     @01,GDTTR2(,@15)                                    1807
         MVC   @TS00001(95),NEWERID2(@01)                          1807
         MVC   OLDERID2(95,@03),@TS00001                           1807
*   NEWID2='IOAJ';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1808
         L     @03,@PC00001                                        1808
         L     @03,GDTTR2(,@03)                                    1808
         MVC   NEWID2(4,@03),@CC04378                              1808
*   /*****************************************************************/
*   /*                                                               */
*   /* CALC NUM OF CCWS EXECUTED                             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1809
*   CNTCCWS=(SVCCWPTR-ADDR(IOXCCWS))/CCWSIZE;/*              @ZA11014
*                                                            @ZA11014*/
*                                                                  1809
         L     @03,@PC00001+8                                      1809
         L     @01,IOCTLBKP                                        1809
         LA    @15,IOXCCWS(,@01)                                   1809
         LR    @00,@15                                             1809
         LCR   @00,@00                                             1809
         L     @03,SVCCWPTR-1(,@03)                                1809
         LA    @03,0(,@03)                                         1809
         ALR   @00,@03                                             1809
         SRDA  @00,32                                              1809
         LH    @03,CCWSIZE                                         1809
         DR    @00,@03                                             1809
         STH   @01,CNTCCWS                                         1809
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INDEX OF FAILING CCW                              @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1810
*   CCWCNT=CNTCCWS;                 /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1810
         LH    @03,CNTCCWS                                         1810
         STH   @03,CCWCNT                                          1810
*   /*****************************************************************/
*   /*                                                               */
*   /* ENSURE CCW IS A READ FOR KEY/DATA OR DATA             @0Z11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1811
*   IF CCWOP^=RDKDOP&CCWOP^=RDDTOP  /*                       @0Z11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1811
         LH    @03,CCWCNT                                          1811
         SLA   @03,3                                               1811
         L     @01,IOCTLBKP                                        1811
         LA    @03,IOXCCW-8(@03,@01)                               1811
         CLC   CCWOP(1,@03),RDKDOP                                 1811
         BE    @RF01811                                            1811
         LH    @03,CCWCNT                                          1811
         SLA   @03,3                                               1811
         L     @01,IOCTLBKP                                        1811
         LA    @03,IOXCCW-8(@03,@01)                               1811
         CLC   CCWOP(1,@03),RDDTOP                                 1811
         BE    @RF01811                                            1811
*     /***************************************************************/
*     /*                                                             */
*     /* UNEXPECTED RESULTS                                  @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1812
*     TESTRC=RCSRUEX;               /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCSRUEX                                         1812
         STH   @03,TESTRC                                          1812
*   ELSE                            /*                       @ZA11014*/
*                                                                  1813
*     /***************************************************************/
*     /*                                                             */
*     /* OP CODE WHAT WAS EXPECTED-CONTINUE                  @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1813
*     DO;                           /*                       @ZA11014
*                                                            @0Z11014*/
         B     @RC01811                                            1813
@RF01811 DS    0H                                                  1814
*       RESPECIFY                                                  1814
*         RBUF BASED(CCWADDR-8);    /*                       @0Z11014*/
*       IF CCWOP=RDDTOP             /*                       @0Z11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1815
         LH    @03,CCWCNT                                          1815
         SLA   @03,3                                               1815
         L     @01,IOCTLBKP                                        1815
         LA    @03,IOXCCW-8(@03,@01)                               1815
         CLC   CCWOP(1,@03),RDDTOP                                 1815
         BNE   @RF01815                                            1815
*         /***********************************************************/
*         /*                                                         */
*         /* READ DATA CCW-DATA BYTES WERE TRANSFERED        @0Z11014*/
*         /* OVERLAY CCW WITH A TIC TO *+8                   @0Z11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1816
*         DO;                       /*                       @ZA11014*/
*           CCW=CCWTIC;             /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1817
         SLA   @03,3                                               1817
         L     @01,IOCTLBKP                                        1817
         LA    @03,IOXCCW-8(@03,@01)                               1817
         MVC   CCW(8,@03),CCWTIC                                   1817
*           CCWADDR=ADDR(IOXCCW(CCWCNT+1));/*                @ZA11014*/
         LH    @03,CCWCNT                                          1818
         SLA   @03,3                                               1818
         L     @01,IOCTLBKP                                        1818
         LA    @03,IOXCCW-8(@03,@01)                               1818
         LH    @15,CCWCNT                                          1818
         SLA   @15,3                                               1818
         L     @01,IOCTLBKP                                        1818
         LA    @15,IOXCCW(@15,@01)                                 1818
         STCM  @15,7,CCWADDR(@03)                                  1818
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*       ELSE                        /*                       @ZA11014*/
*                                                                  1820
*         /***********************************************************/
*         /*                                                         */
*         /* READ KEY/DATA CCW-OVERLAY WITH READ DATA        @0Z11014*/
*         /* CCW TO ENSURE DATA BYTES GET TRANSFERED         @0Z11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1820
*         DO;                       /*                       @ZA11014*/
         B     @RC01815                                            1820
@RF01815 DS    0H                                                  1821
*           CCWOP=RDDTOP;           /*                       @0Z11014*/
         LH    @03,CCWCNT                                          1821
         SLA   @03,3                                               1821
         L     @01,IOCTLBKP                                        1821
         LA    @03,IOXCCW-8(@03,@01)                               1821
         IC    @15,RDDTOP                                          1821
         STC   @15,CCWOP(,@03)                                     1821
*           CCWDATLN=CCWDATLN-RBKL; /*                       @0Z11014*/
         LH    @03,CCWCNT                                          1822
         SLA   @03,3                                               1822
         L     @01,IOCTLBKP                                        1822
         LA    @03,IOXCCW-8(@03,@01)                               1822
         LH    @15,CCWCNT                                          1822
         SLA   @15,3                                               1822
         L     @01,IOCTLBKP                                        1822
         LA    @15,IOXCCW-8(@15,@01)                               1822
         LH    @14,CCWCNT                                          1822
         SLA   @14,3                                               1822
         L     @01,IOCTLBKP                                        1822
         LA    @14,IOXCCW-8(@14,@01)                               1822
         L     @01,CCWADDR-1(,@14)                                 1822
         LH    @00,CCWDATLN(,@15)                                  1822
         AL    @01,@CF04429                                        1822
         SLR   @15,@15                                             1822
         IC    @15,RBKL-5(,@01)                                    1822
         SLR   @00,@15                                             1822
         STH   @00,CCWDATLN(,@03)                                  1822
*           CCWADDR=CCWADDR+RBKL;   /*                       @0Z11014*/
         LH    @03,CCWCNT                                          1823
         SLA   @03,3                                               1823
         L     @01,IOCTLBKP                                        1823
         LA    @03,IOXCCW-8(@03,@01)                               1823
         LH    @15,CCWCNT                                          1823
         SLA   @15,3                                               1823
         L     @01,IOCTLBKP                                        1823
         LA    @15,IOXCCW-8(@15,@01)                               1823
         LH    @14,CCWCNT                                          1823
         SLA   @14,3                                               1823
         L     @01,IOCTLBKP                                        1823
         LA    @14,IOXCCW-8(@14,@01)                               1823
         L     @01,CCWADDR-1(,@14)                                 1823
         L     @00,CCWADDR-1(,@15)                                 1823
         ICM   @00,8,@CB03783                                      1823
         AL    @01,@CF04429                                        1823
         SLR   @15,@15                                             1823
         IC    @15,RBKL-5(,@01)                                    1823
         ALR   @00,@15                                             1823
         STCM  @00,7,CCWADDR(@03)                                  1823
*           CCWSUPP=OFF;            /*                       @0Z11014*/
         LH    @03,CCWCNT                                          1824
         SLA   @03,3                                               1824
         L     @01,IOCTLBKP                                        1824
         LA    @03,IOXCCW-8(@03,@01)                               1824
         NI    CCWSUPP(@03),B'11101111'                            1824
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1825
*       /*************************************************************/
*       /*                                                           */
*       /* BAD CCW HAS BEEN BYPASSED                         @ZA11014*/
*       /* TURN SUPP DATA ON IN ALL READ CCWS PRIOR TO       @ZA11014*/
*       /* LAST ONE AS LONG AS LAST ONE IS NOT BEFORE        @ZA11014*/
*       /* SECOND RECORD                                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1826
*       IF CNTCCWS>=NONRDCT+1       /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
@RC01815 LA    @03,1                                               1826
         AH    @03,NONRDCT                                         1826
         CH    @03,CNTCCWS                                         1826
         BH    @RF01826                                            1826
*         DO CCWCNT=(NONRDCT+1) TO(CNTCCWS-1);/*             @ZA11014*/
         LA    @03,1                                               1827
         AH    @03,NONRDCT                                         1827
         B     @DE01827                                            1827
@DL01827 DS    0H                                                  1828
*           IF CCWOP=RDCKDOP×CCWOP=RDKDOP/*                  @ZA11014*/
*               ×CCWOP=RDCNTOP      /*                       @0Z11014*/
*             THEN                  /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1828
         SLA   @03,3                                               1828
         L     @01,IOCTLBKP                                        1828
         LA    @03,IOXCCW-8(@03,@01)                               1828
         CLC   CCWOP(1,@03),RDCKDOP                                1828
         BE    @RT01828                                            1828
         LH    @03,CCWCNT                                          1828
         SLA   @03,3                                               1828
         L     @01,IOCTLBKP                                        1828
         LA    @03,IOXCCW-8(@03,@01)                               1828
         CLC   CCWOP(1,@03),RDKDOP                                 1828
         BE    @RT01828                                            1828
         LH    @03,CCWCNT                                          1828
         SLA   @03,3                                               1828
         L     @01,IOCTLBKP                                        1828
         LA    @03,IOXCCW-8(@03,@01)                               1828
         CLC   CCWOP(1,@03),RDCNTOP                                1828
         BNE   @RF01828                                            1828
@RT01828 DS    0H                                                  1829
*             CCWSUPP=ON;           /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1829
         SLA   @03,3                                               1829
         L     @01,IOCTLBKP                                        1829
         LA    @03,IOXCCW-8(@03,@01)                               1829
         OI    CCWSUPP(@03),B'00010000'                            1829
*           ELSE                                                   1830
*             ;                     /*                       @ZA11014*/
@RF01828 DS    0H                                                  1831
*         END;                      /*                       @ZA11014*/
         LA    @03,1                                               1831
         AH    @03,CCWCNT                                          1831
@DE01827 STH   @03,CCWCNT                                          1831
         LH    @15,CNTCCWS                                         1831
         BCTR  @15,0                                               1831
         CR    @03,@15                                             1831
         BNH   @DL01827                                            1831
*       ELSE                                                       1832
*         ;                         /*                       @ZA11014*/
@RF01826 DS    0H                                                  1833
*       TESTRC=0;                   /*                       @ZA11014*/
         SLR   @03,@03                                             1833
         STH   @03,TESTRC                                          1833
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/
@RC01811 LH    @15,TESTRC                                          1835
         L     @14,12(,@13)                                        1835
         LM    @00,@12,20(@13)                                     1835
         BR    @14                                                 1835
*   END ADJCCW;                     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1837
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - WRITEREC                               @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - BUILDS THE FOLLOWING CCW LIST TO UPDATE IN   @ZA11014*/
*/*              PLACE A RECORD ON A TRACK                   @ZA11014*/
*/*                                                          @ZA11014*/
*/*                 SET SECTOR ZERO                          @ZA11014*/
*/*                 SEARCH ID EQUAL                          @ZA11014*/
*/*                 TIC *-8                                  @ZA11014*/
*/*                 WRITE KEY/DATA OR WRITE SPECIAL          @ZA11014*/
*/*                 SET SECTOR 0                             @ZA11014*/
*/*                 SEARCH ID EQUAL                          @ZA11014*/
*/*                 TIC *-8                                  @ZA11014*/
*/*                 READ KEY/DATA OR COUNT/KEY/DATA          @ZA11014*/
*/*             CALLS ISSUEXCP TO EXECUTE CCW CHAIN          @ZA11014*/
*/*             RETURNS                                      @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/
*/*          EXRWIOAR FROM EXWRARG                           @ZA11014*/
*/*          EXCC     FROM EXWRARG                           @ZA11014*/
*/*          EXHH     FROM EXWRARG                           @ZA11014*/
*/*          EXRECNUM FROM EXWRARG                           @ZA11014*/
*/*          EXRWFUN  FROM EXWRARG                           @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1837
*                                   /*                       @ZA11014*/
*WRITEREC:                                                         1837
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1837
WRITEREC STM   @14,@12,@SA00029                                    1837
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1838
*   OLDERID2=NEWERID2;                                             1838
         L     @03,@PC00001                                        1838
         L     @03,GDTTR2(,@03)                                    1838
         L     @15,@PC00001                                        1838
         L     @01,GDTTR2(,@15)                                    1838
         MVC   @TS00001(95),NEWERID2(@01)                          1838
         MVC   OLDERID2(95,@03),@TS00001                           1838
*   NEWID2='IOWR';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1839
         L     @03,@PC00001                                        1839
         L     @03,GDTTR2(,@03)                                    1839
         MVC   NEWID2(4,@03),@CC04384                              1839
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE IF VALID ENTRY                            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1840
*   IF EXRWFUN^=RVWS&EXRWFUN^=RVWKD /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1840
         L     @03,@PC00001+8                                      1840
         CLC   EXRWFUN(1,@03),RVWS                                 1840
         BE    @RF01840                                            1840
         L     @03,@PC00001+8                                      1840
         CLC   EXRWFUN(1,@03),RVWKD                                1840
         BE    @RF01840                                            1840
*     /***************************************************************/
*     /*                                                             */
*     /* INVALID WRITE REQUEST                               @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1841
*     TESTRC=RCINVWR;               /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
         LH    @03,RCINVWR                                         1841
         STH   @03,TESTRC                                          1841
*   ELSE                            /*                       @ZA11014*/
*                                                                  1842
*     /***************************************************************/
*     /*                                                             */
*     /* REQUEST OK-CONTINUE                                 @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1842
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1842
         B     @RC01840                                            1842
@RF01840 DS    0H                                                  1843
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP ADDRABILITY TO IOXCTLBK AND WIOAREA        @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1843
*       IOCTLBKP=EXRWCTBL;          /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1843
         L     @03,EXRWCTBL(,@03)                                  1843
         ST    @03,IOCTLBKP                                        1843
*       RWIOARPT=EXRWIOAR;          /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1844
         L     @03,EXRWIOAR(,@03)                                  1844
         ST    @03,RWIOARPT                                        1844
*       RESPECIFY                                                  1845
*         WBUF BASED(ADDR(WBUFF));  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1845
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE DCB AND IOB POINTERS                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1846
*       DCBPTR=ADDR(IOXDCB);        /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1846
         LA    @03,IOXDCB(,@03)                                    1846
         ST    @03,DCBPTR                                          1846
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1847
         L     @03,IOCTLBKP                                        1847
         LA    @03,IOXIOB(,@03)                                    1847
         ST    @03,IOBSTPTR                                        1847
*       /*************************************************************/
*       /*                                                           */
*       /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE     @ZA11014*/
*       /* IOBSEEK CCHHR VALUE                               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1848
*       IOBCC=EXCC;                 /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1848
         L     @01,IOBSTPTR                                        1848
         MVC   IOBCC(2,@01),EXCC(@03)                              1848
*       IOBHH=EXHH;                 /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1849
         L     @01,IOBSTPTR                                        1849
         MVC   IOBHH(2,@01),EXHH(@03)                              1849
*       IOBR=EXRECNUM;              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1850
         L     @03,@PC00001+8                                      1850
         IC    @15,EXRECNUM(,@03)                                  1850
         L     @03,IOBSTPTR                                        1850
         STC   @15,IOBR(,@03)                                      1850
*       /*************************************************************/
*       /*                                                           */
*       /* CALC START OF CCW CHAIN-AFTER LAST RD CNT         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1851
*       CCWCNT=NONRDCT+MAXRECS+1;   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1851
         LH    @03,NONRDCT                                         1851
         AH    @03,MAXRECS                                         1851
         LA    @03,1(,@03)                                         1851
         STH   @03,CCWCNT                                          1851
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE START ADDR OF THE CCW CHN IN IO@ZA11014    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1852
*       IOBSTART=ADDR(IOXCCW(CCWCNT));/*                     @ZA11014
*                                                            @ZA11014*/
*                                                                  1852
         LH    @03,CCWCNT                                          1852
         SLA   @03,3                                               1852
         L     @01,IOCTLBKP                                        1852
         LA    @03,IOXCCW-8(@03,@01)                               1852
         L     @01,IOBSTPTR                                        1852
         ST    @03,IOBSTART(,@01)                                  1852
*       /*************************************************************/
*       /*                                                           */
*       /* SET FIRST CCW TO SET SECTOR ZERO - WANT TO        @ZA11014*/
*       /* START FROM BEGINNING OF TRACK SO THAT             @ZA11014*/
*       /* ERRORS CAN BE FIXED SEQUENTIALLY ONE AT A TIM@ZA11014     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1853
*       CCW=CCWRSSEC;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1853
         SLA   @03,3                                               1853
         L     @01,IOCTLBKP                                        1853
         LA    @03,IOXCCW-8(@03,@01)                               1853
         MVC   CCW(8,@03),CCWRSSEC                                 1853
*       CCWADDR=ADDR(ZERO);         /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1854
         LH    @03,CCWCNT                                          1854
         SLA   @03,3                                               1854
         L     @01,IOCTLBKP                                        1854
         LA    @03,IOXCCW-8(@03,@01)                               1854
         LA    @15,ZERO                                            1854
         STCM  @15,7,CCWADDR(@03)                                  1854
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1855
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1855
         LH    @03,CCWCNT                                          1855
         LA    @03,1(,@03)                                         1855
         STH   @03,CCWCNT                                          1855
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEXT CCW TO SEARCH ID EQUAL-THEN DETERMINE@ZA11014    */
*       /* WHAT RECORD NUMBER TO SEARCH ON                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1856
*       CCW=CCWSIDEQ;               /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1856
         LH    @03,CCWCNT                                          1856
         SLA   @03,3                                               1856
         L     @01,IOCTLBKP                                        1856
         LA    @03,IOXCCW-8(@03,@01)                               1856
         MVC   CCW(8,@03),CCWSIDEQ                                 1856
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF WRITE KEY/DATA                           @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1857
*       IF EXRWFUN=RVWKD            /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1857
         L     @03,@PC00001+8                                      1857
         CLC   EXRWFUN(1,@03),RVWKD                                1857
         BNE   @RF01857                                            1857
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE KEY/DATA-SEARCH THIS RECORD NUMBER        @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1858
*         SRCHR=EXRECNUM;           /*                       @ZA11014
*                                                            @ZA11014*/
         L     @03,@PC00001+8                                      1858
         IC    @15,EXRECNUM(,@03)                                  1858
         STC   @15,SRCHR                                           1858
*       ELSE                        /*                       @ZA11014*/
*                                                                  1859
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE SPECIAL-DETERMINE SEARCH REC NUM          @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1859
*         DO;                       /*                       @ZA11014*/
*                                                                  1859
         B     @RC01857                                            1859
@RF01857 DS    0H                                                  1860
*           /*********************************************************/
*           /*                                                       */
*           /* SEARCH REC IS FIRST PREVIOUS AVAILABLE        @ZA11014*/
*           /* CHECK LOCTAB BEGINNING IN ENTRY BEFORE        @ZA11014*/
*           /* REQUESTED REC--LOCTAB STARTS AT R0            @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1860
*           RCTR=EXRECNUM;          /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1860
         SLR   @15,@15                                             1860
         IC    @15,EXRECNUM(,@03)                                  1860
         STH   @15,RCTR                                            1860
*           DO WHILE RCTR^=1&LOCADDR(RCTR)=NTFNDPTR;/*       @ZA11014*/
         B     @DE01861                                            1861
@DL01861 DS    0H                                                  1862
*             RCTR=RCTR-1;          /*                       @ZA11014*/
         LH    @03,RCTR                                            1862
         BCTR  @03,0                                               1862
         STH   @03,RCTR                                            1862
*           END;                    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1863
@DE01861 CLC   RCTR(2),@CH00222                                    1863
         BE    @DC01861                                            1863
         LH    @03,RCTR                                            1863
         MH    @03,@CH00279                                        1863
         L     @15,@PC00001+8                                      1863
         L     @01,EXLOCPTR(,@15)                                  1863
         AL    @01,@CF04425                                        1863
         L     @03,LOCADDR(@03,@01)                                1863
         ICM   @15,15,NTFNDPTR                                     1863
         CLR   @03,@15                                             1863
         BE    @DL01861                                            1863
@DC01861 DS    0H                                                  1864
*           /*********************************************************/
*           /*                                                       */
*           /* SET SEARCH REC NUM                            @ZA11014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1864
*           SRCHR=RCTR-1;           /*                       @ZA11014*/
         LH    @03,RCTR                                            1864
         BCTR  @03,0                                               1864
         STC   @03,SRCHR                                           1864
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1865
*       /*************************************************************/
*       /*                                                           */
*       /* SET CYLINDER AND HEAD IN SEARCH ARG               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1866
*       SRCHCC=EXCC;                /*                       @ZA11014*/
@RC01857 L     @03,@PC00001+8                                      1866
         LH    @03,EXCC(,@03)                                      1866
         N     @03,@CF04424                                        1866
         STH   @03,SRCHCC                                          1866
*       SRCHHH=EXHH;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1867
         L     @03,@PC00001+8                                      1867
         LH    @03,EXHH(,@03)                                      1867
         N     @03,@CF04424                                        1867
         STH   @03,SRCHHH                                          1867
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH ADDR INTO CCW                          @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1868
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1868
         LH    @03,CCWCNT                                          1868
         SLA   @03,3                                               1868
         L     @01,IOCTLBKP                                        1868
         LA    @03,IOXCCW-8(@03,@01)                               1868
         LA    @15,SRCHCHR                                         1868
         STCM  @15,7,CCWADDR(@03)                                  1868
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1869
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1869
         LH    @03,CCWCNT                                          1869
         LA    @03,1(,@03)                                         1869
         STH   @03,CCWCNT                                          1869
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1870
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1870
         SLA   @03,3                                               1870
         L     @01,IOCTLBKP                                        1870
         LA    @03,IOXCCW-8(@03,@01)                               1870
         MVC   CCW(8,@03),CCWTIC                                   1870
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1871
         LH    @03,CCWCNT                                          1871
         SLA   @03,3                                               1871
         L     @01,IOCTLBKP                                        1871
         LA    @03,IOXCCW-8(@03,@01)                               1871
         LH    @15,CCWCNT                                          1871
         SLA   @15,3                                               1871
         L     @01,IOCTLBKP                                        1871
         LA    @15,IOXCCW-16(@15,@01)                              1871
         STCM  @15,7,CCWADDR(@03)                                  1871
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1872
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1872
         LH    @03,CCWCNT                                          1872
         LA    @03,1(,@03)                                         1872
         STH   @03,CCWCNT                                          1872
*       /*************************************************************/
*       /*                                                           */
*       /* READY FOR WRITE CCW-SAVE ITS INDEX                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1873
*       RVCNT=CCWCNT;               /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1873
         LH    @03,CCWCNT                                          1873
         STH   @03,RVCNT                                           1873
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF WANT TO WR K/D OR WR SPEC            @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1874
*       IF EXRWFUN=RVWKD            /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1874
         L     @03,@PC00001+8                                      1874
         CLC   EXRWFUN(1,@03),RVWKD                                1874
         BNE   @RF01874                                            1874
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE KEY DATA FUNC-SET UP CCW                  @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1875
*         DO;                       /*                       @ZA11014*/
*           CCW=CCWRWKD;            /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1876
         SLA   @03,3                                               1876
         L     @01,IOCTLBKP                                        1876
         LA    @03,IOXCCW-8(@03,@01)                               1876
         MVC   CCW(8,@03),CCWRWKD                                  1876
*           CCWADDR=ADDR(WKEYDAT);  /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1877
         SLA   @03,3                                               1877
         L     @01,IOCTLBKP                                        1877
         LA    @03,IOXCCW-8(@03,@01)                               1877
         L     @01,RWIOARPT                                        1877
         LA    @15,WKEYDAT+4(,@01)                                 1877
         STCM  @15,7,CCWADDR(@03)                                  1877
*           CCWDATLN=WBKL+WBDL;     /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1878
         SLA   @03,3                                               1878
         L     @01,IOCTLBKP                                        1878
         LA    @03,IOXCCW-8(@03,@01)                               1878
         L     @01,RWIOARPT                                        1878
         SLR   @00,@00                                             1878
         IC    @00,WBKL+4(,@01)                                    1878
         L     @01,RWIOARPT                                        1878
         AH    @00,WBDL+4(,@01)                                    1878
         STH   @00,CCWDATLN(,@03)                                  1878
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*       ELSE                        /*                       @ZA11014*/
*                                                                  1880
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE SPECIAL FUNC-SET UP CCW                   @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1880
*         DO;                       /*                       @ZA11014*/
         B     @RC01874                                            1880
@RF01874 DS    0H                                                  1881
*           CCW=CCWRWSP;            /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1881
         SLA   @03,3                                               1881
         L     @01,IOCTLBKP                                        1881
         LA    @03,IOXCCW-8(@03,@01)                               1881
         MVC   CCW(8,@03),CCWRWSP                                  1881
*           CCWADDR=ADDR(WBUFF);    /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1882
         SLA   @03,3                                               1882
         L     @01,IOCTLBKP                                        1882
         LA    @03,IOXCCW-8(@03,@01)                               1882
         L     @01,RWIOARPT                                        1882
         LA    @15,WBUFF(,@01)                                     1882
         STCM  @15,7,CCWADDR(@03)                                  1882
*           CCWDATLN=WBKL+WBDL+LENCNT;/*                     @ZA11014*/
         LH    @03,CCWCNT                                          1883
         SLA   @03,3                                               1883
         L     @01,IOCTLBKP                                        1883
         LA    @03,IOXCCW-8(@03,@01)                               1883
         L     @01,RWIOARPT                                        1883
         SLR   @00,@00                                             1883
         IC    @00,WBKL+4(,@01)                                    1883
         L     @01,RWIOARPT                                        1883
         AH    @00,WBDL+4(,@01)                                    1883
         AH    @00,LENCNT                                          1883
         STH   @00,CCWDATLN(,@03)                                  1883
*         END;                      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1884
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1885
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1885
@RC01874 LH    @03,CCWCNT                                          1885
         LA    @03,1(,@03)                                         1885
         STH   @03,CCWCNT                                          1885
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP TO VERIFY WRITE BY READING BACK            @ZA11014*/
*       /* MUST DO ANOTHER SET SECTOR ZERO IN CASE           @ZA11014*/
*       /* OTHER ERROR RECORDS ON TRACK                      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1886
*       CCW=CCWRSSEC;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1886
         SLA   @03,3                                               1886
         L     @01,IOCTLBKP                                        1886
         LA    @03,IOXCCW-8(@03,@01)                               1886
         MVC   CCW(8,@03),CCWRSSEC                                 1886
*       CCWADDR=ADDR(ZEROS);        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1887
         LH    @03,CCWCNT                                          1887
         SLA   @03,3                                               1887
         L     @01,IOCTLBKP                                        1887
         LA    @03,IOXCCW-8(@03,@01)                               1887
         LA    @15,ZEROS                                           1887
         STCM  @15,7,CCWADDR(@03)                                  1887
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1888
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1888
         LH    @03,CCWCNT                                          1888
         LA    @03,1(,@03)                                         1888
         STH   @03,CCWCNT                                          1888
*       /*************************************************************/
*       /*                                                           */
*       /* SEARCH ID EQUAL SAME AS WRITE                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1889
*       CCW=CCWSIDEQ;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1889
         SLA   @03,3                                               1889
         L     @01,IOCTLBKP                                        1889
         LA    @03,IOXCCW-8(@03,@01)                               1889
         MVC   CCW(8,@03),CCWSIDEQ                                 1889
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1890
         LH    @03,CCWCNT                                          1890
         SLA   @03,3                                               1890
         L     @01,IOCTLBKP                                        1890
         LA    @03,IOXCCW-8(@03,@01)                               1890
         LA    @15,SRCHCHR                                         1890
         STCM  @15,7,CCWADDR(@03)                                  1890
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1891
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1891
         LH    @03,CCWCNT                                          1891
         LA    @03,1(,@03)                                         1891
         STH   @03,CCWCNT                                          1891
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1892
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1892
         SLA   @03,3                                               1892
         L     @01,IOCTLBKP                                        1892
         LA    @03,IOXCCW-8(@03,@01)                               1892
         MVC   CCW(8,@03),CCWTIC                                   1892
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1893
         LH    @03,CCWCNT                                          1893
         SLA   @03,3                                               1893
         L     @01,IOCTLBKP                                        1893
         LA    @03,IOXCCW-8(@03,@01)                               1893
         LH    @15,CCWCNT                                          1893
         SLA   @15,3                                               1893
         L     @01,IOCTLBKP                                        1893
         LA    @15,IOXCCW-16(@15,@01)                              1893
         STCM  @15,7,CCWADDR(@03)                                  1893
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1894
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1894
         LH    @03,CCWCNT                                          1894
         LA    @03,1(,@03)                                         1894
         STH   @03,CCWCNT                                          1894
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHAT KIND OF READ TO DO                 @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1895
*       IF EXRWFUN=RVWKD            /*                       @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1895
         L     @03,@PC00001+8                                      1895
         CLC   EXRWFUN(1,@03),RVWKD                                1895
         BNE   @RF01895                                            1895
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE KEY/DATA-READ BACK KEY/DATA               @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1896
*         CCW=CCWRRKD;              /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,CCWCNT                                          1896
         SLA   @03,3                                               1896
         L     @01,IOCTLBKP                                        1896
         LA    @03,IOXCCW-8(@03,@01)                               1896
         MVC   CCW(8,@03),CCWRRKD                                  1896
*       ELSE                        /*                       @ZA11014*/
*                                                                  1897
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE SPECIAL-READ BACK COUNT/KEY/DATA          @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1897
*         CCW=CCWRRCKD;             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1897
         B     @RC01895                                            1897
@RF01895 LH    @03,CCWCNT                                          1897
         SLA   @03,3                                               1897
         L     @01,IOCTLBKP                                        1897
         LA    @03,IOXCCW-8(@03,@01)                               1897
         MVC   CCW(8,@03),CCWRRCKD                                 1897
*       /*************************************************************/
*       /*                                                           */
*       /* SET ADDR SAME AS WRITE,SUPP DATA XFER=NO CHAIN@ZA11014    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1898
*       CCWADDR=ADDR(IOXCCW(RVCNT))->CCWADDR;/*              @ZA11014*/
@RC01895 LH    @03,CCWCNT                                          1898
         SLA   @03,3                                               1898
         L     @01,IOCTLBKP                                        1898
         LA    @03,IOXCCW-8(@03,@01)                               1898
         LH    @15,RVCNT                                           1898
         SLA   @15,3                                               1898
         L     @01,IOCTLBKP                                        1898
         LA    @15,IOXCCW-8(@15,@01)                               1898
         MVC   CCWADDR(3,@03),CCWADDR(@15)                         1898
*       CCWDATLN=ADDR(IOXCCW(RVCNT))->CCWDATLN;/*            @ZA11014*/
         LH    @03,CCWCNT                                          1899
         SLA   @03,3                                               1899
         L     @01,IOCTLBKP                                        1899
         LA    @03,IOXCCW-8(@03,@01)                               1899
         LH    @15,RVCNT                                           1899
         SLA   @15,3                                               1899
         L     @01,IOCTLBKP                                        1899
         LA    @15,IOXCCW-8(@15,@01)                               1899
         LH    @15,CCWDATLN(,@15)                                  1899
         STH   @15,CCWDATLN(,@03)                                  1899
*       CCWSUPP=ON;                 /*                       @ZA11014*/
*       CCWCMDCH=OFF;               /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1901
         LH    @03,CCWCNT                                          1901
         SLA   @03,3                                               1901
         L     @01,IOCTLBKP                                        1901
         LA    @03,IOXCCW-8(@03,@01)                               1901
         OI    CCWSUPP(@03),B'00010000'                            1901
         NI    CCWCMDCH(@03),B'10111111'                           1901
*       /*************************************************************/
*       /*                                                           */
*       /* CCW CHAIN ALL BUILT-SET TRACE ID BEFORE EXCP      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1902
*       OLDERID2=NEWERID2;                                         1902
         L     @03,@PC00001                                        1902
         L     @03,GDTTR2(,@03)                                    1902
         L     @15,@PC00001                                        1902
         L     @01,GDTTR2(,@15)                                    1902
         MVC   @TS00001(95),NEWERID2(@01)                          1902
         MVC   OLDERID2(95,@03),@TS00001                           1902
*       NEWID2='IOWB';              /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1903
         L     @03,@PC00001                                        1903
         L     @03,GDTTR2(,@03)                                    1903
         MVC   NEWID2(4,@03),@CC04387                              1903
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ISSUEXCP TO DO I/O                           @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1904
*       CALL ISSUEXCP;              /*                       @ZA11014*/
         BAL   @14,ISSUEXCP                                        1904
*       RESPECIFY                                                  1905
*         RTNREG RSTD;                                             1905
*       TESTRC=RTNREG;                                             1906
         STH   RTNREG,TESTRC                                       1906
*       RESPECIFY                                                  1907
*         RTNREG UNRSTD;            /*                       @ZA11014*/
*                                                                  1907
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS     */
*       /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW          */
*       /* ADDITIONAL I/O. SO WE CLEAR THEM HERE.            @ZA17169*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1908
*       IF TESTRC^=0 THEN           /*                       @ZA17169*/
         LH    @03,TESTRC                                          1908
         LTR   @03,@03                                             1908
         BZ    @RF01908                                            1908
*         DCBIFEC='00'B;            /*                       @ZA17169
*                                                            @ZA11014*/
*                                                                  1909
         L     @03,DCBPTR                                          1909
         NI    DCBIFEC+40(@03),B'00111111'                         1909
*       /*************************************************************/
*       /*                                                           */
*       /* IF GOOD DATA OVERFLOW CONDITION ON READ BACK      @ZA11014*/
*       /* VERIFY FOR A WRITE SPECIAL-THAN ALL OK            @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1910
*       IF EXRWFUN=RVWS&TESTRC=RCABOV/*                      @ZA11014*/
*         THEN                      /*                       @ZA11014*/
*                                                                  1910
@RF01908 L     @03,@PC00001+8                                      1910
         CLC   EXRWFUN(1,@03),RVWS                                 1910
         BNE   @RF01910                                            1910
         CLC   TESTRC(2),RCABOV                                    1910
         BNE   @RF01910                                            1910
*         /***********************************************************/
*         /*                                                         */
*         /* SET RETURN CODE TO OK                           @ZA11014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1911
*         TESTRC=0;                 /*                       @ZA11014
*                                                            @ZA11014*/
         SLR   @03,@03                                             1911
         STH   @03,TESTRC                                          1911
*       ELSE                                                       1912
*         ;                         /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1912
@RF01910 DS    0H                                                  1913
*       /*************************************************************/
*       /*                                                           */
*       /* END OF OK TO CONTINUE ELSE                        @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1913
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/
@RC01840 LH    @15,TESTRC                                          1914
         L     @14,@SA00029                                        1914
         LM    @00,@12,@SA00029+8                                  1914
         BR    @14                                                 1914
*   END WRITEREC;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1916
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - FWRITE                                 @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - BUILDS THE FOLLOWING CCW LIST TO WRITE A     @ZA11014*/
*/*              SPECIFIED NUMBER OF RECORDS ON A TRACK      @ZA11014*/
*/*              BEGINNING AT A SPECIFIED RECORD NUMBER      @ZA11014*/
*/*                                                          @ZA11014*/
*/*              FOR NON-R0 BEGINNING RECORD -               @ZA11014*/
*/*                 SET SECTOR ZERO                          @ZA11014*/
*/*                 SEARCH ID EQUAL                          @ZA11014*/
*/*                 TIC *-8                                  @ZA11014*/
*/*                 WRITE COUNT/KEY/DATA                     @ZA11014*/
*/*                     ^                                    @ZA11014*/
*/*                 WRITE COUNT/KEY/DATA                     @ZA11014*/
*/*                 SET SECTOR 0                             @ZA11014*/
*/*                 SEARCH ID EQUAL                          @ZA11014*/
*/*                 TIC *-8                                  @ZA11014*/
*/*                 READ COUNT/KEY/DATA                      @ZA11014*/
*/*                     ^                                    @ZA11014*/
*/*                 READ COUNT/KEY/DATA                      @ZA11014*/
*/*         NOTE - FOR R0 BEGINNING RECORD -                 @ZA11014*/
*/*                 SET SECTOR 0                             @ZA11014*/
*/*                 SEARCH ID EQ(R0)                         @ZA11014*/
*/*                 TIC *-8                                  @ZA11014*/
*/*                 WRITE KEY/DATA(R0)                       @ZA11014*/
*/*                 SET SECTOR 0                             @ZA11014*/
*/*                 SEARCH ID EQ                             @ZA11014*/
*/*                 TIC *-8                                  @ZA11014*/
*/*                 WRITE C/K/D                              @ZA11014*/
*/*                    .                                     @ZA11014*/
*/*                    .                                     @ZA11014*/
*/*                    .                                     @ZA11014*/
*/*                 WRITE C/K/D                              @ZA11014*/
*/*                 SET SECTOR 0                             @ZA11014*/
*/*                 READ 0                                   @ZA11014*/
*/*                 READ C/K/D                               @ZA11014*/
*/*                    .                                     @ZA11014*/
*/*                    .                                     @ZA11014*/
*/*                    .                                     @ZA11014*/
*/*                 READ C/K/D                               @ZA11014*/
*/*                FOR READ BACK VALIDATION IF REQUIRED,     @ZA11014*/
*/*                THE LAST RECORD WRITTEN WILL BE A WRITE   @ZA11014*/
*/*                SPECIAL COUNT/KEY/DATA                    @ZA11014*/
*/*             CALLS ISSUEXCP TO EXECUTE CCW CHAIN          @ZA11014*/
*/*             RETURNS                                      @ZA11014*/
*/*                                                          @ZA11014*/
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/
*/*          EXRWIOAR FROM EXWRARG                           @ZA11014*/
*/*          EXCC     FROM EXWRARG                           @ZA11014*/
*/*          EXHH     FROM EXWRARG                           @ZA11014*/
*/*          EXRECNUM FROM EXWRARG                           @ZA11014*/
*/*          EXRWFUN  FROM EXWRARG                           @ZA11014*/
*/*          WNUMREC  FROM WIOAREA                           @ZA11014*/
*/*          DATA IN WBUFF OF WIOAREA                        @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  1916
*                                   /*                       @ZA11014*/
*FWRITE:                                                           1916
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1916
FWRITE   STM   @14,@12,@SA00030                                    1916
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1917
*   OLDERID2=NEWERID2;                                             1917
         L     @03,@PC00001                                        1917
         L     @03,GDTTR2(,@03)                                    1917
         L     @15,@PC00001                                        1917
         L     @01,GDTTR2(,@15)                                    1917
         MVC   @TS00001(95),NEWERID2(@01)                          1917
         MVC   OLDERID2(95,@03),@TS00001                           1917
*   NEWID2='IOFW';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1918
         L     @03,@PC00001                                        1918
         L     @03,GDTTR2(,@03)                                    1918
         MVC   NEWID2(4,@03),@CC04391                              1918
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRABILITY TO IOXCTLBK AND WIOAREA            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1919
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1919
         L     @03,EXRWCTBL(,@03)                                  1919
         ST    @03,IOCTLBKP                                        1919
*   RWIOARPT=EXRWIOAR;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1920
         L     @03,EXRWIOAR(,@03)                                  1920
         ST    @03,RWIOARPT                                        1920
*   RESPECIFY                                                      1921
*     WBUF BASED(WRADDR);           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1921
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DCB AND IOB POINTERS                       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1922
*   DCBPTR=ADDR(IOXDCB);            /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        1922
         LA    @03,IOXDCB(,@03)                                    1922
         ST    @03,DCBPTR                                          1922
*   IOBSTPTR=ADDR(IOXIOB);          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1923
         L     @03,IOCTLBKP                                        1923
         LA    @03,IOXIOB(,@03)                                    1923
         ST    @03,IOBSTPTR                                        1923
*   /*****************************************************************/
*   /*                                                               */
*   /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE         @ZA11014*/
*   /* IOBSEEK CCHHR VALUE                                   @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1924
*   IOBCC=EXCC;                     /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1924
         L     @01,IOBSTPTR                                        1924
         MVC   IOBCC(2,@01),EXCC(@03)                              1924
*   IOBHH=EXHH;                     /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1925
         L     @01,IOBSTPTR                                        1925
         MVC   IOBHH(2,@01),EXHH(@03)                              1925
*   IOBR=EXRECNUM;                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1926
         L     @03,@PC00001+8                                      1926
         IC    @15,EXRECNUM(,@03)                                  1926
         L     @03,IOBSTPTR                                        1926
         STC   @15,IOBR(,@03)                                      1926
*   /*****************************************************************/
*   /*                                                               */
*   /* CALC START OF CCW CHAIN-AFTER LAST RD CNT             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1927
*   CCWCNT=NONRDCT+MAXRECS+1;       /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1927
         LH    @03,NONRDCT                                         1927
         AH    @03,MAXRECS                                         1927
         LA    @03,1(,@03)                                         1927
         STH   @03,CCWCNT                                          1927
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE START ADDR OF THE CCW CHN IN IOB       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1928
*   IOBSTART=ADDR(IOXCCW(CCWCNT));  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1928
         LH    @03,CCWCNT                                          1928
         SLA   @03,3                                               1928
         L     @01,IOCTLBKP                                        1928
         LA    @03,IOXCCW-8(@03,@01)                               1928
         L     @01,IOBSTPTR                                        1928
         ST    @03,IOBSTART(,@01)                                  1928
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FIRST CCW TO SET SECTOR ZERO - WANT TO            @ZA11014*/
*   /* START FROM BEGINNING OF TRACK SO THAT                 @ZA11014*/
*   /* ERRORS CAN BE FIXED SEQUENTIALLY ONE AT A TIME        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1929
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1929
         SLA   @03,3                                               1929
         L     @01,IOCTLBKP                                        1929
         LA    @03,IOXCCW-8(@03,@01)                               1929
         MVC   CCW(8,@03),CCWRSSEC                                 1929
*   CCWADDR=ADDR(ZERO);             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1930
         LH    @03,CCWCNT                                          1930
         SLA   @03,3                                               1930
         L     @01,IOCTLBKP                                        1930
         LA    @03,IOXCCW-8(@03,@01)                               1930
         LA    @15,ZERO                                            1930
         STCM  @15,7,CCWADDR(@03)                                  1930
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT CCW CHAIN INDEX                             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1931
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1931
         LH    @03,CCWCNT                                          1931
         LA    @03,1(,@03)                                         1931
         STH   @03,CCWCNT                                          1931
*   /*****************************************************************/
*   /*                                                               */
*   /* SET NEXT CCW TO SEARCH ID EQUAL-THEN DETERMINE        @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1932
*   CCW=CCWSIDEQ;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1932
         LH    @03,CCWCNT                                          1932
         SLA   @03,3                                               1932
         L     @01,IOCTLBKP                                        1932
         LA    @03,IOXCCW-8(@03,@01)                               1932
         MVC   CCW(8,@03),CCWSIDEQ                                 1932
*   /*****************************************************************/
*   /*                                                               */
*   /* SET SEARCH CYLINDER AND HEAD ADDRS                    @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1933
*   SRCHCC=EXCC;                    /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1933
         LH    @03,EXCC(,@03)                                      1933
         N     @03,@CF04424                                        1933
         STH   @03,SRCHCC                                          1933
*   SRCHHH=EXHH;                    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1934
         L     @03,@PC00001+8                                      1934
         LH    @03,EXHH(,@03)                                      1934
         N     @03,@CF04424                                        1934
         STH   @03,SRCHHH                                          1934
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT ADDR OF WHERE TO WRITE FROM                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1935
*   WRADDR=ADDR(WBUFF);             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1935
         L     @03,RWIOARPT                                        1935
         LA    @03,WBUFF(,@03)                                     1935
         ST    @03,WRADDR                                          1935
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF TO BEGIN AT RECORD ZERO               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1936
*   IF EXRECNUM^=ZERO               /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1936
         L     @03,@PC00001+8                                      1936
         SLR   @15,@15                                             1936
         IC    @15,EXRECNUM(,@03)                                  1936
         CH    @15,ZERO                                            1936
         BE    @RF01936                                            1936
*     /***************************************************************/
*     /*                                                             */
*     /* REQUEST IS TO BEGIN AFTER R0-                       @ZA11014*/
*     /* FIRST DETERMINE SEARCH RECORD NUMBER                @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1937
*     DO;                           /*                       @ZA11014*/
*                                                                  1937
*       /*************************************************************/
*       /*                                                           */
*       /* SEARCH REC IS FIRST PREVIOUS AVAILABLE            @ZA11014*/
*       /* CHECK LOCTAB BEGINNING IN ENTRY BEFORE            @ZA11014*/
*       /* REQUESTED REC (LOCTAB STARTS AT R0)               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1938
*       RCTR=EXRECNUM;              /*                       @ZA11014*/
         L     @03,@PC00001+8                                      1938
         SLR   @15,@15                                             1938
         IC    @15,EXRECNUM(,@03)                                  1938
         STH   @15,RCTR                                            1938
*       DO WHILE RCTR^=1&LOCADDR(RCTR)=NTFNDPTR;/*           @ZA11014*/
         B     @DE01939                                            1939
@DL01939 DS    0H                                                  1940
*         RCTR=RCTR-1;              /*                       @ZA11014*/
         LH    @03,RCTR                                            1940
         BCTR  @03,0                                               1940
         STH   @03,RCTR                                            1940
*       END;                        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1941
@DE01939 CLC   RCTR(2),@CH00222                                    1941
         BE    @DC01939                                            1941
         LH    @03,RCTR                                            1941
         MH    @03,@CH00279                                        1941
         L     @15,@PC00001+8                                      1941
         L     @01,EXLOCPTR(,@15)                                  1941
         AL    @01,@CF04425                                        1941
         L     @03,LOCADDR(@03,@01)                                1941
         ICM   @15,15,NTFNDPTR                                     1941
         CLR   @03,@15                                             1941
         BE    @DL01939                                            1941
@DC01939 DS    0H                                                  1942
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH REC NUM                                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1942
*       SRCHR=RCTR-1;               /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1942
         LH    @03,RCTR                                            1942
         BCTR  @03,0                                               1942
         STC   @03,SRCHR                                           1942
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH ADDR                                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1943
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1943
         LH    @03,CCWCNT                                          1943
         SLA   @03,3                                               1943
         L     @01,IOCTLBKP                                        1943
         LA    @03,IOXCCW-8(@03,@01)                               1943
         LA    @15,SRCHCHR                                         1943
         STCM  @15,7,CCWADDR(@03)                                  1943
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1944
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1944
         LH    @03,CCWCNT                                          1944
         LA    @03,1(,@03)                                         1944
         STH   @03,CCWCNT                                          1944
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1945
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1945
         SLA   @03,3                                               1945
         L     @01,IOCTLBKP                                        1945
         LA    @03,IOXCCW-8(@03,@01)                               1945
         MVC   CCW(8,@03),CCWTIC                                   1945
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1946
         LH    @03,CCWCNT                                          1946
         SLA   @03,3                                               1946
         L     @01,IOCTLBKP                                        1946
         LA    @03,IOXCCW-8(@03,@01)                               1946
         LH    @15,CCWCNT                                          1946
         SLA   @15,3                                               1946
         L     @01,IOCTLBKP                                        1946
         LA    @15,IOXCCW-16(@15,@01)                              1946
         STCM  @15,7,CCWADDR(@03)                                  1946
*       /*************************************************************/
*       /*                                                           */
*       /* CALC LAST WRITE CCW TO BUILD                      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1947
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1947
         LH    @03,CCWCNT                                          1947
         L     @01,RWIOARPT                                        1947
         AL    @03,WNUMREC(,@01)                                   1947
         STH   @03,LASTCCW                                         1947
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1948
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1948
         LH    @03,CCWCNT                                          1948
         LA    @03,1(,@03)                                         1948
         STH   @03,CCWCNT                                          1948
*       /*************************************************************/
*       /*                                                           */
*       /* END OF NON-R0 REQUEST                             @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1949
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*   ELSE                            /*                       @ZA11014*/
*                                                                  1950
*     /***************************************************************/
*     /*                                                             */
*     /* REQUEST FOR R0                                      @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1950
*     DO;                           /*                       @ZA11014*/
*                                                                  1950
         B     @RC01936                                            1950
@RF01936 DS    0H                                                  1951
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH RECORD NUM TO R0                       @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1951
*       SRCHR=EXRECNUM;             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1951
         L     @03,@PC00001+8                                      1951
         IC    @15,EXRECNUM(,@03)                                  1951
         STC   @15,SRCHR                                           1951
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH ADDR                                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1952
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1952
         LH    @03,CCWCNT                                          1952
         SLA   @03,3                                               1952
         L     @01,IOCTLBKP                                        1952
         LA    @03,IOXCCW-8(@03,@01)                               1952
         LA    @15,SRCHCHR                                         1952
         STCM  @15,7,CCWADDR(@03)                                  1952
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1953
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1953
         LH    @03,CCWCNT                                          1953
         LA    @03,1(,@03)                                         1953
         STH   @03,CCWCNT                                          1953
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1954
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1954
         SLA   @03,3                                               1954
         L     @01,IOCTLBKP                                        1954
         LA    @03,IOXCCW-8(@03,@01)                               1954
         MVC   CCW(8,@03),CCWTIC                                   1954
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1955
         LH    @03,CCWCNT                                          1955
         SLA   @03,3                                               1955
         L     @01,IOCTLBKP                                        1955
         LA    @03,IOXCCW-8(@03,@01)                               1955
         LH    @15,CCWCNT                                          1955
         SLA   @15,3                                               1955
         L     @01,IOCTLBKP                                        1955
         LA    @15,IOXCCW-16(@15,@01)                              1955
         STCM  @15,7,CCWADDR(@03)                                  1955
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1956
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1956
         LH    @03,CCWCNT                                          1956
         LA    @03,1(,@03)                                         1956
         STH   @03,CCWCNT                                          1956
*       /*************************************************************/
*       /*                                                           */
*       /* SET FIRST WRITE CCW TO WRITE KEY/DATA ONLY        @ZA11014*/
*       /* DONT WANT TO WRITE R0 COUNT FIELD                 @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1957
*       CCW=CCWRWKD;                /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1957
         SLA   @03,3                                               1957
         L     @01,IOCTLBKP                                        1957
         LA    @03,IOXCCW-8(@03,@01)                               1957
         MVC   CCW(8,@03),CCWRWKD                                  1957
*       CCWADDR=WRADDR;             /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1958
         SLA   @03,3                                               1958
         L     @01,IOCTLBKP                                        1958
         LA    @03,IOXCCW-8(@03,@01)                               1958
         MVC   CCWADDR(3,@03),WRADDR+1                             1958
*       CCWDATLN=LENR0D;            /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1959
         SLA   @03,3                                               1959
         L     @01,IOCTLBKP                                        1959
         LA    @03,IOXCCW-8(@03,@01)                               1959
         LH    @15,LENR0D                                          1959
         STH   @15,CCWDATLN(,@03)                                  1959
*       WRADDR=WRADDR+LENR0;        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1960
         LH    @03,LENR0                                           1960
         AL    @03,WRADDR                                          1960
         ST    @03,WRADDR                                          1960
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1961
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014*/
*                                                                  1961
         LH    @03,CCWCNT                                          1961
         LA    @03,1(,@03)                                         1961
         STH   @03,CCWCNT                                          1961
*       /*************************************************************/
*       /*                                                           */
*       /* SET ANOTHER SET SECTION, SID AND TIC              @ZA11014*/
*       /* BECAUSE A WRITE COUNT/KEY DATA CANNOT FOLLOW      @ZA11014*/
*       /* A WRITE DATA IN THE CCW STRING                    @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1962
*       CCW=CCWRSSEC;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1962
         SLA   @03,3                                               1962
         L     @01,IOCTLBKP                                        1962
         LA    @03,IOXCCW-8(@03,@01)                               1962
         MVC   CCW(8,@03),CCWRSSEC                                 1962
*       CCWADDR=ADDR(ZERO);         /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1963
         LH    @03,CCWCNT                                          1963
         SLA   @03,3                                               1963
         L     @01,IOCTLBKP                                        1963
         LA    @03,IOXCCW-8(@03,@01)                               1963
         LA    @15,ZERO                                            1963
         STCM  @15,7,CCWADDR(@03)                                  1963
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1964
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1964
         LH    @03,CCWCNT                                          1964
         LA    @03,1(,@03)                                         1964
         STH   @03,CCWCNT                                          1964
*       /*************************************************************/
*       /*                                                           */
*       /* SET SEARCH ID EQUAL ON R0                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1965
*       CCW=CCWSIDEQ;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1965
         SLA   @03,3                                               1965
         L     @01,IOCTLBKP                                        1965
         LA    @03,IOXCCW-8(@03,@01)                               1965
         MVC   CCW(8,@03),CCWSIDEQ                                 1965
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1966
         LH    @03,CCWCNT                                          1966
         SLA   @03,3                                               1966
         L     @01,IOCTLBKP                                        1966
         LA    @03,IOXCCW-8(@03,@01)                               1966
         LA    @15,SRCHCHR                                         1966
         STCM  @15,7,CCWADDR(@03)                                  1966
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1967
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1967
         LH    @03,CCWCNT                                          1967
         LA    @03,1(,@03)                                         1967
         STH   @03,CCWCNT                                          1967
*       /*************************************************************/
*       /*                                                           */
*       /* TIC BACK TO SID                                   @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1968
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1968
         SLA   @03,3                                               1968
         L     @01,IOCTLBKP                                        1968
         LA    @03,IOXCCW-8(@03,@01)                               1968
         MVC   CCW(8,@03),CCWTIC                                   1968
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1969
         LH    @03,CCWCNT                                          1969
         SLA   @03,3                                               1969
         L     @01,IOCTLBKP                                        1969
         LA    @03,IOXCCW-8(@03,@01)                               1969
         LH    @15,CCWCNT                                          1969
         SLA   @15,3                                               1969
         L     @01,IOCTLBKP                                        1969
         LA    @15,IOXCCW-16(@15,@01)                              1969
         STCM  @15,7,CCWADDR(@03)                                  1969
*       /*************************************************************/
*       /*                                                           */
*       /* CALC LAST WRITE CCW TO BUILD                      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1970
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1970
         LH    @03,CCWCNT                                          1970
         L     @01,RWIOARPT                                        1970
         AL    @03,WNUMREC(,@01)                                   1970
         STH   @03,LASTCCW                                         1970
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1971
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1971
         LH    @03,CCWCNT                                          1971
         LA    @03,1(,@03)                                         1971
         STH   @03,CCWCNT                                          1971
*       /*************************************************************/
*       /*                                                           */
*       /* END R0-REQUEST                                    @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1972
*     END;                          /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  1972
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE COUNT/KEY/DATA FOR ALL BUT LAST RE@ZA11014    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1973
*   DO CCWCNT=CCWCNT TO(LASTCCW-1); /*                       @ZA11014*/
@RC01936 LH    @03,CCWCNT                                          1973
         B     @DE01973                                            1973
@DL01973 DS    0H                                                  1974
*     CCW=CCWRWCKD;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1974
         SLA   @03,3                                               1974
         L     @01,IOCTLBKP                                        1974
         LA    @03,IOXCCW-8(@03,@01)                               1974
         MVC   CCW(8,@03),CCWRWCKD                                 1974
*     CCWADDR=WRADDR;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1975
         SLA   @03,3                                               1975
         L     @01,IOCTLBKP                                        1975
         LA    @03,IOXCCW-8(@03,@01)                               1975
         MVC   CCWADDR(3,@03),WRADDR+1                             1975
*     CCWDATLN=WBKL+WBDL+LENCNT;    /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1976
         LH    @03,CCWCNT                                          1976
         SLA   @03,3                                               1976
         L     @01,IOCTLBKP                                        1976
         LA    @03,IOXCCW-8(@03,@01)                               1976
         L     @01,WRADDR                                          1976
         SLR   @00,@00                                             1976
         IC    @00,WBKL(,@01)                                      1976
         L     @01,WRADDR                                          1976
         AH    @00,WBDL(,@01)                                      1976
         AH    @00,LENCNT                                          1976
         STH   @00,CCWDATLN(,@03)                                  1976
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT TO NEXT LOC IN BUFFER                     @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1977
*     WRADDR=WRADDR+CCWDATLN;       /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1977
         SLA   @03,3                                               1977
         L     @01,IOCTLBKP                                        1977
         LA    @03,IOXCCW-8(@03,@01)                               1977
         LH    @03,CCWDATLN(,@03)                                  1977
         AL    @03,WRADDR                                          1977
         ST    @03,WRADDR                                          1977
*   END;                            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1978
         LA    @03,1                                               1978
         AH    @03,CCWCNT                                          1978
         STH   @03,CCWCNT                                          1978
@DE01973 LH    @15,LASTCCW                                         1978
         BCTR  @15,0                                               1978
         CR    @03,@15                                             1978
         BNH   @DL01973                                            1978
*   /*****************************************************************/
*   /*                                                               */
*   /* CCWCNT IS NOW POINTING TO LAST CCW TO BUILD           @ZA11014*/
*   /* CHECK TO SEE IF IT SHOULD BE A WR C/K/D OR WR SPEC@ZA11014    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1979
*   IF EXRWFUN=RVWS                 /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1979
         L     @03,@PC00001+8                                      1979
         CLC   EXRWFUN(1,@03),RVWS                                 1979
         BNE   @RF01979                                            1979
*     /***************************************************************/
*     /*                                                             */
*     /* WRITE SPECIAL ON LAST WRITE                         @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1980
*     CCW=CCWRWSP;                  /*                       @ZA11014
*                                                            @ZA11014*/
         LH    @03,CCWCNT                                          1980
         SLA   @03,3                                               1980
         L     @01,IOCTLBKP                                        1980
         LA    @03,IOXCCW-8(@03,@01)                               1980
         MVC   CCW(8,@03),CCWRWSP                                  1980
*   ELSE                            /*                       @ZA11014*/
*                                                                  1981
*     /***************************************************************/
*     /*                                                             */
*     /* WRITE COUNT/KEY/DATA ON LAST WRITE                  @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1981
*     CCW=CCWRWCKD;                 /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1981
         B     @RC01979                                            1981
@RF01979 LH    @03,CCWCNT                                          1981
         SLA   @03,3                                               1981
         L     @01,IOCTLBKP                                        1981
         LA    @03,IOXCCW-8(@03,@01)                               1981
         MVC   CCW(8,@03),CCWRWCKD                                 1981
*   /*****************************************************************/
*   /*                                                               */
*   /* SET REST OF INFO IN CCW                               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1982
*   CCWADDR=WRADDR;                 /*                       @ZA11014*/
@RC01979 LH    @03,CCWCNT                                          1982
         SLA   @03,3                                               1982
         L     @01,IOCTLBKP                                        1982
         LA    @03,IOXCCW-8(@03,@01)                               1982
         MVC   CCWADDR(3,@03),WRADDR+1                             1982
*   CCWDATLN=WBKL+WBDL+LENCNT;      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1983
         LH    @03,CCWCNT                                          1983
         SLA   @03,3                                               1983
         L     @01,IOCTLBKP                                        1983
         LA    @03,IOXCCW-8(@03,@01)                               1983
         L     @01,WRADDR                                          1983
         SLR   @00,@00                                             1983
         IC    @00,WBKL(,@01)                                      1983
         L     @01,WRADDR                                          1983
         AH    @00,WBDL(,@01)                                      1983
         AH    @00,LENCNT                                          1983
         STH   @00,CCWDATLN(,@03)                                  1983
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT CCW CHAIN INDEX                             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1984
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1984
         LH    @03,CCWCNT                                          1984
         LA    @03,1(,@03)                                         1984
         STH   @03,CCWCNT                                          1984
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD CCW LIST TO READ BACK WHAT WAS WRITTEN          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1985
*                                   /*                       @ZA11014*/
*                                                                  1985
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET DATA POINTER TO BEGINNING OF BUFFER             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1985
*   WRADDR=ADDR(WBUFF);             /*                       @ZA11014
*                                                            @ZA11014*/
         L     @03,RWIOARPT                                        1985
         LA    @03,WBUFF(,@03)                                     1985
         ST    @03,WRADDR                                          1985
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1986
         SLA   @03,3                                               1986
         L     @01,IOCTLBKP                                        1986
         LA    @03,IOXCCW-8(@03,@01)                               1986
         MVC   CCW(8,@03),CCWRSSEC                                 1986
*   CCWADDR=ADDR(ZEROS);            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1987
         LH    @03,CCWCNT                                          1987
         SLA   @03,3                                               1987
         L     @01,IOCTLBKP                                        1987
         LA    @03,IOXCCW-8(@03,@01)                               1987
         LA    @15,ZEROS                                           1987
         STCM  @15,7,CCWADDR(@03)                                  1987
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT CCW CHAIN INDEX                             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1988
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1988
         LH    @03,CCWCNT                                          1988
         LA    @03,1(,@03)                                         1988
         STH   @03,CCWCNT                                          1988
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROCESSING RECORD ZERO                       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1989
*   IF EXRECNUM^=ZERO               /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  1989
         L     @03,@PC00001+8                                      1989
         SLR   @15,@15                                             1989
         IC    @15,EXRECNUM(,@03)                                  1989
         CH    @15,ZERO                                            1989
         BE    @RF01989                                            1989
*     /***************************************************************/
*     /*                                                             */
*     /* NOT R0-SEARCH ID AS IN WRITE                        @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1990
*     DO;                           /*                       @ZA11014*/
*       CCW=CCWSIDEQ;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1991
         SLA   @03,3                                               1991
         L     @01,IOCTLBKP                                        1991
         LA    @03,IOXCCW-8(@03,@01)                               1991
         MVC   CCW(8,@03),CCWSIDEQ                                 1991
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1992
         LH    @03,CCWCNT                                          1992
         SLA   @03,3                                               1992
         L     @01,IOCTLBKP                                        1992
         LA    @03,IOXCCW-8(@03,@01)                               1992
         LA    @15,SRCHCHR                                         1992
         STCM  @15,7,CCWADDR(@03)                                  1992
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1993
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1993
         LH    @03,CCWCNT                                          1993
         LA    @03,1(,@03)                                         1993
         STH   @03,CCWCNT                                          1993
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1994
*       CCW=CCWTIC;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          1994
         SLA   @03,3                                               1994
         L     @01,IOCTLBKP                                        1994
         LA    @03,IOXCCW-8(@03,@01)                               1994
         MVC   CCW(8,@03),CCWTIC                                   1994
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014
*                                                            @ZA11014*/
*                                                                  1995
         LH    @03,CCWCNT                                          1995
         SLA   @03,3                                               1995
         L     @01,IOCTLBKP                                        1995
         LA    @03,IOXCCW-8(@03,@01)                               1995
         LH    @15,CCWCNT                                          1995
         SLA   @15,3                                               1995
         L     @01,IOCTLBKP                                        1995
         LA    @15,IOXCCW-16(@15,@01)                              1995
         STCM  @15,7,CCWADDR(@03)                                  1995
*       /*************************************************************/
*       /*                                                           */
*       /* CALC LAST CCW TO BUILD                            @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1996
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1996
         LH    @03,CCWCNT                                          1996
         L     @01,RWIOARPT                                        1996
         AL    @03,WNUMREC(,@01)                                   1996
         STH   @03,LASTCCW                                         1996
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1997
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1997
         LH    @03,CCWCNT                                          1997
         LA    @03,1(,@03)                                         1997
         STH   @03,CCWCNT                                          1997
*       /*************************************************************/
*       /*                                                           */
*       /* END NOT-R0                                        @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1998
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*   ELSE                            /*                       @ZA11014*/
*                                                                  1999
*     /***************************************************************/
*     /*                                                             */
*     /* R0 REQUEST-READ R0 INSTEAD OF SEARCHING             @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1999
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  1999
         B     @RC01989                                            1999
@RF01989 DS    0H                                                  2000
*       /*************************************************************/
*       /*                                                           */
*       /* CALC LAST CCW TO BUILD                            @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2000
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2000
         LH    @03,CCWCNT                                          2000
         L     @01,RWIOARPT                                        2000
         AL    @03,WNUMREC(,@01)                                   2000
         STH   @03,LASTCCW                                         2000
*       /*************************************************************/
*       /*                                                           */
*       /* SET CCW TO READ R0                                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2001
*       CCW=CCWRRR0;                /*                       @ZA11014*/
         LH    @03,CCWCNT                                          2001
         SLA   @03,3                                               2001
         L     @01,IOCTLBKP                                        2001
         LA    @03,IOXCCW-8(@03,@01)                               2001
         MVC   CCW(8,@03),CCWRRR0                                  2001
*       CCWADDR=WRADDR;             /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2002
         LH    @03,CCWCNT                                          2002
         SLA   @03,3                                               2002
         L     @01,IOCTLBKP                                        2002
         LA    @03,IOXCCW-8(@03,@01)                               2002
         MVC   CCWADDR(3,@03),WRADDR+1                             2002
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT BUFFER POINTER                          @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2003
*       WRADDR=WRADDR+LENR0;        /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2003
         LH    @03,LENR0                                           2003
         AL    @03,WRADDR                                          2003
         ST    @03,WRADDR                                          2003
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2004
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2004
         LH    @03,CCWCNT                                          2004
         LA    @03,1(,@03)                                         2004
         STH   @03,CCWCNT                                          2004
*       /*************************************************************/
*       /*                                                           */
*       /* END R0 REQUEST                                    @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2005
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2005
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD READ BACK CCWS                                  @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2006
*   DO CCWCNT=CCWCNT TO LASTCCW;    /*                       @ZA11014*/
@RC01989 LH    @03,CCWCNT                                          2006
         B     @DE02006                                            2006
@DL02006 DS    0H                                                  2007
*     CCW=CCWRRCKD;                 /*                       @ZA11014*/
         LH    @03,CCWCNT                                          2007
         SLA   @03,3                                               2007
         L     @01,IOCTLBKP                                        2007
         LA    @03,IOXCCW-8(@03,@01)                               2007
         MVC   CCW(8,@03),CCWRRCKD                                 2007
*     CCWADDR=WRADDR;               /*                       @ZA11014*/
         LH    @03,CCWCNT                                          2008
         SLA   @03,3                                               2008
         L     @01,IOCTLBKP                                        2008
         LA    @03,IOXCCW-8(@03,@01)                               2008
         MVC   CCWADDR(3,@03),WRADDR+1                             2008
*     CCWDATLN=WBKL+WBDL+LENCNT;    /*                       @ZA11014*/
         LH    @03,CCWCNT                                          2009
         SLA   @03,3                                               2009
         L     @01,IOCTLBKP                                        2009
         LA    @03,IOXCCW-8(@03,@01)                               2009
         L     @01,WRADDR                                          2009
         SLR   @00,@00                                             2009
         IC    @00,WBKL(,@01)                                      2009
         L     @01,WRADDR                                          2009
         AH    @00,WBDL(,@01)                                      2009
         AH    @00,LENCNT                                          2009
         STH   @00,CCWDATLN(,@03)                                  2009
*     CCWCMDCH=ON;                  /*                       @ZA11014*/
*     CCWSUPP=OFF;                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2011
         LH    @03,CCWCNT                                          2011
         SLA   @03,3                                               2011
         L     @01,IOCTLBKP                                        2011
         LA    @03,IOXCCW-8(@03,@01)                               2011
         OI    CCWCMDCH(@03),B'01000000'                           2011
         NI    CCWSUPP(@03),B'11101111'                            2011
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT TO NEXT LOC IN BUFFER                     @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  2012
*     WRADDR=WRADDR+CCWDATLN;       /*                       @ZA11014*/
         LH    @03,CCWCNT                                          2012
         SLA   @03,3                                               2012
         L     @01,IOCTLBKP                                        2012
         LA    @03,IOXCCW-8(@03,@01)                               2012
         LH    @03,CCWDATLN(,@03)                                  2012
         AL    @03,WRADDR                                          2012
         ST    @03,WRADDR                                          2012
*   END;                            /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2013
         LA    @03,1                                               2013
         AH    @03,CCWCNT                                          2013
         STH   @03,CCWCNT                                          2013
@DE02006 CH    @03,LASTCCW                                         2013
         BNH   @DL02006                                            2013
*   /*****************************************************************/
*   /*                                                               */
*   /* FINISHED BUILDING-TURN CHAINING OFF IN LAST CCW       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2014
*   CCWCNT=CCWCNT-1;                /*                       @ZA11014*/
         LH    @03,CCWCNT                                          2014
         BCTR  @03,0                                               2014
         STH   @03,CCWCNT                                          2014
*   CCWCMDCH=OFF;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2015
         LH    @03,CCWCNT                                          2015
         SLA   @03,3                                               2015
         L     @01,IOCTLBKP                                        2015
         LA    @03,IOXCCW-8(@03,@01)                               2015
         NI    CCWCMDCH(@03),B'10111111'                           2015
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID BEFORE CALLING UEXCP                     @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2016
*   OLDERID2=NEWERID2;                                             2016
         L     @03,@PC00001                                        2016
         L     @03,GDTTR2(,@03)                                    2016
         L     @15,@PC00001                                        2016
         L     @01,GDTTR2(,@15)                                    2016
         MVC   @TS00001(95),NEWERID2(@01)                          2016
         MVC   OLDERID2(95,@03),@TS00001                           2016
*   NEWID2='IOFB';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2017
         L     @03,@PC00001                                        2017
         L     @03,GDTTR2(,@03)                                    2017
         MVC   NEWID2(4,@03),@CC04393                              2017
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ISSUEXCP TO DO I/O                               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2018
*   CALL ISSUEXCP;                  /*                       @ZA11014*/
         BAL   @14,ISSUEXCP                                        2018
*   RESPECIFY                                                      2019
*     RTNREG RSTD;                                                 2019
*   TESTRC=RTNREG;                                                 2020
         STH   RTNREG,TESTRC                                       2020
*   RESPECIFY                                                      2021
*     RTNREG UNRSTD;                /*                       @ZA11014*/
*                                                                  2021
*   /*****************************************************************/
*   /*                                                               */
*   /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS         */
*   /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW ADDITIONAL   */
*   /* I/O. SO WE CLEAR THEM HERE.                           @ZA17169*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2022
*   IF TESTRC^=0 THEN               /*                       @ZA17169*/
         LH    @03,TESTRC                                          2022
         LTR   @03,@03                                             2022
         BZ    @RF02022                                            2022
*     DCBIFEC='00'B;                /*                       @ZA17169
*                                                            @ZA11014*/
*                                                                  2023
         L     @03,DCBPTR                                          2023
         NI    DCBIFEC+40(@03),B'00111111'                         2023
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GOOD DATA OVERFLOW CONDITION ON READ BACK          @ZA11014*/
*   /* VERIFY FOR A WRITE SPECIAL-THAN ALL OK                @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2024
*   IF EXRWFUN=RVWS&TESTRC=RCABOV   /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
*                                                                  2024
@RF02022 L     @03,@PC00001+8                                      2024
         CLC   EXRWFUN(1,@03),RVWS                                 2024
         BNE   @RF02024                                            2024
         CLC   TESTRC(2),RCABOV                                    2024
         BNE   @RF02024                                            2024
*     /***************************************************************/
*     /*                                                             */
*     /* SET RETURN CODE TO OK                               @ZA11014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  2025
*     TESTRC=0;                     /*                       @ZA11014
*                                                            @ZA11014*/
         SLR   @03,@03                                             2025
         STH   @03,TESTRC                                          2025
*   ELSE                                                           2026
*     ;                             /*                       @ZA11014
*                                                            @ZA11014*/
@RF02024 DS    0H                                                  2027
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/
         LH    @15,TESTRC                                          2027
         L     @14,@SA00030                                        2027
         LM    @00,@12,@SA00030+8                                  2027
         BR    @14                                                 2027
*   END FWRITE;                     /*                       @ZA11014*/
*                                   /*                       @ZA11014*/
*/***********************************************************@ZA11014*/
*/*                                                          @ZA11014*/
*/*  PROCEDURE NAME - OPNVTH                                 @ZA11014*/
*/*                                                          @ZA11014*/
*/*  FUNCTION - OPNVTH WILL DO A PSEUDO OPEN (SVC 82)        @ZA11014*/
*/*              TO ENABLE REPAIRV PROCESSING ON A BAD       @ZA11014*/
*/*              FORMAT 4 DSCB                               @ZA11014*/
*/*          IT WILL LOAD THE ABNORMAL END APPENDAGE         @ZA11014*/
*/*           FOR REPAIRV (IGG019A3) AND PLACE ITS           @ZA11014*/
*/*           ADDRESS IN THE DEB                             @ZA11014*/
*/*          THE FILE MASK WILL BE SET TO INHIBIT HEAD       @ZA11014*/
*/*           SWITCHING                                      @ZA11014*/
*/*          THE DEB EXTENT WILL BE MODIFIED TO RESTRICT     @ZA11014*/
*/*           ACCESS ONLY TO THE TRACK THAT CONTAINS         @ZA11014*/
*/*           THE FORMAT 4 DSCB                              @ZA11014*/
*/*                                                          @ZA11014*/
*/*  INPUT - EXOREP FROM EXOARG                              @ZA11014*/
*/*          EXOVTH FROM EXOARG                              @ZA11014*/
*/*          EXOREAD FROM EXOARG                             @ZA11014*/
*/*          EXOUCB FROM EXOARG                              @ZA11014*/
*/*          EXOEXT FROM EXOARG                              @ZA11014*/
*/*                                                          @ZA11014*/
*/*  OUTPUT - EXOCTLBK IN EXOARG                             @ZA11014*/
*/*           EXOEXT   IN EXOARG                             @ZA11014*/
*/*           JFCBDSNM IN IOXJFCB                            @ZA11014*/
*/*           JFCNWRIT IN IOXJFCB                            @ZA11014*/
*/*           DCBOFLWR IN IOXDCB                             @ZA11014*/
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/
*/*                                                          @ZA11014*/
*/*                                                          @ZA11014*/
*/***********************************************************@ZA11014*/
*                                                                  2029
*OPNVTH:                                                           2029
*   PROC;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2029
OPNVTH   STM   @14,@12,@SA00031                                    2029
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE ID                                          @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2030
*   OLDERID2=NEWERID2;                                             2030
         L     @03,@PC00001                                        2030
         L     @03,GDTTR2(,@03)                                    2030
         L     @15,@PC00001                                        2030
         L     @01,GDTTR2(,@15)                                    2030
         MVC   @TS00001(95),NEWERID2(@01)                          2030
         MVC   OLDERID2(95,@03),@TS00001                           2030
*   NEWID2='IOVH';                  /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2031
         L     @03,@PC00001                                        2031
         L     @03,GDTTR2(,@03)                                    2031
         MVC   NEWID2(4,@03),@CC04397                              2031
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SVC82 PARAMETER LIST                       @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2032
*   SV82LIST=''B;                   /*                       @ZA11014*/
         LA    @03,SVC82ARG                                        2032
         XC    SV82LIST(16,@03),SV82LIST(@03)                      2032
*   SV82CODE=SVC82OPN;              /*                       @ZA11014*/
         LA    @03,SVC82ARG                                        2033
         MVC   SV82CODE(1,@03),SVC82OPN                            2033
*   SV82UCBP=EXOUCB;                /*                       @ZA11014*/
         LA    @03,SVC82ARG                                        2034
         L     @15,@PC00001+8                                      2034
         MVC   SV82UCBP(3,@03),EXOUCB+1(@15)                       2034
*   SV82DCBP=ADDR(IOXDCB);          /*                       @ZA11014*/
*                                                                  2035
         LA    @03,SVC82ARG                                        2035
         L     @01,IOCTLBKP                                        2035
         LA    @15,IOXDCB(,@01)                                    2035
         ST    @15,SV82DCBP(,@03)                                  2035
*   /*****************************************************************/
*   /*                                                               */
*   /* THE DCBOFLWR FLAG IS SET OFF JUST IN CASE             @ZA11014*/
*   /* THE DCB IS CLOSED BY TERMINATION MANAGEMENT           @ZA11014*/
*   /* FOR SOME REASON LIKE TIME OUT ABEND.                  @ZA11014*/
*   /* THIS WILL KEEP THE CLOSE SVC FROM TRYING              @ZA11014*/
*   /* TO WRITE AN END-OF-FILE MARK.                         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2036
*   DCBOFLWR=OFF;                   /*                       @ZA11014*/
         L     @03,DCBPTR                                          2036
         NI    DCBOFLWR+40(@03),B'01111111'                        2036
*   RESPECIFY                                                      2037
*     REG1 RESTRICTED;              /*                       @ZA11014*/
*   REG1=ADDR(SV82LIST);            /*                       @ZA11014*/
         LA    REG1,SVC82ARG                                       2038
*                                                                  2039
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THE SVC 82 (DASDR) IS ISSUED TO                   @ZA11014*/
*   /* PERFORM A PSEUDO OPEN WHICH BUILDS                    @ZA11014*/
*   /* THE DEB, CHAINS IT TO THE TCB DEB CHAIN,              @ZA11014*/
*   /* AND INSERTS THE DEB INTO THE SYSTEM                   @ZA11014*/
*   /* DEB TABLE.                                            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2039
*LRV82SVC:                                                         2039
*   SVC(82);                        /*                       @ZA11014*/
*                                                                  2039
LRV82SVC SVC   82                                                  2039
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED                                   @ZA11014*/
*   /* WITH A RETURN CODE ZERO AS CURRENTLY                  @ZA11014*/
*   /* THERE A NO POSSIBLE ERRORS WHICH WILL                 @ZA11014*/
*   /* NOT ABEND THE TASK.                                   @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2040
*                                   /*                       @ZA11014*/
*                                                                  2040
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE LOAD IS DONE FOR THE ABNORM END APPENDAGER@ZA11014   */
*   /* REGISTER 1 IS ALREADY RESTRICTED                      @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2040
*   RESPECIFY                                                      2040
*    (REG0,                                                        2040
*     REG4) RESTRICTED;             /*                       @ZA11014
*                                                            @ZA11014*/
*LRVLOAD:                                                          2041
*   GEN(LOAD EP=IGG019A4);          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2041
LRVLOAD  LOAD EP=IGG019A4
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTER 0 HAS ENTRY POINT ADDRESS                    @ZA11014*/
*   /* REGISTER 1 HAS MODULE SIZE                            @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2042
*                                   /*                       @ZA11014*/
*   RESPECIFY                                                      2042
*     REG4 UNRSTD;                  /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  2042
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO CONTROL BLOCKS               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2043
*   DCBPTR=ADDR(IOXDCB);            /*                       @ZA11014*/
         L     @03,IOCTLBKP                                        2043
         LA    @03,IOXDCB(,@03)                                    2043
         ST    @03,DCBPTR                                          2043
*   DEBPTR=DCBDEBAD;                /*                       @ZA11014*/
         L     @03,DCBPTR                                          2044
         L     @03,DCBDEBAD+40(,@03)                               2044
         ST    @03,DEBPTR                                          2044
*   DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);/*              @ZA11014*/
         LA    @03,32                                              2045
         AL    @03,DEBPTR                                          2045
         ST    @03,DEBDAPTR                                        2045
*   IOBSTPTR=ADDR(IOXIOB);          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2046
         L     @03,IOCTLBKP                                        2046
         LA    @03,IOXIOB(,@03)                                    2046
         ST    @03,IOBSTPTR                                        2046
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IOB SEEK TEMP AREA                         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2047
*   IOBSEEK=''B;                    /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  2047
         L     @03,IOBSTPTR                                        2047
         XC    IOBSEEK(8,@03),IOBSEEK(@03)                         2047
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MODESET TO GET INTO KEY ZERO                    @ZA11014*/
*   /* SO THAT DEB CAN BE MODIFIED                           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2048
*                                   /*                       @ZA11014*/
*                                                                  2048
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE MODULE SIZE BEFORE ISSUING MODESET               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2048
*   MODSIZE=REG1;                   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2048
         ST    REG1,MODSIZE                                        2048
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MODESET                                         @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2049
*   MODEPARM=''B;                   /*                       @ZA11014*/
         XC    MODEPARM(4),MODEPARM                                2049
*   MODEPARM=MOD1;                  /*                       @ZA11014*/
         L     @03,MOD1                                            2050
         ST    @03,MODEPARM                                        2050
*   RESPECIFY                                                      2051
*    (REG1,                                                        2051
*     REG3) RSTD;                   /*                       @ZA11014*/
*   REG3=MODEPARM;                  /*                       @ZA11014*/
         L     REG3,MODEPARM                                       2052
*LRVMODE3:                                                         2053
*   DO;                             /* MODESET MF(E,REG3)            */
LRVMODE3 DS    0H                                                  2054
*     RESPECIFY                                                    2054
*       GPR01F RESTRICTED;                                         2054
*     GPR01F=REG3;                  /* MODESET PARMLIST              */
         LR    GPR01F,REG3                                         2055
*     SVC(107);                     /* ISSUE MODESET SVC             */
         SVC   107                                                 2056
*     RESPECIFY                                                    2057
*      (GPR01F) UNRESTRICTED;                                      2057
*   END;                            /* MODESET MF(E,REG3)    @ZA11014*/
*                                                                  2058
*   /*****************************************************************/
*   /*                                                               */
*   /* DEBAPPAD IS CURRENTLY POINTING TO LOW CORE AS         @ZA11014*/
*   /* A RESULT OF THE SVC 82 - MOVE THAT INFO               @ZA11014*/
*   /* INTO THE CURRENT DEB AND RESET DEBAPPAD               @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2059
*   SAVEAVT=DEBAPPAD;               /*                       @ZA11014*/
         L     @15,DEBPTR                                          2059
         L     @15,DEBAPPAD(,@15)                                  2059
         ST    @15,SAVEAVT                                         2059
*   DEBAPPAD=DEBPTR-(LENGTH(DEBAVT)+/*                       @ZA11014*/
*       LENGTH(DEBPREFX));          /*                       @ZA11014*/
         L     @15,DEBPTR                                          2060
         SL    @15,@CF03001                                        2060
         L     @14,DEBPTR                                          2060
         ST    @15,DEBAPPAD(,@14)                                  2060
*   DEBAVT=SAVEAVT->DEBAVT;         /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2061
         L     @15,DEBPTR                                          2061
         L     @15,DEBAPPAD(,@15)                                  2061
         L     @14,SAVEAVT                                         2061
         MVC   DEBAVT(20,@15),DEBAVT(@14)                          2061
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESS OF AB END APPEN INTO DEB                  @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2062
*   DEBXCEAD=REG0;                  /*                       @ZA11014*/
*                                                                  2062
         L     @15,DEBPTR                                          2062
         L     @15,DEBAPPAD(,@15)                                  2062
         STCM  REG0,7,DEBXCEAD(@15)                                2062
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE SIZE OF MODULE IN 2K BYTES - ENSURING       @ZA11014*/
*   /* POSSIBLILITY OF MODULE CROSSING 2K BOUNDARY           @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2063
*   SLL(REG0,21);                   /*                       @ZA11014*/
         SLL   REG0,21                                             2063
*   SRL(REG0,21);                   /*                       @ZA11014*/
         SRL   REG0,21                                             2064
*   REG0=MODSIZE+REG0-1;            /*                       @ZA11014*/
         LR    @15,REG0                                            2065
         AL    @15,MODSIZE                                         2065
         BCTR  @15,0                                               2065
         LR    REG0,@15                                            2065
*   SRL(REG0,11);                   /*                       @ZA11014*/
         SRL   REG0,11                                             2066
*   REG0=REG0+1;                    /*                       @ZA11014*/
         AL    REG0,@CF00222                                       2067
*   DEBXCEAB=REG0;                  /*                       @ZA11014
*                                                            @ZA11014*/
         L     @15,DEBPTR                                          2068
         L     @15,DEBAPPAD(,@15)                                  2068
         STC   REG0,DEBXCEAB(,@15)                                 2068
*   RESPECIFY                                                      2069
*     REG0 UNRSTD;                  /*                       @ZA11014*/
*                                                                  2069
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VTOC HEADER REQUEST THEN CALC CCHHR OF VTOC HDR    @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2070
*   IF EXOVTH=ON                    /*                       @ZA11014*/
*     THEN                          /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2070
         TM    EXOVTH(@15),B'00000001'                             2070
         BNO   @RF02070                                            2070
*     DO;                           /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2071
*       /*************************************************************/
*       /*                                                           */
*       /* CALC CCHHR OF VTOC HEADER FROM THE TTR IN THE     @ZA11014*/
*       /* UCB                                               @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2072
*       UCBPTR=EXOUCB;              /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2072
         L     @00,EXOUCB(,@15)                                    2072
         ST    @00,UCBPTR                                          2072
*       BEGHHLOC=BEGHH;             /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2073
         L     @15,EXOEXT(,@15)                                    2073
         MVC   BEGHHLOC(2),BEGHH(@15)                              2073
*       VTOCCYL=VTOCTT/HEADNUM;     /*                       @ZA11014*/
         L     @15,UCBPTR                                          2074
         LH    @04,VTOCTT+24(,@15)                                 2074
         SRDA  @04,32                                              2074
         LH    @00,HEADNUM                                         2074
         DR    @04,@00                                             2074
         STH   @05,VTOCCYL                                         2074
*       VTOCHEAD=VTOCTT//HEADNUM;   /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2075
         L     @15,UCBPTR                                          2075
         LH    @04,VTOCTT+24(,@15)                                 2075
         SRDA  @04,32                                              2075
         LH    @00,HEADNUM                                         2075
         DR    @04,@00                                             2075
         STH   @04,VTOCHEAD                                        2075
*       /*************************************************************/
*       /*                                                           */
*       /* RESTRICT ADDRESSABILITY IN DEB TO THIS TRACK      @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2076
*       DEBSTRCC=VTOCCYL;           /*                       @ZA11014*/
         LH    @00,VTOCCYL                                         2076
         N     @00,@CF04424                                        2076
         L     @15,DEBDAPTR                                        2076
         STH   @00,DEBSTRCC(,@15)                                  2076
*       DEBSTRHH=VTOCHEAD;          /*                       @ZA11014*/
         LH    @00,VTOCHEAD                                        2077
         N     @00,@CF04424                                        2077
         L     @15,DEBDAPTR                                        2077
         STH   @00,DEBSTRHH(,@15)                                  2077
*       DEBENDCC=VTOCCYL;           /*                       @ZA11014*/
         LH    @00,VTOCCYL                                         2078
         N     @00,@CF04424                                        2078
         L     @15,DEBDAPTR                                        2078
         STH   @00,DEBENDCC(,@15)                                  2078
*       DEBENDHH=VTOCHEAD;          /*                       @ZA11014*/
         LH    @00,VTOCHEAD                                        2079
         N     @00,@CF04424                                        2079
         L     @15,DEBDAPTR                                        2079
         STH   @00,DEBENDHH(,@15)                                  2079
*       DEBNMTRK=1;                 /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2080
         L     @15,DEBDAPTR                                        2080
         MVC   DEBNMTRK(2,@15),@CH00222                            2080
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE CCHHR OF VTOC HEADER INTO THE             @ZA11014*/
*       /* USERS CALLING AREA                                @ZA11014*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2081
*       BEGCC=VTOCCYL;              /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2081
         L     @15,EXOEXT(,@15)                                    2081
         MVC   BEGCC(2,@15),VTOCCYL                                2081
*       BEGHH=VTOCHEAD;             /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2082
         L     @15,EXOEXT(,@15)                                    2082
         MVC   BEGHH(2,@15),VTOCHEAD                               2082
*       BEGR=ZERO;                  /*                       @0Z11014*/
         L     @15,@PC00001+8                                      2083
         L     @15,EXOEXT(,@15)                                    2083
         LH    @00,ZERO                                            2083
         STC   @00,BEGR(,@15)                                      2083
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2084
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE VSAM DATA SET REQUEST                       @ZA11014*/
*   /* SET DEB EXTENTS EQUAL TO THE EXTENT ENTRY SENT        @ZA11014*/
*   /* BY CALLED                                             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2085
*   ELSE                            /*                       @ZA11014*/
*     DO;                           /*                       @ZA11014*/
         B     @RC02070                                            2085
@RF02070 DS    0H                                                  2086
*       DEBSTRCC=VSMBCC;            /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2086
         L     @15,EXOEXT(,@15)                                    2086
         LH    @00,VSMBCC(,@15)                                    2086
         L     @15,DEBDAPTR                                        2086
         STH   @00,DEBSTRCC(,@15)                                  2086
*       DEBSTRHH=VSMBHH;            /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2087
         L     @15,EXOEXT(,@15)                                    2087
         LH    @00,VSMBHH(,@15)                                    2087
         L     @15,DEBDAPTR                                        2087
         STH   @00,DEBSTRHH(,@15)                                  2087
*       DEBENDCC=VSMECC;            /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2088
         L     @15,EXOEXT(,@15)                                    2088
         LH    @00,VSMECC(,@15)                                    2088
         L     @15,DEBDAPTR                                        2088
         STH   @00,DEBENDCC(,@15)                                  2088
*       DEBENDHH=VSMEHH;            /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2089
         L     @15,EXOEXT(,@15)                                    2089
         LH    @00,VSMEHH(,@15)                                    2089
         L     @15,DEBDAPTR                                        2089
         STH   @00,DEBENDHH(,@15)                                  2089
*       DEBNMTRK=VSMEHH-VSMBHH+1;   /*                       @ZA11014*/
         L     @15,@PC00001+8                                      2090
         L     @15,EXOEXT(,@15)                                    2090
         L     @14,@PC00001+8                                      2090
         L     @14,EXOEXT(,@14)                                    2090
         LH    @00,VSMEHH(,@15)                                    2090
         SH    @00,VSMBHH(,@14)                                    2090
         AL    @00,@CF00222                                        2090
         L     @15,DEBDAPTR                                        2090
         STH   @00,DEBNMTRK(,@15)                                  2090
*     END;                          /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2091
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET FILE MASK TO INHIBIT HEAD SWITCHING             @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2092
*   DEBDVMOD=DEBDVMOD×INHDFLMK;     /*                       @ZA11014
*                                                            @ZA11014*/
*                                                                  2092
@RC02070 L     @15,DEBDAPTR                                        2092
         OC    DEBDVMOD(1,@15),INHDFLMK                            2092
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MODESET TO RETURN TO PROB PROG KEY              @ZA11014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2093
*   MODEPARM=''B;                   /*                       @ZA11014*/
         XC    MODEPARM(4),MODEPARM                                2093
*   MODEPARM=MOD2;                  /*                       @ZA11014*/
         L     @00,MOD2                                            2094
         ST    @00,MODEPARM                                        2094
*   REG3=MODEPARM;                  /*                       @ZA11014*/
         L     REG3,MODEPARM                                       2095
*LRVMODE4:                                                         2096
*   DO;                             /* MODESET MF(E,REG3)            */
LRVMODE4 DS    0H                                                  2097
*     RESPECIFY                                                    2097
*       GPR01F RESTRICTED;                                         2097
*     GPR01F=REG3;                  /* MODESET PARMLIST              */
         LR    GPR01F,REG3                                         2098
*     SVC(107);                     /* ISSUE MODESET SVC             */
         SVC   107                                                 2099
*     RESPECIFY                                                    2100
*      (GPR01F) UNRESTRICTED;                                      2100
*   END;                            /* MODESET MF(E,REG3)    @ZA11014*/
*   RESPECIFY                                                      2102
*    (REG1,                                                        2102
*     REG3) UNRSTD;                 /*                       @ZA11014
*                                                            @ZA11014
*                                                            @ZA11014*/
*                                                                  2102
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN RC=OK /*@ZA11014                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2103
*   TESTRC=0;                       /*                       @ZA11014*/
         SLR   @03,@03                                             2103
         STH   @03,TESTRC                                          2103
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/
         LH    @15,TESTRC                                          2104
         L     @14,@SA00031                                        2104
         LM    @00,@12,@SA00031+8                                  2104
         BR    @14                                                 2104
*   END OPNVTH;                     /*                       @ZA11014*/
*   END IDCIO05                     /*                       @Z40LB35*/
*                                                                  2106
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF05 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF09 )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */
*/*%INCLUDE SYSLIB  (IHAECB  )                                       */
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IDCDF66 )                                       */
*                                                                  2106
*       ;                                                          2106
@DATA    DS    0H
@CH00036 DC    H'2'
@CH00045 DC    H'4'
@CH00038 DC    H'8'
@CH00279 DC    H'20'
@CH00849 DC    H'44'
@CH01813 DC    H'60'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00020 DS    15F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00022 DS    15F
@SA00024 DS    15F
@SA00023 DS    15F
@SA00030 DS    15F
@SA00029 DS    15F
@SA00010 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00014 DS    15F
@SA00015 DS    15F
@SA00017 DS    15F
@SA00021 DS    15F
@SA00019 DS    15F
@SA00031 DS    15F
@AL00001 DS    4A
IDCIO05  CSECT
         DS    0F
@CF00119 DC    F'0'
@CF00222 DC    F'1'
@CH00222 EQU   @CF00222+2
@CF03001 DC    F'36'
@CF04409 DC    F'392'
@CF04425 DC    F'-20'
@CF04427 DC    F'-14'
@CF04428 DC    F'-12'
@CF04420 DC    F'-4'
@CF04429 DC    F'-3'
@CF04424 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
UCBPTR   DS    A
DCBPTR   DS    A
JFCBPTR  DS    A
JFCBXPTR DS    A
DEBPTR   DS    A
DEBDAPTR DS    A
DEBEXPTR DS    A
DEBSBPTR DS    A
IOBPRPTR DS    A
IOBSTPTR DS    A
ECBPTR   DS    A
IOCTLBKP DS    A
USERCHRP DS    A
ADDCHAIN DS    A
SAVEAVT  DS    A
UNCHAIN  DS    F
MODSIZE  DS    F
RWIOARPT DS    A
RRIOARPT DS    A
WRADDR   DS    A
BLKSIZE  DS    F
SYNMSGAD DS    A
OCPARM   DS    A
LISTPTR  DS    A
RDADDR   DS    A
TESTRC   DS    H
WRITECNT DS    H
READCNTA DS    H
ARRINDEX DS    H
CCWCNT   DS    H
OFFSET   DS    H
LASTCCW  DS    H
CCWNDX   DS    H
RDOPCNT  DS    H
CNTCCWS  DS    H
RCTR     DS    H
RVCNT    DS    H
VTOCCYL  DS    H
VTOCHEAD DS    H
SETRC    DS    H
         DS    CL3
RCNTPTR  DS    AL3
         DS    CL1
RDKDADDR DS    AL3
LISTLN   DS    FL1
@TS00001 DS    CL95
PRINTARG DS    CL28
BEGHHLOC DS    CL2
         DS    CL2
TEMPCCHH DS    CL8
         ORG   TEMPCCHH
@NM00201 DS    CL3
TEMPCHR  DS    CL5
         ORG   TEMPCCHH+8
SRCHCHR  DS    CL5
         ORG   SRCHCHR
SRCHCC   DS    FL2
SRCHHH   DS    FL2
SRCHR    DS    FL1
         ORG   SRCHCHR+5
         DS    CL3
SAVEREGS DS    CL64
PARMLIST DS    CL20
SVC82ARG DS    CL16
CANSTAE  DS    BL1
         DS    CL3
MODEPARM DS    CL4
RDJFCBPM DS    CL4
         ORG   RDJFCBPM
RDJFCBCD DS    CL1
RDJFCBAD DS    AL3
         ORG   RDJFCBPM+4
IDCIO05  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RCRACF56 DC    XL4'00000038'
RCRACF60 DC    XL4'0000003C'
RCPSWD12 DC    XL4'0000000C'
ZERO     DC    H'0'
TWOCCWS  DC    H'2'
THREECCW DC    H'3'
FOURCCWS DC    H'4'
FIVECCWS DC    H'5'
MAXRECS  DC    H'122'
LENR0    DC    H'16'
LENR0D   DC    H'8'
LENCNT   DC    H'8'
TWOK     DC    H'2048'
CCWSIZE  DC    H'8'
R0CHNLOC DC    H'2'
NONRDCT  DC    H'3'
RCSRUEX  DC    H'31'
RCINVWR  DC    H'23'
RCSRUNCO DC    H'22'
RCNOERR  DC    H'0'
RCABDS   DC    H'8'
RCABST   DC    H'12'
RCABOV   DC    H'16'
RCABNRF  DC    H'20'
RCABSYNC DC    H'24'
RCABDTCK DC    H'28'
RCABEOFR DC    H'32'
LOCENT   DC    AL2(125)
NEWCCWLN DC    H'1448'
LABCCWLN DC    H'80'
TABCCWLN DC    H'400'
VTOCCWLN DC    H'400'
RPRWCCLN DC    H'4000'
RVWS     DC    AL1(2)
RVWKD    DC    AL1(3)
SPCNTOP  DC    XL1'0F'
TICOP    DC    XL1'08'
NOPOP    DC    XL1'03'
RDCNTOP  DC    XL1'92'
RDKDOP   DC    XL1'8E'
RDCKDOP  DC    XL1'9E'
RDDTOP   DC    XL1'86'
NTFSTIME DC    XL1'00'
FSTIME   DC    XL1'FF'
PCDSTERR DC    XL1'61'
PCSTGERR DC    XL1'62'
PCOVFOK  DC    XL1'63'
PCNRF    DC    XL1'64'
PCSYNCER DC    XL1'65'
PCDATCHK DC    XL1'66'
PCEOFIND DC    XL1'67'
UNSUCCES DC    XL1'41'
IGNORE   DC    XL1'04'
@CC04230 DC    C'IOXCTLBK'
@CC03779 DC    C'IO05'
@CC03929 DC    C'VTOC'
@CC04110 DC    C'IOIN'
@CC04120 DC    C'IOEX'
@CC04124 DC    C'IOOE'
@CC04134 DC    C'IOPG'
@CC04142 DC    C'IOCL'
@CC04149 DC    C'IOOP'
@CC04162 DC    C'IOOV'
@CC04172 DC    C'IOOT'
@CC04197 DC    C'IOOL'
@CC04211 DC    C'IOON'
@CC04232 DC    C'DCB '
@CC04234 DC    C'ECB '
@CC04236 DC    C'IOB '
@CC04238 DC    C'XLST'
@CC04240 DC    C'JFCB'
@CC04242 DC    C'CCW '
@CC04243 DC    C'IOBB'
@CC04248 DC    C'IOP1'
@CC04252 DC    C'IOP2'
@CC04256 DC    C'IOG1'
@CC04262 EQU   @CC04230
@CC04271 DC    C'IOCS'
@CC04282 DC    C'IOCK'
@CC04288 DC    C'IORT'
@CC04303 DC    C'IOSN'
@CC04304 DC    C'IOSY'
@CC04319 DC    C'IOOC'
@CC04320 DC    C'IOAB'
@CC04328 DC    C'IORJ'
@CC04334 DC    C'IOOR'
@CC04347 DC    C'IOCT'
@CC04350 DC    C'IOC1'
@CC04354 DC    C'IOKD'
@CC04357 DC    C'IOK2'
@CC04361 DC    C'IOCW'
@CC04365 DC    C'IOSP'
@CC04371 DC    C'IOKS'
@CC04373 DC    C'IOK3'
@CC04374 DC    C'IOK4'
@CC04378 DC    C'IOAJ'
@CC04384 DC    C'IOWR'
@CC04387 DC    C'IOWB'
@CC04391 DC    C'IOFW'
@CC04393 DC    C'IOFB'
@CC04397 DC    C'IOVH'
@CC03785 DC    C'IO5'
@CC03787 DC    C'SA0'
@CB03783 DC    X'00'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODIFYC  DC    CL8'MODIFYC '
MODID    DC    CL4'IO05'
FIXAREA  DS    CL350
         ORG   FIXAREA
@NM00192 DC    350X'00'
         ORG   FIXAREA+350
CCWSIDEQ DC    X'3100000040000005'
CCWTIC   DC    X'0800000000000000'
CCWWCKD  DC    X'1D00000080000008'
CCWWKD   DC    X'0D00000060000000'
CCWRCKD  DC    X'1E00000060000000'
CCWRKD   DC    X'0E00000060000000'
CCWDATA  DC    X'0000000060000000'
CCWRWSP  DC    X'0100000040000000'
CCWRWKD  DC    X'0D00000040000000'
CCWRRKD  DC    X'8E00000010000000'
CCWRRD   DC    X'8600000040000000'
CCWRWCKD DC    X'1D00000040000000'
CCWRRCKD DC    X'9E00000010000000'
CCWRRR0  DC    X'1600000060000010'
CCWRSSEC DC    X'2300000040000001'
CCWRRCNT DC    X'9200000040000008'
CCWRSPCT DC    X'0F00000040000003'
CCWRNOP  DC    X'0300000020000001'
SVC82OPN DC    X'20'
SVC82CLS DC    X'21'
LAB      DC    X'10'
TABLE    DC    X'20'
PASSWORD DC    X'30'
NEWVOL   DC    X'40'
VTOC     DC    X'50'
VTOCHDR  DC    X'90'
REPDS    DC    X'80'
ZEROS    DS    CL8
         ORG   ZEROS
@NM00197 DC    8X'00'
         ORG   ZEROS+8
VTOCDSN  DS    CL44
         ORG   VTOCDSN
@NM00198 DC    44X'04'
         ORG   VTOCDSN+44
VTOCINST DC    CL4'VTOC'
         DS    CL3
EXLIST   DS    CL8
         ORG   EXLIST
LISTJFCB DC    X'07'
AREAJFCB DS    AL3
EXTDCB   DC    X'91'
ADDRDCBE DC    AL3(OCABEND)
         ORG   EXLIST+8
NTFNDPTR DC    X'FFFFFFFF'
ABEID    DC    CL2'A3'
INHDFLMK DC    X'18'
CYLZERO  DC    X'0000'
TRKZERO  DC    X'0000'
         DS    CL1
MOD1     DS    CL4
         ORG   MOD1
MOD101   DC    B'00000000'
MOD102   DC    B'00000000'
MOD103   DC    B'00000000'
MOD104   DC    B'00111100'
         ORG   MOD1+4
MOD2     DS    CL4
         ORG   MOD2
MOD201   DC    B'00000000'
MOD202   DC    B'00000000'
MOD203   DC    B'00000000'
MOD204   DC    B'00100100'
         ORG   MOD2+4
SUCCESS  DC    X'7F'
@DATD    DSECT
*                                                          /*@Y30LB35*/
IDCIO05  CSECT                                                 @Y30LB35
         ENTRY IDCIOS5                                         @Y30LB35
IDCIOS5  DC    A(@SIZDATD)                                     @Y30LB35
@DATD    DSECT
*                                                          /*@Y30LB35*/
IDCIO05  CSECT                                                 @Y30LB35
DCBEXCP  DCB DSORG=PS,MACRF=(E),EXLST=EXLIST                   @ZA11014
OPENLIST OPEN  (0),MF=L                                        @Y30LB35
DCBEXCP1 DCB DSORG=PS,MACRF=(E),EXLST=EXLIST,XENDA=A4          @ZA11014
CLOSELST CLOSE (0),MF=L                                        @Y30LB35
@DATD    DSECT
*                                                          /*@Y30LB35*/
IDCIO05  CSECT                                                 @Y30LB35
JFCBLST RDJFCB (0),MF=L                                        @Y30LB35
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCIO05  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG3     EQU   @03
REG4     EQU   @04
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
SDWAPTR  EQU   @04
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR01F   EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
CVTPTR   EQU   16
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAST0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
RACFAGL  EQU   0
RACFFLG1 EQU   RACFAGL
RACFFLG2 EQU   RACFAGL+1
RACFFLG3 EQU   RACFAGL+2
RACFFLG4 EQU   RACFAGL+3
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00017 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
IOCEXT   EQU   IOCSTR+64
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXODDN   EQU   EXOARG+8
EXODSN   EQU   EXOARG+12
EXOVSN   EQU   EXOARG+16
EXOUCB   EQU   EXOARG+20
EXOEXT   EQU   EXOARG+24
EXOCTLBK EQU   EXOARG+28
EXOPT    EQU   EXOARG+32
EXOTAB   EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXOREP   EQU   EXOPT
EXFLG    EQU   EXOARG+33
EXOREAD  EQU   EXFLG
EXORVS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORDS   EQU   EXFLG
EXORVT   EQU   EXFLG
EXOVTH   EQU   EXFLG
EXGARG   EQU   0
EXGCTLBK EQU   EXGARG+8
EXGCCHH1 EQU   EXGARG+12
EXGCCHH2 EQU   EXGARG+16
EXGRECNO EQU   EXGARG+20
EXGDATAP EQU   EXGARG+24
EXGKEYLN EQU   EXGARG+28
EXGDATAL EQU   EXGARG+30
EXWRARG  EQU   0
EXRWCTBL EQU   EXWRARG+8
EXRWIOAR EQU   EXWRARG+12
EXLOCPTR EQU   EXWRARG+20
EXCCWCNT EQU   EXWRARG+24
EXRWCHR  EQU   EXWRARG+26
EXCC     EQU   EXRWCHR
EXHH     EQU   EXRWCHR+2
EXRECNUM EQU   EXRWCHR+4
EXRWKDLN EQU   EXWRARG+32
EXSPACE  EQU   EXWRARG+36
EXRWFUN  EQU   EXWRARG+46
EXPARG   EQU   0
EXPCTLBK EQU   EXPARG+8
EXPDATA  EQU   EXPARG+12
EXPCCHHR EQU   EXPARG+16
EXPDATAB EQU   0
EXPRECNO EQU   EXPDATAB
EXPARRAY EQU   EXPDATAB+4
EXPDATAP EQU   EXPARRAY
EXPKEYLN EQU   EXPARRAY+4
EXPDATAL EQU   EXPARRAY+6
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARTSAV EQU   STAEPARM+36
STARTADD EQU   STAEPARM+44
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
STAIO05  EQU   STARETRY
STAOFF   EQU   STARETRY
STAVTOC  EQU   STARETRY
VOLLABEL EQU   0
SV82LIST EQU   0
SV82CODE EQU   SV82LIST
SV82UCBP EQU   SV82LIST+1
@NM00073 EQU   SV82LIST+4
SV82DCBP EQU   @NM00073
@NM00074 EQU   SV82LIST+12
SV82WRKP EQU   @NM00074
SV82DEBP EQU   SV82WRKP
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
IODATA   EQU   0
IODSID   EQU   IODATA+16
IODIOX   EQU   IODATA+52
IOCSEX   EQU   0
IOCRPL   EQU   IOCSEX+4
IOCXAD   EQU   IOCSEX+16
IOCXPM   EQU   IOCSEX+20
IOCFLG   EQU   IOCSEX+32
IOCDEV   EQU   IOCSEX+33
IOCINF   EQU   IOCSEX+34
IOCMOD   EQU   IOCSEX+35
IOCRCV   EQU   IOCSEX+44
SAHIST   EQU   0
AUTOPTR  EQU   SAHIST+8
SAHSTA   EQU   SAHIST+12
AUTOTBL  EQU   0
AUTOARAY EQU   AUTOTBL
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00104 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
DCBEXLSA EQU   DCBEXLST+1
IHADCS24 EQU   0
DCBDDNAM EQU   IHADCS24
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFEC  EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
IHADCS28 EQU   0
DCBOPTCD EQU   IHADCS28
DCBOPTZ  EQU   DCBOPTCD
IHADCS44 EQU   0
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCVSL   EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
JFCBX    EQU   0
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBAPPAD EQU   DEBBASIC+28
DEBEXSCL EQU   DEBAPPAD
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBDVMOD EQU   DEBUCBAD
DEBSTRCC EQU   DEBDASD+6
DEBSTRHH EQU   DEBDASD+8
DEBENDCC EQU   DEBDASD+10
DEBENDHH EQU   DEBDASD+12
DEBNMTRK EQU   DEBDASD+14
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBXCEAD EQU   DEBXCEA+1
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCMDCH EQU   IOBFLAG1
IOBCYCCK EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCNC   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBCMDA  EQU   IOBIOCSW
IOBSTBYT EQU   IOBIOCSW+3
IOBUSTAT EQU   IOBSTBYT
IOBCSTAT EQU   IOBSTBYT+1
IOBSTART EQU   IOBSTDRD+16
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
ECB      EQU   0
ECBRB    EQU   ECB
ECBEVTB  EQU   ECBRB
ECBEXTB  EQU   ECBEVTB
ECBCC    EQU   ECBEXTB
ECBPOSTB EQU   ECBCC
ECBCCCNT EQU   ECBEXTB+1
ECBRBA   EQU   ECBCCCNT
ECBEVTBA EQU   ECBRBA
ECBEXTBA EQU   ECBEVTBA
ECBBYTE3 EQU   ECBEXTBA+2
ECBEXTND EQU   ECBBYTE3
SDWA     EQU   0
SDWAPARM EQU   SDWA
SDWAFIOB EQU   SDWA+4
SDWAABCC EQU   SDWAFIOB
SDWACMPF EQU   SDWAABCC
SDWACTL1 EQU   SDWA+8
SDWACMKA EQU   SDWACTL1
SDWAMWPA EQU   SDWACTL1+1
SDWAPMKA EQU   SDWACTL1+4
SDWACTL2 EQU   SDWA+16
SDWACMKP EQU   SDWACTL2
SDWAMWPP EQU   SDWACTL2+1
SDWAPMKP EQU   SDWACTL2+4
SDWAGRSV EQU   SDWA+24
SDWAGR15 EQU   SDWAGRSV+60
SDWANAME EQU   SDWA+88
SDWAEC1  EQU   SDWA+104
SDWAEMK1 EQU   SDWAEC1
SDWAMWP1 EQU   SDWAEC1+1
SDWAINT1 EQU   SDWAEC1+2
SDWANXT1 EQU   SDWAEC1+4
SDWAAEC1 EQU   SDWA+112
SDWAILC1 EQU   SDWAAEC1+1
SDWAINC1 EQU   SDWAAEC1+2
SDWAICD1 EQU   SDWAINC1+1
SDWAEC2  EQU   SDWA+120
SDWAEMK2 EQU   SDWAEC2
SDWAMWP2 EQU   SDWAEC2+1
SDWAINT2 EQU   SDWAEC2+2
SDWANXT2 EQU   SDWAEC2+4
SDWAAEC2 EQU   SDWA+128
SDWAILC2 EQU   SDWAAEC2+1
SDWAINC2 EQU   SDWAAEC2+2
SDWAICD2 EQU   SDWAINC2+1
SDWASRSV EQU   SDWA+136
SDWAIDNT EQU   SDWA+200
SDWAMCH  EQU   SDWA+204
SDWASTCK EQU   SDWAMCH
SDWAMCHI EQU   SDWAMCH+8
SDWAMCHS EQU   SDWAMCHI
SDWAMCHD EQU   SDWAMCHI+1
SDWARSR1 EQU   SDWAMCH+12
SDWARSR2 EQU   SDWAMCH+13
SDWAFLGS EQU   SDWA+232
SDWAERRA EQU   SDWAFLGS
SDWAERRB EQU   SDWAFLGS+1
SDWAERRC EQU   SDWAFLGS+2
SDWAERRD EQU   SDWAFLGS+3
SDWAIOFS EQU   SDWA+238
SDWACPUA EQU   SDWA+248
SDWAPARQ EQU   SDWA+252
SDWAACF2 EQU   SDWAPARQ+1
SDWAACF3 EQU   SDWAPARQ+2
SDWAACF4 EQU   SDWAPARQ+3
SDWALKWA EQU   SDWA+256
SDWALKWS EQU   SDWALKWA
SDWARECP EQU   SDWA+292
SDWASNPA EQU   SDWA+320
SDWADUMP EQU   SDWASNPA
SDWADPFS EQU   SDWADUMP+1
SDWADDAT EQU   SDWASNPA+4
SDWASDAT EQU   SDWADDAT
SDWAPDAT EQU   SDWADDAT+2
SDWADPSA EQU   SDWA+328
SDWADPSL EQU   SDWADPSA
SDWARA   EQU   SDWA+400
SDWADPVA EQU   SDWARA+2
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
LOCTAB   EQU   0
LOCADDR  EQU   LOCTAB
LOCRCNT  EQU   LOCTAB+4
LOCRCKD  EQU   LOCTAB+6
LOCCNTFD EQU   LOCTAB+8
LOCKLEN  EQU   LOCTAB+17
LOCDLEN  EQU   LOCTAB+18
RIOAREA  EQU   0
RIOHDR   EQU   RIOAREA
RFIRST   EQU   RIOHDR
RPREV    EQU   RIOHDR+2
RNUMREC  EQU   RIOHDR+8
RBUFF    EQU   RIOAREA+282
RKEY     EQU   0
RKEYCHR  EQU   RKEY+6
RKEYFLG  EQU   RKEY+11
RBUF     EQU   0
RBUFCNT  EQU   RBUF
RBCCHHR  EQU   RBUFCNT
RBREC    EQU   RBCCHHR+4
RBKL     EQU   RBUFCNT+5
RBDL     EQU   RBUFCNT+6
WIOAREA  EQU   0
WNUMREC  EQU   WIOAREA
WBUFF    EQU   WIOAREA+4
WBUF     EQU   0
WBUFCNT  EQU   WBUF
WBCCHHR  EQU   WBUFCNT
WBKL     EQU   WBUFCNT+5
WBDL     EQU   WBUFCNT+6
WKEYDAT  EQU   WBUF+8
IOXCTLBK EQU   0
IOCTLBK  EQU   IOXCTLBK
IOXCHAIN EQU   IOCTLBK
IOXID    EQU   IOCTLBK+4
IOXWRITE EQU   IOCTLBK+12
IOXREADS EQU   IOCTLBK+16
IOXACODE EQU   IOCTLBK+20
IOXRCODE EQU   IOCTLBK+22
IOXTYPE  EQU   IOCTLBK+24
IOXFLGS  EQU   IOCTLBK+25
IOXOPN   EQU   IOXFLGS
IOXABEND EQU   IOXFLGS
IOXCLOSE EQU   IOXFLGS
IOXSYNAD EQU   IOXFLGS
IOXDDN   EQU   IOCTLBK+28
IOXDCBID EQU   IOCTLBK+36
IOXDCB   EQU   IOCTLBK+40
IOXECBID EQU   IOCTLBK+112
IOXECB   EQU   IOCTLBK+116
IOXIOBID EQU   IOCTLBK+120
IOXIOB   EQU   IOCTLBK+124
IOXJFCBI EQU   IOCTLBK+164
IOXJFCB  EQU   IOCTLBK+168
IOXEXID  EQU   IOCTLBK+368
IOXEXLST EQU   IOCTLBK+372
IOXJFCBP EQU   IOXEXLST+1
IOXUCBP  EQU   IOCTLBK+380
IOXCCWID EQU   IOXCTLBK+384
IOXCCWS  EQU   IOXCTLBK+392
IOXCCW   EQU   IOXCCWS
IOXCNTS  EQU   IOXCTLBK+1392
IOXCOUNT EQU   IOXCNTS
USERIOBP EQU   0
USERCCHH EQU   0
USERDDN  EQU   0
VOLLAB   EQU   0
RTNEXTS  EQU   0
BEGCC    EQU   RTNEXTS
BEGHH    EQU   RTNEXTS+2
BEGR     EQU   RTNEXTS+4
ENDCC    EQU   RTNEXTS+5
ENDHH    EQU   RTNEXTS+7
VSMEXTS  EQU   0
VSMBCC   EQU   VSMEXTS
VSMBHH   EQU   VSMEXTS+2
VSMECC   EQU   VSMEXTS+8
VSMEHH   EQU   VSMEXTS+10
CHAINPTR EQU   0
CCW      EQU   0
CCWOP    EQU   CCW
CCWADDR  EQU   CCW+1
CCWCMDCH EQU   CCW+4
CCWSUPP  EQU   CCW+4
CCWDATLN EQU   CCW+6
COUNT    EQU   0
CNTCCHHR EQU   COUNT
CNTRECNO EQU   CNTCCHHR+4
CNTKEYLN EQU   COUNT+5
CNTDATLN EQU   COUNT+6
FLDLENS  EQU   0
FLDKEYLN EQU   FLDLENS
FLDDATLN EQU   FLDLENS+1
VTOCLOC  EQU   0
VTOCTT   EQU   VTOCLOC
ARGHEAD  EQU   0
USERDSN  EQU   0
ERRORMSG EQU   0
SYNADMSG EQU   ERRORMSG+68
SYNDNAME EQU   SYNADMSG+7
OPNCLOSE EQU   0
OCABCODE EQU   OPNCLOSE
OCREASON EQU   OPNCLOSE+2
OCOPTION EQU   OPNCLOSE+3
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARK0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NEXTPTR  EQU   0
UCBBGN   EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTSAH   EQU   GDTTBL+32
GDTIOH   EQU   GDTTBL+36
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
GDTRCK   EQU   GDTTBL+284
REQUEST  EQU   0
ARGLIST  EQU   0
UCBOBS01 EQU   UCBDEV
UCBVTOC  EQU   UCBOBS01
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00103 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCAVOLS EQU   JFCBVOLS
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBPRTOV EQU   IOBNFLG1
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBM     EQU   IOBSEEK
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBR     EQU   IOBSEEK+7
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
HEADNUM  EQU   BEGHHLOC
REPVALS  EQU   EXSPACE
SVCCWPTR EQU   REPVALS+1
LSTRECNM EQU   REPVALS+4
RECCNTSV EQU   REPVALS+6
RECCNT   EQU   REPVALS+8
EXTNTVAL EQU   DEBEXSCL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00207 EQU   REPVALS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
IOBSKSS  EQU   IOBSKADR+3
IOBSK0   EQU   IOBSKADR+2
IOBSKTT  EQU   IOBSKADR+1
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBSEGMT EQU   IOBPRTOV
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBRV01 EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00124 EQU   JFCBS001
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00123 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00122 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00103
UCBSKPFG EQU   @NM00103
UCBRIPND EQU   @NM00103
UCBRTIAC EQU   @NM00103
UCBRSV79 EQU   @NM00103
UCBRSV78 EQU   @NM00103
UCBRSV77 EQU   @NM00103
UCBOLTEP EQU   @NM00103
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBDQDSP EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00102 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00210 EQU   SYNADMSG+15
@NM00209 EQU   SYNADMSG
@NM00208 EQU   ERRORMSG
@NM00206 EQU   VTOCLOC+3
VTOCR    EQU   VTOCLOC+2
@NM00205 EQU   CNTCCHHR
@NM00204 EQU   CCW+5
@NM00203 EQU   CCW+4
@NM00202 EQU   CCW+4
CCWDATCH EQU   CCW+4
VSMER    EQU   VSMEXTS+12
@NM00200 EQU   VSMEXTS+5
VSMBR    EQU   VSMEXTS+4
@NM00199 EQU   RTNEXTS+9
@NM00196 EQU   IOXEXLST+4
@NM00195 EQU   IOXEXLST
@NM00194 EQU   IOCTLBK+26
@NM00193 EQU   IOXFLGS
WBREC    EQU   WBCCHHR+4
WBHH     EQU   WBCCHHR+2
WBCC     EQU   WBCCHHR
RKEYDAT  EQU   RBUF+8
RBHH     EQU   RBCCHHR+2
RBCC     EQU   RBCCHHR
@NM00191 EQU   RKEYFLG+4
RKEYFLG3 EQU   RKEYFLG+3
RKEYFLG2 EQU   RKEYFLG+1
RKEYFLG1 EQU   RKEYFLG
RKEYR    EQU   RKEYCHR+4
RKEYHH   EQU   RKEYCHR+2
RKEYCC   EQU   RKEYCHR
RKEYVOL  EQU   RKEY
@NM00190 EQU   RIOHDR+26
@NM00189 EQU   RIOHDR+10
@NM00188 EQU   RIOHDR+7
RPREVR   EQU   RPREV+4
RPREVHH  EQU   RPREV+2
RPREVCC  EQU   RPREV
@NM00187 EQU   RIOHDR+1
@NM00186 EQU   LOCTAB+16
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00185 EQU   CVTFIX+248
@NM00184 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00183 EQU   SDWA+512
SDWAVRA  EQU   SDWARA+4
SDWAURAL EQU   SDWARA+3
@NM00182 EQU   SDWADPVA
SDWAEBC  EQU   SDWADPVA
SDWAHEX  EQU   SDWADPVA
SDWAVRAL EQU   SDWARA
@NM00181 EQU   SDWA+396
SDWACOMP EQU   SDWA+392
SDWARCPL EQU   SDWA+364
@NM00180 EQU   SDWADPSA+32
SDWATO4  EQU   SDWADPSL+28
SDWAFRM4 EQU   SDWADPSL+24
SDWATO3  EQU   SDWADPSL+20
SDWAFRM3 EQU   SDWADPSL+16
SDWATO2  EQU   SDWADPSL+12
SDWAFRM2 EQU   SDWADPSL+8
SDWATO1  EQU   SDWADPSL+4
SDWAFRM1 EQU   SDWADPSL
@NM00179 EQU   SDWADDAT+3
@NM00178 EQU   SDWAPDAT
SDWAUSPL EQU   SDWAPDAT
SDWADPSW EQU   SDWAPDAT
SDWATJPA EQU   SDWAPDAT
SDWATLPA EQU   SDWAPDAT
SDWADREG EQU   SDWAPDAT
SDWADSAH EQU   SDWAPDAT
SDWADSAS EQU   SDWAPDAT
@NM00177 EQU   SDWADDAT+1
@NM00176 EQU   SDWASDAT
SDWAQQS  EQU   SDWASDAT
SDWACBS  EQU   SDWASDAT
SDWAGTF  EQU   SDWASDAT
SDWASWA  EQU   SDWASDAT
SDWALSQA EQU   SDWASDAT
SDWASQA  EQU   SDWASDAT
SDWANUC  EQU   SDWASDAT
@NM00175 EQU   SDWADUMP+2
@NM00174 EQU   SDWADPFS
SDWASLST EQU   SDWADPFS
@NM00173 EQU   SDWADPFS
SDWADLST EQU   SDWADPFS
SDWADPT  EQU   SDWADPFS
SDWADPID EQU   SDWADUMP
SDWADPLA EQU   SDWA+316
SDWAREXN EQU   SDWARECP+16
SDWACSCT EQU   SDWARECP+8
SDWAMODN EQU   SDWARECP
@NM00172 EQU   SDWALKWA+32
SDWATALW EQU   SDWALKWS+28
SDWATDLW EQU   SDWALKWS+24
SDWATNLW EQU   SDWALKWS+20
SDWAAPLW EQU   SDWALKWS+16
SDWAIPLW EQU   SDWALKWS+12
SDWAILLW EQU   SDWALKWS+8
SDWAIULW EQU   SDWALKWS+4
SDWAICLW EQU   SDWALKWS
SDWAFLLK EQU   SDWAACF4
SDWACMS  EQU   SDWAACF4
SDWAOPTM EQU   SDWAACF4
SDWATADB EQU   SDWAACF4
SDWATDNB EQU   SDWAACF4
SDWATNCB EQU   SDWAACF4
SDWAILCH EQU   SDWAACF4
SDWAIUCB EQU   SDWAACF4
SDWAICAT EQU   SDWAACF3
SDWAIPRG EQU   SDWAACF3
SDWASALL EQU   SDWAACF3
SDWAASMP EQU   SDWAACF3
SDWADISP EQU   SDWAACF3
@NM00171 EQU   SDWAACF3
@NM00170 EQU   SDWAACF2
SDWAFREE EQU   SDWAACF2
SDWAUPRG EQU   SDWAACF2
@NM00169 EQU   SDWAACF2
SDWASPIN EQU   SDWAACF2
@NM00168 EQU   SDWAACF2
SDWARCRD EQU   SDWAACF2
SDWARCDE EQU   SDWAPARQ
SDWALCPU EQU   SDWACPUA+2
@NM00167 EQU   SDWACPUA
SDWARECA EQU   SDWA+244
SDWARTYA EQU   SDWA+240
@NM00166 EQU   SDWA+239
@NM00165 EQU   SDWAIOFS
SDWANIOP EQU   SDWAIOFS
SDWANOIO EQU   SDWAIOFS
SDWAIOHT EQU   SDWAIOFS
SDWAIOQR EQU   SDWAIOFS
SDWAFMID EQU   SDWA+236
@NM00164 EQU   SDWAERRD
SDWAMCIV EQU   SDWAERRD
SDWARPIV EQU   SDWAERRD
SDWAMABD EQU   SDWAERRD
SDWACTS  EQU   SDWAERRD
SDWASTAE EQU   SDWAERRD
SDWANRBE EQU   SDWAERRD
SDWACLUP EQU   SDWAERRD
@NM00163 EQU   SDWAERRC
SDWAEAS  EQU   SDWAERRC
SDWAPERC EQU   SDWAERRC
SDWAIRB  EQU   SDWAERRC
SDWASTAI EQU   SDWAERRC
SDWASTAF EQU   SDWAERRC
SDWASRBM EQU   SDWAERRB
SDWALDIS EQU   SDWAERRB
SDWAENRB EQU   SDWAERRB
SDWATYP1 EQU   SDWAERRB
@NM00162 EQU   SDWAERRB
SDWAPGIO EQU   SDWAERRA
SDWATEXC EQU   SDWAERRA
SDWASVCE EQU   SDWAERRA
SDWAABTM EQU   SDWAERRA
SDWASVCD EQU   SDWAERRA
SDWARKEY EQU   SDWAERRA
SDWAPCHK EQU   SDWAERRA
SDWAMCHK EQU   SDWAERRA
SDWATIME EQU   SDWAMCH+20
SDWARFSA EQU   SDWAMCH+16
@NM00161 EQU   SDWAMCH+14
SDWAVEQR EQU   SDWARSR2
SDWAPGFX EQU   SDWARSR2
SDWAFLSQ EQU   SDWARSR2
SDWAFSQA EQU   SDWARSR2
SDWANUCL EQU   SDWARSR2
SDWASPER EQU   SDWARSR2
SDWAINTC EQU   SDWARSR2
SDWAOFLN EQU   SDWARSR2
SDWACHNG EQU   SDWARSR1
SDWAMSER EQU   SDWARSR1
@NM00160 EQU   SDWARSR1
SDWACPID EQU   SDWAMCH+10
SDWATERR EQU   SDWAMCHD
SDWAFPRX EQU   SDWAMCHD
SDWAINSF EQU   SDWAMCHD
SDWAACR  EQU   SDWAMCHD
SDWASCK  EQU   SDWAMCHD
SDWAPSWU EQU   SDWAMCHD
SDWAREGU EQU   SDWAMCHD
SDWASKYF EQU   SDWAMCHD
@NM00159 EQU   SDWAMCHS
SDWARSRF EQU   SDWAMCHS
SDWARSRC EQU   SDWAMCHS
SDWAINVP EQU   SDWAMCHS
SDWATSVL EQU   SDWAMCHS
SDWARCDF EQU   SDWAMCHS
SDWASRVL EQU   SDWAMCHS
SDWASCKE EQU   SDWASTCK+4
SDWASCKB EQU   SDWASTCK
SDWALNTH EQU   SDWAIDNT+1
SDWASPID EQU   SDWAIDNT
SDWASR15 EQU   SDWASRSV+60
SDWASR14 EQU   SDWASRSV+56
SDWASR13 EQU   SDWASRSV+52
SDWASR12 EQU   SDWASRSV+48
SDWASR11 EQU   SDWASRSV+44
SDWASR10 EQU   SDWASRSV+40
SDWASR09 EQU   SDWASRSV+36
SDWASR08 EQU   SDWASRSV+32
SDWASR07 EQU   SDWASRSV+28
SDWASR06 EQU   SDWASRSV+24
SDWASR05 EQU   SDWASRSV+20
SDWASR04 EQU   SDWASRSV+16
SDWASR03 EQU   SDWASRSV+12
SDWASR02 EQU   SDWASRSV+8
SDWASR01 EQU   SDWASRSV+4
SDWASR00 EQU   SDWASRSV
SDWATRN2 EQU   SDWAAEC2+4
SDWAIPC2 EQU   SDWAICD2
SDWAIMC2 EQU   SDWAICD2
SDWAIPR2 EQU   SDWAICD2
@NM00158 EQU   SDWAINC2
@NM00157 EQU   SDWAILC2
SDWAIL2  EQU   SDWAILC2
@NM00156 EQU   SDWAILC2
@NM00155 EQU   SDWAAEC2
SDWAADD2 EQU   SDWANXT2+1
@NM00154 EQU   SDWANXT2
@NM00153 EQU   SDWAEC2+3
SDWASGN2 EQU   SDWAINT2
SDWAEXP2 EQU   SDWAINT2
SDWADEC2 EQU   SDWAINT2
SDWAFPO2 EQU   SDWAINT2
SDWACC2  EQU   SDWAINT2
@NM00152 EQU   SDWAINT2
SDWAPGM2 EQU   SDWAMWP2
SDWAWAT2 EQU   SDWAMWP2
SDWAMCK2 EQU   SDWAMWP2
SDWAECT2 EQU   SDWAMWP2
SDWAKEY2 EQU   SDWAMWP2
SDWAEXT2 EQU   SDWAEMK2
SDWAIO2  EQU   SDWAEMK2
SDWATRM2 EQU   SDWAEMK2
@NM00151 EQU   SDWAEMK2
SDWAPER2 EQU   SDWAEMK2
@NM00150 EQU   SDWAEMK2
SDWATRAN EQU   SDWAAEC1+4
SDWAIPC1 EQU   SDWAICD1
SDWAIMC1 EQU   SDWAICD1
SDWAIPR1 EQU   SDWAICD1
@NM00149 EQU   SDWAINC1
@NM00148 EQU   SDWAILC1
SDWAIL1  EQU   SDWAILC1
@NM00147 EQU   SDWAILC1
@NM00146 EQU   SDWAAEC1
SDWAADD1 EQU   SDWANXT1+1
@NM00145 EQU   SDWANXT1
@NM00144 EQU   SDWAEC1+3
SDWASGN1 EQU   SDWAINT1
SDWAEXP1 EQU   SDWAINT1
SDWADEC1 EQU   SDWAINT1
SDWAFPO1 EQU   SDWAINT1
SDWACC1  EQU   SDWAINT1
@NM00143 EQU   SDWAINT1
SDWAPGM1 EQU   SDWAMWP1
SDWAWAT1 EQU   SDWAMWP1
SDWAMCK1 EQU   SDWAMWP1
SDWAECT1 EQU   SDWAMWP1
SDWAKEY1 EQU   SDWAMWP1
SDWAEXT1 EQU   SDWAEMK1
SDWAIO1  EQU   SDWAEMK1
SDWATRM1 EQU   SDWAEMK1
@NM00142 EQU   SDWAEMK1
SDWAPER1 EQU   SDWAEMK1
@NM00141 EQU   SDWAEMK1
SDWAIOBR EQU   SDWA+100
SDWAEPA  EQU   SDWA+96
@NM00140 EQU   SDWANAME+4
SDWARBAD EQU   SDWANAME
SDWAGR14 EQU   SDWAGRSV+56
SDWAGR13 EQU   SDWAGRSV+52
SDWAGR12 EQU   SDWAGRSV+48
SDWAGR11 EQU   SDWAGRSV+44
SDWAGR10 EQU   SDWAGRSV+40
SDWAGR09 EQU   SDWAGRSV+36
SDWAGR08 EQU   SDWAGRSV+32
SDWAGR07 EQU   SDWAGRSV+28
SDWAGR06 EQU   SDWAGRSV+24
SDWAGR05 EQU   SDWAGRSV+20
SDWAGR04 EQU   SDWAGRSV+16
SDWAGR03 EQU   SDWAGRSV+12
SDWAGR02 EQU   SDWAGRSV+8
SDWAGR01 EQU   SDWAGRSV+4
SDWAGR00 EQU   SDWAGRSV
SDWANXTP EQU   SDWACTL2+5
SDWASGP  EQU   SDWAPMKP
SDWAEUP  EQU   SDWAPMKP
SDWADOP  EQU   SDWAPMKP
SDWAFPP  EQU   SDWAPMKP
SDWACCP  EQU   SDWAPMKP
SDWAILP  EQU   SDWAPMKP
SDWAINTP EQU   SDWACTL2+2
SDWASPVP EQU   SDWAMWPP
SDWAWATP EQU   SDWAMWPP
SDWAMCKP EQU   SDWAMWPP
@NM00139 EQU   SDWAMWPP
SDWAKEYP EQU   SDWAMWPP
SDWAEXTP EQU   SDWACMKP
SDWAIOP  EQU   SDWACMKP
SDWANXTA EQU   SDWACTL1+5
SDWASGA  EQU   SDWAPMKA
SDWAEUA  EQU   SDWAPMKA
SDWADOA  EQU   SDWAPMKA
SDWAFPA  EQU   SDWAPMKA
SDWACCA  EQU   SDWAPMKA
SDWAILA  EQU   SDWAPMKA
SDWAINTA EQU   SDWACTL1+2
SDWASPVA EQU   SDWAMWPA
SDWAWATA EQU   SDWAMWPA
SDWAMCKA EQU   SDWAMWPA
@NM00138 EQU   SDWAMWPA
SDWAKEYA EQU   SDWAMWPA
SDWAEXTA EQU   SDWACMKA
SDWAIOA  EQU   SDWACMKA
SDWACMPC EQU   SDWAABCC+1
@NM00137 EQU   SDWACMPF
SDWASTCC EQU   SDWACMPF
@NM00136 EQU   SDWACMPF
SDWASTEP EQU   SDWACMPF
SDWAREQ  EQU   SDWACMPF
ECBEVNT  EQU   ECBEXTND
@NM00135 EQU   ECBEXTND
@NM00134 EQU   ECBBYTE3
@NM00133 EQU   ECBEXTBA
@NM00132 EQU   ECBCC
ECBWAITB EQU   ECBCC
IOBERRCT EQU   IOBSTDRD+30
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBDCBPB EQU   IOBDCBPT+1
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBSTRTB EQU   IOBSTART+1
IOBSIOCC EQU   IOBSTART
IOBCSB7  EQU   IOBCSTAT
IOBCSB6  EQU   IOBCSTAT
IOBCSB5  EQU   IOBCSTAT
IOBCSB4  EQU   IOBCSTAT
IOBCSB3  EQU   IOBCSTAT
IOBCSB2  EQU   IOBCSTAT
IOBCSB1  EQU   IOBCSTAT
IOBCSB0  EQU   IOBCSTAT
IOBUSB7  EQU   IOBUSTAT
IOBUSB6  EQU   IOBUSTAT
IOBUSB5  EQU   IOBUSTAT
IOBUSB4  EQU   IOBUSTAT
IOBUSB3  EQU   IOBUSTAT
IOBUSB2  EQU   IOBUSTAT
IOBUSB1  EQU   IOBUSTAT
IOBUSB0  EQU   IOBUSTAT
IOBLOG   EQU   IOBFL3
IOBJAM   EQU   IOBICL
IOBMSG   EQU   IOBFL3
IOBSDR   EQU   IOBCNC
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBPB EQU   IOBECBPT+1
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B1  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBUNREL EQU   IOBFLAG1
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
DEBXRV40 EQU   DEBXTN+28
DEBXOPNJ EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXDSSI EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCEAD  EQU   DEBCEA+1
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOEAD EQU   DEBEOEA+1
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBRSV19 EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00131 EQU   DEBACS08+12
@NM00130 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00129 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00128 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBLRECL EQU   DEBACSMD+14
DEBBLKSI EQU   DEBACSMD+12
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBBINUM EQU   DEBDASD+4
DEBUCBA  EQU   DEBUCBAD+1
DEBAPPB  EQU   DEBAPPAD+1
DEBDCBB  EQU   DEBDCBAD+1
DEBDEBID EQU   DEBPROTG
DEBECBB  EQU   DEBECBAD+1
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBNMEXT EQU   DEBUSRPG
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
JFCBXNXT EQU   JFCBX+172
@NM00127 EQU   JFCBX+144
JFCBXDEV EQU   JFCBX+140
JFCBXNAM EQU   JFCBX+96
@NM00126 EQU   JFCBX+94
JFCBXVOL EQU   JFCBX+4
@NM00125 EQU   JFCBX+3
JFCBXTTR EQU   JFCBX
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00121 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
@NM00120 EQU   IHADCS44+10
DCBXENDA EQU   IHADCS44+8
DCBCENDA EQU   IHADCS44+6
DCBSIOA  EQU   IHADCS44+4
DCBPCIA  EQU   IHADCS44+2
DCBEOEA  EQU   IHADCS44
@NM00119 EQU   IHADCS28+1
@NM00118 EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
@NM00117 EQU   DCBOPTCD
DCBDEBA  EQU   DCBDEBAD+1
@NM00116 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00115 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00114 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00113 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00112 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00111 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00110 EQU   DCBDSRG1
@NM00109 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00108 EQU   IHADCS01+5
@NM00107 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00106 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00105 EQU   IHADCB
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBFCBPE EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00104
UCBHALI  EQU   @NM00104
UCBRSV09 EQU   @NM00104
UCBRSV08 EQU   @NM00104
UCBRSV07 EQU   @NM00104
UCBRSV06 EQU   @NM00104
UCBRSV05 EQU   @NM00104
UCBRSV04 EQU   @NM00104
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00101 EQU   UCB
PTR1     EQU   AUTOARAY+8
ASIZE    EQU   AUTOARAY+6
STATUS   EQU   AUTOARAY+4
AREAID   EQU   AUTOARAY
GPLAST   EQU   SAHIST+4
GPFIRST  EQU   SAHIST
@NM00100 EQU   IOCRCV
IOCRCVRA EQU   IOCRCV
IOCRCVXM EQU   IOCRCV
IOCVLN   EQU   IOCSEX+42
IOCDNM   EQU   IOCSEX+40
IOCDLM   EQU   IOCSEX+36
IOCMODEX EQU   IOCMOD
IOCMODRP EQU   IOCMOD
IOCMODXM EQU   IOCMOD
IOCMODUB EQU   IOCMOD
IOCMODRG EQU   IOCMOD
IOCMODDY EQU   IOCMOD
IOCMODRR EQU   IOCMOD
IOCMODPD EQU   IOCMOD
IOCINFR1 EQU   IOCINF
IOCINFCT EQU   IOCINF
IOCINFDO EQU   IOCINF
IOCINFAC EQU   IOCINF
IOCINFQX EQU   IOCINF
IOCINFND EQU   IOCINF
IOCINFAE EQU   IOCINF
IOCINFPT EQU   IOCINF
@NM00099 EQU   IOCDEV
IOCDEVUR EQU   IOCDEV
IOCDEVMT EQU   IOCDEV
IOCDEVDA EQU   IOCDEV
@NM00098 EQU   IOCFLG
IOCFLGSP EQU   IOCFLG
IOCFLGOE EQU   IOCFLG
IOCFLGOP EQU   IOCFLG
IOCFLGIO EQU   IOCFLG
IOCFLGEF EQU   IOCFLG
IOCFLGDF EQU   IOCFLG
IOCFLGEX EQU   IOCFLG
IOCSID   EQU   IOCSEX+28
IOCNIO   EQU   IOCSEX+24
@NM00097 EQU   IOCXPM+2
IOCEXL   EQU   IOCXPM
IOCEXA   EQU   IOCXAD
IOCWKA   EQU   IOCSEX+12
IOCLRP   EQU   IOCSEX+10
IOCCBL   EQU   IOCSEX+8
IOCDEC   EQU   IOCRPL
IOCCBA   EQU   IOCSEX
@NM00096 EQU   IODATA+64
IODAEI   EQU   IODATA+60
@NM00095 EQU   IODATA+56
IODOCS   EQU   IODATA+48
IODICS   EQU   IODATA+44
IODOSO   EQU   IODATA+40
IODOSS   EQU   IODATA+36
IODEOD   EQU   IODATA+32
@NM00094 EQU   IODATA+30
@NM00093 EQU   IODATA+28
IODOEV   EQU   IODATA+24
IODIEV   EQU   IODATA+20
IODINC   EQU   IODSID+2
IODMID   EQU   IODSID
IODXTN   EQU   IODATA+12
IODADD   EQU   IODATA+8
IODMSG   EQU   IODATA+4
IODIOC   EQU   IODATA
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00092 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00091 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00090 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00089 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00088 EQU   VSDSCR+5
@NM00087 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
@NM00086 EQU   VSDSTAT+29
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00085 EQU   VSDFLG2
VSDRACF  EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00084 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00083 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00082 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00081 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00080 EQU   VSDVTOC
@NM00079 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00078 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00077 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00076 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00075 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00072 EQU   STARETRY
@NM00071 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STAEXSAV EQU   STAEPARM+40
STARTTR  EQU   STAEPARM+32
@NM00070 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00069 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00068 EQU   RCTAGL+10
@NM00067 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00066 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00065 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00064 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00063 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00062 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00061 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00060 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00059 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00058 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
@NM00057 EQU   EXPARRAY+5
EXPHEAD  EQU   EXPARG
@NM00056 EQU   EXSPACE+8
@NM00055 EQU   EXSPACE+6
@NM00054 EQU   EXSPACE+4
@NM00053 EQU   EXSPACE+1
@NM00052 EQU   EXSPACE
@NM00051 EQU   EXWRARG+31
EXRWDARE EQU   EXWRARG+16
EXRWRES  EQU   EXWRARG
@NM00050 EQU   EXGARG+29
EXGHEAD  EQU   EXGARG
@NM00049 EQU   EXFLG
@NM00048 EQU   EXOPT
EXOHEAD  EQU   EXOARG
@NM00047 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00046 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00045 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00044 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00043 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00042 EQU   CMMSG+7
@NM00041 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00040 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00039 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00038 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00037 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00036 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00035 EQU   ERCNVTAB+4
@NM00034 EQU   ERCNVTAB+3
@NM00033 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00032 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00031 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00030 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00029 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00028 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00027 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00026 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00025 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00024 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00023 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00022 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00021 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00020 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00019 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00018 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00017+1
UNITCHA  EQU   @NM00017
UNITUCB  EQU   UNITABL
RACFVOLS EQU   RACFAGL+16
RACFCLN  EQU   RACFAGL+12
RACFPROF EQU   RACFAGL+8
RACFENT  EQU   RACFAGL+4
@NM00016 EQU   RACFFLG4
@NM00015 EQU   RACFFLG3
RACFPRF  EQU   RACFFLG3
@NM00014 EQU   RACFFLG3
@NM00013 EQU   RACFFLG2
RACFTRD  EQU   RACFFLG2
RACFTUPD EQU   RACFFLG2
RACFTCTL EQU   RACFFLG2
@NM00012 EQU   RACFFLG2
RACFTALT EQU   RACFFLG2
RACFCSA  EQU   RACFFLG1
RACFLOGN EQU   RACFFLG1
RACFLOGF EQU   RACFFLG1
@NM00011 EQU   RACFFLG1
RACFDSTV EQU   RACFFLG1
@NM00010 EQU   RACFFLG1
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00945 EQU   @RC00928
@RF01145 EQU   @RC01126
@RF01267 EQU   @RC01250
@RC01262 EQU   @RC01250
@RC01257 EQU   @RC01250
@RC01550 EQU   @RC01532
@RC01631 EQU   @RC01611
@RC01637 EQU   @RC01611
@RC01736 EQU   @RC01732
@ENDDATA EQU   *
         END   IDCIO05,(C'PLS1440',0701,77354)

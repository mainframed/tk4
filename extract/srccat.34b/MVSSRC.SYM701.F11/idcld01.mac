         TITLE '************* IDCLD01: LISTDSET FSR ********************
               *********'
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCLD01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCLD01   76.306'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0332
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF IDCLD01 MODULE. THIS SECTION     @Z40LB26*/
*   /* INITIALIZES, CHECKS THE LEVEL PARAMETER FOR           @Z40LB26*/
*   /* VALIDITY, CALLS A PROCEDURE TO CALCULATE AN EXPIRA-   @Z40LB26*/
*   /* TION OR CREATION DATE, OPENS AND CLOSES THE ALTERNATE @Z40LB26*/
*   /* OUTPUT DATA SET, CALLS THE CORRECT PROCEDURE TO       @Z40LB26*/
*   /* EXECUTE THE FUNCTION REQUESTED ON THE COMMAND, AND    @Z40LB26*/
*   /* SETS THE LASTCOND FIELD.                              @Z40LB26*/
*   /*                                                       @Z40LB26*/
*   /* ESTABLISH TRACE POINT AND FULL REGION DUMP POINT      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0332
*   OLDERID2=NEWERID2;                                             0332
         L     @15,@PC00001                                        0332
         L     @14,GDTTR2(,@15)                                    0332
         MVC   @TS00001(95),NEWERID2(@14)                          0332
         MVC   OLDERID2(95,@14),@TS00001                           0332
*   NEWID2='LD01';                  /*                       @Z40LB26*/
         MVC   NEWID2(4,@14),@CC01376                              0333
*   IF GDTDBG=NULLPTR THEN                                         0334
         L     @15,GDTDBG(,@15)                                    0334
         LTR   @15,@15                                             0334
         BZ    @RT00334                                            0334
*     ;                                                            0335
*   ELSE                                                           0336
*     CALL IDCDB010(GDTTBL,'LDST'); /*                       @Z40LB26*/
*                                                                  0336
         L     @15,@PC00001                                        0336
         ST    @15,@AL00001                                        0336
         LA    @14,@CC01564                                        0336
         ST    @14,@AL00001+4                                      0336
         MVI   @AL00001+4,X'80'                                    0336
         L     @15,GDTDBG(,@15)                                    0336
         LA    @01,@AL00001                                        0336
         BALR  @14,@15                                             0336
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESSABILITY TO UPRINT AGRUMENT LIST            @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB26*/
*                                                                  0337
@RT00334 LA    @15,DARGAREA                                        0337
         ST    @15,DDSTRU                                          0337
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO FLAG AREAS AND IOCS POINTER FOR ALTERNATE        @Z40LB26*/
*   /* PRINT FILE OR SYSPRINT DATA SET.                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*   COMFLAGS=''B;                   /*                       @Z40LB26*/
         MVI   COMFLAGS,X'00'                                      0338
*   INTERFLG=''B;                   /*                       @Z40LB26*/
         MVI   INTERFLG,X'00'                                      0339
*   PRINTIT=NULLPTR;                /* INIT ALT IOCS PTR     @Z40LB26*/
*                                                                  0340
         SLR   @14,@14                                             0340
         ST    @14,PRINTIT                                         0340
*   /*****************************************************************/
*   /*                                                               */
*   /* BLANK OUT SUB-TITLE LINES BEFORE USE                  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   STGRPUSE=BLANK;                 /*                       @Z40LB26*/
         MVI   STGRPUSE+1,C' '                                     0341
         MVC   STGRPUSE+2(119),STGRPUSE+1                          0341
         MVI   STGRPUSE,C' '                                       0341
*   STGRPSTA=BLANK;                 /*                       @Z40LB26*/
         MVI   STGRPSTA+1,C' '                                     0342
         MVC   STGRPSTA+2(119),STGRPSTA+1                          0342
         MVI   STGRPSTA,C' '                                       0342
*   STVOLUSE=BLANK;                 /*                       @Z40LB26*/
         MVI   STVOLUSE+1,C' '                                     0343
         MVC   STVOLUSE+2(119),STVOLUSE+1                          0343
         MVI   STVOLUSE,C' '                                       0343
*   STVOLSTA=BLANK;                 /*                       @Z40LB26*/
         MVI   STVOLSTA+1,C' '                                     0344
         MVC   STVOLSTA+2(119),STVOLSTA+1                          0344
         MVI   STVOLSTA,C' '                                       0344
*   STLGND=BLANK;                   /*                       @Z40LB26*/
*                                                                  0345
         MVI   STLGND+1,C' '                                       0345
         MVC   STLGND+2(119),STLGND+1                              0345
         MVI   STLGND,C' '                                         0345
*   /*****************************************************************/
*   /*                                                               */
*   /* INITILIZE NAME OF LAST GROUP PROCESSED TO ZERO        @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0346
*   OLDGROUP=''B;                   /*                       @Z40LB26*/
*                                                                  0346
         XC    OLDGROUP(8),OLDGROUP                                0346
*   /*****************************************************************/
*   /*                                                               */
*   /* INITILIZE FIELDS IN THE UREST ARGUMENT LIST           @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0347
*   PCRSST=SUBTITLE;                /* INDIC CHANGE SUB-TITLE      0347
*                                                            @Z40LB26*/
         MVC   PCRSST(2),@CC01523                                  0347
*   PCRSTLC=LINECNT;                /* NO LINES IN SUB-TITLE @Z40LB26*/
*                                                                  0348
         MVC   PCRSTLC(2),@CH00222                                 0348
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESSABILITY TO VOLUME RECORD AND GROUP RECORD  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   BASEVPTR=ADDR(VOLREC);          /*                       @Z40LB26*/
         LA    BASEVPTR,VOLREC                                     0349
*   GROUPPTR=ADDR(GRPREC);          /*                       @Z40LB26*/
*                                                                  0350
         LA    @07,GRPREC                                          0350
         ST    @07,GROUPPTR                                        0350
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSING TO PARAMETER LISTS                  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   RESPECIFY                                                      0351
*     ALLAGL BASED(ADDR(ALOCAREA)); /*                       @Z40LB26*/
*   RESPECIFY                                                      0352
*     VS3AGL BASED(ADDR(AREAVS3));  /*                       @Z40LB26*/
*   RESPECIFY                                                      0353
*     SELAGL BASED(ADDR(SLTAREA));  /*                       @Z40LB26*/
*   RESPECIFY                                                      0354
*     CKAGL BASED(ADDR(CHKAREA));   /*                       @Z40LB26*/
*   RESPECIFY                                                      0355
*     DATESAGL BASED(ADDR(DTSAREA));/*                       @Z40LB26*/
*   RESPECIFY                                                      0356
*     SRTAGL BASED(ADDR(SORTAREA)); /*                       @Z40LB26*/
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB26*/
         ST    @15,DDSTRU                                          0357
*   OPNPTR=ADDR(OPNAREA);           /*                       @Z40LB26*/
         LA    OPNPTR,OPNAREA                                      0358
*   RESPECIFY                                                      0359
*     VSDBLOCK BASED(LISTADDR);     /*                       @Z40LB26*/
*                                                                  0360
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE LEVEL PARAMETER WAS SPECIFIED AND THE LAST     @Z40LB26*/
*   /* CHARACTER IS AN ASTERISK, ISSUE MESSAGE IDC3113I      @Z40LB26*/
*   /* AND SET THE LASTCOND FIELD                            @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*   IF ADDR(LEVEL)^=NULLPTR&LEVELPOS=LEVELLEN THEN/*         @Z40LB26*/
         L     @07,@PC00001+4                                      0360
         L     @07,FDTPTR+20(,@07)                                 0360
         CR    @07,@14                                             0360
         BE    @RF00360                                            0360
         CLC   LEVELPOS(1,@07),LEVELLEN(@07)                       0360
         BNE   @RF00360                                            0360
*     DO;                           /*                       @Z40LB26*/
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               0362
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@15),@CC01475                            0363
*       DARGSENT=MSG3113I;          /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'45'                                 0364
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
         L     @15,@PC00001                                        0365
         ST    @15,@AL00001                                        0365
         LA    @14,@CF00117                                        0365
         ST    @14,@AL00001+4                                      0365
         LA    @14,DDSTRU                                          0365
         ST    @14,@AL00001+8                                      0365
         MVI   @AL00001+8,X'80'                                    0365
         L     @15,GDTPRT(,@15)                                    0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*       LASTCOND=LASTCC12;          /*                       @Z40LB26*/
         L     @15,@PC00001+8                                      0366
         MVC   LASTCOND(2,@15),@CH00035                            0366
*     END;                          /*                       @Z40LB26*/
*                                                                  0367
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FILE PARAMETER WAS SPECIFIED ON THE COMMAND,   @Z40LB26*/
*   /* ISSUE THE UMSSUNIT MACRO TO CHECK THAT IT IS          @Z40LB26*/
*   /* A VIRTUAL DEVICE AND A DEMOUNTABLE UNIT. SAVE THE     @Z40LB26*/
*   /* RETURN CODE AND SET THE LASTCOND FIELD.               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Z40LB26*/
@RF00360 SLR   @15,@15                                             0368
         L     @14,@PC00001+4                                      0368
         L     @14,FDTPTR+44(,@14)                                 0368
         CR    @14,@15                                             0368
         BE    @RF00368                                            0368
*     DO;                           /*                       @Z40LB26*/
*       CKAGL=''B;                  /*                       @Z40LB26*/
         LA    @02,CHKAREA                                         0370
         XC    CKAGL(29,@02),CKAGL(@02)                            0370
*       CKTESTVT=ON;                /* TEST FOR VIRTUAL      @Z40LB26*/
*       CKDMTABL=ON;                /* TEST FOR DEMOUNTABLE  @Z40LB26*/
         OI    CKTESTVT(@02),B'10100000'                           0372
*       CKDDNAME=FILEVAL;           /*                       @Z40LB26*/
         MVC   CKDDNAME(8,@02),FILEVAL(@14)                        0373
*       CKUCBPTR=ADDR(FILEUCB);     /* UCB ADDRESS TO BE     @Z40LB26
*                                      RETURNED              @Z40LB26*/
         LA    @14,FILEUCB                                         0374
         ST    @14,CKUCBPTR(,@02)                                  0374
*       FILEUCB=NULLPTR;            /*                       @Z40LB26*/
         ST    @15,FILEUCB                                         0375
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB26*/
         L     @15,@PC00001                                        0376
         ST    @15,@AL00001                                        0376
         LA    @14,CHECK                                           0376
         ST    @14,@AL00001+4                                      0376
         ST    @02,@AL00001+8                                      0376
         MVI   @AL00001+8,X'80'                                    0376
         L     @15,GDTUNT(,@15)                                    0376
         LA    @01,@AL00001                                        0376
         BALR  @14,@15                                             0376
*       RESPECIFY                                                  0377
*         RTNREG RSTD;                                             0377
*       TESTRC=RTNREG;                                             0378
         LR    TESTRC,RTNREG                                       0378
*       RESPECIFY                                                  0379
*         RTNREG UNRSTD;            /*                       @Z40LB26*/
*       IF TESTRC^=0 THEN           /*                       @Z40LB26*/
         LTR   TESTRC,TESTRC                                       0380
         BZ    @RF00380                                            0380
*         LASTCOND=LASTCC12;        /*                       @Z40LB26*/
         L     @15,@PC00001+8                                      0381
         MVC   LASTCOND(2,@15),@CH00035                            0381
*     END;                          /*                       @Z40LB26*/
*                                                                  0382
@RF00380 DS    0H                                                  0383
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF AN ALTERNATE OUTPUT DATA SET WAS      @Z40LB26*/
*   /* SPECIFIED. IF SPECIFIED, OPEN IT AND SET LASTCOND     @Z40LB26*/
*   /* FIELD, IF AN ERROR OCCURS.                            @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   IF(ADDR(OFILE)^=NULLPTR×ADDR(ODS)^=NULLPTR)&/*           @Z40LB26*/
*       LASTCOND=LASTCC00 THEN      /*                       @Z40LB26*/
@RF00368 SLR   @15,@15                                             0383
         L     @14,@PC00001+4                                      0383
         C     @15,FDTPTR+68(,@14)                                 0383
         BNE   @GL00002                                            0383
         C     @15,FDTPTR+72(,@14)                                 0383
         BE    @RF00383                                            0383
@GL00002 SLR   @15,@15                                             0383
         L     @14,@PC00001+8                                      0383
         CH    @15,LASTCOND(,@14)                                  0383
         BNE   @RF00383                                            0383
*     DO;                           /*                       @Z40LB26*/
*       OPNAREA=''B;                /*                       @Z40LB26*/
         XC    OPNAREA(48),OPNAREA                                 0385
*       OPNOPTOT=ON;                /* OPEN FOR OUTPUT       @Z40LB26*/
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0386
*       OPNIOC=ADDR(PRINTIT);       /* SET IOCS POINTER      @Z40LB26*/
         LA    @14,PRINTIT                                         0387
         ST    @14,OPNIOC(,OPNPTR)                                 0387
*       OPNMODAC=ON;                /* ASA CARRIAGE CONTROL  @Z40LB26*/
         OI    OPNMODAC(OPNPTR),B'01000000'                        0388
*       IF ADDR(OFILE)^=NULLPTR THEN/*                       @Z40LB26*/
         L     @14,@PC00001+4                                      0389
         L     @14,FDTPTR+68(,@14)                                 0389
         CR    @14,@15                                             0389
         BE    @RF00389                                            0389
*         OPNDDN=ADDR(OFILEVAL);    /* ADDRESS OF DDNAME     @Z40LB26*/
         LA    @15,OFILEVAL(,@14)                                  0390
         ST    @15,OPNDDN(,OPNPTR)                                 0390
*       ELSE                        /*                       @Z40LB26*/
*         OPNDSN=ADDR(ODSVAL);      /* ADDRESS OF DATA SET   @Z40LB26
*                                      NAME                  @Z40LB26*/
         B     @RC00389                                            0391
@RF00389 L     @15,@PC00001+4                                      0391
         L     @01,FDTPTR+72(,@15)                                 0391
         LA    @15,ODSVAL(,@01)                                    0391
         ST    @15,OPNDSN(,OPNPTR)                                 0391
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Z40LB26*/
@RC00389 L     @02,@PC00001                                        0392
         ST    @02,@AL00001                                        0392
         ST    OPNPTR,@AL00001+4                                   0392
         MVI   @AL00001+4,X'80'                                    0392
         L     @15,GDTOPN(,@02)                                    0392
         LA    @01,@AL00001                                        0392
         BALR  @14,@15                                             0392
*       RESPECIFY                                                  0393
*         RTNREG RSTD;                                             0393
*       TESTRC=RTNREG;                                             0394
         LR    TESTRC,RTNREG                                       0394
*       RESPECIFY                                                  0395
*         RTNREG UNRSTD;            /*                       @Z40LB26*/
*       IF TESTRC=4 THEN            /*                       @Z40LB26*/
         C     TESTRC,@CF00043                                     0396
         BNE   @RF00396                                            0396
*         LASTCOND=LASTCC12;        /*                       @Z40LB26*/
         L     @04,@PC00001+8                                      0397
         MVC   LASTCOND(2,@04),@CH00035                            0397
*     END;                          /*                       @Z40LB26*/
@RF00396 DS    0H                                                  0399
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALL CHECKS AND OPEN OF THE OUTPUT DATA SET WERE    @Z40LB26*/
*   /* SUCCESSFUL, CONTINUE WITH PROCESSING.                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   IF LASTCOND=LASTCC00 THEN       /*                       @Z40LB26*/
@RF00383 L     @04,@PC00001+8                                      0399
         LH    @04,LASTCOND(,@04)                                  0399
         LTR   @04,@04                                             0399
         BNZ   @RF00399                                            0399
*     DO;                           /*                       @Z40LB26*/
*                                                                  0400
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT MACRO TO READ INTO STORAGE           @Z40LB26*/
*       /* THE CONSTANTS TO BE INSERTED INTO THE REPORTS     @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0401
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               0401
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/
         L     @04,DDSTRU                                          0402
         MVC   DARGSMOD(3,@04),@CC01477                            0402
*       DARGSENT=PRTCON;            /*                       @Z40LB26*/
         MVI   DARGSENT(@04),X'0C'                                 0403
*       DARGRETP=ADDR(PRINTCON);    /* AREA TO RETURN CONS   @Z40LB26*/
         LA    @15,PRINTCON                                        0404
         ST    @15,DARGRETP(,@04)                                  0404
*       DARGRETL=LENGTH(PRINTCON);  /*                       @Z40LB26*/
         MVC   DARGRETL(2,@04),@CH01501                            0405
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
*                                                                  0406
         L     @04,@PC00001                                        0406
         ST    @04,@AL00001                                        0406
         LA    @15,@CF00117                                        0406
         ST    @15,@AL00001+4                                      0406
         LA    @15,DDSTRU                                          0406
         ST    @15,@AL00001+8                                      0406
         MVI   @AL00001+8,X'80'                                    0406
         L     @15,GDTPRT(,@04)                                    0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXPIRATION PARAMETERS WERE SPECIFIED ON        @Z40LB26*/
*       /* THE COMMAND, CALL THE DATES PROCEDURE TO          @Z40LB26*/
*       /* CALCULATE A DATE FOR COMPARISON                   @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0407
*       IF ADDR(EXPIR)^=NULLPTR×ADDR(EXPDT)^=NULLPTR/*       @Z40LB26*/
*         THEN                      /*                       @Z40LB26*/
         SLR   @04,@04                                             0407
         L     @15,@PC00001+4                                      0407
         C     @04,FDTPTR+32(,@15)                                 0407
         BNE   @RT00407                                            0407
         C     @04,FDTPTR+28(,@15)                                 0407
         BE    @RF00407                                            0407
@RT00407 DS    0H                                                  0408
*         DO;                       /*                       @Z40LB26*/
*           DATESAGL=''B;           /*                       @Z40LB26*/
         LA    @04,DTSAREA                                         0409
         XC    DATESAGL(21,@04),DATESAGL(@04)                      0409
*           DATRETRN=ADDR(EXPDATE); /* PLACE TO RETURN       @Z40LB26
*                                      DATE                  @Z40LB26*/
*                                                                  0410
         LA    @15,EXPDATE                                         0410
         ST    @15,DATRETRN(,@04)                                  0410
*           /*********************************************************/
*           /*                                                       */
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0411
*           IF ADDR(EXPIR)^=NULLPTR THEN/*                   @Z40LB26*/
         L     @15,@PC00001+4                                      0411
         L     @15,FDTPTR+32(,@15)                                 0411
         LTR   @15,@15                                             0411
         BZ    @RF00411                                            0411
*             DO;                   /*                       @Z40LB26*/
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB26*/
         OI    DATDAYOP(@04),B'00010000'                           0413
*               DATDAYS=EXPIRVAL;   /* NUMBER OF DAYS        @Z40LB26*/
         L     @15,EXPIRVAL(,@15)                                  0414
         ST    @15,DATDAYS(,@04)                                   0414
*               DATADD=ON;          /* ADD DAYS TO CURRENT   @Z40LB26
*                                      DATE                  @Z40LB26*/
         OI    DATADD(@04),B'10000000'                             0415
*             END;                  /*                       @Z40LB26*/
*           ELSE                    /*                       @Z40LB26*/
*             DO;                   /*                       @Z40LB26*/
         B     @RC00411                                            0417
@RF00411 DS    0H                                                  0418
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB26*/
         LA    @04,DTSAREA                                         0418
         OI    DATDTEOP(@04),B'00100000'                           0418
*               DATDATE=EXPDTVAL;   /* DATE                  @Z40LB26*/
         L     @15,@PC00001+4                                      0419
         L     @01,FDTPTR+28(,@15)                                 0419
         L     @15,EXPDTVAL(,@01)                                  0419
         ST    @15,DATDATE(,@04)                                   0419
*             END;                  /*                       @Z40LB26*/
*           CALL DATES(DATESAGL);   /*                       @Z40LB26*/
@RC00411 LA    @04,DTSAREA                                         0421
         ST    @04,@AL00001                                        0421
         LA    @01,@AL00001                                        0421
         BAL   @14,DATES                                           0421
*         END;                      /*                       @Z40LB26*/
*                                                                  0423
*       /*************************************************************/
*       /*                                                           */
*       /* IF CREATION PARAMETERS WERE SPECIFIED ON THE      @Z40LB26*/
*       /* COMMAND, CALL THE DATES PROCEDURE TO CALCULATE    @Z40LB26*/
*       /* A DATE FOR COMPARISON                             @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0423
*       IF ADDR(CREAT)^=NULLPTR×ADDR(CREDT)^=NULLPTR/*       @Z40LB26*/
*         THEN                      /*                       @Z40LB26*/
@RF00407 SLR   @04,@04                                             0423
         L     @15,@PC00001+4                                      0423
         C     @04,FDTPTR+40(,@15)                                 0423
         BNE   @RT00423                                            0423
         C     @04,FDTPTR+36(,@15)                                 0423
         BE    @RF00423                                            0423
@RT00423 DS    0H                                                  0424
*         DO;                       /*                       @Z40LB26*/
*           DATESAGL=''B;           /*                       @Z40LB26*/
         LA    @04,DTSAREA                                         0425
         XC    DATESAGL(21,@04),DATESAGL(@04)                      0425
*           DATRETRN=ADDR(CREDATE); /* PLACE TO RETURN       @Z40LB26
*                                      DATE                  @Z40LB26*/
*                                                                  0426
         LA    @15,CREDATE                                         0426
         ST    @15,DATRETRN(,@04)                                  0426
*           /*********************************************************/
*           /*                                                       */
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0427
*           IF ADDR(CREAT)^=NULLPTR THEN/*                   @Z40LB26*/
         L     @15,@PC00001+4                                      0427
         L     @15,FDTPTR+40(,@15)                                 0427
         LTR   @15,@15                                             0427
         BZ    @RF00427                                            0427
*             DO;                   /*                       @Z40LB26*/
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB26*/
         OI    DATDAYOP(@04),B'00010000'                           0429
*               DATDAYS=CREATVAL;   /* NUMBER OF DAYS        @Z40LB26*/
         L     @15,CREATVAL(,@15)                                  0430
         ST    @15,DATDAYS(,@04)                                   0430
*               DATSUB=ON;          /* SUBTRACT DAYS FROM    @Z40LB26
*                                      CURRENT DATE          @Z40LB26*/
         OI    DATSUB(@04),B'01000000'                             0431
*             END;                  /*                       @Z40LB26*/
*           ELSE                    /*                       @Z40LB26*/
*             DO;                   /*                       @Z40LB26*/
         B     @RC00427                                            0433
@RF00427 DS    0H                                                  0434
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB26*/
         LA    @04,DTSAREA                                         0434
         OI    DATDTEOP(@04),B'00100000'                           0434
*               DATDATE=CREDTVAL;   /* DATE                  @Z40LB26*/
         L     @15,@PC00001+4                                      0435
         L     @01,FDTPTR+36(,@15)                                 0435
         L     @15,CREDTVAL(,@01)                                  0435
         ST    @15,DATDATE(,@04)                                   0435
*             END;                  /*                       @Z40LB26*/
*           CALL DATES(DATESAGL);   /*                       @Z40LB26*/
@RC00427 LA    @04,DTSAREA                                         0437
         ST    @04,@AL00001                                        0437
         LA    @01,@AL00001                                        0437
         BAL   @14,DATES                                           0437
*         END;                      /*                       @Z40LB26*/
*                                                                  0439
*       /*************************************************************/
*       /*                                                           */
*       /* CALL THE PROPER PROCEDURE TO PROCESS THE VOLUMES  @Z40LB26*/
*       /* BASED ON THE PARAMETER SPECIFIED ON THE COMMAND:  @Z40LB26*/
*       /* VOLUMES, GROUPS, NONGROUPED, ALLVOLUMES, OR       @Z40LB26*/
*       /* ALLGROUPS                                         @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0439
*       IF ADDR(VOL)^=NULLPTR THEN  /*                       @Z40LB26*/
@RF00423 L     @04,@PC00001+4                                      0439
         L     @04,FDTPTR(,@04)                                    0439
         LTR   @04,@04                                             0439
         BZ    @RF00439                                            0439
*         CALL SPECVOL;             /*                       @Z40LB26*/
         BAL   @14,SPECVOL                                         0440
*       ELSE                        /*                       @Z40LB26*/
*         IF ADDR(GRP)^=NULLPTR THEN/*                       @Z40LB26*/
         B     @RC00439                                            0441
@RF00439 L     @04,@PC00001+4                                      0441
         L     @04,FDTPTR+4(,@04)                                  0441
         LTR   @04,@04                                             0441
         BZ    @RF00441                                            0441
*           CALL SPECGRP;           /*                       @Z40LB26*/
         BAL   @14,SPECGRP                                         0442
*         ELSE                      /*                       @Z40LB26*/
*           IF ADDR(NGRPD)^=NULLPTR THEN/*                   @Z40LB26*/
         B     @RC00441                                            0443
@RF00441 L     @04,@PC00001+4                                      0443
         L     @04,FDTPTR+16(,@04)                                 0443
         LTR   @04,@04                                             0443
         BZ    @RF00443                                            0443
*             CALL NONGRPD;         /*                       @Z40LB26*/
         BAL   @14,NONGRPD                                         0444
*           ELSE                    /*                       @Z40LB26*/
*             IF ADDR(AGRP)^=NULLPTR THEN/*                  @Z40LB26*/
         B     @RC00443                                            0445
@RF00443 L     @04,@PC00001+4                                      0445
         L     @04,FDTPTR+12(,@04)                                 0445
         LTR   @04,@04                                             0445
         BZ    @RF00445                                            0445
*               CALL ALLGRPS;       /*                       @Z40LB26*/
         BAL   @14,ALLGRPS                                         0446
*             ELSE                  /*                       @Z40LB26*/
*               IF ADDR(AVOL)^=NULLPTR THEN/*                @Z40LB26*/
         B     @RC00445                                            0447
@RF00445 L     @04,@PC00001+4                                      0447
         L     @04,FDTPTR+8(,@04)                                  0447
         LTR   @04,@04                                             0447
         BZ    @RF00447                                            0447
*                 CALL ALLVOLS;     /*                       @Z40LB26*/
*                                                                  0448
         BAL   @14,ALLVOLS                                         0448
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE RETURN CODE AND SET THE LASTCOND         @Z40LB26*/
*       /* FIELD EQUAL TO THE RETURN CODE                    @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0449
*       RESPECIFY                                                  0449
*         RTNREG RSTD;                                             0449
@RF00447 DS    0H                                                  0449
@RC00445 DS    0H                                                  0449
@RC00443 DS    0H                                                  0449
@RC00441 DS    0H                                                  0449
@RC00439 DS    0H                                                  0450
*       TESTRC=RTNREG;                                             0450
         LR    TESTRC,RTNREG                                       0450
*       RESPECIFY                                                  0451
*         RTNREG UNRSTD;            /*                       @Z40LB26*/
*       LASTCOND=TESTRC;            /*                       @Z40LB26*/
*                                                                  0452
         L     @02,@PC00001+8                                      0452
         STH   TESTRC,LASTCOND(,@02)                               0452
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NEED TO CALL LEGEND ROUTINE              @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0453
*       IF LASTCOND<LASTCC12&ADDR(LGND)^=NULLPTR THEN/*      @Z40LB26*/
         L     @15,@PC00001+8                                      0453
         LH    @15,LASTCOND(,@15)                                  0453
         C     @15,@CF00035                                        0453
         BNL   @RF00453                                            0453
         L     @15,@PC00001+4                                      0453
         L     @15,FDTPTR+60(,@15)                                 0453
         LTR   @15,@15                                             0453
         BZ    @RF00453                                            0453
*         CALL LEGENDS;             /*                       @Z40LB26*/
         BAL   @14,LEGENDS                                         0454
*     END;                          /*                       @Z40LB26*/
@RF00453 DS    0H                                                  0456
*                                                                  0456
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MESSAGE IDC0001I IF THE LAST CONDITION CODE     @Z40LB26*/
*   /* IS < 12 OR ISSUE MESSAGE IDC3003I IF THE LAST         @Z40LB26*/
*   /* CONDITION CODE IS 12                                  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0456
*   DARGAREA=''B;                   /*                       @Z40LB26*/
@RF00399 XC    DARGAREA(76),DARGAREA                               0456
*   DARGSMOD=UV0MSG;                /*                       @Z40LB26*/
         L     @15,DDSTRU                                          0457
         MVC   DARGSMOD(3,@15),@CC01479                            0457
*   DARGDBP=ADDR(LASTCOND);         /*                       @Z40LB26*/
         L     @14,@PC00001+8                                      0458
         ST    @14,DARGDBP(,@15)                                   0458
*   DARGILP=LENGTH(LASTCOND);       /*                       @Z40LB26*/
         MVC   DARGILP(2,@15),@CH00156                             0459
*   IF LASTCOND<LASTCC12 THEN       /*                       @Z40LB26*/
         LH    @14,LASTCOND(,@14)                                  0460
         C     @14,@CF00035                                        0460
         BNL   @RF00460                                            0460
*     DARGSENT=MSG0001I;            /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'01'                                 0461
*   ELSE                            /*                       @Z40LB26*/
*     DARGSENT=MSG3003I;            /*                       @Z40LB26*/
         B     @RC00460                                            0462
@RF00460 L     @01,DDSTRU                                          0462
         MVI   DARGSENT(@01),X'03'                                 0462
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB26*/
*                                                                  0463
@RC00460 L     @15,@PC00001                                        0463
         ST    @15,@AL00001                                        0463
         LA    @14,@CF00117                                        0463
         ST    @14,@AL00001+4                                      0463
         LA    @14,DDSTRU                                          0463
         ST    @14,@AL00001+8                                      0463
         MVI   @AL00001+8,X'80'                                    0463
         L     @15,GDTPRT(,@15)                                    0463
         LA    @01,@AL00001                                        0463
         BALR  @14,@15                                             0463
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF NEED TO CLOSE OUTPUT DATA SET                  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0464
*   IF PRINTIT^=NULLPTR THEN        /*                       @Z40LB26*/
         L     @15,PRINTIT                                         0464
         LTR   @15,@15                                             0464
         BZ    @RF00464                                            0464
*     CALL IDCIOCL0(GDTTBL,PRINTIT);/*                       @Z40LB26*/
*                                                                  0465
         L     @15,@PC00001                                        0465
         ST    @15,@AL00001                                        0465
         LA    @14,PRINTIT                                         0465
         ST    @14,@AL00001+4                                      0465
         MVI   @AL00001+4,X'80'                                    0465
         L     @15,GDTCLS(,@15)                                    0465
         LA    @01,@AL00001                                        0465
         BALR  @14,@15                                             0465
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0466
*   IF GDTDBG=NULLPTR THEN                                         0466
@RF00464 L     @15,@PC00001                                        0466
         L     @15,GDTDBG(,@15)                                    0466
         LTR   @15,@15                                             0466
         BZ    @RT00466                                            0466
*     ;                                                            0467
*   ELSE                                                           0468
*     CALL IDCDB010(GDTTBL,'LDED'); /*                       @Z40LB26*/
*                                                                  0468
         L     @15,@PC00001                                        0468
         ST    @15,@AL00001                                        0468
         LA    @14,@CC01586                                        0468
         ST    @14,@AL00001+4                                      0468
         MVI   @AL00001+4,X'80'                                    0468
         L     @15,GDTDBG(,@15)                                    0468
         LA    @01,@AL00001                                        0468
         BALR  @14,@15                                             0468
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0469
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);/*                  @Z40LB26*/
@RT00466 L     @15,@PC00001                                        0469
         ST    @15,@AL00001                                        0469
         LA    @14,MODID                                           0469
         ST    @14,@AL00001+4                                      0469
         L     @14,@PC00001+8                                      0469
         ST    @14,@AL00001+8                                      0469
         MVI   @AL00001+8,X'80'                                    0469
         L     @15,GDTEPL(,@15)                                    0469
         LA    @01,@AL00001                                        0469
         BALR  @14,@15                                             0469
*                                                                  0470
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - SPECVOL                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/
*/*           TO READ EACH VOLUME RECORD SPECIFIED ON THE    @Z40LB30*/
*/*           LISTDSET COMMAND.  CALL PROCEDURES TO CHECK    @Z40LB30*/
*/*           IF THERE ARE ANY RECOVERY FLAGS ON AND         @Z40LB30*/
*/*           TO PROCESS THE VOLUME.  PRINT MESSAGE          @Z40LB30*/
*/*           IDC2074I IF THE VOLUME IS NOT ACTIVE,          @Z40LB30*/
*/*           FOLLOWED BY MESSAGE IDC2108I.  IF AN ERROR     @Z40LB30*/
*/*           OCCURS READING A VOLUME RECORD, PRINT MESSAGE  @Z40LB30*/
*/*           IDC2080I.                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERROR OCCURRED              @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME      @Z40LB30*/
*/*                           OR CLOSING VTOC                @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0470
*SPECVOL:                                                          0470
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
@EL00001 L     @13,4(,@13)                                         0470
@EF00001 L     @00,@SIZDATD                                        0470
         LR    @01,@08                                             0470
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0470
         BR    @14                                                 0470
SPECVOL  ST    @14,@SA00002                                        0470
*                                                                  0471
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0471
*   OLDERID2=NEWERID2;                                             0471
         L     @15,@PC00001                                        0471
         L     @15,GDTTR2(,@15)                                    0471
         MVC   @TS00001(95),NEWERID2(@15)                          0471
         MVC   OLDERID2(95,@15),@TS00001                           0471
*   NEWID2='LDSV';                  /*                       @Z40LB30*/
*                                                                  0472
         MVC   NEWID2(4,@15),@CC01590                              0472
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0473
         SLR   CC01,CC01                                           0473
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ A SPECIFIC   @Z40LB30*/
*   /* BASE VOLUME RECORD FROM THE INVENTORY AND TEST THAT   @Z40LB30*/
*   /* IT IS ACTIVE                                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0474
*   VOLRVVI=''B;                    /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0474
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/
         LA    @15,VOLRVVI                                         0475
         ST    @15,RVVIPTR                                         0475
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @14,RVVLEN                                          0476
         ST    @14,RVVLNGTH(,@15)                                  0476
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@15),X'87'                                  0477
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@15),@CH01761                            0478
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @14,VOLREC                                          0479
         ST    @14,RVVRTBUF(,@15)                                  0479
*   RVVRDR=ON;                      /* READ A RECORD         @Z40LB30*/
         OI    RVVRDR(@15),B'10000000'                             0480
*   RVVBVRCD=ON;                    /* BASE RECORD           @Z40LB30*/
         OI    RVVBVRCD(@15),B'10000000'                           0481
*   RVVACTV=ON;                     /* ACTIVE VOLUME         @Z40LB30*/
         OI    RVVACTV(@15),B'00000100'                            0482
*   RVVSVOL=ON;                     /* VOLUME SERIAL IS      @Z40LB30
*                                      SPECIFIED             @Z40LB30*/
         OI    RVVSVOL(@15),B'00000001'                            0483
*                                                                  0484
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE BASE VOLUME RECORD FOR EACH VOLUME SPECIFIED @Z40LB30*/
*   /* ON THE LISTDSET COMMAND                               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   DO INDEX=1 TO VOLCNT;           /*                       @Z40LB30*/
*                                                                  0484
         LA    @15,1                                               0484
         B     @DE00484                                            0484
@DL00484 DS    0H                                                  0485
*     /***************************************************************/
*     /*                                                             */
*     /* PUT THE VOLUME SERIAL IN THE IEZRVVI PARAMETER LIST @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0485
*     RVVOLUME=VOLVAL(INDEX);       /*                       @Z40LB30*/
*                                                                  0485
         L     @02,RVVIPTR                                         0485
         SLA   @15,3                                               0485
         L     @14,@PC00001+4                                      0485
         L     @01,FDTPTR(,@14)                                    0485
         ALR   @01,@15                                             0485
         AL    @01,@CF01781                                        0485
         MVC   RVVOLUME(6,@02),VOLVAL-3(@01)                       0485
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE USSC TO READ THE RECORD. SAVE THE RETURN      @Z40LB30*/
*     /* CODE                                                @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0486
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/
         L     @02,@PC00001                                        0486
         ST    @02,@AL00001                                        0486
         LA    @15,VVIC                                            0486
         ST    @15,@AL00001+4                                      0486
         LA    @15,RVVIPTR                                         0486
         ST    @15,@AL00001+8                                      0486
         LA    @15,VVICODE                                         0486
         ST    @15,@AL00001+12                                     0486
         MVI   @AL00001+12,X'80'                                   0486
         L     @15,GDTSSC(,@02)                                    0486
         LA    @01,@AL00001                                        0486
         BALR  @14,@15                                             0486
*     RESPECIFY                                                    0487
*       RTNREG RSTD;                                               0487
*     TESTRC=RTNREG;                                               0488
         LR    TESTRC,RTNREG                                       0488
*     RESPECIFY                                                    0489
*       RTNREG UNRSTD;              /*                       @Z40LB30*/
*                                                                  0489
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0490
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0490
         BNZ   @RF00490                                            0490
*       DO;                         /*                       @Z40LB30*/
*                                                                  0491
*         /***********************************************************/
*         /*                                                         */
*         /* CALL CKRECOV TO SEE IF ANY RECOVERY FLAGS ARE   @Z40LB30*/
*         /* ON IN THE RECORD AND THE VOLUME CANNOT BE       @Z40LB30*/
*         /* PROCESSED                                       @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0492
*         CALL CKRECOV;             /*                       @Z40LB30*/
         BAL   @14,CKRECOV                                         0492
*         RESPECIFY                                                0493
*           RTNREG RSTD;                                           0493
*         TESTRC=RTNREG;                                           0494
         LR    TESTRC,RTNREG                                       0494
*         RESPECIFY                                                0495
*           RTNREG UNRSTD;          /*                       @Z40LB30*/
*                                                                  0495
*         /***********************************************************/
*         /*                                                         */
*         /* ACCUMULATE THE HIGHEST RETURN CODE IN THE       @Z40LB30*/
*         /* INTERNAL CONDITION CODE AREA                    @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0496
*         CC01=MAX(CC01,TESTRC);    /*                       @Z40LB30*/
*                                                                  0496
         CR    CC01,TESTRC                                         0496
         BNL   *+6
         LR    CC01,TESTRC                                         0496
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO ERRORS WERE FOUND, CALL PROCVOL TO        @Z40LB30*/
*         /* PROCESS THE VOLUME. SAVE THE RETURN CODE        @Z40LB30*/
*         /* AND PUT THE HIGHEST RETURN CODE IN THE INTER-   @Z40LB30*/
*         /* NAL CONDITION CODE AREA                         @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0497
*         IF TESTRC=LASTCC00 THEN   /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0497
         BNZ   @RF00497                                            0497
*           DO;                     /*                       @Z40LB30*/
*             CALL PROCVOL;         /*                       @Z40LB30*/
         BAL   @14,PROCVOL                                         0499
*             RESPECIFY                                            0500
*               RTNREG RSTD;                                       0500
*             TESTRC=RTNREG;                                       0501
         LR    TESTRC,RTNREG                                       0501
*             RESPECIFY                                            0502
*               RTNREG UNRSTD;      /*                       @Z40LB30*/
*             CC01=MAX(CC01,TESTRC);/*                       @Z40LB30*/
*                                                                  0503
         CR    CC01,TESTRC                                         0503
         BNL   *+6
         LR    CC01,TESTRC                                         0503
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE RETURN CODE INDICATES A VOLUME WAS   @Z40LB30*/
*             /* PROCESSED, SET AN INDICATOR                 @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0504
*             IF TESTRC<LASTCC12 THEN/*                      @Z40LB30*/
         C     TESTRC,@CF00035                                     0504
         BNL   @RF00504                                            0504
*               ONEDONE=ON;         /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0505
*           END;                    /*                       @Z40LB30*/
*       END;                        /*                       @Z40LB30*/
*                                                                  0507
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE READ WAS NOT SUCCESSFUL, ISSUE THE PROPER    @Z40LB30*/
*     /* MESSAGES                                            @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0508
*     ELSE                          /*                       @Z40LB30*/
*                                                                  0508
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE REASON CODE INDICATES THE VOLUME IS NOT    @Z40LB30*/
*       /* ACTIVE, PRINT MESSAGE IDC2074I, FOLLOWED BY       @Z40LB30*/
*       /* MESSAGE IDC2108I. SET THE CONDITION CODE          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0508
*       IF VVICODE=NOACTIVE THEN    /*                       @Z40LB30*/
         B     @RC00490                                            0508
@RF00490 CLC   VVICODE(4),@CF01519                                 0508
         BNE   @RF00508                                            0508
*         DO;                       /*                       @Z40LB30*/
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0510
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0511
         MVC   DARGSMOD(3,@15),@CC01475                            0511
*           DARGSENT=MSG2074I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'20'                                 0512
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/
         LH    @14,INDEX                                           0513
         SLA   @14,3                                               0513
         L     @07,@PC00001+4                                      0513
         L     @01,FDTPTR(,@07)                                    0513
         AL    @01,@CF01781                                        0513
         LA    @14,VOLVAL-3(@14,@01)                               0513
         ST    @14,DARGDBP(,@15)                                   0513
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00159                             0514
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @15,@PC00001                                        0515
         ST    @15,@AL00001                                        0515
         LA    @14,@CF00117                                        0515
         ST    @14,@AL00001+4                                      0515
         LA    @14,DDSTRU                                          0515
         ST    @14,@AL00001+8                                      0515
         MVI   @AL00001+8,X'80'                                    0515
         L     @15,GDTPRT(,@15)                                    0515
         LA    @01,@AL00001                                        0515
         BALR  @14,@15                                             0515
*           DARGSENT=MSG2108I;      /*                       @Z40LB30*/
         L     @01,DDSTRU                                          0516
         MVI   DARGSENT(@01),X'40'                                 0516
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @15,@PC00001                                        0517
         ST    @15,@AL00001                                        0517
         LA    @14,@CF00117                                        0517
         ST    @14,@AL00001+4                                      0517
         LA    @14,DDSTRU                                          0517
         ST    @14,@AL00001+8                                      0517
         MVI   @AL00001+8,X'80'                                    0517
         L     @15,GDTPRT(,@15)                                    0517
         LA    @01,@AL00001                                        0517
         BALR  @14,@15                                             0517
*           CC01=LASTCC12;          /*                       @Z40LB30*/
         LA    CC01,12                                             0518
*         END;                      /*                       @Z40LB30*/
*                                                                  0519
*     /***************************************************************/
*     /*                                                             */
*     /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG TO PRINT     @Z40LB30*/
*     /* THE REASON CODE. THEN ISSUE MESSAGE IDC2080I TO     @Z40LB30*/
*     /* IDENTIFY THE VOLUME. SET THE CONDITION CODE         @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0520
*       ELSE                        /*                       @Z40LB30*/
*         DO;                       /*                       @Z40LB30*/
         B     @RC00508                                            0520
@RF00508 DS    0H                                                  0521
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/
         LA    @04,VVICODE                                         0521
         ST    @04,@AL00001                                        0521
         LA    @01,@AL00001                                        0521
         BAL   @14,SSCMSG                                          0521
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0522
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0523
         MVC   DARGSMOD(3,@15),@CC01475                            0523
*           DARGSENT=MSG2080I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'1A'                                 0524
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/
         LH    @14,INDEX                                           0525
         SLA   @14,3                                               0525
         L     @07,@PC00001+4                                      0525
         L     @01,FDTPTR(,@07)                                    0525
         AL    @01,@CF01781                                        0525
         LA    @14,VOLVAL-3(@14,@01)                               0525
         ST    @14,DARGDBP(,@15)                                   0525
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00159                             0526
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @15,@PC00001                                        0527
         ST    @15,@AL00001                                        0527
         LA    @14,@CF00117                                        0527
         ST    @14,@AL00001+4                                      0527
         LA    @14,DDSTRU                                          0527
         ST    @14,@AL00001+8                                      0527
         MVI   @AL00001+8,X'80'                                    0527
         L     @15,GDTPRT(,@15)                                    0527
         LA    @01,@AL00001                                        0527
         BALR  @14,@15                                             0527
*           CC01=LASTCC12;          /*                       @Z40LB30*/
         LA    CC01,12                                             0528
*         END;                      /*                       @Z40LB30*/
*   END;                            /*                       @Z40LB30*/
@RC00508 DS    0H                                                  0530
@RC00490 LA    @15,1                                               0530
         AH    @15,INDEX                                           0530
@DE00484 STH   @15,INDEX                                           0530
         L     @14,@PC00001+4                                      0530
         L     @14,FDTPTR(,@14)                                    0530
         CH    @15,VOLCNT(,@14)                                    0530
         BNH   @DL00484                                            0530
*                                                                  0531
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/
*   /* THE FINAL CONDITION CODE                              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/
         C     CC01,@CF00035                                       0531
         BNE   @RF00531                                            0531
         TM    ONEDONE,B'10000000'                                 0531
         BNO   @RF00531                                            0531
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0532
         LA    CC01,8                                              0532
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0533
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00531 LR    @15,CC01                                            0533
@EL00002 DS    0H                                                  0533
@EF00002 DS    0H                                                  0533
@ER00002 L     @14,@SA00002                                        0533
         BR    @14                                                 0533
*   END SPECVOL;                    /*                       @Z40LB30*/
*                                                                  0535
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - SPECGRP                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/
*/*           TO READ THE INVENTORY RECORD FOR EACH GROUP    @Z40LB30*/
*/*           SPECIFIED ON THE LISTDSET COMMAND.  THEN CALL  @Z40LB30*/
*/*           A PROCEDURE TO READ THE RECORD FOR EACH ACTIVE @Z40LB30*/
*/*           BASE VOLUME IN THE GROUP.  FOR EACH VOLUME,    @Z40LB30*/
*/*           CALL PROCEDURES TO SEE IF THE VOLUME           @Z40LB30*/
*/*           HAS RECOVERY FLAGS ON IN THE RECORD AND TO     @Z40LB26*/
*/*           PROCESS THE VOLUME.  ISSUE MESSAGE IDC2079I IF @Z40LB26*/
*/*           A GROUP RECORD CANNOT BE READ.                 @Z40LB26*/
*/*                                                          @Z40LB30*/
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERROR                       @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE DATA SETS OR       @Z40LB30*/
*/*                           VOLUMES COULD NOT BE PROCESSED @Z40LB30*/
*/*                           DUE TO ERROR                   @Z40LB30*/
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0535
*SPECGRP:                                                          0535
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
SPECGRP  ST    @14,@SA00003                                        0535
*                                                                  0536
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0536
*   OLDERID2=NEWERID2;                                             0536
         L     @15,@PC00001                                        0536
         L     @15,GDTTR2(,@15)                                    0536
         MVC   @TS00001(95),NEWERID2(@15)                          0536
         MVC   OLDERID2(95,@15),@TS00001                           0536
*   NEWID2='LDSG';                  /*                       @Z40LB30*/
*                                                                  0537
         MVC   NEWID2(4,@15),@CC01597                              0537
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0538
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0538
         SLR   CC01,CC01                                           0538
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST TO READ A        @Z40LB30*/
*   /* SPECIFIC GROUP RECORD FROM THE INVENTORY              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0539
*   GRPRVVI=''B;                    /*                       @Z40LB30*/
         XC    GRPRVVI(68),GRPRVVI                                 0539
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/
         LA    @15,GRPRVVI                                         0540
         ST    @15,RVVIPTR                                         0540
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @14,RVVLEN                                          0541
         ST    @14,RVVLNGTH(,@15)                                  0541
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@15),X'87'                                  0542
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@15),@CH01762                            0543
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @14,GRPREC                                          0544
         ST    @14,RVVRTBUF(,@15)                                  0544
*   RVVRDR=ON;                      /* READ NEXT             @Z40LB30*/
         OI    RVVRDR(@15),B'10000000'                             0545
*   RVVGRPRC=ON;                    /* READ GROUP RECORD     @Z40LB30*/
         OI    RVVGRPRC(@15),B'01000000'                           0546
*   RVVSGRP=ON;                     /* GROUP NAME SPECIFIED  @Z40LB30*/
         OI    RVVSGRP(@15),B'10000000'                            0547
*                                                                  0548
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE RECORD FOR EACH GROUP SPECIFIED ON THE       @Z40LB30*/
*   /* LISTDSET COMMAND                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0548
*   DO INDEX=1 TO GRPCNT;           /*                       @Z40LB30*/
*                                                                  0548
         LA    @15,1                                               0548
         B     @DE00548                                            0548
@DL00548 DS    0H                                                  0549
*     /***************************************************************/
*     /*                                                             */
*     /* RESET THE POINTER TO THE IEZRVVI PARAMETER LIST AND @Z40LB30*/
*     /* SET THE GROUP NAME IN THE PARAMETER LIST            @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0549
*     RVVIPTR=ADDR(GRPRVVI);        /*                       @Z40LB30*/
         LA    @02,GRPRVVI                                         0549
         ST    @02,RVVIPTR                                         0549
*     RVVGROUP=GRPVAL(INDEX);       /*                       @Z40LB30*/
*                                                                  0550
         MH    @15,@CH00037                                        0550
         L     @14,@PC00001+4                                      0550
         L     @01,FDTPTR+4(,@14)                                  0550
         ALR   @01,@15                                             0550
         AL    @01,@CF01782                                        0550
         MVC   RVVGROUP(8,@02),GRPVAL-3(@01)                       0550
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD. SAVE THE   @Z40LB30*/
*     /* RETURN CODE                                         @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0551
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/
         L     @02,@PC00001                                        0551
         ST    @02,@AL00001                                        0551
         LA    @15,VVIC                                            0551
         ST    @15,@AL00001+4                                      0551
         LA    @15,RVVIPTR                                         0551
         ST    @15,@AL00001+8                                      0551
         LA    @15,VVICODE                                         0551
         ST    @15,@AL00001+12                                     0551
         MVI   @AL00001+12,X'80'                                   0551
         L     @15,GDTSSC(,@02)                                    0551
         LA    @01,@AL00001                                        0551
         BALR  @14,@15                                             0551
*     RESPECIFY                                                    0552
*       RTNREG RSTD;                                               0552
*     TESTRC=RTNREG;                                               0553
         LR    TESTRC,RTNREG                                       0553
*     RESPECIFY                                                    0554
*       RTNREG UNRSTD;              /*                       @Z40LB30*/
*                                                                  0554
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE GROUP RECORD WAS READ SUCCESSFULLY, CONTINUE @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0555
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/
         SLR   @02,@02                                             0555
         CR    TESTRC,@02                                          0555
         BNE   @RF00555                                            0555
*       DO;                         /*                       @Z40LB30*/
*                                                                  0556
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO 0  @Z40LB30*/
*         /* TO PASS TO RDGRPCHN                             @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0557
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/
*                                                                  0557
         ST    @02,VOLPTR                                          0557
*         /***********************************************************/
*         /*                                                         */
*         /* READ EACH ACTIVE BASE VOLUME RECORD + PROCESS   @Z40LB30*/
*         /* THE VOLUME UNTIL THERE ARE NO MORE VOLUME       @Z40LB30*/
*         /* RECORDS OR A READ ERROR OCCURS                  @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0558
*         RDERROR=OFF;              /*                       @Z40LB30*/
         NI    RDERROR,B'10111111'                                 0558
*         DO UNTIL VOLPTR=NULLPTR×RDERROR=ON;/*              @Z40LB30*/
*                                                                  0559
@DL00559 DS    0H                                                  0560
*           /*********************************************************/
*           /*                                                       */
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0560
*           CALL RDGRPCHN;          /*                       @Z40LB30*/
         BAL   @14,RDGRPCHN                                        0560
*           RESPECIFY                                              0561
*             RTNREG RSTD;                                         0561
*           TESTRC=RTNREG;                                         0562
         LR    TESTRC,RTNREG                                       0562
*           RESPECIFY                                              0563
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0563
*           /*********************************************************/
*           /*                                                       */
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/
*           /* IF THERE IS A VOLUME TO PROCESS               @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0564
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/
         SLR   @02,@02                                             0564
         CR    TESTRC,@02                                          0564
         BNE   @RF00564                                            0564
*             IF VOLPTR^=NULLPTR THEN/*                      @Z40LB30*/
         C     @02,VOLPTR                                          0565
         BE    @RF00565                                            0565
*               DO;                 /*                       @Z40LB30*/
*                                                                  0566
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALL CKRECOV TO SEE IF RECOVERY FLAGS   @Z40LB26*/
*                 /* ARE ON IN THE RECORD. SAVE THE RETURN   @Z40LB30*/
*                 /* CODE                                    @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0567
*                 CALL CKRECOV;     /*                       @Z40LB30*/
         BAL   @14,CKRECOV                                         0567
*                 RESPECIFY                                        0568
*                   RTNREG RSTD;                                   0568
*                 TESTRC=RTNREG;                                   0569
         LR    TESTRC,RTNREG                                       0569
*                 RESPECIFY                                        0570
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/
*                                                                  0570
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/
*                 /* SET THE CONDITION CODE TO INDICATE      @Z40LB26*/
*                 /* A VOLUME WAS NOT PROCESSED              @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0571
*                 IF TESTRC>LASTCC00 THEN/*                  @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0571
         BNP   @RF00571                                            0571
*                   CC01=LASTCC12;  /*                       @Z40LB30*/
*                                                                  0572
         LA    CC01,12                                             0572
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/
*                 /* PROCESS IT.                             @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0573
*                 ELSE              /*                       @Z40LB30*/
*                   DO;             /*                       @Z40LB26*/
*                                                                  0573
         B     @RC00571                                            0573
@RF00571 DS    0H                                                  0574
*                     /***********************************************/
*                     /*                                             */
*                     /* CALL PROCVOL TO PROCESS THE         @Z40LB30*/
*                     /* VOLUME. SAVE THE RETURN CODE.       @Z40LB30*/
*                     /* SET THE RETURN CODE IN THE          @Z40LB30*/
*                     /* INTERNAL CONDITION CODE AREA IF     @Z40LB30*/
*                     /* IT IS HIGHER THAN CURRENT ONE       @Z40LB30*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0574
*                     CALL PROCVOL; /*                       @Z40LB26*/
         BAL   @14,PROCVOL                                         0574
*                     RESPECIFY                                    0575
*                       RTNREG RSTD;                               0575
*                     TESTRC=RTNREG;                               0576
         LR    TESTRC,RTNREG                                       0576
*                     RESPECIFY                                    0577
*                       RTNREG UNRSTD;/*                     @Z40LB26*/
*                     CC01=MAX(CC01,TESTRC);/*               @Z40LB26*/
*                                                                  0578
         CR    CC01,TESTRC                                         0578
         BNL   *+6
         LR    CC01,TESTRC                                         0578
*                     /***********************************************/
*                     /*                                             */
*                     /* IF THE RETURN CODE INDICATES A      @Z40LB30*/
*                     /* VOLUME WAS PROCESSED, SET           @Z40LB30*/
*                     /* INDICATOR                           @Z40LB30*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0579
*                     IF TESTRC<LASTCC12 THEN/*              @Z40LB30*/
         C     TESTRC,@CF00035                                     0579
         BNL   @RF00579                                            0579
*                       ONEDONE=ON; /*                       @Z40LB26*/
         OI    ONEDONE,B'10000000'                                 0580
*                   END;            /*                       @Z40LB26*/
*               END;                /*                       @Z40LB30*/
*                                                                  0582
*           /*********************************************************/
*           /*                                                       */
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0583
*             ELSE                                                 0583
*               ;                   /*                       @Z40LB30*/
*                                                                  0583
@RF00565 DS    0H                                                  0584
*           /*********************************************************/
*           /*                                                       */
*           /* IF AN ERROR OCCURRED READING A VOLUME RECORD  @Z40LB30*/
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0584
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC00564                                            0584
@RF00564 DS    0H                                                  0585
*               RDERROR=ON;         /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0585
*               CC01=LASTCC12;      /*                       @Z40LB30*/
         LA    CC01,12                                             0586
*             END;                  /*                       @Z40LB30*/
*         END;                      /*                       @Z40LB30*/
@RC00564 DS    0H                                                  0588
@DE00559 L     @15,VOLPTR                                          0588
         LTR   @15,@15                                             0588
         BZ    @DC00559                                            0588
         TM    RDERROR,B'01000000'                                 0588
         BNO   @DL00559                                            0588
@DC00559 DS    0H                                                  0589
*       END;                        /*                       @Z40LB30*/
*                                                                  0589
*     /***************************************************************/
*     /*                                                             */
*     /* IF AN ERROR OCCURRED READING A GROUP RECORD, CALL   @Z40LB30*/
*     /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT         @Z40LB30*/
*     /* MESSAGE IDC2079I TO INDICATE THE GROUP NAME.        @Z40LB30*/
*     /* THEN SET THE CONDITION CODE TO INDICATE A SEVERE    @Z40LB30*/
*     /* ERROR                                               @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0590
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
         B     @RC00555                                            0590
@RF00555 DS    0H                                                  0591
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/
         LA    @04,VVICODE                                         0591
         ST    @04,@AL00001                                        0591
         LA    @01,@AL00001                                        0591
         BAL   @14,SSCMSG                                          0591
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0592
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0593
         MVC   DARGSMOD(3,@15),@CC01475                            0593
*         DARGSENT=MSG2079I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'1B'                                 0594
*         DARGDBP=ADDR(GRPVAL(INDEX));/*                     @Z40LB30*/
         LH    @14,INDEX                                           0595
         MH    @14,@CH00037                                        0595
         L     @07,@PC00001+4                                      0595
         L     @01,FDTPTR+4(,@07)                                  0595
         AL    @01,@CF01782                                        0595
         LA    @14,GRPVAL-3(@14,@01)                               0595
         ST    @14,DARGDBP(,@15)                                   0595
*         DARGILP=LENGTH(GRPVAL(INDEX));/*                   @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00182                             0596
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @15,@PC00001                                        0597
         ST    @15,@AL00001                                        0597
         LA    @14,@CF00117                                        0597
         ST    @14,@AL00001+4                                      0597
         LA    @14,DDSTRU                                          0597
         ST    @14,@AL00001+8                                      0597
         MVI   @AL00001+8,X'80'                                    0597
         L     @15,GDTPRT(,@15)                                    0597
         LA    @01,@AL00001                                        0597
         BALR  @14,@15                                             0597
*         CC01=LASTCC12;            /*                       @Z40LB30*/
         LA    CC01,12                                             0598
*       END;                        /*                       @Z40LB30*/
*   END;                            /*                       @Z40LB30*/
@RC00555 LA    @15,1                                               0600
         AH    @15,INDEX                                           0600
@DE00548 STH   @15,INDEX                                           0600
         L     @14,@PC00001+4                                      0600
         L     @14,FDTPTR+4(,@14)                                  0600
         CH    @15,GRPCNT(,@14)                                    0600
         BNH   @DL00548                                            0600
*                                                                  0601
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE INDICATES A SEVERE ERROR THAT   @Z40LB30*/
*   /* PREVENTED A VOLUME FROM BEING PROCESSED, CHECK IF     @Z40LB30*/
*   /* AT LEAST ONE VOLUME WAS PROCESSED, OR IF AT LEAST     @Z40LB26*/
*   /* ONE EMPTY GROUP WAS PROCESSED. IF SO, LOWER           @Z40LB26*/
*   /* THE FINAL CONDITION CODE.                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0601
*   IF CC01=LASTCC12&(ONEDONE=ON×EMPTYGRP=ON) THEN/*         @Z40LB26*/
         C     CC01,@CF00035                                       0601
         BNE   @RF00601                                            0601
         TM    ONEDONE,B'10001000'                                 0601
         BZ    @RF00601                                            0601
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0602
         LA    CC01,8                                              0602
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0603
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00601 LR    @15,CC01                                            0603
@EL00003 DS    0H                                                  0603
@EF00003 DS    0H                                                  0603
@ER00003 L     @14,@SA00003                                        0603
         BR    @14                                                 0603
*   END SPECGRP;                    /*                       @Z40LB30*/
*                                                                  0605
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - NONGRPD                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/
*/*           READ EACH ACTIVE NON-GROUPED VOLUME RECORD.    @Z40LB30*/
*/*           FOR EACH ACTIVE NON-GROUPED VOLUME, CALL A     @Z40LB30*/
*/*           PROCEDURE TO SEE IF THE RECORD HAS ANY         @Z40LB26*/
*/*           RECOVERY FLAGS ON. CALL ANOTHER PROCEDURE TO   @Z40LB26*/
*/*           PROCESS THE VOLUME.  ISSUE MESSAGE IDC0102I IF @Z40LB26*/
*/*           THERE ARE NO ACTIVE NON-GROUPED VOLUMES.       @Z40LB26*/
*/*           ISSUE MESSAGE IDC2103I IF THE NON-GROUPED      @Z40LB26*/
*/*           RECORD CHAIN IS BROKEN.  ISSUE MESSAGE         @Z40LB26*/
*/*           IDC2109I IF AN ERROR OCCURS READING AND        @Z40LB26*/
*/*           NO MORE VOLUMES CAN BE PROCESSED.              @Z40LB26*/
*/*                                                          @Z40LB30*/
*/* INPUT - NONE                                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*********************************************************  @Z40LB30*/
*                                                                  0605
*NONGRPD:                                                          0605
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
NONGRPD  ST    @14,@SA00004                                        0605
*                                                                  0606
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0606
*   OLDERID2=NEWERID2;                                             0606
         L     @02,@PC00001                                        0606
         L     @15,GDTTR2(,@02)                                    0606
         MVC   @TS00001(95),NEWERID2(@15)                          0606
         MVC   OLDERID2(95,@15),@TS00001                           0606
*   NEWID2='LDNG';                  /*                       @Z40LB30*/
*                                                                  0607
         MVC   NEWID2(4,@15),@CC01602                              0607
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0608
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0608
         SLR   CC01,CC01                                           0608
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ THE ACTIVE   @Z40LB30*/
*   /* NON-GROUPED VOLUME RECORDS                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0609
*   VOLRVVI=''B;                    /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0609
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/
         LA    @15,VOLRVVI                                         0610
         ST    @15,RVVIPTR                                         0610
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @14,RVVLEN                                          0611
         ST    @14,RVVLNGTH(,@15)                                  0611
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@15),X'87'                                  0612
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@15),@CH01761                            0613
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @14,VOLREC                                          0614
         ST    @14,RVVRTBUF(,@15)                                  0614
*   RVVRDCH=ON;                     /* READ CHAIN            @Z40LB30*/
         OI    RVVRDCH(@15),B'00100000'                            0615
*   RVVBVRCD=ON;                    /* BASE VOLUME RECORDS   @Z40LB30*/
         OI    RVVBVRCD(@15),B'10000000'                           0616
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/
         OI    RVVACTV(@15),B'00000100'                            0617
*   RVVNGVOL=ON;                    /* NON-GROUPED CHAIN     @Z40LB30*/
*                                                                  0618
         OI    RVVNGVOL(@15),B'01000000'                           0618
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO READ FIRST ACTIVE NON-GROUPED     @Z40LB30*/
*   /* VOLUME. SAVE THE RETURN CODE.                         @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/
         ST    @02,@AL00001                                        0619
         LA    @15,VVIC                                            0619
         ST    @15,@AL00001+4                                      0619
         LA    @15,RVVIPTR                                         0619
         ST    @15,@AL00001+8                                      0619
         LA    @15,VVICODE                                         0619
         ST    @15,@AL00001+12                                     0619
         MVI   @AL00001+12,X'80'                                   0619
         L     @15,GDTSSC(,@02)                                    0619
         LA    @01,@AL00001                                        0619
         BALR  @14,@15                                             0619
*   RESPECIFY                                                      0620
*     RTNREG RSTD;                                                 0620
*   TESTRC=RTNREG;                                                 0621
         LR    TESTRC,RTNREG                                       0621
*   RESPECIFY                                                      0622
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0622
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE ARE NO NON-GROUPED VOLUMES OR NO ACTIVE NON- @Z40LB30*/
*   /* GROUPED VOLUMES, ISSUE MESSAGE IDC0102I.              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0623
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0623
         BZ    @RF00623                                            0623
*     IF VVICODE=NORECORD×VVICODE=NOACTIVE THEN/*            @Z40LB30*/
         L     @05,VVICODE                                         0624
         C     @05,@CF01517                                        0624
         BE    @RT00624                                            0624
         C     @05,@CF01519                                        0624
         BNE   @RF00624                                            0624
@RT00624 DS    0H                                                  0625
*       DO;                         /*                       @Z40LB30*/
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0626
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0627
         MVC   DARGSMOD(3,@05),@CC01475                            0627
*         DARGSENT=MSG0102I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'3A'                                 0628
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @05,@PC00001                                        0629
         ST    @05,@AL00001                                        0629
         LA    @15,@CF00117                                        0629
         ST    @15,@AL00001+4                                      0629
         LA    @15,DDSTRU                                          0629
         ST    @15,@AL00001+8                                      0629
         MVI   @AL00001+8,X'80'                                    0629
         L     @15,GDTPRT(,@05)                                    0629
         LA    @01,@AL00001                                        0629
         BALR  @14,@15                                             0629
*       END;                        /*                       @Z40LB30*/
*                                                                  0630
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/
*   /* REASON CODE AND SET AN INDICATOR.                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0631
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
         B     @RC00624                                            0631
@RF00624 DS    0H                                                  0632
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/
         LA    @05,VVICODE                                         0632
         ST    @05,@AL00001                                        0632
         LA    @01,@AL00001                                        0632
         BAL   @14,SSCMSG                                          0632
*         RDERROR=ON;               /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0633
*       END;                        /*                       @Z40LB30*/
*                                                                  0635
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A RECORD WAS RETURNED, PROCESS AND READ ALL THE    @Z40LB30*/
*   /* ACTIVE NON-GROUPED VOLUMES UNTIL A READ ERROR OCCURS  @Z40LB30*/
*   /* OR END OF FILE.                                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*   ELSE                            /*                       @Z40LB30*/
*     DO WHILE RDERROR=OFF&EOFILE=OFF;/*                     @Z40LB30*/
*                                                                  0635
         B     @RC00623                                            0635
@RF00623 B     @DE00635                                            0635
@DL00635 DS    0H                                                  0636
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CKRECOV TO SEE IF RECOVERY FLAGS ARE ON.     @Z40LB26*/
*       /* SAVE THE RETURN CODE.                             @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0636
*       CALL CKRECOV;               /*                       @Z40LB30*/
         BAL   @14,CKRECOV                                         0636
*       RESPECIFY                                                  0637
*         RTNREG RSTD;                                             0637
*       TESTRC=RTNREG;                                             0638
         LR    TESTRC,RTNREG                                       0638
*       RESPECIFY                                                  0639
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0639
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0640
*       IF TESTRC>LASTCC00 THEN     /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0640
         BNP   @RF00640                                            0640
*         CC01=LASTCC12;            /*                       @Z40LB30*/
*                                                                  0641
         LA    CC01,12                                             0641
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RECORD CAN BE PROCESSED CALL PROCVOL TO    @Z40LB30*/
*       /* PROCESS THE VOLUME. SAVE THE RETURN CODE.         @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0642
*       ELSE                        /*                       @Z40LB26*/
*         DO;                       /*                       @Z40LB30*/
         B     @RC00640                                            0642
@RF00640 DS    0H                                                  0643
*           CALL PROCVOL;           /*                       @Z40LB30*/
         BAL   @14,PROCVOL                                         0643
*           RESPECIFY                                              0644
*             RTNREG RSTD;                                         0644
*           TESTRC=RTNREG;                                         0645
         LR    TESTRC,RTNREG                                       0645
*           RESPECIFY                                              0646
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0646
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE CONDITION CODE TO THE HIGHEST VALUE   @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0647
*           CC01=MAX(CC01,TESTRC);  /*                       @Z40LB30*/
*                                                                  0647
         CR    CC01,TESTRC                                         0647
         BNL   *+6
         LR    CC01,TESTRC                                         0647
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE INDICATES A VOLUME WAS     @Z40LB30*/
*           /* PROCESSED, SET AN INDICATOR.                  @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0648
*           IF TESTRC<LASTCC12 THEN /*                       @Z40LB30*/
         C     TESTRC,@CF00035                                     0648
         BNL   @RF00648                                            0648
*             ONEDONE=ON;           /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0649
*         END;                      /*                       @Z40LB30*/
*                                                                  0650
@RF00648 DS    0H                                                  0651
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CURRENT RECORD WAS NOT THE LAST, ISSUE     @Z40LB30*/
*       /* USSC TO READ THE NEXT RECORD. FIRST SET THE       @Z40LB30*/
*       /* NEW VOLUME SERIAL IN THE IEZRVVI ARGUMENT LIST.   @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0651
*       IF BASLAST^=ON THEN         /*                       @Z40LB30*/
@RC00640 TM    BASLAST(BASEVPTR),B'00001000'                       0651
         BO    @RF00651                                            0651
*         DO;                       /*                       @Z40LB30*/
*           RVVSVOL=ON;             /*                       @Z40LB30*/
         L     @02,RVVIPTR                                         0653
         OI    RVVSVOL(@02),B'00000001'                            0653
*           RVVOLUME=BASNEXTV;      /*                       @Z40LB30*/
         MVC   RVVOLUME(6,@02),BASNEXTV(BASEVPTR)                  0654
*           CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*    @Z40LB30*/
         L     @02,@PC00001                                        0655
         ST    @02,@AL00001                                        0655
         LA    @15,VVIC                                            0655
         ST    @15,@AL00001+4                                      0655
         LA    @15,RVVIPTR                                         0655
         ST    @15,@AL00001+8                                      0655
         LA    @15,VVICODE                                         0655
         ST    @15,@AL00001+12                                     0655
         MVI   @AL00001+12,X'80'                                   0655
         L     @15,GDTSSC(,@02)                                    0655
         LA    @01,@AL00001                                        0655
         BALR  @14,@15                                             0655
*           RESPECIFY                                              0656
*             RTNREG RSTD;                                         0656
*           TESTRC=RTNREG;                                         0657
         LR    TESTRC,RTNREG                                       0657
*           RESPECIFY                                              0658
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0658
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO ACTIVE VOLUMES LEFT, SET END OF FILE    @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0659
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0659
         BZ    @RF00659                                            0659
*             IF VVICODE=NOACTIVE THEN/*                     @Z40LB30*/
         CLC   VVICODE(4),@CF01519                                 0660
         BNE   @RF00660                                            0660
*               EOFILE=ON;          /*                       @Z40LB30*/
*                                                                  0661
         OI    EOFILE,B'00100000'                                  0661
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE NEXT VOLUME IN THE CHAIN COULD NOT     @Z40LB30*/
*           /* BE FOUND OR IF IT WAS FOUND TO BE A GROUPED   @Z40LB30*/
*           /* VOLUME, ISSUE MESSAGE IDC2103I.               @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0662
*             ELSE                  /*                       @Z40LB30*/
*               IF VVICODE=NORECORD×VVICODE=WRONGCHN/*       @Z40LB30*/
*                 THEN              /*                       @Z40LB30*/
         B     @RC00660                                            0662
@RF00660 L     @15,VVICODE                                         0662
         C     @15,@CF01517                                        0662
         BE    @RT00662                                            0662
         C     @15,@CF01521                                        0662
         BNE   @RF00662                                            0662
@RT00662 DS    0H                                                  0663
*                 DO;               /*                       @Z40LB30*/
*                   RDERROR=ON;     /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0664
*                   DARGAREA=''B;   /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0665
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/
         L     @15,DDSTRU                                          0666
         MVC   DARGSMOD(3,@15),@CC01475                            0666
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/
         MVI   DARGSENT(@15),X'3B'                                 0667
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/
         L     @15,@PC00001                                        0668
         ST    @15,@AL00001                                        0668
         LA    @14,@CF00117                                        0668
         ST    @14,@AL00001+4                                      0668
         LA    @14,DDSTRU                                          0668
         ST    @14,@AL00001+8                                      0668
         MVI   @AL00001+8,X'80'                                    0668
         L     @15,GDTPRT(,@15)                                    0668
         LA    @01,@AL00001                                        0668
         BALR  @14,@15                                             0668
*                 END;              /*                       @Z40LB30*/
*                                                                  0669
*           /*********************************************************/
*           /*                                                       */
*           /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG        @Z40LB30*/
*           /* TO PRINT THE REASON CODE                      @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0670
*               ELSE                /*                       @Z40LB30*/
*                 DO;               /*                       @Z40LB30*/
         B     @RC00662                                            0670
@RF00662 DS    0H                                                  0671
*                   RDERROR=ON;     /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0671
*                   CALL SSCMSG(VVICODE);/*                  @Z40LB30*/
         LA    @15,VVICODE                                         0672
         ST    @15,@AL00001                                        0672
         LA    @01,@AL00001                                        0672
         BAL   @14,SSCMSG                                          0672
*                 END;              /*                       @Z40LB30*/
*                                                                  0673
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO ERRORS OCCURRED, NOTHING TO DO          @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0674
*           ELSE                                                   0674
*             ;                     /*                       @Z40LB30*/
@RF00659 DS    0H                                                  0675
*         END;                      /*                       @Z40LB30*/
*                                                                  0675
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CURRENT RECORD IS THE LAST, SET THE        @Z40LB30*/
*       /* END-OF-FILE INDICATOR.                            @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0676
*       ELSE                        /*                       @Z40LB30*/
*         EOFILE=ON;                /*                       @Z40LB30*/
         B     @RC00651                                            0676
@RF00651 OI    EOFILE,B'00100000'                                  0676
*     END;                          /*                       @Z40LB30*/
@RC00651 DS    0H                                                  0677
@DE00635 TM    RDERROR,B'01100000'                                 0677
         BZ    @DL00635                                            0677
*                                                                  0678
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A READ ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/
*   /* AND ISSUE SECONDARY MESSAGE IDC2109I TO SAY NO MORE   @Z40LB30*/
*   /* VOLUMES CAN BE PROCESSED.                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0678
*   IF RDERROR=ON THEN              /*                       @Z40LB30*/
@RC00623 TM    RDERROR,B'01000000'                                 0678
         BNO   @RF00678                                            0678
*     DO;                           /*                       @Z40LB30*/
*       CC01=LASTCC12;              /*                       @Z40LB30*/
         LA    CC01,12                                             0680
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0681
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0682
         MVC   DARGSMOD(3,@05),@CC01475                            0682
*       DARGSENT=MSG2109I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'41'                                 0683
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @05,@PC00001                                        0684
         ST    @05,@AL00001                                        0684
         LA    @15,@CF00117                                        0684
         ST    @15,@AL00001+4                                      0684
         LA    @15,DDSTRU                                          0684
         ST    @15,@AL00001+8                                      0684
         MVI   @AL00001+8,X'80'                                    0684
         L     @15,GDTPRT(,@05)                                    0684
         LA    @01,@AL00001                                        0684
         BALR  @14,@15                                             0684
*     END;                          /*                       @Z40LB30*/
*                                                                  0686
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/
*   /* THE FINAL CONDITION CODE.                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0686
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/
@RF00678 C     CC01,@CF00035                                       0686
         BNE   @RF00686                                            0686
         TM    ONEDONE,B'10000000'                                 0686
         BNO   @RF00686                                            0686
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0687
         LA    CC01,8                                              0687
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0688
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00686 LR    @15,CC01                                            0688
@EL00004 DS    0H                                                  0688
@EF00004 DS    0H                                                  0688
@ER00004 L     @14,@SA00004                                        0688
         BR    @14                                                 0688
*   END NONGRPD;                    /*                       @Z40LB30*/
*                                                                  0690
*/*********************************************************  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - ALLGRPS                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/
*/*           READ EACH GROUP RECORD IN THE INVENTORY.  THEN @Z40LB30*/
*/*           CALL A PROCEDURE TO READ EACH ACTIVE BASE      @Z40LB30*/
*/*           VOLUME IN THE GROUP.  FOR EACH VOLUME, CALL    @Z40LB30*/
*/*           PROCEDURES TO CHECK IF THE VOLUME              @Z40LB26*/
*/*           HAS A RECOVERY FLAG ON IN THE VOLUME RECORD    @Z40LB26*/
*/*           AND TO PROCESS THE VOLUME.  ISSUE MESSAGE      @Z40LB26*/
*/*           IDC2111I IF AN ERROR OCCURS AND THE REMAINING  @Z40LB26*/
*/*           GROUPS CANNOT BE PROCESSED                     @Z40LB26*/
*/*                                                          @Z40LB30*/
*/* INPUT - NONE                                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/
*/*                           TO ERRORS                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*********************************************************  @Z40LB30*/
*                                                                  0690
*ALLGRPS:                                                          0690
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
ALLGRPS  ST    @14,@SA00005                                        0690
*                                                                  0691
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0691
*   OLDERID2=NEWERID2;                                             0691
         L     @15,@PC00001                                        0691
         L     @15,GDTTR2(,@15)                                    0691
         MVC   @TS00001(95),NEWERID2(@15)                          0691
         MVC   OLDERID2(95,@15),@TS00001                           0691
*   NEWID2='LDAG';                  /*                       @Z40LB30*/
*                                                                  0692
         MVC   NEWID2(4,@15),@CC01606                              0692
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0693
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0693
         SLR   @15,@15                                             0693
         LR    CC01,@15                                            0693
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ EACH GROUP   @Z40LB30*/
*   /* RECORD                                                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0694
*   GRPRVVI=''B;                    /*                       @Z40LB30*/
         XC    GRPRVVI(68),GRPRVVI                                 0694
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/
         LA    @14,GRPRVVI                                         0695
         ST    @14,RVVIPTR                                         0695
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @07,RVVLEN                                          0696
         ST    @07,RVVLNGTH(,@14)                                  0696
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@14),X'87'                                  0697
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@14),@CH01762                            0698
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @07,GRPREC                                          0699
         ST    @07,RVVRTBUF(,@14)                                  0699
*   RVVRDNR=ON;                     /* READ NEXT             @Z40LB30*/
         OI    RVVRDNR(@14),B'01000000'                            0700
*   RVVGRPRC=ON;                    /* GROUP RECORD          @Z40LB30*/
         OI    RVVGRPRC(@14),B'01000000'                           0701
*                                                                  0702
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH ALL THE GROUPS UNTIL NO MORE GROUPS CAN  @Z40LB30*/
*   /* BE READ DUE TO ERROR OR BECAUSE THERE ARE NO MORE.    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0702
*   VVICODE=0;                      /*                       @Z40LB30*/
         ST    @15,VVICODE                                         0702
*   DO UNTIL VVICODE^=0;            /*                       @Z40LB30*/
*                                                                  0703
@DL00703 DS    0H                                                  0704
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD.            @Z40LB30*/
*     /* SAVE THE RETURN CODE.                               @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0704
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/
         L     @02,@PC00001                                        0704
         ST    @02,@AL00001                                        0704
         LA    @15,VVIC                                            0704
         ST    @15,@AL00001+4                                      0704
         LA    @15,RVVIPTR                                         0704
         ST    @15,@AL00001+8                                      0704
         LA    @15,VVICODE                                         0704
         ST    @15,@AL00001+12                                     0704
         MVI   @AL00001+12,X'80'                                   0704
         L     @15,GDTSSC(,@02)                                    0704
         LA    @01,@AL00001                                        0704
         BALR  @14,@15                                             0704
*     RESPECIFY                                                    0705
*       RTNREG RSTD;                                               0705
*     TESTRC=RTNREG;                                               0706
         LR    TESTRC,RTNREG                                       0706
*     RESPECIFY                                                    0707
*       RTNREG UNRSTD;              /*                       @Z40LB30*/
*                                                                  0707
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0708
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/
         SLR   @02,@02                                             0708
         CR    TESTRC,@02                                          0708
         BNE   @RF00708                                            0708
*       DO;                         /*                       @Z40LB30*/
*                                                                  0709
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO    @Z40LB30*/
*         /* ZERO TO PASS TO RDGRPCHN PROCEDURE.             @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0710
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/
*                                                                  0710
         ST    @02,VOLPTR                                          0710
*         /***********************************************************/
*         /*                                                         */
*         /* READ AND PROCESS ALL ACTIVE BASE VOLUME RECORDS @Z40LB30*/
*         /* UNTIL THERE ARE NO MORE OR A READ ERROR OCCURS. @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0711
*         RDERROR=OFF;              /*                       @Z40LB30*/
         NI    RDERROR,B'10111111'                                 0711
*         DO UNTIL VOLPTR=NULLPTR×RDERROR=ON;/*              @Z40LB30*/
*                                                                  0712
@DL00712 DS    0H                                                  0713
*           /*********************************************************/
*           /*                                                       */
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/
*           /* SAVE THE RETURN CODE.                         @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0713
*           CALL RDGRPCHN;          /*                       @Z40LB30*/
         BAL   @14,RDGRPCHN                                        0713
*           RESPECIFY                                              0714
*             RTNREG RSTD;                                         0714
*           TESTRC=RTNREG;                                         0715
         LR    TESTRC,RTNREG                                       0715
*           RESPECIFY                                              0716
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0716
*           /*********************************************************/
*           /*                                                       */
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/
*           /* IF THERE IS A VOLUME TO PROCESS.              @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0717
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/
         SLR   @02,@02                                             0717
         CR    TESTRC,@02                                          0717
         BNE   @RF00717                                            0717
*             IF VOLPTR^=NULLPTR    /*                       @Z40LB30*/
*               THEN                /*                       @Z40LB30*/
*                                                                  0718
         C     @02,VOLPTR                                          0718
         BE    @RF00718                                            0718
*               /*****************************************************/
*               /*                                                   */
*               /* PROCESS THE VOLUME                        @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0719
*               DO;                 /*                       @Z40LB30*/
*                                                                  0719
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALL CKRECOV TO SEE IF ANY RECOVERY     @Z40LB26*/
*                 /* FLAGS ARE ON. SAVE THE RETURN CODE.     @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0720
*                 CALL CKRECOV;     /*                       @Z40LB30*/
         BAL   @14,CKRECOV                                         0720
*                 RESPECIFY                                        0721
*                   RTNREG RSTD;                                   0721
*                 TESTRC=RTNREG;                                   0722
         LR    TESTRC,RTNREG                                       0722
*                 RESPECIFY                                        0723
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/
*                                                                  0723
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/
*                 /* (>4), SET THE CONDITION CODE TO         @Z40LB30*/
*                 /* INDICATE A VOLUME COULD NOT BE          @Z40LB30*/
*                 /* PROCESSED.                              @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0724
*                 IF TESTRC>LASTCC00 THEN/*                  @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0724
         BNP   @RF00724                                            0724
*                   CC01=LASTCC12;  /*                       @Z40LB30*/
*                                                                  0725
         LA    CC01,12                                             0725
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/
*                 /* PROCESS IT.                             @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0726
*                 ELSE              /*                       @Z40LB30*/
*                   DO;             /*                       @Z40LB30*/
*                                                                  0726
         B     @RC00724                                            0726
@RF00724 DS    0H                                                  0727
*                     /***********************************************/
*                     /*                                             */
*                     /* CALL PROCVOL TO PROCESS THE         @Z40LB30*/
*                     /* VOLUME. SAVE THE RETURN             @Z40LB30*/
*                     /* CODE. ACCUMULATE THE LARGEST        @Z40LB30*/
*                     /* RETURN CODE IN THE INTERNAL         @Z40LB30*/
*                     /* CONDITION CODE AREA.                @Z40LB30*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0727
*                     CALL PROCVOL; /*                       @Z40LB26*/
         BAL   @14,PROCVOL                                         0727
*                     RESPECIFY                                    0728
*                       RTNREG RSTD;                               0728
*                     TESTRC=RTNREG;                               0729
         LR    TESTRC,RTNREG                                       0729
*                     RESPECIFY                                    0730
*                       RTNREG UNRSTD;/*                     @Z40LB26*/
*                     CC01=MAX(CC01,TESTRC);/*               @Z40LB26*/
*                                                                  0731
         CR    CC01,TESTRC                                         0731
         BNL   *+6
         LR    CC01,TESTRC                                         0731
*                     /***********************************************/
*                     /*                                             */
*                     /* IF THE RETURN CODE INDICATES        @Z40LB30*/
*                     /* A VOLUME WAS PROCESSED, SET         @Z40LB30*/
*                     /* AN INDICATOR.                       @Z40LB30*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0732
*                     IF TESTRC<LASTCC12 THEN/*              @Z40LB30*/
         C     TESTRC,@CF00035                                     0732
         BNL   @RF00732                                            0732
*                       ONEDONE=ON; /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0733
*                   END;            /*                       @Z40LB26*/
*               END;                /*                       @Z40LB30*/
*                                                                  0735
*           /*********************************************************/
*           /*                                                       */
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP.    @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0736
*             ELSE                                                 0736
*               ;                   /*                       @Z40LB30*/
*                                                                  0736
@RF00718 DS    0H                                                  0737
*           /*********************************************************/
*           /*                                                       */
*           /* IF THERE WAS AN ERROR READING A VOLUME RECORD @Z40LB30*/
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0737
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC00717                                            0737
@RF00717 DS    0H                                                  0738
*               RDERROR=ON;         /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0738
*               CC01=LASTCC12;      /*                       @Z40LB30*/
         LA    CC01,12                                             0739
*             END;                  /*                       @Z40LB30*/
*         END;                      /*                       @Z40LB30*/
*                                                                  0741
@RC00717 DS    0H                                                  0741
@DE00712 L     @15,VOLPTR                                          0741
         LTR   @15,@15                                             0741
         BZ    @DC00712                                            0741
         TM    RDERROR,B'01000000'                                 0741
         BNO   @DL00712                                            0741
@DC00712 DS    0H                                                  0742
*         /***********************************************************/
*         /*                                                         */
*         /* RESET THE POINTER TO THE IEZRVVI ARGUMENT LIST. @Z40LB30*/
*         /* INCREMENT GROUP NAME IN IEZRVVI ARGUMENT LIST   @Z40LB30*/
*         /* SO THAT NEXT GROUP RECORD IS READ.              @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0742
*         RVVIPTR=ADDR(GRPRVVI);    /*                       @Z40LB30*/
         LA    @15,GRPRVVI                                         0742
         ST    @15,RVVIPTR                                         0742
*         RVVGROUP=GROVVGRP;        /*                       @Z40LB30*/
         L     @14,GROUPPTR                                        0743
         MVC   RVVGROUP(8,@15),GROVVGRP(@14)                       0743
*         RVVSGRP=ON;               /*                       @Z40LB30*/
         OI    RVVSGRP(@15),B'10000000'                            0744
*       END;                        /*                       @Z40LB30*/
*   END;                            /*                       @Z40LB30*/
@RF00708 DS    0H                                                  0746
@DE00703 L     @15,VVICODE                                         0746
         LTR   @15,@15                                             0746
         BZ    @DL00703                                            0746
*                                                                  0747
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE WAS AN ERROR READING A GROUP RECORD, CALL    @Z40LB30*/
*   /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT MESSAGE   @Z40LB30*/
*   /* IDC2111I TO SAY NO MORE GROUPS COULD BE PROCESSED.    @Z40LB30*/
*   /* THEN SET CONDITION CODE TO INDICATE A SEVERE ERROR.   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0747
*   IF VVICODE^=NORECORD THEN       /*                       @Z40LB30*/
         C     @15,@CF01517                                        0747
         BE    @RF00747                                            0747
*     DO;                           /*                       @Z40LB30*/
*       CALL SSCMSG(VVICODE);       /*                       @Z40LB30*/
         LA    @15,VVICODE                                         0749
         ST    @15,@AL00001                                        0749
         LA    @01,@AL00001                                        0749
         BAL   @14,SSCMSG                                          0749
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0750
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0751
         MVC   DARGSMOD(3,@05),@CC01475                            0751
*       DARGSENT=MSG2111I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'43'                                 0752
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @05,@PC00001                                        0753
         ST    @05,@AL00001                                        0753
         LA    @15,@CF00117                                        0753
         ST    @15,@AL00001+4                                      0753
         LA    @15,DDSTRU                                          0753
         ST    @15,@AL00001+8                                      0753
         MVI   @AL00001+8,X'80'                                    0753
         L     @15,GDTPRT(,@05)                                    0753
         LA    @01,@AL00001                                        0753
         BALR  @14,@15                                             0753
*       CC01=LASTCC12;              /*                       @Z40LB30*/
         LA    CC01,12                                             0754
*     END;                          /*                       @Z40LB30*/
*                                                                  0756
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED, OR AT LEAST     @Z40LB26*/
*   /* ONE EMPTY GROUP WAS PROCESSED. IF SO, LOWER THE       @Z40LB26*/
*   /* FINAL CONDITION CODE.                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0756
*   IF CC01=LASTCC12&(ONEDONE=ON×EMPTYGRP=ON) THEN/*         @Z40LB26*/
@RF00747 C     CC01,@CF00035                                       0756
         BNE   @RF00756                                            0756
         TM    ONEDONE,B'10001000'                                 0756
         BZ    @RF00756                                            0756
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0757
         LA    CC01,8                                              0757
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER.                                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0758
*   RETURN CODE(CC01);              /*                       @Z40LB26*/
@RF00756 LR    @15,CC01                                            0758
@EL00005 DS    0H                                                  0758
@EF00005 DS    0H                                                  0758
@ER00005 L     @14,@SA00005                                        0758
         BR    @14                                                 0758
*   END ALLGRPS;                    /*                       @Z40LB30*/
*                                                                  0760
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - ALLVOLS                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH THE MSVC PROGRAM TO READ EACH  @Z40LB30*/
*/*           ACTIVE BASE VOLUME RECORD IN THE INVENTORY.    @Z40LB30*/
*/*           THEN CALL A PROCEDURE TO CHECK IF THE          @Z40LB26*/
*/*           VOLUME IS TO BE EXCLUDED OR IF THE RECORD      @Z40LB26*/
*/*           HAS ANY RECOVERY FLAGS ON.  THEN CALL A        @Z40LB30*/
*/*           PROCEDURE TO PROCESS THE VOLUME.  ISSUE        @Z40LB30*/
*/*           MESSAGE IDC0104I IF THERE ARE NO ACTIVE        @Z40LB30*/
*/*           VOLUMES IN THE INVENTORY AND MESSAGE           @Z40LB30*/
*/*           IDC2109I IF AN ERROR OCCURS AND NO MORE        @Z40LB30*/
*/*           VOLUMES CAN BE PROCESSED.                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - NONE                                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/
*/*                           TO ERRORS                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0760
*ALLVOLS:                                                          0760
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
ALLVOLS  ST    @14,@SA00006                                        0760
*                                                                  0761
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0761
*   OLDERID2=NEWERID2;                                             0761
         L     @02,@PC00001                                        0761
         L     @15,GDTTR2(,@02)                                    0761
         MVC   @TS00001(95),NEWERID2(@15)                          0761
         MVC   OLDERID2(95,@15),@TS00001                           0761
*   NEWID2='LDAV';                  /*                       @Z40LB30*/
*                                                                  0762
         MVC   NEWID2(4,@15),@CC01610                              0762
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /* SET MSVC REASON CODE TO 0                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0763
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
         SLR   @15,@15                                             0763
         LR    CC01,@15                                            0763
*   VVICODE=0;                      /*                       @Z40LB30*/
*                                                                  0764
         ST    @15,VVICODE                                         0764
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ AN ACTIVE    @Z40LB30*/
*   /* BASE VOLUME RECORD.                                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0765
*   VOLRVVI=''B;                    /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0765
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/
         LA    @15,VOLRVVI                                         0766
         ST    @15,RVVIPTR                                         0766
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @14,RVVLEN                                          0767
         ST    @14,RVVLNGTH(,@15)                                  0767
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@15),X'87'                                  0768
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@15),@CH01761                            0769
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @14,VOLREC                                          0770
         ST    @14,RVVRTBUF(,@15)                                  0770
*   RVVRDNR=ON;                     /* READ NEXT RECORDS     @Z40LB30*/
         OI    RVVRDNR(@15),B'01000000'                            0771
*   RVVBVRCD=ON;                    /* BASE RECORDS ONLY     @Z40LB30*/
         OI    RVVBVRCD(@15),B'10000000'                           0772
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/
*                                                                  0773
         OI    RVVACTV(@15),B'00000100'                            0773
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO READ FIRST RECORD.                @Z40LB30*/
*   /* SAVE THE RETURN CODE.                                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0774
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/
         ST    @02,@AL00001                                        0774
         LA    @15,VVIC                                            0774
         ST    @15,@AL00001+4                                      0774
         LA    @15,RVVIPTR                                         0774
         ST    @15,@AL00001+8                                      0774
         LA    @15,VVICODE                                         0774
         ST    @15,@AL00001+12                                     0774
         MVI   @AL00001+12,X'80'                                   0774
         L     @15,GDTSSC(,@02)                                    0774
         LA    @01,@AL00001                                        0774
         BALR  @14,@15                                             0774
*   RESPECIFY                                                      0775
*     RTNREG RSTD;                                                 0775
*   TESTRC=RTNREG;                                                 0776
         LR    TESTRC,RTNREG                                       0776
*   RESPECIFY                                                      0777
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0778
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FIRST RECORD WAS READ SUCCESSFULLY, START A    @Z40LB30*/
*   /* LOOP TO PROCESS THE VOLUME AND THEN READ THE NEXT     @Z40LB30*/
*   /* VOLUME RECORD. END THE LOOP WHEN THERE ARE NO MORE    @Z40LB30*/
*   /* ACTIVE BASE VOLUME RECORDS THAT CAN BE READ FROM THE  @Z40LB30*/
*   /* INVENTORY.                                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0778
*   IF TESTRC=0 THEN                /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0778
         BNZ   @RF00778                                            0778
*     DO WHILE VVICODE=0;           /*                       @Z40LB30*/
*                                                                  0779
         B     @DE00779                                            0779
@DL00779 DS    0H                                                  0780
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CKRECOV TO SEE IF A RECOVERY FLAG IS         @Z40LB26*/
*       /* ON IN THE VOLUME RECORD. SAVE THE RETURN CODE.    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0780
*       CALL CKRECOV;               /*                       @Z40LB30*/
         BAL   @14,CKRECOV                                         0780
*       RESPECIFY                                                  0781
*         RTNREG RSTD;                                             0781
*       TESTRC=RTNREG;                                             0782
         LR    TESTRC,RTNREG                                       0782
*       RESPECIFY                                                  0783
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0783
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE INDICATES AN ERROR, SET        @Z40LB30*/
*       /* THE CONDITION CODE TO INDICATE A SEVERE ERROR     @Z40LB30*/
*       /* THAT PREVENTED A VOLUME BEING PROCESSED.          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0784
*       IF TESTRC>LASTCC00 THEN     /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0784
         BNP   @RF00784                                            0784
*         CC01=LASTCC12;            /*                       @Z40LB30*/
*                                                                  0785
         LA    CC01,12                                             0785
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME CAN BE PROCESSED, PROCESS IT.       @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0786
*       ELSE                        /*                       @Z40LB30*/
*         DO;                       /*                       @Z40LB30*/
*                                                                  0786
         B     @RC00784                                            0786
@RF00784 DS    0H                                                  0787
*           /*********************************************************/
*           /*                                                       */
*           /* CALL PROCVOL TO PROCESS THE VOLUME. SAVE      @Z40LB30*/
*           /* THE RETURN CODE. ACCUMULATE THE HIGHEST       @Z40LB30*/
*           /* RETURN CODE IN THE INTERNAL CONDITION         @Z40LB30*/
*           /* CODE AREA.                                    @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0787
*           CALL PROCVOL;           /*                       @Z40LB30*/
         BAL   @14,PROCVOL                                         0787
*           RESPECIFY                                              0788
*             RTNREG RSTD;                                         0788
*           TESTRC=RTNREG;                                         0789
         LR    TESTRC,RTNREG                                       0789
*           RESPECIFY                                              0790
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*           CC01=MAX(CC01,TESTRC);  /*                       @Z40LB30*/
*                                                                  0791
         CR    CC01,TESTRC                                         0791
         BNL   *+6
         LR    CC01,TESTRC                                         0791
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE INDICATES THE VOLUME       @Z40LB30*/
*           /* WAS PROCESSED, SET AN INDICATOR.              @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0792
*           IF TESTRC<LASTCC12 THEN /*                       @Z40LB30*/
         C     TESTRC,@CF00035                                     0792
         BNL   @RF00792                                            0792
*             ONEDONE=ON;           /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0793
*         END;                      /*                       @Z40LB30*/
*                                                                  0794
@RF00792 DS    0H                                                  0795
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE VOLUME SERIAL IN THE IEZRVVI ARGUMENT     @Z40LB30*/
*       /* LIST TO THE SERIAL IN THE CURRENT BASE VOLUME     @Z40LB30*/
*       /* RECORD IN PREPARATION FOR READING THE NEXT        @Z40LB30*/
*       /* RECORD.                                           @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0795
*       RVVOLUME=BASSERNO;          /*                       @Z40LB30*/
@RC00784 L     @02,RVVIPTR                                         0795
         MVC   RVVOLUME(6,@02),BASSERNO(BASEVPTR)                  0795
*       RVVSVOL=ON;                 /*                       @Z40LB30*/
*                                                                  0796
         OI    RVVSVOL(@02),B'00000001'                            0796
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/
*       /* RETURN CODE.                                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0797
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*        @Z40LB30*/
         L     @02,@PC00001                                        0797
         ST    @02,@AL00001                                        0797
         LA    @15,VVIC                                            0797
         ST    @15,@AL00001+4                                      0797
         LA    @15,RVVIPTR                                         0797
         ST    @15,@AL00001+8                                      0797
         LA    @15,VVICODE                                         0797
         ST    @15,@AL00001+12                                     0797
         MVI   @AL00001+12,X'80'                                   0797
         L     @15,GDTSSC(,@02)                                    0797
         LA    @01,@AL00001                                        0797
         BALR  @14,@15                                             0797
*       RESPECIFY                                                  0798
*         RTNREG RSTD;                                             0798
*       TESTRC=RTNREG;                                             0799
         LR    TESTRC,RTNREG                                       0799
*       RESPECIFY                                                  0800
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0800
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE INDICATES AN ERROR OCCURRED,   @Z40LB30*/
*       /* CALL THE SSCMSG PROCEDURE TO PRINT THE REASON     @Z40LB30*/
*       /* CODE AND THEN PRINT MESSAGE IDC2109I TO SAY NO    @Z40LB30*/
*       /* MORE VOLUMES COULD BE PROCESSED.                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0801
*       IF TESTRC^=0&VVICODE^=NORECORD&/*                    @Z40LB30*/
*           VVICODE^=NOACTIVE THEN  /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0801
         BZ    @RF00801                                            0801
         L     @02,VVICODE                                         0801
         C     @02,@CF01517                                        0801
         BE    @RF00801                                            0801
         C     @02,@CF01519                                        0801
         BE    @RF00801                                            0801
*         DO;                       /*                       @Z40LB30*/
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/
         LA    @04,VVICODE                                         0803
         ST    @04,@AL00001                                        0803
         LA    @01,@AL00001                                        0803
         BAL   @14,SSCMSG                                          0803
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0804
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0805
         MVC   DARGSMOD(3,@15),@CC01475                            0805
*           DARGSENT=MSG2109I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'41'                                 0806
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
*                                                                  0807
         L     @15,@PC00001                                        0807
         ST    @15,@AL00001                                        0807
         LA    @14,@CF00117                                        0807
         ST    @14,@AL00001+4                                      0807
         LA    @14,DDSTRU                                          0807
         ST    @14,@AL00001+8                                      0807
         MVI   @AL00001+8,X'80'                                    0807
         L     @15,GDTPRT(,@15)                                    0807
         LA    @01,@AL00001                                        0807
         BALR  @14,@15                                             0807
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE INTERNAL CONDITION CODE.              @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0808
*           CC01=LASTCC12;          /*                       @Z40LB30*/
         LA    CC01,12                                             0808
*         END;                      /*                       @Z40LB30*/
*     END;                          /*                       @Z40LB30*/
@RF00801 DS    0H                                                  0810
@DE00779 L     @15,VVICODE                                         0810
         LTR   @15,@15                                             0810
         BZ    @DL00779                                            0810
*                                                                  0811
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A RECORD WAS NOT RETURNED BY THE FIRST READ,       @Z40LB30*/
*   /* DETERMINE IF IT WAS AN ERROR OR IF THERE ARE NO       @Z40LB30*/
*   /* ACTIVE VOLUME RECORDS IN THE INVENTORY.               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0811
*   ELSE                            /*                       @Z40LB30*/
*                                                                  0811
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE RETURN CODE INDICATES NO ACTIVE VOLUME       @Z40LB30*/
*     /* RECORDS, PRINT MESSAGE IDC0104I.                    @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0811
*     IF VVICODE=NORECORD×VVICODE=NOACTIVE THEN/*            @Z40LB30*/
         B     @RC00778                                            0811
@RF00778 L     @05,VVICODE                                         0811
         C     @05,@CF01517                                        0811
         BE    @RT00811                                            0811
         C     @05,@CF01519                                        0811
         BNE   @RF00811                                            0811
@RT00811 DS    0H                                                  0812
*       DO;                         /*                       @Z40LB30*/
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0813
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0814
         MVC   DARGSMOD(3,@05),@CC01475                            0814
*         DARGSENT=MSG0104I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'3C'                                 0815
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @05,@PC00001                                        0816
         ST    @05,@AL00001                                        0816
         LA    @15,@CF00117                                        0816
         ST    @15,@AL00001+4                                      0816
         LA    @15,DDSTRU                                          0816
         ST    @15,@AL00001+8                                      0816
         MVI   @AL00001+8,X'80'                                    0816
         L     @15,GDTPRT(,@05)                                    0816
         LA    @01,@AL00001                                        0816
         BALR  @14,@15                                             0816
*       END;                        /*                       @Z40LB30*/
*                                                                  0817
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/
*   /* REASON CODE AND PRINT MESSAGE IDC2109I TO SAY NO      @Z40LB30*/
*   /* MORE VOLUMES CAN BE PROCESSED.                        @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0818
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
         B     @RC00811                                            0818
@RF00811 DS    0H                                                  0819
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/
         LA    @15,VVICODE                                         0819
         ST    @15,@AL00001                                        0819
         LA    @01,@AL00001                                        0819
         BAL   @14,SSCMSG                                          0819
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0820
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0821
         MVC   DARGSMOD(3,@05),@CC01475                            0821
*         DARGSENT=MSG2109I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'41'                                 0822
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
*                                                                  0823
         L     @05,@PC00001                                        0823
         ST    @05,@AL00001                                        0823
         LA    @15,@CF00117                                        0823
         ST    @15,@AL00001+4                                      0823
         LA    @15,DDSTRU                                          0823
         ST    @15,@AL00001+8                                      0823
         MVI   @AL00001+8,X'80'                                    0823
         L     @15,GDTPRT(,@05)                                    0823
         LA    @01,@AL00001                                        0823
         BALR  @14,@15                                             0823
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE INTERNAL CONDITION CODE TO INDICATE NO  @Z40LB30*/
*         /* VOLUMES PROCESSED.                              @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0824
*         CC01=LASTCC12;            /*                       @Z40LB30*/
         LA    CC01,12                                             0824
*       END;                        /*                       @Z40LB30*/
*                                                                  0826
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF AT LEAST     @Z40LB30*/
*   /* ONE VOLUME WAS PROCESSED, LOWER THE FINAL CONDITION   @Z40LB30*/
*   /* CODE.                                                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0826
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/
@RC00811 DS    0H                                                  0826
@RC00778 C     CC01,@CF00035                                       0826
         BNE   @RF00826                                            0826
         TM    ONEDONE,B'10000000'                                 0826
         BNO   @RF00826                                            0826
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0827
         LA    CC01,8                                              0827
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0828
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00826 LR    @15,CC01                                            0828
@EL00006 DS    0H                                                  0828
@EF00006 DS    0H                                                  0828
@ER00006 L     @14,@SA00006                                        0828
         BR    @14                                                 0828
*   END ALLVOLS;                    /*                       @Z40LB30*/
*                                                                  0830
*/********************************************************** @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - RDGRPCHN                                     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - READ THE NEXT ACTIVE AND, OPTIONALLY, GENERAL @Z40LB30*/
*/*           USE VOLUME RECORD IN A SPECIFIC GROUP.  IF     @Z40LB30*/
*/*           THERE ARE NO ACTIVE AND, OPTIONALLY, GENERAL-  @Z40LB30*/
*/*           USE VOLUMES IN THE GROUP, ISSUE MESSAGE        @Z40LB30*/
*/*           IDC0105I OR MESSAGE IDC0106I.  IF A CHAIN      @Z40LB30*/
*/*           ERROR OCCURS, ISSUE MESSAGE IDC2103I.  IF      @Z40LB30*/
*/*           ANY READ ERROR OCCURS, ISSUE MESSAGE IDC2110I. @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - GROUP RECORD. POINTER TO BASE VOLUME RECORD      @Z40LB30*/
*/*         (VOLPTR) SET WITH 0 IF NO VOLUME RECORDS HAVE    @Z40LB30*/
*/*         BEEN READ YET OR SET WITH THE ADDRESS OF THE     @Z40LB30*/
*/*         LAST VOLUME RECORD READ. FUNTION DEFINITION      @Z40LB30*/
*/*         TABLE.                                           @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/
*/*                        4, AN ERROR OCCURRED              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*          POINTER TO VOLUME RECORD SET WITH 0 IF NO MORE  @Z40LB30*/
*/*          RECORDS ARE IN THE GROUP OR SET WITH ADDRESS    @Z40LB30*/
*/*          OF VOLUME RECORD JUST READ                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************** @Z40LB30*/
*                                                                  0830
*RDGRPCHN:                                                         0830
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
RDGRPCHN ST    @14,@SA00007                                        0830
*                                                                  0831
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE.    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0831
*   OLDERID2=NEWERID2;                                             0831
         L     @06,@PC00001                                        0831
         L     @15,GDTTR2(,@06)                                    0831
         MVC   @TS00001(95),NEWERID2(@15)                          0831
         MVC   OLDERID2(95,@15),@TS00001                           0831
*   NEWID2='LDRG';                  /*                       @Z40LB30*/
*                                                                  0832
         MVC   NEWID2(4,@15),@CC01614                              0832
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE TO ZERO AND INITIALIZE INDICATOR   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*   CC02=0;                         /*                       @Z40LB30*/
         SLR   @15,@15                                             0833
         LR    CC02,@15                                            0833
*   NOVOLS=OFF;                     /*                       @Z40LB30*/
         NI    NOVOLS,B'11101111'                                  0834
*                                                                  0835
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO BASE VOLUME RECORDS HAVE BEEN READ YET FOR      @Z40LB30*/
*   /* THIS GROUP, CHECK FOR NO VOLUMES IN THE GROUP AND     @Z40LB30*/
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST.                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0835
*   IF VOLPTR=NULLPTR THEN          /*                       @Z40LB30*/
         C     @15,VOLPTR                                          0835
         BNE   @RF00835                                            0835
*     DO;                           /*                       @Z40LB30*/
*                                                                  0836
*       /*************************************************************/
*       /*                                                           */
*       /* IF GENERAL WAS SPECIFIED, BUT THERE ARE NO        @Z40LB30*/
*       /* ACTIVE GENERAL VOLUMES IN THE GROUP, ISSUE        @Z40LB30*/
*       /* MESSAGE IDC0106I.                                 @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0837
*       IF ADDR(GENER)^=NULLPTR&GRONGEN=0 THEN/*             @Z40LB30*/
         L     @14,@PC00001+4                                      0837
         C     @15,FDTPTR+76(,@14)                                 0837
         BE    @RF00837                                            0837
         L     @14,GROUPPTR                                        0837
         CH    @15,GRONGEN(,@14)                                   0837
         BNE   @RF00837                                            0837
*         DO;                       /*                       @Z40LB30*/
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0839
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0840
         MVC   DARGSMOD(3,@15),@CC01475                            0840
*           DARGSENT=MSG0106I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'3E'                                 0841
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB26*/
         LA    @14,GROVVGRP(,@14)                                  0842
         ST    @14,DARGDBP(,@15)                                   0842
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB26*/
         MVC   DARGILP(2,@15),@CH00182                             0843
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         ST    @06,@AL00001                                        0844
         LA    @15,@CF00117                                        0844
         ST    @15,@AL00001+4                                      0844
         LA    @15,DDSTRU                                          0844
         ST    @15,@AL00001+8                                      0844
         MVI   @AL00001+8,X'80'                                    0844
         L     @15,GDTPRT(,@06)                                    0844
         LA    @01,@AL00001                                        0844
         BALR  @14,@15                                             0844
*           NOVOLS=ON;              /*                       @Z40LB30*/
         OI    NOVOLS,B'00010000'                                  0845
*         END;                      /*                       @Z40LB30*/
*                                                                  0846
*       /*************************************************************/
*       /*                                                           */
*       /* IF GENERAL WAS NOT SPECIFIED, BUT THERE ARE NO    @Z40LB30*/
*       /* ACTIVE GENERAL OR RESTRICTED VOLUMES IN THE GROUP @Z40LB30*/
*       /* ISSUE MESSAGE IDC0105I.                           @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0847
*       IF ADDR(GENER)=NULLPTR&GRONGEN=0&/*                  @Z40LB30*/
*           GRONRSTD=0 THEN         /*                       @Z40LB30*/
@RF00837 SLR   @06,@06                                             0847
         L     @15,@PC00001+4                                      0847
         C     @06,FDTPTR+76(,@15)                                 0847
         BNE   @RF00847                                            0847
         L     @15,GROUPPTR                                        0847
         CH    @06,GRONGEN(,@15)                                   0847
         BNE   @RF00847                                            0847
         CH    @06,GRONRSTD(,@15)                                  0847
         BNE   @RF00847                                            0847
*         DO;                       /*                       @Z40LB30*/
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0849
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @06,DDSTRU                                          0850
         MVC   DARGSMOD(3,@06),@CC01475                            0850
*           DARGSENT=MSG0105I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'3D'                                 0851
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB26*/
         LA    @15,GROVVGRP(,@15)                                  0852
         ST    @15,DARGDBP(,@06)                                   0852
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB26*/
         MVC   DARGILP(2,@06),@CH00182                             0853
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @06,@PC00001                                        0854
         ST    @06,@AL00001                                        0854
         LA    @15,@CF00117                                        0854
         ST    @15,@AL00001+4                                      0854
         LA    @15,DDSTRU                                          0854
         ST    @15,@AL00001+8                                      0854
         MVI   @AL00001+8,X'80'                                    0854
         L     @15,GDTPRT(,@06)                                    0854
         LA    @01,@AL00001                                        0854
         BALR  @14,@15                                             0854
*           NOVOLS=ON;              /*                       @Z40LB30*/
         OI    NOVOLS,B'00010000'                                  0855
*         END;                      /*                       @Z40LB30*/
*                                                                  0856
*       /*************************************************************/
*       /*                                                           */
*       /* IF THERE ARE SOME VOLUMES IN THE GROUP, SET       @Z40LB30*/
*       /* FIELDS IN THE IEZRVVI ARGUMENT LIST TO READ       @Z40LB30*/
*       /* VOLUME RECORDS IN THE GROUP.                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0857
*       IF NOVOLS=OFF THEN          /*                       @Z40LB30*/
@RF00847 TM    NOVOLS,B'00010000'                                  0857
         BNZ   @RF00857                                            0857
*         DO;                       /*                       @Z40LB30*/
*           VOLRVVI=''B;            /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0859
*           RVVIPTR=ADDR(VOLRVVI);  /*                       @Z40LB30*/
         LA    @06,VOLRVVI                                         0860
         ST    @06,RVVIPTR                                         0860
*           RVVLNGTH=RVVLEN;        /*                       @Z40LB30*/
         LH    @15,RVVLEN                                          0861
         ST    @15,RVVLNGTH(,@06)                                  0861
*           RVVCODE=RVVOP;          /*                       @Z40LB30*/
         MVI   RVVCODE(@06),X'87'                                  0862
*           RVVGROUP=GROVVGRP;      /* GROUP NAME            @Z40LB26*/
         L     @15,GROUPPTR                                        0863
         MVC   RVVGROUP(8,@06),GROVVGRP(@15)                       0863
*           RVVSVOL=ON;             /* VOLUME SPECIFIED      @Z40LB26*/
         OI    RVVSVOL(@06),B'00000001'                            0864
*           RVVOLUME=GROFSN;        /* FIRST VOL IN CHAIN    @Z40LB26*/
         MVC   RVVOLUME(6,@06),GROFSN(@15)                         0865
*           RVVBUFLN=LENGTH(VOLREC);/*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@06),@CH01761                            0866
*           RVVRTBUF=ADDR(VOLREC);  /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @15,VOLREC                                          0867
         ST    @15,RVVRTBUF(,@06)                                  0867
*           RVVRDCH=ON;             /* READ CHAIN            @Z40LB30*/
         OI    RVVRDCH(@06),B'00100000'                            0868
*           RVVBVRCD=ON;            /* BASE VOLUME           @Z40LB30*/
         OI    RVVBVRCD(@06),B'10000000'                           0869
*           RVVGPVOL=ON;            /* GROUPED CHAIN         @Z40LB30*/
         OI    RVVGPVOL(@06),B'10000000'                           0870
*           RVVACTV=ON;             /* ONLY ACTIVE VOLUMES   @Z40LB30*/
         OI    RVVACTV(@06),B'00000100'                            0871
*           RVVSGRP=ON;             /* GROUP NAME SPECIFIED  @Z40LB30*/
*                                                                  0872
         OI    RVVSGRP(@06),B'10000000'                            0872
*           /*********************************************************/
*           /*                                                       */
*           /* IF ONLY GENERAL VOLUMES REQUESTED ON THE      @Z40LB30*/
*           /* COMMAND, SPECIFY THAT.                        @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0873
*           IF ADDR(GENER)^=NULLPTR THEN/*                   @Z40LB30*/
         L     @15,@PC00001+4                                      0873
         L     @15,FDTPTR+76(,@15)                                 0873
         LTR   @15,@15                                             0873
         BZ    @RF00873                                            0873
*             RVVGSVOL=ON;          /*                       @Z40LB30*/
         OI    RVVGSVOL(@06),B'00100000'                           0874
*         END;                      /*                       @Z40LB30*/
*                                                                  0875
@RF00873 DS    0H                                                  0876
*       /*************************************************************/
*       /*                                                           */
*       /* IF THERE ARE NO VOLUMES TO BE PROCESSED IN THIS   @Z40LB26*/
*       /* GROUP, SET AN INDICATOR SO THE FINAL CONDITION    @Z40LB26*/
*       /* CODE CAN BE SET TO REFLECT ONE GROUP WAS          @Z40LB26*/
*       /* PROCESSED.                                        @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0876
*       IF NOVOLS=ON THEN           /*                       @Z40LB26*/
@RF00857 TM    NOVOLS,B'00010000'                                  0876
         BNO   @RF00876                                            0876
*         EMPTYGRP=ON;              /*                       @Z40LB26*/
         OI    EMPTYGRP,B'00001000'                                0877
*     END;                          /*                       @Z40LB30*/
*                                                                  0879
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A BASE VOLUME RECORD IN THIS GROUP HAS BEEN READ   @Z40LB30*/
*   /* PREVIOUSLY, CHECK IF THERE ARE ANY MORE VOLUMES IN    @Z40LB30*/
*   /* THE GROUP.                                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0879
*   ELSE                            /*                       @Z40LB30*/
*                                                                  0879
*     /***************************************************************/
*     /*                                                             */
*     /* NO MORE VOLUMES                                     @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0879
*     IF BASLAST=ON THEN            /*                       @Z40LB30*/
*                                                                  0879
         B     @RC00835                                            0879
@RF00835 TM    BASLAST(BASEVPTR),B'00001000'                       0879
         BNO   @RF00879                                            0879
*       /*************************************************************/
*       /*                                                           */
*       /* SET INDICATOR AND ZERO OUT THE POINTER TO THE     @Z40LB30*/
*       /* VOLUME RECORD.                                    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0880
*       DO;                         /*                       @Z40LB30*/
*         NOVOLS=ON;                /*                       @Z40LB30*/
         OI    NOVOLS,B'00010000'                                  0881
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/
         SLR   @06,@06                                             0882
         ST    @06,VOLPTR                                          0882
*       END;                        /*                       @Z40LB30*/
*                                                                  0883
*   /*****************************************************************/
*   /*                                                               */
*   /* MORE VOLUMES                                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0884
*     ELSE                          /*                       @Z40LB30*/
*                                                                  0884
*       /*************************************************************/
*       /*                                                           */
*       /* PUT THE NEXT VOLUME SERIAL INTO THE IEZRVVI       @Z40LB30*/
*       /* ARGUMENT LIST                                     @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0884
*       DO;                         /*                       @Z40LB30*/
         B     @RC00879                                            0884
@RF00879 DS    0H                                                  0885
*         RVVIPTR=ADDR(VOLRVVI);    /*                       @Z40LB30*/
         LA    @06,VOLRVVI                                         0885
         ST    @06,RVVIPTR                                         0885
*         RVVOLUME=BASNEXTV;        /*                       @Z40LB30*/
         MVC   RVVOLUME(6,@06),BASNEXTV(BASEVPTR)                  0886
*       END;                        /*                       @Z40LB30*/
*                                                                  0888
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE ARE MORE VOLUMES IN THE GROUP, READ ONE.     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0888
*   IF NOVOLS=OFF THEN              /*                       @Z40LB30*/
@RC00879 DS    0H                                                  0888
@RC00835 TM    NOVOLS,B'00010000'                                  0888
         BNZ   @RF00888                                            0888
*     DO;                           /*                       @Z40LB30*/
*                                                                  0889
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/
*       /* RETURN CODE.                                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0890
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE2);/*       @Z40LB30*/
         L     @06,@PC00001                                        0890
         ST    @06,@AL00001                                        0890
         LA    @02,VVIC                                            0890
         ST    @02,@AL00001+4                                      0890
         LA    @02,RVVIPTR                                         0890
         ST    @02,@AL00001+8                                      0890
         LA    @02,VVICODE2                                        0890
         ST    @02,@AL00001+12                                     0890
         MVI   @AL00001+12,X'80'                                   0890
         L     @15,GDTSSC(,@06)                                    0890
         LA    @01,@AL00001                                        0890
         BALR  @14,@15                                             0890
*       RESPECIFY                                                  0891
*         RTNREG RSTD;                                             0891
*       TESTRC=RTNREG;                                             0892
         LR    TESTRC,RTNREG                                       0892
*       RESPECIFY                                                  0893
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0893
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO ERROR, PUT ADDRESS OF RECORD IN POINTER     @Z40LB30*/
*       /* AREA FOR CALLER.                                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0894
*       IF TESTRC=0 THEN            /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0894
         BNZ   @RF00894                                            0894
*         VOLPTR=ADDR(VOLREC);      /*                       @Z40LB30*/
         LA    @06,VOLREC                                          0895
         ST    @06,VOLPTR                                          0895
*                                                                  0896
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO RECORD WAS READ, CHECK FOR ERRORS.          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0896
*       ELSE                        /*                       @Z40LB30*/
*         DO;                       /*                       @Z40LB30*/
*                                                                  0896
         B     @RC00894                                            0896
@RF00894 DS    0H                                                  0897
*           /*********************************************************/
*           /*                                                       */
*           /* SET VOLUME RECORD POINTER TO ZERO.            @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0897
*           VOLPTR=NULLPTR;         /*                       @Z40LB30*/
*                                                                  0897
         SLR   @06,@06                                             0897
         ST    @06,VOLPTR                                          0897
*           /*********************************************************/
*           /*                                                       */
*           /* IF A REAL ERROR OCCURRED, PROCESS IT.         @Z40LB30*/
*           /* NO MORE ACTIVE VOLUMES IS NOT AN ERROR.       @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0898
*           IF VVICODE2^=NOACTIVE THEN/*                     @Z40LB30*/
         L     @06,VVICODE2                                        0898
         C     @06,@CF01519                                        0898
         BE    @RF00898                                            0898
*             DO;                   /*                       @Z40LB30*/
*                                                                  0899
*               /*****************************************************/
*               /*                                                   */
*               /* IF CHAINING ERROR, ISSUE MESSAGE IDC2103I @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0900
*               IF VVICODE2=NORECORD×VVICODE2=WRONGCHN/*     @Z40LB30*/
*                 THEN              /*                       @Z40LB30*/
         C     @06,@CF01517                                        0900
         BE    @RT00900                                            0900
         C     @06,@CF01521                                        0900
         BNE   @RF00900                                            0900
@RT00900 DS    0H                                                  0901
*                 DO;               /*                       @Z40LB30*/
*                   DARGAREA=''B;   /*                       @Z40LB30*/
         XC    DARGAREA(76),DARGAREA                               0902
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/
         L     @15,DDSTRU                                          0903
         MVC   DARGSMOD(3,@15),@CC01475                            0903
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/
         MVI   DARGSENT(@15),X'3B'                                 0904
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/
         L     @15,@PC00001                                        0905
         ST    @15,@AL00001                                        0905
         LA    @14,@CF00117                                        0905
         ST    @14,@AL00001+4                                      0905
         LA    @14,DDSTRU                                          0905
         ST    @14,@AL00001+8                                      0905
         MVI   @AL00001+8,X'80'                                    0905
         L     @15,GDTPRT(,@15)                                    0905
         LA    @01,@AL00001                                        0905
         BALR  @14,@15                                             0905
*                 END;              /*                       @Z40LB30*/
*                                                                  0906
*               /*****************************************************/
*               /*                                                   */
*               /* IF ANOTHER ERROR, CALL SSCMSG TO PRINT    @Z40LB30*/
*               /* REASON CODE.                              @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0907
*               ELSE                /*                       @Z40LB30*/
*                 CALL SSCMSG(VVICODE2);/*                   @Z40LB30*/
*                                                                  0907
         B     @RC00900                                            0907
@RF00900 LA    @15,VVICODE2                                        0907
         ST    @15,@AL00001                                        0907
         LA    @01,@AL00001                                        0907
         BAL   @14,SSCMSG                                          0907
*               /*****************************************************/
*               /*                                                   */
*               /* FOLLOW WITH MESSAGE IDC2110I TO SAY NO    @Z40LB30*/
*               /* MORE VOLUMES IN THE GROUP CAN BE          @Z40LB30*/
*               /* PROCESSED.                                @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0908
*               DARGAREA=''B;       /*                       @Z40LB30*/
@RC00900 XC    DARGAREA(76),DARGAREA                               0908
*               DARGSMOD=CM0MSG;    /*                       @Z40LB30*/
         L     @06,DDSTRU                                          0909
         MVC   DARGSMOD(3,@06),@CC01475                            0909
*               DARGSENT=MSG2110I;  /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'42'                                 0910
*               DARGDBP=ADDR(GROVVGRP);/*                    @Z40LB26*/
         L     @01,GROUPPTR                                        0911
         LA    @15,GROVVGRP(,@01)                                  0911
         ST    @15,DARGDBP(,@06)                                   0911
*               DARGILP=LENGTH(GROVVGRP);/*                  @Z40LB26*/
         MVC   DARGILP(2,@06),@CH00182                             0912
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/
*                                                                  0913
         L     @06,@PC00001                                        0913
         ST    @06,@AL00001                                        0913
         LA    @15,@CF00117                                        0913
         ST    @15,@AL00001+4                                      0913
         LA    @15,DDSTRU                                          0913
         ST    @15,@AL00001+8                                      0913
         MVI   @AL00001+8,X'80'                                    0913
         L     @15,GDTPRT(,@06)                                    0913
         LA    @01,@AL00001                                        0913
         BALR  @14,@15                                             0913
*               /*****************************************************/
*               /*                                                   */
*               /* SET CONDITION CODE                        @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0914
*               CC02=4;             /*                       @Z40LB30*/
         LA    CC02,4                                              0914
*             END;                  /*                       @Z40LB30*/
*         END;                      /*                       @Z40LB30*/
@RF00898 DS    0H                                                  0917
*     END;                          /*                       @Z40LB30*/
*                                                                  0917
@RC00894 DS    0H                                                  0918
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0918
*   RETURN CODE(CC02);              /*                       @Z40LB30*/
@RF00888 LR    @15,CC02                                            0918
@EL00007 DS    0H                                                  0918
@EF00007 DS    0H                                                  0918
@ER00007 L     @14,@SA00007                                        0918
         BR    @14                                                 0918
*   END RDGRPCHN;                   /*                       @Z40LB30*/
*                                                                  0920
*/*********************************************************  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - CKRECOV                                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  CHECKS EACH BASE VOLUME RECORD READ FROM THE @Z40LB26*/
*/*             MSVI TO SEE IF ANY OF THE RECOVERY FLAGS ARE @Z40LB26*/
*/*             ON.  IF ANY ARE ON, THE VOLUME CANNOT BE     @Z40LB26*/
*/*             PROCESSED.  MESSAGES ISSUED IF RECOVERY      @Z40LB26*/
*/*             FLAGS ARE ON INCLUDE IDC2095I, IDC2096I,     @Z40LB26*/
*/*             IDC2097I AND IDC2108I.                       @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - BASE VOLUME RECORD FROM THE MSVI.                @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 - 0, VOLUME OK TO USE               @Z40LB26*/
*/*                       12, VOLUME IS NOT USABLE           @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*********************************************************  @Z40LB26*/
*                                                                  0920
*CKRECOV:                                                          0920
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
CKRECOV  ST    @14,@SA00008                                        0920
*                                                                  0921
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT                               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0921
*   OLDERID2=NEWERID2;                                             0921
         L     @06,@PC00001                                        0921
         L     @15,GDTTR2(,@06)                                    0921
         MVC   @TS00001(95),NEWERID2(@15)                          0921
         MVC   OLDERID2(95,@15),@TS00001                           0921
*   NEWID2='LDCK';                  /*                       @Z40LB26*/
*                                                                  0922
         MVC   NEWID2(4,@15),@CC01618                              0922
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0923
*   CC02=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  0923
         SLR   CC02,CC02                                           0923
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK BASE VOLUME RECORD TO SEE IF ANY RECOVERY       @Z40LB26*/
*   /* FLAGS ARE ON.                                         @Z40LB26*/
*   /* IF VOLUME WAS INCOMPLETELY RENAMED, ISSUE MESSAGE     @Z40LB26*/
*   /* IDC2095I AND SET CONDITION CODE.                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0924
*   IF BASVSMIS=ON THEN             /*                       @Z40LB26*/
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0924
         BNO   @RF00924                                            0924
*     DO;                           /*                       @Z40LB26*/
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               0926
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/
         L     @15,DDSTRU                                          0927
         MVC   DARGSMOD(3,@15),@CC01475                            0927
*       DARGSENT=MSG2095I;          /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'09'                                 0928
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/
         LA    @14,BASSERNO(,BASEVPTR)                             0929
         ST    @14,DARGDBP(,@15)                                   0929
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/
         MVC   DARGILP(2,@15),@CH00159                             0930
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
         ST    @06,@AL00001                                        0931
         LA    @15,@CF00117                                        0931
         ST    @15,@AL00001+4                                      0931
         LA    @15,DDSTRU                                          0931
         ST    @15,@AL00001+8                                      0931
         MVI   @AL00001+8,X'80'                                    0931
         L     @15,GDTPRT(,@06)                                    0931
         LA    @01,@AL00001                                        0931
         BALR  @14,@15                                             0931
*       CC02=LASTCC12;              /*                       @Z40LB26*/
         LA    CC02,12                                             0932
*     END;                          /*                       @Z40LB26*/
*                                                                  0933
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME WAS INCOMPLETELY COPIED, ISSUE MESSAGE      @Z40LB26*/
*   /* IDC2096I AND SET CONDITION CODE                       @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0934
*   IF BASIVCPY=ON THEN             /*                       @Z40LB26*/
@RF00924 TM    BASIVCPY(BASEVPTR),B'01000000'                      0934
         BNO   @RF00934                                            0934
*     DO;                           /*                       @Z40LB26*/
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               0936
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/
         L     @06,DDSTRU                                          0937
         MVC   DARGSMOD(3,@06),@CC01475                            0937
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/
         LA    @15,BASSERNO(,BASEVPTR)                             0938
         ST    @15,DARGDBP(,@06)                                   0938
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/
         MVC   DARGILP(2,@06),@CH00159                             0939
*       DARGSENT=MSG2096I;          /*                       @Z40LB26*/
         MVI   DARGSENT(@06),X'06'                                 0940
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
         L     @06,@PC00001                                        0941
         ST    @06,@AL00001                                        0941
         LA    @15,@CF00117                                        0941
         ST    @15,@AL00001+4                                      0941
         LA    @15,DDSTRU                                          0941
         ST    @15,@AL00001+8                                      0941
         MVI   @AL00001+8,X'80'                                    0941
         L     @15,GDTPRT(,@06)                                    0941
         LA    @01,@AL00001                                        0941
         BALR  @14,@15                                             0941
*       CC02=LASTCC12;              /*                       @Z40LB26*/
         LA    CC02,12                                             0942
*     END;                          /*                       @Z40LB26*/
*                                                                  0943
*   /*****************************************************************/
*   /*                                                               */
*   /* IF BASE VOLUME RECORD HAS THE INCOMPLETE CREATE FLAG  @Z40LB26*/
*   /* ON, ISSUE MESSAGE IDC2097I AND SET THE CONDITION CODE.@Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0944
*   IF BASIVCRE=ON THEN             /*                       @Z40LB26*/
@RF00934 TM    BASIVCRE(BASEVPTR),B'10000000'                      0944
         BNO   @RF00944                                            0944
*     DO;                           /*                       @Z40LB26*/
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               0946
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/
         L     @06,DDSTRU                                          0947
         MVC   DARGSMOD(3,@06),@CC01475                            0947
*       DARGSENT=MSG2097I;          /*                       @Z40LB26*/
         MVI   DARGSENT(@06),X'03'                                 0948
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/
         LA    @15,BASSERNO(,BASEVPTR)                             0949
         ST    @15,DARGDBP(,@06)                                   0949
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/
         MVC   DARGILP(2,@06),@CH00159                             0950
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
         L     @06,@PC00001                                        0951
         ST    @06,@AL00001                                        0951
         LA    @15,@CF00117                                        0951
         ST    @15,@AL00001+4                                      0951
         LA    @15,DDSTRU                                          0951
         ST    @15,@AL00001+8                                      0951
         MVI   @AL00001+8,X'80'                                    0951
         L     @15,GDTPRT(,@06)                                    0951
         LA    @01,@AL00001                                        0951
         BALR  @14,@15                                             0951
*       CC02=LASTCC12;              /*                       @Z40LB26*/
         LA    CC02,12                                             0952
*     END;                          /*                       @Z40LB26*/
*                                                                  0953
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF ANY OF THE RECOVERY FLAGS WERE FOUND  @Z40LB26*/
*   /* TO BE ON. IF ANY WERE ON, ISSUE SECONDARY MESSAGE     @Z40LB26*/
*   /* IDC2108I TO INDICATE THE VOLUME WAS NOT PROCESSED     @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   IF CC02^=LASTCC00 THEN          /*                       @Z40LB26*/
@RF00944 LTR   CC02,CC02                                           0954
         BZ    @RF00954                                            0954
*     DO;                           /*                       @Z40LB26*/
*       DARGSENT=MSG2108I;          /*                       @Z40LB26*/
         L     @06,DDSTRU                                          0956
         MVI   DARGSENT(@06),X'40'                                 0956
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
         L     @06,@PC00001                                        0957
         ST    @06,@AL00001                                        0957
         LA    @15,@CF00117                                        0957
         ST    @15,@AL00001+4                                      0957
         LA    @15,DDSTRU                                          0957
         ST    @15,@AL00001+8                                      0957
         MVI   @AL00001+8,X'80'                                    0957
         L     @15,GDTPRT(,@06)                                    0957
         LA    @01,@AL00001                                        0957
         BALR  @14,@15                                             0957
*     END;                          /*                       @Z40LB26*/
*                                                                  0958
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0959
*   RETURN CODE(CC02);              /*                       @Z40LB26*/
@RF00954 LR    @15,CC02                                            0959
@EL00008 DS    0H                                                  0959
@EF00008 DS    0H                                                  0959
@ER00008 L     @14,@SA00008                                        0959
         BR    @14                                                 0959
*   END CKRECOV;                    /*                       @Z40LB26*/
*                                                                  0961
*/********************************************************** @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - SELECTOR                                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  CONTROLS SELECTION OF DATA SETS FOR LISTING  @Z40LB26*/
*/*             ON A PARTICULAR VOLUME.  IF THERE ARE NO     @Z40LB26*/
*/*             DATA SETS ELIGIBLE FOR SELECTION ON VOLUME,  @Z40LB26*/
*/*             ISSUE PRIMARY MESSAGE IDC0107I.  IF THE      @Z40LB26*/
*/*             VOLUME CANNOT BE PROCESSED, ISSUE SECONDARY  @Z40LB26*/
*/*             MESSAGE IDC2108I.                            @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - BASE VOLUME RECORD, DDNAME FOR THE VOLUME,       @Z40LB26*/
*/*         RE-FORMATED CREATION AND EXPIRATION DATES        @Z40LB26*/
*/*         IF SPECIFIED, FUNCTIONAL DATA TABLE, AND         @Z40LB26*/
*/*         UCB ADDRESS FOR EITHER A UNIQUE DD CARD TO BE    @Z40LB26*/
*/*         USED OR FOR THE FILE PARAMETER DD                @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, NO ERROR                       @Z40LB26*/
*/*                        4, VTOC CLOSE ERROR               @Z40LB26*/
*/*                        8, AN ERROR OCCURRED, BUT THE     @Z40LB26*/
*/*                           LIST OF ELIGIBLE DATA SETS     @Z40LB26*/
*/*                           IS TO BE PROCESSED             @Z40LB26*/
*/*                       12, NO LIST OF ELIGIBLE DATA SETS  @Z40LB26*/
*/*                           RETURNED DUE TO ERROR          @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*          LISTADDR SET TO 0 IF NO LIST OF DATA SETS       @Z40LB26*/
*/*                   SET TO ADDRESS OF LIST OF DATA SETS    @Z40LB26*/
*/*                                                          @Z40LB26*/
*/********************************************************** @Z40LB26*/
*                                                                  0961
*SELECTOR:                                                         0961
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
SELECTOR ST    @14,@SA00009                                        0961
*                                                                  0962
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT                               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0962
*   OLDERID2=NEWERID2;                                             0962
         L     @07,@PC00001                                        0962
         L     @07,GDTTR2(,@07)                                    0962
         MVC   @TS00001(95),NEWERID2(@07)                          0962
         MVC   OLDERID2(95,@07),@TS00001                           0962
*   NEWID2='LDSL';                  /*                       @Z40LB26*/
*                                                                  0963
         MVC   NEWID2(4,@07),@CC01623                              0963
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO INTERNAL CONDITION CODE                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0964
*   CC03=LASTCC00;                  /*                       @Z40LB26*/
         SLR   @15,@15                                             0964
         LR    CC03,@15                                            0964
*                                                                  0965
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF ARGUMENT LIST IS ALREADY SET UP FOR   @Z40LB26*/
*   /* IDCVS03 AND INITIALIZE IT IF IT HASN'T ALREADY BEEN.  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*   IF INITVS3=OFF THEN             /*                       @Z40LB26*/
         TM    INITVS3,B'01000000'                                 0965
         BNZ   @RF00965                                            0965
*     DO;                           /*                       @Z40LB26*/
*       INITVS3=ON;                 /*                       @Z40LB26*/
         OI    INITVS3,B'01000000'                                 0967
*       VS3AGL=''B;                 /* CLEAR IT              @Z40LB26*/
         LA    @07,AREAVS3                                         0968
         XC    VS3AGL(59,@07),VS3AGL(@07)                          0968
*       VS3LISTP=ADDR(LISTADDR);    /* ADDR OF LIST PTR      @Z40LB26*/
         LA    @14,LISTADDR                                        0969
         ST    @14,VS3LISTP(,@07)                                  0969
*       VS3POOL=POOLID;             /* STORAGE POOL ID       @Z40LB26*/
         MVC   VS3POOL(4,@07),@CC01511                             0970
*       VS3DEV=DEV3330V;            /* VIRTUAL DEVICE TYPE   @Z40LB26*/
*                                                                  0971
         MVC   VS3DEV(4,@07),@CB01515                              0971
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF LEVEL PARAMETER WAS SPECIFIED     @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0972
*       IF ADDR(LEVEL)^=NULLPTR THEN/*                       @Z40LB26*/
         L     @14,@PC00001+4                                      0972
         L     @14,FDTPTR+20(,@14)                                 0972
         CR    @14,@15                                             0972
         BE    @RF00972                                            0972
*         DO;                       /*                       @Z40LB26*/
*                                                                  0973
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE VALUES FROM FDT                    @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0974
*           VS3LEVP=ADDR(LEVELVAL); /*                       @Z40LB26*/
         LA    @15,LEVELVAL(,@14)                                  0974
         ST    @15,VS3LEVP(,@07)                                   0974
*           VS3LEVLN=LEVELLEN;      /*                       @Z40LB26*/
         SLR   @15,@15                                             0975
         IC    @15,LEVELLEN(,@14)                                  0975
         STH   @15,VS3LEVLN(,@07)                                  0975
*           VS3AST=LEVELPOS;        /*                       @Z40LB26*/
         SLR   @15,@15                                             0976
         IC    @15,LEVELPOS(,@14)                                  0976
         STH   @15,VS3AST(,@07)                                    0976
*         END;                      /*                       @Z40LB26*/
*                                                                  0977
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF EXPIRATION OR CREATION DATES      @Z40LB26*/
*       /* WERE SPECIFIED. IF SPECIFIED, SET IN VS3AGL.      @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0978
*       IF ADDR(EXPDT)^=NULLPTR×ADDR(EXPIR)^=NULLPTR/*       @Z40LB26*/
*         THEN                      /*                       @Z40LB26*/
@RF00972 SLR   @07,@07                                             0978
         L     @15,@PC00001+4                                      0978
         C     @07,FDTPTR+28(,@15)                                 0978
         BNE   @RT00978                                            0978
         C     @07,FDTPTR+32(,@15)                                 0978
         BE    @RF00978                                            0978
@RT00978 DS    0H                                                  0979
*         VS3EXPIR=ADDR(EXPDATE);   /*                       @Z40LB26*/
         LA    @07,AREAVS3                                         0979
         LA    @15,EXPDATE                                         0979
         ST    @15,VS3EXPIR(,@07)                                  0979
*       IF ADDR(CREDT)^=NULLPTR×ADDR(CREAT)^=NULLPTR/*       @Z40LB26*/
*         THEN                      /*                       @Z40LB26*/
@RF00978 SLR   @07,@07                                             0980
         L     @15,@PC00001+4                                      0980
         C     @07,FDTPTR+36(,@15)                                 0980
         BNE   @RT00980                                            0980
         C     @07,FDTPTR+40(,@15)                                 0980
         BE    @RF00980                                            0980
@RT00980 DS    0H                                                  0981
*         VS3CREAT=ADDR(CREDATE);   /*                       @Z40LB26*/
*                                                                  0981
         LA    @07,AREAVS3                                         0981
         LA    @15,CREDATE                                         0981
         ST    @15,VS3CREAT(,@07)                                  0981
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP TYPE OF REPORT DESIRED                     @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0982
*       IF ADDR(STAT)^=NULLPTR THEN /*                       @Z40LB26*/
@RF00980 L     @07,@PC00001+4                                      0982
         L     @07,FDTPTR+52(,@07)                                 0982
         LTR   @07,@07                                             0982
         BZ    @RF00982                                            0982
*         VS3STAT=ON;               /*                       @Z40LB26*/
         LA    @07,AREAVS3                                         0983
         OI    VS3STAT(@07),B'10000000'                            0983
*       ELSE                        /*                       @Z40LB26*/
*         VS3USAGE=ON;              /*                       @Z40LB26*/
*                                                                  0984
         B     @RC00982                                            0984
@RF00982 LA    @07,AREAVS3                                         0984
         OI    VS3USAGE(@07),B'01000000'                           0984
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF UNCATALOGED SPECIFIED                    @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0985
*       IF ADDR(UNCAT)^=NULLPTR THEN/*                       @Z40LB26*/
@RC00982 L     @07,@PC00001+4                                      0985
         L     @07,FDTPTR+24(,@07)                                 0985
         LTR   @07,@07                                             0985
         BZ    @RF00985                                            0985
*         VS3UNCAT=ON;              /*                       @Z40LB26*/
         LA    @07,AREAVS3                                         0986
         OI    VS3UNCAT(@07),B'00010000'                           0986
*     END;                          /*                       @Z40LB26*/
*                                                                  0987
@RF00985 DS    0H                                                  0988
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FIELDS IN VS03 PARAMETER LIST THAT CHANGE      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0988
*   VS3VOL=BASSERNO;                /* VOLUME ID             @Z40LB26*/
@RF00965 LA    @07,AREAVS3                                         0988
         MVC   VS3VOL(6,@07),BASSERNO(BASEVPTR)                    0988
*   VS3DD=DDNAME;                   /* DDNAME OF DEVICE      @Z40LB26*/
         MVC   VS3DD(8,@07),DDNAME                                 0989
*   LISTADDR=NULLPTR;               /* ZERO ADDRESS OF LIST  @Z40LB26*/
*                                                                  0990
         SLR   @15,@15                                             0990
         ST    @15,LISTADDR                                        0990
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE UCB ADDRESS WAS RETURNED BY UMSSUNIT SELECTDD  @Z40LB26*/
*   /* FUNCTION, SET IT IN THE VS3AGL. IF NOT AND THE FILE   @Z40LB26*/
*   /* PARAMETER WAS SPECIFIED, SET THAT UCB ADDRESS IN THE  @Z40LB26*/
*   /* VS3AGL. IF THE FILE PARAMETER WAS NOT SPECIFIED       @Z40LB26*/
*   /* EITHER, SET THE UCB ADDRESS IN VS3AGL TO ZERO.        @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0991
*   IF ADDRUCB^=NULLPTR THEN        /*                       @Z40LB26*/
         L     @14,ADDRUCB                                         0991
         CR    @14,@15                                             0991
         BE    @RF00991                                            0991
*     VS3UCBP=ADDRUCB;              /*                       @Z40LB26*/
         ST    @14,VS3UCBP(,@07)                                   0992
*   ELSE                            /*                       @Z40LB26*/
*     IF ADDR(FILE)^=NULLPTR THEN   /*                       @Z40LB26*/
         B     @RC00991                                            0993
@RF00991 L     @07,@PC00001+4                                      0993
         L     @07,FDTPTR+44(,@07)                                 0993
         LTR   @07,@07                                             0993
         BZ    @RF00993                                            0993
*       VS3UCBP=FILEUCB;            /*                       @Z40LB26*/
         LA    @07,AREAVS3                                         0994
         L     @15,FILEUCB                                         0994
         ST    @15,VS3UCBP(,@07)                                   0994
*     ELSE                          /*                       @Z40LB26*/
*       VS3UCBP=NULLPTR;            /*                       @Z40LB26*/
*                                                                  0995
         B     @RC00993                                            0995
@RF00993 LA    @07,AREAVS3                                         0995
         SLR   @15,@15                                             0995
         ST    @15,VS3UCBP(,@07)                                   0995
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL IDCVS03 TO SELECT DATA SETS. SAVE THE RETURN     @Z40LB26*/
*   /* CODE.                                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0996
*   CALL IDCSACL0(GDTTBL,'IDCVS03 ',SELECTDS,VS3AGL);/*      @Z40LB26*/
@RC00993 DS    0H                                                  0996
@RC00991 L     @07,@PC00001                                        0996
         ST    @07,@AL00001                                        0996
         LA    @02,@CC01624                                        0996
         ST    @02,@AL00001+4                                      0996
         LA    @02,SELECTDS                                        0996
         ST    @02,@AL00001+8                                      0996
         LA    @02,AREAVS3                                         0996
         ST    @02,@AL00001+12                                     0996
         MVI   @AL00001+12,X'80'                                   0996
         L     @15,GDTCAL(,@07)                                    0996
         LA    @01,@AL00001                                        0996
         BALR  @14,@15                                             0996
*   RESPECIFY                                                      0997
*     RTNREG RSTD;                                                 0997
*   TESTRC=RTNREG;                                                 0998
         LR    TESTRC,RTNREG                                       0998
*   RESPECIFY                                                      0999
*     RTNREG UNRSTD;                /*                       @Z40LB26*/
*                                                                  0999
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SOME ERRORS OCCURRED IN IDCVS03, SET THE INTERNAL  @Z40LB26*/
*   /* CONDITION CODE APPROPRIATELY.                         @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1000
*   IF TESTRC^=0 THEN               /*                       @Z40LB26*/
         LTR   TESTRC,TESTRC                                       1000
         BZ    @RF01000                                            1000
*     DO;                           /*                       @Z40LB26*/
*       IF TESTRC=LASTCC12 THEN     /* VTOC CLOSE ERROR      @Z40LB26*/
         C     TESTRC,@CF00035                                     1002
         BNE   @RF01002                                            1002
*         CC03=LASTCC04;            /*                       @Z40LB26*/
         LA    CC03,4                                              1003
*       ELSE                        /*                       @Z40LB26*/
*         IF TESTRC=LASTCC08 THEN   /*                       @Z40LB26*/
         B     @RC01002                                            1004
@RF01002 LA    @02,8                                               1004
         CR    TESTRC,@02                                          1004
         BNE   @RF01004                                            1004
*           CC03=LASTCC08;          /*                       @Z40LB26*/
         LR    CC03,@02                                            1005
*         ELSE                      /* RETURN OF 4, MAJOR    @Z40LB26
*                                      ERROR                 @Z40LB26*/
*           DO;                     /*                       @Z40LB26*/
         B     @RC01004                                            1006
@RF01004 DS    0H                                                  1007
*             CC03=LASTCC12;        /*                       @Z40LB26*/
*                                                                  1007
         LA    CC03,12                                             1007
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE SECONDARY MESSAGE, UNABLE TO          @Z40LB26*/
*             /* PROCESS VOLUME.                             @Z40LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1008
*             DARGAREA=''B;         /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1008
*             DARGSMOD=CM0MSG;      /*                       @Z40LB26*/
         L     @07,DDSTRU                                          1009
         MVC   DARGSMOD(3,@07),@CC01475                            1009
*             DARGSENT=MSG2108I;    /*                       @Z40LB26*/
         MVI   DARGSENT(@07),X'40'                                 1010
*             DARGDBP=ADDR(BASSERNO);/*                      @Z40LB26*/
         LA    @15,BASSERNO(,BASEVPTR)                             1011
         ST    @15,DARGDBP(,@07)                                   1011
*             DARGILP=LENGTH(BASSERNO);/*                    @Z40LB26*/
         MVC   DARGILP(2,@07),@CH00159                             1012
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB26*/
*                                                                  1013
         L     @07,@PC00001                                        1013
         ST    @07,@AL00001                                        1013
         LA    @15,@CF00117                                        1013
         ST    @15,@AL00001+4                                      1013
         LA    @15,DDSTRU                                          1013
         ST    @15,@AL00001+8                                      1013
         MVI   @AL00001+8,X'80'                                    1013
         L     @15,GDTPRT(,@07)                                    1013
         LA    @01,@AL00001                                        1013
         BALR  @14,@15                                             1013
*             /*******************************************************/
*             /*                                                     */
*             /* FREE SECOND PCT BEFORE ISSUING NEXT UESTA   @ZM01118*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1014
*             CALL AMSTP044(GDTTBL,PRINTIT);/*               @ZM01118*/
         L     @07,@PC00001                                        1014
         ST    @07,@AL00001                                        1014
         LA    @15,PRINTIT                                         1014
         ST    @15,@AL00001+4                                      1014
         MVI   @AL00001+4,X'80'                                    1014
         L     @15,GDTRES(,@07)                                    1014
         LA    @01,@AL00001                                        1014
         BALR  @14,@15                                             1014
*           END;                    /*                       @Z40LB26*/
*     END;                          /*                       @Z40LB26*/
*                                                                  1016
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GOOD RETURN CODE FROM IDCVS03, CHECK TO SEE IF ANY @Z40LB26*/
*   /* DATA SETS RETURNED. IF NONE ELIGIBLE, ISSUE MESSAGE.  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1017
*   ELSE                            /*                       @Z40LB26*/
*     IF VSDELEM=0 THEN             /*                       @Z40LB26*/
         B     @RC01000                                            1017
@RF01000 L     @07,LISTADDR                                        1017
         L     @07,VSDELEM(,@07)                                   1017
         LTR   @07,@07                                             1017
         BNZ   @RF01017                                            1017
*       DO;                         /*                       @Z40LB26*/
*         DARGAREA=''B;             /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1019
*         DARGSMOD=CM0MSG;          /*                       @Z40LB26*/
         L     @07,DDSTRU                                          1020
         MVC   DARGSMOD(3,@07),@CC01475                            1020
*         DARGSENT=MSG0107I;        /*                       @Z40LB26*/
         MVI   DARGSENT(@07),X'3F'                                 1021
*         DARGDBP=ADDR(BASSERNO);   /*                       @Z40LB26*/
         LA    @15,BASSERNO(,BASEVPTR)                             1022
         ST    @15,DARGDBP(,@07)                                   1022
*         DARGILP=LENGTH(BASSERNO); /*                       @Z40LB26*/
         MVC   DARGILP(2,@07),@CH00159                             1023
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB26*/
         L     @07,@PC00001                                        1024
         ST    @07,@AL00001                                        1024
         LA    @15,@CF00117                                        1024
         ST    @15,@AL00001+4                                      1024
         LA    @15,DDSTRU                                          1024
         ST    @15,@AL00001+8                                      1024
         MVI   @AL00001+8,X'80'                                    1024
         L     @15,GDTPRT(,@07)                                    1024
         LA    @01,@AL00001                                        1024
         BALR  @14,@15                                             1024
*       END;                        /*                       @Z40LB26*/
*                                                                  1025
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE IS A DATA SET LIST, SORT IT.                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1026
*   IF CC03<LASTCC12&VSDELEM^=0 THEN/*                       @Z40LB26*/
@RF01017 DS    0H                                                  1026
@RC01000 C     CC03,@CF00035                                       1026
         BNL   @RF01026                                            1026
         L     @07,LISTADDR                                        1026
         L     @15,VSDELEM(,@07)                                   1026
         LTR   @15,@15                                             1026
         BZ    @RF01026                                            1026
*     DO;                           /*                       @Z40LB26*/
*                                                                  1027
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARAMETER LIST FOR SORT                    @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1028
*       SRTAGL=''B;                 /*                       @Z40LB26*/
         LA    @14,SORTAREA                                        1028
         XC    SRTAGL(32,@14),SRTAGL(@14)                          1028
*       SRTADDR=ADDR(VSDARRAY(1));  /*                       @Z40LB26*/
         LA    @03,VSDARRAY(,@07)                                  1029
         ST    @03,SRTADDR(,@14)                                   1029
*       SRTNUM=VSDELEM;             /*                       @Z40LB26*/
         ST    @15,SRTNUM(,@14)                                    1030
*       SRTPOSIT=ADDR(VSDDSN(1))-ADDR(VSDARRAY(1))+1;/*      @Z40LB26*/
         LA    @07,VSDDSN(,@07)                                    1031
         SLR   @07,@03                                             1031
         AL    @07,@CF00222                                        1031
         ST    @07,SRTPOSIT(,@14)                                  1031
*       SRTFLDLN=LENGTH(VSDDSN(1)); /*                       @Z40LB26*/
         MVC   SRTFLDLN(4,@14),@CF00849                            1032
*       SRTWORKP=ADDR(SORTWORK);    /*                       @Z40LB26*/
         LA    @07,SORTWORK                                        1033
         ST    @07,SRTWORKP(,@14)                                  1033
*       SRTLEN=LENGTH(VSDARRAY(1)); /*                       @Z40LB26*/
         MVC   SRTLEN(4,@14),@CF01764                              1034
*       CALL SORT(SRTAGL);          /*                       @Z40LB26*/
         ST    @14,@AL00001                                        1035
         LA    @01,@AL00001                                        1035
         BAL   @14,SORT                                            1035
*     END;                          /*                       @Z40LB26*/
*                                                                  1037
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1037
*   RETURN CODE(CC03);              /*                       @Z40LB26*/
@RF01026 LR    @15,CC03                                            1037
@EL00009 DS    0H                                                  1037
@EF00009 DS    0H                                                  1037
@ER00009 L     @14,@SA00009                                        1037
         BR    @14                                                 1037
*   END SELECTOR;                   /*                       @Z40LB26*/
*                                                                  1039
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - SORT  (ACCESS METHOD SERVICES)          @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* FUNCTION - THIS COMMON INCLUDED PROCEDURE PROVIDES THE   @Z40LB37*/
*/*            CALLER WITH THE BASIC FUNCTION OF SORTING     @Z40LB37*/
*/*            A CONTIGUOUS AREA OF STORAGE OF ANY LENGTH,   @Z40LB37*/
*/*            OR ELEMENT (RECORD) SIZE.   IT ALLOWS         @Z40LB37*/
*/*            CHARACTER FIELDS TO BE SORTED PER USER CALL,  @Z40LB37*/
*/*            ANYWHERE WITHIN AN ELEMENT (RECORD) FOR ANY   @Z40LB37*/
*/*            LENGTH EQUAL TO OR SMALLER THAN AN ELEMENTS   @Z40LB37*/
*/*            SIZE.  THE ELEMENT SIZE CANNOT CHANGE BETWEEN @Z40LB37*/
*/*            CALLS TO THE SORT PROCEDURE.  (THIS IS A      @Z40LB37*/
*/*            COMPILE TIME VARIABLE.)                       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* ENTRY POINT - SORT                                       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*      LINKAGE - 'CALL SORT (SRTAGL)'                      @Z40LB37*/
*/*                '%SRTLABEL = 'WORK AREA''                 @Z40LB37*/
*/*                '%INCLUDE SYSLIB(IDCDF54)'                @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* INPUT  - ADDRESS OF ARGUMENT LIST (SRTAGL)               @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* OUTPUT - A RETURN CODE IN REGISTER 15                    @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          (0) - SORT SUCCESSFUL                           @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* EXIT NORMAL - RETURNS TO CALLER WITH CONDITION           @Z40LB37*/
*/*               CODE ZERO                                  @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* EXIT ERROR  - NONE                                       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* CHANGE ACTIVITY - NONE                                   @Z40LB37*/
*/*                                                                  */
*/********************************************************************/
*                                                                  1039
*SORT:                              /* AMS SORT ROUTINE      @Z40LB37*/
*   PROCEDURE(SRTARG);              /* SORT ARGUMENT LIST    @Z40LB37*/
SORT     STM   @14,@12,@SA00010                                    1039
         MVC   @PC00010(4),0(@01)                                  1039
*                                                                  1040
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR THE SORT ROUTINE.                    @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1040
*   DCL                                                            1040
*     1 SRTSTOR(*) BASED(SRTPTR),   /* INPUT STORAGE DCL     @Z40LB37*/
*      2 SRTELEM CHAR(LENGTH(SORTWORK));/* FOR MOVING ONE ELEMENT  1040
*                                                            @Z40LB37*/
*   DCL                                                            1041
*     SRTSAVE CHAR(LENGTH(SORTWORK))/* PASSED ELEMENT        @Z40LB37*/
*         BASED(SRTWPTR);           /* SAVE AREA             @Z40LB37*/
*   DCL                                                            1042
*    (SRTPTR,                                                      1042
*     SRTWPTR) PTR(31);             /* SORT AREA PTRS        @Z40LB37*/
*   DCL                                                            1043
*     SRTLN FIXED(31);              /* SORT ELEMENT LENGTH   @Z40LB37*/
*   DCL                                                            1044
*    (SRTBEG,                                                      1044
*     SRTEND) FIXED(31);            /* SORT FIELD DCLS       @Z40LB37*/
*   DCL                                                            1045
*    (SRTSTOP,                                                     1045
*     SRTMOVE) BIT(1);              /* SORT SWITCHES         @Z40LB37*/
*   DCL                                                            1046
*     SRTON BIT(1) CONSTANT('1'B);  /* SWITCH ON CONSTANT    @Z40LB37*/
*   DCL                                                            1047
*     SRTOFF BIT(1) CONSTANT('0'B); /* SWITCH OFF CONSTANT   @Z40LB37*/
*   DCL                                                            1048
*    (SRTMAXCT,                                                    1048
*     SRTI,                                                        1048
*     SRTJ) FIXED(31);              /* SORT COUNTER DCLS     @Z40LB37*/
*   DCL                                                            1049
*     SRTRC FIXED(15) CONSTANT(0);  /* SORT RETURN CODE AREA @Z40LB37*/
*                                                                  1050
*   /*****************************************************************/
*   /*                                                               */
*   /* RESPECIFY SRTAGL ON PASSED ADDRESS, ISSUE UTRACE      @Z40LB37*/
*   /* AND UDUMP MACROS, AND INITIALIZE LOCAL COUNTERS AND   @Z40LB37*/
*   /* LENGTH FIELDS.                                        @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1050
*   RFY                                                            1050
*     SRTAGL BASED(ADDR(SRTARG));   /*                       @Z40LB37*/
*   OLDERID2=NEWERID2;                                             1051
         L     @15,@PC00001                                        1051
         L     @14,GDTTR2(,@15)                                    1051
         MVC   @TS00001(95),NEWERID2(@14)                          1051
         MVC   OLDERID2(95,@14),@TS00001                           1051
*   NEWID2='SORT';                  /*                       @Z40LB37*/
         MVC   NEWID2(4,@14),@CC01649                              1052
*   IF GDTDBG=NULLPTR THEN                                         1053
         L     @15,GDTDBG(,@15)                                    1053
         LTR   @15,@15                                             1053
         BZ    @RT01053                                            1053
*     ;                                                            1054
*   ELSE                                                           1055
*     CALL IDCDB010(GDTTBL,'SOTI'); /*                       @Z40LB37*/
         L     @15,@PC00001                                        1055
         ST    @15,@AL00001                                        1055
         LA    @14,@CC01650                                        1055
         ST    @14,@AL00001+4                                      1055
         MVI   @AL00001+4,X'80'                                    1055
         L     @15,GDTDBG(,@15)                                    1055
         LA    @01,@AL00001                                        1055
         BALR  @14,@15                                             1055
*   SRTHEAD='SRTAGL  ';             /*                       @Z40LB37*/
@RT01053 L     @05,@PC00010                                        1056
         MVC   SRTHEAD(8,@05),@CC01651                             1056
*   SRTWPTR=SRTWORKP;               /*                       @Z40LB37*/
         L     SRTWPTR,SRTWORKP(,@05)                              1057
*   SRTPTR=SRTADDR;                 /*                       @Z40LB37*/
         L     SRTPTR,SRTADDR(,@05)                                1058
*   SRTLN=SRTLEN;                   /*                       @Z40LB37*/
         L     SRTLN,SRTLEN(,@05)                                  1059
*   SRTMAXCT=SRTNUM;                /*                       @Z40LB37*/
         L     @02,SRTNUM(,@05)                                    1060
         ST    @02,SRTMAXCT                                        1060
*   SRTBEG=SRTPOSIT;                /*                       @Z40LB37*/
         L     @02,SRTPOSIT(,@05)                                  1061
         LR    SRTBEG,@02                                          1061
*   SRTEND=SRTPOSIT+(SRTFLDLN-1);   /*                       @Z40LB37*/
         L     SRTEND,SRTFLDLN(,@05)                               1062
         BCTR  SRTEND,0                                            1062
         ALR   @02,SRTEND                                          1062
         LR    SRTEND,@02                                          1062
*   SRTSTOP=SRTOFF;                 /*                       @Z40LB37*/
         NI    SRTSTOP,B'01111111'                                 1063
*   SRTMOVE=SRTOFF;                 /*                       @Z40LB37*/
         NI    SRTMOVE,B'01111111'                                 1064
*                                                                  1065
*   /*****************************************************************/
*   /*                                                               */
*   /* EXECUTE THE SORT LOOP USING THE MAXIMUM ELEMENTS      @Z40LB37*/
*   /* MINUS ONE FOR THE SRTI COUNTER AND DECREMENTING THE   @Z40LB37*/
*   /* THE SRTI COUNTER BY ONE EACH PASS. THE SRTJ COUNTER   @Z40LB37*/
*   /* IS USED TO COUNT THE ELEMENTS THRU EACH PASS AND IN-  @Z40LB37*/
*   /* CREMENT THE SRTJ COUNTER BY ONE AFTER EACH ELEMENT    @Z40LB37*/
*   /* IS COMPARED. THE SRTSTOP SWITCH IS USED TO TERM-      @Z40LB37*/
*   /* INATE THE SORT IF NO INTERCHANGE OF ELEMENTS TAKES    @Z40LB37*/
*   /* PLACE.                                                @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1065
*SRTLOOP:                                                          1065
*   DO SRTI=SRTMAXCT-1 TO 1 BY-1 WHILE SRTSTOP=SRTOFF;/*     @Z40LB37*/
SRTLOOP  L     SRTI,SRTMAXCT                                       1065
         BCTR  SRTI,0                                              1065
         B     @DE01065                                            1065
@DL01065 TM    SRTSTOP,B'10000000'                                 1065
         BNZ   @DC01065                                            1065
*     DO SRTJ=1 TO SRTI;            /*                       @Z40LB37*/
*                                                                  1066
         LA    SRTJ,1                                              1066
         B     @DE01066                                            1066
@DL01066 DS    0H                                                  1067
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE THE TWO ELEMENTS TO SEE IF AN INTER-      @Z40LB37*/
*       /* CHANGE SHOULD TAKE PLACE, USING THE PASSED SORT   @Z40LB37*/
*       /* FIELDS AS A SUBSTRING, IF SO INTERCHANGE THEM.    @Z40LB37*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1067
*       IF SRTELEM(SRTJ,SRTBEG:SRTEND)>SRTELEM(SRTJ+1,SRTBEG:SRTEND)
*         THEN                                                     1067
         LR    @15,SRTJ                                            1067
         MH    @15,@CH01764                                        1067
         LR    @14,SRTBEG                                          1067
         ALR   @14,@15                                             1067
         LR    @01,SRTEND                                          1067
         SLR   @01,SRTBEG                                          1067
         ST    @14,@TF00001                                        1067
         ALR   @14,SRTPTR                                          1067
         AL    @14,@CF01787                                        1067
         ST    @15,@TF00002                                        1067
         LR    @15,SRTPTR                                          1067
         AL    @15,@TF00001                                        1067
         AL    @15,@CF01653                                        1067
         EX    @01,@SC01788                                        1067
         BNH   @RF01067                                            1067
*         DO;                       /*                       @Z40LB37*/
*           SRTMOVE=SRTON;          /*                       @Z40LB37*/
         OI    SRTMOVE,B'10000000'                                 1069
*           SRTSAVE=SRTELEM(SRTJ);  /*                       @Z40LB37*/
         LR    @01,SRTPTR                                          1070
         AL    @01,@TF00002                                        1070
         AL    @01,@CF01790                                        1070
         MVC   SRTSAVE(80,SRTWPTR),SRTELEM(@01)                    1070
*           SRTELEM(SRTJ)=SRTELEM(SRTJ+1);/*                 @Z40LB37*/
         LR    @01,SRTPTR                                          1071
         AL    @01,@TF00002                                        1071
         AL    @01,@CF01790                                        1071
         LR    @15,SRTPTR                                          1071
         AL    @15,@TF00002                                        1071
         MVC   SRTELEM(80,@01),SRTELEM(@15)                        1071
*           SRTELEM(SRTJ+1)=SRTSAVE;/*                       @Z40LB37*/
         LR    @01,SRTPTR                                          1072
         AL    @01,@TF00002                                        1072
         MVC   SRTELEM(80,@01),SRTSAVE(SRTWPTR)                    1072
*         END;                      /*                       @Z40LB37*/
*     END;                          /*                       @Z40LB37*/
*                                                                  1074
@RF01067 AL    SRTJ,@CF00222                                       1074
@DE01066 CR    SRTJ,SRTI                                           1074
         BNH   @DL01066                                            1074
*     /***************************************************************/
*     /*                                                             */
*     /* IF AN ELEMENT WAS INTERCHANGED THEN TURN SRTMOVE    @Z40LB37*/
*     /* SWITCH OFF. IF NO INTERCHANGE WAS MADE TURN SORT    @Z40LB37*/
*     /* STOP SWITCH TO ON.                                  @Z40LB37*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1075
*     IF SRTMOVE=SRTON THEN                                        1075
         TM    SRTMOVE,B'10000000'                                 1075
         BNO   @RF01075                                            1075
*       SRTMOVE=SRTOFF;             /*                       @Z40LB37*/
         NI    SRTMOVE,B'01111111'                                 1076
*     ELSE                                                         1077
*       SRTSTOP=SRTON;              /*                       @Z40LB37*/
         B     @RC01075                                            1077
@RF01075 OI    SRTSTOP,B'10000000'                                 1077
*   END SRTLOOP;                    /* END OF SRTLOOP TO SORT INTO AN
*                                      ASCENDING SEQUENCE    @Z40LB37*/
@RC01075 BCTR  SRTI,0                                              1078
@DE01065 LTR   SRTI,SRTI                                           1078
         BP    @DL01065                                            1078
@DC01065 DS    0H                                                  1079
*   IF GDTDBG=NULLPTR THEN                                         1079
         L     @15,@PC00001                                        1079
         L     @15,GDTDBG(,@15)                                    1079
         LTR   @15,@15                                             1079
         BZ    @RT01079                                            1079
*     ;                                                            1080
*   ELSE                                                           1081
*     CALL IDCDB010(GDTTBL,'SOTO'); /* UDUMP EXIT            @Z40LB37*/
         L     @15,@PC00001                                        1081
         ST    @15,@AL00001                                        1081
         LA    @14,@CC01655                                        1081
         ST    @14,@AL00001+4                                      1081
         MVI   @AL00001+4,X'80'                                    1081
         L     @15,GDTDBG(,@15)                                    1081
         LA    @01,@AL00001                                        1081
         BALR  @14,@15                                             1081
*   RETURN CODE(SRTRC);             /* RETURN TO MAIN ROUTINE      1082
*                                                            @Z40LB37*/
@RT01079 SLR   @15,@15                                             1082
         L     @14,@SA00010                                        1082
         LM    @00,@12,@SA00010+8                                  1082
         BR    @14                                                 1082
*   END SORT;                       /* END OF AMS SORT ROUTINE - SORT
*                                                            @Z40LB37*/
*                                                                  1084
*/********************************************************** @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - PROCVOL                                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN AN ELIGIBLE BASE       @Z40LB26*/
*/*             VOLUME RECORD HAS BEEN READ FROM THE MSVI.   @Z40LB26*/
*/*             IT CALLS ROUTINES TO ALLOCATE A UNIT AND TO  @Z40LB26*/
*/*             SELECT ELIGIBLE DATA SETS TO BE LISTED.  IT  @Z40LB26*/
*/*             THEN CALLS ROUTINES TO PRINT THE REPORT AND  @Z40LB26*/
*/*             SUMMARY INFORMATION.  ROUTINE CALLS          @Z40LB26*/
*/*             ALLOCATE, SELECTOR, GRPHDR, VOLHDR, STATRPT, @Z40LB26*/
*/*             USAGERPT.                                    @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - BASE VOLUME RECORD, FUNCTIONAL DATA TABLE,       @Z40LB26*/
*/*         VS3AGL.                                          @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, ENTIRE VOLUME PROCESSED        @Z40LB26*/
*/*                           SUCCESSFULLY                   @Z40LB26*/
*/*                        4, VOLUME DEALLOCATION OR VTOC    @Z40LB26*/
*/*                           CLOSE FAILURE                  @Z40LB26*/
*/*                        8, ONE OR MORE DATA SETS COULD    @Z40LB26*/
*/*                           NOT BE PROCESSED               @Z40LB26*/
*/*                       12, VOLUME COULD NOT BE PROCESSED  @Z40LB26*/
*/*                           DUE TO ERRORS                  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/********************************************************** @Z40LB26*/
*                                                                  1084
*PROCVOL:                                                          1084
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
PROCVOL  ST    @14,@SA00011                                        1084
*                                                                  1085
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT AT START OF PROCEDURE              @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1085
*   OLDERID2=NEWERID2;                                             1085
         L     @06,@PC00001                                        1085
         L     @06,GDTTR2(,@06)                                    1085
         MVC   @TS00001(95),NEWERID2(@06)                          1085
         MVC   OLDERID2(95,@06),@TS00001                           1085
*   NEWID2='LDPV';                  /*                       @Z40LB26*/
*                                                                  1086
         MVC   NEWID2(4,@06),@CC01659                              1086
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO 0               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1087
*   CC02=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1087
         SLR   CC02,CC02                                           1087
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ALLOCATE PROCEDURE TO GET A UNIT TO MOUNT        @Z40LB26*/
*   /* VOLUME ON OR UNIT VOLUME IS MOUNTED ON.               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1088
*   CALL ALLOCATE;                  /*                       @Z40LB26*/
         BAL   @14,ALLOCATE                                        1088
*   RESPECIFY                                                      1089
*     RTNREG RSTD;                                                 1089
*   TESTRC=RTNREG;                                                 1090
         LR    TESTRC,RTNREG                                       1090
*   RESPECIFY                                                      1091
*     RTNREG UNRSTD;                /*                       @Z40LB26*/
*   CC02=TESTRC;                    /*                       @Z40LB26*/
*                                                                  1092
         LR    CC02,TESTRC                                         1092
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALLOCATE WAS SUCCESSFUL, CONTINUE                  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1093
*   IF CC02=LASTCC00 THEN           /*                       @Z40LB26*/
         SLR   @06,@06                                             1093
         CR    CC02,@06                                            1093
         BNE   @RF01093                                            1093
*     DO;                           /*                       @Z40LB26*/
*                                                                  1094
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NOT PROCESSING BY GROUPS                 @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1095
*       IF ADDR(AGRP)=NULLPTR&ADDR(GRP)=NULLPTR/*            @Z40LB26*/
*         THEN                      /*                       @Z40LB26*/
*                                                                  1095
         L     @07,@PC00001+4                                      1095
         C     @06,FDTPTR+12(,@07)                                 1095
         BNE   @RF01095                                            1095
         C     @06,FDTPTR+4(,@07)                                  1095
         BNE   @RF01095                                            1095
*         /***********************************************************/
*         /*                                                         */
*         /* CALL ROUTINE TO PUT OUT VOLUME HEADER           @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1096
*         CALL VOLHDR;              /*                       @Z40LB26*/
*                                                                  1096
         BAL   @14,VOLHDR                                          1096
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO PUT OUT GROUP HEADER              @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1097
*       ELSE                        /*                       @Z40LB26*/
*         CALL GRPHDR;              /*                       @Z40LB26*/
*                                                                  1097
         B     @RC01095                                            1097
@RF01095 BAL   @14,GRPHDR                                          1097
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SELECTOR TO SELECT ELIGIBLE DATA SETS        @Z40LB26*/
*       /* SAVE RETURN CODE.                                 @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1098
*       CALL SELECTOR;              /*                       @Z40LB26*/
@RC01095 BAL   @14,SELECTOR                                        1098
*       RESPECIFY                                                  1099
*         RTNREG RSTD;                                             1099
*       TESTRC=RTNREG;                                             1100
         LR    TESTRC,RTNREG                                       1100
*       RESPECIFY                                                  1101
*         RTNREG UNRSTD;            /*                       @Z40LB26*/
*       CC02=TESTRC;                /*                       @Z40LB26*/
*                                                                  1102
         LR    CC02,TESTRC                                         1102
*       /*************************************************************/
*       /*                                                           */
*       /* TEST RETURN CODE TO SEE IF LIST OF DATA SETS      @Z40LB26*/
*       /* RETURNED.                                         @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1103
*       IF CC02<LASTCC12 THEN       /*                       @Z40LB26*/
         C     CC02,@CF00035                                       1103
         BNL   @RF01103                                            1103
*         DO;                       /*                       @Z40LB26*/
*                                                                  1104
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK TO SEE IF DOING USAGE OR STATUS REPORT  @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1105
*           IF ADDR(USAGE)^=NULLPTR THEN/*                   @Z40LB26*/
*                                                                  1105
         L     @06,@PC00001+4                                      1105
         L     @06,FDTPTR+56(,@06)                                 1105
         LTR   @06,@06                                             1105
         BZ    @RF01105                                            1105
*             /*******************************************************/
*             /*                                                     */
*             /* CALL ROUTINE TO PRINT USAGE REPORT          @Z40LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1106
*             CALL USAGERPT;        /*                       @Z40LB26*/
         BAL   @14,USAGERPT                                        1106
*           IF ADDR(STAT)^=NULLPTR THEN/*                    @Z40LB26*/
*                                                                  1107
@RF01105 L     @06,@PC00001+4                                      1107
         L     @06,FDTPTR+52(,@06)                                 1107
         LTR   @06,@06                                             1107
         BZ    @RF01107                                            1107
*             /*******************************************************/
*             /*                                                     */
*             /* CALL ROUTINE TO PRINT STATUS REPORT         @Z40LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1108
*             CALL STATRPT;         /*                       @Z40LB26*/
         BAL   @14,STATRPT                                         1108
*         END;                      /*                       @Z40LB26*/
*                                                                  1109
@RF01107 DS    0H                                                  1110
*       /*************************************************************/
*       /*                                                           */
*       /* IF SELECTOR CAUSED STORAGE TO BE OBTAINED, ISSUE  @Z40LB26*/
*       /* UFPOOL MACRO TO FREE IT.                          @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1110
*       IF LISTADDR^=NULLPTR THEN   /*                       @Z40LB26*/
@RF01103 L     @06,LISTADDR                                        1110
         LTR   @06,@06                                             1110
         BZ    @RF01110                                            1110
*         CALL IDCSAFP0(GDTTBL,POOLID);/*                    @Z40LB26*/
*                                                                  1111
         L     @06,@PC00001                                        1111
         ST    @06,@AL00001                                        1111
         LA    @15,@CC01511                                        1111
         ST    @15,@AL00001+4                                      1111
         MVI   @AL00001+4,X'80'                                    1111
         L     @15,GDTFPL(,@06)                                    1111
         LA    @01,@AL00001                                        1111
         BALR  @14,@15                                             1111
*       /*************************************************************/
*       /*                                                           */
*       /* IF ALLOCATE ROUTINE USED DYNAMIC ALLOCATION,      @Z40LB26*/
*       /* ISSUE UDEALLOC MACRO TO DEALLOCATE IT. SAVE       @Z40LB26*/
*       /* THE RETURN CODE.                                  @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1112
*       IF ALOCFLG=ON THEN          /*                       @Z40LB26*/
@RF01110 TM    ALOCFLG,B'10000000'                                 1112
         BNO   @RF01112                                            1112
*         DO;                       /*                       @Z40LB26*/
*           CALL IDCSADL0(GDTTBL,ALLAGL);/*                  @Z40LB26*/
         L     @06,@PC00001                                        1114
         ST    @06,@AL00001                                        1114
         LA    @02,ALOCAREA                                        1114
         ST    @02,@AL00001+4                                      1114
         MVI   @AL00001+4,X'80'                                    1114
         L     @15,GDTDLC(,@06)                                    1114
         LA    @01,@AL00001                                        1114
         BALR  @14,@15                                             1114
*           RESPECIFY                                              1115
*             RTNREG RSTD;                                         1115
*           TESTRC=RTNREG;                                         1116
         LR    TESTRC,RTNREG                                       1116
*           RESPECIFY                                              1117
*             RTNREG UNRSTD;        /*                       @Z40LB26*/
*                                                                  1117
*           /*********************************************************/
*           /*                                                       */
*           /* IF UDEALLOC FAILED, SET THE INTERNAL CONDI-   @Z40LB26*/
*           /* TION CODE.                                    @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1118
*           IF TESTRC^=0 THEN       /*                       @Z40LB26*/
         LTR   TESTRC,TESTRC                                       1118
         BZ    @RF01118                                            1118
*             CC02=MAX(LASTCC04,CC02);/*                     @Z40LB26*/
         LA    @06,4                                               1119
         CR    CC02,@06                                            1119
         BNL   *+6
         LR    CC02,@06                                            1119
*         END;                      /*                       @Z40LB26*/
@RF01118 DS    0H                                                  1121
*     END;                          /*                       @Z40LB26*/
@RF01112 DS    0H                                                  1122
*                                                                  1122
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1122
*   RETURN CODE(CC02);              /*                       @Z40LB26*/
@RF01093 LR    @15,CC02                                            1122
@EL00011 DS    0H                                                  1122
@EF00011 DS    0H                                                  1122
@ER00011 L     @14,@SA00011                                        1122
         BR    @14                                                 1122
*   END PROCVOL;                    /*                       @Z40LB26*/
*                                                                  1124
*/********************************************************** @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - ALLOCATE                                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION - DETERMINE THE DD TO USE TO MOUNT THE VOLUME   @Z40LB26*/
*/*            ON.  CHECK THE DD TO DETERMINE IF THE UNIT IS @Z40LB26*/
*/*            VIRTUAL.  DYNAMICALLY ALLOCATE THE VOLUME IF  @Z40LB26*/
*/*            NECESSARY.  ISSUE MESSAGE IDC2108I IF THE     @Z40LB26*/
*/*            VOLUME CAN NOT BE PROCESSED.                  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - INVENTORY BASE RECORD                            @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB26*/
*/*                       12, EITHER THE UNIT ALLOCATED TO   @Z40LB26*/
*/*                           THE VOLUME IS NOT VIRTUAL OR   @Z40LB26*/
*/*                           DYNAMIC ALLOCATION FAILED      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*         ALOCFLAG SET ON IF VOLUME WAS DYNAMICALLY        @Z40LB26*/
*/*          ALLOCATED, OTHERWISE, SET OFF.                  @Z40LB26*/
*/*          DDNAME FIELD SET WITH DD NAME IF RETURN CODE    @Z40LB26*/
*/*          IS 0.                                           @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*         ADDRUCB SET WITH 0 OR SET TO ADDRESS OF THE      @Z40LB26*/
*/*         UCB SELECTED FOR USE                             @Z40LB26*/
*/*                                                          @Z40LB26*/
*/********************************************************** @Z40LB26*/
*                                                                  1124
*ALLOCATE:                                                         1124
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB26*/
ALLOCATE ST    @14,@SA00012                                        1124
*                                                                  1125
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1125
*   OLDERID2=NEWERID2;                                             1125
         L     @07,@PC00001                                        1125
         L     @02,GDTTR2(,@07)                                    1125
         MVC   @TS00001(95),NEWERID2(@02)                          1125
         MVC   OLDERID2(95,@02),@TS00001                           1125
*   NEWID2='LDAL';                  /*                       @Z40LB26*/
*                                                                  1126
         MVC   NEWID2(4,@02),@CC01668                              1126
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1127
*   CC03=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1127
         SLR   @02,@02                                             1127
         LR    CC03,@02                                            1127
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FLAG TO INDICATE NO DYNAMIC ALLOCATION            @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1128
*   ALOCFLG=OFF;                    /*                       @Z40LB26*/
*                                                                  1128
         NI    ALOCFLG,B'01111111'                                 1128
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT MACRO TO DETERMINE IF THE VOLUME IS    @Z40LB26*/
*   /* MOUNTED. SAVE THE RETURN CODE.                        @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1129
*   RESPECIFY                                                      1129
*     SELAGL BASED(ADDR(SLTAREA));  /*                       @Z40LB26*/
*   SELAGL=''B;                     /* SET TO ZERO           @Z40LB26*/
         LA    @15,SLTAREA                                         1130
         XC    SELAGL(23,@15),SELAGL(@15)                          1130
*   SELUCBP=ADDR(ADDRUCB);          /* UCB TO BE RETURNED    @Z40LB26*/
         LA    @14,ADDRUCB                                         1131
         ST    @14,SELUCBP(,@15)                                   1131
*   ADDRUCB=NULLPTR;                /*                       @Z40LB26*/
         ST    @02,ADDRUCB                                         1132
*   SELDDNP=ADDR(DDNAME);           /* DD TO BE RETURNED     @Z40LB26*/
         LA    @02,DDNAME                                          1133
         ST    @02,SELDDNP(,@15)                                   1133
*   SELVOL=BASSERNO;                /* VOLUME SERIAL         @Z40LB26*/
         MVC   SELVOL(6,@15),BASSERNO(BASEVPTR)                    1134
*   CALL IDCSA060(GDTTBL,SELECTDD,SELAGL);/*                 @Z40LB26*/
         ST    @07,@AL00001                                        1135
         LA    @02,SELECTDD                                        1135
         ST    @02,@AL00001+4                                      1135
         ST    @15,@AL00001+8                                      1135
         MVI   @AL00001+8,X'80'                                    1135
         L     @15,GDTUNT(,@07)                                    1135
         LA    @01,@AL00001                                        1135
         BALR  @14,@15                                             1135
*   RESPECIFY                                                      1136
*     RTNREG RSTD;                                                 1136
*   TESTRC=RTNREG;                                                 1137
         LR    TESTRC,RTNREG                                       1137
*   RESPECIFY                                                      1138
*     RTNREG UNRSTD;                /*                       @Z40LB26*/
*                                                                  1138
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A DD WAS FOUND BY UMSSUNIT, ISSUE UMSSUNIT MACRO   @Z40LB26*/
*   /* TO CHECK THAT THE UNIT IS VIRTUAL. SAVE THE RETURN    @Z40LB26*/
*   /* CODE.                                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1139
*   IF TESTRC=0 THEN                /*                       @Z40LB26*/
         LTR   TESTRC,TESTRC                                       1139
         BNZ   @RF01139                                            1139
*     DO;                           /*                       @Z40LB26*/
*       RESPECIFY                                                  1141
*         CKAGL BASED(ADDR(CHKAREA));/*                      @Z40LB26*/
*       CKAGL=''B;                  /*                       @Z40LB26*/
         LA    @07,CHKAREA                                         1142
         XC    CKAGL(29,@07),CKAGL(@07)                            1142
*       CKUCBPTR=ADDR(ADDRUCB);     /*                       @Z40LB26*/
         LA    @02,ADDRUCB                                         1143
         ST    @02,CKUCBPTR(,@07)                                  1143
*       CKDDNAME=DDNAME;            /*                       @Z40LB26*/
         MVC   CKDDNAME(8,@07),DDNAME                              1144
*       CKTESTVT=ON;                /*                       @Z40LB26*/
         OI    CKTESTVT(@07),B'10000000'                           1145
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB26*/
         L     @02,@PC00001                                        1146
         ST    @02,@AL00001                                        1146
         LA    @15,CHECK                                           1146
         ST    @15,@AL00001+4                                      1146
         ST    @07,@AL00001+8                                      1146
         MVI   @AL00001+8,X'80'                                    1146
         L     @15,GDTUNT(,@02)                                    1146
         LA    @01,@AL00001                                        1146
         BALR  @14,@15                                             1146
*       RESPECIFY                                                  1147
*         RTNREG RSTD;                                             1147
*       TESTRC=RTNREG;                                             1148
         LR    TESTRC,RTNREG                                       1148
*       RESPECIFY                                                  1149
*         RTNREG UNRSTD;            /*                       @Z40LB26*/
*                                                                  1149
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR WAS FOUND, SET THE INTERNAL           @Z40LB26*/
*       /* CONDITION CODE.                                   @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1150
*       IF TESTRC^=0 THEN           /*                       @Z40LB26*/
         LTR   TESTRC,TESTRC                                       1150
         BZ    @RF01150                                            1150
*         CC03=LASTCC12;            /*                       @Z40LB26*/
         LA    CC03,12                                             1151
*     END;                          /*                       @Z40LB26*/
*                                                                  1153
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO DD WAS FOUND, CONTINUE                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   ELSE                            /*                       @Z40LB26*/
*     DO;                           /*                       @Z40LB26*/
*                                                                  1153
         B     @RC01139                                            1153
@RF01139 DS    0H                                                  1154
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE FILE PARAMETER WAS SPECIFIED ON THE        @Z40LB26*/
*       /* COMMAND, RETURN IT TO THE CALLER.                 @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1154
*       IF ADDR(FILE)^=NULLPTR THEN /*                       @Z40LB26*/
         L     @07,@PC00001+4                                      1154
         L     @07,FDTPTR+44(,@07)                                 1154
         LTR   @07,@07                                             1154
         BZ    @RF01154                                            1154
*         DDNAME=FILEVAL;           /*                       @Z40LB26*/
*                                                                  1155
         MVC   DDNAME(8),FILEVAL(@07)                              1155
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE FILE PARAMETER WAS NOT SPECIFIED, ISSUE    @Z40LB26*/
*       /* THE UALLOC MACRO TO DYNAMICALLY ALLOCATE A UNIT.  @Z40LB26*/
*       /* SAVE THE RETURN CODE.                             @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1156
*       ELSE                        /*                       @Z40LB26*/
*         DO;                       /*                       @Z40LB26*/
         B     @RC01154                                            1156
@RF01154 DS    0H                                                  1157
*           RESPECIFY                                              1157
*             ALLAGL BASED(ADDR(ALOCAREA));/*                @Z40LB26*/
*           ALLAGL=''B;             /*                       @Z40LB26*/
         LA    @07,ALOCAREA                                        1158
         XC    ALLAGL(31,@07),ALLAGL(@07)                          1158
*           UNITCNT=1;              /*                       @Z40LB26*/
         LA    @02,1                                               1159
         STH   @02,UNITCNT                                         1159
*           UNITLNG=LENGTH(V3330);  /*                       @Z40LB26*/
         MVC   UNITLNG(2),@CH00298                                 1160
*           UNITNAME=V3330;         /* UNIT TYPE             @Z40LB26*/
         MVI   UNITNAME+5,C' '                                     1161
         MVC   UNITNAME+6(2),UNITNAME+5                            1161
         MVC   UNITNAME(5),@CC01513                                1161
*           VOLCOUNT=1;             /*                       @Z40LB26*/
         STH   @02,VOLCOUNT                                        1162
*           VOLLNG=LENGTH(BASSERNO);/*                       @Z40LB26*/
         MVC   VOLLNG(2),@CH00159                                  1163
*           VOLNAME=BASSERNO;       /* VOLUME SERIAL         @Z40LB26*/
         MVC   VOLNAME(6),BASSERNO(BASEVPTR)                       1164
*           ALLULP=ADDR(UNITLIST);  /* UNIT TYPE LIST        @Z40LB26*/
         LA    @02,UNITLIST                                        1165
         ST    @02,ALLULP(,@07)                                    1165
*           ALLVLP=ADDR(VOLLIST);   /* VOLUME SERIAL LIST    @Z40LB26*/
         LA    @02,VOLLIST                                         1166
         ST    @02,ALLVLP(,@07)                                    1166
*           ALLOPTVL=ON;            /* VOLUME ALLOCATION     @Z40LB26*/
*           ALLOPTPV=ON;            /* PRIVATE               @Z40LB26*/
         OI    ALLOPTVL(@07),B'10100000'                           1168
*           ALOCFLG=ON;             /* INDICATES DYNAMIC     @Z40LB26
*                                      ALLOCATION WAS DONE   @Z40LB26*/
         OI    ALOCFLG,B'10000000'                                 1169
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Z40LB26*/
         L     @02,@PC00001                                        1170
         ST    @02,@AL00001                                        1170
         ST    @07,@AL00001+4                                      1170
         MVI   @AL00001+4,X'80'                                    1170
         L     @15,GDTALC(,@02)                                    1170
         LA    @01,@AL00001                                        1170
         BALR  @14,@15                                             1170
*           RESPECIFY                                              1171
*             RTNREG RSTD;                                         1171
*           TESTRC=RTNREG;                                         1172
         LR    TESTRC,RTNREG                                       1172
*           RESPECIFY                                              1173
*             RTNREG UNRSTD;        /*                       @Z40LB26*/
*                                                                  1173
*           /*********************************************************/
*           /*                                                       */
*           /* IF AN ERROR OCCURRED, SET THE CONDITION CODE  @Z40LB26*/
*           /* OTHERWISE, RETURN DDNAME.                     @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1174
*           IF TESTRC^=0 THEN       /*                       @Z40LB26*/
         LTR   TESTRC,TESTRC                                       1174
         BZ    @RF01174                                            1174
*             CC03=LASTCC12;        /*                       @Z40LB26*/
         LA    CC03,12                                             1175
*           ELSE                    /*                       @Z40LB26*/
*             DDNAME=ALLDDN;        /*                       @Z40LB26*/
         B     @RC01174                                            1176
@RF01174 LA    @07,ALOCAREA                                        1176
         MVC   DDNAME(8),ALLDDN(@07)                               1176
*         END;                      /*                       @Z40LB26*/
@RC01174 DS    0H                                                  1178
*     END;                          /*                       @Z40LB26*/
@RC01154 DS    0H                                                  1179
*                                                                  1179
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, ISSUE MESSAGE IDC2108I TO SAY   @Z40LB26*/
*   /* THE VOLUME WAS NOT PROCESSED.                         @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1179
*   IF CC03=LASTCC12 THEN           /*                       @Z40LB26*/
@RC01139 C     CC03,@CF00035                                       1179
         BNE   @RF01179                                            1179
*     DO;                           /*                       @Z40LB26*/
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1181
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/
         L     @07,DDSTRU                                          1182
         MVC   DARGSMOD(3,@07),@CC01475                            1182
*       DARGSENT=MSG2108I;          /*                       @Z40LB26*/
         MVI   DARGSENT(@07),X'40'                                 1183
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/
         LA    @15,BASSERNO(,BASEVPTR)                             1184
         ST    @15,DARGDBP(,@07)                                   1184
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/
         MVC   DARGILP(2,@07),@CH00159                             1185
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/
         L     @07,@PC00001                                        1186
         ST    @07,@AL00001                                        1186
         LA    @15,@CF00117                                        1186
         ST    @15,@AL00001+4                                      1186
         LA    @15,DDSTRU                                          1186
         ST    @15,@AL00001+8                                      1186
         MVI   @AL00001+8,X'80'                                    1186
         L     @15,GDTPRT(,@07)                                    1186
         LA    @01,@AL00001                                        1186
         BALR  @14,@15                                             1186
*     END;                          /*                       @Z40LB26*/
*                                                                  1187
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1188
*   RETURN CODE(CC03);              /*                       @Z40LB26*/
@RF01179 LR    @15,CC03                                            1188
@EL00012 DS    0H                                                  1188
@EF00012 DS    0H                                                  1188
@ER00012 L     @14,@SA00012                                        1188
         BR    @14                                                 1188
*   END ALLOCATE;                   /*                       @Z40LB26*/
*                                                                  1190
*/********************************************************** @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - GRPHDR                                       @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN A NEW VOLUME IS BEING  @Z40LB26*/
*/*             PROCESSED.  IT WILL ESTABLISH A SUB-TITLE    @Z40LB26*/
*/*             LINE FOR BOTH USAGE AND STATUS REPORTS BY    @Z40LB26*/
*/*             GROUP AND WILL INSERT THE CURRENT GROUP      @Z40LB26*/
*/*             NAME AND VOLUME NAME IN THE SUB-TITLE LINE.  @Z40LB26*/
*/*             WHEN A NEW GROUP IS BEING PROCESSED, IT WILL @Z40LB26*/
*/*             PRINT OUT THE GROUP OWNER AND OWNER ADDRESS  @Z40LB26*/
*/*             AS DATA LINES.                               @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - FUNCTION DATA TABLE, GROUP RECORD, BASE VOLUME   @Z40LB26*/
*/*         RECORD, OLD GROUP NAME.                          @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0 SUCCESSFUL                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/********************************************************** @Z40LB26*/
*                                                                  1190
*GRPHDR:                                                           1190
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
GRPHDR   ST    @14,@SA00013                                        1190
*                                                                  1191
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1191
*   OLDERID2=NEWERID2;                                             1191
         L     @07,@PC00001                                        1191
         L     @15,GDTTR2(,@07)                                    1191
         MVC   @TS00001(95),NEWERID2(@15)                          1191
         MVC   OLDERID2(95,@15),@TS00001                           1191
*   NEWID2='LDGH';                  /*                       @Z40LB26*/
*                                                                  1192
         MVC   NEWID2(4,@15),@CC01678                              1192
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*   CC03=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1193
         SLR   @15,@15                                             1193
         LR    CC03,@15                                            1193
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF IT IS A USAGE OR STATUS REPORT.       @Z40LB26*/
*   /* READ IN SUB-TITLE LINE ONLY ON FIRST CALL.            @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1194
*   IF ADDR(USAGE)^=NULLPTR THEN    /*                       @Z40LB26*/
         L     @14,@PC00001+4                                      1194
         C     @15,FDTPTR+56(,@14)                                 1194
         BE    @RF01194                                            1194
*     DO;                           /*                       @Z40LB26*/
*                                                                  1195
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF FIRST CALL FOR USAGE                     @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1196
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/
         TM    NOINITSW,B'00100000'                                1196
         BNZ   @RF01196                                            1196
*         DO;                       /*                       @Z40LB26*/
*                                                                  1197
*           /*********************************************************/
*           /*                                                       */
*           /* READ IN SUB-TITLE LINE                        @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1198
*           DARGAREA=''B;           /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1198
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/
         L     @15,DDSTRU                                          1199
         MVC   DARGSMOD(3,@15),@CC01477                            1199
*           DARGSENT=GVUSEID;       /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'02'                                 1200
*           DARGRETP=ADDR(STGRPUSE);/*                       @Z40LB26*/
         LA    @14,STGRPUSE                                        1201
         ST    @14,DARGRETP(,@15)                                  1201
*           DARGRETL=LENGTH(STGRPUSE);/*                     @Z40LB26*/
         MVC   DARGRETL(2,@15),@CH01473                            1202
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/
         ST    @07,@AL00001                                        1203
         LA    @15,@CF00117                                        1203
         ST    @15,@AL00001+4                                      1203
         LA    @15,DDSTRU                                          1203
         ST    @15,@AL00001+8                                      1203
         MVI   @AL00001+8,X'80'                                    1203
         L     @15,GDTPRT(,@07)                                    1203
         LA    @01,@AL00001                                        1203
         BALR  @14,@15                                             1203
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/
         OI    NOINITSW,B'00100000'                                1204
*         END;                      /*                       @Z40LB26*/
*                                                                  1205
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UESTA TO ESTABLISH THIS AS A SUB-TITLE      @Z40LB26*/
*       /* AFTER INSERTING THE VOLUME SERIAL AND GROUP       @Z40LB26*/
*       /* NAME.                                             @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1206
*       PCARG=''B;                  /*                       @Z40LB26*/
@RF01196 XC    PCARG(33),PCARG                                     1206
*       PCSTLP=ADDR(STGRPUSE);      /*                       @Z40LB26*/
         LA    @07,STGRPUSE                                        1207
         ST    @07,PCSTLP                                          1207
*       PCSTLC=1;                   /*                       @Z40LB26*/
         MVC   PCSTLC(2),@CH00222                                  1208
*       GVOLUSE=BASSERNO;           /*                       @Z40LB26*/
         MVC   GVOLUSE(6),BASSERNO(BASEVPTR)                       1209
*       GRPUSE=GROVVGRP;            /*                       @Z40LB26*/
         L     @07,GROUPPTR                                        1210
         MVC   GRPUSE(8),GROVVGRP(@07)                             1210
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/
         L     @07,@PC00001                                        1211
         ST    @07,@AL00001                                        1211
         LA    @15,PRINTIT                                         1211
         ST    @15,@AL00001+4                                      1211
         LA    @15,PCARG                                           1211
         ST    @15,@AL00001+8                                      1211
         L     @15,GDTESA(,@07)                                    1211
         LA    @01,@AL00001                                        1211
         BALR  @14,@15                                             1211
*     END;                          /*                       @Z40LB26*/
*                                                                  1212
*   /*****************************************************************/
*   /*                                                               */
*   /* STATUS REPORT WAS REQUESTED. READ                     @Z40LB26*/
*   /* THE SUB-TITLE LINE ONLY ON THE FIRST CALL             @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1213
*   ELSE                            /*                       @Z40LB26*/
*     DO;                           /*                       @Z40LB26*/
*                                                                  1213
         B     @RC01194                                            1213
@RF01194 DS    0H                                                  1214
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF FIRST CALL FOR STATUS                    @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1214
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/
         TM    NOINITSW,B'00100000'                                1214
         BNZ   @RF01214                                            1214
*         DO;                       /*                       @Z40LB26*/
*                                                                  1215
*           /*********************************************************/
*           /*                                                       */
*           /* READ IN SUB-TITLE LINE                        @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1216
*           DARGAREA=''B;           /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1216
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/
         L     @07,DDSTRU                                          1217
         MVC   DARGSMOD(3,@07),@CC01477                            1217
*           DARGSENT=GVSTATID;      /*                       @Z40LB26*/
         MVI   DARGSENT(@07),X'04'                                 1218
*           DARGRETP=ADDR(STGRPSTA);/*                       @Z40LB26*/
         LA    @15,STGRPSTA                                        1219
         ST    @15,DARGRETP(,@07)                                  1219
*           DARGRETL=LENGTH(STGRPSTA);/*                     @Z40LB26*/
         MVC   DARGRETL(2,@07),@CH01473                            1220
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/
         L     @07,@PC00001                                        1221
         ST    @07,@AL00001                                        1221
         LA    @15,@CF00117                                        1221
         ST    @15,@AL00001+4                                      1221
         LA    @15,DDSTRU                                          1221
         ST    @15,@AL00001+8                                      1221
         MVI   @AL00001+8,X'80'                                    1221
         L     @15,GDTPRT(,@07)                                    1221
         LA    @01,@AL00001                                        1221
         BALR  @14,@15                                             1221
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/
         OI    NOINITSW,B'00100000'                                1222
*         END;                      /*                       @Z40LB26*/
*                                                                  1223
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UESTA MACRO TO ESTABLISH THIS AS            @Z40LB26*/
*       /* A SUB-TITLE AFTER INSERTING THE VOLUME SERIAL     @Z40LB26*/
*       /* AND GROUP NAME.                                   @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1224
*       PCARG=''B;                  /*                       @Z40LB26*/
@RF01214 XC    PCARG(33),PCARG                                     1224
*       PCSTLP=ADDR(STGRPSTA);      /*                       @Z40LB26*/
         LA    @07,STGRPSTA                                        1225
         ST    @07,PCSTLP                                          1225
*       PCSTLC=1;                   /*                       @Z40LB26*/
         MVC   PCSTLC(2),@CH00222                                  1226
*       GVOLSTAT=BASSERNO;          /*                       @Z40LB26*/
         MVC   GVOLSTAT(6),BASSERNO(BASEVPTR)                      1227
*       GRPSTAT=GROVVGRP;           /*                       @Z40LB26*/
         L     @07,GROUPPTR                                        1228
         MVC   GRPSTAT(8),GROVVGRP(@07)                            1228
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/
         L     @07,@PC00001                                        1229
         ST    @07,@AL00001                                        1229
         LA    @15,PRINTIT                                         1229
         ST    @15,@AL00001+4                                      1229
         LA    @15,PCARG                                           1229
         ST    @15,@AL00001+8                                      1229
         L     @15,GDTESA(,@07)                                    1229
         LA    @01,@AL00001                                        1229
         BALR  @14,@15                                             1229
*     END;                          /*                       @Z40LB26*/
*                                                                  1230
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF GROUP NAME HAS CHANGED. IF CHANGED,   @Z40LB26*/
*   /* PUT OUT GROUP OWNER AND OWNER ADDRESS AS DATA LINES.  @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1231
*   IF OLDGROUP^=GROVVGRP THEN      /*                       @Z40LB26*/
@RC01194 L     @07,GROUPPTR                                        1231
         CLC   OLDGROUP(8),GROVVGRP(@07)                           1231
         BE    @RF01231                                            1231
*     DO;                           /*                       @Z40LB26*/
*       DARGAREA=''B;               /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1233
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/
         L     @15,DDSTRU                                          1234
         MVC   DARGSMOD(3,@15),@CC01477                            1234
*       DARGSENT=GRPOWNER;          /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'05'                                 1235
*       DARGCNT=2;                  /*                       @Z40LB26*/
         MVC   DARGCNT(2,@15),@CH00156                             1236
*       DARGINS(1)=10;              /*                       @Z40LB26*/
         LA    @14,10                                              1237
         STH   @14,DARGINS(,@15)                                   1237
*       DARGINL(1)=LENGTH(GROOWNER);/*                       @Z40LB26*/
         STH   @14,DARGINL(,@15)                                   1238
*       DARGDTM(1)=ADDR(GROOWNER);  /*                       @Z40LB26*/
         LA    @14,GROOWNER(,@07)                                  1239
         ST    @14,DARGDTM(,@15)                                   1239
*       DARGINS(2)=20;              /*                       @Z40LB26*/
         MVC   DARGINS+8(2,@15),@CH00279                           1240
*       DARGINL(2)=LENGTH(GROADDR); /*                       @Z40LB26*/
         MVC   DARGINL+8(2,@15),@CH01278                           1241
*       DARGDTM(2)=ADDR(GROADDR);   /*                       @Z40LB26*/
         LA    @07,GROADDR(,@07)                                   1242
         ST    @07,DARGDTM+8(,@15)                                 1242
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/
         L     @07,@PC00001                                        1243
         ST    @07,@AL00001                                        1243
         LA    @15,PRINTIT                                         1243
         ST    @15,@AL00001+4                                      1243
         LA    @15,DDSTRU                                          1243
         ST    @15,@AL00001+8                                      1243
         MVI   @AL00001+8,X'80'                                    1243
         L     @15,GDTPRT(,@07)                                    1243
         LA    @01,@AL00001                                        1243
         BALR  @14,@15                                             1243
*       OLDGROUP=GROVVGRP;          /*                       @Z40LB26*/
         L     @07,GROUPPTR                                        1244
         MVC   OLDGROUP(8),GROVVGRP(@07)                           1244
*     END;                          /*                       @Z40LB26*/
*                                                                  1245
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1246
*   RETURN CODE(CC03);              /*                       @Z40LB26*/
@RF01231 LR    @15,CC03                                            1246
@EL00013 DS    0H                                                  1246
@EF00013 DS    0H                                                  1246
@ER00013 L     @14,@SA00013                                        1246
         BR    @14                                                 1246
*   END GRPHDR;                     /*                       @Z40LB26*/
*                                                                  1248
*/********************************************************** @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - VOLHDR                                       @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  WILL INITIALLY READ IN THE SUB-TITLE LINE    @Z40LB26*/
*/*             FROM THE STATIC TEXT AND THEN EACH TIME THE  @Z40LB26*/
*/*             VOLUME BEING PROCESSED CHANGES IT WILL       @Z40LB26*/
*/*             UPDATE THE SUB-TITLE LINE.  IT WILL HANDLE   @Z40LB26*/
*/*             SUB-TITLE LINES FOR BOTH USAGE AND STATUS    @Z40LB26*/
*/*             REPORTS.                                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - FUNCTION DATA TABLE, BASE VOLUME RECORD,         @Z40LB26*/
*/*         STATIC TEXT MODULE.                              @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/********************************************************** @Z40LB26*/
*                                                                  1248
*VOLHDR:                                                           1248
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
VOLHDR   ST    @14,@SA00014                                        1248
*                                                                  1249
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1249
*   OLDERID2=NEWERID2;                                             1249
         L     @07,@PC00001                                        1249
         L     @15,GDTTR2(,@07)                                    1249
         MVC   @TS00001(95),NEWERID2(@15)                          1249
         MVC   OLDERID2(95,@15),@TS00001                           1249
*   NEWID2='LDVH';                  /*                       @Z40LB26*/
*                                                                  1250
         MVC   NEWID2(4,@15),@CC01682                              1250
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1251
*   CC03=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1251
         SLR   @15,@15                                             1251
         LR    CC03,@15                                            1251
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF A USAGE OR STATUS REPORT WAS          @Z40LB26*/
*   /* REQUESTED. READ IN SUB-TITLE LINE IF IT HASN'T        @Z40LB26*/
*   /* BEEN DONE PREVIOUSLY.                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1252
*   IF ADDR(USAGE)^=NULLPTR THEN    /*                       @Z40LB26*/
         L     @14,@PC00001+4                                      1252
         C     @15,FDTPTR+56(,@14)                                 1252
         BE    @RF01252                                            1252
*     DO;                           /*                       @Z40LB26*/
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/
         TM    NOINITSW,B'00100000'                                1254
         BNZ   @RF01254                                            1254
*         DO;                       /*                       @Z40LB26*/
*                                                                  1255
*           /*********************************************************/
*           /*                                                       */
*           /* READ IN SUB-TITLE LINE                        @Z40LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1256
*           DARGAREA=''B;           /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1256
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/
         L     @15,DDSTRU                                          1257
         MVC   DARGSMOD(3,@15),@CC01477                            1257
*           DARGSENT=VOLUSEID;      /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'01'                                 1258
*           DARGRETP=ADDR(STVOLUSE);/*                       @Z40LB26*/
         LA    @14,STVOLUSE                                        1259
         ST    @14,DARGRETP(,@15)                                  1259
*           DARGRETL=LENGTH(STVOLUSE);/*                     @Z40LB26*/
         MVC   DARGRETL(2,@15),@CH01473                            1260
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/
         ST    @07,@AL00001                                        1261
         LA    @15,@CF00117                                        1261
         ST    @15,@AL00001+4                                      1261
         LA    @15,DDSTRU                                          1261
         ST    @15,@AL00001+8                                      1261
         MVI   @AL00001+8,X'80'                                    1261
         L     @15,GDTPRT(,@07)                                    1261
         LA    @01,@AL00001                                        1261
         BALR  @14,@15                                             1261
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/
         OI    NOINITSW,B'00100000'                                1262
*         END;                      /*                       @Z40LB26*/
*                                                                  1263
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE UESTA TO ESTABLISH SUB-TITLE LINE       @Z40LB26*/
*       /* AFTER INSERTING THE VOLUME SERIAL.                @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1264
*       PCARG=''B;                  /*                       @Z40LB26*/
@RF01254 XC    PCARG(33),PCARG                                     1264
*       PCSTLP=ADDR(STVOLUSE);      /*                       @Z40LB26*/
         LA    @07,STVOLUSE                                        1265
         ST    @07,PCSTLP                                          1265
*       PCSTLC=1;                   /*                       @Z40LB26*/
         MVC   PCSTLC(2),@CH00222                                  1266
*       VOLUSE=BASSERNO;            /*                       @Z40LB26*/
         MVC   VOLUSE(6),BASSERNO(BASEVPTR)                        1267
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/
         L     @07,@PC00001                                        1268
         ST    @07,@AL00001                                        1268
         LA    @15,PRINTIT                                         1268
         ST    @15,@AL00001+4                                      1268
         LA    @15,PCARG                                           1268
         ST    @15,@AL00001+8                                      1268
         L     @15,GDTESA(,@07)                                    1268
         LA    @01,@AL00001                                        1268
         BALR  @14,@15                                             1268
*     END;                          /*                       @Z40LB26*/
*                                                                  1270
*   /*****************************************************************/
*   /*                                                               */
*   /* IF STATUS TYPE REPORT, SET UP SUB-TITLE LINE FOR      @Z40LB26*/
*   /* STATUS REPORT BY VOLUME.                              @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1270
*   ELSE                            /*                       @Z40LB26*/
*     DO;                           /*                       @Z40LB26*/
         B     @RC01252                                            1270
@RF01252 DS    0H                                                  1271
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/
         TM    NOINITSW,B'00100000'                                1271
         BNZ   @RF01271                                            1271
*         DO;                       /*                       @Z40LB26*/
*           DARGAREA=''B;           /*                       @Z40LB26*/
         XC    DARGAREA(76),DARGAREA                               1273
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/
         L     @07,DDSTRU                                          1274
         MVC   DARGSMOD(3,@07),@CC01477                            1274
*           DARGSENT=VOLSTAID;      /*                       @Z40LB26*/
         MVI   DARGSENT(@07),X'03'                                 1275
*           DARGRETP=ADDR(STVOLSTA);/*                       @Z40LB26*/
         LA    @15,STVOLSTA                                        1276
         ST    @15,DARGRETP(,@07)                                  1276
*           DARGRETL=LENGTH(STVOLSTA);/*                     @Z40LB26*/
         MVC   DARGRETL(2,@07),@CH01473                            1277
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/
         L     @07,@PC00001                                        1278
         ST    @07,@AL00001                                        1278
         LA    @15,@CF00117                                        1278
         ST    @15,@AL00001+4                                      1278
         LA    @15,DDSTRU                                          1278
         ST    @15,@AL00001+8                                      1278
         MVI   @AL00001+8,X'80'                                    1278
         L     @15,GDTPRT(,@07)                                    1278
         LA    @01,@AL00001                                        1278
         BALR  @14,@15                                             1278
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/
         OI    NOINITSW,B'00100000'                                1279
*         END;                      /*                       @Z40LB26*/
*                                                                  1280
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UESTA MACRO TO SET UP THE LINE JUST         @Z40LB26*/
*       /* READ AS A SUB-TITLE LINE AFTER INSERTING THE      @Z40LB26*/
*       /* VOLUME SERIAL                                     @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1281
*       PCARG=''B;                  /*                       @Z40LB26*/
@RF01271 XC    PCARG(33),PCARG                                     1281
*       PCSTLP=ADDR(STVOLSTA);      /*                       @Z40LB26*/
         LA    @07,STVOLSTA                                        1282
         ST    @07,PCSTLP                                          1282
*       PCSTLC=1;                   /*                       @Z40LB26*/
         MVC   PCSTLC(2),@CH00222                                  1283
*       VOLSTAT=BASSERNO;           /*                       @Z40LB26*/
         MVC   VOLSTAT(6),BASSERNO(BASEVPTR)                       1284
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/
         L     @07,@PC00001                                        1285
         ST    @07,@AL00001                                        1285
         LA    @15,PRINTIT                                         1285
         ST    @15,@AL00001+4                                      1285
         LA    @15,PCARG                                           1285
         ST    @15,@AL00001+8                                      1285
         L     @15,GDTESA(,@07)                                    1285
         LA    @01,@AL00001                                        1285
         BALR  @14,@15                                             1285
*     END;                          /*                       @Z40LB26*/
*                                                                  1286
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1287
*   RETURN CODE(CC03);              /*                       @Z40LB26*/
@RC01252 LR    @15,CC03                                            1287
@EL00014 DS    0H                                                  1287
@EF00014 DS    0H                                                  1287
@ER00014 L     @14,@SA00014                                        1287
         BR    @14                                                 1287
*   END VOLHDR;                     /*                       @Z40LB26*/
*                                                                  1289
*/********************************************************** @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - STATRPT                                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN BODY OF A     @Z40LB26*/
*/*             STATUS REPORT IS TO BE PRODUCED. IT CONVERTS @Z40LB26*/
*/*             FIELDS THAT CANNOT BE CONVERTED BY THE TEXT  @Z40LB26*/
*/*             PROCESSOR.  FINALLY IT CALLS THE STATSUM     @Z40LB26*/
*/*             PROCEDURE TO PRINT THE SUMMARY INFORMATION.  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - SORTED LIST OF DATA SETS (VSDBLOCK)              @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*********************************************************  @Z40LB26*/
*                                                                  1289
*STATRPT:                                                          1289
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
STATRPT  ST    @14,@SA00015                                        1289
*                                                                  1290
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT                               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1290
*   OLDERID2=NEWERID2;                                             1290
         L     @15,@PC00001                                        1290
         L     @15,GDTTR2(,@15)                                    1290
         MVC   @TS00001(95),NEWERID2(@15)                          1290
         MVC   OLDERID2(95,@15),@TS00001                           1290
*   NEWID2='LDSR';                  /*                       @Z40LB26*/
*                                                                  1291
         MVC   NEWID2(4,@15),@CC01686                              1291
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INITIAL CONDITION CODE                            @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1292
*   CC03=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1292
         SLR   CC03,CC03                                           1292
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF THERE ARE ANY DATA SETS IN THE LIST. PROCESS   @Z40LB26*/
*   /* THEM IF THERE ARE SOME                                @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1293
*   DO ELEMENT=1 TO VSDELEM;        /*                       @Z40LB26*/
*                                                                  1293
         LA    ELEMENT,1                                           1293
         B     @DE01293                                            1293
@DL01293 DS    0H                                                  1294
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE CREATION DATE IN THE VTOC WAS HIGHER THAN    @Z40LB26*/
*     /* IN THE VSAM CATALOG, SET UP TO PRINT A '-V' AFTER   @Z40LB26*/
*     /* THE DATE. IF THE CREATION DATE IN THE VSAM          @Z40LB26*/
*     /* CATALOG WAS HIGHER, SET UP TO PRINT A '-C'          @Z40LB26*/
*     /* AFTER THE DATE. IF BOTH DATES WERE EQUAL, SET       @Z40LB26*/
*     /* UP TO PRINT BLANKS AFTER THE DATE                   @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1294
*     IF VSDVTOCC=ON&VSDVSAMC=OFF   /*                       @Z40LB26*/
*       THEN                        /*                       @Z40LB26*/
         LR    @03,ELEMENT                                         1294
         MH    @03,@CH01764                                        1294
         L     @01,LISTADDR                                        1294
         AL    @01,@CF01791                                        1294
         LA    @03,VSDVARY-64(@03,@01)                             1294
         TM    VSDVTOCC(@03),B'10000000'                           1294
         BNO   @RF01294                                            1294
         TM    VSDVSAMC(@03),B'00100000'                           1294
         BNZ   @RF01294                                            1294
*       VSDCRE=DASHV;               /*                       @Z40LB26*/
         MVC   VSDCRE(2,@03),DASHV                                 1295
*     ELSE                          /*                       @Z40LB26*/
*       DO;                         /*                       @Z40LB26*/
         B     @RC01294                                            1296
@RF01294 DS    0H                                                  1297
*         IF VSDVSAMC=ON&VSDVTOCC=OFF/*                      @Z40LB26*/
*           THEN                    /*                       @Z40LB26*/
         LR    @03,ELEMENT                                         1297
         MH    @03,@CH01764                                        1297
         L     @01,LISTADDR                                        1297
         AL    @01,@CF01791                                        1297
         LA    @03,VSDVARY-64(@03,@01)                             1297
         TM    VSDVSAMC(@03),B'00100000'                           1297
         BNO   @RF01297                                            1297
         TM    VSDVTOCC(@03),B'10000000'                           1297
         BNZ   @RF01297                                            1297
*           VSDCRE=DASHC;           /*                       @Z40LB26*/
         MVC   VSDCRE(2,@03),DASHC                                 1298
*         ELSE                      /*                       @Z40LB26*/
*           VSDCRE=BLANK;           /*                       @Z40LB26*/
         B     @RC01297                                            1299
@RF01297 LR    @03,ELEMENT                                         1299
         MH    @03,@CH01764                                        1299
         L     @01,LISTADDR                                        1299
         AL    @01,@CF01791                                        1299
         LA    @03,VSDVARY-64(@03,@01)                             1299
         MVI   VSDCRE+1(@03),C' '                                  1299
         MVI   VSDCRE(@03),C' '                                    1299
*       END;                        /*                       @Z40LB26*/
*                                                                  1300
@RC01297 DS    0H                                                  1301
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE EXPIRATION DATE IN THE VTOC WAS HIGHER THAN  @Z40LB26*/
*     /* THAT IN THE VSAM CATALOG, SET UP TO PRINT A "-V"    @Z40LB26*/
*     /* AFTER THE DATE. IF THE EXPIRATION DATE IN THE       @Z40LB26*/
*     /* VSAM CATALOG WAS HIGHER THAN THAT IN THE VTOC       @Z40LB26*/
*     /* SET UP TO PRINT A "-C" AFTER THE DATE. IF BOTH      @Z40LB26*/
*     /* EXPIRATION DATES ARE EQUAL, SET UP TO PRINT         @Z40LB26*/
*     /* BLANKS AFTER THE DATE.                              @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1301
*     IF VSDVTOCE=ON&VSDVSAME=OFF   /*                       @Z40LB26*/
*       THEN                        /*                       @Z40LB26*/
@RC01294 LR    @03,ELEMENT                                         1301
         MH    @03,@CH01764                                        1301
         L     @01,LISTADDR                                        1301
         AL    @01,@CF01791                                        1301
         LA    @03,VSDVARY-64(@03,@01)                             1301
         TM    VSDVTOCE(@03),B'01000000'                           1301
         BNO   @RF01301                                            1301
         TM    VSDVSAME(@03),B'00010000'                           1301
         BNZ   @RF01301                                            1301
*       VSDEXP=DASHV;               /*                       @Z40LB26*/
         MVC   VSDEXP(2,@03),DASHV                                 1302
*     ELSE                          /*                       @Z40LB26*/
*       DO;                         /*                       @Z40LB26*/
         B     @RC01301                                            1303
@RF01301 DS    0H                                                  1304
*         IF VSDVSAME=ON&VSDVTOCE=OFF/*                      @Z40LB26*/
*           THEN                    /*                       @Z40LB26*/
         LR    @03,ELEMENT                                         1304
         MH    @03,@CH01764                                        1304
         L     @01,LISTADDR                                        1304
         AL    @01,@CF01791                                        1304
         LA    @03,VSDVARY-64(@03,@01)                             1304
         TM    VSDVSAME(@03),B'00010000'                           1304
         BNO   @RF01304                                            1304
         TM    VSDVTOCE(@03),B'01000000'                           1304
         BNZ   @RF01304                                            1304
*           VSDEXP=DASHC;           /*                       @Z40LB26*/
         MVC   VSDEXP(2,@03),DASHC                                 1305
*         ELSE                      /*                       @Z40LB26*/
*           VSDEXP=BLANK;           /*                       @Z40LB26*/
         B     @RC01304                                            1306
@RF01304 LR    @03,ELEMENT                                         1306
         MH    @03,@CH01764                                        1306
         L     @01,LISTADDR                                        1306
         AL    @01,@CF01791                                        1306
         LA    @03,VSDVARY-64(@03,@01)                             1306
         MVI   VSDEXP+1(@03),C' '                                  1306
         MVI   VSDEXP(@03),C' '                                    1306
*       END;                        /*                       @Z40LB26*/
*                                                                  1307
@RC01304 DS    0H                                                  1308
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP THE CATALOG FIELD FOR THE TEXT PROCESSOR.    @Z40LB26*/
*     /* IF THE DATA SET IS CATALOGED, SET UP TO PRINT       @Z40LB26*/
*     /* BLANKS. IF THE DATA SET IS NOT CATALOGED,           @Z40LB26*/
*     /* SET UP TO PRINT 'NO'. IF AN ERROR OCCURRED          @Z40LB26*/
*     /* LOCATING THE DATA SET IN THE CATALOG, SET UP TO     @Z40LB26*/
*     /* PRINT 'ERR'. IF THE DATA SET IS CATALOGED           @Z40LB26*/
*     /* ON MORE THAN ONE VOLUME, SET UP TO PRINT            @Z40LB26*/
*     /* THE NUMBER OF VOLUMES.                              @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1308
*     IF VSDCATLG=ON&VSDERROR=OFF   /*                       @Z40LB26*/
*         &VSDVOLCT(ELEMENT)<=1 THEN/*                       @Z40LB26*/
@RC01301 L     @03,LISTADDR                                        1308
         LR    @15,ELEMENT                                         1308
         MH    @15,@CH01764                                        1308
         LA    @01,0(@15,@03)                                      1308
         AL    @01,@CF01791                                        1308
         TM    VSDCATLG(@01),B'00001000'                           1308
         BNO   @RF01308                                            1308
         TM    VSDERROR(@01),B'00010000'                           1308
         BNZ   @RF01308                                            1308
         AL    @03,@CF01792                                        1308
         L     @03,VSDVOLCT-16(@15,@03)                            1308
         C     @03,@CF00222                                        1308
         BH    @RF01308                                            1308
*       VSDCAT=BLANK;               /*                       @Z40LB26*/
         MVI   VSDCAT+1(@01),C' '                                  1309
         MVI   VSDCAT+2(@01),C' '                                  1309
         MVI   VSDCAT(@01),C' '                                    1309
*     ELSE                          /*                       @Z40LB26*/
*       DO;                         /*                       @Z40LB26*/
         B     @RC01308                                            1310
@RF01308 DS    0H                                                  1311
*         IF VSDCATLG=OFF&VSDERROR=OFF/*                     @Z40LB26*/
*           THEN                    /*                       @Z40LB26*/
         LR    @03,ELEMENT                                         1311
         MH    @03,@CH01764                                        1311
         L     @01,LISTADDR                                        1311
         AL    @01,@CF01791                                        1311
         LA    @03,VSDVARY-64(@03,@01)                             1311
         TM    VSDCATLG(@03),B'00001000'                           1311
         BNZ   @RF01311                                            1311
         TM    VSDERROR(@03),B'00010000'                           1311
         BNZ   @RF01311                                            1311
*           VSDCAT=NOCAT;           /*                       @Z40LB26*/
         MVC   VSDCAT(3,@03),NOCAT                                 1312
*         ELSE                      /*                       @Z40LB26*/
*           IF VSDERROR=ON THEN     /*                       @Z40LB26*/
         B     @RC01311                                            1313
@RF01311 LR    @03,ELEMENT                                         1313
         MH    @03,@CH01764                                        1313
         L     @01,LISTADDR                                        1313
         AL    @01,@CF01791                                        1313
         LA    @03,VSDVARY-64(@03,@01)                             1313
         TM    VSDERROR(@03),B'00010000'                           1313
         BNO   @RF01313                                            1313
*             VSDCAT=ERROR;         /*                       @Z40LB26*/
         MVC   VSDCAT(3,@03),ERROR                                 1314
*           ELSE                    /*                       @Z40LB26*/
*             IF VSDVOLCT(ELEMENT)>1 THEN/*                  @Z40LB26*/
         B     @RC01313                                            1315
@RF01313 LA    @03,1                                               1315
         L     @15,LISTADDR                                        1315
         LR    @14,ELEMENT                                         1315
         MH    @14,@CH01764                                        1315
         LA    @01,0(@14,@15)                                      1315
         AL    @01,@CF01792                                        1315
         L     @01,VSDVOLCT-16(,@01)                               1315
         CR    @01,@03                                             1315
         BNH   @RF01315                                            1315
*               DO;                 /*                       @Z40LB26*/
*                                                                  1316
*                 /***************************************************/
*                 /*                                                 */
*                 /* CONVERT MULTI-VOLUME COUNT TO DECIMAL   @Z40LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1317
*                 CVD(VSDVOLCT(ELEMENT),HOLD4CHR);/*         @Z40LB26*/
*                                                                  1317
         CVD   @01,@TS00001                                        1317
         MVC   HOLD4CHR(4),@TS00001+4                              1317
*                 /***************************************************/
*                 /*                                                 */
*                 /* UNPACK                                  @Z40LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1318
*                 UNPK(VSDCAT,HOLD4CHR);/*                   @Z40LB26*/
*                                                                  1318
         AL    @15,@CF01791                                        1318
         LA    @15,VSDVARY-64(@14,@15)                             1318
         UNPK  VSDCAT(3,@15),HOLD4CHR(4)                           1318
*                 /***************************************************/
*                 /*                                                 */
*                 /* GET RID OF SIGN IN THIRD BYTE SO IT     @Z40LB26*/
*                 /* WILL PRINT                              @Z40LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1319
*                 VSDCAT(3)=VSDCAT(3)×ORIT;/*                @Z40LB26*/
*                                                                  1319
         OI    VSDCAT+2(@15),C'0'                                  1319
*                 /***************************************************/
*                 /*                                                 */
*                 /* SUPPRESS LEADING ZEROES                 @Z40LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1320
*                 DO SUPCNT=1 TO 2 WHILE/*                   @Z40LB26*/
*                       VSDCAT(SUPCNT)=CHARZERO;/*           @Z40LB26*/
         LA    @15,1                                               1320
         LR    SUPCNT,@15                                          1320
@DL01320 LR    @15,ELEMENT                                         1320
         MH    @15,@CH01764                                        1320
         L     @01,LISTADDR                                        1320
         AL    @01,@CF01791                                        1320
         LA    @15,VSDVARY-64(@15,@01)                             1320
         LR    @14,@15                                             1320
         ALR   @14,SUPCNT                                          1320
         CLI   VSDCAT-1(@14),C'0'                                  1320
         BNE   @DC01320                                            1320
*                   VSDCAT(SUPCNT)=BLANK;/*                  @Z40LB26*/
         ALR   @15,SUPCNT                                          1321
         MVI   VSDCAT-1(@15),C' '                                  1321
*                 END;              /*                       @Z40LB26*/
         AL    SUPCNT,@CF00222                                     1322
         C     SUPCNT,@CF00156                                     1322
         BNH   @DL01320                                            1322
@DC01320 DS    0H                                                  1323
*               END;                /*                       @Z40LB26*/
*       END;                        /*                       @Z40LB26*/
*                                                                  1324
@RF01315 DS    0H                                                  1324
@RC01313 DS    0H                                                  1324
@RC01311 DS    0H                                                  1325
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP PROTECTION SECTION OF DATA LINE              @Z40LB26*/
*     /* WITH EITHER 'R/W' FOR READ×WRITE, 'W' FOR WRITE,    @Z40LB26*/
*     /* 'RACF' FOR RACF,'RF,R' FOR BOTH RACF AND READ/WRITE,        */
*     /*                                                     @G24LB31*/
*     /* 'RF,W' FOR BOTH RACF AND WRITE,                     @G24LB31*/
*     /* OR BLANKS FOR NO PROTECTION.                        @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1325
*     IF VSDPROT=ON THEN            /*                       @Z40LB26*/
@RC01308 LR    @03,ELEMENT                                         1325
         MH    @03,@CH01764                                        1325
         L     @01,LISTADDR                                        1325
         AL    @01,@CF01791                                        1325
         LA    @03,VSDVARY-64(@03,@01)                             1325
         TM    VSDPROT(@03),B'00100000'                            1325
         BNO   @RF01325                                            1325
*       DO;                         /*                       @Z40LB26*/
*         IF VSDRACF=ON THEN        /*                       @G24LB31*/
         TM    VSDRACF(@03),B'00001000'                            1327
         BNO   @RF01327                                            1327
*           DO;                     /*                       @G24LB31*/
*             IF VSDPWR=ON THEN     /*                       @G24LB31*/
         TM    VSDPWR(@03),B'10000000'                             1329
         BNO   @RF01329                                            1329
*               VSDPRTC=PROTRFR;    /*                       @G24LB31*/
         MVC   VSDPRTC(4,@03),PROTRFR                              1330
*             ELSE                  /*                       @G24LB31*/
*               IF VSDPWW=ON THEN   /*                       @G24LB31*/
         B     @RC01329                                            1331
@RF01329 LR    @03,ELEMENT                                         1331
         MH    @03,@CH01764                                        1331
         L     @01,LISTADDR                                        1331
         AL    @01,@CF01791                                        1331
         LA    @03,VSDVARY-64(@03,@01)                             1331
         TM    VSDPWW(@03),B'01000000'                             1331
         BNO   @RF01331                                            1331
*                 VSDPRTC=PROTRFW;  /*                       @G24LB31*/
         MVC   VSDPRTC(4,@03),PROTRFW                              1332
*               ELSE                /*                       @G24LB31*/
*                 VSDPRTC=PROTRACF; /*                       @G24LB31*/
         B     @RC01331                                            1333
@RF01331 LR    @03,ELEMENT                                         1333
         MH    @03,@CH01764                                        1333
         L     @01,LISTADDR                                        1333
         AL    @01,@CF01791                                        1333
         LA    @03,VSDVARY-64(@03,@01)                             1333
         MVC   VSDPRTC(4,@03),PROTRACF                             1333
*           END;                    /*                       @G24LB31*/
*         ELSE                      /*                       @G24LB31*/
*           IF VSDPWR=ON THEN       /*                       @Z40LB26*/
         B     @RC01327                                            1335
@RF01327 LR    @03,ELEMENT                                         1335
         MH    @03,@CH01764                                        1335
         L     @01,LISTADDR                                        1335
         AL    @01,@CF01791                                        1335
         LA    @03,VSDVARY-64(@03,@01)                             1335
         TM    VSDPWR(@03),B'10000000'                             1335
         BNO   @RF01335                                            1335
*             VSDPRTC=RDWRITE;      /*                       @Z40LB26*/
         MVC   VSDPRTC(4,@03),RDWRITE                              1336
*           ELSE                    /*                       @Z40LB26*/
*             DO;                   /*                       @Z40LB26*/
         B     @RC01335                                            1337
@RF01335 DS    0H                                                  1338
*               IF VSDPWW=ON THEN   /*                       @Z40LB26*/
         LR    @03,ELEMENT                                         1338
         MH    @03,@CH01764                                        1338
         L     @01,LISTADDR                                        1338
         AL    @01,@CF01791                                        1338
         LA    @03,VSDVARY-64(@03,@01)                             1338
         TM    VSDPWW(@03),B'01000000'                             1338
         BNO   @RF01338                                            1338
*                 VSDPRTC=WRITE;    /*                       @Z40LB26*/
         MVC   VSDPRTC(4,@03),WRITE                                1339
*               ELSE                /*                       @Z40LB26*/
*                 VSDPRTC=BLANK;    /*                       @Z40LB26*/
         B     @RC01338                                            1340
@RF01338 LR    @03,ELEMENT                                         1340
         MH    @03,@CH01764                                        1340
         L     @01,LISTADDR                                        1340
         AL    @01,@CF01791                                        1340
         LA    @03,VSDVARY-64(@03,@01)                             1340
         MVI   VSDPRTC+1(@03),C' '                                 1340
         MVC   VSDPRTC+2(2,@03),VSDPRTC+1(@03)                     1340
         MVI   VSDPRTC(@03),C' '                                   1340
*             END;                  /*                       @Z40LB26*/
*       END;                        /*                       @Z40LB26*/
*     ELSE                          /*                       @Z40LB26*/
*       VSDPRTC=BLANK;              /*                       @Z40LB26*/
         B     @RC01325                                            1343
@RF01325 LR    @03,ELEMENT                                         1343
         MH    @03,@CH01764                                        1343
         L     @01,LISTADDR                                        1343
         AL    @01,@CF01791                                        1343
         LA    @03,VSDVARY-64(@03,@01)                             1343
         MVI   VSDPRTC+1(@03),C' '                                 1343
         MVC   VSDPRTC+2(2,@03),VSDPRTC+1(@03)                     1343
         MVI   VSDPRTC(@03),C' '                                   1343
*   END;                            /*                       @Z40LB26*/
@RC01325 AL    ELEMENT,@CF00222                                    1344
@DE01293 L     @03,LISTADDR                                        1344
         C     ELEMENT,VSDELEM(,@03)                               1344
         BNH   @DL01293                                            1344
*                                                                  1345
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UPRINT WITH REPLICATION OPTION TO PRINT OUT     @Z40LB26*/
*   /* THE ENTIRE MAIN BODY OF THE STATUS REPORT FOR ONE     @Z40LB26*/
*   /* VOLUME IF THERE ARE ANY DATA SETS TO REPORT ON.       @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1345
*   IF VSDELEM>0 THEN               /*                       @Z40LB26*/
         L     @15,LISTADDR                                        1345
         L     @14,VSDELEM(,@15)                                   1345
         LTR   @14,@14                                             1345
         BNP   @RF01345                                            1345
*     DO;                           /*                       @Z40LB26*/
*       DARGLIST=''B;               /*                       @Z40LB26*/
         L     @03,DDSTRU                                          1347
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1347
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@03),@CC01477                            1348
*       DARGSENT=MAINSTAT;          /*                       @Z40LB26*/
         MVI   DARGSENT(@03),X'07'                                 1349
*       DARGDBP=ADDR(VSDARRAY(1));  /*                       @Z40LB26*/
         LA    @02,VSDARRAY(,@15)                                  1350
         ST    @02,DARGDBP(,@03)                                   1350
*       DARGILP=VSDELEM*LENGTH(VSDARRAY(1));/*               @Z40LB26*/
         LR    @15,@14                                             1351
         MH    @15,@CH01764                                        1351
         STH   @15,DARGILP(,@03)                                   1351
*       DARGCNT=1;                  /*                       @Z40LB26*/
         MVC   DARGCNT(2,@03),@CH00222                             1352
*       DARGREP(1)=10;              /*                       @Z40LB26*/
         MVC   DARGREP(2,@03),@CH00037                             1353
*       DARGPCT(1)=VSDELEM;         /*                       @Z40LB26*/
         STH   @14,DARGPCT(,@03)                                   1354
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/
         L     @15,@PC00001                                        1355
         ST    @15,@AL00001                                        1355
         LA    @14,PRINTIT                                         1355
         ST    @14,@AL00001+4                                      1355
         LA    @14,DDSTRU                                          1355
         ST    @14,@AL00001+8                                      1355
         MVI   @AL00001+8,X'80'                                    1355
         L     @15,GDTPRT(,@15)                                    1355
         LA    @01,@AL00001                                        1355
         BALR  @14,@15                                             1355
*     END;                          /*                       @Z40LB26*/
*                                                                  1356
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO PRINT OUT THE SUMMARY INFORMATION     @Z40LB26*/
*   /* FOR A STATUS REPORT ON ONE VOLUME                     @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1357
*   CALL STATSUM;                   /*                       @Z40LB26*/
@RF01345 BAL   @14,STATSUM                                         1357
*   RETURN CODE(CC03);              /*                       @Z40LB26*/
         LR    @15,CC03                                            1358
@EL00015 DS    0H                                                  1358
@EF00015 DS    0H                                                  1358
@ER00015 L     @14,@SA00015                                        1358
         BR    @14                                                 1358
*   END STATRPT;                    /*                       @Z40LB26*/
*                                                                  1360
*/*********************************************************  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - USAGERPT                                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN BODY OF A     @Z40LB26*/
*/*             USAGE REPORT IS TO BE PRODUCED.  IT ALSO     @Z40LB26*/
*/*             KEEPS TRACK OF THE TOTAL TRACKS ALLOCATED    @Z40LB26*/
*/*             TO THE DATA SETS LISTED ON THE REPORT.  IT   @Z40LB26*/
*/*             CONVERTS FIELDS THAT CANNOT BE CONVERTED     @Z40LB26*/
*/*             BY THE TEXT PROCESSOR.  IT THEN CALLS        @Z40LB26*/
*/*             USAGESUM ROUTINE TO PRINT THE SUMMARY        @Z40LB26*/
*/*             INFORMATION.                                 @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - SORTED LIST OF DATA SETS                         @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*********************************************************  @Z40LB26*/
*                                                                  1360
*USAGERPT:                                                         1360
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
USAGERPT ST    @14,@SA00016                                        1360
*                                                                  1361
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1361
*   OLDERID2=NEWERID2;                                             1361
         L     @15,@PC00001                                        1361
         L     @15,GDTTR2(,@15)                                    1361
         MVC   @TS00001(95),NEWERID2(@15)                          1361
         MVC   OLDERID2(95,@15),@TS00001                           1361
*   NEWID2='LDUR';                  /*                       @Z40LB26*/
*                                                                  1362
         MVC   NEWID2(4,@15),@CC01693                              1362
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE INITIALLY                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1363
*   CC03=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1363
         SLR   @15,@15                                             1363
         LR    CC03,@15                                            1363
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO TOTAL TRACKS                                     @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1364
*   TOTALTRK=0;                     /*                       @Z40LB26*/
*                                                                  1364
         STH   @15,TOTALTRK                                        1364
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF THERE ARE ANY DATA SETS IN THE LIST            @Z40LB26*/
*   /* TO BE PROCESSED. LOOP THEM IF THERE ARE.              @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1365
*   DO ELEMENT=1 TO VSDELEM;        /*                       @Z40LB26*/
*                                                                  1365
         LA    ELEMENT,1                                           1365
         B     @DE01365                                            1365
@DL01365 DS    0H                                                  1366
*     /***************************************************************/
*     /*                                                             */
*     /* CONVERT OR SET UP FIELDS THAT CANNOT BE HANDLED     @Z40LB26*/
*     /* BY THE TEXT PROCESSOR                               @Z40LB26*/
*     /* SET UP THE DATA SET ORGANIZATION                    @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1366
*     IF VSDOPO=ON THEN             /*                       @Z40LB26*/
         LR    @03,ELEMENT                                         1366
         MH    @03,@CH01764                                        1366
         L     @01,LISTADDR                                        1366
         AL    @01,@CF01791                                        1366
         LA    @03,VSDVARY-64(@03,@01)                             1366
         TM    VSDOPO(@03),B'10000000'                             1366
         BNO   @RF01366                                            1366
*       VSDDSORG=PARTORG;           /*                       @Z40LB26*/
         MVC   VSDDSORG(3,@03),PARTORG                             1367
*     ELSE                          /*                       @Z40LB26*/
*       IF VSDOPS=ON THEN           /*                       @Z40LB26*/
         B     @RC01366                                            1368
@RF01366 LR    @03,ELEMENT                                         1368
         MH    @03,@CH01764                                        1368
         L     @01,LISTADDR                                        1368
         AL    @01,@CF01791                                        1368
         LA    @03,VSDVARY-64(@03,@01)                             1368
         TM    VSDOPS(@03),B'01000000'                             1368
         BNO   @RF01368                                            1368
*         VSDDSORG=PHYSEQ;          /*                       @Z40LB26*/
         MVC   VSDDSORG(3,@03),PHYSEQ                              1369
*       ELSE                        /*                       @Z40LB26*/
*         IF VSDOUN=ON THEN         /*                       @Z40LB26*/
         B     @RC01368                                            1370
@RF01368 LR    @03,ELEMENT                                         1370
         MH    @03,@CH01764                                        1370
         L     @01,LISTADDR                                        1370
         AL    @01,@CF01791                                        1370
         LA    @03,VSDVARY-64(@03,@01)                             1370
         TM    VSDOUN(@03),B'00100000'                             1370
         BNO   @RF01370                                            1370
*           VSDDSORG=UNKN;          /*                       @Z40LB26*/
         MVC   VSDDSORG(3,@03),UNKN                                1371
*         ELSE                      /*                       @Z40LB26*/
*           IF VSDODA=ON THEN       /*                       @Z40LB26*/
         B     @RC01370                                            1372
@RF01370 LR    @03,ELEMENT                                         1372
         MH    @03,@CH01764                                        1372
         L     @01,LISTADDR                                        1372
         AL    @01,@CF01791                                        1372
         LA    @03,VSDVARY-64(@03,@01)                             1372
         TM    VSDODA(@03),B'00010000'                             1372
         BNO   @RF01372                                            1372
*             VSDDSORG=DIRACC;      /*                       @Z40LB26*/
         MVC   VSDDSORG(3,@03),DIRACC                              1373
*           ELSE                    /*                       @Z40LB26*/
*             IF VSDOIS=ON THEN     /*                       @Z40LB26*/
         B     @RC01372                                            1374
@RF01372 LR    @03,ELEMENT                                         1374
         MH    @03,@CH01764                                        1374
         L     @01,LISTADDR                                        1374
         AL    @01,@CF01791                                        1374
         LA    @03,VSDVARY-64(@03,@01)                             1374
         TM    VSDOIS(@03),B'00001000'                             1374
         BNO   @RF01374                                            1374
*               VSDDSORG=INDSEQ;    /*                       @Z40LB26*/
*                                                                  1375
         MVC   VSDDSORG(3,@03),INDSEQ                              1375
*     /***************************************************************/
*     /*                                                             */
*     /* FOR ALL DATA SET ORGANIZATIONS EXCEPT UNKNOWN,      @Z40LB26*/
*     /* CHECK IF THE DATA SET IS UNMOVEABLE + SET UP        @Z40LB26*/
*     /* TO PRINT A "U" IF IT IS.                            @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1376
*     IF VSDOUN=OFF&VSDOU=ON THEN   /*                       @Z40LB26*/
@RF01374 DS    0H                                                  1376
@RC01372 DS    0H                                                  1376
@RC01370 DS    0H                                                  1376
@RC01368 DS    0H                                                  1376
@RC01366 LR    @03,ELEMENT                                         1376
         MH    @03,@CH01764                                        1376
         L     @01,LISTADDR                                        1376
         AL    @01,@CF01791                                        1376
         LA    @03,VSDVARY-64(@03,@01)                             1376
         TM    VSDOU(@03),B'00000100'                              1376
         BNO   @RF01376                                            1376
         TM    VSDOUN(@03),B'00100000'                             1376
         BNZ   @RF01376                                            1376
*       VSDDSOR3=UNMOVE;            /*                       @Z40LB26*/
*                                                                  1377
         MVC   VSDDSOR3(1,@03),UNMOVE                              1377
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP ALLOCATION UNIT                              @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1378
*     IF VSDACYL=ON THEN            /*                       @Z40LB26*/
@RF01376 LR    @03,ELEMENT                                         1378
         MH    @03,@CH01764                                        1378
         L     @01,LISTADDR                                        1378
         AL    @01,@CF01791                                        1378
         LA    @03,VSDVARY-64(@03,@01)                             1378
         TM    VSDACYL(@03),B'10000000'                            1378
         BNO   @RF01378                                            1378
*       VSDALLC=CYLINDER;           /*                       @Z40LB26*/
         MVC   VSDALLC(5,@03),CYLINDER                             1379
*     ELSE                          /*                       @Z40LB26*/
*       IF VSDATRK=ON THEN          /*                       @Z40LB26*/
         B     @RC01378                                            1380
@RF01378 LR    @03,ELEMENT                                         1380
         MH    @03,@CH01764                                        1380
         L     @01,LISTADDR                                        1380
         AL    @01,@CF01791                                        1380
         LA    @03,VSDVARY-64(@03,@01)                             1380
         TM    VSDATRK(@03),B'01000000'                            1380
         BNO   @RF01380                                            1380
*         VSDALLC=TRACK;            /*                       @Z40LB26*/
         MVC   VSDALLC(5,@03),TRACK                                1381
*       ELSE                        /*                       @Z40LB26*/
*         IF VSDABLK=ON THEN        /*                       @Z40LB26*/
         B     @RC01380                                            1382
@RF01380 LR    @03,ELEMENT                                         1382
         MH    @03,@CH01764                                        1382
         L     @01,LISTADDR                                        1382
         AL    @01,@CF01791                                        1382
         LA    @03,VSDVARY-64(@03,@01)                             1382
         TM    VSDABLK(@03),B'00100000'                            1382
         BNO   @RF01382                                            1382
*           VSDALLC=BLOCK;          /*                       @Z40LB26*/
         MVC   VSDALLC(5,@03),BLOCK                                1383
*         ELSE                      /*                       @Z40LB26*/
*           IF VSDABSTR=ON THEN     /*                       @Z40LB26*/
         B     @RC01382                                            1384
@RF01382 LR    @03,ELEMENT                                         1384
         MH    @03,@CH01764                                        1384
         L     @01,LISTADDR                                        1384
         AL    @01,@CF01791                                        1384
         LA    @03,VSDVARY-64(@03,@01)                             1384
         TM    VSDABSTR(@03),B'00010000'                           1384
         BNO   @RF01384                                            1384
*             VSDALLC=ABSOLUTE;     /*                       @Z40LB26*/
*                                                                  1385
         MVC   VSDALLC(5,@03),ABSOLUTE                             1385
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK SECONDARY ALLOCATION. IF MORE THAN 9999       @Z40LB26*/
*     /* INSERT BLANKS.                                      @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1386
*     IF VSDSECAL>MAXALLOC THEN     /*                       @Z40LB26*/
@RF01384 DS    0H                                                  1386
@RC01382 DS    0H                                                  1386
@RC01380 DS    0H                                                  1386
@RC01378 LR    @03,ELEMENT                                         1386
         MH    @03,@CH01764                                        1386
         L     @01,LISTADDR                                        1386
         AL    @01,@CF01791                                        1386
         LA    @03,VSDVARY-64(@03,@01)                             1386
         L     @15,VSDSECAL(,@03)                                  1386
         C     @15,@CF01408                                        1386
         BNH   @RF01386                                            1386
*       VSDSCAL=BLANK;              /*                       @Z40LB26*/
         MVI   VSDSCAL+1(@03),C' '                                 1387
         MVC   VSDSCAL+2(2,@03),VSDSCAL+1(@03)                     1387
         MVI   VSDSCAL(@03),C' '                                   1387
*     ELSE                          /*                       @Z40LB26*/
*       DO;                         /*                       @Z40LB26*/
*                                                                  1388
         B     @RC01386                                            1388
@RF01386 DS    0H                                                  1389
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT FIELD TO DECIMAL                        @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1389
*         CVD(VSDSECAL,HOLD4CHR);   /*                       @Z40LB26*/
*                                                                  1389
         LR    @03,ELEMENT                                         1389
         MH    @03,@CH01764                                        1389
         L     @01,LISTADDR                                        1389
         AL    @01,@CF01791                                        1389
         LA    @03,VSDVARY-64(@03,@01)                             1389
         L     @15,VSDSECAL(,@03)                                  1389
         CVD   @15,@TS00001                                        1389
         MVC   HOLD4CHR(4),@TS00001+4                              1389
*         /***********************************************************/
*         /*                                                         */
*         /* UNPACK                                          @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1390
*         UNPK(VSDSCAL,HOLD4CHR);   /*                       @Z40LB26*/
*                                                                  1390
         UNPK  VSDSCAL(4,@03),HOLD4CHR(4)                          1390
*         /***********************************************************/
*         /*                                                         */
*         /* GET RID OF SIGN IN FOURTH BYTE SO IT            @Z40LB26*/
*         /* WILL PRINT                                      @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1391
*         VSDSCAL(4)=VSDSCAL(4)×ORIT;/*                      @Z40LB26*/
*                                                                  1391
         OI    VSDSCAL+3(@03),C'0'                                 1391
*         /***********************************************************/
*         /*                                                         */
*         /* SUPPRESS LEADING ZEROES                         @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1392
*         DO SUPCNT=1 TO 3 WHILE    /*                       @Z40LB26*/
*               VSDSCAL(SUPCNT)=CHARZERO;/*                  @Z40LB26*/
         LA    SUPCNT,1                                            1392
@DL01392 LR    @15,ELEMENT                                         1392
         MH    @15,@CH01764                                        1392
         L     @01,LISTADDR                                        1392
         AL    @01,@CF01791                                        1392
         LA    @15,VSDVARY-64(@15,@01)                             1392
         LR    @14,@15                                             1392
         ALR   @14,SUPCNT                                          1392
         CLI   VSDSCAL-1(@14),C'0'                                 1392
         BNE   @DC01392                                            1392
*           VSDSCAL(SUPCNT)=BLANK;  /*                       @Z40LB26*/
         ALR   @15,SUPCNT                                          1393
         MVI   VSDSCAL-1(@15),C' '                                 1393
*         END;                      /*                       @Z40LB26*/
         AL    SUPCNT,@CF00222                                     1394
         C     SUPCNT,@CF00165                                     1394
         BNH   @DL01392                                            1394
@DC01392 DS    0H                                                  1395
*       END;                        /*                       @Z40LB26*/
*                                                                  1395
*     /***************************************************************/
*     /*                                                             */
*     /* TAKE CARE OF FREE TRACKS CONVERSION. IF FREE        @Z40LB26*/
*     /* TRACKS COULD NOT BE CALCULATED, SET UP TO PRINT     @Z40LB26*/
*     /* BLANKS.                                             @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1396
*     IF VSDCALFR=ON THEN           /*                       @Z40LB26*/
@RC01386 LR    @03,ELEMENT                                         1396
         MH    @03,@CH01764                                        1396
         L     @01,LISTADDR                                        1396
         AL    @01,@CF01791                                        1396
         LA    @03,VSDVARY-64(@03,@01)                             1396
         TM    VSDCALFR(@03),B'10000000'                           1396
         BNO   @RF01396                                            1396
*       VSDFREE=BLANK;              /*                       @Z40LB26*/
         MVI   VSDFREE+1(@03),C' '                                 1397
         MVC   VSDFREE+2(2,@03),VSDFREE+1(@03)                     1397
         MVI   VSDFREE(@03),C' '                                   1397
*     ELSE                          /*                       @Z40LB26*/
*       DO;                         /*                       @Z40LB26*/
*                                                                  1398
         B     @RC01396                                            1398
@RF01396 DS    0H                                                  1399
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT FIELD TO DECIMAL                        @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1399
*         CVD(VSDFTRK,HOLD4CHR);    /*                       @Z40LB26*/
*                                                                  1399
         LR    @03,ELEMENT                                         1399
         MH    @03,@CH01764                                        1399
         L     @01,LISTADDR                                        1399
         AL    @01,@CF01791                                        1399
         LA    @03,VSDVARY-64(@03,@01)                             1399
         LH    @15,VSDFTRK(,@03)                                   1399
         CVD   @15,@TS00001                                        1399
         MVC   HOLD4CHR(4),@TS00001+4                              1399
*         /***********************************************************/
*         /*                                                         */
*         /* UNPACK                                          @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1400
*         UNPK(VSDFREE,HOLD4CHR);   /*                       @Z40LB26*/
*                                                                  1400
         UNPK  VSDFREE(4,@03),HOLD4CHR(4)                          1400
*         /***********************************************************/
*         /*                                                         */
*         /* GET RID OF SIGN IN FOURTH BYTE SO IT            @Z40LB26*/
*         /* WILL PRINT                                      @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1401
*         VSDFREE(4)=VSDFREE(4)×ORIT;/*                      @Z40LB26*/
*                                                                  1401
         OI    VSDFREE+3(@03),C'0'                                 1401
*         /***********************************************************/
*         /*                                                         */
*         /* SUPPRESS LEADING ZEROES                         @Z40LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1402
*         DO SUPCNT=1 TO 3 WHILE    /*                       @Z40LB26*/
*               VSDFREE(SUPCNT)=CHARZERO;/*                  @Z40LB26*/
         LA    SUPCNT,1                                            1402
@DL01402 LR    @15,ELEMENT                                         1402
         MH    @15,@CH01764                                        1402
         L     @01,LISTADDR                                        1402
         AL    @01,@CF01791                                        1402
         LA    @15,VSDVARY-64(@15,@01)                             1402
         LR    @14,@15                                             1402
         ALR   @14,SUPCNT                                          1402
         CLI   VSDFREE-1(@14),C'0'                                 1402
         BNE   @DC01402                                            1402
*           VSDFREE(SUPCNT)=BLANK;  /*                       @Z40LB26*/
         ALR   @15,SUPCNT                                          1403
         MVI   VSDFREE-1(@15),C' '                                 1403
*         END;                      /*                       @Z40LB26*/
         AL    SUPCNT,@CF00222                                     1404
         C     SUPCNT,@CF00165                                     1404
         BNH   @DL01402                                            1404
@DC01402 DS    0H                                                  1405
*       END;                        /*                       @Z40LB26*/
*                                                                  1405
*     /***************************************************************/
*     /*                                                             */
*     /* KEEP A RUNNING TOTAL OF THE TOTAL TRACKS ALLOCATED  @Z40LB26*/
*     /* TO DATA SETS LISTED                                 @Z40LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1406
*     TOTALTRK=TOTALTRK+VSDTRKS;    /*                       @Z40LB26*/
@RC01396 LR    @03,ELEMENT                                         1406
         MH    @03,@CH01764                                        1406
         L     @01,LISTADDR                                        1406
         AL    @01,@CF01791                                        1406
         LA    @03,VSDVARY-64(@03,@01)                             1406
         LH    @15,TOTALTRK                                        1406
         AH    @15,VSDTRKS(,@03)                                   1406
         STH   @15,TOTALTRK                                        1406
*   END;                            /*                       @Z40LB26*/
*                                                                  1407
         AL    ELEMENT,@CF00222                                    1407
@DE01365 L     @03,LISTADDR                                        1407
         C     ELEMENT,VSDELEM(,@03)                               1407
         BNH   @DL01365                                            1407
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UPRINT WITH REPLICATION OPTION TO PRINT MAIN    @Z40LB26*/
*   /* BODY OF REPORT FOR ONE VOLUME IF THERE ARE ANY DATA   @Z40LB26*/
*   /* SETS TO REPORT ON.                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1408
*   IF VSDELEM>0 THEN               /*                       @Z40LB26*/
         L     @15,LISTADDR                                        1408
         L     @14,VSDELEM(,@15)                                   1408
         LTR   @14,@14                                             1408
         BNP   @RF01408                                            1408
*     DO;                           /*                       @Z40LB26*/
*       DARGLIST=''B;               /*                       @Z40LB26*/
         L     @03,DDSTRU                                          1410
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1410
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@03),@CC01477                            1411
*       DARGSENT=MAINUSE;           /*                       @Z40LB26*/
         MVI   DARGSENT(@03),X'06'                                 1412
*       DARGDBP=ADDR(VSDARRAY(1));  /*                       @Z40LB26*/
         LA    @02,VSDARRAY(,@15)                                  1413
         ST    @02,DARGDBP(,@03)                                   1413
*       DARGILP=VSDELEM*LENGTH(VSDARRAY);/*                  @Z40LB26*/
         LR    @15,@14                                             1414
         MH    @15,@CH01764                                        1414
         STH   @15,DARGILP(,@03)                                   1414
*       DARGCNT=1;                  /*                       @Z40LB26*/
         MVC   DARGCNT(2,@03),@CH00222                             1415
*       DARGREP(1)=10;              /*                       @Z40LB26*/
         MVC   DARGREP(2,@03),@CH00037                             1416
*       DARGPCT(1)=VSDELEM;         /*                       @Z40LB26*/
         STH   @14,DARGPCT(,@03)                                   1417
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/
         L     @15,@PC00001                                        1418
         ST    @15,@AL00001                                        1418
         LA    @14,PRINTIT                                         1418
         ST    @14,@AL00001+4                                      1418
         LA    @14,DDSTRU                                          1418
         ST    @14,@AL00001+8                                      1418
         MVI   @AL00001+8,X'80'                                    1418
         L     @15,GDTPRT(,@15)                                    1418
         LA    @01,@AL00001                                        1418
         BALR  @14,@15                                             1418
*     END;                          /*                       @Z40LB26*/
*                                                                  1419
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO PRINT OUT THE SUMMARY INFORMATION     @Z40LB26*/
*   /* FOR A USAGE REPORT ON ONE VOLUME                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1420
*   CALL USAGESUM;                  /*                       @Z40LB26*/
@RF01408 BAL   @14,USAGESUM                                        1420
*   RETURN CODE(CC03);              /*                       @Z40LB26*/
         LR    @15,CC03                                            1421
@EL00016 DS    0H                                                  1421
@EF00016 DS    0H                                                  1421
@ER00016 L     @14,@SA00016                                        1421
         BR    @14                                                 1421
*   END USAGERPT;                   /*                       @Z40LB26*/
*                                                                  1423
*/*********************************************************  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - STATSUM                                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN SECTION OF A  @Z40LB26*/
*/*             STATUS REPORT HAS BEEN MADE FOR A VOLUME.    @Z40LB26*/
*/*             THIS PROCEDURE PRINTS THE SUMMARY INFORMA-   @Z40LB26*/
*/*             TION FOR A PARTICULAR VOLUME ON A STATUS     @Z40LB26*/
*/*             REPORT.                                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - TOTAL NUMBER OF DATA SETS FIELD IN VSDBLOCK.     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*********************************************************  @Z40LB26*/
*                                                                  1423
*STATSUM:                                                          1423
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
STATSUM  ST    @14,@SA00017                                        1423
*                                                                  1424
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1424
*   OLDERID2=NEWERID2;                                             1424
         L     @03,@PC00001                                        1424
         L     @15,GDTTR2(,@03)                                    1424
         MVC   @TS00001(95),NEWERID2(@15)                          1424
         MVC   OLDERID2(95,@15),@TS00001                           1424
*   NEWID2='LDSS';                  /*                       @Z40LB26*/
*                                                                  1425
         MVC   NEWID2(4,@15),@CC01698                              1425
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1426
*   CC04=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1426
         SLR   CC04,CC04                                           1426
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP DARGLIST TO PRINT SUMMARY LINE                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1427
*   DARGLIST=''B;                   /*                       @Z40LB26*/
         L     @15,DDSTRU                                          1427
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1427
*   DARGSMOD=LD01TXT;               /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@15),@CC01477                            1428
*   DARGSENT=STASUM;                /*                       @Z40LB26*/
         MVI   DARGSENT(@15),X'09'                                 1429
*   DARGDBP=ADDR(VSDELEM);          /*                       @Z40LB26*/
         L     @14,LISTADDR                                        1430
         ST    @14,DARGDBP(,@15)                                   1430
*   DARGILP=LENGTH(VSDELEM);        /*                       @Z40LB26*/
*                                                                  1431
         MVC   DARGILP(2,@15),@CH00043                             1431
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT OUT SUMMARY LINE                                @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1432
*   CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*                  @Z40LB26*/
*                                                                  1432
         ST    @03,@AL00001                                        1432
         LA    @15,PRINTIT                                         1432
         ST    @15,@AL00001+4                                      1432
         LA    @15,DDSTRU                                          1432
         ST    @15,@AL00001+8                                      1432
         MVI   @AL00001+8,X'80'                                    1432
         L     @15,GDTPRT(,@03)                                    1432
         LA    @01,@AL00001                                        1432
         BALR  @14,@15                                             1432
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE URESET TO GET RID OF OLD SUB-TITLE AND          @Z40LB26*/
*   /* HEADER LINES                                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1433
*   CALL AMSTP044(GDTTBL,PRINTIT);  /*                       @Z40LB26*/
*                                                                  1433
         L     @03,@PC00001                                        1433
         ST    @03,@AL00001                                        1433
         LA    @15,PRINTIT                                         1433
         ST    @15,@AL00001+4                                      1433
         MVI   @AL00001+4,X'80'                                    1433
         L     @15,GDTRES(,@03)                                    1433
         LA    @01,@AL00001                                        1433
         BALR  @14,@15                                             1433
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1434
*   RETURN CODE(CC04);              /*                       @Z40LB26*/
         LR    @15,CC04                                            1434
@EL00017 DS    0H                                                  1434
@EF00017 DS    0H                                                  1434
@ER00017 L     @14,@SA00017                                        1434
         BR    @14                                                 1434
*   END STATSUM;                    /*                       @Z40LB26*/
*                                                                  1436
*/*********************************************************  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - USAGESUM                                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN SECTION OF A  @Z40LB26*/
*/*             USAGE REPORT HAS BEEN MADE FOR A VOLUME.     @Z40LB26*/
*/*             THIS PROCEDURE PRINTS THE SUMMARY INFOR-     @Z40LB26*/
*/*             TION FOR A PARTICULAR VOLUME ON A SPACE      @Z40LB26*/
*/*             USAGE REPORT                                 @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* INPUT - TOTAL TRACKS FOR LISTED DATA SETS(TOTALTRK).     @Z40LB26*/
*/*         DATA SET LIST(VSDBLOCK)                          @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/********************************************************** @Z40LB26*/
*                                                                  1436
*USAGESUM:                                                         1436
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
USAGESUM ST    @14,@SA00018                                        1436
*                                                                  1437
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1437
*   OLDERID2=NEWERID2;                                             1437
         L     @03,@PC00001                                        1437
         L     @03,GDTTR2(,@03)                                    1437
         MVC   @TS00001(95),NEWERID2(@03)                          1437
         MVC   OLDERID2(95,@03),@TS00001                           1437
*   NEWID2='LDUS';                  /*                       @Z40LB26*/
*                                                                  1438
         MVC   NEWID2(4,@03),@CC01702                              1438
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1439
*   CC04=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1439
         SLR   CC04,CC04                                           1439
*   /*****************************************************************/
*   /*                                                               */
*   /* SUPPRESS LEADING ZEROES IN THE ALREADY CONVERTED      @Z40LB26*/
*   /* INFORMATION.                                          @Z40LB26*/
*   /* TOTAL FREE CYLINDERS ON VOLUME                        @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1440
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/
*         VSDFRCYL(SUPCNT)=CHARZERO;/*                       @Z40LB26*/
         LA    SUPCNT,1                                            1440
@DL01440 L     @01,LISTADDR                                        1440
         L     @15,VSDSPACE(,@01)                                  1440
         LR    @14,@15                                             1440
         ALR   @14,SUPCNT                                          1440
         CLI   VSDFRCYL-1(@14),C'0'                                1440
         BNE   @DC01440                                            1440
*     VSDFRCYL(SUPCNT)=BLANK;       /*                       @Z40LB26*/
         ALR   @15,SUPCNT                                          1441
         MVI   VSDFRCYL-1(@15),C' '                                1441
*   END;                            /*                       @Z40LB26*/
*                                                                  1442
         AL    SUPCNT,@CF00222                                     1442
         C     SUPCNT,@CF00165                                     1442
         BNH   @DL01440                                            1442
@DC01440 DS    0H                                                  1443
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE TRACKS                                           @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1443
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/
*         VSDFRTRK(SUPCNT)=CHARZERO;/*                       @Z40LB26*/
         LA    SUPCNT,1                                            1443
@DL01443 L     @01,LISTADDR                                        1443
         L     @15,VSDSPACE(,@01)                                  1443
         LR    @14,@15                                             1443
         ALR   @14,SUPCNT                                          1443
         CLI   VSDFRTRK-1(@14),C'0'                                1443
         BNE   @DC01443                                            1443
*     VSDFRTRK(SUPCNT)=BLANK;       /*                       @Z40LB26*/
         ALR   @15,SUPCNT                                          1444
         MVI   VSDFRTRK-1(@15),C' '                                1444
*   END;                            /*                       @Z40LB26*/
*                                                                  1445
         AL    SUPCNT,@CF00222                                     1445
         C     SUPCNT,@CF00165                                     1445
         BNH   @DL01443                                            1445
@DC01443 DS    0H                                                  1446
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE EXTENTS                                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1446
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/
*         VSDFREXT(SUPCNT)=CHARZERO;/*                       @Z40LB26*/
         LA    SUPCNT,1                                            1446
@DL01446 L     @01,LISTADDR                                        1446
         L     @15,VSDSPACE(,@01)                                  1446
         LR    @14,@15                                             1446
         ALR   @14,SUPCNT                                          1446
         CLI   VSDFREXT-1(@14),C'0'                                1446
         BNE   @DC01446                                            1446
*     VSDFREXT(SUPCNT)=BLANK;       /*                       @Z40LB26*/
         ALR   @15,SUPCNT                                          1447
         MVI   VSDFREXT-1(@15),C' '                                1447
*   END;                            /*                       @Z40LB26*/
*                                                                  1448
         AL    SUPCNT,@CF00222                                     1448
         C     SUPCNT,@CF00165                                     1448
         BNH   @DL01446                                            1448
@DC01446 DS    0H                                                  1449
*   /*****************************************************************/
*   /*                                                               */
*   /* LARGEST FREE EXTENT                                   @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1449
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/
*         VSDFRCCL(SUPCNT)=CHARZERO;/*                       @Z40LB26*/
         LA    SUPCNT,1                                            1449
@DL01449 L     @01,LISTADDR                                        1449
         L     @15,VSDSPACE(,@01)                                  1449
         LR    @14,@15                                             1449
         ALR   @14,SUPCNT                                          1449
         CLI   VSDFRCCL-1(@14),C'0'                                1449
         BNE   @DC01449                                            1449
*     VSDFRCCL(SUPCNT)=BLANK;       /*                       @Z40LB26*/
         ALR   @15,SUPCNT                                          1450
         MVI   VSDFRCCL-1(@15),C' '                                1450
*   END;                            /*                       @Z40LB26*/
*                                                                  1451
         AL    SUPCNT,@CF00222                                     1451
         C     SUPCNT,@CF00165                                     1451
         BNH   @DL01449                                            1451
@DC01449 DS    0H                                                  1452
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD DARGLIST FOR PRINTING SUMMARY LINES             @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1452
*   DARGLIST=''B;                   /*                       @Z40LB26*/
         L     @03,DDSTRU                                          1452
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1452
*   DARGSMOD=LD01TXT;               /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@03),@CC01477                            1453
*   DARGSENT=USESUM;                /*                       @Z40LB26*/
         MVI   DARGSENT(@03),X'08'                                 1454
*   DARGCNT=7;                      /*                       @Z40LB26*/
*                                                                  1455
         MVC   DARGCNT(2,@03),@CH00519                             1455
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD INSERT LISTS                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1456
*   DARGINS(1)=10;                  /*                       @Z40LB26*/
         MVC   DARGINS(2,@03),@CH00037                             1456
*   DARGINL(1)=LENGTH(TOTALTRK);    /*                       @Z40LB26*/
         MVC   DARGINL(2,@03),@CH00156                             1457
*   DARGDTM(1)=ADDR(TOTALTRK);      /*                       @Z40LB26*/
         LA    @15,TOTALTRK                                        1458
         ST    @15,DARGDTM(,@03)                                   1458
*   DARGINS(2)=20;                  /*                       @Z40LB26*/
         MVC   DARGINS+8(2,@03),@CH00279                           1459
*   DARGINL(2)=LENGTH(VSDVTOCS);    /*                       @Z40LB26*/
         LA    @15,4                                               1460
         STH   @15,DARGINL+8(,@03)                                 1460
*   DARGDTM(2)=ADDR(VSDVTOCS);      /*                       @Z40LB26*/
         L     @14,LISTADDR                                        1461
         LA    @01,VSDVTOCS(,@14)                                  1461
         ST    @01,DARGDTM+8(,@03)                                 1461
*   DARGINS(3)=30;                  /*                       @Z40LB26*/
         MVC   DARGINS+16(2,@03),@CH01278                          1462
*   DARGINL(3)=LENGTH(VSDFMT0);     /*                       @Z40LB26*/
         STH   @15,DARGINL+16(,@03)                                1463
*   DARGDTM(3)=ADDR(VSDFMT0);       /*                       @Z40LB26*/
         LA    @01,VSDFMT0(,@14)                                   1464
         ST    @01,DARGDTM+16(,@03)                                1464
*   DARGINS(4)=40;                  /*                       @Z40LB26*/
         MVC   DARGINS+24(2,@03),@CH01703                          1465
*   DARGINL(4)=LENGTH(VSDFRCYL);    /*                       @Z40LB26*/
         STH   @15,DARGINL+24(,@03)                                1466
*   DARGDTM(4)=ADDR(VSDFRCYL);      /*                       @Z40LB26*/
         L     @14,VSDSPACE(,@14)                                  1467
         LA    @01,VSDFRCYL(,@14)                                  1467
         ST    @01,DARGDTM+24(,@03)                                1467
*   DARGINS(5)=50;                  /*                       @Z40LB26*/
         MVC   DARGINS+32(2,@03),@CH01448                          1468
*   DARGINL(5)=LENGTH(VSDFRTRK);    /*                       @Z40LB26*/
         STH   @15,DARGINL+32(,@03)                                1469
*   DARGDTM(5)=ADDR(VSDFRTRK);      /*                       @Z40LB26*/
         LA    @01,VSDFRTRK(,@14)                                  1470
         ST    @01,DARGDTM+32(,@03)                                1470
*   DARGINS(6)=60;                  /*                       @Z40LB26*/
         MVC   DARGINS+40(2,@03),@CH01464                          1471
*   DARGINL(6)=LENGTH(VSDFREXT);    /*                       @Z40LB26*/
         STH   @15,DARGINL+40(,@03)                                1472
*   DARGDTM(6)=ADDR(VSDFREXT);      /*                       @Z40LB26*/
         LA    @01,VSDFREXT(,@14)                                  1473
         ST    @01,DARGDTM+40(,@03)                                1473
*   DARGINS(7)=70;                  /*                       @Z40LB26*/
         MVC   DARGINS+48(2,@03),@CH01704                          1474
*   DARGINL(7)=LENGTH(VSDFRCCL);    /*                       @Z40LB26*/
         STH   @15,DARGINL+48(,@03)                                1475
*   DARGDTM(7)=ADDR(VSDFRCCL);      /*                       @Z40LB26*/
*                                                                  1476
         LA    @15,VSDFRCCL(,@14)                                  1476
         ST    @15,DARGDTM+48(,@03)                                1476
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UPRINT FOR ENTIRE SUMMARY                       @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1477
*   CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*                  @Z40LB26*/
*                                                                  1477
         L     @03,@PC00001                                        1477
         ST    @03,@AL00001                                        1477
         LA    @15,PRINTIT                                         1477
         ST    @15,@AL00001+4                                      1477
         LA    @15,DDSTRU                                          1477
         ST    @15,@AL00001+8                                      1477
         MVI   @AL00001+8,X'80'                                    1477
         L     @15,GDTPRT(,@03)                                    1477
         LA    @01,@AL00001                                        1477
         BALR  @14,@15                                             1477
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE URESET TO GET RID OF OLD SUB-TITLE AND          @Z40LB26*/
*   /* HEADER LINES                                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1478
*   CALL AMSTP044(GDTTBL,PRINTIT);  /*                       @Z40LB26*/
*                                                                  1478
         L     @03,@PC00001                                        1478
         ST    @03,@AL00001                                        1478
         LA    @15,PRINTIT                                         1478
         ST    @15,@AL00001+4                                      1478
         MVI   @AL00001+4,X'80'                                    1478
         L     @15,GDTRES(,@03)                                    1478
         LA    @01,@AL00001                                        1478
         BALR  @14,@15                                             1478
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1479
*   RETURN CODE(CC04);              /*                       @Z40LB26*/
         LR    @15,CC04                                            1479
@EL00018 DS    0H                                                  1479
@EF00018 DS    0H                                                  1479
@ER00018 L     @14,@SA00018                                        1479
         BR    @14                                                 1479
*   END USAGESUM;                   /*                       @Z40LB26*/
*                                                                  1481
*/*********************************************************  @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* PROCEDURE - LEGENDS                                      @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* FUNCTION -  RECEIVES CONTROL WHEN A USAGE OR STATUS      @Z40LB26*/
*/*             REPORT IS COMPLETED AND A LEGEND WAS         @Z40LB26*/
*/*             REQUESTED.  IT PRINTS EITHER A STATUS OR     @Z40LB26*/
*/*             USAGE LEGEND, DEPENDING ON THE TYPE OF       @Z40LB26*/
*/*             REPORT ASKED FOR.                            @Z40LB26*/
*/*                                                          @Z40LB26*/
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/
*/*                                                          @Z40LB26*/
*/*********************************************************  @Z40LB26*/
*                                                                  1481
*LEGENDS:                                                          1481
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/
LEGENDS  ST    @14,@SA00019                                        1481
*                                                                  1482
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1482
*   OLDERID2=NEWERID2;                                             1482
         L     @05,@PC00001                                        1482
         L     @15,GDTTR2(,@05)                                    1482
         MVC   @TS00001(95),NEWERID2(@15)                          1482
         MVC   OLDERID2(95,@15),@TS00001                           1482
*   NEWID2='LDLG';                  /*                       @Z40LB26*/
*                                                                  1483
         MVC   NEWID2(4,@15),@CC01708                              1483
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE                                    @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1484
*   CC01=LASTCC00;                  /*                       @Z40LB26*/
*                                                                  1484
         SLR   @15,@15                                             1484
         LR    CC01,@15                                            1484
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF NEED TO CLEAR OLD SUB-TITLE LINE               @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1485
*   IF LASTCOND^=LASTCC00 THEN      /*                       @Z40LB26*/
         L     @14,@PC00001+8                                      1485
         CH    @15,LASTCOND(,@14)                                  1485
         BE    @RF01485                                            1485
*     CALL AMSTP044(GDTTBL,PRINTIT);/*                       @Z40LB26*/
*                                                                  1486
         ST    @05,@AL00001                                        1486
         LA    @15,PRINTIT                                         1486
         ST    @15,@AL00001+4                                      1486
         MVI   @AL00001+4,X'80'                                    1486
         L     @15,GDTRES(,@05)                                    1486
         LA    @01,@AL00001                                        1486
         BALR  @14,@15                                             1486
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UPRINT TO READ IN LEGENDS LINE AS A             @Z40LB26*/
*   /* SUB-TITLE                                             @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1487
*   DARGAREA=''B;                   /*                       @Z40LB26*/
@RF01485 XC    DARGAREA(76),DARGAREA                               1487
*   DARGSMOD=LD01TXT;               /*                       @Z40LB26*/
         L     @05,DDSTRU                                          1488
         MVC   DARGSMOD(3,@05),@CC01477                            1488
*   DARGSENT=LGNDID;                /*                       @Z40LB26*/
         MVI   DARGSENT(@05),X'0D'                                 1489
*   DARGRETP=ADDR(STLGND);          /*                       @Z40LB26*/
         LA    @15,STLGND                                          1490
         ST    @15,DARGRETP(,@05)                                  1490
*   DARGRETL=LENGTH(STLGND);        /*                       @Z40LB26*/
         MVC   DARGRETL(2,@05),@CH01473                            1491
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB26*/
*                                                                  1492
         L     @05,@PC00001                                        1492
         ST    @05,@AL00001                                        1492
         LA    @15,@CF00117                                        1492
         ST    @15,@AL00001+4                                      1492
         LA    @15,DDSTRU                                          1492
         ST    @15,@AL00001+8                                      1492
         MVI   @AL00001+8,X'80'                                    1492
         L     @15,GDTPRT(,@05)                                    1492
         LA    @01,@AL00001                                        1492
         BALR  @14,@15                                             1492
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UESTA TO ESTABLISH THE SUB-TITLE LINE           @Z40LB26*/
*   /* FOR LEGEND.                                           @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1493
*   PCARG=''B;                      /*                       @Z40LB26*/
         XC    PCARG(33),PCARG                                     1493
*   PCSTLP=ADDR(STLGND);            /*                       @Z40LB26*/
         LA    @05,STLGND                                          1494
         ST    @05,PCSTLP                                          1494
*   PCSTLC=1;                       /*                       @Z40LB26*/
         MVC   PCSTLC(2),@CH00222                                  1495
*   CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*                   @Z40LB26*/
*                                                                  1496
         L     @05,@PC00001                                        1496
         ST    @05,@AL00001                                        1496
         LA    @15,PRINTIT                                         1496
         ST    @15,@AL00001+4                                      1496
         LA    @15,PCARG                                           1496
         ST    @15,@AL00001+8                                      1496
         L     @15,GDTESA(,@05)                                    1496
         LA    @01,@AL00001                                        1496
         BALR  @14,@15                                             1496
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF USAGE REPORT                          @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1497
*   IF ADDR(USAGE)^=NULLPTR THEN    /*                       @Z40LB26*/
         L     @05,@PC00001+4                                      1497
         L     @05,FDTPTR+56(,@05)                                 1497
         LTR   @05,@05                                             1497
         BZ    @RF01497                                            1497
*     DO;                           /*                       @Z40LB26*/
*                                                                  1498
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT FOR USAGE LEGEND                     @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1499
*       DARGLIST=''B;               /*                       @Z40LB26*/
         L     @05,DDSTRU                                          1499
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1499
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@05),@CC01477                            1500
*       DARGSENT=USELGND;           /*                       @Z40LB26*/
*                                                                  1501
         MVI   DARGSENT(@05),X'0B'                                 1501
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT LEGEND                                      @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1502
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/
         L     @05,@PC00001                                        1502
         ST    @05,@AL00001                                        1502
         LA    @15,PRINTIT                                         1502
         ST    @15,@AL00001+4                                      1502
         LA    @15,DDSTRU                                          1502
         ST    @15,@AL00001+8                                      1502
         MVI   @AL00001+8,X'80'                                    1502
         L     @15,GDTPRT(,@05)                                    1502
         LA    @01,@AL00001                                        1502
         BALR  @14,@15                                             1502
*     END;                          /*                       @Z40LB26*/
*                                                                  1503
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF STATUS REPORT SUMMARY                        @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1504
*   ELSE                            /*                       @Z40LB26*/
*     DO;                           /*                       @Z40LB26*/
*                                                                  1504
         B     @RC01497                                            1504
@RF01497 DS    0H                                                  1505
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT OF STATUS LEGEND                            @Z40LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1505
*       DARGLIST=''B;               /*                       @Z40LB26*/
         L     @05,DDSTRU                                          1505
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1505
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/
         MVC   DARGSMOD(3,@05),@CC01477                            1506
*       DARGSENT=STATLGND;          /*                       @Z40LB26*/
         MVI   DARGSENT(@05),X'0A'                                 1507
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/
         L     @05,@PC00001                                        1508
         ST    @05,@AL00001                                        1508
         LA    @15,PRINTIT                                         1508
         ST    @15,@AL00001+4                                      1508
         LA    @15,DDSTRU                                          1508
         ST    @15,@AL00001+8                                      1508
         MVI   @AL00001+8,X'80'                                    1508
         L     @15,GDTPRT(,@05)                                    1508
         LA    @01,@AL00001                                        1508
         BALR  @14,@15                                             1508
*     END;                          /*                       @Z40LB26*/
*                                                                  1509
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE A URESET MACRO TO CAUSE A PAGE EJECT TO BE      @Z40LB26*/
*   /* CONSISTENT WITH THE FORMAT PRINTED WHEN NO LEGEND     @Z40LB26*/
*   /* WAS ASKED FOR.                                        @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1510
*   CALL AMSTP044(GDTTBL,PRINTIT);  /*                       @Z40LB26*/
*                                                                  1510
@RC01497 L     @05,@PC00001                                        1510
         ST    @05,@AL00001                                        1510
         LA    @15,PRINTIT                                         1510
         ST    @15,@AL00001+4                                      1510
         MVI   @AL00001+4,X'80'                                    1510
         L     @15,GDTRES(,@05)                                    1510
         LA    @01,@AL00001                                        1510
         BALR  @14,@15                                             1510
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1511
*   RETURN CODE(CC01);              /*                       @Z40LB26*/
         LR    @15,CC01                                            1511
@EL00019 DS    0H                                                  1511
@EF00019 DS    0H                                                  1511
@ER00019 L     @14,@SA00019                                        1511
         BR    @14                                                 1511
*   END LEGENDS;                    /*                       @Z40LB26*/
*                                                                  1513
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - DATES  (ACCESS METHOD SERVICES)         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION - THIS COMMON INCLUDED PROCEDURE PROVIDES       @Z40LB35*/
*/*            THE AMS SERVICES WITH THE BASIC FUNCTION OF   @Z40LB35*/
*/*            CONVERTING A ONE VALUE DATE SUCH AS 99999 TO  @Z40LB35*/
*/*            '00 99 0999' OR OBTAINING THE CURRENT DATE AND@Z40LB35*/
*/*            ADJUSTING IT BY EITHER ADDING OR SUBTRACTING  @Z40LB35*/
*/*            DAYS TO THAT DATE.  THE DATE WILL BE ADJUSTED @Z40LB35*/
*/*            FOR ANY LEAP YEARS.  THE DATE WILL ALSO BE    @Z40LB35*/
*/*            ADJUSTED TO FIT WITHIN THE RANGE 0 TO 99999.  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* ENTRY POINT - DATES                                      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*      LINKAGE - 'CALL DATES (DATESAGL)'                   @Z40LB35*/
*/*                '%INCLUDE SYSLIB(IDCDF55)'                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT  - ADDRESS OF ARGUMENT LIST (DATESAGL)             @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT - A RETURN CODE IN REGISTER 15                    @Z40LB35*/
*/*          (0) - DATES SUCCESSFUL                          @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*        - A CONVERTED DATE (00 YY DDDD) IN BINARY         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* EXIT NORMAL - RETURNS TO CALLER WITH CONDITION           @Z40LB35*/
*/*               CODE ZERO                                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* EXIT ERROR  - NONE                                       @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* CHANGE ACTIVITY - NONE                                   @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  1513
*DATES:                                                            1513
*   PROC;                           /*                       @Z40LB35*/
*                                                                  1513
DATES    STM   @14,@12,@SA00020                                    1513
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATION FOR DATES PROCEDURE                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1514
*   DCL                                                            1514
*     TIMEVAR CHAR(8);              /* TIME VARIABLE - UTIME @Z40LB35
*                                      USED IN UTIME CALL    @Z40LB35*/
*   DCL                                                            1515
*     1 DATEVAR CHAR(4),            /* DATE VARIABLE - UTIME @Z40LB35*/
*      2 * CHAR(1),                 /* FILLER - RESERVED     @Z40LB35*/
*      2 DATEPACK CHAR(3);          /* DATE RETURN - PACKED  @Z40LB35
*                                      DECIMAL FORMAT        @Z40LB35*/
*                                                                  1515
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE IS THE DATE RETURNED          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1516
*   DCL                                                            1516
*     1 CONVDATE BDY(WORD) BASED(DATRETRN),                        1516
*      2 CONVYEAR FIXED(15),        /* YEAR - RANGE 0 - 99   @Z40LB35*/
*      2 CONVDAYS FIXED(15);        /* DAYS - RANGE 0 - 999  @Z40LB35*/
*                                                                  1516
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING DECLARES ARE INTERNAL FIELDS            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1517
*   DCL                                                            1517
*     DATEBIN FIXED(31);            /* USED TO UNPACK DATE   @Z40LB35*/
*   DCL                                                            1518
*     QUITSW BIT(1);                /* USED TO CONTROL LOOPS @Z40LB35*/
*   DCL                                                            1519
*     ADJDAYS FIXED(31);            /* USED TO ADJUST DAYS   @Z40LB35*/
*                                                                  1519
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ARE STATIC CONSTANTS                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1520
*   DCL                                                            1520
*     REGYEAR FIXED(15) INIT(365);  /*                       @Z40LB35
*                                      NUM DAYS IN REG YEAR  @Z40LB35*/
*   DCL                                                            1521
*     LEAPYEAR FIXED(15) INIT(366); /*                       @Z40LB35
*                                      NUM DAYS IN LEAP YEAR @Z40LB35*/
*   DCL                                                            1522
*     MAXYEAR FIXED(15) INIT(99);   /*                       @Z40LB35
*                                      HIGHEST YEAR          @Z40LB35*/
*   DCL                                                            1523
*     MAXDAYS FIXED(15) INIT(999);  /*                       @Z40LB35
*                                      HIGHEST DAYS          @Z40LB35*/
*   DCL                                                            1524
*     MINYEAR FIXED(15) INIT(0);    /*                       @Z40LB35
*                                      LOWEST YEAR           @Z40LB35*/
*   DCL                                                            1525
*     MINDAYS FIXED(15) INIT(0);    /*                       @Z40LB35
*                                      LOWEST DAYS           @Z40LB35*/
*   DCL                                                            1526
*     NOREMAIN FIXED(15) INIT(0);   /*                       @Z40LB35
*                                      NO REMAINDER AFTER DIV      1526
*                                                            @Z40LB35*/
*                                                                  1527
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THIS PROCEDURE                   @Z40LB35*/
*   /* HERE INITIALIZATION TAKES PLACE.                      @Z40LB35*/
*   /* THE PARM LIST HEADER IS INITIALIZED,                  @Z40LB35*/
*   /* THE TRACE POINT 'DTST' IS RECORDED, AND               @Z40LB35*/
*   /* THE DATE IS SET TO ZERO.                              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1527
*   OLDERID2=NEWERID2;                                             1527
         L     @15,@PC00001                                        1527
         L     @14,GDTTR2(,@15)                                    1527
         MVC   @TS00001(95),NEWERID2(@14)                          1527
         MVC   OLDERID2(95,@14),@TS00001                           1527
*   NEWID2='DTST';                  /*                       @Z40LB35*/
         MVC   NEWID2(4,@14),@CC01733                              1528
*   DATHEAD='DATESAGL';             /*                       @Z40LB35*/
         LA    @14,DTSAREA                                         1529
         MVC   DATHEAD(8,@14),@CC01734                             1529
*   CONVDATE=0;                     /*                       @Z40LB35*/
*                                                                  1530
         L     @01,DATRETRN(,@14)                                  1530
         SLR   @00,@00                                             1530
         ST    @00,CONVDATE(,@01)                                  1530
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF CALLER WANTS THE CURRENT DATE            @Z40LB35*/
*   /* ADJUSTED WITH DAYS ADD OR SUBTRACTED.                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1531
*   IF DATDAYOP=ON THEN                                            1531
         TM    DATDAYOP(@14),B'00010000'                           1531
         BNO   @RF01531                                            1531
*     DO;                           /*                       @Z40LB35*/
*                                                                  1532
*       /*************************************************************/
*       /*                                                           */
*       /* IF CALLER WANTS TO ADJUST CURRENT DATE,           @Z40LB35*/
*       /* ISSUE UTIME TO RETRIEVE CURRENT DATE,             @Z40LB35*/
*       /* CONVERT THE DATE FROM PACKED DECIMAL TO           @Z40LB35*/
*       /* BINARY, AND SEPARATE THE YEARS FROM THE           @Z40LB35*/
*       /* DAYS.                                             @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1533
*       ADJDAYS=DATDAYS;            /*                       @Z40LB35*/
         L     ADJDAYS,DATDAYS(,@14)                               1533
*       CALL IDCSATI0(GDTTBL,TIMEVAR,DATEVAR);/*             @Z40LB35*/
         ST    @15,@AL00001                                        1534
         LA    @14,TIMEVAR                                         1534
         ST    @14,@AL00001+4                                      1534
         LA    @14,DATEVAR                                         1534
         ST    @14,@AL00001+8                                      1534
         MVI   @AL00001+8,X'80'                                    1534
         L     @15,GDTTIM(,@15)                                    1534
         LA    @01,@AL00001                                        1534
         BALR  @14,@15                                             1534
*       CVB(DATEBIN,DATEPACK);      /*                       @Z40LB35*/
         XC    @TS00001(8),@TS00001                                1535
         MVC   @TS00001+5(3),DATEPACK                              1535
         CVB   DATEBIN,@TS00001                                    1535
*       CONVYEAR=DATEBIN/1000;      /*                       @Z40LB35*/
         LA    @15,DTSAREA                                         1536
         L     @14,DATRETRN(,@15)                                  1536
         LA    @07,1000                                            1536
         LR    @00,DATEBIN                                         1536
         SRDA  @00,32                                              1536
         DR    @00,@07                                             1536
         STH   @01,CONVYEAR(,@14)                                  1536
*       CONVDAYS=DATEBIN-(CONVYEAR*1000);/*                  @Z40LB35*/
*                                                                  1537
         MR    @00,@07                                             1537
         LCR   @01,@01                                             1537
         ALR   @01,DATEBIN                                         1537
         STH   @01,CONVDAYS(,@14)                                  1537
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE QUITSW OFF FOR LOOP CONTROL            @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1538
*       QUITSW=OFF;                 /*                       @Z40LB35*/
*                                                                  1538
         NI    QUITSW,B'01111111'                                  1538
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF CALLER WANTS DAYS ADDED TO           @Z40LB35*/
*       /* CURRENT DATE.                                     @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1539
*       IF DATADD=ON THEN                                          1539
*                                                                  1539
         TM    DATADD(@15),B'10000000'                             1539
         BNO   @RF01539                                            1539
*         /***********************************************************/
*         /*                                                         */
*         /* IF CALLER WANTS DAYS ADDED, LOOP THOUGH         @Z40LB35*/
*         /* THE FOLLOWING DO LOOP UNTIL QUITSW IS SET       @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1540
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/
*                                                                  1540
         B     @DE01540                                            1540
@DL01540 DS    0H                                                  1541
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1541
*           IF CONVYEAR//4=NOREMAIN THEN                           1541
*                                                                  1541
         LA    @03,DTSAREA                                         1541
         L     @03,DATRETRN(,@03)                                  1541
         LH    @15,CONVYEAR(,@03)                                  1541
         LR    @00,@15                                             1541
         SRDA  @00,32                                              1541
         D     @00,@CF00043                                        1541
         CH    @00,NOREMAIN                                        1541
         BNE   @RF01541                                            1541
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */
*             /*                                             @Z40LB35*/
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1542
*             IF(ADJDAYS+CONVDAYS)>LEAPYEAR THEN                   1542
*                                                                  1542
         LH    @14,LEAPYEAR                                        1542
         LR    @07,ADJDAYS                                         1542
         AH    @07,CONVDAYS(,@03)                                  1542
         CR    @07,@14                                             1542
         BNH   @RF01542                                            1542
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1543
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/
         SLR   ADJDAYS,@14                                         1544
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/
         AL    @15,@CF00222                                        1545
         STH   @15,CONVYEAR(,@03)                                  1545
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1547
*                                                                  1547
*               /*****************************************************/
*               /*                                                   */
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/
*               /* OF DO LOOP                                @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1547
*               DO;                 /*                       @Z40LB35*/
         B     @RC01542                                            1547
@RF01542 DS    0H                                                  1548
*                 CONVDAYS=ADJDAYS+CONVDAYS;/*               @Z40LB35*/
         LA    @03,DTSAREA                                         1548
         L     @03,DATRETRN(,@03)                                  1548
         LR    @15,ADJDAYS                                         1548
         AH    @15,CONVDAYS(,@03)                                  1548
         STH   @15,CONVDAYS(,@03)                                  1548
*                 QUITSW=ON;        /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1549
*               END;                /*                       @Z40LB35*/
*           ELSE                                                   1551
*                                                                  1551
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */
*             /*                                             @Z40LB35*/
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1551
*             IF(ADJDAYS+CONVDAYS)>REGYEAR THEN                    1551
*                                                                  1551
         B     @RC01541                                            1551
@RF01541 LH    @03,REGYEAR                                         1551
         LA    @15,DTSAREA                                         1551
         L     @15,DATRETRN(,@15)                                  1551
         LR    @14,ADJDAYS                                         1551
         AH    @14,CONVDAYS(,@15)                                  1551
         CR    @14,@03                                             1551
         BNH   @RF01551                                            1551
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1552
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/
         SLR   ADJDAYS,@03                                         1553
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/
         LA    @03,1                                               1554
         AH    @03,CONVYEAR(,@15)                                  1554
         STH   @03,CONVYEAR(,@15)                                  1554
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1556
*                                                                  1556
*               /*****************************************************/
*               /*                                                   */
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/
*               /* OF DO LOOP                                @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1556
*               DO;                 /*                       @Z40LB35*/
         B     @RC01551                                            1556
@RF01551 DS    0H                                                  1557
*                 CONVDAYS=CONVDAYS+ADJDAYS;/*               @Z40LB35*/
         LA    @03,DTSAREA                                         1557
         L     @03,DATRETRN(,@03)                                  1557
         LR    @15,ADJDAYS                                         1557
         AH    @15,CONVDAYS(,@03)                                  1557
         STH   @15,CONVDAYS(,@03)                                  1557
*                 QUITSW=ON;        /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1558
*               END;                /*                       @Z40LB35*/
*         END;                      /*                       @Z40LB35*/
@RC01551 DS    0H                                                  1560
@RC01541 DS    0H                                                  1560
@DE01540 TM    QUITSW,B'10000000'                                  1560
         BZ    @DL01540                                            1560
*                                                                  1561
*       /*************************************************************/
*       /*                                                           */
*       /* IF DAYS ARE TO BE SUBTRACTED FROM CURRENT,        @Z40LB35*/
*       /* DO THE FOLLOWING DO GROUP                         @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1561
*       ELSE                                                       1561
*                                                                  1561
*         /***********************************************************/
*         /*                                                         */
*         /* DO THE FOLLOWING WHILE THE QUITSW IS NOT SET    @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1561
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/
*                                                                  1561
         B     @RC01539                                            1561
@RF01539 B     @DE01561                                            1561
@DL01561 DS    0H                                                  1562
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1562
*           IF(CONVYEAR-1)//4=NOREMAIN THEN                        1562
*                                                                  1562
         LA    @03,DTSAREA                                         1562
         L     @03,DATRETRN(,@03)                                  1562
         LH    @15,CONVYEAR(,@03)                                  1562
         BCTR  @15,0                                               1562
         LR    @00,@15                                             1562
         SRDA  @00,32                                              1562
         D     @00,@CF00043                                        1562
         CH    @00,NOREMAIN                                        1562
         BNE   @RF01562                                            1562
*             /*******************************************************/
*             /*                                                     */
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1563
*             IF ADJDAYS>=LEAPYEAR THEN                            1563
*                                                                  1563
         LH    @14,LEAPYEAR                                        1563
         CR    ADJDAYS,@14                                         1563
         BL    @RF01563                                            1563
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1564
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/
         SLR   ADJDAYS,@14                                         1565
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/
         STH   @15,CONVYEAR(,@03)                                  1566
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1568
*                                                                  1568
*               /*****************************************************/
*               /*                                                   */
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1568
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1568
*                                                                  1568
         B     @RC01563                                            1568
@RF01563 LA    @03,DTSAREA                                         1568
         L     @03,DATRETRN(,@03)                                  1568
         LH    @15,CONVDAYS(,@03)                                  1568
         LR    @14,@15                                             1568
         SLR   @14,ADJDAYS                                         1568
         LTR   @14,@14                                             1568
         BP    @RF01568                                            1568
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */
*                 /*                                         @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1569
*                 DO;               /*                       @Z40LB35*/
*                   CONVDAYS=CONVDAYS+LEAPYEAR-ADJDAYS;            1570
         AH    @15,LEAPYEAR                                        1570
         SLR   @15,ADJDAYS                                         1570
         STH   @15,CONVDAYS(,@03)                                  1570
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/
         LH    @15,CONVYEAR(,@03)                                  1571
         BCTR  @15,0                                               1571
         STH   @15,CONVYEAR(,@03)                                  1571
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1572
*                 END;              /*                       @Z40LB35*/
*               ELSE                                               1574
*                                                                  1574
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */
*                 /*                                         @Z40LB35*/
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1574
*                 DO;               /*                       @Z40LB35*/
         B     @RC01568                                            1574
@RF01568 DS    0H                                                  1575
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/
         LA    @03,DTSAREA                                         1575
         L     @03,DATRETRN(,@03)                                  1575
         LH    @15,CONVDAYS(,@03)                                  1575
         SLR   @15,ADJDAYS                                         1575
         STH   @15,CONVDAYS(,@03)                                  1575
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1576
*                 END;              /*                       @Z40LB35*/
*                                                                  1577
*           /*********************************************************/
*           /*                                                       */
*           /* ELSE THIS IS A NORMAL YEAR(NON-LEAP YEAR)     @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1578
*           ELSE                                                   1578
*                                                                  1578
*             /*******************************************************/
*             /*                                                     */
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1578
*             IF ADJDAYS>=REGYEAR THEN                             1578
*                                                                  1578
         B     @RC01562                                            1578
@RF01562 LH    @03,REGYEAR                                         1578
         CR    ADJDAYS,@03                                         1578
         BL    @RF01578                                            1578
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1579
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/
         SLR   ADJDAYS,@03                                         1580
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/
         LA    @03,DTSAREA                                         1581
         L     @03,DATRETRN(,@03)                                  1581
         LH    @15,CONVYEAR(,@03)                                  1581
         BCTR  @15,0                                               1581
         STH   @15,CONVYEAR(,@03)                                  1581
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1583
*                                                                  1583
*               /*****************************************************/
*               /*                                                   */
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1583
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1583
*                                                                  1583
         B     @RC01578                                            1583
@RF01578 LA    @03,DTSAREA                                         1583
         L     @03,DATRETRN(,@03)                                  1583
         LH    @15,CONVDAYS(,@03)                                  1583
         LR    @14,@15                                             1583
         SLR   @14,ADJDAYS                                         1583
         LTR   @14,@14                                             1583
         BP    @RF01583                                            1583
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */
*                 /*                                         @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1584
*                 DO;               /*                       @Z40LB35*/
*                   CONVDAYS=CONVDAYS+REGYEAR-ADJDAYS;             1585
         AH    @15,REGYEAR                                         1585
         SLR   @15,ADJDAYS                                         1585
         STH   @15,CONVDAYS(,@03)                                  1585
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/
         LH    @15,CONVYEAR(,@03)                                  1586
         BCTR  @15,0                                               1586
         STH   @15,CONVYEAR(,@03)                                  1586
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1587
*                 END;              /*                       @Z40LB35*/
*               ELSE                                               1589
*                                                                  1589
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */
*                 /*                                         @Z40LB35*/
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1589
*                 DO;               /*                       @Z40LB35*/
         B     @RC01583                                            1589
@RF01583 DS    0H                                                  1590
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/
         LA    @03,DTSAREA                                         1590
         L     @03,DATRETRN(,@03)                                  1590
         LH    @15,CONVDAYS(,@03)                                  1590
         SLR   @15,ADJDAYS                                         1590
         STH   @15,CONVDAYS(,@03)                                  1590
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1591
*                 END;              /*                       @Z40LB35*/
*         END;                      /*                       @Z40LB35*/
@RC01583 DS    0H                                                  1593
@RC01578 DS    0H                                                  1593
@RC01562 DS    0H                                                  1593
@DE01561 TM    QUITSW,B'10000000'                                  1593
         BZ    @DL01561                                            1593
*     END;                          /*                       @Z40LB35*/
@RC01539 DS    0H                                                  1595
*                                                                  1595
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THE CALLER WANTS THE DATE                @Z40LB35*/
*   /* CONVERTED                                             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1595
*   IF DATDTEOP=ON THEN                                            1595
*                                                                  1595
@RF01531 LA    @15,DTSAREA                                         1595
         TM    DATDTEOP(@15),B'00100000'                           1595
         BNO   @RF01595                                            1595
*     /***************************************************************/
*     /*                                                             */
*     /* IF CALLER WANTS DATE CONVERTED, CONVERT THE         @Z40LB35*/
*     /* DATE BY SEPARATING THE YEARS FROM THE DAYS          @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1596
*     DO;                           /*                       @Z40LB35*/
*       CONVYEAR=DATDATE/1000;      /*                       @Z40LB35*/
         L     @14,DATRETRN(,@15)                                  1597
         LA    @07,1000                                            1597
         L     @15,DATDATE(,@15)                                   1597
         LR    @00,@15                                             1597
         SRDA  @00,32                                              1597
         DR    @00,@07                                             1597
         STH   @01,CONVYEAR(,@14)                                  1597
*       CONVDAYS=DATDATE-(CONVYEAR*1000);/*                  @Z40LB35*/
         MR    @00,@07                                             1598
         SLR   @15,@01                                             1598
         STH   @15,CONVDAYS(,@14)                                  1598
*     END;                          /*                       @Z40LB35*/
*                                                                  1599
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION WILL BE MADE TO SEE            @Z40LB35*/
*   /* IF THE LIMITS ARE VIOLATED                            @Z40LB35*/
*   /* IF SO, FORCE THE DATE TO FALL WITHIN THE              @Z40LB35*/
*   /* LIMITS (0 99999)                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1600
*   IF CONVYEAR>MAXYEAR THEN                                       1600
@RF01595 LH    @15,MAXYEAR                                         1600
         LA    @14,DTSAREA                                         1600
         L     @14,DATRETRN(,@14)                                  1600
         CH    @15,CONVYEAR(,@14)                                  1600
         BNL   @RF01600                                            1600
*     DO;                           /*                       @Z40LB35*/
*       CONVYEAR=MAXYEAR;           /*                       @Z40LB35*/
         STH   @15,CONVYEAR(,@14)                                  1602
*       CONVDAYS=MAXDAYS;           /*                       @Z40LB35*/
         LH    @15,MAXDAYS                                         1603
         STH   @15,CONVDAYS(,@14)                                  1603
*     END;                          /*                       @Z40LB35*/
*   ELSE                                                           1605
*     IF CONVYEAR<MINYEAR×CONVDAYS<MINDAYS THEN                    1605
         B     @RC01600                                            1605
@RF01600 LA    @15,DTSAREA                                         1605
         L     @15,DATRETRN(,@15)                                  1605
         LH    @14,CONVYEAR(,@15)                                  1605
         CH    @14,MINYEAR                                         1605
         BL    @RT01605                                            1605
         LH    @15,CONVDAYS(,@15)                                  1605
         CH    @15,MINDAYS                                         1605
         BNL   @RF01605                                            1605
@RT01605 DS    0H                                                  1606
*       DO;                         /*                       @Z40LB35*/
*         CONVYEAR=MINYEAR;         /*                       @Z40LB35*/
         LA    @15,DTSAREA                                         1607
         L     @15,DATRETRN(,@15)                                  1607
         LH    @14,MINYEAR                                         1607
         STH   @14,CONVYEAR(,@15)                                  1607
*         CONVDAYS=MINDAYS;         /*                       @Z40LB35*/
         LH    @14,MINDAYS                                         1608
         STH   @14,CONVDAYS(,@15)                                  1608
*       END;                        /*                       @Z40LB35*/
*                                                                  1609
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER WITH RETURN CODE ZERO                @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1610
*   IF GDTDBG=NULLPTR THEN                                         1610
@RF01605 DS    0H                                                  1610
@RC01600 L     @15,@PC00001                                        1610
         L     @15,GDTDBG(,@15)                                    1610
         LTR   @15,@15                                             1610
         BZ    @RT01610                                            1610
*     ;                                                            1611
*   ELSE                                                           1612
*     CALL IDCDB010(GDTTBL,'DTND'); /*                       @Z40LB35*/
         L     @15,@PC00001                                        1612
         ST    @15,@AL00001                                        1612
         LA    @14,@CC01737                                        1612
         ST    @14,@AL00001+4                                      1612
         MVI   @AL00001+4,X'80'                                    1612
         L     @15,GDTDBG(,@15)                                    1612
         LA    @01,@AL00001                                        1612
         BALR  @14,@15                                             1612
*   RETURN CODE(0);                 /*                       @Z40LB35*/
@RT01610 SLR   @15,@15                                             1613
         L     @14,@SA00020                                        1613
         LM    @00,@12,@SA00020+8                                  1613
         BR    @14                                                 1613
*   END DATES;                      /*                       @Z40LB35*/
*                                                                  1615
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1615
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1615
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00021                                    1615
         MVC   @PC00021(8),0(@01)                                  1615
*                                   /*                       @Y30LB39*/
*                                                                  1616
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1616
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1616
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1616
*                                   /*                       @Y30LB39*/
*   DCL                                                            1616
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1617
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1617
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1618
*                                   /*                       @Y30LB39*/
*   DCL                                                            1618
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1619
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1619
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1620
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1620
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1620
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1621
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1621
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1621
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1622
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1622
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1622
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1623
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1623
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1623
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1624
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1624
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1625
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1625
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1625
         L     @15,@PC00001                                        1625
         L     @14,GDTTR2(,@15)                                    1625
         MVC   @TS00001(95),NEWERID2(@14)                          1625
         MVC   OLDERID2(95,@14),@TS00001                           1625
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1626
         MVC   NEWID2(4,@14),@CC01757                              1626
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1627
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1627
         LA    @14,SSDRGLT                                         1627
         ST    @14,SSDLPTR                                         1627
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1628
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1628
         L     @07,@PC00021                                        1628
         L     @07,SSRCODE(,@07)                                   1628
         LTR   @07,@07                                             1628
         BNP   @RF01628                                            1628
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1629
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1630
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1630
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1631
         ST    @03,DARGRETP(,@14)                                  1631
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            1632
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 1633
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1634
         MVC   DARGRETL(2,@14),@CH01766                            1634
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1635
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1635
         ST    @15,@AL00001                                        1635
         LA    @03,@CF00117                                        1635
         ST    @03,@AL00001+4                                      1635
         LA    @03,SSDLPTR                                         1635
         ST    @03,@AL00001+8                                      1635
         MVI   @AL00001+8,X'80'                                    1635
         L     @15,GDTPRT(,@15)                                    1635
         LA    @01,@AL00001                                        1635
         BALR  @14,@15                                             1635
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1636
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1636
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   1637
@DL01637 DS    0H                                                  1638
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00222                                   1638
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1639
@DE01637 L     @03,@PC00021                                        1639
         LR    @15,ENTRYNUM                                        1639
         ALR   @15,@15                                             1639
         LH    @15,SSARRAY-2(@15)                                  1639
         CH    @15,SSRHALF(,@03)                                   1639
         BE    @DC01637                                            1639
         SLR   @14,@14                                             1639
         CR    @15,@14                                             1639
         BNE   @DL01637                                            1639
@DC01637 DS    0H                                                  1640
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1640
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1640
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @07,SSDLPTR                                         1641
         MVC   DARGSMOD(3,@07),SSMODSS0                            1641
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@07)                             1642
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             1643
         BNE   @RF01643                                            1643
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@07)                                   1645
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@07),@CH00043                             1646
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1649
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1649
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01628                                            1649
@RF01628 DS    0H                                                  1650
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1650
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         1651
         MVC   DARGSMOD(3,@15),SSMODCM0                            1651
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            1652
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00021+4                                      1653
         ST    @14,DARGDBP(,@15)                                   1653
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00222                             1654
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1655
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1656
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1656
@RC01628 L     @15,@PC00001                                        1656
         ST    @15,@AL00001                                        1656
         LA    @14,@CF00117                                        1656
         ST    @14,@AL00001+4                                      1656
         LA    @14,SSDLPTR                                         1656
         ST    @14,@AL00001+8                                      1656
         MVI   @AL00001+8,X'80'                                    1656
         L     @15,GDTPRT(,@15)                                    1656
         LA    @01,@AL00001                                        1656
         BALR  @14,@15                                             1656
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1657
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1657
         L     @14,@SA00021                                        1657
         LM    @00,@12,@SA00021+8                                  1657
         BR    @14                                                 1657
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCLD01                     /*                       @Z40LB26*/
*                                                                  1659
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSLD )                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IDCDF54 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF55 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  1659
*       ;                                                          1659
@DATA    DS    0H
@CH00298 DC    H'5'
@CH00159 DC    H'6'
@CH00519 DC    H'7'
@CH00182 DC    H'8'
@CH00037 DC    H'10'
@CH00279 DC    H'20'
@CH01278 DC    H'30'
@CH01703 DC    H'40'
@CH01448 DC    H'50'
@CH01464 DC    H'60'
@CH01501 DC    H'66'
@CH01704 DC    H'70'
@CH01766 DC    H'120'
@CH01473 DC    H'121'
@CH01762 DC    H'164'
@CH01761 DC    H'224'
@SC01788 CLC   SRTELEM(0,@14),SRTELEM(@15)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00020 DS    15F
@SA00002 DS    1F
@SA00003 DS    1F
@SA00004 DS    1F
@SA00005 DS    1F
@SA00006 DS    1F
@SA00019 DS    1F
@SA00008 DS    1F
@SA00011 DS    1F
@SA00021 DS    15F
@PC00021 DS    2F
@SA00007 DS    1F
@SA00009 DS    1F
@SA00010 DS    15F
@PC00010 DS    1F
@SA00012 DS    1F
@SA00014 DS    1F
@SA00013 DS    1F
@SA00016 DS    1F
@SA00015 DS    1F
@SA00017 DS    1F
@SA00018 DS    1F
@AL00001 DS    4A
@TF00001 DS    F
@TF00002 DS    F
IDCLD01  CSECT
         DS    0F
@CF00117 DC    F'0'
@CF00222 DC    F'1'
@CH00222 EQU   @CF00222+2
@CF00156 DC    F'2'
@CH00156 EQU   @CF00156+2
@CF00165 DC    F'3'
@CF00043 DC    F'4'
@CH00043 EQU   @CF00043+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00849 DC    F'44'
@CF01764 DC    F'80'
@CH01764 EQU   @CF01764+2
@CF01408 DC    F'9999'
@CF01787 DC    F'-81'
@CF01790 DC    F'-80'
@CF01792 DC    F'-64'
@CF01791 DC    F'-16'
@CF01782 DC    F'-7'
@CF01781 DC    F'-5'
@CF01653 DC    F'-1'
@CF01517 DC    XL4'0208'
@CF01519 DC    XL4'0223'
@CF01521 DC    XL4'0224'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
RVVIPTR  DS    A
GROUPPTR DS    A
PRINTIT  DS    A
LISTADDR DS    A
EXPDATE  DS    F
CREDATE  DS    F
ADDRUCB  DS    A
FILEUCB  DS    A
VVICODE  DS    F
VVICODE2 DS    F
VOLPTR   DS    A
SRTMAXCT DS    F
SSDLPTR  DS    A
LISTPTR  DS    A
TOTALTRK DS    H
INDEX    DS    H
SETRC    DS    H
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
         DS    CL1
PCARG    DS    CL33
         ORG   PCARG
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    AL1
         ORG   PCARG+33
VOLREC   DS    CL224
GRPREC   DS    CL164
         DS    CL3
ALOCAREA DS    CL31
         DS    CL1
DARGAREA DS    CL76
SLTAREA  DS    CL23
         DS    CL1
CHKAREA  DS    CL29
         DS    CL3
DTSAREA  DS    CL21
         DS    CL3
VOLRVVI  DS    CL68
GRPRVVI  DS    CL68
OPNAREA  DS    BL48
SORTAREA DS    CL32
AREAVS3  DS    CL59
         DS    CL1
PCRST    DS    CL8
         ORG   PCRST
PCRSST   DS    CL2
PCRSTLC  DS    FL2
PCRSTLP  DS    AL4
         ORG   PCRST+8
COMFLAGS DS    CL1
         ORG   COMFLAGS
ONEDONE  DS    BL1
RDERROR  EQU   COMFLAGS+0
EOFILE   EQU   COMFLAGS+0
NOVOLS   EQU   COMFLAGS+0
EMPTYGRP EQU   COMFLAGS+0
@NM00107 EQU   COMFLAGS+0
         ORG   COMFLAGS+1
INTERFLG DS    BL1
         ORG   INTERFLG
ALOCFLG  DS    BL1
INITVS3  EQU   INTERFLG+0
NOINITSW EQU   INTERFLG+0
@NM00108 EQU   INTERFLG+0
         ORG   INTERFLG+1
SORTWORK DS    CL80
HOLD4CHR DS    CL4
OLDGROUP DS    CL8
DDNAME   DS    CL8
UNITLIST DS    CL12
         ORG   UNITLIST
UNITCNT  DS    FL2
UNITLNG  DS    FL2
UNITNAME DS    CL8
         ORG   UNITLIST+12
VOLLIST  DS    CL10
         ORG   VOLLIST
VOLCOUNT DS    FL2
VOLLNG   DS    FL2
VOLNAME  DS    CL6
         ORG   VOLLIST+10
STGRPUSE DS    CL121
         ORG   STGRPUSE
CARCONT1 DS    CL1
@NM00109 DS    CL46
GRPUSE   DS    CL8
@NM00110 DS    CL10
GVOLUSE  DS    CL6
FILL1    DS    CL50
         ORG   STGRPUSE+121
         DS    CL3
STGRPSTA DS    CL121
         ORG   STGRPSTA
CARCONT2 DS    CL1
@NM00111 DS    CL43
GRPSTAT  DS    CL8
@NM00112 DS    CL10
GVOLSTAT DS    CL6
FILL2    DS    CL53
         ORG   STGRPSTA+121
         DS    CL3
STVOLUSE DS    CL121
         ORG   STVOLUSE
CARCONT3 DS    CL1
@NM00113 DS    CL54
VOLUSE   DS    CL6
FILL3    DS    CL60
         ORG   STVOLUSE+121
         DS    CL3
STVOLSTA DS    CL121
         ORG   STVOLSTA
CARCONT4 DS    CL1
@NM00114 DS    CL52
VOLSTAT  DS    CL6
FILL4    DS    CL62
         ORG   STVOLSTA+121
STLGND   DS    CL121
         DS    CL2
PRINTCON DS    CL66
         ORG   PRINTCON
DASHV    DS    CL2
DASHC    DS    CL2
RDWRITE  DS    CL4
WRITE    DS    CL4
NOCAT    DS    CL3
ERROR    DS    CL3
PARTORG  DS    CL3
PHYSEQ   DS    CL3
UNKN     DS    CL3
DIRACC   DS    CL3
INDSEQ   DS    CL3
UNMOVE   DS    CL1
CYLINDER DS    CL5
TRACK    DS    CL5
BLOCK    DS    CL5
ABSOLUTE DS    CL5
PROTRACF DS    CL4
PROTRFR  DS    CL4
PROTRFW  DS    CL4
         ORG   PRINTCON+66
SRTSTOP  DS    BL1
SRTMOVE  DS    BL1
TIMEVAR  DS    CL8
DATEVAR  DS    CL4
         ORG   DATEVAR
@NM00118 DS    CL1
DATEPACK DS    CL3
         ORG   DATEVAR+4
QUITSW   DS    BL1
SSDRGLT  DS    CL20
         DS    CL3
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCLD01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
REGYEAR  DC    H'365'
LEAPYEAR DC    H'366'
MAXYEAR  DC    H'99'
MAXDAYS  DC    H'999'
MINYEAR  DC    H'0'
MINDAYS  DC    H'0'
NOREMAIN DC    H'0'
SSMSGNUM DC    AL1(56)
@CC01624 DC    C'IDCVS03 '
@CC01651 DC    C'SRTAGL  '
@CC01734 DC    C'DATESAGL'
@CC01513 DC    C'3330V'
@CC01376 DC    C'LD01'
@CC01511 DC    C'LD00'
@CC01564 DC    C'LDST'
@CC01586 DC    C'LDED'
@CC01590 DC    C'LDSV'
@CC01597 DC    C'LDSG'
@CC01602 DC    C'LDNG'
@CC01606 DC    C'LDAG'
@CC01610 DC    C'LDAV'
@CC01614 DC    C'LDRG'
@CC01618 DC    C'LDCK'
@CC01623 DC    C'LDSL'
@CC01649 DC    C'SORT'
@CC01650 DC    C'SOTI'
@CC01655 DC    C'SOTO'
@CC01659 DC    C'LDPV'
@CC01668 DC    C'LDAL'
@CC01678 DC    C'LDGH'
@CC01682 DC    C'LDVH'
@CC01686 DC    C'LDSR'
@CC01693 DC    C'LDUR'
@CC01698 DC    C'LDSS'
@CC01702 DC    C'LDUS'
@CC01708 DC    C'LDLG'
@CC01733 DC    C'DTST'
@CC01737 DC    C'DTND'
@CC01757 DC    C'SSAA'
@CC01475 DC    C'CM0'
@CC01477 EQU   @CC01376
@CC01479 DC    C'UV0'
@CC01523 DC    C'ST'
@CB01515 DC    X'30582009'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODIFYC  DC    CL8'MODIFYC '
MODID    DC    CL4'LD01'
FIXAREA  DS    CL600
         ORG   FIXAREA
@NM00115 DC    250X'00'
@NM00116 DC    250X'00'
@NM00117 DC    100X'00'
         ORG   FIXAREA+600
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
ADJDAYS  EQU   @02
DATEBIN  EQU   @03
SRTJ     EQU   @02
SRTI     EQU   @05
SRTEND   EQU   @07
SRTBEG   EQU   @04
SRTLN    EQU   @02
SRTWPTR  EQU   @06
SRTPTR   EQU   @03
CC04     EQU   @02
CC03     EQU   @06
CC02     EQU   @07
CC01     EQU   @04
SUPCNT   EQU   @03
BASEVPTR EQU   @05
ELEMENT  EQU   @02
OPNPTR   EQU   @04
TESTRC   EQU   @03
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
RACFAGL  EQU   0
RACFFLG1 EQU   RACFAGL
RACFFLG2 EQU   RACFAGL+1
RACFFLG3 EQU   RACFAGL+2
RACFFLG4 EQU   RACFAGL+3
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00017 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTOT EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
AMSTP044 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGREP  EQU   DARGINS
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00074 EQU   SV82LIST+4
SV82DCBP EQU   @NM00074
@NM00075 EQU   SV82LIST+12
SV82WRKP EQU   @NM00075
SRTAGL   EQU   0
SRTHEAD  EQU   SRTAGL
SRTADDR  EQU   SRTAGL+8
SRTNUM   EQU   SRTAGL+12
SRTLEN   EQU   SRTAGL+16
SRTPOSIT EQU   SRTAGL+20
SRTFLDLN EQU   SRTAGL+24
SRTWORKP EQU   SRTAGL+28
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELUCBP  EQU   SELAGL+8
SELDDNP  EQU   SELAGL+12
SELVOL   EQU   SELAGL+16
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATHEAD  EQU   DATESAGL
DATDATE  EQU   DATESAGL+8
DATDAYS  EQU   DATESAGL+12
DATRETRN EQU   DATESAGL+16
DATESOPT EQU   DATESAGL+20
DATADD   EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATDAYOP EQU   DATESOPT
VS3AGL   EQU   0
VS3LISTP EQU   VS3AGL+8
VS3LEVP  EQU   VS3AGL+16
VS3LEVLN EQU   VS3AGL+20
VS3AST   EQU   VS3AGL+22
VS3EXPIR EQU   VS3AGL+24
VS3CREAT EQU   VS3AGL+28
VS3UCBP  EQU   VS3AGL+32
VS3DEV   EQU   VS3AGL+36
VS3POOL  EQU   VS3AGL+40
VS3VOL   EQU   VS3AGL+44
VS3DD    EQU   VS3AGL+50
VS3FLAGS EQU   VS3AGL+58
VS3STAT  EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VSDVTOC  EQU   0
VSDFRCYL EQU   VSDVTOC+6
VSDFRTRK EQU   VSDVTOC+11
VSDFREXT EQU   VSDVTOC+16
VSDFRCCL EQU   VSDVTOC+21
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDVTOCC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDFLG2  EQU   VSDSTAT+17
VSDPWR   EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDRACF  EQU   VSDFLG2
VSDCRE   EQU   VSDSTAT+18
VSDEXP   EQU   VSDSTAT+20
VSDCAT   EQU   VSDSTAT+22
VSDPRTC  EQU   VSDSTAT+25
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDTRKS  EQU   VSDUSAGE
VSDFTRK  EQU   VSDUSAGE+2
VSDSECAL EQU   VSDUSAGE+4
VSDDORG  EQU   VSDUSAGE+9
VSDOPO   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDALLOC EQU   VSDUSAGE+10
VSDACYL  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDUSEF  EQU   VSDUSAGE+11
VSDCALFR EQU   VSDUSEF
VSDSCAL  EQU   VSDUSAGE+12
VSDDSORG EQU   VSDUSAGE+16
VSDDSOR3 EQU   VSDDSORG+2
VSDALLC  EQU   VSDUSAGE+19
VSDFREE  EQU   VSDUSAGE+24
VSDBLOCK EQU   0
VSDELEM  EQU   VSDBLOCK
VSDVTOCS EQU   VSDBLOCK+4
VSDFMT0  EQU   VSDBLOCK+8
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVOLCT EQU   VSDARRAY
VSDDSN   EQU   VSDARRAY+4
VSDVARY  EQU   VSDARRAY+48
VOL      EQU   0
VOLCNT   EQU   VOL
@NM00094 EQU   VOL+2
VOLVAL   EQU   @NM00094+1
GRP      EQU   0
GRPCNT   EQU   GRP
@NM00095 EQU   GRP+2
GRPVAL   EQU   @NM00095+1
AVOL     EQU   0
AGRP     EQU   0
NGRPD    EQU   0
GENER    EQU   0
LEVEL    EQU   0
LEVELPOS EQU   LEVEL+9
LEVELFLG EQU   LEVEL+10
LEVELLEN EQU   LEVEL+20
LEVELVAL EQU   LEVEL+21
UNCAT    EQU   0
EXPDT    EQU   0
EXPDTVAL EQU   EXPDT
EXPIR    EQU   0
EXPIRVAL EQU   EXPIR
CREDT    EQU   0
CREDTVAL EQU   CREDT
CREAT    EQU   0
CREATVAL EQU   CREAT
FILE     EQU   0
FILEVAL  EQU   FILE+1
STAT     EQU   0
USAGE    EQU   0
LGND     EQU   0
OFILE    EQU   0
OFILEVAL EQU   OFILE+1
ODS      EQU   0
ODSFLG   EQU   ODS+10
ODSVAL   EQU   ODS+21
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVGROUP EQU   RVVI+14
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVGPVOL EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVGSVOL EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSGRP  EQU   RVVSPEC
RVVSVOL  EQU   RVVSPEC
GROUP    EQU   0
GRONAME  EQU   GROUP
GROVVGRP EQU   GRONAME+3
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROFSN   EQU   GROUP+17
GRONGEN  EQU   GROUP+30
GRONRSTD EQU   GROUP+32
GROERRTS EQU   GROUP+56
GROOWNER EQU   GROUP+96
GROADDR  EQU   GROUP+106
BASEV    EQU   0
BASNAME  EQU   BASEV
BASSERNO EQU   BASNAME+5
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASLAST  EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASNEXTV EQU   BASEV+56
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
SRTSTOR  EQU   0
SRTELEM  EQU   SRTSTOR
SRTSAVE  EQU   0
CONVDATE EQU   0
CONVYEAR EQU   CONVDATE
CONVDAYS EQU   CONVDATE+2
AMSTP041 EQU   0
AMSTP043 EQU   0
DMPTRM   EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARK0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NLGND    EQU   0
RPT      EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
GDTRCK   EQU   GDTTBL+284
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SRTARG   EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00119 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00106 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00105 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00104 EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASEVKEY EQU   BASNAME
@NM00103 EQU   GROUP+136
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GRORETPD EQU   GROUP+52
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GROSTRSH EQU   GROUP+40
GROSSPD  EQU   GROUP+38
GROPSPD  EQU   GROUP+36
GRONINAC EQU   GROUP+34
GROPCENT EQU   GROUP+29
GROLSN   EQU   GROUP+23
@NM00102 EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GROBIND  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROG     EQU   GRONAME
@NM00101 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
@NM00100 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
@NM00099 EQU   RVVCHAIN
@NM00098 EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00097 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
@NM00096 EQU   RVVOPCOD+1
ODSLEN   EQU   ODS+20
ODSMEM   EQU   ODS+12
ODSMLN   EQU   ODS+11
ODSFUQ   EQU   ODSFLG
ODSPOS   EQU   ODS+9
ODSPAS   EQU   ODS+1
ODSPLN   EQU   ODS
OFILELEN EQU   OFILE
FILELEN  EQU   FILE
LEVELMEM EQU   LEVEL+12
LEVELMLN EQU   LEVEL+11
LEVELFUQ EQU   LEVELFLG
LEVELPAS EQU   LEVEL+1
LEVELPLN EQU   LEVEL
GRPLEN   EQU   @NM00095
VOLLEN   EQU   @NM00094
@NM00093 EQU   VSDDSORG
@NM00092 EQU   VSDUSEF
@NM00091 EQU   VSDALLOC
@NM00090 EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
@NM00089 EQU   VSDSCR+5
@NM00088 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
@NM00087 EQU   VSDSTAT+29
@NM00086 EQU   VSDFLG2
@NM00085 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
@NM00084 EQU   VSDVTOC+20
@NM00083 EQU   VSDVTOC+15
@NM00082 EQU   VSDVTOC+10
@NM00081 EQU   VSDVTOC
@NM00080 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3EXDSP EQU   VS3AGL+12
VS3HEAD  EQU   VS3AGL
@NM00079 EQU   DATESOPT
@NM00078 EQU   SELFLAGS
SELHEAD  EQU   SELAGL
@NM00077 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00076 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00073 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00072 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00071 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00070 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00069 EQU   RCTAGL+10
@NM00068 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00067 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00066 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00065 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00064 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00063 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00062 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00061 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00060 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00059 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00058 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00057 EQU   EXSPACE+8
@NM00056 EQU   EXSPACE+6
@NM00055 EQU   EXSPACE+4
@NM00054 EQU   EXSPACE+1
@NM00053 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00052 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00051 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00050 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00049 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00048 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00047 EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00046 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00045 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00044 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00043 EQU   CMMSG+7
@NM00042 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00041 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00040 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00039 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00038 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00037 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00036 EQU   ERCNVTAB+4
@NM00035 EQU   ERCNVTAB+3
@NM00034 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00033 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00032 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00031 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00030 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00029 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
@NM00028 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00027 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00026 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00025 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00024 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNPWA   EQU   OPNAGL+12
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00023 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00022 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00021 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00020 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00019 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00018 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00017+1
UNITCHA  EQU   @NM00017
UNITUCB  EQU   UNITABL
RACFVOLS EQU   RACFAGL+16
RACFCLN  EQU   RACFAGL+12
RACFPROF EQU   RACFAGL+8
RACFENT  EQU   RACFAGL+4
@NM00016 EQU   RACFFLG4
@NM00015 EQU   RACFFLG3
RACFPRF  EQU   RACFFLG3
@NM00014 EQU   RACFFLG3
@NM00013 EQU   RACFFLG2
RACFTRD  EQU   RACFFLG2
RACFTUPD EQU   RACFFLG2
RACFTCTL EQU   RACFFLG2
@NM00012 EQU   RACFFLG2
RACFTALT EQU   RACFFLG2
RACFCSA  EQU   RACFFLG1
RACFLOGN EQU   RACFFLG1
RACFLOGF EQU   RACFFLG1
@NM00011 EQU   RACFFLG1
RACFDSTV EQU   RACFFLG1
@NM00010 EQU   RACFFLG1
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00497 EQU   @RC00490
@RF00504 EQU   @RC00490
@RC00565 EQU   @RC00564
@RC00624 EQU   @RC00623
@RC00659 EQU   @RC00651
@RC00718 EQU   @RC00717
@RF00876 EQU   @RC00835
@RC01004 EQU   @RC01000
@RC01002 EQU   @RC01000
@RF01150 EQU   @RC01139
@RC01335 EQU   @RC01325
@RC01327 EQU   @RC01325
@RC01338 EQU   @RC01325
@RC01542 EQU   @RC01541
@RC01568 EQU   @RC01562
@RC01563 EQU   @RC01562
@RF01643 EQU   @RC01628
@PB00021 EQU   @EL00001
@RC00571 EQU   @RC00565
@RF00579 EQU   @RC00565
@RC00662 EQU   @RC00659
@RC00660 EQU   @RC00659
@RC00724 EQU   @RC00718
@RF00732 EQU   @RC00718
@RC01331 EQU   @RC01327
@RC01329 EQU   @RC01327
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCLD01,(C'PLS1829',0603,76306)

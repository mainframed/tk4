         TITLE '**** IDCCN01:  CONVERTV FUNCTION SUPPORT ROUTINE ****  *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCCN01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCCN01   76.342'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @03,0                                               0002
@PSTART  LA    @04,4095(,@03)                                      0002
         LA    @05,4095(,@04)                                      0002
         LA    @06,4095(,@05)                                      0002
         USING @PSTART,@03                                         0002
         USING @PSTART+4095,@04                                    0002
         USING @PSTART+8190,@05                                    0002
         USING @PSTART+12285,@06                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0002
         USING @DATD,@12                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @12,8(,@13)                                         0002
         LR    @13,@12                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0323
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*  THIS IS THE BEGINNING OF THE MAIN PROCEDURE - IDCCN01   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*  FUNCTION - CALLS PROCEDURES TO RETRIEVE SOURCE AND      @Y30LB34*/
*/*             TARGET VOLUME INFORMATION.                   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*             DETERMINES APPROPRIATE PATH DEPENDING ON     @Y30LB34*/
*/*             TYPE OF CONVERSION.  CALLS RVPROC FOR REAL   @Y30LB34*/
*/*             TO VIRTUAL.  CALLS VRPROC FOR VIRTUAL TO     @Y30LB34*/
*/*             REAL.                                        @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*             IF FUNCTION IS COMPLETED WITH A CONDITION    @Y30LB34*/
*/*             CODE LESS THAN 12, ISSUES MESSAGE IDC0001I.  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*             IF FUNCTION TERMINATES WITH A CONDITION      @Y30LB34*/
*/*             CODE OF 12, ISSUES MESSAGE IDC0003I.         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0323
*                                                                  0323
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT THE BEGINNING OF THE       @Y30LB34*/
*   /* PROCEDURE                                             @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   OLDERID2=NEWERID2;                                             0323
         L     @07,@PC00001                                        0323
         L     @15,GDTTR2(,@07)                                    0323
         MVC   @TS00001(95),NEWERID2(@15)                          0323
         MVC   OLDERID2(95,@15),@TS00001                           0323
*   NEWID2='CNST';                  /*                       @Y30LB34*/
*                                                                  0324
         MVC   NEWID2(4,@15),@CC01652                              0324
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO DATA AREAS                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   RESPECIFY                                                      0325
*     EXCLAGL BASED(ADDR(EXCLAR));  /*                       @YD00175*/
*   RESPECIFY                                                      0326
*     UNITABL BASED(UNITABLP);      /*                       @Y30LB34*/
*   UNITABLP=ADDR(UNITABLA);        /*                       @Y30LB34*/
         LA    @15,UNITABLA                                        0327
         ST    @15,UNITABLP                                        0327
*   OPNPTR=ADDR(OPNAREA);           /*                       @Y30LB34*/
         LA    OPNPTR,OPNAREA                                      0328
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB34*/
         LA    @15,PRINTTAB                                        0329
         ST    @15,DDSTRU                                          0329
*   CVOLPTR=ADDR(CVOLAR);           /*                       @Y30LB34*/
         LA    @15,CVOLAR                                          0330
         ST    @15,CVOLPTR                                         0330
*   RVVIPTR=ADDR(RVVIAREA);         /*                       @Y30LB34*/
         LA    @15,RVVIAREA                                        0331
         ST    @15,RVVIPTR                                         0331
*   BASEVPTR=ADDR(BASEVAR);         /*                       @Y30LB34*/
         LA    @15,BASEVAR                                         0332
         ST    @15,BASEVPTR                                        0332
*   MVRPTR=ADDR(MVRAREA);           /*                       @Y30LB34*/
         LA    @15,MVRAREA                                         0333
         ST    @15,MVRPTR                                          0333
*   COVCEPTR=ADDR(COVCEAR);         /*                       @Y30LB34*/
         LA    @15,COVCEAR                                         0334
         ST    @15,COVCEPTR                                        0334
*   RESPECIFY                                                      0335
*     IOINFOPT BASED(ADDR(IOINFAR));/*                       @Y30LB34*/
*   INFOPTR=ADDR(INFOAREA);         /*                       @Y30LB34*/
         LA    @15,INFOAREA                                        0336
         ST    @15,INFOPTR                                         0336
*   RESPECIFY                                                      0337
*     MDAGL BASED(ADDR(MDAGLAR));   /*                       @Y30LB34*/
*   RESPECIFY                                                      0338
*     PUAGL BASED(ADDR(PUAGLAR));   /*                       @Y30LB34*/
*   RESPECIFY                                                      0339
*     CKAGL BASED(ADDR(CKAGLAR));   /*                       @Y30LB34*/
*   RESPECIFY                                                      0340
*     VS2AGL BASED(ADDR(VS2AGLAR)); /*                       @Y30LB34*/
*                                                                  0340
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PARAMETER LISTS AND DATA AREAS TO ZERO     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   UNITABLA=''B;                   /*                       @Y30LB34*/
         XC    UNITABLA(11),UNITABLA                               0341
*   FRVS1AGL=''B;                   /*                       @Y30LB34*/
         XC    FRVS1AGL(74),FRVS1AGL                               0342
*   TOVS1AGL=''B;                   /*                       @Y30LB34*/
         XC    TOVS1AGL(74),TOVS1AGL                               0343
*   OPNAREA=''B;                    /*                       @Y30LB34*/
         XC    OPNAREA(48),OPNAREA                                 0344
*   PRINTTAB=''B;                   /*                       @Y30LB34*/
         XC    PRINTTAB(44),PRINTTAB                               0345
*   MDAGLAR=''B;                    /*                       @Y30LB34*/
         XC    MDAGLAR(37),MDAGLAR                                 0346
*   PUAGLAR=''B;                    /*                       @Y30LB34*/
         XC    PUAGLAR(20),PUAGLAR                                 0347
*   CKAGLAR=''B;                    /*                       @Y30LB34*/
         XC    CKAGLAR(29),CKAGLAR                                 0348
*   VS2AGLAR=''B;                   /*                       @Y30LB34*/
         XC    VS2AGLAR(52),VS2AGLAR                               0349
*   CVOLAR=''B;                     /*                       @Y30LB34*/
         XC    CVOLAR(40),CVOLAR                                   0350
*   EXCLAGL=''B;                    /*                       @YD00175*/
         LA    @15,EXCLAR                                          0351
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        0351
*   RVVIAREA=''B;                   /*                       @Y30LB34*/
         XC    RVVIAREA(68),RVVIAREA                               0352
*   BASEVAR=''B;                    /*                       @Y30LB34*/
         XC    BASEVAR(224),BASEVAR                                0353
*   MVRAREA=''B;                    /*                       @Y30LB34*/
         XC    MVRAREA(88),MVRAREA                                 0354
*   COVCEAR=''B;                    /*                       @Y30LB34*/
         XC    COVCEAR(43),COVCEAR                                 0355
*   INFOAREA=''B;                   /*                       @Y30LB34*/
         XC    INFOAREA(54),INFOAREA                               0356
*   IOINFAR=''B;                    /*                       @Y30LB34*/
         MVI   IOINFAR,X'00'                                       0357
*   SRCEAREA=''B;                   /*                       #Y30LB34*/
         XC    SRCEAREA(39),SRCEAREA                               0358
*   TARGAREA=''B;                   /*                       #Y30LB34*/
         XC    TARGAREA(49),TARGAREA                               0359
*   SWITCHES=''B;                   /*                       #Y30LB34*/
         MVI   SWITCHES,X'00'                                      0360
*                                                                  0361
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A DUMP POINT AFTER INITIALIZATION OF        @Y30LB34*/
*   /* THE PARAMETER LISTS AND DATA AREAS                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0361
*   IF GDTDBG=NULLPTR THEN                                         0361
         L     @07,GDTDBG(,@07)                                    0361
         LTR   @07,@07                                             0361
         BZ    @RT00361                                            0361
*     ;                                                            0362
*   ELSE                                                           0363
*     CALL IDCDB010(GDTTBL,'CNBG'); /*                       @Y30LB34*/
*                                                                  0363
         L     @07,@PC00001                                        0363
         ST    @07,@AL00001                                        0363
         LA    @15,@CC01667                                        0363
         ST    @15,@AL00001+4                                      0363
         MVI   @AL00001+4,X'80'                                    0363
         L     @15,GDTDBG(,@07)                                    0363
         LA    @01,@AL00001                                        0363
         BALR  @14,@15                                             0363
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USYSINFO TO RETRIEVE THE UNITABL TO TEST FOR    @ZA08840*/
*   /* SHAREABLE DRIVES.                                     @ZA08840*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,FFILEVAL);/*          @ZA08840*/
@RT00361 L     @07,@PC00001                                        0364
         ST    @07,@AL00001                                        0364
         LA    @15,UNIT                                            0364
         ST    @15,@AL00001+4                                      0364
         LA    @15,UNITABLP                                        0364
         ST    @15,@AL00001+8                                      0364
         L     @15,@PC00001+4                                      0364
         L     @01,FDTPTR(,@15)                                    0364
         LA    @15,FFILEVAL(,@01)                                  0364
         ST    @15,@AL00001+12                                     0364
         MVI   @AL00001+12,X'80'                                   0364
         L     @15,GDTSFO(,@07)                                    0364
         LA    @01,@AL00001                                        0364
         BALR  @14,@15                                             0364
*   RESPECIFY                                                      0365
*     RTNREG RSTD;                                                 0365
*   TESTRC=RTNREG;                                                 0366
         STH   RTNREG,TESTRC                                       0366
*   RESPECIFY                                                      0367
*     RTNREG UNRSTD;                /*                       @ZA08840*/
*                                                                  0367
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USYSINFO IS UNSCCESSFUL, SET LASTCOND TO 12.       @ZA08840*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*   IF TESTRC^=0 THEN                                              0368
         LH    @07,TESTRC                                          0368
         LTR   @07,@07                                             0368
         BZ    @RF00368                                            0368
*     LASTCOND=LASTCC12;            /*                       @ZA08840*/
*                                                                  0369
         L     @07,@PC00001+8                                      0369
         MVC   LASTCOND(2,@07),@CH00567                            0369
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF A SHAREABLE CONVERTIBLE DRIVE WAS SYSGEND OR A        */
*   /* UNIPROCESSOR UNIT WAS BEING USED ON A VS2 SYSTEM. IF SO, ISSUE*/
*   /* MESSAGE IDC3736I TO INFORM THE USER THAT CONVERTV CANNOT BE   */
*   /* ISSUED. SET LASTCOND TO 12.                           @ZA08840*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0370
*   ELSE                                                           0370
*     IF UNITXSHR=ON×UNITUSHR=ON THEN                              0370
         B     @RC00368                                            0370
@RF00368 L     @07,UNITABLP                                        0370
         TM    UNITXSHR(@07),B'01100000'                           0370
         BZ    @RF00370                                            0370
*       DO;                         /*                       @ZA08840*/
*         DARGSMOD=CONVMSG;         /*                       @ZA08840*/
         L     @07,DDSTRU                                          0372
         MVC   DARGSMOD(3,@07),@CC01557                            0372
*         DARGSENT=MSG3736I;        /*                       @ZA08840*/
         MVI   DARGSENT(@07),X'01'                                 0373
*         DARGDBP=ADDR(FFILEVAL);   /*                       @ZA08840*/
         L     @15,@PC00001+4                                      0374
         L     @01,FDTPTR(,@15)                                    0374
         LA    @15,FFILEVAL(,@01)                                  0374
         ST    @15,DARGDBP(,@07)                                   0374
*         DARGILP=LENGTH(FFILEVAL); /*                       @ZA08840*/
         MVC   DARGILP(2,@07),@CH00177                             0375
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @ZA08840*/
         L     @07,@PC00001                                        0376
         ST    @07,@AL00001                                        0376
         LA    @15,@CF00115                                        0376
         ST    @15,@AL00001+4                                      0376
         LA    @15,DDSTRU                                          0376
         ST    @15,@AL00001+8                                      0376
         MVI   @AL00001+8,X'80'                                    0376
         L     @15,GDTPRT(,@07)                                    0376
         LA    @01,@AL00001                                        0376
         BALR  @14,@15                                             0376
*         LASTCOND=LASTCC12;        /*                       @ZA08840*/
         L     @07,@PC00001+8                                      0377
         MVC   LASTCOND(2,@07),@CH00567                            0377
*       END;                        /*                       @ZA08840*/
*     ELSE                                                         0379
*       DO;                         /*                       @ZA08840*/
*                                                                  0379
         B     @RC00370                                            0379
@RF00370 DS    0H                                                  0380
*         /***********************************************************/
*         /*                                                         */
*         /* RETRIEVE PRELIMINARY INFORMATION ON SOURCE AND  #Y30LB34*/
*         /* TARGET VOLUMES                                  @Y30LB34*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0380
*         CALL INFOPROC;            /*                       @Y30LB34*/
         BAL   @14,INFOPROC                                        0380
*         RESPECIFY                                                0381
*           RTNREG RSTD;                                           0381
*         TESTRC=RTNREG;                                           0382
         STH   RTNREG,TESTRC                                       0382
*         RESPECIFY                                                0383
*           RTNREG UNRSTD;          /*                       @Y30LB34*/
*         LASTCOND=TESTRC;          /*                       @Y30LB34*/
         LH    @07,TESTRC                                          0384
         L     @15,@PC00001+8                                      0384
         STH   @07,LASTCOND(,@15)                                  0384
*       END;                        /*                       @ZA08840*/
*                                                                  0385
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A SEVERE ERROR HAS NOT OCCURRED, PERFORM           @Y30LB34*/
*   /* CONVERSION. CALL APPROPRIATE PROCEDURE BASED ON       @Y30LB34*/
*   /* TYPE OF CONVERSION.                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0386
*   IF LASTCOND<LASTCC12 THEN                                      0386
@RC00370 DS    0H                                                  0386
@RC00368 L     @07,@PC00001+8                                      0386
         LH    @07,LASTCOND(,@07)                                  0386
         C     @07,@CF00567                                        0386
         BNL   @RF00386                                            0386
*     DO;                           /*                       @Y30LB34*/
*       IF CONVTYPE=RV THEN                                        0388
         TM    CONVTYPE,B'01000000'                                0388
         BNO   @RF00388                                            0388
*         CALL RVPROC;              /*                       @Y30LB34*/
         BAL   @14,RVPROC                                          0389
*       IF CONVTYPE=VR THEN                                        0390
@RF00388 TM    CONVTYPE,B'01000000'                                0390
         BNZ   @RF00390                                            0390
*         CALL VRPROC;              /*                       @Y30LB34*/
         BAL   @14,VRPROC                                          0391
*       RESPECIFY                                                  0392
*         RTNREG RSTD;                                             0392
@RF00390 DS    0H                                                  0393
*       TESTRC=RTNREG;                                             0393
         STH   RTNREG,TESTRC                                       0393
*       RESPECIFY                                                  0394
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     @Y30LB34*/
         L     @07,@PC00001+8                                      0395
         LH    @02,TESTRC                                          0395
         LH    @15,LASTCOND(,@07)                                  0395
         CR    @15,@02                                             0395
         BNL   *+6
         LR    @15,@02                                             0395
         STH   @15,LASTCOND(,@07)                                  0395
*     END;                          /*                       @Y30LB34*/
*                                                                  0397
*   /*****************************************************************/
*   /*                                                               */
*   /* DO TERMINATION PROCESSING                             @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0397
*   IF GDTDBG=NULLPTR THEN                                         0397
@RF00386 L     @07,@PC00001                                        0397
         L     @07,GDTDBG(,@07)                                    0397
         LTR   @07,@07                                             0397
         BZ    @RT00397                                            0397
*     ;                                                            0398
*   ELSE                                                           0399
*     CALL IDCDB010(GDTTBL,'CNND'); /*                       @Y30LB34*/
*                                                                  0399
         L     @07,@PC00001                                        0399
         ST    @07,@AL00001                                        0399
         LA    @02,@CC01671                                        0399
         ST    @02,@AL00001+4                                      0399
         MVI   @AL00001+4,X'80'                                    0399
         L     @15,GDTDBG(,@07)                                    0399
         LA    @01,@AL00001                                        0399
         BALR  @14,@15                                             0399
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE COMPLETION MESSAGE                              @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   IF LASTCOND<LASTCC12 THEN                                      0400
@RT00397 L     @07,@PC00001+8                                      0400
         LH    @07,LASTCOND(,@07)                                  0400
         C     @07,@CF00567                                        0400
         BNL   @RF00400                                            0400
*     DARGSENT=MSG0001I;            /*                       @Y30LB34*/
         L     @07,DDSTRU                                          0401
         MVI   DARGSENT(@07),X'01'                                 0401
*   ELSE                                                           0402
*     DARGSENT=MSG0003I;            /*                       @Y30LB34*/
         B     @RC00400                                            0402
@RF00400 L     @07,DDSTRU                                          0402
         MVI   DARGSENT(@07),X'03'                                 0402
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB34*/
@RC00400 L     @07,DDSTRU                                          0403
         MVC   DARGSMOD(3,@07),@CC01553                            0403
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB34*/
         L     @02,@PC00001+8                                      0404
         ST    @02,DARGDBP(,@07)                                   0404
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB34*/
         MVC   DARGILP(2,@07),@CH00153                             0405
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB34*/
*                                                                  0406
         L     @07,@PC00001                                        0406
         ST    @07,@AL00001                                        0406
         LA    @02,@CF00115                                        0406
         ST    @02,@AL00001+4                                      0406
         LA    @02,DDSTRU                                          0406
         ST    @02,@AL00001+8                                      0406
         MVI   @AL00001+8,X'80'                                    0406
         L     @15,GDTPRT(,@07)                                    0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE AMS EXECUTIVE                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0407
*                                                                  0407
         L     @07,@PC00001                                        0407
         ST    @07,@AL00001                                        0407
         LA    @02,MODID                                           0407
         ST    @02,@AL00001+4                                      0407
         L     @02,@PC00001+8                                      0407
         ST    @02,@AL00001+8                                      0407
         MVI   @AL00001+8,X'80'                                    0407
         L     @15,GDTEPL(,@07)                                    0407
         LA    @01,@AL00001                                        0407
         BALR  @14,@15                                             0407
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*                                                                  0408
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - INFOPROC                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - RETRIEVES SOURCE AND TARGET VOLUME PROCESSING @Y30LB34*/
*/*            INFORMATION.  BUILDS INITIAL SOURCE AND       @Y30LB34*/
*/*            TARGET WORK AREAS.  TESTS FOR ERRORS IN       @Y30LB34*/
*/*            JOB SETUP.                                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS ERROR MESSAGE IDC3739I IF SOURCE       @Y30LB34*/
*/*            TARGET VOLUMES ARE BOTH VIRTUAL OR REAL       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, DARGLIST                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*            R. C. =  0, SUCCESSFUL COMPLETION             @Y30LB34*/
*/*            R. C. = 12, RETURN CODE FROM SOINFO AND/OR    @Y30LB34*/
*/*                        TAINFO, VOLUMES ARE THE SAME      @Y30LB34*/
*/*                        TYPE                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0408
*INFOPROC:                                                         0408
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0408
@EL00001 L     @13,4(,@13)                                         0408
@EF00001 L     @00,@SIZDATD                                        0408
         LR    @01,@12                                             0408
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0408
         BR    @14                                                 0408
INFOPROC DS    0H                                                  0409
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   DCL                                                            0409
*     CC01 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0410
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*   CC01=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC01,CC01                                           0410
*   RTNREG1=REG14;                  /*                       @Y30LB34*/
*                                                                  0411
         ST    REG14,RTNREG1                                       0411
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   OLDERID2=NEWERID2;                                             0412
         L     @07,@PC00001                                        0412
         L     @07,GDTTR2(,@07)                                    0412
         MVC   @TS00001(95),NEWERID2(@07)                          0412
         MVC   OLDERID2(95,@07),@TS00001                           0412
*   NEWID2='CNT1';                  /*                       @Y30LB34*/
*                                                                  0413
         MVC   NEWID2(4,@07),@CC01676                              0413
*   /*****************************************************************/
*   /*                                                               */
*   /* GET SOURCE VOLUME INFORMATION                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   CALL SOINFO;                    /*                       @Y30LB34*/
         BAL   @14,SOINFO                                          0414
*   RESPECIFY                                                      0415
*     RTNREG RSTD;                                                 0415
*   TESTRC=RTNREG;                                                 0416
         STH   RTNREG,TESTRC                                       0416
*   RESPECIFY                                                      0417
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC01=TESTRC;                    /*                       @Y30LB34*/
*                                                                  0418
         LH    @07,TESTRC                                          0418
         LR    CC01,@07                                            0418
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR OCCURRED RETRIEVING SOURCE         @Y30LB34*/
*   /* VOLUME INFO, GET TARGET VOLUME INFORMATION            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0419
*   IF CC01<LASTCC12 THEN                                          0419
         C     CC01,@CF00567                                       0419
         BNL   @RF00419                                            0419
*     DO;                           /*                       @Y30LB34*/
*       CALL TAINFO;                /*                       @Y30LB34*/
         BAL   @14,TAINFO                                          0421
*       RESPECIFY                                                  0422
*         RTNREG RSTD;                                             0422
*       TESTRC=RTNREG;                                             0423
         STH   RTNREG,TESTRC                                       0423
*       RESPECIFY                                                  0424
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC01=MAX(CC01,TESTRC);      /*                       @Y30LB34*/
         LH    @08,TESTRC                                          0425
         CR    CC01,@08                                            0425
         BNL   *+6
         LR    CC01,@08                                            0425
*     END;                          /*                       @Y30LB34*/
*                                                                  0427
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS HAVE OCCURRED RETRIEVING          @Y30LB34*/
*   /* INFORMATION, CONTINUE PROCESSING.                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   IF CC01<LASTCC08 THEN                                          0427
@RF00419 C     CC01,@CF00177                                       0427
         BNL   @RF00427                                            0427
*     DO;                           /*                       @Y30LB34*/
*                                                                  0428
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR SAME VOLUME SERIAL NUMBERS ON            @Y30LB34*/
*       /* SOURCE AND TARGET VOLUMES                         @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0429
*       IF SVOLSER=TVOLSER THEN                                    0429
         CLC   SVOLSER(6),TVOLSER                                  0429
         BNE   @RF00429                                            0429
*         SAMESER=ON;               /*                       @Y30LB34*/
         OI    SAMESER,B'10000000'                                 0430
*       ELSE                                                       0431
*         SAMESER=OFF;              /*                       @Y30LB34*/
*                                                                  0431
         B     @RC00429                                            0431
@RF00429 NI    SAMESER,B'01111111'                                 0431
*       /*************************************************************/
*       /*                                                           */
*       /* TEST VOLUME TYPES FOR TYPE OF CONVERSION          @Y30LB34*/
*       /* IF VOLUMES ARE THE SAME TYPE PRINT                @Y30LB34*/
*       /* MESSAGE IDC3739I, AND TERMINATE THE JOB.          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0432
*       IF STYPEVOL='REAL'&TTYPEVOL='VIRT' THEN                    0432
@RC00429 CLC   STYPEVOL(4),@CC01679                                0432
         BNE   @RF00432                                            0432
         CLC   TTYPEVOL(4),@CC01680                                0432
         BNE   @RF00432                                            0432
*         CONVTYPE=RV;              /*                       @Y30LB34*/
         OI    CONVTYPE,B'01000000'                                0433
*       ELSE                                                       0434
*         IF STYPEVOL='VIRT'&TTYPEVOL='REAL' THEN                  0434
         B     @RC00432                                            0434
@RF00432 CLC   STYPEVOL(4),@CC01680                                0434
         BNE   @RF00434                                            0434
         CLC   TTYPEVOL(4),@CC01679                                0434
         BNE   @RF00434                                            0434
*           CONVTYPE=VR;            /*                       @Y30LB34*/
         NI    CONVTYPE,B'10111111'                                0435
*         ELSE                                                     0436
*           DO;                     /*                       @Y30LB34*/
         B     @RC00434                                            0436
@RF00434 DS    0H                                                  0437
*             DARGSMOD=CONVMSG;     /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0437
         MVC   DARGSMOD(3,@08),@CC01557                            0437
*             DARGSENT=MSG3739I;    /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'03'                                 0438
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB34*/
         L     @08,@PC00001                                        0439
         ST    @08,@AL00001                                        0439
         LA    @07,@CF00115                                        0439
         ST    @07,@AL00001+4                                      0439
         LA    @07,DDSTRU                                          0439
         ST    @07,@AL00001+8                                      0439
         MVI   @AL00001+8,X'80'                                    0439
         L     @15,GDTPRT(,@08)                                    0439
         LA    @01,@AL00001                                        0439
         BALR  @14,@15                                             0439
*             CC01=MAX(CC01,LASTCC12);/*                     @Y30LB34*/
         LA    @08,12                                              0440
         CR    CC01,@08                                            0440
         BNL   *+6
         LR    CC01,@08                                            0440
*           END;                    /*                       @Y30LB34*/
*                                                                  0442
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE ENQ AND RESERVE RNAME FOR          @Y30LB34*/
*       /* SOURCE AND TARGET VOLUMES                         @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0442
*       RENQLEN=LENGTH(RNAMERE);    /*                       @Y30LB34*/
@RC00434 DS    0H                                                  0442
@RC00432 MVI   RENQLEN,X'14'                                       0442
*       RENQ=REALENQ;               /*                       @Y30LB34*/
         MVC   RENQ(13),@CC01596                                   0443
*       RRESLEN=LENGTH(RNAMERR);    /*                       @Y30LB34*/
         MVI   RRESLEN,X'14'                                       0444
*       RRES=REALRES;               /*                       @Y30LB34*/
         MVC   RRES(13),@CC01602                                   0445
*       VENQLEN=LENGTH(RNAMEVE);    /*                       @Y30LB34*/
         MVI   VENQLEN,X'17'                                       0446
*       VENQ=VIRTENQ;               /*                       @Y30LB34*/
         MVC   VENQ(16),@CC01599                                   0447
*       VRESLEN=LENGTH(RNAMEVR);    /*                       @Y30LB34*/
         MVI   VRESLEN,X'17'                                       0448
*       VRES=VIRTRES;               /*                       @Y30LB34*/
         MVC   VRES(16),@CC01605                                   0449
*       IF STYPEVOL='REAL' THEN                                    0450
         CLC   STYPEVOL(4),@CC01679                                0450
         BNE   @RF00450                                            0450
*         DO;                       /*                       @Y30LB34*/
*           REVOLSER=SVOLSER;       /*                       @Y30LB34*/
         MVC   REVOLSER(6),SVOLSER                                 0452
*           RRVOLSER=SVOLSER;       /*                       @Y30LB34*/
         MVC   RRVOLSER(6),SVOLSER                                 0453
*           VEVOLSER=TVOLSER;       /*                       @Y30LB34*/
         MVC   VEVOLSER(6),TVOLSER                                 0454
*           VRVOLSER=TVOLSER;       /*                       @Y30LB34*/
         MVC   VRVOLSER(6),TVOLSER                                 0455
*         END;                      /*                       @Y30LB34*/
*       ELSE                                                       0457
*         DO;                       /*                       @Y30LB34*/
         B     @RC00450                                            0457
@RF00450 DS    0H                                                  0458
*           REVOLSER=TVOLSER;       /*                       @Y30LB34*/
         MVC   REVOLSER(6),TVOLSER                                 0458
*           RRVOLSER=TVOLSER;       /*                       @Y30LB34*/
         MVC   RRVOLSER(6),TVOLSER                                 0459
*           VEVOLSER=SVOLSER;       /*                       @Y30LB34*/
         MVC   VEVOLSER(6),SVOLSER                                 0460
*           VRVOLSER=SVOLSER;       /*                       @Y30LB34*/
         MVC   VRVOLSER(6),SVOLSER                                 0461
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
@RC00450 DS    0H                                                  0464
*                                                                  0464
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ERRORS OCCURRED IN SOINFO AND/OR TAINFO A          @Y30LB34*/
*   /* RETURN CODE OF 8 WAS PASSED TO INFOPROC SO            @Y30LB34*/
*   /* PROCESSING COULD CONTINUE. NOW THESE ERRORS           @Y30LB34*/
*   /* SHOULD TERMIATE FURTHER PROCESSING. CHANGE            @Y30LB34*/
*   /* RETURN CODE OF 8 TO 12.                               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0464
*   IF CC01=LASTCC08 THEN                                          0464
@RF00427 C     CC01,@CF00177                                       0464
         BNE   @RF00464                                            0464
*     CC01=LASTCC12;                /*                       @Y30LB34*/
*                                                                  0465
         LA    CC01,12                                             0465
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO THE MAIN PROCEDURE                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0466
*   REG14=RTNREG1;                  /*                       @Y30LB34*/
@RF00464 L     REG14,RTNREG1                                       0466
*   RETURN CODE(CC01);              /*                       @Y30LB34*/
         LR    @15,CC01                                            0467
@EL00002 DS    0H                                                  0467
@EF00002 DS    0H                                                  0467
@ER00002 BR    @14                                                 0467
*   END INFOPROC;                   /*                       @Y30LB34*/
*                                                                  0469
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*  PROCEDURE NAME - SOINFO                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - RETRIEVES SOURCE VOLUME INFORMATION AND SAVES @Y30LB34*/
*/*            IT IN SRCEAREA.                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES UIOINFO FOR DEVICE TYPE AND VOLSER     @Y30LB34*/
*/*            INFORMATION.                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS ERROR MESSAGE IDC3740I IF MULTIPLE     @Y30LB34*/
*/*            VOLUME SERIAL NUMBERS ARE RETURNED BY         @Y30LB34*/
*/*            UIOINFO                                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES UMSSUNIT FOR VOLUME TYPE: REAL OR      @YD00175*/
*/*            VIRTUAL                                       @YD00175*/
*/*                                                          @Y30LB34*/
*/*            IF VOLUME IS REAL ISSUES USYSINFO FOR REAL    @Y30LB34*/
*/*            UNIT ADDRESS.                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, IOINFOPT, CKAGL, UNITABL    @Y30LB34*/
*/*         SRCEAREA AND DARGLIST.                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INFOAREA, SRCEAREA, CKAGL, UNITABL, IOINFOPT.   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  8, UNABLE TO RETRIEVE DEVTYPE AND     @Y30LB34*/
*/*                       VOLSER,                            @Y30LB34*/
*/*                       MORE THAN 1 VOLSER RETURNED BY     @Y30LB34*/
*/*                       UIOINFO,                           @Y30LB34*/
*/*                       UNABLE TO RETRIEVE VOLUME INFO,    @Y30LB34*/
*/*                       UNABLE TO RETRIEVE REAL UNIT       @Y30LB34*/
*/*                       ADDRESS                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0469
*SOINFO:                                                           0469
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0469
SOINFO   DS    0H                                                  0470
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*   DCL                                                            0470
*     CC02 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0471
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0471
*   OLDERID2=NEWERID2;                                             0471
         L     @08,@PC00001                                        0471
         L     @15,GDTTR2(,@08)                                    0471
         MVC   @TS00001(95),NEWERID2(@15)                          0471
         MVC   OLDERID2(95,@15),@TS00001                           0471
*   NEWID2='CNT2';                  /*                       @Y30LB34*/
*                                                                  0472
         MVC   NEWID2(4,@15),@CC01685                              0472
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   CC02=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC02,CC02                                           0473
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  0474
         LR    RTNREG2,REG14                                       0474
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE UIOINFO OPTIONS TO RETRIEVE DEVICE     @Y30LB34*/
*   /* TYPE AND VOLSER                                       @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0475
*   AREALEN=LENGTH(INFOAREA);       /*                       @Y30LB34*/
         MVC   AREALEN(2),@CH01872                                 0475
*   IOINFDVT=ON;                    /*                       @Y30LB34*/
*   IOINFVOL=ON;                    /*                       @Y30LB34*/
*                                                                  0477
         LA    @15,IOINFAR                                         0477
         OI    IOINFDVT(@15),B'11000000'                           0477
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UIOINFO TO RETRIEVE DEVICE TYPE AND VOLSER      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0478
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,FFILEVAL);/*       @Y30LB34*/
         ST    @08,@AL00001                                        0478
         ST    @15,@AL00001+4                                      0478
         LA    @15,INFOPTR                                         0478
         ST    @15,@AL00001+8                                      0478
         L     @15,@PC00001+4                                      0478
         L     @01,FDTPTR(,@15)                                    0478
         LA    @15,FFILEVAL(,@01)                                  0478
         ST    @15,@AL00001+12                                     0478
         MVI   @AL00001+12,X'80'                                   0478
         L     @15,GDTIFO(,@08)                                    0478
         LA    @01,@AL00001                                        0478
         BALR  @14,@15                                             0478
*   RESPECIFY                                                      0479
*     RTNREG RSTD;                                                 0479
*   TESTRC=RTNREG;                                                 0480
         STH   RTNREG,TESTRC                                       0480
*   RESPECIFY                                                      0481
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   IF TESTRC>0 THEN                                               0482
         LH    @08,TESTRC                                          0482
         LTR   @08,@08                                             0482
         BNP   @RF00482                                            0482
*     CC02=LASTCC08;                /*                       @Y30LB34*/
         LA    CC02,8                                              0483
*                                                                  0484
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UIOINFO IS SUCCESSFUL SAVE INFORMATION IN          @Y30LB34*/
*   /* SRCEAREA                                              @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   ELSE                                                           0484
*     DO;                           /*                       @Y30LB34*/
*                                                                  0484
         B     @RC00482                                            0484
@RF00482 DS    0H                                                  0485
*       /*************************************************************/
*       /*                                                           */
*       /* STORE DEVICE TYPE IN WORK AREA.                   @Y30LB34*/
*       /* MAKE SURE UIOINFO ONLY RETRIEVED                  @Y30LB34*/
*       /* ONE VOLSER. IF ONLY ONE,                          @Y30LB34*/
*       /* SAVE IT IN SRCEAREA. IF MORE THAN                 @Y30LB34*/
*       /* ONE, PRINT MESSAGE IDC3740I AND SET THE           @Y30LB34*/
*       /* RETURN CODE TO 8.                                 @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0485
*       SDEVTYPE=DEVICE;            /*                       @Y30LB34*/
         MVC   SDEVTYPE(4),DEVICE                                  0485
*       IF VOLLEN=LENGTH(SVOLSER) THEN                             0486
         CLC   VOLLEN(2),@CH00038                                  0486
         BNE   @RF00486                                            0486
*         SVOLSER=FIRVOL;           /*                       @Y30LB34*/
         MVC   SVOLSER(6),FIRVOL                                   0487
*       IF VOLLEN>LENGTH(SVOLSER) THEN                             0488
@RF00486 LH    @08,VOLLEN                                          0488
         C     @08,@CF00038                                        0488
         BNH   @RF00488                                            0488
*         DO;                       /*                       @Y30LB34*/
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0490
         MVC   DARGSMOD(3,@08),@CC01557                            0490
*           DARGSENT=MSG3740I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'04'                                 0491
*           DARGDBP=ADDR(FFILEVAL); /*                       @Y30LB34*/
         L     @15,@PC00001+4                                      0492
         L     @01,FDTPTR(,@15)                                    0492
         LA    @15,FFILEVAL(,@01)                                  0492
         ST    @15,DARGDBP(,@08)                                   0492
*           DARGILP=LENGTH(FFILEVAL);/*                      @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00177                             0493
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        0494
         ST    @08,@AL00001                                        0494
         LA    @15,@CF00115                                        0494
         ST    @15,@AL00001+4                                      0494
         LA    @15,DDSTRU                                          0494
         ST    @15,@AL00001+8                                      0494
         MVI   @AL00001+8,X'80'                                    0494
         L     @15,GDTPRT(,@08)                                    0494
         LA    @01,@AL00001                                        0494
         BALR  @14,@15                                             0494
*           CC02=LASTCC08;          /*                       @Y30LB34*/
         LA    CC02,8                                              0495
*         END;                      /*                       @Y30LB34*/
*                                                                  0497
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE CKAGL TO GET VOLUME TYPE:              @YD00175*/
*       /* VIRTUAL OR REAL                                   @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0497
*       CKUCBPTR=ADDR(SUCBADDR);    /*                       @Y30LB34*/
@RF00488 LA    @08,CKAGLAR                                         0497
         LA    @15,SUCBADDR                                        0497
         ST    @15,CKUCBPTR(,@08)                                  0497
*       CKDDNAME=FFILEVAL;          /*                       @Y30LB34*/
         L     @15,@PC00001+4                                      0498
         L     @01,FDTPTR(,@15)                                    0498
         MVC   CKDDNAME(8,@08),FFILEVAL(@01)                       0498
*       CKDATYPE=ADDR(STYPEVOL);    /*                       @Y30LB34*/
         LA    @15,STYPEVOL                                        0499
         ST    @15,CKDATYPE(,@08)                                  0499
*       CKRETTYP=ON;                /*                       @Y30LB34*/
*                                                                  0500
         OI    CKRETTYP(@08),B'01000000'                           0500
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT TO RETRIEVE VOLUME INFO            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0501
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB34*/
         L     @15,@PC00001                                        0501
         ST    @15,@AL00001                                        0501
         LA    @14,CHECK                                           0501
         ST    @14,@AL00001+4                                      0501
         ST    @08,@AL00001+8                                      0501
         MVI   @AL00001+8,X'80'                                    0501
         L     @15,GDTUNT(,@15)                                    0501
         LA    @01,@AL00001                                        0501
         BALR  @14,@15                                             0501
*       RESPECIFY                                                  0502
*         RTNREG RSTD;                                             0502
*       TESTRC=RTNREG;                                             0503
         STH   RTNREG,TESTRC                                       0503
*       RESPECIFY                                                  0504
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  0504
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT WAS NOT SUCCESSFUL, SET THE           @YD00175*/
*       /* CONDITION CODE TO 8                               @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0505
*       IF TESTRC>0 THEN                                           0505
         LH    @08,TESTRC                                          0505
         LTR   @08,@08                                             0505
         BNP   @RF00505                                            0505
*         CC02=LASTCC08;            /*                       @Y30LB34*/
         LA    CC02,8                                              0506
*                                                                  0507
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT IS SUCCESSFUL AND                     @Y30LB34*/
*       /* THE VOLUME IS REAL, ISSUE USYSINFO TO RETRIEVE    @Y30LB34*/
*       /* THE REAL UNIT ADDRESS. IF UMSSUNIT WAS NOT        @Y30LB34*/
*       /* SUCCESSFUL STYPEVOL WILL BE ZERO                  @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0507
*       IF STYPEVOL='REAL' THEN                                    0507
@RF00505 CLC   STYPEVOL(4),@CC01679                                0507
         BNE   @RF00507                                            0507
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,FFILEVAL);/*  @Y30LB34*/
         L     @08,@PC00001                                        0509
         ST    @08,@AL00001                                        0509
         LA    @15,UNIT                                            0509
         ST    @15,@AL00001+4                                      0509
         LA    @15,UNITABLP                                        0509
         ST    @15,@AL00001+8                                      0509
         L     @15,@PC00001+4                                      0509
         L     @01,FDTPTR(,@15)                                    0509
         LA    @15,FFILEVAL(,@01)                                  0509
         ST    @15,@AL00001+12                                     0509
         MVI   @AL00001+12,X'80'                                   0509
         L     @15,GDTSFO(,@08)                                    0509
         LA    @01,@AL00001                                        0509
         BALR  @14,@15                                             0509
*           RESPECIFY                                              0510
*             RTNREG RSTD;                                         0510
*           TESTRC=RTNREG;                                         0511
         STH   RTNREG,TESTRC                                       0511
*           RESPECIFY                                              0512
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           IF TESTRC=0 THEN                                       0513
         LH    @08,TESTRC                                          0513
         LTR   @08,@08                                             0513
         BNZ   @RF00513                                            0513
*             SUNITADR=UNITADR;     /*                       @Y30LB34*/
         L     @08,UNITABLP                                        0514
         LH    @08,UNITADR(,@08)                                   0514
         STH   @08,SUNITADR                                        0514
*           IF TESTRC>0 THEN                                       0515
@RF00513 LH    @08,TESTRC                                          0515
         LTR   @08,@08                                             0515
         BNP   @RF00515                                            0515
*             CC02=MAX(CC02,LASTCC08);/*                     @Y30LB34*/
         LA    @08,8                                               0516
         CR    CC02,@08                                            0516
         BNL   *+6
         LR    CC02,@08                                            0516
*         END;                      /*                       @Y30LB34*/
*                                                                  0517
@RF00515 DS    0H                                                  0518
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO SEVERE ERROR HAS OCCURRED, PLACE THE NAME   @Y30LB34*/
*       /* OF THE VSAM CATALOG DD IN SCATDD FOR USE IN       @Y30LB34*/
*       /* CHEKSRCE                                          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0518
*       IF CC02<LASTCC08 THEN                                      0518
@RF00507 C     CC02,@CF00177                                       0518
         BNL   @RF00518                                            0518
*         DO;                       /*                       @Y30LB34*/
*           IF ADDR(CATDD)^=NULLPTR THEN                           0520
         L     @08,@PC00001+4                                      0520
         L     @08,FDTPTR+48(,@08)                                 0520
         LTR   @08,@08                                             0520
         BZ    @RF00520                                            0520
*             SCATDD=CATDDVAL;      /*                       @Y30LB34*/
         MVC   SCATDD(8),CATDDVAL(@08)                             0521
*           ELSE                                                   0522
*             SCATDD=' ';           /*                       @Y30LB34*/
         B     @RC00520                                            0522
@RF00520 MVI   SCATDD+1,C' '                                       0522
         MVC   SCATDD+2(6),SCATDD+1                                0522
         MVI   SCATDD,C' '                                         0522
*         END;                      /*                       @Y30LB34*/
@RC00520 DS    0H                                                  0524
*     END;                          /*                       @Y30LB34*/
*                                                                  0524
@RF00518 DS    0H                                                  0525
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/
*   /* RETURN TO CALLER                                      #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RC00482 LR    REG14,RTNREG2                                       0525
*   RETURN CODE(CC02);              /*                       @Y30LB34*/
         LR    @15,CC02                                            0526
@EL00003 DS    0H                                                  0526
@EF00003 DS    0H                                                  0526
@ER00003 BR    @14                                                 0526
*   END SOINFO;                     /*                       @Y30LB34*/
*                                                                  0528
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*  PROCEDURE NAME - TAINFO                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - RETRIEVES TARGET VOLUME INFORMATION AND SAVES @Y30LB34*/
*/*            IT IN TARGAREA.                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES UIOINFO FOR DEVICE TYPE AND VOLSER     @Y30LB34*/
*/*            INFORMATION.                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS ERROR MESSAGE IDC3740I IF MULTIPLE     @Y30LB34*/
*/*            VOLUME SERIAL NUMBERS ARE RETURNED BY         @Y30LB34*/
*/*            UIOINFO                                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES UMSSUNIT FOR VOLUME TYPE: REAL OR      @YD00175*/
*/*            VIRTUAL.                                      @YD00175*/
*/*                                                          @Y30LB34*/
*/*            IF VOLUME IS REAL ISSUES USYSINFO FOR REAL    @Y30LB34*/
*/*            UNIT ADDRESS.                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, IOINFOPT, CKAGL, UNITABL    @Y30LB34*/
*/*         TARGAREA AND DARGLIST.                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INFOAREA, TARGAREA, CKAGL, UNITABL, IOINFOPT.   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  8, UNABLE TO RETRIEVE DEVTYPE AND     @Y30LB34*/
*/*                       VOLSER,                            @Y30LB34*/
*/*                       MORE THAN 1 VOLSER RETURNED BY     @Y30LB34*/
*/*                       UIOINFO,                           @Y30LB34*/
*/*                       UNABLE TO RETRIEVE VOLUME INFO,    @Y30LB34*/
*/*                       UNABLE TO RETRIEVE REAL UNIT       @Y30LB34*/
*/*                       ADDRESS                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0528
*TAINFO:                                                           0528
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0528
TAINFO   DS    0H                                                  0529
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*   DCL                                                            0529
*     CC03 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0530
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0530
*   OLDERID2=NEWERID2;                                             0530
         L     @11,@PC00001                                        0530
         L     @11,GDTTR2(,@11)                                    0530
         MVC   @TS00001(95),NEWERID2(@11)                          0530
         MVC   OLDERID2(95,@11),@TS00001                           0530
*   NEWID2='CNT3';                  /*                       @Y30LB34*/
*                                                                  0531
         MVC   NEWID2(4,@11),@CC01691                              0531
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0532
*   CC03=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @08,@08                                             0532
         LR    CC03,@08                                            0532
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  0533
         LR    RTNREG2,REG14                                       0533
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE UIOINFO OPTIONS TO RETRIEVE DEVICE     @Y30LB34*/
*   /* TYPE AND IF VOLSER NOT SPECIFIED IN CONTROL           @Y30LB34*/
*   /* STATEMENT, VOLSER.                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0534
*   IOINFAR=''B;                    /*                       @Y30LB34*/
         MVI   IOINFAR,X'00'                                       0534
*   INFOAREA=''B;                   /*                       @Y30LB34*/
         XC    INFOAREA(54),INFOAREA                               0535
*   AREALEN=LENGTH(INFOAREA);       /*                       @Y30LB34*/
         MVC   AREALEN(2),@CH01872                                 0536
*   IOINFDVT=ON;                    /*                       @Y30LB34*/
         LA    @11,IOINFAR                                         0537
         OI    IOINFDVT(@11),B'10000000'                           0537
*   IF ADDR(TVOL)=NULLPTR THEN                                     0538
         L     @15,@PC00001+4                                      0538
         C     @08,FDTPTR+12(,@15)                                 0538
         BNE   @RF00538                                            0538
*     IOINFVOL=ON;                  /*                       @Y30LB34*/
*                                                                  0539
         OI    IOINFVOL(@11),B'01000000'                           0539
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UIOINFO TO RETRIEVE DEVICE TYPE AND VOLSER      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0540
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,TFILEVAL);/*       @Y30LB34*/
@RF00538 L     @11,@PC00001                                        0540
         ST    @11,@AL00001                                        0540
         LA    @08,IOINFAR                                         0540
         ST    @08,@AL00001+4                                      0540
         LA    @08,INFOPTR                                         0540
         ST    @08,@AL00001+8                                      0540
         L     @08,@PC00001+4                                      0540
         L     @08,FDTPTR+4(,@08)                                  0540
         LA    @08,TFILEVAL(,@08)                                  0540
         ST    @08,@AL00001+12                                     0540
         MVI   @AL00001+12,X'80'                                   0540
         L     @15,GDTIFO(,@11)                                    0540
         LA    @01,@AL00001                                        0540
         BALR  @14,@15                                             0540
*   RESPECIFY                                                      0541
*     RTNREG RSTD;                                                 0541
*   TESTRC=RTNREG;                                                 0542
         STH   RTNREG,TESTRC                                       0542
*   RESPECIFY                                                      0543
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   IF TESTRC>0 THEN                                               0544
         LH    @11,TESTRC                                          0544
         LTR   @11,@11                                             0544
         BNP   @RF00544                                            0544
*     CC03=LASTCC08;                /*                       @Y30LB34*/
         LA    CC03,8                                              0545
*                                                                  0546
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UIOINFO IS SUCCESSFUL SAVE INFORMATION IN          @Y30LB34*/
*   /* TARGAREA                                              @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*   ELSE                                                           0546
*     DO;                           /*                       @Y30LB34*/
*                                                                  0546
         B     @RC00544                                            0546
@RF00544 DS    0H                                                  0547
*       /*************************************************************/
*       /*                                                           */
*       /* IF UIOINFO RETRIEVED VOLSER STORE DEVICE          @Y30LB34*/
*       /* TYPE IN WORK AREA. MAKE SURE UIOINFO              @Y30LB34*/
*       /* ONLY RETRIEVED ONE VOLSER. IF ONLY ONE,           @Y30LB34*/
*       /* SAVE IT IN TARGAREA. IF MORE THAN                 @Y30LB34*/
*       /* ONE, PRINT MESSAGE IDC3740I AND SET THE           @Y30LB34*/
*       /* RETURN CODE TO 8.                                 @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0547
*       IF ADDR(TVOL)=NULLPTR THEN                                 0547
         L     @11,@PC00001+4                                      0547
         L     @11,FDTPTR+12(,@11)                                 0547
         LTR   @11,@11                                             0547
         BNZ   @RF00547                                            0547
*         DO;                       /*                       @Y30LB34*/
*           TDEVTYPE=DEVICE;        /*                       @Y30LB34*/
         MVC   TDEVTYPE(4),DEVICE                                  0549
*           IF VOLLEN=LENGTH(TVOLSER) THEN                         0550
         CLC   VOLLEN(2),@CH00038                                  0550
         BNE   @RF00550                                            0550
*             TVOLSER=FIRVOL;       /*                       @Y30LB34*/
         MVC   TVOLSER(6),FIRVOL                                   0551
*           IF VOLLEN>LENGTH(TVOLSER) THEN                         0552
@RF00550 LH    @11,VOLLEN                                          0552
         C     @11,@CF00038                                        0552
         BNH   @RF00552                                            0552
*             DO;                   /*                       @Y30LB34*/
*               DARGSMOD=CONVMSG;   /*                       @Y30LB34*/
         L     @11,DDSTRU                                          0554
         MVC   DARGSMOD(3,@11),@CC01557                            0554
*               DARGSENT=MSG3740I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@11),X'04'                                 0555
*               DARGDBP=ADDR(TFILEVAL);/*                    @Y30LB34*/
         L     @08,@PC00001+4                                      0556
         L     @08,FDTPTR+4(,@08)                                  0556
         LA    @08,TFILEVAL(,@08)                                  0556
         ST    @08,DARGDBP(,@11)                                   0556
*               DARGILP=LENGTH(TFILEVAL);/*                  @Y30LB34*/
         MVC   DARGILP(2,@11),@CH00177                             0557
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/
         L     @11,@PC00001                                        0558
         ST    @11,@AL00001                                        0558
         LA    @08,@CF00115                                        0558
         ST    @08,@AL00001+4                                      0558
         LA    @08,DDSTRU                                          0558
         ST    @08,@AL00001+8                                      0558
         MVI   @AL00001+8,X'80'                                    0558
         L     @15,GDTPRT(,@11)                                    0558
         LA    @01,@AL00001                                        0558
         BALR  @14,@15                                             0558
*               CC03=LASTCC08;      /*                       @Y30LB34*/
         LA    CC03,8                                              0559
*             END;                  /*                       @Y30LB34*/
*         END;                      /*                       @Y30LB34*/
*                                                                  0561
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLSER WAS SPECIFIED IN A CONTROL              @Y30LB34*/
*       /* STATEMENT ONLY DEVICE TYPE IS RETRIEVED           @Y30LB34*/
*       /* FROM UIOINFO AND VOLSER IS RETRIEVED FROM         @Y30LB34*/
*       /* THE FUNCTION DATA TABLE.                          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0562
*       ELSE                                                       0562
*         DO;                       /*                       @Y30LB34*/
         B     @RC00547                                            0562
@RF00547 DS    0H                                                  0563
*           TDEVTYPE=DEVONLY;       /*                       @Y30LB34*/
         MVC   TDEVTYPE(4),DEVONLY                                 0563
*           TVOLSER=TVOLVAL;        /*                       @Y30LB34*/
         L     @11,@PC00001+4                                      0564
         L     @11,FDTPTR+12(,@11)                                 0564
         MVC   TVOLSER(6),TVOLVAL(@11)                             0564
*         END;                      /*                       @Y30LB34*/
*                                                                  0566
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE CKAGL TO RETURN VOLUME TYPE            @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0566
*       CKAGLAR=''B;                /*                       @Y30LB34*/
@RC00547 XC    CKAGLAR(29),CKAGLAR                                 0566
*       CKUCBPTR=ADDR(TUCBADDR);    /*                       @Y30LB34*/
         LA    @11,CKAGLAR                                         0567
         LA    @08,TUCBADDR                                        0567
         ST    @08,CKUCBPTR(,@11)                                  0567
*       CKDDNAME=TFILEVAL;          /*                       @Y30LB34*/
         L     @08,@PC00001+4                                      0568
         L     @08,FDTPTR+4(,@08)                                  0568
         MVC   CKDDNAME(8,@11),TFILEVAL(@08)                       0568
*       CKDATYPE=ADDR(TTYPEVOL);    /*                       @Y30LB34*/
         LA    @08,TTYPEVOL                                        0569
         ST    @08,CKDATYPE(,@11)                                  0569
*       CKRETTYP=ON;                /*                       @Y30LB34*/
*                                                                  0570
         OI    CKRETTYP(@11),B'01000000'                           0570
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT TO RETRIEVE VOLUME INFO            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0571
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB34*/
         L     @08,@PC00001                                        0571
         ST    @08,@AL00001                                        0571
         LA    @15,CHECK                                           0571
         ST    @15,@AL00001+4                                      0571
         ST    @11,@AL00001+8                                      0571
         MVI   @AL00001+8,X'80'                                    0571
         L     @15,GDTUNT(,@08)                                    0571
         LA    @01,@AL00001                                        0571
         BALR  @14,@15                                             0571
*       RESPECIFY                                                  0572
*         RTNREG RSTD;                                             0572
*       TESTRC=RTNREG;                                             0573
         STH   RTNREG,TESTRC                                       0573
*       RESPECIFY                                                  0574
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  0574
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT WAS NOT SUCCESSFUL, SET THE CONDITION @YD00175*/
*       /* CODE TO 8                                         @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0575
*       IF TESTRC>0 THEN                                           0575
         LH    @11,TESTRC                                          0575
         LTR   @11,@11                                             0575
         BNP   @RF00575                                            0575
*         CC03=LASTCC08;            /*                       @Y30LB34*/
         LA    CC03,8                                              0576
*                                                                  0577
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT IS SUCCESSFUL AND                     @Y30LB34*/
*       /* THE VOLUME IS REAL, ISSUE USYSINFO TO RETRIEVE    @Y30LB34*/
*       /* THE REAL UNIT ADDRESS. IF UMSSUNIT WAS NOT        @Y30LB34*/
*       /* SUCCESSFUL TTYPEVOL WILL BE ZERO                  @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0577
*       IF TTYPEVOL='REAL' THEN                                    0577
@RF00575 CLC   TTYPEVOL(4),@CC01679                                0577
         BNE   @RF00577                                            0577
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,TFILEVAL);/*  @Y30LB34*/
         L     @11,@PC00001                                        0579
         ST    @11,@AL00001                                        0579
         LA    @08,UNIT                                            0579
         ST    @08,@AL00001+4                                      0579
         LA    @08,UNITABLP                                        0579
         ST    @08,@AL00001+8                                      0579
         L     @08,@PC00001+4                                      0579
         L     @08,FDTPTR+4(,@08)                                  0579
         LA    @08,TFILEVAL(,@08)                                  0579
         ST    @08,@AL00001+12                                     0579
         MVI   @AL00001+12,X'80'                                   0579
         L     @15,GDTSFO(,@11)                                    0579
         LA    @01,@AL00001                                        0579
         BALR  @14,@15                                             0579
*           RESPECIFY                                              0580
*             RTNREG RSTD;                                         0580
*           TESTRC=RTNREG;                                         0581
         STH   RTNREG,TESTRC                                       0581
*           RESPECIFY                                              0582
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           IF TESTRC=0 THEN                                       0583
         LH    @11,TESTRC                                          0583
         LTR   @11,@11                                             0583
         BNZ   @RF00583                                            0583
*             TUNITADR=UNITADR;     /*                       @Y30LB34*/
         L     @11,UNITABLP                                        0584
         LH    @11,UNITADR(,@11)                                   0584
         STH   @11,TUNITADR                                        0584
*           IF TESTRC>0 THEN                                       0585
@RF00583 LH    @11,TESTRC                                          0585
         LTR   @11,@11                                             0585
         BNP   @RF00585                                            0585
*             CC03=MAX(CC03,LASTCC08);/*                     @Y30LB34*/
         LA    @11,8                                               0586
         CR    CC03,@11                                            0586
         BNL   *+6
         LR    CC03,@11                                            0586
*         END;                      /*                       @Y30LB34*/
@RF00585 DS    0H                                                  0588
*     END;                          /*                       @Y30LB34*/
*                                                                  0588
@RF00577 DS    0H                                                  0589
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/
*   /* RETURN TO CALLER                                      #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0589
*   REG14=RTNREG2;                  /*                       #Y30LB34*/
@RC00544 LR    REG14,RTNREG2                                       0589
*   RETURN CODE(CC03);              /*                       #Y30LB34*/
         LR    @15,CC03                                            0590
@EL00004 DS    0H                                                  0590
@EF00004 DS    0H                                                  0590
@ER00004 BR    @14                                                 0590
*   END TAINFO;                     /*                       #Y30LB34*/
*                                                                  0592
*/********************************************************** #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* PROCEDURE NAME - RVPROC                                  #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* FUNCTION - CONTROLS THE REAL TO VIRTUAL CONVERSION       #Y30LB34*/
*/*                                                          #Y30LB34*/
*/*            CALLS RVINITSO TO INTERROGATE SOURCE VOLUME   #Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RVINITTA TO INTERROGATE TARGET VOLUME   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RVMOVE TO CONTROL THE CONVERSION OF     @Y30LB34*/
*/*            DATA FROM REAL TO VIRTUAL                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            TESTS IF SOURCE VOLUME VTOC SHOULD BE         @Y30LB34*/
*/*            SCRATCHED, AND, IF SO, CALLS RVSCRV           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES SOURCE VOLUME RESERVED IN CHEKSRCE   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM RVINITSO,         @Y30LB34*/
*/*                       RVINITTA, RVMOVE OR RVSCRV         @Y30LB34*/
*/*           R. C. =  8, RETURN CODE FROM RVMOVE            @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM RVINITSO,         @Y30LB34*/
*/*                       RVINITTA, RVMOVE OR RVSCRV         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0592
*RVPROC:                                                           0592
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0592
RVPROC   DS    0H                                                  0593
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0593
*   DCL                                                            0593
*     CC04 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0594
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0594
*   OLDERID2=NEWERID2;                                             0594
         L     @07,@PC00001                                        0594
         L     @07,GDTTR2(,@07)                                    0594
         MVC   @TS00001(95),NEWERID2(@07)                          0594
         MVC   OLDERID2(95,@07),@TS00001                           0594
*   NEWID2='CNT4';                  /*                       @Y30LB34*/
*                                                                  0595
         MVC   NEWID2(4,@07),@CC01696                              0595
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0596
*   CC04=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @07,@07                                             0596
         STH   @07,CC04                                            0596
*   RTNREG1=REG14;                  /*                       @Y30LB34*/
*                                                                  0597
         ST    REG14,RTNREG1                                       0597
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL RVINITSO TO INTERROGATE THE REAL SOURCE VOLUME   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0598
*   CALL RVINITSO;                  /*                       @Y30LB34*/
         BAL   @14,RVINITSO                                        0598
*   RESPECIFY                                                      0599
*     RTNREG RSTD;                                                 0599
*   TESTRC=RTNREG;                                                 0600
         STH   RTNREG,TESTRC                                       0600
*   RESPECIFY                                                      0601
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC04=TESTRC;                    /*                       @Y30LB34*/
*                                                                  0602
         LH    @07,TESTRC                                          0602
         STH   @07,CC04                                            0602
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS OCCURRED IN RVINITSO, CALL        @Y30LB34*/
*   /* RVINITTA TO INTERROGATE THE MSS TARGET VOLUME         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0603
*   IF CC04<LASTCC12 THEN                                          0603
         C     @07,@CF00567                                        0603
         BNL   @RF00603                                            0603
*     DO;                           /*                       @Y30LB34*/
*       CALL RVINITTA;              /*                       @Y30LB34*/
         BAL   @14,RVINITTA                                        0605
*       RESPECIFY                                                  0606
*         RTNREG RSTD;                                             0606
*       TESTRC=RTNREG;                                             0607
         STH   RTNREG,TESTRC                                       0607
*       RESPECIFY                                                  0608
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC04=MAX(CC04,TESTRC);      /*                       @Y30LB34*/
         LH    @07,TESTRC                                          0609
         LH    @15,CC04                                            0609
         CR    @15,@07                                             0609
         BNL   *+6
         LR    @15,@07                                             0609
         STH   @15,CC04                                            0609
*     END;                          /*                       @Y30LB34*/
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, CALL RVMOVE        @Y30LB34*/
*   /* TO HANDLE THE DATA CONVERSION FROM REAL TO VIRTUAL    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0611
*   IF CC04<LASTCC12 THEN                                          0611
@RF00603 LH    @07,CC04                                            0611
         C     @07,@CF00567                                        0611
         BNL   @RF00611                                            0611
*     DO;                           /*                       @Y30LB34*/
*       CALL RVMOVE;                /*                       @Y30LB34*/
         BAL   @14,RVMOVE                                          0613
*       RESPECIFY                                                  0614
*         RTNREG RSTD;                                             0614
*       TESTRC=RTNREG;                                             0615
         STH   RTNREG,TESTRC                                       0615
*       RESPECIFY                                                  0616
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC04=MAX(CC04,TESTRC);      /*                       @Y30LB34*/
         LH    @07,TESTRC                                          0617
         LH    @15,CC04                                            0617
         CR    @15,@07                                             0617
         BNL   *+6
         LR    @15,@07                                             0617
         STH   @15,CC04                                            0617
*     END;                          /*                       @Y30LB34*/
*                                                                  0618
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, AND IF             @Y30LB34*/
*   /* 'NOSCRATCH' WAS NOT SPECIFIED IN A CONTROL            @Y30LB34*/
*   /* STATEMENT, CALL RVSCRV TO SCRATCH THE SOURCE          @Y30LB34*/
*   /* VOLUME VTOC                                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*   IF CC04<LASTCC12 THEN                                          0619
@RF00611 LH    @07,CC04                                            0619
         C     @07,@CF00567                                        0619
         BNL   @RF00619                                            0619
*     IF ADDR(NSCR)=NULLPTR THEN                                   0620
         L     @07,@PC00001+4                                      0620
         L     @07,FDTPTR+36(,@07)                                 0620
         LTR   @07,@07                                             0620
         BNZ   @RF00620                                            0620
*       DO;                         /*                       @Y30LB34*/
*         CALL RVSCRV;              /*                       @Y30LB34*/
         BAL   @14,RVSCRV                                          0622
*         RESPECIFY                                                0623
*           RTNREG RSTD;                                           0623
*         TESTRC=RTNREG;                                           0624
         STH   RTNREG,TESTRC                                       0624
*         RESPECIFY                                                0625
*           RTNREG UNRSTD;          /*                       @Y30LB34*/
*         CC04=MAX(CC04,TESTRC);    /*                       @Y30LB34*/
         LH    @07,TESTRC                                          0626
         LH    @15,CC04                                            0626
         CR    @15,@07                                             0626
         BNL   *+6
         LR    @15,@07                                             0626
         STH   @15,CC04                                            0626
*       END;                        /*                       @Y30LB34*/
*                                                                  0628
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SOURCE VOLUME WAS RESERVED IN CHEKSRCE,        @Y30LB34*/
*   /* DEQUEUE THAT RESERVE AND SET OFF THE SOURCE RESERVE   @Y30LB34*/
*   /* BIT                                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0628
*   IF SRES=ON THEN                                                0628
@RF00620 DS    0H                                                  0628
@RF00619 TM    SRES,B'01000000'                                    0628
         BNO   @RF00628                                            0628
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMERR);/*               @Y30LB34*/
         L     @07,@PC00001                                        0630
         ST    @07,@AL00001                                        0630
         LA    @15,@CC01594                                        0630
         ST    @15,@AL00001+4                                      0630
         LA    @15,RNAMERR                                         0630
         ST    @15,@AL00001+8                                      0630
         MVI   @AL00001+8,X'80'                                    0630
         L     @15,GDTDEQ(,@07)                                    0630
         LA    @01,@AL00001                                        0630
         BALR  @14,@15                                             0630
*       SRES=OFF;                   /*                       @Y30LB34*/
         NI    SRES,B'10111111'                                    0631
*     END;                          /*                       @Y30LB34*/
*                                                                  0632
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLING PROCEDURE                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0633
*   REG14=RTNREG1;                  /*                       @Y30LB34*/
@RF00628 L     REG14,RTNREG1                                       0633
*   RETURN CODE(CC04);              /*                       @Y30LB34*/
         LH    @15,CC04                                            0634
@EL00005 DS    0H                                                  0634
@EF00005 DS    0H                                                  0634
@ER00005 BR    @14                                                 0634
*   END RVPROC;                     /*                       @Y30LB34*/
*                                                                  0636
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RVINITSO                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - INTERROGATES THE REAL SOURCE VOLUME           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RVGETSO TO DEMOUNT THE TARGET VOLUME    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS CHEKSRCE TO CHECK SOURCE VOLUME         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - SAMESER                                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM CHEKSRCE          @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM RVGETSO OR        @Y30LB34*/
*/*                       CHEKSRCE                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0636
*RVINITSO:                                                         0636
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0636
RVINITSO DS    0H                                                  0637
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0637
*   DCL                                                            0637
*     CC05 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0638
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0638
*   OLDERID2=NEWERID2;                                             0638
         L     @10,@PC00001                                        0638
         L     @10,GDTTR2(,@10)                                    0638
         MVC   @TS00001(95),NEWERID2(@10)                          0638
         MVC   OLDERID2(95,@10),@TS00001                           0638
*   NEWID2='CNT5';                  /*                       @Y30LB34*/
*                                                                  0639
         MVC   NEWID2(4,@10),@CC01705                              0639
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0640
*   CC05=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC05,CC05                                           0640
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  0641
         LR    RTNREG2,REG14                                       0641
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL RVGETSO TO INITIALIZE MOUNT/DEMOUNT PARAMETER    @Y30LB34*/
*   /* LISTS AND IF SERIAL NUMBERS ARE THE SAME, DEMOUNT     @Y30LB34*/
*   /* MSS TARGET VOLUME                                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0642
*   CALL RVGETSO;                   /*                       @Y30LB34*/
         BAL   @14,RVGETSO                                         0642
*   RESPECIFY                                                      0643
*     RTNREG RSTD;                                                 0643
*   TESTRC=RTNREG;                                                 0644
         STH   RTNREG,TESTRC                                       0644
*   RESPECIFY                                                      0645
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC05=TESTRC;                    /*                       @Y30LB34*/
*                                                                  0646
         LH    @15,TESTRC                                          0646
         LR    CC05,@15                                            0646
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS OCCURRED, CALL CHEKSRCE TO        @Y30LB34*/
*   /* PERFORM SECURITY CHECKING ON THE SOURCE VOLUME AND    @Y30LB34*/
*   /* CHECK JOB SETUP WITH RESPECT TO THE SOURCE VOLUME     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0647
*   IF CC05<LASTCC12 THEN                                          0647
         C     CC05,@CF00567                                       0647
         BNL   @RF00647                                            0647
*     DO;                           /*                       @Y30LB34*/
*       CALL CHEKSRCE;              /*                       @Y30LB34*/
         BAL   @14,CHEKSRCE                                        0649
*       RESPECIFY                                                  0650
*         RTNREG RSTD;                                             0650
*       TESTRC=RTNREG;                                             0651
         STH   RTNREG,TESTRC                                       0651
*       RESPECIFY                                                  0652
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC05=MAX(CC05,TESTRC);      /*                       @Y30LB34*/
         LH    @10,TESTRC                                          0653
         CR    CC05,@10                                            0653
         BNL   *+6
         LR    CC05,@10                                            0653
*     END;                          /*                       @Y30LB34*/
*                                                                  0655
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0655
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RF00647 LR    REG14,RTNREG2                                       0655
*   RETURN CODE(CC05);              /*                       @Y30LB34*/
         LR    @15,CC05                                            0656
@EL00006 DS    0H                                                  0656
@EF00006 DS    0H                                                  0656
@ER00006 BR    @14                                                 0656
*   END RVINITSO;                   /*                       @Y30LB34*/
*                                                                  0658
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RVGETSO                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - OBTAINS EXCLUSIVE CONTROL OF THE TARGET       @YD00175*/
*/*            MASS STORAGE VOL PRIOR TO POSSIBLE DEMOUNT.   @YD00175*/
*/*            INITIALIZES THE MOUNT/DEMOUNT PARM LIST FOR   @YD00175*/
*/*            THE VIRTUAL TARGET VOLUME.                    @YD00175*/
*/*                                                          #Y30LB34*/
*/*            IF THE VOLUMES HAVE THE SAME VOLSERS,         #Y30LB34*/
*/*            INITIALIZES THE POST/CLEAR PARM LIST FOR THE  #Y30LB34*/
*/*            SOURCE VOLUME                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEMOUNTS THE MSS VOLUME IF SOURCE AND         @Y30LB34*/
*/*            TARGET SERIAL NUMBERS ARE THE SAME            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, MDAGL, PUAGL, SRCEAREA,     @Y30LB34*/
*/*         TARGAREA, AND SAMESER                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - MDAGL, PUAGL, SRCEAREA, TARGAREA                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. = 12, UNABLE TO DEMOUNT MSS VOLUME       @Y30LB34*/
*/*                   OR OBTAIN EXCLUSIVE CONTROL OF VOLUME  @YD00175*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0658
*RVGETSO:                                                          0658
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0658
RVGETSO  DS    0H                                                  0659
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0659
*   DCL                                                            0659
*     CC06 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0660
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0660
*   OLDERID2=NEWERID2;                                             0660
         L     @08,@PC00001                                        0660
         L     @15,GDTTR2(,@08)                                    0660
         MVC   @TS00001(95),NEWERID2(@15)                          0660
         MVC   OLDERID2(95,@15),@TS00001                           0660
*   NEWID2='CNT6';                  /*                       @Y30LB34*/
*                                                                  0661
         MVC   NEWID2(4,@15),@CC01712                              0661
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0662
*   CC06=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC06,CC06                                           0662
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  0663
         ST    REG14,RTNREG3                                       0663
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE PARAMETER LIST TO GET EXCLUSIVE        @YD00175*/
*   /* CONTROL                                               @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0664
*   EXCLAGL=''B;                    /*                       @YD00175*/
         LA    @15,EXCLAR                                          0664
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        0664
*   EXCLUCBP=ADDR(TUCBADDR);        /*                       @YD00175*/
         LA    @14,TUCBADDR                                        0665
         ST    @14,EXCLUCBP(,@15)                                  0665
*   EXCLDDP=ADDR(TFILEVAL);         /*                       @YD00175*/
*                                                                  0666
         L     @14,@PC00001+4                                      0666
         L     @01,FDTPTR+4(,@14)                                  0666
         LA    @14,TFILEVAL(,@01)                                  0666
         ST    @14,EXCLDDP(,@15)                                   0666
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL               @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0667
*   CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*                 @YD00175*/
         ST    @08,@AL00001                                        0667
         LA    @14,CHANGEX                                         0667
         ST    @14,@AL00001+4                                      0667
         ST    @15,@AL00001+8                                      0667
         MVI   @AL00001+8,X'80'                                    0667
         L     @15,GDTUNT(,@08)                                    0667
         LA    @01,@AL00001                                        0667
         BALR  @14,@15                                             0667
*   RESPECIFY                                                      0668
*     RTNREG RSTD;                                                 0668
*   TESTRC=RTNREG;                                                 0669
         STH   RTNREG,TESTRC                                       0669
*   RESPECIFY                                                      0670
*     RTNREG UNRSTD;                /*                       @YD00175*/
*                                                                  0670
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RETURN CODE FROM UMSSUNIT NOT ZERO, SET INTERNAL   @YD00175*/
*   /* CONDITION CODE TO 12                                  @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0671
*   IF TESTRC>0 THEN                                               0671
         LH    @08,TESTRC                                          0671
         LTR   @08,@08                                             0671
         BNP   @RF00671                                            0671
*     CC06=LASTCC12;                /*                       @YD00175*/
*                                                                  0672
         LA    CC06,12                                             0672
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE UMSSUNIT MOUNT/DEMOUNT PARM LIST       #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0673
*   MDUCBPTR=ADDR(TUCBADDR);        /*                       #Y30LB34*/
@RF00671 LA    @08,MDAGLAR                                         0673
         LA    @15,TUCBADDR                                        0673
         ST    @15,MDUCBPTR(,@08)                                  0673
*   MDDDNAME=TFILEVAL;              /*                       #Y30LB34*/
         L     @15,@PC00001+4                                      0674
         L     @01,FDTPTR+4(,@15)                                  0674
         MVC   MDDDNAME(8,@08),TFILEVAL(@01)                       0674
*   MDLABEL=TVOLSER;                /*                       #Y30LB34*/
         MVC   MDLABEL(6,@08),TVOLSER                              0675
*                                                                  0676
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SOURCE AND TARGET VOLSERS ARE EQUAL, INITIALIZE    @Y30LB34*/
*   /* THE UMSSUNIT POST/CLEAR PARM LIST AND DEMOUNT THE     @Y30LB34*/
*   /* MSS TARGET VOLUME                                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0676
*   IF CC06=0&SAMESER=ON THEN                                      0676
         LTR   CC06,CC06                                           0676
         BNZ   @RF00676                                            0676
         TM    SAMESER,B'10000000'                                 0676
         BNO   @RF00676                                            0676
*     DO;                           /*                       @YD00175*/
*       PUUCBPTR=ADDR(SUCBADDR);    /*                       @Y30LB34*/
         LA    @15,PUAGLAR                                         0678
         LA    @14,SUCBADDR                                        0678
         ST    @14,PUUCBPTR(,@15)                                  0678
*       PULABELP=ADDR(SLABEL);      /*                       @Y30LB34*/
         LA    @14,SLABEL                                          0679
         ST    @14,PULABELP(,@15)                                  0679
*       PUTTRPTR=ADDR(SVTOCTTR);    /*                       @Y30LB34*/
         LA    @14,SVTOCTTR                                        0680
         ST    @14,PUTTRPTR(,@15)                                  0680
*       MDPUAGL=ADDR(PUAGLAR);      /*                       @Y30LB34*/
*                                                                  0681
         ST    @15,MDPUAGL(,@08)                                   0681
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT TO DEMOUNT THE MSS TARGET VOLUME   @Y30LB34*/
*       /* IF IT IS MOUNTED. THE REAL VOLUME CAN THEN BE     @Y30LB34*/
*       /* MOUNTED WITHOUT DUPLICATE SERIAL NUMBERS. IF THE  @Y30LB34*/
*       /* TARGET VOLUME IS NOT MOUNTED, UMSSUNIT RETURNS A  @Y30LB34*/
*       /* SUCCESSFUL COMPLETION CODE SAYING IT IS DEMOUNTED @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0682
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB34*/
         L     @15,@PC00001                                        0682
         ST    @15,@AL00001                                        0682
         LA    @14,DEMOUNT                                         0682
         ST    @14,@AL00001+4                                      0682
         ST    @08,@AL00001+8                                      0682
         MVI   @AL00001+8,X'80'                                    0682
         L     @15,GDTUNT(,@15)                                    0682
         LA    @01,@AL00001                                        0682
         BALR  @14,@15                                             0682
*       RESPECIFY                                                  0683
*         RTNREG RSTD;                                             0683
*       TESTRC=RTNREG;                                             0684
         STH   RTNREG,TESTRC                                       0684
*       RESPECIFY                                                  0685
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  0685
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE CONDITION  @Y30LB34*/
*       /* CODE TO 12 AND TERMINATE THE COMMAND              @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0686
*       IF TESTRC>0 THEN                                           0686
         LH    @08,TESTRC                                          0686
         LTR   @08,@08                                             0686
         BNP   @RF00686                                            0686
*         CC06=LASTCC12;            /*                       @Y30LB34*/
         LA    CC06,12                                             0687
*     END;                          /*                       @Y30LB34*/
*                                                                  0688
@RF00686 DS    0H                                                  0689
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0689
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RF00676 L     REG14,RTNREG3                                       0689
*   RETURN CODE(CC06);              /*                       @Y30LB34*/
         LR    @15,CC06                                            0690
@EL00007 DS    0H                                                  0690
@EF00007 DS    0H                                                  0690
@ER00007 BR    @14                                                 0690
*   END RVGETSO;                    /*                       @Y30LB34*/
*                                                                  0692
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - CHEKSRCE                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - PERFORMS SOURCE VOLUME CHECKING               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES IDCVS01 PARM LIST FOR ALL         @Y30LB34*/
*/*            VOLUME SERVICES REQUESTS ON THE SOURCE VOLUME @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VOLUME SERVICES TO PERFORM SECURITY     @Y30LB34*/
*/*            CHECKING AND TESTING FOR VSAM OWNERSHIP       @Y30LB34*/
*/*            AND USER CATALOG ON VOLUME                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF VOLUME IS VSAM, DETERMINES IF ERROR        @Y30LB34*/
*/*            CONDITIONS EXIST IN CONTROL STATEMENTS        @Y30LB34*/
*/*            WHICH SHOULD CAUSE TERMINATION OF THE         @Y30LB34*/
*/*            COMMAND                                       @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3741I FOR AN      @Y30LB34*/
*/*                INVALID RECATALOG OPTION,                 @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3067I FOR AN      @Y30LB34*/
*/*                INVALID SERIAL NUMBER SPECIFIED,          @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3745I FOR NOT     @Y30LB34*/
*/*                SUPPLYING A DD NAME FOR USER CATALOG      @Y30LB34*/
*/*                ON VOLUME,                                @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3744I FOR USING   @Y30LB34*/
*/*                A JOBCAT OR STEPCAT STATEMENT TO OPEN     @Y30LB34*/
*/*                USER CATALOG ON VOLUME.                   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CLOSES THE VTOC OPENED BY VOLUME SERVICES     @Y30LB34*/
*/*                                                          @YD00175*/
*/*            GETS EXCLUSIVE CONTROL OF SOURCE VOLUME USING @YD00175*/
*/*            UMSSUNIT MACRO                                @YD00175*/
*/*                                                          @Y30LB34*/
*/* INPUT - FRVS1AGL, SRCEAREA, FUNCTION DATA TABLE,         @Y30LB34*/
*/*         DARGLIST                                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INITIALIZED FRVS1AGL                            @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/
*/*           R. C. = 12, SECURITY CHECKING FAILED,          @Y30LB34*/
*/*                       INVALID CONTROL STATEMENT,         @YD00175*/
*/*                       UNABLE TO OBTAIN EXCLUSIVE CONTROL @YD00175*/
*/*                        OF SOURCE VOLUME                  @YD00175*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0692
*CHEKSRCE:                                                         0692
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0692
CHEKSRCE DS    0H                                                  0693
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0693
*   DCL                                                            0693
*     CC07 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0694
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0694
*   OLDERID2=NEWERID2;                                             0694
         L     @08,@PC00001                                        0694
         L     @08,GDTTR2(,@08)                                    0694
         MVC   @TS00001(95),NEWERID2(@08)                          0694
         MVC   OLDERID2(95,@08),@TS00001                           0694
*   NEWID2='CNT7';                  /*                       @Y30LB34*/
*                                                                  0695
         MVC   NEWID2(4,@08),@CC01717                              0695
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0696
*   CC07=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             0696
         LR    CC07,@15                                            0696
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  0697
         ST    REG14,RTNREG3                                       0697
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IDCVS01 PARM LIST FOR ALL VOLUME       @Y30LB34*/
*   /* SERVICES REQUESTS TO THE SOURCE VOLUME                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0698
*   RESPECIFY                                                      0698
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/
*   VSUCMAST=ON;                    /*                       @Y30LB34*/
*   VSREAD=ON;                      /*                       @Y30LB34*/
*   VSOPCAT=ON;                     /*                       @Y30LB34*/
*   VSUCTEST=ON;                    /*                       @Y30LB34*/
         LA    @08,FRVS1AGL                                        0702
         OI    VSUCMAST(@08),B'00010111'                           0702
*   VSFROMV=ON;                     /*                       @Y30LB34*/
         OI    VSFROMV(@08),B'10000000'                            0703
*   VSVOLP=ADDR(SVOLSER);           /*                       @Y30LB34*/
         LA    @14,SVOLSER                                         0704
         ST    @14,VSVOLP(,@08)                                    0704
*   VSFILEP=ADDR(FFILEVAL);         /*                       @Y30LB34*/
         L     @14,@PC00001+4                                      0705
         L     @01,FDTPTR(,@14)                                    0705
         LA    @01,FFILEVAL(,@01)                                  0705
         ST    @01,VSFILEP(,@08)                                   0705
*   IF ADDR(CATN)^=NULLPTR THEN                                    0706
         L     @14,FDTPTR+44(,@14)                                 0706
         CR    @14,@15                                             0706
         BE    @RF00706                                            0706
*     DO;                           /*                       @Y30LB34*/
*       VSCATP=ADDR(CATNVAL);       /*                       @Y30LB34*/
         LA    @15,CATNVAL(,@14)                                   0708
         ST    @15,VSCATP(,@08)                                    0708
*       VSPSWDP=ADDR(CATNPAS);      /*                       @Y30LB34*/
         LA    @15,CATNPAS(,@14)                                   0709
         ST    @15,VSPSWDP(,@08)                                   0709
*     END;                          /*                       @Y30LB34*/
*   VSCATDDP=ADDR(SCATDD);          /*                       @Y30LB34*/
@RF00706 LA    @08,FRVS1AGL                                        0711
         LA    @15,SCATDD                                          0711
         ST    @15,VSCATDDP(,@08)                                  0711
*   VSPFILEP=ADDR(PFILE);           /*                       @Y30LB34*/
         L     @15,@PC00001+4                                      0712
         L     @15,FDTPTR+60(,@15)                                 0712
         ST    @15,VSPFILEP(,@08)                                  0712
*   IF STYPEVOL='REAL' THEN                                        0713
         CLC   STYPEVOL(4),@CC01679                                0713
         BNE   @RF00713                                            0713
*     VSREAL=ON;                    /*                       @Y30LB34*/
         OI    VSREAL(@08),B'01000000'                             0714
*   VSUCBP=ADDR(SUCBADDR);          /*                       @Y30LB34*/
@RF00713 LA    @08,FRVS1AGL                                        0715
         LA    @15,SUCBADDR                                        0715
         ST    @15,VSUCBP(,@08)                                    0715
*   VSDEVP=ADDR(SDEVTYPE);          /*                       @Y30LB34*/
         LA    @15,SDEVTYPE                                        0716
         ST    @15,VSDEVP(,@08)                                    0716
*                                                                  0717
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VOLUME SERVICES TO PERFORM SECURITY CHECKING     @Y30LB34*/
*   /* ON THE SOURCE VOLUME. SINCE THE VIRTUAL VOLUME        @ZA08840*/
*   /* IS TO BE RESERVED BEFORE IT IS MOUNTED, THE           @ZA08840*/
*   /* VSRES AND SRES BITS ARE TURNED ON.                    @ZA08840*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*   IF CONVTYPE=VR THEN                                            0717
         TM    CONVTYPE,B'01000000'                                0717
         BNZ   @RF00717                                            0717
*     DO;                           /*                       @ZA08840*/
*       VSRES=ON;                   /*                       #Y30LB34*/
         OI    VSRES(@08),B'10000000'                              0719
*       SRES=ON;                    /*                       @ZA08840*/
         OI    SRES,B'01000000'                                    0720
*     END;                          /*                       @ZA08840*/
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*      #Y30LB34*/
@RF00717 L     @08,@PC00001                                        0722
         ST    @08,@AL00001                                        0722
         LA    @15,@CC01720                                        0722
         ST    @15,@AL00001+4                                      0722
         LA    @15,SECCHECK                                        0722
         ST    @15,@AL00001+8                                      0722
         LA    @15,FRVS1AGL                                        0722
         ST    @15,@AL00001+12                                     0722
         MVI   @AL00001+12,X'80'                                   0722
         L     @15,GDTCAL(,@08)                                    0722
         LA    @01,@AL00001                                        0722
         BALR  @14,@15                                             0722
*   RESPECIFY                                                      0723
*     RTNREG RSTD;                                                 0723
*   TESTRC=RTNREG;                                                 0724
         STH   RTNREG,TESTRC                                       0724
*   RESPECIFY                                                      0725
*     RTNREG UNRSTD;                /*                       #Y30LB34*/
*                                                                  0725
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERVICES WAS UNSUCCESSFUL OR THE SECURITY   #Y30LB34*/
*   /* CHECKING FAILED, SET THE CONDITION CODE TO 12.        #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0726
*   IF TESTRC=4 THEN                                               0726
         LH    @08,TESTRC                                          0726
         C     @08,@CF00036                                        0726
         BNE   @RF00726                                            0726
*     CC07=LASTCC12;                /*                       #Y30LB34*/
*                                                                  0727
         LA    CC07,12                                             0727
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERVICES COULD NOT CLOSE A DATA SET,        #Y30LB34*/
*   /* SET THE CONDITION CODE TO 4.                          #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0728
*   IF TESTRC=8 THEN                                               0728
@RF00726 CLC   TESTRC(2),@CH00177                                  0728
         BNE   @RF00728                                            0728
*     CC07=LASTCC04;                /*                       #Y30LB34*/
*                                                                  0729
         LA    CC07,4                                              0729
*   /*****************************************************************/
*   /*                                                               */
*   /* SET OFF THE VSRES RESERVE BIT.                        @ZA08840*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0730
*   VSRES=OFF;                      /*                       #Y30LB34*/
@RF00728 LA    @08,FRVS1AGL                                        0730
         NI    VSRES(@08),B'01111111'                              0730
*                                                                  0731
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR ERRORS IN JOB SETUP FOR A VSAM VOLUME        @Y30LB34*/
*   /* (IF A SEVERE ERROR OCCURRED IN SECURITY CHECKING,     @Y30LB34*/
*   /* THE VSAM VOLUME FLAG WILL NOT HAVE BEEN SET ON AND    @Y30LB34*/
*   /* THIS STEP WILL BE BYPASSED.)                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0731
*   IF VSVSAM=ON THEN                                              0731
         TM    VSVSAM(@08),B'10000000'                             0731
         BNO   @RF00731                                            0731
*     DO;                           /*                       @Y30LB34*/
*                                                                  0732
*       /*************************************************************/
*       /*                                                           */
*       /* SET VSAM BIT ON FOR SOURCE VOLUME WHICH WILL      @Y30LB34*/
*       /* REFERENCED IN CHEKTARG                            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0733
*       SVSAM=ON;                   /*                       @Y30LB34*/
*                                                                  0733
         OI    SVSAM,B'00100000'                                   0733
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR A RECATALOG OPTION OF 'NONE' FOR A       @Y30LB34*/
*       /* VSAM VOLUME. IF FOUND, ISSUE ERROR MESSAGE        @Y30LB34*/
*       /* IDC3741I AND SET CONDITION CODE TO 12.            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0734
*       IF ADDR(NONE)^=NULLPTR THEN                                0734
         SLR   @08,@08                                             0734
         L     @15,@PC00001+4                                      0734
         C     @08,FDTPTR+28(,@15)                                 0734
         BE    @RF00734                                            0734
*         DO;                       /*                       @Y30LB34*/
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @15,DDSTRU                                          0736
         MVC   DARGSMOD(3,@15),@CC01557                            0736
*           DARGSENT=MSG3741I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'05'                                 0737
*           DARGDBP=0;              /*                       @Y30LB34*/
         ST    @08,DARGDBP(,@15)                                   0738
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @08,DARGILP(,@15)                                   0739
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @08,DARGRETP(,@15)                                  0740
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        0741
         ST    @08,@AL00001                                        0741
         LA    @15,@CF00115                                        0741
         ST    @15,@AL00001+4                                      0741
         LA    @15,DDSTRU                                          0741
         ST    @15,@AL00001+8                                      0741
         MVI   @AL00001+8,X'80'                                    0741
         L     @15,GDTPRT(,@08)                                    0741
         LA    @01,@AL00001                                        0741
         BALR  @14,@15                                             0741
*           CC07=LASTCC12;          /*                       @Y30LB34*/
         LA    CC07,12                                             0742
*         END;                      /*                       @Y30LB34*/
*                                                                  0743
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THE VOLSER FOR THE TARGET            @Y30LB34*/
*       /* VOL IS NOT THE SAME AS THE SOURCE VOL, ISSUE      @Y30LB34*/
*       /* MESSAGE IDC3067I AND SET CONDITITON CODE TO 12    @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0744
*       IF SAMESER=OFF THEN                                        0744
@RF00734 TM    SAMESER,B'10000000'                                 0744
         BNZ   @RF00744                                            0744
*         DO;                       /*                       @Y30LB34*/
*           DARGSMOD=COMMSG;        /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0746
         MVC   DARGSMOD(3,@08),@CC01555                            0746
*           DARGSENT=MSG3067I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'29'                                 0747
*           DARGDBP=ADDR(SVOLSER);  /*                       @Y30LB34*/
         LA    @15,SVOLSER                                         0748
         ST    @15,DARGDBP(,@08)                                   0748
*           DARGILP=LENGTH(SVOLSER);/*                       @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             0749
*           DARGRETP=0;             /*                       @Y30LB34*/
         SLR   @15,@15                                             0750
         ST    @15,DARGRETP(,@08)                                  0750
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        0751
         ST    @08,@AL00001                                        0751
         LA    @15,@CF00115                                        0751
         ST    @15,@AL00001+4                                      0751
         LA    @15,DDSTRU                                          0751
         ST    @15,@AL00001+8                                      0751
         MVI   @AL00001+8,X'80'                                    0751
         L     @15,GDTPRT(,@08)                                    0751
         LA    @01,@AL00001                                        0751
         BALR  @14,@15                                             0751
*           CC07=LASTCC12;          /*                       @Y30LB34*/
         LA    CC07,12                                             0752
*         END;                      /*                       @Y30LB34*/
*                                                                  0754
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR ERRORS IN JOB SETUP FOR A USER           @Y30LB34*/
*       /* CATALOG ON THE VOLUME.                            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0754
*       IF VSUCAT=ON THEN                                          0754
@RF00744 LA    @08,FRVS1AGL                                        0754
         TM    VSUCAT(@08),B'01000000'                             0754
         BNO   @RF00754                                            0754
*         DO;                       /*                       @Y30LB34*/
*                                                                  0755
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO DD NAME WAS SUPPLIED OR RETURNED        @Y30LB34*/
*           /* BY VOLUME SERVICES FOR THE USER CATALOG       @Y30LB34*/
*           /* ON THE VOLUME, ISSUE ERROR MESSAGE            @Y30LB34*/
*           /* IDC3745I AND SET CONDITION CODE TO 12         @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0756
*           IF VSCATDDP=NULLPTR×SCATDD=' ' THEN                    0756
         L     @08,VSCATDDP(,@08)                                  0756
         LTR   @08,@08                                             0756
         BZ    @RT00756                                            0756
         CLI   SCATDD,C' '                                         0756
         BNE   @RF00756                                            0756
@RT00756 DS    0H                                                  0757
*             DO;                   /*                       @ZA09518*/
*               DARGSMOD=CONVMSG;   /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0758
         MVC   DARGSMOD(3,@08),@CC01557                            0758
*               DARGSENT=MSG3745I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'09'                                 0759
*               DARGDBP=0;          /*                       @Y30LB34*/
         SLR   @15,@15                                             0760
         ST    @15,DARGDBP(,@08)                                   0760
*               DARGILP=0;          /*                       @Y30LB34*/
         STH   @15,DARGILP(,@08)                                   0761
*               DARGRETP=0;         /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@08)                                  0762
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/
         L     @08,@PC00001                                        0763
         ST    @08,@AL00001                                        0763
         LA    @15,@CF00115                                        0763
         ST    @15,@AL00001+4                                      0763
         LA    @15,DDSTRU                                          0763
         ST    @15,@AL00001+8                                      0763
         MVI   @AL00001+8,X'80'                                    0763
         L     @15,GDTPRT(,@08)                                    0763
         LA    @01,@AL00001                                        0763
         BALR  @14,@15                                             0763
*               CC07=LASTCC12;      /*                       @Y30LB34*/
         LA    CC07,12                                             0764
*             END;                  /*                       @Y30LB34*/
*                                                                  0765
*           /*********************************************************/
*           /*                                                       */
*           /* IF A DD NAME WAS SUPPLIED OR RETURNED         @Y30LB34*/
*           /* BY VOLUME SERVICES FOR THE USER CATALOG       @Y30LB34*/
*           /* ON THE VOLUME, DETERMINE IF IT IS JOBCAT      @Y30LB34*/
*           /* OR STEPCAT. IF SO, ISSUE ERROR MESSAGE        @Y30LB34*/
*           /* IDC3744I AND SET CONDITION CODE TO 12         @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0766
*           ELSE                                                   0766
*             IF SCATDD='JOBCAT  '×SCATDD='STEPCAT ' THEN          0766
         B     @RC00756                                            0766
@RF00756 CLC   SCATDD(8),@CC01721                                  0766
         BE    @RT00766                                            0766
         CLC   SCATDD(8),@CC01722                                  0766
         BNE   @RF00766                                            0766
@RT00766 DS    0H                                                  0767
*               DO;                 /*                       @Y30LB34*/
*                 DARGSMOD=CONVMSG; /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0768
         MVC   DARGSMOD(3,@08),@CC01557                            0768
*                 DARGSENT=MSG3744I;/*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'08'                                 0769
*                 DARGDBP=0;        /*                       @Y30LB34*/
         SLR   @15,@15                                             0770
         ST    @15,DARGDBP(,@08)                                   0770
*                 DARGILP=0;        /*                       @Y30LB34*/
         STH   @15,DARGILP(,@08)                                   0771
*                 DARGRETP=0;       /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@08)                                  0772
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB34*/
         L     @08,@PC00001                                        0773
         ST    @08,@AL00001                                        0773
         LA    @15,@CF00115                                        0773
         ST    @15,@AL00001+4                                      0773
         LA    @15,DDSTRU                                          0773
         ST    @15,@AL00001+8                                      0773
         MVI   @AL00001+8,X'80'                                    0773
         L     @15,GDTPRT(,@08)                                    0773
         LA    @01,@AL00001                                        0773
         BALR  @14,@15                                             0773
*                 CC07=LASTCC12;    /*                       @Y30LB34*/
         LA    CC07,12                                             0774
*               END;                /*                       @Y30LB34*/
*         END;                      /*                       @Y30LB34*/
@RF00766 DS    0H                                                  0776
@RC00756 DS    0H                                                  0777
*     END;                          /*                       @Y30LB34*/
@RF00754 DS    0H                                                  0778
*                                                                  0778
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VTOC WAS OPENED BY VOLUME SERVICES, CLOSE IT   @Y30LB34*/
*   /* AND RESET THE IOCSTR POINTER TO 0.                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0778
*   IF VSIOP^=NULLPTR THEN                                         0778
@RF00731 LA    @08,FRVS1AGL                                        0778
         L     @15,VSIOP(,@08)                                     0778
         LTR   @15,@15                                             0778
         BZ    @RF00778                                            0778
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB34*/
         L     @15,@PC00001                                        0780
         ST    @15,@AL00001                                        0780
         LA    @08,VSIOP(,@08)                                     0780
         ST    @08,@AL00001+4                                      0780
         MVI   @AL00001+4,X'80'                                    0780
         L     @15,GDTCLS(,@15)                                    0780
         LA    @01,@AL00001                                        0780
         BALR  @14,@15                                             0780
*       RESPECIFY                                                  0781
*         RTNREG RSTD;                                             0781
*       TESTRC=RTNREG;                                             0782
         STH   RTNREG,TESTRC                                       0782
*       RESPECIFY                                                  0783
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC07=MAX(CC07,TESTRC);      /*                       @Y30LB34*/
         LH    @08,TESTRC                                          0784
         CR    CC07,@08                                            0784
         BNL   *+6
         LR    CC07,@08                                            0784
*       VSIOP=NULLPTR;              /*                       @Y30LB34*/
         LA    @08,FRVS1AGL                                        0785
         SLR   @15,@15                                             0785
         ST    @15,VSIOP(,@08)                                     0785
*     END;                          /*                       @Y30LB34*/
*                                                                  0787
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS SO FAR, GET EXCLUSIVE CONTROL OF VOLUME  @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0787
*   IF CC07<LASTCC12 THEN                                          0787
@RF00778 C     CC07,@CF00567                                       0787
         BNL   @RF00787                                            0787
*     DO;                           /*                       @YD00175*/
*                                                                  0788
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARAMETER LIST                             @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0789
*       EXCLAGL=EXCLAGL&&EXCLAGL;   /*                       @YD00175*/
         LA    @08,EXCLAR                                          0789
         XC    EXCLAGL(23,@08),EXCLAGL(@08)                        0789
*       EXCLUCBP=ADDR(SUCBADDR);    /*                       @YD00175*/
         LA    @15,SUCBADDR                                        0790
         ST    @15,EXCLUCBP(,@08)                                  0790
*       EXCLDDP=ADDR(FFILEVAL);     /*                       @YD00175*/
*                                                                  0791
         L     @15,@PC00001+4                                      0791
         L     @01,FDTPTR(,@15)                                    0791
         LA    @15,FFILEVAL(,@01)                                  0791
         ST    @15,EXCLDDP(,@08)                                   0791
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0792
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/
         L     @15,@PC00001                                        0792
         ST    @15,@AL00001                                        0792
         LA    @14,CHANGEX                                         0792
         ST    @14,@AL00001+4                                      0792
         ST    @08,@AL00001+8                                      0792
         MVI   @AL00001+8,X'80'                                    0792
         L     @15,GDTUNT(,@15)                                    0792
         LA    @01,@AL00001                                        0792
         BALR  @14,@15                                             0792
*       RESPECIFY                                                  0793
*         RTNREG RSTD;                                             0793
*       TESTRC=RTNREG;                                             0794
         STH   RTNREG,TESTRC                                       0794
*       RESPECIFY                                                  0795
*         RTNREG UNRSTD;            /*                       @YD00175*/
*                                                                  0795
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXCLUSIVE CONTROL NO OBTAINED, SET RETURN CODE @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0796
*       IF TESTRC>0 THEN                                           0796
         LH    @08,TESTRC                                          0796
         LTR   @08,@08                                             0796
         BNP   @RF00796                                            0796
*         CC07=LASTCC12;            /*                       @YD00175*/
         LA    CC07,12                                             0797
*     END;                          /*                       @YD00175*/
*                                                                  0798
@RF00796 DS    0H                                                  0799
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/
*   /* RETURN TO CALLER                                      #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0799
*   REG14=RTNREG3;                  /*                       #Y30LB34*/
@RF00787 L     REG14,RTNREG3                                       0799
*   RETURN CODE(CC07);              /*                       #Y30LB34*/
         LR    @15,CC07                                            0800
@EL00008 DS    0H                                                  0800
@EF00008 DS    0H                                                  0800
@ER00008 BR    @14                                                 0800
*   END CHEKSRCE;                   /*                       #Y30LB34*/
*                                                                  0802
*/********************************************************** #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* PROCEDURE NAME - RVINITTA                                #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* FUNCTION - INTERROGATES THE MSS TARGET VOLUME            #Y30LB34*/
*/*                                                          #Y30LB34*/
*/*            ENQUEUES THE TARGET VOLUME                    #Y30LB34*/
*/*                                                          #Y30LB34*/
*/*            CALLS RVGETTA TO ACCESS THE MSVC BASE VOLUME  #Y30LB34*/
*/*            RECORD TO RETRIEVE VOLUME INFORMATION         #Y30LB34*/
*/*                                                          #Y30LB34*/
*/*            MOUNTS THE TARGET VOLUME IF SOURCE AND        #Y30LB34*/
*/*            TARGET VOLSERS ARE THE SAME                   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS CHEKTARG TO CHECK THE TARGET VOLUME     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES TARGET VOLUME RESERVED IN CHEKTARG   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEMOUNTS THE TARGET VOLUME IF IT WAS MOUNTED  @Y30LB34*/
*/*            ABOVE                                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF A SEVERE ERROR HAS OCCURRED, DEQUEUES      @Y30LB34*/
*/*            TARGET VOLUME ENQUEUED IN THIS PROCEDURE      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - TARGAREA, MDAGL, PUAGL                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - TARGAREA                                        @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM CHEKTARG          @Y30LB34*/
*/*           R. C. = 12, UNABLE TO MOUNT VOLUME,            @Y30LB34*/
*/*                       UNABLE TO DEMOUNT VOLUME,          @Y30LB34*/
*/*                       RETURN CODE FROM RVGETTA OR        @Y30LB34*/
*/*                       CHEKTARG                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0802
*RVINITTA:                                                         0802
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0802
RVINITTA DS    0H                                                  0803
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0803
*   DCL                                                            0803
*     CC08 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0804
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0804
*   OLDERID2=NEWERID2;                                             0804
         L     @08,@PC00001                                        0804
         L     @15,GDTTR2(,@08)                                    0804
         MVC   @TS00001(95),NEWERID2(@15)                          0804
         MVC   OLDERID2(95,@15),@TS00001                           0804
*   NEWID2='CNT8';                  /*                       @Y30LB34*/
*                                                                  0805
         MVC   NEWID2(4,@15),@CC01727                              0805
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0806
*   CC08=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC08,CC08                                           0806
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  0807
         LR    RTNREG2,REG14                                       0807
*   /*****************************************************************/
*   /*                                                               */
*   /* ENQUEUE THE MSS TARGET VOLUME AND SET THE BIT ON IN   @Y30LB34*/
*   /* TARGAREA                                              @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0808
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,QNAME,RNAMEVE);/*         @Y30LB34*/
         MVC   @AL00001+4(12),@AL00808                             0808
         ST    @08,@AL00001                                        0808
         LA    @09,RNAMEVE                                         0808
         ST    @09,@AL00001+16                                     0808
         MVI   @AL00001+16,X'80'                                   0808
         L     @15,GDTENQ(,@08)                                    0808
         LA    @01,@AL00001                                        0808
         BALR  @14,@15                                             0808
*   TENQ=ON;                        /*                       @Y30LB34*/
*                                                                  0809
         OI    TENQ,B'10000000'                                    0809
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL RVGETTA TO ACCESS THE MSVC BASE VOLUME RECORD    @Y30LB34*/
*   /* AND VERIFY THE TARGET VOLUME'S USABILITY              @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0810
*   CALL RVGETTA;                   /*                       @Y30LB34*/
         BAL   @14,RVGETTA                                         0810
*   RESPECIFY                                                      0811
*     RTNREG RSTD;                                                 0811
*   TESTRC=RTNREG;                                                 0812
         STH   RTNREG,TESTRC                                       0812
*   RESPECIFY                                                      0813
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC08=TESTRC;                    /*                       @Y30LB34*/
         LH    @15,TESTRC                                          0814
         LR    CC08,@15                                            0814
*                                                                  0815
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR OCCURRED IN RVGETTA AND IF THE     @Y30LB34*/
*   /* NOVTOCCK FLAG IS NOT ON AND THE VOLSERS ARE THE       @Y30LB34*/
*   /* SAME, MOUNT THE TARGET VOLUME. SET THE BIT ON TO      @Y30LB34*/
*   /* CLEAR THE SOURCE UCB BEFORE THE MOUNT.                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0815
*   IF CC08<LASTCC12&NOVTOCCK=OFF&SAMESER=ON THEN                  0815
         C     CC08,@CF00567                                       0815
         BNL   @RF00815                                            0815
         TM    NOVTOCCK,B'00100000'                                0815
         BNZ   @RF00815                                            0815
         TM    SAMESER,B'10000000'                                 0815
         BNO   @RF00815                                            0815
*     DO;                           /*                       @Y30LB34*/
*       MDCLEAR=ON;                 /*                       @Y30LB34*/
         LA    @08,MDAGLAR                                         0817
         OI    MDCLEAR(@08),B'01000000'                            0817
*       CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                 @Y30LB34*/
         L     @15,@PC00001                                        0818
         ST    @15,@AL00001                                        0818
         LA    @14,MOUNT                                           0818
         ST    @14,@AL00001+4                                      0818
         ST    @08,@AL00001+8                                      0818
         MVI   @AL00001+8,X'80'                                    0818
         L     @15,GDTUNT(,@15)                                    0818
         LA    @01,@AL00001                                        0818
         BALR  @14,@15                                             0818
*       RESPECIFY                                                  0819
*         RTNREG RSTD;                                             0819
*       TESTRC=RTNREG;                                             0820
         STH   RTNREG,TESTRC                                       0820
*       RESPECIFY                                                  0821
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       MDCLEAR=OFF;                /*                       @Y30LB34*/
*                                                                  0822
         LA    @08,MDAGLAR                                         0822
         NI    MDCLEAR(@08),B'10111111'                            0822
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT IS UNSUCCESSFUL, SET CONDITION        @Y30LB34*/
*       /* CODE TO 12.                                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0823
*       IF TESTRC>0 THEN                                           0823
         LH    @08,TESTRC                                          0823
         LTR   @08,@08                                             0823
         BNP   @RF00823                                            0823
*         CC08=LASTCC12;            /*                       @Y30LB34*/
         LA    CC08,12                                             0824
*     END;                          /*                       @Y30LB34*/
@RF00823 DS    0H                                                  0826
*                                                                  0826
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR HAS OCCURRED, CHECK TARGET         @Y30LB34*/
*   /* VOLUME AND PREPARE FOR DATA CONVERSION.               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0826
*   IF CC08<LASTCC12 THEN                                          0826
@RF00815 C     CC08,@CF00567                                       0826
         BNL   @RF00826                                            0826
*     DO;                           /*                       @Y30LB34*/
*                                                                  0827
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CHEKTARG TO INITIALIZE THE VOLUME            @Y30LB34*/
*       /* SERVICES PARM LIST, PERFORM SECURITY CHECKING     @Y30LB34*/
*       /* AND RETRIEVE VTOC INFORMATION                     @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0828
*       CALL CHEKTARG;              /*                       @Y30LB34*/
         BAL   @14,CHEKTARG                                        0828
*       RESPECIFY                                                  0829
*         RTNREG RSTD;                                             0829
*       TESTRC=RTNREG;                                             0830
         STH   RTNREG,TESTRC                                       0830
*       RESPECIFY                                                  0831
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC08=MAX(CC08,TESTRC);      /*                       @Y30LB34*/
*                                                                  0832
         LH    @08,TESTRC                                          0832
         CR    CC08,@08                                            0832
         BNL   *+6
         LR    CC08,@08                                            0832
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE TARGET VOLUME WAS RESERVED IN CHEKTARG     @Y30LB34*/
*       /* DEQUEUE THAT RESERVE AND SET OFF THE TARGET       @Y30LB34*/
*       /* RESERVE BIT                                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0833
*       IF TRES=ON THEN                                            0833
         TM    TRES,B'01000000'                                    0833
         BNO   @RF00833                                            0833
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*           @Y30LB34*/
         L     @08,@PC00001                                        0835
         ST    @08,@AL00001                                        0835
         LA    @15,@CC01594                                        0835
         ST    @15,@AL00001+4                                      0835
         LA    @15,RNAMEVR                                         0835
         ST    @15,@AL00001+8                                      0835
         MVI   @AL00001+8,X'80'                                    0835
         L     @15,GDTDEQ(,@08)                                    0835
         LA    @01,@AL00001                                        0835
         BALR  @14,@15                                             0835
*           TRES=OFF;               /*                       @Y30LB34*/
         NI    TRES,B'10111111'                                    0836
*         END;                      /*                       @Y30LB34*/
*                                                                  0837
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO SEVERE ERROR HAS OCCURRED OR IF THE         @Y30LB34*/
*       /* VOLUME WAS MOUNTED EARLIER IN THIS PROCEDURE      @Y30LB34*/
*       /* AND A SEVERE ERROR HAS OCCURRED SINCE THEN,       @Y30LB34*/
*       /* DEMOUNT THE MSS TARGET VOLUME. SET THE BIT        @Y30LB34*/
*       /* ON TO POST THE SOURCE UCB AFTER DEMOUNT IF IT     @Y30LB34*/
*       /* WAS CLEARED EARLIER. SINCE THE DEMOUNT MUST       @Y30LB34*/
*       /* BE COMPLETED BEFORE THE DATA COPY CAN TAKE        @Y30LB34*/
*       /* PLACE, SET THE BIT ON TO WAIT FOR COMPLETION      @Y30LB34*/
*       /* FOR THE DEMOUNT BEFORE PROCEEDING                 @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0838
*       IF CC08<LASTCC12×(SAMESER=ON&NOVTOCCK=OFF) THEN            0838
@RF00833 C     CC08,@CF00567                                       0838
         BL    @RT00838                                            0838
         TM    SAMESER,B'10000000'                                 0838
         BNO   @RF00838                                            0838
         TM    NOVTOCCK,B'00100000'                                0838
         BNZ   @RF00838                                            0838
@RT00838 DS    0H                                                  0839
*         DO;                       /*                       @Y30LB34*/
*           IF SAMESER=ON&NOVTOCCK=OFF THEN                        0840
         TM    SAMESER,B'10000000'                                 0840
         BNO   @RF00840                                            0840
         TM    NOVTOCCK,B'00100000'                                0840
         BNZ   @RF00840                                            0840
*             MDPOST=ON;            /*                       @Y30LB34*/
         LA    @08,MDAGLAR                                         0841
         OI    MDPOST(@08),B'00100000'                             0841
*           MDWAIT=ON;              /*                       @Y30LB34*/
@RF00840 LA    @08,MDAGLAR                                         0842
         OI    MDWAIT(@08),B'00010000'                             0842
*           CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*           @Y30LB34*/
         L     @15,@PC00001                                        0843
         ST    @15,@AL00001                                        0843
         LA    @14,DEMOUNT                                         0843
         ST    @14,@AL00001+4                                      0843
         ST    @08,@AL00001+8                                      0843
         MVI   @AL00001+8,X'80'                                    0843
         L     @15,GDTUNT(,@15)                                    0843
         LA    @01,@AL00001                                        0843
         BALR  @14,@15                                             0843
*           RESPECIFY                                              0844
*             RTNREG RSTD;                                         0844
*           TESTRC=RTNREG;                                         0845
         STH   RTNREG,TESTRC                                       0845
*           RESPECIFY                                              0846
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           MDPOST=OFF;             /*                       @Y30LB34*/
*           MDWAIT=OFF;             /*                       @Y30LB34*/
*                                                                  0848
         LA    @08,MDAGLAR                                         0848
         NI    MDPOST(@08),B'11001111'                             0848
*           /*********************************************************/
*           /*                                                       */
*           /* IF UMSSUNIT WAS UNSUCCESSFUL SET CONDITION    @Y30LB34*/
*           /* CODE TO 12                                    @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0849
*           IF TESTRC>0 THEN                                       0849
         LH    @08,TESTRC                                          0849
         LTR   @08,@08                                             0849
         BNP   @RF00849                                            0849
*             CC08=LASTCC12;        /*                       @Y30LB34*/
         LA    CC08,12                                             0850
*         END;                      /*                       @Y30LB34*/
@RF00849 DS    0H                                                  0852
*     END;                          /*                       @Y30LB34*/
@RF00838 DS    0H                                                  0853
*                                                                  0853
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A SEVERE ERROR HAS OCCURRED, DEQUEUE THE TARGET    @Y30LB34*/
*   /* VOLUME ENQUEUE BEFORE TERMINATING THE JOB             @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0853
*   IF CC08=LASTCC12 THEN                                          0853
@RF00826 C     CC08,@CF00567                                       0853
         BNE   @RF00853                                            0853
*     IF TENQ=ON THEN                                              0854
         TM    TENQ,B'10000000'                                    0854
         BNO   @RF00854                                            0854
*       DO;                         /*                       @Y30LB34*/
*         CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVE);/*             @Y30LB34*/
         L     @08,@PC00001                                        0856
         ST    @08,@AL00001                                        0856
         LA    @15,@CC01594                                        0856
         ST    @15,@AL00001+4                                      0856
         LA    @15,RNAMEVE                                         0856
         ST    @15,@AL00001+8                                      0856
         MVI   @AL00001+8,X'80'                                    0856
         L     @15,GDTDEQ(,@08)                                    0856
         LA    @01,@AL00001                                        0856
         BALR  @14,@15                                             0856
*         TENQ=OFF;                 /*                       @Y30LB34*/
         NI    TENQ,B'01111111'                                    0857
*       END;                        /*                       @Y30LB34*/
*                                                                  0858
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0859
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RF00854 DS    0H                                                  0859
@RF00853 LR    REG14,RTNREG2                                       0859
*   RETURN CODE(CC08);              /*                       @Y30LB34*/
         LR    @15,CC08                                            0860
@EL00009 DS    0H                                                  0860
@EF00009 DS    0H                                                  0860
@ER00009 BR    @14                                                 0860
*   END RVINITTA;                   /*                       @Y30LB34*/
*                                                                  0862
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RVGETTA                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - INITIALIZES THE MSVC PARM LIST TO RETRIEVE    @Y30LB34*/
*/*            THE BASE VOLUME RECORD OF THE MSS VOLUME      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES USSC TO RETRIEVE THE BASE VOLUME       @Y30LB34*/
*/*            RECORD                                        @Y30LB34*/
*/*                IF USSC IS NOT SUCCESSFUL, CALLS SSCMSG   @Y30LB34*/
*/*                TO PRINT MESSAGE,                         @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC2080I IF THE BASE @Y30LB34*/
*/*                VOLUME RECORD COULD NOT BE RETRIEVED      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DETERMINES IF VOLUME IS INACTIVE.  IF SO,     @Y30LB34*/
*/*            PRINTS MESSAGE IDC3074I                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DETERMINES IF ANY RECOVERY FLAGS ARE ON, AND, @Y30LB34*/
*/*            IF SO, WHICH ONES                             @Y30LB34*/
*/*                IF INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3097I,            @Y30LB34*/
*/*                IF VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3095I,            @Y30LB34*/
*/*                IF INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/
*/*                PREVENTS EMPTY VTOC CHECKING IN CHEKTARG  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            RETRIEVES OWNER INFORMATION                   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - TARGAREA, RVVI, DARGLIST                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RVVI, TARGAREA                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. = 12, UNABLE TO RETRIEVE BASE VOLUME     @Y30LB34*/
*/*                       RECORD,                            @Y30LB34*/
*/*                       INVALID RECOVERY FLAGS ON IN BASE  @Y30LB34*/
*/*                       VOLUME RECORD,                     @Y30LB34*/
*/*                       VOLUME NOT ACTIVE                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0862
*RVGETTA:                                                          0862
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0862
RVGETTA  DS    0H                                                  0863
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0863
*   DCL                                                            0863
*     CC09 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0864
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0864
*   OLDERID2=NEWERID2;                                             0864
         L     @08,@PC00001                                        0864
         L     @15,GDTTR2(,@08)                                    0864
         MVC   @TS00001(95),NEWERID2(@15)                          0864
         MVC   OLDERID2(95,@15),@TS00001                           0864
*   NEWID2='CNT9';                  /*                       @Y30LB34*/
*                                                                  0865
         MVC   NEWID2(4,@15),@CC01734                              0865
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0866
*   CC09=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             0866
         LR    CC09,@15                                            0866
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  0867
         ST    REG14,RTNREG3                                       0867
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI PARM LIST FOR RETRIEVING A BASE       @Y30LB34*/
*   /* VOLUME RECORD                                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0868
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB34*/
         L     @14,RVVIPTR                                         0868
         LH    @11,RVVLEN                                          0868
         ST    @11,RVVLNGTH(,@14)                                  0868
*   RVVCODE=RVVOP;                  /*                       @Y30LB34*/
         MVI   RVVCODE(@14),X'87'                                  0869
*   RVVOLUME=TVOLSER;               /*                       @Y30LB34*/
         MVC   RVVOLUME(6,@14),TVOLSER                             0870
*   RVVRDR=ON;                      /*                       @Y30LB34*/
         OI    RVVRDR(@14),B'10000000'                             0871
*   RVVBVRCD=ON;                    /*                       @Y30LB34*/
         OI    RVVBVRCD(@14),B'10000000'                           0872
*   RVVBUFLN=LENGTH(BASEVAR);       /*                       @Y30LB34*/
         MVC   RVVBUFLN(2,@14),@CH01875                            0873
*   RVVRTBUF=ADDR(BASEVAR);         /*                       @Y30LB34*/
         LA    @11,BASEVAR                                         0874
         ST    @11,RVVRTBUF(,@14)                                  0874
*   RVVSVOL=ON;                     /*                       @Y30LB34*/
         OI    RVVSVOL(@14),B'00000001'                            0875
*                                                                  0876
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO ISSUE ICBVVIC TO RETRIEVE THE BASE      @Y30LB34*/
*   /* VOLUME RECORD FOR THE TARGET VOLUME                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0876
*   USSCREG0=0;                     /*                       @Y30LB34*/
         ST    @15,USSCREG0                                        0876
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,USSCREG0);/*           @Y30LB34*/
         ST    @08,@AL00001                                        0877
         LA    @15,VVIC                                            0877
         ST    @15,@AL00001+4                                      0877
         LA    @15,RVVIPTR                                         0877
         ST    @15,@AL00001+8                                      0877
         LA    @15,USSCREG0                                        0877
         ST    @15,@AL00001+12                                     0877
         MVI   @AL00001+12,X'80'                                   0877
         L     @15,GDTSSC(,@08)                                    0877
         LA    @01,@AL00001                                        0877
         BALR  @14,@15                                             0877
*   RESPECIFY                                                      0878
*     RTNREG RSTD;                                                 0878
*   TESTRC=RTNREG;                                                 0879
         STH   RTNREG,TESTRC                                       0879
*   RESPECIFY                                                      0880
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  0880
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USSC WAS UNSUCCESSFUL, CALL SSCMSG TO PRINT        @Y30LB34*/
*   /* THE USSC MESSAGE, PRINT MESSAGE IDC2080I, AND         @Y30LB34*/
*   /* SET THE CONDITION CODE TO 12                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0881
*   IF TESTRC>0 THEN                                               0881
         LH    @08,TESTRC                                          0881
         LTR   @08,@08                                             0881
         BNP   @RF00881                                            0881
*     DO;                           /*                       @Y30LB34*/
*       CALL SSCMSG(USSCREG0);      /*                       @Y30LB34*/
         LA    @15,USSCREG0                                        0883
         ST    @15,@AL00001                                        0883
         LA    @01,@AL00001                                        0883
         BAL   @14,SSCMSG                                          0883
*       CC09=LASTCC12;              /*                       @Y30LB34*/
         LA    CC09,12                                             0884
*       DARGSMOD=COMMSG;            /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0885
         MVC   DARGSMOD(3,@08),@CC01555                            0885
*       DARGSENT=MSG2080I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'1A'                                 0886
*       DARGDBP=ADDR(TVOLSER);      /*                       @Y30LB34*/
         LA    @15,TVOLSER                                         0887
         ST    @15,DARGDBP(,@08)                                   0887
*       DARGILP=LENGTH(TVOLSER);    /*                       @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             0888
*       DARGRETP=0;                 /*                       @Y30LB34*/
         SLR   @15,@15                                             0889
         ST    @15,DARGRETP(,@08)                                  0889
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @08,@PC00001                                        0890
         ST    @08,@AL00001                                        0890
         LA    @15,@CF00115                                        0890
         ST    @15,@AL00001+4                                      0890
         LA    @15,DDSTRU                                          0890
         ST    @15,@AL00001+8                                      0890
         MVI   @AL00001+8,X'80'                                    0890
         L     @15,GDTPRT(,@08)                                    0890
         LA    @01,@AL00001                                        0890
         BALR  @14,@15                                             0890
*     END;                          /*                       @Y30LB34*/
*                                                                  0891
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USSC WAS SUCCESSFUL, CHECK BASE VOLUME RECORD      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0892
*   ELSE                                                           0892
*     DO;                           /*                       @Y30LB34*/
         B     @RC00881                                            0892
@RF00881 DS    0H                                                  0893
*                                                                  0893
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR AN ACTIVE VOLUME. IF NOT, PRINT          @Y30LB34*/
*       /* ERROR MESSAGE IDC3074I AND SET CONDITION CODE     @Y30LB34*/
*       /* TO 12.                                            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0893
*       IF BASINAC=ON THEN                                         0893
         L     @08,BASEVPTR                                        0893
         TM    BASINAC(@08),B'00000100'                            0893
         BNO   @RF00893                                            0893
*         DO;                       /*                       @Y30LB34*/
*           CC09=LASTCC12;          /*                       @Y30LB34*/
         LA    CC09,12                                             0895
*           DARGSMOD=COMMSG;        /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0896
         MVC   DARGSMOD(3,@08),@CC01555                            0896
*           DARGSENT=MSG3074I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'20'                                 0897
*           DARGDBP=ADDR(TVOLSER);  /*                       @Y30LB34*/
         LA    @15,TVOLSER                                         0898
         ST    @15,DARGDBP(,@08)                                   0898
*           DARGILP=LENGTH(TVOLSER);/*                       @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             0899
*           DARGRETP=0;             /*                       @Y30LB34*/
         SLR   @15,@15                                             0900
         ST    @15,DARGRETP(,@08)                                  0900
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        0901
         ST    @08,@AL00001                                        0901
         LA    @15,@CF00115                                        0901
         ST    @15,@AL00001+4                                      0901
         LA    @15,DDSTRU                                          0901
         ST    @15,@AL00001+8                                      0901
         MVI   @AL00001+8,X'80'                                    0901
         L     @15,GDTPRT(,@08)                                    0901
         LA    @01,@AL00001                                        0901
         BALR  @14,@15                                             0901
*         END;                      /*                       @Y30LB34*/
*                                                                  0902
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME IS ACTIVE, TEST RECOVERY FLAGS          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0903
*       ELSE                                                       0903
*         DO;                       /*                       @Y30LB34*/
*                                                                  0903
         B     @RC00893                                            0903
@RF00893 DS    0H                                                  0904
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/
*           /* PRINT ERROR MESSAGE IDC3097I AND SET          @Y30LB34*/
*           /* CONDITION CODE TO 12                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0904
*           IF BASIVCRE=ON THEN                                    0904
         L     @08,BASEVPTR                                        0904
         TM    BASIVCRE(@08),B'10000000'                           0904
         BNO   @RF00904                                            0904
*             DO;                   /*                       @Y30LB34*/
*               CC09=LASTCC12;      /*                       @Y30LB34*/
         LA    CC09,12                                             0906
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0907
         MVC   DARGSMOD(3,@08),@CC01555                            0907
*               DARGSENT=MSG3097T;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'04'                                 0908
*               DARGDBP=ADDR(TVOLSER);/*                     @Y30LB34*/
         LA    @15,TVOLSER                                         0909
         ST    @15,DARGDBP(,@08)                                   0909
*               DARGILP=LENGTH(TVOLSER);/*                   @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             0910
*               DARGRETP=0;         /*                       @Y30LB34*/
         SLR   @15,@15                                             0911
         ST    @15,DARGRETP(,@08)                                  0911
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/
         L     @08,@PC00001                                        0912
         ST    @08,@AL00001                                        0912
         LA    @15,@CF00115                                        0912
         ST    @15,@AL00001+4                                      0912
         LA    @15,DDSTRU                                          0912
         ST    @15,@AL00001+8                                      0912
         MVI   @AL00001+8,X'80'                                    0912
         L     @15,GDTPRT(,@08)                                    0912
         LA    @01,@AL00001                                        0912
         BALR  @14,@15                                             0912
*             END;                  /*                       @Y30LB34*/
*                                                                  0914
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/
*           /* PRINT ERROR MESSAGE IDC3095I AND SET          @Y30LB34*/
*           /* CONDITION CODE TO 12                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0914
*           ELSE                                                   0914
*             IF BASVSMIS=ON THEN                                  0914
         B     @RC00904                                            0914
@RF00904 L     @08,BASEVPTR                                        0914
         TM    BASVSMIS(@08),B'00100000'                           0914
         BNO   @RF00914                                            0914
*               DO;                 /*                       @Y30LB34*/
*                 CC09=LASTCC12;    /*                       @Y30LB34*/
         LA    CC09,12                                             0916
*                 DARGSMOD=COMMSG;  /*                       @Y30LB34*/
         L     @08,DDSTRU                                          0917
         MVC   DARGSMOD(3,@08),@CC01555                            0917
*                 DARGSENT=MSG3095T;/*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'0A'                                 0918
*                 DARGDBP=ADDR(TVOLSER);/*                   @Y30LB34*/
         LA    @15,TVOLSER                                         0919
         ST    @15,DARGDBP(,@08)                                   0919
*                 DARGILP=LENGTH(TVOLSER);/*                 @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             0920
*                 DARGRETP=0;       /*                       @Y30LB34*/
         SLR   @15,@15                                             0921
         ST    @15,DARGRETP(,@08)                                  0921
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB34*/
         L     @08,@PC00001                                        0922
         ST    @08,@AL00001                                        0922
         LA    @15,@CF00115                                        0922
         ST    @15,@AL00001+4                                      0922
         LA    @15,DDSTRU                                          0922
         ST    @15,@AL00001+8                                      0922
         MVI   @AL00001+8,X'80'                                    0922
         L     @15,GDTPRT(,@08)                                    0922
         LA    @01,@AL00001                                        0922
         BALR  @14,@15                                             0922
*               END;                /*                       @Y30LB34*/
*                                                                  0923
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/
*           /* SET THE BIT TO OMIT EMPTY VTOC CHECKING       @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0924
*             ELSE                                                 0924
*               IF BASIVCPY=ON THEN                                0924
         B     @RC00914                                            0924
@RF00914 L     @08,BASEVPTR                                        0924
         TM    BASIVCPY(@08),B'01000000'                           0924
         BNO   @RF00924                                            0924
*                 NOVTOCCK=ON;      /*                       @Y30LB34*/
         OI    NOVTOCCK,B'00100000'                                0925
*         END;                      /*                       @Y30LB34*/
@RF00924 DS    0H                                                  0926
@RC00914 DS    0H                                                  0926
@RC00904 DS    0H                                                  0927
*     END;                          /*                       @Y30LB34*/
@RC00893 DS    0H                                                  0928
*                                                                  0928
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS WERE ENCOUNTERED, RETRIEVE        @Y30LB34*/
*   /* OWNER INFORMATION AND SAVE IT IN THE TARGET VOLUME    @Y30LB34*/
*   /* WORK AREA. THIS IS DONE SINCE THE LABEL MAY HAVE      @Y30LB34*/
*   /* BEEN OVERLAYED IN A PREVIOUSLY UNSUCCESSFUL CONVERT   @Y30LB34*/
*   /* ATTEMPT.                                              @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0928
*   IF CC09<LASTCC12 THEN                                          0928
@RC00881 C     CC09,@CF00567                                       0928
         BNL   @RF00928                                            0928
*     TOWNER=BASOWNER;              /*                       @Y30LB34*/
*                                                                  0929
         L     @08,BASEVPTR                                        0929
         MVC   TOWNER(10),BASOWNER(@08)                            0929
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0930
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RF00928 L     REG14,RTNREG3                                       0930
*   RETURN CODE(CC09);              /*                       @Y30LB34*/
         LR    @15,CC09                                            0931
@EL00010 DS    0H                                                  0931
@EF00010 DS    0H                                                  0931
@ER00010 BR    @14                                                 0931
*   END RVGETTA;                    /*                       @Y30LB34*/
*                                                                  0933
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - CHEKTARG                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - PERFORMS TARGET VOLUME CHECKING               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES VOLUME SERVICES PARM LIST FOR ALL @Y30LB34*/
*/*            VOLUME SERVICES REQUESTS ON THE TARGET VOLUME @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF VTOC CHECKING IS NOT TO BE OMITTED, CALLS  @Y30LB34*/
*/*            VOLUME SERVICES TO PERFORM SECURITY CHECKING  @Y30LB34*/
*/*            FOR AN EMPTY VTOC AND RETRIEVE ALTERNATE      @Y30LB34*/
*/*            TRACK INFROMATION                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CLOSES THE VTOC OPENED BY VOLUME SERVICES     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - TOVS1AGL, TARGAREA, FUNCTION DATA TABLE,         @Y30LB34*/
*/*         DARGLIST                                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INITIALIZED TOVS1AGL                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/
*/*           R. C. = 12, SECURITY CHECKING FAILED,          @Y30LB34*/
*/*                       UNABLE TO RETRIEVE ALTERNATE       @Y30LB34*/
*/*                       TRACK INFORMATION                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0933
*CHEKTARG:                                                         0933
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  0933
CHEKTARG DS    0H                                                  0934
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0934
*   DCL                                                            0934
*     CC10 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  0935
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0935
*   OLDERID2=NEWERID2;                                             0935
         L     @08,@PC00001                                        0935
         L     @08,GDTTR2(,@08)                                    0935
         MVC   @TS00001(95),NEWERID2(@08)                          0935
         MVC   OLDERID2(95,@08),@TS00001                           0935
*   NEWID2='CNTA';                  /*                       @Y30LB34*/
*                                                                  0936
         MVC   NEWID2(4,@08),@CC01740                              0936
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0937
*   CC10=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC10,CC10                                           0937
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  0938
         ST    REG14,RTNREG3                                       0938
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IDCVS01 PARM LIST FOR ALL VOLUME       @Y30LB34*/
*   /* SERVICES REQUESTS ON THE TARGET VOLUME                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0939
*   RESPECIFY                                                      0939
*     VS1AGL BASED(ADDR(TOVS1AGL)); /*                       @Y30LB34*/
*   VSNOVSAM=ON;                    /*                       @Y30LB34*/
*   VSNONONV=ON;                    /*                       @Y30LB34*/
         LA    @08,TOVS1AGL                                        0941
         OI    VSNOVSAM(@08),B'10100000'                           0941
*   VSALTTRK=ON;                    /*                       @Y30LB34*/
         OI    VSALTTRK(@08),B'01000000'                           0942
*   IF SVSAM=ON THEN                                               0943
         TM    SVSAM,B'00100000'                                   0943
         BNO   @RF00943                                            0943
*     VSTIME=ON;                    /*                       @Y30LB34*/
         OI    VSTIME(@08),B'10000000'                             0944
*   VSDEVICE=ON;                    /*                       @Y30LB34*/
@RF00943 LA    @08,TOVS1AGL                                        0945
         OI    VSDEVICE(@08),B'10000000'                           0945
*   IF SAMESER=OFF THEN                                            0946
         TM    SAMESER,B'10000000'                                 0946
         BNZ   @RF00946                                            0946
*     VSSERIAL=ON;                  /*                       @Y30LB34*/
         OI    VSSERIAL(@08),B'01000000'                           0947
*   IF ADDR(LIST)^=NULLPTR THEN                                    0948
@RF00946 L     @08,@PC00001+4                                      0948
         L     @08,FDTPTR+52(,@08)                                 0948
         LTR   @08,@08                                             0948
         BZ    @RF00948                                            0948
*     VSLIST=ON;                    /*                       @Y30LB34*/
         LA    @08,TOVS1AGL                                        0949
         OI    VSLIST(@08),B'00100000'                             0949
*   VSTOV=ON;                       /*                       @Y30LB34*/
@RF00948 LA    @08,TOVS1AGL                                        0950
         OI    VSTOV(@08),B'01000000'                              0950
*   VSVOLP=ADDR(TVOLSER);           /*                       @Y30LB34*/
         LA    @15,TVOLSER                                         0951
         ST    @15,VSVOLP(,@08)                                    0951
*   VSFILEP=ADDR(TFILEVAL);         /*                       @Y30LB34*/
         L     @14,@PC00001+4                                      0952
         L     @01,FDTPTR+4(,@14)                                  0952
         LA    @14,TFILEVAL(,@01)                                  0952
         ST    @14,VSFILEP(,@08)                                   0952
*   VSNUMATP=ADDR(TNUMAT);          /*                       @Y30LB34*/
         LA    @14,TNUMAT                                          0953
         ST    @14,VSNUMATP(,@08)                                  0953
*   VSNXTATP=ADDR(TNXTAT);          /*                       @Y30LB34*/
         LA    @14,TNXTAT                                          0954
         ST    @14,VSNXTATP(,@08)                                  0954
*   VSSERP=ADDR(TVOLSER);           /*                       @Y30LB34*/
         ST    @15,VSSERP(,@08)                                    0955
*   VSDEVP=ADDR(TDEVTYPE);          /*                       @Y30LB34*/
         LA    @15,TDEVTYPE                                        0956
         ST    @15,VSDEVP(,@08)                                    0956
*   VSOSERP=ADDR(SVOLSER);          /*                       @Y30LB34*/
         LA    @15,SVOLSER                                         0957
         ST    @15,VSOSERP(,@08)                                   0957
*   VSODEVP=ADDR(SDEVTYPE);         /*                       @Y30LB34*/
         LA    @15,SDEVTYPE                                        0958
         ST    @15,VSODEVP(,@08)                                   0958
*   IF TTYPEVOL='REAL' THEN                                        0959
         CLC   TTYPEVOL(4),@CC01679                                0959
         BNE   @RF00959                                            0959
*     VSREAL=ON;                    /*                       @Y30LB34*/
         OI    VSREAL(@08),B'01000000'                             0960
*   VSUCBP=ADDR(TUCBADDR);          /*                       @Y30LB34*/
@RF00959 LA    @08,TOVS1AGL                                        0961
         LA    @15,TUCBADDR                                        0961
         ST    @15,VSUCBP(,@08)                                    0961
*                                                                  0962
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE NOVTOCCK FLAG IS OFF, CHECK AND RETREIVE       @Y30LB34*/
*   /* INFORMATION FROM THE TARGET VOLUME VTOC               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0962
*   IF NOVTOCCK=OFF THEN                                           0962
         TM    NOVTOCCK,B'00100000'                                0962
         BNZ   @RF00962                                            0962
*     DO;                           /*                       @Y30LB34*/
*                                                                  0963
*       /*************************************************************/
*       /*                                                           */
*       /* CALL VOLUME SERVICES TO VERIFY AN EMPTY VTOC      @Y30LB34*/
*       /* ON THE TARGET VOLUME. SINCE THE VOLUME IS TO      @Y30LB34*/
*       /* BE RESERVED AT THE TIME IT IS MOUNTED, THE        @Y30LB34*/
*       /* VSRES AND TRES BITS ARE TURNED ON.                @ZA08840*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0964
*       IF CONVTYPE=RV THEN                                        0964
         TM    CONVTYPE,B'01000000'                                0964
         BNO   @RF00964                                            0964
*         DO;                       /*                       @ZA08840*/
*           VSRES=ON;               /*                       @Y30LB34*/
         OI    VSRES(@08),B'10000000'                              0966
*           TRES=ON;                /*                       @ZA08840*/
         OI    TRES,B'01000000'                                    0967
*         END;                      /*                       @ZA08840*/
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*  @Y30LB34*/
@RF00964 L     @08,@PC00001                                        0969
         ST    @08,@AL00001                                        0969
         LA    @15,@CC01720                                        0969
         ST    @15,@AL00001+4                                      0969
         LA    @15,SECCHECK                                        0969
         ST    @15,@AL00001+8                                      0969
         LA    @15,TOVS1AGL                                        0969
         ST    @15,@AL00001+12                                     0969
         MVI   @AL00001+12,X'80'                                   0969
         L     @15,GDTCAL(,@08)                                    0969
         LA    @01,@AL00001                                        0969
         BALR  @14,@15                                             0969
*       RESPECIFY                                                  0970
*         RTNREG RSTD;                                             0970
*       TESTRC=RTNREG;                                             0971
         STH   RTNREG,TESTRC                                       0971
*       RESPECIFY                                                  0972
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  0972
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERVICES WAS UNSUCCESSFUL OR THE        @Y30LB34*/
*       /* VTOC WAS NOT EMPTY, SET THE CONDITION CODE TO     @Y30LB34*/
*       /* 12.                                               @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0973
*       IF TESTRC=4 THEN                                           0973
         LH    @08,TESTRC                                          0973
         C     @08,@CF00036                                        0973
         BNE   @RF00973                                            0973
*         CC10=LASTCC12;            /*                       @Y30LB34*/
*                                                                  0974
         LA    CC10,12                                             0974
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERVICES COULD NOT CLOSE A DATA SET     @Y30LB34*/
*       /* SET THEN CONDITION CODE TO 4                      @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0975
*       IF TESTRC=8 THEN                                           0975
@RF00973 CLC   TESTRC(2),@CH00177                                  0975
         BNE   @RF00975                                            0975
*         CC10=LASTCC04;            /*                       @Y30LB34*/
         LA    CC10,4                                              0976
*                                                                  0977
*       /*************************************************************/
*       /*                                                           */
*       /* RESET VSRES RESERVE BIT OFF.                      @ZA08840*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0977
*       VSRES=OFF;                  /*                       @Y30LB34*/
*                                                                  0977
@RF00975 LA    @08,TOVS1AGL                                        0977
         NI    VSRES(@08),B'01111111'                              0977
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VTOC WAS OPENED BY VOLUME SERVICES,        @Y30LB34*/
*       /* CLOSE IT AND RESET IOCSPTR TO ZERO.               @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0978
*       IF VSIOP^=NULLPTR THEN                                     0978
         L     @15,VSIOP(,@08)                                     0978
         LTR   @15,@15                                             0978
         BZ    @RF00978                                            0978
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB34*/
         L     @15,@PC00001                                        0980
         ST    @15,@AL00001                                        0980
         LA    @08,VSIOP(,@08)                                     0980
         ST    @08,@AL00001+4                                      0980
         MVI   @AL00001+4,X'80'                                    0980
         L     @15,GDTCLS(,@15)                                    0980
         LA    @01,@AL00001                                        0980
         BALR  @14,@15                                             0980
*           RESPECIFY                                              0981
*             RTNREG RSTD;                                         0981
*           TESTRC=RTNREG;                                         0982
         STH   RTNREG,TESTRC                                       0982
*           RESPECIFY                                              0983
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           VSIOP=NULLPTR;          /*                       @Y30LB34*/
         LA    @08,TOVS1AGL                                        0984
         SLR   @15,@15                                             0984
         ST    @15,VSIOP(,@08)                                     0984
*           CC10=MAX(CC10,TESTRC);  /*                       @Y30LB34*/
         LH    @08,TESTRC                                          0985
         CR    CC10,@08                                            0985
         BNL   *+6
         LR    CC10,@08                                            0985
*         END;                      /*                       @Y30LB34*/
*                                                                  0986
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE EMPTY VTOC CHECK WAS SUCCESSFUL, CALL      @Y30LB34*/
*       /* VOLUME SERVICES TO RETRIEVE THE VOLUME'S          @Y30LB34*/
*       /* ALTERNATE TRACK INFORMATION TO BE SAVED AND       @Y30LB34*/
*       /* RESTORED AFTER THE CONVERSION.                    @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0987
*       IF CC10<LASTCC12 THEN                                      0987
@RF00978 C     CC10,@CF00567                                       0987
         BNL   @RF00987                                            0987
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCSACL0(GDTTBL,'IDCVS01 ',GETVTOC,VS1AGL);/*     0989
*                                                            @Y30LB34*/
         L     @08,@PC00001                                        0989
         ST    @08,@AL00001                                        0989
         LA    @15,@CC01720                                        0989
         ST    @15,@AL00001+4                                      0989
         LA    @15,GETVTOC                                         0989
         ST    @15,@AL00001+8                                      0989
         LA    @15,TOVS1AGL                                        0989
         ST    @15,@AL00001+12                                     0989
         MVI   @AL00001+12,X'80'                                   0989
         L     @15,GDTCAL(,@08)                                    0989
         LA    @01,@AL00001                                        0989
         BALR  @14,@15                                             0989
*           RESPECIFY                                              0990
*             RTNREG RSTD;                                         0990
*           TESTRC=RTNREG;                                         0991
         STH   RTNREG,TESTRC                                       0991
*           RESPECIFY                                              0992
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*                                                                  0992
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO SERVICE WAS PERFORMED, RESET            @Y30LB34*/
*           /* CONDITION CODE TO 12.                         @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0993
*           IF TESTRC>0 THEN                                       0993
         LH    @08,TESTRC                                          0993
         LTR   @08,@08                                             0993
         BNP   @RF00993                                            0993
*             CC10=LASTCC12;        /*                       @Y30LB34*/
         LA    CC10,12                                             0994
*         END;                      /*                       @Y30LB34*/
@RF00993 DS    0H                                                  0996
*                                                                  0996
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VTOC WAS OPENED BY VOLUME SERVICES,        @Y30LB34*/
*       /* CLOSE IT AND RESET IOCSPTR TO ZERO.               @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0996
*       IF VSIOP^=NULLPTR THEN                                     0996
@RF00987 LA    @08,TOVS1AGL                                        0996
         L     @15,VSIOP(,@08)                                     0996
         LTR   @15,@15                                             0996
         BZ    @RF00996                                            0996
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB34*/
         L     @15,@PC00001                                        0998
         ST    @15,@AL00001                                        0998
         LA    @08,VSIOP(,@08)                                     0998
         ST    @08,@AL00001+4                                      0998
         MVI   @AL00001+4,X'80'                                    0998
         L     @15,GDTCLS(,@15)                                    0998
         LA    @01,@AL00001                                        0998
         BALR  @14,@15                                             0998
*           RESPECIFY                                              0999
*             RTNREG RSTD;                                         0999
*           TESTRC=RTNREG;                                         1000
         STH   RTNREG,TESTRC                                       1000
*           RESPECIFY                                              1001
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           VSIOP=NULLPTR;          /*                       @Y30LB34*/
         LA    @08,TOVS1AGL                                        1002
         SLR   @15,@15                                             1002
         ST    @15,VSIOP(,@08)                                     1002
*           CC10=MAX(CC10,TESTRC);  /*                       @Y30LB34*/
         LH    @08,TESTRC                                          1003
         CR    CC10,@08                                            1003
         BNL   *+6
         LR    CC10,@08                                            1003
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  1005
@RF00996 DS    0H                                                  1006
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/
*   /* RETURN TO CALLER                                      #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1006
*   REG14=RTNREG3;                  /*                       #Y30LB34*/
@RF00962 L     REG14,RTNREG3                                       1006
*   RETURN CODE(CC10);              /*                       #Y30LB34*/
         LR    @15,CC10                                            1007
@EL00011 DS    0H                                                  1007
@EF00011 DS    0H                                                  1007
@ER00011 BR    @14                                                 1007
*   END CHEKTARG;                   /*                       #Y30LB34*/
*                                                                  1009
*/********************************************************** #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* PROCEDURE NAME - RVMOVE                                  #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* FUNCTION - CONTROLS THE DATA CONVERSION PROCESS WHICH    #Y30LB34*/
*/*            CONSISTS OF THREE OPERATIONS:                 #Y30LB34*/
*/*                1)  COPY VOLUME,                          #Y30LB34*/
*/*                2)  UPDATE TARGET VOLUME VTOC,            #Y30LB34*/
*/*                3)  RECATALOG DATA SETS.  (THIS IS ONLY   @Y30LB34*/
*/*                    ESSENTIAL FOR VSAM VOLUMES.)          @Y30LB34*/
*/*                     IF ANY OF THESE OPERATIONS IS NOT    @Y30LB34*/
*/*                     COMPLETED, PRINTS MESSAGE IDC0737I   @Y30LB34*/
*/*                     TO NOTIFY TERMINATION OF PROCESSING  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RVMOVDAT TO COPY THE DATA FROM REAL TO  @Y30LB34*/
*/*            VIRTUAL                                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            MOUNTS THE MSS TARGET VOLUME AND CALLS        @Y30LB34*/
*/*            UPDVTOC TO UPDATE THE VTOC                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RECATCTL TO DETERMINE WHAT RECATALOGING @Y30LB34*/
*/*            IS TO BE DONE AND REQUESTS VSAM RECATALOGING  @Y30LB34*/
*/*            IF NECESSARY                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RVCLEAR TO CLEAR RECOVERY FLAGS AT THE  @Y30LB34*/
*/*            APPROPRIATE TIME                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF NON-VSAM RECATALOGING IS TO BE DONE,       @Y30LB34*/
*/*            REQUESTS VOLUME SERVICES TO RECATALOG NON-    @Y30LB34*/
*/*            VSAM DATA SETS NOT ALREADY RECATALOGED        @Y30LB34*/
*/*                PRINTS MESSAGE IDC0748I NOTIFYING         @Y30LB34*/
*/*                NON-VSAM DATA SETS RECATALOGED            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES TARGET VOLUME RESERVED IN UPDVTOC    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEMOUNTS TARGET VOLUME IF VOLSERS ARE EQUAL   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES TARGET VOLUME ENQUEUED IN RVINITTA   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - SAMESER, MDAGL, PUAGL, VS1AGL, TARGAREA          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM UPDVTOC           @Y30LB34*/
*/*           R. C. =  8, RETURN CODE FROM UPDVTOC,          @Y30LB34*/
*/*                       UNABLE TO RECATALOG NON-VSAM DATA  @Y30LB34*/
*/*                       SETS,                              @Y30LB34*/
*/*                       UNABLE TO MOUNT VOLUME,            @Y30LB34*/
*/*                       UNABLE TO DEMOUNT VOLUME           @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM RVMOVDAT,         @Y30LB34*/
*/*                       UPDVTOC, RVCLEAR, OR RECATCTL      @Y30LB34*/
*/*                       UNABLE TO MOUNT VOLUME             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1009
*RVMOVE:                                                           1009
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1009
RVMOVE   DS    0H                                                  1010
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1010
*   DCL                                                            1010
*     CC11 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1011
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1011
*   OLDERID2=NEWERID2;                                             1011
         L     @11,@PC00001                                        1011
         L     @11,GDTTR2(,@11)                                    1011
         MVC   @TS00001(95),NEWERID2(@11)                          1011
         MVC   OLDERID2(95,@11),@TS00001                           1011
*   NEWID2='CNTB';                  /*                       @Y30LB34*/
*                                                                  1012
         MVC   NEWID2(4,@11),@CC01747                              1012
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1013
*   CC11=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC11,CC11                                           1013
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  1014
         LR    RTNREG2,REG14                                       1014
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL RVMOVDAT TO COPY THE DATA FROM THE REAL VOLUME   @Y30LB34*/
*   /* TO THE MSS VOLUME                                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1015
*   CALL RVMOVDAT;                  /*                       @Y30LB34*/
         BAL   @14,RVMOVDAT                                        1015
*   RESPECIFY                                                      1016
*     RTNREG RSTD;                                                 1016
*   TESTRC=RTNREG;                                                 1017
         STH   RTNREG,TESTRC                                       1017
*   RESPECIFY                                                      1018
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC11=TESTRC;                    /*                       @Y30LB34*/
         LH    @15,TESTRC                                          1019
         LR    CC11,@15                                            1019
*                                                                  1020
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR OCCURRED IN RVMOVDAT, DETERMINE    @Y30LB34*/
*   /* IF RECOVERY FLAG CAN BE CLEARED                       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1020
*   IF CC11<LASTCC12 THEN                                          1020
         C     CC11,@CF00567                                       1020
         BNL   @RF01020                                            1020
*     DO;                           /*                       @Y30LB34*/
*                                                                  1021
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS NOT VSAM AND NO SERIAL NUMBER    @Y30LB34*/
*       /* UPDATING NEEDS TO BE DONE, CALL RVCLEAR TO        @Y30LB34*/
*       /* CLEAR THE RECOVERY FLAG                           @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1022
*       RESPECIFY                                                  1022
*         VS1AGL BASED(ADDR(FRVS1AGL));/*                    @Y30LB34*/
*       IF SAMESER=ON&VSVSAM=OFF THEN                              1023
         TM    SAMESER,B'10000000'                                 1023
         BNO   @RF01023                                            1023
         LA    @11,FRVS1AGL                                        1023
         TM    VSVSAM(@11),B'10000000'                             1023
         BNZ   @RF01023                                            1023
*         DO;                       /*                       @Y30LB34*/
*           CALL RVCLEAR;           /*                       @Y30LB34*/
         BAL   @14,RVCLEAR                                         1025
*           RESPECIFY                                              1026
*             RTNREG RSTD;                                         1026
*           TESTRC=RTNREG;                                         1027
         STH   RTNREG,TESTRC                                       1027
*           RESPECIFY                                              1028
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           CC11=MAX(CC11,TESTRC);  /*                       @Y30LB34*/
         LH    @11,TESTRC                                          1029
         CR    CC11,@11                                            1029
         BNL   *+6
         LR    CC11,@11                                            1029
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  1031
@RF01023 DS    0H                                                  1032
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR HAS OCCURRED, MOUNT THE TARGET     @Y30LB34*/
*   /* VOLUME. IF THE SOURCE AND TARGET VOLSERS ARE          @Y30LB34*/
*   /* EQUAL, CLEAR THE SOURCE UCB BEFORE MOUNT.             @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1032
*   IF CC11<LASTCC12 THEN                                          1032
@RF01020 C     CC11,@CF00567                                       1032
         BNL   @RF01032                                            1032
*     DO;                           /*                       @Y30LB34*/
*       IF SAMESER=ON THEN                                         1034
         TM    SAMESER,B'10000000'                                 1034
         BNO   @RF01034                                            1034
*         MDCLEAR=ON;               /*                       @Y30LB34*/
         LA    @11,MDAGLAR                                         1035
         OI    MDCLEAR(@11),B'01000000'                            1035
*       CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                 @Y30LB34*/
@RF01034 L     @11,@PC00001                                        1036
         ST    @11,@AL00001                                        1036
         LA    @15,MOUNT                                           1036
         ST    @15,@AL00001+4                                      1036
         LA    @15,MDAGLAR                                         1036
         ST    @15,@AL00001+8                                      1036
         MVI   @AL00001+8,X'80'                                    1036
         L     @15,GDTUNT(,@11)                                    1036
         LA    @01,@AL00001                                        1036
         BALR  @14,@15                                             1036
*       RESPECIFY                                                  1037
*         RTNREG RSTD;                                             1037
*       TESTRC=RTNREG;                                             1038
         STH   RTNREG,TESTRC                                       1038
*       RESPECIFY                                                  1039
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       MDCLEAR=OFF;                /*                       @Y30LB34*/
         LA    @11,MDAGLAR                                         1040
         NI    MDCLEAR(@11),B'10111111'                            1040
*                                                                  1041
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE MOUNT IS UNSUCCESSFUL, SET AN              @Y30LB34*/
*       /* APPROPRIATE CONDITION CODE                        @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1041
*       IF TESTRC>0 THEN                                           1041
         LH    @11,TESTRC                                          1041
         LTR   @11,@11                                             1041
         BNP   @RF01041                                            1041
*         DO;                       /*                       @Y30LB34*/
*                                                                  1042
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE SERIAL NUMBER DOES NOT HAVE TO         @Y30LB34*/
*           /* BE UPDATED AND NO VSAM RECATALOGING           @Y30LB34*/
*           /* IS NECESSARY, THE MAJOR FUNCTION IS           @Y30LB34*/
*           /* COMPLETE                                      @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1043
*           IF SAMESER=ON&VSVSAM=OFF THEN                          1043
         TM    SAMESER,B'10000000'                                 1043
         BNO   @RF01043                                            1043
         LA    @15,FRVS1AGL                                        1043
         TM    VSVSAM(@15),B'10000000'                             1043
         BNZ   @RF01043                                            1043
*             DO;                   /*                       @Y30LB34*/
*               CC11=LASTCC08;      /*                       @Y30LB34*/
         LA    CC11,8                                              1045
*               MSGSW=ON;           /*                       @Y30LB34*/
         OI    MSGSW,B'00001000'                                   1046
*             END;                  /*                       @Y30LB34*/
*                                                                  1047
*           /*********************************************************/
*           /*                                                       */
*           /* THE MAJOR FUNCTION IS NOT COMPLETE            @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1048
*           ELSE                                                   1048
*             CC11=LASTCC12;        /*                       @Y30LB34*/
         B     @RC01043                                            1048
@RF01043 LA    CC11,12                                             1048
*         END;                      /*                       @Y30LB34*/
*                                                                  1050
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT HAS MOUNTED THE MSS VOLUME,           @Y30LB34*/
*       /* CONTINUE PROCESSING.                              @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1050
*       ELSE                                                       1050
*         DO;                       /*                       @Y30LB34*/
*                                                                  1050
         B     @RC01041                                            1050
@RF01041 DS    0H                                                  1051
*           /*********************************************************/
*           /*                                                       */
*           /* CALL UPDVTOC TO UPDATE THE TARGET VOLUME VTOC @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1051
*           CALL UPDVTOC;           /*                       @Y30LB34*/
         BAL   @14,UPDVTOC                                         1051
*           RESPECIFY                                              1052
*             RTNREG RSTD;                                         1052
*           TESTRC=RTNREG;                                         1053
         STH   RTNREG,TESTRC                                       1053
*           RESPECIFY                                              1054
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           CC11=MAX(CC11,TESTRC);  /*                       @Y30LB34*/
*                                                                  1055
         LH    @11,TESTRC                                          1055
         CR    CC11,@11                                            1055
         BNL   *+6
         LR    CC11,@11                                            1055
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO SEVERE ERROR OCCURRED IN UPDVTOC,       @Y30LB34*/
*           /* DETERMINE IF THE RECOVERY FLAG CAN BE CLEARED @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1056
*           IF CC11<LASTCC12 THEN                                  1056
         C     CC11,@CF00567                                       1056
         BNL   @RF01056                                            1056
*             DO;                   /*                       @Y30LB34*/
*                                                                  1057
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE VOLUME IS NOT VSAM AND THE SERIAL  @Y30LB34*/
*               /* NUMBER HAS BEEN UPDATED, CALL RVCLEAR TO  @Y30LB34*/
*               /* CLEAR THE RECOVERY FLAG                   @Y30LB34*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1058
*               IF SAMESER=OFF&VSVSAM=OFF THEN                     1058
         TM    SAMESER,B'10000000'                                 1058
         BNZ   @RF01058                                            1058
         LA    @11,FRVS1AGL                                        1058
         TM    VSVSAM(@11),B'10000000'                             1058
         BNZ   @RF01058                                            1058
*                 DO;               /*                       @Y30LB34*/
*                   CALL RVCLEAR;   /*                       @Y30LB34*/
         BAL   @14,RVCLEAR                                         1060
*                   RESPECIFY                                      1061
*                     RTNREG RSTD;                                 1061
*                   TESTRC=RTNREG;                                 1062
         STH   RTNREG,TESTRC                                       1062
*                   RESPECIFY                                      1063
*                     RTNREG UNRSTD;/*                       @Y30LB34*/
*                   CC11=MAX(CC11,TESTRC);/*                 @Y30LB34*/
         LH    @11,TESTRC                                          1064
         CR    CC11,@11                                            1064
         BNL   *+6
         LR    CC11,@11                                            1064
*                 END;              /*                       @Y30LB34*/
*             END;                  /*                       @Y30LB34*/
@RF01058 DS    0H                                                  1067
*                                                                  1067
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO SEVERE ERROR HAS OCCURRED, CALL         @Y30LB34*/
*           /* RECATCTL TO CONTROL THE RECATALOGING TO BE    @Y30LB34*/
*           /* DONE                                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1067
*           IF CC11<LASTCC12 THEN                                  1067
@RF01056 C     CC11,@CF00567                                       1067
         BNL   @RF01067                                            1067
*             DO;                   /*                       @Y30LB34*/
*               CALL RECATCTL;      /*                       @Y30LB34*/
         BAL   @14,RECATCTL                                        1069
*               RESPECIFY                                          1070
*                 RTNREG RSTD;                                     1070
*               TESTRC=RTNREG;                                     1071
         STH   RTNREG,TESTRC                                       1071
*               RESPECIFY                                          1072
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/
*               CC11=MAX(CC11,TESTRC);/*                     @Y30LB34*/
         LH    @11,TESTRC                                          1073
         CR    CC11,@11                                            1073
         BNL   *+6
         LR    CC11,@11                                            1073
*             END;                  /*                       @Y30LB34*/
*                                                                  1074
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO SEVERE ERROR HAS OCCURRED AND IF THE    @Y30LB34*/
*           /* VOLUME IS VSAM, CALL RVCLEAR TO CLEAR         @Y30LB34*/
*           /* THE RECOVERY FLAG.                            @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1075
*           IF CC11<LASTCC12&VSVSAM=ON THEN                        1075
@RF01067 C     CC11,@CF00567                                       1075
         BNL   @RF01075                                            1075
         LA    @11,FRVS1AGL                                        1075
         TM    VSVSAM(@11),B'10000000'                             1075
         BNO   @RF01075                                            1075
*             DO;                   /*                       @Y30LB34*/
*               CALL RVCLEAR;       /*                       @Y30LB34*/
         BAL   @14,RVCLEAR                                         1077
*               RESPECIFY                                          1078
*                 RTNREG RSTD;                                     1078
*               TESTRC=RTNREG;                                     1079
         STH   RTNREG,TESTRC                                       1079
*               RESPECIFY                                          1080
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/
*               CC11=MAX(CC11,TESTRC);/*                     @Y30LB34*/
         LH    @11,TESTRC                                          1081
         CR    CC11,@11                                            1081
         BNL   *+6
         LR    CC11,@11                                            1081
*             END;                  /*                       @Y30LB34*/
*                                                                  1083
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO SEVERE ERROR HAS OCCURRED AND THE NON-  @Y30LB34*/
*           /* VSAM DATA SETS ARE TO BE RECATALOGED, CALL    @Y30LB34*/
*           /* VOLUME SERVICES TO HANDLE IT                  @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1083
*           IF CC11<LASTCC12&NONVSAM=ON THEN                       1083
@RF01075 C     CC11,@CF00567                                       1083
         BNL   @RF01083                                            1083
         TM    NONVSAM,B'00010000'                                 1083
         BNO   @RF01083                                            1083
*             DO;                   /*                       @Y30LB34*/
*               RESPECIFY                                          1085
*                 VS1AGL BASED(ADDR(TOVS1AGL));/*            @Y30LB34*/
*               CALL IDCSACL0(GDTTBL,'IDCVS01 ',RECATLG,VS1AGL);/* 1086
*                                                            @YM02865*/
         L     @11,@PC00001                                        1086
         ST    @11,@AL00001                                        1086
         LA    @15,@CC01720                                        1086
         ST    @15,@AL00001+4                                      1086
         LA    @15,RECATLG                                         1086
         ST    @15,@AL00001+8                                      1086
         LA    @15,TOVS1AGL                                        1086
         ST    @15,@AL00001+12                                     1086
         MVI   @AL00001+12,X'80'                                   1086
         L     @15,GDTCAL(,@11)                                    1086
         LA    @01,@AL00001                                        1086
         BALR  @14,@15                                             1086
*               RESPECIFY                                          1087
*                 RTNREG RSTD;                                     1087
*               TESTRC=RTNREG;                                     1088
         STH   RTNREG,TESTRC                                       1088
*               RESPECIFY                                          1089
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/
*                                                                  1089
*               /*****************************************************/
*               /*                                                   */
*               /* IF VOLUME SERVICES WAS UNSUCCESSFUL, SET  @Y30LB34*/
*               /* CONDITION CODE TO 8.                      @Y30LB34*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1090
*               IF TESTRC>0 THEN                                   1090
         LH    @11,TESTRC                                          1090
         LTR   @11,@11                                             1090
         BNP   @RF01090                                            1090
*                 CC11=LASTCC08;    /*                       @Y30LB34*/
*                                                                  1091
         LA    CC11,8                                              1091
*               /*****************************************************/
*               /*                                                   */
*               /* IF VOLUME SERVICES WAS SUCCESSFUL, PRINT  @Y30LB34*/
*               /* MESSAGE IDC0748I NOTIFYING THAT NON-VSAM  @Y30LB34*/
*               /* DATA SETS ARE RECATALOGED                 @Y30LB34*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1092
*               ELSE                                               1092
*                 DO;               /*                       @Y30LB34*/
         B     @RC01090                                            1092
@RF01090 DS    0H                                                  1093
*                   DARGSMOD=CONVMSG;/*                      @Y30LB34*/
         L     @11,DDSTRU                                          1093
         MVC   DARGSMOD(3,@11),@CC01557                            1093
*                   DARGSENT=MSG0748I;/*                     @Y30LB34*/
         MVI   DARGSENT(@11),X'0C'                                 1094
*                   DARGDBP=0;      /*                       @Y30LB34*/
         SLR   @15,@15                                             1095
         ST    @15,DARGDBP(,@11)                                   1095
*                   DARGILP=0;      /*                       @Y30LB34*/
         STH   @15,DARGILP(,@11)                                   1096
*                   DARGRETP=0;     /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@11)                                  1097
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB34*/
         L     @11,@PC00001                                        1098
         ST    @11,@AL00001                                        1098
         LA    @15,@CF00115                                        1098
         ST    @15,@AL00001+4                                      1098
         LA    @15,DDSTRU                                          1098
         ST    @15,@AL00001+8                                      1098
         MVI   @AL00001+8,X'80'                                    1098
         L     @15,GDTPRT(,@11)                                    1098
         LA    @01,@AL00001                                        1098
         BALR  @14,@15                                             1098
*                 END;              /*                       #Y30LB34*/
*                                                                  1099
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE VTOC WAS OPENED BY VOLUME SERVICES @ZM32896*/
*               /* CLOSE IT AND SET THE IOCSTR PTR TO 0.     @ZM32896*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1100
*               IF VSIOP^=NULLPTR THEN                             1100
@RC01090 LA    @11,TOVS1AGL                                        1100
         L     @15,VSIOP(,@11)                                     1100
         LTR   @15,@15                                             1100
         BZ    @RF01100                                            1100
*                 DO;               /*                       @ZM32896*/
*                   CALL IDCIOCL0(GDTTBL,VSIOP);/*           @ZM32896*/
         L     @15,@PC00001                                        1102
         ST    @15,@AL00001                                        1102
         LA    @11,VSIOP(,@11)                                     1102
         ST    @11,@AL00001+4                                      1102
         MVI   @AL00001+4,X'80'                                    1102
         L     @15,GDTCLS(,@15)                                    1102
         LA    @01,@AL00001                                        1102
         BALR  @14,@15                                             1102
*                   RESPECIFY                                      1103
*                     RTNREG RSTD;                                 1103
*                   TESTRC=RTNREG;                                 1104
         STH   RTNREG,TESTRC                                       1104
*                   RESPECIFY                                      1105
*                     RTNREG UNRSTD;/*                       @ZM32896*/
*                   CC11=MAX(CC11,TESTRC);/*                 @ZM32896*/
         LH    @11,TESTRC                                          1106
         CR    CC11,@11                                            1106
         BNL   *+6
         LR    CC11,@11                                            1106
*                   VSIOP=NULLPTR;  /*                       @ZM32896*/
         LA    @11,TOVS1AGL                                        1107
         SLR   @15,@15                                             1107
         ST    @15,VSIOP(,@11)                                     1107
*                 END;              /*                       @ZM32896*/
*             END;                  /*                       #Y30LB34*/
@RF01100 DS    0H                                                  1110
*                                                                  1110
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE TARGET VOLUME WAS RESERVED IN UPDVTOC, #Y30LB34*/
*           /* RELEASE THAT RESERVE AND SET OFF THE TARGET   #Y30LB34*/
*           /* RESERVE BIT                                   #Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1110
*           IF TRES=ON THEN                                        1110
@RF01083 TM    TRES,B'01000000'                                    1110
         BNO   @RF01110                                            1110
*             DO;                   /*                       #Y30LB34*/
*               CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*       #Y30LB34*/
         L     @11,@PC00001                                        1112
         ST    @11,@AL00001                                        1112
         LA    @15,@CC01594                                        1112
         ST    @15,@AL00001+4                                      1112
         LA    @15,RNAMEVR                                         1112
         ST    @15,@AL00001+8                                      1112
         MVI   @AL00001+8,X'80'                                    1112
         L     @15,GDTDEQ(,@11)                                    1112
         LA    @01,@AL00001                                        1112
         BALR  @14,@15                                             1112
*               TRES=OFF;           /*                       #Y30LB34*/
         NI    TRES,B'10111111'                                    1113
*             END;                  /*                       #Y30LB34*/
*                                                                  1114
*           /*********************************************************/
*           /*                                                       */
*           /* DEMOUNT THE TARGET VOLUME IF THE SOURCE AND   #Y30LB34*/
*           /* TARGET VOLSERS ARE EQUAL. POST THE SOURCE UCB #Y30LB34*/
*           /* AFTER DEMOUNT.                                #Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1115
*           IF SAMESER=ON THEN                                     1115
@RF01110 TM    SAMESER,B'10000000'                                 1115
         BNO   @RF01115                                            1115
*             DO;                   /*                       #Y30LB34*/
*               MDPOST=ON;          /*                       #Y30LB34*/
*               MDWAIT=ON;          /*                       #Y30LB34*/
         LA    @11,MDAGLAR                                         1118
         OI    MDPOST(@11),B'00110000'                             1118
*               CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*       #Y30LB34*/
         L     @15,@PC00001                                        1119
         ST    @15,@AL00001                                        1119
         LA    @14,DEMOUNT                                         1119
         ST    @14,@AL00001+4                                      1119
         ST    @11,@AL00001+8                                      1119
         MVI   @AL00001+8,X'80'                                    1119
         L     @15,GDTUNT(,@15)                                    1119
         LA    @01,@AL00001                                        1119
         BALR  @14,@15                                             1119
*               RESPECIFY                                          1120
*                 RTNREG RSTD;                                     1120
*               TESTRC=RTNREG;                                     1121
         STH   RTNREG,TESTRC                                       1121
*               RESPECIFY                                          1122
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/
*                                                                  1123
*               /*****************************************************/
*               /*                                                   */
*               /* IF UMSSUNIT IS UNSUCCESSFUL SET           @Y30LB34*/
*               /* APPROPRIATE CONDITION CODE                @Y30LB34*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1123
*               IF TESTRC>0 THEN                                   1123
         LH    @11,TESTRC                                          1123
         SLR   @15,@15                                             1123
         CR    @11,@15                                             1123
         BNH   @RF01123                                            1123
*                 DO;               /*                       @Y30LB34*/
*                                                                  1124
*                   /*************************************************/
*                   /*                                               */
*                   /* IF 'NOSCRATCH' WAS SPECIFIED ALL      @Y30LB34*/
*                   /* FUNCTION IS COMPLETE                  @Y30LB34*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1125
*                   IF ADDR(NSCR)^=NULLPTR THEN                    1125
         L     @11,@PC00001+4                                      1125
         C     @15,FDTPTR+36(,@11)                                 1125
         BE    @RF01125                                            1125
*                     CC11=MAX(CC11,LASTCC04);/*             @Y30LB34*/
*                                                                  1126
         LA    @11,4                                               1126
         CR    CC11,@11                                            1126
         BNL   *+6
         LR    CC11,@11                                            1126
*                   /*************************************************/
*                   /*                                               */
*                   /* IF SOURCE VOLUME WAS TO BE SCRATCHED, @Y30LB34*/
*                   /* MAJOR FUNCTION MAY BE COMPLETE. END   @Y30LB34*/
*                   /* WITH CONDITION CODE OF 8 OR GREATER   @Y30LB34*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1127
*                   ELSE                                           1127
*                     CC11=MAX(CC11,LASTCC08);/*             @Y30LB34*/
         B     @RC01125                                            1127
@RF01125 LA    @11,8                                               1127
         CR    CC11,@11                                            1127
         BNL   *+6
         LR    CC11,@11                                            1127
*                 END;              /*                       @Y30LB34*/
*                                                                  1128
@RC01125 DS    0H                                                  1129
*               /*****************************************************/
*               /*                                                   */
*               /* SET OFF POST AND WAIT BITS                @Y30LB34*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1129
*               MDPOST=OFF;         /*                       @Y30LB34*/
@RF01123 DS    0H                                                  1130
*               MDWAIT=OFF;         /*                       @Y30LB34*/
         LA    @11,MDAGLAR                                         1130
         NI    MDPOST(@11),B'11001111'                             1130
*             END;                  /*                       @Y30LB34*/
*         END;                      /*                       @Y30LB34*/
@RF01115 DS    0H                                                  1133
*     END;                          /*                       @Y30LB34*/
@RC01041 DS    0H                                                  1134
*                                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A SEVERE ERROR OCCURRED DURING THIS PROCEDURE      @Y30LB34*/
*   /* PRINT MESSAGE IDC0737I TO NOTIFY WHERE PROCESSING     @Y30LB34*/
*   /* TERMINATED                                            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1134
*   IF(CC11=LASTCC12)×MSGSW=ON THEN                                1134
@RF01032 C     CC11,@CF00567                                       1134
         BE    @RT01134                                            1134
         TM    MSGSW,B'00001000'                                   1134
         BNO   @RF01134                                            1134
@RT01134 DS    0H                                                  1135
*     DO;                           /*                       @Y30LB34*/
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/
         L     @11,DDSTRU                                          1136
         MVC   DARGSMOD(3,@11),@CC01557                            1136
*       DARGSENT=MSG0737I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@11),X'02'                                 1137
*       DARGDBP=0;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1138
         ST    @15,DARGDBP(,@11)                                   1138
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @15,DARGILP(,@11)                                   1139
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@11)                                  1140
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @11,@PC00001                                        1141
         ST    @11,@AL00001                                        1141
         LA    @15,@CF00115                                        1141
         ST    @15,@AL00001+4                                      1141
         LA    @15,DDSTRU                                          1141
         ST    @15,@AL00001+8                                      1141
         MVI   @AL00001+8,X'80'                                    1141
         L     @15,GDTPRT(,@11)                                    1141
         LA    @01,@AL00001                                        1141
         BALR  @14,@15                                             1141
*     END;                          /*                       @Y30LB34*/
*                                                                  1142
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TARGET VOLUME WAS ENQUEUED IN RVINITTA,        @Y30LB34*/
*   /* RELEASE THAT ENQUEUE AND SET OFF THE TARGET ENQ BIT   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1143
*   IF TENQ=ON THEN                                                1143
@RF01134 TM    TENQ,B'10000000'                                    1143
         BNO   @RF01143                                            1143
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVE);/*               @Y30LB34*/
         L     @11,@PC00001                                        1145
         ST    @11,@AL00001                                        1145
         LA    @15,@CC01594                                        1145
         ST    @15,@AL00001+4                                      1145
         LA    @15,RNAMEVE                                         1145
         ST    @15,@AL00001+8                                      1145
         MVI   @AL00001+8,X'80'                                    1145
         L     @15,GDTDEQ(,@11)                                    1145
         LA    @01,@AL00001                                        1145
         BALR  @14,@15                                             1145
*       TENQ=OFF;                   /*                       @Y30LB34*/
         NI    TENQ,B'01111111'                                    1146
*     END;                          /*                       @Y30LB34*/
*                                                                  1147
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/
*   /* RETURN TO CALLER                                      #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1148
*   REG14=RTNREG2;                  /*                       #Y30LB34*/
@RF01143 LR    REG14,RTNREG2                                       1148
*   RETURN CODE(CC11);              /*                       #Y30LB34*/
         LR    @15,CC11                                            1149
@EL00012 DS    0H                                                  1149
@EF00012 DS    0H                                                  1149
@ER00012 BR    @14                                                 1149
*   END RVMOVE;                     /*                       #Y30LB34*/
*                                                                  1151
*/********************************************************** #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* PROCEDURE NAME - RVMOVDAT                                #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* FUNCTION - MOVES THE DATA FROM REAL TO VIRTUAL           #Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES ICBCOVC PARM LIST FOR DASD TO     @Y30LB34*/
*/*            CARTRIDGE                                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES IEZCOVCE PARM LIST FOR THE MSVC   @Y30LB34*/
*/*            EXTENSION TO ICBCOVC                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES USSC TO ISSUE ICBCOVC TO COPY THE DATA @Y30LB34*/
*/*                IF THE COPY COULD NOT START, ISSUES ERROR @Y30LB34*/
*/*                MESSAGE IDC3082I,                         @Y30LB34*/
*/*                IF THE COPY ENCOUNTERED AN ERROR AFTER IT @Y30LB34*/
*/*                PARTIALLY COMPLETED, ISSUES ERROR MESSAGE @Y30LB34*/
*/*                IDC3071I,                                 @Y30LB34*/
*/*                IF THE COPY WAS SUCCESSFUL, ISSUES        @Y30LB34*/
*/*                MESSAGE IDC0743I.                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT = ICBCOVC, IEZCOVCE, TARGAREA, SRCEAREA, FRVS1AGL, @Y30LB34*/
*/*         DARGLIST                                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - ICBCOVC, IEZCOVCE                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. = 12, UNABLE TO CONVERT VOLUME           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1151
*RVMOVDAT:                                                         1151
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1151
RVMOVDAT DS    0H                                                  1152
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1152
*   DCL                                                            1152
*     CC12 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1153
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   OLDERID2=NEWERID2;                                             1153
         L     @08,@PC00001                                        1153
         L     @15,GDTTR2(,@08)                                    1153
         MVC   @TS00001(95),NEWERID2(@15)                          1153
         MVC   OLDERID2(95,@15),@TS00001                           1153
*   NEWID2='CNTC';                  /*                       @Y30LB34*/
*                                                                  1154
         MVC   NEWID2(4,@15),@CC01760                              1154
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*   CC12=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC12,CC12                                           1155
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  1156
         ST    REG14,RTNREG3                                       1156
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE ICBCOVC PARM LIST                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1157
*   CVODASCR=ON;                    /*                       @Y30LB34*/
         L     @15,CVOLPTR                                         1157
         OI    CVODASCR(@15),B'10000000'                           1157
*   CVOLRUA=SUNITADR;               /*                       @Y30LB34*/
         LH    @14,SUNITADR                                        1158
         STH   @14,CVOLRUA(,@15)                                   1158
*   CVOLID=TVOLSER;                 /*                       @Y30LB34*/
         MVC   CVOLID(6,@15),TVOLSER                               1159
*   CVOLVEXT=COVCEPTR;              /*                       @Y30LB34*/
*                                                                  1160
         L     @14,COVCEPTR                                        1160
         ST    @14,CVOLVEXT(,@15)                                  1160
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IEZCOVCE PARM LIST                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1161
*   COVICOPY=ON;                    /*                       @Y30LB34*/
         OI    COVICOPY(@14),B'10000000'                           1161
*   COVSRCVY=ON;                    /*                       @Y30LB34*/
         OI    COVSRCVY(@14),B'10000000'                           1162
*   COVLNGTH=COVLEN;                /*                       @Y30LB34*/
*                                                                  1163
         LH    @15,COVLEN                                          1163
         ST    @15,COVLNGTH(,@14)                                  1163
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE USSC MACRO TO ISSUE ICBCOVC WHICH WILL      @Y30LB34*/
*   /* COPY THE DATA FROM THE REAL VOLUME TO THE MSS         @Y30LB34*/
*   /* VOLUME                                                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1164
*   CALL IDCSASS0(GDTTBL,COPYVOL,CVOLPTR,USSCREG0,USSCECB);/*      1164
*                                                            @Y30LB34*/
         ST    @08,@AL00001                                        1164
         LA    @15,COPYVOL                                         1164
         ST    @15,@AL00001+4                                      1164
         LA    @15,CVOLPTR                                         1164
         ST    @15,@AL00001+8                                      1164
         LA    @15,USSCREG0                                        1164
         ST    @15,@AL00001+12                                     1164
         LA    @15,USSCECB                                         1164
         ST    @15,@AL00001+16                                     1164
         MVI   @AL00001+16,X'80'                                   1164
         L     @15,GDTSSC(,@08)                                    1164
         LA    @01,@AL00001                                        1164
         BALR  @14,@15                                             1164
*   RESPECIFY                                                      1165
*     RTNREG RSTD;                                                 1165
*   TESTRC=RTNREG;                                                 1166
         STH   RTNREG,TESTRC                                       1166
*   RESPECIFY                                                      1167
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1167
*   /*****************************************************************/
*   /*                                                               */
*   /* ANALYZE THE RETURN CODE FROM USSC                     @Y30LB34*/
*   /*                                                       @Y30LB34*/
*   /*                                                       @Y30LB34*/
*   /* IF IT WAS SUCCESSFUL PRINT MESSAGE IDC0743I           @Y30LB34*/
*   /* NOTIFYING A SUCCESSFUL COPY                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   IF TESTRC=0×TESTRC=12 THEN                                     1168
         LH    @08,TESTRC                                          1168
         LTR   @08,@08                                             1168
         BZ    @RT01168                                            1168
         C     @08,@CF00567                                        1168
         BNE   @RF01168                                            1168
@RT01168 DS    0H                                                  1169
*     DO;                           /*                       @Y30LB34*/
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1170
         MVC   DARGSMOD(3,@08),@CC01557                            1170
*       DARGSENT=MSG0743I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'07'                                 1171
*       DARGDBP=0;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1172
         ST    @15,DARGDBP(,@08)                                   1172
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @15,DARGILP(,@08)                                   1173
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@08)                                  1174
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @08,@PC00001                                        1175
         ST    @08,@AL00001                                        1175
         LA    @15,@CF00115                                        1175
         ST    @15,@AL00001+4                                      1175
         LA    @15,DDSTRU                                          1175
         ST    @15,@AL00001+8                                      1175
         MVI   @AL00001+8,X'80'                                    1175
         L     @15,GDTPRT(,@08)                                    1175
         LA    @01,@AL00001                                        1175
         BALR  @14,@15                                             1175
*     END;                          /*                       @Y30LB34*/
*                                                                  1176
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IT WAS NOT SUCCESSFUL DETERMINE TYPE OF ERROR      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1177
*   ELSE                                                           1177
*     DO;                           /*                       @Y30LB34*/
         B     @RC01168                                            1177
@RF01168 DS    0H                                                  1178
*       CC12=LASTCC12;              /*                       @Y30LB34*/
*                                                                  1178
         LA    CC12,12                                             1178
*       /*************************************************************/
*       /*                                                           */
*       /* IF USSC FAILED PRINT ERROR MESSAGES               @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1179
*       IF TESTRC=4 THEN                                           1179
         CLC   TESTRC(2),@CH00036                                  1179
         BNE   @RF01179                                            1179
*         DO;                       /*                       @Y30LB34*/
*                                                                  1180
*           /*********************************************************/
*           /*                                                       */
*           /* CALL SSCMSG TO PRINT USSC ERROR MESSAGE       @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1181
*           CALL SSCMSG(USSCREG0,USSCECB);/*                 @Y30LB34*/
         LA    @08,USSCREG0                                        1181
         ST    @08,@AL00001                                        1181
         LA    @08,USSCECB                                         1181
         ST    @08,@AL00001+4                                      1181
         LA    @01,@AL00001                                        1181
         BAL   @14,SSCMSG                                          1181
*                                                                  1182
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE REASON CODE IS NOT ZERO SIGNIFYING     @Y30LB34*/
*           /* THE COPY WAS NOT STARTED ISSUE MESSAGE        @Y30LB34*/
*           /* IDC3082I.                                     @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1182
*           IF USSCREG0^=0 THEN                                    1182
         L     @08,USSCREG0                                        1182
         LTR   @08,@08                                             1182
         BZ    @RF01182                                            1182
*             DO;                   /*                       @Y30LB34*/
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1184
         MVC   DARGSMOD(3,@08),@CC01555                            1184
*               DARGSENT=MSG3082I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'18'                                 1185
*             END;                  /*                       @Y30LB34*/
*                                                                  1186
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE REASON CODE IS ZERO SIGNIFYING THE     @Y30LB34*/
*           /* COPY WAS STARTED BUT DID NOT COMPLETE,        @Y30LB34*/
*           /* ISSUE ERROR MESSAGE IDC3071I.                 @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1187
*           ELSE                                                   1187
*             DO;                   /*                       @Y30LB34*/
         B     @RC01182                                            1187
@RF01182 DS    0H                                                  1188
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1188
         MVC   DARGSMOD(3,@08),@CC01555                            1188
*               DARGSENT=MSG3071I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'23'                                 1189
*             END;                  /*                       @Y30LB34*/
*           DARGDBP=0;              /*                       @Y30LB34*/
@RC01182 SLR   @08,@08                                             1191
         L     @15,DDSTRU                                          1191
         ST    @08,DARGDBP(,@15)                                   1191
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @08,DARGILP(,@15)                                   1192
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @08,DARGRETP(,@15)                                  1193
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        1194
         ST    @08,@AL00001                                        1194
         LA    @15,@CF00115                                        1194
         ST    @15,@AL00001+4                                      1194
         LA    @15,DDSTRU                                          1194
         ST    @15,@AL00001+8                                      1194
         MVI   @AL00001+8,X'80'                                    1194
         L     @15,GDTPRT(,@08)                                    1194
         LA    @01,@AL00001                                        1194
         BALR  @14,@15                                             1194
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  1196
@RF01179 DS    0H                                                  1197
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1197
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RC01168 L     REG14,RTNREG3                                       1197
*   RETURN CODE(CC12);              /*                       @Y30LB34*/
         LR    @15,CC12                                            1198
@EL00013 DS    0H                                                  1198
@EF00013 DS    0H                                                  1198
@ER00013 BR    @14                                                 1198
*   END RVMOVDAT;                   /*                       @Y30LB34*/
*                                                                  1200
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - UPDVTOC                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - UPDATES TARGET VOLUME VTOC AND LABEL AFTER    @Y30LB34*/
*/*            DATA HAS BEEN COPIED                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VOLUME SERVICES TO UPDATE THE ALTERNATE @Y30LB34*/
*/*            TRACK INFORMATION AND, IF THE VOLUME IS VSAM, @Y30LB34*/
*/*            THE TIMESTAMP                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CLOSES THE VTOC AFTER VOLUME SERVICES OPENS   @Y30LB34*/
*/*            IT                                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES THE IDCVS02 PARM LIST FOR LABEL   @Y30LB34*/
*/*            UPDATING                                      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VOLUME SERVICES TO UPDATE THE LABEL     @Y30LB34*/
*/*            WITH THE ORIGINAL OWNER OF THE VOLUME AND     @Y30LB34*/
*/*            IF THE VOLSERS ARE NOT EQUAL, UPDATES THE     @Y30LB34*/
*/*            VOLUME SERIAL NUMBER                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF THE VTOC AND LABEL ARE SUCCESSFULLY        @Y30LB34*/
*/*            UPDATED, PRINTS MESSAGE IDC0747I              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - TOVS1AGL,TARGAREA, VS2AGL, FDTTBL, DARGLIST      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INITIALIZED VS2AGL                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, UNABLE TO UPDATE VTOC,             @Y30LB34*/
*/*                       UNABLE TO CLOSE VTOC               @Y30LB34*/
*/*           R. C. =  8, UNABLE TO UPDATE OWNER DATA        @Y30LB34*/
*/*           R. C. = 12, UNABLE TO UPDATE VOLUME SERIAL     @Y30LB34*/
*/*                       NUMBER                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1200
*UPDVTOC:                                                          1200
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1200
UPDVTOC  DS    0H                                                  1201
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1201
*   DCL                                                            1201
*     CC13 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1202
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1202
*   OLDERID2=NEWERID2;                                             1202
         L     @08,@PC00001                                        1202
         L     @15,GDTTR2(,@08)                                    1202
         MVC   @TS00001(95),NEWERID2(@15)                          1202
         MVC   OLDERID2(95,@15),@TS00001                           1202
*   NEWID2='CNTD';                  /*                       @Y30LB34*/
*                                                                  1203
         MVC   NEWID2(4,@15),@CC01765                              1203
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE REGISTER 14                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1204
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  1204
         ST    REG14,RTNREG3                                       1204
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VOLUME SERVICES TO RESTORE THE ORIGINAL          @Y30LB34*/
*   /* ALTERNATE TRACK INFORMATION IN THE VTOC               @Y30LB34*/
*   /* AND UPDATE THE VSAM TIMESTAMP                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1205
*   RESPECIFY                                                      1205
*     VS1AGL BASED(ADDR(TOVS1AGL)); /*                       @Y30LB34*/
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',PUTVTOC,VS1AGL);/*       @Y30LB34*/
         ST    @08,@AL00001                                        1206
         LA    @15,@CC01720                                        1206
         ST    @15,@AL00001+4                                      1206
         LA    @15,PUTVTOC                                         1206
         ST    @15,@AL00001+8                                      1206
         LA    @15,TOVS1AGL                                        1206
         ST    @15,@AL00001+12                                     1206
         MVI   @AL00001+12,X'80'                                   1206
         L     @15,GDTCAL(,@08)                                    1206
         LA    @01,@AL00001                                        1206
         BALR  @14,@15                                             1206
*   RESPECIFY                                                      1207
*     RTNREG RSTD;                                                 1207
*   TESTRC=RTNREG;                                                 1208
         STH   RTNREG,TESTRC                                       1208
*   RESPECIFY                                                      1209
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1209
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE FROM VOLUME SERVICES               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1210
*   CC13=TESTRC;                    /*                       @Y30LB34*/
         LH    @15,TESTRC                                          1210
         LR    CC13,@15                                            1210
*                                                                  1211
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VTOC WAS OPENED BY VOLUME SERVICES, CLOSE IT   @Y30LB34*/
*   /* AND SET THE IOCSTR POINTER TO ZERO                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1211
*   IF VSIOP^=NULLPTR THEN                                         1211
         LA    @08,TOVS1AGL                                        1211
         L     @15,VSIOP(,@08)                                     1211
         LTR   @15,@15                                             1211
         BZ    @RF01211                                            1211
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB34*/
         L     @15,@PC00001                                        1213
         ST    @15,@AL00001                                        1213
         LA    @08,VSIOP(,@08)                                     1213
         ST    @08,@AL00001+4                                      1213
         MVI   @AL00001+4,X'80'                                    1213
         L     @15,GDTCLS(,@15)                                    1213
         LA    @01,@AL00001                                        1213
         BALR  @14,@15                                             1213
*       RESPECIFY                                                  1214
*         RTNREG RSTD;                                             1214
*       TESTRC=RTNREG;                                             1215
         STH   RTNREG,TESTRC                                       1215
*       RESPECIFY                                                  1216
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       VSIOP=NULLPTR;              /*                       @Y30LB34*/
         LA    @08,TOVS1AGL                                        1217
         SLR   @15,@15                                             1217
         ST    @15,VSIOP(,@08)                                     1217
*       CC13=MAX(CC13,TESTRC);      /*                       @Y30LB34*/
         LH    @08,TESTRC                                          1218
         CR    CC13,@08                                            1218
         BNL   *+6
         LR    CC13,@08                                            1218
*     END;                          /*                       @Y30LB34*/
*                                                                  1219
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IDCVS02 PARM LIST TO UPDATE THE        @Y30LB34*/
*   /* OWNER AND IF THE VOLSERS ARE NOT THE SAME,            @Y30LB34*/
*   /* UPDATE THE VOLSER                                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1220
*   VSUCBPTR=ADDR(TUCBADDR);        /*                       @Y30LB34*/
@RF01211 LA    @08,VS2AGLAR                                        1220
         LA    @15,TUCBADDR                                        1220
         ST    @15,VSUCBPTR(,@08)                                  1220
*   VSDDNAME=TFILEVAL;              /*                       @Y30LB34*/
         L     @15,@PC00001+4                                      1221
         L     @01,FDTPTR+4(,@15)                                  1221
         MVC   VSDDNAME(8,@08),TFILEVAL(@01)                       1221
*   VSOWNPTR=ADDR(TOWNER);          /*                       @Y30LB34*/
         LA    @15,TOWNER                                          1222
         ST    @15,VSOWNPTR(,@08)                                  1222
*   VSOWNER=ON;                     /*                       @Y30LB34*/
         OI    VSOWNER(@08),B'10000000'                            1223
*   IF SAMESER=OFF THEN                                            1224
         TM    SAMESER,B'10000000'                                 1224
         BNZ   @RF01224                                            1224
*     DO;                           /*                       @Y30LB34*/
*       VSVOLPTR=ADDR(TVOLSER);     /*                       @Y30LB34*/
         LA    @15,TVOLSER                                         1226
         ST    @15,VSVOLPTR(,@08)                                  1226
*       VSVOLSER=ON;                /*                       @Y30LB34*/
         OI    VSVOLSER(@08),B'01000000'                           1227
*     END;                          /*                       @Y30LB34*/
*   VSVOLUME=TVOLSER;               /*                       @Y30LB34*/
@RF01224 LA    @08,VS2AGLAR                                        1229
         MVC   VSVOLUME(6,@08),TVOLSER                             1229
*   VS2TOV=ON;                      /*                       @Y30LB34*/
*                                                                  1230
         OI    VS2TOV(@08),B'10000000'                             1230
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VOLUME SERVICES TO RESTORE THE ORIGINAL          @Y30LB34*/
*   /* OWNER IN THE LABEL AND, IF NECESSARY, UPDATE          @Y30LB34*/
*   /* THE VOLSER                                            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1231
*   CALL IDCSACL0(GDTTBL,'IDCVS02 ',PUTLABEL,VS2AGL);/*      @Y30LB34*/
         L     @15,@PC00001                                        1231
         ST    @15,@AL00001                                        1231
         LA    @14,@CC01768                                        1231
         ST    @14,@AL00001+4                                      1231
         LA    @14,PUTLABEL                                        1231
         ST    @14,@AL00001+8                                      1231
         ST    @08,@AL00001+12                                     1231
         MVI   @AL00001+12,X'80'                                   1231
         L     @15,GDTCAL(,@15)                                    1231
         LA    @01,@AL00001                                        1231
         BALR  @14,@15                                             1231
*   RESPECIFY                                                      1232
*     RTNREG RSTD;                                                 1232
*   TESTRC=RTNREG;                                                 1233
         STH   RTNREG,TESTRC                                       1233
*   RESPECIFY                                                      1234
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1235
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE LABEL UPDATING WAS NOT SUCCESSFUL,             @Y30LB34*/
*   /* DETERMINE THE SEVERITY OF THE ERROR                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1235
*   IF TESTRC>0 THEN                                               1235
         LH    @08,TESTRC                                          1235
         LTR   @08,@08                                             1235
         BNP   @RF01235                                            1235
*     DO;                           /*                       @Y30LB34*/
*                                                                  1236
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE SERIAL NUMBER NEEDED UPDATING,             @Y30LB34*/
*       /* THE VOLUME IS UNUSABLE. SET THE                   @Y30LB34*/
*       /* CONDITION CODE TO 12.                             @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1237
*       IF SAMESER=OFF THEN                                        1237
         TM    SAMESER,B'10000000'                                 1237
         BNZ   @RF01237                                            1237
*         CC13=LASTCC12;            /*                       @Y30LB34*/
*                                                                  1238
         LA    CC13,12                                             1238
*       /*************************************************************/
*       /*                                                           */
*       /* IF ONLY THE OWNER NEEDED UPDATING, THE            @Y30LB34*/
*       /* VOLUME IS USABLE. SET THE CONDITION               @Y30LB34*/
*       /* CODE TO 8.                                        @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1239
*       ELSE                                                       1239
*         CC13=LASTCC08;            /*                       @Y30LB34*/
         B     @RC01237                                            1239
@RF01237 LA    CC13,8                                              1239
*     END;                          /*                       @Y30LB34*/
*                                                                  1240
@RC01237 DS    0H                                                  1241
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS OCCURRED IN THE UPDATE PROCESS,   @Y30LB34*/
*   /* PRINT MESSAGE IDC0747I.                               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1241
*   IF CC13<LASTCC08 THEN                                          1241
@RF01235 C     CC13,@CF00177                                       1241
         BNL   @RF01241                                            1241
*     DO;                           /*                       @Y30LB34*/
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1243
         MVC   DARGSMOD(3,@08),@CC01557                            1243
*       DARGSENT=MSG0747I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'0B'                                 1244
*       DARGDBP=0;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1245
         ST    @15,DARGDBP(,@08)                                   1245
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @15,DARGILP(,@08)                                   1246
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@08)                                  1247
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @08,@PC00001                                        1248
         ST    @08,@AL00001                                        1248
         LA    @15,@CF00115                                        1248
         ST    @15,@AL00001+4                                      1248
         LA    @15,DDSTRU                                          1248
         ST    @15,@AL00001+8                                      1248
         MVI   @AL00001+8,X'80'                                    1248
         L     @15,GDTPRT(,@08)                                    1248
         LA    @01,@AL00001                                        1248
         BALR  @14,@15                                             1248
*     END;                          /*                       @Y30LB34*/
*                                                                  1250
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1250
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RF01241 L     REG14,RTNREG3                                       1250
*   RETURN CODE(CC13);              /*                       @Y30LB34*/
         LR    @15,CC13                                            1251
@EL00014 DS    0H                                                  1251
@EF00014 DS    0H                                                  1251
@ER00014 BR    @14                                                 1251
*   END UPDVTOC;                    /*                       @Y30LB34*/
*                                                                  1253
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RVCLEAR                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - CLEARS THE RECOVERY FLAG FROM THE BASE VOLUME @Y30LB34*/
*/*            RECORD                                        @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES THE MVR PARAMETER LIST TO SET OFF @Y30LB34*/
*/*            THE INCOMPLETE-COPY-OPERATION FLAG            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES USSC TO ISSUE THE ICBVVIC MACRO WHICH  @Y30LB34*/
*/*            SETS OFF THE FLAG IN THE BASE VOLUME RECORD   @Y30LB34*/
*/*                IF USSC IS NOT SUCCESSFUL, CALLS SSCMSG   @Y30LB34*/
*/*                TO PRINT ANY MESSAGES ISSUED BY USSC,     @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3066I IF UNABLE   @Y30LB34*/
*/*                TO CLEAR FLAG FROM RECORD                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - MVR, TARGAREA, DARGLIST                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INITIALIZED MVR                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. = 12, UNABLE TO CLEAR INCOMPLETE-COPY    @Y30LB34*/
*/*                       FLAG                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1253
*RVCLEAR:                                                          1253
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1253
RVCLEAR  DS    0H                                                  1254
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1254
*   DCL                                                            1254
*     CC14 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1255
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1255
*   OLDERID2=NEWERID2;                                             1255
         L     @11,@PC00001                                        1255
         L     @08,GDTTR2(,@11)                                    1255
         MVC   @TS00001(95),NEWERID2(@08)                          1255
         MVC   OLDERID2(95,@08),@TS00001                           1255
*   NEWID2='CNTE';                  /*                       @Y30LB34*/
*                                                                  1256
         MVC   NEWID2(4,@08),@CC01773                              1256
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1257
*   CC14=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1257
         LR    CC14,@15                                            1257
*   RTNREG4=REG14;                  /*                       @Y30LB34*/
*                                                                  1258
         ST    REG14,RTNREG4                                       1258
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE MVR PARM LIST TO SET OFF THE           @Y30LB34*/
*   /* INCOMPLETE-COPY-OPERATION FLAG                        @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1259
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB34*/
         L     @08,MVRPTR                                          1259
         LH    @14,MVRLEN                                          1259
         ST    @14,MVRLNGTH(,@08)                                  1259
*   MVROPCD=MVROP;                  /*                       @Y30LB34*/
         MVI   MVROPCD(@08),X'85'                                  1260
*   MVRCICPY=ON;                    /*                       @ZM30738*/
         OI    MVRCICPY(@08),B'01000000'                           1261
*   MVRFLBAS=ON;                    /*                       @ZM30758*/
         OI    MVRFLBAS(@08),B'00100000'                           1262
*   MVRBVOL=TVOLSER;                /*                       @Y30LB34*/
*                                                                  1263
         MVC   MVRBVOL(6,@08),TVOLSER                              1263
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO ISSUE THE ICBVVIC MACRO TO CLEAR THE    @Y30LB34*/
*   /* FLAG                                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1264
*   USSCREG0=0;                     /*                       @Y30LB34*/
         ST    @15,USSCREG0                                        1264
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,USSCREG0);/*            @Y30LB34*/
         ST    @11,@AL00001                                        1265
         LA    @08,VVIC                                            1265
         ST    @08,@AL00001+4                                      1265
         LA    @08,MVRPTR                                          1265
         ST    @08,@AL00001+8                                      1265
         LA    @08,USSCREG0                                        1265
         ST    @08,@AL00001+12                                     1265
         MVI   @AL00001+12,X'80'                                   1265
         L     @15,GDTSSC(,@11)                                    1265
         LA    @01,@AL00001                                        1265
         BALR  @14,@15                                             1265
*   RESPECIFY                                                      1266
*     RTNREG RSTD;                                                 1266
*   TESTRC=RTNREG;                                                 1267
         STH   RTNREG,TESTRC                                       1267
*   RESPECIFY                                                      1268
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1269
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USSC WAS NOT SUCCESSFUL, CALL SSCMSG TO PRINT      @Y30LB34*/
*   /* THE MESSAGE FROM USSC, PRINT ERROR MESSAGE IDC3066I   @Y30LB34*/
*   /* AND SET CONDITION CODE TO 12                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1269
*   IF TESTRC>0 THEN                                               1269
         LH    @11,TESTRC                                          1269
         LTR   @11,@11                                             1269
         BNP   @RF01269                                            1269
*     DO;                           /*                       @Y30LB34*/
*       CALL SSCMSG(USSCREG0);      /*                       @Y30LB34*/
         LA    @11,USSCREG0                                        1271
         ST    @11,@AL00001                                        1271
         LA    @01,@AL00001                                        1271
         BAL   @14,SSCMSG                                          1271
*       DARGSMOD=COMMSG;            /*                       @Y30LB34*/
         L     @11,DDSTRU                                          1272
         MVC   DARGSMOD(3,@11),@CC01555                            1272
*       DARGSENT=MSG3066I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@11),X'2C'                                 1273
*       DARGDBP=0;                  /*                       @Y30LB34*/
         SLR   @08,@08                                             1274
         ST    @08,DARGDBP(,@11)                                   1274
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @08,DARGILP(,@11)                                   1275
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @08,DARGRETP(,@11)                                  1276
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @11,@PC00001                                        1277
         ST    @11,@AL00001                                        1277
         LA    @08,@CF00115                                        1277
         ST    @08,@AL00001+4                                      1277
         LA    @08,DDSTRU                                          1277
         ST    @08,@AL00001+8                                      1277
         MVI   @AL00001+8,X'80'                                    1277
         L     @15,GDTPRT(,@11)                                    1277
         LA    @01,@AL00001                                        1277
         BALR  @14,@15                                             1277
*       CC14=LASTCC12;              /*                       @Y30LB34*/
         LA    CC14,12                                             1278
*     END;                          /*                       @Y30LB34*/
*                                                                  1279
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1280
*   REG14=RTNREG4;                  /*                       @Y30LB34*/
@RF01269 L     REG14,RTNREG4                                       1280
*   RETURN CODE(CC14);              /*                       @Y30LB34*/
         LR    @15,CC14                                            1281
@EL00015 DS    0H                                                  1281
@EF00015 DS    0H                                                  1281
@ER00015 BR    @14                                                 1281
*   END RVCLEAR;                    /*                       @Y30LB34*/
*                                                                  1283
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RECATCTL                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - CONTROLS RECATALOGING TO BE DONE              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DETERMINES WHAT RECATALOGING IS TO BE DONE.   @Y30LB34*/
*/*            SETS FLAG TO ALLOW VSAM AND/OR NON-VSAM       @Y30LB34*/
*/*            RECATALOGING.                                 @Y30LB34*/
*/*                PRINTS WARNING MESSAGE IDC1742I IF THE    @Y30LB34*/
*/*                VSAM CATALOG OPTION WAS REQUESTED FOR A   @Y30LB34*/
*/*                NON-VSAM VOLUME                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RCATVSAM, IF THE VOLUME IS VSAM, TO     @Y30LB34*/
*/*            RECATALOG THE DATA SETS IN THE VSAM CATALOG   @Y30LB34*/
*/*            OWNING THE VOLUME                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, FRVS1AGL, DARGLIST          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETRUN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM RCATVSAM          @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM RCATVSAM          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1283
*RECATCTL:                                                         1283
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1283
RECATCTL DS    0H                                                  1284
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1284
*   DCL                                                            1284
*     CC15 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1285
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1285
*   OLDERID2=NEWERID2;                                             1285
         L     @15,@PC00001                                        1285
         L     @15,GDTTR2(,@15)                                    1285
         MVC   @TS00001(95),NEWERID2(@15)                          1285
         MVC   OLDERID2(95,@15),@TS00001                           1285
*   NEWID2='CNTF';                  /*                       @Y30LB34*/
*                                                                  1286
         MVC   NEWID2(4,@15),@CC01778                              1286
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1287
*   CC15=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1287
         STH   @15,CC15                                            1287
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  1288
         ST    REG14,RTNREG3                                       1288
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO FRVS1AGL                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1289
*   RESPECIFY                                                      1289
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/
*                                                                  1289
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR THE 'VSAMCATALOG' PARAMETER                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1290
*   IF ADDR(VCAT)^=NULLPTR THEN                                    1290
         L     @14,@PC00001+4                                      1290
         C     @15,FDTPTR+24(,@14)                                 1290
         BE    @RF01290                                            1290
*     DO;                           /*                       @Y30LB34*/
*                                                                  1291
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO MAKE SURE VOLUME IS VSAM, AND IF SO,     @Y30LB34*/
*       /* SET VSAM FLAG                                     @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1292
*       IF VSVSAM=ON THEN                                          1292
         LA    @15,FRVS1AGL                                        1292
         TM    VSVSAM(@15),B'10000000'                             1292
         BNO   @RF01292                                            1292
*         VSAM=ON;                  /*                       @Y30LB34*/
         OI    VSAM,B'00100000'                                    1293
*                                                                  1294
*       /*************************************************************/
*       /*                                                           */
*       /* IF NOT, PRINT WARNING MESSAGE IDC1742I, SET       @Y30LB34*/
*       /* CONDITION CODE TO 4, AND DON'T SET VSAM FLAG      @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1294
*       ELSE                                                       1294
*         DO;                       /*                       @Y30LB34*/
         B     @RC01292                                            1294
@RF01292 DS    0H                                                  1295
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @15,DDSTRU                                          1295
         MVC   DARGSMOD(3,@15),@CC01557                            1295
*           DARGSENT=MSG1742I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'06'                                 1296
*           DARGDBP=0;              /*                       @Y30LB34*/
         SLR   @14,@14                                             1297
         ST    @14,DARGDBP(,@15)                                   1297
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @14,DARGILP(,@15)                                   1298
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @14,DARGRETP(,@15)                                  1299
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @15,@PC00001                                        1300
         ST    @15,@AL00001                                        1300
         LA    @14,@CF00115                                        1300
         ST    @14,@AL00001+4                                      1300
         LA    @14,DDSTRU                                          1300
         ST    @14,@AL00001+8                                      1300
         MVI   @AL00001+8,X'80'                                    1300
         L     @15,GDTPRT(,@15)                                    1300
         LA    @01,@AL00001                                        1300
         BALR  @14,@15                                             1300
*           CC15=LASTCC04;          /*                       @Y30LB34*/
         MVC   CC15(2),@CH00036                                    1301
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  1303
@RC01292 DS    0H                                                  1304
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR THE 'ALL' PARAMETER                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1304
*   IF ADDR(ALLC)^=NULLPTR THEN                                    1304
@RF01290 L     @15,@PC00001+4                                      1304
         L     @15,FDTPTR+20(,@15)                                 1304
         LTR   @15,@15                                             1304
         BZ    @RF01304                                            1304
*     DO;                           /*                       @Y30LB34*/
*                                                                  1305
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS VSAM SET THE VSAM FLAG. SET      @Y30LB34*/
*       /* THE NONVSAM FLAG.                                 @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1306
*       IF VSVSAM=ON THEN                                          1306
         LA    @15,FRVS1AGL                                        1306
         TM    VSVSAM(@15),B'10000000'                             1306
         BNO   @RF01306                                            1306
*         VSAM=ON;                  /*                       @Y30LB34*/
         OI    VSAM,B'00100000'                                    1307
*       NONVSAM=ON;                 /*                       @Y30LB34*/
@RF01306 OI    NONVSAM,B'00010000'                                 1308
*     END;                          /*                       @Y30LB34*/
*                                                                  1309
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO PARM WAS SPECIFIED AND THE VOLUME IS VSAM,      @Y30LB34*/
*   /* APPLY THE DEFAULT OF RECATALOGING THE VSAM DATA       @Y30LB34*/
*   /* SETS                                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1310
*   ELSE                                                           1310
*     IF VSVSAM=ON&VSAM=OFF THEN                                   1310
         B     @RC01304                                            1310
@RF01304 LA    @15,FRVS1AGL                                        1310
         TM    VSVSAM(@15),B'10000000'                             1310
         BNO   @RF01310                                            1310
         TM    VSAM,B'00100000'                                    1310
         BNZ   @RF01310                                            1310
*       VSAM=ON;                    /*                       @Y30LB34*/
         OI    VSAM,B'00100000'                                    1311
*                                                                  1312
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE 'NONE' PARM OR NO PARM WAS SPECIFIED AND THE   @Y30LB34*/
*   /* VOLUME IS NOT VSAM THEN NO FLAGS WILL BE SET TO       @Y30LB34*/
*   /* PREVENT ANY RECATALOGING TO BE DONE                   @Y30LB34*/
*   /*                                                       @Y30LB34*/
*   /*                                                       @Y30LB34*/
*   /* IF THE VSAM FLAG IS ON CALL RCATVSAM TO PERFORM       @Y30LB34*/
*   /* VSAM RECATALOGING                                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1312
*   IF VSAM=ON THEN                                                1312
@RF01310 DS    0H                                                  1312
@RC01304 TM    VSAM,B'00100000'                                    1312
         BNO   @RF01312                                            1312
*     DO;                           /*                       @Y30LB34*/
*       CALL RCATVSAM;              /*                       @Y30LB34*/
         BAL   @14,RCATVSAM                                        1314
*       RESPECIFY                                                  1315
*         RTNREG RSTD;                                             1315
*       TESTRC=RTNREG;                                             1316
         STH   RTNREG,TESTRC                                       1316
*       RESPECIFY                                                  1317
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC15=MAX(CC15,TESTRC);      /*                       @Y30LB34*/
         LH    @15,TESTRC                                          1318
         LH    @14,CC15                                            1318
         CR    @14,@15                                             1318
         BNL   *+6
         LR    @14,@15                                             1318
         STH   @14,CC15                                            1318
*     END;                          /*                       @Y30LB34*/
*                                                                  1319
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1320
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RF01312 L     REG14,RTNREG3                                       1320
*   RETURN CODE(CC15);              /*                       @Y30LB34*/
         LH    @15,CC15                                            1321
@EL00016 DS    0H                                                  1321
@EF00016 DS    0H                                                  1321
@ER00016 BR    @14                                                 1321
*   END RECATCTL;                   /*                       @Y30LB34*/
*                                                                  1323
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RCATVSAM                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - RECATALOGS DATA SETS IN THE VSAM CATALOG      @Y30LB34*/
*/*            OWNING THE VOLUME                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF THE USER CATALOG IS ON THE CONVERTED       @Y30LB34*/
*/*            VOLUME, OPENS THAT CATALOG WITH A MODIFIED    @Y30LB34*/
*/*            JFCB                                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF A CATALOG DD NAME WAS SUPPLIED IN A        @Y30LB34*/
*/*            CONTROL STATEMENT AND THE USER CATALOG IS     @Y30LB34*/
*/*            NOT ON THE VOLUME, OPENS THE CATALOG          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS ERROR MESSAGE IDC3010I IF THE CATALOG  @ZM34301*/
*/*            CANNOT BE OPENED                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES THE CATALOG PARAMETER LIST AND    @Y30LB34*/
*/*            AND THE FIELD PARAMETER LISTS FOR UCATLG      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES UCATLG TO RECATALOG ALL DATA SETS IN   @Y30LB34*/
*/*            THE VSAM CATALOG                              @Y30LB34*/
*/*                PRINTS MESSAGE IDC0746I IF THE DATA SETS  @Y30LB34*/
*/*                ARE RECATALOGED,                          @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3009I IF UCATLG   @Y30LB34*/
*/*                WAS UNSUCCESSFUL AND RETURNED A REASON    @Y30LB34*/
*/*                CODE IN THE CATALOG PARM LIST,            @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3007I IF UCATLG   @Y30LB34*/
*/*                WAS UNSUCCESSFUL AND NO REASON CODE WAS   @Y30LB34*/
*/*                RETURNED                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CLOSES THE CATALOG IF CONVERTV OPENED IT      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, TARGAREA, FRVS1AGL, OPNAGL  @Y30LB34*/
*/*          CTGPL, CTGFL, DARGLIST                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INITIALIZED OPNAGL, CTGPL AND CTGFLS            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, UNABLE TO CLOSE CATALOG            @Y30LB34*/
*/*           R. C. = 12, UNABLE TO OPEN CATALOG,            @Y30LB34*/
*/*                       UNABLE TO RECATALOG VSAM DATA SETS @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1323
*RCATVSAM:                                                         1323
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1323
RCATVSAM DS    0H                                                  1324
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1324
*   DCL                                                            1324
*     CC16 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*   DCL                                                            1325
*     DEVLNGTH FIXED(31) CONSTANT(4);/* DEVICE LENGTH        @Y30LB34*/
*   DCL                                                            1326
*     VOLLNGTH FIXED(31) CONSTANT(6);/* VOLSER LENGTH        @Y30LB34*/
*   DCL                                                            1327
*     UPDATE BIT(8) CONSTANT('00'X);/* CTGFL CODE            @Y30LB34*/
*   DCL                                                            1328
*     EQUAL BIT(8) CONSTANT('80'X); /* CTGFL CODE            @Y30LB34*/
*                                                                  1328
*   /*****************************************************************/
*   /*                                                               */
*   /* POINTERS AND AREAS FOR UCATLG                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1329
*   DCL                                                            1329
*     CTGPLPTR PTR(31);             /* POINTER TO CTGPL      @Y30LB34*/
*   DCL                                                            1330
*     CTGFLPTR PTR(31);             /* POINTER TO CTGFL      @Y30LB34*/
*   DCL                                                            1331
*     CTGPLAR CHAR(LENGTH(CTGPL)+LENGTH(CTGFIELD)) BDY(WORD);/* AREA
*                                      FOR CTGPL             @Y30LB34*/
*   DCL                                                            1332
*     CTGFLAR1 CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT)) BDY(WORD);/* AREA
*                                      FOR FIRST CTGFL       @Y30LB34*/
*   DCL                                                            1333
*     CTGFLAR2 CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT)) BDY(WORD);/* AREA
*                                      FOR SECOND CTGFL      @Y30LB34*/
*   DCL                                                            1334
*     CTGFLAR3 CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT)) BDY(WORD);/* AREA
*                                      FOR THIRD CTGFL       @Y30LB34*/
*                                                                  1335
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1335
*   OLDERID2=NEWERID2;                                             1335
         L     @08,@PC00001                                        1335
         L     @08,GDTTR2(,@08)                                    1335
         MVC   @TS00001(95),NEWERID2(@08)                          1335
         MVC   OLDERID2(95,@08),@TS00001                           1335
*   NEWID2='CNTG';                  /*                       @Y30LB34*/
*                                                                  1336
         MVC   NEWID2(4,@08),@CC01794                              1336
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1337
*   CC16=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @08,@08                                             1337
         STH   @08,CC16                                            1337
*   RTNREG4=REG14;                  /*                       @Y30LB34*/
*                                                                  1338
         ST    REG14,RTNREG4                                       1338
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO CATALOG DATA AREAS        @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1339
*   CTGPLPTR=ADDR(CTGPLAR);         /*                       @Y30LB34*/
         LA    @15,CTGPLAR                                         1339
         ST    @15,CTGPLPTR                                        1339
*   CTGFLPTR=ADDR(CTGFLAR1);        /*                       @Y30LB34*/
*                                                                  1340
         LA    CTGFLPTR,CTGFLAR1                                   1340
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DATA AREAS TO ZERO                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1341
*   CTGPLAR=''B;                    /*                       @Y30LB34*/
         XC    CTGPLAR(32),CTGPLAR                                 1341
*   CTGFLAR1=''B;                   /*                       @Y30LB34*/
         XC    CTGFLAR1(24),CTGFLAR1                               1342
*   CTGFLAR2=''B;                   /*                       @Y30LB34*/
         XC    CTGFLAR2(24),CTGFLAR2                               1343
*   CTGFLAR3=''B;                   /*                       @Y30LB34*/
         XC    CTGFLAR3(24),CTGFLAR3                               1344
*   IOCSPTR=NULLPTR;                /*                       @Y30LB34*/
*                                                                  1345
         ST    @08,IOCSPTR                                         1345
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE VOLSER COUNT TO 1                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1346
*   TCOUNT=ONE;                     /*                       @Y30LB34*/
         MVI   TCOUNT,X'01'                                        1346
*                                                                  1347
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VSAM USER CATALOG IS ON THE CONVERTED VOLUME   @Y30LB34*/
*   /* OPNAGL IS INITIALIZED TO OPEN THE CATALOG WITH A      @Y30LB34*/
*   /* MODIFIED JFCB. THE DD STATEMENT OF THE TARGET         @Y30LB34*/
*   /* VOLUME IS USED SINCE THE USER CATALOG IS NOW ON       @Y30LB34*/
*   /* THAT UNIT. THE CATALOG NAME AND VOLUME SERIAL         @Y30LB34*/
*   /* NUMBER ARE SPECIFIED VIA THE OPEN.                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1347
*   RESPECIFY                                                      1347
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/
*   IF VSUCAT=ON THEN                                              1348
         LA    @15,FRVS1AGL                                        1348
         TM    VSUCAT(@15),B'01000000'                             1348
         BNO   @RF01348                                            1348
*     DO;                           /*                       @Y30LB34*/
*       OPNTYPCI=ON;                /*                       @Y30LB34*/
         OI    OPNTYPCI(OPNPTR),B'00100000'                        1350
*       OPNOPTJM=ON;                /*                       @Y30LB34*/
         OI    OPNOPTJM(OPNPTR),B'00100000'                        1351
*       OPNIOC=ADDR(IOCSPTR);       /*                       @Y30LB34*/
         LA    @15,IOCSPTR                                         1352
         ST    @15,OPNIOC(,OPNPTR)                                 1352
*       OPNOPTUP=ON;                /*                       @Y30LB34*/
         OI    OPNOPTUP(OPNPTR),B'00100000'                        1353
*       OPNDDN=ADDR(TFILEVAL);      /*                       @ZM30744*/
         L     @15,@PC00001+4                                      1354
         L     @01,FDTPTR+4(,@15)                                  1354
         LA    @14,TFILEVAL(,@01)                                  1354
         ST    @14,OPNDDN(,OPNPTR)                                 1354
*       OPNDSN=ADDR(CATNVAL);       /*                       @Y30LB34*/
         L     @15,FDTPTR+44(,@15)                                 1355
         LA    @14,CATNVAL(,@15)                                   1355
         ST    @14,OPNDSN(,OPNPTR)                                 1355
*       OPNVOL=ADDR(TVOLCNT);       /*                       @Y30LB34*/
         LA    @14,TVOLCNT                                         1356
         ST    @14,OPNVOL(,OPNPTR)                                 1356
*       OPNMODRC=ON;                /*                       @Y30LB34*/
         OI    OPNMODRC(OPNPTR),B'00100000'                        1357
*       OPNDSOAM=ON;                /*                       @ZM30985*/
         OI    OPNDSOAM(OPNPTR),B'10000000'                        1358
*       IF ADDR(CATN)^=NULLPTR THEN                                1359
         CR    @15,@08                                             1359
         BE    @RF01359                                            1359
*         OPNPWA=ADDR(CATNPAS);     /*                       @Y30LB34*/
         LA    @08,CATNPAS(,@15)                                   1360
         ST    @08,OPNPWA(,OPNPTR)                                 1360
*     END;                          /*                       @Y30LB34*/
*                                                                  1361
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VSAM USER CATALOG IS NOT ON THE CONVERTED      @Y30LB34*/
*   /* VOLUME BUT A DD NAME WAS SUPPLIED,                    @Y30LB34*/
*   /* INITIALIZE OPNAGL TO OPEN THE                         @Y30LB34*/
*   /* CATALOG WITH A REGULAR OPEN.                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1362
*   ELSE                                                           1362
*     IF ADDR(CATDD)^=NULLPTR THEN                                 1362
         B     @RC01348                                            1362
@RF01348 SLR   @08,@08                                             1362
         L     @15,@PC00001+4                                      1362
         C     @08,FDTPTR+48(,@15)                                 1362
         BE    @RF01362                                            1362
*       DO;                         /*                       @Y30LB34*/
*         OPNOPTUP=ON;              /*                       @Y30LB34*/
         OI    OPNOPTUP(OPNPTR),B'00100000'                        1364
*         OPNTYPCI=ON;              /*                       @Y30LB34*/
         OI    OPNTYPCI(OPNPTR),B'00100000'                        1365
*         OPNIOC=ADDR(IOCSPTR);     /*                       @Y30LB34*/
         LA    @14,IOCSPTR                                         1366
         ST    @14,OPNIOC(,OPNPTR)                                 1366
*         OPNDDN=ADDR(SCATDD);      /*                       @Y30LB34*/
         LA    @14,SCATDD                                          1367
         ST    @14,OPNDDN(,OPNPTR)                                 1367
*         OPNMODRC=ON;              /*                       @Y30LB34*/
         OI    OPNMODRC(OPNPTR),B'00100000'                        1368
*         IF ADDR(CATN)^=NULLPTR THEN                              1369
         L     @15,FDTPTR+44(,@15)                                 1369
         CR    @15,@08                                             1369
         BE    @RF01369                                            1369
*           OPNPWA=ADDR(CATNPAS);   /*                       @Y30LB34*/
         LA    @08,CATNPAS(,@15)                                   1370
         ST    @08,OPNPWA(,OPNPTR)                                 1370
*       END;                        /*                       @Y30LB34*/
@RF01369 DS    0H                                                  1372
*                                                                  1372
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPNAGL WAS INITIALIZED THEN OPEN THE CATALOG       @Y30LB34*/
*   /* AND SET THE FLAG SAYING CONVERTV DID THE OPEN         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1372
*   IF OPNTYPCI=ON THEN                                            1372
@RF01362 DS    0H                                                  1372
@RC01348 TM    OPNTYPCI(OPNPTR),B'00100000'                        1372
         BNO   @RF01372                                            1372
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Y30LB34*/
         L     @08,@PC00001                                        1374
         ST    @08,@AL00001                                        1374
         ST    OPNPTR,@AL00001+4                                   1374
         MVI   @AL00001+4,X'80'                                    1374
         L     @15,GDTOPN(,@08)                                    1374
         LA    @01,@AL00001                                        1374
         BALR  @14,@15                                             1374
*       RESPECIFY                                                  1375
*         RTNREG RSTD;                                             1375
*       TESTRC=RTNREG;                                             1376
         STH   RTNREG,TESTRC                                       1376
*       RESPECIFY                                                  1377
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  1377
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE FROM OPEN IS NOT ZERO,         @Y30LB34*/
*       /* DETERMINE IF OPEN WAS PARTIALLY SUCCESSFUL AND    @Y30LB34*/
*       /* CONTINUATION IS POSSIBLE                          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1378
*       IF TESTRC>0 THEN                                           1378
         LH    @08,TESTRC                                          1378
         LTR   @08,@08                                             1378
         BNP   @RF01378                                            1378
*         DO;                       /*                       @Y30LB34*/
*                                                                  1379
*           /*********************************************************/
*           /*                                                       */
*           /* CATALOG WAS OPENED, SET CONDITION CODE TO 4   @Y30LB34*/
*           /* AND CONTINUE                                  @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1380
*           IF IOCMSGOP=ON THEN                                    1380
         L     @08,IOCSPTR                                         1380
         TM    IOCMSGOP(@08),B'00100000'                           1380
         BNO   @RF01380                                            1380
*             CC16=LASTCC04;        /*                       @Y30LB34*/
*                                                                  1381
         MVC   CC16(2),@CH00036                                    1381
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE CATALOG WAS NOT OPENED SET CONDITION   @Y30LB34*/
*           /* CODE TO 12 AND PRINT MSG: UNABLE TO OPEN      @ZM34301*/
*           /* (CATALOG NAME)                                @ZM34301*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1382
*           ELSE                    /*                       @ZM34301*/
*             DO;                   /*                       @ZM34301*/
         B     @RC01380                                            1382
@RF01380 DS    0H                                                  1383
*               DARGSMOD=UNIVMSG;   /*                       @ZM34301*/
         L     @08,DDSTRU                                          1383
         MVC   DARGSMOD(3,@08),@CC01553                            1383
*               DARGSENT=MSG3010I;  /*                       @ZM34301*/
         MVI   DARGSENT(@08),X'0B'                                 1384
*               DARGDBP=ADDR(CATNVAL);/*                     @ZM34301*/
         L     @15,@PC00001+4                                      1385
         L     @01,FDTPTR+44(,@15)                                 1385
         LA    @15,CATNVAL(,@01)                                   1385
         ST    @15,DARGDBP(,@08)                                   1385
*               DARGILP=LENGTH(CATNVAL);/*                   @ZM34301*/
         MVC   DARGILP(2,@08),@CH00608                             1386
*               DARGRETP=0;         /*                       @ZM34301*/
         SLR   @15,@15                                             1387
         ST    @15,DARGRETP(,@08)                                  1387
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @ZM34301*/
         L     @08,@PC00001                                        1388
         ST    @08,@AL00001                                        1388
         LA    @15,@CF00115                                        1388
         ST    @15,@AL00001+4                                      1388
         LA    @15,DDSTRU                                          1388
         ST    @15,@AL00001+8                                      1388
         MVI   @AL00001+8,X'80'                                    1388
         L     @15,GDTPRT(,@08)                                    1388
         LA    @01,@AL00001                                        1388
         BALR  @14,@15                                             1388
*               CC16=LASTCC12;      /*                       @ZM34301*/
         MVC   CC16(2),@CH00567                                    1389
*             END;                  /*                       @ZM34301*/
*         END;                      /*                       @ZM34301*/
@RC01380 DS    0H                                                  1392
*     END;                          /*                       @Y30LB34*/
@RF01378 DS    0H                                                  1393
*                                                                  1393
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS OCCURRED IN OPENING THE CATALOG   @Y30LB34*/
*   /* OR CONVERTV DID NOT OPEN THE CATALOG, CONTINUE WITH   @Y30LB34*/
*   /* RECATALOGING THE VSAM DATA SETS                       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1393
*   IF CC16<LASTCC12 THEN                                          1393
@RF01372 LH    @08,CC16                                            1393
         C     @08,@CF00567                                        1393
         BNL   @RF01393                                            1393
*     DO;                           /*                       @Y30LB34*/
*                                                                  1394
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE CATALOG PARAMETER LIST AND A       @Y30LB34*/
*       /* CHAIN OF THREE FIELD PARAMETER LISTS              @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1395
*       CTGNAME=ON;                 /*                       @Y30LB34*/
         L     @08,CTGPLPTR                                        1395
         OI    CTGNAME(@08),B'00000100'                            1395
*       CTGFUNC=CTGCMS;             /*                       @Y30LB34*/
         NI    CTGFUNC(@08),B'10011111'                            1396
         OI    CTGFUNC(@08),B'10000000'                            1396
*       CTGAM0=ON;                  /*                       @Y30LB34*/
         OI    CTGAM0(@08),B'00000001'                             1397
*       CTGENT=ADDR(CNVOLAR);       /*                       @ZM00735*/
         LA    @15,CNVOLAR                                         1398
         ST    @15,CTGENT(,@08)                                    1398
*       CNVOLAR=''B;                /* CLEAR AREA            @ZM00735*/
         XC    CNVOLAR(44),CNVOLAR                                 1399
*       CNVOLAR(1:6)=TVOLSER;       /* AND INSERT VOLSER     @ZM00735*/
         MVC   CNVOLAR(6),TVOLSER                                  1400
*       CTGDDNM=ADDR(TFILEVAL);     /*                       @ZM31016*/
         L     @15,@PC00001+4                                      1401
         L     @01,FDTPTR+4(,@15)                                  1401
         LA    @15,TFILEVAL(,@01)                                  1401
         ST    @15,CTGDDNM(,@08)                                   1401
*       IF IOCSPTR^=NULLPTR THEN    /*                       @ZM31016*/
         L     @15,IOCSPTR                                         1402
         LTR   @15,@15                                             1402
         BZ    @RF01402                                            1402
*         CTGCAT=ADDR(IOCCBP);      /*                       @ZM00734*/
         LA    @15,IOCCBP(,@15)                                    1403
         ST    @15,CTGCAT(,@08)                                    1403
*       ELSE                                                       1404
*         IF ADDR(CATN)^=NULLPTR THEN                              1404
         B     @RC01402                                            1404
@RF01402 L     @08,@PC00001+4                                      1404
         L     @08,FDTPTR+44(,@08)                                 1404
         LTR   @08,@08                                             1404
         BZ    @RF01404                                            1404
*           DO;                     /*                       @Y30LB34*/
*             CTGCNAME=ON;          /*                       @Y30LB34*/
         L     @15,CTGPLPTR                                        1406
         OI    CTGCNAME(@15),B'00000010'                           1406
*             CTGCAT=ADDR(CATNVAL); /*                       @ZM00735*/
         LA    @08,CATNVAL(,@08)                                   1407
         ST    @08,CTGCAT(,@15)                                    1407
*           END;                    /*                       @Y30LB34*/
*       CTGOPTNS=CTGCNVTV;          /*                       @Y30LB34*/
@RF01404 DS    0H                                                  1409
@RC01402 L     @08,CTGPLPTR                                        1409
         NI    CTGOPTNS(@08),B'00110111'                           1409
         OI    CTGOPTNS(@08),B'00110000'                           1409
*       CTGNOFLD=1;                 /*                       @ZM30990*/
         MVI   CTGNOFLD(@08),X'01'                                 1410
*       CTGFIELD(1)=ADDR(CTGFLAR1); /*                       @Y30LB34*/
*                                                                  1411
         LA    @15,CTGFLAR1                                        1411
         ST    @15,CTGFIELD(,@08)                                  1411
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE FIRST FPL TO UPDATE THE DEVICE TYPE    @Y30LB34*/
*       /* IN CATALOG                                        @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1412
*       CTGFLDNO=1;                 /*                       @XM30990*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1412
*       CTGFLDCD=UPDATE;            /*                       @Y30LB34*/
         MVI   CTGFLDCD(CTGFLPTR),X'00'                            1413
*       CTGFLCHN=ADDR(CTGFLAR2);    /*                       @Y30LB34*/
         LA    @08,CTGFLAR2                                        1414
         ST    @08,CTGFLCHN(,CTGFLPTR)                             1414
*       CTGFLNG(1)=DEVLNGTH;        /*                       @Y30LB34*/
         LA    @15,4                                               1415
         ST    @15,CTGFLNG(,CTGFLPTR)                              1415
*       CTGFLPT(1)=ADDR(TDEVTYPE);  /*                       @Y30LB34*/
         LA    @14,TDEVTYPE                                        1416
         ST    @14,CTGFLPT(,CTGFLPTR)                              1416
*       CTGFLDNM=ADDR(CNDEVTYP);    /*                       @ZM00735*/
         LA    @14,CNDEVTYP                                        1417
         ST    @14,CTGFLDNM(,CTGFLPTR)                             1417
*       CTGFLPTR=ADDR(CTGFLAR2);    /*                       @Y30LB34*/
         LR    CTGFLPTR,@08                                        1418
*                                                                  1419
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE SECOND FPL TO VERIFY THAT THE          @Y30LB34*/
*       /* VOLSER IN CATALOG ENTRY MATCHES ORIGINAL          @Y30LB34*/
*       /* TARGET VOLSER BEFORE UPDATING THE DEVICE TYPE     @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1419
*       CTGFLDNO=1;                 /*                       @XM30990*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1419
*       CTGFLDCD=EQUAL;             /*                       @Y30LB34*/
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            1420
*       CTGFLCHN=ADDR(CTGFLAR3);    /*                       @Y30LB34*/
         LA    @08,CTGFLAR3                                        1421
         ST    @08,CTGFLCHN(,CTGFLPTR)                             1421
*       CTGFLNG(1)=VOLLNGTH;        /*                       @Y30LB34*/
         MVC   CTGFLNG(4,CTGFLPTR),@CF00038                        1422
*       CTGFLPT(1)=ADDR(TVOLSER);   /*                       @Y30LB34*/
         LA    @01,TVOLSER                                         1423
         ST    @01,CTGFLPT(,CTGFLPTR)                              1423
*       CTGFLDNM=ADDR(CNVOLSER);    /*                       @ZM00735*/
         LA    @01,CNVOLSER                                        1424
         ST    @01,CTGFLDNM(,CTGFLPTR)                             1424
*       CTGFLPTR=ADDR(CTGFLAR3);    /*                       @Y30LB34*/
*                                                                  1425
         LR    CTGFLPTR,@08                                        1425
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THIRD FPL TO VERIFY THAT THE DEVICE    @Y30LB34*/
*       /* TYPE IN CATALOG ENTRY MATCHES ORIGINAL TARGET     @Y30LB34*/
*       /* DEVICE TYPE BEFORE UPDATING IT                    @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1426
*       CTGFLDNO=1;                 /*                       @XM30990*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1426
*       CTGFLDCD=EQUAL;             /*                       @Y30LB34*/
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            1427
*       CTGFLCHN=NULLPTR;           /*                       @Y30LB34*/
         SLR   @08,@08                                             1428
         ST    @08,CTGFLCHN(,CTGFLPTR)                             1428
*       CTGFLNG(1)=DEVLNGTH;        /*                       @Y30LB34*/
         ST    @15,CTGFLNG(,CTGFLPTR)                              1429
*       CTGFLPT(1)=ADDR(SDEVTYPE);  /*                       @Y30LB34*/
         LA    @08,SDEVTYPE                                        1430
         ST    @08,CTGFLPT(,CTGFLPTR)                              1430
*       CTGFLDNM=ADDR(CNDEVTYP);    /*                       @ZM00735*/
         ST    @14,CTGFLDNM(,CTGFLPTR)                             1431
*                                                                  1432
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UCATLG TO CONVERT THE VSAM CATALOG ENTRIES  @Y30LB34*/
*       /* REFLECT THEIR CURRENT VOLSER AND DEVICE TYPE      @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1432
*       CALL IDCSACA0(GDTTBL,CTGPLPTR);/*                    @Y30LB34*/
         L     @15,@PC00001                                        1432
         ST    @15,@AL00001                                        1432
         LA    @14,CTGPLPTR                                        1432
         ST    @14,@AL00001+4                                      1432
         L     @15,GDTCAT(,@15)                                    1432
         LA    @01,@AL00001                                        1432
         BALR  @14,@15                                             1432
*       RESPECIFY                                                  1433
*         RTNREG RSTD;                                             1433
*       TESTRC=RTNREG;                                             1434
         STH   RTNREG,TESTRC                                       1434
*       RESPECIFY                                                  1435
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  1435
*       /*************************************************************/
*       /*                                                           */
*       /* IF CATALOG WAS SUCCESSFUL PRINT MESSAGE           @Y30LB34*/
*       /* IDC0746I NOTIFYING THE VSAM RECATALOGING IS       @Y30LB34*/
*       /* COMPLETE                                          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1436
*       IF TESTRC=0 THEN                                           1436
         LH    @15,TESTRC                                          1436
         SLR   @14,@14                                             1436
         CR    @15,@14                                             1436
         BNE   @RF01436                                            1436
*         DO;                       /*                       @Y30LB34*/
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @15,DDSTRU                                          1438
         MVC   DARGSMOD(3,@15),@CC01557                            1438
*           DARGSENT=MSG0746I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'0A'                                 1439
*           DARGDBP=0;              /*                       @Y30LB34*/
         ST    @14,DARGDBP(,@15)                                   1440
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @14,DARGILP(,@15)                                   1441
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @14,DARGRETP(,@15)                                  1442
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @15,@PC00001                                        1443
         ST    @15,@AL00001                                        1443
         LA    @14,@CF00115                                        1443
         ST    @14,@AL00001+4                                      1443
         LA    @14,DDSTRU                                          1443
         ST    @14,@AL00001+8                                      1443
         MVI   @AL00001+8,X'80'                                    1443
         L     @15,GDTPRT(,@15)                                    1443
         LA    @01,@AL00001                                        1443
         BALR  @14,@15                                             1443
*         END;                      /*                       @Y30LB34*/
*                                                                  1445
*       /*************************************************************/
*       /*                                                           */
*       /* IF CATALOG WAS NOT SUCCESSFUL DETERMINE WHAT      @Y30LB34*/
*       /* INFORMATION WAS RETURNED AND PRINT APPROPRIATE    @Y30LB34*/
*       /* MESSAGE                                           @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1445
*       ELSE                                                       1445
*         DO;                       /*                       @Y30LB34*/
         B     @RC01436                                            1445
@RF01436 DS    0H                                                  1446
*           CC16=LASTCC12;          /*                       @Y30LB34*/
*                                                                  1446
         MVC   CC16(2),@CH00567                                    1446
*           /*********************************************************/
*           /*                                                       */
*           /* IF CMS RETURNED INFORMATION IN FEEDBACK       @Y30LB34*/
*           /* AREA PRINT MESSAGE IDC3009I                   @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1447
*           IF CTGFDBK^=NULLPTR THEN                               1447
         L     @15,CTGPLPTR                                        1447
         LH    @14,CTGFDBK(,@15)                                   1447
         N     @14,@CF01899                                        1447
         LTR   @14,@14                                             1447
         BZ    @RF01447                                            1447
*             DO;                   /*                       @Y30LB34*/
*               DARGSMOD=UNIVMSG;   /*                       @Y30LB34*/
         L     @14,DDSTRU                                          1449
         MVC   DARGSMOD(3,@14),@CC01553                            1449
*               DARGSENT=MSG3009I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@14),X'0A'                                 1450
*               DARGRETP=0;         /*                       @Y30LB34*/
         SLR   @09,@09                                             1451
         ST    @09,DARGRETP(,@14)                                  1451
*               DARGCNT=3;          /*                       @Y30LB34*/
         LA    @09,3                                               1452
         STH   @09,DARGCNT(,@14)                                   1452
*               DARGINS(1)=1;       /*                       @Y30LB34*/
         MVC   DARGINS(2,@14),@CH00217                             1453
*               DARGINL(1)=LENGTH(TESTRC);/*                 @Y30LB34*/
         LA    @08,2                                               1454
         STH   @08,DARGINL(,@14)                                   1454
*               DARGDTM(1)=ADDR(TESTRC);/*                   @Y30LB34*/
         LA    @01,TESTRC                                          1455
         ST    @01,DARGDTM(,@14)                                   1455
*               DARGINS(2)=2;       /*                       @Y30LB34*/
         STH   @08,DARGINS+8(,@14)                                 1456
*               DARGINL(2)=LENGTH(CTGFDBK);/*                @Y30LB34*/
         STH   @08,DARGINL+8(,@14)                                 1457
*               DARGDTM(2)=ADDR(CTGFDBK);/*                  @Y30LB34*/
         LA    @01,CTGFDBK(,@15)                                   1458
         ST    @01,DARGDTM+8(,@14)                                 1458
*               DARGINS(3)=3;       /*                       @Y30LB34*/
         STH   @09,DARGINS+16(,@14)                                1459
*               DARGINL(3)=2;       /*                       @Y30LB34*/
         STH   @08,DARGINL+16(,@14)                                1460
*               DARGDTM(3)=ADDR(CTGFBFLG);/*                 @Y30LB34*/
         LA    @15,CTGFBFLG(,@15)                                  1461
         ST    @15,DARGDTM+16(,@14)                                1461
*             END;                  /*                       @Y30LB34*/
*                                                                  1462
*           /*********************************************************/
*           /*                                                       */
*           /* IF CMS DID NOT RETURN INFORMATION IN          @Y30LB34*/
*           /* FEEDBACK AREA PRINT MESSAGE IDC3007I          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1463
*           ELSE                                                   1463
*             DO;                   /*                       @Y30LB34*/
         B     @RC01447                                            1463
@RF01447 DS    0H                                                  1464
*               DARGSMOD=UNIVMSG;   /*                       @Y30LB34*/
         L     @15,DDSTRU                                          1464
         MVC   DARGSMOD(3,@15),@CC01553                            1464
*               DARGSENT=MSG3007I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'07'                                 1465
*               DARGDBP=ADDR(TESTRC);/*                      @Y30LB34*/
         LA    @14,TESTRC                                          1466
         ST    @14,DARGDBP(,@15)                                   1466
*               DARGILP=LENGTH(TESTRC);/*                    @Y30LB34*/
         MVC   DARGILP(2,@15),@CH00153                             1467
*               DARGRETP=0;         /*                       @Y30LB34*/
         SLR   @14,@14                                             1468
         ST    @14,DARGRETP(,@15)                                  1468
*             END;                  /*                       @Y30LB34*/
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
@RC01447 L     @15,@PC00001                                        1470
         ST    @15,@AL00001                                        1470
         LA    @14,@CF00115                                        1470
         ST    @14,@AL00001+4                                      1470
         LA    @14,DDSTRU                                          1470
         ST    @14,@AL00001+8                                      1470
         MVI   @AL00001+8,X'80'                                    1470
         L     @15,GDTPRT(,@15)                                    1470
         LA    @01,@AL00001                                        1470
         BALR  @14,@15                                             1470
*                                                                  1471
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT MESSAGE IDC3738I NOTIFYING              @Y30LB34*/
*           /* UNSUCCESSFUL VSAM RECATALOGING                @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1471
*           PRINTTAB=''B;           /*                       @Y30LB34*/
         XC    PRINTTAB(44),PRINTTAB                               1471
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @15,DDSTRU                                          1472
         MVC   DARGSMOD(3,@15),@CC01557                            1472
*           DARGSENT=MSG3738I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'0E'                                 1473
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @15,@PC00001                                        1474
         ST    @15,@AL00001                                        1474
         LA    @14,@CF00115                                        1474
         ST    @14,@AL00001+4                                      1474
         LA    @14,DDSTRU                                          1474
         ST    @14,@AL00001+8                                      1474
         MVI   @AL00001+8,X'80'                                    1474
         L     @15,GDTPRT(,@15)                                    1474
         LA    @01,@AL00001                                        1474
         BALR  @14,@15                                             1474
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
@RC01436 DS    0H                                                  1477
*                                                                  1477
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UCLOSE TO CLOSE THE CATALOG                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1477
*   IF IOCSPTR^=NULLPTR THEN                                       1477
@RF01393 L     @15,IOCSPTR                                         1477
         LTR   @15,@15                                             1477
         BZ    @RF01477                                            1477
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCIOCL0(GDTTBL,IOCSPTR);/*                     @Y30LB34*/
         L     @15,@PC00001                                        1479
         ST    @15,@AL00001                                        1479
         LA    @14,IOCSPTR                                         1479
         ST    @14,@AL00001+4                                      1479
         MVI   @AL00001+4,X'80'                                    1479
         L     @15,GDTCLS(,@15)                                    1479
         LA    @01,@AL00001                                        1479
         BALR  @14,@15                                             1479
*       RESPECIFY                                                  1480
*         RTNREG RSTD;                                             1480
*       TESTRC=RTNREG;                                             1481
         STH   RTNREG,TESTRC                                       1481
*       RESPECIFY                                                  1482
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC16=MAX(CC16,TESTRC);      /*                       @Y30LB34*/
         LH    @15,TESTRC                                          1483
         LH    @14,CC16                                            1483
         CR    @14,@15                                             1483
         BNL   *+6
         LR    @14,@15                                             1483
         STH   @14,CC16                                            1483
*     END;                          /*                       @Y30LB34*/
*                                                                  1484
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1485
*   REG14=RTNREG4;                  /*                       @Y30LB34*/
@RF01477 L     REG14,RTNREG4                                       1485
*   RETURN CODE(CC16);              /*                       @Y30LB34*/
         LH    @15,CC16                                            1486
@EL00017 DS    0H                                                  1486
@EF00017 DS    0H                                                  1486
@ER00017 BR    @14                                                 1486
*   END RCATVSAM;                   /*                       @Y30LB34*/
*                                                                  1488
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - RVSCRV                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - CALLS VOLUME SERVICES TO SCRATCH THE VTOC ON  @Y30LB34*/
*/*            THEN SOURCE VOLUME                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CLOSES THE VTOC                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS MESSAGE IDC0749I IF THE VTOC IS        @Y30LB34*/
*/*            SCRATCHED                                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FRVS1AGL, DARGLIST                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/
*/*           R. C. =  8, UNABLE TO SCRATCH VTOC             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1488
*RVSCRV:                                                           1488
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1488
RVSCRV   DS    0H                                                  1489
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1489
*   DCL                                                            1489
*     CC17 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1490
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1490
*   OLDERID2=NEWERID2;                                             1490
         L     @08,@PC00001                                        1490
         L     @15,GDTTR2(,@08)                                    1490
         MVC   @TS00001(95),NEWERID2(@15)                          1490
         MVC   OLDERID2(95,@15),@TS00001                           1490
*   NEWID2='CNTH';                  /*                       @Y30LB34*/
*                                                                  1491
         MVC   NEWID2(4,@15),@CC01801                              1491
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1492
*   CC17=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC17,CC17                                           1492
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  1493
         LR    RTNREG2,REG14                                       1493
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VOLUME SERVICES TO SCRATCH THE SOURCE VOLUME     @Y30LB34*/
*   /* VTOC                                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1494
*   RESPECIFY                                                      1494
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',SCRVTOC,VS1AGL);/*       @Y30LB34*/
         ST    @08,@AL00001                                        1495
         LA    @15,@CC01720                                        1495
         ST    @15,@AL00001+4                                      1495
         LA    @15,SCRVTOC                                         1495
         ST    @15,@AL00001+8                                      1495
         LA    @15,FRVS1AGL                                        1495
         ST    @15,@AL00001+12                                     1495
         MVI   @AL00001+12,X'80'                                   1495
         L     @15,GDTCAL(,@08)                                    1495
         LA    @01,@AL00001                                        1495
         BALR  @14,@15                                             1495
*   RESPECIFY                                                      1496
*     RTNREG RSTD;                                                 1496
*   TESTRC=RTNREG;                                                 1497
         STH   RTNREG,TESTRC                                       1497
*   RESPECIFY                                                      1498
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1498
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERVICES WAS UNABLE TO SCRATCH THE VTOC     @Y30LB34*/
*   /* SET CONDITION CODE TO 8                               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1499
*   IF TESTRC>0 THEN                                               1499
         LH    @08,TESTRC                                          1499
         LTR   @08,@08                                             1499
         BNP   @RF01499                                            1499
*     CC17=LASTCC08;                /*                       @Y30LB34*/
         LA    CC17,8                                              1500
*                                                                  1501
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERVICES OPENED THE VTOC, CLOSE IT          @Y30LB34*/
*   /* AND SET THE IOCSTR POINTER TO 0                       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1501
*   IF VSIOP^=NULLPTR THEN                                         1501
@RF01499 LA    @08,FRVS1AGL                                        1501
         L     @15,VSIOP(,@08)                                     1501
         LTR   @15,@15                                             1501
         BZ    @RF01501                                            1501
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB34*/
         L     @15,@PC00001                                        1503
         ST    @15,@AL00001                                        1503
         LA    @08,VSIOP(,@08)                                     1503
         ST    @08,@AL00001+4                                      1503
         MVI   @AL00001+4,X'80'                                    1503
         L     @15,GDTCLS(,@15)                                    1503
         LA    @01,@AL00001                                        1503
         BALR  @14,@15                                             1503
*       RESPECIFY                                                  1504
*         RTNREG RSTD;                                             1504
*       TESTRC=RTNREG;                                             1505
         STH   RTNREG,TESTRC                                       1505
*       RESPECIFY                                                  1506
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC17=MAX(CC17,TESTRC);      /*                       @Y30LB34*/
         LH    @08,TESTRC                                          1507
         CR    CC17,@08                                            1507
         BNL   *+6
         LR    CC17,@08                                            1507
*       VSIOP=NULLPTR;              /*                       @Y30LB34*/
         LA    @08,FRVS1AGL                                        1508
         SLR   @15,@15                                             1508
         ST    @15,VSIOP(,@08)                                     1508
*     END;                          /*                       @Y30LB34*/
*                                                                  1509
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VTOC WAS SCRATCHED, PRINT MESSAGE IDC0749I     @Y30LB34*/
*   /* NOTIFYING THE USER                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1510
*   IF CC17<LASTCC08 THEN                                          1510
@RF01501 C     CC17,@CF00177                                       1510
         BNL   @RF01510                                            1510
*     DO;                           /*                       @Y30LB34*/
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1512
         MVC   DARGSMOD(3,@08),@CC01557                            1512
*       DARGSENT=MSG0749I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'0D'                                 1513
*       DARGDBP=0;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1514
         ST    @15,DARGDBP(,@08)                                   1514
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @15,DARGILP(,@08)                                   1515
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@08)                                  1516
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @08,@PC00001                                        1517
         ST    @08,@AL00001                                        1517
         LA    @15,@CF00115                                        1517
         ST    @15,@AL00001+4                                      1517
         LA    @15,DDSTRU                                          1517
         ST    @15,@AL00001+8                                      1517
         MVI   @AL00001+8,X'80'                                    1517
         L     @15,GDTPRT(,@08)                                    1517
         LA    @01,@AL00001                                        1517
         BALR  @14,@15                                             1517
*     END;                          /*                       @Y30LB34*/
*                                                                  1518
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1519
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RF01510 LR    REG14,RTNREG2                                       1519
*   RETURN CODE(CC17);              /*                       @Y30LB34*/
         LR    @15,CC17                                            1520
@EL00018 DS    0H                                                  1520
@EF00018 DS    0H                                                  1520
@ER00018 BR    @14                                                 1520
*   END RVSCRV;                     /*                       @Y30LB34*/
*                                                                  1522
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRPROC                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - CONTROLS THE VIRTUAL TO REAL CONVERSION       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ENQUEUES THE SOURCE VOLUME                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VRINITSO TO INTERROGATE SOURCE VOLUME   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VRINITTA TO INTERROGATE TARGET VOLUME   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VRMOVE TO CONTROL THE CONVERSION OF     @Y30LB34*/
*/*            DATA FROM VIRTUAL TO REAL                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            TESTS IF SOURCE VOLUME VTOC SHOULD BE         @Y30LB34*/
*/*            SCRATCHED, AND, IF SO, CALLS VRSCRV           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES TARGET VOLUME RESERVED IN CHEKTARG   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES SOURCE VOLUME ENQUEUED ABOVE         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM VRINITTA          @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM VRINITSO,         @Y30LB34*/
*/*                       VRINITTA, VRMOVE OR VRSCRV         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1522
*VRPROC:                                                           1522
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1522
VRPROC   DS    0H                                                  1523
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1523
*   DCL                                                            1523
*     CC18 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1524
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1524
*   OLDERID2=NEWERID2;                                             1524
         L     @07,@PC00001                                        1524
         L     @15,GDTTR2(,@07)                                    1524
         MVC   @TS00001(95),NEWERID2(@15)                          1524
         MVC   OLDERID2(95,@15),@TS00001                           1524
*   NEWID2='CNTI';                  /*                       @Y30LB34*/
*                                                                  1525
         MVC   NEWID2(4,@15),@CC01808                              1525
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1526
*   CC18=LASTCC00;                  /*                       @Y30LB34*/
         SLR   @15,@15                                             1526
         STH   @15,CC18                                            1526
*   RTNREG1=REG14;                  /*                       @Y30LB34*/
*                                                                  1527
         ST    REG14,RTNREG1                                       1527
*   /*****************************************************************/
*   /*                                                               */
*   /* ENQUEUE THE SOURCE VOLUME AND SET ON THE SOURCE ENQ   @Y30LB34*/
*   /* BIT                                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1528
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,QNAME,RNAMEVE);/*         @Y30LB34*/
         MVC   @AL00001+4(12),@AL01528                             1528
         ST    @07,@AL00001                                        1528
         LA    @15,RNAMEVE                                         1528
         ST    @15,@AL00001+16                                     1528
         MVI   @AL00001+16,X'80'                                   1528
         L     @15,GDTENQ(,@07)                                    1528
         LA    @01,@AL00001                                        1528
         BALR  @14,@15                                             1528
*   SENQ=ON;                        /*                       @Y30LB34*/
*                                                                  1529
         OI    SENQ,B'10000000'                                    1529
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VRINITSO TO INTERROGATE THE VIRT SOURCE VOLUME   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1530
*   CALL VRINITSO;                  /*                       @Y30LB34*/
         BAL   @14,VRINITSO                                        1530
*   RESPECIFY                                                      1531
*     RTNREG RSTD;                                                 1531
*   TESTRC=RTNREG;                                                 1532
         STH   RTNREG,TESTRC                                       1532
*   RESPECIFY                                                      1533
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC18=TESTRC;                    /*                       @Y30LB34*/
         LH    @07,TESTRC                                          1534
         STH   @07,CC18                                            1534
*                                                                  1535
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS OCCURRED IN VRINITSO, CALL        @Y30LB34*/
*   /* VRINITTA TO INTERROGATE THE REAL TARGET VOLUME        @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1535
*   IF CC18<LASTCC12 THEN                                          1535
         C     @07,@CF00567                                        1535
         BNL   @RF01535                                            1535
*     DO;                           /*                       @Y30LB34*/
*       CALL VRINITTA;              /*                       @Y30LB34*/
         BAL   @14,VRINITTA                                        1537
*       RESPECIFY                                                  1538
*         RTNREG RSTD;                                             1538
*       TESTRC=RTNREG;                                             1539
         STH   RTNREG,TESTRC                                       1539
*       RESPECIFY                                                  1540
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC18=MAX(CC18,TESTRC);      /*                       @Y30LB34*/
         LH    @07,TESTRC                                          1541
         LH    @15,CC18                                            1541
         CR    @15,@07                                             1541
         BNL   *+6
         LR    @15,@07                                             1541
         STH   @15,CC18                                            1541
*     END;                          /*                       @Y30LB34*/
*                                                                  1542
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, CALL VRMOVE        @Y30LB34*/
*   /* TO HANDLE THE DATA CONVERSION FROM VIRTUAL TO REAL    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1543
*   IF CC18<LASTCC12 THEN                                          1543
@RF01535 LH    @07,CC18                                            1543
         C     @07,@CF00567                                        1543
         BNL   @RF01543                                            1543
*     DO;                           /*                       @Y30LB34*/
*       CALL VRMOVE;                /*                       @Y30LB34*/
         BAL   @14,VRMOVE                                          1545
*       RESPECIFY                                                  1546
*         RTNREG RSTD;                                             1546
*       TESTRC=RTNREG;                                             1547
         STH   RTNREG,TESTRC                                       1547
*       RESPECIFY                                                  1548
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC18=MAX(CC18,TESTRC);      /*                       @Y30LB34*/
         LH    @07,TESTRC                                          1549
         LH    @02,CC18                                            1549
         CR    @02,@07                                             1549
         BNL   *+6
         LR    @02,@07                                             1549
         STH   @02,CC18                                            1549
*     END;                          /*                       @Y30LB34*/
*                                                                  1550
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, AND IF             @Y30LB34*/
*   /* 'NOSCRATCH' WAS NOT SPECIFIED IN A CONTROL            @Y30LB34*/
*   /* STATEMENT, CALL VRSCRV TO SCRATCH THE SOURCE          @Y30LB34*/
*   /* VOLUME VTOC                                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1551
*   IF CC18<LASTCC12 THEN                                          1551
@RF01543 LH    @07,CC18                                            1551
         C     @07,@CF00567                                        1551
         BNL   @RF01551                                            1551
*     IF ADDR(NSCR)=NULLPTR THEN                                   1552
         L     @07,@PC00001+4                                      1552
         L     @07,FDTPTR+36(,@07)                                 1552
         LTR   @07,@07                                             1552
         BNZ   @RF01552                                            1552
*       DO;                         /*                       @Y30LB34*/
*         CALL VRSCRV;              /*                       @Y30LB34*/
         BAL   @14,VRSCRV                                          1554
*         RESPECIFY                                                1555
*           RTNREG RSTD;                                           1555
*         TESTRC=RTNREG;                                           1556
         STH   RTNREG,TESTRC                                       1556
*         RESPECIFY                                                1557
*           RTNREG UNRSTD;          /*                       @Y30LB34*/
*         CC18=MAX(CC18,TESTRC);    /*                       @Y30LB34*/
         LH    @07,TESTRC                                          1558
         LH    @02,CC18                                            1558
         CR    @02,@07                                             1558
         BNL   *+6
         LR    @02,@07                                             1558
         STH   @02,CC18                                            1558
*       END;                        /*                       @Y30LB34*/
*                                                                  1560
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TARGET VOLUME IS STILL RESERVED FROM           @Y30LB34*/
*   /* CHEKTARG, IMPLYING THE COMMAND IS TERMINATING WITH    @Y30LB34*/
*   /* A RETURN CODE OF 12, RELEASE THAT RESERVE AND SET     @Y30LB34*/
*   /* OFF THE TARGET RESERVE BIT                            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1560
*   IF TRES=ON THEN                                                1560
@RF01552 DS    0H                                                  1560
@RF01551 TM    TRES,B'01000000'                                    1560
         BNO   @RF01560                                            1560
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMERR);/*               @Y30LB34*/
         L     @07,@PC00001                                        1562
         ST    @07,@AL00001                                        1562
         LA    @02,@CC01594                                        1562
         ST    @02,@AL00001+4                                      1562
         LA    @02,RNAMERR                                         1562
         ST    @02,@AL00001+8                                      1562
         MVI   @AL00001+8,X'80'                                    1562
         L     @15,GDTDEQ(,@07)                                    1562
         LA    @01,@AL00001                                        1562
         BALR  @14,@15                                             1562
*       TRES=OFF;                   /*                       @Y30LB34*/
         NI    TRES,B'10111111'                                    1563
*     END;                          /*                       @Y30LB34*/
*                                                                  1564
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SOURCE VOLUME WAS ENQUEUED AT THE BEGINNING    @Y30LB34*/
*   /* OF THIS PROCEDURE, DEQUEUE THAT ENQUEUE AND SET OFF   @Y30LB34*/
*   /* THE SOURCE ENQ BIT                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1565
*   IF SENQ=ON THEN                                                1565
@RF01560 TM    SENQ,B'10000000'                                    1565
         BNO   @RF01565                                            1565
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVE);/*               @Y30LB34*/
         L     @07,@PC00001                                        1567
         ST    @07,@AL00001                                        1567
         LA    @02,@CC01594                                        1567
         ST    @02,@AL00001+4                                      1567
         LA    @02,RNAMEVE                                         1567
         ST    @02,@AL00001+8                                      1567
         MVI   @AL00001+8,X'80'                                    1567
         L     @15,GDTDEQ(,@07)                                    1567
         LA    @01,@AL00001                                        1567
         BALR  @14,@15                                             1567
*       SENQ=OFF;                   /*                       @Y30LB34*/
         NI    SENQ,B'01111111'                                    1568
*     END;                          /*                       @Y30LB34*/
*                                                                  1569
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLING PROCEDURE                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1570
*   REG14=RTNREG1;                  /*                       @Y30LB34*/
@RF01565 L     REG14,RTNREG1                                       1570
*   RETURN CODE(CC18);              /*                       @Y30LB34*/
         LH    @15,CC18                                            1571
@EL00019 DS    0H                                                  1571
@EF00019 DS    0H                                                  1571
@ER00019 BR    @14                                                 1571
*   END VRPROC;                     /*                       @Y30LB34*/
*                                                                  1573
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRINITSO                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - INTERROGATES THE MSS SOURCE VOLUME            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VRGETSO TO ACCESS THE MSVC BASE VOLUME  @Y30LB34*/
*/*            RECORD TO RETRIEVE VOLUME INFORMATION, AND    @Y30LB34*/
*/*            TO MOUNT THE SOURCE VOLUME                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS CHEKSRCE TO CHECK SOURCE VOLUME         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES USYSINFO TO RETRIEVE VTOC TTR AFTER    @Y30LB34*/
*/*            VOLUME IS MOUNTED                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES THE SOURCE VOLUME RESERVED IN        @Y30LB34*/
*/*            CHEKSRCE                                      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEMOUNTS THE SOURCE VOLUME MOUNTED IN VRGETSO @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - MDAGL, PUAGL                                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM CHEKSRCE          @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM VRGETSO OR        @Y30LB34*/
*/*                       CHEKSRCE,                          @Y30LB34*/
*/*                       UNABLE TO DEMOUNT VOLUME           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1573
*VRINITSO:                                                         1573
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1573
VRINITSO DS    0H                                                  1574
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1574
*   DCL                                                            1574
*     CC19 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1575
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1575
*   OLDERID2=NEWERID2;                                             1575
         L     @11,@PC00001                                        1575
         L     @11,GDTTR2(,@11)                                    1575
         MVC   @TS00001(95),NEWERID2(@11)                          1575
         MVC   OLDERID2(95,@11),@TS00001                           1575
*   NEWID2='CNTJ';                  /*                       @Y30LB34*/
*                                                                  1576
         MVC   NEWID2(4,@11),@CC01817                              1576
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1577
*   CC19=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC19,CC19                                           1577
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
         LR    RTNREG2,REG14                                       1578
*                                                                  1579
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VRGETSO TO RETRIEVE INFORMATION FROM THE BASE    @Y30LB34*/
*   /* VOLUME RECORD AND MOUNT THE SOURCE VOLUME IF THE      @Y30LB34*/
*   /* SOURCE AND TARGET VOLSERS ARE THE SAME                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1579
*   CALL VRGETSO;                   /*                       @Y30LB34*/
         BAL   @14,VRGETSO                                         1579
*   RESPECIFY                                                      1580
*     RTNREG RSTD;                                                 1580
*   TESTRC=RTNREG;                                                 1581
         STH   RTNREG,TESTRC                                       1581
*   RESPECIFY                                                      1582
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC19=TESTRC;                    /*                       @Y30LB34*/
*                                                                  1583
         LH    @15,TESTRC                                          1583
         LR    CC19,@15                                            1583
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERRORS OCCURRED, CONTINUE PROCESSING     @Y30LB34*/
*   /* SOURCE VOLUME                                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1584
*   IF CC19<LASTCC12 THEN                                          1584
         C     CC19,@CF00567                                       1584
         BNL   @RF01584                                            1584
*     DO;                           /*                       @Y30LB34*/
*                                                                  1585
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CHEKSRCE TO PERFORM SECURITY CHECKING ON THE @Y30LB34*/
*       /* SOURCE VOLUME AND CHECK JOB SETUP WITH RESPECT TO @Y30LB34*/
*       /* THE SOURCE VOLUME                                 @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1586
*       CALL CHEKSRCE;              /*                       @Y30LB34*/
         BAL   @14,CHEKSRCE                                        1586
*       RESPECIFY                                                  1587
*         RTNREG RSTD;                                             1587
*       TESTRC=RTNREG;                                             1588
         STH   RTNREG,TESTRC                                       1588
*       RESPECIFY                                                  1589
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC19=MAX(CC19,TESTRC);      /*                       @Y30LB34*/
         LH    @11,TESTRC                                          1590
         CR    CC19,@11                                            1590
         BNL   *+6
         LR    CC19,@11                                            1590
*                                                                  1591
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO SEVERE ERROR OCCURRED ISSUE USYSINFO TO     @Y30LB34*/
*       /* GET THE VTOC TTR OF THE MOUNTED VOLUME. THIS WILL @Y30LB34*/
*       /* BE SAVED AND USED TO FIND THE VTOC ON THE TARGET  @Y30LB34*/
*       /* VOLUME AFTER THE CONVERSION                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1591
*       IF CC19<LASTCC12 THEN                                      1591
         C     CC19,@CF00567                                       1591
         BNL   @RF01591                                            1591
*         DO;                       /*                       @Y30LB34*/
*           UNITABLA=''B;           /*                       @Y30LB34*/
         XC    UNITABLA(11),UNITABLA                               1593
*           CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,FFILEVAL);/*  @Y30LB34*/
         L     @11,@PC00001                                        1594
         ST    @11,@AL00001                                        1594
         LA    @15,UNIT                                            1594
         ST    @15,@AL00001+4                                      1594
         LA    @15,UNITABLP                                        1594
         ST    @15,@AL00001+8                                      1594
         L     @15,@PC00001+4                                      1594
         L     @01,FDTPTR(,@15)                                    1594
         LA    @15,FFILEVAL(,@01)                                  1594
         ST    @15,@AL00001+12                                     1594
         MVI   @AL00001+12,X'80'                                   1594
         L     @15,GDTSFO(,@11)                                    1594
         LA    @01,@AL00001                                        1594
         BALR  @14,@15                                             1594
*           RESPECIFY                                              1595
*             RTNREG RSTD;                                         1595
*           TESTRC=RTNREG;                                         1596
         STH   RTNREG,TESTRC                                       1596
*           RESPECIFY                                              1597
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*                                                                  1597
*           /*********************************************************/
*           /*                                                       */
*           /* IF USYSINFO IS SUCCESSFUL SAVE THE TTR ADDRESS        */
*           /*                                               @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1598
*           IF TESTRC=LASTCC00 THEN                                1598
         LH    @11,TESTRC                                          1598
         LTR   @11,@11                                             1598
         BNZ   @RF01598                                            1598
*             SVTOCTTR=UNITVTOC;    /*                       @Y30LB34*/
*                                                                  1599
         L     @11,UNITABLP                                        1599
         MVC   SVTOCTTR(4),UNITVTOC(@11)                           1599
*           /*********************************************************/
*           /*                                                       */
*           /* IF USYSINFO IS UNSUCCESSFUL SET THE CONDITION @Y30LB34*/
*           /* CODE TO 12                                    @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1600
*           ELSE                                                   1600
*             CC19=LASTCC12;        /*                       @Y30LB34*/
         B     @RC01598                                            1600
@RF01598 LA    CC19,12                                             1600
*         END;                      /*                       @Y30LB34*/
*                                                                  1601
@RC01598 DS    0H                                                  1602
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE SOURCE VOLUME WAS RESERVED IN CHEKSRCE,    @Y30LB34*/
*       /* RELEASE THAT RESERVE AND SET OFF THE SOURCE       @Y30LB34*/
*       /* RESERVE BIT                                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1602
*       IF SRES=ON THEN                                            1602
@RF01591 TM    SRES,B'01000000'                                    1602
         BNO   @RF01602                                            1602
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*           @Y30LB34*/
         L     @11,@PC00001                                        1604
         ST    @11,@AL00001                                        1604
         LA    @15,@CC01594                                        1604
         ST    @15,@AL00001+4                                      1604
         LA    @15,RNAMEVR                                         1604
         ST    @15,@AL00001+8                                      1604
         MVI   @AL00001+8,X'80'                                    1604
         L     @15,GDTDEQ(,@11)                                    1604
         LA    @01,@AL00001                                        1604
         BALR  @14,@15                                             1604
*           SRES=OFF;               /*                       @Y30LB34*/
         NI    SRES,B'10111111'                                    1605
*         END;                      /*                       @Y30LB34*/
*                                                                  1607
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO SEVERE ERROR HAS OCCURRED, ISSUE UMSSUNIT   @Y30LB34*/
*       /* TO DEMOUNT SOURCE VOLUME. IF SOURCE AND TARGET    @Y30LB34*/
*       /* VOLSERS ARE THE SAME, SET THE BIT ON TO POST THE  @Y30LB34*/
*       /* TARGET UCB AFTER DEMOUNT. SET THE WAIT BIT ON     @Y30LB34*/
*       /* TO WAIT UNTIL THE DEMOUNT IS COMPLETE BEFORE THE  @Y30LB34*/
*       /* COPY BEGINS                                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1607
*       IF CC19<LASTCC12 THEN                                      1607
@RF01602 C     CC19,@CF00567                                       1607
         BNL   @RF01607                                            1607
*         DO;                       /*                       @Y30LB34*/
*           IF SAMESER=ON THEN                                     1609
         TM    SAMESER,B'10000000'                                 1609
         BNO   @RF01609                                            1609
*             MDPOST=ON;            /*                       @Y30LB34*/
         LA    @11,MDAGLAR                                         1610
         OI    MDPOST(@11),B'00100000'                             1610
*           MDWAIT=ON;              /*                       @Y30LB34*/
@RF01609 LA    @11,MDAGLAR                                         1611
         OI    MDWAIT(@11),B'00010000'                             1611
*           CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*           @Y30LB34*/
         L     @15,@PC00001                                        1612
         ST    @15,@AL00001                                        1612
         LA    @14,DEMOUNT                                         1612
         ST    @14,@AL00001+4                                      1612
         ST    @11,@AL00001+8                                      1612
         MVI   @AL00001+8,X'80'                                    1612
         L     @15,GDTUNT(,@15)                                    1612
         LA    @01,@AL00001                                        1612
         BALR  @14,@15                                             1612
*           RESPECIFY                                              1613
*             RTNREG RSTD;                                         1613
*           TESTRC=RTNREG;                                         1614
         STH   RTNREG,TESTRC                                       1614
*           RESPECIFY                                              1615
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           MDPOST=OFF;             /*                       @Y30LB34*/
*           MDWAIT=OFF;             /*                       @Y30LB34*/
*                                                                  1617
         LA    @11,MDAGLAR                                         1617
         NI    MDPOST(@11),B'11001111'                             1617
*           /*********************************************************/
*           /*                                                       */
*           /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE        @Y30LB34*/
*           /* CONDITION CODE TO 12                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1618
*           IF TESTRC>0 THEN                                       1618
         LH    @11,TESTRC                                          1618
         LTR   @11,@11                                             1618
         BNP   @RF01618                                            1618
*             CC19=LASTCC12;        /*                       @Y30LB34*/
         LA    CC19,12                                             1619
*         END;                      /*                       @Y30LB34*/
@RF01618 DS    0H                                                  1621
*     END;                          /*                       @Y30LB34*/
*                                                                  1621
@RF01607 DS    0H                                                  1622
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1622
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RF01584 LR    REG14,RTNREG2                                       1622
*   RETURN CODE(CC19);              /*                       @Y30LB34*/
         LR    @15,CC19                                            1623
@EL00020 DS    0H                                                  1623
@EF00020 DS    0H                                                  1623
@ER00020 BR    @14                                                 1623
*   END VRINITSO;                   /*                       @Y30LB34*/
*                                                                  1625
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRGETSO                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - INITIALIZES THE MSVC PARM LIST TO RETRIEVE    @Y30LB34*/
*/*            THE BASE VOLUME RECORD OF THE MSS VOLUME      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES USSC TO RETRIEVE THE BASE VOLUME       @Y30LB34*/
*/*            RECORD                                        @Y30LB34*/
*/*                IF USSC IS NOT SUCCESSFUL, CALLS SSCMSG   @Y30LB34*/
*/*                TO PRINT MESSAGE ISSUED BY USSC,          @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC2080 IF THE BASE  @Y30LB34*/
*/*                VOLUME RECORD COULD NOT BE RETRIEVED      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DETERMINES IF VOLUME IS INACTIVE.  IF SO,     @Y30LB34*/
*/*            PRINTS MESSAGE IDC3074I                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DETERMINES IF ANY RECOVERY FLAGS ARE ON, AND, @Y30LB34*/
*/*            IF SO, WHICH ONES                             @Y30LB34*/
*/*                IF INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3097I,            @Y30LB34*/
*/*                IF VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3095I,            @Y30LB34*/
*/*                IF INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/
*/*                PRINTS ERROR MESSAGE IDC3096I.            @Y30LB34*/
*/*                                                          @YD00175*/
*/*            OBTAINS EXCLUSIVE CONTROL OF TARGET REAL      @YD00175*/
*/*            VOLUME                                        @YD00175*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES THE MOUNT/DEMOUNT PARM LIST FOR   @Y30LB34*/
*/*            THE VIRTUAL TARGET VOLUME                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF THE VOLUMES HAVE THE SAME VOLSERS,         @Y30LB34*/
*/*            INITIALIZES THE POST/CLEAR PARM LIST FOR THE  @Y30LB34*/
*/*            SOURCE VOLUME                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            MOUNTS THE MSS VOLUME IF SOURCE AND TARGET    @Y30LB34*/
*/*            VOLSERS ARE EQUAL                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FUNCTION DATA TABLE, MDAGL, PUAGL, SRCEAREA,     @Y30LB34*/
*/*         TARGAREA, AND SAMESER                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - MDAGL, PUAGL, SRCEAREA, TARGAREA, RVVI, UNITABL @Y30LB34*/
*/*          DARGLIST                                        @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. = 12, UNABLE TO MOUNT MSS VOLUME,        @Y30LB34*/
*/*                       UNABLE TO RETRIEVE BASE VOLUME     @Y30LB34*/
*/*                       RECORD,                            @Y30LB34*/
*/*                       INVALID RECOVERY FLAG ON IN BASE   @Y30LB34*/
*/*                       VOLUME RECORD,                     @Y30LB34*/
*/*                       VOLUME NOT ACTIVE,                 @Y30LB34*/
*/*                       UNABLE TO RETRIEVE VTOC TTR        @Y30LB34*/
*/*                       UNABLE TO GET EXCLUSIVE CONTROL    @YD00175*/
*/*                        OF TARGET VOLUME                  @YD00175*/
*/*                                                          #Y30LB34*/
*/********************************************************** #Y30LB34*/
*                                                                  1625
*VRGETSO:                                                          1625
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1625
VRGETSO  DS    0H                                                  1626
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1626
*   DCL                                                            1626
*     CC20 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1627
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1627
*   OLDERID2=NEWERID2;                                             1627
         L     @08,@PC00001                                        1627
         L     @15,GDTTR2(,@08)                                    1627
         MVC   @TS00001(95),NEWERID2(@15)                          1627
         MVC   OLDERID2(95,@15),@TS00001                           1627
*   NEWID2='CNTK';                  /*                       @Y30LB34*/
*                                                                  1628
         MVC   NEWID2(4,@15),@CC01823                              1628
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1629
*   CC20=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC20,CC20                                           1629
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  1630
         ST    REG14,RTNREG3                                       1630
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI PARM LIST FOR RETRIEVING A BASE       @Y30LB34*/
*   /* VOLUME RECORD                                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1631
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB34*/
         L     @15,RVVIPTR                                         1631
         LH    @14,RVVLEN                                          1631
         ST    @14,RVVLNGTH(,@15)                                  1631
*   RVVCODE=RVVOP;                  /*                       @Y30LB34*/
         MVI   RVVCODE(@15),X'87'                                  1632
*   RVVOLUME=SVOLSER;               /*                       @Y30LB34*/
         MVC   RVVOLUME(6,@15),SVOLSER                             1633
*   RVVRDR=ON;                      /*                       @Y30LB34*/
         OI    RVVRDR(@15),B'10000000'                             1634
*   RVVBVRCD=ON;                    /*                       @Y30LB34*/
         OI    RVVBVRCD(@15),B'10000000'                           1635
*   RVVBUFLN=LENGTH(BASEVAR);       /*                       @Y30LB34*/
         MVC   RVVBUFLN(2,@15),@CH01875                            1636
*   RVVRTBUF=ADDR(BASEVAR);         /*                       @Y30LB34*/
         LA    @14,BASEVAR                                         1637
         ST    @14,RVVRTBUF(,@15)                                  1637
*                                                                  1638
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO ISSUE ICBVVIC TO RETRIEVE THE BASE      @Y30LB34*/
*   /* VOLUME RECORD FOR THE SOURCE VOLUME                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1638
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,USSCREG0);/*           @Y30LB34*/
         ST    @08,@AL00001                                        1638
         LA    @15,VVIC                                            1638
         ST    @15,@AL00001+4                                      1638
         LA    @15,RVVIPTR                                         1638
         ST    @15,@AL00001+8                                      1638
         LA    @15,USSCREG0                                        1638
         ST    @15,@AL00001+12                                     1638
         MVI   @AL00001+12,X'80'                                   1638
         L     @15,GDTSSC(,@08)                                    1638
         LA    @01,@AL00001                                        1638
         BALR  @14,@15                                             1638
*   RESPECIFY                                                      1639
*     RTNREG RSTD;                                                 1639
*   TESTRC=RTNREG;                                                 1640
         STH   RTNREG,TESTRC                                       1640
*   RESPECIFY                                                      1641
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1641
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USSC WAS UNSUCCESSFUL, CALL SSCMSG TO PRINT        @Y30LB34*/
*   /* THE USSC MESSAGE, PRINT MESSAGE IDC2080I, AND         @Y30LB34*/
*   /* SET THE CONDITION CODE TO 12                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1642
*   IF TESTRC>0 THEN                                               1642
         LH    @08,TESTRC                                          1642
         LTR   @08,@08                                             1642
         BNP   @RF01642                                            1642
*     DO;                           /*                       @Y30LB34*/
*       CALL SSCMSG(USSCREG0);      /*                       @Y30LB34*/
         LA    @15,USSCREG0                                        1644
         ST    @15,@AL00001                                        1644
         LA    @01,@AL00001                                        1644
         BAL   @14,SSCMSG                                          1644
*       CC20=LASTCC12;              /*                       @Y30LB34*/
         LA    CC20,12                                             1645
*       DARGSMOD=COMMSG;            /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1646
         MVC   DARGSMOD(3,@08),@CC01555                            1646
*       DARGSENT=MSG2080I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'1A'                                 1647
*       DARGDBP=ADDR(SVOLSER);      /*                       @Y30LB34*/
         LA    @15,SVOLSER                                         1648
         ST    @15,DARGDBP(,@08)                                   1648
*       DARGILP=LENGTH(SVOLSER);    /*                       @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             1649
*       DARGRETP=0;                 /*                       @Y30LB34*/
         SLR   @15,@15                                             1650
         ST    @15,DARGRETP(,@08)                                  1650
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @08,@PC00001                                        1651
         ST    @08,@AL00001                                        1651
         LA    @15,@CF00115                                        1651
         ST    @15,@AL00001+4                                      1651
         LA    @15,DDSTRU                                          1651
         ST    @15,@AL00001+8                                      1651
         MVI   @AL00001+8,X'80'                                    1651
         L     @15,GDTPRT(,@08)                                    1651
         LA    @01,@AL00001                                        1651
         BALR  @14,@15                                             1651
*     END;                          /*                       @Y30LB34*/
*                                                                  1652
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USSC WAS SUCCESSFUL, CHECK BASE VOLUME RECORD      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1653
*   ELSE                                                           1653
*     DO;                           /*                       @Y30LB34*/
         B     @RC01642                                            1653
@RF01642 DS    0H                                                  1654
*                                                                  1654
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR AN ACTIVE VOLUME. IF NOT, PRINT          @Y30LB34*/
*       /* ERROR MESSAGE IDC3074I AND SET CONDITION CODE     @Y30LB34*/
*       /* TO 12.                                            @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1654
*       IF BASINAC=ON THEN                                         1654
         L     @08,BASEVPTR                                        1654
         TM    BASINAC(@08),B'00000100'                            1654
         BNO   @RF01654                                            1654
*         DO;                       /*                       @Y30LB34*/
*           CC20=LASTCC12;          /*                       @Y30LB34*/
         LA    CC20,12                                             1656
*           DARGSMOD=COMMSG;        /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1657
         MVC   DARGSMOD(3,@08),@CC01555                            1657
*           DARGSENT=MSG3074I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'20'                                 1658
*           DARGDBP=ADDR(SVOLSER);  /*                       @Y30LB34*/
         LA    @15,SVOLSER                                         1659
         ST    @15,DARGDBP(,@08)                                   1659
*           DARGILP=LENGTH(SVOLSER);/*                       @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             1660
*           DARGRETP=0;             /*                       @Y30LB34*/
         SLR   @15,@15                                             1661
         ST    @15,DARGRETP(,@08)                                  1661
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        1662
         ST    @08,@AL00001                                        1662
         LA    @15,@CF00115                                        1662
         ST    @15,@AL00001+4                                      1662
         LA    @15,DDSTRU                                          1662
         ST    @15,@AL00001+8                                      1662
         MVI   @AL00001+8,X'80'                                    1662
         L     @15,GDTPRT(,@08)                                    1662
         LA    @01,@AL00001                                        1662
         BALR  @14,@15                                             1662
*         END;                      /*                       @Y30LB34*/
*                                                                  1663
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME IS ACTIVE, TEST RECOVERY FLAGS          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1664
*       ELSE                                                       1664
*         DO;                       /*                       @Y30LB34*/
*                                                                  1664
         B     @RC01654                                            1664
@RF01654 DS    0H                                                  1665
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/
*           /* PRINT ERROR MESSAGE IDC3097I AND SET          @Y30LB34*/
*           /* CONDITION CODE TO 12                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1665
*           IF BASIVCRE=ON THEN                                    1665
         L     @08,BASEVPTR                                        1665
         TM    BASIVCRE(@08),B'10000000'                           1665
         BNO   @RF01665                                            1665
*             DO;                   /*                       @Y30LB34*/
*               CC20=LASTCC12;      /*                       @Y30LB34*/
         LA    CC20,12                                             1667
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1668
         MVC   DARGSMOD(3,@08),@CC01555                            1668
*               DARGSENT=MSG3097F;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'05'                                 1669
*               DARGDBP=ADDR(SVOLSER);/*                     @Y30LB34*/
         LA    @15,SVOLSER                                         1670
         ST    @15,DARGDBP(,@08)                                   1670
*               DARGILP=LENGTH(SVOLSER);/*                   @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             1671
*               DARGRETP=0;         /*                       @Y30LB34*/
         SLR   @15,@15                                             1672
         ST    @15,DARGRETP(,@08)                                  1672
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/
         L     @08,@PC00001                                        1673
         ST    @08,@AL00001                                        1673
         LA    @15,@CF00115                                        1673
         ST    @15,@AL00001+4                                      1673
         LA    @15,DDSTRU                                          1673
         ST    @15,@AL00001+8                                      1673
         MVI   @AL00001+8,X'80'                                    1673
         L     @15,GDTPRT(,@08)                                    1673
         LA    @01,@AL00001                                        1673
         BALR  @14,@15                                             1673
*             END;                  /*                       @Y30LB34*/
*                                                                  1675
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/
*           /* PRINT ERROR MESSAGE IDC3095I AND SET          @Y30LB34*/
*           /* CONDITION CODE TO 12                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1675
*           ELSE                                                   1675
*             IF BASVSMIS=ON THEN                                  1675
         B     @RC01665                                            1675
@RF01665 L     @08,BASEVPTR                                        1675
         TM    BASVSMIS(@08),B'00100000'                           1675
         BNO   @RF01675                                            1675
*               DO;                 /*                       @Y30LB34*/
*                 CC20=LASTCC12;    /*                       @Y30LB34*/
         LA    CC20,12                                             1677
*                 DARGSMOD=COMMSG;  /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1678
         MVC   DARGSMOD(3,@08),@CC01555                            1678
*                 DARGSENT=MSG3095F;/*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'0B'                                 1679
*                 DARGDBP=ADDR(SVOLSER);/*                   @Y30LB34*/
         LA    @15,SVOLSER                                         1680
         ST    @15,DARGDBP(,@08)                                   1680
*                 DARGILP=LENGTH(SVOLSER);/*                 @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             1681
*                 DARGRETP=0;       /*                       @Y30LB34*/
         SLR   @15,@15                                             1682
         ST    @15,DARGRETP(,@08)                                  1682
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB34*/
         L     @08,@PC00001                                        1683
         ST    @08,@AL00001                                        1683
         LA    @15,@CF00115                                        1683
         ST    @15,@AL00001+4                                      1683
         LA    @15,DDSTRU                                          1683
         ST    @15,@AL00001+8                                      1683
         MVI   @AL00001+8,X'80'                                    1683
         L     @15,GDTPRT(,@08)                                    1683
         LA    @01,@AL00001                                        1683
         BALR  @14,@15                                             1683
*               END;                /*                       @Y30LB34*/
*                                                                  1684
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/
*           /* PRINT ERROR MESSAGE IDC3096I AND SET          @Y30LB34*/
*           /* CONDITION CODE TO 12                          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1685
*             ELSE                                                 1685
*               IF BASIVCPY=ON THEN                                1685
         B     @RC01675                                            1685
@RF01675 L     @08,BASEVPTR                                        1685
         TM    BASIVCPY(@08),B'01000000'                           1685
         BNO   @RF01685                                            1685
*                 DO;               /*                       @Y30LB34*/
*                   CC20=LASTCC12;  /*                       @Y30LB34*/
         LA    CC20,12                                             1687
*                   DARGSMOD=COMMSG;/*                       @Y30LB34*/
         L     @08,DDSTRU                                          1688
         MVC   DARGSMOD(3,@08),@CC01555                            1688
*                   DARGSENT=MSG3096I;/*                     @Y30LB34*/
         MVI   DARGSENT(@08),X'08'                                 1689
*                   DARGDBP=ADDR(SVOLSER);/*                 @Y30LB34*/
         LA    @15,SVOLSER                                         1690
         ST    @15,DARGDBP(,@08)                                   1690
*                   DARGILP=LENGTH(SVOLSER);/*               @Y30LB34*/
         MVC   DARGILP(2,@08),@CH00038                             1691
*                   DARGRETP=0;     /*                       @Y30LB34*/
         SLR   @15,@15                                             1692
         ST    @15,DARGRETP(,@08)                                  1692
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB34*/
         L     @08,@PC00001                                        1693
         ST    @08,@AL00001                                        1693
         LA    @15,@CF00115                                        1693
         ST    @15,@AL00001+4                                      1693
         LA    @15,DDSTRU                                          1693
         ST    @15,@AL00001+8                                      1693
         MVI   @AL00001+8,X'80'                                    1693
         L     @15,GDTPRT(,@08)                                    1693
         LA    @01,@AL00001                                        1693
         BALR  @14,@15                                             1693
*                 END;              /*                       @Y30LB34*/
*         END;                      /*                       @Y30LB34*/
@RF01685 DS    0H                                                  1695
@RC01675 DS    0H                                                  1695
@RC01665 DS    0H                                                  1696
*     END;                          /*                       @Y30LB34*/
@RC01654 DS    0H                                                  1697
*                                                                  1697
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR OCCURRED IN RETRIEVING AND         @Y30LB34*/
*   /* INTERROGATING THE BASE VOLUME RECORD,                 @YD00175*/
*   /* OBTAIN EXCLUSIVE USE OF TARGET VOLUME                 @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1697
*   IF CC20<LASTCC12 THEN                                          1697
@RC01642 C     CC20,@CF00567                                       1697
         BNL   @RF01697                                            1697
*     DO;                           /*                       @Y30LB34*/
*                                                                  1698
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP EXCLUSIVE CONTROL PARM LIST                @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1699
*       EXCLAGL=''B;                /*                       @YD00175*/
         LA    @08,EXCLAR                                          1699
         XC    EXCLAGL(23,@08),EXCLAGL(@08)                        1699
*       EXCLUCBP=ADDR(TUCBADDR);    /*                       @YD00175*/
         LA    @15,TUCBADDR                                        1700
         ST    @15,EXCLUCBP(,@08)                                  1700
*       EXCLDDP=ADDR(TFILEVAL);     /*                       @YD00175*/
*                                                                  1701
         L     @15,@PC00001+4                                      1701
         L     @01,FDTPTR+4(,@15)                                  1701
         LA    @15,TFILEVAL(,@01)                                  1701
         ST    @15,EXCLDDP(,@08)                                   1701
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1702
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/
         L     @15,@PC00001                                        1702
         ST    @15,@AL00001                                        1702
         LA    @14,CHANGEX                                         1702
         ST    @14,@AL00001+4                                      1702
         ST    @08,@AL00001+8                                      1702
         MVI   @AL00001+8,X'80'                                    1702
         L     @15,GDTUNT(,@15)                                    1702
         LA    @01,@AL00001                                        1702
         BALR  @14,@15                                             1702
*       RESPECIFY                                                  1703
*         RTNREG RSTD;                                             1703
*       TESTRC=RTNREG;                                             1704
         STH   RTNREG,TESTRC                                       1704
*       RESPECIFY                                                  1705
*         RTNREG UNRSTD;            /*                       @YD00175*/
*                                                                  1705
*       /*************************************************************/
*       /*                                                           */
*       /* IF RETURN CODE IS NOT ZERO, SET INTERNAL CONDITION        */
*       /*                                                   @YD00175*/
*       /* CODE TO 12                                        @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1706
*       IF TESTRC>0 THEN                                           1706
         LH    @08,TESTRC                                          1706
         LTR   @08,@08                                             1706
         BNP   @RF01706                                            1706
*         CC20=LASTCC12;            /*                       @YD00175*/
         LA    CC20,12                                             1707
*     END;                          /*                       @YD00175*/
@RF01706 DS    0H                                                  1709
*                                                                  1709
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS, PREPARE TO USE SOURCE VOLUME            @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1709
*   IF CC20<LASTCC12 THEN                                          1709
@RF01697 C     CC20,@CF00567                                       1709
         BNL   @RF01709                                            1709
*     DO;                           /*                       @YD00175*/
*                                                                  1710
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE THE UMSSUNIT MOUNT/DEMOUNT PARM LIST   #Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1711
*       MDUCBPTR=ADDR(SUCBADDR);    /*                       #Y30LB34*/
         LA    @08,MDAGLAR                                         1711
         LA    @15,SUCBADDR                                        1711
         ST    @15,MDUCBPTR(,@08)                                  1711
*       MDDDNAME=FFILEVAL;          /*                       #Y30LB34*/
         L     @15,@PC00001+4                                      1712
         L     @01,FDTPTR(,@15)                                    1712
         MVC   MDDDNAME(8,@08),FFILEVAL(@01)                       1712
*       MDLABEL=SVOLSER;            /*                       #Y30LB34*/
*                                                                  1713
         MVC   MDLABEL(6,@08),SVOLSER                              1713
*       /*************************************************************/
*       /*                                                           */
*       /* IF SOURCE AND TARGET VOLSERS ARE EQUAL,           #Y30LB34*/
*       /* INITIALIZE THE UMSSUNIT POST/CLEAR PARM LIST      #Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1714
*       IF SAMESER=ON THEN                                         1714
         TM    SAMESER,B'10000000'                                 1714
         BNO   @RF01714                                            1714
*         DO;                       /*                       #Y30LB34*/
*           PUUCBPTR=ADDR(TUCBADDR);/*                       #Y30LB34*/
         LA    @15,PUAGLAR                                         1716
         LA    @14,TUCBADDR                                        1716
         ST    @14,PUUCBPTR(,@15)                                  1716
*           PULABELP=ADDR(TLABEL);  /*                       #Y30LB34*/
         LA    @14,TLABEL                                          1717
         ST    @14,PULABELP(,@15)                                  1717
*           PUTTRPTR=ADDR(TVTOCTTR);/*                       #YM02856*/
         LA    @14,TVTOCTTR                                        1718
         ST    @14,PUTTRPTR(,@15)                                  1718
*           MDPUAGL=ADDR(PUAGLAR);  /*                       #Y30LB34*/
*                                                                  1719
         ST    @15,MDPUAGL(,@08)                                   1719
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UMSSUNIT TO MOUNT THE MSS SOURCE VOLUME #Y30LB34*/
*           /* IF THE VOLSERS ARE THE SAME. SET THE BIT ON   #Y30LB34*/
*           /* TO CLEAR THE TARGET UCB BEFORE MOUNT          @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1720
*           MDCLEAR=ON;             /*                       @Y30LB34*/
         OI    MDCLEAR(@08),B'01000000'                            1720
*           CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*             @Y30LB34*/
         L     @15,@PC00001                                        1721
         ST    @15,@AL00001                                        1721
         LA    @14,MOUNT                                           1721
         ST    @14,@AL00001+4                                      1721
         ST    @08,@AL00001+8                                      1721
         MVI   @AL00001+8,X'80'                                    1721
         L     @15,GDTUNT(,@15)                                    1721
         LA    @01,@AL00001                                        1721
         BALR  @14,@15                                             1721
*           RESPECIFY                                              1722
*             RTNREG RSTD;                                         1722
*           TESTRC=RTNREG;                                         1723
         STH   RTNREG,TESTRC                                       1723
*           RESPECIFY                                              1724
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           MDCLEAR=OFF;            /*                       @Y30LB34*/
         LA    @08,MDAGLAR                                         1725
         NI    MDCLEAR(@08),B'10111111'                            1725
*                                                                  1726
*           /*********************************************************/
*           /*                                                       */
*           /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE        @Y30LB34*/
*           /* CONDITION CODE TO 12 AND TERMINATE THE        @Y30LB34*/
*           /* COMMAND                                       @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1726
*           IF TESTRC>0 THEN                                       1726
         LH    @08,TESTRC                                          1726
         LTR   @08,@08                                             1726
         BNP   @RF01726                                            1726
*             CC20=LASTCC12;        /*                       @Y30LB34*/
         LA    CC20,12                                             1727
*         END;                      /*                       @Y30LB34*/
@RF01726 DS    0H                                                  1729
*     END;                          /*                       @Y30LB34*/
*                                                                  1729
@RF01714 DS    0H                                                  1730
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1730
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RF01709 L     REG14,RTNREG3                                       1730
*   RETURN CODE(CC20);              /*                       @Y30LB34*/
         LR    @15,CC20                                            1731
@EL00021 DS    0H                                                  1731
@EF00021 DS    0H                                                  1731
@ER00021 BR    @14                                                 1731
*   END VRGETSO;                    /*                       @Y30LB34*/
*                                                                  1733
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRINITTA                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - INTERROGATES THE TARGET VOLUME                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES THE VOLUME SERVICES PARM LIST     @Y30LB34*/
*/*            FOR RETRIEVING LABEL INFORMATION              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VOLUME SERVICES TO RETRIEVE THE OWNER   @Y30LB34*/
*/*            FROM THE LABEL                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS CHEKTARG TO CHECK THE TARGET VOLUME     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - TARGAREA, VS2AGL                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - INITIALIZED VS2AGL                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, RETURN CODE FROM CHEKTARG,         @Y30LB34*/
*/*                       UNABLE TO CLOSE VTOC               @Y30LB34*/
*/*           R. C. = 12, UNABLE TO RETRIEVE OWNER,          @Y30LB34*/
*/*                       RETURN CODE FROM VRGETTA OR        @Y30LB34*/
*/*                       CHEKTARG                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1733
*VRINITTA:                                                         1733
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1733
VRINITTA DS    0H                                                  1734
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1734
*   DCL                                                            1734
*     CC21 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1735
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1735
*   OLDERID2=NEWERID2;                                             1735
         L     @10,@PC00001                                        1735
         L     @15,GDTTR2(,@10)                                    1735
         MVC   @TS00001(95),NEWERID2(@15)                          1735
         MVC   OLDERID2(95,@15),@TS00001                           1735
*   NEWID2='CNTL';                  /*                       @Y30LB34*/
*                                                                  1736
         MVC   NEWID2(4,@15),@CC01828                              1736
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1737
*   CC21=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC21,CC21                                           1737
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  1738
         LR    RTNREG2,REG14                                       1738
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IDCVS02 TO RETRIEVE THE OWNER FROM THE     @Y30LB34*/
*   /* LABEL                                                 @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1739
*   VSUCBPTR=ADDR(TUCBADDR);        /*                       @Y30LB34*/
         LA    @15,VS2AGLAR                                        1739
         LA    @14,TUCBADDR                                        1739
         ST    @14,VSUCBPTR(,@15)                                  1739
*   VSDDNAME=TFILEVAL;              /*                       @Y30LB34*/
         L     @14,@PC00001+4                                      1740
         L     @01,FDTPTR+4(,@14)                                  1740
         MVC   VSDDNAME(8,@15),TFILEVAL(@01)                       1740
*   VSOWNPTR=ADDR(TOWNER);          /*                       @Y30LB34*/
         LA    @14,TOWNER                                          1741
         ST    @14,VSOWNPTR(,@15)                                  1741
*   VSOWNER=ON;                     /*                       @Y30LB34*/
         OI    VSOWNER(@15),B'10000000'                            1742
*   VSVOLUME=TVOLSER;               /*                       @Y30LB34*/
*                                                                  1743
         MVC   VSVOLUME(6,@15),TVOLSER                             1743
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VOLUME SERVICES TO RETRIEVE THE OWNER            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1744
*   CALL IDCSACL0(GDTTBL,'IDCVS02 ',GETLABEL,VS2AGL);/*      @Y30LB34*/
         ST    @10,@AL00001                                        1744
         LA    @14,@CC01768                                        1744
         ST    @14,@AL00001+4                                      1744
         LA    @14,GETLABEL                                        1744
         ST    @14,@AL00001+8                                      1744
         ST    @15,@AL00001+12                                     1744
         MVI   @AL00001+12,X'80'                                   1744
         L     @15,GDTCAL(,@10)                                    1744
         LA    @01,@AL00001                                        1744
         BALR  @14,@15                                             1744
*   RESPECIFY                                                      1745
*     RTNREG RSTD;                                                 1745
*   TESTRC=RTNREG;                                                 1746
         STH   RTNREG,TESTRC                                       1746
*   RESPECIFY                                                      1747
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1747
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERVICES IS UNSUCCESSFUL, SET CONDITION     @Y30LB34*/
*   /* CODE TO 12                                            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1748
*   IF TESTRC=4 THEN                                               1748
         LH    @10,TESTRC                                          1748
         C     @10,@CF00036                                        1748
         BNE   @RF01748                                            1748
*     CC21=LASTCC12;                /*                       @Y30LB34*/
*                                                                  1749
         LA    CC21,12                                             1749
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERVICES CANNOT CLOSE THE VTOC SET          @Y30LB34*/
*   /* CONDITION CODE TO 4                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1750
*   IF TESTRC=8 THEN                                               1750
@RF01748 CLC   TESTRC(2),@CH00177                                  1750
         BNE   @RF01750                                            1750
*     CC21=LASTCC04;                /*                       @Y30LB34*/
*                                                                  1751
         LA    CC21,4                                              1751
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR HAS OCCURRED, CHECK TARGET         @Y30LB34*/
*   /* VOLUME AND PREPARE FOR DATA CONVERSION.               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1752
*   IF CC21<LASTCC12 THEN                                          1752
@RF01750 C     CC21,@CF00567                                       1752
         BNL   @RF01752                                            1752
*     DO;                           /*                       @Y30LB34*/
*                                                                  1753
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CHEKTARG TO INITIALIZE THE VOLUME            @Y30LB34*/
*       /* SERVICES PARM LIST, PERFORM SECURITY CHECKING     @Y30LB34*/
*       /* AND RETRIEVE VTOC INFORMATION                     @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1754
*       CALL CHEKTARG;              /*                       @Y30LB34*/
         BAL   @14,CHEKTARG                                        1754
*       RESPECIFY                                                  1755
*         RTNREG RSTD;                                             1755
*       TESTRC=RTNREG;                                             1756
         STH   RTNREG,TESTRC                                       1756
*       RESPECIFY                                                  1757
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC21=MAX(CC21,TESTRC);      /*                       @Y30LB34*/
         LH    @10,TESTRC                                          1758
         CR    CC21,@10                                            1758
         BNL   *+6
         LR    CC21,@10                                            1758
*     END;                          /*                       @Y30LB34*/
*                                                                  1759
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1760
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RF01752 LR    REG14,RTNREG2                                       1760
*   RETURN CODE(CC21);              /*                       @Y30LB34*/
         LR    @15,CC21                                            1761
@EL00022 DS    0H                                                  1761
@EF00022 DS    0H                                                  1761
@ER00022 BR    @14                                                 1761
*   END VRINITTA;                   /*                       @Y30LB34*/
*                                                                  1763
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRMOVE                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - CONTROLS THE DATA CONVERSION PROCESS WHICH    @Y30LB34*/
*/*            CONSISTS OF THREE OPERATIONS:                 @Y30LB34*/
*/*                1)  COPY VOLUME,                          @Y30LB34*/
*/*                2)  UPDATE TARGET VOLUME VTOC,            @Y30LB34*/
*/*                3)  RECATALOG DATA SETS.  (THIS IS ONLY   @Y30LB34*/
*/*                    ESSENTIAL FOR VSAM VOLUMES.)          @Y30LB34*/
*/*                     IF ANY OF THESE OPERATIONS IS NOT    @Y30LB34*/
*/*                     COMPLETED, PRINTS MESSAGE IDC0737I   @Y30LB34*/
*/*                     TO NOTIFY TERMINATION OF PROCESSING  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VRMOVDAT TO COPY THE DATA FROM VIRTUAL  @Y30LB34*/
*/*            TO REAL                                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS UPDVTOC TO UPDATE THE VTOC              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS RECATCTL TO DETERMINE WHAT RECATALOGING @Y30LB34*/
*/*            IS TO BE DONE AND REQUESTS VSAM RECATALOGING  @Y30LB34*/
*/*            IF NECESSARY                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF NON-VSAM RECATALOGING IS TO BE DONE,       @Y30LB34*/
*/*            REQUESTS VOLUME SERVICES TO RECATALOG NON-    @Y30LB34*/
*/*            VSAM DATA SETS NOT ALREADY RECATALOGED        @Y30LB34*/
*/*                PRINTS MESSAGE IDC0748I NOTIFYING         @Y30LB34*/
*/*                NON-VSAM DATA SETS RECATALOGED            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES TARGET VOLUME RESERVED IN CHEKTARG   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - TARGAREA                                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  8, UNABLE TO RECATALOG NON-VSAM DATA  @Y30LB34*/
*/*                       SETS,                              @Y30LB34*/
*/*           R. C. = 12, RETURN CODE FROM VRMOVDAT,         @Y30LB34*/
*/*                       UPDVTOC, OR RECATCTL               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1763
*VRMOVE:                                                           1763
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1763
VRMOVE   DS    0H                                                  1764
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1764
*   DCL                                                            1764
*     CC22 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1765
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1765
*   OLDERID2=NEWERID2;                                             1765
         L     @10,@PC00001                                        1765
         L     @10,GDTTR2(,@10)                                    1765
         MVC   @TS00001(95),NEWERID2(@10)                          1765
         MVC   OLDERID2(95,@10),@TS00001                           1765
*   NEWID2='CNTM';                  /*                       @Y30LB34*/
*                                                                  1766
         MVC   NEWID2(4,@10),@CC01833                              1766
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1767
*   CC22=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC22,CC22                                           1767
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
         LR    RTNREG2,REG14                                       1768
*                                                                  1769
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VRMOVDAT TO COPY THE DATA FROM THE MSS VOLUME    @Y30LB34*/
*   /* TO THE REAL VOLUME                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1769
*   CALL VRMOVDAT;                  /*                       @Y30LB34*/
         BAL   @14,VRMOVDAT                                        1769
*   RESPECIFY                                                      1770
*     RTNREG RSTD;                                                 1770
*   TESTRC=RTNREG;                                                 1771
         STH   RTNREG,TESTRC                                       1771
*   RESPECIFY                                                      1772
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   CC22=TESTRC;                    /*                       @Y30LB34*/
*                                                                  1773
         LH    @15,TESTRC                                          1773
         LR    CC22,@15                                            1773
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR OCCURRED IN VRMOVDAT,              @Y30LB34*/
*   /* CALL UPDVTOC TO UPDATE THE TARGET VOLUME VTOC         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1774
*   IF CC22<LASTCC12 THEN                                          1774
         C     CC22,@CF00567                                       1774
         BNL   @RF01774                                            1774
*     DO;                           /*                       @Y30LB34*/
*       CALL UPDVTOC;               /*                       @Y30LB34*/
         BAL   @14,UPDVTOC                                         1776
*       RESPECIFY                                                  1777
*         RTNREG RSTD;                                             1777
*       TESTRC=RTNREG;                                             1778
         STH   RTNREG,TESTRC                                       1778
*       RESPECIFY                                                  1779
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC22=MAX(CC22,TESTRC);      /*                       @Y30LB34*/
         LH    @10,TESTRC                                          1780
         CR    CC22,@10                                            1780
         BNL   *+6
         LR    CC22,@10                                            1780
*     END;                          /*                       @Y30LB34*/
*                                                                  1781
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR HAS OCCURRED, CALL                 @Y30LB34*/
*   /* RECATCTL TO CONTROL THE RECATALOGING TO BE            @Y30LB34*/
*   /* DONE                                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1782
*   IF CC22<LASTCC12 THEN                                          1782
@RF01774 C     CC22,@CF00567                                       1782
         BNL   @RF01782                                            1782
*     DO;                           /*                       @Y30LB34*/
*       CALL RECATCTL;              /*                       @Y30LB34*/
         BAL   @14,RECATCTL                                        1784
*       RESPECIFY                                                  1785
*         RTNREG RSTD;                                             1785
*       TESTRC=RTNREG;                                             1786
         STH   RTNREG,TESTRC                                       1786
*       RESPECIFY                                                  1787
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       CC22=MAX(CC22,TESTRC);      /*                       @Y30LB34*/
         LH    @10,TESTRC                                          1788
         CR    CC22,@10                                            1788
         BNL   *+6
         LR    CC22,@10                                            1788
*     END;                          /*                       @Y30LB34*/
*                                                                  1790
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR HAS OCCURRED AND THE NON-          @Y30LB34*/
*   /* VSAM DATA SETS ARE TO BE RECATALOGED, CALL            @Y30LB34*/
*   /* VOLUME SERVICES TO HANDLE IT                          @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1790
*   IF CC22<LASTCC12&NONVSAM=ON THEN                               1790
@RF01782 C     CC22,@CF00567                                       1790
         BNL   @RF01790                                            1790
         TM    NONVSAM,B'00010000'                                 1790
         BNO   @RF01790                                            1790
*     DO;                           /*                       @Y30LB34*/
*       RESPECIFY                                                  1792
*         VS1AGL BASED(ADDR(TOVS1AGL));/*                    @Y30LB34*/
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',RECATLG,VS1AGL);/*   @YM02865*/
         L     @10,@PC00001                                        1793
         ST    @10,@AL00001                                        1793
         LA    @02,@CC01720                                        1793
         ST    @02,@AL00001+4                                      1793
         LA    @02,RECATLG                                         1793
         ST    @02,@AL00001+8                                      1793
         LA    @02,TOVS1AGL                                        1793
         ST    @02,@AL00001+12                                     1793
         MVI   @AL00001+12,X'80'                                   1793
         L     @15,GDTCAL(,@10)                                    1793
         LA    @01,@AL00001                                        1793
         BALR  @14,@15                                             1793
*       RESPECIFY                                                  1794
*         RTNREG RSTD;                                             1794
*       TESTRC=RTNREG;                                             1795
         STH   RTNREG,TESTRC                                       1795
*       RESPECIFY                                                  1796
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  1796
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERVICES WAS UNSUCCESSFUL, SET          @Y30LB34*/
*       /* CONDITION CODE TO 8.                              @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1797
*       IF TESTRC>0 THEN                                           1797
         LH    @10,TESTRC                                          1797
         LTR   @10,@10                                             1797
         BNP   @RF01797                                            1797
*         CC22=LASTCC08;            /*                       @Y30LB34*/
*                                                                  1798
         LA    CC22,8                                              1798
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERVICES WAS SUCCESSFUL, PRINT          @Y30LB34*/
*       /* MESSAGE IDC0748I NOTIFYING THE NON-VSAM DATA      @Y30LB34*/
*       /* SETS ARE RECATALOGED                              @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1799
*       ELSE                                                       1799
*         DO;                       /*                       @Y30LB34*/
         B     @RC01797                                            1799
@RF01797 DS    0H                                                  1800
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @10,DDSTRU                                          1800
         MVC   DARGSMOD(3,@10),@CC01557                            1800
*           DARGSENT=MSG0748I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@10),X'0C'                                 1801
*           DARGDBP=0;              /*                       @Y30LB34*/
         SLR   @02,@02                                             1802
         ST    @02,DARGDBP(,@10)                                   1802
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @02,DARGILP(,@10)                                   1803
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @02,DARGRETP(,@10)                                  1804
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @10,@PC00001                                        1805
         ST    @10,@AL00001                                        1805
         LA    @02,@CF00115                                        1805
         ST    @02,@AL00001+4                                      1805
         LA    @02,DDSTRU                                          1805
         ST    @02,@AL00001+8                                      1805
         MVI   @AL00001+8,X'80'                                    1805
         L     @15,GDTPRT(,@10)                                    1805
         LA    @01,@AL00001                                        1805
         BALR  @14,@15                                             1805
*         END;                      /*                       #Y30LB34*/
*                                                                  1806
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VTOC WAS OPENED BY VOLUME SERVICES         @ZM32896*/
*       /* CLOSE IT AND SET THE IOCSTR PTR TO 0.             @ZM32896*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1807
*       IF VSIOP^=NULLPTR THEN                                     1807
@RC01797 LA    @10,TOVS1AGL                                        1807
         L     @02,VSIOP(,@10)                                     1807
         LTR   @02,@02                                             1807
         BZ    @RF01807                                            1807
*         DO;                       /*                       @ZM32896*/
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @ZM32896*/
         L     @02,@PC00001                                        1809
         ST    @02,@AL00001                                        1809
         LA    @10,VSIOP(,@10)                                     1809
         ST    @10,@AL00001+4                                      1809
         MVI   @AL00001+4,X'80'                                    1809
         L     @15,GDTCLS(,@02)                                    1809
         LA    @01,@AL00001                                        1809
         BALR  @14,@15                                             1809
*           RESPECIFY                                              1810
*             RTNREG RSTD;                                         1810
*           TESTRC=RTNREG;                                         1811
         STH   RTNREG,TESTRC                                       1811
*           RESPECIFY                                              1812
*             RTNREG UNRSTD;        /*                       @ZM32896*/
*           CC22=MAX(CC22,TESTRC);  /*                       @ZM32896*/
         LH    @10,TESTRC                                          1813
         CR    CC22,@10                                            1813
         BNL   *+6
         LR    CC22,@10                                            1813
*           VSIOP=NULLPTR;          /*                       @ZM32896*/
         LA    @10,TOVS1AGL                                        1814
         SLR   @02,@02                                             1814
         ST    @02,VSIOP(,@10)                                     1814
*         END;                      /*                       @ZM32896*/
*     END;                          /*                       #Y30LB34*/
@RF01807 DS    0H                                                  1817
*                                                                  1817
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A SEVERE ERROR OCCURRED DURING THIS PROCEDURE      @Y30LB34*/
*   /* PRINT MESSAGE IDC0737I TO NOTIFY WHERE PROCESSING     @Y30LB34*/
*   /* TERMINATED                                            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1817
*   IF(CC22=LASTCC12) THEN                                         1817
@RF01790 C     CC22,@CF00567                                       1817
         BNE   @RF01817                                            1817
*     DO;                           /*                       @Y30LB34*/
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/
         L     @10,DDSTRU                                          1819
         MVC   DARGSMOD(3,@10),@CC01557                            1819
*       DARGSENT=MSG0737I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@10),X'02'                                 1820
*       DARGDBP=0;                  /*                       @Y30LB34*/
         SLR   @02,@02                                             1821
         ST    @02,DARGDBP(,@10)                                   1821
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @02,DARGILP(,@10)                                   1822
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @02,DARGRETP(,@10)                                  1823
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @10,@PC00001                                        1824
         ST    @10,@AL00001                                        1824
         LA    @02,@CF00115                                        1824
         ST    @02,@AL00001+4                                      1824
         LA    @02,DDSTRU                                          1824
         ST    @02,@AL00001+8                                      1824
         MVI   @AL00001+8,X'80'                                    1824
         L     @15,GDTPRT(,@10)                                    1824
         LA    @01,@AL00001                                        1824
         BALR  @14,@15                                             1824
*     END;                          /*                       @Y30LB34*/
*                                                                  1825
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TARGET VOLUME WAS RESERVED IN CHEKTARG,        @Y30LB34*/
*   /* RELEASE THAT RESERVE AND SET OFF THE TARGET RESERVE   @Y30LB34*/
*   /* BIT                                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1826
*   IF TRES=ON THEN                                                1826
@RF01817 TM    TRES,B'01000000'                                    1826
         BNO   @RF01826                                            1826
*     DO;                           /*                       @Y30LB34*/
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMERR);/*               @Y30LB34*/
         L     @10,@PC00001                                        1828
         ST    @10,@AL00001                                        1828
         LA    @02,@CC01594                                        1828
         ST    @02,@AL00001+4                                      1828
         LA    @02,RNAMERR                                         1828
         ST    @02,@AL00001+8                                      1828
         MVI   @AL00001+8,X'80'                                    1828
         L     @15,GDTDEQ(,@10)                                    1828
         LA    @01,@AL00001                                        1828
         BALR  @14,@15                                             1828
*       TRES=OFF;                   /*                       @Y30LB34*/
         NI    TRES,B'10111111'                                    1829
*     END;                          /*                       @Y30LB34*/
*                                                                  1830
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/
*   /* RETURN TO CALLER                                      #Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1831
*   REG14=RTNREG2;                  /*                       #Y30LB34*/
@RF01826 LR    REG14,RTNREG2                                       1831
*   RETURN CODE(CC22);              /*                       #Y30LB34*/
         LR    @15,CC22                                            1832
@EL00023 DS    0H                                                  1832
@EF00023 DS    0H                                                  1832
@ER00023 BR    @14                                                 1832
*   END VRMOVE;                     /*                       #Y30LB34*/
*                                                                  1834
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRMOVDAT                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - MOVES THE DATA FROM VIRTUAL TO REAL           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES ICBCOVC PARM LIST FOR CARTRIDGE   @Y30LB34*/
*/*            TO DASD                                       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            INITIALIZES IEZCOVCE PARM LIST FOR THE MSVC   @Y30LB34*/
*/*            EXTENSION TO ICBCOVC                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES USSC TO ISSUE ICBCOVC TO COPY THE DATA @Y30LB34*/
*/*                IF THE COPY COULD NOT START, ISSUES ERROR @Y30LB34*/
*/*                MESSAGE IDC3082I,                         @Y30LB34*/
*/*                IF THE COPY ENCOUNTERED AN ERROR AFTER IT @Y30LB34*/
*/*                PARTIALLY COMPLETED, ISSUES ERROR MESSAGE @Y30LB34*/
*/*                IDC3071I,                                 @Y30LB34*/
*/*                IF THE COPY WAS SUCCESSFUL, ISSUES        @Y30LB34*/
*/*                MESSAGE IDC0743I.                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*           POSTS THE NEW TTR OF THE VTOC IN THE UCB       @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT = ICBCOVC, IEZCOVCE, TARGAREA, SRCEAREA, PUAGL,    @Y30LB34*/
*/*         DARGLIST, UNITABL                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - ICBCOVC, IEZCOVCE                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. = 12, UNABLE TO CONVERT VOLUME,          @Y30LB34*/
*/*                       UNABLE TO POST REAL VOLUME UCB     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1834
*VRMOVDAT:                                                         1834
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1834
VRMOVDAT DS    0H                                                  1835
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1835
*   DCL                                                            1835
*     CC23 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1836
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1836
*   OLDERID2=NEWERID2;                                             1836
         L     @08,@PC00001                                        1836
         L     @15,GDTTR2(,@08)                                    1836
         MVC   @TS00001(95),NEWERID2(@15)                          1836
         MVC   OLDERID2(95,@15),@TS00001                           1836
*   NEWID2='CNTN';                  /*                       @Y30LB34*/
*                                                                  1837
         MVC   NEWID2(4,@15),@CC01841                              1837
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1838
*   CC23=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC23,CC23                                           1838
*   RTNREG3=REG14;                  /*                       @Y30LB34*/
*                                                                  1839
         ST    REG14,RTNREG3                                       1839
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE ICBCOVC PARM LIST                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1840
*   CVOCRDAS=ON;                    /*                       @Y30LB34*/
         L     @15,CVOLPTR                                         1840
         OI    CVOCRDAS(@15),B'01000000'                           1840
*   CVOLID=SVOLSER;                 /*                       @Y30LB34*/
         MVC   CVOLID(6,@15),SVOLSER                               1841
*   CVOLRUA=TUNITADR;               /*                       @Y30LB34*/
         LH    @14,TUNITADR                                        1842
         STH   @14,CVOLRUA(,@15)                                   1842
*                                                                  1843
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE USSC MACRO TO ISSUE ICBCOVC WHICH WILL      @Y30LB34*/
*   /* COPY THE DATA FROM THE MSS VOLUME TO THE REAL         @Y30LB34*/
*   /* VOLUME                                                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1843
*   CALL IDCSASS0(GDTTBL,COPYVOL,CVOLPTR,USSCREG0,USSCECB);/*      1843
*                                                            @Y30LB34*/
         ST    @08,@AL00001                                        1843
         LA    @15,COPYVOL                                         1843
         ST    @15,@AL00001+4                                      1843
         LA    @15,CVOLPTR                                         1843
         ST    @15,@AL00001+8                                      1843
         LA    @15,USSCREG0                                        1843
         ST    @15,@AL00001+12                                     1843
         LA    @15,USSCECB                                         1843
         ST    @15,@AL00001+16                                     1843
         MVI   @AL00001+16,X'80'                                   1843
         L     @15,GDTSSC(,@08)                                    1843
         LA    @01,@AL00001                                        1843
         BALR  @14,@15                                             1843
*   RESPECIFY                                                      1844
*     RTNREG RSTD;                                                 1844
*   TESTRC=RTNREG;                                                 1845
         STH   RTNREG,TESTRC                                       1845
*   RESPECIFY                                                      1846
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  1846
*   /*****************************************************************/
*   /*                                                               */
*   /* ANALYZE THE RETURN CODE FROM USSC                     @Y30LB34*/
*   /*                                                       @Y30LB34*/
*   /*                                                       @Y30LB34*/
*   /* IF IT WAS SUCCESSFUL PRINT MESSAGE IDC0743I           @Y30LB34*/
*   /* NOTIFYING A SUCCESSFUL COPY                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1847
*   IF TESTRC=0 THEN                                               1847
         LH    @08,TESTRC                                          1847
         SLR   @15,@15                                             1847
         CR    @08,@15                                             1847
         BNE   @RF01847                                            1847
*     DO;                           /*                       @Y30LB34*/
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1849
         MVC   DARGSMOD(3,@08),@CC01557                            1849
*       DARGSENT=MSG0743I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'07'                                 1850
*       DARGDBP=0;                  /*                       @Y30LB34*/
         ST    @15,DARGDBP(,@08)                                   1851
*       DARGILP=0;                  /*                       @Y30LB34*/
         STH   @15,DARGILP(,@08)                                   1852
*       DARGRETP=0;                 /*                       @Y30LB34*/
         ST    @15,DARGRETP(,@08)                                  1853
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @08,@PC00001                                        1854
         ST    @08,@AL00001                                        1854
         LA    @15,@CF00115                                        1854
         ST    @15,@AL00001+4                                      1854
         LA    @15,DDSTRU                                          1854
         ST    @15,@AL00001+8                                      1854
         MVI   @AL00001+8,X'80'                                    1854
         L     @15,GDTPRT(,@08)                                    1854
         LA    @01,@AL00001                                        1854
         BALR  @14,@15                                             1854
*     END;                          /*                       @Y30LB34*/
*                                                                  1855
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IT WAS NOT SUCCESSFUL DETERMINE TYPE OF ERROR      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1856
*   ELSE                                                           1856
*     DO;                           /*                       @Y30LB34*/
*                                                                  1856
         B     @RC01847                                            1856
@RF01847 DS    0H                                                  1857
*       /*************************************************************/
*       /*                                                           */
*       /* SET CONDITION CODE TO 12                          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1857
*       CC23=LASTCC12;              /*                       @Y30LB34*/
         LA    CC23,12                                             1857
*                                                                  1858
*       /*************************************************************/
*       /*                                                           */
*       /* IF USSC FAILED PRINT ERROR MESSAGES               @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1858
*       IF TESTRC=4 THEN                                           1858
         CLC   TESTRC(2),@CH00036                                  1858
         BNE   @RF01858                                            1858
*         DO;                       /*                       @Y30LB34*/
*                                                                  1859
*           /*********************************************************/
*           /*                                                       */
*           /* CALL SSCMSG TO PRINT USSC ERROR MESSAGE       @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1860
*           CALL SSCMSG(USSCREG0,USSCECB);/*                 @Y30LB34*/
*                                                                  1860
         LA    @08,USSCREG0                                        1860
         ST    @08,@AL00001                                        1860
         LA    @08,USSCECB                                         1860
         ST    @08,@AL00001+4                                      1860
         LA    @01,@AL00001                                        1860
         BAL   @14,SSCMSG                                          1860
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE REASON CODE IS NOT ZERO SIGNIFYING     @Y30LB34*/
*           /* THE COPY WAS NOT STARTED ISSUE MESSAGE        @Y30LB34*/
*           /* IDC3082I.                                     @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1861
*           IF USSCREG0^=0 THEN                                    1861
         L     @08,USSCREG0                                        1861
         LTR   @08,@08                                             1861
         BZ    @RF01861                                            1861
*             DO;                   /*                       @Y30LB34*/
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1863
         MVC   DARGSMOD(3,@08),@CC01555                            1863
*               DARGSENT=MSG3082I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'18'                                 1864
*             END;                  /*                       @Y30LB34*/
*                                                                  1865
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE REASON CODE IS ZERO SIGNIFYING THE     @Y30LB34*/
*           /* COPY WAS STARTED BUT DID NOT COMPLETE,        @Y30LB34*/
*           /* ISSUE ERROR MESSAGE IDC3071I.                 @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1866
*           ELSE                                                   1866
*             DO;                   /*                       @Y30LB34*/
         B     @RC01861                                            1866
@RF01861 DS    0H                                                  1867
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1867
         MVC   DARGSMOD(3,@08),@CC01555                            1867
*               DARGSENT=MSG3071I;  /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'23'                                 1868
*             END;                  /*                       @Y30LB34*/
*           DARGDBP=0;              /*                       @Y30LB34*/
@RC01861 SLR   @08,@08                                             1870
         L     @15,DDSTRU                                          1870
         ST    @08,DARGDBP(,@15)                                   1870
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @08,DARGILP(,@15)                                   1871
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @08,DARGRETP(,@15)                                  1872
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        1873
         ST    @08,@AL00001                                        1873
         LA    @15,@CF00115                                        1873
         ST    @15,@AL00001+4                                      1873
         LA    @15,DDSTRU                                          1873
         ST    @15,@AL00001+8                                      1873
         MVI   @AL00001+8,X'80'                                    1873
         L     @15,GDTPRT(,@08)                                    1873
         LA    @01,@AL00001                                        1873
         BALR  @14,@15                                             1873
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
@RF01858 DS    0H                                                  1876
*                                                                  1876
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR HAS OCCURRED COPYING THE VOLUME,   @Y30LB34*/
*   /* PREPARE TARGET VOLUME FOR VTOC UPDATING               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1876
*   IF CC23<LASTCC12 THEN                                          1876
@RC01847 C     CC23,@CF00567                                       1876
         BNL   @RF01876                                            1876
*     DO;                           /*                       @Y30LB34*/
*                                                                  1877
*       /*************************************************************/
*       /*                                                           */
*       /* SINCE THE TARGET VOLUME VTOC MAY HAVE BEEN        @Y30LB34*/
*       /* RELOCATED, POST THE UCB WITH THE SOURCE VTOC TTR  @Y30LB34*/
*       /* THAT WAS RETRIEVED AND SAVED IN VRGETSO           @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1878
*       PUUCBPTR=ADDR(TUCBADDR);    /*                       @YM02880*/
         LA    @08,PUAGLAR                                         1878
         LA    @15,TUCBADDR                                        1878
         ST    @15,PUUCBPTR(,@08)                                  1878
*       PUTTRPTR=ADDR(SVTOCTTR);    /*                       @Y30LB34*/
         LA    @15,SVTOCTTR                                        1879
         ST    @15,PUTTRPTR(,@08)                                  1879
*       PULABELP=ADDR(TLABEL);      /*                       @Y30LB34*/
         LA    @15,TLABEL                                          1880
         ST    @15,PULABELP(,@08)                                  1880
*       CALL IDCSA060(GDTTBL,POSTUCB,PUAGL);/*               @Y30LB34*/
         L     @15,@PC00001                                        1881
         ST    @15,@AL00001                                        1881
         LA    @14,POSTUCB                                         1881
         ST    @14,@AL00001+4                                      1881
         ST    @08,@AL00001+8                                      1881
         MVI   @AL00001+8,X'80'                                    1881
         L     @15,GDTUNT(,@15)                                    1881
         LA    @01,@AL00001                                        1881
         BALR  @14,@15                                             1881
*       RESPECIFY                                                  1882
*         RTNREG RSTD;                                             1882
*       TESTRC=RTNREG;                                             1883
         STH   RTNREG,TESTRC                                       1883
*       RESPECIFY                                                  1884
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*                                                                  1884
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE POST IS UNSUCCESSFUL, SET THE CONDITION    @Y30LB34*/
*       /* CODE TO 12                                        @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1885
*       IF TESTRC>0 THEN                                           1885
         LH    @08,TESTRC                                          1885
         LTR   @08,@08                                             1885
         BNP   @RF01885                                            1885
*         CC23=LASTCC12;            /*                       @Y30LB34*/
         LA    CC23,12                                             1886
*     END;                          /*                       @Y30LB34*/
*                                                                  1887
@RF01885 DS    0H                                                  1888
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1888
*   REG14=RTNREG3;                  /*                       @Y30LB34*/
@RF01876 L     REG14,RTNREG3                                       1888
*   RETURN CODE(CC23);              /*                       @Y30LB34*/
         LR    @15,CC23                                            1889
@EL00024 DS    0H                                                  1889
@EF00024 DS    0H                                                  1889
@ER00024 BR    @14                                                 1889
*   END VRMOVDAT;                   /*                       @Y30LB34*/
*                                                                  1891
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - VRSCRV                                  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - MOUNTS THE SOURCE VOLUME IF THE SOURCE AND    @Y30LB34*/
*/*            TARGET SERIAL NUMBERS ARE THE SAME            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CALLS VOLUME SERVICES TO SCRATCH THE VTOC ON  @Y30LB34*/
*/*            THEN SOURCE VOLUME                            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            CLOSES THE VTOC                               @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS MESSAGE IDC0749I IF THE VTOC IS        @Y30LB34*/
*/*            SCRATCHED                                     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEQUEUES THE SOURCE VOLUME RESERVE            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            DEMOUNTS THE SOURCE VOLUME IF THE SOURCE AND  @Y30LB34*/
*/*            TARGET SERIAL NUMBERS ARE THE SAME            @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - FRVS1AGL, DARGLIST, MDAGL, PUAGL                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/
*/*           R. C. =  8, UNABLE TO SCRATCH VTOC,            @Y30LB34*/
*/*                       UNABLE TO MOUNT VOLUME,            @Y30LB34*/
*/*                       UNABLE TO DEMOUNT VOLUME           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  1891
*VRSCRV:                                                           1891
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/
*                                                                  1891
VRSCRV   DS    0H                                                  1892
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1892
*   DCL                                                            1892
*     CC24 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34
*                                      CODE SAVE AREA        @Y30LB34*/
*                                                                  1893
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1893
*   OLDERID2=NEWERID2;                                             1893
         L     @08,@PC00001                                        1893
         L     @02,GDTTR2(,@08)                                    1893
         MVC   @TS00001(95),NEWERID2(@02)                          1893
         MVC   OLDERID2(95,@02),@TS00001                           1893
*   NEWID2='CNTO';                  /*                       @Y30LB34*/
*                                                                  1894
         MVC   NEWID2(4,@02),@CC01846                              1894
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1895
*   CC24=LASTCC00;                  /*                       @Y30LB34*/
         SLR   CC24,CC24                                           1895
*   RTNREG2=REG14;                  /*                       @Y30LB34*/
*                                                                  1896
         LR    RTNREG2,REG14                                       1896
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT TO MOUNT THE MSS SOURCE VOLUME         @Y30LB34*/
*   /* IF THE VOLSERS ARE THE SAME. SET THE BIT ON TO        @Y30LB34*/
*   /* CLEAR THE TARGET UCB BEFORE MOUNT                     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1897
*   IF SAMESER=ON THEN                                             1897
         TM    SAMESER,B'10000000'                                 1897
         BNO   @RF01897                                            1897
*     DO;                           /*                       @Y30LB34*/
*       MDCLEAR=ON;                 /*                       @Y30LB34*/
         LA    @02,MDAGLAR                                         1899
         OI    MDCLEAR(@02),B'01000000'                            1899
*       CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                 @Y30LB34*/
         ST    @08,@AL00001                                        1900
         LA    @15,MOUNT                                           1900
         ST    @15,@AL00001+4                                      1900
         ST    @02,@AL00001+8                                      1900
         MVI   @AL00001+8,X'80'                                    1900
         L     @15,GDTUNT(,@08)                                    1900
         LA    @01,@AL00001                                        1900
         BALR  @14,@15                                             1900
*       RESPECIFY                                                  1901
*         RTNREG RSTD;                                             1901
*       TESTRC=RTNREG;                                             1902
         STH   RTNREG,TESTRC                                       1902
*       RESPECIFY                                                  1903
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       MDCLEAR=OFF;                /*                       @Y30LB34*/
*                                                                  1904
         LA    @08,MDAGLAR                                         1904
         NI    MDCLEAR(@08),B'10111111'                            1904
*       /*************************************************************/
*       /*                                                           */
*       /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE CONDITION  @Y30LB34*/
*       /* CODE TO 8                                         @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1905
*       IF TESTRC>0 THEN                                           1905
         LH    @08,TESTRC                                          1905
         LTR   @08,@08                                             1905
         BNP   @RF01905                                            1905
*         CC24=LASTCC08;            /*                       @Y30LB34*/
         LA    CC24,8                                              1906
*     END;                          /*                       @Y30LB34*/
@RF01905 DS    0H                                                  1908
*                                                                  1908
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SEVERE ERROR OCCURRED MOUNTING THE VOLUME       @Y30LB34*/
*   /* PROCEED WITH COMPLETION PROCESSING OF THE SOURCE      @Y30LB34*/
*   /* VOLUME                                                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1908
*   IF CC24<LASTCC08 THEN                                          1908
@RF01897 C     CC24,@CF00177                                       1908
         BNL   @RF01908                                            1908
*     DO;                           /*                       @Y30LB34*/
*                                                                  1909
*       /*************************************************************/
*       /*                                                           */
*       /* CALL VOLUME SERVICES TO SCRATCH THE SOURCE VOLUME @Y30LB34*/
*       /* VTOC                                              @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1910
*       RESPECIFY                                                  1910
*         VS1AGL BASED(ADDR(FRVS1AGL));/*                    @Y30LB34*/
*                                                                  1910
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE REQUEST IS VIRTUAL TO REAL, RESERVE TO VOLUME.     */
*       /*                                                   @ZA08840*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1911
*       IF CONVTYPE=VR THEN         /*                       @ZA08840*/
         TM    CONVTYPE,B'01000000'                                1911
         BNZ   @RF01911                                            1911
*         VSRES=ON;                 /*                       @Y30LB34*/
         LA    @08,FRVS1AGL                                        1912
         OI    VSRES(@08),B'10000000'                              1912
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',SCRVTOC,VS1AGL);/*   @Y30LB34*/
@RF01911 L     @08,@PC00001                                        1913
         ST    @08,@AL00001                                        1913
         LA    @02,@CC01720                                        1913
         ST    @02,@AL00001+4                                      1913
         LA    @02,SCRVTOC                                         1913
         ST    @02,@AL00001+8                                      1913
         LA    @02,FRVS1AGL                                        1913
         ST    @02,@AL00001+12                                     1913
         MVI   @AL00001+12,X'80'                                   1913
         L     @15,GDTCAL(,@08)                                    1913
         LA    @01,@AL00001                                        1913
         BALR  @14,@15                                             1913
*       RESPECIFY                                                  1914
*         RTNREG RSTD;                                             1914
*       TESTRC=RTNREG;                                             1915
         STH   RTNREG,TESTRC                                       1915
*       RESPECIFY                                                  1916
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       VSRES=OFF;                  /*                       @Y30LB34*/
*                                                                  1917
         LA    @08,FRVS1AGL                                        1917
         NI    VSRES(@08),B'01111111'                              1917
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERVICES WAS UNABLE TO SCRATCH THE VTOC @Y30LB34*/
*       /* SET CONDITION CODE TO 8                           @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1918
*       IF TESTRC>0 THEN                                           1918
         LH    @08,TESTRC                                          1918
         LTR   @08,@08                                             1918
         BNP   @RF01918                                            1918
*         CC24=LASTCC08;            /*                       @Y30LB34*/
         LA    CC24,8                                              1919
*                                                                  1920
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERVICES OPENED THE VTOC, CLOSE IT      @Y30LB34*/
*       /* AND SET THE IOCSTR POINTER TO 0                   @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1920
*       IF VSIOP^=NULLPTR THEN                                     1920
@RF01918 LA    @08,FRVS1AGL                                        1920
         L     @02,VSIOP(,@08)                                     1920
         LTR   @02,@02                                             1920
         BZ    @RF01920                                            1920
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB34*/
         L     @02,@PC00001                                        1922
         ST    @02,@AL00001                                        1922
         LA    @08,VSIOP(,@08)                                     1922
         ST    @08,@AL00001+4                                      1922
         MVI   @AL00001+4,X'80'                                    1922
         L     @15,GDTCLS(,@02)                                    1922
         LA    @01,@AL00001                                        1922
         BALR  @14,@15                                             1922
*           RESPECIFY                                              1923
*             RTNREG RSTD;                                         1923
*           TESTRC=RTNREG;                                         1924
         STH   RTNREG,TESTRC                                       1924
*           RESPECIFY                                              1925
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           CC24=MAX(CC24,TESTRC);  /*                       @Y30LB34*/
         LH    @08,TESTRC                                          1926
         CR    CC24,@08                                            1926
         BNL   *+6
         LR    CC24,@08                                            1926
*           VSIOP=NULLPTR;          /*                       @Y30LB34*/
         LA    @08,FRVS1AGL                                        1927
         SLR   @02,@02                                             1927
         ST    @02,VSIOP(,@08)                                     1927
*         END;                      /*                       @Y30LB34*/
*                                                                  1928
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VTOC WAS SCRATCHED, PRINT MESSAGE IDC0749I @Y30LB34*/
*       /* NOTIFYING THE USER                                @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1929
*       IF CC24<LASTCC08 THEN                                      1929
@RF01920 C     CC24,@CF00177                                       1929
         BNL   @RF01929                                            1929
*         DO;                       /*                       @Y30LB34*/
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/
         L     @08,DDSTRU                                          1931
         MVC   DARGSMOD(3,@08),@CC01557                            1931
*           DARGSENT=MSG0749I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@08),X'0D'                                 1932
*           DARGDBP=0;              /*                       @Y30LB34*/
         SLR   @02,@02                                             1933
         ST    @02,DARGDBP(,@08)                                   1933
*           DARGILP=0;              /*                       @Y30LB34*/
         STH   @02,DARGILP(,@08)                                   1934
*           DARGRETP=0;             /*                       @Y30LB34*/
         ST    @02,DARGRETP(,@08)                                  1935
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @08,@PC00001                                        1936
         ST    @08,@AL00001                                        1936
         LA    @02,@CF00115                                        1936
         ST    @02,@AL00001+4                                      1936
         LA    @02,DDSTRU                                          1936
         ST    @02,@AL00001+8                                      1936
         MVI   @AL00001+8,X'80'                                    1936
         L     @15,GDTPRT(,@08)                                    1936
         LA    @01,@AL00001                                        1936
         BALR  @14,@15                                             1936
*         END;                      /*                       @Y30LB34*/
*                                                                  1937
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE SOURCE VOLUME WAS RESERVED ABOVE, RELEASE  @Y30LB34*/
*       /* THAT RESERVE AND SET OFF THE SOURCE RESERVE BIT   @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1938
*       IF SRES=ON THEN                                            1938
@RF01929 TM    SRES,B'01000000'                                    1938
         BNO   @RF01938                                            1938
*         DO;                       /*                       @Y30LB34*/
*           CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*           @Y30LB34*/
         L     @08,@PC00001                                        1940
         ST    @08,@AL00001                                        1940
         LA    @02,@CC01594                                        1940
         ST    @02,@AL00001+4                                      1940
         LA    @02,RNAMEVR                                         1940
         ST    @02,@AL00001+8                                      1940
         MVI   @AL00001+8,X'80'                                    1940
         L     @15,GDTDEQ(,@08)                                    1940
         LA    @01,@AL00001                                        1940
         BALR  @14,@15                                             1940
*           SRES=OFF;               /*                       @Y30LB34*/
         NI    SRES,B'10111111'                                    1941
*         END;                      /*                       @Y30LB34*/
*                                                                  1943
*       /*************************************************************/
*       /*                                                           */
*       /* DEMOUNT THE SOURCE VOLUME IF SOURCE AND TARGET    @ZM34313*/
*       /* VOLSERS ARE THE SAME. SET THE BIT ON TO POST THE  @Y30LB34*/
*       /* TARGET UCB AFTER DEMOUNT. (DELAYED RESPONSE)      @ZM34313*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1943
*       IF SAMESER=ON THEN                                         1943
@RF01938 TM    SAMESER,B'10000000'                                 1943
         BNO   @RF01943                                            1943
*         DO;                       /*                       @Y30LB34*/
*           MDPOST=ON;              /*                       @Y30LB34*/
*           MDWAIT=ON;              /*                       @ZM34313*/
         LA    @08,MDAGLAR                                         1946
         OI    MDPOST(@08),B'00110000'                             1946
*           CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*           @Y30LB34*/
         L     @02,@PC00001                                        1947
         ST    @02,@AL00001                                        1947
         LA    @15,DEMOUNT                                         1947
         ST    @15,@AL00001+4                                      1947
         ST    @08,@AL00001+8                                      1947
         MVI   @AL00001+8,X'80'                                    1947
         L     @15,GDTUNT(,@02)                                    1947
         LA    @01,@AL00001                                        1947
         BALR  @14,@15                                             1947
*           RESPECIFY                                              1948
*             RTNREG RSTD;                                         1948
*           TESTRC=RTNREG;                                         1949
         STH   RTNREG,TESTRC                                       1949
*           RESPECIFY                                              1950
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           MDPOST=OFF;             /*                       @Y30LB34*/
*                                                                  1951
         LA    @08,MDAGLAR                                         1951
         NI    MDPOST(@08),B'11011111'                             1951
*           /*********************************************************/
*           /*                                                       */
*           /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE        @Y30LB34*/
*           /* CONDITION CODE TO 8                           @Y30LB34*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1952
*           IF TESTRC>0 THEN                                       1952
         LH    @08,TESTRC                                          1952
         LTR   @08,@08                                             1952
         BNP   @RF01952                                            1952
*             CC24=LASTCC08;        /*                       @Y30LB34*/
         LA    CC24,8                                              1953
*         END;                      /*                       @Y30LB34*/
@RF01952 DS    0H                                                  1955
*     END;                          /*                       @Y30LB34*/
*                                                                  1955
@RF01943 DS    0H                                                  1956
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1956
*   REG14=RTNREG2;                  /*                       @Y30LB34*/
@RF01908 LR    REG14,RTNREG2                                       1956
*   RETURN CODE(CC24);              /*                       @Y30LB34*/
         LR    @15,CC24                                            1957
@EL00025 DS    0H                                                  1957
@EF00025 DS    0H                                                  1957
@ER00025 BR    @14                                                 1957
*   END VRSCRV;                     /*                       @Y30LB34*/
*                                                                  1959
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1959
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1959
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00026                                    1959
         MVC   @PC00026(8),0(@01)                                  1959
*                                   /*                       @Y30LB39*/
*                                                                  1960
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1960
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1960
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1960
*                                   /*                       @Y30LB39*/
*   DCL                                                            1960
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1961
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1961
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1962
*                                   /*                       @Y30LB39*/
*   DCL                                                            1962
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1963
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1963
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1964
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1964
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1964
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1965
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1965
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1965
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1966
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1966
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1966
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1967
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1967
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1967
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1968
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1968
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1969
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1969
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1969
         L     @07,@PC00001                                        1969
         L     @02,GDTTR2(,@07)                                    1969
         MVC   @TS00001(95),NEWERID2(@02)                          1969
         MVC   OLDERID2(95,@02),@TS00001                           1969
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1970
         MVC   NEWID2(4,@02),@CC01869                              1970
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1971
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1971
         LA    @02,SSDRGLT                                         1971
         ST    @02,SSDLPTR                                         1971
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1972
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1972
         L     @15,@PC00026                                        1972
         L     @15,SSRCODE(,@15)                                   1972
         LTR   @15,@15                                             1972
         BNP   @RF01972                                            1972
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1973
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1974
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1974
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @09,SSINXLST                                        1975
         ST    @09,DARGRETP(,@02)                                  1975
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@02),SSMODSS0                            1976
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@02),X'01'                                 1977
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1978
         MVC   DARGRETL(2,@02),@CH01877                            1978
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1979
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1979
         ST    @07,@AL00001                                        1979
         LA    @09,@CF00115                                        1979
         ST    @09,@AL00001+4                                      1979
         LA    @09,SSDLPTR                                         1979
         ST    @09,@AL00001+8                                      1979
         MVI   @AL00001+8,X'80'                                    1979
         L     @15,GDTPRT(,@07)                                    1979
         LA    @01,@AL00001                                        1979
         BALR  @14,@15                                             1979
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1980
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1980
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   1981
@DL01981 DS    0H                                                  1982
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00217                                   1982
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1983
@DE01981 L     @09,@PC00026                                        1983
         LR    @07,ENTRYNUM                                        1983
         ALR   @07,@07                                             1983
         LH    @07,SSARRAY-2(@07)                                  1983
         CH    @07,SSRHALF(,@09)                                   1983
         BE    @DC01981                                            1983
         SLR   @02,@02                                             1983
         CR    @07,@02                                             1983
         BNE   @DL01981                                            1983
@DC01981 DS    0H                                                  1984
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1984
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1984
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         1985
         MVC   DARGSMOD(3,@15),SSMODSS0                            1985
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@15)                             1986
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @07,@02                                             1987
         BNE   @RF01987                                            1987
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @09,DARGDBP(,@15)                                   1989
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00036                             1990
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1993
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1993
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01972                                            1993
@RF01972 DS    0H                                                  1994
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1994
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @07,SSDLPTR                                         1995
         MVC   DARGSMOD(3,@07),SSMODCM0                            1995
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@07),SSMSGNUM                            1996
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @02,@PC00026+4                                      1997
         ST    @02,DARGDBP(,@07)                                   1997
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@07),@CH00217                             1998
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1999
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2000
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2000
@RC01972 L     @07,@PC00001                                        2000
         ST    @07,@AL00001                                        2000
         LA    @02,@CF00115                                        2000
         ST    @02,@AL00001+4                                      2000
         LA    @02,SSDLPTR                                         2000
         ST    @02,@AL00001+8                                      2000
         MVI   @AL00001+8,X'80'                                    2000
         L     @15,GDTPRT(,@07)                                    2000
         LA    @01,@AL00001                                        2000
         BALR  @14,@15                                             2000
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2001
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             2001
         L     @14,@SA00026                                        2001
         LM    @00,@12,@SA00026+8                                  2001
         BR    @14                                                 2001
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCCN01                     /*                       @Y30LB34*/
*                                                                  2003
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSCN )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  2003
*       ;                                                          2003
@DATA    DS    0H
@CH00153 DC    H'2'
@CH00608 DC    H'44'
@CH01872 DC    H'54'
@CH01877 DC    H'120'
@CH01875 DC    H'224'
         DS    0F
@AL00808 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01528 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01594)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00026 DS    15F
@PC00026 DS    2F
@AL00001 DS    5A
IDCCN01  CSECT
         DS    0F
@CF00115 DC    F'0'
@CF00217 DC    F'1'
@CH00217 EQU   @CF00217+2
@CF00036 DC    F'4'
@CH00036 EQU   @CF00036+2
@CF00038 DC    F'6'
@CH00038 EQU   @CF00038+2
@CF00177 DC    F'8'
@CH00177 EQU   @CF00177+2
@CF00567 DC    F'12'
@CH00567 EQU   @CF00567+2
@CF01899 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RVVIPTR  DS    A
BASEVPTR DS    A
MVRPTR   DS    A
CTGPLPTR DS    A
CVOLPTR  DS    A
COVCEPTR DS    A
USSCREG0 DS    F
UNITABLP DS    A
INFOPTR  DS    A
RTNREG1  DS    A
RTNREG3  DS    A
RTNREG4  DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
TESTRC   DS    H
CC04     DS    H
CC15     DS    H
CC16     DS    H
CC18     DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
PRINTTAB DS    CL44
USSCECB  DS    CL1
RNAMERE  DS    CL20
         ORG   RNAMERE
RENQLEN  DS    FL1
RENQNAM  DS    CL19
         ORG   RENQNAM
REVOLSER DS    CL6
RENQ     DS    CL13
         ORG   RNAMERE+20
RNAMERR  DS    CL20
         ORG   RNAMERR
RRESLEN  DS    FL1
RRESNAM  DS    CL19
         ORG   RRESNAM
RRVOLSER DS    CL6
RRES     DS    CL13
         ORG   RNAMERR+20
RNAMEVE  DS    CL23
         ORG   RNAMEVE
VENQLEN  DS    FL1
VENQNAM  DS    CL22
         ORG   VENQNAM
VEVOLSER DS    CL6
VENQ     DS    CL16
         ORG   RNAMEVE+23
RNAMEVR  DS    CL23
         ORG   RNAMEVR
VRESLEN  DS    FL1
VRESNAM  DS    CL22
         ORG   VRESNAM
VRVOLSER DS    CL6
VRES     DS    CL16
         ORG   RNAMEVR+23
         DS    CL1
UNITABLA DS    CL11
IOINFAR  DS    CL1
INFOAREA DS    CL54
         ORG   INFOAREA
AREALEN  DS    CL2
DATALEN  DS    CL2
VOLLIST  DS    CL2
         ORG   VOLLIST
DEVLST   DS    CL2
         ORG   INFOAREA+6
VOLLEN   DS    FL2
FIRVOL   DS    CL6
         ORG   FIRVOL
DEVONLY  DS    CL4
         ORG   INFOAREA+14
DEVLIST  DS    CL2
DEVLEN   DS    FL2
DEVICE   DS    CL4
DEVBLK   DS    CL4
DEVTRK   DS    CL4
SPACE    DS    CL24
         ORG   INFOAREA+54
         DS    CL2
VS1ARGS  DS    CL150
         ORG   VS1ARGS
FRVS1AGL DS    CL74
         DS    CL2
TOVS1AGL DS    CL74
         ORG   VS1ARGS+150
         DS    CL2
VS2AGLAR DS    CL52
OPNAREA  DS    BL48
MDAGLAR  DS    CL37
         DS    CL3
PUAGLAR  DS    CL20
CKAGLAR  DS    CL29
         DS    CL3
EXCLAR   DS    CL23
         DS    CL1
CVOLAR   DS    CL40
RVVIAREA DS    CL68
BASEVAR  DS    CL224
MVRAREA  DS    CL88
COVCEAR  DS    CL43
CNVOLAR  DS    CL44
         DS    CL1
SRCEAREA DS    CL39
         ORG   SRCEAREA
SLABEL   DS    CL6
SVOLSER  DS    CL6
SDEVTYPE DS    CL4
SUCBADDR DS    AL4
SVTOCTTR DS    CL4
STYPEVOL DS    CL4
SUNITADR DS    FL2
SCATDD   DS    CL8
SRCEBITS DS    CL1
         ORG   SRCEBITS
SENQ     DS    BL1
SRES     EQU   SRCEBITS+0
SVSAM    EQU   SRCEBITS+0
@NM00122 EQU   SRCEBITS+0
         ORG   SRCEAREA+39
         DS    CL1
TARGAREA DS    CL49
         ORG   TARGAREA
TLABEL   DS    CL6
TVOLCNT  DS    CL7
         ORG   TVOLCNT
TCOUNT   DS    FL1
TVOLSER  DS    CL6
         ORG   TARGAREA+13
@NM00123 DS    CL1
TUNITADR DS    FL2
TDEVTYPE DS    CL4
TUCBADDR DS    AL4
TVTOCTTR DS    CL4
TTYPEVOL DS    CL4
TOWNER   DS    CL10
TNUMAT   DS    CL2
TNXTAT   DS    CL4
TARGBITS DS    CL1
         ORG   TARGBITS
TENQ     DS    BL1
TRES     EQU   TARGBITS+0
NOVTOCCK EQU   TARGBITS+0
@NM00124 EQU   TARGBITS+0
         ORG   TARGAREA+49
         DS    CL3
SWITCHES DS    CL1
         ORG   SWITCHES
SAMESER  DS    BL1
CONVTYPE EQU   SWITCHES+0
VSAM     EQU   SWITCHES+0
NONVSAM  EQU   SWITCHES+0
MSGSW    EQU   SWITCHES+0
@NM00125 EQU   SWITCHES+0
         ORG   SWITCHES+1
         DS    CL3
CTGPLAR  DS    CL32
CTGFLAR1 DS    CL24
CTGFLAR2 DS    CL24
CTGFLAR3 DS    CL24
SSDRGLT  DS    CL20
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCCN01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
MVRLEN   DC    AL2(88)
COVLEN   DC    AL2(43)
SSMSGNUM DC    AL1(56)
@CC01599 DC    C'.VIRTUAL.ENQUEUE'
@CC01605 DC    C'.VIRTUAL.RESERVE'
@CC01596 DC    C'.REAL.ENQUEUE'
@CC01602 DC    C'.REAL.RESERVE'
@CC01594 DC    C'SYSZAMS '
@CC01720 DC    C'IDCVS01 '
@CC01721 DC    C'JOBCAT  '
@CC01722 DC    C'STEPCAT '
@CC01768 DC    C'IDCVS02 '
@CC01652 DC    C'CNST'
@CC01667 DC    C'CNBG'
@CC01671 DC    C'CNND'
@CC01676 DC    C'CNT1'
@CC01679 DC    C'REAL'
@CC01680 DC    C'VIRT'
@CC01685 DC    C'CNT2'
@CC01691 DC    C'CNT3'
@CC01696 DC    C'CNT4'
@CC01705 DC    C'CNT5'
@CC01712 DC    C'CNT6'
@CC01717 DC    C'CNT7'
@CC01727 DC    C'CNT8'
@CC01734 DC    C'CNT9'
@CC01740 DC    C'CNTA'
@CC01747 DC    C'CNTB'
@CC01760 DC    C'CNTC'
@CC01765 DC    C'CNTD'
@CC01773 DC    C'CNTE'
@CC01778 DC    C'CNTF'
@CC01794 DC    C'CNTG'
@CC01801 DC    C'CNTH'
@CC01808 DC    C'CNTI'
@CC01817 DC    C'CNTJ'
@CC01823 DC    C'CNTK'
@CC01828 DC    C'CNTL'
@CC01833 DC    C'CNTM'
@CC01841 DC    C'CNTN'
@CC01846 DC    C'CNTO'
@CC01869 DC    C'SSAA'
@CC01553 DC    C'UV0'
@CC01555 DC    C'CM0'
@CC01557 DC    C'CN0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODID    DC    CL4'CN01'
         DS    CL3
FIXAREA  DS    CL624
         ORG   FIXAREA
@NM00118 DS    CL624
         ORG   @NM00118
@NM00119 DC    208X'00'
@NM00120 DC    208X'00'
@NM00121 DC    208X'00'
         ORG   FIXAREA+624
CNDEVTYP DC    CL8'DEVTYP  '
CNVOLSER DC    CL8'VOLSER  '
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @08
CC24     EQU   @09
CC23     EQU   @09
CC22     EQU   @11
CC21     EQU   @11
CC20     EQU   @09
CC19     EQU   @10
CC17     EQU   @09
CC14     EQU   @09
CC13     EQU   @09
CC12     EQU   @09
CC11     EQU   @10
CC10     EQU   @10
CC09     EQU   @09
CC08     EQU   @09
CC07     EQU   @09
CC06     EQU   @09
CC05     EQU   @11
CC03     EQU   @10
CC02     EQU   @09
CC01     EQU   @09
RTNREG2  EQU   @07
CTGFLPTR EQU   @09
OPNPTR   EQU   @02
RTNREG   EQU   @15
REG14    EQU   @14
CVOLR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSACA0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
UNITXSHR EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITVTOC EQU   UNITABL+7
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOSI0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCCBP   EQU   IOCSTR+36
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTUP EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPCI EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODRC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNDSOAM EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
OPNOPTJM EQU   OPNOPT2
OPNVOL   EQU   OPNAGL+44
IOINFOPT EQU   0
IOINFDVT EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
FFILE    EQU   0
FFILEVAL EQU   FFILE+1
TFILE    EQU   0
TFILEVAL EQU   TFILE+1
TVOL     EQU   0
TVOLVAL  EQU   TVOL+1
ALLC     EQU   0
VCAT     EQU   0
NONE     EQU   0
NSCR     EQU   0
CATN     EQU   0
CATNPAS  EQU   CATN+1
CATNFLG  EQU   CATN+10
CATNVAL  EQU   CATN+21
CATDD    EQU   0
CATDDVAL EQU   CATDD+1
LIST     EQU   0
PFILE    EQU   0
@NM00038 EQU   PFILE+2
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDPUAGL  EQU   MDAGL+20
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDCLEAR  EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
PUUCBPTR EQU   PUAGL+8
PUTTRPTR EQU   PUAGL+12
PULABELP EQU   PUAGL+16
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKDATYPE EQU   CKAGL+20
CKFLAGS  EQU   CKAGL+28
CKRETTYP EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSUCBPTR EQU   VS2AGL+8
VSOWNPTR EQU   VS2AGL+16
VSVOLPTR EQU   VS2AGL+20
VSLABOPT EQU   VS2AGL+28
VSOWNER  EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSVOLUME EQU   VS2AGL+29
VS2MSG   EQU   VS2AGL+35
VS2TOV   EQU   VS2MSG
VS2RESOP EQU   VS2AGL+36
VSDDNAME EQU   VS2AGL+37
VS1AGL   EQU   0
VSUCBP   EQU   VS1AGL+8
VSVOLP   EQU   VS1AGL+12
VSFILEP  EQU   VS1AGL+16
VSIOP    EQU   VS1AGL+20
VSNUMATP EQU   VS1AGL+24
VSNXTATP EQU   VS1AGL+28
VSCATP   EQU   VS1AGL+32
VSCATDDP EQU   VS1AGL+40
VSPSWDP  EQU   VS1AGL+44
VSPFILEP EQU   VS1AGL+48
VSSERP   EQU   VS1AGL+52
VSDEVP   EQU   VS1AGL+56
VSOSERP  EQU   VS1AGL+60
VSODEVP  EQU   VS1AGL+64
VSSECOPT EQU   VS1AGL+68
VSNOVSAM EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCMAST EQU   VSSECOPT
VSVTOPT  EQU   VS1AGL+69
VSTIME   EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSCATOPT EQU   VS1AGL+70
VSDEVICE EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSRETURN EQU   VS1AGL+71
VSVSAM   EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSMSG    EQU   VS1AGL+72
VSFROMV  EQU   VSMSG
VSTOV    EQU   VSMSG
VSRESOPT EQU   VS1AGL+73
VSRES    EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00073 EQU   SV82LIST+4
SV82DCBP EQU   @NM00073
@NM00074 EQU   SV82LIST+12
SV82WRKP EQU   @NM00074
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSVOL  EQU   RVVSPEC
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASINAC  EQU   BASFLAGA+2
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASOWNER EQU   BASEV+134
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVROPCD  EQU   MVRCODE
MVRFLAGA EQU   MVR+8
MVRFLBAS EQU   MVRFLAGA
MVRCICPY EQU   MVRFLAGA+2
MVRBVOL  EQU   MVR+12
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFDBK  EQU   CTGNEWNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDCD EQU   CTGFL+1
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLCHN EQU   CTGFL+12
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
CVOLLST  EQU   0
CVOLFLG  EQU   CVOLLST+6
CVODASCR EQU   CVOLFLG
CVOCRDAS EQU   CVOLFLG
CVOLID   EQU   CVOLLST+8
CVOLRUA  EQU   CVOLLST+32
CVOLVEXT EQU   CVOLLST+36
COVCE    EQU   0
COVLNGTH EQU   COVCE
COVFLAGA EQU   COVCE+34
COVFLAGB EQU   COVCE+35
COVSETFL EQU   COVFLAGB
COVSRCVY EQU   COVSETFL
COVRECFL EQU   COVFLAGB+1
COVICOPY EQU   COVRECFL
COVTYPE  EQU   COVFLAGB+2
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CAT      EQU   0
DMPTRM   EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NLIST    EQU   0
RECAT    EQU   0
SCR      EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
@NM00109 EQU   CTGDDNM
CTGPROB  EQU   @NM00109
CTGREASN EQU   CTGPROB+2
*                                      START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
@NM00126 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00117 EQU   COVCE+39
@NM00116 EQU   COVFLAGB+3
@NM00115 EQU   COVTYPE
COVREUSE EQU   COVTYPE
COVSAM   EQU   COVTYPE
@NM00114 EQU   COVRECFL
COVLAMIS EQU   COVRECFL
COVCREAT EQU   COVRECFL
@NM00113 EQU   COVSETFL
COVCRCVY EQU   COVSETFL
@NM00112 EQU   COVFLAGA
COVSPDES EQU   COVFLAGA
COVDESCR EQU   COVCE+4
CVOLRES2 EQU   CVOLLST+34
CVOLCSN  EQU   CVOLLST+20
CVOLECB  EQU   CVOLLST+16
CVOLASID EQU   CVOLLST+14
@NM00111 EQU   CVOLFLG
CVOCRCRV EQU   CVOLFLG
CVOCRCR  EQU   CVOLFLG
CVOLRES1 EQU   CVOLLST+5
CVOLOPCD EQU   CVOLLST+4
CVOLLEN  EQU   CVOLLST
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00110 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGPSWD  EQU   CTGJSCB
@NM00108 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGTYPE  EQU   CTGPL+18
@NM00107 EQU   CTGDSORG
CTGWKA   EQU   CTGPL+12
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00106 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00105 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00104 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
@NM00103 EQU   MVR+82
MVRLABEL EQU   MVR+76
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRCSN   EQU   MVR+62
MVRTO    EQU   MVR+58
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00102 EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRCLMIS EQU   MVRFLAGA+1
MVRSLMIS EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLLAB EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00101 EQU   MVRCODE+1
@NM00100 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00099 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00098 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
@NM00097 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00096 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00095 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00094 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00093 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00092 EQU   RVVOPCOD+1
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00091 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00090 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00089 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00088 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00087 EQU   VSDSCR+5
@NM00086 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00085 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00084 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00083 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00082 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00081 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00080 EQU   VSDVTOC
@NM00079 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00078 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00077 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00076 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00075 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00072 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00071 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00070 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00069 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00068 EQU   RCTAGL+10
@NM00067 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00066 EQU   VSRESOPT
@NM00065 EQU   VSMSG
@NM00064 EQU   VSRETURN
@NM00063 EQU   VSCATOPT
@NM00062 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSWRITE  EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSACBP   EQU   VS1AGL+36
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00061 EQU   VS2AGL+45
@NM00060 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00059 EQU   VS2MSG
@NM00058 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVTOCSZ EQU   VS2AGL+12
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00057 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00056 EQU   EXSPACE+8
@NM00055 EQU   EXSPACE+6
@NM00054 EQU   EXSPACE+4
@NM00053 EQU   EXSPACE+1
@NM00052 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00051 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00050 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00049 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00048 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00047 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLHEAD EQU   EXCLAGL
@NM00046 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKHEAD   EQU   CKAGL
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00045 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00044 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00043 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00042 EQU   CMMSG+7
@NM00041 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00040 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00039 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
PFILEVAL EQU   @NM00038+1
PFILELEN EQU   @NM00038
PFILECNT EQU   PFILE
CATDDLEN EQU   CATDD
CATNLEN  EQU   CATN+20
CATNMEM  EQU   CATN+12
CATNMLN  EQU   CATN+11
CATNFUQ  EQU   CATNFLG
CATNPOS  EQU   CATN+9
CATNPLN  EQU   CATN
TVOLLEN  EQU   TVOL
TFILELEN EQU   TFILE
FFILELEN EQU   FFILE
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
@NM00011 EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RF00552 EQU   @RC00547
@RC01043 EQU   @RC01041
@RF01359 EQU   @RC01348
@RF01987 EQU   @RC01972
@PB00026 EQU   @EL00001
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCCN01,(C'PLS2128',0603,76342)

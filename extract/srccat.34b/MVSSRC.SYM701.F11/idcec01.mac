         TITLE '********** IDCEC01:   EJECTC FUNCTION SUPPORT ROUTINE **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCEC01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCEC01   74.255'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0218
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN CONTROL ROUTING SECTION OF EJECTC    @Y30LB32*/
*   /* MESSAGES ISSUED IN THIS ROUTINE ARE IDC0781I,         @Y30LB32*/
*   /* IDC0001I, AND IDC0003I. THE EXIT POINT FROM EJECTC    @Y30LB32*/
*   /* FSR IS CONTAINED IN THIS PROCEDURE                    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0218
*   OLDERID2=NEWERID2;                                             0218
         L     @10,@PC00001                                        0218
         L     @15,GDTTR2(,@10)                                    0218
         MVC   @TS00001(95),NEWERID2(@15)                          0218
         MVC   OLDERID2(95,@15),@TS00001                           0218
*   NEWID2='ECES';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@15),@CC00908                              0219
*   IF GDTDBG=NULLPTR THEN                                         0220
         L     @10,GDTDBG(,@10)                                    0220
         LTR   @10,@10                                             0220
         BZ    @RT00220                                            0220
*     ;                                                            0221
*   ELSE                                                           0222
*     CALL IDCDB010(GDTTBL,'ECEC'); /*                       @Y30LB32*/
*                                                                  0222
         L     @10,@PC00001                                        0222
         ST    @10,@AL00001                                        0222
         LA    @15,@CC00909                                        0222
         ST    @15,@AL00001+4                                      0222
         MVI   @AL00001+4,X'80'                                    0222
         L     @15,GDTDBG(,@10)                                    0222
         LA    @01,@AL00001                                        0222
         BALR  @14,@15                                             0222
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE PRINT ARGUMENT LIST AND COUNT OF       @Y30LB32*/
*   /* CARTRIDGES EJECTED FIELD TO ZEROES                    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0223
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB32*/
@RT00220 LA    @10,PRINTTAB                                        0223
         ST    @10,DDSTRU                                          0223
*   PRINTTAB=''B;                   /*                       @Y30LB32*/
         XC    PRINTTAB(20),PRINTTAB                               0224
*   EJECTCNT=''B;                   /*                       @Y30LB32*/
*                                                                  0225
         SLR   @10,@10                                             0225
         ST    @10,EJECTCNT                                        0225
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TO ZERO FLAG BIT WHICH INDICATES VOLUME           @Y30LB32*/
*   /* INVENTORY WAS NOT UPDATED SUCCESSFULLY AND FLAG       @Y30LB32*/
*   /* BIT WHICH INDICATES NO SCRATCH CARTRIDGES WERE FOUND  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0226
*   VIERRFLG=OFF;                   /*                       @Y30LB32*/
         NI    VIERRFLG,B'01111111'                                0226
*   NOCART=OFF;                     /*                       @Y30LB32*/
*                                                                  0227
         NI    NOCART,B'01111111'                                  0227
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS ADDRESS TO MOVE PARM LIST CORE AREA AND        @Y30LB32*/
*   /* INITIALIZE TO ZEROES                                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0228
*   MCLSTPTR=ADDR(PARMLST);         /*                       @Y30LB32*/
         LA    @10,PARMLST                                         0228
         ST    @10,MCLSTPTR                                        0228
*   MCLIST=''B;                     /*                       @Y30LB32*/
*                                                                  0229
         XC    MCLIST(48,@10),MCLIST(@10)                          0229
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS MSF ID AND SET MSF ID IN MOVE MACRO PARM LIST  @Y30LB32*/
*   /* AND SET REMOVE SCRATCH CARTRIDGE FLAG                 @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0230
*   MCRTLIB=MSFVAL;                 /*                       @Y30LB32*/
         L     @15,@PC00001+4                                      0230
         L     @01,FDTPTR+12(,@15)                                 0230
         MVC   MCRTLIB(1,@10),MSFVAL+3(@01)                        0230
*   MCRTSCT=ON;                     /*                       @Y30LB32*/
*                                                                  0231
         OI    MCRTSCT(@10),B'00010000'                            0231
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF CARTRIDGES PARAMETER WAS SPECIFIED AND IF IT @Y30LB32*/
*   /* IS SPECIFIED ROUTINE CARTPROC IS INVOKED              @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0232
*   IF(ADDR(CART))^=NULLPTR THEN                                   0232
         L     @10,FDTPTR(,@15)                                    0232
         LTR   @10,@10                                             0232
         BZ    @RF00232                                            0232
*     DO;                           /*                       @Y30LB32*/
*       CALL CARTPROC;              /*                       @Y30LB32*/
         BAL   @14,CARTPROC                                        0234
*       RESPECIFY                                                  0235
*         RTNREG RSTD;                                             0235
*       TESTRC=RTNREG;                                             0236
         LR    TESTRC,RTNREG                                       0236
*       RESPECIFY                                                  0237
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*   ELSE                                                           0239
*     DO;                           /*                       @Y30LB32*/
*                                                                  0239
         B     @RC00232                                            0239
@RF00232 DS    0H                                                  0240
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF COUNT PARAMETER WAS SPECIFIED, IF IT IS  @Y30LB32*/
*       /* SPECIFIED INVOKE CNTPROC ROUTINE                  @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0240
*       IF(ADDR(CNT))^=NULLPTR THEN /*                       @Y30LB32*/
         L     @10,@PC00001+4                                      0240
         L     @10,FDTPTR+4(,@10)                                  0240
         LTR   @10,@10                                             0240
         BZ    @RF00240                                            0240
*         DO;                       /*                       @Y30LB32*/
*           CALL CNTPROC;           /*                       @Y30LB32*/
         BAL   @14,CNTPROC                                         0242
*           RESPECIFY                                              0243
*             RTNREG RSTD;                                         0243
*           TESTRC=RTNREG;                                         0244
         LR    TESTRC,RTNREG                                       0244
*           RESPECIFY                                              0245
*             RTNREG UNRSTD;        /*                       @Y30LB32*/
*         END;                      /*                       @Y30LB32*/
*       ELSE                        /*                       @Y30LB32*/
*         DO;                       /*                       @Y30LB32*/
*                                                                  0247
         B     @RC00240                                            0247
@RF00240 DS    0H                                                  0248
*           /*********************************************************/
*           /*                                                       */
*           /* INVOKE ALLPROC ROUTINE TO EJECT ALL SCRATCH   @Y30LB32*/
*           /* CARTRIDGES                                    @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0248
*           CALL ALLPROC;           /*                       @Y30LB32*/
         BAL   @14,ALLPROC                                         0248
*           RESPECIFY                                              0249
*             RTNREG RSTD;                                         0249
*           TESTRC=RTNREG;                                         0250
         LR    TESTRC,RTNREG                                       0250
*           RESPECIFY                                              0251
*             RTNREG UNRSTD;        /*                       @Y30LB32*/
*         END;                      /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0253
@RC00240 DS    0H                                                  0254
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ERROR RETURN CODE FROM CARTPROC, CNTPROC,   @Y30LB32*/
*   /* OR ALLPROC                                            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0254
*   IF TESTRC^=0 THEN               /*                       @Y30LB32*/
@RC00232 SLR   @10,@10                                             0254
         CR    TESTRC,@10                                          0254
         BE    @RF00254                                            0254
*     DO;                           /*                       @Y30LB32*/
*                                                                  0255
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK COUNT OF CARTRIDGES EJECTED AND SET FINAL   @Y30LB32*/
*       /* CONDITION CODE                                    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0256
*       IF EJECTCNT=ZERO THEN       /*                       @Y30LB32*/
         C     @10,EJECTCNT                                        0256
         BNE   @RF00256                                            0256
*         LASTCOND=LASTCC12;        /*                       @Y30LB32*/
         L     @10,@PC00001+8                                      0257
         MVC   LASTCOND(2,@10),@CH00536                            0257
*       ELSE                        /*                       @Y30LB32*/
*         LASTCOND=LASTCC08;        /*                       @Y30LB32*/
         B     @RC00256                                            0258
@RF00256 L     @10,@PC00001+8                                      0258
         MVC   LASTCOND(2,@10),@CH00171                            0258
*     END;                          /*                       @Y30LB32*/
*   ELSE                            /*                       @Y30LB32*/
*     IF VIERRFLG=ON×NOCART=ON THEN /*                       @Y30LB32*/
         B     @RC00254                                            0260
@RF00254 TM    VIERRFLG,B'10000000'                                0260
         BO    @RT00260                                            0260
         TM    NOCART,B'10000000'                                  0260
         BNO   @RF00260                                            0260
@RT00260 DS    0H                                                  0261
*       LASTCOND=LASTCC04;          /*                       @Y30LB32*/
*                                                                  0261
         L     @10,@PC00001+8                                      0261
         MVC   LASTCOND(2,@10),@CH00039                            0261
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK COUNT OF CARTRIDGES EJECTED, IF ANY WERE        @Y30LB32*/
*   /* EJECTED WRITE MESSAGE IDCO781I STATING NUMBER         @Y30LB32*/
*   /* OF SCRATCH CARTRIDGES EJECTED                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*   IF EJECTCNT>ZERO THEN           /*                       @Y30LB32*/
@RF00260 DS    0H                                                  0262
@RC00254 L     @10,EJECTCNT                                        0262
         LTR   @10,@10                                             0262
         BNP   @RF00262                                            0262
*     DO;                           /*                       @Y30LB32*/
*       PRINTTAB=''B;               /*                       @Y30LB32*/
         XC    PRINTTAB(20),PRINTTAB                               0264
*       DARGSMOD=EJECTMSG;          /*                       @Y30LB32*/
         L     @10,DDSTRU                                          0265
         MVC   DARGSMOD(3,@10),@CC00888                            0265
*       DARGSENT=MSG0781I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@10),X'02'                                 0266
*       DARGDBP=ADDR(EJECTCNT);     /*                       @Y30LB32*/
         LA    @15,EJECTCNT                                        0267
         ST    @15,DARGDBP(,@10)                                   0267
*       DARGILP=LENGTH(EJECTCNT);   /*                       @Y30LB32*/
         MVC   DARGILP(2,@10),@CH00039                             0268
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @10,@PC00001                                        0269
         ST    @10,@AL00001                                        0269
         LA    @15,@CF00109                                        0269
         ST    @15,@AL00001+4                                      0269
         LA    @15,DDSTRU                                          0269
         ST    @15,@AL00001+8                                      0269
         MVI   @AL00001+8,X'80'                                    0269
         L     @15,GDTPRT(,@10)                                    0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*     END;                          /*                       @Y30LB32*/
*                                                                  0270
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE COMPLETION MESSAGE IDC3001I IF FUNCTION WAS     @Y30LB32*/
*   /* COMPLETED OR TERMINATING MESSAGE IDC0003I IF          @Y30LB32*/
*   /* FUNCTION WAS NOT PERFORMED                            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*   DARGLIST=''B;                   /*                       @Y30LB32*/
@RF00262 L     @10,DDSTRU                                          0271
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0271
*   IF LASTCOND<LASTCC12 THEN       /*                       @Y30LB32*/
         L     @15,@PC00001+8                                      0272
         LH    @15,LASTCOND(,@15)                                  0272
         C     @15,@CF00536                                        0272
         BNL   @RF00272                                            0272
*     DARGSENT=MSG0001I;            /*                       @Y30LB32*/
         MVI   DARGSENT(@10),X'01'                                 0273
*   ELSE                            /*                       @Y30LB32*/
*     DARGSENT=MSG0003I;            /*                       @Y30LB32*/
         B     @RC00272                                            0274
@RF00272 L     @10,DDSTRU                                          0274
         MVI   DARGSENT(@10),X'03'                                 0274
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB32*/
@RC00272 L     @10,DDSTRU                                          0275
         MVC   DARGSMOD(3,@10),@CC00882                            0275
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB32*/
         L     @15,@PC00001+8                                      0276
         ST    @15,DARGDBP(,@10)                                   0276
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB32*/
         MVC   DARGILP(2,@10),@CH00145                             0277
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB32*/
         L     @10,@PC00001                                        0278
         ST    @10,@AL00001                                        0278
         LA    @15,@CF00109                                        0278
         ST    @15,@AL00001+4                                      0278
         LA    @15,DDSTRU                                          0278
         ST    @15,@AL00001+8                                      0278
         MVI   @AL00001+8,X'80'                                    0278
         L     @15,GDTPRT(,@10)                                    0278
         LA    @01,@AL00001                                        0278
         BALR  @14,@15                                             0278
*   IF GDTDBG=NULLPTR THEN                                         0279
         L     @10,@PC00001                                        0279
         L     @10,GDTDBG(,@10)                                    0279
         LTR   @10,@10                                             0279
         BZ    @RT00279                                            0279
*     ;                                                            0280
*   ELSE                                                           0281
*     CALL IDCDB010(GDTTBL,'ECRP'); /*                       @Y30LB32*/
*                                                                  0281
         L     @10,@PC00001                                        0281
         ST    @10,@AL00001                                        0281
         LA    @15,@CC00915                                        0281
         ST    @15,@AL00001+4                                      0281
         MVI   @AL00001+4,X'80'                                    0281
         L     @15,GDTDBG(,@10)                                    0281
         LA    @01,@AL00001                                        0281
         BALR  @14,@15                                             0281
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO AMS EXECUTIVE                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0282
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0282
*                                                                  0282
@RT00279 L     @10,@PC00001                                        0282
         ST    @10,@AL00001                                        0282
         LA    @15,MODID                                           0282
         ST    @15,@AL00001+4                                      0282
         L     @15,@PC00001+8                                      0282
         ST    @15,@AL00001+8                                      0282
         MVI   @AL00001+8,X'80'                                    0282
         L     @15,GDTEPL(,@10)                                    0282
         LA    @01,@AL00001                                        0282
         BALR  @14,@15                                             0282
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*                                                                  0283
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CARTPROC                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - EJECTS SCRATCH CARTRIDGES THAT ARE SPECIFIED @Y30LB32*/
*/*             BY THEIR CSN'S. ISSUES MESSAGE IDC2782I IF   @Y30LB32*/
*/*             SCRATCH CARTRIDGE NOT EJECTED                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CSN, CSN LENGTH, COUNT OF CSNS LISTED           @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - CARTPROC SUCCESSFUL        @Y30LB32*/
*/*             RETURN CODE = 4 - SCRATCH CARTRIDGE NOT      @Y30LB32*/
*/*                               EJECTED SUCCESSFULLY       @Y30LB32*/
*/*                                                          @Y30LB32*/
*/****************************************************************** */
*                                                                  0283
*CARTPROC:                                                         0283
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0283
@EL00001 L     @13,4(,@13)                                         0283
@EF00001 L     @00,@SIZDATD                                        0283
         LR    @01,@11                                             0283
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0283
         BR    @14                                                 0283
CARTPROC DS    0H                                                  0284
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/
*   /* CODE TO ZERO                                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0284
*   RETADDR=REG14;                  /*                       @Y30LB32*/
         LR    RETADDR,REG14                                       0284
*   OLDERID2=NEWERID2;                                             0285
         L     @10,@PC00001                                        0285
         L     @10,GDTTR2(,@10)                                    0285
         MVC   @TS00001(95),NEWERID2(@10)                          0285
         MVC   OLDERID2(95,@10),@TS00001                           0285
*   NEWID2='ECCP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@10),@CC00919                              0286
*   CARTCOND=''B;                   /*                       @Y30LB32*/
*                                                                  0287
         SLR   CARTCOND,CARTCOND                                   0287
*   /*****************************************************************/
*   /*                                                               */
*   /* EJECT ALL THE SCRATCH CARTRIDGES LISTED FOR EJECTION  @Y30LB32*/
*   /* UNLESS A TERMINATING ERROR OCCURS                     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   DO LOOPCNT=ONE TO CARTCNT       /*                       @Y30LB32*/
*         WHILE(CARTCOND<LASTCC08); /*                       @Y30LB32*/
*                                                                  0288
         LA    LOOPCNT,1                                           0288
         B     @DE00288                                            0288
@DL00288 C     CARTCOND,@CF00171                                   0288
         BNL   @DC00288                                            0288
*     /***************************************************************/
*     /*                                                             */
*     /* ACCESS CARTRIDGE SERIAL NUMBER LENGTH               @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0289
*     CSNVAL=CARTVAL(LOOPCNT);      /*                       @Y30LB32*/
*                                                                  0289
         LR    @10,LOOPCNT                                         0289
         MH    @10,@CH00981                                        0289
         L     @09,@PC00001+4                                      0289
         L     @09,FDTPTR(,@09)                                    0289
         ST    @10,@TF00001                                        0289
         ALR   @10,@09                                             0289
         AL    @10,@CF00987                                        0289
         MVC   CSNVAL(12),CARTVAL-3(@10)                           0289
*     /***************************************************************/
*     /*                                                             */
*     /* CALL SUBROUTINE CKCSNLEN TO CHECK VALIDITY OF CSN   @Y30LB32*/
*     /* LENGTH                                              @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0290
*     CALL CKCSNLEN(CSNVAL,CARTLEN(LOOPCNT));/*              @Y30LB32*/
         LA    @10,CSNVAL                                          0290
         ST    @10,@AL00001                                        0290
         L     @10,@TF00001                                        0290
         AL    @09,@CF00988                                        0290
         LA    @10,CARTLEN-2(@10,@09)                              0290
         ST    @10,@AL00001+4                                      0290
         LA    @01,@AL00001                                        0290
         BAL   @14,CKCSNLEN                                        0290
*     RESPECIFY                                                    0291
*       RTNREG RSTD;                                               0291
*     TESTRC=RTNREG;                                               0292
         LR    TESTRC,RTNREG                                       0292
*     RESPECIFY                                                    0293
*       RTNREG UNRSTD;              /*                       @Y30LB32*/
*                                                                  0293
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK RETURN CODE AND IF CSN LENGTH WAS VALID PLACE @Y30LB32*/
*     /* CSN IN PARM LIST MCLIST                             @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0294
*     IF TESTRC=0 THEN              /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0294
         BNZ   @RF00294                                            0294
*       DO;                         /*                       @Y30LB32*/
*         MCRTCSN=CSNVAL;           /*                       @Y30LB32*/
*                                                                  0296
         L     @10,MCLSTPTR                                        0296
         MVC   MCRTCSN(12,@10),CSNVAL                              0296
*         /***********************************************************/
*         /*                                                         */
*         /* INVOKE THE MOVEPROC ROUTINE TO EJECT THE        @Y30LB32*/
*         /* SPECIFIED SCRATCH CARTRIDGE                     @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0297
*         CALL MOVEPROC;            /*                       @Y30LB32*/
         BAL   @14,MOVEPROC                                        0297
*         RESPECIFY                                                0298
*           RTNREG RSTD;                                           0298
*         TESTRC=RTNREG;                                           0299
         LR    TESTRC,RTNREG                                       0299
*         RESPECIFY                                                0300
*           RTNREG UNRSTD;          /*                       @Y30LB32*/
*                                                                  0300
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK RETURN CODE AND IF MOVEPROC WAS NOT       @Y30LB32*/
*         /* SUCCESSFUL, WRITE MESSAGE IDC2782I STATING      @Y30LB32*/
*         /* CARTRIDGE WAS NOT EJECTED                       @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0301
*         IF TESTRC^=0 THEN         /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0301
         BZ    @RF00301                                            0301
*           DO;                     /*                       @Y30LB32*/
*             PRINTTAB=''B;         /*                       @Y30LB32*/
         XC    PRINTTAB(20),PRINTTAB                               0303
*             DARGSMOD=EJECTMSG;    /*                       @Y30LB32*/
         L     @10,DDSTRU                                          0304
         MVC   DARGSMOD(3,@10),@CC00888                            0304
*             DARGSENT=MSG2782I;    /*                       @Y30LB32*/
         MVI   DARGSENT(@10),X'03'                                 0305
*             DARGDBP=ADDR(CSNVAL); /*                       @Y30LB32*/
         LA    @09,CSNVAL                                          0306
         ST    @09,DARGDBP(,@10)                                   0306
*             DARGILP=LENGTH(CSNVAL);/*                      @Y30LB32*/
         MVC   DARGILP(2,@10),@CH00536                             0307
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB32*/
*                                                                  0308
         L     @10,@PC00001                                        0308
         ST    @10,@AL00001                                        0308
         LA    @09,@CF00109                                        0308
         ST    @09,@AL00001+4                                      0308
         LA    @09,DDSTRU                                          0308
         ST    @09,@AL00001+8                                      0308
         MVI   @AL00001+8,X'80'                                    0308
         L     @15,GDTPRT(,@10)                                    0308
         LA    @01,@AL00001                                        0308
         BALR  @14,@15                                             0308
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK FOR RETURN CODE OF EIGHT TO SEE IF    @Y30LB32*/
*             /* STORAGE COULD NOT BE OBTAINED FOR MESSAGE   @Y30LB32*/
*             /* IF EIGHT SET CONDITION CODE TO EIGHT        @Y30LB32*/
*             /* TO TERMINATE LOOP                           @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0309
*             IF TESTRC=8 THEN      /*                       @Y30LB32*/
         LA    @10,8                                               0309
         CR    TESTRC,@10                                          0309
         BNE   @RF00309                                            0309
*               CARTCOND=LASTCC08;  /*                       @Y30LB32*/
         LR    CARTCOND,@10                                        0310
*             ELSE                  /*                       @Y30LB32*/
*               DO;                 /*                       @Y30LB32*/
*                                                                  0311
         B     @RC00309                                            0311
@RF00309 DS    0H                                                  0312
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK REASON CODE AND SET CONDITION CODE        */
*                 /*                                         @Y30LB32*/
*                 /* IF THE REASON CODE INDICATES A SEVERE ERROR     */
*                 /*                                         @Y30LB32*/
*                 /* THE CONDITION CODE IS SET TO EIGHT TO   @Y30LB32*/
*                 /* TERMINATE THE LOOP. IF THE REASON CODE DOES     */
*                 /*                                         @Y30LB32*/
*                 /* NOT INDICATE A SEVERE ERROR THE CONDITION       */
*                 /*                                         @Y30LB32*/
*                 /* CODE IS SET TO FOUR TO CONTINUE PROCESSING      */
*                 /*                                         @Y30LB32*/
*                 /* AND EJECT REST OF THE CARTRIDGES        @Y30LB32*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0312
*                 IF REASONCD^=RCNOCSN&REASONCD^=RCWRNGC THEN/*    0312
*                                                            @Y30LB32*/
         L     @10,REASONCD                                        0312
         C     @10,@CF00897                                        0312
         BE    @RF00312                                            0312
         C     @10,@CF00899                                        0312
         BE    @RF00312                                            0312
*                   CARTCOND=LASTCC08;/*                     @Y30LB32*/
         LA    CARTCOND,8                                          0313
*                 ELSE              /*                       @Y30LB32*/
*                   CARTCOND=LASTCC04;/*                     @Y30LB32*/
         B     @RC00312                                            0314
@RF00312 LA    CARTCOND,4                                          0314
*               END;                /*                       @Y30LB32*/
*           END;                    /*                       @Y30LB32*/
*         ELSE                                                     0317
*           ;                       /*                       @Y30LB32*/
@RF00301 DS    0H                                                  0318
*       END;                        /*                       @Y30LB32*/
*                                                                  0318
*     /***************************************************************/
*     /*                                                             */
*     /* IF CSN LENGTH WAS NOT VALID, SET CONDITION CODE     @Y30LB32*/
*     /* TO FOUR                                             @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0319
*     ELSE                          /*                       @Y30LB32*/
*       CARTCOND=LASTCC04;          /*                       @Y30LB32*/
         B     @RC00294                                            0319
@RF00294 LA    CARTCOND,4                                          0319
*   END;                            /*                       @Y30LB32*/
*                                                                  0320
@RC00294 AL    LOOPCNT,@CF00211                                    0320
@DE00288 L     @10,@PC00001+4                                      0320
         L     @10,FDTPTR(,@10)                                    0320
         CH    LOOPCNT,CARTCNT(,@10)                               0320
         BNH   @DL00288                                            0320
@DC00288 DS    0H                                                  0321
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK CONDITION CODE                                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0321
*   IF CARTCOND^=0 THEN             /*                       @Y30LB32*/
         LTR   CARTCOND,CARTCOND                                   0321
         BZ    @RF00321                                            0321
*     CARTCOND=LASTCC04;            /*                       @Y30LB32*/
*                                                                  0322
         LA    CARTCOND,4                                          0322
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS RETURN ADDRESS AND RETURN TO CALLER            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   REG14=RETADDR;                  /*                       @Y30LB32*/
@RF00321 LR    REG14,RETADDR                                       0323
*   RETURN CODE(CARTCOND);          /*                       @Y30LB32*/
         LR    @15,CARTCOND                                        0324
@EL00002 DS    0H                                                  0324
@EF00002 DS    0H                                                  0324
@ER00002 BR    @14                                                 0324
*   END CARTPROC;                   /*                       @Y30LB32*/
*                                                                  0326
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CNTPROC                                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - EJECTS THE REQUESTED NUMBER OF SCRATCH       @Y30LB32*/
*/*             CARTRIDGES.                                  @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - COUNT OF CARTRIDGES TO BE EJECTED               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - CNTPROC SUCCESSFUL         @Y30LB32*/
*/*             RETURN CODE = 4 - REQUESTED NUMBER OF SCRATCH@Y30LB32*/
*/*                               CARTRIDGES NOT EJECTED     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0326
*CNTPROC:                                                          0326
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0326
CNTPROC  DS    0H                                                  0327
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND SET CONDITION CODE TO ZERO    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0327
*   RETADDR=REG14;                  /*                       @Y30LB32*/
         LR    RETADDR,REG14                                       0327
*   OLDERID2=NEWERID2;                                             0328
         L     @10,@PC00001                                        0328
         L     @10,GDTTR2(,@10)                                    0328
         MVC   @TS00001(95),NEWERID2(@10)                          0328
         MVC   OLDERID2(95,@10),@TS00001                           0328
*   NEWID2='ECCN';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@10),@CC00925                              0329
*   CNTCOND=0;                      /*                       @Y30LB32*/
*                                                                  0330
         SLR   CNTCOND,CNTCOND                                     0330
*   /*****************************************************************/
*   /*                                                               */
*   /* EJECT SCRATCH CARTRIDGES UNTIL REQUESTED NUMBER OF    @Y30LB32*/
*   /* SCRATCH CARTRIDGES ARE EJECTED OR AN ERROR OCCURS     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   DO LOOPCNT=ONE TO CNTVAL        /*                       @Y30LB32*/
*         WHILE(CNTCOND=0);         /*                       @Y30LB32*/
*                                                                  0331
         LA    LOOPCNT,1                                           0331
         B     @DE00331                                            0331
@DL00331 LTR   CNTCOND,CNTCOND                                     0331
         BNZ   @DC00331                                            0331
*     /***************************************************************/
*     /*                                                             */
*     /* INVOKE MOVEPROC ROUTINE TO EJECT A SCRATCH CARTRIDGE@Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0332
*     CALL MOVEPROC;                /*                       @Y30LB32*/
         BAL   @14,MOVEPROC                                        0332
*     RESPECIFY                                                    0333
*       RTNREG RSTD;                                               0333
*     TESTRC=RTNREG;                                               0334
         LR    TESTRC,RTNREG                                       0334
*     RESPECIFY                                                    0335
*       RTNREG UNRSTD;              /*                       @Y30LB32*/
*                                                                  0335
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK RETURN CODE AND IF MOVEPROC WAS NOT SUCCESSFUL@Y30LB32*/
*     /* SET CONDITION CODE TO TERMINATE THE LOOP            @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0336
*     IF TESTRC^=0 THEN             /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0336
         BZ    @RF00336                                            0336
*       CNTCOND=LASTCC04;           /*                       @Y30LB32*/
         LA    CNTCOND,4                                           0337
*   END;                            /*                       @Y30LB32*/
*                                                                  0338
@RF00336 AL    LOOPCNT,@CF00211                                    0338
@DE00331 L     @10,@PC00001+4                                      0338
         L     @10,FDTPTR+4(,@10)                                  0338
         C     LOOPCNT,CNTVAL(,@10)                                0338
         BNH   @DL00331                                            0338
@DC00331 DS    0H                                                  0339
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET RETURN ADDRESS AND RETURN TO CALLER             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0339
*   REG14=RETADDR;                  /*                       @Y30LB32*/
         LR    REG14,RETADDR                                       0339
*   RETURN CODE(CNTCOND);           /*                       @Y30LB32*/
         LR    @15,CNTCOND                                         0340
@EL00003 DS    0H                                                  0340
@EF00003 DS    0H                                                  0340
@ER00003 BR    @14                                                 0340
*   END CNTPROC;                    /*                       @Y30LB32*/
*                                                                  0342
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - ALLPROC                                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - EJECTS ALL SCRATCH CARTRIDGES IN MSF         @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - NONE                                            @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - ALLPROC SUCCESSFUL         @Y30LB32*/
*/*             RETURN CODE = 4 - ALL SCRATCH                @Y30LB32*/
*/*                               CARTRIDGES NOT EJECTED     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0342
*ALLPROC:                                                          0342
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0342
ALLPROC  DS    0H                                                  0343
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/
*   /* CODE TO ZERO                                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   RETADDR=REG14;                  /*                       @Y30LB32*/
         LR    RETADDR,REG14                                       0343
*   OLDERID2=NEWERID2;                                             0344
         L     @10,@PC00001                                        0344
         L     @10,GDTTR2(,@10)                                    0344
         MVC   @TS00001(95),NEWERID2(@10)                          0344
         MVC   OLDERID2(95,@10),@TS00001                           0344
*   NEWID2='ECAP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@10),@CC00929                              0345
*   ALLCOND=0;                      /*                       @Y30LB32*/
         SLR   ALLCOND,ALLCOND                                     0346
*   CNTALL=''B;                     /*                       @Y30LB32*/
*                                                                  0347
         XC    CNTALL(3),CNTALL                                    0347
*   /*****************************************************************/
*   /*                                                               */
*   /* EJECT SCRATCH CARTRIDGES UNTIL ALL THE SCRATCH        @Y30LB32*/
*   /* CARTRIDGES IN THE MSF HAVE BEEN EJECTED OR CONDITION  @Y30LB32*/
*   /* CODE IS NOT ZERO                                      @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*   DO WHILE CNTALL^=ALLCNT&ALLCOND=0;/*                     @Y30LB32*/
*                                                                  0348
         B     @DE00348                                            0348
@DL00348 DS    0H                                                  0349
*     /***************************************************************/
*     /*                                                             */
*     /* INVOKE MOVEPROC ROUTINE TO EJECT A SCRATCH          @Y30LB32*/
*     /* CARTRIDGE                                           @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0349
*     CALL MOVEPROC;                /*                       @Y30LB32*/
         BAL   @14,MOVEPROC                                        0349
*     RESPECIFY                                                    0350
*       RTNREG RSTD;                                               0350
*     TESTRC=RTNREG;                                               0351
         LR    TESTRC,RTNREG                                       0351
*     RESPECIFY                                                    0352
*       RTNREG UNRSTD;              /*                       @Y30LB32*/
*                                                                  0352
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF MOVEPROC WAS SUCCESSFUL                    @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0353
*     IF TESTRC^=0 THEN             /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0353
         BZ    @RF00353                                            0353
*       DO;                         /*                       @Y30LB32*/
*                                                                  0354
*         /***********************************************************/
*         /*                                                         */
*         /* IF STORAGE AREA COULD NOT BE OBTAINED FOR THE   @Y30LB32*/
*         /* MESSAGE AREA SET CONDITION CODE TO FOUR TO      @Y30LB32*/
*         /* TERMINATE LOOP OF EJECTING CARTRIDGES           @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0355
*         IF TESTRC=8 THEN          /*                       @Y30LB32*/
         C     TESTRC,@CF00171                                     0355
         BNE   @RF00355                                            0355
*           ALLCOND=LASTCC04;       /*                       @Y30LB32*/
*                                                                  0356
         LA    ALLCOND,4                                           0356
*         /***********************************************************/
*         /*                                                         */
*         /* IF AN ERROR OCCURRED DURING MOVE MACRO EXECUTION        */
*         /*                                                 @Y30LB32*/
*         /* PROCESS THE REASON CODE                         @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0357
*         ELSE                      /*                       @Y30LB32*/
*           DO;                     /*                       @Y30LB32*/
*                                                                  0357
         B     @RC00355                                            0357
@RF00355 DS    0H                                                  0358
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK REASON CODE TO DETERMINE IF NO SCRATCH        */
*             /*                                             @Y30LB32*/
*             /* CARTRIDGES ARE LEFT IN MSF, IF SOME OTHER   @Y30LB32*/
*             /* ERROR OCCURRED CONDITION CODE IS SET TO FOUR TO     */
*             /*                                             @Y30LB32*/
*             /* TERMINATE LOOP OF EJECTING CARTRIDGES       @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0358
*             IF REASONCD^=RCNOCART THEN/*                   @Y30LB32*/
         CLC   REASONCD(4),@CF00901                                0358
         BE    @RF00358                                            0358
*               ALLCOND=LASTCC04;   /*                       @Y30LB32*/
         LA    ALLCOND,4                                           0359
*             ELSE                  /*                       @Y30LB32*/
*                                                                  0360
*               /*****************************************************/
*               /*                                                   */
*               /* IF NO MORE SCRATCH CARTRIDGES ARE LEFT IN MSF     */
*               /*                                           @Y30LB32*/
*               /* SET LOOP CONTROLLER TO EXIT FROM LOOP     @Y30LB32*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0360
*               CNTALL=ALLCNT;      /*                       @Y30LB32*/
         B     @RC00358                                            0360
@RF00358 MVC   CNTALL(3),@CC00155                                  0360
*           END;                    /*                       @Y30LB32*/
@RC00358 DS    0H                                                  0362
*       END;                        /*                       @Y30LB32*/
@RC00355 DS    0H                                                  0363
*   END;                            /*                       @Y30LB32*/
*                                                                  0363
@RF00353 DS    0H                                                  0363
@DE00348 CLC   CNTALL(3),@CC00155                                  0363
         BE    @DC00348                                            0363
         LTR   ALLCOND,ALLCOND                                     0363
         BZ    @DL00348                                            0363
@DC00348 DS    0H                                                  0364
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET RETURN ADDRESS AND RETURN TO CALLER             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   REG14=RETADDR;                  /*                       @Y30LB32*/
         LR    REG14,RETADDR                                       0364
*   RETURN CODE(ALLCOND);           /*                       @Y30LB32*/
         LR    @15,ALLCOND                                         0365
@EL00004 DS    0H                                                  0365
@EF00004 DS    0H                                                  0365
@ER00004 BR    @14                                                 0365
*   END ALLPROC;                    /*                       @Y30LB32*/
*                                                                  0367
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - MOVEPROC                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - INVOKES ICBMCRT MACRO TO EJECT A SCRATCH     @Y30LB32*/
*/*             CARTRIDGE FROM THE MSF. WRITES MESSAGES      @Y30LB32*/
*/*             IDC783E TO OPERATOR AND MESSAGE IDC0780I     @Y30LB32*/
*/*             TO SYSPRINT IDENTIFYING CARTRIDGE EJECTED    @Y30LB32*/
*/*             AND MESSAGE IDC1784I                         @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - PARM LIST FOR MOVE MACRO                        @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - MOVEPROC SUCCESSFUL        @Y30LB32*/
*/*             RETURN CODE = 4 - SCRATCH CARTRIDGE          @Y30LB32*/
*/*                               NOT EJECTED                @Y30LB32*/
*/*             RETURN CODE = 8 - NO STORAGE OBTAINED FOR    @Y30LB32*/
*/*                               ECB/MESSAGE AREA           @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*         - REASON CODE                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0367
*MOVEPROC:                                                         0367
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0367
MOVEPROC DS    0H                                                  0368
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND INIT CONDITION      @Y30LB32*/
*   /* CODE, ECBCODE, AND REASON CODE FIELDS TO ZERO         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*   RETADDR1=REG14;                 /*                       @Y30LB32*/
         LR    RETADDR1,REG14                                      0368
*   OLDERID2=NEWERID2;                                             0369
         L     @15,@PC00001                                        0369
         L     @14,GDTTR2(,@15)                                    0369
         MVC   @TS00001(95),NEWERID2(@14)                          0369
         MVC   OLDERID2(95,@14),@TS00001                           0369
*   NEWID2='ECMP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@14),@CC00933                              0370
*   MOVECOND=0;                     /*                       @Y30LB32*/
*                                                                  0371
         SLR   @14,@14                                             0371
         LR    MOVECOND,@14                                        0371
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDE A POINTER VALUE TO LOCATE DATA RETURNED BY    @Y30LB32*/
*   /* THE MOVE MACRO MESSAGE                                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0372
*   RFY                                                            0372
*     CMMSG BASED(MSGPTR+ECBLEN);   /*                       @Y30LB32*/
*                                                                  0372
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC UMACRO TO INVOKE ICBMCRT MACRO TO EJECT    @Y30LB32*/
*   /* SCRATCH CARTRIDGE                                     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0373
*   IF GDTDBG=NULLPTR THEN                                         0373
         C     @14,GDTDBG(,@15)                                    0373
         BE    @RT00373                                            0373
*     ;                                                            0374
*   ELSE                                                           0375
*     DO;                                                          0375
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   0376
*       DMPITMNM='MCLIST';                                         0377
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0377
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0377
         MVC   DMPITMNM(6,DMPINDEX),@CC00936                       0377
*       DMPITMPT=ADDR(MCLIST);                                     0378
         L     @03,MCLSTPTR                                        0378
         ST    @03,DMPITMPT(,DMPINDEX)                             0378
*       DMPITMLN=LENGTH(MCLIST);                                   0379
         MVC   DMPITMLN(2,DMPINDEX),@CH00982                       0379
*       DMPITMTP='H';                                              0380
         MVI   DMPITMTP(DMPINDEX),C'H'                             0380
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0381
*                                                                  0381
         AL    DMPINDEX,@CF00463                                   0381
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0382
*       DMPTRM=DMPTRMVL;                                           0382
         MVI   DMPTRM(DMPINDEX),X'FF'                              0382
*     END;                          /*                       @Y30LB32*/
*   IF GDTDBG=NULLPTR THEN                                         0384
@RT00373 L     @15,@PC00001                                        0384
         L     @15,GDTDBG(,@15)                                    0384
         LTR   @15,@15                                             0384
         BZ    @RT00384                                            0384
*     ;                                                            0385
*   ELSE                                                           0386
*     CALL IDCDB010(GDTTBL,'ECBM',ADDR(DUMPAREA));/*         @Y30LB32*/
         L     @15,@PC00001                                        0386
         ST    @15,@AL00001                                        0386
         LA    @14,@CC00938                                        0386
         ST    @14,@AL00001+4                                      0386
         LA    @14,DUMPAREA                                        0386
         ST    @14,@AFTEMPS                                        0386
         LA    @14,@AFTEMPS                                        0386
         ST    @14,@AL00001+8                                      0386
         MVI   @AL00001+8,X'80'                                    0386
         L     @15,GDTDBG(,@15)                                    0386
         LA    @01,@AL00001                                        0386
         BALR  @14,@15                                             0386
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,REASONCD,ECBCODE,MSGPTR);/* 0387
*                                                            @Y30LB32*/
@RT00384 L     @02,@PC00001                                        0387
         ST    @02,@AL00001                                        0387
         LA    @15,MOVE                                            0387
         ST    @15,@AL00001+4                                      0387
         LA    @15,MCLSTPTR                                        0387
         ST    @15,@AL00001+8                                      0387
         LA    @15,REASONCD                                        0387
         ST    @15,@AL00001+12                                     0387
         LA    @15,ECBCODE                                         0387
         ST    @15,@AL00001+16                                     0387
         LA    @15,MSGPTR                                          0387
         ST    @15,@AL00001+20                                     0387
         MVI   @AL00001+20,X'80'                                   0387
         L     @15,GDTSSC(,@02)                                    0387
         LA    @01,@AL00001                                        0387
         BALR  @14,@15                                             0387
*   RESPECIFY                                                      0388
*     RTNREG RSTD;                                                 0388
*   TESTRC=RTNREG;                                                 0389
         LR    TESTRC,RTNREG                                       0389
*   RESPECIFY                                                      0390
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0390
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MOVE MACRO WAS SUCCESSFUL                    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0391
*   IF TESTRC=0×TESTRC=12 THEN      /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0391
         BZ    @RT00391                                            0391
         C     TESTRC,@CF00536                                     0391
         BNE   @RF00391                                            0391
@RT00391 DS    0H                                                  0392
*     DO;                           /*                       @Y30LB32*/
*                                                                  0392
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF VOLUME INVENTORY WAS UPDATED             @Y30LB32*/
*       /* IF NOT UPDATED SUCCESSFULLY SET VIERRFLG          @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0393
*       IF TESTRC=12 THEN           /*                       @Y30LB32*/
         C     TESTRC,@CF00536                                     0393
         BNE   @RF00393                                            0393
*         VIERRFLG=ON;              /*                       @Y30LB32*/
*                                                                  0394
         OI    VIERRFLG,B'10000000'                                0394
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE USYSINFO UMACRO TO ACCESS JOBNAME AND   @Y30LB32*/
*       /* STEPNAME                                          @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0395
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(NAMEAREA));/*        @Y30LB32*/
*                                                                  0395
@RF00393 L     @15,@PC00001                                        0395
         ST    @15,@AL00001                                        0395
         LA    @14,NAMES                                           0395
         ST    @14,@AL00001+4                                      0395
         LA    @14,NAMEAREA                                        0395
         ST    @14,@AFTEMPS                                        0395
         LA    @14,@AFTEMPS                                        0395
         ST    @14,@AL00001+8                                      0395
         MVI   @AL00001+8,X'80'                                    0395
         L     @15,GDTSFO(,@15)                                    0395
         LA    @01,@AL00001                                        0395
         BALR  @14,@15                                             0395
*       /*************************************************************/
*       /*                                                           */
*       /* SET MESSAGE AREA TO ZERO                          @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0396
*       MSGAREA=''B;                /*                       @Y30LB32*/
*                                                                  0396
         XC    MSGAREA(72),MSGAREA                                 0396
*       /*************************************************************/
*       /*                                                           */
*       /* ACCESS CARTRIDGE SERIAL NUMBER OF SCRATCH         @Y30LB32*/
*       /* CARTRIDGE EJECTED FROM MESSAGE RETURNED BY MOVE   @Y30LB32*/
*       /* MACRO                                             @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0397
*       CSNVAL=CMCSN1;              /*                       @Y30LB32*/
*                                                                  0397
         L     @01,MSGPTR                                          0397
         MVC   CSNVAL(12),CMCSN1+4(@01)                            0397
*       /*************************************************************/
*       /*                                                           */
*       /* GET MESSAGE TO SEND TO THE OPERATOR               @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0398
*       DARGLIST=''B;               /*                       @Y30LB32*/
         L     @15,DDSTRU                                          0398
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0398
*       DARGSMOD=EJECTMSG;          /*                       @Y30LB32*/
         MVC   DARGSMOD(3,@15),@CC00888                            0399
*       DARGSENT=MSG783E;           /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'04'                                 0400
*       DARGRETP=ADDR(MSGAREA);     /*                       @Y30LB32*/
         LA    @14,MSGAREA                                         0401
         ST    @14,DARGRETP(,@15)                                  0401
*       DARGRETL=LENGTH(MSGAREA);   /*                       @Y30LB32*/
         MVC   DARGRETL(2,@15),@CH00866                            0402
*       DARGDBP=ADDR(INSERTS);      /*                       @Y30LB32*/
         LA    @14,INSERTS                                         0403
         ST    @14,DARGDBP(,@15)                                   0403
*       DARGILP=LENGTH(INSERTS);    /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00860                             0404
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
*                                                                  0405
         L     @15,@PC00001                                        0405
         ST    @15,@AL00001                                        0405
         LA    @14,@CF00109                                        0405
         ST    @14,@AL00001+4                                      0405
         LA    @14,DDSTRU                                          0405
         ST    @14,@AL00001+8                                      0405
         MVI   @AL00001+8,X'80'                                    0405
         L     @15,GDTPRT(,@15)                                    0405
         LA    @01,@AL00001                                        0405
         BALR  @14,@15                                             0405
*       /*************************************************************/
*       /*                                                           */
*       /* SET AREA FOR ROUTING AND DESCRIPTOR CODE TO ZERO  @Y30LB32*/
*       /* AND SET ROUTING AND DESCRIPTOR CODES              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0406
*       MSGCODE=''B;                /*                       @Y30LB32*/
         XC    MSGCODE(4),MSGCODE                                  0406
*       RTCDNO1=ON;                 /*                       @Y30LB32*/
         OI    RTCDNO1,B'10000000'                                 0407
*       DRCDNO3=ON;                 /*                       @Y30LB32*/
*                                                                  0408
         OI    DRCDNO3,B'00100000'                                 0408
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE IDC783E TO OPERATOR IDENTIFYING     @Y30LB32*/
*       /* SCRATCH CARTRIDGE EJECTED, JOBNAME AND STEPNAME   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0409
*       CALL IDCSAWO0(GDTTBL,DARGRETL,DARGRETP,ROUTECD,DESCRCD);/* 0409
*                                                            @Y30LB32*/
*                                                                  0409
         L     @15,@PC00001                                        0409
         ST    @15,@AL00001                                        0409
         L     @14,DDSTRU                                          0409
         LA    @03,DARGRETL(,@14)                                  0409
         ST    @03,@AL00001+4                                      0409
         LA    @14,DARGRETP(,@14)                                  0409
         ST    @14,@AL00001+8                                      0409
         LA    @14,ROUTECD                                         0409
         ST    @14,@AL00001+12                                     0409
         LA    @14,DESCRCD                                         0409
         ST    @14,@AL00001+16                                     0409
         MVI   @AL00001+16,X'80'                                   0409
         L     @15,GDTWTO(,@15)                                    0409
         LA    @01,@AL00001                                        0409
         BALR  @14,@15                                             0409
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE IDC0780I IDENTIFYING CSN OF SCRATCH @Y30LB32*/
*       /* CARTRIDGE EJECTED                                 @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0410
*       DARGLIST=''B;               /*                       @Y30LB32*/
         L     @15,DDSTRU                                          0410
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0410
*       DARGSMOD=EJECTMSG;          /*                       @Y30LB32*/
         MVC   DARGSMOD(3,@15),@CC00888                            0411
*       DARGSENT=MSG0780I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'01'                                 0412
*       DARGDBP=ADDR(CSNVAL);       /*                       @Y30LB32*/
         LA    @14,CSNVAL                                          0413
         ST    @14,DARGDBP(,@15)                                   0413
*       DARGILP=LENGTH(CSNVAL);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00536                             0414
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
*                                                                  0415
         L     @15,@PC00001                                        0415
         ST    @15,@AL00001                                        0415
         LA    @14,@CF00109                                        0415
         ST    @14,@AL00001+4                                      0415
         LA    @14,DDSTRU                                          0415
         ST    @14,@AL00001+8                                      0415
         MVI   @AL00001+8,X'80'                                    0415
         L     @15,GDTPRT(,@15)                                    0415
         LA    @01,@AL00001                                        0415
         BALR  @14,@15                                             0415
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT COUNT OF SCRATCH CARTRIDGES EJECTED     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0416
*       EJECTCNT=EJECTCNT+ONE;      /*                       @Y30LB32*/
*                                                                  0416
         LA    @15,1                                               0416
         AL    @15,EJECTCNT                                        0416
         ST    @15,EJECTCNT                                        0416
*       /*************************************************************/
*       /*                                                           */
*       /* FREE UP STORAGE OBTAINED BY USSC FOR THE ECB AND  @Y30LB32*/
*       /* MESSAGE AREA                                      @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0417
*       CALL IDCSAFS0(GDTTBL,MSGPTR);/*                      @Y30LB32*/
         L     @15,@PC00001                                        0417
         ST    @15,@AL00001                                        0417
         LA    @14,MSGPTR                                          0417
         ST    @14,@AL00001+4                                      0417
         L     @15,GDTFSP(,@15)                                    0417
         LA    @01,@AL00001                                        0417
         BALR  @14,@15                                             0417
*     END;                          /*                       @Y30LB32*/
*                                                                  0418
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MOVE MACRO WAS NOT SUCCESSFUL, PROCESS ERROR   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0419
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
*                                                                  0419
         B     @RC00391                                            0419
@RF00391 DS    0H                                                  0420
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF USSC COULD NOT OBTAIN STORAGE FOR        @Y30LB32*/
*       /* MESSAGE AREA                                      @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0420
*       IF TESTRC=8 THEN            /*                       @Y30LB32*/
         LA    @09,8                                               0420
         CR    TESTRC,@09                                          0420
         BNE   @RF00420                                            0420
*         MOVECOND=8;               /*                       @Y30LB32*/
*                                                                  0421
         LA    @15,8                                               0421
         LR    MOVECOND,@15                                        0421
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS FOR ERROR CODE OF FOUR                    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0422
*       ELSE                        /*                       @Y30LB32*/
*         DO;                       /*                       @Y30LB32*/
*                                                                  0422
         B     @RC00420                                            0422
@RF00420 DS    0H                                                  0423
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR REASON CODE INDICATING NO SCRATCH   @Y30LB32*/
*           /* CARTRIDGES ARE LEFT IN THE MSF AND CHECK IF   @Y30LB32*/
*           /* ALL PARAMETER WAS SPECIFIED. IF BOTH THESE    @Y30LB32*/
*           /* CONDITIONS ARE MET CHECK NUMBER OF SCRATCH    @Y30LB32*/
*           /* CARTRIDGES EJECTED. IF COUNT IS ZERO WRITE    @Y30LB32*/
*           /* MESSAGE IDC1784I                              @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0423
*           IF REASONCD=RCNOCART&   /*                       @Y30LB32*/
*               ADDR(ALLC)^=NULLPTR THEN/*                   @Y30LB32*/
         CLC   REASONCD(4),@CF00901                                0423
         BNE   @RF00423                                            0423
         SLR   @09,@09                                             0423
         L     @15,@PC00001+4                                      0423
         C     @09,FDTPTR+8(,@15)                                  0423
         BE    @RF00423                                            0423
*             IF EJECTCNT=ZERO THEN /*                       @Y30LB32*/
         C     @09,EJECTCNT                                        0424
         BNE   @RF00424                                            0424
*               DO;                 /*                       @Y30LB32*/
*                 DARGLIST=''B;     /*                       @Y30LB32*/
         L     @09,DDSTRU                                          0426
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0426
*                 DARGSMOD=EJECTMSG;/*                       @Y30LB32*/
         MVC   DARGSMOD(3,@09),@CC00888                            0427
*                 DARGSENT=MSG1784I;/*                       @Y30LB32*/
         MVI   DARGSENT(@09),X'05'                                 0428
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB32*/
*                                                                  0429
         L     @09,@PC00001                                        0429
         ST    @09,@AL00001                                        0429
         LA    @15,@CF00109                                        0429
         ST    @15,@AL00001+4                                      0429
         LA    @15,DDSTRU                                          0429
         ST    @15,@AL00001+8                                      0429
         MVI   @AL00001+8,X'80'                                    0429
         L     @15,GDTPRT(,@09)                                    0429
         LA    @01,@AL00001                                        0429
         BALR  @14,@15                                             0429
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET NO SCRATCH CARTRIDGES FOUND FALG BIT        */
*                 /*                                         @Y30LB32*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0430
*                 NOCART=ON;        /*                       @Y30LB32*/
         OI    NOCART,B'10000000'                                  0430
*               END;                /*                       @Y30LB32*/
*             ELSE                                                 0432
*               ;                   /*                       @Y30LB32*/
@RF00424 DS    0H                                                  0433
*           ELSE                    /*                       @Y30LB32*/
*                                                                  0433
*             /*******************************************************/
*             /*                                                     */
*             /* CALL SSCMSG SUBROUTINE TO WRITE             @Y30LB32*/
*             /* MESSAGE EXPLAINING REASON FOR FAILURE       @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0433
*             CALL SSCMSG(REASONCD);/*                       @Y30LB32*/
*                                                                  0433
         B     @RC00423                                            0433
@RF00423 LA    @09,REASONCD                                        0433
         ST    @09,@AL00001                                        0433
         LA    @01,@AL00001                                        0433
         BAL   @14,SSCMSG                                          0433
*           /*********************************************************/
*           /*                                                       */
*           /* SET CONDITION CODE TO INDICATE FAILURE        @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0434
*           MOVECOND=LASTCC04;      /*                       @Y30LB32*/
@RC00423 LA    MOVECOND,4                                          0434
*         END;                      /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0436
@RC00420 DS    0H                                                  0437
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET RETURN ADDRESS AND RETURN TO CALLER             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0437
*   REG14=RETADDR1;                 /*                       @Y30LB32*/
@RC00391 LR    REG14,RETADDR1                                      0437
*   RETURN CODE(MOVECOND);          /*                       @Y30LB32*/
         LR    @15,MOVECOND                                        0438
@EL00005 DS    0H                                                  0438
@EF00005 DS    0H                                                  0438
@ER00005 BR    @14                                                 0438
*   END MOVEPROC;                   /*                       @Y30LB32*/
*                                                                  0440
*/****************************************************************** */
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/
*/*             CHARACTER                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0440
*CKCSNLEN:                          /*                       @Y30LB32*/
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/
*                                                                  0440
CKCSNLEN MVC   @PC00006(8),0(@01)                                  0440
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*   DCL                                                            0441
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/
*   DCL                                                            0442
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/
*   DCL                                                            0443
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/
*   DCL                                                            0444
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/
*   DCL                                                            0445
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/
*   DCL                                                            0446
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/
*   DCL                                                            0447
*     CKCOND FIXED(15);                                            0447
*                                                                  0447
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0448
*   DCL                                                            0448
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32
*                                      CSN                   @Y30LB32*/
*   DCL                                                            0449
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32
*                                      OF CSN AGAINST        @Y30LB32*/
*   DCL                                                            0450
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/
*   DCL                                                            0451
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/
*                                                                  0452
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0452
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/
         LR    CKRETPTR,REG14                                      0452
*   OLDERID2=NEWERID2;                                             0453
         L     @10,@PC00001                                        0453
         L     @10,GDTTR2(,@10)                                    0453
         MVC   @TS00001(95),NEWERID2(@10)                          0453
         MVC   OLDERID2(95,@10),@TS00001                           0453
*   NEWID2='CKLN';                  /*                       @Y30LB32*/
*                                                                  0454
         MVC   NEWID2(4,@10),@CC00959                              0454
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0455
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/
         L     CKSAVPTR,DDSTRU                                     0455
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/
         LA    @10,CKPRTTAB                                        0456
         ST    @10,DDSTRU                                          0456
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/
         XC    CKPRTTAB(20),CKPRTTAB                               0457
*   CKCOND=''B;                     /*                       @Y30LB32*/
*                                                                  0458
         SLR   CKCOND,CKCOND                                       0458
*   /*****************************************************************/
*   /*                                                               */
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/
*   /* OR MORE                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0459
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/
*                                                                  0459
         L     @10,@PC00006+4                                      0459
         CLI   CKLENGTH(@10),11                                    0459
         BL    @RF00459                                            0459
*     /***************************************************************/
*     /*                                                             */
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/
*     /* CHARACTER                                           @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0460
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/
         CLI   CKLENGTH(@10),11                                    0460
         BNE   @RF00460                                            0460
*       DO;                         /*                       @Y30LB32*/
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/
         MVI   CKCSNADJ+3,C' '                                     0462
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/
         L     @10,@PC00006                                        0463
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@10)                       0463
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/
         MVC   CKCSNVAL+3(9,@10),CKCSNADJ+3                        0464
*       END;                        /*                       @Y30LB32*/
*     ELSE                                                         0466
*       ;                           /*                       @Y30LB32*/
*                                                                  0466
@RF00460 DS    0H                                                  0467
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC00459                                            0467
@RF00459 DS    0H                                                  0468
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/
         L     @10,DDSTRU                                          0468
         MVC   DARGSMOD(3,@10),@CC00886                            0468
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@10),X'01'                                 0469
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/
         L     @09,@PC00006                                        0470
         ST    @09,DARGDBP(,@10)                                   0470
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/
         MVC   DARGILP(2,@10),@CH00536                             0471
*       DARGRETP=''B;               /*                       @Y30LB32*/
         SLR   @09,@09                                             0472
         ST    @09,DARGRETP(,@10)                                  0472
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @10,@PC00001                                        0473
         ST    @10,@AL00001                                        0473
         LA    @09,@CF00109                                        0473
         ST    @09,@AL00001+4                                      0473
         LA    @09,DDSTRU                                          0473
         ST    @09,@AL00001+8                                      0473
         MVI   @AL00001+8,X'80'                                    0473
         L     @15,GDTPRT(,@10)                                    0473
         LA    @01,@AL00001                                        0473
         BALR  @14,@15                                             0473
*       CKCOND=4;                   /*                       @Y30LB32*/
         LA    CKCOND,4                                            0474
*     END;                          /*                       @Y30LB32*/
*                                                                  0475
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/
@RC00459 ST    CKSAVPTR,DDSTRU                                     0476
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/
         LR    REG14,CKRETPTR                                      0477
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/
         LR    @15,CKCOND                                          0478
@EL00006 DS    0H                                                  0478
@EF00006 DS    0H                                                  0478
@ER00006 BR    @14                                                 0478
*   END CKCSNLEN;                   /*                       @Y30LB32*/
*                                                                  0480
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  0480
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           0480
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00007                                    0480
         MVC   @PC00007(8),0(@01)                                  0480
*                                   /*                       @Y30LB39*/
*                                                                  0481
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0481
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*                                   /*                       @Y30LB39*/
*   DCL                                                            0481
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            0482
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0482
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0483
*                                   /*                       @Y30LB39*/
*   DCL                                                            0483
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            0484
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0484
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0485
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0485
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0485
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0486
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0486
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0486
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0487
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0487
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0487
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0488
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0488
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0489
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0489
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0490
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0490
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0490
         L     @10,@PC00001                                        0490
         L     @15,GDTTR2(,@10)                                    0490
         MVC   @TS00001(95),NEWERID2(@15)                          0490
         MVC   OLDERID2(95,@15),@TS00001                           0490
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0491
         MVC   NEWID2(4,@15),@CC00980                              0491
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0492
         LA    @15,SSDRGLT                                         0492
         ST    @15,SSDLPTR                                         0492
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              0493
         L     @14,@PC00007                                        0493
         L     @14,SSRCODE(,@14)                                   0493
         LTR   @14,@14                                             0493
         BNP   @RF00493                                            0493
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0494
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0495
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0495
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        0496
         ST    @03,DARGRETP(,@15)                                  0496
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),SSMODSS0                            0497
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 0498
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0499
         MVC   DARGRETL(2,@15),@CH00984                            0499
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0500
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0500
         ST    @10,@AL00001                                        0500
         LA    @03,@CF00109                                        0500
         ST    @03,@AL00001+4                                      0500
         LA    @03,SSDLPTR                                         0500
         ST    @03,@AL00001+8                                      0500
         MVI   @AL00001+8,X'80'                                    0500
         L     @15,GDTPRT(,@10)                                    0500
         LA    @01,@AL00001                                        0500
         BALR  @14,@15                                             0500
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0501
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          0501
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   0502
@DL00502 DS    0H                                                  0503
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00211                                   0503
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0504
@DE00502 L     @10,@PC00007                                        0504
         LR    @03,ENTRYNUM                                        0504
         ALR   @03,@03                                             0504
         LH    @03,SSARRAY-2(@03)                                  0504
         CH    @03,SSRHALF(,@10)                                   0504
         BE    @DC00502                                            0504
         SLR   @15,@15                                             0504
         CR    @03,@15                                             0504
         BNE   @DL00502                                            0504
@DC00502 DS    0H                                                  0505
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0505
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0505
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @14,SSDLPTR                                         0506
         MVC   DARGSMOD(3,@14),SSMODSS0                            0506
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@14)                             0507
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @03,@15                                             0508
         BNE   @RF00508                                            0508
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @10,DARGDBP(,@14)                                   0510
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@14),@CH00039                             0511
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0514
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0514
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC00493                                            0514
@RF00493 DS    0H                                                  0515
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0515
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @10,SSDLPTR                                         0516
         MVC   DARGSMOD(3,@10),SSMODCM0                            0516
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@10),SSMSGNUM                            0517
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @15,@PC00007+4                                      0518
         ST    @15,DARGDBP(,@10)                                   0518
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@10),@CH00211                             0519
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0520
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0521
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0521
@RC00493 L     @10,@PC00001                                        0521
         ST    @10,@AL00001                                        0521
         LA    @15,@CF00109                                        0521
         ST    @15,@AL00001+4                                      0521
         LA    @15,SSDLPTR                                         0521
         ST    @15,@AL00001+8                                      0521
         MVI   @AL00001+8,X'80'                                    0521
         L     @15,GDTPRT(,@10)                                    0521
         LA    @01,@AL00001                                        0521
         BALR  @14,@15                                             0521
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0522
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0522
         L     @14,@SA00007                                        0522
         LM    @00,@12,@SA00007+8                                  0522
         BR    @14                                                 0522
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCEC01                     /*                       @Y30LB32*/
*                                                                  0524
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSEC )                                       */
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  0524
*       ;                                                          0524
@DATA    DS    0H
@CH00145 DC    H'2'
@CH00039 DC    H'4'
@CH00981 DC    H'14'
@CH00860 DC    H'28'
@CH00982 DC    H'48'
@CH00866 DC    H'72'
@CH00984 DC    H'120'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@PC00006 DS    2F
@SA00007 DS    15F
@PC00007 DS    2F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    1F
IDCEC01  CSECT
         DS    0F
@CF00109 DC    F'0'
@CF00211 DC    F'1'
@CH00211 EQU   @CF00211+2
@CF00171 DC    F'8'
@CH00171 EQU   @CF00171+2
@CF00536 DC    F'12'
@CH00536 EQU   @CF00536+2
@CF00463 DC    F'16'
@CF00988 DC    F'-12'
@CF00987 DC    F'-11'
@CF00897 DC    XL4'23'
@CF00899 DC    XL4'C5'
@CF00901 DC    XL4'24'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
MCLSTPTR DS    A
EJECTCNT DS    F
REASONCD DS    F
MSGPTR   DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
SETRC    DS    H
ECBCODE  DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL1
PRINTTAB DS    CL20
PARMLST  DS    CL48
DUMPAREA DS    CL17
CNTALL   DS    CL3
INSERTS  DS    CL28
         ORG   INSERTS
CSNVAL   DS    CL12
NAMEAREA DS    CL16
         ORG   NAMEAREA
JOBNAME  DS    CL8
STEPNAME DS    CL8
         ORG   INSERTS+28
MSGAREA  DS    CL72
MSGCODE  DS    BL4
         ORG   MSGCODE
ROUTECD  DS    BL2
         ORG   ROUTECD
RTCDNO1  DS    BL1
@NM00062 EQU   ROUTECD+0
         ORG   MSGCODE+2
DESCRCD  DS    BL2
         ORG   DESCRCD
@NM00063 DS    BL1
DRCDNO3  EQU   DESCRCD+0
@NM00064 EQU   DESCRCD+0
         ORG   MSGCODE+4
VIERRFLG DS    BL1
NOCART   DS    BL1
CKCSNADJ DS    CL12
         DS    CL2
CKPRTTAB DS    CL20
SSDRGLT  DS    CL20
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCEC01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
SSMSGNUM DC    AL1(56)
@CC00936 DC    C'MCLIST'
@CC00908 DC    C'ECES'
@CC00909 DC    C'ECEC'
@CC00915 DC    C'ECRP'
@CC00919 DC    C'ECCP'
@CC00925 DC    C'ECCN'
@CC00929 DC    C'ECAP'
@CC00933 DC    C'ECMP'
@CC00938 DC    C'ECBM'
@CC00959 DC    C'CKLN'
@CC00980 DC    C'SSAA'
@CC00155 DC    C'ALL'
@CC00882 DC    C'UV0'
@CC00886 DC    C'CM0'
@CC00888 DC    C'EC0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
MODID    DC    CL4'EC01'
FIXAREA  DS    CL140
         ORG   FIXAREA
@NM00065 DC    140X'00'
         ORG   FIXAREA+140
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
CKCOND   EQU   @03
CKSAVPTR EQU   @06
CKRETPTR EQU   @05
RETADDR1 EQU   @10
RETADDR  EQU   @08
MOVECOND EQU   @09
ALLCOND  EQU   @05
CNTCOND  EQU   @06
CARTCOND EQU   @04
LOOPCNT  EQU   @07
DMPINDEX EQU   @02
TESTRC   EQU   @03
RTNREG   EQU   @15
REG14    EQU   @14
MCR1     EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSASS0 EQU   0
IDCSASI0 EQU   0
IDCSAWO0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CMCSN1   EQU   CMMSG+16
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00056 EQU   SV82LIST+4
SV82DCBP EQU   @NM00056
@NM00057 EQU   SV82LIST+12
SV82WRKP EQU   @NM00057
CART     EQU   0
CARTCNT  EQU   CART
@NM00058 EQU   CART+2
CARTLEN  EQU   @NM00058
CARTVAL  EQU   @NM00058+1
CNT      EQU   0
CNTVAL   EQU   CNT
ALLC     EQU   0
MSF      EQU   0
MSFVAL   EQU   MSF
MCLIST   EQU   0
MCRTFLG  EQU   MCLIST+6
MCRTSCT  EQU   MCRTFLG
MCRTLIB  EQU   MCLIST+7
MCRTCSN  EQU   MCLIST+24
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
CKCSNVAL EQU   0
CKLENGTH EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00066 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
MCRTVEXT EQU   MCLIST+44
MCRTECB  EQU   MCLIST+40
MCRTASID EQU   MCLIST+38
MCRTRES4 EQU   MCLIST+36
MCRTRES3 EQU   MCLIST+16
MCRTRES2 EQU   MCLIST+8
MCRTLD   EQU   MCRTLIB
@NM00061 EQU   MCRTLIB
@NM00060 EQU   MCRTFLG
MCRTTRAN EQU   MCRTFLG
@NM00059 EQU   MCRTFLG
MCRTRES1 EQU   MCLIST+5
MCRTOPCD EQU   MCLIST+4
MCRTLEN  EQU   MCLIST
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
@NM00055 EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00054 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00053 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00052 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00051 EQU   RCTAGL+10
@NM00050 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00049 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00048 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00047 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00046 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00045 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
@NM00044 EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSDDNAME EQU   VS2AGL+37
@NM00043 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00042 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00041 EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00040 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00039 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00038 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00037 EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00036 EQU   CKFLAGS
CKEXCL   EQU   CKFLAGS
CKDYALOC EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00035 EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00034 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMNUMCRT EQU   CMMSG+15
@NM00033 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00032 EQU   CMMSG+7
@NM00031 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00030 EQU   CCMSG+6
CCVOL    EQU   CCMSG
@NM00029 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00028 EQU   DMPITM+15
@NM00027 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00026 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00025 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00024 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGCNT  EQU   DARGLIST+14
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00023 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00022 EQU   OPNAGL+43
@NM00021 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNF EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00020 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00019 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00018 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00017 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00016 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00015 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACNF EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00256 EQU   @RC00254
@RC00301 EQU   @RC00294
@RF00508 EQU   @RC00493
@PB00007 EQU   @EL00001
@RC00309 EQU   @RC00301
@RC00312 EQU   @RC00301
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCEC01,(C'PLS2202',0603,74255)

         TITLE 'IDCEV01: EJECT VOLUME ROUTINE                          *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCEV01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCEV01   74.298'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @12,4095(,@10)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0216
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN ROUTINE FOR EJECT VOLUME FSR. IT PERFORMS    */
*   /* INITIALIZATION AND TERMINATION FUNCTIONS AND CALLS THE VARIOUS*/
*   /* SUBFUNCTION ROUTINES. INITIALIZE PRINT ARGUMENT LIST AND SET  */
*   /* TRACE POINTS                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0216
*   IF GDTDBG=NULLPTR THEN                                         0216
         L     @15,@PC00001                                        0216
         L     @15,GDTDBG(,@15)                                    0216
         LTR   @15,@15                                             0216
         BZ    @RT00216                                            0216
*     ;                                                            0217
*   ELSE                                                           0218
*     CALL IDCDB010(GDTTBL,'EVVE'); /*                       @Y30LB38*/
         L     @15,@PC00001                                        0218
         ST    @15,@AL00001                                        0218
         LA    @14,@CC01074                                        0218
         ST    @14,@AL00001+4                                      0218
         MVI   @AL00001+4,X'80'                                    0218
         L     @15,GDTDBG(,@15)                                    0218
         LA    @01,@AL00001                                        0218
         BALR  @14,@15                                             0218
*   OLDERID2=NEWERID2;                                             0219
@RT00216 L     @09,@PC00001                                        0219
         L     @09,GDTTR2(,@09)                                    0219
         MVC   @TS00001(95),NEWERID2(@09)                          0219
         MVC   OLDERID2(95,@09),@TS00001                           0219
*   NEWID2='EVVE';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@09),@CC01074                              0220
*   DDSTRU=ADDR(PRINTAB);           /*                       @Y30LB38*/
         LA    @09,PRINTAB                                         0221
         ST    @09,DDSTRU                                          0221
*   PRINTAB=''B;                    /*                       @Y30LB38*/
         XC    PRINTAB(20),PRINTAB                                 0222
*   FLAGS=''B;                      /*                       @Y30LB38*/
         MVI   FLAGS,X'00'                                         0223
*   INVERR=OFF;                     /*                       @Y30LB38*/
         NI    INVERR,B'01111111'                                  0224
*   RECFLAG=OFF;                    /*                       @Y30LB38*/
         NI    RECFLAG,B'01111111'                                 0225
*   SETRC=LASTCC00;                 /*                       @Y30LB38*/
*                                                                  0226
         SLR   @15,@15                                             0226
         LR    SETRC,@15                                           0226
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS CARTRIDGE SERIAL NUMBER SPECIFIED? IF YES, CALL   @Y30LB38*/
*   /* CKCSNLEN TO CHECK LENGTH OF SERIAL NUMBER AND         @Y30LB38*/
*   /* INSERT BLANK IN                                       @Y30LB38*/
*   /* FOURTH CHARACTER IF NECESSARY                         @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0227
*   IF ADDR(CART)^=NULLPTR THEN                                    0227
         L     @09,@PC00001+4                                      0227
         L     @09,FDTPTR+16(,@09)                                 0227
         CR    @09,@15                                             0227
         BE    @RF00227                                            0227
*     DO;                           /*                       @Y30LB38*/
*       CSNWORK=CARTVAL;            /*                       @Y30LB38*/
         MVC   CSNWORK(12),CARTVAL(@09)                            0229
*       CALL CKCSNLEN(CSNWORK,CARTLEN);/*                    @Y30LB38*/
         LA    @15,CSNWORK                                         0230
         ST    @15,@AL00001                                        0230
         ST    @09,@AL00001+4                                      0230
         LA    @01,@AL00001                                        0230
         BAL   @14,CKCSNLEN                                        0230
*       RESPECIFY                                                  0231
*         RTNREG RSTD;                                             0231
*       TESTRC=RTNREG;                                             0232
         LR    TESTRC,RTNREG                                       0232
*       RESPECIFY                                                  0233
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0234
         LTR   TESTRC,TESTRC                                       0234
         BZ    @RF00234                                            0234
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/
         L     @09,@PC00001+8                                      0235
         MVC   LASTCOND(2,@09),@CH00536                            0235
*     END;                                                         0236
*   ELSE                                                           0237
*     ;                                                            0237
@RF00227 DS    0H                                                  0238
*                                                                  0238
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR NON-ZERO RETURN CODE FROM CKCSNLEN. IF       @Y30LB38*/
*   /* ZERO, PROCEED. IF FOUR CSN WAS INVALID.               @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   IF LASTCOND=0 THEN                                             0238
@RC00227 L     @09,@PC00001+8                                      0238
         LH    @09,LASTCOND(,@09)                                  0238
         LTR   @09,@09                                             0238
         BNZ   @RF00238                                            0238
*     DO;                                                          0239
*                                                                  0239
*       /*************************************************************/
*       /*                                                           */
*       /* CALL PARMPROC TO SET UP ARGUMENT LIST TO READ THE @Y30LB38*/
*       /* INVENTORY RECORD FOR THE VOLUME TO BE EJECTED.    @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0240
*       CALL PARMPROC;              /*                       @Y30LB38*/
*                                                                  0240
         BAL   @14,PARMPROC                                        0240
*       /*************************************************************/
*       /*                                                           */
*       /* ENQUEUE ON VOLUME SERIAL NUMBER TO ENSURE EXCLUSIVE       */
*       /*                                                   @Y30LB38*/
*       /* USE                                               @Y30LB38*/
*       /* INITIALIZE Q-NAME ANE R-NAME PARAMETER LISTS      @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0241
*       RNAME=RNAMECON;             /*                       @Y30LB38*/
         MVC   RNAME(23),RNAMECON                                  0241
*       VOLSN=VOLVAL;               /*                       @Y30LB38*/
         L     @09,@PC00001+4                                      0242
         L     @09,FDTPTR(,@09)                                    0242
         MVC   VOLSN(6),VOLVAL(@09)                                0242
*       CALL IDCSANQ0(GDTTBL,EXCL,WAIT,QNAME,RNAME);/*       @Y30LB38*/
*                                                                  0243
         MVC   @AL00001+4(12),@AL00243                             0243
         L     @09,@PC00001                                        0243
         ST    @09,@AL00001                                        0243
         LA    @06,RNAME                                           0243
         ST    @06,@AL00001+16                                     0243
         MVI   @AL00001+16,X'80'                                   0243
         L     @15,GDTENQ(,@09)                                    0243
         LA    @01,@AL00001                                        0243
         BALR  @14,@15                                             0243
*       /*************************************************************/
*       /*                                                           */
*       /* CALL MSICPROC TO ACCESS REQUIRED INFO FROM THE INVENTORY  */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0244
*       CALL MSICPROC;              /*                       @Y30LB38*/
         BAL   @14,MSICPROC                                        0244
*       RESPECIFY                                                  0245
*         RTNREG RSTD;                                             0245
*       TESTRC=RTNREG;                                             0246
         LR    TESTRC,RTNREG                                       0246
*       RESPECIFY                                                  0247
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*                                                                  0248
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR NON-ZERO RETURN CODE FROM MSICPROC. IF   @Y30LB38*/
*       /* ZERO, PROCEED.                                    @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0248
*       IF TESTRC=0 THEN                                           0248
         LTR   TESTRC,TESTRC                                       0248
         BNZ   @RF00248                                            0248
*         DO;                                                      0249
*                                                                  0249
*           /*********************************************************/
*           /*                                                       */
*           /* CALL RECPROC TO SET THE RECORD OR NORECORD OPTION OR  */
*           /*                                               @Y30LB38*/
*           /* SET THE DEFAULT IF NOT SPECIFIED              @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0250
*           CALL RECPROC;                                          0250
*                                                                  0250
         BAL   @14,RECPROC                                         0250
*           /*********************************************************/
*           /*                                                       */
*           /* BUILD PARMAMETER LIST TO CALL VOLEXIT. VOLEXIT        */
*           /*                                               @Y30LB38*/
*           /* DELETES A VOLUME FROM THE INVENTORY.          @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0251
*           IF ADDR(LOC)=NULLPTR THEN                              0251
         L     @15,@PC00001+4                                      0251
         L     @15,FDTPTR+28(,@15)                                 0251
         LTR   @15,@15                                             0251
         BNZ   @RF00251                                            0251
*             LOCATION=' ';         /*                       @Y30LB38*/
         MVI   LOCATION+1,C' '                                     0252
         MVC   LOCATION+2(28),LOCATION+1                           0252
         MVI   LOCATION,C' '                                       0252
*           ELSE                                                   0253
*             LOCATION=LOCVAL;      /*                       @Y30LB38*/
         B     @RC00251                                            0253
@RF00251 L     @15,@PC00001+4                                      0253
         L     @01,FDTPTR+28(,@15)                                 0253
         MVC   LOCATION(30),LOCVAL(@01)                            0253
*           CALL VOLEXIT(CSNWORK,VOLVAL,INVERR,RECFLAG,LOCATION);  0254
@RC00251 LA    @15,CSNWORK                                         0254
         ST    @15,@AL00001                                        0254
         L     @15,@PC00001+4                                      0254
         L     @01,FDTPTR(,@15)                                    0254
         LA    @15,VOLVAL(,@01)                                    0254
         ST    @15,@AL00001+4                                      0254
         LA    @15,INVERR                                          0254
         ST    @15,@AL00001+8                                      0254
         LA    @15,RECFLAG                                         0254
         ST    @15,@AL00001+12                                     0254
         LA    @15,LOCATION                                        0254
         ST    @15,@AL00001+16                                     0254
         LA    @01,@AL00001                                        0254
         BAL   @14,VOLEXIT                                         0254
*           RESPECIFY                                              0255
*             RTNREG RSTD;                                         0255
*           TESTRC=RTNREG;                                         0256
         LR    TESTRC,RTNREG                                       0256
*           RESPECIFY                                              0257
*             RTNREG UNRSTD;        /*                       @Y30LB38*/
*                                                                  0257
*           /*********************************************************/
*           /*                                                       */
*           /* TEST RETURN CODE FROM VOLEXIT. IF 0, CONTINUE. IF     */
*           /*                                               @Y30LB38*/
*           /* 8, ONE CARTIRDGE WAS EJECTED SO SET CONDITION TO      */
*           /*                                               @Y30LB38*/
*           /* 8. IF 4, NO CARTRIDGES WERE EJECTED SO SET CON-       */
*           /*                                               @Y30LB38*/
*           /* DITION CODE TO 12.                            @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0258
*           IF TESTRC^=0 THEN                                      0258
         LTR   TESTRC,TESTRC                                       0258
         BZ    @RF00258                                            0258
*             DO;                   /*                       @Y30LB38*/
*               IF TESTRC=LASTCC08 THEN                            0260
         LA    @02,8                                               0260
         CR    TESTRC,@02                                          0260
         BNE   @RF00260                                            0260
*                 LASTCOND=LASTCC08;/*                       @Y30LB38*/
         L     @03,@PC00001+8                                      0261
         STH   @02,LASTCOND(,@03)                                  0261
*               ELSE                                               0262
*                 LASTCOND=LASTCC12;/*                       @Y30LB38*/
         B     @RC00260                                            0262
@RF00260 L     @15,@PC00001+8                                      0262
         MVC   LASTCOND(2,@15),@CH00536                            0262
*             END;                                                 0263
*                                                                  0263
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE VOLUME WAS EJECTED BUT AN ERROR PREVENTED      */
*           /*                                               @Y30LB38*/
*           /* THE INVENTORY FROM BEING UPDATED, SET THE CONDI-      */
*           /*                                               @Y30LB38*/
*           /* TION CODE TO 4                                @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0264
*           ELSE                                                   0264
*             DO;                   /*                       @Y30LB38*/
         B     @RC00258                                            0264
@RF00258 DS    0H                                                  0265
*               IF INVERR=ON THEN                                  0265
         TM    INVERR,B'10000000'                                  0265
         BNO   @RF00265                                            0265
*                 LASTCOND=LASTCC04;/*                       @Y30LB38*/
         L     @15,@PC00001+8                                      0266
         MVC   LASTCOND(2,@15),@CH00041                            0266
*               ELSE                                               0267
*                 ;                 /*                       @Y30LB38*/
@RF00265 DS    0H                                                  0268
*             END;                  /*                       @Y30LB38*/
*         END;                                                     0269
*                                                                  0269
*       /*************************************************************/
*       /*                                                           */
*       /* MSICPROC FOUND AN ERROR READING THE INVENTORY FOR @Y30LB38*/
*       /* THE RECORD, SO SET THE FINAL CONDITION CODE TO 12 @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0270
*       ELSE                        /*                       @Y30LB38*/
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/
*                                                                  0270
         B     @RC00248                                            0270
@RF00248 L     @15,@PC00001+8                                      0270
         MVC   LASTCOND(2,@15),@CH00536                            0270
*       /*************************************************************/
*       /*                                                           */
*       /* DEQUENE THE ENQUENE ON THE VOLUME SERIAL NUMBER   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0271
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAME);/*                 @Y30LB38*/
@RC00248 L     @15,@PC00001                                        0271
         ST    @15,@AL00001                                        0271
         LA    @14,@CC01065                                        0271
         ST    @14,@AL00001+4                                      0271
         LA    @14,RNAME                                           0271
         ST    @14,@AL00001+8                                      0271
         MVI   @AL00001+8,X'80'                                    0271
         L     @15,GDTDEQ(,@15)                                    0271
         LA    @01,@AL00001                                        0271
         BALR  @14,@15                                             0271
*     END;                                                         0272
*   ELSE                                                           0273
*     ;                                                            0273
@RF00238 DS    0H                                                  0274
*                                                                  0274
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD PARAMETER LIST FOR UPRINT MACRO. IF THE         @Y30LB38*/
*   /* CONDITION CODE IS => 12 THEN MESSAGE IDC0003I IS PRINTED.     */
*   /* OTHERWISE, MESSAGE IDC0001I IS PRINTED                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0274
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB38*/
         L     @15,DDSTRU                                          0274
         MVC   DARGSMOD(3,@15),@CC01057                            0274
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB38*/
         L     @14,@PC00001+8                                      0275
         ST    @14,DARGDBP(,@15)                                   0275
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB38*/
         MVC   DARGILP(2,@15),@CH00147                             0276
*   IF LASTCOND=>LASTCC12 THEN                                     0277
         LH    @14,LASTCOND(,@14)                                  0277
         C     @14,@CF00536                                        0277
         BL    @RF00277                                            0277
*     DARGSENT=MSG0003I;            /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'01'                                 0278
*   ELSE                                                           0279
*     DARGSENT=MSG0001I;            /*                       @Y30LB38*/
*                                                                  0279
         B     @RC00277                                            0279
@RF00277 L     @01,DDSTRU                                          0279
         MVI   DARGSENT(@01),X'01'                                 0279
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN A FULL REGION DUMP IF THE DUMP OPTION IS SET   @Y30LB38*/
*   /* AND RETURN TO THE AMS EXECUTIVE                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                          0280
@RC00277 L     @15,@PC00001                                        0280
         ST    @15,@AL00001                                        0280
         LA    @14,@CF00111                                        0280
         ST    @14,@AL00001+4                                      0280
         LA    @14,DDSTRU                                          0280
         ST    @14,@AL00001+8                                      0280
         MVI   @AL00001+8,X'80'                                    0280
         L     @15,GDTPRT(,@15)                                    0280
         LA    @01,@AL00001                                        0280
         BALR  @14,@15                                             0280
*   IF GDTDBG=NULLPTR THEN                                         0281
         L     @15,@PC00001                                        0281
         L     @15,GDTDBG(,@15)                                    0281
         LTR   @15,@15                                             0281
         BZ    @RT00281                                            0281
*     ;                                                            0282
*   ELSE                                                           0283
*     CALL IDCDB010(GDTTBL,'EVRC'); /*                       @Y30LB38*/
         L     @15,@PC00001                                        0283
         ST    @15,@AL00001                                        0283
         LA    @14,@CC01083                                        0283
         ST    @14,@AL00001+4                                      0283
         MVI   @AL00001+4,X'80'                                    0283
         L     @15,GDTDBG(,@15)                                    0283
         LA    @01,@AL00001                                        0283
         BALR  @14,@15                                             0283
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0284
*                                                                  0284
@RT00281 L     @15,@PC00001                                        0284
         ST    @15,@AL00001                                        0284
         LA    @14,MODID                                           0284
         ST    @14,@AL00001+4                                      0284
         L     @14,@PC00001+8                                      0284
         ST    @14,@AL00001+8                                      0284
         MVI   @AL00001+8,X'80'                                    0284
         L     @15,GDTEPL(,@15)                                    0284
         LA    @01,@AL00001                                        0284
         BALR  @14,@15                                             0284
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0285
*                                                                  0285
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - PARMPROC                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - CHECK THE INPUT PARAMETERS AND BUILD      @Y30LB38*/
*/*                RVVILIST TO READ THE RECORD FROM THE      @Y30LB38*/
*/*                MASS STORAGE VOLUME INVENTORY.            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - FUNCTION DEFINITION TABLE                    @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - THE COMPLETED RVVILIST.                     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0285
*PARMPROC:                                                         0285
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
@EL00001 L     @13,4(,@13)                                         0285
@EF00001 L     @00,@SIZDATD                                        0285
         LR    @01,@11                                             0285
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0285
         BR    @14                                                 0285
PARMPROC DS    0H                                                  0286
*                                                                  0286
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDR                                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0286
*   RETADDR1=REG14;                 /*                       @Y30LB38*/
         LR    RETADDR1,REG14                                      0286
*   OLDERID2=NEWERID2;                                             0287
         L     @09,@PC00001                                        0287
         L     @09,GDTTR2(,@09)                                    0287
         MVC   @TS00001(95),NEWERID2(@09)                          0287
         MVC   OLDERID2(95,@09),@TS00001                           0287
*   NEWID2='EVPC';                  /*                       @Y30LB38*/
*                                                                  0288
         MVC   NEWID2(4,@09),@CC01087                              0288
*   /*****************************************************************/
*   /*                                                               */
*   /* INITILAIZE BUFFER AND RVVILIST                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   VVIREC=''B;                     /*                       @Y30LB38*/
         XC    VVIREC(224),VVIREC                                  0289
*   BASEVPTR=ADDR(VVIREC);          /*                       @Y30LB38*/
         LA    @09,VVIREC                                          0290
         LR    BASEVPTR,@09                                        0290
*   BCDVPTR=ADDR(VVIREC);           /*                       @Y30LB38*/
         LR    BCDVPTR,@09                                         0291
*   RVVIPTR=ADDR(VVILIST);          /*                       @Y30LB38*/
         LA    @05,VVILIST                                         0292
         ST    @05,RVVIPTR                                         0292
*   RVVI=''B;                       /*                       @Y30LB38*/
*                                                                  0293
         XC    RVVI(68,@05),RVVI(@05)                              0293
*   /*****************************************************************/
*   /*                                                               */
*   /* SET OP CODE AND LENGTH IN RVVI LIST                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   RVVCODE=RVVOP;                  /*                       @Y30LB38*/
         MVI   RVVCODE(@05),X'87'                                  0294
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB38*/
*                                                                  0295
         LH    @15,RVVLEN                                          0295
         ST    @15,RVVLNGTH(,@05)                                  0295
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE REMAINING REQUIRED FIELDS              @Y30LB38*/
*   /* IN THE RVVI LIST                                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0296
*   RVVBUFLN=LENGTH(VVIREC);        /*                       @Y30LB38*/
         MVC   RVVBUFLN(2,@05),@CH01239                            0296
*   RVVRDR=ON;                      /*                       @Y30LB38*/
         OI    RVVRDR(@05),B'10000000'                             0297
*   RVVRTBUF=ADDR(VVIREC);          /*                       @Y30LB38*/
         ST    @09,RVVRTBUF(,@05)                                  0298
*   RVVOLUME=VOLVAL;                /*                       @Y30LB38*/
         L     @09,@PC00001+4                                      0299
         L     @01,FDTPTR(,@09)                                    0299
         MVC   RVVOLUME(6,@05),VOLVAL(@01)                         0299
*   RVVSVOL=ON;                     /*                       @Y30LB38*/
*                                                                  0300
         OI    RVVSVOL(@05),B'00000001'                            0300
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS THE COPYDATE SPECIFIED? IF YES SET VALUES         @Y30LB38*/
*   /* IN THE RVVI LIST. IF NO, CHECK FOR CARTRIDGE SERIAL   @Y30LB38*/
*   /* NUMBER SPECIFIED AND SET CSN IN THE RVVI LIST.        @Y30LB38*/
*   /* IF NEITHER COPYDATE OR CSN WERE SPECIFIED, TURN ON    @Y30LB38*/
*   /* FLAG TO READ BASE VOLUME RECORD.                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0301
*   IF ADDR(CDATE)^=NULLPTR THEN                                   0301
         SLR   @15,@15                                             0301
         C     @15,FDTPTR+4(,@09)                                  0301
         BE    @RF00301                                            0301
*     DO;                           /*                       @Y30LB38*/
*       RVVCPYRC=ON;                /*                       @Y30LB38*/
         OI    RVVCPYRC(@05),B'00100000'                           0303
*       CVD(DATEVAL,RVVCDATE);      /*                       @Y30LB38*/
         L     @01,FDTPTR+8(,@09)                                  0304
         L     @14,DATEVAL(,@01)                                   0304
         CVD   @14,@TS00001                                        0304
         MVC   RVVCDATE(4,@05),@TS00001+4                          0304
*       RVVSDTE=ON;                 /*                       @Y30LB38*/
         OI    RVVSDTE(@05),B'00100000'                            0305
*       IF ADDR(SEQ)^=NULLPTR THEN                                 0306
         L     @09,FDTPTR+12(,@09)                                 0306
         CR    @09,@15                                             0306
         BE    @RF00306                                            0306
*         DO;                       /*                       @Y30LB38*/
*           RVVRDSEQ=SEQVAL;        /*                       @Y30LB38*/
         MVC   RVVRDSEQ(1,@05),SEQVAL+3(@09)                       0308
*           RVVSSEQ=ON;             /*                       @Y30LB38*/
         OI    RVVSSEQ(@05),B'00010000'                            0309
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*   ELSE                            /*                       @Y30LB38*/
*     DO;                           /*                       @Y30LB38*/
         B     @RC00301                                            0312
@RF00301 DS    0H                                                  0313
*       IF ADDR(CART)^=NULLPTR THEN                                0313
         L     @09,@PC00001+4                                      0313
         L     @09,FDTPTR+16(,@09)                                 0313
         LTR   @09,@09                                             0313
         BZ    @RF00313                                            0313
*         DO;                       /*                       @Y30LB38*/
*           RVVRDCSN=CSNWORK;       /*                       @Y30LB38*/
         L     @09,RVVIPTR                                         0315
         MVC   RVVRDCSN(12,@09),CSNWORK                            0315
*           RVVRUNKN=ON;            /*                       @Y30LB38*/
         OI    RVVRUNKN(@09),B'00001000'                           0316
*           RVVSCSN=ON;             /*                       @Y30LB38*/
         OI    RVVSCSN(@09),B'00001000'                            0317
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       0319
*         RVVBVRCD=ON;              /*                       @Y30LB38*/
         B     @RC00313                                            0319
@RF00313 L     @09,RVVIPTR                                         0319
         OI    RVVBVRCD(@09),B'10000000'                           0319
*     END;                          /*                       @Y30LB38*/
*                                                                  0320
@RC00313 DS    0H                                                  0321
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO THE CALLER       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0321
*   REG14=RETADDR1;                 /*                       @Y30LB38*/
@RC00301 LR    REG14,RETADDR1                                      0321
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             0322
@EL00002 DS    0H                                                  0322
@EF00002 DS    0H                                                  0322
@ER00002 BR    @14                                                 0322
*   END PARMPROC;                   /*                       @Y30LB38*/
*                                                                  0324
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - MSICPROC                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - ISSUES USSC MACRO TO OBTAIN VOLUME RECORD @Y30LB38*/
*/*                FROM THE INVENTORY, CHECKS THE RECORD FOR @Y30LB38*/
*/*                SITUATIONS THAT PREVENT EJECTING THE      @Y30LB38*/
*/*                VOLUME.  ALSO CHECKS THAT THERE ARE TWO   @Y30LB38*/
*/*                DUPLICATE RECORDS FOR THE VOLUME IN THE   @Y30LB38*/
*/*                INVENTORY, IF THE USER SPECIFIED ONLY     @Y30LB38*/
*/*                THE VOLUME SERIAL NUMBER.                 @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - FUNCTION DEFINITION TABLE, AND THE RVVILIST. @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - THE FIRST CSN ASSOCIATED WITH THE VOLUME    @Y30LB38*/
*/*              SPECIFIED AND A RETURN CODE OF 00 OR 04.    @Y30LB38*/
*/*              THE 04 RETURN CODE IS FOR ONE OF THE        @Y30LB38*/
*/*              FOLLOWING REASONS: 1) VOLUME RECORD COULD   @Y30LB38*/
*/*              NOT BE ACCESSED, 2) A RECOVERY FLAG WAS ON, @Y30LB38*/
*/*              3) A DUPLICATE RECORD WAS FOUND OR 4)       @Y30LB38*/
*/*              THE VOLUME WAS ACTIVE.                      @Y30LB38*/
*/*              ALSO, THE RRCDFAIL FLAG IS SET IF A RECORD  @Y30LB38*/
*/*              COULD NOT BE FOUND BUT THE VOLUME CAN BE    @Y30LB38*/
*/*              EJECTED.                                    @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0324
*MSICPROC:                                                         0324
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0324
MSICPROC DS    0H                                                  0325
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   DCL                                                            0325
*     CODE2 FIXED(15);              /* CONDITION CODE        @Y30LB38*/
*                                                                  0326
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN REGISTER AND INITIALIZE THE CONDI-    @Y30LB38*/
*   /* TION CODE AREA TO 0.                                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0326
*   RETADDR1=REG14;                 /*                       @Y30LB38*/
         LR    RETADDR1,REG14                                      0326
*   OLDERID2=NEWERID2;                                             0327
         L     @09,@PC00001                                        0327
         L     @15,GDTTR2(,@09)                                    0327
         MVC   @TS00001(95),NEWERID2(@15)                          0327
         MVC   OLDERID2(95,@15),@TS00001                           0327
*   NEWID2='EVVP';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01093                              0328
*   CODE2='0'X;                     /*                       @Y30LB38*/
*                                                                  0329
         SLR   CODE2,CODE2                                         0329
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE UDUMP OF PARMAMETER                              @Y30LB38*/
*   /* LIST TO READ INVENTORY (VVILIST)                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0330
*   IF GDTDBG=NULLPTR THEN                                         0330
         L     @09,GDTDBG(,@09)                                    0330
         LTR   @09,@09                                             0330
         BZ    @RT00330                                            0330
*     ;                                                            0331
*   ELSE                                                           0332
*     DO;                                                          0332
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Y30LB38*/
         LA    DMPINDEX,DMPSTG                                     0333
*       DMPITMNM='VVILIST';                                        0334
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0334
         MVC   DMPITMNM(7,DMPINDEX),@CC01095                       0334
*       DMPITMPT=ADDR(RVVIPTR);                                    0335
         LA    @09,RVVIPTR                                         0335
         ST    @09,DMPITMPT(,DMPINDEX)                             0335
*       DMPITMLN=LENGTH(VVILIST);                                  0336
         MVC   DMPITMLN(2,DMPINDEX),@CH01240                       0336
*       DMPITMTP='H';                                              0337
         MVI   DMPITMTP(DMPINDEX),C'H'                             0337
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0338
*                                                                  0338
         AL    DMPINDEX,@CF00465                                   0338
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0339
*       DMPTRM=DMPTRMVL;                                           0339
         MVI   DMPTRM(DMPINDEX),X'FF'                              0339
*     END;                          /*                       @Y30LB38*/
*   IF GDTDBG=NULLPTR THEN                                         0341
@RT00330 L     @09,@PC00001                                        0341
         L     @09,GDTDBG(,@09)                                    0341
         LTR   @09,@09                                             0341
         BZ    @RT00341                                            0341
*     ;                                                            0342
*   ELSE                                                           0343
*     CALL IDCDB010(GDTTBL,'EVBR',ADDR(DMPSTG));/*           @Y30LB38*/
*                                                                  0343
         L     @09,@PC00001                                        0343
         ST    @09,@AL00001                                        0343
         LA    @15,@CC01097                                        0343
         ST    @15,@AL00001+4                                      0343
         LA    @15,DMPSTG                                          0343
         ST    @15,@AFTEMPS                                        0343
         LA    @15,@AFTEMPS                                        0343
         ST    @15,@AL00001+8                                      0343
         MVI   @AL00001+8,X'80'                                    0343
         L     @15,GDTDBG(,@09)                                    0343
         LA    @01,@AL00001                                        0343
         BALR  @14,@15                                             0343
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO OBTAIN VOLUME RECORD FROM         @Y30LB38*/
*   /* INVENTORY                                             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0344
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB38*/
@RT00341 L     @09,@PC00001                                        0344
         ST    @09,@AL00001                                        0344
         LA    @02,VVIC                                            0344
         ST    @02,@AL00001+4                                      0344
         LA    @02,RVVIPTR                                         0344
         ST    @02,@AL00001+8                                      0344
         LA    @02,REASONCD                                        0344
         ST    @02,@AL00001+12                                     0344
         MVI   @AL00001+12,X'80'                                   0344
         L     @15,GDTSSC(,@09)                                    0344
         LA    @01,@AL00001                                        0344
         BALR  @14,@15                                             0344
*   RESPECIFY                                                      0345
*     RTNREG RSTD;                                                 0345
*   TESTRC=RTNREG;                                                 0346
         LR    TESTRC,RTNREG                                       0346
*   RESPECIFY                                                      0347
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*                                                                  0348
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RETURN CODE FROM USSC IS NOT SUCCESSFUL,           @Y30LB38*/
*   /* PROCESS AN ERROR READING THE INVENTORY                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*   IF TESTRC^=0 THEN                                              0348
         LTR   TESTRC,TESTRC                                       0348
         BZ    @RF00348                                            0348
*     DO;                           /*                       @Y30LB38*/
*                                                                  0349
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE ERROR IS OTHER THAN RECORD NOT FOUND, CALL @Y30LB38*/
*       /* SSCMSG ROUTINE TO ISSUE AN ERROR MESSAGE BASED ON @Y30LB38*/
*       /* REASON CODE                                       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0350
*       IF REASONCD^=NOREC THEN                                    0350
         CLC   REASONCD(4),NOREC                                   0350
         BE    @RF00350                                            0350
*         DO;                       /*                       @Y30LB38*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB38*/
         LA    @15,REASONCD                                        0352
         ST    @15,@AL00001                                        0352
         LA    @01,@AL00001                                        0352
         BAL   @14,SSCMSG                                          0352
*           CODE2=LASTCC04;         /*                       @Y30LB38*/
         LA    CODE2,4                                             0353
*         END;                      /*                       @Y30LB38*/
*                                                                  0354
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RECORD COULD NOT BE FOUND IN THE INVENTORY,        */
*       /*                                                   @Y30LB38*/
*       /* SEE IF THE CARTRIDGE SERIAL NUMBER WAS SPECIFIED  @Y30LB38*/
*       /* BY THE USER. IF IT WAS, DO NOT CONSIDER THIS AN   @Y30LB38*/
*       /* ERROR SINCE THERE IS SUFFICIENT INFO TO EJECT THE @Y30LB38*/
*       /* VOLUME. SET A FLAG TO INDICATE THERE IS NO RECORD.        */
*       /*                                                   @Y30LB38*/
*       /* IF CARTRIDGE SERIAL NO. IS NOT SPECIFIED, CONSIDER        */
*       /*                                                   @Y30LB38*/
*       /* IT AN ERROR AND CALL THE SSCMSG ROUTINE TO ISSUE  @Y30LB38*/
*       /* AN ERROR MSG                                      @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0355
*       ELSE                                                       0355
*         DO;                       /*                       @Y30LB38*/
         B     @RC00350                                            0355
@RF00350 DS    0H                                                  0356
*           IF ADDR(CART)^=NULLPTR THEN                            0356
         L     @04,@PC00001+4                                      0356
         L     @04,FDTPTR+16(,@04)                                 0356
         LTR   @04,@04                                             0356
         BZ    @RF00356                                            0356
*             RRCDFAIL=ON;          /*                       @Y30LB38*/
         OI    RRCDFAIL,B'10000000'                                0357
*           ELSE                                                   0358
*             DO;                   /*                       @Y30LB38*/
         B     @RC00356                                            0358
@RF00356 DS    0H                                                  0359
*               CALL SSCMSG(REASONCD);/*                     @Y30LB38*/
         LA    @15,REASONCD                                        0359
         ST    @15,@AL00001                                        0359
         LA    @01,@AL00001                                        0359
         BAL   @14,SSCMSG                                          0359
*               CODE2=LASTCC04;     /*                       @Y30LB38*/
         LA    CODE2,4                                             0360
*             END;                  /*                       @Y30LB38*/
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  0364
*   /*****************************************************************/
*   /*                                                               */
*   /* IF USSC WAS SUCCESSFUL IN READING A RECORD, IN-       @Y30LB38*/
*   /* SPECT THE RECORD                                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   ELSE                                                           0364
*     DO;                           /*                       @Y30LB38*/
*                                                                  0364
         B     @RC00348                                            0364
@RF00348 DS    0H                                                  0365
*       /*************************************************************/
*       /*                                                           */
*       /* TEST IF THIS IS A BASE VOLUME. IF YES, CALL DUPVCHK       */
*       /*                                                   @Y30LB38*/
*       /* ROUTINE TO CHECK FOR DUPLICATE VOLUME IF CARTRIDGE        */
*       /*                                                   @Y30LB38*/
*       /* NOT SPECIFIED. IF NO,TEST FOR VOLUME BEING A      @Y30LB38*/
*       /* COPIED VOLUME.                                    @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0365
*       IF BCDBASE=ON THEN                                         0365
         TM    BCDBASE(BCDVPTR),B'00100000'                        0365
         BNO   @RF00365                                            0365
*         DO;                       /*                       @Y30LB38*/
*           IF ADDR(CART)=NULLPTR THEN                             0367
         L     @09,@PC00001+4                                      0367
         L     @09,FDTPTR+16(,@09)                                 0367
         LTR   @09,@09                                             0367
         BNZ   @RF00367                                            0367
*             DO;                   /*                       @Y30LB38*/
*               CALL DUPVCHK;       /*                       @Y30LB38*/
         BAL   @14,DUPVCHK                                         0369
*               RESPECIFY                                          0370
*                 RTNREG RSTD;                                     0370
*               TESTRC=RTNREG;                                     0371
         LR    TESTRC,RTNREG                                       0371
*               RESPECIFY                                          0372
*                 RTNREG UNRSTD;    /*                       @Y30LB38*/
*               CODE2=TESTRC;       /*                       @Y30LB38*/
         LR    CODE2,TESTRC                                        0373
*             END;                  /*                       @Y30LB38*/
*                                                                  0374
*           /*********************************************************/
*           /*                                                       */
*           /* IF A DUPLICATE RECORD WAS NOT FOUND, CONTINUE WITH    */
*           /*                                               @Y30LB38*/
*           /* INSPECTION OF RECORD                          @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0375
*           IF TESTRC=0 THEN                                       0375
@RF00367 LTR   TESTRC,TESTRC                                       0375
         BNZ   @RF00375                                            0375
*             DO;                   /*                       @Y30LB38*/
*                                                                  0376
*               /*****************************************************/
*               /*                                                   */
*               /* TEST THE RECOVERY FLAGS AND PRINT THE APPROPRIATE */
*               /*                                           @Y30LB38*/
*               /* MESSAGE WITH THE UPRINT MACRO. IF THE BASIVCRE    */
*               /* FLAG IS ON INDICATING INCOMPLETE CREATE, MESSAGE  */
*               /* IDC3097I IS WRITTEN. IF BASIVCPY IS ON INDICATING */
*               /* INCOMPLETE COPY, MESSAGE IDC3096I IS WRITTEN. IF  */
*               /* BASVSMIS IS ON INDICATING INCOMPLETE RENAME,      */
*               /* MESSAGE IDC3095I IS WRITTEN               @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0377
*               IF BASIVCRE=ONBASIVCPY=ONBASVSMIS=ON THEN        0377
         TM    BASIVCRE(BASEVPTR),B'11100000'                      0377
         BZ    @RF00377                                            0377
*                 DO;               /*                       @Y30LB38*/
*                   DARGSMOD=CMOVMSG;/*                      @Y30LB38*/
         L     @05,DDSTRU                                          0379
         MVC   DARGSMOD(3,@05),@CC01061                            0379
*                   DARGDBP=ADDR(VOLVAL);/*                  @Y30LB38*/
         L     @15,@PC00001+4                                      0380
         L     @01,FDTPTR(,@15)                                    0380
         LA    @15,VOLVAL(,@01)                                    0380
         ST    @15,DARGDBP(,@05)                                   0380
*                   DARGILP=LENGTH(VOLVAL);/*                @Y30LB38*/
         MVC   DARGILP(2,@05),@CH00150                             0381
*                   IF BASIVCRE=ON THEN                            0382
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0382
         BNO   @RF00382                                            0382
*                     DARGSENT=MSG3097I;/*                   @Y30LB38*/
         MVI   DARGSENT(@05),X'03'                                 0383
*                   IF BASIVCPY=ON THEN                            0384
@RF00382 TM    BASIVCPY(BASEVPTR),B'01000000'                      0384
         BNO   @RF00384                                            0384
*                     DARGSENT=MSG3096I;/*                   @Y30LB38*/
         L     @05,DDSTRU                                          0385
         MVI   DARGSENT(@05),X'06'                                 0385
*                   IF BASVSMIS=ON THEN                            0386
@RF00384 TM    BASVSMIS(BASEVPTR),B'00100000'                      0386
         BNO   @RF00386                                            0386
*                     DARGSENT=MSG3095I;/*                   @Y30LB38*/
         L     @01,DDSTRU                                          0387
         MVI   DARGSENT(@01),X'09'                                 0387
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB38*/
@RF00386 L     @04,@PC00001                                        0388
         ST    @04,@AL00001                                        0388
         LA    @15,@CF00111                                        0388
         ST    @15,@AL00001+4                                      0388
         LA    @15,DDSTRU                                          0388
         ST    @15,@AL00001+8                                      0388
         MVI   @AL00001+8,X'80'                                    0388
         L     @15,GDTPRT(,@04)                                    0388
         LA    @01,@AL00001                                        0388
         BALR  @14,@15                                             0388
*                   CODE2=LASTCC04; /*                       @Y30LB38*/
         LA    CODE2,4                                             0389
*                 END;              /*                       @Y30LB38*/
*                                                                  0390
*               /*****************************************************/
*               /*                                                   */
*               /* TEST IF THE VOLUME IS INACTIVE. IF NOT, USE       */
*               /*                                           @Y30LB38*/
*               /* UPRINT MACRO TO PRINT MESSAGE IDC3770I. IF IT IS, */
*               /* RETURN WITH CSN.                          @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0391
*               ELSE                                               0391
*                 DO;               /*                       @Y30LB38*/
         B     @RC00377                                            0391
@RF00377 DS    0H                                                  0392
*                   IF BASINAC=OFF THEN                            0392
         TM    BASINAC(BASEVPTR),B'00000100'                       0392
         BNZ   @RF00392                                            0392
*                     DO;           /*                       @Y30LB38*/
*                       DARGSMOD=EVOVMSG;/*                  @Y30LB38*/
         L     @04,DDSTRU                                          0394
         MVC   DARGSMOD(3,@04),@CC01059                            0394
*                       DARGDBP=ADDR(VOLVAL);/*              @Y30LB38*/
         L     @15,@PC00001+4                                      0395
         L     @01,FDTPTR(,@15)                                    0395
         LA    @15,VOLVAL(,@01)                                    0395
         ST    @15,DARGDBP(,@04)                                   0395
*                       DARGILP=LENGTH(VOLVAL);/*            @Y30LB38*/
         MVC   DARGILP(2,@04),@CH00150                             0396
*                       DARGSENT=MSG3770I;/*                 @Y30LB38*/
         MVI   DARGSENT(@04),X'01'                                 0397
*                       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    0398
*                                                            @Y30LB38*/
         L     @04,@PC00001                                        0398
         ST    @04,@AL00001                                        0398
         LA    @15,@CF00111                                        0398
         ST    @15,@AL00001+4                                      0398
         LA    @15,DDSTRU                                          0398
         ST    @15,@AL00001+8                                      0398
         MVI   @AL00001+8,X'80'                                    0398
         L     @15,GDTPRT(,@04)                                    0398
         LA    @01,@AL00001                                        0398
         BALR  @14,@15                                             0398
*                       CODE2=LASTCC04;/*                    @Y30LB38*/
         LA    CODE2,4                                             0399
*                     END;          /*                       @Y30LB38*/
*                                                                  0400
*                   /*************************************************/
*                   /*                                               */
*                   /* IF NO ERRORS HAVE BEEN FOUND, PUT THE         */
*                   /* CARTRIDGE                             @Y30LB38*/
*                   /* SERIAL NUMBER OF THE FIRST CARTRIDGE FROM THE */
*                   /* RECORD INTO A WORK AREA TO RETURN TO THE      */
*                   /* CALLER                                @Y30LB38*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0401
*                   ELSE                                           0401
*                     CSNWORK=BASCSN1;/*                     @Y30LB38*/
         B     @RC00392                                            0401
@RF00392 MVC   CSNWORK(12),BASCSN1(BASEVPTR)                       0401
*                 END;              /*                       @Y30LB38*/
*             END;                  /*                       @Y30LB38*/
*                                                                  0403
*           /*********************************************************/
*           /*                                                       */
*           /* IF A DUPLICATE RECORD WAS FOUND, SET CONDITION        */
*           /*                                               @Y30LB38*/
*           /* CODE TO 4                                     @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0404
*           ELSE                                                   0404
*             CODE2=LASTCC04;       /*                       @Y30LB38*/
         B     @RC00375                                            0404
@RF00375 LA    CODE2,4                                             0404
*         END;                      /*                       @Y30LB38*/
*                                                                  0406
*       /*************************************************************/
*       /*                                                           */
*       /* IF RECORD IS NOT A BASE VOLUME, TEST FOR IT BEING @Y30LB38*/
*       /* A COPY RECORD                                     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0406
*       ELSE                                                       0406
*         DO;                       /*                       @Y30LB38*/
*                                                                  0406
         B     @RC00365                                            0406
@RF00365 DS    0H                                                  0407
*           /*********************************************************/
*           /*                                                       */
*           /* IF NOT A COPY RECORD, THEN NO INSPECTION NEEDS TO     */
*           /*                                               @Y30LB38*/
*           /* BE DONE. RETURN WITH CSN1                     @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0407
*           IF BCDCOPY=OFF THEN                                    0407
         TM    BCDCOPY(BCDVPTR),B'00010000'                        0407
         BNZ   @RF00407                                            0407
*             CSNWORK=BASCSN1;      /*                       @Y30LB38*/
*                                                                  0408
         MVC   CSNWORK(12),BASCSN1(BASEVPTR)                       0408
*           /*********************************************************/
*           /*                                                       */
*           /* IF A COPY RECORD, INSPECT IT                  @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0409
*           ELSE                                                   0409
*             DO;                   /*                       @Y30LB38*/
*                                                                  0409
         B     @RC00407                                            0409
@RF00407 DS    0H                                                  0410
*               /*****************************************************/
*               /*                                                   */
*               /* TEST IF THE COPY IS COMPLETE. IF YES, RETURN      */
*               /*                                           @Y30LB38*/
*               /* WITH THE CSN. IF NO, USE UPRINT MACRO TO PRINT    */
*               /* MESSAGE IDC3096I.                         @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0410
*               IF BCDIVCPY=OFF THEN                               0410
         TM    BCDIVCPY(BCDVPTR),B'01000000'                       0410
         BNZ   @RF00410                                            0410
*                 CSNWORK=BASCSN1;  /*                       @Y30LB38*/
         MVC   CSNWORK(12),BASCSN1(BASEVPTR)                       0411
*               ELSE                                               0412
*                 DO;               /*                       @Y30LB38*/
         B     @RC00410                                            0412
@RF00410 DS    0H                                                  0413
*                   DARGSMOD=CMOVMSG;/*                      @Y30LB38*/
         L     @04,DDSTRU                                          0413
         MVC   DARGSMOD(3,@04),@CC01061                            0413
*                   DARGDBP=ADDR(VOLVAL);/*                  @Y30LB38*/
         L     @15,@PC00001+4                                      0414
         L     @01,FDTPTR(,@15)                                    0414
         LA    @15,VOLVAL(,@01)                                    0414
         ST    @15,DARGDBP(,@04)                                   0414
*                   DARGILP=LENGTH(VOLVAL);/*                @Y30LB38*/
         MVC   DARGILP(2,@04),@CH00150                             0415
*                   DARGSENT=MSG3096I;/*                     @Y30LB38*/
         MVI   DARGSENT(@04),X'06'                                 0416
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB38*/
         L     @04,@PC00001                                        0417
         ST    @04,@AL00001                                        0417
         LA    @15,@CF00111                                        0417
         ST    @15,@AL00001+4                                      0417
         LA    @15,DDSTRU                                          0417
         ST    @15,@AL00001+8                                      0417
         MVI   @AL00001+8,X'80'                                    0417
         L     @15,GDTPRT(,@04)                                    0417
         LA    @01,@AL00001                                        0417
         BALR  @14,@15                                             0417
*                   CODE2=LASTCC04; /*                       @Y30LB38*/
         LA    CODE2,4                                             0418
*                 END;              /*                       @Y30LB38*/
*             END;                  /*                       @Y30LB38*/
@RC00410 DS    0H                                                  0421
*         END;                      /*                       @Y30LB38*/
@RC00407 DS    0H                                                  0422
*     END;                          /*                       @Y30LB38*/
*                                                                  0422
@RC00365 DS    0H                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE RETURN ADDRESS AND RETURN TO THE          @Y30LB38*/
*   /* CALLER                                                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   REG14=RETADDR1;                 /*                       @Y30LB38*/
@RC00348 LR    REG14,RETADDR1                                      0423
*   RETURN CODE(CODE2);             /*                       @Y30LB38*/
         LR    @15,CODE2                                           0424
@EL00003 DS    0H                                                  0424
@EF00003 DS    0H                                                  0424
@ER00003 BR    @14                                                 0424
*   END MSICPROC;                   /*                       @Y30LB38*/
*                                                                  0426
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - DUPVCHK                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - CHECK FOR DUPLICATE VOLUME RECORD IN      @Y30LB38*/
*/*                THE INVENTORY.  IF A DUPLICATE VOLUME IS  @Y30LB38*/
*/*                FOUND, ISSUE MESSAGE                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - RVVI LIST                                    @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - A RETURN CODE OF 00 OR 04. A RETURN         @Y30LB38*/
*/*              CODE OF 04 MEANS THAT A DUPLICATE           @Y30LB38*/
*/*              VOLUME WAS FOUND OR AN ERROR OCCURRED       @Y30LB38*/
*/*              WHILE TRYING TO ACCESS THE RECORD           @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0426
*DUPVCHK:                                                          0426
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
DUPVCHK  DS    0H                                                  0427
*                                                                  0427
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS                               @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   RETADDR2=REG14;                 /*                       @Y30LB38*/
         LR    RETADDR2,REG14                                      0427
*   OLDERID2=NEWERID2;                                             0428
         L     @09,@PC00001                                        0428
         L     @15,GDTTR2(,@09)                                    0428
         MVC   @TS00001(95),NEWERID2(@15)                          0428
         MVC   OLDERID2(95,@15),@TS00001                           0428
*   NEWID2='EVDC';                  /*                       @Y30LB38*/
*                                                                  0429
         MVC   NEWID2(4,@15),@CC01103                              0429
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN READ BASE VOLUME FLAG OFF AND TURN READ          @Y30LB38*/
*   /* DUPLICATE VOLUME RECORD FLAG ON. ISSUE USSC MACRO     @Y30LB38*/
*   /* TO READ DUPLICATE RECORD FROM MSIC.                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0430
*   RVVBVRCD=OFF;                   /*                       @Y30LB38*/
*   RVVDUPRC=ON;                    /*                       @Y30LB38*/
*                                                                  0431
         L     @01,RVVIPTR                                         0431
         OI    RVVDUPRC(@01),B'00010000'                           0431
         NI    RVVBVRCD(@01),B'01111111'                           0431
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE UDUMP OF READ MSIC RECORD PARMAMETER             @Y30LB38*/
*   /* LIST TO READ A RECORD (VVILIST)                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0432
*   IF GDTDBG=NULLPTR THEN                                         0432
         L     @09,GDTDBG(,@09)                                    0432
         LTR   @09,@09                                             0432
         BZ    @RT00432                                            0432
*     ;                                                            0433
*   ELSE                                                           0434
*     DO;                                                          0434
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Y30LB38*/
         LA    DMPINDEX,DMPSTG                                     0435
*       DMPITMNM='VVILIST';                                        0436
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0436
         MVC   DMPITMNM(7,DMPINDEX),@CC01095                       0436
*       DMPITMPT=ADDR(RVVIPTR);                                    0437
         LA    @09,RVVIPTR                                         0437
         ST    @09,DMPITMPT(,DMPINDEX)                             0437
*       DMPITMLN=LENGTH(VVILIST);                                  0438
         MVC   DMPITMLN(2,DMPINDEX),@CH01240                       0438
*       DMPITMTP='H';                                              0439
         MVI   DMPITMTP(DMPINDEX),C'H'                             0439
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0440
*                                                                  0440
         AL    DMPINDEX,@CF00465                                   0440
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0441
*       DMPTRM=DMPTRMVL;                                           0441
         MVI   DMPTRM(DMPINDEX),X'FF'                              0441
*     END;                          /*                       @Y30LB38*/
*   IF GDTDBG=NULLPTR THEN                                         0443
@RT00432 L     @09,@PC00001                                        0443
         L     @09,GDTDBG(,@09)                                    0443
         LTR   @09,@09                                             0443
         BZ    @RT00443                                            0443
*     ;                                                            0444
*   ELSE                                                           0445
*     CALL IDCDB010(GDTTBL,'EVBV',ADDR(DMPSTG));/*           @Y30LB38*/
*                                                                  0445
         L     @09,@PC00001                                        0445
         ST    @09,@AL00001                                        0445
         LA    @15,@CC01104                                        0445
         ST    @15,@AL00001+4                                      0445
         LA    @15,DMPSTG                                          0445
         ST    @15,@AFTEMPS+4                                      0445
         LA    @15,@AFTEMPS+4                                      0445
         ST    @15,@AL00001+8                                      0445
         MVI   @AL00001+8,X'80'                                    0445
         L     @15,GDTDBG(,@09)                                    0445
         LA    @01,@AL00001                                        0445
         BALR  @14,@15                                             0445
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO READ FOR A DUPLICATE RECORD.      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0446
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB38*/
@RT00443 L     @09,@PC00001                                        0446
         ST    @09,@AL00001                                        0446
         LA    @02,VVIC                                            0446
         ST    @02,@AL00001+4                                      0446
         LA    @02,RVVIPTR                                         0446
         ST    @02,@AL00001+8                                      0446
         LA    @02,REASONCD                                        0446
         ST    @02,@AL00001+12                                     0446
         MVI   @AL00001+12,X'80'                                   0446
         L     @15,GDTSSC(,@09)                                    0446
         LA    @01,@AL00001                                        0446
         BALR  @14,@15                                             0446
*   RESPECIFY                                                      0447
*     RTNREG RSTD;                                                 0447
*   TESTRC=RTNREG;                                                 0448
         LR    TESTRC,RTNREG                                       0448
*   RESPECIFY                                                      0449
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*                                                                  0449
*   /*****************************************************************/
*   /*                                                               */
*   /* A RETURN CODE OF 00 INDICATES THAT A DUPLICATE        @Y30LB38*/
*   /* VOLUME WAS FOUND. IF SO, THE UPRINT MACRO IS ISSUED TO PRINT  */
*   /* MESSAGE IDC3089I.                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   IF TESTRC=0 THEN                                               0450
         LTR   TESTRC,TESTRC                                       0450
         BNZ   @RF00450                                            0450
*     DO;                           /*                       @Y30LB38*/
*       DARGSMOD=CMOVMSG;           /*                       @Y30LB38*/
         L     @09,DDSTRU                                          0452
         MVC   DARGSMOD(3,@09),@CC01061                            0452
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB38*/
         L     @15,@PC00001+4                                      0453
         L     @01,FDTPTR(,@15)                                    0453
         LA    @15,VOLVAL(,@01)                                    0453
         ST    @15,DARGDBP(,@09)                                   0453
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@09),@CH00150                             0454
*       DARGSENT=MSG3089I;          /*                       @Y30LB38*/
         MVI   DARGSENT(@09),X'11'                                 0455
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/
         L     @09,@PC00001                                        0456
         ST    @09,@AL00001                                        0456
         LA    @15,@CF00111                                        0456
         ST    @15,@AL00001+4                                      0456
         LA    @15,DDSTRU                                          0456
         ST    @15,@AL00001+8                                      0456
         MVI   @AL00001+8,X'80'                                    0456
         L     @15,GDTPRT(,@09)                                    0456
         LA    @01,@AL00001                                        0456
         BALR  @14,@15                                             0456
*       SETRC=LASTCC04;             /*                       @Y30LB38*/
         LA    SETRC,4                                             0457
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           0459
*     DO;                           /*                       @Y30LB38*/
*                                                                  0459
         B     @RC00450                                            0459
@RF00450 DS    0H                                                  0460
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE REASON CODE INDICATES AN ERROR OTHER THAN  @Y30LB38*/
*       /* RECORD NOT FOUND, CALL SSCMSG TO PRINT THE REASON @Y30LB38*/
*       /* AND SET THE RETURN CODE TO 04                     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0460
*       IF REASONCD^=NOREC THEN                                    0460
         CLC   REASONCD(4),NOREC                                   0460
         BE    @RF00460                                            0460
*         DO;                       /*                       @Y30LB38*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB38*/
         LA    @15,REASONCD                                        0462
         ST    @15,@AL00001                                        0462
         LA    @01,@AL00001                                        0462
         BAL   @14,SSCMSG                                          0462
*           SETRC=LASTCC04;         /*                       @Y30LB38*/
         LA    SETRC,4                                             0463
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  0465
@RF00460 DS    0H                                                  0466
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE RETURN ADDRESS AND RETURN TO THE CALLER   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0466
*   REG14=RETADDR2;                 /*                       @Y30LB38*/
@RC00450 LR    REG14,RETADDR2                                      0466
*   RETURN CODE(SETRC);             /*                       @Y30LB38*/
         LR    @15,SETRC                                           0467
@EL00004 DS    0H                                                  0467
@EF00004 DS    0H                                                  0467
@ER00004 BR    @14                                                 0467
*   END DUPVCHK;                    /*                       @Y30LB38*/
*                                                                  0469
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - RECPROC                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - DETERMINE WHETHER THE RECORD IN THE       @Y30LB38*/
*/*     INVENTORY SHOULD BE RETAINED OR DELETED.             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*    INPUT - FUNCTION DEFINITION TABLE; INVENTORY RECORD   @Y30LB38*/
*/*           OR FLAG INDICATING RECORD NOT FOUND            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*    OUTPUT - A FLAG SET TO 1 IF THE RECORD IS TO          @Y30LB38*/
*/*    BE RETAINED.                                          @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0469
*RECPROC:                                                          0469
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
RECPROC  DS    0H                                                  0470
*                                                                  0470
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS                               @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*   RETADDR1=REG14;                 /*                       @Y30LB38*/
         LR    RETADDR1,REG14                                      0470
*   OLDERID2=NEWERID2;                                             0471
         L     @15,@PC00001                                        0471
         L     @15,GDTTR2(,@15)                                    0471
         MVC   @TS00001(95),NEWERID2(@15)                          0471
         MVC   OLDERID2(95,@15),@TS00001                           0471
*   NEWID2='EVRP';                  /*                       @Y30LB38*/
*                                                                  0472
         MVC   NEWID2(4,@15),@CC01108                              0472
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE RETAIN RECORD FLAG ACCORDING TO THE FDT.      @Y30LB38*/
*   /* IF RECORD WAS SPECIFIED ON THE COMMAND, SET THE       @Y30LB38*/
*   /* FLAG ON. IF NORECORD WAS SPECIFIED ON THE COMMAND,    @Y30LB38*/
*   /* SET THE FLAG OFF                                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   IF ADDR(NREC)=NULLPTR THEN                                     0473
         SLR   @15,@15                                             0473
         L     @14,@PC00001+4                                      0473
         C     @15,FDTPTR+24(,@14)                                 0473
         BNE   @RF00473                                            0473
*     DO;                           /*                       @Y30LB38*/
*       IF ADDR(REC)=NULLPTR THEN                                  0475
         C     @15,FDTPTR+20(,@14)                                 0475
         BNE   @RF00475                                            0475
*         DO;                       /*                       @Y30LB38*/
*                                                                  0476
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE USER DID NOT SPECIFY RECORD OR NO RECORD,      */
*           /*                                               @Y30LB38*/
*           /* SET THE FLAG ON TO RETAIN THE RECORD IF THE RECORD WAS*/
*           /* FOUND AND THE VOLUME SET IS NOT A DUPLICATE   @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0477
*           IF RRCDFAIL=OFF THEN                                   0477
         TM    RRCDFAIL,B'10000000'                                0477
         BNZ   @RF00477                                            0477
*             DO;                   /*                       @Y30LB38*/
*               IF BCDDUP=OFF THEN  /*                       @Y30LB38*/
         TM    BCDDUP(BCDVPTR),B'00000100'                         0479
         BNZ   @RF00479                                            0479
*                 RECFLAG=ON;       /*                       @Y30LB38*/
         OI    RECFLAG,B'10000000'                                 0480
*             END;                  /*                       @Y30LB38*/
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       0483
*         RECFLAG=ON;               /*                       @Y30LB38*/
         B     @RC00475                                            0483
@RF00475 OI    RECFLAG,B'10000000'                                 0483
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           0485
*     RECFLAG=OFF;                  /*                       @Y30LB38*/
*                                                                  0485
         B     @RC00473                                            0485
@RF00473 NI    RECFLAG,B'01111111'                                 0485
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE RETURN ADDRESS & RETURN TO THE CALLER     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0486
*   REG14=RETADDR1;                 /*                       @Y30LB38*/
@RC00473 LR    REG14,RETADDR1                                      0486
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             0487
@EL00005 DS    0H                                                  0487
@EF00005 DS    0H                                                  0487
@ER00005 BR    @14                                                 0487
*   END RECPROC;                    /*                       @Y30LB38*/
*                                                                  0489
*/****************************************************************** */
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/
*/*             CHARACTER                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0489
*CKCSNLEN:                          /*                       @Y30LB32*/
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/
*                                                                  0489
CKCSNLEN MVC   @PC00006(8),0(@01)                                  0489
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0490
*   DCL                                                            0490
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/
*   DCL                                                            0491
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/
*   DCL                                                            0492
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/
*   DCL                                                            0493
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/
*   DCL                                                            0494
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/
*   DCL                                                            0495
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/
*   DCL                                                            0496
*     CKCOND FIXED(15);                                            0496
*                                                                  0496
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0497
*   DCL                                                            0497
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32
*                                      CSN                   @Y30LB32*/
*   DCL                                                            0498
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32
*                                      OF CSN AGAINST        @Y30LB32*/
*   DCL                                                            0499
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/
*   DCL                                                            0500
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/
*                                                                  0501
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/
         LR    CKRETPTR,REG14                                      0501
*   OLDERID2=NEWERID2;                                             0502
         L     @09,@PC00001                                        0502
         L     @09,GDTTR2(,@09)                                    0502
         MVC   @TS00001(95),NEWERID2(@09)                          0502
         MVC   OLDERID2(95,@09),@TS00001                           0502
*   NEWID2='CKLN';                  /*                       @Y30LB32*/
*                                                                  0503
         MVC   NEWID2(4,@09),@CC01126                              0503
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/
         L     CKSAVPTR,DDSTRU                                     0504
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/
         LA    @09,CKPRTTAB                                        0505
         ST    @09,DDSTRU                                          0505
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/
         XC    CKPRTTAB(20),CKPRTTAB                               0506
*   CKCOND=''B;                     /*                       @Y30LB32*/
*                                                                  0507
         SLR   CKCOND,CKCOND                                       0507
*   /*****************************************************************/
*   /*                                                               */
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/
*   /* OR MORE                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/
*                                                                  0508
         L     @09,@PC00006+4                                      0508
         CLI   CKLENGTH(@09),11                                    0508
         BL    @RF00508                                            0508
*     /***************************************************************/
*     /*                                                             */
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/
*     /* CHARACTER                                           @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0509
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/
         CLI   CKLENGTH(@09),11                                    0509
         BNE   @RF00509                                            0509
*       DO;                         /*                       @Y30LB32*/
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/
         MVI   CKCSNADJ+3,C' '                                     0511
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/
         L     @09,@PC00006                                        0512
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@09)                       0512
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/
         MVC   CKCSNVAL+3(9,@09),CKCSNADJ+3                        0513
*       END;                        /*                       @Y30LB32*/
*     ELSE                                                         0515
*       ;                           /*                       @Y30LB32*/
*                                                                  0515
@RF00509 DS    0H                                                  0516
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC00508                                            0516
@RF00508 DS    0H                                                  0517
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/
         L     @09,DDSTRU                                          0517
         MVC   DARGSMOD(3,@09),@CC01061                            0517
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@09),X'01'                                 0518
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/
         L     @02,@PC00006                                        0519
         ST    @02,DARGDBP(,@09)                                   0519
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/
         MVC   DARGILP(2,@09),@CH00536                             0520
*       DARGRETP=''B;               /*                       @Y30LB32*/
         SLR   @02,@02                                             0521
         ST    @02,DARGRETP(,@09)                                  0521
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @09,@PC00001                                        0522
         ST    @09,@AL00001                                        0522
         LA    @02,@CF00111                                        0522
         ST    @02,@AL00001+4                                      0522
         LA    @02,DDSTRU                                          0522
         ST    @02,@AL00001+8                                      0522
         MVI   @AL00001+8,X'80'                                    0522
         L     @15,GDTPRT(,@09)                                    0522
         LA    @01,@AL00001                                        0522
         BALR  @14,@15                                             0522
*       CKCOND=4;                   /*                       @Y30LB32*/
         LA    CKCOND,4                                            0523
*     END;                          /*                       @Y30LB32*/
*                                                                  0524
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/
@RC00508 ST    CKSAVPTR,DDSTRU                                     0525
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/
         LR    REG14,CKRETPTR                                      0526
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/
         LR    @15,CKCOND                                          0527
@EL00006 DS    0H                                                  0527
@EF00006 DS    0H                                                  0527
@ER00006 BR    @14                                                 0527
*   END CKCSNLEN;                   /*                       @Y30LB32*/
*                                                                  0529
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - VOLEXIT                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - REMOVES A VOLUME FROM THE MSF.            @Y30LB38*/
*/*                IF THE VOLUME IS EJECTED SUCCESSFULLY,    @Y30LB38*/
*/*                ISSUES MESSAGE IDC0085I TO SYSPRINT AND   @Y30LB38*/
*/*                MESSAGE IDC083E TO THE OPERATOR.  IF THE  @Y30LB38*/
*/*                VOLUME IS NOT EJECTED SUCCESSFULLY, AN    @Y30LB38*/
*/*                ERROR MESSAGE IS ISSUED VIA SSCMSG        @Y30LB38*/
*/*                PROCEDURE AND MESSAGE IDC2084I IS ISSUED  @Y30LB38*/
*/*                TO SYSPRINT.                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - THE FOLLOWING POSITIONAL PARAMETERS ARE      @Y30LB38*/
*/*             PASSED AS INPUT:                             @Y30LB38*/
*/*             ARG1 = CSN OF FIRST VOLUME CARTRIDGE         @Y30LB38*/
*/*             ARG2 = VOLUME SERIAL NUMBER                  @Y30LB38*/
*/*             ARG3 = VVI ERROR FLAG                        @Y30LB38*/
*/*             ARG4 = RETAIN RECORD FLAG                    @Y30LB38*/
*/*             ARG5 = VOLUME STORAGE LOCATION               @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - RETURN CODE IN REG15                        @Y30LB38*/
*/*              REG15 = 00 CARTRIDGES EJECTED SUCCESSFULLY  @Y30LB38*/
*/*              REG15 = 04 CARTRIDGES NOT EJECTED           @Y30LB38*/
*/*                         SUCCESSFULLY                     @Y30LB38*/
*/*              REG15 = 08 SECOND CARTRIDGE NOT EJECTED     @Y30LB38*/
*/*                         SUCCESSFULLY                     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0529
*VOLEXIT:                                                          0529
*   PROCEDURE(VECSN1,               /* CART SERIAL NUMBER    @Y30LB38*/
*       VEVOLUME,                   /* VOL SERIAL NUMBER     @Y30LB38*/
*       VEVVIERR,                   /* VVI ERROR FLAG        @Y30LB38*/
*       VERECFLG,                   /* RETAIN RECORD FLAG    @Y30LB38*/
*       VEVOLLOC)                   /* VOL STORAGE LOC       @Y30LB38*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB38*/
VOLEXIT  MVC   @PC00007(20),0(@01)                                 0529
*                                                                  0530
*/********************************************************************/
*/*          MACCOMP  Y30LB22          SC1DR/BL0019          @Y30LB22*/
*/*          MACSTAT  Y30LB22          74/170/341040         @Y30LB22*/
*/*                                                                  */
*/*          NAME: IEZMCRTE                                  @Y30LB22*/
*/*                                                                  */
*/*          FUNCTION:                                       @Y30LB22*/
*/*                  MAPS THE ICBMCRT REQUEST BLOCK          @Y30LB22*/
*/*                  EXTENSION WHICH IS USED TO PASS         @Y30LB22*/
*/*                  ADDITIONAL INFORMATION TO MASS          @Y30LB22*/
*/*                  STORAGE VOLUME  CONTROL DURING          @Y30LB22*/
*/*                  AN ICBMCRT REQUEST.                     @Y30LB22*/
*/*                                                                  */
*/*          STATUS:  CHANGE LEVEL = 0                       #Y30LB22*/
*/*                                                          @Y30LB22*/
*/********************************************************************/
*                                                                  0530
*   /*****************************************************************/
*   /*                                                               */
*   /* CONSTANTS FOR IEZMCRTE                                @Y30LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0530
*   DCL                                                            0530
*     MCRLEN FIXED(15) INIT(LENGTH(MCRTE));/* LENGTH         @Y30LB22
*                                      OF EXTENSION          @Y30LB22*/
*                                                                  0530
*   /*****************************************************************/
*   /*                                                               */
*   /* MAPPING MACRO DECLARES                                @Y30LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*   DCL                                                            0531
*     1 MCRTE BASED(MCRTEPTR) BDY(WORD),                           0531
*      2 MCRLNGTH FIXED(31),        /* LENGTH OF EXTENSION   @Y30LB22*/
*      2 MCRLOC CHAR(30),           /* LOCATION/DESTINATION OF VOL 0531
*                                      AFTER EJECTION        @Y30LB22*/
*      2 MCRFLAGA BIT(8),           /* SPECIFICATION FLAGS   @Y30LB22*/
*       3 MCRSPLOC BIT(1),          /* MCRLOC IS SPECIFIED   @Y30LB22*/
*       3 * BIT(7),                 /* UNUSED                @Y30LB22*/
*      2 MCRBLNK1 CHAR(1),          /* BLANK                 @Y30LB22*/
*      2 MCRFLAGB BIT(32),          /* INDICATOR FLAGS       @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*       3 MCRTYPE BIT(8),           /* MOVE CART. TYPE FLAG  @Y30LB22*/
*        4 MCRREC BIT(1),           /* BIT 0=1, REC RETAIN   @Y30LB22
*                                      BIT 0=0, REC DELETE   @Y30LB22*/
*        4 * BIT(7),                /* UNUSED                @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*      2 * CHAR(4);                 /* UNUSED                @Y30LB22*/
*                                                                  0532
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR VOLEXIT                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0532
*   DCL                                                            0532
*     VEDDSTRU POINTER(31);         /* DARGLIST POINTER      @Y30LB38*/
*   DCL                                                            0533
*     MCLSTPTR POINTER(31);         /* BASE PTR FOR MCLIST@Y30LB38   */
*   DCL                                                            0534
*     MCRTEPTR POINTER(31);         /* PTR FOR MCLIST EXT    @Y30LB38*/
*   DCL                                                            0535
*     VERETADR POINTER(31);         /* RETURN ADDR           @Y30LB38*/
*   DCL                                                            0536
*     VEMSGPTR POINTER(31);         /* MESSAGE PTR AREA      @Y30LB38*/
*   DCL                                                            0537
*     VEWTOPTR POINTER(31);         /* WTO MSG POINTER       @Y30LB38*/
*   DCL                                                            0538
*     VECOND FIXED(15);             /* CONDITION CODE        @Y30LB38*/
*   DCL                                                            0539
*     VEWTOLEN FIXED(15);           /* LENGTH OF WTO MSG     @Y30LB38*/
*   DCL                                                            0540
*     VERESNCD FIXED(31);           /* RSN CODE FOR USSC     @Y30LB38*/
*   DCL                                                            0541
*     VEECB CHAR(1);                /* ECB RETURN AREA       @Y30LB38*/
*                                                                  0541
*   /*****************************************************************/
*   /*                                                               */
*   /* PARM LIST FOR UPRINT MACRO WITH MULTIPLE INSERTS      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0542
*   DCL                                                            0542
*     VELIST CHAR(LENGTH(DARGLIST)+(4*LENGTH(DARGARY)));/*   @Y30LB38*/
*                                                                  0542
*   /*****************************************************************/
*   /*                                                               */
*   /* POSITIONAL PARMS FOR INPUT PARMAMETERS                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0543
*   DCL                                                            0543
*     VECSN1 CHAR(12);              /* CART SERIAL NUM       @Y30LB38*/
*   DCL                                                            0544
*     VEVOLUME CHAR(6);             /* VOL SER NUMBER        @Y30LB38*/
*   DCL                                                            0545
*     VEVVIERR BIT(1);              /* VVI ERROR FLAG        @Y30LB38*/
*   DCL                                                            0546
*     VERECFLG BIT(1);              /* RETAIN REC FLAG       @Y30LB38*/
*   DCL                                                            0547
*     VEVOLLOC CHAR(30);            /* VOL LOCATION          @Y30LB38*/
*   DCL                                                            0548
*     VEWTOMSG CHAR(72);            /* UWTO MSG AREA         @Y30LB38*/
*                                                                  0548
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE LIST FORM OF MCLIST MACRO                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0549
*   DCL                                                            0549
*     MCR1 REG(1) PTR;              /* ADDRESS OF REQUEST BLOCK    0549
*                                                            @Y30LB02*/
*                                                                  0549
*   /*****************************************************************/
*   /*                                                               */
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /* MACMEAN MSSC MOVE CARTRIDGE MACRO                     @Y30LB02*/
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0550
*   DCL                                                            0550
*     1 MCLIST BASED(MCLSTPTR),     /* MOVE CARTRIDGE REQUEST BLOCK
*                                                            @Y30LB02*/
*      2 MCRTLEN FIXED(31),         /* LENGTH OF MOVE CARTRIDGE    0550
*                                      REQUEST BLK = 30 HEX  @Y30LB02*/
*      2 MCRTOPCD FIXED(8),         /* MOVE CARTRIDGE OPCODE = 0E HEX
*                                                            @Y30LB02*/
*      2 MCRTRES1 CHAR(1),          /* RESERVED AND ZERO     @Y30LB02*/
*      2 MCRTFLG BIT(8),            /* ONE BYTE FLAGS AREA   @Y30LB02*/
*       3 * BIT(2),                 /* RESERVED AND MUST BE ZERO   0550
*                                                            @Y30LB02*/
*       3 MCRTTRAN BIT(1),          /* SOURCE WITH TRANSIENT CSN1  0550
*                                      SPECD                 @Y30LB02*/
*       3 MCRTSCT BIT(1),           /* SOURCE WITH SCRATCH ATTRIBUTE
*                                                            @Y30LB02*/
*       3 * BIT(4),                 /* RESERVED AND MUST BE ZERO   0550
*                                                            @Y30LB02*/
*      2 MCRTLIB BIT(8),            /* BYTE-LIBID            @Y30LB02*/
*       3 * BIT(6),                 /* RESERVED AND MUST BE ZERO   0550
*                                                            @Y30LB02*/
*       3 MCRTLD BIT(2),            /* BINARY NUMBER ZERO TO THREE 0550
*                                                            @Y30LB02*/
*      2 MCRTRES2 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/
*      2 MCRTRES3 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/
*      2 MCRTCSN CHAR(12),          /* CART SER NO           @Y30LB02*/
*      2 MCRTRES4 CHAR(2),          /* RESERVED              @Y30LB02*/
*      2 MCRTASID CHAR(2),          /* ASID AREA             @Y30LB02*/
*      2 MCRTECB FIXED(31),         /* EVENT CONTROL BLOCK ADDRESS 0550
*                                                            @Y30LB02*/
*      2 MCRTVEXT FIXED(31);        /* MSVC EXTENSION AREA   @Y30LB02*/
*                                                                  0550
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0551
*                                                                  0551
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR MC LIST AND EXTENSION LIST      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0551
*   DCL                                                            0551
*     VEMCLIST CHAR(LENGTH(MCLIST));/*                       @Y30LB38*/
*   DCL                                                            0552
*     VEEXLIST CHAR(LENGTH(MCRTE)); /*                       @Y30LB38*/
*                                                                  0552
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR JOBNAME AND STEPNAME USED BY    @Y30LB38*/
*   /* USYSINFO MACRO                                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   DCL                                                            0553
*     1 VESYSIN CHAR(16),                                          0553
*      2 VEJOBNAM CHAR(8),                                         0553
*      2 VESTEPNM CHAR(8);          /*                       @Y30LB38*/
*                                                                  0553
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE ROUTING AND DESCRIPTOR CODE AREAS FOR UWTO    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0554
*   DCL                                                            0554
*     1 VEROUTCD BIT(16),                                          0554
*      2 VECD1 BIT(1),                                             0554
*      2 * BIT(15);                 /*                       @Y30LB38*/
*   DCL                                                            0555
*     1 VEDESCCD BIT(16),                                          0555
*      2 * BIT(2),                                                 0555
*      2 VEDESC3 BIT(1),                                           0555
*      2 * BIT(12);                 /*                       @Y30LB38*/
*                                                                  0555
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR UDUMP MACRO                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0556
*   DCL                                                            0556
*     VEDMPSTG CHAR(17);            /*                       @Y30LB38*/
*                                                                  0556
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE STATIC MODULE ID FOR MESSAGES USED BY         @Y30LB38*/
*   /* COMMON FSR'S                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0557
*   DCL                                                            0557
*     VECMOMSG CHAR(3) CONSTANT('CM0');/*                    @Y30LB38*/
*   DCL                                                            0558
*     MSG0085I PTR(8) CONSTANT(21); /* MSG ENTRY NUMBER      @Y30LB38*/
*   DCL                                                            0559
*     MSG2084I PTR(8) CONSTANT(22); /* MSG ENTRY NUMBER      @Y30LB38*/
*   DCL                                                            0560
*     MSG083E PTR(8) CONSTANT(23);  /* MSG ENTRY NUMBER      @Y30LB38*/
*                                                                  0560
*   /*****************************************************************/
*   /*                                                               */
*   /* VOLEXIT CONSTANTS                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0561
*   DCL                                                            0561
*     VEECBLEN FIXED(31) CONSTANT(4);/* LENGTH OF ECB        @Y30LB38*/
*                                                                  0562
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND INITIALIZE PARAMETER LISTS    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   VERETADR=REG14;                 /*                       @Y30LB38*/
         LR    VERETADR,REG14                                      0562
*   OLDERID2=NEWERID2;                                             0563
         L     @02,@PC00001                                        0563
         L     @02,GDTTR2(,@02)                                    0563
         MVC   @TS00001(95),NEWERID2(@02)                          0563
         MVC   OLDERID2(95,@02),@TS00001                           0563
*   NEWID2='VESR';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@02),@CC01208                              0564
*   VELIST=''B;                     /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   0565
*   VEDDSTRU=ADDR(VELIST);          /*                       @Y30LB38*/
         LA    @02,VELIST                                          0566
         ST    @02,VEDDSTRU                                        0566
*   MCLSTPTR=ADDR(VEMCLIST);        /*                       @Y30LB38*/
         LA    @02,VEMCLIST                                        0567
         ST    @02,MCLSTPTR                                        0567
*   MCRTEPTR=ADDR(VEEXLIST);        /*                       @Y30LB38*/
         LA    MCRTEPTR,VEEXLIST                                   0568
*   VEWTOPTR=ADDR(VEWTOMSG);        /*                       @Y30LB38*/
         LA    @15,VEWTOMSG                                        0569
         ST    @15,VEWTOPTR                                        0569
*   MCLIST=''B;                     /*                       @Y30LB38*/
         XC    MCLIST(48,@02),MCLIST(@02)                          0570
*   MCRTE=''B;                      /*                       @Y30LB38*/
         XC    MCRTE(44,MCRTEPTR),MCRTE(MCRTEPTR)                  0571
*   VECOND='0'X;                    /*                       @Y30LB38*/
*                                                                  0572
         SLR   VECOND,VECOND                                       0572
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MCLIST FOR USSC MACRO                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   MCRLNGTH=MCRLEN;                /*                       @Y30LB38*/
         LH    @15,MCRLEN                                          0573
         ST    @15,MCRLNGTH(,MCRTEPTR)                             0573
*   MCRTCSN=VECSN1;                 /*                       @Y30LB38*/
         L     @15,@PC00007                                        0574
         MVC   MCRTCSN(12,@02),VECSN1(@15)                         0574
*   MCRTTRAN=ON;                    /*                       @Y30LB38*/
         OI    MCRTTRAN(@02),B'00100000'                           0575
*   IF VERECFLG=ON THEN                                            0576
         L     @02,@PC00007+12                                     0576
         TM    VERECFLG(@02),B'10000000'                           0576
         BNO   @RF00576                                            0576
*     MCRREC=ON;                    /*                       @Y30LB38*/
         OI    MCRREC(MCRTEPTR),B'10000000'                        0577
*   MCRLOC=VEVOLLOC;                /*                       @Y30LB38*/
@RF00576 L     @02,@PC00007+16                                     0578
         MVC   MCRLOC(30,MCRTEPTR),VEVOLLOC(@02)                   0578
*   MCRTVEXT=MCRTEPTR;              /*                       @Y30LB38*/
         L     @02,MCLSTPTR                                        0579
         ST    MCRTEPTR,MCRTVEXT(,@02)                             0579
*   MCRSPLOC=ON;                    /*                       @Y30LB38*/
*                                                                  0580
         OI    MCRSPLOC(MCRTEPTR),B'10000000'                      0580
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE UDUMP OF MOVE VOLUME PARAMETER LIST (MCLIST)     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*   IF GDTDBG=NULLPTR THEN                                         0581
         L     @15,@PC00001                                        0581
         L     @15,GDTDBG(,@15)                                    0581
         LTR   @15,@15                                             0581
         BZ    @RT00581                                            0581
*     ;                                                            0582
*   ELSE                                                           0583
*     DO;                                                          0583
*       DMPINDEX=ADDR(VEDMPSTG);    /*                       @Y30LB38*/
         LA    DMPINDEX,VEDMPSTG                                   0584
*       DMPITMNM='MCLIST';                                         0585
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0585
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0585
         MVC   DMPITMNM(6,DMPINDEX),@CC01209                       0585
*       DMPITMPT=ADDR(MCLSTPTR);                                   0586
         LA    @03,MCLSTPTR                                        0586
         ST    @03,DMPITMPT(,DMPINDEX)                             0586
*       DMPITMLN=LENGTH(MCLIST);                                   0587
         MVC   DMPITMLN(2,DMPINDEX),@CH00976                       0587
*       DMPITMTP='H';                                              0588
         MVI   DMPITMTP(DMPINDEX),C'H'                             0588
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0589
*                                                                  0589
         AL    DMPINDEX,@CF00465                                   0589
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0590
*       DMPTRM=DMPTRMVL;                                           0590
         MVI   DMPTRM(DMPINDEX),X'FF'                              0590
*     END;                          /*                       @Y30LB38*/
*   IF GDTDBG=NULLPTR THEN                                         0592
@RT00581 L     @15,@PC00001                                        0592
         L     @15,GDTDBG(,@15)                                    0592
         LTR   @15,@15                                             0592
         BZ    @RT00592                                            0592
*     ;                                                            0593
*   ELSE                                                           0594
*     CALL IDCDB010(GDTTBL,'VEBM',ADDR(VEDMPSTG));/*         @Y30LB38*/
*                                                                  0594
         L     @15,@PC00001                                        0594
         ST    @15,@AL00001                                        0594
         LA    @14,@CC01210                                        0594
         ST    @14,@AL00001+4                                      0594
         LA    @14,VEDMPSTG                                        0594
         ST    @14,@AFTEMPS+8                                      0594
         LA    @14,@AFTEMPS+8                                      0594
         ST    @14,@AL00001+8                                      0594
         MVI   @AL00001+8,X'80'                                    0594
         L     @15,GDTDBG(,@15)                                    0594
         LA    @01,@AL00001                                        0594
         BALR  @14,@15                                             0594
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO EJECT THE VOLUME                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0595
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,VERESNCD,VEECB,VEMSGPTR);/* 0595
*                                                            @Y30LB38*/
@RT00592 L     @02,@PC00001                                        0595
         ST    @02,@AL00001                                        0595
         LA    @15,MOVE                                            0595
         ST    @15,@AL00001+4                                      0595
         LA    @15,MCLSTPTR                                        0595
         ST    @15,@AL00001+8                                      0595
         LA    @15,VERESNCD                                        0595
         ST    @15,@AL00001+12                                     0595
         LA    @15,VEECB                                           0595
         ST    @15,@AL00001+16                                     0595
         LA    @15,VEMSGPTR                                        0595
         ST    @15,@AL00001+20                                     0595
         MVI   @AL00001+20,X'80'                                   0595
         L     @15,GDTSSC(,@02)                                    0595
         LA    @01,@AL00001                                        0595
         BALR  @14,@15                                             0595
*   RESPECIFY                                                      0596
*     RTNREG RSTD;                                                 0596
*   TESTRC=RTNREG;                                                 0597
         LR    TESTRC,RTNREG                                       0597
*   RESPECIFY                                                      0598
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*                                                                  0598
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO MESSAGE AREA FROM USSC       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0599
*   VEMSGPTR=VEMSGPTR+VEECBLEN;     /*                       @Y30LB38*/
         LA    @02,4                                               0599
         AL    @02,VEMSGPTR                                        0599
         ST    @02,VEMSGPTR                                        0599
*                                                                  0600
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CARTRIDGE WERE SUCCESSFULLY EJECTED; ISSUE THE     @Y30LB38*/
*   /* APPROPRIATE MESSAGE                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*   IF TESTRC=LASTCC00TESTRC=LASTCC12 THEN                        0600
         LTR   TESTRC,TESTRC                                       0600
         BZ    @RT00600                                            0600
         C     TESTRC,@CF00536                                     0600
         BNE   @RF00600                                            0600
@RT00600 DS    0H                                                  0601
*     DO;                           /*                       @Y30LB38*/
*                                                                  0601
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR OCCURRES UPDATING INVENTORY, SET A    @Y30LB38*/
*       /* FLAG ON FOR THE CALLER                            @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0602
*       IF TESTRC=LASTCC12 THEN                                    0602
         C     TESTRC,@CF00536                                     0602
         BNE   @RF00602                                            0602
*         VEVVIERR=ON;              /*                       @Y30LB38*/
*                                                                  0603
         L     @15,@PC00007+8                                      0603
         OI    VEVVIERR(@15),B'10000000'                           0603
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME       */
*       /*                                                   @Y30LB38*/
*       /* TO BE USED IN MESSAGE IDC083E                     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0604
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/*         @Y30LB38*/
*                                                                  0604
@RF00602 L     @15,@PC00001                                        0604
         ST    @15,@AL00001                                        0604
         LA    @14,NAMES                                           0604
         ST    @14,@AL00001+4                                      0604
         LA    @14,VESYSIN                                         0604
         ST    @14,@AFTEMPS+8                                      0604
         LA    @14,@AFTEMPS+8                                      0604
         ST    @14,@AL00001+8                                      0604
         MVI   @AL00001+8,X'80'                                    0604
         L     @15,GDTSFO(,@15)                                    0604
         LA    @01,@AL00001                                        0604
         BALR  @14,@15                                             0604
*       /*************************************************************/
*       /*                                                           */
*       /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS        @Y30LB38*/
*       /* FOR MESSAGE IDC083E                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0605
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/
         L     @15,VEDDSTRU                                        0605
         MVC   DARGSMOD(3,@15),@CC01061                            0605
*       VEDDSTRU->DARGSENT=MSG083E; /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'17'                                 0606
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/
         L     @14,VEMSGPTR                                        0607
         LA    @09,CMCSN1(,@14)                                    0607
         ST    @09,DARGDBP(,@15)                                   0607
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/
         LA    @09,12                                              0608
         STH   @09,DARGILP(,@15)                                   0608
*       VEDDSTRU->DARGRETP=VEWTOPTR;/*                       @Y30LB38*/
         L     @08,VEWTOPTR                                        0609
         ST    @08,DARGRETP(,@15)                                  0609
*       VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*               @Y30LB38*/
*                                                                  0610
         MVC   DARGRETL(2,@15),@CH01168                            0610
*       /*************************************************************/
*       /*                                                           */
*       /* IF BOTH CARTRIDGES WERE EJECTED, SET DARGLIST     @Y30LB38*/
*       /* FOR FIVE INSERTS. IF NOT USE FOUR INSERTS.        @Y30LB38*/
*       /* IF FIVE INSERTS ARE USED, THEY WILL BE CSN1, CSN2,        */
*       /*                                                   @Y30LB38*/
*       /* VOLUME SERIAL NUMBER, JOB NAME AND STEP NAME.     @Y30LB38*/
*       /* IF FOUR INSERTS ARE USED CSN2 WILL BE OMMITTED.   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0611
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/
         CLI   CMNUMCRT(@14),X'F2'                                 0611
         BNE   @RF00611                                            0611
*         DO;                       /*                       @Y30LB38*/
*           VEDDSTRU->DARGCNT='4'X; /*                       @Y30LB38*/
         LA    @08,4                                               0613
         STH   @08,DARGCNT(,@15)                                   0613
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/
         LA    @07,1                                               0614
         STH   @07,DARGINS(,@15)                                   0614
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/
         STH   @09,DARGINL(,@15)                                   0615
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/
         LA    @14,CMCSN2(,@14)                                    0616
         ST    @14,DARGDTM(,@15)                                   0616
*           VEDDSTRU->DARGINS(2)='2'X;/*                     @Y30LB38*/
         LA    @14,2                                               0617
         STH   @14,DARGINS+8(,@15)                                 0617
*           VEDDSTRU->DARGINL(2)=LENGTH(VEVOLUME);/*         @Y30LB38*/
         MVC   DARGINL+8(2,@15),@CH00150                           0618
*           VEDDSTRU->DARGDTM(2)=ADDR(VEVOLUME);/*           @Y30LB38*/
         L     @14,@PC00007+4                                      0619
         ST    @14,DARGDTM+8(,@15)                                 0619
*           VEDDSTRU->DARGINS(3)='3'X;/*                     @Y30LB38*/
         LA    @14,3                                               0620
         STH   @14,DARGINS+16(,@15)                                0620
*           VEDDSTRU->DARGINL(3)=LENGTH(VEJOBNAM);/*         @Y30LB38*/
         LA    @14,8                                               0621
         STH   @14,DARGINL+16(,@15)                                0621
*           VEDDSTRU->DARGDTM(3)=ADDR(VEJOBNAM);/*           @Y30LB38*/
         LA    @09,VEJOBNAM                                        0622
         ST    @09,DARGDTM+16(,@15)                                0622
*           VEDDSTRU->DARGINS(4)='4'X;/*                     @Y30LB38*/
         STH   @08,DARGINS+24(,@15)                                0623
*           VEDDSTRU->DARGINL(4)=LENGTH(VESTEPNM);/*         @Y30LB38*/
         STH   @14,DARGINL+24(,@15)                                0624
*           VEDDSTRU->DARGDTM(4)=ADDR(VESTEPNM);/*           @Y30LB38*/
         LA    @14,VESTEPNM                                        0625
         ST    @14,DARGDTM+24(,@15)                                0625
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       0627
*         DO;                       /*                       @Y30LB38*/
         B     @RC00611                                            0627
@RF00611 DS    0H                                                  0628
*           VEDDSTRU->DARGCNT='3'X; /*                       @Y30LB38*/
         LA    @15,3                                               0628
         L     @14,VEDDSTRU                                        0628
         STH   @15,DARGCNT(,@14)                                   0628
*           VEDDSTRU->DARGINS(1)='2'X;/*                     @Y30LB38*/
         LA    @09,2                                               0629
         STH   @09,DARGINS(,@14)                                   0629
*           VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*         @Y30LB38*/
         MVC   DARGINL(2,@14),@CH00150                             0630
*           VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*           @Y30LB38*/
         L     @09,@PC00007+4                                      0631
         ST    @09,DARGDTM(,@14)                                   0631
*           VEDDSTRU->DARGINS(2)='3'X;/*                     @Y30LB38*/
         STH   @15,DARGINS+8(,@14)                                 0632
*           VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*         @Y30LB38*/
         LA    @15,8                                               0633
         STH   @15,DARGINL+8(,@14)                                 0633
*           VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*           @Y30LB38*/
         LA    @09,VEJOBNAM                                        0634
         ST    @09,DARGDTM+8(,@14)                                 0634
*           VEDDSTRU->DARGINS(3)='4'X;/*                     @Y30LB38*/
         LA    @09,4                                               0635
         STH   @09,DARGINS+16(,@14)                                0635
*           VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*         @Y30LB38*/
         STH   @15,DARGINL+16(,@14)                                0636
*           VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*           @Y30LB38*/
         LA    @15,VESTEPNM                                        0637
         ST    @15,DARGDTM+16(,@14)                                0637
*         END;                      /*                       @Y30LB38*/
*                                                                  0638
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT MACRO TO RETRIEVE MESSAGE IDC0083I   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0639
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/
*                                                                  0639
@RC00611 L     @15,@PC00001                                        0639
         ST    @15,@AL00001                                        0639
         LA    @14,@CF00111                                        0639
         ST    @14,@AL00001+4                                      0639
         LA    @14,VEDDSTRU                                        0639
         ST    @14,@AL00001+8                                      0639
         MVI   @AL00001+8,X'80'                                    0639
         L     @15,GDTPRT(,@15)                                    0639
         LA    @01,@AL00001                                        0639
         BALR  @14,@15                                             0639
*       /*************************************************************/
*       /*                                                           */
*       /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR CODES       */
*       /*                                                   @Y30LB38*/
*       /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE IDC2083E*/
*       /* TO THE SYSTEM OPERATOR.                           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0640
*       VEWTOLEN=LENGTH(VEWTOMSG);  /*                       @Y30LB38*/
         MVC   VEWTOLEN(2),@CH01168                                0640
*       VEROUTCD=''B;               /*                       @Y30LB38*/
         XC    VEROUTCD(2),VEROUTCD                                0641
*       VECD1=ON;                   /*                       @Y30LB38*/
         OI    VECD1,B'10000000'                                   0642
*       VEDESCCD=''B;               /*                       @Y30LB38*/
         XC    VEDESCCD(2),VEDESCCD                                0643
*       VEDESC3=ON;                 /*                       @Y30LB38*/
         OI    VEDESC3,B'00100000'                                 0644
*       CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,VEDESCCD);/*
*                                                            @Y30LB38*/
         L     @15,@PC00001                                        0645
         ST    @15,@AL00001                                        0645
         LA    @14,VEWTOLEN                                        0645
         ST    @14,@AL00001+4                                      0645
         LA    @14,VEWTOPTR                                        0645
         ST    @14,@AL00001+8                                      0645
         LA    @14,VEROUTCD                                        0645
         ST    @14,@AL00001+12                                     0645
         LA    @14,VEDESCCD                                        0645
         ST    @14,@AL00001+16                                     0645
         MVI   @AL00001+16,X'80'                                   0645
         L     @15,GDTWTO(,@15)                                    0645
         LA    @01,@AL00001                                        0645
         BALR  @14,@15                                             0645
*                                                                  0646
*       /*************************************************************/
*       /*                                                           */
*       /* TEST IF BOTH SERIAL NUMBERS WERE SPECIFIED? IF    @Y30LB38*/
*       /* YES, PUT BOTH CSN'S IN MESSAGE IDC0085I AND PRINT THE     */
*       /* MESSAGE. IF NO, USE ONLY THE FIRST CSN.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0646
*       VELIST=''B;                 /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   0646
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/
         L     @15,VEDDSTRU                                        0647
         MVC   DARGSMOD(3,@15),@CC01061                            0647
*       VEDDSTRU->DARGSENT=MSG0085I;/*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'15'                                 0648
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/
         L     @14,VEMSGPTR                                        0649
         LA    @09,CMCSN1(,@14)                                    0649
         ST    @09,DARGDBP(,@15)                                   0649
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/
         LA    @09,12                                              0650
         STH   @09,DARGILP(,@15)                                   0650
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/
         CLI   CMNUMCRT(@14),X'F2'                                 0651
         BNE   @RF00651                                            0651
*         DO;                       /*                       @Y30LB38*/
*           VEDDSTRU->DARGCNT='1'X; /*                       @Y30LB38*/
         LA    @08,1                                               0653
         STH   @08,DARGCNT(,@15)                                   0653
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/
         STH   @08,DARGINS(,@15)                                   0654
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/
         STH   @09,DARGINL(,@15)                                   0655
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/
         LA    @14,CMCSN2(,@14)                                    0656
         ST    @14,DARGDTM(,@15)                                   0656
*         END;                      /*                       @Y30LB38*/
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/
*                                                                  0658
@RF00651 L     @15,@PC00001                                        0658
         ST    @15,@AL00001                                        0658
         LA    @14,@CF00111                                        0658
         ST    @14,@AL00001+4                                      0658
         LA    @14,VEDDSTRU                                        0658
         ST    @14,@AL00001+8                                      0658
         MVI   @AL00001+8,X'80'                                    0658
         L     @15,GDTPRT(,@15)                                    0658
         LA    @01,@AL00001                                        0658
         BALR  @14,@15                                             0658
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UFSPACE MACRO TO FREE MESSAGE AREA SPACE    @Y30LB38*/
*       /* FROM THE USSC MACRO                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0659
*       VEMSGPTR=VEMSGPTR-VEECBLEN; /*                       @Y30LB38*/
         L     @15,VEMSGPTR                                        0659
         SL    @15,@CF00041                                        0659
         ST    @15,VEMSGPTR                                        0659
*       CALL IDCSAFS0(GDTTBL,VEMSGPTR);/*                    @Y30LB38*/
         L     @15,@PC00001                                        0660
         ST    @15,@AL00001                                        0660
         LA    @14,VEMSGPTR                                        0660
         ST    @14,@AL00001+4                                      0660
         L     @15,GDTFSP(,@15)                                    0660
         LA    @01,@AL00001                                        0660
         BALR  @14,@15                                             0660
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           0662
*     DO;                           /*                       @Y30LB38*/
*                                                                  0662
         B     @RC00600                                            0662
@RF00600 DS    0H                                                  0663
*       /*************************************************************/
*       /*                                                           */
*       /* THE RETURN CODE FROM THE USSC MACRO WAS NOT 0 OR 12.      */
*       /*                                                   @Y30LB38*/
*       /* A RETURN CODE OF 8 IS CHECKED TO DETERMINE IF USSC COULD  */
*       /* NOT GET STORAGE. IF YES, MESSAGE IDC2084I IS WRITTEN AND  */
*       /* RETURN TO CALLER WITH CONDITION CODE 4.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0663
*       IF TESTRC=LASTCC08 THEN                                    0663
         C     TESTRC,@CF00173                                     0663
         BNE   @RF00663                                            0663
*         DO;                       /*                       @Y30LB38*/
*           VELIST=''B;             /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   0665
*           VEDDSTRU->DARGSMOD=VECMOMSG;/*                   @Y30LB38*/
         L     @15,VEDDSTRU                                        0666
         MVC   DARGSMOD(3,@15),@CC01061                            0666
*           VEDDSTRU->DARGSENT=MSG2084I;/*                   @Y30LB38*/
         MVI   DARGSENT(@15),X'16'                                 0667
*           CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*        @Y30LB38*/
         L     @15,@PC00001                                        0668
         ST    @15,@AL00001                                        0668
         LA    @14,@CF00111                                        0668
         ST    @14,@AL00001+4                                      0668
         LA    @14,VEDDSTRU                                        0668
         ST    @14,@AL00001+8                                      0668
         MVI   @AL00001+8,X'80'                                    0668
         L     @15,GDTPRT(,@15)                                    0668
         LA    @01,@AL00001                                        0668
         BALR  @14,@15                                             0668
*           VECOND=LASTCC04;        /*                       @Y30LB38*/
         LA    VECOND,4                                            0669
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       0671
*         DO;                       /*                       @Y30LB38*/
*                                                                  0671
         B     @RC00663                                            0671
@RF00663 DS    0H                                                  0672
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE WAS NOT 8, TEST IF THE REASON      */
*           /*                                               @Y30LB38*/
*           /* CODE WAS '4C'X INDICATING THAT THE FIRST CARTRIDGE WAS*/
*           /* EJECTED BUT THE SECOND WAS NOT. IF YES, ISSUE UPRINT  */
*           /* AND UWTO MACROS TO WRITE MESSAGE IDC083E TO THE SYSTEM*/
*           /* OPERATOR AND ISSUE UPRINT MACRO TO WRITE MESSAGE      */
*           /* IDC0085I TO THE USER.                         @Y30LB38*/
*           /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME   */
*           /*                                               @Y30LB38*/
*           /* TO BE USED IN MESSAGE IDC083E                 @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0672
*           IF VERESNCD='4C'X THEN                                 0672
         CLC   VERESNCD(4),@CF01216                                0672
         BNE   @RF00672                                            0672
*             DO;                   /*                       @Y30LB38*/
*               CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/* @Y30LB38*/
         L     @04,@PC00001                                        0674
         ST    @04,@AL00001                                        0674
         LA    @15,NAMES                                           0674
         ST    @15,@AL00001+4                                      0674
         LA    @15,VESYSIN                                         0674
         ST    @15,@AFTEMPS+8                                      0674
         LA    @15,@AFTEMPS+8                                      0674
         ST    @15,@AL00001+8                                      0674
         MVI   @AL00001+8,X'80'                                    0674
         L     @15,GDTSFO(,@04)                                    0674
         LA    @01,@AL00001                                        0674
         BALR  @14,@15                                             0674
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @04,VEDDSTRU                                        0675
         MVC   DARGSMOD(3,@04),@CC01061                            0675
*               VEDDSTRU->DARGSENT=MSG083E;/*                @Y30LB38*/
         MVI   DARGSENT(@04),X'17'                                 0676
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/
         L     @15,@PC00007                                        0677
         ST    @15,DARGDBP(,@04)                                   0677
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/
         MVC   DARGILP(2,@04),@CH00536                             0678
*               VEDDSTRU->DARGRETP=VEWTOPTR;/*               @Y30LB38*/
         L     @15,VEWTOPTR                                        0679
         ST    @15,DARGRETP(,@04)                                  0679
*               VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*       @Y30LB38*/
         MVC   DARGRETL(2,@04),@CH01168                            0680
*               VEDDSTRU->DARGCNT='3'X;/*                    @Y30LB38*/
         LA    @15,3                                               0681
         STH   @15,DARGCNT(,@04)                                   0681
*               VEDDSTRU->DARGINS(1)='2'X;/*                 @Y30LB38*/
         LA    @14,2                                               0682
         STH   @14,DARGINS(,@04)                                   0682
*               VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*     @Y30LB38*/
         MVC   DARGINL(2,@04),@CH00150                             0683
*               VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*       @Y30LB38*/
         L     @14,@PC00007+4                                      0684
         ST    @14,DARGDTM(,@04)                                   0684
*               VEDDSTRU->DARGINS(2)='3'X;/*                 @Y30LB38*/
         STH   @15,DARGINS+8(,@04)                                 0685
*               VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*     @Y30LB38*/
         LA    @15,8                                               0686
         STH   @15,DARGINL+8(,@04)                                 0686
*               VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*       @Y30LB38*/
         LA    @14,VEJOBNAM                                        0687
         ST    @14,DARGDTM+8(,@04)                                 0687
*               VEDDSTRU->DARGINS(3)='4'X;/*                 @Y30LB38*/
         LA    @14,4                                               0688
         STH   @14,DARGINS+16(,@04)                                0688
*               VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*     @Y30LB38*/
         STH   @15,DARGINL+16(,@04)                                0689
*               VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*       @Y30LB38*/
         LA    @15,VESTEPNM                                        0690
         ST    @15,DARGDTM+16(,@04)                                0690
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
*                                                                  0691
         L     @04,@PC00001                                        0691
         ST    @04,@AL00001                                        0691
         LA    @15,@CF00111                                        0691
         ST    @15,@AL00001+4                                      0691
         LA    @15,VEDDSTRU                                        0691
         ST    @15,@AL00001+8                                      0691
         MVI   @AL00001+8,X'80'                                    0691
         L     @15,GDTPRT(,@04)                                    0691
         LA    @01,@AL00001                                        0691
         BALR  @14,@15                                             0691
*               /*****************************************************/
*               /*                                                   */
*               /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR     */
*               /* CODES                                     @Y30LB38*/
*               /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE */
*               /* IDC083E TO THE SYSTEM OPERATOR.           @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0692
*               VEWTOLEN=LENGTH(VEWTOMSG);/*                 @Y30LB38*/
         MVC   VEWTOLEN(2),@CH01168                                0692
*               VEROUTCD=''B;       /*                       @Y30LB38*/
         XC    VEROUTCD(2),VEROUTCD                                0693
*               VECD1=ON;           /*                       @Y30LB38*/
         OI    VECD1,B'10000000'                                   0694
*               VEDESCCD=''B;       /*                       @Y30LB38*/
         XC    VEDESCCD(2),VEDESCCD                                0695
*               VEDESC3=ON;         /*                       @Y30LB38*/
         OI    VEDESC3,B'00100000'                                 0696
*               CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,   0697
*                   VEDESCCD);      /*                       @Y30LB38*/
*                                                                  0697
         L     @04,@PC00001                                        0697
         ST    @04,@AL00001                                        0697
         LA    @15,VEWTOLEN                                        0697
         ST    @15,@AL00001+4                                      0697
         LA    @15,VEWTOPTR                                        0697
         ST    @15,@AL00001+8                                      0697
         LA    @15,VEROUTCD                                        0697
         ST    @15,@AL00001+12                                     0697
         LA    @15,VEDESCCD                                        0697
         ST    @15,@AL00001+16                                     0697
         MVI   @AL00001+16,X'80'                                   0697
         L     @15,GDTWTO(,@04)                                    0697
         LA    @01,@AL00001                                        0697
         BALR  @14,@15                                             0697
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE UPRINT MACRO TO PRINT MESSAGE IDC0085I      */
*               /*                                           @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0698
*               VELIST=''B;         /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   0698
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @04,VEDDSTRU                                        0699
         MVC   DARGSMOD(3,@04),@CC01061                            0699
*               VEDDSTRU->DARGSENT=MSG0085I;/*               @Y30LB38*/
         MVI   DARGSENT(@04),X'15'                                 0700
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/
         L     @15,@PC00007                                        0701
         ST    @15,DARGDBP(,@04)                                   0701
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/
         MVC   DARGILP(2,@04),@CH00536                             0702
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
*                                                                  0703
         L     @04,@PC00001                                        0703
         ST    @04,@AL00001                                        0703
         LA    @15,@CF00111                                        0703
         ST    @15,@AL00001+4                                      0703
         LA    @15,VEDDSTRU                                        0703
         ST    @15,@AL00001+8                                      0703
         MVI   @AL00001+8,X'80'                                    0703
         L     @15,GDTPRT(,@04)                                    0703
         LA    @01,@AL00001                                        0703
         BALR  @14,@15                                             0703
*               /*****************************************************/
*               /*                                                   */
*               /* THE SSCMSG ROUTINE IS CALLED TO WRITE THE MSS     */
*               /*                                           @Y30LB38*/
*               /* MESSAGE EXPLAINING THE SECOND CARTRIDGE WAS NOT   */
*               /* EJECTED.                                  @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0704
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/
         LA    @04,VERESNCD                                        0704
         ST    @04,@AL00001                                        0704
         LA    @01,@AL00001                                        0704
         BAL   @14,SSCMSG                                          0704
*               VECOND=LASTCC08;    /*                       @Y30LB38*/
         LA    VECOND,8                                            0705
*             END;                  /*                       @Y30LB38*/
*           ELSE                                                   0707
*             DO;                   /*                       @Y30LB38*/
*                                                                  0707
         B     @RC00672                                            0707
@RF00672 DS    0H                                                  0708
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN CODE FROM USSC IS 4 INDICATING THAT        */
*               /*                                           @Y30LB38*/
*               /* THE CARTRIDGES WERE NOT EJECTED. THE SSCMSG       */
*               /* ROUTINE IS CALLED TO WRITE THE MSS MESSAGE        */
*               /* EXPLAINING THE ERROR. MESSAGE IDC2048I IS WRITTEN */
*               /* TO THE USER WITH THE UPRINT MACRO.        @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0708
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/
         LA    @04,VERESNCD                                        0708
         ST    @04,@AL00001                                        0708
         LA    @01,@AL00001                                        0708
         BAL   @14,SSCMSG                                          0708
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @15,VEDDSTRU                                        0709
         MVC   DARGSMOD(3,@15),@CC01061                            0709
*               VEDDSTRU->DARGSENT=MSG2084I;/*               @Y30LB38*/
         MVI   DARGSENT(@15),X'16'                                 0710
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
         L     @15,@PC00001                                        0711
         ST    @15,@AL00001                                        0711
         LA    @14,@CF00111                                        0711
         ST    @14,@AL00001+4                                      0711
         LA    @14,VEDDSTRU                                        0711
         ST    @14,@AL00001+8                                      0711
         MVI   @AL00001+8,X'80'                                    0711
         L     @15,GDTPRT(,@15)                                    0711
         LA    @01,@AL00001                                        0711
         BALR  @14,@15                                             0711
*               VECOND=LASTCC04;    /*                       @Y30LB38*/
         LA    VECOND,4                                            0712
*             END;                  /*                       @Y30LB38*/
*         END;                      /*                       @Y30LB38*/
@RC00672 DS    0H                                                  0715
*     END;                          /*                       @Y30LB38*/
*                                                                  0715
@RC00663 DS    0H                                                  0716
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0716
*   REG14=VERETADR;                 /*                       @Y30LB38*/
@RC00600 LR    REG14,VERETADR                                      0716
*   RETURN CODE(VECOND);            /*                       @Y30LB38*/
         LR    @15,VECOND                                          0717
@EL00007 DS    0H                                                  0717
@EF00007 DS    0H                                                  0717
@ER00007 BR    @14                                                 0717
*   END VOLEXIT;                    /*                       @Y30LB38*/
*                                                                  0719
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  0719
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           0719
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00008                                    0719
         MVC   @PC00008(8),0(@01)                                  0719
*                                   /*                       @Y30LB39*/
*                                                                  0720
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0720
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0720
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0720
*                                   /*                       @Y30LB39*/
*   DCL                                                            0720
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            0721
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0721
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0722
*                                   /*                       @Y30LB39*/
*   DCL                                                            0722
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            0723
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0723
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0724
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0724
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0724
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0725
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0725
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0725
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0726
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0726
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0726
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0727
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0727
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0727
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0728
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0728
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0729
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0729
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0729
         L     @15,@PC00001                                        0729
         L     @14,GDTTR2(,@15)                                    0729
         MVC   @TS00001(95),NEWERID2(@14)                          0729
         MVC   OLDERID2(95,@14),@TS00001                           0729
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0730
         MVC   NEWID2(4,@14),@CC01237                              0730
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0731
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0731
         LA    @14,SSDRGLT                                         0731
         ST    @14,SSDLPTR                                         0731
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0732
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              0732
         L     @09,@PC00008                                        0732
         L     @09,SSRCODE(,@09)                                   0732
         LTR   @09,@09                                             0732
         BNP   @RF00732                                            0732
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0733
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0734
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0734
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        0735
         ST    @03,DARGRETP(,@14)                                  0735
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            0736
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 0737
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0738
         MVC   DARGRETL(2,@14),@CH01241                            0738
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0739
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0739
         ST    @15,@AL00001                                        0739
         LA    @03,@CF00111                                        0739
         ST    @03,@AL00001+4                                      0739
         LA    @03,SSDLPTR                                         0739
         ST    @03,@AL00001+8                                      0739
         MVI   @AL00001+8,X'80'                                    0739
         L     @15,GDTPRT(,@15)                                    0739
         LA    @01,@AL00001                                        0739
         BALR  @14,@15                                             0739
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0740
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          0740
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)SSARRAY(ENTRYNUM)=0);   0741
@DL00741 DS    0H                                                  0742
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00213                                   0742
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0743
@DE00741 L     @03,@PC00008                                        0743
         LR    @15,ENTRYNUM                                        0743
         ALR   @15,@15                                             0743
         LH    @15,SSARRAY-2(@15)                                  0743
         CH    @15,SSRHALF(,@03)                                   0743
         BE    @DC00741                                            0743
         SLR   @14,@14                                             0743
         CR    @15,@14                                             0743
         BNE   @DL00741                                            0743
@DC00741 DS    0H                                                  0744
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0744
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0744
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @09,SSDLPTR                                         0745
         MVC   DARGSMOD(3,@09),SSMODSS0                            0745
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@09)                             0746
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             0747
         BNE   @RF00747                                            0747
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@09)                                   0749
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00041                             0750
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0753
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0753
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC00732                                            0753
@RF00732 DS    0H                                                  0754
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0754
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         0755
         MVC   DARGSMOD(3,@15),SSMODCM0                            0755
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            0756
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00008+4                                      0757
         ST    @14,DARGDBP(,@15)                                   0757
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00213                             0758
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0759
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0760
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0760
@RC00732 L     @15,@PC00001                                        0760
         ST    @15,@AL00001                                        0760
         LA    @14,@CF00111                                        0760
         ST    @14,@AL00001+4                                      0760
         LA    @14,SSDLPTR                                         0760
         ST    @14,@AL00001+8                                      0760
         MVI   @AL00001+8,X'80'                                    0760
         L     @15,GDTPRT(,@15)                                    0760
         LA    @01,@AL00001                                        0760
         BALR  @14,@15                                             0760
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0761
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0761
         L     @14,@SA00008                                        0761
         LM    @00,@12,@SA00008+8                                  0761
         BR    @14                                                 0761
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCEV01                     /*                       @Y30LB38*/
*                                                                  0763
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSEV )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF51 )                                       */
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  0763
*       ;                                                          0763
@DATA    DS    0H
@CH00147 DC    H'2'
@CH00150 DC    H'6'
@CH00976 DC    H'48'
@CH01240 DC    H'68'
@CH01168 DC    H'72'
@CH01241 DC    H'120'
@CH01239 DC    H'224'
         DS    0F
@AL00243 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01065)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@PC00006 DS    2F
@PC00007 DS    5F
@SA00008 DS    15F
@PC00008 DS    2F
@AL00001 DS    6A
@AFTEMPS DS    3F
IDCEV01  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00213 DC    F'1'
@CH00213 EQU   @CF00213+2
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00173 DC    F'8'
@CF00536 DC    F'12'
@CH00536 EQU   @CF00536+2
@CF00465 DC    F'16'
@CF01216 DC    XL4'4C'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
RVVIPTR  DS    A
REASONCD DS    F
VEDDSTRU DS    A
MCLSTPTR DS    A
VEMSGPTR DS    A
VEWTOPTR DS    A
VERESNCD DS    F
SSDLPTR  DS    A
LISTPTR  DS    A
VEWTOLEN DS    H
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
         DS    CL1
PRINTAB  DS    CL20
CSNWORK  DS    CL12
VVIREC   DS    CL224
VVILIST  DS    CL68
LOCATION DS    CL30
RNAME    DS    CL23
         ORG   RNAME
@NM00070 DS    FL1
VOLSN    DS    CL6
@NM00071 DS    CL16
         ORG   RNAME+23
FLAGS    DS    BL1
         ORG   FLAGS
RRCDFAIL DS    BL1
@NM00072 EQU   FLAGS+0
         ORG   FLAGS+1
RECINDIC DS    BL1
         ORG   RECINDIC
RECFLAG  DS    BL1
@NM00073 EQU   RECINDIC+0
         ORG   RECINDIC+1
MSICERR  DS    BL1
         ORG   MSICERR
INVERR   DS    BL1
@NM00074 EQU   MSICERR+0
         ORG   MSICERR+1
DMPSTG   DS    CL17
CKCSNADJ DS    CL12
         DS    CL3
CKPRTTAB DS    CL20
VEECB    DS    CL1
VELIST   DS    CL52
VEWTOMSG DS    CL72
VEMCLIST DS    CL48
VEEXLIST DS    CL44
VESYSIN  DS    CL16
         ORG   VESYSIN
VEJOBNAM DS    CL8
VESTEPNM DS    CL8
         ORG   VESYSIN+16
VEROUTCD DS    BL2
         ORG   VEROUTCD
VECD1    DS    BL1
@NM00088 EQU   VEROUTCD+0
         ORG   VEROUTCD+2
VEDESCCD DS    BL2
         ORG   VEDESCCD
@NM00089 DS    BL1
VEDESC3  EQU   VEDESCCD+0
@NM00090 EQU   VEDESCCD+0
         ORG   VEDESCCD+2
VEDMPSTG DS    CL17
SSDRGLT  DS    CL20
         DS    CL2
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCEV01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
NOREC    DC    XL4'208'
RVVLEN   DC    AL2(68)
MCRLEN   DC    AL2(44)
SSMSGNUM DC    AL1(56)
@CC01065 DC    C'SYSZAMS '
@CC01095 DC    C'VVILIST'
@CC01209 DC    C'MCLIST'
@CC01074 DC    C'EVVE'
@CC01083 DC    C'EVRC'
@CC01087 DC    C'EVPC'
@CC01093 DC    C'EVVP'
@CC01097 DC    C'EVBR'
@CC01103 DC    C'EVDC'
@CC01104 DC    C'EVBV'
@CC01108 DC    C'EVRP'
@CC01126 DC    C'CKLN'
@CC01208 DC    C'VESR'
@CC01210 DC    C'VEBM'
@CC01237 DC    C'SSAA'
@CC01057 DC    C'UV0'
@CC01059 DC    C'EV0'
@CC01061 DC    C'CM0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
FIXAREA  DS    CL250
         ORG   FIXAREA
@NM00069 DC    250X'00'
         ORG   FIXAREA+250
RNAMECON DS    CL23
         ORG   RNAMECON
@NM00075 DC    AL1(22)
@NM00076 DS    CL6
@NM00077 DC    CL8'.VIRTUAL'
@NM00078 DC    CL8'.ENQUEUE'
         ORG   RNAMECON+23
MODID    DC    CL4'EV01'
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
VECOND   EQU   @04
VERETADR EQU   @05
MCRTEPTR EQU   @03
CKCOND   EQU   @03
CKSAVPTR EQU   @05
CKRETPTR EQU   @04
CODE2    EQU   @05
RETADDR2 EQU   @05
RETADDR1 EQU   @06
BCDVPTR  EQU   @07
BASEVPTR EQU   @04
DMPINDEX EQU   @02
TESTRC   EQU   @03
SETRC    EQU   @08
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
REG14    EQU   @14
MCR1     EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
IDCSAWO0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
VOL      EQU   0
VOLVAL   EQU   VOL+1
CDATE    EQU   0
DATE     EQU   0
DATEVAL  EQU   DATE
SEQ      EQU   0
SEQVAL   EQU   SEQ
CART     EQU   0
CARTLEN  EQU   CART
CARTVAL  EQU   CART+1
REC      EQU   0
NREC     EQU   0
LOC      EQU   0
LOCVAL   EQU   LOC+1
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CMNUMCRT EQU   CMMSG+15
CMCSN1   EQU   CMMSG+16
CMCSN2   EQU   CMMSG+28
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00056 EQU   SV82LIST+4
SV82DCBP EQU   @NM00056
@NM00057 EQU   SV82LIST+12
SV82WRKP EQU   @NM00057
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASINAC  EQU   BASFLAGA+2
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASCSN1  EQU   BASEV+24
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BCDV     EQU   0
BCDNAME  EQU   BCDV
BCDPREFX EQU   BCDNAME
BCDID    EQU   BCDNAME+11
BCDFLAGA EQU   BCDV+14
BCDTYPE  EQU   BCDFLAGA
BCDBASE  EQU   BCDTYPE
BCDCOPY  EQU   BCDTYPE
BCDDUP   EQU   BCDTYPE
BCDFLAGB EQU   BCDFLAGA+2
BCDRCVYF EQU   BCDV+20
BCDSATIA EQU   BCDRCVYF
BCDIVCPY EQU   BCDSATIA
BCDMISCF EQU   BCDRCVYF+2
BCDLIB1  EQU   BCDV+36
BCDLID1  EQU   BCDLIB1
BCDLIB2  EQU   BCDV+49
BCDLID2  EQU   BCDLIB2
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVCDATE EQU   RVVI+38
RVVRDSEQ EQU   RVVI+43
RVVRDCSN EQU   RVVI+44
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSDTE  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSVOL  EQU   RVVSPEC
MCRTE    EQU   0
MCRLNGTH EQU   MCRTE
MCRLOC   EQU   MCRTE+4
MCRFLAGA EQU   MCRTE+34
MCRSPLOC EQU   MCRFLAGA
MCRFLAGB EQU   MCRTE+36
MCRTYPE  EQU   MCRFLAGB+2
MCRREC   EQU   MCRTYPE
MCLIST   EQU   0
MCRTFLG  EQU   MCLIST+6
MCRTTRAN EQU   MCRTFLG
MCRTLIB  EQU   MCLIST+7
MCRTCSN  EQU   MCLIST+24
MCRTVEXT EQU   MCLIST+44
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
CKCSNVAL EQU   0
CKLENGTH EQU   0
VECSN1   EQU   0
VEVOLUME EQU   0
VEVVIERR EQU   0
VERECFLG EQU   0
VEVOLLOC EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
*                                      START UNREFERENCED COMPONENTS
@NM00091 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
MCRTECB  EQU   MCLIST+40
MCRTASID EQU   MCLIST+38
MCRTRES4 EQU   MCLIST+36
MCRTRES3 EQU   MCLIST+16
MCRTRES2 EQU   MCLIST+8
MCRTLD   EQU   MCRTLIB
@NM00087 EQU   MCRTLIB
@NM00086 EQU   MCRTFLG
MCRTSCT  EQU   MCRTFLG
@NM00085 EQU   MCRTFLG
MCRTRES1 EQU   MCLIST+5
MCRTOPCD EQU   MCLIST+4
MCRTLEN  EQU   MCLIST
@NM00084 EQU   MCRTE+40
@NM00083 EQU   MCRFLAGB+3
@NM00082 EQU   MCRTYPE
@NM00081 EQU   MCRFLAGB+1
@NM00080 EQU   MCRFLAGB
MCRBLNK1 EQU   MCRTE+35
@NM00079 EQU   MCRFLAGA
@NM00068 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00067 EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
@NM00066 EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
@NM00065 EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00064 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00063 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVBLNK1 EQU   RVVI+42
RVVEXPIR EQU   RVVI+36
@NM00062 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00061 EQU   RVVOPCOD+1
BCD2BIT2 EQU   BCDLID2
BCD2BIT1 EQU   BCDLID2
BCDRES8  EQU   BCDLIB2
BCDCSN2  EQU   BCDV+37
BCD1BIT2 EQU   BCDLID1
BCD1BIT1 EQU   BCDLID1
BCDRE10  EQU   BCDLIB1
BCDCSN1  EQU   BCDV+24
BCDRES7A EQU   BCDMISCF
BCDHOLD  EQU   BCDMISCF
BCDRES7  EQU   BCDSATIA
BCDVSMIS EQU   BCDSATIA
BCDIVCRE EQU   BCDSATIA
BCDCPUID EQU   BCDV+18
BCDRES5  EQU   BCDFLAGB+1
BCDREASS EQU   BCDFLAGB+1
BCDRES4  EQU   BCDFLAGB
BCDRES3  EQU   BCDTYPE
BCDRES2  EQU   BCDTYPE
BCDRES1  EQU   BCDTYPE
BCDRES9  EQU   BCDV+13
BCDINDEX EQU   BCDID+1
BCDBLNK2 EQU   BCDID
BCDSERNO EQU   BCDNAME+5
BCDBLNK1 EQU   BCDPREFX+1
BCDALPHA EQU   BCDPREFX
@NM00060 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00059 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00058 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
@NM00055 EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00054 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00053 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00052 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00051 EQU   RCTAGL+10
@NM00050 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00049 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00048 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00047 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00046 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00045 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
@NM00044 EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSDDNAME EQU   VS2AGL+37
@NM00043 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00042 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00041 EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00040 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00039 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00038 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00037 EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00036 EQU   CKFLAGS
CKEXCL   EQU   CKFLAGS
CKDYALOC EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00035 EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00034 EQU   CTMSG
@NM00033 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00032 EQU   CMMSG+7
@NM00031 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00030 EQU   CCMSG+6
CCVOL    EQU   CCMSG
LOCLEN   EQU   LOC
VOLLEN   EQU   VOL
@NM00029 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00028 EQU   DMPITM+15
@NM00027 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00026 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00025 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00024 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00023 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00022 EQU   OPNAGL+43
@NM00021 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNF EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00020 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00019 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00018 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00017 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00016 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00015 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACNF EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RF00234 EQU   @RC00227
@RC00258 EQU   @RC00248
@RF00306 EQU   @RC00301
@RC00350 EQU   @RC00348
@RC00356 EQU   @RC00348
@RC00375 EQU   @RC00365
@RC00475 EQU   @RC00473
@RF00747 EQU   @RC00732
@PB00008 EQU   @EL00001
@RC00260 EQU   @RC00258
@RC00377 EQU   @RC00375
@RC00392 EQU   @RC00375
@RF00477 EQU   @RC00475
@RF00479 EQU   @RC00475
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCEV01,(C'PLS2119',0603,74298)

         TITLE '*********** IDCCV01: CREATEV FUNCTION SUPPORT ROUTINE **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCCV01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCCV01   78.164'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @11,0                                               0002
@PSTART  LA    @12,4095(,@11)                                      0002
         LA    @09,4095(,@12)                                      0002
         USING @PSTART,@11                                         0002
         USING @PSTART+4095,@12                                    0002
         USING @PSTART+8190,@09                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0002
         USING @DATD,@10                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @10,8(,@13)                                         0002
         LR    @13,@10                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0289
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN CONTROL ROUTING ROUTINE FOR CREATEV  @Y30LB32*/
*   /* WRITES MESSAGES IDC0001I IF FUNCTION WAS COMPLETED    @Y30LB32*/
*   /* AND IDC3003I IF FUNCTION TERMINATED. CONTROL IS       @Y30LB32*/
*   /* RETURNED TO THE EXECUTIVE FROM THIS ROUTINE           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   OLDERID2=NEWERID2;                                             0289
         L     @08,@PC00001                                        0289
         L     @15,GDTTR2(,@08)                                    0289
         MVC   @TS00001(95),NEWERID2(@15)                          0289
         MVC   OLDERID2(95,@15),@TS00001                           0289
*   NEWID2='CVCR';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@15),@CC01528                              0290
*   IF GDTDBG=NULLPTR THEN                                         0291
         L     @08,GDTDBG(,@08)                                    0291
         LTR   @08,@08                                             0291
         BZ    @RT00291                                            0291
*     ;                                                            0292
*   ELSE                                                           0293
*     CALL IDCDB010(GDTTBL,'CVCV'); /*                       @Y30LB32*/
*                                                                  0293
         L     @08,@PC00001                                        0293
         ST    @08,@AL00001                                        0293
         LA    @15,@CC01529                                        0293
         ST    @15,@AL00001+4                                      0293
         MVI   @AL00001+4,X'80'                                    0293
         L     @15,GDTDBG(,@08)                                    0293
         LA    @01,@AL00001                                        0293
         BALR  @14,@15                                             0293
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE ICBDEFV PARM LIST AREAS TO ZEROES          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/
@RT00291 LA    @07,PARMLST                                         0294
         ST    @07,DEFLSTP                                         0294
*   DEFLIST=''B;                    /*                       @Y30LB32*/
         XC    DEFLIST(132,@07),DEFLIST(@07)                       0295
*   DEFLSTP=ADDR(PARMLST2);         /*                       @Y30LB32*/
         LA    @05,PARMLST2                                        0296
         ST    @05,DEFLSTP                                         0296
*   DEFLIST=''B;                    /*                       @Y30LB32*/
*                                                                  0297
         XC    DEFLIST(132,@05),DEFLIST(@05)                       0297
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MSVC PARAMETER LISTS TO ZEROES             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0298
*   DEFVEPTR=ADDR(DEFLSTEX);        /*                       @Y30LB32*/
         LA    DEFVEPTR,DEFLSTEX                                   0298
*   MVRPTR=ADDR(MVRLST);            /*                       @Y30LB32*/
         LA    @05,MVRLST                                          0299
         ST    @05,MVRPTR                                          0299
*   RVVIPTR=ADDR(RVVILST);          /*                       @Y30LB32*/
         LA    @15,RVVILST                                         0300
         ST    @15,RVVIPTR                                         0300
*   DEFVE=''B;                      /*                       @Y30LB32*/
         XC    DEFVE(64,DEFVEPTR),DEFVE(DEFVEPTR)                  0301
*   MVR=''B;                        /*                       @Y30LB32*/
         XC    MVR(88,@05),MVR(@05)                                0302
*   RVVI=''B;                       /*                       @Y30LB32*/
*                                                                  0303
         XC    RVVI(68,@15),RVVI(@15)                              0303
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DEFVE EXTENSION LIST WITH LENGTH OF LIST   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*   DEFLNGTH=DEFLEN;                /*                       @Y30LB32*/
*                                                                  0304
         LH    @14,DEFLEN                                          0304
         ST    @14,DEFLNGTH(,DEFVEPTR)                             0304
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MSVC PARM LISTS WITH LENGTH AND OP CODE    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB32*/
         LH    @14,RVVLEN                                          0305
         ST    @14,RVVLNGTH(,@15)                                  0305
*   RVVCODE=RVVOP;                  /*                       @Y30LB32*/
         MVI   RVVCODE(@15),X'87'                                  0306
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB32*/
         LH    @15,MVRLEN                                          0307
         ST    @15,MVRLNGTH(,@05)                                  0307
*   MVROPCD=MVROP;                  /*                       @Y30LB32*/
*                                                                  0308
         MVI   MVROPCD(@05),X'85'                                  0308
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE VS2AGL, MDAGL, AND CKAGL ARGUMENT LISTS TO @Y30LB32*/
*   /* ZEROES                                                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   RFY                                                            0309
*     VS2AGL BASED(VSAGLPTR);       /*                       @Y30LB32*/
*   RFY                                                            0310
*     MDAGL BASED(MDAGLPTR);        /*                       @Y30LB32*/
*   RFY                                                            0311
*     CKAGL BASED(CKAGLPTR);        /*                       @Y30LB32*/
*   RFY                                                            0312
*     EXCLAGL BASED(ADDR(EXCLLST)); /*                       @YD00175*/
*   VSAGLPTR=ADDR(VS2AGLST);        /*                       @Y30LB32*/
         LA    @15,VS2AGLST                                        0313
         ST    @15,VSAGLPTR                                        0313
*   MDAGLPTR=ADDR(MDAGLLST);        /*                       @Y30LB32*/
         LA    @14,MDAGLLST                                        0314
         ST    @14,MDAGLPTR                                        0314
*   CKAGLPTR=ADDR(CKAGLLST);        /*                       @Y30LB32*/
         LA    CKAGLPTR,CKAGLLST                                   0315
*   VS2AGL=''B;                     /*                       #Y30LB32*/
         XC    VS2AGL(52,@15),VS2AGL(@15)                          0316
*   MDAGL=''B;                      /*                       #Y30LB32*/
         XC    MDAGL(37,@14),MDAGL(@14)                            0317
*   CKAGL=''B;                      /*                       #Y30LB32*/
         XC    CKAGL(29,CKAGLPTR),CKAGL(CKAGLPTR)                  0318
*   EXCLAGL=''B;                    /*                       @YD00175*/
*                                                                  0319
         LA    @03,EXCLLST                                         0319
         XC    EXCLAGL(23,@03),EXCLAGL(@03)                        0319
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DEFINE PARM LIST FIELDS TO CREATE A VOLUME @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0320
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/
         ST    @07,DEFLSTP                                         0320
*   DEFVCR=ON;                      /*                       @Y30LB32*/
         OI    DEFVCR(@07),B'10000000'                             0321
*   DEFTLAB=TCHAR;                  /*                       @Y30LB32*/
         MVI   DEFTLAB(@07),C'T'                                   0322
*   DEFVVEXT=DEFVEPTR;              /*                       @Y30LB32*/
         ST    DEFVEPTR,DEFVVEXT(,@07)                             0323
*                                                                  0324
*   /*****************************************************************/
*   /*                                                               */
*   /* SET DEFSRCVY TO INDICATE RECOVERY FLAG IS TO BE SET   @Y30LB32*/
*   /* AND SET DEFCREAT TO INDICATE INCOMPLETE CREATE FLAG   @Y30LB32*/
*   /* IS TO BE SET                                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0324
*   DEFSRCVY=ON;                    /*                       @Y30LB32*/
         OI    DEFSRCVY(DEFVEPTR),B'10000000'                      0324
*   DEFCREAT=ON;                    /*                       @Y30LB32*/
*                                                                  0325
         OI    DEFCREAT(DEFVEPTR),B'01000000'                      0325
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE AREA FOR UCB ADDRESS TO ZEROES AND         @Y30LB32*/
*   /* SET VS2AGL, MDAGL, CKAGL, AND EXCLAGL ARGUMENT        @YD00175*/
*   /* LISTS WITH POINTER TO AREA FOR UCB ADDRESS            @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0326
*   UCBPTR=''B;                     /*                       @Y30LB32*/
         SLR   @07,@07                                             0326
         ST    @07,UCBPTR                                          0326
*   VSUCBPTR=ADDR(UCBPTR);          /*                       @Y30LB32*/
         LA    @07,UCBPTR                                          0327
         ST    @07,VSUCBPTR(,@15)                                  0327
*   MDUCBPTR=ADDR(UCBPTR);          /*                       @Y30LB32*/
         ST    @07,MDUCBPTR(,@14)                                  0328
*   CKUCBPTR=ADDR(UCBPTR);          /*                       @Y30LB32*/
         ST    @07,CKUCBPTR(,CKAGLPTR)                             0329
*   EXCLUCBP=ADDR(UCBPTR);          /*                       @YD00175*/
*                                                                  0330
         ST    @07,EXCLUCBP(,@03)                                  0330
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FLAG BITS USED BY CREATEV TO ZEROS         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   CRVFLGS=''B;                    /*                       @Y30LB32*/
*                                                                  0331
         XC    CRVFLGS(2),CRVFLGS                                  0331
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CLEAR INCOMPLETE VOLUME CREATION FLAG  @Y30LB32*/
*   /* IN MVR                                                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0332
*   MVRCIVCF=ON;                    /*                       @Y30LB32*/
*                                                                  0332
         OI    MVRCIVCF(@05),B'10000000'                           0332
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RNAME WITH LENGTH OF NAME AND WITH KEYWORD        @Y30LB32*/
*   /* VIRTUAL TO ENQUEUE AND RESERVE VOLUMES                @ZA05119*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0333
*   RNAMELN=LENGTH(VOLSER)+LENGTH(VIRTNAME)/*                @ZA13060*/
*       +LENGTH(TYPENAME);          /*                       @ZA13060*/
         MVI   RNAMELN,X'16'                                       0333
*   VIRTNAME=VIRTUAL;               /*                       @Y30LB32*/
*                                                                  0334
         MVC   VIRTNAME(8),@CC01487                                0334
*   /*****************************************************************/
*   /*                                                               */
*   /* SET POINTER TO DARGLIST WITH ADDRESS TO STORAGE AREA  @Y30LB32*/
*   /* SET GROUP RECORD PTR WITH ADDRESS TO BUFFER AREA      @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB32*/
         LA    @07,PRINTTAB                                        0335
         ST    @07,DDSTRU                                          0335
*   GROUPPTR=ADDR(BUFFER);          /*                       @Y30LB32*/
*                                                                  0336
         LA    GROUPPTR,BUFFER                                     0336
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDE POINTER VALUE TO LOCATE DATA RETURNED BY      @Y30LB32*/
*   /* DEFINE MACRO MESSAGE                                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   RFY                                                            0337
*     CMMSG BASED(CMMSGPTR+ECBLEN); /*                       @Y30LB32*/
*                                                                  0338
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FDT TO DETERMINE IF THE GROUP PARAMETER WAS     @Y30LB32*/
*   /* SPECIFIED, IF SPECIFIED INVOKE ROUTINE GRPPROC        @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*   IF(ADDR(GRP))^=NULLPTR THEN     /*                       @Y30LB32*/
         L     @07,@PC00001+4                                      0338
         L     @07,FDTPTR+36(,@07)                                 0338
         LTR   @07,@07                                             0338
         BZ    @RF00338                                            0338
*     DO;                           /*                       @Y30LB32*/
*       CALL GRPPROC;               /*                       @Y30LB32*/
         BAL   @14,GRPPROC                                         0340
*       RESPECIFY                                                  0341
*         RTNREG RSTD;                                             0341
*       TESTRC=RTNREG;                                             0342
         LR    TESTRC,RTNREG                                       0342
*       RESPECIFY                                                  0343
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0344
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ATTRIBUTE ROUTINE TO CHECK GROUP ATTRIBUTES      @Y30LB32*/
*   /* SPECIFIED AND SET ATTRIBUTES FOR NEW VOLUME           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0345
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC00338                                            0345
@RF00338 DS    0H                                                  0346
*       CALL ATTRBUTE;              /*                       @Y30LB32*/
         BAL   @14,ATTRBUTE                                        0346
*       RESPECIFY                                                  0347
*         RTNREG RSTD;                                             0347
*       TESTRC=RTNREG;                                             0348
         LR    TESTRC,RTNREG                                       0348
*       RESPECIFY                                                  0349
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0350
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ERROR RETURN CODE FROM GRPPROC OR ATTRIBUTE @Y30LB32*/
*   /* IF ERROR CODE RETURNED SET LASTCOND                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   IF TESTRC^=0 THEN               /*                       @Y30LB32*/
@RC00338 LTR   TESTRC,TESTRC                                       0351
         BZ    @RF00351                                            0351
*     LASTCOND=LASTCC04;            /*                       @Y30LB32*/
*                                                                  0352
         L     @07,@PC00001+8                                      0352
         MVC   LASTCOND(2,@07),@CH00042                            0352
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE COUNTVAL FIELD IN THE FDT TO DETERMINE      @Y30LB32*/
*   /* NUMBER OF NEW VOLUMES TO BE CREATED. IF COUNT IS MORE @Y30LB32*/
*   /* THEN ONE CALL CKVOLSER ROUTINE TO CHECK VOLUME SERIAL @Y30LB32*/
*   /* FOR NUMERIC CHARACTERS                                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0353
*   IF COUNTVAL>1 THEN              /*                       @Y30LB32*/
@RF00351 L     @07,@PC00001+4                                      0353
         L     @07,FDTPTR+8(,@07)                                  0353
         L     @07,COUNTVAL(,@07)                                  0353
         C     @07,@CF00221                                        0353
         BNH   @RF00353                                            0353
*     DO;                           /*                       @Y30LB32*/
*       CALL CKVOLSER;              /*                       @Y30LB32*/
         BAL   @14,CKVOLSER                                        0355
*       RESPECIFY                                                  0356
*         RTNREG RSTD;                                             0356
*       TESTRC=RTNREG;                                             0357
         LR    TESTRC,RTNREG                                       0357
*       RESPECIFY                                                  0358
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  0358
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ERROR RETURN CODE FROM CKVOLSER. IF     @Y30LB32*/
*       /* ERROR CODE RETURNED SET LASTCOND                  @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0359
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0359
         BZ    @RF00359                                            0359
*         LASTCOND=LASTCC04;        /*                       @Y30LB32*/
         L     @07,@PC00001+8                                      0360
         MVC   LASTCOND(2,@07),@CH00042                            0360
*     END;                          /*                       @Y30LB32*/
@RF00359 DS    0H                                                  0362
*                                                                  0362
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CKAGL ARGUMENT LIST TO CHECK FOR A 3330    @Y30LB32*/
*   /* VIRTUAL UCB. THE DDNAME IS ACCESSED FROM THE FDT      @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0362
*   CKDDNAME=FILEVAL;               /*                       @Y30LB32*/
@RF00353 L     @07,@PC00001+4                                      0362
         L     @07,FDTPTR+4(,@07)                                  0362
         MVC   CKDDNAME(8,CKAGLPTR),FILEVAL(@07)                   0362
*   CKTESTVT=ON;                    /*                       @Y30LB32*/
*                                                                  0363
         OI    CKTESTVT(CKAGLPTR),B'10000000'                      0363
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT(CHECK) TO CHECK FOR A 3330 VIRTUAL UCB @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                     @Y30LB32*/
         L     @07,@PC00001                                        0364
         ST    @07,@AL00001                                        0364
         LA    @02,CHECK                                           0364
         ST    @02,@AL00001+4                                      0364
         ST    CKAGLPTR,@AL00001+8                                 0364
         MVI   @AL00001+8,X'80'                                    0364
         L     @15,GDTUNT(,@07)                                    0364
         LA    @01,@AL00001                                        0364
         BALR  @14,@15                                             0364
*   RESPECIFY                                                      0365
*     RTNREG RSTD;                                                 0365
*   TESTRC=RTNREG;                                                 0366
         LR    TESTRC,RTNREG                                       0366
*   RESPECIFY                                                      0367
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0367
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ERROR RETURN CODE FROM UMSSUNIT(CHECK). IF  @Y30LB32*/
*   /* ERROR CODE IS RETURNED SET LASTCOND                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*   IF TESTRC^=0 THEN               /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0368
         BZ    @RF00368                                            0368
*     LASTCOND=LASTCC04;            /*                       @Y30LB32*/
*                                                                  0369
         L     @15,@PC00001+8                                      0369
         MVC   LASTCOND(2,@15),@CH00042                            0369
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS, GET EXCLUSIVE CONTROL OF THE VOLUME     @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0370
*   IF LASTCOND=LASTCC00 THEN                                      0370
@RF00368 L     @15,@PC00001+8                                      0370
         LH    @15,LASTCOND(,@15)                                  0370
         LTR   @15,@15                                             0370
         BNZ   @RF00370                                            0370
*     DO;                           /*                       @YD00175*/
*       EXCLDDP=ADDR(FILEVAL);      /*                       @YD00175*/
*                                                                  0372
         LA    @02,EXCLLST                                         0372
         L     @15,@PC00001+4                                      0372
         L     @01,FDTPTR+4(,@15)                                  0372
         LA    @15,FILEVAL(,@01)                                   0372
         ST    @15,EXCLDDP(,@02)                                   0372
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT(CHANGEX) TO GET EXCLUSIVE CONTROL  @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0373
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/
         L     @15,@PC00001                                        0373
         ST    @15,@AL00001                                        0373
         LA    @14,CHANGEX                                         0373
         ST    @14,@AL00001+4                                      0373
         ST    @02,@AL00001+8                                      0373
         MVI   @AL00001+8,X'80'                                    0373
         L     @15,GDTUNT(,@15)                                    0373
         LA    @01,@AL00001                                        0373
         BALR  @14,@15                                             0373
*       RESPECIFY                                                  0374
*         RTNREG RSTD;                                             0374
*       TESTRC=RTNREG;                                             0375
         LR    TESTRC,RTNREG                                       0375
*       RESPECIFY                                                  0376
*         RTNREG UNRSTD;            /*                       @YD00175*/
*       IF TESTRC>0 THEN                                           0377
         LTR   TESTRC,TESTRC                                       0377
         BNP   @RF00377                                            0377
*         LASTCOND=LASTCC04;        /*                       @YD00175*/
         L     @15,@PC00001+8                                      0378
         MVC   LASTCOND(2,@15),@CH00042                            0378
*     END;                          /*                       @YD00175*/
*                                                                  0379
@RF00377 DS    0H                                                  0380
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK CONDITION CODE EQUAL ZERO, IF ZERO CALL ACCESS  #Y30LB32*/
*   /* ROUTINE                                               #Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0380
*   IF LASTCOND=LASTCC00 THEN       /*                       #Y30LB32*/
@RF00370 L     @15,@PC00001+8                                      0380
         LH    @15,LASTCOND(,@15)                                  0380
         LTR   @15,@15                                             0380
         BNZ   @RF00380                                            0380
*     DO;                           /*                       #Y30LB32*/
*       CALL ACCESS;                /*                       #Y30LB32*/
*                                                                  0382
         BAL   @14,ACCESS                                          0382
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CREATVOL ROUTINE TO CREATE NEW VOLUME        @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0383
*       CALL CREATVOL;              /*                       @Y30LB32*/
         BAL   @14,CREATVOL                                        0383
*       RESPECIFY                                                  0384
*         RTNREG RSTD;                                             0384
*       TESTRC=RTNREG;                                             0385
         LR    TESTRC,RTNREG                                       0385
*       RESPECIFY                                                  0386
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  0386
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ERROR RETURN CODE FROM CREATVOL. IF     @Y30LB32*/
*       /* ERROR CODE IS RETURNED SET LASTCOND               @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0387
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0387
         BZ    @RF00387                                            0387
*         LASTCOND=LASTCC04;        /*                       @Y30LB32*/
*                                                                  0388
         L     @08,@PC00001+8                                      0388
         MVC   LASTCOND(2,@08),@CH00042                            0388
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK CONDITION CODE TO SET FINAL CONDITION CODE  @Y30LB32*/
*       /* IF CONDITION CODE IS NOT ZERO CHECK CREATFLG TO   @Y30LB32*/
*       /* SEE IF ANY VOLUMES WERE CREATED                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0389
*       IF LASTCOND^=0 THEN         /*                       @Y30LB32*/
@RF00387 L     @08,@PC00001+8                                      0389
         LH    @15,LASTCOND(,@08)                                  0389
         LTR   @15,@15                                             0389
         BZ    @RF00389                                            0389
*         DO;                       /*                       @Y30LB32*/
*                                                                  0390
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK CREATFLG FLAG, IF ON SET LASTCOND TO    @Y30LB32*/
*           /* EIGHT                                         @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0391
*           IF CREATFLG=ON THEN     /*                       @Y30LB32*/
         TM    CREATFLG,B'10000000'                                0391
         BNO   @RF00391                                            0391
*             LASTCOND=LASTCC08;    /*                       @Y30LB32*/
*                                                                  0392
         MVC   LASTCOND(2,@08),@CH00181                            0392
*           /*********************************************************/
*           /*                                                       */
*           /* SET LASTCOND TO TWELVE IF NO VOLUMES CREATED  @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0393
*           ELSE                    /*                       @Y30LB32*/
*             LASTCOND=LASTCC12;    /*                       @Y30LB32*/
         B     @RC00391                                            0393
@RF00391 L     @08,@PC00001+8                                      0393
         MVC   LASTCOND(2,@08),@CH00606                            0393
*         END;                      /*                       @Y30LB32*/
*                                                                  0394
*       /*************************************************************/
*       /*                                                           */
*       /* IF CONDITION CODE IS ZERO AND VIERRFLG IS ON THEN @ZA00067*/
*       /* SET FINAL CONDITION CODE TO FOUR. IF ROFAIL FLAG  @ZA00067*/
*       /* IS ON THEN SET FINAL CONDITION CODE TO EIGHT.     @ZA00067*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0395
*       ELSE                        /*                       @Y30LB32*/
*         DO;                       /*                       @ZA00067*/
         B     @RC00389                                            0395
@RF00389 DS    0H                                                  0396
*           IF VIERRFLG=ON THEN     /*                       @ZA00067*/
         TM    VIERRFLG,B'01000000'                                0396
         BNO   @RF00396                                            0396
*             LASTCOND=LASTCC04;    /*                       @ZA00067*/
         L     @08,@PC00001+8                                      0397
         MVC   LASTCOND(2,@08),@CH00042                            0397
*           IF ROFAIL=ON THEN       /*                       @ZA00067*/
@RF00396 TM    ROFAIL,B'00000010'                                  0398
         BNO   @RF00398                                            0398
*             LASTCOND=LASTCC08;    /*                       @ZA00067*/
         L     @08,@PC00001+8                                      0399
         MVC   LASTCOND(2,@08),@CH00181                            0399
*         END;                      /*                       @ZA00067*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0401
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CONDITION CODE WAS NOT ZERO BEFORE CALL TO         @Y30LB32*/
*   /* ACCESS ROUTINE SET LASTCOND TO TWELVE                 @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   ELSE                            /*                       @Y30LB32*/
*     LASTCOND=LASTCC12;            /*                       @Y30LB32*/
         B     @RC00380                                            0402
@RF00380 L     @08,@PC00001+8                                      0402
         MVC   LASTCOND(2,@08),@CH00606                            0402
*                                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE COMPLETION MESSAGE IDC0001I IF FUNCTION WAS     @Y30LB32*/
*   /* COMPLETE OR TERMINATING MESSAGE IDC3003I IF FUNCTION  @Y30LB32*/
*   /* WAS NOT PERFORMED                                     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   PRINTTAB=''B;                   /*                       @Y30LB32*/
@RC00380 XC    PRINTTAB(36),PRINTTAB                               0403
*   IF LASTCOND<LASTCC12 THEN       /*                       @Y30LB32*/
         L     @08,@PC00001+8                                      0404
         LH    @08,LASTCOND(,@08)                                  0404
         C     @08,@CF00606                                        0404
         BNL   @RF00404                                            0404
*     DARGSENT=MSG0001I;            /*                       @Y30LB32*/
         L     @08,DDSTRU                                          0405
         MVI   DARGSENT(@08),X'01'                                 0405
*   ELSE                            /*                       @Y30LB32*/
*     DARGSENT=MSG3003I;            /*                       @Y30LB32*/
         B     @RC00404                                            0406
@RF00404 L     @08,DDSTRU                                          0406
         MVI   DARGSENT(@08),X'03'                                 0406
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB32*/
@RC00404 L     @08,DDSTRU                                          0407
         MVC   DARGSMOD(3,@08),@CC01458                            0407
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB32*/
         L     @15,@PC00001+8                                      0408
         ST    @15,DARGDBP(,@08)                                   0408
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB32*/
         MVC   DARGILP(2,@08),@CH00155                             0409
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB32*/
         L     @08,@PC00001                                        0410
         ST    @08,@AL00001                                        0410
         LA    @15,@CF00116                                        0410
         ST    @15,@AL00001+4                                      0410
         LA    @15,DDSTRU                                          0410
         ST    @15,@AL00001+8                                      0410
         MVI   @AL00001+8,X'80'                                    0410
         L     @15,GDTPRT(,@08)                                    0410
         LA    @01,@AL00001                                        0410
         BALR  @14,@15                                             0410
*   IF GDTDBG=NULLPTR THEN                                         0411
         L     @08,@PC00001                                        0411
         L     @08,GDTDBG(,@08)                                    0411
         LTR   @08,@08                                             0411
         BZ    @RT00411                                            0411
*     ;                                                            0412
*   ELSE                                                           0413
*     CALL IDCDB010(GDTTBL,'CVRP'); /*                       @Y30LB32*/
*                                                                  0413
         L     @08,@PC00001                                        0413
         ST    @08,@AL00001                                        0413
         LA    @15,@CC01543                                        0413
         ST    @15,@AL00001+4                                      0413
         MVI   @AL00001+4,X'80'                                    0413
         L     @15,GDTDBG(,@08)                                    0413
         LA    @01,@AL00001                                        0413
         BALR  @14,@15                                             0413
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN CONTROL TO AMS EXECUTIVE                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0414
*                                                                  0414
@RT00411 L     @08,@PC00001                                        0414
         ST    @08,@AL00001                                        0414
         LA    @15,MODID                                           0414
         ST    @15,@AL00001+4                                      0414
         L     @15,@PC00001+8                                      0414
         ST    @15,@AL00001+8                                      0414
         MVI   @AL00001+8,X'80'                                    0414
         L     @15,GDTEPL(,@08)                                    0414
         LA    @01,@AL00001                                        0414
         BALR  @14,@15                                             0414
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0415
*                                                                  0415
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - GRPPROC                                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS FOR GROUP ATTRIBUTES SPECIFIED        @Y30LB32*/
*/*             ROUTES CONTROL TO ATTRBUTE OR GENPROC        @Y30LB32*/
*/*             BASED ON GROUP ATTRIBUTE SPECIFIED OR NOT    @Y30LB32*/
*/*             SPECIFIED                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - RESTRICT PARAMETER IN FDT                       @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - GRPPROC SUCCESSFUL         @Y30LB32*/
*/*             RETURN CODE = 4 - GROUP RECORD NOT READ OR   @Y30LB32*/
*/*                               ATTRIBUTES DO NOT MATCH    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0415
*GRPPROC:                                                          0415
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0415
@EL00001 L     @13,4(,@13)                                         0415
@EF00001 L     @00,@SIZDATD                                        0415
         LR    @01,@10                                             0415
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0415
         BR    @14                                                 0415
GRPPROC  DS    0H                                                  0416
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   RETADDR=REG14;                  /*                       @Y30LB32*/
         LR    RETADDR,REG14                                       0416
*   OLDERID2=NEWERID2;                                             0417
         L     @05,@PC00001                                        0417
         L     @05,GDTTR2(,@05)                                    0417
         MVC   @TS00001(95),NEWERID2(@05)                          0417
         MVC   OLDERID2(95,@05),@TS00001                           0417
*   NEWID2='CVGP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@05),@CC01547                              0418
*   GRPCOND=0;                      /*                       @Y30LB32*/
*                                                                  0419
         SLR   @05,@05                                             0419
         STH   @05,GRPCOND                                         0419
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS GROUP NAME FROM FDT AND PLACE IN DEFINE PARM   @Y30LB32*/
*   /* LIST EXTENSION DEFVE AND SPECIFY GROUP NAME SET       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0420
*   DEFGROUP=GRPVAL;                /*                       @Y30LB32*/
         L     @15,@PC00001+4                                      0420
         L     @01,FDTPTR+36(,@15)                                 0420
         MVC   DEFGROUP(8,DEFVEPTR),GRPVAL(@01)                    0420
*   DEFPGRO=ON;                     /*                       @Y30LB32*/
*                                                                  0421
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       0421
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FDT TO DETERMINE IF RESTRICTED PARAMETER WAS    @Y30LB32*/
*   /* SPECIFIED                                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*   IF(ADDR(RSTR))^=NULLPTR THEN    /*                       @Y30LB32*/
         C     @05,FDTPTR+44(,@15)                                 0422
         BE    @RF00422                                            0422
*     DO;                           /*                       @Y30LB32*/
*                                                                  0423
*       /*************************************************************/
*       /*                                                           */
*       /* SET FLAG IN DEFINE PARM EXTENSION LIST INDICATING @Y30LB32*/
*       /* A RESTRICTED VOLUME IS TO BE CREATED              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0424
*       DEFRSTD=ON;                 /*                       @Y30LB32*/
*                                                                  0424
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       0424
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ATTRIBUTE ROUTINE TO CHECK ATTRIBUTES TO BE  @Y30LB32*/
*       /* ASSIGNED OR DEFAULTED TO FOR NEW VOLUME           @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0425
*       CALL ATTRBUTE;              /*                       @Y30LB32*/
         BAL   @14,ATTRBUTE                                        0425
*     END;                          /*                       @Y30LB32*/
*                                                                  0426
*   /*****************************************************************/
*   /*                                                               */
*   /* SET PARAMETERS AND CHECK ATTRIBUTES SPECIFIED TO      @Y30LB32*/
*   /* CREATE A NEW GENERAL GROUP VOLUME                     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
*                                                                  0427
         B     @RC00422                                            0427
@RF00422 DS    0H                                                  0428
*       /*************************************************************/
*       /*                                                           */
*       /* CALL GENPROC ROUTINE TO CHECK VOLUME ATTRIBUTES   @Y30LB32*/
*       /* AGAINST GROUP ATTRIBUTES                          @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0428
*       CALL GENPROC;               /*                       @Y30LB32*/
         BAL   @14,GENPROC                                         0428
*       RESPECIFY                                                  0429
*         RTNREG RSTD;                                             0429
*       TESTRC=RTNREG;                                             0430
         LR    TESTRC,RTNREG                                       0430
*       RESPECIFY                                                  0431
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  0431
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ERROR CODE FROM GENPROC ROUTINE, IF     @Y30LB32*/
*       /* ERROR CODE RETURNED SET CONDITION CODE            @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0432
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0432
         BZ    @RF00432                                            0432
*         GRPCOND=LASTCC04;         /*                       @Y30LB32*/
*                                                                  0433
         MVC   GRPCOND(2),@CH00042                                 0433
*       /*************************************************************/
*       /*                                                           */
*       /* SET FLAG TO CREATE NEW GENERAL GROUP VOLUME       @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0434
*       ELSE                        /*                       @Y30LB32*/
*         DEFGENUS=ON;              /*                       @Y30LB32*/
         B     @RC00432                                            0434
@RF00432 OI    DEFGENUS(DEFVEPTR),B'10000000'                      0434
*     END;                          /*                       @Y30LB32*/
*                                                                  0435
@RC00432 DS    0H                                                  0436
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*   REG14=RETADDR;                  /*                       @Y30LB32*/
@RC00422 LR    REG14,RETADDR                                       0436
*   RETURN CODE(GRPCOND);           /*                       @Y30LB32*/
         LH    @15,GRPCOND                                         0437
@EL00002 DS    0H                                                  0437
@EF00002 DS    0H                                                  0437
@ER00002 BR    @14                                                 0437
*   END GRPPROC;                    /*                       @Y30LB32*/
*                                                                  0439
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - ATTRIBUTE                              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS FOR MOUNTING ATTRIBUTES TO BE         @Y30LB32*/
*/*             ASSIGNED TO NEW VOLUME TO BE CREATED IF      @Y30LB32*/
*/*             ANY ATTRIBUTES ARE NOT SPECIFIED DEFAULT     @Y30LB32*/
*/*             ATTRIBUTES ARE ASSIGNED                      @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - DEFLIST,DEFINE MACRO PARM LIST                  @Y30LB32*/
*/*          BIND, EXCL, DASD, AND RONLY KEYWORD PARAMETERS  @Y30LB32*/
*/*          RONLYFLG FLAG TO INDICATE IF READONLY SPECIFIED @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - DEFLIST WITH VOLUME ATTRIBUTES SPECIFIED       @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0439
*ATTRBUTE:                                                         0439
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0439
ATTRBUTE DS    0H                                                  0440
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO AND SET POINTER TO DEFLIST PARM LIST          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0440
*   RETADDR1=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR1                                      0440
*   OLDERID2=NEWERID2;                                             0441
         L     @02,@PC00001                                        0441
         L     @02,GDTTR2(,@02)                                    0441
         MVC   @TS00001(95),NEWERID2(@02)                          0441
         MVC   OLDERID2(95,@02),@TS00001                           0441
*   NEWID2='CVAT';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@02),@CC01552                              0442
*   ATTRCOND=0;                     /*                       @Y30LB32*/
         SLR   ATTRCOND,ATTRCOND                                   0443
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/
*                                                                  0444
         LA    @02,PARMLST                                         0444
         ST    @02,DEFLSTP                                         0444
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF BIND PARAMETER IS SPECIFIED. IF BIND IS      @Y30LB32*/
*   /* SPECIFIED SET DEFVBIND FLAG IN DEFLIST                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*   IF(ADDR(BIND))^=NULLPTR THEN    /*                       @Y30LB32*/
         L     @15,@PC00001+4                                      0445
         L     @15,FDTPTR+48(,@15)                                 0445
         LTR   @15,@15                                             0445
         BZ    @RF00445                                            0445
*     DEFVBIND=ON;                  /*                       @Y30LB32*/
*                                                                  0446
         OI    DEFVBIND(@02),B'00000100'                           0446
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF EXCLUSIVE PARAMETER IS SPECIFIED. IF EXCL    @Y30LB32*/
*   /* IS SPECIFIED SET DEFVEXCL FLAG IN DEFLIST             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*   IF(ADDR(EXCLU))^=NULLPTR THEN   /*                       @Y30LB32*/
@RF00445 L     @02,@PC00001+4                                      0447
         L     @02,FDTPTR+56(,@02)                                 0447
         LTR   @02,@02                                             0447
         BZ    @RF00447                                            0447
*     DEFVEXCL=ON;                  /*                       @Y30LB32*/
*                                                                  0448
         L     @02,DEFLSTP                                         0448
         OI    DEFVEXCL(@02),B'00010000'                           0448
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DASDERASE PARAMETER IS SPECIFIED. IF DERAS   @Y30LB32*/
*   /* IS SPECIFIED SET DEFVSEC FLAG IN DEFLIST              @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0449
*   IF(ADDR(DERAS))^=NULLPTR THEN   /*                       @Y30LB32*/
@RF00447 L     @02,@PC00001+4                                      0449
         L     @02,FDTPTR+72(,@02)                                 0449
         LTR   @02,@02                                             0449
         BZ    @RF00449                                            0449
*     DEFVSEC=ON;                   /*                       @Y30LB32*/
*                                                                  0450
         L     @02,DEFLSTP                                         0450
         OI    DEFVSEC(@02),B'00100000'                            0450
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF READONLY PARAMETER IS SPECIFIED. IF RONLY    @Y30LB32*/
*   /* IS SPECIFIED SET RONLYFLG INDICATING READONLY         @Y30LB32*/
*   /* PARAMETER WAS SPECIFIED                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0451
*   IF(ADDR(RONLY))^=NULLPTR THEN   /*                       @Y30LB32*/
@RF00449 L     @02,@PC00001+4                                      0451
         L     @02,FDTPTR+64(,@02)                                 0451
         LTR   @02,@02                                             0451
         BZ    @RF00451                                            0451
*     RONLYFLG=ON;                  /*                       @Y30LB32*/
*                                                                  0452
         OI    RONLYFLG,B'01000000'                                0452
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0453
*   REG14=RETADDR1;                 /*                       @Y30LB32*/
@RF00451 L     REG14,RETADDR1                                      0453
*   RETURN CODE(ATTRCOND);          /*                       @Y30LB32*/
         LR    @15,ATTRCOND                                        0454
@EL00003 DS    0H                                                  0454
@EF00003 DS    0H                                                  0454
@ER00003 BR    @14                                                 0454
*   END ATTRBUTE;                   /*                       @Y30LB32*/
*                                                                  0456
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - GENPROC                                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - ACCESSES GROUP RECORD, COMPARES SPECIFIED    @Y30LB32*/
*/*             VOLUME ATTRIBUTES WITH GROUP ATTRIBUTES IF   @Y30LB32*/
*/*             SPECIFIED, IF VOLUME ATTRIBUTES NOT          @Y30LB32*/
*/*             SPECIFIED SETS ATTRIBUTES TO MATCH GROUP     @Y30LB32*/
*/*             ATTRIBUTES. ISSUES MESSAGE IDC2079I IF GROUP @Y30LB32*/
*/*             RECORD COULD NOT BE READ. ISSUES MESSAGE     @Y30LB32*/
*/*             IDC3072I IF MOUNTING ATTRIBUTES DO NOT MATCH @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - PARM LIST RVVI FOR MSVC READ MACRO              @Y30LB32*/
*/*          BIND, NBIND, EXCL, SHRD, DERAS, NDERAS, RONLY   @Y30LB32*/
*/*          AND RW KEYWORD PARAMETERS                       @Y30LB32*/
*/*          RONLYFLG INDICATING RONLY ATTRIBUTE SPECIFIED   @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - ALL ATTRIBUTES VALID       @Y30LB32*/
*/*             RETURN CODE = 4 - SPECIFIED ATTRIBUTES DO    @Y30LB32*/
*/*                 NOT MATCH GROUP ATTRIBUTES               @Y30LB32*/
*/*                               OR RECORD NOT READ         @Y30LB32*/
*/*             RONLYFLG INDICATING VOLUME IS TO BE READONLY @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0456
*GENPROC:                                                          0456
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0456
GENPROC  DS    0H                                                  0457
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO AND SET PTR TO DEFLIST                        @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0457
*   RETADDR1=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR1                                      0457
*   OLDERID2=NEWERID2;                                             0458
         L     @15,@PC00001                                        0458
         L     @14,GDTTR2(,@15)                                    0458
         MVC   @TS00001(95),NEWERID2(@14)                          0458
         MVC   OLDERID2(95,@14),@TS00001                           0458
*   NEWID2='DVGN';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@14),@CC01556                              0459
*   GENCOND=0;                      /*                       @Y30LB32*/
         SLR   GENCOND,GENCOND                                     0460
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/
*                                                                  0461
         LA    @14,PARMLST                                         0461
         ST    @14,DEFLSTP                                         0461
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI PARM LIST WITH GROUP NAME, SET FLAGS  @Y30LB32*/
*   /* TO READ A GROUP RECORD AND ZERO BUFFER AREA RECORD IS @Y30LB32*/
*   /* RETURNED IN. ALSO SET RVVI WITH LENGTH OF BUFFER      @Y30LB32*/
*   /* AND INITIALIZE BUFFER AREA TO ZEROES                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0462
*   RVVGROUP=GRPVAL;                /*                       @Y30LB32*/
         L     @14,RVVIPTR                                         0462
         L     @03,@PC00001+4                                      0462
         L     @01,FDTPTR+36(,@03)                                 0462
         MVC   RVVGROUP(8,@14),GRPVAL(@01)                         0462
*   RVVSGRP=ON;                     /*                       @Y30LB32*/
         OI    RVVSGRP(@14),B'10000000'                            0463
*   RVVRDR=ON;                      /*                       @Y30LB32*/
         OI    RVVRDR(@14),B'10000000'                             0464
*   RVVGRPRC=ON;                    /*                       @Y30LB32*/
         OI    RVVGRPRC(@14),B'01000000'                           0465
*   RVVBUFLN=LENGTH(BUFFER);        /*                       @Y30LB32*/
         MVC   RVVBUFLN(2,@14),@CH01675                            0466
*   RVVRTBUF=ADDR(BUFFER);          /*                       @Y30LB32*/
         LA    @03,BUFFER                                          0467
         ST    @03,RVVRTBUF(,@14)                                  0467
*   BUFFER=''B;                     /*                       @Y30LB32*/
*                                                                  0468
         XC    BUFFER(164),BUFFER                                  0468
*   /*****************************************************************/
*   /*                                                               */
*   /* A USSC UMACRO IS ISSUED TO ACCESS THE GROUP RECORD    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0469
*   IF GDTDBG=NULLPTR THEN                                         0469
         L     @15,GDTDBG(,@15)                                    0469
         LTR   @15,@15                                             0469
         BZ    @RT00469                                            0469
*     ;                                                            0470
*   ELSE                                                           0471
*     DO;                                                          0471
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   0472
*       DMPITMNM='RVVI';                                           0473
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0473
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0473
         MVC   DMPITMNM(4,DMPINDEX),@CC01557                       0473
*       DMPITMPT=ADDR(RVVI);                                       0474
         L     @03,RVVIPTR                                         0474
         ST    @03,DMPITMPT(,DMPINDEX)                             0474
*       DMPITMLN=LENGTH(RVVI);                                     0475
         MVC   DMPITMLN(2,DMPINDEX),@CH01676                       0475
*       DMPITMTP='H';                                              0476
         MVI   DMPITMTP(DMPINDEX),C'H'                             0476
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0477
*                                                                  0477
         AL    DMPINDEX,@CF00508                                   0477
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0478
*       DMPTRM=DMPTRMVL;                                           0478
         MVI   DMPTRM(DMPINDEX),X'FF'                              0478
*     END;                          /*                       @Y30LB32*/
*   IF GDTDBG=NULLPTR THEN                                         0480
@RT00469 L     @15,@PC00001                                        0480
         L     @15,GDTDBG(,@15)                                    0480
         LTR   @15,@15                                             0480
         BZ    @RT00480                                            0480
*     ;                                                            0481
*   ELSE                                                           0482
*     CALL IDCDB010(GDTTBL,'CVBV',ADDR(DUMPAREA));/*         @Y30LB32*/
         L     @15,@PC00001                                        0482
         ST    @15,@AL00001                                        0482
         LA    @14,@CC01559                                        0482
         ST    @14,@AL00001+4                                      0482
         LA    @14,DUMPAREA                                        0482
         ST    @14,@AFTEMPS                                        0482
         LA    @14,@AFTEMPS                                        0482
         ST    @14,@AL00001+8                                      0482
         MVI   @AL00001+8,X'80'                                    0482
         L     @15,GDTDBG(,@15)                                    0482
         LA    @01,@AL00001                                        0482
         BALR  @14,@15                                             0482
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB32*/
@RT00480 L     @02,@PC00001                                        0483
         ST    @02,@AL00001                                        0483
         LA    @15,VVIC                                            0483
         ST    @15,@AL00001+4                                      0483
         LA    @15,RVVIPTR                                         0483
         ST    @15,@AL00001+8                                      0483
         LA    @15,REASONCD                                        0483
         ST    @15,@AL00001+12                                     0483
         MVI   @AL00001+12,X'80'                                   0483
         L     @15,GDTSSC(,@02)                                    0483
         LA    @01,@AL00001                                        0483
         BALR  @14,@15                                             0483
*   RESPECIFY                                                      0484
*     RTNREG RSTD;                                                 0484
*   TESTRC=RTNREG;                                                 0485
         LR    TESTRC,RTNREG                                       0485
*   RESPECIFY                                                      0486
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0486
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MSVC READ MACRO WAS SUCCESSFUL               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0487
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/
         SLR   @02,@02                                             0487
         CR    TESTRC,@02                                          0487
         BNE   @RF00487                                            0487
*     DO;                           /*                       @Y30LB32*/
*                                                                  0488
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF BIND PARAMETER IS SPECIFIED. IF          @Y30LB32*/
*       /* SPECIFIED SET FLAGS INDICATING BIND SPECIFIED     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0489
*       IF(ADDR(BIND))^=NULLPTR THEN/*                       @Y30LB32*/
         L     @03,@PC00001+4                                      0489
         C     @02,FDTPTR+48(,@03)                                 0489
         BE    @RF00489                                            0489
*         DO;                       /*                       @Y30LB32*/
*           BNDNBND=ON;             /*                       @Y30LB32*/
         OI    BNDNBND,B'00100000'                                 0491
*           DEFVBIND=ON;            /*                       @Y30LB32*/
         L     @01,DEFLSTP                                         0492
         OI    DEFVBIND(@01),B'00000100'                           0492
*         END;                      /*                       @Y30LB32*/
*                                                                  0493
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NOBIND PARAMETER WAS SPECIFIED. IF       @Y30LB32*/
*       /* SPECIFIED SET FLAG INDICATING NOBIND SPECIFIED    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0494
*       ELSE                        /*                       @Y30LB32*/
*         IF(ADDR(NBIND))^=NULLPTR THEN/*                    @Y30LB32*/
         B     @RC00489                                            0494
@RF00489 L     @15,@PC00001+4                                      0494
         L     @15,FDTPTR+52(,@15)                                 0494
         LTR   @15,@15                                             0494
         BZ    @RF00494                                            0494
*           BNDNBND=ON;             /*                       @Y30LB32*/
*                                                                  0495
         OI    BNDNBND,B'00100000'                                 0495
*       /*************************************************************/
*       /*                                                           */
*       /* SET VOLUME ATTRIBUTE TO MATCH GROUP ATTRIBUTE     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0496
*         ELSE                      /*                       @Y30LB32*/
*           IF GROBIND=ON THEN      /*                       @Y30LB32*/
         B     @RC00494                                            0496
@RF00494 TM    GROBIND(GROUPPTR),B'10000000'                       0496
         BNO   @RF00496                                            0496
*             DEFVBIND=ON;          /*                       @Y30LB32*/
*                                                                  0497
         L     @01,DEFLSTP                                         0497
         OI    DEFVBIND(@01),B'00000100'                           0497
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF BIND OR NOBIND PARAMETER WAS SPECIFIED   @Y30LB32*/
*       /* IF EITHER WAS SPECIFIED COMPARE ATTRIBUTE WITH    @Y30LB32*/
*       /* GROUP ATTRIBUTE. IF MISMATCH SET CONDITION CODE   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0498
*       IF BNDNBND=ON THEN          /*                       @Y30LB32*/
@RF00496 DS    0H                                                  0498
@RC00494 DS    0H                                                  0498
@RC00489 TM    BNDNBND,B'00100000'                                 0498
         BNO   @RF00498                                            0498
*         IF DEFVBIND=ON&GROBIND=OFF THEN/*                  @Y30LB32*/
         L     @01,DEFLSTP                                         0499
         TM    DEFVBIND(@01),B'00000100'                           0499
         BNO   @RF00499                                            0499
         TM    GROBIND(GROUPPTR),B'10000000'                       0499
         BNZ   @RF00499                                            0499
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/
         LA    GENCOND,4                                           0500
*         ELSE                      /*                       @Y30LB32*/
*           IF DEFVBIND=OFF&GROBIND=ON THEN/*                @Y30LB32*/
         B     @RC00499                                            0501
@RF00499 L     @01,DEFLSTP                                         0501
         TM    DEFVBIND(@01),B'00000100'                           0501
         BNZ   @RF00501                                            0501
         TM    GROBIND(GROUPPTR),B'10000000'                       0501
         BNO   @RF00501                                            0501
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/
*                                                                  0502
         LA    GENCOND,4                                           0502
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF EXCLUSIVE PARAMETER IS SPECIFIED. IF     @Y30LB32*/
*       /* SPECIFIED SET FLAGS INDICATING EXCL SPECIFIED     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0503
*       IF(ADDR(EXCLU))^=NULLPTR THEN/*                      @Y30LB32*/
@RF00501 DS    0H                                                  0503
@RC00499 DS    0H                                                  0503
@RF00498 L     @15,@PC00001+4                                      0503
         L     @15,FDTPTR+56(,@15)                                 0503
         LTR   @15,@15                                             0503
         BZ    @RF00503                                            0503
*         DO;                       /*                       @Y30LB32*/
*           EXCLSHRD=ON;            /*                       @Y30LB32*/
         OI    EXCLSHRD,B'00010000'                                0505
*           DEFVEXCL=ON;            /*                       @Y30LB32*/
         L     @01,DEFLSTP                                         0506
         OI    DEFVEXCL(@01),B'00010000'                           0506
*         END;                      /*                       @Y30LB32*/
*                                                                  0507
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF SHARED PARAMETER WAS SPECIFIED. IF       @Y30LB32*/
*       /* SPECIFIED SET FLAG INDICATING SHARED SPECIFIED    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0508
*       ELSE                        /*                       @Y30LB32*/
*         IF(ADDR(SHRD))^=NULLPTR THEN/*                     @Y30LB32*/
         B     @RC00503                                            0508
@RF00503 L     @15,@PC00001+4                                      0508
         L     @15,FDTPTR+60(,@15)                                 0508
         LTR   @15,@15                                             0508
         BZ    @RF00508                                            0508
*           EXCLSHRD=ON;            /*                       @Y30LB32*/
*                                                                  0509
         OI    EXCLSHRD,B'00010000'                                0509
*       /*************************************************************/
*       /*                                                           */
*       /* SET VOLUME ATTRIBUTE TO MATCH GROUP ATTRIBUTE     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0510
*         ELSE                      /*                       @Y30LB32*/
*           IF GROEXCL=ON THEN      /*                       @Y30LB32*/
         B     @RC00508                                            0510
@RF00508 TM    GROEXCL(GROUPPTR),B'01000000'                       0510
         BNO   @RF00510                                            0510
*             DEFVEXCL=ON;          /*                       @Y30LB32*/
*                                                                  0511
         L     @01,DEFLSTP                                         0511
         OI    DEFVEXCL(@01),B'00010000'                           0511
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF EXCLUSIVE OR SHARED PARAMETER WAS        @Y30LB32*/
*       /* SPECIFIED IF EITHER WAS SPECIFIED, COMPARE        @Y30LB32*/
*       /* ATTRIBUTE WITH GROUP ATTRIBUTE. IF MISMATCH, SET  @Y30LB32*/
*       /* CONDITION CODE                                    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0512
*       IF EXCLSHRD=ON THEN         /*                       @Y30LB32*/
@RF00510 DS    0H                                                  0512
@RC00508 DS    0H                                                  0512
@RC00503 TM    EXCLSHRD,B'00010000'                                0512
         BNO   @RF00512                                            0512
*         IF DEFVEXCL=ON&GROEXCL=OFF THEN/*                  @Y30LB32*/
         L     @01,DEFLSTP                                         0513
         TM    DEFVEXCL(@01),B'00010000'                           0513
         BNO   @RF00513                                            0513
         TM    GROEXCL(GROUPPTR),B'01000000'                       0513
         BNZ   @RF00513                                            0513
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/
         LA    GENCOND,4                                           0514
*         ELSE                      /*                       @Y30LB32*/
*           IF DEFVEXCL=OFF&GROEXCL=ON THEN/*                @Y30LB32*/
         B     @RC00513                                            0515
@RF00513 L     @01,DEFLSTP                                         0515
         TM    DEFVEXCL(@01),B'00010000'                           0515
         BNZ   @RF00515                                            0515
         TM    GROEXCL(GROUPPTR),B'01000000'                       0515
         BNO   @RF00515                                            0515
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/
*                                                                  0516
         LA    GENCOND,4                                           0516
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF DASDERASE PARAMETER IS SPECIFIED. IF     @Y30LB32*/
*       /* SPECIFIED SET FLAGS INDICATING DERAS SPECIFIED    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0517
*       IF(ADDR(DERAS))^=NULLPTR THEN/*                      @Y30LB32*/
@RF00515 DS    0H                                                  0517
@RC00513 DS    0H                                                  0517
@RF00512 L     @15,@PC00001+4                                      0517
         L     @15,FDTPTR+72(,@15)                                 0517
         LTR   @15,@15                                             0517
         BZ    @RF00517                                            0517
*         DO;                       /*                       @Y30LB32*/
*           DERASNDE=ON;            /*                       @Y30LB32*/
         OI    DERASNDE,B'00001000'                                0519
*           DEFVSEC=ON;             /*                       @Y30LB32*/
         L     @01,DEFLSTP                                         0520
         OI    DEFVSEC(@01),B'00100000'                            0520
*         END;                      /*                       @Y30LB32*/
*                                                                  0521
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NODASDERASE PARAMETER WAS SPECIFIED. IF  @Y30LB32*/
*       /* SPECIFIED SET FLAG INDICATING NDERAS SPECIFIED    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0522
*       ELSE                        /*                       @Y30LB32*/
*         IF(ADDR(NDERS))^=NULLPTR THEN/*                    @Y30LB32*/
         B     @RC00517                                            0522
@RF00517 L     @15,@PC00001+4                                      0522
         L     @15,FDTPTR+76(,@15)                                 0522
         LTR   @15,@15                                             0522
         BZ    @RF00522                                            0522
*           DERASNDE=ON;            /*                       @Y30LB32*/
*                                                                  0523
         OI    DERASNDE,B'00001000'                                0523
*       /*************************************************************/
*       /*                                                           */
*       /* SET VOLUME ATTRIBUTE TO MATCH GROUP ATTRIBUTE     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0524
*         ELSE                      /*                       @Y30LB32*/
*           IF GRODAERA=ON THEN     /*                       @Y30LB32*/
         B     @RC00522                                            0524
@RF00522 TM    GRODAERA(GROUPPTR),B'00100000'                      0524
         BNO   @RF00524                                            0524
*             DEFVSEC=ON;           /*                       @Y30LB32*/
*                                                                  0525
         L     @01,DEFLSTP                                         0525
         OI    DEFVSEC(@01),B'00100000'                            0525
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF DASDERASE OR NODASDERASE PARAMETER WAS   @Y30LB32*/
*       /* SPECIFIED, IF EITHER WAS SPECIFIED, COMPARE       @Y30LB32*/
*       /* ATTRIBUTES WITH GROUP ATTRIBUTE. IF MISMATCH, SET @Y30LB32*/
*       /* CONDITION CODE                                    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0526
*       IF DERASNDE=ON THEN         /*                       @Y30LB32*/
@RF00524 DS    0H                                                  0526
@RC00522 DS    0H                                                  0526
@RC00517 TM    DERASNDE,B'00001000'                                0526
         BNO   @RF00526                                            0526
*         IF DEFVSEC=ON&GRODAERA=OFF THEN/*                  @Y30LB32*/
         L     @01,DEFLSTP                                         0527
         TM    DEFVSEC(@01),B'00100000'                            0527
         BNO   @RF00527                                            0527
         TM    GRODAERA(GROUPPTR),B'00100000'                      0527
         BNZ   @RF00527                                            0527
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/
         LA    GENCOND,4                                           0528
*         ELSE                      /*                       @Y30LB32*/
*           IF DEFVSEC=OFF&GRODAERA=ON THEN/*                @Y30LB32*/
         B     @RC00527                                            0529
@RF00527 L     @01,DEFLSTP                                         0529
         TM    DEFVSEC(@01),B'00100000'                            0529
         BNZ   @RF00529                                            0529
         TM    GRODAERA(GROUPPTR),B'00100000'                      0529
         BNO   @RF00529                                            0529
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/
*                                                                  0530
         LA    GENCOND,4                                           0530
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF READONLY PARAMETER WAS SPECIFIED, IF     @Y30LB32*/
*       /* SPECIFIED SET FLAGS INDICATING RONLY SPECIFIED    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0531
*       IF(ADDR(RONLY))^=NULLPTR THEN/*                      @Y30LB32*/
@RF00529 DS    0H                                                  0531
@RC00527 DS    0H                                                  0531
@RF00526 L     @15,@PC00001+4                                      0531
         L     @15,FDTPTR+64(,@15)                                 0531
         LTR   @15,@15                                             0531
         BZ    @RF00531                                            0531
*         DO;                       /*                       @Y30LB32*/
*           RONLYRW=ON;             /*                       @Y30LB32*/
*           RONLYFLG=ON;            /*                       @Y30LB32*/
         OI    RONLYRW,B'01000100'                                 0534
*         END;                      /*                       @Y30LB32*/
*                                                                  0535
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF READWRITE PARAMETER WAS SPECIFIED, IF    @Y30LB32*/
*       /* SPECIFIED SET FLAG INDICATING RW SPECIFIED        @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0536
*       ELSE                        /*                       @Y30LB32*/
*         IF(ADDR(RW))^=NULLPTR THEN/*                       @Y30LB32*/
         B     @RC00531                                            0536
@RF00531 L     @15,@PC00001+4                                      0536
         L     @15,FDTPTR+68(,@15)                                 0536
         LTR   @15,@15                                             0536
         BZ    @RF00536                                            0536
*           RONLYRW=ON;             /*                       @Y30LB32*/
*                                                                  0537
         OI    RONLYRW,B'00000100'                                 0537
*       /*************************************************************/
*       /*                                                           */
*       /* SET RONLYFLG TO MATCH GROUP ATTRIBUTE             @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0538
*         ELSE                      /*                       @Y30LB32*/
*           IF GRORONLY=ON THEN     /*                       @Y30LB32*/
         B     @RC00536                                            0538
@RF00536 TM    GRORONLY(GROUPPTR),B'00010000'                      0538
         BNO   @RF00538                                            0538
*             RONLYFLG=ON;          /*                       @Y30LB32*/
*                                                                  0539
         OI    RONLYFLG,B'01000000'                                0539
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF READONLY OR READWRITE PARAMETER WAS      @Y30LB32*/
*       /* SPECIFIED, IF EITHER WAS SPECIFIED, COMPARE       @Y30LB32*/
*       /* ATTRIBUTES WITH GROUP ATTRIBUTE. IF ATTRIBUTES    @Y30LB32*/
*       /* DO NOT MATCH SET CONDITION CODE                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0540
*       IF RONLYRW=ON THEN          /*                       @Y30LB32*/
@RF00538 DS    0H                                                  0540
@RC00536 DS    0H                                                  0540
@RC00531 TM    RONLYRW,B'00000100'                                 0540
         BNO   @RF00540                                            0540
*         IF RONLYFLG=ON&GRORONLY=OFF THEN/*                 @Y30LB32*/
         TM    RONLYFLG,B'01000000'                                0541
         BNO   @RF00541                                            0541
         TM    GRORONLY(GROUPPTR),B'00010000'                      0541
         BNZ   @RF00541                                            0541
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/
         LA    GENCOND,4                                           0542
*         ELSE                      /*                       @Y30LB32*/
*           IF RONLYFLG=OFF&GRORONLY=ON THEN/*               @Y30LB32*/
         B     @RC00541                                            0543
@RF00541 TM    RONLYFLG,B'01000000'                                0543
         BNZ   @RF00543                                            0543
         TM    GRORONLY(GROUPPTR),B'00010000'                      0543
         BNO   @RF00543                                            0543
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/
*                                                                  0544
         LA    GENCOND,4                                           0544
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK CONDITION CODE IF IT IS FOUR MESSAGE        @Y30LB32*/
*       /* IDC3072I IS ISSUED                                @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0545
*       IF GENCOND=4 THEN           /*                       @Y30LB32*/
@RF00543 DS    0H                                                  0545
@RC00541 DS    0H                                                  0545
@RF00540 C     GENCOND,@CF00042                                    0545
         BNE   @RF00545                                            0545
*         DO;                       /*                       @Y30LB32*/
*           PRINTTAB=''B;           /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0547
*           DARGSMOD=COMMSG;        /*                       @Y30LB32*/
         L     @04,DDSTRU                                          0548
         MVC   DARGSMOD(3,@04),@CC01460                            0548
*           DARGSENT=MSG3072I;      /*                       @Y30LB32*/
         MVI   DARGSENT(@04),X'22'                                 0549
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB32*/
         L     @04,@PC00001                                        0550
         ST    @04,@AL00001                                        0550
         LA    @15,@CF00116                                        0550
         ST    @15,@AL00001+4                                      0550
         LA    @15,DDSTRU                                          0550
         ST    @15,@AL00001+8                                      0550
         MVI   @AL00001+8,X'80'                                    0550
         L     @15,GDTPRT(,@04)                                    0550
         LA    @01,@AL00001                                        0550
         BALR  @14,@15                                             0550
*         END;                      /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0553
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FAILED - CALL SSCMSG ROUTINE TO WRITE MESSAGE    @Y30LB32*/
*   /* EXPLAINING REASON FOR FAILURE                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC00487                                            0553
@RF00487 DS    0H                                                  0554
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB32*/
*                                                                  0554
         LA    @15,REASONCD                                        0554
         ST    @15,@AL00001                                        0554
         LA    @01,@AL00001                                        0554
         BAL   @14,SSCMSG                                          0554
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE SECONDARY MESSAGE IDC2079I AND SET          @Y30LB32*/
*       /* CONDITION CODE                                    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0555
*       PRINTTAB=''B;               /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0555
*       DARGSMOD=COMMSG;            /*                       @Y30LB32*/
         L     @04,DDSTRU                                          0556
         MVC   DARGSMOD(3,@04),@CC01460                            0556
*       DARGSENT=MSG2079I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@04),X'1B'                                 0557
*       DARGDBP=ADDR(GRPVAL);       /*                       @Y30LB32*/
         L     @15,@PC00001+4                                      0558
         L     @01,FDTPTR+36(,@15)                                 0558
         LA    @15,GRPVAL(,@01)                                    0558
         ST    @15,DARGDBP(,@04)                                   0558
*       DARGILP=LENGTH(GRPVAL);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@04),@CH00181                             0559
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @04,@PC00001                                        0560
         ST    @04,@AL00001                                        0560
         LA    @15,@CF00116                                        0560
         ST    @15,@AL00001+4                                      0560
         LA    @15,DDSTRU                                          0560
         ST    @15,@AL00001+8                                      0560
         MVI   @AL00001+8,X'80'                                    0560
         L     @15,GDTPRT(,@04)                                    0560
         LA    @01,@AL00001                                        0560
         BALR  @14,@15                                             0560
*       GENCOND=LASTCC04;           /*                       @Y30LB32*/
         LA    GENCOND,4                                           0561
*     END;                          /*                       @Y30LB32*/
*                                                                  0562
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET RETURN ADDRESS AND RETURN TO CALLER             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0563
*   REG14=RETADDR1;                 /*                       @Y30LB32*/
@RC00487 L     REG14,RETADDR1                                      0563
*   RETURN CODE(GENCOND);           /*                       @Y30LB32*/
         LR    @15,GENCOND                                         0564
@EL00004 DS    0H                                                  0564
@EF00004 DS    0H                                                  0564
@ER00004 BR    @14                                                 0564
*   END GENPROC;                    /*                       @Y30LB32*/
*                                                                  0566
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CKVOLSER                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECK IF VOLUME SERIAL NUMBER IS VALID FOR   @Y30LB32*/
*/*             INCREMENTING TO CREATE MORE THAN ONE VOLUME  @Y30LB32*/
*/*             MESSAGES IDC3682I AND IDC3683I ARE ISSUED    @Y30LB32*/
*/*             IF VOLUME SERIAL NUMBER IS NOT VALID. CALLS  @Y30LB32*/
*/*             NUMCHK ROUTINE TO CHECK FOR NUMERIC          @Y30LB32*/
*/*             CHARACTERS                                   @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - VOLUME SERIAL NUMBER,COUNT OF VOLUMES TO CREATE @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 VOLUME SERIAL NUMBER VALID   @Y30LB32*/
*/*             RETURN CODE = 4 VOLUME SERIAL NUMBER INVALID @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0566
*CKVOLSER:                                                         0566
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0566
CKVOLSER DS    0H                                                  0567
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND SET CONDITON CODE TO ZERO     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0567
*   RETADDR=REG14;                  /*                       @Y30LB32*/
         LR    RETADDR,REG14                                       0567
*   OLDERID2=NEWERID2;                                             0568
         L     @04,@PC00001                                        0568
         L     @04,GDTTR2(,@04)                                    0568
         MVC   @TS00001(95),NEWERID2(@04)                          0568
         MVC   OLDERID2(95,@04),@TS00001                           0568
*   NEWID2='CVCK';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@04),@CC01564                              0569
*   CKVCOND=0;                      /*                       @Y30LB32*/
*                                                                  0570
         SLR   CKVCOND,CKVCOND                                     0570
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL NUMCHK ROUTINE TO CHECK FOR NUMBER OF NUMERIC    @Y30LB32*/
*   /* CHARACTERS IN VOLUME SERIAL NUMBER                    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0571
*   CALL NUMCHK;                    /*                       @Y30LB32*/
*                                                                  0571
         BAL   @14,NUMCHK                                          0571
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK NUMBER OF NUMERIC CHARACTERS FOUND BY NUMCHK    @Y30LB32*/
*   /* ROUTINE                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0572
*   IF NUMCNT=>1 THEN               /*                       @Y30LB32*/
         LA    @04,1                                               0572
         CR    NUMCNT,@04                                          0572
         BL    @RF00572                                            0572
*     DO;                           /*                       @Y30LB32*/
*                                                                  0573
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO FIELDS USED TO CONVERT NUMERIC CHARACTERS    @Y30LB32*/
*       /* SET VALUE FOR SUBSTRINGING TO ACCESS PROPER       @Y30LB32*/
*       /* CHARACTERS FROM VOLUME SERIAL NUMBER THEN ACCESS  @Y30LB32*/
*       /* CHARACTERS AND CONVERT THEM TO BINARY             @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0574
*       PACKEDNO=''B;               /*                       @Y30LB32*/
         XC    PACKEDNO(6),PACKEDNO                                0574
*       NUMERICS=''B;               /*                       @Y30LB32*/
         XC    NUMERICS(6),NUMERICS                                0575
*       CHARNUM=(6-NUMCNT)+1;       /*                       @Y30LB32*/
         LA    @15,6                                               0576
         LR    @14,@15                                             0576
         SLR   @14,NUMCNT                                          0576
         ALR   @14,@04                                             0576
         STC   @14,CHARNUM                                         0576
*       NUMERICS(CHARNUM:6)=VOLVAL(CHARNUM:6);/*             @Y30LB32*/
         LA    @04,NUMERICS-1(@14)                                 0577
         LR    @01,@15                                             0577
         SLR   @01,@14                                             0577
         L     @00,@PC00001+4                                      0577
         LR    @15,@00                                             0577
         L     @15,FDTPTR(,@15)                                    0577
         ALR   @14,@15                                             0577
         EX    @01,@SM01692                                        0577
*       PACK(PACKEDNO,NUMERICS);    /*                       @Y30LB32*/
         PACK  PACKEDNO(6),NUMERICS(6)                             0578
*       CVB(BINARYNO,PACKEDNO);     /*                       @Y30LB32*/
*                                                                  0579
         XC    @TS00001(8),@TS00001                                0579
         MVC   @TS00001+2(6),PACKEDNO                              0579
         CVB   BINARYNO,@TS00001                                   0579
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE CONVERTED NUMBER TO CREATE VOLUME SERIAL     @Y30LB32*/
*       /* NUMBERS WITH AND THEN                             @Y30LB32*/
*       /* ADD CONVERTED NUMBER TO COUNT OF VOLUMES MINUS 1  @ZA28874*/
*       /* TO BE CREATED AND CHECK IF SUM EXCEEDS MAXIMUM    @ZA28874*/
*       /* ALLOWED FOR THE NUMBER OF NUMERIC                 @Y30LB32*/
*       /* CHARACTERS SPECIFIED                              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0580
*       SAVBINNO=BINARYNO;          /*                       @Y30LB32*/
         ST    BINARYNO,SAVBINNO                                   0580
*       BINARYNO=BINARYNO+COUNTVAL-1;/*                      @ZA28874*/
         LR    @04,@00                                             0581
         L     @04,FDTPTR+8(,@04)                                  0581
         LR    @14,BINARYNO                                        0581
         AL    @14,COUNTVAL(,@04)                                  0581
         BCTR  @14,0                                               0581
         LR    BINARYNO,@14                                        0581
*       IF BINARYNO>MAXNUM(NUMCNT) THEN/*                    @Y30LB32*/
         LR    @04,NUMCNT                                          0582
         SLA   @04,2                                               0582
         C     BINARYNO,MAXNUM-4(@04)                              0582
         BNH   @RF00582                                            0582
*         DO;                       /*                       @Y30LB32*/
*                                                                  0583
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF ALL SIX CHARACTERS ARE NUMERIC       @Y30LB32*/
*           /* IF ALL NUMERIC WRITE MESSAGE IDC3683I STATING @Y30LB32*/
*           /* SUM OF COUNTVAL PLUS VOLSER                   @Y30LB32*/
*           /* EXCEED MAXIMUM VALUE ALLOWED                  @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0584
*           IF NUMCNT=6 THEN        /*                       @Y30LB32*/
         LA    @02,6                                               0584
         CR    NUMCNT,@02                                          0584
         BNE   @RF00584                                            0584
*             DO;                   /*                       @Y30LB32*/
*               PRINTTAB=''B;       /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0586
*               DARGSMOD=CRVMSG;    /*                       @Y30LB32*/
         L     @14,DDSTRU                                          0587
         MVC   DARGSMOD(3,@14),@CC01462                            0587
*               DARGSENT=MSG3683I;  /*                       @Y30LB32*/
         MVI   DARGSENT(@14),X'04'                                 0588
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB32*/
         LA    @15,VOLVAL(,@15)                                    0589
         ST    @15,DARGDBP(,@14)                                   0589
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB32*/
         STH   @02,DARGILP(,@14)                                   0590
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/
         L     @15,@PC00001                                        0591
         ST    @15,@AL00001                                        0591
         LA    @14,@CF00116                                        0591
         ST    @14,@AL00001+4                                      0591
         LA    @14,DDSTRU                                          0591
         ST    @14,@AL00001+8                                      0591
         MVI   @AL00001+8,X'80'                                    0591
         L     @15,GDTPRT(,@15)                                    0591
         LA    @01,@AL00001                                        0591
         BALR  @14,@15                                             0591
*             END;                  /*                       @Y30LB32*/
*                                                                  0592
*           /*********************************************************/
*           /*                                                       */
*           /* IF ALL SIX CHARACTERS ARE NOT NUMERIC THEN    @Y30LB32*/
*           /* WRITE MESSAGE IDC3682I STATING CHARACTER      @Y30LB32*/
*           /* NOT NUMERIC                                   @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0593
*           ELSE                    /*                       @Y30LB32*/
*             DO;                   /*                       @Y30LB32*/
         B     @RC00584                                            0593
@RF00584 DS    0H                                                  0594
*               PRINTTAB=''B;       /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0594
*               DARGSMOD=CRVMSG;    /*                       @Y30LB32*/
         L     @15,DDSTRU                                          0595
         MVC   DARGSMOD(3,@15),@CC01462                            0595
*               DARGSENT=MSG3682I;  /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'03'                                 0596
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB32*/
         L     @14,@PC00001+4                                      0597
         L     @01,FDTPTR(,@14)                                    0597
         LA    @14,VOLVAL(,@01)                                    0597
         ST    @14,DARGDBP(,@15)                                   0597
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00158                             0598
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/
         L     @15,@PC00001                                        0599
         ST    @15,@AL00001                                        0599
         LA    @14,@CF00116                                        0599
         ST    @14,@AL00001+4                                      0599
         LA    @14,DDSTRU                                          0599
         ST    @14,@AL00001+8                                      0599
         MVI   @AL00001+8,X'80'                                    0599
         L     @15,GDTPRT(,@15)                                    0599
         LA    @01,@AL00001                                        0599
         BALR  @14,@15                                             0599
*             END;                  /*                       @Y30LB32*/
*                                                                  0600
*           /*********************************************************/
*           /*                                                       */
*           /* SET CONDITION CODE WITH ERROR CODE            @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0601
*           CKVCOND=LASTCC04;       /*                       @Y30LB32*/
@RC00584 LA    CKVCOND,4                                           0601
*         END;                      /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0603
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO NUMERIC CHARACTERS WERE FOUND                   @Y30LB32*/
*   /* WRITE MESSAGE IDC3682I STATING CHARACTER              @Y30LB32*/
*   /* NOT NUMERIC AND SET CONDITION CODE WITH               @Y30LB32*/
*   /* ERROR CODE                                            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0604
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC00572                                            0604
@RF00572 DS    0H                                                  0605
*       PRINTTAB=''B;               /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0605
*       DARGSENT=MSG3682I;          /*                       @Y30LB32*/
         L     @04,DDSTRU                                          0606
         MVI   DARGSENT(@04),X'03'                                 0606
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/
         MVC   DARGSMOD(3,@04),@CC01462                            0607
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB32*/
         L     @15,@PC00001+4                                      0608
         L     @01,FDTPTR(,@15)                                    0608
         LA    @15,VOLVAL(,@01)                                    0608
         ST    @15,DARGDBP(,@04)                                   0608
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@04),@CH00158                             0609
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @04,@PC00001                                        0610
         ST    @04,@AL00001                                        0610
         LA    @15,@CF00116                                        0610
         ST    @15,@AL00001+4                                      0610
         LA    @15,DDSTRU                                          0610
         ST    @15,@AL00001+8                                      0610
         MVI   @AL00001+8,X'80'                                    0610
         L     @15,GDTPRT(,@04)                                    0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*       CKVCOND=LASTCC04;           /*                       @Y30LB32*/
         LA    CKVCOND,4                                           0611
*     END;                          /*                       @Y30LB32*/
*                                                                  0612
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0613
*   REG14=RETADDR;                  /*                       @Y30LB32*/
@RC00572 LR    REG14,RETADDR                                       0613
*   RETURN CODE(CKVCOND);           /*                       @Y30LB32*/
         LR    @15,CKVCOND                                         0614
@EL00005 DS    0H                                                  0614
@EF00005 DS    0H                                                  0614
@ER00005 BR    @14                                                 0614
*   END CKVOLSER;                   /*                       @Y30LB32*/
*                                                                  0616
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - NUMCHK                                 @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS FOR NUMERIC CHARACTERS IN VOLUME      @Y30LB32*/
*/*             SERIAL NUMBER WHICH ARE VALID FOR            @Y30LB32*/
*/*             INCREMENTING TO CREATE NEW VOLUME SERIAL     @Y30LB32*/
*/*             NUMBERS                                      @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - VOLUME SERIAL NUMBER                            @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - ALL SIX CHARACTERS NUMERIC @Y30LB32*/
*/*             RETURN CODE = 4 - NONE OR SOME CHARACTERS    @Y30LB32*/
*/*                 NUMERIC                                  @Y30LB32*/
*/*         - NUMBER OF NUMERIC CHARACTERS                   @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0616
*NUMCHK:                                                           0616
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0616
NUMCHK   DS    0H                                                  0617
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/
*   /* CODE TO ZERO                                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0617
*   RETADDR1=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR1                                      0617
*   OLDERID2=NEWERID2;                                             0618
         L     @02,@PC00001                                        0618
         L     @02,GDTTR2(,@02)                                    0618
         MVC   @TS00001(95),NEWERID2(@02)                          0618
         MVC   OLDERID2(95,@02),@TS00001                           0618
*   NEWID2='CVNC';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@02),@CC01571                              0619
*   NUMCOND=0;                      /*                       @Y30LB32*/
*                                                                  0620
         SLR   NUMCOND,NUMCOND                                     0620
*   /*****************************************************************/
*   /*                                                               */
*   /* SET COUNT OF NUMERIC CHARACTERS TO ZERO AND           @Y30LB32*/
*   /* SET SUBSTRING VALUE TO ACCESS LAST CHARACTER OF       @Y30LB32*/
*   /* VOLUME SERIAL NUMBER                                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0621
*   NUMCNT=0;                       /*                       @Y30LB32*/
         SLR   NUMCNT,NUMCNT                                       0621
*   CHARNUM=6;                      /*                       @Y30LB32*/
*                                                                  0622
         MVI   CHARNUM,X'06'                                       0622
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK EACH CHARACTER IN VOLUME SERIAL NUMBER          @Y30LB32*/
*   /* STARTING WITH HIGH ORDER BYTE FOR NUMERIC CHARACTER   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0623
*   DO VOLSERCK=1 TO 6 WHILE NUMCOND=0;/*                    @Y30LB32*/
*                                                                  0623
         LA    VOLSERCK,1                                          0623
@DL00623 LTR   NUMCOND,NUMCOND                                     0623
         BNZ   @DC00623                                            0623
*     /***************************************************************/
*     /*                                                             */
*     /* ACCESS CHARACTER TO CHECK IT FOR NUMERIC            @Y30LB32*/
*     /* CHARACTER                                           @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0624
*     VOLCHAR=VOLVAL(CHARNUM:CHARNUM);/*                     @Y30LB32*/
*                                                                  0624
         SLR   @01,@01                                             0624
         IC    @01,CHARNUM                                         0624
         L     @15,@PC00001+4                                      0624
         L     @15,FDTPTR(,@15)                                    0624
         ALR   @15,@01                                             0624
         MVC   VOLCHAR(1),VOLVAL-1(@15)                            0624
*     /***************************************************************/
*     /*                                                             */
*     /* SET FIELD FOR NUMBER TO ZERO                        @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0625
*     NUMBER=0;                     /*                       @Y30LB32*/
*                                                                  0625
         MVI   NUMBER,X'00'                                        0625
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK CHARACTER FOR NUMERIC VALUE                   @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0626
*     DO LOOPCNT=1 TO 10 WHILE VOLCHAR^=NUMBER;/*            @Y30LB32*/
         LA    @15,1                                               0626
         ST    @15,LOOPCNT                                         0626
@DL00626 CLC   VOLCHAR(1),NUMBER                                   0626
         BE    @DC00626                                            0626
*       NUMBER=NUMTBL(LOOPCNT);     /*                       @Y30LB32*/
*                                                                  0627
         LA    @14,NUMTBL-1(@15)                                   0627
         MVC   NUMBER(1),0(@14)                                    0627
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF CHARACTER NOT NUMERIC AND IF NOT         @Y30LB32*/
*       /* NUMERIC SET CONDITION CODE WITH ERROR CODE        @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0628
*       IF VOLCHAR^=NUMBER&LOOPCNT=10 THEN/*                 @Y30LB32*/
         CLC   VOLCHAR(1),NUMBER                                   0628
         BE    @RF00628                                            0628
         C     @15,@CF00478                                        0628
         BNE   @RF00628                                            0628
*         NUMCOND=LASTCC04;         /*                       @Y30LB32*/
*                                                                  0629
         LA    NUMCOND,4                                           0629
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF CHARACTER NUMERIC AND IF NUMERIC         @Y30LB32*/
*       /* INCREMENT COUNT OF NUMERIC CHARACTERS FOUND       @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0630
*       ELSE                        /*                       @Y30LB32*/
*         IF VOLCHAR=NUMBER THEN    /*                       @Y30LB32*/
         B     @RC00628                                            0630
@RF00628 CLC   VOLCHAR(1),NUMBER                                   0630
         BNE   @RF00630                                            0630
*           NUMCNT=NUMCNT+1;        /*                       @Y30LB32*/
         LA    NUMCNT,1(,NUMCNT)                                   0631
*     END;                          /*                       @Y30LB32*/
*                                                                  0632
@RF00630 DS    0H                                                  0632
@RC00628 LA    @15,1                                               0632
         AL    @15,LOOPCNT                                         0632
         ST    @15,LOOPCNT                                         0632
         C     @15,@CF00478                                        0632
         BNH   @DL00626                                            0632
@DC00626 DS    0H                                                  0633
*     /***************************************************************/
*     /*                                                             */
*     /* RESET SUBSTRINGING VARIABLE TO ACCESS NEXT          @Y30LB32*/
*     /* CHARACTER IN VOLUME SERIAL NUMBER                   @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0633
*     CHARNUM=CHARNUM-1;            /*                       @Y30LB32*/
         SLR   @15,@15                                             0633
         IC    @15,CHARNUM                                         0633
         BCTR  @15,0                                               0633
         STC   @15,CHARNUM                                         0633
*   END;                            /*                       @Y30LB32*/
*                                                                  0634
         AL    VOLSERCK,@CF00221                                   0634
         C     VOLSERCK,@CF00158                                   0634
         BNH   @DL00623                                            0634
@DC00623 DS    0H                                                  0635
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN                     @Y30LB32*/
*   /* TO CALLER                                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*   REG14=RETADDR1;                 /*                       @Y30LB32*/
         L     REG14,RETADDR1                                      0635
*   RETURN CODE(NUMCOND);           /*                       @Y30LB32*/
         LR    @15,NUMCOND                                         0636
@EL00006 DS    0H                                                  0636
@EF00006 DS    0H                                                  0636
@ER00006 BR    @14                                                 0636
*   END NUMCHK;                     /*                       @Y30LB32*/
*                                                                  0638
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - ACCESS                                 @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - ACCESSES INFORMATION FROM FDT AND            @Y30LB32*/
*/*             INITIALIZES PARM LIST DEFLIST AND ARGUMENT   @Y30LB32*/
*/*             LIST VS2AGL WITH THE INFORMATION             @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - DEFLIST, MSF ID, VOLUME SERIAL NUMBER, VOLUME   @Y30LB32*/
*/*          DESCRIPTION, BACKUP NUMBER, VTOC SIZE, OWNER    @Y30LB32*/
*/*          NAME                                            @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - DEFLIST                                        @Y30LB32*/
*/*           CONDITION CODE - NONE                          @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0638
*ACCESS:                                                           0638
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0638
ACCESS   DS    0H                                                  0639
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0639
*   RETADDR=REG14;                  /*                       @Y30LB32*/
         LR    RETADDR,REG14                                       0639
*   OLDERID2=NEWERID2;                                             0640
         L     @06,@PC00001                                        0640
         L     @06,GDTTR2(,@06)                                    0640
         MVC   @TS00001(95),NEWERID2(@06)                          0640
         MVC   OLDERID2(95,@06),@TS00001                           0640
*   NEWID2='CVAC';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@06),@CC01575                              0641
*   ACCCOND=0;                      /*                       @Y30LB32*/
*                                                                  0642
         SLR   ACCCOND,ACCCOND                                     0642
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS MSF ID FROM FDT AND PLACE IN PARM LIST         @Y30LB32*/
*   /* DEFLIST AREAS                                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0643
*   DEFVLIB=MSFVAL;                 /*                       @Y30LB32*/
*                                                                  0643
         L     @06,DEFLSTP                                         0643
         L     @02,@PC00001+4                                      0643
         L     @01,FDTPTR+12(,@02)                                 0643
         L     @15,MSFVAL(,@01)                                    0643
         STC   @15,DEFVLIB(,@06)                                   0643
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS VOLUME DESCRIPTION AND BACKUP NUMBER FROM THE  @Y30LB32*/
*   /* FDT AND PLACE IN DEFINE MACRO PARAMETER EXTENSION     @Y30LB32*/
*   /* LIST DEFVE. SET FLAGS SPECIFYING FIELDS SET           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0644
*   DEFDESCR=DESCRVAL;              /*                       @Y30LB32*/
         L     @01,FDTPTR+28(,@02)                                 0644
         MVC   DEFDESCR(30,DEFVEPTR),DESCRVAL(@01)                 0644
*   DEFPDESC=ON;                    /*                       @Y30LB32*/
         OI    DEFPDESC(DEFVEPTR),B'00010000'                      0645
*   DEFBKUPN=BKUP#VAL;              /*                       @Y30LB32*/
         L     @01,FDTPTR+32(,@02)                                 0646
         L     @15,BKUP#VAL(,@01)                                  0646
         STC   @15,DEFBKUPN(,DEFVEPTR)                             0646
*   DEFPBKUP=ON;                    /*                       @Y30LB32*/
*                                                                  0647
         OI    DEFPBKUP(DEFVEPTR),B'00000100'                      0647
*   /*****************************************************************/
*   /*                                                               */
*   /* SET DEFVDATA TO BLANK AND SET DEFOWNID WITH OWNER     @Y30LB32*/
*   /* NAME ACCESSED FROM FDT AND SET DEFTLAB TO T           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0648
*   DEFVDATA=BLANK;                 /*                       @Y30LB32*/
         MVI   DEFVDATA+1(@06),C' '                                0648
         MVC   DEFVDATA+2(70,@06),DEFVDATA+1(@06)                  0648
         MVI   DEFVDATA(@06),C' '                                  0648
*   DEFOWNID=OWNERVAL;              /*                       @Y30LB32*/
         MVI   DEFOWNID+10(@06),C' '                               0649
         MVC   DEFOWNID+11(3,@06),DEFOWNID+10(@06)                 0649
         L     @02,FDTPTR+24(,@02)                                 0649
         MVC   DEFOWNID(10,@06),OWNERVAL(@02)                      0649
*   DEFTLAB=TCHAR;                  /*                       @Y30LB32*/
*                                                                  0650
         MVI   DEFTLAB(@06),C'T'                                   0650
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RONLYFLG IS ON, IF ON SET WAIT FLAG IN MDAGL @Y30LB32*/
*   /* FOR DEMOUNT TO RETURN CONTROL TO CALLER AFTER         @Y30LB32*/
*   /* DEMOUNT IS COMPLETE                                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0651
*   IF RONLYFLG=ON THEN             /*                       @Y30LB32*/
         TM    RONLYFLG,B'01000000'                                0651
         BNO   @RF00651                                            0651
*     MDWAIT=ON;                    /*                       @Y30LB32*/
*                                                                  0652
         L     @06,MDAGLPTR                                        0652
         OI    MDWAIT(@06),B'00010000'                             0652
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS DDNAME TO ALLOCATE NEW VOLUME ON               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*   MDDDNAME=FILEVAL;               /*                       @Y30LB32*/
@RF00651 L     @06,MDAGLPTR                                        0653
         L     @02,@PC00001+4                                      0653
         L     @15,FDTPTR+4(,@02)                                  0653
         MVC   MDDDNAME(8,@06),FILEVAL(@15)                        0653
*   VSDDNAME=FILEVAL;               /*                       @Y30LB32*/
*                                                                  0654
         L     @06,VSAGLPTR                                        0654
         MVC   VSDDNAME(8,@06),FILEVAL(@15)                        0654
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS ADDRESS OF VOLUME SERIAL NUMBER, ADDRESS OF    @Y30LB32*/
*   /* VOLUME OWNER NAME, AND ADDRESS TO ADDRESS OF IO       @Y30LB32*/
*   /* CONTROL BLOCK                                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0655
*   VSVOLPTR=ADDR(VOLSER);          /*                       @Y30LB32*/
         LA    @15,VOLSER                                          0655
         ST    @15,VSVOLPTR(,@06)                                  0655
*   VSOWNPTR=ADDR(OWNERVAL);        /*                       @Y30LB32*/
         L     @01,FDTPTR+24(,@02)                                 0656
         LA    @15,OWNERVAL(,@01)                                  0656
         ST    @15,VSOWNPTR(,@06)                                  0656
*   VSIOBKPT=ADDR(IOCTLBKP);        /*                       @Y30LB32*/
*                                                                  0657
         LA    @15,IOCTLBKP                                        0657
         ST    @15,VSIOBKPT(,@06)                                  0657
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS THE NUMBER OF TRACKS THE VTOC IS TO OCCUPY     @Y30LB32*/
*   /* FROM THE FDT AND PALCE IN ARGUMENT LIST VS2AGL        @Y30LB32*/
*   /* SET BIT REQUESTING RESERVE TO BE PERFORMED            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0658
*   VSVTOCSZ=VTSZVAL;               /*                       @Y30LB32*/
*                                                                  0658
         L     @02,FDTPTR+16(,@02)                                 0658
         L     @02,VTSZVAL(,@02)                                   0658
         ST    @02,VSVTOCSZ(,@06)                                  0658
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0659
*   REG14=RETADDR;                  /*                       @Y30LB32*/
         LR    REG14,RETADDR                                       0659
*   RETURN CODE(ACCCOND);           /*                       @Y30LB32*/
         LR    @15,ACCCOND                                         0660
@EL00007 DS    0H                                                  0660
@EF00007 DS    0H                                                  0660
@ER00007 BR    @14                                                 0660
*   END ACCESS;                     /*                       @Y30LB32*/
*                                                                  0662
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CREATVOL                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - ROUTES CONTROL TO ROUTINES WHICH CREATE,     @Y30LB32*/
*/*             MOUNT, INITIALIZE, DEMOUNT, AND RESET        @Y30LB32*/
*/*             READONLY MOUNTING ATTRIBUTE FLAG. WRITES     @Y30LB32*/
*/*             MESSAGE IDC0680I IF VOLUME IS CREATED.       @Y30LB32*/
*/*             INCREMENTS VOLUME SERIAL NUMBER IF MORE THEN @Y30LB32*/
*/*             ONE VOLUME IS TO BE CREATED.                 @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CSN, CSN LENGTH, NUMBER OF VOLUMES              @Y30LB32*/
*/*          TO BE CREATED                                   @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*            RETURN CODE = 0 - VOLUME CREATED & UPDATED    @Y30LB32*/
*/*            RETURN CODE = 4 - ALL VOLUMES WERE NOT        @Y30LB32*/
*/*                              CREATED                     @Y30LB32*/
*/*            RETURN CODE = 8 - FUNCTION TERMINATED         @Y30LB32*/
*/*                              ERROR DURING UPDATE, CART-  @ZA00067*/
*/*                              PROC OR CREATACT            @ZA00067*/
*/*         - ROFAIL FLAG                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0662
*CREATVOL:                                                         0662
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0662
CREATVOL DS    0H                                                  0663
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND SET CONDITION CODE TO         @Y30LB32*/
*   /* ZERO                                                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0663
*   RETADDR1=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR1                                      0663
*   OLDERID2=NEWERID2;                                             0664
         L     @06,@PC00001                                        0664
         L     @06,GDTTR2(,@06)                                    0664
         MVC   @TS00001(95),NEWERID2(@06)                          0664
         MVC   OLDERID2(95,@06),@TS00001                           0664
*   NEWID2='CVCL';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@06),@CC01579                              0665
*   CRVCOND=0;                      /*                       @Y30LB32*/
*                                                                  0666
         SLR   CRVCOND,CRVCOND                                     0666
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FIELD USED TO COUNT NUMBER OF VOLUMES      @Y30LB32*/
*   /* CREATED TO ZERO                                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0667
*   VOLCRCNT=''B;                   /*                       @Y30LB32*/
*                                                                  0667
         SLR   @06,@06                                             0667
         ST    @06,VOLCRCNT                                        0667
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS VOLUME SERIAL NUMBER FROM THE FDT              @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0668
*   VOLSER=VOLVAL;                  /*                       @Y30LB32*/
*                                                                  0668
         L     @06,@PC00001+4                                      0668
         L     @06,FDTPTR(,@06)                                    0668
         MVC   VOLSER(6),VOLVAL(@06)                               0668
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE NEW VOLUMES UNTIL REQUESTED NUMBER ARE         @Y30LB32*/
*   /* CREATED OR A TERMINATING ERROR OCCURS                 @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0669
*   DO LOOPCNT=ONE TO COUNTVAL      /*                       @Y30LB32*/
*         WHILE(CRVCOND<LASTCC08);  /*                       @ZA00067*/
*                                                                  0669
         LA    @06,1                                               0669
         B     @DE00669                                            0669
@DL00669 C     CRVCOND,@CF00181                                    0669
         BNL   @DC00669                                            0669
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF CART PARAMETER IS SPECIFIED. IF            @Y30LB32*/
*     /* SPECIFIED, CHECK NUMBER OF CSN'S LISTED ADEQUATE    @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0670
*     IF(ADDR(CART))^=NULLPTR THEN  /*                       @Y30LB32*/
         L     @06,@PC00001+4                                      0670
         L     @06,FDTPTR+20(,@06)                                 0670
         LTR   @06,@06                                             0670
         BZ    @RF00670                                            0670
*       IF VOLCRCNT<CARTCNT/2 THEN  /*                       @Y30LB32*/
         LH    @00,CARTCNT(,@06)                                   0671
         SRDA  @00,32                                              0671
         D     @00,@CF00155                                        0671
         C     @01,VOLCRCNT                                        0671
         BNH   @RF00671                                            0671
*         DO;                       /*                       @Y30LB32*/
*                                                                  0672
*           /*********************************************************/
*           /*                                                       */
*           /* CALL CARTPROC TO ACCESS CARTRIDGES AND        @Y30LB32*/
*           /* CHECK CSN'S USED TO CREATE NEW VOLUME         @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0673
*           CALL CARTPROC;          /*                       @Y30LB32*/
         BAL   @14,CARTPROC                                        0673
*           RESPECIFY                                              0674
*             RTNREG RSTD;                                         0674
*           TESTRC=RTNREG;                                         0675
         LR    TESTRC,RTNREG                                       0675
*           RESPECIFY                                              0676
*             RTNREG UNRSTD;        /*                       @Y30LB32*/
*                                                                  0676
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF CARTPROC ROUTINE WAS SUCCESSFUL      @Y30LB32*/
*           /* IF NOT SUCCESSFUL SET CONDITION CODE WITH     @Y30LB32*/
*           /* ERROR CODE                                    @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0677
*           IF TESTRC^=0 THEN       /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0677
         BZ    @RF00677                                            0677
*             CRVCOND=LASTCC08;     /*                       @Y30LB32*/
         LA    CRVCOND,8                                           0678
*         END;                      /*                       @Y30LB32*/
*                                                                  0679
*     /***************************************************************/
*     /*                                                             */
*     /* WRITE MESSAGE IDC2689I STATING INSUFFICIENT NUMBER  @Y30LB32*/
*     /* OF CARTRIDGES AND SET CONDITION CODE                @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0680
*       ELSE                        /*                       @Y30LB32*/
*         DO;                       /*                       @Y30LB32*/
         B     @RC00671                                            0680
@RF00671 DS    0H                                                  0681
*           PRINTTAB=''B;           /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0681
*           DARGSMOD=CRVMSG;        /*                       @Y30LB32*/
         L     @06,DDSTRU                                          0682
         MVC   DARGSMOD(3,@06),@CC01462                            0682
*           DARGSENT=MSG2689I;      /*                       @Y30LB32*/
         MVI   DARGSENT(@06),X'0A'                                 0683
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB32*/
         L     @06,@PC00001                                        0684
         ST    @06,@AL00001                                        0684
         LA    @15,@CF00116                                        0684
         ST    @15,@AL00001+4                                      0684
         LA    @15,DDSTRU                                          0684
         ST    @15,@AL00001+8                                      0684
         MVI   @AL00001+8,X'80'                                    0684
         L     @15,GDTPRT(,@06)                                    0684
         LA    @01,@AL00001                                        0684
         BALR  @14,@15                                             0684
*           CRVCOND=LASTCC08;       /*                       @Y30LB32*/
         LA    CRVCOND,8                                           0685
*         END;                      /*                       @Y30LB32*/
*                                                                  0686
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK CONDITION CODE TO DETERMINE IF                @Y30LB32*/
*     /* PROCESSING SHOULD CONTINUE                          @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0687
*     IF CRVCOND^=LASTCC08 THEN     /*                       @Y30LB32*/
@RC00671 DS    0H                                                  0687
@RF00670 C     CRVCOND,@CF00181                                    0687
         BE    @RF00687                                            0687
*       DO;                         /*                       @Y30LB32*/
*                                                                  0688
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE UENQ MACRO TO GAIN EXCLUSIVE              @Y30LB32*/
*         /* CONTROL OF VOLUME SERIAL NUMBER                 @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0689
*         TYPENAME=ENQUEUE;         /*                       @Y30LB32*/
         MVC   TYPENAME(8),@CC01489                                0689
*         CALL IDCSANQ0(GDTTBL,EXCL,WAIT,SYSZAMS,RNAME);/*   @Y30LB32*/
*                                                                  0690
         MVC   @AL00001+4(12),@AL00690                             0690
         L     @06,@PC00001                                        0690
         ST    @06,@AL00001                                        0690
         LA    @15,RNAME                                           0690
         ST    @15,@AL00001+16                                     0690
         MVI   @AL00001+16,X'80'                                   0690
         L     @15,GDTENQ(,@06)                                    0690
         LA    @01,@AL00001                                        0690
         BALR  @14,@15                                             0690
*         /***********************************************************/
*         /*                                                         */
*         /* SET DEFLIST WITH VOLUME SERIAL NUMBER           @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0691
*         DEFLSTP=ADDR(PARMLST2);   /*                       @Y30LB32*/
         LA    @06,PARMLST2                                        0691
         ST    @06,DEFLSTP                                         0691
*         DEFVOLD=VOLSER;           /*                       @Y30LB32*/
         MVC   DEFVOLD(6,@06),VOLSER                               0692
*         DEFLSTP=ADDR(PARMLST);    /*                       @Y30LB32*/
         LA    @06,PARMLST                                         0693
         ST    @06,DEFLSTP                                         0693
*         DEFVOLD=VOLSER;           /*                       @Y30LB32*/
*                                                                  0694
         MVC   DEFVOLD(6,@06),VOLSER                               0694
*         /***********************************************************/
*         /*                                                         */
*         /* CALL CREATACT ROUTINE WHICH CREATES AND         @Y30LB32*/
*         /* ACTIVATES A NEW VOLUME                          @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0695
*         CALL CREATACT;            /*                       @Y30LB32*/
         BAL   @14,CREATACT                                        0695
*         RESPECIFY                                                0696
*           RTNREG RSTD;                                           0696
*         TESTRC=RTNREG;                                           0697
         LR    TESTRC,RTNREG                                       0697
*         RESPECIFY                                                0698
*           RTNREG UNRSTD;          /*                       @Y30LB32*/
*                                                                  0698
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF CREATACT ROUTINE WAS SUCCESSFUL        @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0699
*         IF TESTRC=0 THEN          /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0699
         BNZ   @RF00699                                            0699
*           DO;                     /*                       @Y30LB32*/
*                                                                  0700
*             /*******************************************************/
*             /*                                                     */
*             /* CALL UPDATE ROUTINE TO INITIALIZE VOLUME    @Y30LB32*/
*             /* WITH VOLUME LABEL AND VTOC                  @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0701
*             CALL UPDATE;          /*                       @Y30LB32*/
         BAL   @14,UPDATE                                          0701
*             RESPECIFY                                            0702
*               RTNREG RSTD;                                       0702
*             TESTRC=RTNREG;                                       0703
         LR    TESTRC,RTNREG                                       0703
*             RESPECIFY                                            0704
*               RTNREG UNRSTD;      /*                       @Y30LB32*/
*                                                                  0704
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF UPDATE ROUTINE WAS SUCCESSFUL      @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0705
*             IF TESTRC=0 THEN      /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0705
         BNZ   @RF00705                                            0705
*               IF RONLYFLG=ON THEN /*                       @Y30LB32*/
         TM    RONLYFLG,B'01000000'                                0706
         BNO   @RF00706                                            0706
*                 DO;               /*                       @Y30LB32*/
*                                                                  0707
*                   /*************************************************/
*                   /*                                               */
*                   /* CALL ROPROC ROUTINE TO SET READWRITE  @Y30LB32*/
*                   /* VOLUME ATTRIBUTE FLAG TO READ ONLY    @Y30LB32*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0708
*                   CALL ROPROC;    /*                       @Y30LB32*/
         BAL   @14,ROPROC                                          0708
*                   RESPECIFY                                      0709
*                     RTNREG RSTD;                                 0709
*                   TESTRC=RTNREG;                                 0710
         LR    TESTRC,RTNREG                                       0710
*                   RESPECIFY                                      0711
*                     RTNREG UNRSTD;/*                       @Y30LB32*/
*                                                                  0711
*                   /*************************************************/
*                   /*                                               */
*                   /* CHECK IF ROPROC ROUTINE WAS SUCCESSFUL        */
*                   /*                                       @Y30LB32*/
*                   /* IF NOT SUCCESSFUL SET ROFAIL FLAG     @Y30LB32*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0712
*                   IF TESTRC^=0 THEN/*                      @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0712
         BZ    @RF00712                                            0712
*                     ROFAIL=ON;    /*                       @Y30LB32*/
         OI    ROFAIL,B'00000010'                                  0713
*                 END;              /*                       @Y30LB32*/
*               ELSE                                               0715
*                 ;                 /*                       @Y30LB32*/
*                                                                  0715
@RF00706 DS    0H                                                  0716
*             /*******************************************************/
*             /*                                                     */
*             /* UPDATE ROUTINE WAS UNSUCCESSFUL             @Y30LB32*/
*             /* PROCESS ERROR CODE                          @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0716
*             ELSE                  /*                       @Y30LB32*/
*                                                                  0716
*               /*****************************************************/
*               /*                                                   */
*               /* IF UPDATE FAILS FOR ANY REASON, WE WANT TO        */
*               /* TERMINATE OUR LOOP BY SETTING OUR RETURN CODE TO  */
*               /* 8.                                        @ZA00067*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0716
*               CRVCOND=LASTCC08;   /*                       @Y30LB32*/
         B     @RC00705                                            0716
@RF00705 LA    CRVCOND,8                                           0716
*           END;                    /*                       @Y30LB32*/
*                                                                  0717
*         /***********************************************************/
*         /*                                                         */
*         /* CREATACT WAS NOT SUCCESSFUL PROCESS             @Y30LB32*/
*         /* ERROR CODE                                      @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0718
*         ELSE                      /*                       @Y30LB32*/
*                                                                  0718
*           /*********************************************************/
*           /*                                                       */
*           /* IF CREATACT FAILS FOR ANY REASON, WE WANT TO TERMINATE*/
*           /* OUR LOOP BY SETTING OUR RETURN CODE TO 8.     @ZA00067*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0718
*           CRVCOND=LASTCC08;       /*                       @Y30LB32*/
*                                                                  0718
         B     @RC00699                                            0718
@RF00699 LA    CRVCOND,8                                           0718
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE UDEQ UMACRO TO RELEASE EXCLUSIVE          @Y30LB32*/
*         /* CONTROL OF VOLUME SERIAL NUMBER                 @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0719
*         TYPENAME=ENQUEUE;         /*                       @ZA05119*/
@RC00699 MVC   TYPENAME(8),@CC01489                                0719
*         CALL IDCSADQ0(GDTTBL,SYSZAMS,RNAME);/*             @Y30LB32*/
*                                                                  0720
         L     @06,@PC00001                                        0720
         ST    @06,@AL00001                                        0720
         LA    @15,@CC01493                                        0720
         ST    @15,@AL00001+4                                      0720
         LA    @15,RNAME                                           0720
         ST    @15,@AL00001+8                                      0720
         MVI   @AL00001+8,X'80'                                    0720
         L     @15,GDTDEQ(,@06)                                    0720
         LA    @01,@AL00001                                        0720
         BALR  @14,@15                                             0720
*         /***********************************************************/
*         /*                                                         */
*         /* IF VCREATED FLAG IS                             @Y30LB32*/
*         /* SET WRITE MESSAGE IDC0680I STATING              @Y30LB32*/
*         /* VOLUME CREATED                                  @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0721
*         IF VCREATED=ON THEN       /*                       @Y30LB32*/
         TM    VCREATED,B'10000000'                                0721
         BNO   @RF00721                                            0721
*           DO;                     /*                       @Y30LB32*/
*             PRINTTAB=''B;         /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0723
*             DARGSMOD=CRVMSG;      /*                       @Y30LB32*/
         L     @06,DDSTRU                                          0724
         MVC   DARGSMOD(3,@06),@CC01462                            0724
*             DARGSENT=MSG0680I;    /*                       @Y30LB32*/
         MVI   DARGSENT(@06),X'01'                                 0725
*             DARGDBP=ADDR(VOLSER); /*                       @Y30LB32*/
         LA    @15,VOLSER                                          0726
         ST    @15,DARGDBP(,@06)                                   0726
*             DARGILP=LENGTH(VOLSER);/*                      @Y30LB32*/
         MVC   DARGILP(2,@06),@CH00158                             0727
*             DARGCNT=2;            /*                       @Y30LB32*/
         LA    @15,2                                               0728
         STH   @15,DARGCNT(,@06)                                   0728
*             DARGINS(1)=1;         /*                       @Y30LB32*/
         MVC   DARGINS(2,@06),@CH00221                             0729
*             DARGINL(1)=LENGTH(SAVECSN1);/*                 @Y30LB32*/
         LA    @14,12                                              0730
         STH   @14,DARGINL(,@06)                                   0730
*             DARGDTM(1)=ADDR(SAVECSN1);/*                   @Y30LB32*/
         LA    @05,SAVECSN1                                        0731
         ST    @05,DARGDTM(,@06)                                   0731
*             DARGINS(2)=2;         /*                       @Y30LB32*/
         STH   @15,DARGINS+8(,@06)                                 0732
*             DARGINL(2)=LENGTH(SAVECSN2);/*                 @Y30LB32*/
         STH   @14,DARGINL+8(,@06)                                 0733
*             DARGDTM(2)=ADDR(SAVECSN2);/*                   @Y30LB32*/
         LA    @15,SAVECSN2                                        0734
         ST    @15,DARGDTM+8(,@06)                                 0734
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB32*/
*                                                                  0735
         L     @06,@PC00001                                        0735
         ST    @06,@AL00001                                        0735
         LA    @15,@CF00116                                        0735
         ST    @15,@AL00001+4                                      0735
         LA    @15,DDSTRU                                          0735
         ST    @15,@AL00001+8                                      0735
         MVI   @AL00001+8,X'80'                                    0735
         L     @15,GDTPRT(,@06)                                    0735
         LA    @01,@AL00001                                        0735
         BALR  @14,@15                                             0735
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT COUNT OF VOLUMES CREATED AND SET  @Y30LB32*/
*             /* VOLUME CREATED INDICATOR FLAG               @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0736
*             VOLCRCNT=VOLCRCNT+1;  /*                       @Y30LB32*/
         LA    @06,1                                               0736
         AL    @06,VOLCRCNT                                        0736
         ST    @06,VOLCRCNT                                        0736
*             CREATFLG=ON;          /*                       @Y30LB32*/
         OI    CREATFLG,B'10000000'                                0737
*           END;                    /*                       @Y30LB32*/
*                                                                  0738
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF MORE THAN ONE VOLUME IS TO BE CREATED. @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0739
*         IF COUNTVAL>1&CRVCOND<8 THEN/*                     @Y30LB32*/
@RF00721 LA    @06,1                                               0739
         L     @15,@PC00001+4                                      0739
         L     @01,FDTPTR+8(,@15)                                  0739
         C     @06,COUNTVAL(,@01)                                  0739
         BNL   @RF00739                                            0739
         C     CRVCOND,@CF00181                                    0739
         BNL   @RF00739                                            0739
*           DO;                     /*                       @Y30LB32*/
*                                                                  0740
*             /*******************************************************/
*             /*                                                     */
*             /* INCREMENT VOLSER FOR NEXT VOLUME            @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0741
*             SAVBINNO=SAVBINNO+ONE;/*                       @Y30LB32*/
         AL    @06,SAVBINNO                                        0741
         ST    @06,SAVBINNO                                        0741
*             CVD(SAVBINNO,PACKEDNO);/*                      @Y30LB32*/
         CVD   @06,@TS00001                                        0742
         MVC   PACKEDNO(6),@TS00001+2                              0742
*             UNPK(NUMERICS,PACKEDNO);/*                     @Y30LB32*/
         UNPK  NUMERICS(6),PACKEDNO(6)                             0743
*             MVZ(NUMERICS(6:6),NUMERICS);/*                 @Y30LB32*/
         MVZ   NUMERICS+5(1),NUMERICS                              0744
*             VOLSER(CHARNUM:6)=NUMERICS(CHARNUM:6);/*       @Y30LB32*/
*                                                                  0745
         SLR   @06,@06                                             0745
         IC    @06,CHARNUM                                         0745
         LA    @01,VOLSER-1(@06)                                   0745
         LA    @15,6                                               0745
         SLR   @15,@06                                             0745
         LA    @14,NUMERICS-1(@06)                                 0745
         EX    @15,@SM01695                                        0745
*             /*******************************************************/
*             /*                                                     */
*             /* RESET VCREATED FLAG TO ZERO AND BLANK FIELDS FOR    */
*             /*                                             @Y30LB32*/
*             /* SAVING CSNS                                 @Y30LB32*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0746
*             VCREATED=OFF;         /*                       @Y30LB32*/
         NI    VCREATED,B'01111111'                                0746
*             SAVECSN1=BLANK;       /*                       @Y30LB32*/
         MVI   SAVECSN1+1,C' '                                     0747
         MVC   SAVECSN1+2(10),SAVECSN1+1                           0747
         MVI   SAVECSN1,C' '                                       0747
*             SAVECSN2=BLANK;       /*                       @Y30LB32*/
         MVI   SAVECSN2+1,C' '                                     0748
         MVC   SAVECSN2+2(10),SAVECSN2+1                           0748
         MVI   SAVECSN2,C' '                                       0748
*           END;                    /*                       @Y30LB32*/
*       END;                        /*                       @Y30LB32*/
@RF00739 DS    0H                                                  0751
*   END;                            /*                       @Y30LB32*/
@RF00687 LA    @06,1                                               0751
         AL    @06,LOOPCNT                                         0751
@DE00669 ST    @06,LOOPCNT                                         0751
         L     @15,@PC00001+4                                      0751
         L     @01,FDTPTR+8(,@15)                                  0751
         C     @06,COUNTVAL(,@01)                                  0751
         BNH   @DL00669                                            0751
@DC00669 DS    0H                                                  0752
*                                                                  0752
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ALL REQUESTED VOLUMES WERE CREATED           @Y30LB32*/
*   /* SUCCESSFULLY OR ATTEMPT MADE TO CREATE THEM           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0752
*   IF(VOLCRCNT+1)<COUNTVAL THEN    /*                       @Y30LB32*/
         LA    @08,1                                               0752
         AL    @08,VOLCRCNT                                        0752
         L     @06,@PC00001+4                                      0752
         L     @06,FDTPTR+8(,@06)                                  0752
         C     @08,COUNTVAL(,@06)                                  0752
         BNL   @RF00752                                            0752
*     DO;                           /*                       @Y30LB32*/
*                                                                  0753
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE IDC2685I STATING ATTEMPT            @Y30LB32*/
*       /* NOT MADE TO CREATE ADDITIONAL VOLUMES             @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0754
*       PRINTTAB=''B;               /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0754
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/
         L     @08,DDSTRU                                          0755
         MVC   DARGSMOD(3,@08),@CC01462                            0755
*       DARGSENT=MSG2685I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@08),X'06'                                 0756
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @08,@PC00001                                        0757
         ST    @08,@AL00001                                        0757
         LA    @06,@CF00116                                        0757
         ST    @06,@AL00001+4                                      0757
         LA    @06,DDSTRU                                          0757
         ST    @06,@AL00001+8                                      0757
         MVI   @AL00001+8,X'80'                                    0757
         L     @15,GDTPRT(,@08)                                    0757
         LA    @01,@AL00001                                        0757
         BALR  @14,@15                                             0757
*     END;                          /*                       @Y30LB32*/
*                                                                  0758
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0759
*   REG14=RETADDR1;                 /*                       @Y30LB32*/
@RF00752 L     REG14,RETADDR1                                      0759
*   RETURN CODE(CRVCOND);           /*                       @Y30LB32*/
         LR    @15,CRVCOND                                         0760
@EL00008 DS    0H                                                  0760
@EF00008 DS    0H                                                  0760
@ER00008 BR    @14                                                 0760
*   END CREATVOL;                   /*                       @Y30LB32*/
*                                                                  0762
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CARTPROC                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - ACCESSES CSN'S AND CHECKS LENGTH OF          @Y30LB32*/
*/*             CSN'S. CALLS SUBROUTINE CKCSNLEN WHICH       @Y30LB32*/
*/*             ACTUALLY CHECKS LENGTH. IF CSN IS VALID      @Y30LB32*/
*/*             PLACES IT IN PARM LIST DEFLIST               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - COUNT OF ATTEMPTS TO CREATE A VOLUME            @Y30LB32*/
*/*         CSN'S AND LENGTH OF CSN'S                        @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - CSN'S VALID                @Y30LB32*/
*/*             RETURN CODE = 4 - CSN INVALID LENGTH         @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0762
*CARTPROC:                                                         0762
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0762
CARTPROC DS    0H                                                  0763
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER, SET CONDITION CODE     @Y30LB32*/
*   /* TO ZERO AND RESET POINTER TO DEFLIST PARM AREA        @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0763
*   RETADDR2=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR2                                      0763
*   OLDERID2=NEWERID2;                                             0764
         L     @06,@PC00001                                        0764
         L     @06,GDTTR2(,@06)                                    0764
         MVC   @TS00001(95),NEWERID2(@06)                          0764
         MVC   OLDERID2(95,@06),@TS00001                           0764
*   NEWID2='CVCP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@06),@CC01590                              0765
*   CARTCOND=0;                     /*                       @Y30LB32*/
         SLR   CARTCOND,CARTCOND                                   0766
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/
*                                                                  0767
         LA    @06,PARMLST                                         0767
         ST    @06,DEFLSTP                                         0767
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ARRAY COUNT TO LIST OF CSN'S BASED ON             @Y30LB32*/
*   /* NUMBER OF VOLUMES CREATED                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0768
*   IF VOLCRCNT=0 THEN              /*                       @Y30LB32*/
         L     @06,VOLCRCNT                                        0768
         LTR   @06,@06                                             0768
         BNZ   @RF00768                                            0768
*     CSNNUM=ONE;                   /*                       @Y30LB32*/
*                                                                  0769
         LA    CSNNUM,1                                            0769
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INDEX NUMBER TO ACCESS CSNS FOR THE NEXT VOLUME   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0770
*   ELSE                            /*                       @Y30LB32*/
*     CSNNUM=(VOLCRCNT*2)+1;        /*                       @Y30LB32*/
*                                                                  0770
         B     @RC00768                                            0770
@RF00768 L     CSNNUM,VOLCRCNT                                     0770
         ALR   CSNNUM,CSNNUM                                       0770
         LA    CSNNUM,1(,CSNNUM)                                   0770
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS, CHECK LENGTH, AND PLACE TWO CSN'S IN          @Y30LB32*/
*   /* DEFLIST                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0771
*   DO CSNCNT=1 TO 2 WHILE(CARTCOND=0);/*                    @Y30LB32*/
*                                                                  0771
@RC00768 LA    CSNCNT,1                                            0771
@DL00771 LTR   CARTCOND,CARTCOND                                   0771
         BNZ   @DC00771                                            0771
*     /***************************************************************/
*     /*                                                             */
*     /* ACCESS CSN AND CSN LENGTH THEN CALL CKCSNLEN        @Y30LB32*/
*     /* ROUTINE TO CHECK LENGTH OF CSN                      @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0772
*     CSNVAL=CARTVAL(CSNNUM);       /*                       @Y30LB32*/
         LR    @15,CSNNUM                                          0772
         MH    @15,@CH00649                                        0772
         L     @14,@PC00001+4                                      0772
         L     @14,FDTPTR+20(,@14)                                 0772
         ST    @15,@TF00001                                        0772
         ALR   @15,@14                                             0772
         AL    @15,@CF01698                                        0772
         MVC   CSNVAL(12),CARTVAL-3(@15)                           0772
*     CALL CKCSNLEN(CSNVAL,CARTLEN(CSNNUM));/*               @Y30LB32*/
         LA    @15,CSNVAL                                          0773
         ST    @15,@AL00001                                        0773
         L     @15,@TF00001                                        0773
         AL    @14,@CF01699                                        0773
         LA    @15,CARTLEN-2(@15,@14)                              0773
         ST    @15,@AL00001+4                                      0773
         LA    @01,@AL00001                                        0773
         BAL   @14,CKCSNLEN                                        0773
*     RESPECIFY                                                    0774
*       RTNREG RSTD;                                               0774
*     TESTRC=RTNREG;                                               0775
         LR    TESTRC,RTNREG                                       0775
*     RESPECIFY                                                    0776
*       RTNREG UNRSTD;              /*                       @Y30LB32*/
*                                                                  0776
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF CSN IS VALID LENGTH. IF CSN VALID          @Y30LB32*/
*     /* CHECK IF FIRST CSN FOR NEW VOLUME                   @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0777
*     IF TESTRC=0 THEN              /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0777
         BNZ   @RF00777                                            0777
*       IF CSNCNT=FIRSTCSN THEN     /*                       @Y30LB32*/
         LA    @15,1                                               0778
         CR    CSNCNT,@15                                          0778
         BNE   @RF00778                                            0778
*         DO;                       /*                       @Y30LB32*/
*                                                                  0779
*           /*********************************************************/
*           /*                                                       */
*           /* PLACE CSN IN DEFLIST AS FIRST CSN             @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0780
*           DEFVCSN1=CSNVAL;        /*                       @Y30LB32*/
*                                                                  0780
         L     @01,DEFLSTP                                         0780
         MVC   DEFVCSN1(12,@01),CSNVAL                             0780
*           /*********************************************************/
*           /*                                                       */
*           /* RESET ARRAY SUBSCRIPT NUMBER TO ACCESS        @Y30LB32*/
*           /* NEXT CSN                                      @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0781
*           CSNNUM=CSNNUM+1;        /*                       @Y30LB32*/
         ALR   CSNNUM,@15                                          0781
*         END;                      /*                       @Y30LB32*/
*                                                                  0782
*     /***************************************************************/
*     /*                                                             */
*     /* IF CSN IS NOT FIRST CSN THEN PLACE CSN              @Y30LB32*/
*     /* IN DEFLIST AS SECOND CSN                            @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0783
*       ELSE                        /*                       @Y30LB32*/
*         DEFVCSN2=CSNVAL;          /*                       @Y30LB32*/
*                                                                  0783
         B     @RC00778                                            0783
@RF00778 L     @01,DEFLSTP                                         0783
         MVC   DEFVCSN2(12,@01),CSNVAL                             0783
*     /***************************************************************/
*     /*                                                             */
*     /* IF CSN IS NOT VALID WRITE MESSAGE IDC2681I          @Y30LB32*/
*     /* STATING VOLUME NOT CREATED                          @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0784
*     ELSE                          /*                       @Y30LB32*/
*       DO;                         /*                       @Y30LB32*/
         B     @RC00777                                            0784
@RF00777 DS    0H                                                  0785
*         PRINTTAB=''B;             /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0785
*         DARGSMOD=CRVMSG;          /*                       @Y30LB32*/
         L     @15,DDSTRU                                          0786
         MVC   DARGSMOD(3,@15),@CC01462                            0786
*         DARGSENT=MSG2681I;        /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'02'                                 0787
*         DARGDBP=ADDR(VOLSER);     /*                       @Y30LB32*/
         LA    @14,VOLSER                                          0788
         ST    @14,DARGDBP(,@15)                                   0788
*         DARGILP=LENGTH(VOLSER);   /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00158                             0789
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Y30LB32*/
*                                                                  0790
         L     @15,@PC00001                                        0790
         ST    @15,@AL00001                                        0790
         LA    @14,@CF00116                                        0790
         ST    @14,@AL00001+4                                      0790
         LA    @14,DDSTRU                                          0790
         ST    @14,@AL00001+8                                      0790
         MVI   @AL00001+8,X'80'                                    0790
         L     @15,GDTPRT(,@15)                                    0790
         LA    @01,@AL00001                                        0790
         BALR  @14,@15                                             0790
*         /***********************************************************/
*         /*                                                         */
*         /* SET CONDITION CODE WITH ERROR CODE              @Y30LB32*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0791
*         CARTCOND=LASTCC04;        /*                       @Y30LB32*/
         LA    CARTCOND,4                                          0791
*       END;                        /*                       @Y30LB32*/
*   END;                            /*                       @Y30LB32*/
*                                                                  0793
@RC00777 AL    CSNCNT,@CF00221                                     0793
         C     CSNCNT,@CF00155                                     0793
         BNH   @DL00771                                            0793
@DC00771 DS    0H                                                  0794
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB32*/
*   /* TO CALLER                                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0794
*   REG14=RETADDR2;                 /*                       @Y30LB32*/
         L     REG14,RETADDR2                                      0794
*   RETURN CODE(CARTCOND);          /*                       @Y30LB32*/
         LR    @15,CARTCOND                                        0795
@EL00009 DS    0H                                                  0795
@EF00009 DS    0H                                                  0795
@ER00009 BR    @14                                                 0795
*   END CARTPROC;                   /*                       @Y30LB32*/
*                                                                  0797
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CREATACT                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CREATES NEW VOLUME THEN ACTIVATES NEW        @Y30LB32*/
*/*             VOLUME. ISSUES MESSAGE IDC2681I IF VOLUME    @Y30LB32*/
*/*             NOT CREATED. ISSUES MESSAGE IDC2075I IF      @Y30LB32*/
*/*             VOLUME NOT ACTIVATED. CALLS SCRATCH ROUTINE  @Y30LB32*/
*/*             TO SCRATCH VOLUME IF VOLUME IS NOT ACTIVATED @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - DEFLIST, DEFVE                                  @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*            RETURN CODE = 0 VOLUME CREATED AND ACTIVATED  @Y30LB32*/
*/*            RETURN CODE = 4 VOLUME NOT CREATED OR NOT     @Y30LB32*/
*/*                            ACTIVATED.                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0797
*CREATACT:                                                         0797
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0797
CREATACT DS    0H                                                  0798
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/
*   /* CODE TO ZERO AND RESET PTR TO DEFLIST PARM AREA       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0798
*   RETADDR2=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR2                                      0798
*   OLDERID2=NEWERID2;                                             0799
         L     @06,@PC00001                                        0799
         L     @05,GDTTR2(,@06)                                    0799
         MVC   @TS00001(95),NEWERID2(@05)                          0799
         MVC   OLDERID2(95,@05),@TS00001                           0799
*   NEWID2='CVCA';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@05),@CC01595                              0800
*   CRACOND=0;                      /*                       @Y30LB32*/
*                                                                  0801
         SLR   CRACOND,CRACOND                                     0801
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE FLAG BIT SETTINGS INDICATING VOLUME MOUNTING     @Y30LB32*/
*   /* ATTRIBUTES REQUESTED                                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0802
*   SAVFLAG=DEFVVFLG;                                              0802
*                                                                  0802
         L     @05,DEFLSTP                                         0802
         IC    @15,DEFVVFLG(,@05)                                  0802
         STC   @15,SAVFLAG                                         0802
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC UMACRO TO INVOKE EXECUTE FORM OF           @Y30LB32*/
*   /* ICBDEFV TO CREATE NEW VOLUME                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0803
*   IF GDTDBG=NULLPTR THEN                                         0803
         L     @06,GDTDBG(,@06)                                    0803
         LTR   @06,@06                                             0803
         BZ    @RT00803                                            0803
*     ;                                                            0804
*   ELSE                                                           0805
*     DO;                                                          0805
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   0806
*       DMPITMNM='DEFLIST';                                        0807
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0807
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       0807
*       DMPITMPT=ADDR(DEFLIST);                                    0808
         L     @06,DEFLSTP                                         0808
         ST    @06,DMPITMPT(,DMPINDEX)                             0808
*       DMPITMLN=LENGTH(DEFLIST);                                  0809
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       0809
*       DMPITMTP='H';                                              0810
         MVI   DMPITMTP(DMPINDEX),C'H'                             0810
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0811
*                                                                  0811
         LA    @06,16                                              0811
         ALR   DMPINDEX,@06                                        0811
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0812
*       DMPITMNM='DEFVE';                                          0812
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0812
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0812
         MVC   DMPITMNM(5,DMPINDEX),@CC01597                       0812
*       DMPITMPT=ADDR(DEFVE);                                      0813
         ST    DEFVEPTR,DMPITMPT(,DMPINDEX)                        0813
*       DMPITMLN=LENGTH(DEFVE);                                    0814
         MVC   DMPITMLN(2,DMPINDEX),@CH01674                       0814
*       DMPITMTP='H';                                              0815
         MVI   DMPITMTP(DMPINDEX),C'H'                             0815
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0816
*                                                                  0816
         ALR   DMPINDEX,@06                                        0816
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0817
*       DMPTRM=DMPTRMVL;                                           0817
         MVI   DMPTRM(DMPINDEX),X'FF'                              0817
*     END;                          /*                       @Y30LB32*/
*   IF GDTDBG=NULLPTR THEN                                         0819
@RT00803 L     @06,@PC00001                                        0819
         L     @06,GDTDBG(,@06)                                    0819
         LTR   @06,@06                                             0819
         BZ    @RT00819                                            0819
*     ;                                                            0820
*   ELSE                                                           0821
*     CALL IDCDB010(GDTTBL,'CVBC',ADDR(DUMPAREA));/*         @Y30LB32*/
         L     @06,@PC00001                                        0821
         ST    @06,@AL00001                                        0821
         LA    @05,@CC01598                                        0821
         ST    @05,@AL00001+4                                      0821
         LA    @05,DUMPAREA                                        0821
         ST    @05,@AFTEMPS+4                                      0821
         LA    @05,@AFTEMPS+4                                      0821
         ST    @05,@AL00001+8                                      0821
         MVI   @AL00001+8,X'80'                                    0821
         L     @15,GDTDBG(,@06)                                    0821
         LA    @01,@AL00001                                        0821
         BALR  @14,@15                                             0821
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);/*
*                                                            @Y30LB32*/
@RT00819 L     @06,@PC00001                                        0822
         ST    @06,@AL00001                                        0822
         LA    @05,DEFINE                                          0822
         ST    @05,@AL00001+4                                      0822
         LA    @05,DEFLSTP                                         0822
         ST    @05,@AL00001+8                                      0822
         LA    @05,REASONCD                                        0822
         ST    @05,@AL00001+12                                     0822
         LA    @05,ECBCODE                                         0822
         ST    @05,@AL00001+16                                     0822
         LA    @05,CMMSGPTR                                        0822
         ST    @05,@AL00001+20                                     0822
         MVI   @AL00001+20,X'80'                                   0822
         L     @15,GDTSSC(,@06)                                    0822
         LA    @01,@AL00001                                        0822
         BALR  @14,@15                                             0822
*   RESPECIFY                                                      0823
*     RTNREG RSTD;                                                 0823
*   TESTRC=RTNREG;                                                 0824
         LR    TESTRC,RTNREG                                       0824
*   RESPECIFY                                                      0825
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0825
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF CREATE FORM OF DEFINE MACRO WAS SUCCESSFUL   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0826
*   IF TESTRC=0TESTRC=12 THEN      /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0826
         BZ    @RT00826                                            0826
         C     TESTRC,@CF00606                                     0826
         BNE   @RF00826                                            0826
@RT00826 DS    0H                                                  0827
*     DO;                           /*                       @Y30LB32*/
*                                                                  0827
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF VOLUME INVENTORY WAS UPDATED             @Y30LB32*/
*       /* SUCCESSFULLY, IF NOT UPDATED SET ERROR FLAG       @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0828
*       IF TESTRC=12 THEN           /*                       @Y30LB32*/
         C     TESTRC,@CF00606                                     0828
         BNE   @RF00828                                            0828
*         VIERRFLG=ON;              /*                       @Y30LB32*/
*                                                                  0829
         OI    VIERRFLG,B'01000000'                                0829
*       /*************************************************************/
*       /*                                                           */
*       /* ACCESS CSN'S FROM MESSAGE AREA AND FREE UP        @Y30LB32*/
*       /* MESSAGE AREA OBTAINED BY USSC UMACRO              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0830
*       SAVECSN1=CMCSN1;            /*                       @Y30LB32*/
@RF00828 LA    @06,4                                               0830
         AL    @06,CMMSGPTR                                        0830
         MVC   SAVECSN1(12),CMCSN1(@06)                            0830
*       SAVECSN2=CMCSN2;            /*                       @Y30LB32*/
         MVC   SAVECSN2(12),CMCSN2(@06)                            0831
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB32*/
*                                                                  0832
         L     @06,@PC00001                                        0832
         ST    @06,@AL00001                                        0832
         LA    @05,CMMSGPTR                                        0832
         ST    @05,@AL00001+4                                      0832
         L     @15,GDTFSP(,@06)                                    0832
         LA    @01,@AL00001                                        0832
         BALR  @14,@15                                             0832
*       /*************************************************************/
*       /*                                                           */
*       /* RESET POINTER TO DEFLIST PARM AREA                @Y30LB32*/
*       /* THE DEFLIST IS REINITIALIZED AND USSC UMACRO      @Y30LB32*/
*       /* ISSUED TO INVOKE THE EXECUTE FORM OF ICBDEFV      @Y30LB32*/
*       /* MACRO TO ACTIVATE THE NEWLY CREATED VOLUME        @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0833
*       DEFLSTP=ADDR(PARMLST2);     /*                       @Y30LB32*/
         LA    @06,PARMLST2                                        0833
         ST    @06,DEFLSTP                                         0833
*       DEFVVFLG=''B;               /*                       @Y30LB32*/
         MVI   DEFVVFLG(@06),X'00'                                 0834
*       DEFVFLG=''B;                /*                       @Y30LB32*/
         MVI   DEFVFLG(@06),X'00'                                  0835
*       DEFVACT=ON;                 /*                       @Y30LB32*/
         OI    DEFVACT(@06),B'00000010'                            0836
*       DEFVCSN1=SAVECSN1;          /*                       @Y30LB32*/
         MVC   DEFVCSN1(12,@06),SAVECSN1                           0837
*       IF GDTDBG=NULLPTR THEN                                     0838
         L     @06,@PC00001                                        0838
         L     @06,GDTDBG(,@06)                                    0838
         LTR   @06,@06                                             0838
         BZ    @RT00838                                            0838
*         ;                                                        0839
*       ELSE                                                       0840
*         DO;                                                      0840
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   0841
*           DMPITMNM='DEFLIST';                                    0842
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0842
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       0842
*           DMPITMPT=ADDR(DEFLIST);                                0843
         L     @06,DEFLSTP                                         0843
         ST    @06,DMPITMPT(,DMPINDEX)                             0843
*           DMPITMLN=LENGTH(DEFLIST);                              0844
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       0844
*           DMPITMTP='H';                                          0845
         MVI   DMPITMTP(DMPINDEX),C'H'                             0845
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0846
*                                                                  0846
         AL    DMPINDEX,@CF00508                                   0846
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0847
*           DMPTRM=DMPTRMVL;                                       0847
         MVI   DMPTRM(DMPINDEX),X'FF'                              0847
*         END;                      /*                       @Y30LB32*/
*       IF GDTDBG=NULLPTR THEN                                     0849
@RT00838 L     @06,@PC00001                                        0849
         L     @06,GDTDBG(,@06)                                    0849
         LTR   @06,@06                                             0849
         BZ    @RT00849                                            0849
*         ;                                                        0850
*       ELSE                                                       0851
*         CALL IDCDB010(GDTTBL,'CVBA',ADDR(DUMPAREA));/*     @Y30LB32*/
         L     @06,@PC00001                                        0851
         ST    @06,@AL00001                                        0851
         LA    @05,@CC01599                                        0851
         ST    @05,@AL00001+4                                      0851
         LA    @05,DUMPAREA                                        0851
         ST    @05,@AFTEMPS+4                                      0851
         LA    @05,@AFTEMPS+4                                      0851
         ST    @05,@AL00001+8                                      0851
         MVI   @AL00001+8,X'80'                                    0851
         L     @15,GDTDBG(,@06)                                    0851
         LA    @01,@AL00001                                        0851
         BALR  @14,@15                                             0851
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);
@RT00849 L     @06,@PC00001                                        0852
         ST    @06,@AL00001                                        0852
         LA    @05,DEFINE                                          0852
         ST    @05,@AL00001+4                                      0852
         LA    @05,DEFLSTP                                         0852
         ST    @05,@AL00001+8                                      0852
         LA    @05,REASONCD                                        0852
         ST    @05,@AL00001+12                                     0852
         LA    @05,ECBCODE                                         0852
         ST    @05,@AL00001+16                                     0852
         LA    @05,CMMSGPTR                                        0852
         ST    @05,@AL00001+20                                     0852
         MVI   @AL00001+20,X'80'                                   0852
         L     @15,GDTSSC(,@06)                                    0852
         LA    @01,@AL00001                                        0852
         BALR  @14,@15                                             0852
*                                   /*                       @Y30LB32*/
*       RESPECIFY                                                  0853
*         RTNREG RSTD;                                             0853
*       TESTRC=RTNREG;                                             0854
         LR    TESTRC,RTNREG                                       0854
*       RESPECIFY                                                  0855
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  0855
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF ACTIVATE FORM OF DEFINE MACRO WAS        @Y30LB32*/
*       /* SUCCESSFUL, IF SUCCESSFUL FREE UP MESSAGE STORAGE @Y30LB32*/
*       /* AREA                                              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0856
*       IF TESTRC=0TESTRC=12 THEN  /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0856
         BZ    @RT00856                                            0856
         C     TESTRC,@CF00606                                     0856
         BNE   @RF00856                                            0856
@RT00856 DS    0H                                                  0857
*         DO;                       /*                       @Y30LB32*/
*           IF TESTRC=12 THEN       /*                       @Y30LB32*/
         C     TESTRC,@CF00606                                     0858
         BNE   @RF00858                                            0858
*             VIERRFLG=ON;          /*                       @Y30LB32*/
         OI    VIERRFLG,B'01000000'                                0859
*           CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                @Y30LB32*/
@RF00858 L     @06,@PC00001                                        0860
         ST    @06,@AL00001                                        0860
         LA    @05,CMMSGPTR                                        0860
         ST    @05,@AL00001+4                                      0860
         L     @15,GDTFSP(,@06)                                    0860
         LA    @01,@AL00001                                        0860
         BALR  @14,@15                                             0860
*         END;                      /*                       @Y30LB32*/
*                                                                  0861
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEFINE MACRO DID NOT ACTIVATE VOLUME           @Y30LB32*/
*       /* SUCCESSFULLY PROCESS ERROR CODE                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0862
*       ELSE                        /*                       @Y30LB32*/
*         DO;                       /*                       @Y30LB32*/
*                                                                  0862
         B     @RC00856                                            0862
@RF00856 DS    0H                                                  0863
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF USSC UMACRO COULD NOT OBTAIN         @Y30LB32*/
*           /* STORAGE FOR ECB/MESSAGE AREA                  @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0863
*           IF TESTRC^=8 THEN       /*                       @Y30LB32*/
         C     TESTRC,@CF00181                                     0863
         BE    @RF00863                                            0863
*             DO;                   /*                       @Y30LB32*/
*               CALL SSCMSG(REASONCD);/*                     @Y30LB32*/
         LA    @06,REASONCD                                        0865
         ST    @06,@AL00001                                        0865
         LA    @01,@AL00001                                        0865
         BAL   @14,SSCMSG                                          0865
*               CRACOND=LASTCC04;   /*                       @Y30LB32*/
*                                                                  0866
         LA    CRACOND,4                                           0866
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE MESSAGE IDC2075I STATING VOLUME     @Y30LB32*/
*               /* COULD NOT BE ACTIVATED                    @Y30LB32*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0867
*               PRINTTAB=''B;       /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0867
*               DARGSMOD=COMMSG;    /*                       @Y30LB32*/
         L     @06,DDSTRU                                          0868
         MVC   DARGSMOD(3,@06),@CC01460                            0868
*               DARGSENT=MSG2075I;  /*                       @Y30LB32*/
         MVI   DARGSENT(@06),X'1F'                                 0869
*               DARGDBP=ADDR(VOLSER);/*                      @Y30LB32*/
         LA    @05,VOLSER                                          0870
         ST    @05,DARGDBP(,@06)                                   0870
*               DARGILP=LENGTH(VOLSER);/*                    @Y30LB32*/
         MVC   DARGILP(2,@06),@CH00158                             0871
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/
*                                                                  0872
         L     @06,@PC00001                                        0872
         ST    @06,@AL00001                                        0872
         LA    @05,@CF00116                                        0872
         ST    @05,@AL00001+4                                      0872
         LA    @05,DDSTRU                                          0872
         ST    @05,@AL00001+8                                      0872
         MVI   @AL00001+8,X'80'                                    0872
         L     @15,GDTPRT(,@06)                                    0872
         LA    @01,@AL00001                                        0872
         BALR  @14,@15                                             0872
*               /*****************************************************/
*               /*                                                   */
*               /* RESET POINTER TO DEFLIST PARM AREA        @Y30LB32*/
*               /* INITIALIZE PARM LIST DEFLIST AND CALL SCRATCH     */
*               /*                                           @Y30LB32*/
*               /* ROUTINE TO SCRATCH PARTIALLY CREATED INACTIVE     */
*               /*                                           @Y30LB32*/
*               /* VOLUME                                    @Y30LB32*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0873
*               DEFLSTP=ADDR(PARMLST2);/*                    @Y30LB32*/
         LA    @06,PARMLST2                                        0873
         ST    @06,DEFLSTP                                         0873
*               DEFVFLG=''B;        /*                       @Y30LB32*/
         MVI   DEFVFLG(@06),X'00'                                  0874
*               DEFVELTR=ON;        /*                       @Y30LB32*/
         OI    DEFVELTR(@06),B'00001000'                           0875
*               CALL SCRATCH;       /*                       @Y30LB32*/
         BAL   @14,SCRATCH                                         0876
*               RESPECIFY                                          0877
*                 RTNREG RSTD;                                     0877
*               TESTRC=RTNREG;                                     0878
         LR    TESTRC,RTNREG                                       0878
*               RESPECIFY                                          0879
*                 RTNREG UNRSTD;    /*                       @Y30LB32*/
*               CRACOND=MAX(CRACOND,TESTRC);/*               @Y30LB32*/
         CR    CRACOND,TESTRC                                      0880
         BNL   *+6
         LR    CRACOND,TESTRC                                      0880
*             END;                  /*                       @Y30LB32*/
*                                                                  0881
*           /*********************************************************/
*           /*                                                       */
*           /* SET CONDITION CODE WITH ERROR CODE            @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0882
*           ELSE                    /*                       @Y30LB32*/
*             DO;                   /*                       @Y30LB32*/
         B     @RC00863                                            0882
@RF00863 DS    0H                                                  0883
*               CRACOND=LASTCC08;   /*                       @Y30LB32*/
*                                                                  0883
         LA    CRACOND,8                                           0883
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE MESSAGE IDC2075I STATING VOLUME     @Y30LB32*/
*               /* COULD NOT BE ACTIVATED                    @Y30LB32*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0884
*               PRINTTAB=''B;       /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               0884
*               DARGSMOD=COMMSG;    /*                       @Y30LB32*/
         L     @06,DDSTRU                                          0885
         MVC   DARGSMOD(3,@06),@CC01460                            0885
*               DARGSENT=MSG2075I;  /*                       @Y30LB32*/
         MVI   DARGSENT(@06),X'1F'                                 0886
*               DARGDBP=ADDR(VOLSER);/*                      @Y30LB32*/
         LA    @05,VOLSER                                          0887
         ST    @05,DARGDBP(,@06)                                   0887
*               DARGILP=LENGTH(VOLSER);/*                    @Y30LB32*/
         MVC   DARGILP(2,@06),@CH00158                             0888
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/
         L     @06,@PC00001                                        0889
         ST    @06,@AL00001                                        0889
         LA    @05,@CF00116                                        0889
         ST    @05,@AL00001+4                                      0889
         LA    @05,DDSTRU                                          0889
         ST    @05,@AL00001+8                                      0889
         MVI   @AL00001+8,X'80'                                    0889
         L     @15,GDTPRT(,@06)                                    0889
         LA    @01,@AL00001                                        0889
         BALR  @14,@15                                             0889
*             END;                  /*                       @Y30LB32*/
*         END;                      /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  0892
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DEFINE MACRO DID NOT CREATE A VOLUME               @Y30LB32*/
*   /* SUCCESSFULLY PROCESS ERROR CODE                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0893
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
*                                                                  0893
         B     @RC00826                                            0893
@RF00826 DS    0H                                                  0894
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF USSC UMACRO COULD NOT OBTAIN STORAGE     @Y30LB32*/
*       /* FOR ECB/MESSAGE AREA. IF FAILURE DUE TO           @Y30LB32*/
*       /* OTHER ERROR CALL SSCMSG TO WRITE ERROR MESSAGE    @Y30LB32*/
*       /* AND SET ERROR CODE                                @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0894
*       IF TESTRC^=8 THEN           /*                       @Y30LB32*/
         C     TESTRC,@CF00181                                     0894
         BE    @RF00894                                            0894
*         DO;                       /*                       @Y30LB32*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/
         LA    @06,REASONCD                                        0896
         ST    @06,@AL00001                                        0896
         LA    @01,@AL00001                                        0896
         BAL   @14,SSCMSG                                          0896
*           CRACOND=LASTCC04;       /*                       @Y30LB32*/
         LA    CRACOND,4                                           0897
*         END;                      /*                       @Y30LB32*/
*                                                                  0898
*       /*************************************************************/
*       /*                                                           */
*       /* SET CONDITION CODE WITH ERROR CODE                @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0899
*       ELSE                        /*                       @Y30LB32*/
*         CRACOND=LASTCC08;         /*                       @Y30LB32*/
*                                                                  0899
         B     @RC00894                                            0899
@RF00894 LA    CRACOND,8                                           0899
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE IDC2681I STATING VOLUME NOT         @Y30LB32*/
*       /* CREATED                                           @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0900
*       PRINTTAB=''B;               /*                       @Y30LB32*/
@RC00894 XC    PRINTTAB(36),PRINTTAB                               0900
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/
         L     @06,DDSTRU                                          0901
         MVC   DARGSMOD(3,@06),@CC01462                            0901
*       DARGSENT=MSG2681I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@06),X'02'                                 0902
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/
         LA    @05,VOLSER                                          0903
         ST    @05,DARGDBP(,@06)                                   0903
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@06),@CH00158                             0904
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @06,@PC00001                                        0905
         ST    @06,@AL00001                                        0905
         LA    @05,@CF00116                                        0905
         ST    @05,@AL00001+4                                      0905
         LA    @05,DDSTRU                                          0905
         ST    @05,@AL00001+8                                      0905
         MVI   @AL00001+8,X'80'                                    0905
         L     @15,GDTPRT(,@06)                                    0905
         LA    @01,@AL00001                                        0905
         BALR  @14,@15                                             0905
*     END;                          /*                       @Y30LB32*/
*                                                                  0906
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0907
*   REG14=RETADDR2;                 /*                       @Y30LB32*/
@RC00826 L     REG14,RETADDR2                                      0907
*   RETURN CODE(CRACOND);           /*                       @Y30LB32*/
         LR    @15,CRACOND                                         0908
@EL00010 DS    0H                                                  0908
@EF00010 DS    0H                                                  0908
@ER00010 BR    @14                                                 0908
*   END CREATACT;                   /*                       @Y30LB32*/
*                                                                  0910
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - UPDATE                                 @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - ROUTES CONTROL TO PROCEDURES WHICH           @Y30LB32*/
*/*             MOUNT, INITIALIZE, AND DEMOUNT NEW           @Y30LB32*/
*/*             VOLUME. ALSO INVOKES ROUTINE TO SCRATCH      @Y30LB32*/
*/*             PARTIALLY CREATED VOLUME FOR BACK OUT        @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - NONE                                            @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - VOLUME CREATED             @Y30LB32*/
*/*             RETURN CODE = 4 - MOUNT, INITIALIZATION, OR  @Y30LB32*/
*/*                               SCRATCHING OF VOL FAILED   @Y30LB32*/
*/*             RETURN CODE = 8 - DEMOUNT NOT SUCCESSFUL     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0910
*UPDATE:                                                           0910
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0910
UPDATE   DS    0H                                                  0911
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/
*   /* CODE TO ZERO                                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0911
*   RETADDR2=REG14;                 /*                       @Y30LB32*/
         ST    REG14,RETADDR2                                      0911
*   OLDERID2=NEWERID2;                                             0912
         L     @15,@PC00001                                        0912
         L     @15,GDTTR2(,@15)                                    0912
         MVC   @TS00001(95),NEWERID2(@15)                          0912
         MVC   OLDERID2(95,@15),@TS00001                           0912
*   NEWID2='CVUD';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@15),@CC01604                              0913
*   UPDCOND=0;                      /*                       @Y30LB32*/
*                                                                  0914
         SLR   UPDCOND,UPDCOND                                     0914
*   /*****************************************************************/
*   /*                                                               */
*   /* THE MNTPROC ROUTINE IS INVOKED TO MOUNT VOLUME        @Y30LB32*/
*   /* FOR INITIALIZING LABEL AND VTOC                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*   CALL MNTPROC;                   /*                       @Y30LB32*/
         BAL   @14,MNTPROC                                         0915
*   RESPECIFY                                                      0916
*     RTNREG RSTD;                                                 0916
*   TESTRC=RTNREG;                                                 0917
         LR    TESTRC,RTNREG                                       0917
*   RESPECIFY                                                      0918
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0918
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MNTPROC ROUTINE WAS SUCCESSFUL               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0919
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0919
         BNZ   @RF00919                                            0919
*     DO;                           /*                       @Y30LB32*/
*                                                                  0920
*       /*************************************************************/
*       /*                                                           */
*       /* THE INITPROC ROUTINE IS INVOKED TO INITIALIZE     @Y30LB32*/
*       /* VOLUME LABEL AND VTOC                             @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0921
*       CALL INITPROC;              /*                       @Y30LB32*/
         BAL   @14,INITPROC                                        0921
*       RESPECIFY                                                  0922
*         RTNREG RSTD;                                             0922
*       TESTRC=RTNREG;                                             0923
         LR    TESTRC,RTNREG                                       0923
*       RESPECIFY                                                  0924
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  0924
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF INITPROC ROUTINE WAS SUCCESSFUL, IF      @Y30LB32*/
*       /* UNSUCCESSFUL SET CONDITION CODE WITH ERROR CODE   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0925
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0925
         BZ    @RF00925                                            0925
*         UPDCOND=LASTCC04;         /*                       @Y30LB32*/
*                                                                  0926
         LA    UPDCOND,4                                           0926
*       /*************************************************************/
*       /*                                                           */
*       /* SET VOLUME CREATED INDICATOR FLAG BIT             @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0927
*       ELSE                        /*                       @Y30LB32*/
*         VCREATED=ON;              /*                       @Y30LB32*/
*                                                                  0927
         B     @RC00925                                            0927
@RF00925 OI    VCREATED,B'10000000'                                0927
*       /*************************************************************/
*       /*                                                           */
*       /* THE DMNTPROC ROUTINE IS INVOKED TO DEMOUNT        @Y30LB32*/
*       /* VOLUME                                            @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0928
*       CALL DMNTPROC;              /*                       @Y30LB32*/
@RC00925 BAL   @14,DMNTPROC                                        0928
*       RESPECIFY                                                  0929
*         RTNREG RSTD;                                             0929
*       TESTRC=RTNREG;                                             0930
         LR    TESTRC,RTNREG                                       0930
*       RESPECIFY                                                  0931
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  0931
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF DMNTPROC ROUTINE WAS SUCCESSFUL          @Y30LB32*/
*       /* IF UNSUCCESSFUL SET CONDITION CODE WITH ERROR     @Y30LB32*/
*       /* IF NOT ALREADY SET WITH ERROR CODE OF FOUR        @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0932
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0932
         BZ    @RF00932                                            0932
*         UPDCOND=LASTCC08;         /*                       @Y30LB32*/
         LA    UPDCOND,8                                           0933
*     END;                          /*                       @Y30LB32*/
*                                                                  0934
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MNTPROC WAS UNSUCCESSFUL SET CONDITION CODE WITH   @Y30LB32*/
*   /* ERROR CODE OF FOUR                                    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0935
*   ELSE                            /*                       @Y30LB32*/
*     UPDCOND=LASTCC04;             /*                       @Y30LB32*/
*                                                                  0935
         B     @RC00919                                            0935
@RF00919 LA    UPDCOND,4                                           0935
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK CONDITION CODE TO DETERMINE IF VOLUME           @Y30LB32*/
*   /* WAS ONLY PARTIALLY CREATED                            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0936
*   IF UPDCOND=4 THEN               /*                       @Y30LB32*/
@RC00919 C     UPDCOND,@CF00042                                    0936
         BNE   @RF00936                                            0936
*     DO;                           /*                       @Y30LB32*/
*                                                                  0937
*       /*************************************************************/
*       /*                                                           */
*       /* RESET POINTER TO DEFLIST PARM AREA                @Y30LB32*/
*       /* INITIALIZE PARM LIST DEFLIST TO SCRATCH A         @Y30LB32*/
*       /* PARTIALLY CREATED ACTIVE VOLUME AND THEN          @Y30LB32*/
*       /* CALL SCRATCH ROUTINE                              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0938
*       DEFLSTP=ADDR(PARMLST2);     /*                       @Y30LB32*/
         LA    @15,PARMLST2                                        0938
         ST    @15,DEFLSTP                                         0938
*       DEFVFLG=OFF;                /*                       @Y30LB32*/
         MVI   DEFVFLG(@15),B'00000000'                            0939
*       DEFVELM=ON;                 /*                       @Y30LB32*/
         OI    DEFVELM(@15),B'01000000'                            0940
*       CALL SCRATCH;               /*                       @Y30LB32*/
         BAL   @14,SCRATCH                                         0941
*       RESPECIFY                                                  0942
*         RTNREG RSTD;                                             0942
*       TESTRC=RTNREG;                                             0943
         LR    TESTRC,RTNREG                                       0943
*       RESPECIFY                                                  0944
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*       UPDCOND=MAX(UPDCOND,TESTRC);/*                       @Y30LB32*/
         CR    UPDCOND,TESTRC                                      0945
         BNL   *+6
         LR    UPDCOND,TESTRC                                      0945
*     END;                          /*                       @Y30LB32*/
*                                                                  0946
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0947
*   REG14=RETADDR2;                 /*                       @Y30LB32*/
@RF00936 L     REG14,RETADDR2                                      0947
*   RETURN CODE(UPDCOND);           /*                       @Y30LB32*/
         LR    @15,UPDCOND                                         0948
@EL00011 DS    0H                                                  0948
@EF00011 DS    0H                                                  0948
@ER00011 BR    @14                                                 0948
*   END UPDATE;                     /*                       @Y30LB32*/
*                                                                  0950
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - MNTPROC                                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - MOUNTS AND RESERVES VOLUME TO INITIALIZE     @Y30LB32*/
*/*             VOLUME WITH LABEL AND EMPTY VTOC             @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - DEFLIST, MDAGL                                  @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - VOLUME MOUNTED             @Y30LB32*/
*/*             RETURN CODE = 4 - VOLUME NOT MOUNTED         @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0950
*MNTPROC:                                                          0950
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0950
MNTPROC  DS    0H                                                  0951
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE CALLERS RETURN ADDRESS AND SET CONDITION CODE    @Y30LB32*/
*   /* TO ZERO AND RESET PTR TO DEFLIST PARM AREA            @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0951
*   RETADDR3=REG14;                 /*                       @Y30LB32*/
         LR    RETADDR3,REG14                                      0951
*   OLDERID2=NEWERID2;                                             0952
         L     @02,@PC00001                                        0952
         L     @15,GDTTR2(,@02)                                    0952
         MVC   @TS00001(95),NEWERID2(@15)                          0952
         MVC   OLDERID2(95,@15),@TS00001                           0952
*   NEWID2='CVMP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@15),@CC01611                              0953
*   MNTCOND=0;                      /*                       @Y30LB32*/
         SLR   MNTCOND,MNTCOND                                     0954
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/
*                                                                  0955
         LA    @15,PARMLST                                         0955
         ST    @15,DEFLSTP                                         0955
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS VOLUME SERIAL NUMBER FROM DEFLIST AND PLACE    @Y30LB32*/
*   /* IN MDAGL, SET FLAG FOR NEW VOLUME AND ZERO ENQ FLAG   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0956
*   MDLABEL=DEFVOLD;                /*                       @Y30LB32*/
         L     @14,MDAGLPTR                                        0956
         MVC   MDLABEL(6,@14),DEFVOLD(@15)                         0956
*   MDNEWVOL=ON;                    /*                       @Y30LB32*/
*   MDENQ=OFF;                      /*                       @Y30LB32*/
*                                                                  0958
         OI    MDNEWVOL(@14),B'10000000'                           0958
         NI    MDENQ(@14),B'11110111'                              0958
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT (MOUNT) TO MOUNT VOLUME                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0959
*   CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                     @Y30LB32*/
         ST    @02,@AL00001                                        0959
         LA    @15,MOUNT                                           0959
         ST    @15,@AL00001+4                                      0959
         ST    @14,@AL00001+8                                      0959
         MVI   @AL00001+8,X'80'                                    0959
         L     @15,GDTUNT(,@02)                                    0959
         LA    @01,@AL00001                                        0959
         BALR  @14,@15                                             0959
*   RESPECIFY                                                      0960
*     RTNREG RSTD;                                                 0960
*   TESTRC=RTNREG;                                                 0961
         LR    TESTRC,RTNREG                                       0961
*   RESPECIFY                                                      0962
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0962
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MOUNT WAS SUCCESSFUL. IF SUCCESSFUL ISSUE    @Y30LB32*/
*   /* URESERVE UMACRO TO GAIN EXCLUSIVE CONTROL OF VOLUME   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0963
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       0963
         BNZ   @RF00963                                            0963
*     DO;                           /*                       @Y30LB32*/
*       TYPENAME=RESERVE;           /*                       @Y30LB32*/
         MVC   TYPENAME(8),@CC01491                                0965
*       CALL IDCSARV0(GDTTBL,EXCL,WAIT,UCBPTR,SYSZAMS,RNAME);/*    0966
*                                                            @Y30LB32*/
         L     @15,@PC00001                                        0966
         ST    @15,@AL00001                                        0966
         LA    @14,EXCL                                            0966
         ST    @14,@AL00001+4                                      0966
         LA    @14,WAIT                                            0966
         ST    @14,@AL00001+8                                      0966
         LA    @14,UCBPTR                                          0966
         ST    @14,@AL00001+12                                     0966
         LA    @14,@CC01493                                        0966
         ST    @14,@AL00001+16                                     0966
         LA    @14,RNAME                                           0966
         ST    @14,@AL00001+20                                     0966
         MVI   @AL00001+20,X'80'                                   0966
         L     @15,GDTRSV(,@15)                                    0966
         LA    @01,@AL00001                                        0966
         BALR  @14,@15                                             0966
*     END;                          /*                       @Y30LB32*/
*                                                                  0967
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE WITH ERROR CODE                    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0968
*   ELSE                            /*                       @Y30LB32*/
*     MNTCOND=LASTCC04;             /*                       @Y30LB32*/
*                                                                  0968
         B     @RC00963                                            0968
@RF00963 LA    MNTCOND,4                                           0968
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN TO          @Y30LB32*/
*   /* CALLER                                                @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0969
*   REG14=RETADDR3;                 /*                       @Y30LB32*/
@RC00963 LR    REG14,RETADDR3                                      0969
*   RETURN CODE(MNTCOND);           /*                       @Y30LB32*/
         LR    @15,MNTCOND                                         0970
@EL00012 DS    0H                                                  0970
@EF00012 DS    0H                                                  0970
@ER00012 BR    @14                                                 0970
*   END MNTPROC;                    /*                       @Y30LB32*/
*                                                                  0972
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - INITPROC                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - UPDATES NEW VOLUME WITH LABEL AND            @Y30LB32*/
*/*             VTOC. MODIFIES VOLUME RECORD TO TURN THE     @Y30LB32*/
*/*             INCOMPLETE CREATE FLAG OFF. WRITES MESSAGE   @Y30LB32*/
*/*             IDC2684I IF VOLUME IS NOT INITIALIZED AND    @Y30LB32*/
*/*             MESSAGE IDC2688I IF INCOMPLETE CREATE FLAG   @Y30LB32*/
*/*             IS NOT TURNED OFF. ISSUES UEXCP TO CLOSE DCB.@Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - VS2AGL, MVR, DEFLIST                            @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - NEW VOLUME INITIALIZED     @Y30LB32*/
*/*             RETURN CODE = 4 - NEW VOLUME NOT INITIALIZED @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  0972
*INITPROC:                                                         0972
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  0972
INITPROC DS    0H                                                  0973
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0973
*   RETADDR3=REG14;                 /*                       @Y30LB32*/
         LR    RETADDR3,REG14                                      0973
*   OLDERID2=NEWERID2;                                             0974
         L     @02,@PC00001                                        0974
         L     @15,GDTTR2(,@02)                                    0974
         MVC   @TS00001(95),NEWERID2(@15)                          0974
         MVC   OLDERID2(95,@15),@TS00001                           0974
*   NEWID2='CVIP';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@15),@CC01615                              0975
*   INITCOND=0;                     /*                       @Y30LB32*/
         SLR   INITCOND,INITCOND                                   0976
*   IOCTLBKP=NULLPTR;               /*                       @Y30LB32*/
*                                                                  0977
         SLR   @15,@15                                             0977
         ST    @15,IOCTLBKP                                        0977
*   /*****************************************************************/
*   /*                                                               */
*   /* THE INITVOL SERVICE ROUTINE IS INVOKED TO INITIALIZE  @Y30LB32*/
*   /* NEW VOLUME WITH VOLUME LABEL AND VTOC                 @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0978
*   CALL IDCSACL0(GDTTBL,'IDCVS02 ',INITVOL,VS2AGL);/*       @Y30LB32*/
         ST    @02,@AL00001                                        0978
         LA    @15,@CC01616                                        0978
         ST    @15,@AL00001+4                                      0978
         LA    @15,INITVOL                                         0978
         ST    @15,@AL00001+8                                      0978
         L     @01,VSAGLPTR                                        0978
         ST    @01,@AL00001+12                                     0978
         MVI   @AL00001+12,X'80'                                   0978
         L     @15,GDTCAL(,@02)                                    0978
         LA    @01,@AL00001                                        0978
         BALR  @14,@15                                             0978
*   RESPECIFY                                                      0979
*     RTNREG RSTD;                                                 0979
*   TESTRC=RTNREG;                                                 0980
         LR    TESTRC,RTNREG                                       0980
*   RESPECIFY                                                      0981
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  0981
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF INITVOL WAS SUCCESSFUL                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0982
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/
         SLR   @02,@02                                             0982
         CR    TESTRC,@02                                          0982
         BNE   @RF00982                                            0982
*     DO;                           /*                       @Y30LB32*/
*                                                                  0983
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE PARM LIST MVR AND ISSUE MSVC MACRO     @Y30LB32*/
*       /* TO RESET INCOMPLETE VOLUME CREATION FLAG          @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0984
*       MVRBVOL=VOLSER;             /*                       @Y30LB32*/
         L     @03,MVRPTR                                          0984
         MVC   MVRBVOL(6,@03),VOLSER                               0984
*       MVRFLBAS=ON;                /*                       @Y30LB32*/
*                                                                  0985
         OI    MVRFLBAS(@03),B'00100000'                           0985
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC UMACRO TO INVOKE EXECUTE FORM OF       @Y30LB32*/
*       /* MSVC MODIFY VOLUME RECORD MACRO                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0986
*       IF GDTDBG=NULLPTR THEN                                     0986
         L     @03,@PC00001                                        0986
         C     @02,GDTDBG(,@03)                                    0986
         BE    @RT00986                                            0986
*         ;                                                        0987
*       ELSE                                                       0988
*         DO;                                                      0988
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   0989
*           DMPITMNM='MVR';                                        0990
         MVI   DMPITMNM+3(DMPINDEX),C' '                           0990
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         0990
         MVC   DMPITMNM(3,DMPINDEX),@CC01617                       0990
*           DMPITMPT=ADDR(MVR);                                    0991
         L     @03,MVRPTR                                          0991
         ST    @03,DMPITMPT(,DMPINDEX)                             0991
*           DMPITMLN=LENGTH(MVR);                                  0992
         MVC   DMPITMLN(2,DMPINDEX),@CH01680                       0992
*           DMPITMTP='H';                                          0993
         MVI   DMPITMTP(DMPINDEX),C'H'                             0993
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0994
*                                                                  0994
         AL    DMPINDEX,@CF00508                                   0994
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0995
*           DMPTRM=DMPTRMVL;                                       0995
         MVI   DMPTRM(DMPINDEX),X'FF'                              0995
*         END;                      /*                       @Y30LB32*/
*       IF GDTDBG=NULLPTR THEN                                     0997
@RT00986 L     @15,@PC00001                                        0997
         L     @15,GDTDBG(,@15)                                    0997
         LTR   @15,@15                                             0997
         BZ    @RT00997                                            0997
*         ;                                                        0998
*       ELSE                                                       0999
*         CALL IDCDB010(GDTTBL,'CVMR',ADDR(DUMPAREA));/*     @Y30LB32*/
         L     @15,@PC00001                                        0999
         ST    @15,@AL00001                                        0999
         LA    @14,@CC01618                                        0999
         ST    @14,@AL00001+4                                      0999
         LA    @14,DUMPAREA                                        0999
         ST    @14,@AFTEMPS+8                                      0999
         LA    @14,@AFTEMPS+8                                      0999
         ST    @14,@AL00001+8                                      0999
         MVI   @AL00001+8,X'80'                                    0999
         L     @15,GDTDBG(,@15)                                    0999
         LA    @01,@AL00001                                        0999
         BALR  @14,@15                                             0999
*       CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASONCD);/*        @Y30LB32*/
@RT00997 L     @02,@PC00001                                        1000
         ST    @02,@AL00001                                        1000
         LA    @15,VVIC                                            1000
         ST    @15,@AL00001+4                                      1000
         LA    @15,MVRPTR                                          1000
         ST    @15,@AL00001+8                                      1000
         LA    @15,REASONCD                                        1000
         ST    @15,@AL00001+12                                     1000
         MVI   @AL00001+12,X'80'                                   1000
         L     @15,GDTSSC(,@02)                                    1000
         LA    @01,@AL00001                                        1000
         BALR  @14,@15                                             1000
*       RESPECIFY                                                  1001
*         RTNREG RSTD;                                             1001
*       TESTRC=RTNREG;                                             1002
         LR    TESTRC,RTNREG                                       1002
*       RESPECIFY                                                  1003
*         RTNREG UNRSTD;            /*                       @Y30LB32*/
*                                                                  1003
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF MODIFY WAS SUCCESSFUL. IF NOT            @Y30LB32*/
*       /* SUCCESSFUL INVOKE SSCMSG SUBROUTINE TO            @Y30LB32*/
*       /* WRITE MESSAGE EXPLAINING REASON FOR FAILURE       @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1004
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       1004
         BZ    @RF01004                                            1004
*         DO;                       /*                       @Y30LB32*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/
*                                                                  1006
         LA    @04,REASONCD                                        1006
         ST    @04,@AL00001                                        1006
         LA    @01,@AL00001                                        1006
         BAL   @14,SSCMSG                                          1006
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE SECONDARY MESSAGE IDC2688I STATING      @Y30LB32*/
*           /* INCOMPLETE VOLUME CREATION FLAG NOT RESET     @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1007
*           PRINTTAB=''B;           /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               1007
*           DARGSMOD=CRVMSG;        /*                       @Y30LB32*/
         L     @15,DDSTRU                                          1008
         MVC   DARGSMOD(3,@15),@CC01462                            1008
*           DARGSENT=MSG2688I;      /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'09'                                 1009
*           DARGDBP=ADDR(VOLSER);   /*                       @Y30LB32*/
         LA    @14,VOLSER                                          1010
         ST    @14,DARGDBP(,@15)                                   1010
*           DARGILP=LENGTH(VOLSER); /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00158                             1011
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB32*/
*                                                                  1012
         L     @15,@PC00001                                        1012
         ST    @15,@AL00001                                        1012
         LA    @14,@CF00116                                        1012
         ST    @14,@AL00001+4                                      1012
         LA    @14,DDSTRU                                          1012
         ST    @14,@AL00001+8                                      1012
         MVI   @AL00001+8,X'80'                                    1012
         L     @15,GDTPRT(,@15)                                    1012
         LA    @01,@AL00001                                        1012
         BALR  @14,@15                                             1012
*           /*********************************************************/
*           /*                                                       */
*           /* SET CONDITION CODE WITH ERROR CODE            @Y30LB32*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1013
*           INITCOND=LASTCC04;      /*                       @Y30LB32*/
         LA    INITCOND,4                                          1013
*         END;                      /*                       @Y30LB32*/
*     END;                          /*                       @Y30LB32*/
*                                                                  1015
*   /*****************************************************************/
*   /*                                                               */
*   /* IF INITVOL ROUTINE WAS NOT SUCCESSFUL, WRITE          @Y30LB32*/
*   /* MESSAGE IDC2684I STATING VOLUME NOT INITIALIZED       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1016
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC00982                                            1016
@RF00982 DS    0H                                                  1017
*       PRINTTAB=''B;               /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               1017
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/
         L     @15,DDSTRU                                          1018
         MVC   DARGSMOD(3,@15),@CC01462                            1018
*       DARGSENT=MSG2684I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'05'                                 1019
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/
         LA    @14,VOLSER                                          1020
         ST    @14,DARGDBP(,@15)                                   1020
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00158                             1021
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
*                                                                  1022
         L     @15,@PC00001                                        1022
         ST    @15,@AL00001                                        1022
         LA    @14,@CF00116                                        1022
         ST    @14,@AL00001+4                                      1022
         LA    @14,DDSTRU                                          1022
         ST    @14,@AL00001+8                                      1022
         MVI   @AL00001+8,X'80'                                    1022
         L     @15,GDTPRT(,@15)                                    1022
         LA    @01,@AL00001                                        1022
         BALR  @14,@15                                             1022
*       /*************************************************************/
*       /*                                                           */
*       /* SET CONDITION CODE WITH ERROR CODE                @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1023
*       INITCOND=LASTCC04;          /*                       @Y30LB32*/
         LA    INITCOND,4                                          1023
*     END;                          /*                       @Y30LB32*/
*                                                                  1024
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK POINTER TO IO CONTROL BLOCK. IF NON             @Y30LB32*/
*   /* ZERO ISSUE UEXCP (CLOSE) TO CLOSE DCB                 @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1025
*   IF IOCTLBKP^=NULLPTR THEN       /*                       @Y30LB32*/
@RC00982 L     @15,IOCTLBKP                                        1025
         LTR   @15,@15                                             1025
         BZ    @RF01025                                            1025
*     DO;                           /*                       @Y30LB32*/
*       CALL IDCIO050(GDTTBL,CLOSE,IOCTLBKP);/*              @Y30LB32*/
         L     @15,@PC00001                                        1027
         ST    @15,@AL00001                                        1027
         LA    @14,CLOSE                                           1027
         ST    @14,@AL00001+4                                      1027
         LA    @14,IOCTLBKP                                        1027
         ST    @14,@AL00001+8                                      1027
         MVI   @AL00001+8,X'80'                                    1027
         L     @15,GDTEXP(,@15)                                    1027
         LA    @01,@AL00001                                        1027
         BALR  @14,@15                                             1027
*     END;                          /*                       @Y30LB32*/
*                                                                  1028
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB32*/
*   /* TO THE CALLER                                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1029
*   REG14=RETADDR3;                 /*                       @Y30LB32*/
@RF01025 LR    REG14,RETADDR3                                      1029
*   RETURN CODE(INITCOND);          /*                       @Y30LB32*/
         LR    @15,INITCOND                                        1030
@EL00013 DS    0H                                                  1030
@EF00013 DS    0H                                                  1030
@ER00013 BR    @14                                                 1030
*   END INITPROC;                   /*                       @Y30LB32*/
*                                                                  1032
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - DMNTPROC                               @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - DEMOUNTS NEWLY CREATED VOLUME AND ISSUES     @Y30LB32*/
*/*             UDEQ TO RELEASE CONTROL GAINED WITH URESERVE @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CKAGL                                           @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - NEW VOLUME DEMOUNTED       @Y30LB32*/
*/*             RETURN CODE = 4 - NEW VOLUME NOT DEMOUNTED   @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  1032
*DMNTPROC:                                                         1032
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  1032
DMNTPROC DS    0H                                                  1033
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1033
*   RETADDR3=REG14;                 /*                       @Y30LB32*/
         LR    RETADDR3,REG14                                      1033
*   OLDERID2=NEWERID2;                                             1034
         L     @02,@PC00001                                        1034
         L     @15,GDTTR2(,@02)                                    1034
         MVC   @TS00001(95),NEWERID2(@15)                          1034
         MVC   OLDERID2(95,@15),@TS00001                           1034
*   NEWID2='CVDM';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@15),@CC01622                              1035
*   DMNTCOND=0;                     /*                       @Y30LB32*/
*                                                                  1036
         SLR   DMNTCOND,DMNTCOND                                   1036
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UDEQ UMACRO TO RELEASE CONTROL OF VOLUME        @ZA05122*/
*   /* GAINED WITH RESERVE                                   @ZA05122*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1037
*   TYPENAME=RESERVE;               /*                       @ZA05119*/
         MVC   TYPENAME(8),@CC01491                                1037
*   CALL IDCSADQ0(GDTTBL,SYSZAMS,RNAME);/*                   @ZA05122*/
*                                                                  1038
         ST    @02,@AL00001                                        1038
         LA    @15,@CC01493                                        1038
         ST    @15,@AL00001+4                                      1038
         LA    @15,RNAME                                           1038
         ST    @15,@AL00001+8                                      1038
         MVI   @AL00001+8,X'80'                                    1038
         L     @15,GDTDEQ(,@02)                                    1038
         LA    @01,@AL00001                                        1038
         BALR  @14,@15                                             1038
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET MDNEWVOL FLAG TO ZERO DURING DEMOUNT.           @YD00175*/
*   /* SET MDDEQ FLAG TO CAUSE DEQUEUE OF VOLSER             @YD00175*/
*   /* SINCE THIS IS THE FINAL DEMOUNT.                      @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1039
*   MDWAIT=ON;                      /*                       @ZM04313*/
*   MDDEQ=ON;                       /*                       @YD00175*/
*   MDNEWVOL=OFF;                   /*                       #Y30LB32*/
*                                                                  1041
         L     @02,MDAGLPTR                                        1041
         OI    MDWAIT(@02),B'00010100'                             1041
         NI    MDNEWVOL(@02),B'01111111'                           1041
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE DEMOUNT VERSION OF UMSSUNIT UMACRO TO DEMOUNT   #Y30LB32*/
*   /* VOLUME                                                #Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1042
*   CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*                   #Y30LB32*/
         L     @15,@PC00001                                        1042
         ST    @15,@AL00001                                        1042
         LA    @14,DEMOUNT                                         1042
         ST    @14,@AL00001+4                                      1042
         ST    @02,@AL00001+8                                      1042
         MVI   @AL00001+8,X'80'                                    1042
         L     @15,GDTUNT(,@15)                                    1042
         LA    @01,@AL00001                                        1042
         BALR  @14,@15                                             1042
*   RESPECIFY                                                      1043
*     RTNREG RSTD;                                                 1043
*   TESTRC=RTNREG;                                                 1044
         LR    TESTRC,RTNREG                                       1044
*   RESPECIFY                                                      1045
*     RTNREG UNRSTD;                /*                       #Y30LB32*/
*                                                                  1045
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DEMOUNT WAS SUCCESSFUL. IF NOT SUCCESSFUL    #Y30LB32*/
*   /* SET CONDITION CODE WITH ERROR CODE                    #Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1046
*   IF TESTRC^=0 THEN               /*                       #Y30LB32*/
         LTR   TESTRC,TESTRC                                       1046
         BZ    @RF01046                                            1046
*     DMNTCOND=LASTCC04;            /*                       #Y30LB32*/
*                                                                  1047
         LA    DMNTCOND,4                                          1047
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN TO THE      #Y30LB32*/
*   /* CALLER                                                #Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   REG14=RETADDR3;                 /*                       #Y30LB32*/
@RF01046 LR    REG14,RETADDR3                                      1048
*   RETURN CODE(DMNTCOND);          /*                       #Y30LB32*/
         LR    @15,DMNTCOND                                        1049
@EL00014 DS    0H                                                  1049
@EF00014 DS    0H                                                  1049
@ER00014 BR    @14                                                 1049
*   END DMNTPROC;                   /*                       #Y30LB32*/
*                                                                  1051
*/********************************************************************/
*/*                                                          #Y30LB32*/
*/*  PROCEDURE NAME - ROPROC                                 #Y30LB32*/
*/*                                                          #Y30LB32*/
*/*  FUNCTION - SETS READWRITE ATTRIBUTE TO READONLY. ISSUES #Y30LB32*/
*/*             MESSAGE IDC2091I IF READONLY FLAG IS NOT SET #Y30LB32*/
*/*                                                          #Y30LB32*/
*/*  INPUT - DEFLIST                                         #Y30LB32*/
*/*                                                          #Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     #Y30LB32*/
*/*             RETURN CODE = 0 - READWRITE FLAG RESET       #Y30LB32*/
*/*             RETURN CODE = 4 - READWRITE FLAG NOT RESET   #Y30LB32*/
*/*                                                          #Y30LB32*/
*/********************************************************************/
*                                                                  1051
*ROPROC:                                                           1051
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB32*/
*                                                                  1051
ROPROC   DS    0H                                                  1052
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  #Y30LB32*/
*   /* TO ZERO                                               #Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1052
*   RETADDR2=REG14;                 /*                       #Y30LB32*/
         ST    REG14,RETADDR2                                      1052
*   OLDERID2=NEWERID2;                                             1053
         L     @06,@PC00001                                        1053
         L     @05,GDTTR2(,@06)                                    1053
         MVC   @TS00001(95),NEWERID2(@05)                          1053
         MVC   OLDERID2(95,@05),@TS00001                           1053
*   NEWID2='CVRO';                  /*                       #Y30LB32*/
         MVC   NEWID2(4,@05),@CC01626                              1054
*   ROCOND=0;                       /*                       #Y30LB32*/
*                                                                  1055
         SLR   ROCOND,ROCOND                                       1055
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO FLAG BYTE AND SET FLAG BITS IN DEFLIST TO CHANGE #Y30LB32*/
*   /* VOLUME STATUS FROM READWRITE TO READONLY              #Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1056
*   DEFLSTP=ADDR(PARMLST2);         /*                       #Y30LB32*/
         LA    @05,PARMLST2                                        1056
         ST    @05,DEFLSTP                                         1056
*   DEFVFLG=''B;                    /*                       #Y30LB32*/
         MVI   DEFVFLG(@05),X'00'                                  1057
*   DEFVREP=ON;                     /*                       #Y30LB32*/
         OI    DEFVREP(@05),B'00010000'                            1058
*   DEFVVFLG=SAVFLAG;               /*                       #Y30LB32*/
         IC    @15,SAVFLAG                                         1059
         STC   @15,DEFVVFLG(,@05)                                  1059
*   DEFVWINH=ON;                    /*                       #Y30LB32*/
*                                                                  1060
         OI    DEFVWINH(@05),B'00000010'                           1060
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC UMACRO TO INVOKE EXECUTE FORM OF ICBDEFV   @Y30LB32*/
*   /* MACRO TO REPLACE ATTRIBUTE FLAG                       @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1061
*   IF GDTDBG=NULLPTR THEN                                         1061
         L     @06,GDTDBG(,@06)                                    1061
         LTR   @06,@06                                             1061
         BZ    @RT01061                                            1061
*     ;                                                            1062
*   ELSE                                                           1063
*     DO;                                                          1063
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   1064
*       DMPITMNM='DEFLIST';                                        1065
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1065
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       1065
*       DMPITMPT=ADDR(DEFLIST);                                    1066
         L     @06,DEFLSTP                                         1066
         ST    @06,DMPITMPT(,DMPINDEX)                             1066
*       DMPITMLN=LENGTH(DEFLIST);                                  1067
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       1067
*       DMPITMTP='H';                                              1068
         MVI   DMPITMTP(DMPINDEX),C'H'                             1068
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1069
*                                                                  1069
         AL    DMPINDEX,@CF00508                                   1069
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1070
*       DMPTRM=DMPTRMVL;                                           1070
         MVI   DMPTRM(DMPINDEX),X'FF'                              1070
*     END;                          /*                       @Y30LB32*/
*   IF GDTDBG=NULLPTR THEN                                         1072
@RT01061 L     @06,@PC00001                                        1072
         L     @06,GDTDBG(,@06)                                    1072
         LTR   @06,@06                                             1072
         BZ    @RT01072                                            1072
*     ;                                                            1073
*   ELSE                                                           1074
*     CALL IDCDB010(GDTTBL,'CVMW',ADDR(DUMPAREA));/*         @Y30LB32*/
         L     @06,@PC00001                                        1074
         ST    @06,@AL00001                                        1074
         LA    @05,@CC01627                                        1074
         ST    @05,@AL00001+4                                      1074
         LA    @05,DUMPAREA                                        1074
         ST    @05,@AFTEMPS+12                                     1074
         LA    @05,@AFTEMPS+12                                     1074
         ST    @05,@AL00001+8                                      1074
         MVI   @AL00001+8,X'80'                                    1074
         L     @15,GDTDBG(,@06)                                    1074
         LA    @01,@AL00001                                        1074
         BALR  @14,@15                                             1074
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);/*
*                                                            @Y30LB32*/
@RT01072 L     @06,@PC00001                                        1075
         ST    @06,@AL00001                                        1075
         LA    @05,DEFINE                                          1075
         ST    @05,@AL00001+4                                      1075
         LA    @05,DEFLSTP                                         1075
         ST    @05,@AL00001+8                                      1075
         LA    @05,REASONCD                                        1075
         ST    @05,@AL00001+12                                     1075
         LA    @05,ECBCODE                                         1075
         ST    @05,@AL00001+16                                     1075
         LA    @05,CMMSGPTR                                        1075
         ST    @05,@AL00001+20                                     1075
         MVI   @AL00001+20,X'80'                                   1075
         L     @15,GDTSSC(,@06)                                    1075
         LA    @01,@AL00001                                        1075
         BALR  @14,@15                                             1075
*   RESPECIFY                                                      1076
*     RTNREG RSTD;                                                 1076
*   TESTRC=RTNREG;                                                 1077
         LR    TESTRC,RTNREG                                       1077
*   RESPECIFY                                                      1078
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  1078
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DEFINE MACRO WAS SUCCESSFUL. IF SUCCESSFUL   @Y30LB32*/
*   /* CHECK IF VOLUME INVENTORY WAS UPDATED SUCCESSFULLY    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1079
*   IF TESTRC=0TESTRC=12 THEN      /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       1079
         BZ    @RT01079                                            1079
         C     TESTRC,@CF00606                                     1079
         BNE   @RF01079                                            1079
@RT01079 DS    0H                                                  1080
*     DO;                           /*                       @Y30LB32*/
*       IF TESTRC=12 THEN           /*                       @Y30LB32*/
         C     TESTRC,@CF00606                                     1081
         BNE   @RF01081                                            1081
*         VIERRFLG=ON;              /*                       @Y30LB32*/
*                                                                  1082
         OI    VIERRFLG,B'01000000'                                1082
*       /*************************************************************/
*       /*                                                           */
*       /* FREE STORAGE OBTAINED BY USSC UMACFO FOR ECB AND  @Y30LB32*/
*       /* MESSAGE AREA                                      @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1083
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB32*/
@RF01081 L     @06,@PC00001                                        1083
         ST    @06,@AL00001                                        1083
         LA    @05,CMMSGPTR                                        1083
         ST    @05,@AL00001+4                                      1083
         L     @15,GDTFSP(,@06)                                    1083
         LA    @01,@AL00001                                        1083
         BALR  @14,@15                                             1083
*     END;                          /*                       @Y30LB32*/
*                                                                  1085
*   /*****************************************************************/
*   /*                                                               */
*   /* DEFINE MACRO WAS UNSUCCESSFUL, PROCESS ERROR CODE     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1085
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
*                                                                  1085
         B     @RC01079                                            1085
@RF01079 DS    0H                                                  1086
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF USSC COULD NOT OBTAIN STORAGE FOR        @Y30LB32*/
*       /* MESSAGE AREA. IF ERROR DUE TO SOME OTHER PROBLEM  @Y30LB32*/
*       /* INVOKE SSCMSG SUBROUTINE TO WRITE ERROR MESSAGE   @Y30LB32*/
*       /* AND SET ERROR CODE                                @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1086
*       IF TESTRC^=8 THEN           /*                       @Y30LB32*/
         C     TESTRC,@CF00181                                     1086
         BE    @RF01086                                            1086
*         DO;                       /*                       @Y30LB32*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/
         LA    @06,REASONCD                                        1088
         ST    @06,@AL00001                                        1088
         LA    @01,@AL00001                                        1088
         BAL   @14,SSCMSG                                          1088
*           ROCOND=LASTCC04;        /*                       @Y30LB32*/
         LA    ROCOND,4                                            1089
*         END;                      /*                       @Y30LB32*/
*                                                                  1090
*       /*************************************************************/
*       /*                                                           */
*       /* SET ERROR CODE INDICATING NO STORAGE OBTAINED     @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1091
*       ELSE                        /*                       @Y30LB32*/
*         ROCOND=LASTCC08;          /*                       @Y30LB32*/
*                                                                  1091
         B     @RC01086                                            1091
@RF01086 LA    ROCOND,8                                            1091
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE IDC3091I STATING READONLY FLAG NOT  @Y30LB32*/
*       /* SET AS REQUIRED                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1092
*       PRINTTAB=''B;               /*                       @Y30LB32*/
@RC01086 XC    PRINTTAB(36),PRINTTAB                               1092
*       DARGSMOD=COMMSG;            /*                       @Y30LB32*/
         L     @06,DDSTRU                                          1093
         MVC   DARGSMOD(3,@06),@CC01460                            1093
*       DARGSENT=MSG2091I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@06),X'0F'                                 1094
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/
         LA    @05,VOLSER                                          1095
         ST    @05,DARGDBP(,@06)                                   1095
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@06),@CH00158                             1096
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @06,@PC00001                                        1097
         ST    @06,@AL00001                                        1097
         LA    @05,@CF00116                                        1097
         ST    @05,@AL00001+4                                      1097
         LA    @05,DDSTRU                                          1097
         ST    @05,@AL00001+8                                      1097
         MVI   @AL00001+8,X'80'                                    1097
         L     @15,GDTPRT(,@06)                                    1097
         LA    @01,@AL00001                                        1097
         BALR  @14,@15                                             1097
*     END;                          /*                       @Y30LB32*/
*                                                                  1098
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN TO CALLER   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1099
*   REG14=RETADDR2;                 /*                       @Y30LB32*/
@RC01079 L     REG14,RETADDR2                                      1099
*   RETURN CODE(ROCOND);            /*                       @Y30LB32*/
         LR    @15,ROCOND                                          1100
@EL00015 DS    0H                                                  1100
@EF00015 DS    0H                                                  1100
@ER00015 BR    @14                                                 1100
*   END ROPROC;                     /*                       @Y30LB32*/
*                                                                  1102
*/********************************************************************/
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - SCRATCH                                @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - SCRATCHES PARTIALLY CREATED VOLUMES FOR BACK @Y30LB32*/
*/*             OUT. ISSUES MESSAGE IDC0686I IF VOLUME WAS   @Y30LB32*/
*/*             SCRATCHED ISSUES MESSAGE IDC2687I IF VOLUME  @Y30LB32*/
*/*             WAS NOT SCRATCHED                            @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - DEFLIST                                         @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/
*/*             RETURN CODE = 0 - PARTIALLY CREATED VOLUME   @Y30LB32*/
*/*                               SCRATCHED                  @Y30LB32*/
*/*             RETURN CODE = 4 - PARTIALLY CREATED VOLUME   @Y30LB32*/
*/*                               NOT SCRATCHED              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  1102
*SCRATCH:                                                          1102
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/
*                                                                  1102
SCRATCH  DS    0H                                                  1103
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/
*   /* TO ZERO                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1103
*   RETADDR3=REG14;                 /*                       @Y30LB32*/
         LR    RETADDR3,REG14                                      1103
*   OLDERID2=NEWERID2;                                             1104
         L     @15,@PC00001                                        1104
         L     @14,GDTTR2(,@15)                                    1104
         MVC   @TS00001(95),NEWERID2(@14)                          1104
         MVC   OLDERID2(95,@14),@TS00001                           1104
*   NEWID2='CVSC';                  /*                       @Y30LB32*/
         MVC   NEWID2(4,@14),@CC01631                              1105
*   SCRCOND=0;                      /*                       @Y30LB32*/
*                                                                  1106
         SLR   @14,@14                                             1106
         STH   @14,SCRCOND                                         1106
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC UMACRO TO INVOKE THE EXECUTE FORM OF THE   @Y30LB32*/
*   /* ICBDEFV MACRO TO SCRATCH PARTIALLY CREATED VOLUME     @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1107
*   IF GDTDBG=NULLPTR THEN                                         1107
         C     @14,GDTDBG(,@15)                                    1107
         BE    @RT01107                                            1107
*     ;                                                            1108
*   ELSE                                                           1109
*     DO;                                                          1109
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/
         LA    DMPINDEX,DUMPAREA                                   1110
*       DMPITMNM='DEFLIST';                                        1111
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1111
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       1111
*       DMPITMPT=ADDR(DEFLIST);                                    1112
         L     @03,DEFLSTP                                         1112
         ST    @03,DMPITMPT(,DMPINDEX)                             1112
*       DMPITMLN=LENGTH(DEFLIST);                                  1113
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       1113
*       DMPITMTP='H';                                              1114
         MVI   DMPITMTP(DMPINDEX),C'H'                             1114
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1115
*                                                                  1115
         AL    DMPINDEX,@CF00508                                   1115
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1116
*       DMPTRM=DMPTRMVL;                                           1116
         MVI   DMPTRM(DMPINDEX),X'FF'                              1116
*     END;                          /*                       @Y30LB32*/
*   IF GDTDBG=NULLPTR THEN                                         1118
@RT01107 L     @15,@PC00001                                        1118
         L     @15,GDTDBG(,@15)                                    1118
         LTR   @15,@15                                             1118
         BZ    @RT01118                                            1118
*     ;                                                            1119
*   ELSE                                                           1120
*     CALL IDCDB010(GDTTBL,'CVSR',ADDR(DUMPAREA));/*         @Y30LB32*/
         L     @15,@PC00001                                        1120
         ST    @15,@AL00001                                        1120
         LA    @14,@CC01632                                        1120
         ST    @14,@AL00001+4                                      1120
         LA    @14,DUMPAREA                                        1120
         ST    @14,@AFTEMPS+16                                     1120
         LA    @14,@AFTEMPS+16                                     1120
         ST    @14,@AL00001+8                                      1120
         MVI   @AL00001+8,X'80'                                    1120
         L     @15,GDTDBG(,@15)                                    1120
         LA    @01,@AL00001                                        1120
         BALR  @14,@15                                             1120
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);/*
*                                                            @Y30LB32*/
@RT01118 L     @02,@PC00001                                        1121
         ST    @02,@AL00001                                        1121
         LA    @15,DEFINE                                          1121
         ST    @15,@AL00001+4                                      1121
         LA    @15,DEFLSTP                                         1121
         ST    @15,@AL00001+8                                      1121
         LA    @15,REASONCD                                        1121
         ST    @15,@AL00001+12                                     1121
         LA    @15,ECBCODE                                         1121
         ST    @15,@AL00001+16                                     1121
         LA    @15,CMMSGPTR                                        1121
         ST    @15,@AL00001+20                                     1121
         MVI   @AL00001+20,X'80'                                   1121
         L     @15,GDTSSC(,@02)                                    1121
         LA    @01,@AL00001                                        1121
         BALR  @14,@15                                             1121
*   RESPECIFY                                                      1122
*     RTNREG RSTD;                                                 1122
*   TESTRC=RTNREG;                                                 1123
         LR    TESTRC,RTNREG                                       1123
*   RESPECIFY                                                      1124
*     RTNREG UNRSTD;                /*                       @Y30LB32*/
*                                                                  1125
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DEFINE MACRO WAS SUCCESSFUL                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1125
*   IF TESTRC=0TESTRC=12 THEN      /*                       @Y30LB32*/
         LTR   TESTRC,TESTRC                                       1125
         BZ    @RT01125                                            1125
         C     TESTRC,@CF00606                                     1125
         BNE   @RF01125                                            1125
@RT01125 DS    0H                                                  1126
*     DO;                           /*                       @Y30LB32*/
*                                                                  1126
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE IDC0686I STATING PARTIALLY CREATED  @Y30LB32*/
*       /* VOLUME WAS SCRATCHED                              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1127
*       PRINTTAB=''B;               /*                       @Y30LB32*/
         XC    PRINTTAB(36),PRINTTAB                               1127
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/
         L     @15,DDSTRU                                          1128
         MVC   DARGSMOD(3,@15),@CC01462                            1128
*       DARGSENT=MSG0686I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'07'                                 1129
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/
         LA    @14,VOLSER                                          1130
         ST    @14,DARGDBP(,@15)                                   1130
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00158                             1131
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
*                                                                  1132
         L     @15,@PC00001                                        1132
         ST    @15,@AL00001                                        1132
         LA    @14,@CF00116                                        1132
         ST    @14,@AL00001+4                                      1132
         LA    @14,DDSTRU                                          1132
         ST    @14,@AL00001+8                                      1132
         MVI   @AL00001+8,X'80'                                    1132
         L     @15,GDTPRT(,@15)                                    1132
         LA    @01,@AL00001                                        1132
         BALR  @14,@15                                             1132
*       /*************************************************************/
*       /*                                                           */
*       /* FREE STORAGE OBTAINED BY USSC UMACRO FOR ECB AND  @Y30LB32*/
*       /* MESSAGE AREA                                      @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1133
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB32*/
         L     @15,@PC00001                                        1133
         ST    @15,@AL00001                                        1133
         LA    @14,CMMSGPTR                                        1133
         ST    @14,@AL00001+4                                      1133
         L     @15,GDTFSP(,@15)                                    1133
         LA    @01,@AL00001                                        1133
         BALR  @14,@15                                             1133
*     END;                          /*                       @Y30LB32*/
*                                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DEFINE MACRO WAS UNSUCCESSFUL, PROCESS ERROR CODE  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
*                                                                  1135
         B     @RC01125                                            1135
@RF01125 DS    0H                                                  1136
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF USSC UMACRO COULD NOT OBTAIN STORAGE     @Y30LB32*/
*       /* FOR MESSAGE AREA                                  @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1136
*       IF TESTRC^=8 THEN           /*                       @Y30LB32*/
         C     TESTRC,@CF00181                                     1136
         BE    @RF01136                                            1136
*         DO;                       /*                       @Y30LB32*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/
         LA    @15,REASONCD                                        1138
         ST    @15,@AL00001                                        1138
         LA    @01,@AL00001                                        1138
         BAL   @14,SSCMSG                                          1138
*           SCRCOND=LASTCC04;       /*                       @Y30LB32*/
         MVC   SCRCOND(2),@CH00042                                 1139
*         END;                      /*                       @Y30LB32*/
*                                                                  1140
*       /*************************************************************/
*       /*                                                           */
*       /* SET ERROR CODE INDICATING STORAGE NOT OBTAINED    @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1141
*       ELSE                        /*                       @Y30LB32*/
*         SCRCOND=LASTCC08;         /*                       @Y30LB32*/
*                                                                  1141
         B     @RC01136                                            1141
@RF01136 MVC   SCRCOND(2),@CH00181                                 1141
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE IDC2687I STATING PARTIALLY CREATED  @Y30LB32*/
*       /* VOLUME NOT SCRATCHED                              @Y30LB32*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1142
*       PRINTTAB=''B;               /*                       @Y30LB32*/
@RC01136 XC    PRINTTAB(36),PRINTTAB                               1142
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/
         L     @15,DDSTRU                                          1143
         MVC   DARGSMOD(3,@15),@CC01462                            1143
*       DARGSENT=MSG2687I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@15),X'08'                                 1144
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/
         LA    @14,VOLSER                                          1145
         ST    @14,DARGDBP(,@15)                                   1145
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/
         MVC   DARGILP(2,@15),@CH00158                             1146
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @15,@PC00001                                        1147
         ST    @15,@AL00001                                        1147
         LA    @14,@CF00116                                        1147
         ST    @14,@AL00001+4                                      1147
         LA    @14,DDSTRU                                          1147
         ST    @14,@AL00001+8                                      1147
         MVI   @AL00001+8,X'80'                                    1147
         L     @15,GDTPRT(,@15)                                    1147
         LA    @01,@AL00001                                        1147
         BALR  @14,@15                                             1147
*     END;                          /*                       @Y30LB32*/
*                                                                  1148
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1149
*   REG14=RETADDR3;                 /*                       @Y30LB32*/
@RC01125 LR    REG14,RETADDR3                                      1149
*   RETURN CODE(SCRCOND);           /*                       @Y30LB32*/
         LH    @15,SCRCOND                                         1150
@EL00016 DS    0H                                                  1150
@EF00016 DS    0H                                                  1150
@ER00016 BR    @14                                                 1150
*   END SCRATCH;                    /*                       @Y30LB32*/
*                                                                  1152
*/****************************************************************** */
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/
*/*             CHARACTER                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  1152
*CKCSNLEN:                          /*                       @Y30LB32*/
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/
*                                                                  1152
CKCSNLEN MVC   @PC00017(8),0(@01)                                  1152
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   DCL                                                            1153
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/
*   DCL                                                            1154
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/
*   DCL                                                            1155
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/
*   DCL                                                            1156
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/
*   DCL                                                            1157
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/
*   DCL                                                            1158
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/
*   DCL                                                            1159
*     CKCOND FIXED(15);                                            1159
*                                                                  1159
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1160
*   DCL                                                            1160
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32
*                                      CSN                   @Y30LB32*/
*   DCL                                                            1161
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32
*                                      OF CSN AGAINST        @Y30LB32*/
*   DCL                                                            1162
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/
*   DCL                                                            1163
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/
*                                                                  1164
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1164
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/
         ST    REG14,CKRETPTR                                      1164
*   OLDERID2=NEWERID2;                                             1165
         L     @02,@PC00001                                        1165
         L     @02,GDTTR2(,@02)                                    1165
         MVC   @TS00001(95),NEWERID2(@02)                          1165
         MVC   OLDERID2(95,@02),@TS00001                           1165
*   NEWID2='CKLN';                  /*                       @Y30LB32*/
*                                                                  1166
         MVC   NEWID2(4,@02),@CC01650                              1166
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1167
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/
         L     @02,DDSTRU                                          1167
         ST    @02,CKSAVPTR                                        1167
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/
         LA    @02,CKPRTTAB                                        1168
         ST    @02,DDSTRU                                          1168
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/
         XC    CKPRTTAB(20),CKPRTTAB                               1169
*   CKCOND=''B;                     /*                       @Y30LB32*/
*                                                                  1170
         SLR   CKCOND,CKCOND                                       1170
*   /*****************************************************************/
*   /*                                                               */
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/
*   /* OR MORE                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1171
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/
*                                                                  1171
         L     @02,@PC00017+4                                      1171
         CLI   CKLENGTH(@02),11                                    1171
         BL    @RF01171                                            1171
*     /***************************************************************/
*     /*                                                             */
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/
*     /* CHARACTER                                           @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1172
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/
         CLI   CKLENGTH(@02),11                                    1172
         BNE   @RF01172                                            1172
*       DO;                         /*                       @Y30LB32*/
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/
         MVI   CKCSNADJ+3,C' '                                     1174
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/
         L     @02,@PC00017                                        1175
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@02)                       1175
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/
         MVC   CKCSNVAL+3(9,@02),CKCSNADJ+3                        1176
*       END;                        /*                       @Y30LB32*/
*     ELSE                                                         1178
*       ;                           /*                       @Y30LB32*/
*                                                                  1178
@RF01172 DS    0H                                                  1179
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1179
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC01171                                            1179
@RF01171 DS    0H                                                  1180
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/
         L     @02,DDSTRU                                          1180
         MVC   DARGSMOD(3,@02),@CC01460                            1180
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@02),X'01'                                 1181
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/
         L     @15,@PC00017                                        1182
         ST    @15,DARGDBP(,@02)                                   1182
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/
         MVC   DARGILP(2,@02),@CH00606                             1183
*       DARGRETP=''B;               /*                       @Y30LB32*/
         SLR   @15,@15                                             1184
         ST    @15,DARGRETP(,@02)                                  1184
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @02,@PC00001                                        1185
         ST    @02,@AL00001                                        1185
         LA    @15,@CF00116                                        1185
         ST    @15,@AL00001+4                                      1185
         LA    @15,DDSTRU                                          1185
         ST    @15,@AL00001+8                                      1185
         MVI   @AL00001+8,X'80'                                    1185
         L     @15,GDTPRT(,@02)                                    1185
         LA    @01,@AL00001                                        1185
         BALR  @14,@15                                             1185
*       CKCOND=4;                   /*                       @Y30LB32*/
         LA    CKCOND,4                                            1186
*     END;                          /*                       @Y30LB32*/
*                                                                  1187
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1188
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/
@RC01171 L     @02,CKSAVPTR                                        1188
         ST    @02,DDSTRU                                          1188
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/
         L     REG14,CKRETPTR                                      1189
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/
         LR    @15,CKCOND                                          1190
@EL00017 DS    0H                                                  1190
@EF00017 DS    0H                                                  1190
@ER00017 BR    @14                                                 1190
*   END CKCSNLEN;                   /*                       @Y30LB32*/
*                                                                  1192
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1192
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1192
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00018                                    1192
         MVC   @PC00018(8),0(@01)                                  1192
*                                   /*                       @Y30LB39*/
*                                                                  1193
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1193
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*                                   /*                       @Y30LB39*/
*   DCL                                                            1193
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1194
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1194
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1195
*                                   /*                       @Y30LB39*/
*   DCL                                                            1195
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1196
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1196
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1197
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1197
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1197
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1198
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1198
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1198
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1199
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1199
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1199
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1200
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1200
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1200
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1201
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1201
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1202
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1202
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1202
         L     @08,@PC00001                                        1202
         L     @15,GDTTR2(,@08)                                    1202
         MVC   @TS00001(95),NEWERID2(@15)                          1202
         MVC   OLDERID2(95,@15),@TS00001                           1202
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1203
         MVC   NEWID2(4,@15),@CC01671                              1203
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1204
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1204
         LA    @15,SSDRGLT                                         1204
         ST    @15,SSDLPTR                                         1204
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1205
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1205
         L     @14,@PC00018                                        1205
         L     @14,SSRCODE(,@14)                                   1205
         LTR   @14,@14                                             1205
         BNP   @RF01205                                            1205
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1206
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1207
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1207
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1208
         ST    @03,DARGRETP(,@15)                                  1208
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),SSMODSS0                            1209
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 1210
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1211
         MVC   DARGRETL(2,@15),@CH01681                            1211
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1212
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1212
         ST    @08,@AL00001                                        1212
         LA    @03,@CF00116                                        1212
         ST    @03,@AL00001+4                                      1212
         LA    @03,SSDLPTR                                         1212
         ST    @03,@AL00001+8                                      1212
         MVI   @AL00001+8,X'80'                                    1212
         L     @15,GDTPRT(,@08)                                    1212
         LA    @01,@AL00001                                        1212
         BALR  @14,@15                                             1212
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1213
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1213
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)SSARRAY(ENTRYNUM)=0);   1214
@DL01214 DS    0H                                                  1215
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         LA    ENTRYNUM,1(,ENTRYNUM)                               1215
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1216
@DE01214 L     @08,@PC00018                                        1216
         LR    @03,ENTRYNUM                                        1216
         ALR   @03,@03                                             1216
         LH    @03,SSARRAY-2(@03)                                  1216
         CH    @03,SSRHALF(,@08)                                   1216
         BE    @DC01214                                            1216
         LTR   @03,@03                                             1216
         BNZ   @DL01214                                            1216
@DC01214 DS    0H                                                  1217
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1217
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1217
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @08,SSDLPTR                                         1218
         MVC   DARGSMOD(3,@08),SSMODSS0                            1218
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@08)                             1219
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         LR    @03,ENTRYNUM                                        1220
         ALR   @03,@03                                             1220
         LH    @03,SSARRAY-2(@03)                                  1220
         LTR   @03,@03                                             1220
         BNZ   @RF01220                                            1220
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         L     @15,@PC00018                                        1222
         ST    @15,DARGDBP(,@08)                                   1222
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@08),@CH00042                             1223
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1226
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1226
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01205                                            1226
@RF01205 DS    0H                                                  1227
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1227
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @08,SSDLPTR                                         1228
         MVC   DARGSMOD(3,@08),SSMODCM0                            1228
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         IC    @15,SSMSGNUM                                        1229
         STC   @15,DARGSENT(,@08)                                  1229
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @15,@PC00018+4                                      1230
         ST    @15,DARGDBP(,@08)                                   1230
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@08),@CH00221                             1231
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1232
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1233
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1233
@RC01205 L     @08,@PC00001                                        1233
         ST    @08,@AL00001                                        1233
         LA    @15,@CF00116                                        1233
         ST    @15,@AL00001+4                                      1233
         LA    @15,SSDLPTR                                         1233
         ST    @15,@AL00001+8                                      1233
         MVI   @AL00001+8,X'80'                                    1233
         L     @15,GDTPRT(,@08)                                    1233
         LA    @01,@AL00001                                        1233
         BALR  @14,@15                                             1233
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1234
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1234
         L     @14,@SA00018                                        1234
         LM    @00,@12,@SA00018+8                                  1234
         BR    @14                                                 1234
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCCV01                     /*                       @Y30LB32*/
*                                                                  1236
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSCV )                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  1236
*       ;                                                          1236
@DATA    DS    0H
@CH00649 DC    H'14'
@CH01674 DC    H'64'
@CH01676 DC    H'68'
@CH01680 DC    H'88'
@CH01681 DC    H'120'
@CH01679 DC    H'132'
@CH01675 DC    H'164'
@SM01692 MVC   0(0,@04),VOLVAL-1(@14)
@SM01695 MVC   0(0,@01),0(@14)
         DS    0F
@AL00690 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01493)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00018 DS    15F
@PC00018 DS    2F
@PC00017 DS    2F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    5F
IDCCV01  CSECT
         DS    0F
@CF00116 DC    F'0'
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00155 DC    F'2'
@CH00155 EQU   @CF00155+2
@CF00042 DC    F'4'
@CH00042 EQU   @CF00042+2
@CF00158 DC    F'6'
@CH00158 EQU   @CF00158+2
@CF00181 DC    F'8'
@CH00181 EQU   @CF00181+2
@CF00478 DC    F'10'
@CF00606 DC    F'12'
@CH00606 EQU   @CF00606+2
@CF00508 DC    F'16'
@CF01699 DC    F'-12'
@CF01698 DC    F'-11'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RVVIPTR  DS    A
MVRPTR   DS    A
DEFLSTP  DS    A
VOLCRCNT DS    F
REASONCD DS    F
RETADDR1 DS    A
RETADDR2 DS    A
MDAGLPTR DS    A
VSAGLPTR DS    A
UCBPTR   DS    A
IOCTLBKP DS    A
LOOPCNT  DS    F
SAVBINNO DS    F
CKRETPTR DS    A
CKSAVPTR DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
GRPCOND  DS    H
SCRCOND  DS    H
SETRC    DS    H
SAVFLAG  DS    FL1
ECBCODE  DS    FL1
CHARNUM  DS    FL1
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
CRVFLGS  DS    BL2
         ORG   CRVFLGS
CREATFLG DS    BL1
RONLYFLG EQU   CRVFLGS+0
BNDNBND  EQU   CRVFLGS+0
EXCLSHRD EQU   CRVFLGS+0
DERASNDE EQU   CRVFLGS+0
RONLYRW  EQU   CRVFLGS+0
ROFAIL   EQU   CRVFLGS+0
@NM00119 EQU   CRVFLGS+0
VCREATED DS    BL1
VIERRFLG EQU   CRVFLGS+1
         ORG   CRVFLGS+2
DUMPAREA DS    CL33
SAVECSN1 DS    CL12
SAVECSN2 DS    CL12
PARMLST  DS    CL132
DEFLSTEX DS    CL64
PARMLST2 DS    CL132
         DS    CL2
PRINTTAB DS    CL36
BUFFER   DS    CL164
MVRLST   DS    CL88
RVVILST  DS    CL68
VS2AGLST DS    CL52
MDAGLLST DS    CL37
CKAGLLST DS    CL29
         DS    CL2
EXCLLST  DS    CL23
RNAME    DS    CL23
         ORG   RNAME
RNAMELN  DS    FL1
VOLSER   DS    CL6
VIRTNAME DS    CL8
TYPENAME DS    CL8
         ORG   RNAME+23
CSNVAL   DS    CL12
NUMBER   DS    CL1
VOLCHAR  DS    CL1
         DS    CL4
NUMERICS DS    CL6
         DS    CL2
PACKEDNO DS    CL6
CKCSNADJ DS    CL12
         DS    CL2
CKPRTTAB DS    CL20
SSDRGLT  DS    CL20
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCCV01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
MVRLEN   DC    AL2(88)
DEFLEN   DC    AL2(64)
SSMSGNUM DC    AL1(56)
@CC01487 DC    C'.VIRTUAL'
@CC01489 DC    C'.ENQUEUE'
@CC01491 DC    C'.RESERVE'
@CC01493 DC    C'SYSZAMS '
@CC01616 DC    C'IDCVS02 '
@CC01596 DC    C'DEFLIST'
@CC01597 DC    C'DEFVE'
@CC01528 DC    C'CVCR'
@CC01529 DC    C'CVCV'
@CC01543 DC    C'CVRP'
@CC01547 DC    C'CVGP'
@CC01552 DC    C'CVAT'
@CC01556 DC    C'DVGN'
@CC01557 DC    C'RVVI'
@CC01559 DC    C'CVBV'
@CC01564 DC    C'CVCK'
@CC01571 DC    C'CVNC'
@CC01575 DC    C'CVAC'
@CC01579 DC    C'CVCL'
@CC01590 DC    C'CVCP'
@CC01595 DC    C'CVCA'
@CC01598 DC    C'CVBC'
@CC01599 DC    C'CVBA'
@CC01604 DC    C'CVUD'
@CC01611 DC    C'CVMP'
@CC01615 DC    C'CVIP'
@CC01618 DC    C'CVMR'
@CC01622 DC    C'CVDM'
@CC01626 DC    C'CVRO'
@CC01627 DC    C'CVMW'
@CC01631 DC    C'CVSC'
@CC01632 DC    C'CVSR'
@CC01650 DC    C'CKLN'
@CC01671 DC    C'SSAA'
@CC01458 DC    C'UV0'
@CC01460 DC    C'CM0'
@CC01462 DC    C'CV0'
@CC01617 DC    C'MVR'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODIFYC  DC    CL8'MODIFYC '
MODID    DC    CL4'CV01'
FIXAREA  DS    CL400
         ORG   FIXAREA
@NM00120 DC    400X'00'
         ORG   FIXAREA+400
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
MAXNUM   DC    XL4'9'
         DC    XL4'63'
         DC    XL4'3E7'
         DC    XL4'2705'
         DC    XL4'1869F'
         DC    XL4'F423F'
NUMTBL   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
CKCOND   EQU   @03
BINARYNO EQU   @02
VOLSERCK EQU   @02
NUMCNT   EQU   @03
CSNNUM   EQU   @04
CKAGLPTR EQU   @06
RETADDR3 EQU   @05
RETADDR  EQU   @07
CKVCOND  EQU   @05
ROCOND   EQU   @04
DMNTCOND EQU   @04
INITCOND EQU   @04
MNTCOND  EQU   @04
UPDCOND  EQU   @06
CRACOND  EQU   @04
CARTCOND EQU   @05
CRVCOND  EQU   @07
ACCCOND  EQU   @03
NUMCOND  EQU   @04
GENCOND  EQU   @05
ATTRCOND EQU   @03
CSNCNT   EQU   @06
DEFVEPTR EQU   @08
GROUPPTR EQU   @04
DMPINDEX EQU   @02
TESTRC   EQU   @03
REG11    EQU   @11
REG12    EQU   @12
REG9     EQU   @09
RTNREG   EQU   @15
REG14    EQU   @14
DEFVR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSARV0 EQU   0
IDCSADQ0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
RACFAGL  EQU   0
RACFFLG1 EQU   RACFAGL
RACFFLG2 EQU   RACFAGL+1
RACFFLG3 EQU   RACFAGL+2
RACFFLG4 EQU   RACFAGL+3
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00017 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CMCSN1   EQU   CMMSG+16
CMCSN2   EQU   CMMSG+28
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDNEWVOL EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSUCBPTR EQU   VS2AGL+8
VSVTOCSZ EQU   VS2AGL+12
VSOWNPTR EQU   VS2AGL+16
VSVOLPTR EQU   VS2AGL+20
VSIOBKPT EQU   VS2AGL+24
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VSDDNAME EQU   VS2AGL+37
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00073 EQU   SV82LIST+4
SV82DCBP EQU   @NM00073
@NM00074 EQU   SV82LIST+12
SV82WRKP EQU   @NM00074
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
VOL      EQU   0
VOLVAL   EQU   VOL+1
FILE     EQU   0
FILEVAL  EQU   FILE+1
COUNT    EQU   0
COUNTVAL EQU   COUNT
MSF      EQU   0
MSFVAL   EQU   MSF
VTSZ     EQU   0
VTSZVAL  EQU   VTSZ
CART     EQU   0
CARTCNT  EQU   CART
@NM00093 EQU   CART+2
CARTLEN  EQU   @NM00093
CARTVAL  EQU   @NM00093+1
OWNER    EQU   0
OWNERVAL EQU   OWNER+1
DESCR    EQU   0
DESCRVAL EQU   DESCR+1
BKUP#    EQU   0
BKUP#VAL EQU   BKUP#
GRP      EQU   0
GRPVAL   EQU   GRP+1
RSTR     EQU   0
BIND     EQU   0
NBIND    EQU   0
EXCLU    EQU   0
SHRD     EQU   0
RONLY    EQU   0
RW       EQU   0
DERAS    EQU   0
NDERS    EQU   0
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVGROUP EQU   RVVI+14
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVGRPRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSGRP  EQU   RVVSPEC
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVROPCD  EQU   MVRCODE
MVRFLAGA EQU   MVR+8
MVRFLBAS EQU   MVRFLAGA
MVRCIVCF EQU   MVRFLAGA+2
MVRBVOL  EQU   MVR+12
GROUP    EQU   0
GRONAME  EQU   GROUP
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROBIND  EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GROERRTS EQU   GROUP+56
DEFLIST  EQU   0
DEFVFLG  EQU   DEFLIST+6
DEFVCR   EQU   DEFVFLG
DEFVELM  EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVACT  EQU   DEFVFLG
DEFVLIB  EQU   DEFLIST+7
DEFVOLD  EQU   DEFLIST+8
DEFVVFLG EQU   DEFLIST+14
DEFVSEC  EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVCSN1 EQU   DEFLIST+24
DEFVCSN2 EQU   DEFLIST+36
DEFVDATA EQU   DEFLIST+56
DEFOWNID EQU   DEFVDATA+29
DEFTLAB  EQU   DEFVDATA+71
DEFVVEXT EQU   DEFLIST+128
DEFVE    EQU   0
DEFLNGTH EQU   DEFVE
DEFGROUP EQU   DEFVE+4
DEFDESCR EQU   DEFVE+12
DEFBKUPN EQU   DEFVE+48
DEFFLAGA EQU   DEFVE+55
DEFPGRO  EQU   DEFFLAGA
DEFPDESC EQU   DEFFLAGA
DEFPBKUP EQU   DEFFLAGA
DEFFLAGB EQU   DEFVE+56
DEFSETFL EQU   DEFFLAGB
DEFSRCVY EQU   DEFSETFL
DEFRECFL EQU   DEFFLAGB+1
DEFCREAT EQU   DEFRECFL
DEFTYPFL EQU   DEFFLAGB+2
DEFGENUS EQU   DEFTYPFL
DEFRSTD  EQU   DEFTYPFL
DEFNULFL EQU   DEFFLAGB+3
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
GENRL    EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARK0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
GDTRCK   EQU   GDTTBL+284
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
CKCSNVAL EQU   0
CKLENGTH EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00121 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00118 EQU   DEFVE+60
@NM00117 EQU   DEFNULFL
DEFNEXPD EQU   DEFNULFL
DEFNDESC EQU   DEFNULFL
DEFNGRP  EQU   DEFNULFL
@NM00116 EQU   DEFTYPFL
DEFCOPY  EQU   DEFTYPFL
DEFDUP   EQU   DEFTYPFL
@NM00115 EQU   DEFRECFL
DEFLAMIS EQU   DEFRECFL
DEFICOPY EQU   DEFRECFL
@NM00114 EQU   DEFSETFL
DEFCRCVY EQU   DEFSETFL
@NM00113 EQU   DEFFLAGA
DEFPTO   EQU   DEFFLAGA
DEFPVLAB EQU   DEFFLAGA
DEFPFOR  EQU   DEFFLAGA
DEFLABEL EQU   DEFVE+49
DEFFOR   EQU   DEFVE+46
DEFTO    EQU   DEFVE+42
DEFR60   EQU   DEFVDATA+43
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   DEFLIST+52
DEFVASID EQU   DEFLIST+50
@NM00112 EQU   DEFLIST+48
@NM00111 EQU   DEFLIST+22
DEFVNVOL EQU   DEFLIST+16
@NM00110 EQU   DEFLIST+15
@NM00109 EQU   DEFVVFLG
@NM00108 EQU   DEFVVFLG
@NM00107 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00106 EQU   DEFVLIB
DEFVDACT EQU   DEFVFLG
DEFVRNTR EQU   DEFVFLG
DEFVRNM  EQU   DEFVFLG
@NM00105 EQU   DEFLIST+5
DEFVOPCD EQU   DEFLIST+4
DEFVLEN  EQU   DEFLIST
@NM00104 EQU   GROUP+136
GROADDR  EQU   GROUP+106
GROOWNER EQU   GROUP+96
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GRORETPD EQU   GROUP+52
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GROSTRSH EQU   GROUP+40
GROSSPD  EQU   GROUP+38
GROPSPD  EQU   GROUP+36
GRONINAC EQU   GROUP+34
GRONRSTD EQU   GROUP+32
GRONGEN  EQU   GROUP+30
GROPCENT EQU   GROUP+29
GROLSN   EQU   GROUP+23
GROFSN   EQU   GROUP+17
@NM00103 EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROVVGRP EQU   GRONAME+3
GROG     EQU   GRONAME
@NM00102 EQU   MVR+82
MVRLABEL EQU   MVR+76
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRCSN   EQU   MVR+62
MVRTO    EQU   MVR+58
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00101 EQU   MVRFLAGA+2
MVRCICPY EQU   MVRFLAGA+2
MVRCLMIS EQU   MVRFLAGA+1
MVRSLMIS EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLLAB EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00100 EQU   MVRCODE+1
@NM00099 EQU   RVVI+64
RVVSVOL  EQU   RVVSPEC
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
@NM00098 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVBVRCD EQU   RVVRDRCD
@NM00097 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00096 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00095 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVOLUME EQU   RVVI+8
@NM00094 EQU   RVVOPCOD+1
GRPLEN   EQU   GRP
DESCRLEN EQU   DESCR
OWNERLEN EQU   OWNER
FILELEN  EQU   FILE
VOLLEN   EQU   VOL
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00092 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00091 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00090 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00089 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00088 EQU   VSDSCR+5
@NM00087 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
@NM00086 EQU   VSDSTAT+29
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00085 EQU   VSDFLG2
VSDRACF  EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00084 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00083 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00082 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00081 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00080 EQU   VSDVTOC
@NM00079 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00078 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00077 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00076 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00075 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00072 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00071 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00070 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00069 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00068 EQU   RCTAGL+10
@NM00067 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00066 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00065 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00064 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00063 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00062 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00061 EQU   VS2AGL+45
@NM00060 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00059 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00058 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00057 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00056 EQU   EXSPACE+8
@NM00055 EQU   EXSPACE+6
@NM00054 EQU   EXSPACE+4
@NM00053 EQU   EXSPACE+1
@NM00052 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00051 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00050 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00049 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00048 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00047 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLHEAD EQU   EXCLAGL
@NM00046 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00045 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDPUAGL  EQU   MDAGL+20
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00044 EQU   CTMSG
CMNUMCRT EQU   CMMSG+15
@NM00043 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00042 EQU   CMMSG+7
@NM00041 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00040 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00039 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00038 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00037 EQU   DMPITM+15
@NM00036 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00035 EQU   ERCNVTAB+4
@NM00034 EQU   ERCNVTAB+3
@NM00033 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00032 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00031 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00030 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00029 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00028 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00027 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00026 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00025 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00024 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00023 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00022 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00021 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00020 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00019 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00018 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00017+1
UNITCHA  EQU   @NM00017
UNITUCB  EQU   UNITABL
RACFVOLS EQU   RACFAGL+16
RACFCLN  EQU   RACFAGL+12
RACFPROF EQU   RACFAGL+8
RACFENT  EQU   RACFAGL+4
@NM00016 EQU   RACFFLG4
@NM00015 EQU   RACFFLG3
RACFPRF  EQU   RACFFLG3
@NM00014 EQU   RACFFLG3
@NM00013 EQU   RACFFLG2
RACFTRD  EQU   RACFFLG2
RACFTUPD EQU   RACFFLG2
RACFTCTL EQU   RACFFLG2
@NM00012 EQU   RACFFLG2
RACFTALT EQU   RACFFLG2
RACFCSA  EQU   RACFFLG1
RACFLOGN EQU   RACFFLG1
RACFLOGF EQU   RACFFLG1
@NM00011 EQU   RACFFLG1
RACFDSTV EQU   RACFFLG1
@NM00010 EQU   RACFFLG1
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00389 EQU   @RC00380
@RF00398 EQU   @RC00380
@RF00545 EQU   @RC00487
@RF00582 EQU   @RC00572
@RF00677 EQU   @RC00671
@RC00705 EQU   @RC00699
@RC00778 EQU   @RC00777
@RC00856 EQU   @RC00826
@RC00863 EQU   @RC00826
@RF00932 EQU   @RC00919
@RF01004 EQU   @RC00982
@RF01220 EQU   @RC01205
@PB00018 EQU   @EL00001
@RC00391 EQU   @RC00389
@RC00706 EQU   @RC00705
@PB00017 EQU   @PB00018
@RF00712 EQU   @RC00706
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCCV01,(C'PLS1930',0701,78164)

         TITLE '*********** IDCCO01:  COPYV FUNCTION SUPPORT ROUTINE ***
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCCO01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCCO01   76.339'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @08,0                                               0002
@PSTART  LA    @10,4095(,@08)                                      0002
         LA    @12,4095(,@10)                                      0002
         USING @PSTART,@08                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                            @Y30LB39*/
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THIS IS CENTRAL SECTION OF THE COPYV ROUTINE.         @Y30LB39*/
*   /* IT PERFORMS INITIALIZATION AND TERMINATION            @Y30LB39*/
*   /* FUNCTIONS AND ROUTES CONTROL TO SUB-PROCEDURES.       @Y30LB39*/
*   /* THE EXIT FROM IDCCO01 OCCURS FROM HERE.               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0265
         L     @09,@PC00001                                        0265
         L     @15,GDTTR2(,@09)                                    0265
         MVC   @TS00001(95),NEWERID2(@15)                          0265
         MVC   OLDERID2(95,@15),@TS00001                           0265
*   NEWID2='CO01';                  /*                       @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0266
         MVC   NEWID2(4,@15),@CC01492                              0266
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA          @Y30LB39*/
*   /* PRIOR TO SERVICING COPYV UTILITY REQUEST              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0267
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0267
         L     @09,GDTDBG(,@09)                                    0267
         LTR   @09,@09                                             0267
         BZ    @RT00267                                            0267
*     ;                                                            0268
*   ELSE                                                           0269
*     CALL IDCDB010(GDTTBL,'COBG'); /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0269
         L     @09,@PC00001                                        0269
         ST    @09,@AL00001                                        0269
         LA    @15,@CC01602                                        0269
         ST    @15,@AL00001+4                                      0269
         MVI   @AL00001+4,X'80'                                    0269
         L     @15,GDTDBG(,@09)                                    0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0270
*                                   /*                       @Y30LB39*/
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB39*/
@RT00267 LA    @09,PRINTTAB                                        0270
         ST    @09,DDSTRU                                          0270
*   PRINTTAB=''B;                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0271
         XC    PRINTTAB(44),PRINTTAB                               0271
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT SECTION OF CODE ESTABLISHES ADDRESS-         @Y30LB39*/
*   /* ABILITY TO THE VARIOUS ARGUMENT AND PARAMETER         @Y30LB39*/
*   /* LISTS WHICH ARE USED BY IDCCO01 IN SERVICING          @Y30LB39*/
*   /* THE COPYV FSR REQUEST.                                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0272
*                                   /*                       @Y30LB39*/
*   RFY                                                            0272
*     ALLAGL BASED(ADDR(ALLAGLBF)); /*                       @Y30LB39*/
*   RFY                                                            0273
*     CKAGL BASED(ADDR(CKAGLBUF));  /*                       @Y30LB39*/
*   RFY                                                            0274
*     VS1AGL BASED(ADDR(VS1AGLBF)); /*                       @Y30LB39*/
*   RFY                                                            0275
*     MDAGL BASED(ADDR(MDAGLBUF));  /*                       @Y30LB39*/
*   RFY                                                            0276
*     EXCLAGL BASED(ADDR(EXCLAGLB));/*                       @ZD00175*/
*   DEFVEPTR=ADDR(DEFVEBUF);        /*                       @Y30LB39*/
         LA    @09,DEFVEBUF                                        0277
         ST    @09,DEFVEPTR                                        0277
*   COVCEPTR=ADDR(COVCEBUF);        /*                       @Y30LB39*/
         LA    @09,COVCEBUF                                        0278
         ST    @09,COVCEPTR                                        0278
*   MVRPTR=ADDR(MVRBUFR);           /*                       @Y30LB39*/
         LA    @09,MVRBUFR                                         0279
         ST    @09,MVRPTR                                          0279
*   RVVIPTR=ADDR(RVVIBUFR);         /*                       @Y30LB39*/
         LA    @09,RVVIBUFR                                        0280
         ST    @09,RVVIPTR                                         0280
*   DEFVPTR=ADDR(DEFLISTB);         /*                       @Y30LB39*/
         LA    @09,DEFLISTB                                        0281
         ST    @09,DEFVPTR                                         0281
*   COVCPTR=ADDR(COVLISTB);         /*                       @Y30LB39*/
         LA    @09,COVLISTB                                        0282
         ST    @09,COVCPTR                                         0282
*   BASEVPTR=ADDR(BASVOLBD);        /*                       @Y30LB39*/
         LA    BASEVPTR,BASVOLBD                                   0283
*   COPYVPTR=ADDR(COPVOLBD);        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0284
         LA    COPYVPTR,COPVOLBD                                   0284
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE INTERNAL TABLE USED BY THIS MODULE            @Y30LB39*/
*   /* TO ZEROES. ALL FLAGS ARE THEREBY INITIALIZED          @Y30LB39*/
*   /* TO OFF.                                               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0285
*                                   /*                       @Y30LB39*/
*   COPYVTBL=''B;                   /*                       @Y30LB39*/
         XC    COPYVTBL(54),COPYVTBL                               0285
*   COPYVTBC='COPYVTBL';            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0286
         MVC   COPYVTBC(8),@CC01614                                0286
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET UP KEYWORD PARAMETERS FOR UENQ MACRO              @Y30LB39*/
*   /* TO ENQUEUE ON THE VOLUME SERIAL NUMBER                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0287
*                                   /*                       @Y30LB39*/
*   RNAMLNTH=LENGTH(RNAMCHAR);      /*                       @Y30LB39*/
         MVI   RNAMLNTH,X'16'                                      0287
*   RNAMCHAR(1:6)=VOLVAL;           /*                       @Y30LB39*/
         L     @09,@PC00001+4                                      0288
         L     @09,FDTPTR(,@09)                                    0288
         MVC   RNAMCHAR(6),VOLVAL(@09)                             0288
*   RNAMCHAR(7:22)='.VIRTUAL.ENQUEUE';/*                     @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0289
         MVC   RNAMCHAR+6(16),@CC01615                             0289
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UENQ MACRO TO ENQUEUE ON THE VOLUME SERIAL      @Y30LB39*/
*   /* NUMBER TO INSURE THAT THE VOLUME RECORD IS NOT        @Y30LB39*/
*   /* UPDATED DURING COPYV PROCESSING.                      @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0290
*                                   /*                       @Y30LB39*/
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,'SYSZAMS ',MINORNAM);/*   @Y30LB39*/
         MVC   @AL00001+4(12),@AL00290                             0290
         L     @09,@PC00001                                        0290
         ST    @09,@AL00001                                        0290
         LA    @07,MINORNAM                                        0290
         ST    @07,@AL00001+16                                     0290
         MVI   @AL00001+16,X'80'                                   0290
         L     @15,GDTENQ(,@09)                                    0290
         LA    @01,@AL00001                                        0290
         BALR  @14,@15                                             0290
*                                   /*                       @Y30LB39*/
*                                                                  0291
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CALL SUBROUTINE FVOLRTN TO VERIFY THAT THE            @Y30LB39*/
*   /* SOURCE VOLUME IS ACTIVE AND USABLE                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0291
*                                   /*                       @Y30LB39*/
*   CALL FVOLRTN;                   /*                       @Y30LB39*/
         BAL   @14,FVOLRTN                                         0291
*   RESPECIFY                                                      0292
*     RTNREG RSTD;                                                 0292
*   TESTRC=RTNREG;                                                 0293
         LR    TESTRC,RTNREG                                       0293
*   RESPECIFY                                                      0294
*     RTNREG UNRSTD;                /*                       @Y30LB39*/
*   LASTCOND=TESTRC;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0295
         L     @09,@PC00001+8                                      0295
         STH   TESTRC,LASTCOND(,@09)                               0295
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DISCONTINUE PROCESSING AND PROCEED TO ISSUE           @Y30LB39*/
*   /* DEQUEUE IF CONDITION CODE GREATER THAN EIGHT          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0296
*                                   /*                       @Y30LB39*/
*   IF LASTCOND^>LASTCC08 THEN      /*                       @Y30LB39*/
         L     @09,@PC00001+8                                      0296
         LH    @09,LASTCOND(,@09)                                  0296
         C     @09,@CF00179                                        0296
         BH    @RF00296                                            0296
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0297
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CALL SUBROUTINE TVOLRTN TO DIRECT THE SELECTION   @Y30LB39*/
*       /* OF THE TARGET VOLUME                              @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0298
*                                   /*                       @Y30LB39*/
*       CALL TVOLRTN;               /*                       @Y30LB39*/
         BAL   @14,TVOLRTN                                         0298
*       RESPECIFY                                                  0299
*         RTNREG RSTD;                                             0299
*       TESTRC=RTNREG;                                             0300
         LR    TESTRC,RTNREG                                       0300
*       RESPECIFY                                                  0301
*         RTNREG UNRSTD;            /*                       @Y30LB39*/
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0302
         L     @09,@PC00001+8                                      0302
         LH    @07,LASTCOND(,@09)                                  0302
         CR    @07,TESTRC                                          0302
         BNL   *+6
         LR    @07,TESTRC                                          0302
         STH   @07,LASTCOND(,@09)                                  0302
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* DISCONTINUE PROCESSING AND PROCEED TO             @Y30LB39*/
*       /* ISSUE DEQUEUE IF CONDITION CODE GREATER           @Y30LB39*/
*       /* THAN EIGHT.                                       @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0303
*                                   /*                       @Y30LB39*/
*       IF LASTCOND^>LASTCC08 THEN  /*                       @Y30LB39*/
         C     @07,@CF00179                                        0303
         BH    @RF00303                                            0303
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0304
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* CALL FILERTN TO CHECK IF FILE IS SPECI-       @Y30LB39*/
*           /* FIED AND WHETHER THE ALLOCATED UNIT IS        @Y30LB39*/
*           /* VIRTUAL. IF FILE IS NOT SPECIFIED,            @ZD00175*/
*           /* FILERTN WILL DYNAMICALLY ALLOCATE SUCH        @ZD00175*/
*           /* A UNIT.                                       @ZD00175*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0305
*                                   /*                       @Y30LB39*/
*           CALL FILERTN;           /*                       @Y30LB39*/
         BAL   @14,FILERTN                                         0305
*           RESPECIFY                                              0306
*             RTNREG RSTD;                                         0306
*           TESTRC=RTNREG;                                         0307
         LR    TESTRC,RTNREG                                       0307
*           RESPECIFY                                              0308
*             RTNREG UNRSTD;        /*                       @Y30LB39*/
*           LASTCOND=MAX(LASTCOND,TESTRC);/*                 @Y30LB39*/
         L     @09,@PC00001+8                                      0309
         LH    @07,LASTCOND(,@09)                                  0309
         CR    @07,TESTRC                                          0309
         BNL   *+6
         LR    @07,TESTRC                                          0309
         STH   @07,LASTCOND(,@09)                                  0309
*           IF LASTCOND^>LASTCC08 THEN/*                     @Y30LB39*/
         C     @07,@CF00179                                        0310
         BH    @RF00310                                            0310
*             DO;                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0311
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB39*/
*               /* CALL VSRTN TO VERIFY PASSWORDS OF         @Y30LB39*/
*               /* PROTECTED DATA SETS, TO UPDATE THE        @ZD00175*/
*               /* VSAM TIMESTAMP AND TO CHANGE THE          @ZD00175*/
*               /* THE ALLOCATION TO EXCLUSIVE.              @ZD00175*/
*               /*                                           @Y30LB39*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0312
*                                   /*                       @Y30LB39*/
*               CALL VSRTN;         /*                       @Y30LB39*/
         BAL   @14,VSRTN                                           0312
*               RESPECIFY                                          0313
*                 RTNREG RSTD;                                     0313
*               TESTRC=RTNREG;                                     0314
         LR    TESTRC,RTNREG                                       0314
*               RESPECIFY                                          0315
*                 RTNREG UNRSTD;    /*                       @Y30LB39*/
*               LASTCOND=MAX(LASTCOND,TESTRC);/*             @Y30LB39*/
         L     @09,@PC00001+8                                      0316
         LH    @07,LASTCOND(,@09)                                  0316
         CR    @07,TESTRC                                          0316
         BNL   *+6
         LR    @07,TESTRC                                          0316
         STH   @07,LASTCOND(,@09)                                  0316
*               IF LASTCOND^>LASTCC08 THEN/*                 @Y30LB39*/
         C     @07,@CF00179                                        0317
         BH    @RF00317                                            0317
*                 DO;               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0318
*                   /*************************************************/
*                   /*                                               */
*                   /*                                       @Y30LB39*/
*                   /* CALL WORKRTN TO DIRECT THE            @Y30LB39*/
*                   /* CREATION OF A NEW TARGET VOLUME       @Y30LB39*/
*                   /* PLUS THE COPY, RELABEL, AND           @Y30LB39*/
*                   /* EJECT OPERATIONS.                     @Y30LB39*/
*                   /*                                       @Y30LB39*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0319
*                                   /*                       @Y30LB39*/
*                   CALL WORKRTN;   /*                       @Y30LB39*/
         BAL   @14,WORKRTN                                         0319
*                   RESPECIFY                                      0320
*                     RTNREG RSTD;                                 0320
*                   TESTRC=RTNREG;                                 0321
         LR    TESTRC,RTNREG                                       0321
*                   RESPECIFY                                      0322
*                     RTNREG UNRSTD;/*                       @Y30LB39*/
*                   LASTCOND=MAX(LASTCOND,TESTRC);/*         @Y30LB39*/
         L     @09,@PC00001+8                                      0323
         LH    @07,LASTCOND(,@09)                                  0323
         CR    @07,TESTRC                                          0323
         BNL   *+6
         LR    @07,TESTRC                                          0323
         STH   @07,LASTCOND(,@09)                                  0323
*                 END;              /*                       @Y30LB39*/
*             END;                  /*                       @Y30LB39*/
@RF00317 DS    0H                                                  0326
*           IF LASTCOND^>LASTCC08 THEN/*                     @Y30LB39*/
@RF00310 L     @09,@PC00001+8                                      0326
         LH    @09,LASTCOND(,@09)                                  0326
         C     @09,@CF00179                                        0326
         BH    @RF00326                                            0326
*             IF REUSEFLG=ON&ADDR(BKUP)^=NULLPTR THEN              0327
         TM    REUSEFLG,B'10000000'                                0327
         BNO   @RF00327                                            0327
         L     @09,@PC00001+4                                      0327
         L     @09,FDTPTR+4(,@09)                                  0327
         LTR   @09,@09                                             0327
         BZ    @RF00327                                            0327
*               DO;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0328
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB39*/
*                 /* CALL SCRRTN TO DETERMINE IF THE         @Y30LB39*/
*                 /* BACKUP LIMIT HAS BEEN EXCEEDED.         @Y30LB39*/
*                 /* IF THAT IS THE CASE, SCRATCH            @Y30LB39*/
*                 /* THE OLDEST BACKUP COPIES.               @Y30LB39*/
*                 /*                                         @Y30LB39*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0329
*                                   /*                       @Y30LB39*/
*                 CALL SCRRTN;      /*                       @Y30LB39*/
         BAL   @14,SCRRTN                                          0329
*                 RESPECIFY                                        0330
*                   RTNREG RSTD;                                   0330
*                 TESTRC=RTNREG;                                   0331
         LR    TESTRC,RTNREG                                       0331
*                 RESPECIFY                                        0332
*                   RTNREG UNRSTD;  /*                       @Y30LB39*/
*                 LASTCOND=MAX(LASTCOND,TESTRC);/*           @Y30LB39*/
         L     @09,@PC00001+8                                      0333
         LH    @02,LASTCOND(,@09)                                  0333
         CR    @02,TESTRC                                          0333
         BNL   *+6
         LR    @02,TESTRC                                          0333
         STH   @02,LASTCOND(,@09)                                  0333
*               END;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0334
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* CHECK TO SEE IF THE RETURN CODE               @Y30LB39*/
*           /* TO THE EXECUTIVE SHOULD BE AT                 @Y30LB39*/
*           /* LEAST FOUR.                                   @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0335
*                                   /*                       @Y30LB39*/
*           IF LASTCOND=0&IOERRFLG=ON THEN/*                 @Y30LB39*/
@RF00327 DS    0H                                                  0335
@RF00326 L     @09,@PC00001+8                                      0335
         LH    @15,LASTCOND(,@09)                                  0335
         LTR   @15,@15                                             0335
         BNZ   @RF00335                                            0335
         TM    IOERRFLG,B'10000000'                                0335
         BNO   @RF00335                                            0335
*             LASTCOND=LASTCC04;    /*                       @Y30LB39*/
         MVC   LASTCOND(2,@09),@CH00042                            0336
*         END;                      /*                       @Y30LB39*/
@RF00335 DS    0H                                                  0338
*     END;                          /*                       @Y30LB39*/
@RF00303 DS    0H                                                  0339
*                                   /*                       @Y30LB39*/
*                                                                  0339
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE DEQUEUE MACRO TO RELEASE ENQUEUE SET AT         @Y30LB39*/
*   /* BEGINNING OF PROGRAM.                                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0339
*                                   /*                       @Y30LB39*/
*   RNAMCHAR(7:22)='.VIRTUAL.ENQUEUE';/*                     @ZA05138*/
@RF00296 MVC   RNAMCHAR+6(16),@CC01615                             0339
*   CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0340
         L     @09,@PC00001                                        0340
         ST    @09,@AL00001                                        0340
         LA    @15,@CC01617                                        0340
         ST    @15,@AL00001+4                                      0340
         LA    @15,MINORNAM                                        0340
         ST    @15,@AL00001+8                                      0340
         MVI   @AL00001+8,X'80'                                    0340
         L     @15,GDTDEQ(,@09)                                    0340
         LA    @01,@AL00001                                        0340
         BALR  @14,@15                                             0340
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT TO PRINT THE APPROPRIATE                 @Y30LB39*/
*   /* COMPLETION MESSAGE.                                   @Y30LB39*/
*   /* MESSAGE IDC0003I IF CONDITION CODE GREATER            @Y30LB39*/
*   /* THAN EIGHT                                            @Y30LB39*/
*   /* MESSAGE IDC0001I IF CONDITION CODE LESS THAN          @Y30LB39*/
*   /* TWELVE                                                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*                                   /*                       @Y30LB39*/
*   DARGLIST=''B;                   /*                       @Y30LB39*/
         L     @09,DDSTRU                                          0341
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0341
*   IF LASTCOND>LASTCC08 THEN       /*                       @Y30LB39*/
         L     @15,@PC00001+8                                      0342
         LH    @15,LASTCOND(,@15)                                  0342
         C     @15,@CF00179                                        0342
         BNH   @RF00342                                            0342
*     DARGSENT=MSG3003I;            /*                       @Y30LB39*/
         MVI   DARGSENT(@09),X'03'                                 0343
*   ELSE                            /*                       @Y30LB39*/
*     IF LASTCOND<LASTCC12 THEN     /*                       @Y30LB39*/
         B     @RC00342                                            0344
@RF00342 L     @09,@PC00001+8                                      0344
         LH    @09,LASTCOND(,@09)                                  0344
         C     @09,@CF00567                                        0344
         BNL   @RF00344                                            0344
*       DARGSENT=MSG0001I;          /*                       @Y30LB39*/
         L     @09,DDSTRU                                          0345
         MVI   DARGSENT(@09),X'01'                                 0345
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB39*/
@RF00344 DS    0H                                                  0346
@RC00342 L     @09,DDSTRU                                          0346
         MVC   DARGSMOD(3,@09),@CC01552                            0346
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB39*/
         L     @15,@PC00001+8                                      0347
         ST    @15,DARGDBP(,@09)                                   0347
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00153                             0348
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0349
         L     @09,@PC00001                                        0349
         ST    @09,@AL00001                                        0349
         LA    @15,@CF00115                                        0349
         ST    @15,@AL00001+4                                      0349
         LA    @15,DDSTRU                                          0349
         ST    @15,@AL00001+8                                      0349
         MVI   @AL00001+8,X'80'                                    0349
         L     @15,GDTPRT(,@09)                                    0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA          @Y30LB39*/
*   /* PRIOR TO RETURNING TO EXECUTIVE ROUTINE.              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0350
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0350
         L     @09,@PC00001                                        0350
         L     @09,GDTDBG(,@09)                                    0350
         LTR   @09,@09                                             0350
         BZ    @RT00350                                            0350
*     ;                                                            0351
*   ELSE                                                           0352
*     CALL IDCDB010(GDTTBL,'COND'); /*                       @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0352
         ST    @09,@AL00001                                        0352
         LA    @15,@CC01624                                        0352
         ST    @15,@AL00001+4                                      0352
         MVI   @AL00001+4,X'80'                                    0352
         L     @15,GDTDBG(,@09)                                    0352
         LA    @01,@AL00001                                        0352
         BALR  @14,@15                                             0352
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0353
*                                                                  0353
@RT00350 L     @09,@PC00001                                        0353
         ST    @09,@AL00001                                        0353
         LA    @15,MODID                                           0353
         ST    @15,@AL00001+4                                      0353
         L     @15,@PC00001+8                                      0353
         ST    @15,@AL00001+8                                      0353
         MVI   @AL00001+8,X'80'                                    0353
         L     @15,GDTEPL(,@09)                                    0353
         LA    @01,@AL00001                                        0353
         BALR  @14,@15                                             0353
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0354
*                                                                  0354
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - FVOLRTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* CALL RVVIRTN SO THAT RVVIRTN CAN PROCEED TO           @Y30LB39*/
*   /* RETRIEVE A BASE VOLUME RECORD PRIOR TO FURTHER        @Y30LB39*/
*   /* PROCESSING BY COPYV FSR.                              @Y30LB39*/
*   /* FVOLRTN MERELY REQUESTS THE RECORD BE                 @Y30LB39*/
*   /* RETRIEVED AND THEN VERIFIES THAT THE VOLUME           @Y30LB39*/
*   /* IS ACTIVE AND USUABLE BY TESTING DATA FROM            @Y30LB39*/
*   /* THE RECORD.                                           @Y30LB39*/
*   /* IF RECORD IS NOT RETRIEVED, A CODE OF                 @Y30LB39*/
*   /* TWELVE IS SET. IF THE RECORD IS RETRIEVED,            @Y30LB39*/
*   /* BUT THE VOLUME IS INACTIVE OR UNUSABLE BECAUSE        @Y30LB39*/
*   /* THERE WAS AN INCOMPLETE CREATE, INCOMPLETE            @Y30LB39*/
*   /* COPY, OR A VOLUME SERIAL MISMATCH, THEN THE           @Y30LB39*/
*   /* CONDITION CODE WILL ALSO BE SET TO TWELVE.            @Y30LB39*/
*   /* OTHERWISE, THE CONDITION CODE IS SET TO ZERO          @Y30LB39*/
*   /* TO SHOW THAT THE BASE VOLUME RECORD WAS               @Y30LB39*/
*   /* SUCCESSFULLY RETRIEVED.                               @Y30LB39*/
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/
*   /* IDC3074I IF VOLUME IS INACTIVE                        @Y30LB39*/
*   /* IDC3095I IF THERE WAS A VOLSER MISMATCH               @Y30LB39*/
*   /* IDC3096I IF THERE WAS AN INCOMPLETE COPY              @Y30LB39*/
*   /* IDC3097I IF THERE WASN AN INCOMPLETE CREATE           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* BUFFER FOR BASE VOLUME RECORD                         @Y30LB39*/
*   /* DARGLIST                                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 12 - BASE RECORD WAS NOT RETRIEVED OR WAS             @Y30LB39*/
*   /* UNUSABLE.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0354
*FVOLRTN:                                                          0354
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0354
@EL00001 L     @13,4(,@13)                                         0354
@EF00001 L     @00,@SIZDATD                                        0354
         LR    @01,@11                                             0354
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0354
         BR    @14                                                 0354
FVOLRTN  DS    0H                                                  0355
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*                                   /*                       @Y30LB39*/
*   DCL                                                            0355
*     FVOLRC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0356
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0356
*                                   /*                       @Y30LB39*/
*   RETADDR1=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0356
         ST    REG14,RETADDR1                                      0356
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0357
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0357
         L     @09,@PC00001                                        0357
         L     @09,GDTTR2(,@09)                                    0357
         MVC   @TS00001(95),NEWERID2(@09)                          0357
         MVC   OLDERID2(95,@09),@TS00001                           0357
*   NEWID2='COFV';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0358
         MVC   NEWID2(4,@09),@CC01629                              0358
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*                                   /*                       @Y30LB39*/
*   FVOLRC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0359
         SLR   FVOLRC,FVOLRC                                       0359
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE RECORD TYPE TO BE READ PRIOR TO CALLING       @Y30LB39*/
*   /* RVVIRTN. IN THIS CALL, THE RECORD TO                  @Y30LB39*/
*   /* BE READ IS THE BASE VOLUME RECORD.                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*                                   /*                       @Y30LB39*/
*   RECTYPE=BASECHAR;               /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVC   RECTYPE(4),BASECHAR                                 0360
*   CALL RVVIRTN;                   /*                       @Y30LB39*/
         BAL   @14,RVVIRTN                                         0361
*   RESPECIFY                                                      0362
*     RTNREG RSTD;                                                 0362
*   TESTRC=RTNREG;                                                 0363
         LR    TESTRC,RTNREG                                       0363
*   RESPECIFY                                                      0364
*     RTNREG UNRSTD;                /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0365
         BZ    @RF00365                                            0365
*     FVOLRC=LASTCC12;              /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0366
         LA    FVOLRC,12                                           0366
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CHECK RETURN CODE                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0367
*                                   /*                       @Y30LB39*/
*   IF FVOLRC=LASTCC00 THEN         /*                       @Y30LB39*/
@RF00365 C     FVOLRC,@CF00115                                     0367
         BNE   @RF00367                                            0367
*     DO;                           /*                       @Y30LB39*/
*       IF BASINAC=ON THEN          /*                       @Y30LB39*/
         TM    BASINAC(BASEVPTR),B'00000100'                       0369
         BNO   @RF00369                                            0369
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0370
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* THE VOLUME IS INACTIVE, SO                    @Y30LB39*/
*           /* SET THE CONDITION CODE TO TWELVE AND          @Y30LB39*/
*           /* ISSUE MESSAGE IDC3074I                        @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0371
*                                   /*                       @Y30LB39*/
*           FVOLRC=LASTCC12;        /*                       @Y30LB39*/
         LA    FVOLRC,12                                           0371
*           DARGLIST=''B;           /*                       @Y30LB39*/
         L     @09,DDSTRU                                          0372
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0372
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01550                            0373
*           DARGSENT=MSG3074I;      /*                       @Y30LB39*/
         MVI   DARGSENT(@09),X'20'                                 0374
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB39*/
         L     @04,@PC00001+4                                      0375
         L     @04,FDTPTR(,@04)                                    0375
         LA    @15,VOLVAL(,@04)                                    0375
         ST    @15,DARGDBP(,@09)                                   0375
*           DARGILP=VOLLEN;         /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0376
         IC    @15,VOLLEN(,@04)                                    0376
         STH   @15,DARGILP(,@09)                                   0376
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0377
         ST    @09,@AL00001                                        0377
         LA    @04,@CF00115                                        0377
         ST    @04,@AL00001+4                                      0377
         LA    @04,DDSTRU                                          0377
         ST    @04,@AL00001+8                                      0377
         MVI   @AL00001+8,X'80'                                    0377
         L     @15,GDTPRT(,@09)                                    0377
         LA    @01,@AL00001                                        0377
         BALR  @14,@15                                             0377
*         END;                      /*                       @Y30LB39*/
*       IF BASSATIA^=NULLPTR THEN   /*                       @Y30LB39*/
@RF00369 LH    @09,BASSATIA(,BASEVPTR)                             0379
         N     @09,@CF01914                                        0379
         LTR   @09,@09                                             0379
         BZ    @RF00379                                            0379
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0380
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* THE VOLUME IS UNUSABLE, SO SET THE            @Y30LB39*/
*           /* CONDITION CODE TO TWELVE AND ISSUE            @Y30LB39*/
*           /* MESSAGE IDC3097I IF THERE WAS AN              @Y30LB39*/
*           /* INCOMPLETE CREATE                             @Y30LB39*/
*           /* MESSAGE IDC3096I IF THERE WAS AN              @Y30LB39*/
*           /* INCOMPELTE COPY                               @Y30LB39*/
*           /* MESSAGE IDC3095I IF THERE WAS A               @Y30LB39*/
*           /* VOLUME SERIAL MISMATCH.                       @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0381
*                                   /*                       @Y30LB39*/
*           FVOLRC=LASTCC12;        /*                       @Y30LB39*/
         LA    FVOLRC,12                                           0381
*           DARGLIST=''B;           /*                       @Y30LB39*/
         L     @09,DDSTRU                                          0382
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0382
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB39*/
         L     @04,@PC00001+4                                      0383
         L     @04,FDTPTR(,@04)                                    0383
         LA    @15,VOLVAL(,@04)                                    0383
         ST    @15,DARGDBP(,@09)                                   0383
*           DARGILP=VOLLEN;         /*                       @Y30LB39*/
         SLR   @15,@15                                             0384
         IC    @15,VOLLEN(,@04)                                    0384
         STH   @15,DARGILP(,@09)                                   0384
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01550                            0385
*           IF BASIVCRE=ON THEN     /*                       @Y30LB39*/
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0386
         BNO   @RF00386                                            0386
*             DARGSENT=MSG3097I;    /*                       @Y30LB39*/
         MVI   DARGSENT(@09),X'03'                                 0387
*           ELSE                    /*                       @Y30LB39*/
*             IF BASIVCPY=ON THEN   /*                       @Y30LB39*/
         B     @RC00386                                            0388
@RF00386 TM    BASIVCPY(BASEVPTR),B'01000000'                      0388
         BNO   @RF00388                                            0388
*               DARGSENT=MSG3096I;  /*                       @Y30LB39*/
         L     @09,DDSTRU                                          0389
         MVI   DARGSENT(@09),X'06'                                 0389
*             ELSE                  /*                       @Y30LB39*/
*               IF BASVSMIS=ON THEN /*                       @Y30LB39*/
         B     @RC00388                                            0390
@RF00388 TM    BASVSMIS(BASEVPTR),B'00100000'                      0390
         BNO   @RF00390                                            0390
*                 DARGSENT=MSG3095I;/*                       @Y30LB39
*                                                            @Y30LB39*/
         L     @09,DDSTRU                                          0391
         MVI   DARGSENT(@09),X'09'                                 0391
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39
*                                                            @Y30LB39*/
@RF00390 DS    0H                                                  0392
@RC00388 DS    0H                                                  0392
@RC00386 L     @09,@PC00001                                        0392
         ST    @09,@AL00001                                        0392
         LA    @04,@CF00115                                        0392
         ST    @04,@AL00001+4                                      0392
         LA    @04,DDSTRU                                          0392
         ST    @04,@AL00001+8                                      0392
         MVI   @AL00001+8,X'80'                                    0392
         L     @15,GDTPRT(,@09)                                    0392
         LA    @01,@AL00001                                        0392
         BALR  @14,@15                                             0392
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0394
@RF00379 DS    0H                                                  0395
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0395
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR1;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0395
@RF00367 L     REG14,RETADDR1                                      0395
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0396
*                                   /*                       @Y30LB39*/
*   RETURN CODE(FVOLRC);            /*                       @Y30LB39*/
         LR    @15,FVOLRC                                          0396
@EL00002 DS    0H                                                  0396
@EF00002 DS    0H                                                  0396
@ER00002 BR    @14                                                 0396
*   END FVOLRTN;                    /*                       @Y30LB39*/
*                                                                  0398
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - TVOLRTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* SELECT A TARGET VOLUME AND READ THE RECORD FOR        @Y30LB39*/
*   /* FOR THIS VOLUME. A CALL IS MADE TO TVOLRTN            @Y30LB39*/
*   /* TO SEE IF CARTRIDGES OF AN EXISTING COPY CAN BE       @Y30LB39*/
*   /* REUSED OR CALLS CKCSNLEN IF THE USER HAS SPCFD        @Y30LB39*/
*   /* CARTRIDGES TO BE USED. IT IS POSSIBLE FOR A           @Y30LB39*/
*   /* MESSAGE TO BE ISSUED BY CKCSNLEN WHICH CHECKS         @Y30LB39*/
*   /* THE CARTRIDGE SERIALS NUMBERS AND ADJUSTS THE         @Y30LB39*/
*   /* LENGTH, IF NECESSARY.                                 @Y30LB39*/
*   /* IF THE USER HAS NOT SPECIFIED THE                     @Y30LB39*/
*   /* CARTRIDGES TO BE USED, THEN SCRATCH CARTRIDGES        @Y30LB39*/
*   /* WILL BE SELECTED DURING LATER PROCESSING.             @Y30LB39*/
*   /* THIS ROUTINE ALSO CALLS SSCMSG ROUTINE TO             @Y30LB39*/
*   /* PRINT A MESSAGE CONTAINING THE MSS REASON CODE,       @Y30LB39*/
*   /* IF THE READ FAILED.                                   @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 12 - IF EITHER OF THE CARTRIDGES TO BE USED           @Y30LB39*/
*   /* WAS INCORRECTLY SPECIFIED OR                          @Y30LB39*/
*   /* IT WAS DETERMINED THAT CARTRIDGES                     @Y30LB39*/
*   /* OF AN EXISTING COPY WERE NOT AVAILABLE.               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0398
*TVOLRTN:                                                          0398
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0398
TVOLRTN  DS    0H                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*                                   /*                       @Y30LB39*/
*   DCL                                                            0399
*     TVOLRC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*   DCL                                                            0400
*     CSN1RC FIXED(8);              /* RETURN CODE           @Y30LB39
*                                      FROM CKCSNLEN         @Y30LB39*/
*   DCL                                                            0401
*     CSN2RC FIXED(8);              /* RETURN CODE           @Y30LB39
*                                      FROM CKCSNLEN         @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*                                   /*                       @Y30LB39*/
*   RETADDR1=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0402
         ST    REG14,RETADDR1                                      0402
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0403
         L     @09,@PC00001                                        0403
         L     @09,GDTTR2(,@09)                                    0403
         MVC   @TS00001(95),NEWERID2(@09)                          0403
         MVC   OLDERID2(95,@09),@TS00001                           0403
*   NEWID2='COTV';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0404
         MVC   NEWID2(4,@09),@CC01637                              0404
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET CONDITION CODE AND RETURN CODES TO ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0405
*                                   /*                       @Y30LB39*/
*   TVOLRC=LASTCC00;                /*                       @Y30LB39*/
         MVI   TVOLRC,X'00'                                        0405
*   CSN1RC=LASTCC00;                /*                       @Y30LB39*/
         SLR   @09,@09                                             0406
         LR    CSN1RC,@09                                          0406
*   CSN2RC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0407
         LR    CSN2RC,@09                                          0407
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE BASE VOLUME RECORD INDICATES THAT AT           @Y30LB39*/
*   /* LEAST ONE COPY EXISTS, CALL REUSERTN TO               @Y30LB39*/
*   /* DETERMINE IF THE CARTRIDGES OF AN EXISTING            @Y30LB39*/
*   /* COPY CAN BE REUSED.                                   @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*                                   /*                       @Y30LB39*/
*   IF BASNCOPY>0 THEN              /*                       @Y30LB39*/
         CLI   BASNCOPY(BASEVPTR),0                                0408
         BNH   @RF00408                                            0408
*     DO;                           /*                       @Y30LB39*/
*       CALL REUSERTN;              /*                       @Y30LB39*/
         BAL   @14,REUSERTN                                        0410
*       RESPECIFY                                                  0411
*         RTNREG RSTD;                                             0411
*       TESTRC=RTNREG;                                             0412
         LR    TESTRC,RTNREG                                       0412
*       RESPECIFY                                                  0413
*         RTNREG UNRSTD;            /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0414
         BZ    @RF00414                                            0414
*         TVOLRC=LASTCC12;          /*                       @Y30LB39*/
         MVI   TVOLRC,X'0C'                                        0415
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0416
@RF00414 DS    0H                                                  0417
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF RETURN CODE FROM REUSERTN IS ZERO                  @Y30LB39*/
*   /* THEN CONTINUE PROCESSING                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0417
*                                   /*                       @Y30LB39*/
*   IF TVOLRC=0 THEN                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0417
@RF00408 CLI   TVOLRC,0                                            0417
         BNE   @RF00417                                            0417
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* IF AN EXISTING COPY CAN BE REUSED                   @Y30LB39*/
*     /* AS THE TARGET VOLUME THEN FALL THRU TO              @Y30LB39*/
*     /* EXIT THIS ROUTINE                                   @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0418
*                                   /*                       @Y30LB39*/
*     IF REUSEFLG=OFF THEN          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0418
         TM    REUSEFLG,B'10000000'                                0418
         BNZ   @RF00418                                            0418
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF CART IS NOT SPECIFED, SCRATCH                  @Y30LB39*/
*       /* CARTRIDGES ARE TO BE RANDOMLY SELECTED            @Y30LB39*/
*       /* WHEN CREATING A NEW TARGET VOLUME.                @Y30LB39*/
*       /* IF THIS IS THE CASE, THEN EXIT VIA LAST           @Y30LB39*/
*       /* STEP.                                             @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0419
*                                   /*                       @Y30LB39*/
*       IF ADDR(CART)^=NULLPTR THEN /*                       @Y30LB39*/
         L     @09,@PC00001+4                                      0419
         L     @07,FDTPTR+8(,@09)                                  0419
         LTR   @07,@07                                             0419
         BZ    @RF00419                                            0419
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0420
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* FOR EACH CARTRIDGE SERIAL NUMBER,             @Y30LB39*/
*           /* CALL CKCSNLEN TO VALIDATE THE                 @Y30LB39*/
*           /* LENGTH AND ADJUST TO 12 BYTES, IF             @Y30LB39*/
*           /* NECESSARY.                                    @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0421
*                                   /*                       @Y30LB39*/
*           CSN1AREA=CSN1VAL;       /*                       @Y30LB39*/
         L     @07,FDTPTR+12(,@09)                                 0421
         MVC   CSN1AREA(12),CSN1VAL(@07)                           0421
*           CSN2AREA=CSN2VAL;       /*                       @Y30LB39*/
         L     @09,FDTPTR+16(,@09)                                 0422
         MVC   CSN2AREA(12),CSN2VAL(@09)                           0422
*           CALL CKCSNLEN(CSN1AREA,CSN1LEN);/*               @Y30LB39*/
         LA    @09,CSN1AREA                                        0423
         ST    @09,@AL00001                                        0423
         ST    @07,@AL00001+4                                      0423
         LA    @01,@AL00001                                        0423
         BAL   @14,CKCSNLEN                                        0423
*           RESPECIFY                                              0424
*             RTNREG RSTD;                                         0424
*           TESTRC=RTNREG;                                         0425
         LR    TESTRC,RTNREG                                       0425
*           RESPECIFY                                              0426
*             RTNREG UNRSTD;        /*                       @Y30LB39*/
*           CSN1RC=TESTRC;          /*                       @Y30LB39*/
         LR    CSN1RC,TESTRC                                       0427
*           CALL CKCSNLEN(CSN2AREA,CSN2LEN);/*               @Y30LB39*/
         LA    @09,CSN2AREA                                        0428
         ST    @09,@AL00001                                        0428
         L     @09,@PC00001+4                                      0428
         L     @09,FDTPTR+16(,@09)                                 0428
         ST    @09,@AL00001+4                                      0428
         LA    @01,@AL00001                                        0428
         BAL   @14,CKCSNLEN                                        0428
*           RESPECIFY                                              0429
*             RTNREG RSTD;                                         0429
*           TESTRC=RTNREG;                                         0430
         LR    TESTRC,RTNREG                                       0430
*           RESPECIFY                                              0431
*             RTNREG UNRSTD;        /*                       @Y30LB39*/
*           CSN2RC=TESTRC;          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0432
         LR    CSN2RC,TESTRC                                       0432
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* IF CKCSNLEN RETURN CODE IS NOT                @Y30LB39*/
*           /* ZERO FOR BOTH CARTRIDGE SERIAL                @Y30LB39*/
*           /* NUMBERS CHECKED OUT, A CSN LENGTH             @Y30LB39*/
*           /* WAS INVALID AND THE APPROPRIATE               @Y30LB39*/
*           /* MESSAGE WAS ISSUED BY CKCSNLEN.               @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0433
*                                   /*                       @Y30LB39*/
*           IF CSN1RC^=0CSN2RC^=0 THEN/*                    @Y30LB39*/
         SLR   @09,@09                                             0433
         CR    CSN1RC,@09                                          0433
         BNE   @RT00433                                            0433
         CR    CSN2RC,@09                                          0433
         BE    @RF00433                                            0433
@RT00433 DS    0H                                                  0434
*             TVOLRC=LASTCC12;      /*                       @Y30LB39*/
         MVI   TVOLRC,X'0C'                                        0434
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0435
@RF00433 DS    0H                                                  0436
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR1;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0436
@RF00419 DS    0H                                                  0436
@RF00418 DS    0H                                                  0436
@RF00417 L     REG14,RETADDR1                                      0436
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0437
*                                   /*                       @Y30LB39*/
*   RETURN CODE(TVOLRC);            /*                       @Y30LB39*/
         SLR   @15,@15                                             0437
         IC    @15,TVOLRC                                          0437
@EL00003 DS    0H                                                  0437
@EF00003 DS    0H                                                  0437
@ER00003 BR    @14                                                 0437
*   END TVOLRTN;                    /*                       @Y30LB39*/
*                                                                  0439
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - REUSERTN                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* CHECK TO SEE IF VOLUME CAN BE REUSED.                 @Y30LB39*/
*   /* CALLS RVVIRTN TO RETRIEVE LATEST COPY RECORD.         @Y30LB39*/
*   /* A CHECK IS MADE TO SEE IF RETRIEVE WAS OKAY, IF       @Y30LB39*/
*   /* NOT, CODE IS SET TO FOUR AND AN IMMEDIATE             @Y30LB39*/
*   /* RETURN TO THE CALLING ROUTINE IS EFFECTED.            @Y30LB39*/
*   /* OTHERWISE, PROCESSING CONTINUES BY CHECKING TO        @Y30LB39*/
*   /* SEE IF THE COPY IS INCOMPLETE, IN WHICH CASE          @Y30LB39*/
*   /* THE REUSE FLAG IS TURNED ON AND THE CARTRIDGES        @Y30LB39*/
*   /* TO BE REUSED ARE PLACED IN THE COPYV INTERNAL         @Y30LB39*/
*   /* TABLE. IF BACKUP HAS BEEN SPECIFIED AND LATEST        @Y30LB39*/
*   /* COPY CANNOT BE REUSED, THEN MSVC IS CALLED TO         @Y30LB39*/
*   /* RETRIEVE OLDEST BACKUP COPY RECORD. CHECK IS          @Y30LB39*/
*   /* MADE TO DETERMINE IF THE CARTRIDGES OF A BACKUP       @Y30LB39*/
*   /* TO BE REUSED ARE OUT OF MASS STORAGE FACILITY.        @Y30LB39*/
*   /* THERE ARE NO MESSAGES ISSUED BY THIS SUB-             @Y30LB39*/
*   /* PROCEDURE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /* FORMAT OF A COPY VOLUME RECORD                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 4 - COPY RECORD COULT NOT BE RETRIEVED OR             @Y30LB39*/
*   /* OLDEST BACKUP COULD NOT BE RETRIEVED,                 @Y30LB39*/
*   /* COPYVTBL IS UPDATED.                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0439
*REUSERTN:                                                         0439
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0439
REUSERTN DS    0H                                                  0440
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0440
*                                   /*                       @Y30LB39*/
*   DCL                                                            0440
*     REUSERC FIXED(8);             /* RETURN CODE           @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0441
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*                                   /*                       @Y30LB39*/
*   RETADDR2=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0441
         LR    RETADDR2,REG14                                      0441
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0442
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0442
         L     @07,@PC00001                                        0442
         L     @07,GDTTR2(,@07)                                    0442
         MVC   @TS00001(95),NEWERID2(@07)                          0442
         MVC   OLDERID2(95,@07),@TS00001                           0442
*   NEWID2='CORE';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0443
         MVC   NEWID2(4,@07),@CC01644                              0443
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*                                   /*                       @Y30LB39*/
*   REUSERC=LASTCC00;               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0444
         SLR   REUSERC,REUSERC                                     0444
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE RECORD TYPE IN THE INTERNAL TABLE AND         @Y30LB39*/
*   /* CALL RVVIRTN TO READ THE LATEST COPY RECORD.          @Y30LB39*/
*   /* IF THE RETURN CODE FROM RVVIRTN IS NOT ZERO,          @Y30LB39*/
*   /* EXIT THIS ROUTINE AFTER SETTING CONDITION             @Y30LB39*/
*   /* CODE TO FOUR.                                         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*                                   /*                       @Y30LB39*/
*   RECTYPE=COPYCHAR;               /*                       @Y30LB39*/
         MVC   RECTYPE(4),COPYCHAR                                 0445
*   CALL RVVIRTN;                   /*                       @Y30LB39*/
         BAL   @14,RVVIRTN                                         0446
*   RESPECIFY                                                      0447
*     RTNREG RSTD;                                                 0447
*   TESTRC=RTNREG;                                                 0448
         LR    TESTRC,RTNREG                                       0448
*   RESPECIFY                                                      0449
*     RTNREG UNRSTD;                /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0450
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CHECK RETURN CODE                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*                                   /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0450
         BZ    @RF00450                                            0450
*     REUSERC=LASTCC04;             /*                       @Y30LB39*/
         LA    REUSERC,4                                           0451
*   IF REUSERC=0 THEN               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0452
@RF00450 SLR   @07,@07                                             0452
         CR    REUSERC,@07                                         0452
         BNE   @RF00452                                            0452
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* IF THE CARTRIDGES CAN BE REUSED BECAUSE             @Y30LB39*/
*     /* THE LATEST COPY IS MARKED INCOMPLETE, DROP          @Y30LB39*/
*     /* THRU TO THE CORRESPONDING ELSE CLAUSE               @Y30LB39*/
*     /* TO SAVE THE CSN'S AND COPYDATE FROM RECORD.         @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0453
*                                   /*                       @Y30LB39*/
*     IF COPSATIA=NULLPTR THEN      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0453
         LH    @15,COPSATIA(,COPYVPTR)                             0453
         N     @15,@CF01914                                        0453
         LTR   @15,@15                                             0453
         BNZ   @RF00453                                            0453
*       /*************************************************************/
*       /*                                                           */
*       /* SINCE THERE IS NO INCOMPLETE-COPY VOLUME          @Y30LB39*/
*       /* TO BE REUSED, DETERMINE WHETHER THE OLDEST BACKUP COPY    */
*       /* VOLUME SHOULD BE REUSED.                          @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0454
*                                   /*                       @Y30LB39*/
*       IF ADDR(BKUP)^=NULLPTR THEN /*                       @Y30LB39*/
         L     @15,@PC00001+4                                      0454
         C     @07,FDTPTR+4(,@15)                                  0454
         BE    @RF00454                                            0454
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0455
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* IF THE NUMBER OF CURRENT BACKUPS HAS          @Y30LB39*/
*           /* REACHED OR EXCEEDED THE BACKUP LIMIT,         @Y30LB39*/
*           /* THEN REUSE THE OLDEST BACKUP.                 @Y30LB39*/
*           /* CALL RVVIRTN TO RETRIEVE THE OLDEST           @Y30LB39*/
*           /* BACKUP COPY RECORD. IF THE RETURN             @Y30LB39*/
*           /* CODE IS NOT ZERO, THEN SET CONDITION          @Y30LB39*/
*           /* CODE TO FOUR AND EXIT THIS ROUTINE.           @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0456
*                                   /*                       @Y30LB39*/
*           IF BASNBKUP=>BASBKLMT THEN/*                     @Y30LB39*/
         CLC   BASNBKUP(1,BASEVPTR),BASBKLMT(BASEVPTR)             0456
         BL    @RF00456                                            0456
*             DO;                   /*                       @Y30LB39*/
*               RECTYPE=BKUPCHAR;   /*                       @Y30LB39*/
         MVC   RECTYPE(4),BKUPCHAR                                 0458
*               CALL RVVIRTN;       /*                       @Y30LB39*/
         BAL   @14,RVVIRTN                                         0459
*               RESPECIFY                                          0460
*                 RTNREG RSTD;                                     0460
*               TESTRC=RTNREG;                                     0461
         LR    TESTRC,RTNREG                                       0461
*               RESPECIFY                                          0462
*                 RTNREG UNRSTD;    /*                       @Y30LB39*/
*               IF TESTRC^=0 THEN   /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0463
         BZ    @RF00463                                            0463
*                 REUSERC=LASTCC04; /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0464
         LA    REUSERC,4                                           0464
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB39*/
*               /* CALL OBKUPRTN TO DETERMINE IF EITHER      @Y30LB39*/
*               /* CARTRIDGE OF THE BACKUP COPY IS OUT OF    @Y30LB39*/
*               /* MASS STORAGE FACILITY. IF THE RETURN      @Y30LB39*/
*               /* CODE IS NON-ZERO, RETURN TO CALLER        @Y30LB39*/
*               /* WITH A CONDITION CODE OF FOUR.            @Y30LB39*/
*               /*                                           @Y30LB39*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0465
*                                   /*                       @Y30LB39*/
*               IF REUSERC=0 THEN   /*                       @Y30LB39*/
@RF00463 C     REUSERC,@CF00115                                    0465
         BNE   @RF00465                                            0465
*                 DO;               /*                       @Y30LB39*/
*                   CALL OBKUPRTN;  /*                       @Y30LB39*/
         BAL   @14,OBKUPRTN                                        0467
*                   RESPECIFY                                      0468
*                     RTNREG RSTD;                                 0468
*                   TESTRC=RTNREG;                                 0469
         LR    TESTRC,RTNREG                                       0469
*                   RESPECIFY                                      0470
*                     RTNREG UNRSTD;/*                       @Y30LB39*/
*                   IF TESTRC^=0 THEN/*                      @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0471
         BZ    @RF00471                                            0471
*                     REUSERC=LASTCC04;/*                    @Y30LB39*/
         LA    REUSERC,4                                           0472
*                 END;              /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0473
@RF00471 DS    0H                                                  0474
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB39*/
*               /* SINCE AN EXISTING COPY CAN BE USED,       @Y30LB39*/
*               /* SET REUSEFLG ON. SAVE THE CARTRIDGE       @Y30LB39*/
*               /* SERIAL NUMBERS IN THE INTERNAL TABLE      @Y30LB39*/
*               /* ALONG WITH THE COPY DATE FROM THE         @Y30LB39*/
*               /* COPY RECORD. THE CARTRIDGE SERIAL         @Y30LB39*/
*               /* NUMBERS WILL BE NEEDED IN THE COPY        @Y30LB39*/
*               /* OPERATION. THEY ARE SAVED IN THE          @Y30LB39*/
*               /* INTERNAL TABLE SINCE ONE OF SEVERAL       @Y30LB39*/
*               /* ROUTINES DETERMINE THE ACTUAL CSN'S       @Y30LB39*/
*               /* USED FOR THE TARGET VOLUME.               @Y30LB39*/
*               /*                                           @Y30LB39*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0474
*                                   /*                       @Y30LB39*/
*               IF REUSERC=0 THEN   /*                       @Y30LB39*/
@RF00465 C     REUSERC,@CF00115                                    0474
         BNE   @RF00474                                            0474
*                 DO;               /*                       @Y30LB39*/
*                   REUSEFLG=ON;    /*                       @Y30LB39*/
         OI    REUSEFLG,B'10000000'                                0476
*                   CSN1AREA=COPCSN1;/*                      @Y30LB39*/
         MVC   CSN1AREA(12),COPCSN1(COPYVPTR)                      0477
*                   CSN2AREA=COPCSN2;/*                      @Y30LB39*/
         MVC   CSN2AREA(12),COPCSN2(COPYVPTR)                      0478
*                   NEWCDATE=COPDATE;/*                      @Y30LB39*/
         MVC   NEWCDATE(4),COPDATE(COPYVPTR)                       0479
*                 END;              /*                       @Y30LB39*/
*             END;                  /*                       @Y30LB39*/
*                                                                  0481
*           /*********************************************************/
*           /*                                                       */
*           /* THE BACKUP PARM IS SPECIFIED BUT THE          @Y30LB39*/
*           /* BACKUP LIMIT HAS NOT BEEN REACHED. EXIT FROM THIS PROC*/
*           /* SINCE A NEW COPY VOLUME WILL BE CREATED FROM SCRATCH  */
*           /* CARTRIDGES.                                   @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0482
*           ELSE                                                   0482
*             ;                     /*                       @Y30LB39*/
@RF00456 DS    0H                                                  0483
*         END;                      /*                       @Y30LB39*/
*                                                                  0483
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* BACKUP IS NOT SPECIFIED. EXIT FROM THIS               @Y30LB39*/
*   /* PROCEDURE. IT HAS BEEN DETERMINED THAT                @Y30LB39*/
*   /* AN INCOMPLETE COPY DOES NOT EXIST THAT                @Y30LB39*/
*   /* CAN BE REUSED AS THE TARGET VOLUME.                   @Y30LB39*/
*   /* SINCE THE NEW COPY IS NOT DESIRED FOR BKUP            @Y30LB39*/
*   /* PURPOSES, NO CHECK IS MADE TO DETERMINE               @Y30LB39*/
*   /* WHETHER THE OLDEST BACKUP SHOULD BE REUSED            @Y30LB39*/
*   /* AS THE TARGET VOLUME.                                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*       ELSE                                                       0484
*         ;                         /*                       @Y30LB39*/
@RF00454 DS    0H                                                  0485
*     ELSE                          /*                       #Y30LB39*/
*       DO;                         /*                       @Y30LB39*/
         B     @RC00453                                            0485
@RF00453 DS    0H                                                  0486
*         REUSEFLG=ON;              /*                       @Y30LB39*/
         OI    REUSEFLG,B'10000000'                                0486
*         CSN1AREA=COPCSN1;         /*                       @Y30LB39*/
         MVC   CSN1AREA(12),COPCSN1(COPYVPTR)                      0487
*         CSN2AREA=COPCSN2;         /*                       @Y30LB39*/
         MVC   CSN2AREA(12),COPCSN2(COPYVPTR)                      0488
*         NEWCDATE=COPDATE;         /*                       @Y30LB39*/
         MVC   NEWCDATE(4),COPDATE(COPYVPTR)                       0489
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0490
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0491
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR2;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0491
@RC00453 DS    0H                                                  0491
@RF00452 LR    REG14,RETADDR2                                      0491
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*                                   /*                       @Y30LB39*/
*   RETURN CODE(REUSERC);           /*                       @Y30LB39*/
         LR    @15,REUSERC                                         0492
@EL00004 DS    0H                                                  0492
@EF00004 DS    0H                                                  0492
@ER00004 BR    @14                                                 0492
*   END REUSERTN;                   /*                       @Y30LB39*/
*                                                                  0494
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - OBKUPRTN                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* DETERMINE IF BOTH CARTRIDGES OF THE BACKUP            @Y30LB39*/
*   /* COPY TO BE REUSED ARE IN THE MASS STORAGE             @Y30LB39*/
*   /* FACILITY.                                             @Y30LB39*/
*   /* IF BOTH CARTRIDGES ARE IN THE MASS STORAGE            @Y30LB39*/
*   /* FACILITY, THEN CONTROL MERELY RETURNS TO              @Y30LB39*/
*   /* THE CALLER. OTHERWISE, SERIES OF MESSAGES ARE         @Y30LB39*/
*   /* ISSUED TO NOTIFY THE USER WHICH CARTRIDGES WERE       @Y30LB39*/
*   /* NOT AVAILABLE FOR THE COPY OPERATION.                 @Y30LB39*/
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/
*   /* IDC3702I TO SAY TARGET CAN NOT BE USED                @Y30LB39*/
*   /* IDC2076I TO IDENTIFY MISSING CARTRIDGE(S)             @Y30LB39*/
*   /* IDC0098I TO GIVE LOCATION OF VOLUME                   @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FDTTBL AND DARGLIST                           @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 4 - ONE OR BOTH OF CARTRIDGES WAS OUT OF              @Y30LB39*/
*   /* THE MASS STORAGE FACILITY.                            @Y30LB39*/
*   /* COPYVTBL IS UPDATED.                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0494
*OBKUPRTN:                                                         0494
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0494
OBKUPRTN DS    0H                                                  0495
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*                                   /*                       @Y30LB39*/
*   DCL                                                            0495
*     OBKUPRC FIXED(8);             /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0496
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*                                   /*                       @Y30LB39*/
*   RETADDR3=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0496
         ST    REG14,RETADDR3                                      0496
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0497
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0497
         L     @07,@PC00001                                        0497
         L     @07,GDTTR2(,@07)                                    0497
         MVC   @TS00001(95),NEWERID2(@07)                          0497
         MVC   OLDERID2(95,@07),@TS00001                           0497
*   NEWID2='COBK';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0498
         MVC   NEWID2(4,@07),@CC01650                              0498
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*                                   /*                       @Y30LB39*/
*   OBKUPRC=LASTCC00;               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0499
         SLR   OBKUPRC,OBKUPRC                                     0499
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF EITHER CARTRIDGE IS OUT OF THE                     @Y30LB39*/
*   /* MASS STORAGE FACILITY, THEN SET CONDITION             @Y30LB39*/
*   /* CODE TO FOUR AND ISSUE EXPLANATORY                    @Y30LB39*/
*   /* MESSAGES.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0500
*                                   /*                       @Y30LB39*/
*   IF COPLIB1=HEXFFCOPLIB2=HEXFF THEN/*                    @Y30LB39*/
         CLC   COPLIB1(1,COPYVPTR),HEXFF                           0500
         BE    @RT00500                                            0500
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0500
         BNE   @RF00500                                            0500
@RT00500 DS    0H                                                  0501
*     DO;                           /*                       @Y30LB39*/
*       OBKUPRC=LASTCC04;           /*                       @Y30LB39*/
         LA    @07,4                                               0502
         LR    OBKUPRC,@07                                         0502
*       DARGLIST=''B;               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0503
         L     @02,DDSTRU                                          0503
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0503
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT FOR MESSAGE IDC3702I                 @Y30LB39*/
*       /* INSERT COPY DATE FROM COPY RECORD.                @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0504
*                                   /*                       @Y30LB39*/
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@02),@CC01548                            0504
*       DARGSENT=MSG3702I;          /*                       @Y30LB39*/
         MVI   DARGSENT(@02),X'03'                                 0505
*       DARGDBP=ADDR(COPDATE);      /*                       @Y30LB39*/
         LA    @15,COPDATE(,COPYVPTR)                              0506
         ST    @15,DARGDBP(,@02)                                   0506
*       DARGILP=LENGTH(COPDATE);    /*                       @Y30LB39
*                                                            @Y30LB39*/
         STH   @07,DARGILP(,@02)                                   0507
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0508
         L     @07,@PC00001                                        0508
         ST    @07,@AL00001                                        0508
         LA    @02,@CF00115                                        0508
         ST    @02,@AL00001+4                                      0508
         LA    @02,DDSTRU                                          0508
         ST    @02,@AL00001+8                                      0508
         MVI   @AL00001+8,X'80'                                    0508
         L     @15,GDTPRT(,@07)                                    0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT FOR SECONDARY MESSAGE                @Y30LB39*/
*       /* IDC2076I. INSERT FROM THE COPY                    @Y30LB39*/
*       /* RECORD ONE OR BOTH CSNS AND THE                   @Y30LB39*/
*       /* COPY DATE.                                        @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0509
*                                   /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
         L     @07,DDSTRU                                          0509
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0509
*       DARGSMOD=COMNMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@07),@CC01550                            0510
*       DARGSENT=MSG2076I;          /*                       @Y30LB39*/
         MVI   DARGSENT(@07),X'1E'                                 0511
*       IF COPLIB1=HEXFF&COPLIB2=HEXFF THEN/*                @Y30LB39*/
         CLC   COPLIB1(1,COPYVPTR),HEXFF                           0512
         BNE   @RF00512                                            0512
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0512
         BNE   @RF00512                                            0512
*         DARGCNT=BOTHCSNS;         /*                       @Y30LB39*/
         MVC   DARGCNT(2,@07),@CH00153                             0513
*       ELSE                        /*                       @Y30LB39*/
*         DARGCNT=ONECSN;           /*                       @Y30LB39*/
         B     @RC00512                                            0514
@RF00512 L     @07,DDSTRU                                          0514
         MVC   DARGCNT(2,@07),@CH00219                             0514
*       IF DARGCNT=BOTHCSNS THEN    /*                       @Y30LB39*/
@RC00512 L     @07,DDSTRU                                          0515
         CLC   DARGCNT(2,@07),@CH00153                             0515
         BNE   @RF00515                                            0515
*         DO;                       /*                       @Y30LB39*/
*           DARGILP=LENGTH(COPCSN1);/*                       @Y30LB39*/
         LA    @02,12                                              0517
         STH   @02,DARGILP(,@07)                                   0517
*           DARGDBP=ADDR(COPCSN1);  /*                       @Y30LB39*/
         LA    @15,COPCSN1(,COPYVPTR)                              0518
         ST    @15,DARGDBP(,@07)                                   0518
*           DARGINS(1)=ONECSN;      /*                       @Y30LB39*/
         MVC   DARGINS(2,@07),@CH00219                             0519
*           DARGINL(1)=LENGTH(COPCSN2);/*                    @Y30LB39*/
         STH   @02,DARGINL(,@07)                                   0520
*           DARGDTM(1)=ADDR(COPCSN2);/*                      @Y30LB39*/
         LA    @02,COPCSN2(,COPYVPTR)                              0521
         ST    @02,DARGDTM(,@07)                                   0521
*         END;                      /*                       @Y30LB39*/
*       ELSE                        /*                       @Y30LB39*/
*         IF COPLIB1=HEXFF THEN     /*                       @Y30LB39*/
         B     @RC00515                                            0523
@RF00515 CLC   COPLIB1(1,COPYVPTR),HEXFF                           0523
         BNE   @RF00523                                            0523
*           DO;                     /*                       @Y30LB39*/
*             DARGILP=LENGTH(COPCSN1);/*                     @Y30LB39*/
         L     @07,DDSTRU                                          0525
         MVC   DARGILP(2,@07),@CH00567                             0525
*             DARGDBP=ADDR(COPCSN1);/*                       @Y30LB39*/
         LA    @02,COPCSN1(,COPYVPTR)                              0526
         ST    @02,DARGDBP(,@07)                                   0526
*           END;                    /*                       @Y30LB39*/
*         ELSE                      /*                       @Y30LB39*/
*           DO;                     /*                       @Y30LB39*/
         B     @RC00523                                            0528
@RF00523 DS    0H                                                  0529
*             DARGILP=LENGTH(COPCSN2);/*                     @Y30LB39*/
         L     @07,DDSTRU                                          0529
         MVC   DARGILP(2,@07),@CH00567                             0529
*             DARGDBP=ADDR(COPCSN2);/*                       @Y30LB39*/
         LA    @02,COPCSN2(,COPYVPTR)                              0530
         ST    @02,DARGDBP(,@07)                                   0530
*           END;                    /*                       @Y30LB39*/
*       IF DARGCNT=ONECSN THEN      /*                       @Y30LB39*/
@RC00523 DS    0H                                                  0532
@RC00515 L     @07,DDSTRU                                          0532
         CLC   DARGCNT(2,@07),@CH00219                             0532
         BNE   @RF00532                                            0532
*         DO;                       /*                       @Y30LB39*/
*           DARGINS(ONECSN)=2;      /*                       @Y30LB39*/
         MVC   DARGINS(2,@07),@CH00153                             0534
*           DARGINL(ONECSN)=LENGTH(COPDATE);/*               @Y30LB39*/
         MVC   DARGINL(2,@07),@CH00042                             0535
*           DARGDTM(ONECSN)=ADDR(COPDATE);/*                 @Y30LB39*/
         LA    @02,COPDATE(,COPYVPTR)                              0536
         ST    @02,DARGDTM(,@07)                                   0536
*         END;                      /*                       @Y30LB39*/
*       ELSE                        /*                       @Y30LB39*/
*         DO;                       /*                       @Y30LB39*/
         B     @RC00532                                            0538
@RF00532 DS    0H                                                  0539
*           DARGINS(DARGCNT)=DARGCNT;/*                      @Y30LB39*/
         L     @07,DDSTRU                                          0539
         LH    @02,DARGCNT(,@07)                                   0539
         LR    @15,@02                                             0539
         SLA   @15,3                                               0539
         STH   @02,DARGINS-8(@15,@07)                              0539
*           DARGINL(DARGCNT)=LENGTH(COPDATE);/*              @Y30LB39*/
         LA    @02,4                                               0540
         STH   @02,DARGINL-8(@15,@07)                              0540
*           DARGDTM(DARGCNT)=ADDR(COPDATE);/*                @Y30LB39*/
         LA    @02,COPDATE(,COPYVPTR)                              0541
         ST    @02,DARGDTM-8(@15,@07)                              0541
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0543
@RC00532 L     @07,@PC00001                                        0543
         ST    @07,@AL00001                                        0543
         LA    @02,@CF00115                                        0543
         ST    @02,@AL00001+4                                      0543
         LA    @02,DDSTRU                                          0543
         ST    @02,@AL00001+8                                      0543
         MVI   @AL00001+8,X'80'                                    0543
         L     @15,GDTPRT(,@07)                                    0543
         LA    @01,@AL00001                                        0543
         BALR  @14,@15                                             0543
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF COPDEST IS NOT BLANK, ISSUE UPRINT             @Y30LB39*/
*       /* FOR SECONDARY MESSAGE IDC0098I INSERT             @Y30LB39*/
*       /* THE LOCATION DATA FROM THE COPY RECORD.           @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0544
*                                   /*                       @Y30LB39*/
*       IF COPDEST^=THIRTYBK THEN   /*                       @Y30LB39*/
         CLC   COPDEST(30,COPYVPTR),THIRTYBK                       0544
         BE    @RF00544                                            0544
*         DO;                       /*                       @Y30LB39*/
*           DARGLIST=''B;           /*                       @Y30LB39*/
         L     @07,DDSTRU                                          0546
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0546
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@07),@CC01550                            0547
*           DARGSENT=MSG0098I;      /*                       @Y30LB39*/
         MVI   DARGSENT(@07),X'02'                                 0548
*           DARGDBP=ADDR(COPDEST);  /*                       @Y30LB39*/
         LA    @02,COPDEST(,COPYVPTR)                              0549
         ST    @02,DARGDBP(,@07)                                   0549
*           DARGILP=LENGTH(COPDEST);/*                       @Y30LB39
*                                                            @Y30LB39*/
         MVC   DARGILP(2,@07),@CH01085                             0550
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39
*                                                            @Y30LB39*/
         L     @07,@PC00001                                        0551
         ST    @07,@AL00001                                        0551
         LA    @02,@CF00115                                        0551
         ST    @02,@AL00001+4                                      0551
         LA    @02,DDSTRU                                          0551
         ST    @02,@AL00001+8                                      0551
         MVI   @AL00001+8,X'80'                                    0551
         L     @15,GDTPRT(,@07)                                    0551
         LA    @01,@AL00001                                        0551
         BALR  @14,@15                                             0551
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0554
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* THE CONDITION CODE IS ZERO SO SET FLAG              @Y30LB39*/
*     /* ON INDICATING THAT CARTRIDGES CAN BE REUSED.        @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0554
*                                   /*                       @Y30LB39*/
*     OBKUPFLG=ON;                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0554
         B     @RC00500                                            0554
@RF00500 OI    OBKUPFLG,B'01000000'                                0554
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0555
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR3;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0555
@RC00500 L     REG14,RETADDR3                                      0555
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0556
*                                   /*                       @Y30LB39*/
*   RETURN CODE(OBKUPRC);           /*                       @Y30LB39*/
         LR    @15,OBKUPRC                                         0556
@EL00005 DS    0H                                                  0556
@EF00005 DS    0H                                                  0556
@ER00005 BR    @14                                                 0556
*   END OBKUPRTN;                   /*                       @Y30LB39*/
*                                                                  0558
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - FILERTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* PROCESS UNIT ALLOCATION AND INSURE THAT UNIT          @Y30LB39*/
*   /* ALLOCATED IS VIRTUAL.                                 @ZD00175*/
*   /* IF THE USER HAD SPECIFED A FILE NAME, THEN            @Y30LB39*/
*   /* A CHECK IS MERELY MADE TO INSURE THAT THE             @ZD00175*/
*   /* UNIT IS VIRTUAL. OTHERWISE, A CHECK IS MADE           @ZD00175*/
*   /* TO DETERMINE IF THE VOL IS ALREADY ALLOCATED          @ZD00175*/
*   /* EXCLUSIVELY TO THIS TASK AND CAN BE REASSIGNED,       @ZD00175*/
*   /* OR A VIRTUAL UNIT IS DYNAMICALLY ALLOCATED.           @ZD00175*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* ALLOCATION ARGUMENT LIST                              @Y30LB39*/
*   /* EXCLUSIVE ARGUMENT LIST                               @ZD00175*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 12 - IF DYNAMIC ALLOCATION FAILED OR IF               @Y30LB39*/
*   /* NO UNIT IS AVAILABLE,OR IF THE VIRTUAL                @ZD00175*/
*   /* UNIT CHECK FAILED. COPYVTBL IS UPDATED.               @ZD00175*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*FILERTN:                                                          0558
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0558
FILERTN  DS    0H                                                  0559
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0559
*                                   /*                       @Y30LB39*/
*   DCL                                                            0559
*     FILERC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0560
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0560
*                                   /*                       @Y30LB39*/
*   RETADDR1=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0560
         ST    REG14,RETADDR1                                      0560
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0561
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0561
         L     @09,@PC00001                                        0561
         L     @09,GDTTR2(,@09)                                    0561
         MVC   @TS00001(95),NEWERID2(@09)                          0561
         MVC   OLDERID2(95,@09),@TS00001                           0561
*   NEWID2='COFI';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0562
         MVC   NEWID2(4,@09),@CC01655                              0562
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0563
*                                   /*                       @Y30LB39*/
*   FILERC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0563
         SLR   @09,@09                                             0563
         LR    FILERC,@09                                          0563
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE DDNAME FOR THE ALLOCATED UNIT IS                  @Y30LB39*/
*   /* SAVED IN THE COMMON INTERNAL TABLE.                   @Y30LB39*/
*   /* IF FILE IS SPECIFIED, THE DDNAME IS OBTAINED          @Y30LB39*/
*   /* FROM FILEVAL.                                         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0564
*                                   /*                       @Y30LB39*/
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Y30LB39*/
         L     @07,@PC00001+4                                      0564
         L     @07,FDTPTR+56(,@07)                                 0564
         CR    @07,@09                                             0564
         BE    @RF00564                                            0564
*     CUNITDDN=FILEVAL;             /*                       @Y30LB39*/
         MVC   CUNITDDN(8),FILEVAL(@07)                            0565
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0566
         B     @RC00564                                            0566
@RF00564 DS    0H                                                  0567
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* DETERMINE WHETHER THE VOL TO BE COPIED IS         @ZD00175*/
*       /* ALREADY ALLOCATED EXCLUSIVELY TO THE JOB          @ZD00175*/
*       /* STEP AND A UNIT IS AVAILABLE FOR REUSE.           @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0567
*       EXCLAGL=''B;                /*                       @ZD00175*/
         LA    @09,EXCLAGLB                                        0567
         XC    EXCLAGL(23,@09),EXCLAGL(@09)                        0567
*       EXCLUCBP=ADDR(CUNITUCB);    /*                       @ZD00175*/
         LA    @07,CUNITUCB                                        0568
         ST    @07,EXCLUCBP(,@09)                                  0568
*       EXCLDDP=ADDR(CUNITDDN);     /*                       @ZD00175*/
         LA    @07,CUNITDDN                                        0569
         ST    @07,EXCLDDP(,@09)                                   0569
*       EXCLVOL=VOLVAL;             /*                       @ZD00175*/
*                                                                  0570
         L     @07,@PC00001+4                                      0570
         L     @07,FDTPTR(,@07)                                    0570
         MVC   EXCLVOL(6,@09),VOLVAL(@07)                          0570
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* INVOKE THE SYSTEM ADAPTER, IDCSA06, T0            @ZD00175*/
*       /* SELECT A UNIT ALREADY EXCLUSIVELY ALLOCATED       @ZD00175*/
*       /* TO THE VOLUME AND JOB STEP.                       @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0571
*       CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*             @ZD00175*/
         L     @07,@PC00001                                        0571
         ST    @07,@AL00001                                        0571
         LA    @02,SELECTX                                         0571
         ST    @02,@AL00001+4                                      0571
         ST    @09,@AL00001+8                                      0571
         MVI   @AL00001+8,X'80'                                    0571
         L     @15,GDTUNT(,@07)                                    0571
         LA    @01,@AL00001                                        0571
         BALR  @14,@15                                             0571
*       RESPECIFY                                                  0572
*         RTNREG RSTD;                                             0572
*       TESTRC=RTNREG;                                             0573
         LR    TESTRC,RTNREG                                       0573
*       RESPECIFY                                                  0574
*         RTNREG UNRSTD;            /*                       @ZD00175*/
*                                                                  0575
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* IF THE DDNAME AND UCB ADDRESS ARE NOT             @ZD00175*/
*       /* RETURNED BY IDCSA06, THE VOLUME IS NOT AL-        @ZD00175*/
*       /* READY ALLOCATED EXCLUSIVELY TO THIS TASK.         @ZD00175*/
*       /* DYNAMICALLY ALLOCATE THE VOLUME FOR SHARED        @ZD00175*/
*       /* USE.                                              @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0575
*       IF TESTRC=0 THEN                                           0575
         SLR   @09,@09                                             0575
         CR    TESTRC,@09                                          0575
         BNE   @RF00575                                            0575
*         IF CUNITUCB=NULLPTR THEN                                 0576
         C     @09,CUNITUCB                                        0576
         BNE   @RF00576                                            0576
*           DO;                     /*                       @ZD00175*/
*                                                                  0577
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @ZD00175*/
*             /* FILE WAS NOT SPECIFIED SO INITIALIZE THE    #Y30LB39*/
*             /* ARGUMENT LIST TO DYNAMICALLY ALLOCATE A     #Y30LB39*/
*             /* VIRTUAL UNIT, 3330V, FOR SHARED USE         @ZD00175*/
*             /* AND TO MOUNT THE SOURCE VOLUME              #Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0578
*                                   /*                       @Y30LB39*/
*             ALLAGL=''B;           /*                       @Y30LB39*/
         LA    @07,ALLAGLBF                                        0578
         XC    ALLAGL(31,@07),ALLAGL(@07)                          0578
*             ALLOPTVL=ON;          /*                       @Y30LB39*/
         OI    ALLOPTVL(@07),B'10000000'                           0579
*             UNITNUM=UNITCNT;      /*                       @Y30LB39*/
         LA    @15,1                                               0580
         STH   @15,UNITNUM                                         0580
*             UNITLNTH=TYPELNTH;    /*                       @Y30LB39*/
         MVC   UNITLNTH(2),@CH00286                                0581
*             UNITTYPE='3330V';     /*                       @Y30LB39*/
         MVC   UNITTYPE(5),@CC01656                                0582
*             ALLULP=ADDR(UNITLIST);/*                       @Y30LB39*/
         LA    @14,UNITLIST                                        0583
         ST    @14,ALLULP(,@07)                                    0583
*             VOLNUMBR=UNITCNT;     /*                       @Y30LB39*/
         STH   @15,VOLNUMBR                                        0584
*             VOLLENTH=VOLLEN;      /*                       @Y30LB39*/
         L     @15,@PC00001+4                                      0585
         L     @15,FDTPTR(,@15)                                    0585
         SLR   @14,@14                                             0585
         IC    @14,VOLLEN(,@15)                                    0585
         STH   @14,VOLLENTH                                        0585
*             VOLSERNM=VOLVAL;      /*                       @Y30LB39*/
         MVC   VOLSERNM(6),VOLVAL(@15)                             0586
*             ALLVLP=ADDR(VOLSERLT);/*                       @Y30LB39*/
         LA    @15,VOLSERLT                                        0587
         ST    @15,ALLVLP(,@07)                                    0587
*             ALLVLCNT=VOLUMCNT;    /*                       @Y30LB39*/
         MVI   ALLVLCNT(@07),X'01'                                 0588
*             ALLUNCNT=UNITCNT;     /*                       @Y30LB39*/
         MVI   ALLUNCNT(@07),X'01'                                 0589
*             ALLOPTPV=ON;          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0590
         OI    ALLOPTPV(@07),B'00100000'                           0590
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* DUMP ALLOCATION ARGUMENT LIST PRIOR TO      @Y30LB39*/
*             /* INVOKING DYNAMIC ALLOCATION ROUTINE.        @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0591
*                                   /*                       @Y30LB39*/
*             IF GDTDBG=NULLPTR THEN                               0591
         L     @07,@PC00001                                        0591
         C     @09,GDTDBG(,@07)                                    0591
         BE    @RT00591                                            0591
*               ;                                                  0592
*             ELSE                                                 0593
*               DO;                                                0593
*                 DMPINDEX=ADDR(DUMPLIST);/*                 @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   0594
*                 DMPITMNM='ALLAGLBF';                             0595
         MVC   DMPITMNM(8,DMPINDEX),@CC01657                       0595
*                 DMPITMPT=ADDR(ALLAGLBF);                         0596
         LA    @09,ALLAGLBF                                        0596
         ST    @09,DMPITMPT(,DMPINDEX)                             0596
*                 DMPITMLN=LENGTH(ALLAGLBF);                       0597
         MVC   DMPITMLN(2,DMPINDEX),@CH00044                       0597
*                 DMPITMTP='H';                                    0598
         MVI   DMPITMTP(DMPINDEX),C'H'                             0598
*                 DMPINDEX=DMPINDEX+DMPELEMT;                      0599
         AL    DMPINDEX,@CF00474                                   0599
*                 DMPTRM=DMPTRMVL;                                 0600
         MVI   DMPTRM(DMPINDEX),X'FF'                              0600
*               END;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*             IF GDTDBG=NULLPTR THEN                               0602
@RT00591 L     @09,@PC00001                                        0602
         L     @09,GDTDBG(,@09)                                    0602
         LTR   @09,@09                                             0602
         BZ    @RT00602                                            0602
*               ;                                                  0603
*             ELSE                                                 0604
*               CALL IDCDB010(GDTTBL,'COAA',ADDR(DUMPLIST));/*     0604
*                                                            @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0604
         ST    @09,@AL00001                                        0604
         LA    @07,@CC01659                                        0604
         ST    @07,@AL00001+4                                      0604
         LA    @07,DUMPLIST                                        0604
         ST    @07,@AFTEMPS                                        0604
         LA    @07,@AFTEMPS                                        0604
         ST    @07,@AL00001+8                                      0604
         MVI   @AL00001+8,X'80'                                    0604
         L     @15,GDTDBG(,@09)                                    0604
         LA    @01,@AL00001                                        0604
         BALR  @14,@15                                             0604
*             CALL IDCSAAL0(GDTTBL,ALLAGL);/*                @Y30LB39
*                                                            @Y30LB39*/
@RT00602 L     @09,@PC00001                                        0605
         ST    @09,@AL00001                                        0605
         LA    @07,ALLAGLBF                                        0605
         ST    @07,@AL00001+4                                      0605
         MVI   @AL00001+4,X'80'                                    0605
         L     @15,GDTALC(,@09)                                    0605
         LA    @01,@AL00001                                        0605
         BALR  @14,@15                                             0605
*             RESPECIFY                                            0606
*               RTNREG RSTD;                                       0606
*             TESTRC=RTNREG;                                       0607
         LR    TESTRC,RTNREG                                       0607
*             RESPECIFY                                            0608
*               RTNREG UNRSTD;      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0608
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* IF UALLOC RETURN CODE IS NOT ZERO, DYNAMIC  @Y30LB39*/
*             /* ALLOCATION FAILED. THE UALLOC FUNCTION      @Y30LB39*/
*             /* ISSUED THE APPROPRIATE MESSAGE.             @Y30LB39*/
*             /* SET THE CONDITION CODE TO 12 PRIOR          @Y30LB39*/
*             /* TO RETURNING TO CALLER.                     @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0609
*                                   /*                       @Y30LB39*/
*             IF TESTRC^=0 THEN     /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0609
         BZ    @RF00609                                            0609
*               FILERC=LASTCC12;    /*                       @Y30LB39*/
         LA    FILERC,12                                           0610
*             IF FILERC=0 THEN      /*                       @Y30LB39*/
@RF00609 C     FILERC,@CF00115                                     0611
         BNE   @RF00611                                            0611
*               DO;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0612
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB39*/
*                 /* SET THE ALLOCFLG ON TO INDICATE THAT    @Y30LB39*/
*                 /* DYNAMIC ALLOCATION WAS DONE.            @ZD00175*/
*                 /*                                         @Y30LB39*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0613
*                                   /*                       @Y30LB39*/
*                 ALLOCFLG=ON;      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0613
         OI    ALLOCFLG,B'00100000'                                0613
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB39*/
*                 /* SAVE DDNAME OF DYNAMICALLY ALLOCATED    @Y30LB39*/
*                 /* UNIT NAME IN THE COPYV INTERNAL TABLE.  @Y30LB39*/
*                 /*                                         @Y30LB39*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0614
*                                   /*                       @Y30LB39*/
*                 CUNITDDN=ALLDDN;  /*                       @Y30LB39*/
         LA    @09,ALLAGLBF                                        0614
         MVC   CUNITDDN(8),ALLDDN(@09)                             0614
*               END;                /*                       @ZD00175*/
*           END;                    /*                       @ZD00175*/
*                                                                  0617
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* USE THE DDNAME AND UCB ADDRESS RETURNED BY        @ZD00175*/
*       /* IDCSA06, SINCE THE VOL IS ALREADY ALLOCATED       @ZD00175*/
*       /* EXCLUSIVELY TO THIS TASK.                         @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0617
*         ELSE                                                     0617
*           ;                       /*                       @ZD00175*/
*                                                                  0617
@RF00576 DS    0H                                                  0618
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* IF NO UNIT IS AVAILABLE FOR THE VOLUME,           @ZD00175*/
*       /* IDCSA06 ISSUED THE APPROPRIATE MESSAGE. SET       @ZD00175*/
*       /* THE CONDITION CODE TO 12 PRIOR TO RETURNING       @ZD00175*/
*       /* TO THE CALLER.                                    @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0618
*       ELSE                                                       0618
*         FILERC=LASTCC12;          /*                       @ZD00175*/
         B     @RC00575                                            0618
@RF00575 LA    FILERC,12                                           0618
*     END;                          /*                       @ZD00175*/
@RC00575 DS    0H                                                  0620
*                                   /*                       #Y30LB39*/
*                                                                  0620
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CHECK RETURN CODE                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0620
*                                   /*                       @Y30LB39*/
*   IF FILERC=0 THEN                /*                       @Y30LB39*/
@RC00564 SLR   @09,@09                                             0620
         CR    FILERC,@09                                          0620
         BNE   @RF00620                                            0620
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0621
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* INITIALIZE CKAGL AND ISSUE UMSSUNIT MACRO         @Y30LB39*/
*       /* TO VERIFY THAT THE DEVICE ALLOCATED IS            @Y30LB39*/
*       /* VIRTUAL.                                          @ZD00175*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0622
*                                   /*                       @Y30LB39*/
*       CKAGL=''B;                  /*                       @Y30LB39*/
         LA    @07,CKAGLBUF                                        0622
         XC    CKAGL(29,@07),CKAGL(@07)                            0622
*       CKUCBPTR=ADDR(CUNITUCB);    /*                       @Y30LB39*/
         LA    @15,CUNITUCB                                        0623
         ST    @15,CKUCBPTR(,@07)                                  0623
*       CKDDNAME=CUNITDDN;          /*                       @Y30LB39*/
         MVC   CKDDNAME(8,@07),CUNITDDN                            0624
*       CKTESTVT=ON;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0625
         OI    CKTESTVT(@07),B'10000000'                           0625
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* DUMP CHECK ARGUMENT LIST PRIOR TO                 @Y30LB39*/
*       /* INVOKING CHECK ALLOCATION ROUTINE.                @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0626
*                                   /*                       @Y30LB39*/
*       IF GDTDBG=NULLPTR THEN                                     0626
         L     @07,@PC00001                                        0626
         C     @09,GDTDBG(,@07)                                    0626
         BE    @RT00626                                            0626
*         ;                                                        0627
*       ELSE                                                       0628
*         DO;                                                      0628
*           DMPINDEX=ADDR(DUMPLIST);/*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   0629
*           DMPITMNM='CKAGLBUF';                                   0630
         MVC   DMPITMNM(8,DMPINDEX),@CC01660                       0630
*           DMPITMPT=ADDR(CKAGLBUF);                               0631
         LA    @09,CKAGLBUF                                        0631
         ST    @09,DMPITMPT(,DMPINDEX)                             0631
*           DMPITMLN=LENGTH(CKAGLBUF);                             0632
         MVC   DMPITMLN(2,DMPINDEX),@CH00847                       0632
*           DMPITMTP='H';                                          0633
         MVI   DMPITMTP(DMPINDEX),C'H'                             0633
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0634
         AL    DMPINDEX,@CF00474                                   0634
*           DMPTRM=DMPTRMVL;                                       0635
         MVI   DMPTRM(DMPINDEX),X'FF'                              0635
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*       IF GDTDBG=NULLPTR THEN                                     0637
@RT00626 L     @09,@PC00001                                        0637
         L     @09,GDTDBG(,@09)                                    0637
         LTR   @09,@09                                             0637
         BZ    @RT00637                                            0637
*         ;                                                        0638
*       ELSE                                                       0639
*         CALL IDCDB010(GDTTBL,'COBB',ADDR(DUMPLIST));/*     @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0639
         ST    @09,@AL00001                                        0639
         LA    @07,@CC01661                                        0639
         ST    @07,@AL00001+4                                      0639
         LA    @07,DUMPLIST                                        0639
         ST    @07,@AFTEMPS                                        0639
         LA    @07,@AFTEMPS                                        0639
         ST    @07,@AL00001+8                                      0639
         MVI   @AL00001+8,X'80'                                    0639
         L     @15,GDTDBG(,@09)                                    0639
         LA    @01,@AL00001                                        0639
         BALR  @14,@15                                             0639
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB39
*                                                            @Y30LB39*/
@RT00637 L     @09,@PC00001                                        0640
         ST    @09,@AL00001                                        0640
         LA    @07,CHECK                                           0640
         ST    @07,@AL00001+4                                      0640
         LA    @07,CKAGLBUF                                        0640
         ST    @07,@AL00001+8                                      0640
         MVI   @AL00001+8,X'80'                                    0640
         L     @15,GDTUNT(,@09)                                    0640
         LA    @01,@AL00001                                        0640
         BALR  @14,@15                                             0640
*       RESPECIFY                                                  0641
*         RTNREG RSTD;                                             0641
*       TESTRC=RTNREG;                                             0642
         LR    TESTRC,RTNREG                                       0642
*       RESPECIFY                                                  0643
*         RTNREG UNRSTD;            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0643
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF UMSSUNIT RETURN CODE IS NOT ZERO, AN           @Y30LB39*/
*       /* APPROPRIATE MESSAGE WAS ISSUED BY THE             @Y30LB39*/
*       /* CHECK FUNCTION. MERELY SET THE CONDITION          @Y30LB39*/
*       /* CODE TO TWELVE PRIOR TO RETURNING TO CALLER       @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0644
*                                   /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0644
         BZ    @RF00644                                            0644
*         FILERC=LASTCC12;          /*                       @Y30LB39*/
         LA    FILERC,12                                           0645
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0646
@RF00644 DS    0H                                                  0647
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0647
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR1;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0647
@RF00620 L     REG14,RETADDR1                                      0647
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0648
*                                   /*                       @Y30LB39*/
*   RETURN CODE(FILERC);            /*                       @Y30LB39*/
         LR    @15,FILERC                                          0648
@EL00006 DS    0H                                                  0648
@EF00006 DS    0H                                                  0648
@ER00006 BR    @14                                                 0648
*   END FILERTN;                    /*                       @Y30LB39*/
*                                                                  0650
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - VSRTN                                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* CHECK PASSWORDS, UPDATE THE VSAM TIMESTAMP, AND       @ZD00175*/
*   /* CHANGE VOL ALLOCATION FROM SHARED TO EXCLUSIVE.       @ZD00175*/
*   /* IDCVS01 IS CALLED TO CHECK THE PASSWORD AND TO        @ZD00175*/
*   /* UPDATE THE TIMESTAMP. IDCSA06 IS CALLED TO IN-        @ZD00175*/
*   /* SURE EXCLUSIVE CONTROL OF THE VOLUME. IF THE          @ZD00175*/
*   /* PASSWORD DATA SET COULD NOT BE CLOSED, PROCESS-       @ZD00175*/
*   /* ING CONTINUES AFTER SETTING CONDITION CODE TO         @ZD00175*/
*   /* FOUR. IF THE PASSWORD CHECK FAILED ALTOGETHER         @Y30LB39*/
*   /* OR IF THE UPDATING OF THE TIMESTAMP FAILED            @Y30LB39*/
*   /* OR IF THE VOL CANNOT BE OBTAINED FOR EXCLUSIVE        @ZD00175*/
*   /* CONTROL THEN A DEQUEUE IS ISSUED SINCE THE COPY       @ZD00175*/
*   /* OPERATION WILL NOT BE ABLE TO BE COMPLETED.           @Y30LB39*/
*   /* THERE ARE NO MESSAGES ISSUED BY THIS                  @Y30LB39*/
*   /* SUBPROCEDURE.                                         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* SECURITY ARGUMENT LIST                                @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* EXCLUSIVE ARGUMENT LIST                               @ZD00175*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 4 - PASSWORD PROTECTED DATA SET COULD NOT             @Y30LB39*/
*   /* BE CLOSED OR UCLOSE FAILED (IF ISSUED).               @Y30LB39*/
*   /* 12 - COPY OPERATION CAN NOT BE PERFORMED              @Y30LB39*/
*   /* BECAUSE THE PASSWORD CHECK FAILED OR                  @Y30LB39*/
*   /* TIMESTAMP COULD NOT BE UPDATED. OR THE                @ZD00175*/
*   /* VOL COULD NOT BE OBTAINED FOR EXCLUSIVE               @ZD00175*/
*   /* CONTROL. COPYVTBL MAY BE UPDATED.                     @ZD00175*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0650
*VSRTN:                                                            0650
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0650
VSRTN    DS    0H                                                  0651
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0651
*                                   /*                       @Y30LB39*/
*   DCL                                                            0651
*     VSRC FIXED(8);                /* RETURN CODE           @Y30LB39*/
*   DCL                                                            0652
*     VOLSERV CHAR(8) CONSTANT('IDCVS01 ');/*                @Y30LB39
*                                      CHARACTER STRING      @Y30LB39
*                                      USED TO IDENTIFY      @Y30LB39
*                                      EXTERNAL ROUTINE.     @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0653
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*                                   /*                       @Y30LB39*/
*   RETADDR1=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0653
         ST    REG14,RETADDR1                                      0653
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0654
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0654
         L     @09,@PC00001                                        0654
         L     @09,GDTTR2(,@09)                                    0654
         MVC   @TS00001(95),NEWERID2(@09)                          0654
         MVC   OLDERID2(95,@09),@TS00001                           0654
*   NEWID2='COVS';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0655
         MVC   NEWID2(4,@09),@CC01668                              0655
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0656
*                                   /*                       @Y30LB39*/
*   VSRC=LASTCC00;                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0656
         SLR   @09,@09                                             0656
         LR    VSRC,@09                                            0656
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE VS1AGL AND REQUEST IDCVS01 TO ISSUE        @Y30LB39*/
*   /* A RESERVE BEFORE MAKING THE PASSWORD CHECK.           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0657
*                                   /*                       @Y30LB39*/
*   VS1AGL=''B;                     /*                       @Y30LB39*/
         LA    @07,VS1AGLBF                                        0657
         XC    VS1AGL(74,@07),VS1AGL(@07)                          0657
*   VSRES=ON;                       /*                       @Y30LB39*/
         OI    VSRES(@07),B'10000000'                              0658
*   VSUCBP=ADDR(CUNITUCB);          /*                       @Y30LB39*/
         LA    @15,CUNITUCB                                        0659
         ST    @15,VSUCBP(,@07)                                    0659
*   VSMASTER=ON;                    /*                       @Y30LB39*/
         OI    VSMASTER(@07),B'01000000'                           0660
*   IF ADDR(CAT)^=NULLPTR THEN      /*                       @Y30LB39*/
         L     @15,@PC00001+4                                      0661
         C     @09,FDTPTR+44(,@15)                                 0661
         BE    @RF00661                                            0661
*     DO;                           /*                       @Y30LB39*/
*       VSCATP=ADDR(CATNMVAL);      /*                       @Y30LB39*/
         L     @01,FDTPTR+48(,@15)                                 0663
         LA    @14,CATNMVAL(,@01)                                  0663
         ST    @14,VSCATP(,@07)                                    0663
*       IF ADDR(CATDN)^=NULLPTR THEN/*                       @Y30LB39*/
         L     @15,FDTPTR+52(,@15)                                 0664
         CR    @15,@09                                             0664
         BE    @RF00664                                            0664
*         VSCATDDP=ADDR(CATDNVAL);  /*                       @Y30LB39*/
         LA    @09,CATDNVAL(,@15)                                  0665
         ST    @09,VSCATDDP(,@07)                                  0665
*       IF CATNMPLN^=0 THEN         /*                       @Y30LB39*/
@RF00664 L     @09,@PC00001+4                                      0666
         L     @09,FDTPTR+48(,@09)                                 0666
         CLI   CATNMPLN(@09),0                                     0666
         BE    @RF00666                                            0666
*         VSPSWDP=ADDR(CATNMPAS);   /*                       @Y30LB39*/
         LA    @07,VS1AGLBF                                        0667
         LA    @09,CATNMPAS(,@09)                                  0667
         ST    @09,VSPSWDP(,@07)                                   0667
*     END;                          /*                       @Y30LB39*/
@RF00666 DS    0H                                                  0669
*   VSREAD=ON;                      /*                       @ZD00175*/
@RF00661 LA    @09,VS1AGLBF                                        0669
         OI    VSREAD(@09),B'00010000'                             0669
*   VSVOLP=ADDR(VOLVAL);            /*                       @ZD00175*/
         L     @07,@PC00001+4                                      0670
         L     @01,FDTPTR(,@07)                                    0670
         LA    @15,VOLVAL(,@01)                                    0670
         ST    @15,VSVOLP(,@09)                                    0670
*   VSFILEP=ADDR(CUNITDDN);         /*                       @ZD00175*/
         LA    @15,CUNITDDN                                        0671
         ST    @15,VSFILEP(,@09)                                   0671
*   VSPFILEP=ADDR(PFILE);           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0672
         L     @07,FDTPTR+64(,@07)                                 0672
         ST    @07,VSPFILEP(,@09)                                  0672
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL              @Y30LB39*/
*   /* TO PROVIDE A FULL REGION DUMP.                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0673
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0673
         L     @09,@PC00001                                        0673
         L     @09,GDTDBG(,@09)                                    0673
         LTR   @09,@09                                             0673
         BZ    @RT00673                                            0673
*     ;                                                            0674
*   ELSE                                                           0675
*     CALL IDCDB010(GDTTBL,'COCH'); /*                       @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0675
         ST    @09,@AL00001                                        0675
         LA    @07,@CC01669                                        0675
         ST    @07,@AL00001+4                                      0675
         MVI   @AL00001+4,X'80'                                    0675
         L     @15,GDTDBG(,@09)                                    0675
         LA    @01,@AL00001                                        0675
         BALR  @14,@15                                             0675
*   CALL IDCSACL0(GDTTBL,VOLSERV,SECCHECK,VS1AGL);/*         @Y30LB39
*                                                            @Y30LB39*/
@RT00673 L     @09,@PC00001                                        0676
         ST    @09,@AL00001                                        0676
         LA    @07,@CC01667                                        0676
         ST    @07,@AL00001+4                                      0676
         LA    @07,SECCHECK                                        0676
         ST    @07,@AL00001+8                                      0676
         LA    @07,VS1AGLBF                                        0676
         ST    @07,@AL00001+12                                     0676
         MVI   @AL00001+12,X'80'                                   0676
         L     @15,GDTCAL(,@09)                                    0676
         LA    @01,@AL00001                                        0676
         BALR  @14,@15                                             0676
*   RESPECIFY                                                      0677
*     RTNREG RSTD;                                                 0677
*   TESTRC=RTNREG;                                                 0678
         LR    TESTRC,RTNREG                                       0678
*   RESPECIFY                                                      0679
*     RTNREG UNRSTD;                /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0680
         LTR   TESTRC,TESTRC                                       0680
         BZ    @RF00680                                            0680
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* RETURN CODE IS NOT ZERO. IF RETURN CODE             @Y30LB39*/
*     /* IS EIGHT THEN A PASSWORD PROTECTED DATA SET         @Y30LB39*/
*     /* COULD NOT BE CLOSED, SO SET CONDITION CODE TO       @Y30LB39*/
*     /* FOUR.                                               @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0681
*                                   /*                       @Y30LB39*/
*     IF TESTRC=8 THEN              /*                       @Y30LB39*/
         C     TESTRC,@CF00179                                     0681
         BNE   @RF00681                                            0681
*       VSRC=LASTCC04;              /*                       @Y30LB39*/
         LA    VSRC,4                                              0682
*     ELSE                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0683
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* RETURN CODE IS FOUR, SECURITY CHECK               @Y30LB39*/
*       /* FAILED AND CONDITION CODE MUST BE SET TO 12       @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0683
*                                   /*                       @Y30LB39*/
*       VSRC=LASTCC12;              /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0683
         B     @RC00681                                            0683
@RF00681 LA    VSRC,12                                             0683
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* FOLLOWING SECCHECK CALL TO IDCVS01                    @Y30LB39*/
*   /* ISSUE UCLOSE FOR VTOC IF VSIOP IS NOT ZERO.           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0684
*                                   /*                       @Y30LB39*/
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB39*/
@RC00681 DS    0H                                                  0684
@RF00680 LA    @09,VS1AGLBF                                        0684
         L     @07,VSIOP(,@09)                                     0684
         LTR   @07,@07                                             0684
         BZ    @RF00684                                            0684
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB39
*                                                            @Y30LB39*/
         L     @07,@PC00001                                        0686
         ST    @07,@AL00001                                        0686
         LA    @09,VSIOP(,@09)                                     0686
         ST    @09,@AL00001+4                                      0686
         MVI   @AL00001+4,X'80'                                    0686
         L     @15,GDTCLS(,@07)                                    0686
         LA    @01,@AL00001                                        0686
         BALR  @14,@15                                             0686
*       RESPECIFY                                                  0687
*         RTNREG RSTD;                                             0687
*       TESTRC=RTNREG;                                             0688
         LR    TESTRC,RTNREG                                       0688
*       RESPECIFY                                                  0689
*         RTNREG UNRSTD;            /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0690
         BZ    @RF00690                                            0690
*         VSRC=MAX(VSRC,LASTCC04);  /*                       @Y30LB39*/
         LA    @09,4                                               0691
         CR    VSRC,@09                                            0691
         BNL   *+6
         LR    VSRC,@09                                            0691
*       VSIOP=NULLPTR;              /*                       @Y30LB39*/
@RF00690 LA    @09,VS1AGLBF                                        0692
         SLR   @07,@07                                             0692
         ST    @07,VSIOP(,@09)                                     0692
*     END;                          /*                       @Y30LB39*/
*                                                                  0693
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE CONDITION CODE IS NOT GREATER THAN             @Y30LB39*/
*   /* EIGHT, IT IS OKAY TO UPDATE THE VSAM                  @Y30LB39*/
*   /* TIMESTAMP.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0694
*                                   /*                       @Y30LB39*/
*   IF VSRC^>LASTCC08 THEN          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0694
@RF00684 C     VSRC,@CF00179                                       0694
         BH    @RF00694                                            0694
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* IF THE VOLUME IS VSAM THEN CALL IDCVS01 TO          @Y30LB39*/
*     /* UPDATE THE FORMAT 4 TIMESTAMP. SET THE              @Y30LB39*/
*     /* RESERVE OPTION BIT OFF FOR THIS CALL TO             @Y30LB39*/
*     /* IDCVS01 BECAUSE THE RESERVE SET DURING              @Y30LB39*/
*     /* THE FIRST CALL TO IDCVS01 IS STILL IN EFFECT.       @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0695
*                                   /*                       @Y30LB39*/
*     IF VSVSAM=ON THEN             /*                       @Y30LB39*/
         LA    @09,VS1AGLBF                                        0695
         TM    VSVSAM(@09),B'10000000'                             0695
         BNO   @RF00695                                            0695
*       DO;                         /*                       @Y30LB39*/
*         VSTIME=ON;                /*                       @Y30LB39*/
         OI    VSTIME(@09),B'10000000'                             0697
*         VSRES=OFF;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0698
         NI    VSRES(@09),B'01111111'                              0698
*         /***********************************************************/
*         /*                                                         */
*         /*                                                 @Y30LB39*/
*         /* ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL        @Y30LB39*/
*         /* TO PROVIDE A FULL REGION DUMP.                  @Y30LB39*/
*         /*                                                 @Y30LB39*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0699
*                                   /*                       @Y30LB39*/
*         IF GDTDBG=NULLPTR THEN                                   0699
         L     @09,@PC00001                                        0699
         L     @09,GDTDBG(,@09)                                    0699
         LTR   @09,@09                                             0699
         BZ    @RT00699                                            0699
*           ;                                                      0700
*         ELSE                                                     0701
*           CALL IDCDB010(GDTTBL,'COPT');/*                  @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0701
         ST    @09,@AL00001                                        0701
         LA    @07,@CC01670                                        0701
         ST    @07,@AL00001+4                                      0701
         MVI   @AL00001+4,X'80'                                    0701
         L     @15,GDTDBG(,@09)                                    0701
         LA    @01,@AL00001                                        0701
         BALR  @14,@15                                             0701
*         CALL IDCSACL0(GDTTBL,VOLSERV,PUTVTOC,VS1AGL);/*    @Y30LB39
*                                                            @Y30LB39*/
@RT00699 L     @09,@PC00001                                        0702
         ST    @09,@AL00001                                        0702
         LA    @07,@CC01667                                        0702
         ST    @07,@AL00001+4                                      0702
         LA    @07,PUTVTOC                                         0702
         ST    @07,@AL00001+8                                      0702
         LA    @07,VS1AGLBF                                        0702
         ST    @07,@AL00001+12                                     0702
         MVI   @AL00001+12,X'80'                                   0702
         L     @15,GDTCAL(,@09)                                    0702
         LA    @01,@AL00001                                        0702
         BALR  @14,@15                                             0702
*         RESPECIFY                                                0703
*           RTNREG RSTD;                                           0703
*         TESTRC=RTNREG;                                           0704
         LR    TESTRC,RTNREG                                       0704
*         RESPECIFY                                                0705
*           RTNREG UNRSTD;          /*                       @Y30LB39*/
*         IF TESTRC^=0 THEN         /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0706
         BZ    @RF00706                                            0706
*           VSRC=LASTCC12;          /*                       @Y30LB39*/
         LA    VSRC,12                                             0707
*       END;                        /*                       @Y30LB39*/
@RF00706 DS    0H                                                  0709
*                                   /*                       @Y30LB39*/
*                                                                  0709
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UCLOSE FOR VTOC IF VSIOP IS NOT ZERO.           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*                                   /*                       @Y30LB39*/
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB39*/
@RF00695 DS    0H                                                  0709
@RF00694 LA    @09,VS1AGLBF                                        0709
         L     @07,VSIOP(,@09)                                     0709
         LTR   @07,@07                                             0709
         BZ    @RF00709                                            0709
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB39
*                                                            @Y30LB39*/
         L     @07,@PC00001                                        0711
         ST    @07,@AL00001                                        0711
         LA    @09,VSIOP(,@09)                                     0711
         ST    @09,@AL00001+4                                      0711
         MVI   @AL00001+4,X'80'                                    0711
         L     @15,GDTCLS(,@07)                                    0711
         LA    @01,@AL00001                                        0711
         BALR  @14,@15                                             0711
*       RESPECIFY                                                  0712
*         RTNREG RSTD;                                             0712
*       TESTRC=RTNREG;                                             0713
         LR    TESTRC,RTNREG                                       0713
*       RESPECIFY                                                  0714
*         RTNREG UNRSTD;            /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0715
         BZ    @RF00715                                            0715
*         VSRC=MAX(VSRC,LASTCC04);  /*                       @Y30LB39*/
         LA    @09,4                                               0716
         CR    VSRC,@09                                            0716
         BNL   *+6
         LR    VSRC,@09                                            0716
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0717
@RF00715 DS    0H                                                  0718
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @ZD00175*/
*   /* BEFORE PERFORMING THE COPY OPERATION,                 @ZD00175*/
*   /* INITIALIZE THE EXCLAGL AND CALL IDCSA06 TO            @ZD00175*/
*   /* INSURE THAT THE UNIT AND VOLUME MOUNTED ON            @ZD00175*/
*   /* IT ARE ALLOCATED TO THIS TASK FOR EXCLUSIVE           @ZD00175*/
*   /* CONTROL WITHIN THE OPERATING SYSTEM. MAKE             @ZD00175*/
*   /* THIS CHECK IF THE UNIT WAS ALLOCATED DYNAM-           @ZD00175*/
*   /* ICALLY OR VIA THE FILE PARAMETER.                     @ZD00175*/
*   /*                                                       @ZD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0718
*   IF VSRC<LASTCC12&(ADDR(FILE)^=NULLPTRALLOCFLG=ON) THEN        0718
@RF00709 C     VSRC,@CF00567                                       0718
         BNL   @RF00718                                            0718
         L     @09,@PC00001+4                                      0718
         L     @09,FDTPTR+56(,@09)                                 0718
         LTR   @09,@09                                             0718
         BNZ   @RT00718                                            0718
         TM    ALLOCFLG,B'00100000'                                0718
         BNO   @RF00718                                            0718
@RT00718 DS    0H                                                  0719
*     DO;                           /*                       @ZD00175*/
*       EXCLAGL=''B;                /*                       @ZD00175*/
         LA    @09,EXCLAGLB                                        0720
         XC    EXCLAGL(23,@09),EXCLAGL(@09)                        0720
*       EXCLUCBP=ADDR(CUNITUCB);    /*                       @ZD00175*/
         LA    @07,CUNITUCB                                        0721
         ST    @07,EXCLUCBP(,@09)                                  0721
*       EXCLDDP=ADDR(CUNITDDN);     /*                       @ZD00175*/
*                                                                  0722
         LA    @07,CUNITDDN                                        0722
         ST    @07,EXCLDDP(,@09)                                   0722
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* TAKE A FULL REGION DUMP PRIOR TO THE EXTER-       @ZD00175*/
*       /* NAL CALL TO IDCSA06.                              @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0723
*       IF GDTDBG=NULLPTR THEN                                     0723
         L     @09,@PC00001                                        0723
         L     @09,GDTDBG(,@09)                                    0723
         LTR   @09,@09                                             0723
         BZ    @RT00723                                            0723
*         ;                                                        0724
*       ELSE                                                       0725
*         CALL IDCDB010(GDTTBL,'COII');/*                    @ZD00175*/
         L     @09,@PC00001                                        0725
         ST    @09,@AL00001                                        0725
         LA    @07,@CC01671                                        0725
         ST    @07,@AL00001+4                                      0725
         MVI   @AL00001+4,X'80'                                    0725
         L     @15,GDTDBG(,@09)                                    0725
         LA    @01,@AL00001                                        0725
         BALR  @14,@15                                             0725
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @ZD00175*/
@RT00723 L     @09,@PC00001                                        0726
         ST    @09,@AL00001                                        0726
         LA    @07,CHANGEX                                         0726
         ST    @07,@AL00001+4                                      0726
         LA    @07,EXCLAGLB                                        0726
         ST    @07,@AL00001+8                                      0726
         MVI   @AL00001+8,X'80'                                    0726
         L     @15,GDTUNT(,@09)                                    0726
         LA    @01,@AL00001                                        0726
         BALR  @14,@15                                             0726
*       RESPECIFY                                                  0727
*         RTNREG RSTD;                                             0727
*       TESTRC=RTNREG;                                             0728
         LR    TESTRC,RTNREG                                       0728
*       RESPECIFY                                                  0729
*         RTNREG UNRSTD;            /*                       @ZD00175*/
*                                                                  0729
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZD00175*/
*       /* IF THE REQUEST TO CHANGE THE VOL ALLOCATION       @ZD00175*/
*       /* FROM SHARED TO EXCLUSIVE FAILED, RETURN TO        @ZD00175*/
*       /* THE CALLER AND DO NOT PERFORM THE COPY.           @ZD00175*/
*       /*                                                   @ZD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0730
*       IF TESTRC^=0 THEN                                          0730
         LTR   TESTRC,TESTRC                                       0730
         BZ    @RF00730                                            0730
*         VSRC=LASTCC12;            /*                       @ZD00175*/
         LA    VSRC,12                                             0731
*     END;                          /*                       @ZD00175*/
*                                                                  0732
@RF00730 DS    0H                                                  0733
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       #Y30LB39*/
*   /* CHECK RETURN CODE                                     #Y30LB39*/
*   /*                                                       #Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0733
*                                   /*                       @Y30LB39*/
*   IF VSRC>LASTCC08 THEN           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0733
@RF00718 C     VSRC,@CF00179                                       0733
         BNH   @RF00733                                            0733
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* IF THE CONDITION CODE IS GREATER THAN EIGHT,        @Y30LB39*/
*     /* THEN THE COPY OPERATION CANNOT BE PERFORMED.        @Y30LB39*/
*     /* ISSUE UDEQ TO RELEASE THE RESERVE SET BY            @Y30LB39*/
*     /* IDCVS01.                                            @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0734
*                                   /*                       @Y30LB39*/
*     RNAMCHAR(7:22)='.VIRTUAL.RESERVE';/*                   @ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01672                             0734
*   CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0735
@RF00733 L     @09,@PC00001                                        0735
         ST    @09,@AL00001                                        0735
         LA    @07,@CC01617                                        0735
         ST    @07,@AL00001+4                                      0735
         LA    @07,MINORNAM                                        0735
         ST    @07,@AL00001+8                                      0735
         MVI   @AL00001+8,X'80'                                    0735
         L     @15,GDTDEQ(,@09)                                    0735
         LA    @01,@AL00001                                        0735
         BALR  @14,@15                                             0735
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0736
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR1;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0736
         L     REG14,RETADDR1                                      0736
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0737
*                                   /*                       @Y30LB39*/
*   RETURN CODE(VSRC);              /*                       @Y30LB39*/
         LR    @15,VSRC                                            0737
@EL00007 DS    0H                                                  0737
@EF00007 DS    0H                                                  0737
@ER00007 BR    @14                                                 0737
*   END VSRTN;                      /*                       @Y30LB39*/
*                                                                  0739
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - WORKRTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* DIRECT THE COPY OPERATION.                            @Y30LB39*/
*   /* IF CARTRIDGES CAN NOT BE REUSED, THEN A CALL          @Y30LB39*/
*   /* IS MADE TO CRVRTN TO CREATE A NEW                     @Y30LB39*/
*   /* TARGET VOLUME FROM SCRATCH CARTRIDGES.                @Y30LB39*/
*   /* PROVIDING THAT EVERYTHING IS STILL OKAY AT THIS       @Y30LB39*/
*   /* POINT, THEN THE SOURCE VOLUME IS DEMOUNTED            @Y30LB39*/
*   /* BY DMNTRTN SUB-PROCEDURE.                             @Y30LB39*/
*   /* THE SOURCE VOLUME IS COPIED AND IF THE RETURN         @Y30LB39*/
*   /* CODE FROM THE COPYRTN SUBPROCEDURE IS OK, THEN        @Y30LB39*/
*   /* THE OWNER INFORMATION IS UPDATED BY LABELRTN.         @Y30LB39*/
*   /* IF THE COPY IS TO BE EJECTED, THEN A CALL             @Y30LB39*/
*   /* IS MADE TO THE VOLUME EJECT ROUTINE(VOLEXIT).         @Y30LB39*/
*   /* IF VSAM USER CATALOG MAY BE ON THE SOURCE             @ZD00175*/
*   /* VOLUME, IDCSA06 IS CALLED TO REMOUNT THE VOLUME.@ZD00175      */
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/
*   /* IDC3706I IF TARGET WAS AN INCOMPLETE COPY VOL.        @Y30LB39*/
*   /* IDC3709I IF OLDEST BACKUP WAS SELECTED AS             @Y30LB39*/
*   /* TARGET VOLUME.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* DYNAMIC ARGUMENT LIST (DARGLIST)                      @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /* FORMAT OF A COPY VOLUME RECORD                        @Y30LB39*/
*   /* MOUNT ARGUMENT LIST                                   @ZM00175*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* AND COPYVTBL MAY BE UPDATED.                          @Y30LB39*/
*   /* 4 - IF VOLUME LABEL INFORMATION COULD NOT             @Y30LB39*/
*   /* BE UPDATED OR VOLUME COULD NOT BE                     @ZD00175*/
*   /* REMOUNTED AFTER SUCCESSFUL COPY.                      @ZD00175*/
*   /* 8 - IF UNABLE TO EJECT CARTRIDGES FROM MASS           @Y30LB39*/
*   /* STORAGE FACILITY.                                     @Y30LB39*/
*   /* 12 - IF UNABLE TO CREATE A NEW TARGET VOLUME          @Y30LB39*/
*   /* FROM SCRATCH CARTRIDGES OR UNABLE TO                  @Y30LB39*/
*   /* DEMOUNT SOURCE VOLUME OR UNABLE TO COPY               @Y30LB39*/
*   /* SOURCE VOLUMM.                                        @Y30LB39*/
*   /* COPYVTBL MAY BE UPDATED.                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0739
*WORKRTN:                                                          0739
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0739
WORKRTN  DS    0H                                                  0740
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0740
*                                   /*                       @Y30LB39*/
*   DCL                                                            0740
*     SAVEFLG BIT(1) BDY(BYTE);     /* PARAMETER SET         @Y30LB39
*                                      WHEN (IF) CALLING     @Y30LB39
*                                      ROUTING VOLEXIT       @Y30LB39*/
*   DCL                                                            0741
*     WORKRC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*   DCL                                                            0742
*     DATAVALU CHAR(30) BDY(BYTE);  /* PARAMETER SET         @Y30LB39
*                                      WHEN (IF) CALLING     @Y30LB39
*                                      ROUTINE VOLEXIT       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0743
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0743
*                                   /*                       @Y30LB39*/
*   RETADDR1=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0743
         ST    REG14,RETADDR1                                      0743
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0744
         L     @09,@PC00001                                        0744
         L     @09,GDTTR2(,@09)                                    0744
         MVC   @TS00001(95),NEWERID2(@09)                          0744
         MVC   OLDERID2(95,@09),@TS00001                           0744
*   NEWID2='COWK';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0745
         MVC   NEWID2(4,@09),@CC01680                              0745
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0746
*                                   /*                       @Y30LB39*/
*   WORKRC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0746
         SLR   WORKRC,WORKRC                                       0746
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF AN EXISTING VOLUME CANNOT BE REUSED,               @Y30LB39*/
*   /* THEN CALL CRVRTN TO                                   @Y30LB39*/
*   /* CREATE A NEW TARGET VOLUME FROM SCRATCH               @Y30LB39*/
*   /* CARTRIDGES. IF THE RETURN CODE IS NOT ZERO,           @Y30LB39*/
*   /* SET THE CONDITION CODE TO 12 AND EXIT ROUTINE.        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0747
*                                   /*                       @Y30LB39*/
*   IF REUSEFLG=OFF THEN            /*                       @Y30LB39*/
         TM    REUSEFLG,B'10000000'                                0747
         BNZ   @RF00747                                            0747
*     DO;                           /*                       @Y30LB39*/
*       CALL CRVRTN;                /*                       @Y30LB39*/
         BAL   @14,CRVRTN                                          0749
*       RESPECIFY                                                  0750
*         RTNREG RSTD;                                             0750
*       TESTRC=RTNREG;                                             0751
         LR    TESTRC,RTNREG                                       0751
*       RESPECIFY                                                  0752
*         RTNREG UNRSTD;            /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0753
         BZ    @RF00753                                            0753
*         WORKRC=LASTCC12;          /*                       @Y30LB39*/
         LA    WORKRC,12                                           0754
*     END;                          /*                       @Y30LB39*/
@RF00753 DS    0H                                                  0756
*                                   /*                       @Y30LB39*/
*                                                                  0756
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CHECK RETURN CODE                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0756
*                                   /*                       @Y30LB39*/
*   IF WORKRC=0 THEN                /*                       @Y30LB39*/
@RF00747 C     WORKRC,@CF00115                                     0756
         BNE   @RF00756                                            0756
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0757
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CALL DMNTRTN TO DEMOUNT THE SOURCE VOLUME.        @Y30LB39*/
*       /* NOT DEMOUNTING THE SOURCE VOLUME UNTIL            @Y30LB39*/
*       /* IMMIDIATELY PRIOR TO THE COPY OPERATION           @Y30LB39*/
*       /* REDUCES THE EXPOSURE OF ANOTHER SYSTEM            @Y30LB39*/
*       /* MOUNTING THE VOLUME BEFORE COPYV PERFORMS         @Y30LB39*/
*       /* THE COPY.                                         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0758
*                                   /*                       @Y30LB39*/
*       CALL DMNTRTN;               /*                       @Y30LB39*/
         BAL   @14,DMNTRTN                                         0758
*       RESPECIFY                                                  0759
*         RTNREG RSTD;                                             0759
*       TESTRC=RTNREG;                                             0760
         LR    TESTRC,RTNREG                                       0760
*       RESPECIFY                                                  0761
*         RTNREG UNRSTD;            /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0762
         BZ    @RF00762                                            0762
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0763
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* AFTER SETTING THE CONDITION CODE TO 12,       @Y30LB39*/
*           /* SET THE MESSAGE IDC0009I IF THE               @Y30LB39*/
*           /* OBKUPFLG IS ON (THIS MEANS THAT THE           @Y30LB39*/
*           /* OLDEST BACKUP WAS SELECTED AS THE             @Y30LB39*/
*           /* TARGET VOLUME.                                @Y30LB39*/
*           /* OTHERWISE, SET THE MESSAGE IDC0006I           @Y30LB39*/
*           /* SINCE THE TARGET IS AN INCOMPLETE COPY        @Y30LB39*/
*           /* VOLUME. ISSUE UPRINT FOR THE APPROPRI-        @Y30LB39*/
*           /* ATE SECONDARY MESSAGE.                        @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0764
*                                   /*                       @Y30LB39*/
*           WORKRC=LASTCC12;        /*                       @Y30LB39*/
         LA    WORKRC,12                                           0764
*           DARGLIST=''B;           /*                       @Y30LB39*/
         L     @09,DDSTRU                                          0765
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0765
*           DARGSMOD=COPYMSG;       /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01548                            0766
*           IF OBKUPFLG=ON THEN     /*                       @Y30LB39*/
         TM    OBKUPFLG,B'01000000'                                0767
         BNO   @RF00767                                            0767
*             DARGSENT=MSG3709I;    /*                       @Y30LB39*/
         MVI   DARGSENT(@09),X'0A'                                 0768
*           ELSE                    /*                       @Y30LB39*/
*             DARGSENT=MSG3706I;    /*                       @Y30LB39*/
         B     @RC00767                                            0769
@RF00767 L     @09,DDSTRU                                          0769
         MVI   DARGSENT(@09),X'07'                                 0769
*           DARGDBP=ADDR(CSN1AREA); /*                       @Y30LB39*/
@RC00767 L     @09,DDSTRU                                          0770
         LA    @04,CSN1AREA                                        0770
         ST    @04,DARGDBP(,@09)                                   0770
*           DARGILP=LENGTH(CSN1AREA);/*                      @Y30LB39*/
         LA    @04,12                                              0771
         STH   @04,DARGILP(,@09)                                   0771
*           DARGCNT=CSN2INST;       /*                       @Y30LB39*/
         LA    @15,1                                               0772
         STH   @15,DARGCNT(,@09)                                   0772
*           DARGINS(1)=CSN2INST;    /*                       @Y30LB39*/
         STH   @15,DARGINS(,@09)                                   0773
*           DARGINL(1)=LENGTH(CSN2AREA);/*                   @Y30LB39*/
         STH   @04,DARGINL(,@09)                                   0774
*           DARGDTM(1)=ADDR(CSN2AREA);/*                     @Y30LB39
*                                                            @Y30LB39*/
         LA    @04,CSN2AREA                                        0775
         ST    @04,DARGDTM(,@09)                                   0775
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        0776
         ST    @09,@AL00001                                        0776
         LA    @04,@CF00115                                        0776
         ST    @04,@AL00001+4                                      0776
         LA    @04,DDSTRU                                          0776
         ST    @04,@AL00001+8                                      0776
         MVI   @AL00001+8,X'80'                                    0776
         L     @15,GDTPRT(,@09)                                    0776
         LA    @01,@AL00001                                        0776
         BALR  @14,@15                                             0776
*         END;                      /*                       @Y30LB39*/
*       IF WORKRC=0 THEN            /*                       @Y30LB39*/
@RF00762 C     WORKRC,@CF00115                                     0778
         BNE   @RF00778                                            0778
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0779
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* CALL COPYRTN TO COPY THE SOURCE VOLUME.       @Y30LB39*/
*           /* IF THE RETURN CODE IS NOT ZERO, EXIT          @Y30LB39*/
*           /* THIS ROUTINE.                                 @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0780
*                                   /*                       @Y30LB39*/
*           CALL COPYRTN;           /*                       @Y30LB39*/
         BAL   @14,COPYRTN                                         0780
*           RESPECIFY                                              0781
*             RTNREG RSTD;                                         0781
*           TESTRC=RTNREG;                                         0782
         LR    TESTRC,RTNREG                                       0782
*           RESPECIFY                                              0783
*             RTNREG UNRSTD;        /*                       @Y30LB39*/
*           IF TESTRC^=0 THEN       /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0784
         BZ    @RF00784                                            0784
*             WORKRC=LASTCC12;      /*                       @Y30LB39*/
         LA    WORKRC,12                                           0785
*           ELSE                    /*                       @ZD00175*/
*             DO;                   /*                       @ZD00175
*                                                            @Y30LB39*/
*                                                                  0786
         B     @RC00784                                            0786
@RF00784 DS    0H                                                  0787
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB39*/
*               /* CALL LABELRTN IF REUSEFLG BIT IS ON AND   @Y30LB39*/
*               /* THE OWNER MUST BE UPDATED. THIS MIS-      @Y30LB39*/
*               /* MATCH BETWEEN COPY AND BASE VOLUME        @Y30LB39*/
*               /* OWNERS OCCURED IF THE COPY WAS MADE TO    @Y30LB39*/
*               /* AN EXISTING COPY VOLUME. THE LABELRTN     @Y30LB39*/
*               /* WILL UPDATE THE OWNER IN THE CARTRIDGE    @Y30LB39*/
*               /* LABELS AND INVENTORY RECORD TO AGREE      @Y30LB39*/
*               /* WITH THE VOLUME LABEL.                    @Y30LB39*/
*               /*                                           @Y30LB39*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0787
*                                   /*                       @Y30LB39*/
*               IF REUSEFLG=ON&BASOWNER^=COPOWNER THEN/*     @Y30LB39*/
         TM    REUSEFLG,B'10000000'                                0787
         BNO   @RF00787                                            0787
         CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            0787
         BE    @RF00787                                            0787
*                 DO;               /*                       @Y30LB39*/
*                   CALL LABELRTN;  /*                       @Y30LB39*/
         BAL   @14,LABELRTN                                        0789
*                   RESPECIFY                                      0790
*                     RTNREG RSTD;                                 0790
*                   TESTRC=RTNREG;                                 0791
         LR    TESTRC,RTNREG                                       0791
*                   RESPECIFY                                      0792
*                     RTNREG UNRSTD;/*                       @Y30LB39*/
*                   IF TESTRC^=0 THEN/*                      @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0793
         BZ    @RF00793                                            0793
*                     WORKRC=LASTCC04;/*                     @Y30LB39*/
         LA    WORKRC,4                                            0794
*                 END;              /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0795
@RF00793 DS    0H                                                  0796
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB39*/
*               /* CALL VOLEXIT, IF EJECT IS SPECIFIED,      @Y30LB39*/
*               /* TO EJECT THE COPY FROM THE MASS STORAGE   @Y30LB39*/
*               /* FACILITY.                                 @Y30LB39*/
*               /*                                           @Y30LB39*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0796
*                                   /*                       @Y30LB39*/
*               IF ADDR(EJECT)^=NULLPTR THEN/*               @Y30LB39*/
@RF00787 SLR   @09,@09                                             0796
         L     @04,@PC00001+4                                      0796
         C     @09,FDTPTR+24(,@04)                                 0796
         BE    @RF00796                                            0796
*                 DO;               /*                       @Y30LB39*/
*                   IF ADDR(REC)^=NULLPTR THEN/*             @Y30LB39*/
         C     @09,FDTPTR+32(,@04)                                 0798
         BE    @RF00798                                            0798
*                     SAVEFLG=ON;   /*                       @Y30LB39*/
         OI    SAVEFLG,B'10000000'                                 0799
*                   ELSE            /*                       @Y30LB39*/
*                     SAVEFLG=OFF;  /*                       @Y30LB39*/
         B     @RC00798                                            0800
@RF00798 NI    SAVEFLG,B'01111111'                                 0800
*                   IF ADDR(LOC)^=NULLPTR THEN/*             @Y30LB39*/
@RC00798 L     @09,@PC00001+4                                      0801
         L     @09,FDTPTR+40(,@09)                                 0801
         LTR   @09,@09                                             0801
         BZ    @RF00801                                            0801
*                     DATAVALU=LOCVAL;/*                     @Y30LB39*/
         MVC   DATAVALU(30),LOCVAL(@09)                            0802
*                   ELSE            /*                       @Y30LB39*/
*                     DATAVALU=BLNKAREA;/*                   @Y30LB39*/
         B     @RC00801                                            0803
@RF00801 MVI   DATAVALU+1,C' '                                     0803
         MVC   DATAVALU+2(28),DATAVALU+1                           0803
         MVC   DATAVALU(1),BLNKAREA                                0803
*                   CALL VOLEXIT(CSN1AREA,VOLVAL,IOERRFLG,SAVEFLG, 0804
*                       DATAVALU);  /*                       @Y30LB39*/
@RC00801 LA    @09,CSN1AREA                                        0804
         ST    @09,@AL00001                                        0804
         L     @09,@PC00001+4                                      0804
         L     @09,FDTPTR(,@09)                                    0804
         LA    @09,VOLVAL(,@09)                                    0804
         ST    @09,@AL00001+4                                      0804
         LA    @09,IOERRFLG                                        0804
         ST    @09,@AL00001+8                                      0804
         LA    @09,SAVEFLG                                         0804
         ST    @09,@AL00001+12                                     0804
         LA    @09,DATAVALU                                        0804
         ST    @09,@AL00001+16                                     0804
         LA    @01,@AL00001                                        0804
         BAL   @14,VOLEXIT                                         0804
*                   RESPECIFY                                      0805
*                     RTNREG RSTD;                                 0805
*                   TESTRC=RTNREG;                                 0806
         LR    TESTRC,RTNREG                                       0806
*                   RESPECIFY                                      0807
*                     RTNREG UNRSTD;/*                       @Y30LB39*/
*                   IF TESTRC^=0 THEN/*                      @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0808
         BZ    @RF00808                                            0808
*                     WORKRC=LASTCC08;/*                     @Y30LB39*/
         LA    WORKRC,8                                            0809
*                 END;              /*                       @Y30LB39*/
@RF00808 DS    0H                                                  0811
*             END;                  /*                       @Y30LB39*/
@RF00796 DS    0H                                                  0812
*                                                                  0812
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @ZD00175*/
*           /* MOUNT THE SOURCE VOLUME. THE SECURITY         @XD00175*/
*           /* CHECK DONE BY IDCVS01 MAY HAVE RESULTED IN    @XD00175*/
*           /* DYNAMIC ALLOCATION OF A VSAM PRIVATE CATALOG. @ZD00175*/
*           /* THEREFORE THE VOLUME MUST REMAIN MOUNTED      @ZD00175*/
*           /* AT EOJ SINCE THE VSAM PRIVATE CATALOG IS STILL        */
*           /*                                               @ZD00175*/
*           /* OPEN.                                         @ZD00175*/
*           /*                                               @ZD00175*/
*           /*                                               @ZD00175*/
*           /* MOUNT THE VOLUME. NOTE THAT MDAGL WAS         @ZD00175*/
*           /* INITIALIZED IN THE DMNTRTN PROCEDURE.         @ZD00175*/
*           /*                                               @ZD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0812
*           MDWAIT=OFF;             /*                       @ZD00175*/
@RC00784 LA    @09,MDAGLBUF                                        0812
         NI    MDWAIT(@09),B'11101111'                             0812
*           IF GDTDBG=NULLPTR THEN                                 0813
         L     @09,@PC00001                                        0813
         L     @09,GDTDBG(,@09)                                    0813
         LTR   @09,@09                                             0813
         BZ    @RT00813                                            0813
*             ;                                                    0814
*           ELSE                                                   0815
*             CALL IDCDB010(GDTTBL,'COJJ');/*                @ZD00175*/
         L     @09,@PC00001                                        0815
         ST    @09,@AL00001                                        0815
         LA    @04,@CC01686                                        0815
         ST    @04,@AL00001+4                                      0815
         MVI   @AL00001+4,X'80'                                    0815
         L     @15,GDTDBG(,@09)                                    0815
         LA    @01,@AL00001                                        0815
         BALR  @14,@15                                             0815
*           CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*             @ZD00175*/
@RT00813 L     @09,@PC00001                                        0816
         ST    @09,@AL00001                                        0816
         LA    @04,MOUNT                                           0816
         ST    @04,@AL00001+4                                      0816
         LA    @04,MDAGLBUF                                        0816
         ST    @04,@AL00001+8                                      0816
         MVI   @AL00001+8,X'80'                                    0816
         L     @15,GDTUNT(,@09)                                    0816
         LA    @01,@AL00001                                        0816
         BALR  @14,@15                                             0816
*           RESPECIFY                                              0817
*             RTNREG RSTD;                                         0817
*           TESTRC=RTNREG;                                         0818
         LR    TESTRC,RTNREG                                       0818
*           RESPECIFY                                              0819
*             RTNREG UNRSTD;        /*                       @ZD00175*/
*                                                                  0819
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @ZD00175*/
*           /* IF THE VOLUME CANNOT BE REMOUNTED, SET AN     @ZD00175*/
*           /* ERROR CODE AND CONTINUE PROCESSING.           @ZD00175*/
*           /*                                               @ZD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0820
*           IF TESTRC^=0 THEN                                      0820
         LTR   TESTRC,TESTRC                                       0820
         BZ    @RF00820                                            0820
*             WORKRC=MAX(WORKRC,LASTCC04);/*                 @ZD00175*/
         LA    @09,4                                               0821
         CR    WORKRC,@09                                          0821
         BNL   *+6
         LR    WORKRC,@09                                          0821
*         END;                      /*                       @ZD00175*/
@RF00820 DS    0H                                                  0823
*     END;                          /*                       #Y30LB39
*                                                            #Y30LB39*/
*                                                                  0823
@RF00778 DS    0H                                                  0824
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       #Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0824
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR1;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0824
@RF00756 L     REG14,RETADDR1                                      0824
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0825
*                                   /*                       @Y30LB39*/
*   RETURN CODE(WORKRC);            /*                       @Y30LB39*/
         LR    @15,WORKRC                                          0825
@EL00008 DS    0H                                                  0825
@EF00008 DS    0H                                                  0825
@ER00008 BR    @14                                                 0825
*   END WORKRTN;                    /*                       @Y30LB39*/
*                                                                  0827
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - CRVRTN                               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* CREATE VIA THE MSSC DEFINE ORDER A NEW TARGET         @Y30LB39*/
*   /* VOLUME FOR THE COPY OPERATION.                        @Y30LB39*/
*   /* IF THE DEFINE GOES OKAY, THEN A CHECK IS MADE         @Y30LB39*/
*   /* TO SEE IF THE CARTRIDGES HAD BEEN RANDOMLY            @Y30LB39*/
*   /* SELECTED. IF THEY HAD BEEN, THEN THE CARTRIDGE        @Y30LB39*/
*   /* SERIAL NUMBERS ARE SAVED IN THE COPYV INTERNAL        @Y30LB39*/
*   /* TABLE FOR USE BY A LATER SUB-PROCEDURE.               @Y30LB39*/
*   /* IF THE DEFINE DOES NOT GO OKAY, THEN                  @Y30LB39*/
*   /* MESSAGE IDC3708I IS                                   @Y30LB39*/
*   /* ISSUED.                                               @Y30LB39*/
*   /* ALSO CALLS SSCMSG TO OUTPUT APPROPRIATE REASON        @Y30LB39*/
*   /* CODE IF THE DEFINE ORDER FAILED.                      @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* DYNAMIC ARGUMENT LIST(DARGLIST)                       @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* MSSC DEFINE VOLUME PARAMETER LIST                     @Y30LB39*/
*   /* EXTENDED ICBDEFV PARM LIST FOR MSVC                   @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY AND                 @Y30LB39*/
*   /* COPYVTBL UPDATED                                      @Y30LB39*/
*   /* 4 - DEFINE FAILED, VOLUME NOT CREATED                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*CRVRTN:                                                           0827
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0827
CRVRTN   DS    0H                                                  0828
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0828
*                                   /*                       @Y30LB39*/
*   DCL                                                            0828
*     CRVRC FIXED(8);               /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0829
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0829
*                                   /*                       @Y30LB39*/
*   RETADDR2=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0829
         LR    RETADDR2,REG14                                      0829
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0830
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0830
         L     @15,@PC00001                                        0830
         L     @15,GDTTR2(,@15)                                    0830
         MVC   @TS00001(95),NEWERID2(@15)                          0830
         MVC   OLDERID2(95,@15),@TS00001                           0830
*   NEWID2='COCR';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0831
         MVC   NEWID2(4,@15),@CC01691                              0831
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0832
*                                   /*                       @Y30LB39*/
*   CRVRC=LASTCC00;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0832
         SLR   CRVRC,CRVRC                                         0832
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE MSVC EXTENSION LIST FOR DEFINING       @Y30LB39*/
*   /* A VOLUME                                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*                                   /*                       @Y30LB39*/
*   DEFVE=''B;                      /*                       @Y30LB39*/
         L     @15,DEFVEPTR                                        0833
         XC    DEFVE(64,@15),DEFVE(@15)                            0833
*   DEFLNGTH=DEFLEN;                /*                       @Y30LB39*/
         LH    @14,DEFLEN                                          0834
         ST    @14,DEFLNGTH(,@15)                                  0834
*   DEFDESCR=DESCRVAL;              /*                       @Y30LB39*/
         L     @14,@PC00001+4                                      0835
         L     @01,FDTPTR+20(,@14)                                 0835
         MVC   DEFDESCR(30,@15),DESCRVAL(@01)                      0835
*   DEFPDESC=ON;                    /*                       @Y30LB39*/
         OI    DEFPDESC(@15),B'00010000'                           0836
*   DEFCOPY=ON;                     /*                       @Y30LB39*/
         OI    DEFCOPY(@15),B'00010000'                            0837
*   DEFSRCVY=ON;                    /*                       @Y30LB39*/
         OI    DEFSRCVY(@15),B'10000000'                           0838
*   DEFICOPY=ON;                    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0839
         OI    DEFICOPY(@15),B'10000000'                           0839
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE MSVC LIST FOR DEFINING A VOLUME        @Y30LB39*/
*   /* THE MSS MOUNTING CHARACTERISTICS ARE OBTAINED         @Y30LB39*/
*   /* FROM THE SOURCE VOLUME RECORD.                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0840
*                                   /*                       @Y30LB39*/
*   DEFLIST=''B;                    /*                       @Y30LB39*/
         L     @15,DEFVPTR                                         0840
         XC    DEFLIST(132,@15),DEFLIST(@15)                       0840
*   DEFVCR=ON;                      /*                       @Y30LB39*/
         OI    DEFVCR(@15),B'10000000'                             0841
*   DEFVLIB=MSFVAL;                 /*                       @Y30LB39*/
         L     @01,FDTPTR+60(,@14)                                 0842
         MVC   DEFVLIB(1,@15),MSFVAL+3(@01)                        0842
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB39*/
         L     @01,FDTPTR(,@14)                                    0843
         MVC   DEFVOLD(6,@15),VOLVAL(@01)                          0843
*   IF BASDAERA=ON THEN             /*                       @Y30LB39*/
         TM    BASDAERA(BASEVPTR),B'10000000'                      0844
         BNO   @RF00844                                            0844
*     DEFVSEC=ON;                   /*                       @Y30LB39*/
         OI    DEFVSEC(@15),B'00100000'                            0845
*   IF BASEXCL=ON THEN              /*                       @Y30LB39*/
@RF00844 TM    BASEXCL(BASEVPTR),B'00000001'                       0846
         BNO   @RF00846                                            0846
*     DEFVEXCL=ON;                  /*                       @Y30LB39*/
         L     @01,DEFVPTR                                         0847
         OI    DEFVEXCL(@01),B'00010000'                           0847
*   IF BASBIND=ON THEN              /*                       @Y30LB39*/
@RF00846 TM    BASBIND(BASEVPTR),B'00000010'                       0848
         BNO   @RF00848                                            0848
*     DEFVBIND=ON;                  /*                       @Y30LB39*/
         L     @01,DEFVPTR                                         0849
         OI    DEFVBIND(@01),B'00000100'                           0849
*   IF BASRONLY=ON THEN             /*                       @Y30LB39*/
@RF00848 TM    BASRONLY(BASEVPTR),B'01000000'                      0850
         BNO   @RF00850                                            0850
*     DEFVWINH=ON;                  /*                       @Y30LB39*/
         L     @01,DEFVPTR                                         0851
         OI    DEFVWINH(@01),B'00000010'                           0851
*   DEFVCSN1=CSN1AREA;              /*                       @Y30LB39*/
@RF00850 L     @15,DEFVPTR                                         0852
         MVC   DEFVCSN1(12,@15),CSN1AREA                           0852
*   DEFVCSN2=CSN2AREA;              /*                       @Y30LB39*/
         MVC   DEFVCSN2(12,@15),CSN2AREA                           0853
*   DEFVDATA=BLNKAREA;              /*                       @Y30LB39*/
         MVI   DEFVDATA+1(@15),C' '                                0854
         MVC   DEFVDATA+2(70,@15),DEFVDATA+1(@15)                  0854
         MVC   DEFVDATA(1,@15),BLNKAREA                            0854
*   DEFOWNID=BASOWNER;              /*                       @Y30LB39*/
         MVI   DEFOWNID+10(@15),C' '                               0855
         MVC   DEFOWNID+11(3,@15),DEFOWNID+10(@15)                 0855
         MVC   DEFOWNID(10,@15),BASOWNER(BASEVPTR)                 0855
*   DEFTLAB='T';                    /*                       @Y30LB39*/
         MVI   DEFTLAB(@15),C'T'                                   0856
*   DEFVVEXT=DEFVEPTR;              /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0857
         L     @14,DEFVEPTR                                        0857
         ST    @14,DEFVVEXT(,@15)                                  0857
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE USSC TO CREATE A NEW VOLUME AFTER DUMPING       @ZD00175*/
*   /* DEFLIST AND DEFVE.                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0858
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0858
         L     @15,@PC00001                                        0858
         L     @15,GDTDBG(,@15)                                    0858
         LTR   @15,@15                                             0858
         BZ    @RT00858                                            0858
*     ;                                                            0859
*   ELSE                                                           0860
*     DO;                                                          0860
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   0861
*       DMPITMNM='DEFLISTB';                                       0862
         MVC   DMPITMNM(8,DMPINDEX),@CC01693                       0862
*       DMPITMPT=ADDR(DEFLISTB);                                   0863
         LA    @03,DEFLISTB                                        0863
         ST    @03,DMPITMPT(,DMPINDEX)                             0863
*       DMPITMLN=LENGTH(DEFLISTB);                                 0864
         MVC   DMPITMLN(2,DMPINDEX),@CH01906                       0864
*       DMPITMTP='H';                                              0865
         MVI   DMPITMTP(DMPINDEX),C'H'                             0865
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0866
         LA    @03,16                                              0866
         ALR   DMPINDEX,@03                                        0866
*       DMPITMNM='DEFVEBUF';                                       0867
         MVC   DMPITMNM(8,DMPINDEX),@CC01694                       0867
*       DMPITMPT=ADDR(DEFVEBUF);                                   0868
         LA    @15,DEFVEBUF                                        0868
         ST    @15,DMPITMPT(,DMPINDEX)                             0868
*       DMPITMLN=LENGTH(DEFVEBUF);                                 0869
         MVC   DMPITMLN(2,DMPINDEX),@CH01905                       0869
*       DMPITMTP='H';                                              0870
         MVI   DMPITMTP(DMPINDEX),C'H'                             0870
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0871
         ALR   DMPINDEX,@03                                        0871
*       DMPTRM=DMPTRMVL;                                           0872
         MVI   DMPTRM(DMPINDEX),X'FF'                              0872
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0874
@RT00858 L     @15,@PC00001                                        0874
         L     @15,GDTDBG(,@15)                                    0874
         LTR   @15,@15                                             0874
         BZ    @RT00874                                            0874
*     ;                                                            0875
*   ELSE                                                           0876
*     CALL IDCDB010(GDTTBL,'COCC',ADDR(DUMPLIST));/*         @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        0876
         ST    @15,@AL00001                                        0876
         LA    @14,@CC01695                                        0876
         ST    @14,@AL00001+4                                      0876
         LA    @14,DUMPLIST                                        0876
         ST    @14,@AFTEMPS+4                                      0876
         LA    @14,@AFTEMPS+4                                      0876
         ST    @14,@AL00001+8                                      0876
         MVI   @AL00001+8,X'80'                                    0876
         L     @15,GDTDBG(,@15)                                    0876
         LA    @01,@AL00001                                        0876
         BALR  @14,@15                                             0876
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBBYTE,CMMSGPTR);/*
*                                                            @Y30LB39*/
@RT00874 L     @02,@PC00001                                        0877
         ST    @02,@AL00001                                        0877
         LA    @15,DEFINE                                          0877
         ST    @15,@AL00001+4                                      0877
         LA    @15,DEFVPTR                                         0877
         ST    @15,@AL00001+8                                      0877
         LA    @15,REASON                                          0877
         ST    @15,@AL00001+12                                     0877
         LA    @15,ECBBYTE                                         0877
         ST    @15,@AL00001+16                                     0877
         LA    @15,CMMSGPTR                                        0877
         ST    @15,@AL00001+20                                     0877
         MVI   @AL00001+20,X'80'                                   0877
         L     @15,GDTSSC(,@02)                                    0877
         LA    @01,@AL00001                                        0877
         BALR  @14,@15                                             0877
*   RESPECIFY                                                      0878
*     RTNREG RSTD;                                                 0878
*   TESTRC=RTNREG;                                                 0879
         LR    TESTRC,RTNREG                                       0879
*   RESPECIFY                                                      0880
*     RTNREG UNRSTD;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0880
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF MSVC RETURNS A RETURN CODE OF TWELVE,              @Y30LB39*/
*   /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN            @Y30LB39*/
*   /* I-O ERROR PREVENTED THE UPDATING OF THE               @Y30LB39*/
*   /* MS INVENTORY. THIS RETURN CODE SHOULD BE              @Y30LB39*/
*   /* TREATED AS A RETURN CODE OF ZERO, EXCEPT              @Y30LB39*/
*   /* THAT THE FINAL CODE TO THE EXECUTIVE                  @Y30LB39*/
*   /* SHOULD BE AT LEAST FOUR. THAT IS THE                  @Y30LB39*/
*   /* REASON FOR SETTING IOERRFLG ON.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0881
*                                   /*                       @Y30LB39*/
*   IF TESTRC=12 THEN               /*                       @Y30LB39*/
         C     TESTRC,@CF00567                                     0881
         BNE   @RF00881                                            0881
*     DO;                           /*                       @Y30LB39*/
*       TESTRC=LASTCC00;            /*                       @Y30LB39*/
         SLR   TESTRC,TESTRC                                       0883
*       IOERRFLG=ON;                /*                       @Y30LB39*/
         OI    IOERRFLG,B'10000000'                                0884
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0886
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CHECK RETURN CODE                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0886
*                                   /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/
@RF00881 LTR   TESTRC,TESTRC                                       0886
         BZ    @RF00886                                            0886
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0887
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* USSC RETURN CODE IS NOT ZERO. SET CONDITION       @Y30LB39*/
*       /* CODE TO FOUR PRIOR TO PUTTING OUT MESSAGES.       @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0888
*                                   /*                       @Y30LB39*/
*       CRVRC=LASTCC04;             /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0888
         LA    @02,4                                               0888
         LR    CRVRC,@02                                           0888
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF THE DEFINE ORDER FAILED,                       @Y30LB39*/
*       /* CALL SSCMSG TO OUTPUT APPROPRIATE REASON          @Y30LB39*/
*       /* CODE MESSAGE.                                     @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0889
*                                   /*                       @Y30LB39*/
*       IF TESTRC=LASTCC04 THEN     /*                       @Y30LB39
*                                                            @Y30LB39*/
         CR    TESTRC,@02                                          0889
         BNE   @RF00889                                            0889
*         CALL SSCMSG(REASON,ECBBYTE);/*                     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0890
         LA    @15,REASON                                          0890
         ST    @15,@AL00001                                        0890
         LA    @15,ECBBYTE                                         0890
         ST    @15,@AL00001+4                                      0890
         LA    @01,@AL00001                                        0890
         BAL   @14,SSCMSG                                          0890
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT TO OUTPUT SECONDARY MESSAGE          @Y30LB39*/
*       /* IDC3708I.                                         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0891
*                                   /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
@RF00889 L     @15,DDSTRU                                          0891
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0891
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01548                            0892
*       DARGSENT=MSG3708I;          /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVI   DARGSENT(@15),X'09'                                 0893
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0894
         L     @15,@PC00001                                        0894
         ST    @15,@AL00001                                        0894
         LA    @14,@CF00115                                        0894
         ST    @14,@AL00001+4                                      0894
         LA    @14,DDSTRU                                          0894
         ST    @14,@AL00001+8                                      0894
         MVI   @AL00001+8,X'80'                                    0894
         L     @15,GDTPRT(,@15)                                    0894
         LA    @01,@AL00001                                        0894
         BALR  @14,@15                                             0894
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UDEQ TO RELEASE RESERVE SETUP BY            @Y30LB39*/
*       /* IDCVS01 IN SUBROUTINE VSRTN.                      @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0895
*                                   /*                       @Y30LB39*/
*       RNAMCHAR(7:22)='.VIRTUAL.RESERVE';/*                 @ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01672                             0895
*       CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*         @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        0896
         ST    @15,@AL00001                                        0896
         LA    @14,@CC01617                                        0896
         ST    @14,@AL00001+4                                      0896
         LA    @14,MINORNAM                                        0896
         ST    @14,@AL00001+8                                      0896
         MVI   @AL00001+8,X'80'                                    0896
         L     @15,GDTDEQ(,@15)                                    0896
         LA    @01,@AL00001                                        0896
         BALR  @14,@15                                             0896
*     END;                          /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0898
         B     @RC00886                                            0898
@RF00886 DS    0H                                                  0899
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* SET UP ADDRESSABILITY TO DEFINE MESSAGE           @Y30LB39*/
*       /* STRUCTURE.                                        @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0899
*                                   /*                       @Y30LB39*/
*       RFY                                                        0899
*         CMMSG BASED(CMMSGPTR+4);  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0899
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF THE CARTRIDGES HAD BEEN RANDOMLY               @Y30LB39*/
*       /* SELECTED, THEN SAVE THE CSN1 AND CSN2 FROM        @Y30LB39*/
*       /* THE DEFINE MESSAGE AREA.                          @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0900
*                                   /*                       @Y30LB39*/
*       IF CSN1AREA=TWLVZERO&CSN2AREA=TWLVZERO THEN                0900
         CLC   CSN1AREA(12),TWLVZERO                               0900
         BNE   @RF00900                                            0900
         CLC   CSN2AREA(12),TWLVZERO                               0900
         BNE   @RF00900                                            0900
*         DO;                       /*                       @Y30LB39*/
*           CSN1AREA=CMCSN1;        /*                       @Y30LB39*/
         LA    @15,4                                               0902
         AL    @15,CMMSGPTR                                        0902
         MVC   CSN1AREA(12),CMCSN1(@15)                            0902
*           CSN2AREA=CMCSN2;        /*                       @Y30LB39*/
         MVC   CSN2AREA(12),CMCSN2(@15)                            0903
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0904
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UFSPACE TO RELEASE MESSAGE STORAGE          @Y30LB39*/
*       /* AREA.                                             @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0905
*                                   /*                       @Y30LB39*/
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB39
*                                                            @Y30LB39*/
@RF00900 L     @15,@PC00001                                        0905
         ST    @15,@AL00001                                        0905
         LA    @14,CMMSGPTR                                        0905
         ST    @14,@AL00001+4                                      0905
         L     @15,GDTFSP(,@15)                                    0905
         LA    @01,@AL00001                                        0905
         BALR  @14,@15                                             0905
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0906
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0907
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR2;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0907
@RC00886 LR    REG14,RETADDR2                                      0907
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0908
*                                   /*                       @Y30LB39*/
*   RETURN CODE(CRVRC);             /*                       @Y30LB39*/
         LR    @15,CRVRC                                           0908
@EL00009 DS    0H                                                  0908
@EF00009 DS    0H                                                  0908
@ER00009 BR    @14                                                 0908
*   END CRVRTN;                     /*                       @Y30LB39*/
*                                                                  0910
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - DMNTRTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* DEMOUNT THE SOURCE VOLUME BEFORE COPYING.             @Y30LB39*/
*   /* AFTER THE ARGUMENT LIST IS INITIALIZED, THEN          @Y30LB39*/
*   /* MSVC IS INVOKED TO DEMOUNT THE SOURCE VOLUME,         @Y30LB39*/
*   /* A DEQUEUE IS ISSUED TO RELEASE THE RESERVE            @Y30LB39*/
*   /* SET EARLIER BY IDCVS01 IN VSRTN.                      @Y30LB39*/
*   /* THERE ARE NO MESSAGES ISSUED BY THIS ROUTINE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 4 - IF THE DEMOUNT FAILED.                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0910
*DMNTRTN:                                                          0910
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0910
DMNTRTN  DS    0H                                                  0911
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0911
*                                   /*                       @Y30LB39*/
*   DCL                                                            0911
*     DMNTRC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0912
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0912
*                                   /*                       @Y30LB39*/
*   RETADDR2=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0912
         LR    RETADDR2,REG14                                      0912
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0913
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0913
         L     @15,@PC00001                                        0913
         L     @14,GDTTR2(,@15)                                    0913
         MVC   @TS00001(95),NEWERID2(@14)                          0913
         MVC   OLDERID2(95,@14),@TS00001                           0913
*   NEWID2='CODM';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0914
         MVC   NEWID2(4,@14),@CC01703                              0914
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*                                   /*                       @Y30LB39*/
*   DMNTRC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0915
         SLR   DMNTRC,DMNTRC                                       0915
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE ARGUMENT LIST. NOTE THE WAIT           @Y30LB39*/
*   /* OPTION IS SET TO INSURE THE VOLUME IS DE-             @Y30LB39*/
*   /* MOUNTED BEFORE THE COPY OPERATION.                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0916
*                                   /*                       @Y30LB39*/
*   MDAGL=''B;                      /*                       @Y30LB39*/
         LA    @14,MDAGLBUF                                        0916
         XC    MDAGL(37,@14),MDAGL(@14)                            0916
*   MDDDNAME=CUNITDDN;              /*                       @Y30LB39*/
         MVC   MDDDNAME(8,@14),CUNITDDN                            0917
*   MDLABEL=VOLVAL;                 /*                       @Y30LB39*/
         L     @03,@PC00001+4                                      0918
         L     @01,FDTPTR(,@03)                                    0918
         MVC   MDLABEL(6,@14),VOLVAL(@01)                          0918
*   MDUCBPTR=ADDR(CUNITUCB);        /*                       @Y30LB39*/
         LA    @03,CUNITUCB                                        0919
         ST    @03,MDUCBPTR(,@14)                                  0919
*   MDWAIT=ON;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0920
         OI    MDWAIT(@14),B'00010000'                             0920
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @ZA05125*/
*   /* ISSUE THE UDEQ TO RELEASE THE RESERVE SET BY          @ZA05125*/
*   /* IDCVS01 IN VSRTN SUBROUTINE.                          @ZA05125*/
*   /*                                                       @ZA05125*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0921
*                                   /*                       @ZA05125*/
*   RNAMCHAR(7:22)='.VIRTUAL.RESERVE';/*                     @ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01672                             0921
*   CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*             @ZA05125
*                                                            @ZA05125*/
*                                                                  0922
         ST    @15,@AL00001                                        0922
         LA    @14,@CC01617                                        0922
         ST    @14,@AL00001+4                                      0922
         LA    @14,MINORNAM                                        0922
         ST    @14,@AL00001+8                                      0922
         MVI   @AL00001+8,X'80'                                    0922
         L     @15,GDTDEQ(,@15)                                    0922
         LA    @01,@AL00001                                        0922
         BALR  @14,@15                                             0922
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UMSSUNIT MACRO TO DEMOUNT THE SOURCE            @Y30LB39*/
*   /* VOLUME AFTER DUMPING THE DEMOUNT ARGUMENT LIST        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0923
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0923
         L     @15,@PC00001                                        0923
         L     @15,GDTDBG(,@15)                                    0923
         LTR   @15,@15                                             0923
         BZ    @RT00923                                            0923
*     ;                                                            0924
*   ELSE                                                           0925
*     DO;                                                          0925
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   0926
*       DMPITMNM='MDAGLBUF';                                       0927
         MVC   DMPITMNM(8,DMPINDEX),@CC01704                       0927
*       DMPITMPT=ADDR(MDAGLBUF);                                   0928
         LA    @03,MDAGLBUF                                        0928
         ST    @03,DMPITMPT(,DMPINDEX)                             0928
*       DMPITMLN=LENGTH(MDAGLBUF);                                 0929
         MVC   DMPITMLN(2,DMPINDEX),@CH01907                       0929
*       DMPITMTP='H';                                              0930
         MVI   DMPITMTP(DMPINDEX),C'H'                             0930
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0931
         AL    DMPINDEX,@CF00474                                   0931
*       DMPTRM=DMPTRMVL;                                           0932
         MVI   DMPTRM(DMPINDEX),X'FF'                              0932
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0934
@RT00923 L     @15,@PC00001                                        0934
         L     @15,GDTDBG(,@15)                                    0934
         LTR   @15,@15                                             0934
         BZ    @RT00934                                            0934
*     ;                                                            0935
*   ELSE                                                           0936
*     CALL IDCDB010(GDTTBL,'CODD',ADDR(DUMPLIST));/*         @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        0936
         ST    @15,@AL00001                                        0936
         LA    @14,@CC01705                                        0936
         ST    @14,@AL00001+4                                      0936
         LA    @14,DUMPLIST                                        0936
         ST    @14,@AFTEMPS+8                                      0936
         LA    @14,@AFTEMPS+8                                      0936
         ST    @14,@AL00001+8                                      0936
         MVI   @AL00001+8,X'80'                                    0936
         L     @15,GDTDBG(,@15)                                    0936
         LA    @01,@AL00001                                        0936
         BALR  @14,@15                                             0936
*   CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*                   @Y30LB39
*                                                            @Y30LB39*/
@RT00934 L     @02,@PC00001                                        0937
         ST    @02,@AL00001                                        0937
         LA    @15,DEMOUNT                                         0937
         ST    @15,@AL00001+4                                      0937
         LA    @15,MDAGLBUF                                        0937
         ST    @15,@AL00001+8                                      0937
         MVI   @AL00001+8,X'80'                                    0937
         L     @15,GDTUNT(,@02)                                    0937
         LA    @01,@AL00001                                        0937
         BALR  @14,@15                                             0937
*   RESPECIFY                                                      0938
*     RTNREG RSTD;                                                 0938
*   TESTRC=RTNREG;                                                 0939
         LR    TESTRC,RTNREG                                       0939
*   RESPECIFY                                                      0940
*     RTNREG UNRSTD;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0940
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE RETURN CODE IS NOT ZERO, SET THE               @Y30LB39*/
*   /* CONDITION CODE TO FOUR INDICATING THAT A              @Y30LB39*/
*   /* COPY CANNOT BE TAKEN OF A MOUNTED VOLUME.             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0941
*                                   /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       0941
         BZ    @RF00941                                            0941
*     DMNTRC=LASTCC04;              /*                       @Y30LB39*/
*                                                                  0942
         LA    DMNTRC,4                                            0942
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0943
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR2;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0943
@RF00941 LR    REG14,RETADDR2                                      0943
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0944
*                                   /*                       @Y30LB39*/
*   RETURN CODE(DMNTRC);            /*                       @Y30LB39*/
         LR    @15,DMNTRC                                          0944
@EL00010 DS    0H                                                  0944
@EF00010 DS    0H                                                  0944
@ER00010 BR    @14                                                 0944
*   END DMNTRTN;                    /*                       @Y30LB39*/
*                                                                  0946
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - COPYRTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* COPY THE SOURCE VOLUME.                               @Y30LB39*/
*   /* MSC IS USED TO COPY THE SOURCE VOLUME TO AN           @Y30LB39*/
*   /* INACTIVE COPY VOLUME.                                 @Y30LB39*/
*   /* THE DATE TO BE INSERTED IN THE SUCCESSFUL COPY        @Y30LB39*/
*   /* MESSAGE IS OBTAINED IMMEDIATELY PRIOR TO              @Y30LB39*/
*   /* CALLING MSC TO COPY THE VOLUME.                       @Y30LB39*/
*   /* IF THE COPY OPERATION COMPLETES NORMALLY,             @Y30LB39*/
*   /* THEN MESSAGE IDC0703I IS OUTPUTED WITH                @Y30LB39*/
*   /* THE DATE OF COPY AND THE SERIAL NUMBERS               @Y30LB39*/
*   /* OF THE TWO CARTRIDGES USED.                           @Y30LB39*/
*   /* OTHERWISE, MESSAGE IDC3709I IS ISSUED IF              @Y30LB39*/
*   /* THE I/O DID NOT COMPLETE NORMALLY OR                  @Y30LB39*/
*   /* MESSAGE IDC3706I IS ISSUED IF BACKUP COPIES           @Y30LB39*/
*   /* CARTRIDGES WERE USED.                                 @Y30LB39*/
*   /* IF CARTRIDGES WERE REUSED, THEN MESSAGE               @Y30LB39*/
*   /* IDC0704I IS ISSUED IF OLDEST BACKUP COPY              @Y30LB39*/
*   /* CARTRIDGES WERE REUSED. OTHERWISE, MESSAGE            @Y30LB39*/
*   /* IDC0705I IS ISSUED IF OLDEST BACKUP COPIES            @Y30LB39*/
*   /* WERE NOT REUSED. ALSO SSCMSG IS CALLED TO             @Y30LB39*/
*   /* OUTPUT THE APPROPRIATE REASON CODE IF THE COPY        @Y30LB39*/
*   /* OPERATION FAILED.                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/
*   /* VSIAGL                                                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 4 - COPY WAS UNSUCCESSFUL.                            @Y30LB39*/
*   /* COPYVTBL IS UPDATED.                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0946
*COPYRTN:                                                          0946
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  0946
COPYRTN  DS    0H                                                  0947
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0947
*                                   /*                       @Y30LB39*/
*   DCL                                                            0947
*     COPYRC FIXED(8);              /*                       @Y30LB39*/
*   DCL                                                            0948
*     TIMEAREA CHAR(8) BDY(WORD);   /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0949
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0949
*                                   /*                       @Y30LB39*/
*   RETADDR2=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0949
         LR    RETADDR2,REG14                                      0949
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0950
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0950
         L     @15,@PC00001                                        0950
         L     @15,GDTTR2(,@15)                                    0950
         MVC   @TS00001(95),NEWERID2(@15)                          0950
         MVC   OLDERID2(95,@15),@TS00001                           0950
*   NEWID2='COCP';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0951
         MVC   NEWID2(4,@15),@CC01711                              0951
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0952
*                                   /*                       @Y30LB39*/
*   COPYRC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0952
         SLR   COPYRC,COPYRC                                       0952
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE MSSC COVCE PARAMETER LIST              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0953
*                                   /*                       @Y30LB39*/
*   COVCE=''B;                      /*                       @Y30LB39*/
         L     @15,COVCEPTR                                        0953
         XC    COVCE(43,@15),COVCE(@15)                            0953
*   COVLNGTH=COVLEN;                /*                       @Y30LB39*/
         LH    @14,COVLEN                                          0954
         ST    @14,COVLNGTH(,@15)                                  0954
*   COVDESCR=DESCRVAL;              /*                       @Y30LB39*/
         L     @14,@PC00001+4                                      0955
         L     @01,FDTPTR+20(,@14)                                 0955
         MVC   COVDESCR(30,@15),DESCRVAL(@01)                      0955
*   COVSPDES=ON;                    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0956
         OI    COVSPDES(@15),B'10000000'                           0956
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REUSE FLAG IS ON, THEN SET THE RECOVERY        @Y30LB39*/
*   /* FLAGS ON. NOTE THAT IF THE REUSE FLAG IS OFF,         @Y30LB39*/
*   /* THESE RECOVERY FLAGS HAVE BEEN SET DURING THE         @Y30LB39*/
*   /* CREATE OPERATION.                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0957
*                                   /*                       @Y30LB39*/
*   IF REUSEFLG=ON THEN             /*                       @Y30LB39*/
         TM    REUSEFLG,B'10000000'                                0957
         BNO   @RF00957                                            0957
*     DO;                           /*                       @Y30LB39*/
*       COVSRCVY=ON;                /*                       @Y30LB39*/
         OI    COVSRCVY(@15),B'10000000'                           0959
*       COVICOPY=ON;                /*                       @Y30LB39*/
         OI    COVICOPY(@15),B'10000000'                           0960
*       COVREUSE=ON;                /*                       @Y30LB39*/
         OI    COVREUSE(@15),B'01000000'                           0961
*     END;                          /*                       @Y30LB39*/
*   IF VSVSAM=ON THEN               /*                       @Y30LB39*/
@RF00957 LA    @15,VS1AGLBF                                        0963
         TM    VSVSAM(@15),B'10000000'                             0963
         BNO   @RF00963                                            0963
*     COVSAM=ON;                    /*                       @Y30LB39*/
         L     @01,COVCEPTR                                        0964
         OI    COVSAM(@01),B'10000000'                             0964
*                                   /*                       @Y30LB39*/
*                                                                  0965
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE MSSC COVLIST PARAMETER LIST            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*                                   /*                       @Y30LB39*/
*   COVLIST=''B;                    /*                       @Y30LB39*/
@RF00963 L     @15,COVCPTR                                         0965
         XC    COVLIST(40,@15),COVLIST(@15)                        0965
*   CVOCRCR=ON;                     /*                       @Y30LB39*/
         OI    CVOCRCR(@15),B'00100000'                            0966
*   CVOLID=VOLVAL;                  /*                       @Y30LB39*/
         L     @14,@PC00001+4                                      0967
         L     @01,FDTPTR(,@14)                                    0967
         MVC   CVOLID(6,@15),VOLVAL(@01)                           0967
*   CVOLCSN=CSN1AREA;               /*                       @Y30LB39*/
         MVC   CVOLCSN(12,@15),CSN1AREA                            0968
*   CVOLVEXT=COVCEPTR;              /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0969
         L     @14,COVCEPTR                                        0969
         ST    @14,CVOLVEXT(,@15)                                  0969
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UTIME MACRO TO OBTAIN DATE IN THE FORM          @Y30LB39*/
*   /* YYDDD TO BE INSERTED IN THE COPY MESSAGE. NOTE        @Y30LB39*/
*   /* THAT COPY DATE IS OBTAINED IMMEDIATELY BEFORE         @Y30LB39*/
*   /* COPY OPERATION SINCE MSVC WILL ALSO CALCULATE         @Y30LB39*/
*   /* AND RECORD THE COPY DATE IMMEDIATELY BEFORE THE       @Y30LB39*/
*   /* COPY OPERATION. COPYV USES UTIME MACRO RATHER         @Y30LB39*/
*   /* THAN READING THE LATEST COPY RECORD FOLLOWING         @Y30LB39*/
*   /* COPY OPERATION BECAUSE THE NEWLY RECORDED COPY        @Y30LB39*/
*   /* RECORD MAY NOT NECESSARILY BE ONE RETRIEVED.          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0970
*                                   /*                       @Y30LB39*/
*   CALL IDCSATI0(GDTTBL,TIMEAREA,NEWCDATE);/*               @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0970
         L     @15,@PC00001                                        0970
         ST    @15,@AL00001                                        0970
         LA    @14,TIMEAREA                                        0970
         ST    @14,@AL00001+4                                      0970
         LA    @14,NEWCDATE                                        0970
         ST    @14,@AL00001+8                                      0970
         MVI   @AL00001+8,X'80'                                    0970
         L     @15,GDTTIM(,@15)                                    0970
         LA    @01,@AL00001                                        0970
         BALR  @14,@15                                             0970
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE USSC MACRO TO COPY THE SOURCE VOLUME            @Y30LB39*/
*   /* TO AN INACTIVE COPY VOLUME AFTER DUMPING              @Y30LB39*/
*   /* PARAMETER LISTS.                                      @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0971
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0971
         L     @15,@PC00001                                        0971
         L     @15,GDTDBG(,@15)                                    0971
         LTR   @15,@15                                             0971
         BZ    @RT00971                                            0971
*     ;                                                            0972
*   ELSE                                                           0973
*     DO;                                                          0973
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   0974
*       DMPITMNM='COVLISTB';                                       0975
         MVC   DMPITMNM(8,DMPINDEX),@CC01712                       0975
*       DMPITMPT=ADDR(COVLISTB);                                   0976
         LA    @03,COVLISTB                                        0976
         ST    @03,DMPITMPT(,DMPINDEX)                             0976
*       DMPITMLN=LENGTH(COVLISTB);                                 0977
         MVC   DMPITMLN(2,DMPINDEX),@CH01588                       0977
*       DMPITMTP='H';                                              0978
         MVI   DMPITMTP(DMPINDEX),C'H'                             0978
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0979
         LA    @03,16                                              0979
         ALR   DMPINDEX,@03                                        0979
*       DMPITMNM='COVCEBUF';                                       0980
         MVC   DMPITMNM(8,DMPINDEX),@CC01713                       0980
*       DMPITMPT=ADDR(COVCEBUF);                                   0981
         LA    @15,COVCEBUF                                        0981
         ST    @15,DMPITMPT(,DMPINDEX)                             0981
*       DMPITMLN=LENGTH(COVCEBUF);                                 0982
         MVC   DMPITMLN(2,DMPINDEX),@CH01908                       0982
*       DMPITMTP='H';                                              0983
         MVI   DMPITMTP(DMPINDEX),C'H'                             0983
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0984
         ALR   DMPINDEX,@03                                        0984
*       DMPTRM=DMPTRMVL;                                           0985
         MVI   DMPTRM(DMPINDEX),X'FF'                              0985
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         0987
@RT00971 L     @15,@PC00001                                        0987
         L     @15,GDTDBG(,@15)                                    0987
         LTR   @15,@15                                             0987
         BZ    @RT00987                                            0987
*     ;                                                            0988
*   ELSE                                                           0989
*     CALL IDCDB010(GDTTBL,'COEE',ADDR(DUMPLIST));/*         @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        0989
         ST    @15,@AL00001                                        0989
         LA    @14,@CC01714                                        0989
         ST    @14,@AL00001+4                                      0989
         LA    @14,DUMPLIST                                        0989
         ST    @14,@AFTEMPS+12                                     0989
         LA    @14,@AFTEMPS+12                                     0989
         ST    @14,@AL00001+8                                      0989
         MVI   @AL00001+8,X'80'                                    0989
         L     @15,GDTDBG(,@15)                                    0989
         LA    @01,@AL00001                                        0989
         BALR  @14,@15                                             0989
*   CALL IDCSASS0(GDTTBL,COPYVOL,COVCPTR,REASON,ECBBYTE);/*  @Y30LB39
*                                                            @Y30LB39*/
@RT00987 L     @02,@PC00001                                        0990
         ST    @02,@AL00001                                        0990
         LA    @15,COPYVOL                                         0990
         ST    @15,@AL00001+4                                      0990
         LA    @15,COVCPTR                                         0990
         ST    @15,@AL00001+8                                      0990
         LA    @15,REASON                                          0990
         ST    @15,@AL00001+12                                     0990
         LA    @15,ECBBYTE                                         0990
         ST    @15,@AL00001+16                                     0990
         MVI   @AL00001+16,X'80'                                   0990
         L     @15,GDTSSC(,@02)                                    0990
         LA    @01,@AL00001                                        0990
         BALR  @14,@15                                             0990
*   RESPECIFY                                                      0991
*     RTNREG RSTD;                                                 0991
*   TESTRC=RTNREG;                                                 0992
         LR    TESTRC,RTNREG                                       0992
*   RESPECIFY                                                      0993
*     RTNREG UNRSTD;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0993
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF MSVC RETURNS A RETURN CODE OF TWELVE,              @Y30LB39*/
*   /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN            @Y30LB39*/
*   /* I-O ERROR PREVENTED THE UPDATING OF THE               @Y30LB39*/
*   /* MSV INVENTORY. THIS RETURN CODE SHOULD BE             @Y30LB39*/
*   /* TREATED AS A RETURN CODE OF ZERO, EXCEPT              @Y30LB39*/
*   /* THAT THE FINAL CODE TO THE EXECUTIVE                  @Y30LB39*/
*   /* SHOULD BE AT LEAST FOUR. THAT IS THE                  @Y30LB39*/
*   /* REASON FOR SETTING IOERRFLG ON.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0994
*                                   /*                       @Y30LB39*/
*   IF TESTRC=12 THEN               /*                       @Y30LB39*/
         C     TESTRC,@CF00567                                     0994
         BNE   @RF00994                                            0994
*     DO;                           /*                       @Y30LB39*/
*       TESTRC=LASTCC00;            /*                       @Y30LB39*/
         SLR   TESTRC,TESTRC                                       0996
*       IOERRFLG=ON;                /*                       @Y30LB39*/
         OI    IOERRFLG,B'10000000'                                0997
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0998
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF USSC RETURN CODE IS ZERO, ISSUE UPRINT             @Y30LB39*/
*   /* FOR MESSAGE IDC0703I AND IDENTIFY THE COPY            @Y30LB39*/
*   /* VOLUME.                                               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0999
*                                   /*                       @Y30LB39*/
*   IF TESTRC=0 THEN                /*                       @Y30LB39*/
@RF00994 LTR   TESTRC,TESTRC                                       0999
         BNZ   @RF00999                                            0999
*     DO;                           /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
         L     @15,DDSTRU                                          1001
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1001
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01548                            1002
*       DARGSENT=MSG0703I;          /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'04'                                 1003
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB39*/
         L     @14,@PC00001+4                                      1004
         L     @14,FDTPTR(,@14)                                    1004
         LA    @03,VOLVAL(,@14)                                    1004
         ST    @03,DARGDBP(,@15)                                   1004
*       DARGILP=VOLLEN;             /*                       @Y30LB39*/
         SLR   @03,@03                                             1005
         IC    @03,VOLLEN(,@14)                                    1005
         STH   @03,DARGILP(,@15)                                   1005
*       DARGCNT=THREE;              /*                       @Y30LB39*/
         LA    @14,3                                               1006
         STH   @14,DARGCNT(,@15)                                   1006
*       DARGINS(1)=FIRSTCSN;        /*                       @Y30LB39*/
         MVC   DARGINS(2,@15),@CH00219                             1007
*       DARGINL(1)=LENGTH(CSN1AREA);/*                       @Y30LB39*/
         LA    @03,12                                              1008
         STH   @03,DARGINL(,@15)                                   1008
*       DARGDTM(1)=ADDR(CSN1AREA);  /*                       @Y30LB39*/
         LA    @02,CSN1AREA                                        1009
         ST    @02,DARGDTM(,@15)                                   1009
*       DARGINS(2)=SECONDCN;        /*                       @Y30LB39*/
         MVC   DARGINS+8(2,@15),@CH00153                           1010
*       DARGINL(2)=LENGTH(CSN2AREA);/*                       @Y30LB39*/
         STH   @03,DARGINL+8(,@15)                                 1011
*       DARGDTM(2)=ADDR(CSN2AREA);  /*                       @Y30LB39*/
         LA    @03,CSN2AREA                                        1012
         ST    @03,DARGDTM+8(,@15)                                 1012
*       DARGINS(3)=DATE;            /*                       @Y30LB39*/
         STH   @14,DARGINS+16(,@15)                                1013
*       DARGINL(3)=LENGTH(NEWCDATE);/*                       @Y30LB39*/
         MVC   DARGINL+16(2,@15),@CH00042                          1014
*       DARGDTM(3)=ADDR(NEWCDATE);  /*                       @Y30LB39
*                                                            @Y30LB39*/
         LA    @14,NEWCDATE                                        1015
         ST    @14,DARGDTM+16(,@15)                                1015
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        1016
         ST    @15,@AL00001                                        1016
         LA    @14,@CF00115                                        1016
         ST    @14,@AL00001+4                                      1016
         LA    @14,DDSTRU                                          1016
         ST    @14,@AL00001+8                                      1016
         MVI   @AL00001+8,X'80'                                    1016
         L     @15,GDTPRT(,@15)                                    1016
         LA    @01,@AL00001                                        1016
         BALR  @14,@15                                             1016
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1017
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN CODE FROM USSC WAS NOT ZERO                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1018
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1018
         B     @RC00999                                            1018
@RF00999 DS    0H                                                  1019
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* SET THE CONDITION CODE TO FOUR.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1019
*                                   /*                       @Y30LB39*/
*       COPYRC=LASTCC04;            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1019
         LA    @02,4                                               1019
         LR    COPYRC,@02                                          1019
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CALL SSCMSG TO OUTPUT APPROPRIATE REASON          @Y30LB39*/
*       /* CODE MESSAGE IF USSC RETURN CODE IS FOUR,         @Y30LB39*/
*       /* WHICH INDICATES THE MSC COPY ORDER FAILED.        @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1020
*                                   /*                       @Y30LB39*/
*       IF TESTRC=LASTCC04 THEN     /*                       @Y30LB39*/
         CR    TESTRC,@02                                          1020
         BNE   @RF01020                                            1020
*         CALL SSCMSG(REASON,ECBBYTE);/*                     @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1021
         LA    @15,REASON                                          1021
         ST    @15,@AL00001                                        1021
         LA    @15,ECBBYTE                                         1021
         ST    @15,@AL00001+4                                      1021
         LA    @01,@AL00001                                        1021
         BAL   @14,SSCMSG                                          1021
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE MESSAGE IDC3709I IF THE COPY OPERA-         @Y30LB39*/
*       /* TION WAS NEVER STARTED AND THE TARGET             @Y30LB39*/
*       /* VOLUME IS THE OLDEST BACKUP.                      @Y30LB39*/
*       /* OTHERWISE, ISSUE MESSAGE IDC3706I.                @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1022
*                                   /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
@RF01020 L     @15,DDSTRU                                          1022
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1022
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01548                            1023
*       DARGDBP=ADDR(CSN1AREA);     /*                       @Y30LB39*/
         LA    @14,CSN1AREA                                        1024
         ST    @14,DARGDBP(,@15)                                   1024
*       DARGILP=LENGTH(CSN1AREA);   /*                       @Y30LB39*/
         LA    @14,12                                              1025
         STH   @14,DARGILP(,@15)                                   1025
*       DARGCNT=CSN2INST;           /*                       @Y30LB39*/
         LA    @03,1                                               1026
         STH   @03,DARGCNT(,@15)                                   1026
*       DARGINS(1)=CSN2INST;        /*                       @Y30LB39*/
         STH   @03,DARGINS(,@15)                                   1027
*       DARGINL(1)=LENGTH(CSN2AREA);/*                       @Y30LB39*/
         STH   @14,DARGINL(,@15)                                   1028
*       DARGDTM(1)=ADDR(CSN2AREA);  /*                       @Y30LB39*/
         LA    @14,CSN2AREA                                        1029
         ST    @14,DARGDTM(,@15)                                   1029
*       IF ECBBYTE=ONEZERO&OBKUPFLG=ON THEN/*                @Y30LB39*/
         CLC   ECBBYTE(1),ONEZERO                                  1030
         BNE   @RF01030                                            1030
         TM    OBKUPFLG,B'01000000'                                1030
         BNO   @RF01030                                            1030
*         DARGSENT=MSG3709I;        /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'0A'                                 1031
*       ELSE                        /*                       @Y30LB39*/
*         DARGSENT=MSG3706I;        /*                       @Y30LB39
*                                                            @Y30LB39*/
         B     @RC01030                                            1032
@RF01030 L     @01,DDSTRU                                          1032
         MVI   DARGSENT(@01),X'07'                                 1032
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
@RC01030 L     @15,@PC00001                                        1033
         ST    @15,@AL00001                                        1033
         LA    @14,@CF00115                                        1033
         ST    @14,@AL00001+4                                      1033
         LA    @14,DDSTRU                                          1033
         ST    @14,@AL00001+8                                      1033
         MVI   @AL00001+8,X'80'                                    1033
         L     @15,GDTPRT(,@15)                                    1033
         LA    @01,@AL00001                                        1033
         BALR  @14,@15                                             1033
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1034
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF REUSE FLAG IS ON, THEN ISSUE THE APPROPRIATE       @Y30LB39*/
*   /* SECONDARY MESSAGE.                                    @Y30LB39*/
*   /* IF OBKUPFLG IS ON, MESSAGE IDC0704I                   @Y30LB39*/
*   /* IF OBKUPFLG IS OFF, MESSAGE IDC0605I                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1035
*                                   /*                       @Y30LB39*/
*   IF REUSEFLG=ON THEN             /*                       @Y30LB39*/
@RC00999 TM    REUSEFLG,B'10000000'                                1035
         BNO   @RF01035                                            1035
*     DO;                           /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
         L     @15,DDSTRU                                          1037
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1037
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01548                            1038
*       IF OBKUPFLG=ON THEN         /*                       @Y30LB39*/
         TM    OBKUPFLG,B'01000000'                                1039
         BNO   @RF01039                                            1039
*         DO;                       /*                       @Y30LB39*/
*           DARGSENT=MSG0704I;      /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'05'                                 1041
*           DARGDBP=ADDR(COPDATE);  /*                       @Y30LB39*/
         LA    @14,COPDATE(,COPYVPTR)                              1042
         ST    @14,DARGDBP(,@15)                                   1042
*           DARGILP=LENGTH(COPDATE);/*                       @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00042                             1043
*         END;                      /*                       @Y30LB39*/
*       ELSE                        /*                       @Y30LB39*/
*         DARGSENT=MSG0705I;        /*                       @Y30LB39
*                                                            @Y30LB39*/
         B     @RC01039                                            1045
@RF01039 L     @01,DDSTRU                                          1045
         MVI   DARGSENT(@01),X'06'                                 1045
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
@RC01039 L     @15,@PC00001                                        1046
         ST    @15,@AL00001                                        1046
         LA    @14,@CF00115                                        1046
         ST    @14,@AL00001+4                                      1046
         LA    @14,DDSTRU                                          1046
         ST    @14,@AL00001+8                                      1046
         MVI   @AL00001+8,X'80'                                    1046
         L     @15,GDTPRT(,@15)                                    1046
         LA    @01,@AL00001                                        1046
         BALR  @14,@15                                             1046
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1048
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE CONDITION CODE IS ZERO, THEN CONTINUE.         @Y30LB39*/
*   /* OTHERWISE, RETURN TO CALLER.                          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*                                   /*                       @Y30LB39*/
*   IF COPYRC=0 THEN                /*                       @Y30LB39*/
@RF01035 SLR   @15,@15                                             1048
         CR    COPYRC,@15                                          1048
         BNE   @RF01048                                            1048
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1049
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* INITIALIZE MVR TO CLEAR THE INCOMPLETE            @Y30LB39*/
*       /* FLAG FROM THE INVENTORY.                          @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1050
*                                   /*                       @Y30LB39*/
*       MVR=''B;                    /*                       @Y30LB39*/
         L     @14,MVRPTR                                          1050
         XC    MVR(88,@14),MVR(@14)                                1050
*       MVRLNGTH=MVRLEN;            /*                       @Y30LB39*/
         LH    @03,MVRLEN                                          1051
         ST    @03,MVRLNGTH(,@14)                                  1051
*       MVRCODE=MVROP;              /*                       @Y30LB39*/
         XC    MVRCODE+1(3,@14),MVRCODE+1(@14)                     1052
         MVI   MVRCODE(@14),X'85'                                  1052
*       MVRCICPY=ON;                /*                       @Y30LB39*/
         OI    MVRCICPY(@14),B'01000000'                           1053
*       MVRBVOL=VOLVAL;             /*                       @Y30LB39*/
         L     @03,@PC00001+4                                      1054
         L     @01,FDTPTR(,@03)                                    1054
         MVC   MVRBVOL(6,@14),VOLVAL(@01)                          1054
*       MVRFLBAS=ON;                /*                       @Y30LB39*/
         OI    MVRFLBAS(@14),B'00100000'                           1055
*       MVRCSN=CSN1AREA;            /*                       @Y30LB39*/
         MVC   MVRCSN(12,@14),CSN1AREA                             1056
*       MVRFLCSN=ON;                /*                       @Y30LB39*/
         OI    MVRFLCSN(@14),B'00000100'                           1057
*       IF ADDR(BKUP)^=NULLPTR THEN /*                       @Y30LB39*/
         C     @15,FDTPTR+4(,@03)                                  1058
         BE    @RF01058                                            1058
*         MVRBKUP=ON;               /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1059
         OI    MVRBKUP(@14),B'00010000'                            1059
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE USSC TO INVOKE MSVC AFTER DUMPING MVR       @Y30LB39*/
*       /* PARAMETER LIST.                                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1060
*                                   /*                       @Y30LB39*/
*       IF GDTDBG=NULLPTR THEN                                     1060
@RF01058 L     @15,@PC00001                                        1060
         L     @15,GDTDBG(,@15)                                    1060
         LTR   @15,@15                                             1060
         BZ    @RT01060                                            1060
*         ;                                                        1061
*       ELSE                                                       1062
*         DO;                                                      1062
*           DMPINDEX=ADDR(DUMPLIST);/*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   1063
*           DMPITMNM='MVRBUFR';                                    1064
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1064
         MVC   DMPITMNM(7,DMPINDEX),@CC01715                       1064
*           DMPITMPT=ADDR(MVRBUFR);                                1065
         LA    @03,MVRBUFR                                         1065
         ST    @03,DMPITMPT(,DMPINDEX)                             1065
*           DMPITMLN=LENGTH(MVRBUFR);                              1066
         MVC   DMPITMLN(2,DMPINDEX),@CH01909                       1066
*           DMPITMTP='H';                                          1067
         MVI   DMPITMTP(DMPINDEX),C'H'                             1067
*           DMPINDEX=DMPINDEX+DMPELEMT;                            1068
         AL    DMPINDEX,@CF00474                                   1068
*           DMPTRM=DMPTRMVL;                                       1069
         MVI   DMPTRM(DMPINDEX),X'FF'                              1069
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*       IF GDTDBG=NULLPTR THEN                                     1071
@RT01060 L     @15,@PC00001                                        1071
         L     @15,GDTDBG(,@15)                                    1071
         LTR   @15,@15                                             1071
         BZ    @RT01071                                            1071
*         ;                                                        1072
*       ELSE                                                       1073
*         CALL IDCDB010(GDTTBL,'COFF',ADDR(DUMPLIST));/*     @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        1073
         ST    @15,@AL00001                                        1073
         LA    @14,@CC01716                                        1073
         ST    @14,@AL00001+4                                      1073
         LA    @14,DUMPLIST                                        1073
         ST    @14,@AFTEMPS+12                                     1073
         LA    @14,@AFTEMPS+12                                     1073
         ST    @14,@AL00001+8                                      1073
         MVI   @AL00001+8,X'80'                                    1073
         L     @15,GDTDBG(,@15)                                    1073
         LA    @01,@AL00001                                        1073
         BALR  @14,@15                                             1073
*       CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASON);/*          @Y30LB39
*                                                            @Y30LB39*/
@RT01071 L     @02,@PC00001                                        1074
         ST    @02,@AL00001                                        1074
         LA    @15,VVIC                                            1074
         ST    @15,@AL00001+4                                      1074
         LA    @15,MVRPTR                                          1074
         ST    @15,@AL00001+8                                      1074
         LA    @15,REASON                                          1074
         ST    @15,@AL00001+12                                     1074
         MVI   @AL00001+12,X'80'                                   1074
         L     @15,GDTSSC(,@02)                                    1074
         LA    @01,@AL00001                                        1074
         BALR  @14,@15                                             1074
*       RESPECIFY                                                  1075
*         RTNREG RSTD;                                             1075
*       TESTRC=RTNREG;                                             1076
         LR    TESTRC,RTNREG                                       1076
*       RESPECIFY                                                  1077
*         RTNREG UNRSTD;            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1077
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF MSVC RETURNS A RETURN CODE OF TWELVE,          @Y30LB39*/
*       /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN        @Y30LB39*/
*       /* I-O ERROR PREVENTED THE UPDATING OF THE           @Y30LB39*/
*       /* MS INVENTORY. THIS RETURN CODE SHOULD BE          @Y30LB39*/
*       /* TREATED AS A RETURN CODE OF ZERO, EXCEPT          @Y30LB39*/
*       /* THAT THE FINAL CODE TO THE EXECUTIVE              @Y30LB39*/
*       /* SHOULD BE AT LEAST FOUR. THAT IS THE              @Y30LB39*/
*       /* REASON FOR SETTING IOERRFLG ON.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1078
*                                   /*                       @Y30LB39*/
*       IF TESTRC=12 THEN           /*                       @Y30LB39*/
         C     TESTRC,@CF00567                                     1078
         BNE   @RF01078                                            1078
*         DO;                       /*                       @Y30LB39*/
*           TESTRC=LASTCC00;        /*                       @Y30LB39*/
         SLR   TESTRC,TESTRC                                       1080
*           IOERRFLG=ON;            /*                       @Y30LB39*/
         OI    IOERRFLG,B'10000000'                                1081
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1082
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CHECK IF THE INCOMPLETE COPY FLAG WAS             @Y30LB39*/
*       /* SUCCESSFULLY CLEARED FROM THE MSVI                @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1083
*                                   /*                       @Y30LB39*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/
@RF01078 LTR   TESTRC,TESTRC                                       1083
         BZ    @RF01083                                            1083
*         DO;                       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1084
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* SET THE CONDITION CODE TO FOUR,               @Y30LB39*/
*           /* IF MSIV NOT UPDATED                           @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1085
*                                   /*                       @Y30LB39*/
*           COPYRC=LASTCC04;        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1085
         LA    @02,4                                               1085
         LR    COPYRC,@02                                          1085
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* CALL SSCMSG TO OUTPUT APPROPRIATE             @Y30LB39*/
*           /* REASON CODE IF RETURN CODE IS FOUR.           @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1086
*                                   /*                       @Y30LB39*/
*           IF TESTRC=LASTCC04 THEN /*                       @Y30LB39
*                                                            @Y30LB39*/
         CR    TESTRC,@02                                          1086
         BNE   @RF01086                                            1086
*             CALL SSCMSG(REASON);  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1087
         LA    @15,REASON                                          1087
         ST    @15,@AL00001                                        1087
         LA    @01,@AL00001                                        1087
         BAL   @14,SSCMSG                                          1087
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB39*/
*           /* ISSUE UPRINT FOR SECONDARY MESSAGE            @Y30LB39*/
*           /* IDC3066I.                                     @Y30LB39*/
*           /*                                               @Y30LB39*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1088
*                                   /*                       @Y30LB39*/
*           DARGLIST=''B;           /*                       @Y30LB39*/
@RF01086 L     @15,DDSTRU                                          1088
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1088
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01550                            1089
*           DARGSENT=MSG3066I;      /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVI   DARGSENT(@15),X'2C'                                 1090
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        1091
         ST    @15,@AL00001                                        1091
         LA    @14,@CF00115                                        1091
         ST    @14,@AL00001+4                                      1091
         LA    @14,DDSTRU                                          1091
         ST    @14,@AL00001+8                                      1091
         MVI   @AL00001+8,X'80'                                    1091
         L     @15,GDTPRT(,@15)                                    1091
         LA    @01,@AL00001                                        1091
         BALR  @14,@15                                             1091
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1093
@RF01083 DS    0H                                                  1094
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1094
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR2;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1094
@RF01048 LR    REG14,RETADDR2                                      1094
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1095
*                                   /*                       @Y30LB39*/
*   RETURN CODE(COPYRC);            /*                       @Y30LB39*/
         LR    @15,COPYRC                                          1095
@EL00011 DS    0H                                                  1095
@EF00011 DS    0H                                                  1095
@ER00011 BR    @14                                                 1095
*   END COPYRTN;                    /*                       @Y30LB39*/
*                                                                  1097
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - LABELRTN                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* UPDATE THE OWNER IN THE MSV INVENTORY AND             @Y30LB39*/
*   /* IN THE CARTRIDGE LABELS BY ISSUING THE MSC            @Y30LB39*/
*   /* DEFINE ORDER TO RENAME THE VOLUME WITH ITS            @Y30LB39*/
*   /* SAME SERIAL NUMBER. IF THE UPDATING OF INFOR-         @Y30LB39*/
*   /* MATION IS NOT SUCCESSFUL, THEN MESSAGE IDC1707I       @Y30LB39*/
*   /* IS ISSUED AND CONDITION CODE IS SET TO FOUR.          @Y30LB39*/
*   /* ALSO CALLS SSCMSG TO ISSUE APPROPRIATE REASON         @Y30LB39*/
*   /* CODE IF DEFINE DID NOT COMPLETE NORMALLY.             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /* DEFLIST                                               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 4 - IF MSSC RETURNS A NON-ZERO RETURN CODE            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1097
*LABELRTN:                                                         1097
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  1097
LABELRTN DS    0H                                                  1098
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1098
*                                   /*                       @Y30LB39*/
*   DCL                                                            1098
*     LABLRC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1099
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1099
*                                   /*                       @Y30LB39*/
*   RETADDR2=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1099
         LR    RETADDR2,REG14                                      1099
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1100
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1100
         L     @15,@PC00001                                        1100
         L     @14,GDTTR2(,@15)                                    1100
         MVC   @TS00001(95),NEWERID2(@14)                          1100
         MVC   OLDERID2(95,@14),@TS00001                           1100
*   NEWID2='COLB';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1101
         MVC   NEWID2(4,@14),@CC01721                              1101
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1102
*                                   /*                       @Y30LB39*/
*   LABLRC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1102
         SLR   @14,@14                                             1102
         LR    LABLRC,@14                                          1102
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE THE DEFLIST PARAMETER LIST                 @Y30LB39*/
*   /* NOTE THAT THE VOLUME IS RENAMED TO ITSELF IN          @Y30LB39*/
*   /* ORDER TO UPDATE THE OWNER ON THE CARTRIDGE            @Y30LB39*/
*   /* LABELS. THE MOUNTING ATTRIBUTES ARE                   @Y30LB39*/
*   /* NOT CHANGED.                                          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1103
*                                   /*                       @Y30LB39*/
*   DEFLIST=''B;                    /*                       @Y30LB39*/
         L     @03,DEFVPTR                                         1103
         XC    DEFLIST(132,@03),DEFLIST(@03)                       1103
*   DEFVRNTR=ON;                    /*                       @Y30LB39*/
         OI    DEFVRNTR(@03),B'00000100'                           1104
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB39*/
         L     @02,@PC00001+4                                      1105
         L     @01,FDTPTR(,@02)                                    1105
         MVC   DEFVOLD(6,@03),VOLVAL(@01)                          1105
*   DEFVVFLG=HEXFF;                 /*                       @Y30LB39*/
         MVC   DEFVVFLG(1,@03),HEXFF                               1106
*   DEFVCSN1=CSN1AREA;              /*                       @Y30LB39*/
         MVC   DEFVCSN1(12,@03),CSN1AREA                           1107
*   DEFVDATA=''B;                   /*                       @Y30LB39*/
         XC    DEFVDATA(72,@03),DEFVDATA(@03)                      1108
*   DEFOWNID=BASOWNER;              /*                       @Y30LB39*/
         MVI   DEFOWNID+10(@03),C' '                               1109
         MVC   DEFOWNID+11(3,@03),DEFOWNID+10(@03)                 1109
         MVC   DEFOWNID(10,@03),BASOWNER(BASEVPTR)                 1109
*   DEFVNVOL=DEFVOLD;               /*                       @Y30LB39*/
         MVC   DEFVNVOL(6,@03),DEFVOLD(@03)                        1110
*   DEFVVEXT=NULLPTR;               /*                       @Y30LB39*/
         ST    @14,DEFVVEXT(,@03)                                  1111
*                                   /*                       @Y30LB39*/
*                                                                  1112
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE USSC TO UPDATE THE OWNER AFTER DUMPING          @Y30LB39*/
*   /* DEFINE PARAMETER LIST.                                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1112
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         1112
         C     @14,GDTDBG(,@15)                                    1112
         BE    @RT01112                                            1112
*     ;                                                            1113
*   ELSE                                                           1114
*     DO;                                                          1114
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   1115
*       DMPITMNM='DEFLISTB';                                       1116
         MVC   DMPITMNM(8,DMPINDEX),@CC01693                       1116
*       DMPITMPT=ADDR(DEFLISTB);                                   1117
         LA    @03,DEFLISTB                                        1117
         ST    @03,DMPITMPT(,DMPINDEX)                             1117
*       DMPITMLN=LENGTH(DEFLISTB);                                 1118
         MVC   DMPITMLN(2,DMPINDEX),@CH01906                       1118
*       DMPITMTP='H';                                              1119
         MVI   DMPITMTP(DMPINDEX),C'H'                             1119
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1120
         AL    DMPINDEX,@CF00474                                   1120
*       DMPTRM=DMPTRMVL;                                           1121
         MVI   DMPTRM(DMPINDEX),X'FF'                              1121
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         1123
@RT01112 L     @15,@PC00001                                        1123
         L     @15,GDTDBG(,@15)                                    1123
         LTR   @15,@15                                             1123
         BZ    @RT01123                                            1123
*     ;                                                            1124
*   ELSE                                                           1125
*     CALL IDCDB010(GDTTBL,'COGG',ADDR(DUMPLIST));/*         @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        1125
         ST    @15,@AL00001                                        1125
         LA    @14,@CC01722                                        1125
         ST    @14,@AL00001+4                                      1125
         LA    @14,DUMPLIST                                        1125
         ST    @14,@AFTEMPS+16                                     1125
         LA    @14,@AFTEMPS+16                                     1125
         ST    @14,@AL00001+8                                      1125
         MVI   @AL00001+8,X'80'                                    1125
         L     @15,GDTDBG(,@15)                                    1125
         LA    @01,@AL00001                                        1125
         BALR  @14,@15                                             1125
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBBYTE,CMMSGPTR);/*
*                                                            @Y30LB39*/
@RT01123 L     @02,@PC00001                                        1126
         ST    @02,@AL00001                                        1126
         LA    @15,DEFINE                                          1126
         ST    @15,@AL00001+4                                      1126
         LA    @15,DEFVPTR                                         1126
         ST    @15,@AL00001+8                                      1126
         LA    @15,REASON                                          1126
         ST    @15,@AL00001+12                                     1126
         LA    @15,ECBBYTE                                         1126
         ST    @15,@AL00001+16                                     1126
         LA    @15,CMMSGPTR                                        1126
         ST    @15,@AL00001+20                                     1126
         MVI   @AL00001+20,X'80'                                   1126
         L     @15,GDTSSC(,@02)                                    1126
         LA    @01,@AL00001                                        1126
         BALR  @14,@15                                             1126
*   RESPECIFY                                                      1127
*     RTNREG RSTD;                                                 1127
*   TESTRC=RTNREG;                                                 1128
         LR    TESTRC,RTNREG                                       1128
*   RESPECIFY                                                      1129
*     RTNREG UNRSTD;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1129
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF MSVC RETURNS A RETURN CODE OF TWELVE,              @Y30LB39*/
*   /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN            @Y30LB39*/
*   /* I-O ERROR PREVENTED THE UPDATING OF THE               @Y30LB39*/
*   /* MS INVENTORY. THIS RETURN CODE SHOULD BE              @Y30LB39*/
*   /* TREATED AS A RETURN CODE OF ZERO, EXCEPT              @Y30LB39*/
*   /* THAT THE FINAL CODE TO THE EXECUTIVE                  @Y30LB39*/
*   /* SHOULD BE AT LEAST FOUR. THAT IS THE                  @Y30LB39*/
*   /* REASON FOR SETTING IOERRFLG ON.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1130
*                                   /*                       @Y30LB39*/
*   IF TESTRC=12 THEN               /*                       @Y30LB39*/
         C     TESTRC,@CF00567                                     1130
         BNE   @RF01130                                            1130
*     DO;                           /*                       @Y30LB39*/
*       TESTRC=LASTCC00;            /*                       @Y30LB39*/
         SLR   TESTRC,TESTRC                                       1132
*       IOERRFLG=ON;                /*                       @Y30LB39*/
         OI    IOERRFLG,B'10000000'                                1133
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* CHECK RETURN CODE                                     @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*                                   /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/
@RF01130 LTR   TESTRC,TESTRC                                       1135
         BZ    @RF01135                                            1135
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1136
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* RETURN CODE IS NOT ZERO. SET CONDITION            @Y30LB39*/
*       /* CODE TO FOUR.                                     @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1137
*                                   /*                       @Y30LB39*/
*       LABLRC=LASTCC04;            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1137
         LA    @02,4                                               1137
         LR    LABLRC,@02                                          1137
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* IF THE USSC RETURN CODE WAS FOUR,                 @Y30LB39*/
*       /* THE RENAME REQUEST FAILED.                        @Y30LB39*/
*       /* CALL SSCMSG TO OUTPUT THE APPROPRIATE             @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1138
*                                   /*                       @Y30LB39*/
*       IF TESTRC=LASTCC04 THEN     /*                       @Y30LB39
*                                                            @Y30LB39*/
         CR    TESTRC,@02                                          1138
         BNE   @RF01138                                            1138
*         CALL SSCMSG(REASON,ECBBYTE);/*                     @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1139
         LA    @15,REASON                                          1139
         ST    @15,@AL00001                                        1139
         LA    @15,ECBBYTE                                         1139
         ST    @15,@AL00001+4                                      1139
         LA    @01,@AL00001                                        1139
         BAL   @14,SSCMSG                                          1139
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT FOR SECONDARY MESSAGE IDC1707I       @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1140
*                                   /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
@RF01138 L     @15,DDSTRU                                          1140
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1140
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01548                            1141
*       DARGSENT=MSG1707I;          /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'08'                                 1142
*       DARGDBP=ADDR(COPOWNER);     /*                       @Y30LB39*/
         LA    @14,COPOWNER(,COPYVPTR)                             1143
         ST    @14,DARGDBP(,@15)                                   1143
*       DARGILP=LENGTH(COPOWNER);   /*                       @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00444                             1144
*       DARGCNT=DATEINST;           /*                       @Y30LB39*/
         LA    @14,1                                               1145
         STH   @14,DARGCNT(,@15)                                   1145
*       DARGINS(1)=DATEINST;        /*                       @Y30LB39*/
         STH   @14,DARGINS(,@15)                                   1146
*       DARGINL(1)=LENGTH(NEWCDATE);/*                       @Y30LB39*/
         MVC   DARGINL(2,@15),@CH00042                             1147
*       DARGDTM(1)=ADDR(NEWCDATE);  /*                       @Y30LB39
*                                                            @Y30LB39*/
         LA    @14,NEWCDATE                                        1148
         ST    @14,DARGDTM(,@15)                                   1148
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        1149
         ST    @15,@AL00001                                        1149
         LA    @14,@CF00115                                        1149
         ST    @14,@AL00001+4                                      1149
         LA    @14,DDSTRU                                          1149
         ST    @14,@AL00001+8                                      1149
         MVI   @AL00001+8,X'80'                                    1149
         L     @15,GDTPRT(,@15)                                    1149
         LA    @01,@AL00001                                        1149
         BALR  @14,@15                                             1149
*     END;                          /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1151
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @Y30LB39*/
*     /* RETURN CODE FROM USSC WAS ZERO, SO ISSUE            @Y30LB39*/
*     /* UFSPACE TO RELEASE THE MESSAGE STORAGE AREA.        @Y30LB39*/
*     /*                                                     @Y30LB39*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1151
*                                   /*                       @Y30LB39*/
*     CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1151
         B     @RC01135                                            1151
@RF01135 L     @15,@PC00001                                        1151
         ST    @15,@AL00001                                        1151
         LA    @14,CMMSGPTR                                        1151
         ST    @14,@AL00001+4                                      1151
         L     @15,GDTFSP(,@15)                                    1151
         LA    @01,@AL00001                                        1151
         BALR  @14,@15                                             1151
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1152
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR2;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1152
@RC01135 LR    REG14,RETADDR2                                      1152
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*                                   /*                       @Y30LB39*/
*   RETURN CODE(LABLRC);            /*                       @Y30LB39*/
         LR    @15,LABLRC                                          1153
@EL00012 DS    0H                                                  1153
@EF00012 DS    0H                                                  1153
@ER00012 BR    @14                                                 1153
*   END LABELRTN;                   /*                       @Y30LB39*/
*                                                                  1155
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - SCRRTN                               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* DETERMINE HOW MANY, IF ANY, EXCESS BACKUP             @Y30LB39*/
*   /* COPIES ARE IN EXISTENCE. ONCE THIS DETERMINA-         @Y30LB39*/
*   /* TION HAS BEEN MADE. THIS SUB-PROCEDURE WILL           @Y30LB39*/
*   /* LOOP AND MAKE A CALL TO RVVIRTN TO RETRIEVE           @Y30LB39*/
*   /* EACH BACKUP COPY AND THEN, FOR EACH BACKUP,           @Y30LB39*/
*   /* A CALL TO ANOTHER SUBPROCEDURE, SCRCOPY, TO           @Y30LB39*/
*   /* SCRATCH THE BACKUP.                                   @Y30LB39*/
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/
*   /* IDC0068I TO TELL USER HOW MANY BACKUP COPIES          @Y30LB39*/
*   /* WERE IN EXCESS OF THE LIMIT.                          @Y30LB39*/
*   /* IDC3701I IF UNABLE TO RETRIEVE BACKUP COPY.           @Y30LB39*/
*   /* IDC2078I IF UNABLE TO SCRATCH EXCESS COPIES.          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* 8 - IF EITHER BACKUP COPY WAS NOT RETRIEVED           @Y30LB39*/
*   /* OR SCRATCHED.                                         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*SCRRTN:                                                           1155
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  1155
SCRRTN   DS    0H                                                  1156
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1156
*                                   /*                       @Y30LB39*/
*   DCL                                                            1156
*     SCRRC FIXED(8);               /* RETURN CODE           @Y30LB39*/
*   DCL                                                            1157
*     OVERFLOW FIXED(8);            /* EXCESS BACKUPS        @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1158
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1158
*                                   /*                       @Y30LB39*/
*   RETADDR1=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1158
         ST    REG14,RETADDR1                                      1158
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1159
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1159
         L     @09,@PC00001                                        1159
         L     @09,GDTTR2(,@09)                                    1159
         MVC   @TS00001(95),NEWERID2(@09)                          1159
         MVC   OLDERID2(95,@09),@TS00001                           1159
*   NEWID2='COSC';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1160
         MVC   NEWID2(4,@09),@CC01728                              1160
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /* INITIALIZE THE LOCAL VARIABLE WHICH WILL HAVE         @Y30LB39*/
*   /* THE EXCESS NUMBER OF BACKUP COPIES VALUE.             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1161
*                                   /*                       @Y30LB39*/
*   SCRRC=LASTCC00;                 /*                       @Y30LB39*/
         MVI   SCRRC,X'00'                                         1161
*   OVERFLOW=0;                     /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1162
         MVI   OVERFLOW,X'00'                                      1162
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DETERMINE WHETHER THE BACKUP LIMIT HAS BEEN           @Y30LB39*/
*   /* REACHED. IF AN INCOMPLETE COPY WAS REUSED             @Y30LB39*/
*   /* WHEN CREATING THE NEWEST BACKUP, THEN INCREASE        @Y30LB39*/
*   /* THE NUMBER OF BACKUP VARIABLE IN THE BASE             @Y30LB39*/
*   /* VOLUME RECORD.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1163
*                                   /*                       @Y30LB39*/
*   IF REUSEFLG=ON&OBKUPFLG=OFF THEN/*                       @Y30LB39*/
         TM    REUSEFLG,B'10000000'                                1163
         BNO   @RF01163                                            1163
         TM    OBKUPFLG,B'01000000'                                1163
         BNZ   @RF01163                                            1163
*     BASNBKUP=BASNBKUP+1;          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1164
         LA    @09,1                                               1164
         SLR   @07,@07                                             1164
         IC    @07,BASNBKUP(,BASEVPTR)                             1164
         ALR   @09,@07                                             1164
         STC   @09,BASNBKUP(,BASEVPTR)                             1164
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE NUMBER OF CURRENT BACKUPS IS GREATER           @Y30LB39*/
*   /* THAN THE ALLOWABLE LIMIT, THEN CALCULATE THE          @Y30LB39*/
*   /* EXCESS NUMBER.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1165
*                                   /*                       @Y30LB39*/
*   IF BASNBKUP>BASBKLMT THEN       /*                       @Y30LB39*/
@RF01163 CLC   BASNBKUP(1,BASEVPTR),BASBKLMT(BASEVPTR)             1165
         BNH   @RF01165                                            1165
*     OVERFLOW=BASNBKUP-BASBKLMT;   /*                       @Y30LB39*/
         SLR   @09,@09                                             1166
         IC    @09,BASNBKUP(,BASEVPTR)                             1166
         SLR   @07,@07                                             1166
         IC    @07,BASBKLMT(,BASEVPTR)                             1166
         SLR   @09,@07                                             1166
         STC   @09,OVERFLOW                                        1166
*                                   /*                       @Y30LB39*/
*                                                                  1167
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLING ROUTINE IF THE ALLOWABLE            @Y30LB39*/
*   /* NUMBER OF BACKUPS HAS NOT BEEN EXCEEDED.              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1167
*                                   /*                       @Y30LB39*/
*   IF OVERFLOW>0 THEN              /*                       @Y30LB39*/
@RF01165 CLI   OVERFLOW,0                                          1167
         BNH   @RF01167                                            1167
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1168
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT FOR MESSAGE IDC0068I TO              @Y30LB39*/
*       /* INFORM THE FSR CALLER OF THE NUMBER               @Y30LB39*/
*       /* OF EXCESSIVE BACKUP COPIES THAT WILL              @Y30LB39*/
*       /* BE ERASED.                                        @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1169
*                                   /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
         L     @09,DDSTRU                                          1169
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1169
*       DARGSMOD=COMNMSG;           /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01550                            1170
*       DARGSENT=MSG0068I;          /*                       @Y30LB39*/
         MVI   DARGSENT(@09),X'28'                                 1171
*       DARGDBP=ADDR(OVERFLOW);     /*                       @Y30LB39*/
         LA    @07,OVERFLOW                                        1172
         ST    @07,DARGDBP(,@09)                                   1172
*       DARGILP=LENGTH(OVERFLOW);   /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00219                             1173
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1174
         L     @09,@PC00001                                        1174
         ST    @09,@AL00001                                        1174
         LA    @07,@CF00115                                        1174
         ST    @07,@AL00001+4                                      1174
         LA    @07,DDSTRU                                          1174
         ST    @07,@AL00001+8                                      1174
         MVI   @AL00001+8,X'80'                                    1174
         L     @15,GDTPRT(,@09)                                    1174
         LA    @01,@AL00001                                        1174
         BALR  @14,@15                                             1174
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* PROCEED TO ERASE ALL EXCESS BACKUP COPIES         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1175
*                                   /*                       @Y30LB39*/
*       DO WHILE OVERFLOW^=0;       /*                       @Y30LB39*/
         B     @DE01175                                            1175
@DL01175 DS    0H                                                  1176
*         RECTYPE=BKUPCHAR;         /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1176
         MVC   RECTYPE(4),BKUPCHAR                                 1176
*         /***********************************************************/
*         /*                                                         */
*         /*                                                 @Y30LB39*/
*         /* AFTER SETTING RECORD TYPE TO BACKUP, CALL       @Y30LB39*/
*         /* RVVIRTN TO READ THE OLDEST BACKUP.              @Y30LB39*/
*         /*                                                 @Y30LB39*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1177
*                                   /*                       @Y30LB39*/
*         CALL RVVIRTN;             /*                       @Y30LB39*/
         BAL   @14,RVVIRTN                                         1177
*         RESPECIFY                                                1178
*           RTNREG RSTD;                                           1178
*         TESTRC=RTNREG;                                           1179
         LR    TESTRC,RTNREG                                       1179
*         RESPECIFY                                                1180
*           RTNREG UNRSTD;          /*                       @Y30LB39*/
*         IF TESTRC^=0 THEN         /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       1181
         BZ    @RF01181                                            1181
*           DO;                     /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1182
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* RETURN CODE FROM RVVIRTN IS NOT ZERO,       @Y30LB39*/
*             /* SO SET CONDITION CODE TO EIGHT.             @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1183
*                                   /*                       @Y30LB39*/
*             SCRRC=LASTCC08;       /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1183
         MVI   SCRRC,X'08'                                         1183
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* ISSUE UPRINT FOR MESSAGE IDC3701I           @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1184
*                                   /*                       @Y30LB39*/
*             DARGLIST=''B;         /*                       @Y30LB39*/
         L     @09,DDSTRU                                          1184
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1184
*             DARGSMOD=COPYMSG;     /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01548                            1185
*             DARGSENT=MSG3701I;    /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVI   DARGSENT(@09),X'02'                                 1186
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1187
         L     @09,@PC00001                                        1187
         ST    @09,@AL00001                                        1187
         LA    @07,@CF00115                                        1187
         ST    @07,@AL00001+4                                      1187
         LA    @07,DDSTRU                                          1187
         ST    @07,@AL00001+8                                      1187
         MVI   @AL00001+8,X'80'                                    1187
         L     @15,GDTPRT(,@09)                                    1187
         LA    @01,@AL00001                                        1187
         BALR  @14,@15                                             1187
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* FORCE END OF DO WHILE LOOP                  @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1188
*                                   /*                       @Y30LB39*/
*             OVERFLOW=STOPLOOP;    /*                       @Y30LB39*/
         MVI   OVERFLOW,X'00'                                      1188
*           END;                    /*                       @Y30LB39*/
*         IF SCRRC=0 THEN           /*                       @Y30LB39*/
@RF01181 CLI   SCRRC,0                                             1190
         BNE   @RF01190                                            1190
*           DO;                     /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1191
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* CALL SCRCOPY TO SCRATCH OLDEST BACKUP       @Y30LB39*/
*             /* COPY WHICH WAS JUST READ IN.                @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1192
*                                   /*                       @Y30LB39*/
*             CALL SCRCOPY(IOERRFLG);/*                      @Y30LB39
*                                                            @Y30LB39*/
         LA    @09,IOERRFLG                                        1192
         ST    @09,@AL00001                                        1192
         LA    @01,@AL00001                                        1192
         BAL   @14,SCRCOPY                                         1192
*             RESPECIFY                                            1193
*               RTNREG RSTD;                                       1193
*             TESTRC=RTNREG;                                       1194
         LR    TESTRC,RTNREG                                       1194
*             RESPECIFY                                            1195
*               RTNREG UNRSTD;      /*                       @Y30LB39*/
*             IF TESTRC^=0 THEN     /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       1196
         BZ    @RF01196                                            1196
*               DO;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1197
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB39*/
*                 /* IF RETURN CODE IS NOT ZERO, SET         @Y30LB39*/
*                 /* CONDITION CODE TO EIGHT.                @Y30LB39*/
*                 /*                                         @Y30LB39*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1198
*                                   /*                       @Y30LB39*/
*                 SCRRC=LASTCC08;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1198
         MVI   SCRRC,X'08'                                         1198
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB39*/
*                 /* IF THE RETURN CODE WAS EIGHT AND        @Y30LB39*/
*                 /* NOT ALL OF THE EXCESS BACKUP            @Y30LB39*/
*                 /* COPIES HAVE BEEN SCRATCHED, THEN        @Y30LB39*/
*                 /* PREPARE TO RETURN TO CALLER AFTER       @Y30LB39*/
*                 /* ISSUING MESSAGE IDC2078I.               @Y30LB39*/
*                 /*                                         @Y30LB39*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1199
*                                   /*                       @Y30LB39*/
*                 IF TESTRC=LASTCC08&OVERFLOW>0 THEN               1199
         C     TESTRC,@CF00179                                     1199
         BNE   @RF01199                                            1199
         CLI   OVERFLOW,0                                          1199
         BNH   @RF01199                                            1199
*                   DO;             /*                       @Y30LB39*/
*                     DARGLIST=''B; /*                       @Y30LB39*/
         L     @09,DDSTRU                                          1201
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1201
*                     DARGSMOD=COMNMSG;/*                    @Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01550                            1202
*                     DARGSENT=MSG2078I;/*                   @Y30LB39*/
         MVI   DARGSENT(@09),X'1C'                                 1203
*                     DARGDBP=ADDR(VOLVAL);/*                @Y30LB39*/
         L     @07,@PC00001+4                                      1204
         L     @07,FDTPTR(,@07)                                    1204
         LA    @04,VOLVAL(,@07)                                    1204
         ST    @04,DARGDBP(,@09)                                   1204
*                     DARGILP=VOLLEN;/*                      @Y30LB39
*                                                            @Y30LB39*/
         SLR   @04,@04                                             1205
         IC    @04,VOLLEN(,@07)                                    1205
         STH   @04,DARGILP(,@09)                                   1205
*                     CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      1206
*                                                            @Y30LB39
*                                                            @Y30LB39*/
         L     @09,@PC00001                                        1206
         ST    @09,@AL00001                                        1206
         LA    @07,@CF00115                                        1206
         ST    @07,@AL00001+4                                      1206
         LA    @07,DDSTRU                                          1206
         ST    @07,@AL00001+8                                      1206
         MVI   @AL00001+8,X'80'                                    1206
         L     @15,GDTPRT(,@09)                                    1206
         LA    @01,@AL00001                                        1206
         BALR  @14,@15                                             1206
*                   END;            /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1207
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB39*/
*                 /* FORCE END OF DO WHILE LOOP.             @Y30LB39*/
*                 /*                                         @Y30LB39*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1208
*                                   /*                       @Y30LB39*/
*                 OVERFLOW=STOPLOOP;/*                       @Y30LB39*/
@RF01199 MVI   OVERFLOW,X'00'                                      1208
*               END;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1209
*             /*******************************************************/
*             /*                                                     */
*             /*                                             @Y30LB39*/
*             /* OLDEST BACKUP HAS BEEN SUCCESSFULLY         @Y30LB39*/
*             /* READ AND SCRATCHED. DECREMENT THE           @Y30LB39*/
*             /* EXCESSIVE BACKUP NUMBER AND CONTINUE        @Y30LB39*/
*             /* IF NOT ZERO.                                @Y30LB39*/
*             /*                                             @Y30LB39*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1210
*                                   /*                       @Y30LB39*/
*             ELSE                  /*                       @Y30LB39*/
*               OVERFLOW=OVERFLOW-1;/*                       @Y30LB39*/
         B     @RC01196                                            1210
@RF01196 SLR   @09,@09                                             1210
         IC    @09,OVERFLOW                                        1210
         BCTR  @09,0                                               1210
         STC   @09,OVERFLOW                                        1210
*           END;                    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1211
@RC01196 DS    0H                                                  1212
*         /***********************************************************/
*         /*                                                         */
*         /*                                                 @Y30LB39*/
*         /* THE NEXT END REPRESENTS THE END OF THE          @Y30LB39*/
*         /* DO WHILE LOOP.                                  @Y30LB39*/
*         /*                                                 @Y30LB39*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1212
*                                   /*                       @Y30LB39*/
*       END;                        /*                       @Y30LB39*/
@RF01190 DS    0H                                                  1212
@DE01175 CLI   OVERFLOW,0                                          1212
         BNE   @DL01175                                            1212
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1213
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1214
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR1;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1214
@RF01167 L     REG14,RETADDR1                                      1214
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1215
*                                   /*                       @Y30LB39*/
*   RETURN CODE(SCRRC);             /*                       @Y30LB39*/
         SLR   @15,@15                                             1215
         IC    @15,SCRRC                                           1215
@EL00013 DS    0H                                                  1215
@EF00013 DS    0H                                                  1215
@ER00013 BR    @14                                                 1215
*   END SCRRTN;                     /*                       @Y30LB39*/
*                                                                  1217
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* PROCEDURE NAME - RVVIRTN                              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/
*   /* RETRIEVE THE TYPE OF RECORD REQUESTED BY THE          @Y30LB39*/
*   /* CALLER.                                               @Y30LB39*/
*   /* ONCE THIS DETERMINATION HAS BEEN MADE BY              @Y30LB39*/
*   /* EXAMINING THE CHARACTER TYPE SET IN THE COPYV         @Y30LB39*/
*   /* INTERNAL TABLE, THEN THE PARAMETER LIST IS            @Y30LB39*/
*   /* SET UP AND MSVC IS INVOKED TO RETRIEVE THE            @Y30LB39*/
*   /* RECORD. IF THE RECORD COULD NOT BE RETRIEVED,         @Y30LB39*/
*   /* THEN ONE OF THE FOLLOWING MESSAGES IS ISSUED.         @Y30LB39*/
*   /* MESSAGE IDC2080I IF BASE RECORD IS NOT READ.          @Y30LB39*/
*   /* MESSAGE IDC3700I IF COPY RECORD NOT READ.             @Y30LB39*/
*   /* MESSAGE IDC3701I IF BACKUP RECORD NOT READ.           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/
*   /* AND COPY VOLUME RECORD @Y30LB399                      @Y30LB39*/
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/
*   /* AND BUFFER CONTAINS RECORD.                           @Y30LB39*/
*   /* 4 - IF MSVC COULD NOT RETRIEVE RECORD.                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1217
*RVVIRTN:                                                          1217
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/
*                                                                  1217
RVVIRTN  DS    0H                                                  1218
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1218
*                                   /*                       @Y30LB39*/
*   DCL                                                            1218
*     RVVIRC FIXED(8);              /* RETURN CODE           @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1219
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1219
*                                   /*                       @Y30LB39*/
*   RETADDR3=REG14;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1219
         ST    REG14,RETADDR3                                      1219
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1220
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1220
         L     @15,@PC00001                                        1220
         L     @15,GDTTR2(,@15)                                    1220
         MVC   @TS00001(95),NEWERID2(@15)                          1220
         MVC   OLDERID2(95,@15),@TS00001                           1220
*   NEWID2='CORV';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1221
         MVC   NEWID2(4,@15),@CC01734                              1221
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1222
*                                   /*                       @Y30LB39*/
*   RVVIRC=LASTCC00;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1222
         MVI   RVVIRC,X'00'                                        1222
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* INITIALIZE RVVI PARAMETER LIST FOR THE TYPE OF        @Y30LB39*/
*   /* RECORD TO BE READ. NOTE THAT ALTHOUGH THREE           @Y30LB39*/
*   /* TYPES OF RECORDS CAN BE READ, THAT IT IS ONLY         @Y30LB39*/
*   /* NECESSARY TO HAVE TWO RECORD BUFFERS. ONE             @Y30LB39*/
*   /* FOR COPY AND BACKUP TYPES AND ANOTHER FOR BASE        @Y30LB39*/
*   /* VOLUME RECORDS.                                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1223
*                                   /*                       @Y30LB39*/
*   RVVI=''B;                       /*                       @Y30LB39*/
         L     @15,RVVIPTR                                         1223
         XC    RVVI(68,@15),RVVI(@15)                              1223
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB39*/
         LH    @14,RVVLEN                                          1224
         ST    @14,RVVLNGTH(,@15)                                  1224
*   RVVCODE=RVVOP;                  /*                       @Y30LB39*/
         MVI   RVVCODE(@15),X'87'                                  1225
*   RVVOLUME=VOLVAL;                /*                       @Y30LB39*/
         L     @14,@PC00001+4                                      1226
         L     @01,FDTPTR(,@14)                                    1226
         MVC   RVVOLUME(6,@15),VOLVAL(@01)                         1226
*   RVVSVOL=ON;                     /*                       @Y30LB39*/
         OI    RVVSVOL(@15),B'00000001'                            1227
*   RVVRDR=ON;                      /*                       @Y30LB39*/
         OI    RVVRDR(@15),B'10000000'                             1228
*   IF RECTYPE=BASECHAR THEN        /*                       @Y30LB39*/
         CLC   RECTYPE(4),BASECHAR                                 1229
         BNE   @RF01229                                            1229
*     DO;                           /*                       @Y30LB39*/
*       RVVRTBUF=BASEVPTR;          /*                       @Y30LB39*/
         ST    BASEVPTR,RVVRTBUF(,@15)                             1231
*       RVVBUFLN=LENGTH(BASEV);     /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1232
         MVC   RVVBUFLN(2,@15),@CH01910                            1232
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* SET FLAG TO SHOW THAT A BASE VOLUME               @Y30LB39*/
*       /* RECORD IS BEING RETRIEVED.                        @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1233
*                                   /*                       @Y30LB39*/
*       RVVBVRCD=ON;                /*                       @Y30LB39*/
         OI    RVVBVRCD(@15),B'10000000'                           1233
*     END;                          /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01229                                            1235
@RF01229 DS    0H                                                  1236
*       RVVRTBUF=COPYVPTR;          /*                       @Y30LB39*/
         L     @15,RVVIPTR                                         1236
         ST    COPYVPTR,RVVRTBUF(,@15)                             1236
*       RVVBUFLN=LENGTH(COPYV);     /*                       @Y30LB39*/
         MVC   RVVBUFLN(2,@15),@CH01911                            1237
*       RVVCPYRC=ON;                /*                       @Y30LB39*/
         OI    RVVCPYRC(@15),B'00100000'                           1238
*       IF RECTYPE=COPYCHAR THEN    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1239
         CLC   RECTYPE(4),COPYCHAR                                 1239
         BNE   @RF01239                                            1239
*         /***********************************************************/
*         /*                                                         */
*         /*                                                 @Y30LB39*/
*         /* SET FLAG TO SHOW THAT LATEST COPY VOLUME        @Y30LB39*/
*         /* RECORD IS BEING RETRIEVED.                      @Y30LB39*/
*         /*                                                 @Y30LB39*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1240
*                                   /*                       @Y30LB39*/
*         RVVLCOPY=ON;              /*                       @Y30LB39*/
         OI    RVVLCOPY(@15),B'00100000'                           1240
*       ELSE                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1241
*         /***********************************************************/
*         /*                                                         */
*         /*                                                 @Y30LB39*/
*         /* SET FLAG TO SHOW OLDEST BACKUP VOLUME           @Y30LB39*/
*         /* RECORD IS BEING RETRIEVED.                      @Y30LB39*/
*         /*                                                 @Y30LB39*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1241
*                                   /*                       @Y30LB39*/
*         RVVOBKUP=ON;              /*                       @Y30LB39*/
         B     @RC01239                                            1241
@RF01239 L     @01,RVVIPTR                                         1241
         OI    RVVOBKUP(@01),B'01000000'                           1241
*     END;                          /*                       @Y30LB39*/
@RC01239 DS    0H                                                  1243
*                                   /*                       @Y30LB39*/
*                                                                  1243
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE USSC TO READ THE SPECIFIED INVENTORY            @Y30LB39*/
*   /* RECORD AFTER DUMPING RVVI PARAMETER LIST              @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1243
*                                   /*                       @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         1243
@RC01229 L     @15,@PC00001                                        1243
         L     @15,GDTDBG(,@15)                                    1243
         LTR   @15,@15                                             1243
         BZ    @RT01243                                            1243
*     ;                                                            1244
*   ELSE                                                           1245
*     DO;                                                          1245
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/
         LA    DMPINDEX,DUMPLIST                                   1246
*       DMPITMNM='RVVI';                                           1247
         MVI   DMPITMNM+4(DMPINDEX),C' '                           1247
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         1247
         MVC   DMPITMNM(4,DMPINDEX),@CC01735                       1247
*       DMPITMPT=ADDR(RVVI);                                       1248
         L     @03,RVVIPTR                                         1248
         ST    @03,DMPITMPT(,DMPINDEX)                             1248
*       DMPITMLN=RVVLEN;                                           1249
         LH    @03,RVVLEN                                          1249
         STH   @03,DMPITMLN(,DMPINDEX)                             1249
*       DMPITMTP='H';                                              1250
         MVI   DMPITMTP(DMPINDEX),C'H'                             1250
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB39*/
         AL    DMPINDEX,@CF00474                                   1251
*       DMPTRM=DMPTRMVL;                                           1252
         MVI   DMPTRM(DMPINDEX),X'FF'                              1252
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*   IF GDTDBG=NULLPTR THEN                                         1254
@RT01243 L     @15,@PC00001                                        1254
         L     @15,GDTDBG(,@15)                                    1254
         LTR   @15,@15                                             1254
         BZ    @RT01254                                            1254
*     ;                                                            1255
*   ELSE                                                           1256
*     CALL IDCDB010(GDTTBL,'CORR',ADDR(DUMPLIST));/*         @Y30LB39
*                                                            @Y30LB39*/
         L     @15,@PC00001                                        1256
         ST    @15,@AL00001                                        1256
         LA    @14,@CC01736                                        1256
         ST    @14,@AL00001+4                                      1256
         LA    @14,DUMPLIST                                        1256
         ST    @14,@AFTEMPS+20                                     1256
         LA    @14,@AFTEMPS+20                                     1256
         ST    @14,@AL00001+8                                      1256
         MVI   @AL00001+8,X'80'                                    1256
         L     @15,GDTDBG(,@15)                                    1256
         LA    @01,@AL00001                                        1256
         BALR  @14,@15                                             1256
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASON);/*             @Y30LB39
*                                                            @Y30LB39*/
@RT01254 L     @02,@PC00001                                        1257
         ST    @02,@AL00001                                        1257
         LA    @15,VVIC                                            1257
         ST    @15,@AL00001+4                                      1257
         LA    @15,RVVIPTR                                         1257
         ST    @15,@AL00001+8                                      1257
         LA    @15,REASON                                          1257
         ST    @15,@AL00001+12                                     1257
         MVI   @AL00001+12,X'80'                                   1257
         L     @15,GDTSSC(,@02)                                    1257
         LA    @01,@AL00001                                        1257
         BALR  @14,@15                                             1257
*   RESPECIFY                                                      1258
*     RTNREG RSTD;                                                 1258
*   TESTRC=RTNREG;                                                 1259
         LR    TESTRC,RTNREG                                       1259
*   RESPECIFY                                                      1260
*     RTNREG UNRSTD;                /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1260
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF USSC RETURN CODE IS ZERO, THEN RETURN TO           @Y30LB39*/
*   /* CALLER OF THIS SUBROUTINE.                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1261
*                                   /*                       @Y30LB39*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/
         LTR   TESTRC,TESTRC                                       1261
         BZ    @RF01261                                            1261
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1262
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* SET CONDITION CODE TO 4 AND CALL SSCMSG           @Y30LB39*/
*       /* TO OUTPUT THE APPROPRIATE REASON CODE             @Y30LB39*/
*       /* MESSAGE.                                          @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1263
*                                   /*                       @Y30LB39*/
*       RVVIRC=LASTCC04;            /*                       @Y30LB39
*                                                            @Y30LB39*/
         MVI   RVVIRC,X'04'                                        1263
*       CALL SSCMSG(REASON);        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1264
         LA    @15,REASON                                          1264
         ST    @15,@AL00001                                        1264
         LA    @01,@AL00001                                        1264
         BAL   @14,SSCMSG                                          1264
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT FOR APPROPRIATE SECONDARY            @Y30LB39*/
*       /* MESSAGE.                                          @Y30LB39*/
*       /* MESSAGE IDC2080I IF BASE RECORD NOT READ          @Y30LB39*/
*       /* MESSAGE IDC3700I IF COPY RECORD NOT READ          @Y30LB39*/
*       /* MESSAGE IDC3701I IF BACKUP RECORD NOT TEAD        @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1265
*                                   /*                       @Y30LB39*/
*       DARGLIST=''B;               /*                       @Y30LB39*/
         L     @15,DDSTRU                                          1265
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1265
*       IF RECTYPE=BASECHAR THEN    /*                       @Y30LB39*/
         CLC   RECTYPE(4),BASECHAR                                 1266
         BNE   @RF01266                                            1266
*         DO;                       /*                       @Y30LB39*/
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01550                            1268
*           DARGSENT=MSG2080I;      /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'1A'                                 1269
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB39*/
         L     @14,@PC00001+4                                      1270
         L     @14,FDTPTR(,@14)                                    1270
         LA    @03,VOLVAL(,@14)                                    1270
         ST    @03,DARGDBP(,@15)                                   1270
*           DARGILP=VOLLEN;         /*                       @Y30LB39*/
         SLR   @03,@03                                             1271
         IC    @03,VOLLEN(,@14)                                    1271
         STH   @03,DARGILP(,@15)                                   1271
*         END;                      /*                       @Y30LB39*/
*       ELSE                        /*                       @Y30LB39*/
*         DO;                       /*                       @Y30LB39*/
         B     @RC01266                                            1273
@RF01266 DS    0H                                                  1274
*           DARGSMOD=COPYMSG;       /*                       @Y30LB39*/
         L     @15,DDSTRU                                          1274
         MVC   DARGSMOD(3,@15),@CC01548                            1274
*           IF RECTYPE=COPYCHAR THEN/*                       @Y30LB39*/
         CLC   RECTYPE(4),COPYCHAR                                 1275
         BNE   @RF01275                                            1275
*             DARGSENT=MSG3700I;    /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 1276
*           ELSE                    /*                       @Y30LB39*/
*             DARGSENT=MSG3701I;    /*                       @Y30LB39*/
         B     @RC01275                                            1277
@RF01275 L     @01,DDSTRU                                          1277
         MVI   DARGSENT(@01),X'02'                                 1277
*         END;                      /*                       @Y30LB39
*                                                            @Y30LB39*/
@RC01275 DS    0H                                                  1279
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39
*                                                            @Y30LB39*/
@RC01266 L     @15,@PC00001                                        1279
         ST    @15,@AL00001                                        1279
         LA    @14,@CF00115                                        1279
         ST    @14,@AL00001+4                                      1279
         LA    @14,DDSTRU                                          1279
         ST    @14,@AL00001+8                                      1279
         MVI   @AL00001+8,X'80'                                    1279
         L     @15,GDTPRT(,@15)                                    1279
         LA    @01,@AL00001                                        1279
         BALR  @14,@15                                             1279
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1280
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1281
*                                   /*                       @Y30LB39*/
*   REG14=RETADDR3;                 /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1281
@RF01261 L     REG14,RETADDR3                                      1281
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1282
*                                   /*                       @Y30LB39*/
*   RETURN CODE(RVVIRC);            /*                       @Y30LB39*/
         SLR   @15,@15                                             1282
         IC    @15,RVVIRC                                          1282
@EL00014 DS    0H                                                  1282
@EF00014 DS    0H                                                  1282
@ER00014 BR    @14                                                 1282
*   END RVVIRTN;                    /*                       @Y30LB39*/
*                                                                  1284
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/
*   /* CHECK CARTRIDGE SERIAL NUMBERS.                       @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1284
*                                   /*                       @Y30LB39*/
*/****************************************************************** */
*/*                                                          @Y30LB32*/
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/
*/*             CHARACTER                                    @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/
*/*                                                          @Y30LB32*/
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/
*/*                                                          @Y30LB32*/
*/********************************************************************/
*                                                                  1284
*CKCSNLEN:                          /*                       @Y30LB32*/
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/
*                                                                  1284
CKCSNLEN MVC   @PC00015(8),0(@01)                                  1284
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1285
*   DCL                                                            1285
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/
*   DCL                                                            1286
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/
*   DCL                                                            1287
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/
*   DCL                                                            1288
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/
*   DCL                                                            1289
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/
*   DCL                                                            1290
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/
*   DCL                                                            1291
*     CKCOND FIXED(15);                                            1291
*                                                                  1291
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1292
*   DCL                                                            1292
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32
*                                      CSN                   @Y30LB32*/
*   DCL                                                            1293
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32
*                                      OF CSN AGAINST        @Y30LB32*/
*   DCL                                                            1294
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/
*   DCL                                                            1295
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/
*                                                                  1296
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1296
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/
         LR    CKRETPTR,REG14                                      1296
*   OLDERID2=NEWERID2;                                             1297
         L     @02,@PC00001                                        1297
         L     @02,GDTTR2(,@02)                                    1297
         MVC   @TS00001(95),NEWERID2(@02)                          1297
         MVC   OLDERID2(95,@02),@TS00001                           1297
*   NEWID2='CKLN';                  /*                       @Y30LB32*/
*                                                                  1298
         MVC   NEWID2(4,@02),@CC01755                              1298
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1299
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/
         L     CKSAVPTR,DDSTRU                                     1299
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/
         LA    @02,CKPRTTAB                                        1300
         ST    @02,DDSTRU                                          1300
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/
         XC    CKPRTTAB(20),CKPRTTAB                               1301
*   CKCOND=''B;                     /*                       @Y30LB32*/
*                                                                  1302
         SLR   CKCOND,CKCOND                                       1302
*   /*****************************************************************/
*   /*                                                               */
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/
*   /* OR MORE                                               @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1303
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/
*                                                                  1303
         L     @02,@PC00015+4                                      1303
         CLI   CKLENGTH(@02),11                                    1303
         BL    @RF01303                                            1303
*     /***************************************************************/
*     /*                                                             */
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/
*     /* CHARACTER                                           @Y30LB32*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1304
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/
         CLI   CKLENGTH(@02),11                                    1304
         BNE   @RF01304                                            1304
*       DO;                         /*                       @Y30LB32*/
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/
         MVI   CKCSNADJ+3,C' '                                     1306
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/
         L     @02,@PC00015                                        1307
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@02)                       1307
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/
         MVC   CKCSNVAL+3(9,@02),CKCSNADJ+3                        1308
*       END;                        /*                       @Y30LB32*/
*     ELSE                                                         1310
*       ;                           /*                       @Y30LB32*/
*                                                                  1310
@RF01304 DS    0H                                                  1311
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1311
*   ELSE                            /*                       @Y30LB32*/
*     DO;                           /*                       @Y30LB32*/
         B     @RC01303                                            1311
@RF01303 DS    0H                                                  1312
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/
         L     @02,DDSTRU                                          1312
         MVC   DARGSMOD(3,@02),@CC01550                            1312
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/
         MVI   DARGSENT(@02),X'01'                                 1313
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/
         L     @15,@PC00015                                        1314
         ST    @15,DARGDBP(,@02)                                   1314
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/
         MVC   DARGILP(2,@02),@CH00567                             1315
*       DARGRETP=''B;               /*                       @Y30LB32*/
         SLR   @15,@15                                             1316
         ST    @15,DARGRETP(,@02)                                  1316
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/
         L     @02,@PC00001                                        1317
         ST    @02,@AL00001                                        1317
         LA    @15,@CF00115                                        1317
         ST    @15,@AL00001+4                                      1317
         LA    @15,DDSTRU                                          1317
         ST    @15,@AL00001+8                                      1317
         MVI   @AL00001+8,X'80'                                    1317
         L     @15,GDTPRT(,@02)                                    1317
         LA    @01,@AL00001                                        1317
         BALR  @14,@15                                             1317
*       CKCOND=4;                   /*                       @Y30LB32*/
         LA    CKCOND,4                                            1318
*     END;                          /*                       @Y30LB32*/
*                                                                  1319
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1320
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/
@RC01303 ST    CKSAVPTR,DDSTRU                                     1320
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/
         LR    REG14,CKRETPTR                                      1321
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/
         LR    @15,CKCOND                                          1322
@EL00015 DS    0H                                                  1322
@EF00015 DS    0H                                                  1322
@ER00015 BR    @14                                                 1322
*   END CKCSNLEN;                   /*                       @Y30LB32*/
*                                                                  1324
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/
*   /* EJECT AN INACTIVE VOLUME FROM LIBRARY.                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1324
*                                   /*                       @Y30LB39*/
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - VOLEXIT                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - REMOVES A VOLUME FROM THE MSF.            @Y30LB38*/
*/*                IF THE VOLUME IS EJECTED SUCCESSFULLY,    @Y30LB38*/
*/*                ISSUES MESSAGE IDC0085I TO SYSPRINT AND   @Y30LB38*/
*/*                MESSAGE IDC083E TO THE OPERATOR.  IF THE  @Y30LB38*/
*/*                VOLUME IS NOT EJECTED SUCCESSFULLY, AN    @Y30LB38*/
*/*                ERROR MESSAGE IS ISSUED VIA SSCMSG        @Y30LB38*/
*/*                PROCEDURE AND MESSAGE IDC2084I IS ISSUED  @Y30LB38*/
*/*                TO SYSPRINT.                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - THE FOLLOWING POSITIONAL PARAMETERS ARE      @Y30LB38*/
*/*             PASSED AS INPUT:                             @Y30LB38*/
*/*             ARG1 = CSN OF FIRST VOLUME CARTRIDGE         @Y30LB38*/
*/*             ARG2 = VOLUME SERIAL NUMBER                  @Y30LB38*/
*/*             ARG3 = VVI ERROR FLAG                        @Y30LB38*/
*/*             ARG4 = RETAIN RECORD FLAG                    @Y30LB38*/
*/*             ARG5 = VOLUME STORAGE LOCATION               @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - RETURN CODE IN REG15                        @Y30LB38*/
*/*              REG15 = 00 CARTRIDGES EJECTED SUCCESSFULLY  @Y30LB38*/
*/*              REG15 = 04 CARTRIDGES NOT EJECTED           @Y30LB38*/
*/*                         SUCCESSFULLY                     @Y30LB38*/
*/*              REG15 = 08 SECOND CARTRIDGE NOT EJECTED     @Y30LB38*/
*/*                         SUCCESSFULLY                     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1324
*VOLEXIT:                                                          1324
*   PROCEDURE(VECSN1,               /* CART SERIAL NUMBER    @Y30LB38*/
*       VEVOLUME,                   /* VOL SERIAL NUMBER     @Y30LB38*/
*       VEVVIERR,                   /* VVI ERROR FLAG        @Y30LB38*/
*       VERECFLG,                   /* RETAIN RECORD FLAG    @Y30LB38*/
*       VEVOLLOC)                   /* VOL STORAGE LOC       @Y30LB38*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB38*/
VOLEXIT  MVC   @PC00016(20),0(@01)                                 1324
*                                                                  1325
*/********************************************************************/
*/*          MACCOMP  Y30LB22          SC1DR/BL0019          @Y30LB22*/
*/*          MACSTAT  Y30LB22          74/170/341040         @Y30LB22*/
*/*                                                                  */
*/*          NAME: IEZMCRTE                                  @Y30LB22*/
*/*                                                                  */
*/*          FUNCTION:                                       @Y30LB22*/
*/*                  MAPS THE REQUEST BLOCK                  @Y30LB22*/
*/*                  EXTENSION WHICH IS USED TO PASS         @Y30LB22*/
*/*                  ADDITIONAL INFORMATION TO MASS          @Y30LB22*/
*/*                  STORAGE VOLUME  CONTROL DURING          @Y30LB22*/
*/*                  AN MOVE CARTRIDGE REQUEST.              @Y30LB22*/
*/*                                                                  */
*/*          STATUS:  CHANGE LEVEL = 0                       #Y30LB22*/
*/*                                                          @Y30LB22*/
*/********************************************************************/
*                                                                  1325
*   /*****************************************************************/
*   /*                                                               */
*   /* CONSTANTS FOR IEZMCRTE                                @Y30LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1325
*   DCL                                                            1325
*     MCRLEN FIXED(15) INIT(LENGTH(MCRTE));/* LENGTH         @Y30LB22
*                                      OF EXTENSION          @Y30LB22*/
*                                                                  1325
*   /*****************************************************************/
*   /*                                                               */
*   /* MAPPING MACRO DECLARES                                @Y30LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1326
*   DCL                                                            1326
*     1 MCRTE BASED(MCRTEPTR) BDY(WORD),                           1326
*      2 MCRLNGTH FIXED(31),        /* LENGTH OF EXTENSION   @Y30LB22*/
*      2 MCRLOC CHAR(30),           /* LOCATION/DESTINATION OF VOL 1326
*                                      AFTER EJECTION        @Y30LB22*/
*      2 MCRFLAGA BIT(8),           /* SPECIFICATION FLAGS   @Y30LB22*/
*       3 MCRSPLOC BIT(1),          /* MCRLOC IS SPECIFIED   @Y30LB22*/
*       3 * BIT(7),                 /* UNUSED                @Y30LB22*/
*      2 MCRBLNK1 CHAR(1),          /* BLANK                 @Y30LB22*/
*      2 MCRFLAGB BIT(32),          /* INDICATOR FLAGS       @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*       3 MCRTYPE BIT(8),           /* MOVE CART. TYPE FLAG  @Y30LB22*/
*        4 MCRREC BIT(1),           /* BIT 0=1, REC RETAIN   @Y30LB22
*                                      BIT 0=0, REC DELETE   @Y30LB22*/
*        4 * BIT(7),                /* UNUSED                @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*      2 * CHAR(4);                 /* UNUSED                @Y30LB22*/
*                                                                  1327
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR VOLEXIT                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1327
*   DCL                                                            1327
*     VEDDSTRU POINTER(31);         /* DARGLIST POINTER      @Y30LB38*/
*   DCL                                                            1328
*     MCLSTPTR POINTER(31);         /* BASE PTR FOR MCLIST@Y30LB38   */
*   DCL                                                            1329
*     MCRTEPTR POINTER(31);         /* PTR FOR MCLIST EXT    @Y30LB38*/
*   DCL                                                            1330
*     VERETADR POINTER(31);         /* RETURN ADDR           @Y30LB38*/
*   DCL                                                            1331
*     VEMSGPTR POINTER(31);         /* MESSAGE PTR AREA      @Y30LB38*/
*   DCL                                                            1332
*     VEWTOPTR POINTER(31);         /* WTO MSG POINTER       @Y30LB38*/
*   DCL                                                            1333
*     VECOND FIXED(15);             /* CONDITION CODE        @Y30LB38*/
*   DCL                                                            1334
*     VEWTOLEN FIXED(15);           /* LENGTH OF WTO MSG     @Y30LB38*/
*   DCL                                                            1335
*     VERESNCD FIXED(31);           /* RSN CODE FOR USSC     @Y30LB38*/
*   DCL                                                            1336
*     VEECB CHAR(1);                /* ECB RETURN AREA       @Y30LB38*/
*                                                                  1336
*   /*****************************************************************/
*   /*                                                               */
*   /* PARM LIST FOR UPRINT MACRO WITH MULTIPLE INSERTS      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1337
*   DCL                                                            1337
*     VELIST CHAR(LENGTH(DARGLIST)+(4*LENGTH(DARGARY)));/*   @Y30LB38*/
*                                                                  1337
*   /*****************************************************************/
*   /*                                                               */
*   /* POSITIONAL PARMS FOR INPUT PARMAMETERS                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1338
*   DCL                                                            1338
*     VECSN1 CHAR(12);              /* CART SERIAL NUM       @Y30LB38*/
*   DCL                                                            1339
*     VEVOLUME CHAR(6);             /* VOL SER NUMBER        @Y30LB38*/
*   DCL                                                            1340
*     VEVVIERR BIT(1);              /* VVI ERROR FLAG        @Y30LB38*/
*   DCL                                                            1341
*     VERECFLG BIT(1);              /* RETAIN REC FLAG       @Y30LB38*/
*   DCL                                                            1342
*     VEVOLLOC CHAR(30);            /* VOL LOCATION          @Y30LB38*/
*   DCL                                                            1343
*     VEWTOMSG CHAR(72);            /* UWTO MSG AREA         @Y30LB38*/
*                                                                  1343
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE LIST FORM OF MCLIST MACRO                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1344
*   DCL                                                            1344
*     MCR1 REG(1) PTR;              /* ADDRESS OF REQUEST BLOCK    1344
*                                                            @Y30LB02*/
*                                                                  1344
*   /*****************************************************************/
*   /*                                                               */
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /* MACMEAN MSSC MOVE CARTRIDGE MACRO                     @Y30LB02*/
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1345
*   DCL                                                            1345
*     1 MCLIST BASED(MCLSTPTR),     /* MOVE CARTRIDGE REQUEST BLOCK
*                                                            @Y30LB02*/
*      2 MCRTLEN FIXED(31),         /* LENGTH OF MOVE CARTRIDGE    1345
*                                      REQUEST BLK = 30 HEX  @Y30LB02*/
*      2 MCRTOPCD FIXED(8),         /* MOVE CARTRIDGE OPCODE = 0E HEX
*                                                            @Y30LB02*/
*      2 MCRTRES1 CHAR(1),          /* RESERVED AND ZERO     @Y30LB02*/
*      2 MCRTFLG BIT(8),            /* ONE BYTE FLAGS AREA   @Y30LB02*/
*       3 * BIT(2),                 /* RESERVED AND MUST BE ZERO   1345
*                                                            @Y30LB02*/
*       3 MCRTTRAN BIT(1),          /* SOURCE WITH TRANSIENT CSN1  1345
*                                      SPECD                 @Y30LB02*/
*       3 MCRTSCT BIT(1),           /* SOURCE WITH SCRATCH ATTRIBUTE
*                                                            @Y30LB02*/
*       3 * BIT(4),                 /* RESERVED AND MUST BE ZERO   1345
*                                                            @Y30LB02*/
*      2 MCRTLIB BIT(8),            /* BYTE-LIBID            @Y30LB02*/
*       3 * BIT(6),                 /* RESERVED AND MUST BE ZERO   1345
*                                                            @Y30LB02*/
*       3 MCRTLD BIT(2),            /* BINARY NUMBER ZERO TO THREE 1345
*                                                            @Y30LB02*/
*      2 MCRTRES2 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/
*      2 MCRTRES3 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/
*      2 MCRTCSN CHAR(12),          /* CART SER NO           @Y30LB02*/
*      2 MCRTRES4 CHAR(2),          /* RESERVED              @Y30LB02*/
*      2 MCRTASID CHAR(2),          /* ASID AREA             @Y30LB02*/
*      2 MCRTECB FIXED(31),         /* EVENT CONTROL BLOCK ADDRESS 1345
*                                                            @Y30LB02*/
*      2 MCRTVEXT FIXED(31);        /* MSVC EXTENSION AREA   @Y30LB02*/
*                                                                  1345
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1346
*                                                                  1346
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR MC LIST AND EXTENSION LIST      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1346
*   DCL                                                            1346
*     VEMCLIST CHAR(LENGTH(MCLIST));/*                       @Y30LB38*/
*   DCL                                                            1347
*     VEEXLIST CHAR(LENGTH(MCRTE)); /*                       @Y30LB38*/
*                                                                  1347
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR JOBNAME AND STEPNAME USED BY    @Y30LB38*/
*   /* USYSINFO MACRO                                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1348
*   DCL                                                            1348
*     1 VESYSIN CHAR(16),                                          1348
*      2 VEJOBNAM CHAR(8),                                         1348
*      2 VESTEPNM CHAR(8);          /*                       @Y30LB38*/
*                                                                  1348
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE ROUTING AND DESCRIPTOR CODE AREAS FOR UWTO    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1349
*   DCL                                                            1349
*     1 VEROUTCD BIT(16),                                          1349
*      2 VECD1 BIT(1),                                             1349
*      2 * BIT(15);                 /*                       @Y30LB38*/
*   DCL                                                            1350
*     1 VEDESCCD BIT(16),                                          1350
*      2 * BIT(2),                                                 1350
*      2 VEDESC3 BIT(1),                                           1350
*      2 * BIT(12);                 /*                       @Y30LB38*/
*                                                                  1350
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR UDUMP MACRO                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1351
*   DCL                                                            1351
*     VEDMPSTG CHAR(17);            /*                       @Y30LB38*/
*                                                                  1351
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE STATIC MODULE ID FOR MESSAGES USED BY         @Y30LB38*/
*   /* COMMON FSR'S                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1352
*   DCL                                                            1352
*     VECMOMSG CHAR(3) CONSTANT('CM0');/*                    @Y30LB38*/
*   DCL                                                            1353
*     MSG0085I PTR(8) CONSTANT(21); /* MSG ENTRY NUMBER      @Y30LB38*/
*   DCL                                                            1354
*     MSG2084I PTR(8) CONSTANT(22); /* MSG ENTRY NUMBER      @Y30LB38*/
*   DCL                                                            1355
*     MSG083E PTR(8) CONSTANT(23);  /* MSG ENTRY NUMBER      @Y30LB38*/
*                                                                  1355
*   /*****************************************************************/
*   /*                                                               */
*   /* VOLEXIT CONSTANTS                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1356
*   DCL                                                            1356
*     VEECBLEN FIXED(31) CONSTANT(4);/* LENGTH OF ECB        @Y30LB38*/
*                                                                  1357
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND INITIALIZE PARAMETER LISTS    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1357
*   VERETADR=REG14;                 /*                       @Y30LB38*/
         LR    VERETADR,REG14                                      1357
*   OLDERID2=NEWERID2;                                             1358
         L     @02,@PC00001                                        1358
         L     @02,GDTTR2(,@02)                                    1358
         MVC   @TS00001(95),NEWERID2(@02)                          1358
         MVC   OLDERID2(95,@02),@TS00001                           1358
*   NEWID2='VESR';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@02),@CC01836                              1359
*   VELIST=''B;                     /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1360
*   VEDDSTRU=ADDR(VELIST);          /*                       @Y30LB38*/
         LA    @02,VELIST                                          1361
         ST    @02,VEDDSTRU                                        1361
*   MCLSTPTR=ADDR(VEMCLIST);        /*                       @Y30LB38*/
         LA    @02,VEMCLIST                                        1362
         ST    @02,MCLSTPTR                                        1362
*   MCRTEPTR=ADDR(VEEXLIST);        /*                       @Y30LB38*/
         LA    MCRTEPTR,VEEXLIST                                   1363
*   VEWTOPTR=ADDR(VEWTOMSG);        /*                       @Y30LB38*/
         LA    @15,VEWTOMSG                                        1364
         ST    @15,VEWTOPTR                                        1364
*   MCLIST=''B;                     /*                       @Y30LB38*/
         XC    MCLIST(48,@02),MCLIST(@02)                          1365
*   MCRTE=''B;                      /*                       @Y30LB38*/
         XC    MCRTE(44,MCRTEPTR),MCRTE(MCRTEPTR)                  1366
*   VECOND='0'X;                    /*                       @Y30LB38*/
*                                                                  1367
         SLR   VECOND,VECOND                                       1367
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MCLIST FOR USSC MACRO                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1368
*   MCRLNGTH=MCRLEN;                /*                       @Y30LB38*/
         LH    @15,MCRLEN                                          1368
         ST    @15,MCRLNGTH(,MCRTEPTR)                             1368
*   MCRTCSN=VECSN1;                 /*                       @Y30LB38*/
         L     @15,@PC00016                                        1369
         MVC   MCRTCSN(12,@02),VECSN1(@15)                         1369
*   MCRTTRAN=ON;                    /*                       @Y30LB38*/
         OI    MCRTTRAN(@02),B'00100000'                           1370
*   IF VERECFLG=ON THEN                                            1371
         L     @02,@PC00016+12                                     1371
         TM    VERECFLG(@02),B'10000000'                           1371
         BNO   @RF01371                                            1371
*     MCRREC=ON;                    /*                       @Y30LB38*/
         OI    MCRREC(MCRTEPTR),B'10000000'                        1372
*   MCRLOC=VEVOLLOC;                /*                       @Y30LB38*/
@RF01371 L     @02,@PC00016+16                                     1373
         MVC   MCRLOC(30,MCRTEPTR),VEVOLLOC(@02)                   1373
*   MCRTVEXT=MCRTEPTR;              /*                       @Y30LB38*/
         L     @02,MCLSTPTR                                        1374
         ST    MCRTEPTR,MCRTVEXT(,@02)                             1374
*   MCRSPLOC=ON;                    /*                       @Y30LB38*/
*                                                                  1375
         OI    MCRSPLOC(MCRTEPTR),B'10000000'                      1375
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE UDUMP OF MOVE VOLUME PARAMETER LIST (MCLIST)     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1376
*   IF GDTDBG=NULLPTR THEN                                         1376
         L     @15,@PC00001                                        1376
         L     @15,GDTDBG(,@15)                                    1376
         LTR   @15,@15                                             1376
         BZ    @RT01376                                            1376
*     ;                                                            1377
*   ELSE                                                           1378
*     DO;                                                          1378
*       DMPINDEX=ADDR(VEDMPSTG);    /*                       @Y30LB38*/
         LA    DMPINDEX,VEDMPSTG                                   1379
*       DMPITMNM='MCLIST';                                         1380
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1380
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1380
         MVC   DMPITMNM(6,DMPINDEX),@CC01838                       1380
*       DMPITMPT=ADDR(MCLSTPTR);                                   1381
         LA    @03,MCLSTPTR                                        1381
         ST    @03,DMPITMPT(,DMPINDEX)                             1381
*       DMPITMLN=LENGTH(MCLIST);                                   1382
         MVC   DMPITMLN(2,DMPINDEX),@CH01146                       1382
*       DMPITMTP='H';                                              1383
         MVI   DMPITMTP(DMPINDEX),C'H'                             1383
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1384
*                                                                  1384
         AL    DMPINDEX,@CF00474                                   1384
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1385
*       DMPTRM=DMPTRMVL;                                           1385
         MVI   DMPTRM(DMPINDEX),X'FF'                              1385
*     END;                          /*                       @Y30LB38*/
*   IF GDTDBG=NULLPTR THEN                                         1387
@RT01376 L     @15,@PC00001                                        1387
         L     @15,GDTDBG(,@15)                                    1387
         LTR   @15,@15                                             1387
         BZ    @RT01387                                            1387
*     ;                                                            1388
*   ELSE                                                           1389
*     CALL IDCDB010(GDTTBL,'VEBM',ADDR(VEDMPSTG));/*         @Y30LB38*/
*                                                                  1389
         L     @15,@PC00001                                        1389
         ST    @15,@AL00001                                        1389
         LA    @14,@CC01839                                        1389
         ST    @14,@AL00001+4                                      1389
         LA    @14,VEDMPSTG                                        1389
         ST    @14,@AFTEMPS+24                                     1389
         LA    @14,@AFTEMPS+24                                     1389
         ST    @14,@AL00001+8                                      1389
         MVI   @AL00001+8,X'80'                                    1389
         L     @15,GDTDBG(,@15)                                    1389
         LA    @01,@AL00001                                        1389
         BALR  @14,@15                                             1389
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO EJECT THE VOLUME                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1390
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,VERESNCD,VEECB,VEMSGPTR);/* 1390
*                                                            @Y30LB38*/
@RT01387 L     @02,@PC00001                                        1390
         ST    @02,@AL00001                                        1390
         LA    @15,MOVE                                            1390
         ST    @15,@AL00001+4                                      1390
         LA    @15,MCLSTPTR                                        1390
         ST    @15,@AL00001+8                                      1390
         LA    @15,VERESNCD                                        1390
         ST    @15,@AL00001+12                                     1390
         LA    @15,VEECB                                           1390
         ST    @15,@AL00001+16                                     1390
         LA    @15,VEMSGPTR                                        1390
         ST    @15,@AL00001+20                                     1390
         MVI   @AL00001+20,X'80'                                   1390
         L     @15,GDTSSC(,@02)                                    1390
         LA    @01,@AL00001                                        1390
         BALR  @14,@15                                             1390
*   RESPECIFY                                                      1391
*     RTNREG RSTD;                                                 1391
*   TESTRC=RTNREG;                                                 1392
         LR    TESTRC,RTNREG                                       1392
*   RESPECIFY                                                      1393
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*                                                                  1393
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO MESSAGE AREA FROM USSC       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1394
*   VEMSGPTR=VEMSGPTR+VEECBLEN;     /*                       @Y30LB38*/
         LA    @02,4                                               1394
         AL    @02,VEMSGPTR                                        1394
         ST    @02,VEMSGPTR                                        1394
*                                                                  1395
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CARTRIDGE WERE SUCCESSFULLY EJECTED; ISSUE THE     @Y30LB38*/
*   /* APPROPRIATE MESSAGE                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1395
*   IF TESTRC=LASTCC00TESTRC=LASTCC12 THEN                        1395
         LTR   TESTRC,TESTRC                                       1395
         BZ    @RT01395                                            1395
         C     TESTRC,@CF00567                                     1395
         BNE   @RF01395                                            1395
@RT01395 DS    0H                                                  1396
*     DO;                           /*                       @Y30LB38*/
*                                                                  1396
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR OCCURRES UPDATING INVENTORY, SET A    @Y30LB38*/
*       /* FLAG ON FOR THE CALLER                            @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1397
*       IF TESTRC=LASTCC12 THEN                                    1397
         C     TESTRC,@CF00567                                     1397
         BNE   @RF01397                                            1397
*         VEVVIERR=ON;              /*                       @Y30LB38*/
*                                                                  1398
         L     @15,@PC00016+8                                      1398
         OI    VEVVIERR(@15),B'10000000'                           1398
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME       */
*       /*                                                   @Y30LB38*/
*       /* TO BE USED IN MESSAGE IDC083E                     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1399
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/*         @Y30LB38*/
*                                                                  1399
@RF01397 L     @15,@PC00001                                        1399
         ST    @15,@AL00001                                        1399
         LA    @14,NAMES                                           1399
         ST    @14,@AL00001+4                                      1399
         LA    @14,VESYSIN                                         1399
         ST    @14,@AFTEMPS+24                                     1399
         LA    @14,@AFTEMPS+24                                     1399
         ST    @14,@AL00001+8                                      1399
         MVI   @AL00001+8,X'80'                                    1399
         L     @15,GDTSFO(,@15)                                    1399
         LA    @01,@AL00001                                        1399
         BALR  @14,@15                                             1399
*       /*************************************************************/
*       /*                                                           */
*       /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS        @Y30LB38*/
*       /* FOR MESSAGE IDC083E                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1400
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/
         L     @15,VEDDSTRU                                        1400
         MVC   DARGSMOD(3,@15),@CC01550                            1400
*       VEDDSTRU->DARGSENT=MSG083E; /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'17'                                 1401
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/
         L     @14,VEMSGPTR                                        1402
         LA    @03,CMCSN1(,@14)                                    1402
         ST    @03,DARGDBP(,@15)                                   1402
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/
         LA    @03,12                                              1403
         STH   @03,DARGILP(,@15)                                   1403
*       VEDDSTRU->DARGRETP=VEWTOPTR;/*                       @Y30LB38*/
         L     @02,VEWTOPTR                                        1404
         ST    @02,DARGRETP(,@15)                                  1404
*       VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*               @Y30LB38*/
*                                                                  1405
         MVC   DARGRETL(2,@15),@CH01399                            1405
*       /*************************************************************/
*       /*                                                           */
*       /* IF BOTH CARTRIDGES WERE EJECTED, SET DARGLIST     @Y30LB38*/
*       /* FOR FIVE INSERTS. IF NOT USE FOUR INSERTS.        @Y30LB38*/
*       /* IF FIVE INSERTS ARE USED, THEY WILL BE CSN1, CSN2,        */
*       /*                                                   @Y30LB38*/
*       /* VOLUME SERIAL NUMBER, JOB NAME AND STEP NAME.     @Y30LB38*/
*       /* IF FOUR INSERTS ARE USED CSN2 WILL BE OMMITTED.   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1406
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/
         CLI   CMNUMCRT(@14),X'F2'                                 1406
         BNE   @RF01406                                            1406
*         DO;                       /*                       @Y30LB38*/
*           VEDDSTRU->DARGCNT='4'X; /*                       @Y30LB38*/
         LA    @02,4                                               1408
         STH   @02,DARGCNT(,@15)                                   1408
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/
         LA    @01,1                                               1409
         STH   @01,DARGINS(,@15)                                   1409
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/
         STH   @03,DARGINL(,@15)                                   1410
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/
         LA    @14,CMCSN2(,@14)                                    1411
         ST    @14,DARGDTM(,@15)                                   1411
*           VEDDSTRU->DARGINS(2)='2'X;/*                     @Y30LB38*/
         LA    @14,2                                               1412
         STH   @14,DARGINS+8(,@15)                                 1412
*           VEDDSTRU->DARGINL(2)=LENGTH(VEVOLUME);/*         @Y30LB38*/
         MVC   DARGINL+8(2,@15),@CH00156                           1413
*           VEDDSTRU->DARGDTM(2)=ADDR(VEVOLUME);/*           @Y30LB38*/
         L     @14,@PC00016+4                                      1414
         ST    @14,DARGDTM+8(,@15)                                 1414
*           VEDDSTRU->DARGINS(3)='3'X;/*                     @Y30LB38*/
         LA    @14,3                                               1415
         STH   @14,DARGINS+16(,@15)                                1415
*           VEDDSTRU->DARGINL(3)=LENGTH(VEJOBNAM);/*         @Y30LB38*/
         LA    @14,8                                               1416
         STH   @14,DARGINL+16(,@15)                                1416
*           VEDDSTRU->DARGDTM(3)=ADDR(VEJOBNAM);/*           @Y30LB38*/
         LA    @03,VEJOBNAM                                        1417
         ST    @03,DARGDTM+16(,@15)                                1417
*           VEDDSTRU->DARGINS(4)='4'X;/*                     @Y30LB38*/
         STH   @02,DARGINS+24(,@15)                                1418
*           VEDDSTRU->DARGINL(4)=LENGTH(VESTEPNM);/*         @Y30LB38*/
         STH   @14,DARGINL+24(,@15)                                1419
*           VEDDSTRU->DARGDTM(4)=ADDR(VESTEPNM);/*           @Y30LB38*/
         LA    @14,VESTEPNM                                        1420
         ST    @14,DARGDTM+24(,@15)                                1420
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       1422
*         DO;                       /*                       @Y30LB38*/
         B     @RC01406                                            1422
@RF01406 DS    0H                                                  1423
*           VEDDSTRU->DARGCNT='3'X; /*                       @Y30LB38*/
         LA    @15,3                                               1423
         L     @14,VEDDSTRU                                        1423
         STH   @15,DARGCNT(,@14)                                   1423
*           VEDDSTRU->DARGINS(1)='2'X;/*                     @Y30LB38*/
         LA    @03,2                                               1424
         STH   @03,DARGINS(,@14)                                   1424
*           VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*         @Y30LB38*/
         MVC   DARGINL(2,@14),@CH00156                             1425
*           VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*           @Y30LB38*/
         L     @03,@PC00016+4                                      1426
         ST    @03,DARGDTM(,@14)                                   1426
*           VEDDSTRU->DARGINS(2)='3'X;/*                     @Y30LB38*/
         STH   @15,DARGINS+8(,@14)                                 1427
*           VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*         @Y30LB38*/
         LA    @15,8                                               1428
         STH   @15,DARGINL+8(,@14)                                 1428
*           VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*           @Y30LB38*/
         LA    @03,VEJOBNAM                                        1429
         ST    @03,DARGDTM+8(,@14)                                 1429
*           VEDDSTRU->DARGINS(3)='4'X;/*                     @Y30LB38*/
         LA    @03,4                                               1430
         STH   @03,DARGINS+16(,@14)                                1430
*           VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*         @Y30LB38*/
         STH   @15,DARGINL+16(,@14)                                1431
*           VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*           @Y30LB38*/
         LA    @15,VESTEPNM                                        1432
         ST    @15,DARGDTM+16(,@14)                                1432
*         END;                      /*                       @Y30LB38*/
*                                                                  1433
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT MACRO TO RETRIEVE MESSAGE IDC0083I   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1434
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/
*                                                                  1434
@RC01406 L     @15,@PC00001                                        1434
         ST    @15,@AL00001                                        1434
         LA    @14,@CF00115                                        1434
         ST    @14,@AL00001+4                                      1434
         LA    @14,VEDDSTRU                                        1434
         ST    @14,@AL00001+8                                      1434
         MVI   @AL00001+8,X'80'                                    1434
         L     @15,GDTPRT(,@15)                                    1434
         LA    @01,@AL00001                                        1434
         BALR  @14,@15                                             1434
*       /*************************************************************/
*       /*                                                           */
*       /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR CODES       */
*       /*                                                   @Y30LB38*/
*       /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE IDC2083E*/
*       /* TO THE SYSTEM OPERATOR.                           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1435
*       VEWTOLEN=LENGTH(VEWTOMSG);  /*                       @Y30LB38*/
         MVC   VEWTOLEN(2),@CH01399                                1435
*       VEROUTCD=''B;               /*                       @Y30LB38*/
         XC    VEROUTCD(2),VEROUTCD                                1436
*       VECD1=ON;                   /*                       @Y30LB38*/
         OI    VECD1,B'10000000'                                   1437
*       VEDESCCD=''B;               /*                       @Y30LB38*/
         XC    VEDESCCD(2),VEDESCCD                                1438
*       VEDESC3=ON;                 /*                       @Y30LB38*/
         OI    VEDESC3,B'00100000'                                 1439
*       CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,VEDESCCD);/*
*                                                            @Y30LB38*/
         L     @15,@PC00001                                        1440
         ST    @15,@AL00001                                        1440
         LA    @14,VEWTOLEN                                        1440
         ST    @14,@AL00001+4                                      1440
         LA    @14,VEWTOPTR                                        1440
         ST    @14,@AL00001+8                                      1440
         LA    @14,VEROUTCD                                        1440
         ST    @14,@AL00001+12                                     1440
         LA    @14,VEDESCCD                                        1440
         ST    @14,@AL00001+16                                     1440
         MVI   @AL00001+16,X'80'                                   1440
         L     @15,GDTWTO(,@15)                                    1440
         LA    @01,@AL00001                                        1440
         BALR  @14,@15                                             1440
*                                                                  1441
*       /*************************************************************/
*       /*                                                           */
*       /* TEST IF BOTH SERIAL NUMBERS WERE SPECIFIED? IF    @Y30LB38*/
*       /* YES, PUT BOTH CSN'S IN MESSAGE IDC0085I AND PRINT THE     */
*       /* MESSAGE. IF NO, USE ONLY THE FIRST CSN.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1441
*       VELIST=''B;                 /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1441
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/
         L     @15,VEDDSTRU                                        1442
         MVC   DARGSMOD(3,@15),@CC01550                            1442
*       VEDDSTRU->DARGSENT=MSG0085I;/*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'15'                                 1443
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/
         L     @14,VEMSGPTR                                        1444
         LA    @03,CMCSN1(,@14)                                    1444
         ST    @03,DARGDBP(,@15)                                   1444
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/
         LA    @03,12                                              1445
         STH   @03,DARGILP(,@15)                                   1445
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/
         CLI   CMNUMCRT(@14),X'F2'                                 1446
         BNE   @RF01446                                            1446
*         DO;                       /*                       @Y30LB38*/
*           VEDDSTRU->DARGCNT='1'X; /*                       @Y30LB38*/
         LA    @02,1                                               1448
         STH   @02,DARGCNT(,@15)                                   1448
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/
         STH   @02,DARGINS(,@15)                                   1449
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/
         STH   @03,DARGINL(,@15)                                   1450
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/
         LA    @14,CMCSN2(,@14)                                    1451
         ST    @14,DARGDTM(,@15)                                   1451
*         END;                      /*                       @Y30LB38*/
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/
*                                                                  1453
@RF01446 L     @15,@PC00001                                        1453
         ST    @15,@AL00001                                        1453
         LA    @14,@CF00115                                        1453
         ST    @14,@AL00001+4                                      1453
         LA    @14,VEDDSTRU                                        1453
         ST    @14,@AL00001+8                                      1453
         MVI   @AL00001+8,X'80'                                    1453
         L     @15,GDTPRT(,@15)                                    1453
         LA    @01,@AL00001                                        1453
         BALR  @14,@15                                             1453
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UFSPACE MACRO TO FREE MESSAGE AREA SPACE    @Y30LB38*/
*       /* FROM THE USSC MACRO                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1454
*       VEMSGPTR=VEMSGPTR-VEECBLEN; /*                       @Y30LB38*/
         L     @15,VEMSGPTR                                        1454
         SL    @15,@CF00042                                        1454
         ST    @15,VEMSGPTR                                        1454
*       CALL IDCSAFS0(GDTTBL,VEMSGPTR);/*                    @Y30LB38*/
         L     @15,@PC00001                                        1455
         ST    @15,@AL00001                                        1455
         LA    @14,VEMSGPTR                                        1455
         ST    @14,@AL00001+4                                      1455
         L     @15,GDTFSP(,@15)                                    1455
         LA    @01,@AL00001                                        1455
         BALR  @14,@15                                             1455
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           1457
*     DO;                           /*                       @Y30LB38*/
*                                                                  1457
         B     @RC01395                                            1457
@RF01395 DS    0H                                                  1458
*       /*************************************************************/
*       /*                                                           */
*       /* THE RETURN CODE FROM THE USSC MACRO WAS NOT 0 OR 12.      */
*       /*                                                   @Y30LB38*/
*       /* A RETURN CODE OF 8 IS CHECKED TO DETERMINE IF USSC COULD  */
*       /* NOT GET STORAGE. IF YES, MESSAGE IDC2084I IS WRITTEN AND  */
*       /* RETURN TO CALLER WITH CONDITION CODE 4.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1458
*       IF TESTRC=LASTCC08 THEN                                    1458
         C     TESTRC,@CF00179                                     1458
         BNE   @RF01458                                            1458
*         DO;                       /*                       @Y30LB38*/
*           VELIST=''B;             /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1460
*           VEDDSTRU->DARGSMOD=VECMOMSG;/*                   @Y30LB38*/
         L     @15,VEDDSTRU                                        1461
         MVC   DARGSMOD(3,@15),@CC01550                            1461
*           VEDDSTRU->DARGSENT=MSG2084I;/*                   @Y30LB38*/
         MVI   DARGSENT(@15),X'16'                                 1462
*           CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*        @Y30LB38*/
         L     @15,@PC00001                                        1463
         ST    @15,@AL00001                                        1463
         LA    @14,@CF00115                                        1463
         ST    @14,@AL00001+4                                      1463
         LA    @14,VEDDSTRU                                        1463
         ST    @14,@AL00001+8                                      1463
         MVI   @AL00001+8,X'80'                                    1463
         L     @15,GDTPRT(,@15)                                    1463
         LA    @01,@AL00001                                        1463
         BALR  @14,@15                                             1463
*           VECOND=LASTCC04;        /*                       @Y30LB38*/
         LA    VECOND,4                                            1464
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       1466
*         DO;                       /*                       @Y30LB38*/
*                                                                  1466
         B     @RC01458                                            1466
@RF01458 DS    0H                                                  1467
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE WAS NOT 8, TEST IF THE REASON      */
*           /*                                               @Y30LB38*/
*           /* CODE WAS '4C'X INDICATING THAT THE FIRST CARTRIDGE WAS*/
*           /* EJECTED BUT THE SECOND WAS NOT. IF YES, ISSUE UPRINT  */
*           /* AND UWTO MACROS TO WRITE MESSAGE IDC083E TO THE SYSTEM*/
*           /* OPERATOR AND ISSUE UPRINT MACRO TO WRITE MESSAGE      */
*           /* IDC0085I TO THE USER.                         @Y30LB38*/
*           /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME   */
*           /*                                               @Y30LB38*/
*           /* TO BE USED IN MESSAGE IDC083E                 @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1467
*           IF VERESNCD='4C'X THEN                                 1467
         CLC   VERESNCD(4),@CF01845                                1467
         BNE   @RF01467                                            1467
*             DO;                   /*                       @Y30LB38*/
*               CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/* @Y30LB38*/
         L     @04,@PC00001                                        1469
         ST    @04,@AL00001                                        1469
         LA    @15,NAMES                                           1469
         ST    @15,@AL00001+4                                      1469
         LA    @15,VESYSIN                                         1469
         ST    @15,@AFTEMPS+24                                     1469
         LA    @15,@AFTEMPS+24                                     1469
         ST    @15,@AL00001+8                                      1469
         MVI   @AL00001+8,X'80'                                    1469
         L     @15,GDTSFO(,@04)                                    1469
         LA    @01,@AL00001                                        1469
         BALR  @14,@15                                             1469
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @04,VEDDSTRU                                        1470
         MVC   DARGSMOD(3,@04),@CC01550                            1470
*               VEDDSTRU->DARGSENT=MSG083E;/*                @Y30LB38*/
         MVI   DARGSENT(@04),X'17'                                 1471
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/
         L     @15,@PC00016                                        1472
         ST    @15,DARGDBP(,@04)                                   1472
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/
         MVC   DARGILP(2,@04),@CH00567                             1473
*               VEDDSTRU->DARGRETP=VEWTOPTR;/*               @Y30LB38*/
         L     @15,VEWTOPTR                                        1474
         ST    @15,DARGRETP(,@04)                                  1474
*               VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*       @Y30LB38*/
         MVC   DARGRETL(2,@04),@CH01399                            1475
*               VEDDSTRU->DARGCNT='3'X;/*                    @Y30LB38*/
         LA    @15,3                                               1476
         STH   @15,DARGCNT(,@04)                                   1476
*               VEDDSTRU->DARGINS(1)='2'X;/*                 @Y30LB38*/
         LA    @14,2                                               1477
         STH   @14,DARGINS(,@04)                                   1477
*               VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*     @Y30LB38*/
         MVC   DARGINL(2,@04),@CH00156                             1478
*               VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*       @Y30LB38*/
         L     @14,@PC00016+4                                      1479
         ST    @14,DARGDTM(,@04)                                   1479
*               VEDDSTRU->DARGINS(2)='3'X;/*                 @Y30LB38*/
         STH   @15,DARGINS+8(,@04)                                 1480
*               VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*     @Y30LB38*/
         LA    @15,8                                               1481
         STH   @15,DARGINL+8(,@04)                                 1481
*               VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*       @Y30LB38*/
         LA    @14,VEJOBNAM                                        1482
         ST    @14,DARGDTM+8(,@04)                                 1482
*               VEDDSTRU->DARGINS(3)='4'X;/*                 @Y30LB38*/
         LA    @14,4                                               1483
         STH   @14,DARGINS+16(,@04)                                1483
*               VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*     @Y30LB38*/
         STH   @15,DARGINL+16(,@04)                                1484
*               VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*       @Y30LB38*/
         LA    @15,VESTEPNM                                        1485
         ST    @15,DARGDTM+16(,@04)                                1485
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
*                                                                  1486
         L     @04,@PC00001                                        1486
         ST    @04,@AL00001                                        1486
         LA    @15,@CF00115                                        1486
         ST    @15,@AL00001+4                                      1486
         LA    @15,VEDDSTRU                                        1486
         ST    @15,@AL00001+8                                      1486
         MVI   @AL00001+8,X'80'                                    1486
         L     @15,GDTPRT(,@04)                                    1486
         LA    @01,@AL00001                                        1486
         BALR  @14,@15                                             1486
*               /*****************************************************/
*               /*                                                   */
*               /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR     */
*               /* CODES                                     @Y30LB38*/
*               /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE */
*               /* IDC083E TO THE SYSTEM OPERATOR.           @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1487
*               VEWTOLEN=LENGTH(VEWTOMSG);/*                 @Y30LB38*/
         MVC   VEWTOLEN(2),@CH01399                                1487
*               VEROUTCD=''B;       /*                       @Y30LB38*/
         XC    VEROUTCD(2),VEROUTCD                                1488
*               VECD1=ON;           /*                       @Y30LB38*/
         OI    VECD1,B'10000000'                                   1489
*               VEDESCCD=''B;       /*                       @Y30LB38*/
         XC    VEDESCCD(2),VEDESCCD                                1490
*               VEDESC3=ON;         /*                       @Y30LB38*/
         OI    VEDESC3,B'00100000'                                 1491
*               CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,   1492
*                   VEDESCCD);      /*                       @Y30LB38*/
*                                                                  1492
         L     @04,@PC00001                                        1492
         ST    @04,@AL00001                                        1492
         LA    @15,VEWTOLEN                                        1492
         ST    @15,@AL00001+4                                      1492
         LA    @15,VEWTOPTR                                        1492
         ST    @15,@AL00001+8                                      1492
         LA    @15,VEROUTCD                                        1492
         ST    @15,@AL00001+12                                     1492
         LA    @15,VEDESCCD                                        1492
         ST    @15,@AL00001+16                                     1492
         MVI   @AL00001+16,X'80'                                   1492
         L     @15,GDTWTO(,@04)                                    1492
         LA    @01,@AL00001                                        1492
         BALR  @14,@15                                             1492
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE UPRINT MACRO TO PRINT MESSAGE IDC0085I      */
*               /*                                           @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1493
*               VELIST=''B;         /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1493
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @04,VEDDSTRU                                        1494
         MVC   DARGSMOD(3,@04),@CC01550                            1494
*               VEDDSTRU->DARGSENT=MSG0085I;/*               @Y30LB38*/
         MVI   DARGSENT(@04),X'15'                                 1495
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/
         L     @15,@PC00016                                        1496
         ST    @15,DARGDBP(,@04)                                   1496
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/
         MVC   DARGILP(2,@04),@CH00567                             1497
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
*                                                                  1498
         L     @04,@PC00001                                        1498
         ST    @04,@AL00001                                        1498
         LA    @15,@CF00115                                        1498
         ST    @15,@AL00001+4                                      1498
         LA    @15,VEDDSTRU                                        1498
         ST    @15,@AL00001+8                                      1498
         MVI   @AL00001+8,X'80'                                    1498
         L     @15,GDTPRT(,@04)                                    1498
         LA    @01,@AL00001                                        1498
         BALR  @14,@15                                             1498
*               /*****************************************************/
*               /*                                                   */
*               /* THE SSCMSG ROUTINE IS CALLED TO WRITE THE MSS     */
*               /*                                           @Y30LB38*/
*               /* MESSAGE EXPLAINING THE SECOND CARTRIDGE WAS NOT   */
*               /* EJECTED.                                  @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1499
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/
         LA    @04,VERESNCD                                        1499
         ST    @04,@AL00001                                        1499
         LA    @01,@AL00001                                        1499
         BAL   @14,SSCMSG                                          1499
*               VECOND=LASTCC08;    /*                       @Y30LB38*/
         LA    VECOND,8                                            1500
*             END;                  /*                       @Y30LB38*/
*           ELSE                                                   1502
*             DO;                   /*                       @Y30LB38*/
*                                                                  1502
         B     @RC01467                                            1502
@RF01467 DS    0H                                                  1503
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN CODE FROM USSC IS 4 INDICATING THAT        */
*               /*                                           @Y30LB38*/
*               /* THE CARTRIDGES WERE NOT EJECTED. THE SSCMSG       */
*               /* ROUTINE IS CALLED TO WRITE THE MSS MESSAGE        */
*               /* EXPLAINING THE ERROR. MESSAGE IDC2048I IS WRITTEN */
*               /* TO THE USER WITH THE UPRINT MACRO.        @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1503
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/
         LA    @04,VERESNCD                                        1503
         ST    @04,@AL00001                                        1503
         LA    @01,@AL00001                                        1503
         BAL   @14,SSCMSG                                          1503
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @15,VEDDSTRU                                        1504
         MVC   DARGSMOD(3,@15),@CC01550                            1504
*               VEDDSTRU->DARGSENT=MSG2084I;/*               @Y30LB38*/
         MVI   DARGSENT(@15),X'16'                                 1505
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
         L     @15,@PC00001                                        1506
         ST    @15,@AL00001                                        1506
         LA    @14,@CF00115                                        1506
         ST    @14,@AL00001+4                                      1506
         LA    @14,VEDDSTRU                                        1506
         ST    @14,@AL00001+8                                      1506
         MVI   @AL00001+8,X'80'                                    1506
         L     @15,GDTPRT(,@15)                                    1506
         LA    @01,@AL00001                                        1506
         BALR  @14,@15                                             1506
*               VECOND=LASTCC04;    /*                       @Y30LB38*/
         LA    VECOND,4                                            1507
*             END;                  /*                       @Y30LB38*/
*         END;                      /*                       @Y30LB38*/
@RC01467 DS    0H                                                  1510
*     END;                          /*                       @Y30LB38*/
*                                                                  1510
@RC01458 DS    0H                                                  1511
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1511
*   REG14=VERETADR;                 /*                       @Y30LB38*/
@RC01395 LR    REG14,VERETADR                                      1511
*   RETURN CODE(VECOND);            /*                       @Y30LB38*/
         LR    @15,VECOND                                          1512
@EL00016 DS    0H                                                  1512
@EF00016 DS    0H                                                  1512
@ER00016 BR    @14                                                 1512
*   END VOLEXIT;                    /*                       @Y30LB38*/
*                                                                  1514
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/
*   /* OUTPUT SSC MESSAGES.                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1514
*                                   /*                       @Y30LB39*/
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1514
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1514
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00017                                    1514
         MVC   @PC00017(8),0(@01)                                  1514
*                                   /*                       @Y30LB39*/
*                                                                  1515
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1515
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1515
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1515
*                                   /*                       @Y30LB39*/
*   DCL                                                            1515
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1516
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1516
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1517
*                                   /*                       @Y30LB39*/
*   DCL                                                            1517
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1518
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1518
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1519
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1519
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1519
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1520
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1520
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1520
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1521
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1521
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1521
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1522
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1522
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1522
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1523
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1523
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1524
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1524
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1524
         L     @09,@PC00001                                        1524
         L     @15,GDTTR2(,@09)                                    1524
         MVC   @TS00001(95),NEWERID2(@15)                          1524
         MVC   OLDERID2(95,@15),@TS00001                           1524
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1525
         MVC   NEWID2(4,@15),@CC01866                              1525
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1526
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1526
         LA    @15,SSDRGLT                                         1526
         ST    @15,SSDLPTR                                         1526
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1527
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1527
         L     @14,@PC00017                                        1527
         L     @14,SSRCODE(,@14)                                   1527
         LTR   @14,@14                                             1527
         BNP   @RF01527                                            1527
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1528
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1529
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1529
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1530
         ST    @03,DARGRETP(,@15)                                  1530
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),SSMODSS0                            1531
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 1532
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1533
         MVC   DARGRETL(2,@15),@CH01912                            1533
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1534
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1534
         ST    @09,@AL00001                                        1534
         LA    @03,@CF00115                                        1534
         ST    @03,@AL00001+4                                      1534
         LA    @03,SSDLPTR                                         1534
         ST    @03,@AL00001+8                                      1534
         MVI   @AL00001+8,X'80'                                    1534
         L     @15,GDTPRT(,@09)                                    1534
         LA    @01,@AL00001                                        1534
         BALR  @14,@15                                             1534
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1535
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1535
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)SSARRAY(ENTRYNUM)=0);   1536
@DL01536 DS    0H                                                  1537
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00219                                   1537
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1538
@DE01536 L     @09,@PC00017                                        1538
         LR    @03,ENTRYNUM                                        1538
         ALR   @03,@03                                             1538
         LH    @03,SSARRAY-2(@03)                                  1538
         CH    @03,SSRHALF(,@09)                                   1538
         BE    @DC01536                                            1538
         SLR   @15,@15                                             1538
         CR    @03,@15                                             1538
         BNE   @DL01536                                            1538
@DC01536 DS    0H                                                  1539
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1539
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1539
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @14,SSDLPTR                                         1540
         MVC   DARGSMOD(3,@14),SSMODSS0                            1540
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@14)                             1541
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @03,@15                                             1542
         BNE   @RF01542                                            1542
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @09,DARGDBP(,@14)                                   1544
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@14),@CH00042                             1545
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1548
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1548
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01527                                            1548
@RF01527 DS    0H                                                  1549
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1549
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @09,SSDLPTR                                         1550
         MVC   DARGSMOD(3,@09),SSMODCM0                            1550
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@09),SSMSGNUM                            1551
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @15,@PC00017+4                                      1552
         ST    @15,DARGDBP(,@09)                                   1552
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00219                             1553
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1554
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1555
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1555
@RC01527 L     @09,@PC00001                                        1555
         ST    @09,@AL00001                                        1555
         LA    @15,@CF00115                                        1555
         ST    @15,@AL00001+4                                      1555
         LA    @15,SSDLPTR                                         1555
         ST    @15,@AL00001+8                                      1555
         MVI   @AL00001+8,X'80'                                    1555
         L     @15,GDTPRT(,@09)                                    1555
         LA    @01,@AL00001                                        1555
         BALR  @14,@15                                             1555
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1556
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1556
         L     @14,@SA00017                                        1556
         LM    @00,@12,@SA00017+8                                  1556
         BR    @14                                                 1556
*   END SSCMSG;                     /*                       @Y30LB39*/
*                                                                  1558
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/
*   /* SCRATCH A COPY VOLUME.                                @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1558
*                                   /*                       @Y30LB39*/
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - SCRCOPY                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE PRINCIPLE FUNCTION OF THIS ROUTINE IS TO  @Y30LB11*/
*/*            SCRATCH AN MSS COPY VOLUME.                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0088I CARTRIDGES CSN (CSN) SCRATCHED FOR   @Y30LB11*/
*/*            COPY YYDDD.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0098I ** LOCATION OF VOLUME: (LOCATION)    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2076I ** CART CSN (CSN) NOT IN MSF FOR     @Y30LB11*/
*/*            COPY YYDDD.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2087I ** CART CSN (CSN) NOT SCRATCHED FOR  @Y30LB11*/
*/*            COPY YYDDD.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - A PARAMETER CONSISTING OF A SINGLE BYTE.  THE    @Y30LB11*/
*/*         FIRST BIT OF THE BYTE IS SET TO '1' BY SCRCOPY   @Y30LB11*/
*/*         AN ERROR OCCURS UPDATING THE INVENTORY.          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*         THE COPY RECORD MUST HAVE BEEN READ AND THE      @Y30LB11*/
*/*         COPYV MAPPING MACRO BASED ON THE RECORD PRIOR TO @Y30LB11*/
*/*         THE CALL TO SCRCOPY.   FURTHER, THE DEFLIST      @Y30LB11*/
*/*         MUST HAVE BEEN INCLUDED PRIOR TO THE CALL TO     @Y30LB11*/
*/*         SCRCOPY.                                         @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - FIRST BIT OF INPUT BYTE SET IF INVENTORY ERROR. @Y30LB11*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - CARTRIDGE OR CARTRIDGES FOR COPY VOLUME     @Y30LB11*/
*/*              SCRATCHED SUCCESSFULLY.                     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - CARTRIDGES NOT IN LIBRARY, OR DSM FAILURE   @Y30LB11*/
*/*              OCCURRED.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          8 - USSC UMACRO COULD NOT OBTAIN STORAGE        @Y30LB11*/
*/*              FOR ECB/MESSAGE AREA.                       @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  1558
*SCRCOPY:                           /*                       @Y30LB11*/
*   PROCEDURE(SCINPUT);             /*                       @Y30LB11*/
SCRCOPY  STM   @14,@12,@SA00018                                    1558
         MVC   @PC00018(4),0(@01)                                  1558
*   DCL                                                            1559
*     SCCMPTR PTR(31);              /* PTR TO ECB/MSG AREA   @Y30LB11*/
*   DCL                                                            1560
*     SCECBCD FIXED(8);             /* SCRCOPY ECB CODE      @Y30LB11*/
*   DCL                                                            1561
*     SCRCOND FIXED(15);            /* SCRCOPY COND CODE     @Y30LB11*/
*   DCL                                                            1562
*     SCMSGCD PTR(31);              /* SSCMSG REASON CODE    @Y30LB11*/
*   DCL                                                            1563
*     SCMSGPTR PTR(31);             /* MESSAGE AREA POINTER  @Y30LB11*/
*   DCL                                                            1564
*     SCDEFLST CHAR(LENGTH(DEFLIST));/* SCRCOPY DEFLIST      @Y30LB11*/
*   DCL                                                            1565
*     SCDEFPTR PTR(31);             /* DEFLIST POINTER       @Y30LB11*/
*   DCL                                                            1566
*     SCDDSTRU PTR(31);             /* DARGLIST POINTER      @Y30LB11*/
*                                                                  1566
*   /*****************************************************************/
*   /*                                                               */
*   /* DARGLIST WITH UP TO 3 INSERTS                         @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1567
*   DCL                                                            1567
*     SCDARG CHAR(LENGTH(DARGLIST)+2*(LENGTH(DARGARY)));/*   @Y30LB11*/
*   DCL                                                            1568
*     1 SCINPUT BIT(8),             /* PARAMETER LIST        @Y30LB11*/
*      2 SCERRFLG BIT(1),           /* RETURNED FLAG         @Y30LB11*/
*      2 * BIT(7);                  /* UNUSED                @Y30LB11*/
*                                                                  1568
*   /*****************************************************************/
*   /*                                                               */
*   /* CONSTANT SECTION DECLARATIONS FOR SCRCOPY             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1569
*   DCL                                                            1569
*     1 SCBLANKS CHAR(30) STATIC LOCAL,/* BLANK FIELD        @Y30LB11*/
*      2 *(30) CHAR(1) INIT((30)'40'X);/*                    @Y30LB11*/
*   DCL                                                            1570
*     SCCSN2# FIXED(15) CONSTANT(1);/* CSN2 INSERT           @Y30LB11*/
*   DCL                                                            1571
*     SCDATE# FIXED(15) CONSTANT(2);/* DATE INSERT           @Y30LB11*/
*   DCL                                                            1572
*     SCECBLEN FIXED(15) CONSTANT(4);/* ECB LENGTH           @Y30LB11*/
*   DCL                                                            1573
*     SCNOCSNS BIT(8) CONSTANT('23'X);/* NEITHER CSN FOUND   @Y30LB11*/
*   DCL                                                            1574
*     SCNOCSN1 BIT(8) CONSTANT('26'X);/* CSN1 NOT FOUND      @Y30LB11*/
*   DCL                                                            1575
*     SCNOCSN2 BIT(8) CONSTANT('2A'X);/* CSN2 NOT FOUND      @Y30LB11*/
*   DCL                                                            1576
*     SCCOMMSG CHAR(3) CONSTANT('CM0');/* STATIC TEST MOD    @Y30LB11*/
*   DCL                                                            1577
*     SCM0088I PTR(8) CONSTANT(18); /* CARTS SCRATCHED       @Y30LB11*/
*   DCL                                                            1578
*     SCM0098I PTR(8) CONSTANT(2);  /* LOCATION OF VOLUME    @Y30LB11*/
*   DCL                                                            1579
*     SCM2076I PTR(8) CONSTANT(30); /* CART NOT SCRATCHED    @Y30LB11*/
*   DCL                                                            1580
*     SCM2087I PTR(8) CONSTANT(19); /* CARTS NOT IN LIBRARY  @Y30LB11*/
*                                                                  1581
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO SCRCOPY PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1581
*   OLDERID2=NEWERID2;                                             1581
         L     @09,@PC00001                                        1581
         L     @15,GDTTR2(,@09)                                    1581
         MVC   @TS00001(95),NEWERID2(@15)                          1581
         MVC   OLDERID2(95,@15),@TS00001                           1581
*   NEWID2='SCSC';                  /*                       @Y30LB11*/
*                                                                  1582
         MVC   NEWID2(4,@15),@CC01902                              1582
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION CONSISTS OF ZEROING THE RETURN CODE, ZEROING   */
*   /* THE DEFLIST, AND THE PRINT ARGUMENT LIST.             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1583
*   SCRCOND=0;                      /*                       @Y30LB11*/
         SLR   @15,@15                                             1583
         LR    SCRCOND,@15                                         1583
*   SCDDSTRU=ADDR(SCDARG);          /*                       @Y30LB11*/
         LA    @14,SCDARG                                          1584
         ST    @14,SCDDSTRU                                        1584
*   SCDEFPTR=ADDR(SCDEFLST);        /*                       @Y30LB11*/
         LA    @07,SCDEFLST                                        1585
         ST    @07,SCDEFPTR                                        1585
*   SCDEFLST=''B;                   /*                       @Y30LB11*/
         XC    SCDEFLST(132),SCDEFLST                              1586
*   SCDARG=''B;                     /*                       @Y30LB11*/
         XC    SCDARG(36),SCDARG                                   1587
*   SCDDSTRU->DARGSMOD=SCCOMMSG;    /* COMMON MESSAGE MODULE @Y30LB11*/
*                                                                  1588
         MVC   DARGSMOD(3,@14),@CC01550                            1588
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE AN INACTIVE VOLUME IS TO BE SCRATCHED AND PICK UP THE*/
*   /* CSN1 FROM THE COPY RECORD.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1589
*   SCDEFPTR->DEFVELTR=ON;          /*                       @Y30LB11*/
         OI    DEFVELTR(@07),B'00001000'                           1589
*   SCDEFPTR->DEFVCSN1=COPCSN1;     /*                       @Y30LB11*/
*                                                                  1590
         MVC   DEFVCSN1(12,@07),COPCSN1(COPYVPTR)                  1590
*   /*****************************************************************/
*   /*                                                               */
*   /* FULL REGION DUMP BEFORE EXECUTING THE ICBDEFV MACRO.  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1591
*   IF GDTDBG=NULLPTR THEN                                         1591
         C     @15,GDTDBG(,@09)                                    1591
         BE    @RT01591                                            1591
*     ;                                                            1592
*   ELSE                                                           1593
*     CALL IDCDB010(GDTTBL,'SCDF'); /*                       @Y30LB11*/
*                                                                  1593
         L     @09,@PC00001                                        1593
         ST    @09,@AL00001                                        1593
         LA    @15,@CC01903                                        1593
         ST    @15,@AL00001+4                                      1593
         MVI   @AL00001+4,X'80'                                    1593
         L     @15,GDTDBG(,@09)                                    1593
         LA    @01,@AL00001                                        1593
         BALR  @14,@15                                             1593
*   /*****************************************************************/
*   /*                                                               */
*   /* THE USSC MACRO IS ISSUED TO EXECUTE THE ICBDEFV MACRO @Y30LB11*/
*   /* TO SCRATCH THE COPY.                                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1594
*   CALL IDCSASS0(GDTTBL,DEFINE,SCDEFPTR,SCMSGCD,SCECBCD,SCMSGPTR);/*
*                                                            @Y30LB11*/
@RT01591 L     @09,@PC00001                                        1594
         ST    @09,@AL00001                                        1594
         LA    @02,DEFINE                                          1594
         ST    @02,@AL00001+4                                      1594
         LA    @02,SCDEFPTR                                        1594
         ST    @02,@AL00001+8                                      1594
         LA    @02,SCMSGCD                                         1594
         ST    @02,@AL00001+12                                     1594
         LA    @02,SCECBCD                                         1594
         ST    @02,@AL00001+16                                     1594
         LA    @02,SCMSGPTR                                        1594
         ST    @02,@AL00001+20                                     1594
         MVI   @AL00001+20,X'80'                                   1594
         L     @15,GDTSSC(,@09)                                    1594
         LA    @01,@AL00001                                        1594
         BALR  @14,@15                                             1594
*   RESPECIFY                                                      1595
*     RTNREG RSTD;                                                 1595
*   TESTRC=RTNREG;                                                 1596
         LR    TESTRC,RTNREG                                       1596
*   RESPECIFY                                                      1597
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  1598
*   /*****************************************************************/
*   /*                                                               */
*   /* A RETURN CODE OF 0 OR 12 INDICATES THAT THE MACRO WAS EXECUTED*/
*   /* SUCCESSFULLY.                                         @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1598
*   IF TESTRC=0TESTRC=12 THEN      /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       1598
         BZ    @RT01598                                            1598
         C     TESTRC,@CF00567                                     1598
         BNE   @RF01598                                            1598
@RT01598 DS    0H                                                  1599
*     DO;                           /*                       @Y30LB11*/
*                                                                  1599
*       /*************************************************************/
*       /*                                                           */
*       /* IF A RETURN CODE OF 12 IS PASSED, SCERRFLG IS SET ON TO   */
*       /* INDICATE THAT THE INVENTORY RECORD WAS NOT UPDATED.       */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1600
*       IF TESTRC=12 THEN           /*                       @Y30LB11*/
         C     TESTRC,@CF00567                                     1600
         BNE   @RF01600                                            1600
*         SCERRFLG=ON;              /*                       @Y30LB11*/
*                                                                  1601
         L     @09,@PC00018                                        1601
         OI    SCERRFLG(@09),B'10000000'                           1601
*       /*************************************************************/
*       /*                                                           */
*       /* THE MESSAGE: CARTRIDGES CSN (CSN) SCRATCHED FOR COPY      */
*       /* YYDDD, IS ISSUED.                                 @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1602
*       SCCMPTR=SCMSGPTR+SCECBLEN;  /*                       @Y30LB11*/
@RF01600 LA    @09,4                                               1602
         L     SCCMPTR,SCMSGPTR                                    1602
         ALR   SCCMPTR,@09                                         1602
*       SCDDSTRU->DARGSENT=SCM0088I;/*                       @Y30LB11*/
         L     @03,SCDDSTRU                                        1603
         MVI   DARGSENT(@03),X'12'                                 1603
*       SCDDSTRU->DARGDBP=ADDR(SCCMPTR->CMCSN1);/*           @Y30LB11*/
         LA    @15,CMCSN1(,SCCMPTR)                                1604
         ST    @15,DARGDBP(,@03)                                   1604
*       SCDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB11*/
         LA    @15,12                                              1605
         STH   @15,DARGILP(,@03)                                   1605
*       SCDDSTRU->DARGCNT=2;        /*                       @Y30LB11*/
         LA    @14,2                                               1606
         STH   @14,DARGCNT(,@03)                                   1606
*       SCDDSTRU->DARGINS(1)=SCCSN2#;/*                      @Y30LB11*/
         MVC   DARGINS(2,@03),@CH00219                             1607
*       SCDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*               @Y30LB11*/
         STH   @15,DARGINL(,@03)                                   1608
*       SCDDSTRU->DARGDTM(1)=ADDR(SCCMPTR->CMCSN2);/*        @Y30LB11*/
         LA    @15,CMCSN2(,SCCMPTR)                                1609
         ST    @15,DARGDTM(,@03)                                   1609
*       SCDDSTRU->DARGINS(2)=SCDATE#;/*                      @Y30LB11*/
         STH   @14,DARGINS+8(,@03)                                 1610
*       SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*              @Y30LB11*/
         STH   @09,DARGINL+8(,@03)                                 1611
*       SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*                @Y30LB11*/
         LA    @09,COPDATE(,COPYVPTR)                              1612
         ST    @09,DARGDTM+8(,@03)                                 1612
*       CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*            @Y30LB11*/
*                                                                  1613
         L     @09,@PC00001                                        1613
         ST    @09,@AL00001                                        1613
         LA    @15,@CF00115                                        1613
         ST    @15,@AL00001+4                                      1613
         LA    @15,SCDDSTRU                                        1613
         ST    @15,@AL00001+8                                      1613
         MVI   @AL00001+8,X'80'                                    1613
         L     @15,GDTPRT(,@09)                                    1613
         LA    @01,@AL00001                                        1613
         BALR  @14,@15                                             1613
*       /*************************************************************/
*       /*                                                           */
*       /* BECAUSE THE MESSAGE AREA POINTER IS SET, AND THE ICBDEFV  */
*       /* MACRO IS SUCCESSFUL, THE UFSPACE IS ISSUED TO FREE THE    */
*       /* ECB/MESSAGE AREA GOTTEN BY THE ICBDEFV MACRO.     @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1614
*       CALL IDCSAFS0(GDTTBL,SCMSGPTR);/*                    @Y30LB11*/
         L     @09,@PC00001                                        1614
         ST    @09,@AL00001                                        1614
         LA    @15,SCMSGPTR                                        1614
         ST    @15,@AL00001+4                                      1614
         L     @15,GDTFSP(,@09)                                    1614
         LA    @01,@AL00001                                        1614
         BALR  @14,@15                                             1614
*     END;                          /*                       @Y30LB11*/
*                                                                  1616
*   /*****************************************************************/
*   /*                                                               */
*   /* A RETURN CODE OF 4 OR 8 INDICATES THAT THE MACRO WAS NOT      */
*   /* EXECUTED SUCCESSFULLY.                                @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1616
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
*                                                                  1616
         B     @RC01598                                            1616
@RF01598 DS    0H                                                  1617
*       /*************************************************************/
*       /*                                                           */
*       /* A RETURN CODE OF 8 FROM THE ICBDEFV MACRO INDICATES THAT  */
*       /* NO CORE WAS AVAILABLE FOR THE ECB/MESSAGE AREA. THE       */
*       /* MESSAGE: ** CART CSN (CSN) NOT SCRATCHED COPY YYDDD, IS   */
*       /* ISSUED AND THE RETURN CODE IS SET TO 8.           @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1617
*       IF TESTRC=8 THEN            /*                       @Y30LB11*/
         C     TESTRC,@CF00179                                     1617
         BNE   @RF01617                                            1617
*         DO;                       /*                       @Y30LB11*/
*           SCDDSTRU->DARGSENT=SCM2087I;/*                   @Y30LB11*/
         L     @09,SCDDSTRU                                        1619
         MVI   DARGSENT(@09),X'13'                                 1619
*           SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*               @Y30LB11*/
         LA    @15,COPCSN1(,COPYVPTR)                              1620
         ST    @15,DARGDBP(,@09)                                   1620
*           SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*             @Y30LB11*/
         LA    @15,12                                              1621
         STH   @15,DARGILP(,@09)                                   1621
*           SCDDSTRU->DARGCNT=2;    /*                       @Y30LB11*/
         LA    @14,2                                               1622
         STH   @14,DARGCNT(,@09)                                   1622
*           SCDDSTRU->DARGINS(1)=SCCSN2#;/*                  @Y30LB11*/
         MVC   DARGINS(2,@09),@CH00219                             1623
*           SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*          @Y30LB11*/
         STH   @15,DARGINL(,@09)                                   1624
*           SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*            @Y30LB11*/
         LA    @15,COPCSN2(,COPYVPTR)                              1625
         ST    @15,DARGDTM(,@09)                                   1625
*           SCDDSTRU->DARGINS(2)=SCDATE#;/*                  @Y30LB11*/
         STH   @14,DARGINS+8(,@09)                                 1626
*           SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*          @Y30LB11*/
         MVC   DARGINL+8(2,@09),@CH00042                           1627
*           SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*            @Y30LB11*/
         LA    @15,COPDATE(,COPYVPTR)                              1628
         ST    @15,DARGDTM+8(,@09)                                 1628
*           CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*        @Y30LB11*/
*                                                                  1629
         L     @09,@PC00001                                        1629
         ST    @09,@AL00001                                        1629
         LA    @15,@CF00115                                        1629
         ST    @15,@AL00001+4                                      1629
         LA    @15,SCDDSTRU                                        1629
         ST    @15,@AL00001+8                                      1629
         MVI   @AL00001+8,X'80'                                    1629
         L     @15,GDTPRT(,@09)                                    1629
         LA    @01,@AL00001                                        1629
         BALR  @14,@15                                             1629
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE RETURN CODE TO 8 INDICATING THAT THE USSC     */
*           /* UMACRO COULD NOT OBTAIN STORAGE FOR THE ECB/MESSAGE   */
*           /* AREA.                                         @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1630
*           SCRCOND=8;              /*                       @Y30LB11*/
         LA    SCRCOND,8                                           1630
*         END;                      /*                       @Y30LB11*/
*                                                                  1631
*       /*************************************************************/
*       /*                                                           */
*       /* A RETURN CODE OF 4 INDICATES THAT THE ICBDEFV MACRO WAS   */
*       /* EXECUTED, BUT FAILED.                             @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1632
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
*                                                                  1632
         B     @RC01617                                            1632
@RF01617 DS    0H                                                  1633
*           /*********************************************************/
*           /*                                                       */
*           /* THE SSCMSG ROUTINE IS CALLED TO PRINT COMMON MESSAGES */
*           /* FROM IDCTSSS0 AND IDCTSSS1 AS DIRECTED BY THE REASON  */
*           /* CODE PASSED BACK FROM THE ICBDEFV MACRO.      @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1633
*           CALL SSCMSG(SCMSGCD);   /*                       @Y30LB11*/
*                                                                  1633
         LA    @09,SCMSGCD                                         1633
         ST    @09,@AL00001                                        1633
         LA    @01,@AL00001                                        1633
         BAL   @14,SSCMSG                                          1633
*           /*********************************************************/
*           /*                                                       */
*           /* IF EITHER OR BOTH CARTRIDGES ARE NOT IN THE MSF A     */
*           /* MESSAGE INDICATING THAT SITUATION IS PRINTED. @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1634
*           IF SCMSGCD=SCNOCSN1    /*                       @Y30LB11*/
*               SCMSGCD=SCNOCSN2   /*                       @Y30LB11*/
*               SCMSGCD=SCNOCSNS THEN/*                      @Y30LB11*/
         L     @09,SCMSGCD                                         1634
         C     @09,@CF01892                                        1634
         BE    @RT01634                                            1634
         C     @09,@CF01894                                        1634
         BE    @RT01634                                            1634
         C     @09,@CF01890                                        1634
         BNE   @RF01634                                            1634
@RT01634 DS    0H                                                  1635
*             DO;                   /*                       @Y30LB11*/
*                                                                  1635
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP TO ISSUE MESSAGE THAT CARTS ARE OUT OF THE */
*               /* MSF.                                      @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1636
*               SCDDSTRU->DARGSENT=SCM2076I;/*               @Y30LB11*/
*                                                                  1636
         L     @09,SCDDSTRU                                        1636
         MVI   DARGSENT(@09),X'1E'                                 1636
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT COPYDATE FROM COPY RECORD          @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1637
*               SCDDSTRU->DARGINS(1)=SCDATE#;/*              @Y30LB11*/
         LA    @04,2                                               1637
         STH   @04,DARGINS(,@09)                                   1637
*               SCDDSTRU->DARGINL(1)=LENGTH(COPDATE);/*      @Y30LB11*/
         MVC   DARGINL(2,@09),@CH00042                             1638
*               SCDDSTRU->DARGDTM(1)=ADDR(COPDATE);/*        @Y30LB11*/
*                                                                  1639
         LA    @15,COPDATE(,COPYVPTR)                              1639
         ST    @15,DARGDTM(,@09)                                   1639
*               /*****************************************************/
*               /*                                                   */
*               /* IF 2 CARTS OUT OF LIBRARY, INSERT 2 CSNS  @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1640
*               IF SCMSGCD=SCNOCSNS THEN                           1640
         CLC   SCMSGCD(4),@CF01890                                 1640
         BNE   @RF01640                                            1640
*                 DO;               /*                       @Y30LB11*/
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/
         LA    @15,COPCSN1(,COPYVPTR)                              1642
         ST    @15,DARGDBP(,@09)                                   1642
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/
         LA    @15,12                                              1643
         STH   @15,DARGILP(,@09)                                   1643
*                   SCDDSTRU->DARGCNT=2;/*                   @Y30LB11*/
         STH   @04,DARGCNT(,@09)                                   1644
*                   SCDDSTRU->DARGINS(2)=SCCSN2#;/*          @Y30LB11*/
         MVC   DARGINS+8(2,@09),@CH00219                           1645
*                   SCDDSTRU->DARGINL(2)=LENGTH(COPCSN2);/*  @Y30LB11*/
         STH   @15,DARGINL+8(,@09)                                 1646
*                   SCDDSTRU->DARGDTM(2)=ADDR(COPCSN2);/*    @Y30LB11*/
         LA    @04,COPCSN2(,COPYVPTR)                              1647
         ST    @04,DARGDTM+8(,@09)                                 1647
*                 END;              /*                       @Y30LB11*/
*                                                                  1648
*               /*****************************************************/
*               /*                                                   */
*               /* IF CSN1 OUT OF LIBRARY, INSERT CSN1       @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1649
*               IF SCMSGCD=SCNOCSN1 THEN                           1649
@RF01640 CLC   SCMSGCD(4),@CF01892                                 1649
         BNE   @RF01649                                            1649
*                 DO;               /*                       @Y30LB11*/
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/
         L     @09,SCDDSTRU                                        1651
         LA    @04,COPCSN1(,COPYVPTR)                              1651
         ST    @04,DARGDBP(,@09)                                   1651
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/
         MVC   DARGILP(2,@09),@CH00567                             1652
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/
         MVC   DARGCNT(2,@09),@CH00219                             1653
*                 END;              /*                       @Y30LB11*/
*                                                                  1654
*               /*****************************************************/
*               /*                                                   */
*               /* IF CSN2 OUT OF LIBRARY, INSERT CSN2       @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1655
*               IF SCMSGCD=SCNOCSN2 THEN                           1655
@RF01649 CLC   SCMSGCD(4),@CF01894                                 1655
         BNE   @RF01655                                            1655
*                 DO;               /*                       @Y30LB11*/
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN2);/*       @Y30LB11*/
         L     @09,SCDDSTRU                                        1657
         LA    @04,COPCSN2(,COPYVPTR)                              1657
         ST    @04,DARGDBP(,@09)                                   1657
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN2);/*     @Y30LB11*/
         MVC   DARGILP(2,@09),@CH00567                             1658
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/
         MVC   DARGCNT(2,@09),@CH00219                             1659
*                 END;              /*                       @Y30LB11*/
*                                                                  1660
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE THE UPRINT MACRO TO PRINT THE MESSAGE       */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1661
*                                   /*                       @Y30LB11*/
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/
*                                                                  1661
@RF01655 L     @09,@PC00001                                        1661
         ST    @09,@AL00001                                        1661
         LA    @04,@CF00115                                        1661
         ST    @04,@AL00001+4                                      1661
         LA    @04,SCDDSTRU                                        1661
         ST    @04,@AL00001+8                                      1661
         MVI   @AL00001+8,X'80'                                    1661
         L     @15,GDTPRT(,@09)                                    1661
         LA    @01,@AL00001                                        1661
         BALR  @14,@15                                             1661
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE LOCATION OF THE VOLUME HAS BEEN DETERMINED */
*               /* THE MESSAGE: ** LOCATION OF VOLUME: (LOCATION), IS*/
*               /* ISSUED.                                   @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1662
*               IF COPDEST^=SCBLANKS THEN/*                  @Y30LB11*/
         CLC   COPDEST(30,COPYVPTR),SCBLANKS                       1662
         BE    @RF01662                                            1662
*                 DO;               /*                       @Y30LB11*/
*                   SCDARG=''B;     /*                       @Y30LB11*/
         XC    SCDARG(36),SCDARG                                   1664
*                   SCDDSTRU->DARGSENT=SCM0098I;/*           @Y30LB11*/
         L     @09,SCDDSTRU                                        1665
         MVI   DARGSENT(@09),X'02'                                 1665
*                   SCDDSTRU->DARGSMOD=SCCOMMSG;/*           @Y30LB11*/
         MVC   DARGSMOD(3,@09),@CC01550                            1666
*                   SCDDSTRU->DARGDBP=ADDR(COPDEST);/*       @Y30LB11*/
         LA    @04,COPDEST(,COPYVPTR)                              1667
         ST    @04,DARGDBP(,@09)                                   1667
*                   SCDDSTRU->DARGILP=LENGTH(COPDEST);/*     @Y30LB11*/
         MVC   DARGILP(2,@09),@CH01085                             1668
*                   CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*      1669
*                                                            @Y30LB11*/
         L     @09,@PC00001                                        1669
         ST    @09,@AL00001                                        1669
         LA    @04,@CF00115                                        1669
         ST    @04,@AL00001+4                                      1669
         LA    @04,SCDDSTRU                                        1669
         ST    @04,@AL00001+8                                      1669
         MVI   @AL00001+8,X'80'                                    1669
         L     @15,GDTPRT(,@09)                                    1669
         LA    @01,@AL00001                                        1669
         BALR  @14,@15                                             1669
*                 END;              /*                       @Y30LB11*/
*             END;                  /*                       @Y30LB11*/
*                                                                  1671
*           /*********************************************************/
*           /*                                                       */
*           /* A RETURN CODE OF 4 FROM THE ICBDEFV MACRO INDICATES   */
*           /* THAT THE ICBDEFV MACRO FAILED. A MESSAGE INDICATING   */
*           /* THAT COPY VOLUMES WERE NOT SCRATCHED, IS PRINTED.     */
*           /*                                               @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1672
*           ELSE                                                   1672
*             DO;                   /*                       @Y30LB11*/
         B     @RC01634                                            1672
@RF01634 DS    0H                                                  1673
*               SCDDSTRU->DARGSENT=SCM2087I;/*               @Y30LB11*/
         L     @09,SCDDSTRU                                        1673
         MVI   DARGSENT(@09),X'13'                                 1673
*               SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*           @Y30LB11*/
         LA    @04,COPCSN1(,COPYVPTR)                              1674
         ST    @04,DARGDBP(,@09)                                   1674
*               SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*         @Y30LB11*/
         LA    @04,12                                              1675
         STH   @04,DARGILP(,@09)                                   1675
*               SCDDSTRU->DARGCNT=2;/*                       @Y30LB11*/
         LA    @15,2                                               1676
         STH   @15,DARGCNT(,@09)                                   1676
*               SCDDSTRU->DARGINS(1)=SCCSN2#;/*              @Y30LB11*/
         MVC   DARGINS(2,@09),@CH00219                             1677
*               SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*      @Y30LB11*/
         STH   @04,DARGINL(,@09)                                   1678
*               SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*        @Y30LB11*/
         LA    @04,COPCSN2(,COPYVPTR)                              1679
         ST    @04,DARGDTM(,@09)                                   1679
*               SCDDSTRU->DARGINS(2)=SCDATE#;/*              @Y30LB11*/
         STH   @15,DARGINS+8(,@09)                                 1680
*               SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*      @Y30LB11*/
         MVC   DARGINL+8(2,@09),@CH00042                           1681
*               SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*        @Y30LB11*/
         LA    @04,COPDATE(,COPYVPTR)                              1682
         ST    @04,DARGDTM+8(,@09)                                 1682
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/
         L     @09,@PC00001                                        1683
         ST    @09,@AL00001                                        1683
         LA    @04,@CF00115                                        1683
         ST    @04,@AL00001+4                                      1683
         LA    @04,SCDDSTRU                                        1683
         ST    @04,@AL00001+8                                      1683
         MVI   @AL00001+8,X'80'                                    1683
         L     @15,GDTPRT(,@09)                                    1683
         LA    @01,@AL00001                                        1683
         BALR  @14,@15                                             1683
*             END;                  /*                       @Y30LB11*/
*                                                                  1684
*           /*********************************************************/
*           /*                                                       */
*           /* INDICATE THAT SCRCOPY FAILED WITH A RETURN CODE OF 4. */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1685
*                                   /*                       @Y30LB11*/
*           SCRCOND=4;              /*                       @Y30LB11*/
@RC01634 LA    SCRCOND,4                                           1685
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  1687
@RC01617 DS    0H                                                  1688
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO SCRCOPY CALLER                              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1688
*   RETURN CODE(SCRCOND);           /*                       @Y30LB11*/
@RC01598 LR    @15,SCRCOND                                         1688
         L     @14,@SA00018                                        1688
         LM    @00,@12,@SA00018+8                                  1688
         BR    @14                                                 1688
*   END SCRCOPY;                    /*                       @Y30LB11*/
*   END IDCCO01                     /*                       @Y30LB39*/
*                                                                  1690
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSCO )                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF51 )                                       */
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF53 )                                       */
*                                                                  1690
*       ;                                                          1690
@DATA    DS    0H
@CH00153 DC    H'2'
@CH00286 DC    H'5'
@CH00156 DC    H'6'
@CH00444 DC    H'10'
@CH00847 DC    H'29'
@CH01085 DC    H'30'
@CH00044 DC    H'31'
@CH01907 DC    H'37'
@CH01588 DC    H'40'
@CH01908 DC    H'43'
@CH01146 DC    H'48'
@CH01905 DC    H'64'
@CH01399 DC    H'72'
@CH01909 DC    H'88'
@CH01912 DC    H'120'
@CH01906 DC    H'132'
@CH01911 DC    H'164'
@CH01910 DC    H'224'
         DS    0F
@AL00290 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01617)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@PC00015 DS    2F
@PC00016 DS    5F
@SA00017 DS    15F
@PC00017 DS    2F
@SA00018 DS    15F
@PC00018 DS    1F
@AL00001 DS    6A
@AFTEMPS DS    7F
IDCCO01  CSECT
         DS    0F
@CF00115 DC    F'0'
@CF00219 DC    F'1'
@CH00219 EQU   @CF00219+2
@CF00042 DC    F'4'
@CH00042 EQU   @CF00042+2
@CF00179 DC    F'8'
@CF00567 DC    F'12'
@CH00567 EQU   @CF00567+2
@CF00474 DC    F'16'
@CF01914 DC    XL4'0000FFFF'
@CF01845 DC    XL4'4C'
@CF01890 DC    XL4'23'
@CF01892 DC    XL4'26'
@CF01894 DC    XL4'2A'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RVVIPTR  DS    A
MVRPTR   DS    A
DEFVPTR  DS    A
DEFVEPTR DS    A
COVCPTR  DS    A
COVCEPTR DS    A
REASON   DS    F
RETADDR1 DS    A
RETADDR3 DS    A
VEDDSTRU DS    A
MCLSTPTR DS    A
VEMSGPTR DS    A
VEWTOPTR DS    A
VERESNCD DS    F
SSDLPTR  DS    A
SCMSGCD  DS    A
SCMSGPTR DS    A
SCDEFPTR DS    A
SCDDSTRU DS    A
LISTPTR  DS    A
VEWTOLEN DS    H
SETRC    DS    H
ECBBYTE  DS    FL1
TVOLRC   DS    FL1
SCRRC    DS    FL1
OVERFLOW DS    FL1
RVVIRC   DS    FL1
SCECBCD  DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
PRINTTAB DS    CL44
ALLAGLBF DS    CL31
         DS    CL1
CKAGLBUF DS    CL29
         DS    CL3
VS1AGLBF DS    CL74
         DS    CL2
MDAGLBUF DS    CL37
         DS    CL3
DEFVEBUF DS    CL64
COVCEBUF DS    CL43
         DS    CL1
MVRBUFR  DS    CL88
RVVIBUFR DS    CL68
DEFLISTB DS    CL132
COVLISTB DS    CL40
EXCLAGLB DS    CL23
         DS    CL1
BASVOLBD DS    CL224
COPVOLBD DS    CL164
COPYVTBL DS    CL54
         ORG   COPYVTBL
COPYVTBC DS    CL8
CUNITUCB DS    AL4
CUNITDDN DS    CL8
RECTYPE  DS    CL4
CSN1AREA DS    CL12
CSN2AREA DS    CL12
NEWCDATE DS    CL4
COPYFLGS DS    BL2
         ORG   COPYFLGS
REUSEFLG DS    BL1
OBKUPFLG EQU   COPYFLGS+0
ALLOCFLG EQU   COPYFLGS+0
IOERRFLG DS    BL1
@NM00129 EQU   COPYFLGS+1
         ORG   COPYVTBL+54
MINORNAM DS    CL23
         ORG   MINORNAM
RNAMLNTH DS    FL1
RNAMCHAR DS    CL22
         ORG   MINORNAM+23
         DS    CL3
UNITLIST DS    CL9
         ORG   UNITLIST
UNITNUM  DS    FL2
UNITARAY DS    CL7
         ORG   UNITARAY
UNITLNTH DS    FL2
UNITTYPE DS    CL5
         ORG   UNITLIST+9
         DS    CL3
VOLSERLT DS    CL10
         ORG   VOLSERLT
VOLNUMBR DS    FL2
VOLARRAY DS    CL8
         ORG   VOLARRAY
VOLLENTH DS    FL2
VOLSERNM DS    CL6
         ORG   VOLSERLT+10
         DS    CL2
DUMPLIST DS    CL33
SAVEFLG  DS    BL1
DATAVALU DS    CL30
TIMEAREA DS    CL8
CKCSNADJ DS    CL12
CKPRTTAB DS    CL20
VEECB    DS    CL1
VELIST   DS    CL52
VEWTOMSG DS    CL72
VEMCLIST DS    CL48
VEEXLIST DS    CL44
VESYSIN  DS    CL16
         ORG   VESYSIN
VEJOBNAM DS    CL8
VESTEPNM DS    CL8
         ORG   VESYSIN+16
VEROUTCD DS    BL2
         ORG   VEROUTCD
VECD1    DS    BL1
@NM00143 EQU   VEROUTCD+0
         ORG   VEROUTCD+2
VEDESCCD DS    BL2
         ORG   VEDESCCD
@NM00144 DS    BL1
VEDESC3  EQU   VEDESCCD+0
@NM00145 EQU   VEDESCCD+0
         ORG   VEDESCCD+2
VEDMPSTG DS    CL17
SSDRGLT  DS    CL20
         DS    CL2
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
SCDEFLST DS    CL132
SCDARG   DS    CL36
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCCO01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
MVRLEN   DC    AL2(88)
DEFLEN   DC    AL2(64)
COVLEN   DC    AL2(43)
MCRLEN   DC    AL2(44)
ONEZERO  DC    AL1(0)
SSMSGNUM DC    AL1(56)
@CC01615 DC    C'.VIRTUAL.ENQUEUE'
@CC01672 DC    C'.VIRTUAL.RESERVE'
@CC01614 DC    C'COPYVTBL'
@CC01617 DC    C'SYSZAMS '
@CC01657 DC    C'ALLAGLBF'
@CC01660 DC    C'CKAGLBUF'
@CC01667 DC    C'IDCVS01 '
@CC01693 DC    C'DEFLISTB'
@CC01694 DC    C'DEFVEBUF'
@CC01704 DC    C'MDAGLBUF'
@CC01712 DC    C'COVLISTB'
@CC01713 DC    C'COVCEBUF'
@CC01715 DC    C'MVRBUFR'
@CC01838 DC    C'MCLIST'
@CC01656 DC    C'3330V'
@CC01492 DC    C'CO01'
@CC01602 DC    C'COBG'
@CC01624 DC    C'COND'
@CC01629 DC    C'COFV'
@CC01637 DC    C'COTV'
@CC01644 DC    C'CORE'
@CC01650 DC    C'COBK'
@CC01655 DC    C'COFI'
@CC01659 DC    C'COAA'
@CC01661 DC    C'COBB'
@CC01668 DC    C'COVS'
@CC01669 DC    C'COCH'
@CC01670 DC    C'COPT'
@CC01671 DC    C'COII'
@CC01680 DC    C'COWK'
@CC01686 DC    C'COJJ'
@CC01691 DC    C'COCR'
@CC01695 DC    C'COCC'
@CC01703 DC    C'CODM'
@CC01705 DC    C'CODD'
@CC01711 DC    C'COCP'
@CC01714 DC    C'COEE'
@CC01716 DC    C'COFF'
@CC01721 DC    C'COLB'
@CC01722 DC    C'COGG'
@CC01728 DC    C'COSC'
@CC01734 DC    C'CORV'
@CC01735 DC    C'RVVI'
@CC01736 DC    C'CORR'
@CC01755 DC    C'CKLN'
@CC01836 DC    C'VESR'
@CC01839 DC    C'VEBM'
@CC01866 DC    C'SSAA'
@CC01902 DC    C'SCSC'
@CC01903 DC    C'SCDF'
@CC01548 EQU   @CC01492
@CC01550 DC    C'CM0'
@CC01552 DC    C'UV0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODID    DC    CL4'CO01'
FIXAREA  DS    CL512
         ORG   FIXAREA
@NM00130 DC    256X'00'
@NM00131 DC    256X'00'
         ORG   FIXAREA+512
BASECHAR DC    CL4'BASE'
COPYCHAR DC    CL4'COPY'
BKUPCHAR DC    CL4'BKUP'
HEXFF    DC    X'FF'
BLNKAREA DC    CL1' '
THIRTYBK DS    CL30
         ORG   THIRTYBK
@NM00132 DC    30CL1' '
         ORG   THIRTYBK+30
TWLVZERO DS    CL12
         ORG   TWLVZERO
@NM00133 DC    12X'00'
         ORG   TWLVZERO+12
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
SCBLANKS DS    CL30
         ORG   SCBLANKS
@NM00148 DC    30X'40'
         ORG   SCBLANKS+30
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SCRCOND  EQU   @04
SCCMPTR  EQU   @02
ENTRYNUM EQU   @02
VECOND   EQU   @04
VERETADR EQU   @09
MCRTEPTR EQU   @03
CKCOND   EQU   @03
CKSAVPTR EQU   @09
CKRETPTR EQU   @04
LABLRC   EQU   @04
COPYRC   EQU   @04
DMNTRC   EQU   @04
CRVRC    EQU   @04
WORKRC   EQU   @07
VSRC     EQU   @04
FILERC   EQU   @04
OBKUPRC  EQU   @03
REUSERC  EQU   @04
CSN2RC   EQU   @04
CSN1RC   EQU   @07
FVOLRC   EQU   @07
RETADDR2 EQU   @09
COPYVPTR EQU   @05
BASEVPTR EQU   @06
DMPINDEX EQU   @02
TESTRC   EQU   @03
REG8     EQU   @08
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
REG14    EQU   @14
CVOLR1   EQU   @01
DEFVR1   EQU   @01
MCR1     EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSATI0 EQU   0
IDCSAAL0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLVLCNT EQU   ALLAGL+29
ALLUNCNT EQU   ALLAGL+30
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CMNUMCRT EQU   CMMSG+15
CMCSN1   EQU   CMMSG+16
CMCSN2   EQU   CMMSG+28
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDWAIT   EQU   MDFLAGS
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLVOL  EQU   EXCLAGL+16
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSUCBP   EQU   VS1AGL+8
VSVOLP   EQU   VS1AGL+12
VSFILEP  EQU   VS1AGL+16
VSIOP    EQU   VS1AGL+20
VSCATP   EQU   VS1AGL+32
VSCATDDP EQU   VS1AGL+40
VSPSWDP  EQU   VS1AGL+44
VSPFILEP EQU   VS1AGL+48
VSSECOPT EQU   VS1AGL+68
VSMASTER EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSVTOPT  EQU   VS1AGL+69
VSTIME   EQU   VSVTOPT
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSVSAM   EQU   VSRETURN
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
VSRES    EQU   VSRESOPT
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00072 EQU   SV82LIST+4
SV82DCBP EQU   @NM00072
@NM00073 EQU   SV82LIST+12
SV82WRKP EQU   @NM00073
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
VOL      EQU   0
VOLLEN   EQU   VOL
VOLVAL   EQU   VOL+1
BKUP     EQU   0
CART     EQU   0
CSN1     EQU   0
CSN1LEN  EQU   CSN1
CSN1VAL  EQU   CSN1+1
CSN2     EQU   0
CSN2LEN  EQU   CSN2
CSN2VAL  EQU   CSN2+1
DESCR    EQU   0
DESCRVAL EQU   DESCR+1
EJECT    EQU   0
REC      EQU   0
LOC      EQU   0
LOCVAL   EQU   LOC+1
CAT      EQU   0
CATNM    EQU   0
CATNMPLN EQU   CATNM
CATNMPAS EQU   CATNM+1
CATNMFLG EQU   CATNM+10
CATNMVAL EQU   CATNM+21
CATDN    EQU   0
CATDNVAL EQU   CATDN+1
FILE     EQU   0
FILEVAL  EQU   FILE+1
MSF      EQU   0
MSFVAL   EQU   MSF
PFILE    EQU   0
@NM00091 EQU   PFILE+2
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVOBKUP EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVSPEC  EQU   RVVFLAGA+5
RVVSVOL  EQU   RVVSPEC
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVRFLAGA EQU   MVR+8
MVRFLBAS EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRBKUP  EQU   MVRFLAGA+1
MVRCICPY EQU   MVRFLAGA+2
MVRBVOL  EQU   MVR+12
MVRCSN   EQU   MVR+62
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASINAC  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASEXCL  EQU   BASFLAGA+2
BASDAERA EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASNCOPY EQU   BASEV+62
BASNBKUP EQU   BASEV+63
BASBKLMT EQU   BASEV+64
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASOWNER EQU   BASEV+134
COPYV    EQU   0
COPNAME  EQU   COPYV
COPID    EQU   COPNAME+11
COPFLAGA EQU   COPYV+14
COPTYPE  EQU   COPFLAGA
COPRCVYF EQU   COPYV+20
COPSATIA EQU   COPRCVYF
COPMISCF EQU   COPRCVYF+2
COPCSN1  EQU   COPYV+24
COPLIB1  EQU   COPYV+36
COPLID1  EQU   COPLIB1
COPCSN2  EQU   COPYV+37
COPLIB2  EQU   COPYV+49
COPLID2  EQU   COPLIB2
COPDATE  EQU   COPYV+50
COPDEST  EQU   COPYV+88
COPOWNER EQU   COPYV+118
DEFLIST  EQU   0
DEFVFLG  EQU   DEFLIST+6
DEFVCR   EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVRNTR EQU   DEFVFLG
DEFVLIB  EQU   DEFLIST+7
DEFVOLD  EQU   DEFLIST+8
DEFVVFLG EQU   DEFLIST+14
DEFVSEC  EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVNVOL EQU   DEFLIST+16
DEFVCSN1 EQU   DEFLIST+24
DEFVCSN2 EQU   DEFLIST+36
DEFVDATA EQU   DEFLIST+56
DEFOWNID EQU   DEFVDATA+29
DEFTLAB  EQU   DEFVDATA+71
DEFVVEXT EQU   DEFLIST+128
DEFVE    EQU   0
DEFLNGTH EQU   DEFVE
DEFDESCR EQU   DEFVE+12
DEFFLAGA EQU   DEFVE+55
DEFPDESC EQU   DEFFLAGA
DEFFLAGB EQU   DEFVE+56
DEFSETFL EQU   DEFFLAGB
DEFSRCVY EQU   DEFSETFL
DEFRECFL EQU   DEFFLAGB+1
DEFICOPY EQU   DEFRECFL
DEFTYPFL EQU   DEFFLAGB+2
DEFCOPY  EQU   DEFTYPFL
DEFNULFL EQU   DEFFLAGB+3
COVLIST  EQU   0
CVOLFLG  EQU   COVLIST+6
CVOCRCR  EQU   CVOLFLG
CVOLID   EQU   COVLIST+8
CVOLCSN  EQU   COVLIST+20
CVOLVEXT EQU   COVLIST+36
COVCE    EQU   0
COVLNGTH EQU   COVCE
COVDESCR EQU   COVCE+4
COVFLAGA EQU   COVCE+34
COVSPDES EQU   COVFLAGA
COVFLAGB EQU   COVCE+35
COVSETFL EQU   COVFLAGB
COVSRCVY EQU   COVSETFL
COVRECFL EQU   COVFLAGB+1
COVICOPY EQU   COVRECFL
COVTYPE  EQU   COVFLAGB+2
COVSAM   EQU   COVTYPE
COVREUSE EQU   COVTYPE
MCRTE    EQU   0
MCRLNGTH EQU   MCRTE
MCRLOC   EQU   MCRTE+4
MCRFLAGA EQU   MCRTE+34
MCRSPLOC EQU   MCRFLAGA
MCRFLAGB EQU   MCRTE+36
MCRTYPE  EQU   MCRFLAGB+2
MCRREC   EQU   MCRTYPE
MCLIST   EQU   0
MCRTFLG  EQU   MCLIST+6
MCRTTRAN EQU   MCRTFLG
MCRTLIB  EQU   MCLIST+7
MCRTCSN  EQU   MCLIST+24
MCRTVEXT EQU   MCLIST+44
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEJCT    EQU   0
NEWERID1 EQU   5
NREC     EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
CKCSNVAL EQU   0
CKLENGTH EQU   0
VECSN1   EQU   0
VEVOLUME EQU   0
VEVVIERR EQU   0
VERECFLG EQU   0
VEVOLLOC EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
SCINPUT  EQU   0
SCERRFLG EQU   SCINPUT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00147 EQU   SCINPUT
@NM00146 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
MCRTECB  EQU   MCLIST+40
MCRTASID EQU   MCLIST+38
MCRTRES4 EQU   MCLIST+36
MCRTRES3 EQU   MCLIST+16
MCRTRES2 EQU   MCLIST+8
MCRTLD   EQU   MCRTLIB
@NM00142 EQU   MCRTLIB
@NM00141 EQU   MCRTFLG
MCRTSCT  EQU   MCRTFLG
@NM00140 EQU   MCRTFLG
MCRTRES1 EQU   MCLIST+5
MCRTOPCD EQU   MCLIST+4
MCRTLEN  EQU   MCLIST
@NM00139 EQU   MCRTE+40
@NM00138 EQU   MCRFLAGB+3
@NM00137 EQU   MCRTYPE
@NM00136 EQU   MCRFLAGB+1
@NM00135 EQU   MCRFLAGB
MCRBLNK1 EQU   MCRTE+35
@NM00134 EQU   MCRFLAGA
@NM00128 EQU   COVCE+39
@NM00127 EQU   COVFLAGB+3
@NM00126 EQU   COVTYPE
@NM00125 EQU   COVRECFL
COVLAMIS EQU   COVRECFL
COVCREAT EQU   COVRECFL
@NM00124 EQU   COVSETFL
COVCRCVY EQU   COVSETFL
@NM00123 EQU   COVFLAGA
CVOLRES2 EQU   COVLIST+34
CVOLRUA  EQU   COVLIST+32
CVOLECB  EQU   COVLIST+16
CVOLASID EQU   COVLIST+14
@NM00122 EQU   CVOLFLG
CVOCRCRV EQU   CVOLFLG
CVOCRDAS EQU   CVOLFLG
CVODASCR EQU   CVOLFLG
CVOLRES1 EQU   COVLIST+5
CVOLOPCD EQU   COVLIST+4
CVOLLEN  EQU   COVLIST
@NM00121 EQU   DEFVE+60
@NM00120 EQU   DEFNULFL
DEFNEXPD EQU   DEFNULFL
DEFNDESC EQU   DEFNULFL
DEFNGRP  EQU   DEFNULFL
@NM00119 EQU   DEFTYPFL
DEFDUP   EQU   DEFTYPFL
DEFRSTD  EQU   DEFTYPFL
DEFGENUS EQU   DEFTYPFL
@NM00118 EQU   DEFRECFL
DEFLAMIS EQU   DEFRECFL
DEFCREAT EQU   DEFRECFL
@NM00117 EQU   DEFSETFL
DEFCRCVY EQU   DEFSETFL
@NM00116 EQU   DEFFLAGA
DEFPBKUP EQU   DEFFLAGA
DEFPTO   EQU   DEFFLAGA
DEFPGRO  EQU   DEFFLAGA
DEFPVLAB EQU   DEFFLAGA
DEFPFOR  EQU   DEFFLAGA
DEFLABEL EQU   DEFVE+49
DEFBKUPN EQU   DEFVE+48
DEFFOR   EQU   DEFVE+46
DEFTO    EQU   DEFVE+42
DEFGROUP EQU   DEFVE+4
DEFR60   EQU   DEFVDATA+43
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   DEFLIST+52
DEFVASID EQU   DEFLIST+50
@NM00115 EQU   DEFLIST+48
@NM00114 EQU   DEFLIST+22
@NM00113 EQU   DEFLIST+15
@NM00112 EQU   DEFVVFLG
@NM00111 EQU   DEFVVFLG
@NM00110 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00109 EQU   DEFVLIB
DEFVDACT EQU   DEFVFLG
DEFVACT  EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVRNM  EQU   DEFVFLG
DEFVELM  EQU   DEFVFLG
@NM00108 EQU   DEFLIST+5
DEFVOPCD EQU   DEFLIST+4
DEFVLEN  EQU   DEFLIST
@NM00107 EQU   COPYV+136
COPFREXT EQU   COPYV+132
COPLEXT  EQU   COPYV+130
COPFRESP EQU   COPYV+128
COPDESCR EQU   COPYV+58
COPDTREM EQU   COPYV+54
COP2BIT2 EQU   COPLID2
COP2BIT1 EQU   COPLID2
COPRES5  EQU   COPLIB2
COP1BIT2 EQU   COPLID1
COP1BIT1 EQU   COPLID1
COPRES4  EQU   COPLIB1
@NM00106 EQU   COPMISCF
COPHOLD  EQU   COPMISCF
COPRES3  EQU   COPSATIA
COPVSMIS EQU   COPSATIA
COPIVCPY EQU   COPSATIA
COPIVCRE EQU   COPSATIA
@NM00105 EQU   COPYV+18
@NM00104 EQU   COPFLAGA+3
COPDLSPF EQU   COPFLAGA+3
COPRONLY EQU   COPFLAGA+3
COPDAERA EQU   COPFLAGA+2
COPEXCL  EQU   COPFLAGA+2
COPBIND  EQU   COPFLAGA+2
COPBKUP  EQU   COPFLAGA+2
COPRSTD  EQU   COPFLAGA+2
COPGENUS EQU   COPFLAGA+2
COPVSAM  EQU   COPFLAGA+2
COPGROUP EQU   COPFLAGA+2
COPRES2  EQU   COPTYPE
COPCOPYV EQU   COPTYPE
COPRES1  EQU   COPTYPE
COPRES6  EQU   COPYV+13
COPNO    EQU   COPID+1
COPBLANK EQU   COPID
COPSERNO EQU   COPNAME+5
COPV     EQU   COPNAME
@NM00103 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00102 EQU   BASEV+65
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00101 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
@NM00100 EQU   MVR+82
MVRLABEL EQU   MVR+76
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRTO    EQU   MVR+58
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00099 EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRCLMIS EQU   MVRFLAGA+1
MVRSLMIS EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLLAB EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00098 EQU   MVRCODE+1
MVROPCD  EQU   MVRCODE
@NM00097 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00096 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00095 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00094 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00093 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00092 EQU   RVVOPCOD+1
PFILEVAL EQU   @NM00091+1
PFILELEN EQU   @NM00091
PFILECNT EQU   PFILE
FILELEN  EQU   FILE
CATDNLEN EQU   CATDN
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
LOCLEN   EQU   LOC
DESCRLEN EQU   DESCR
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00090 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00089 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00088 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00087 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00086 EQU   VSDSCR+5
@NM00085 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00084 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00083 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00082 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00081 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00080 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00079 EQU   VSDVTOC
@NM00078 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00077 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00076 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00075 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00074 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00071 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00070 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00069 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00068 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00067 EQU   RCTAGL+10
@NM00066 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00065 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
@NM00064 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00063 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
@NM00062 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00061 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSACBP   EQU   VS1AGL+36
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00060 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00059 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00058 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00057 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00056 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00055 EQU   EXSPACE+8
@NM00054 EQU   EXSPACE+6
@NM00053 EQU   EXSPACE+4
@NM00052 EQU   EXSPACE+1
@NM00051 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00050 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDPUAGL  EQU   MDAGL+20
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00454 EQU   @RC00453
@RF00544 EQU   @RC00500
@RC00576 EQU   @RC00575
@RF01542 EQU   @RC01527
@RF01662 EQU   @RC01634
@PB00018 EQU   @EL00001
@RC00456 EQU   @RC00454
@RF00611 EQU   @RC00576
@PB00017 EQU   @PB00018
@RF00474 EQU   @RC00456
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCCO01,(C'PLS1721',0603,76339)

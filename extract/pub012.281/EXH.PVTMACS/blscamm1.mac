*** START OF SPECIFICATIONS *****************************************
*
* $MAC(BLSCAMM1) COMP(SC132) PROD(JIP1329): COUNT SUBLIST ENTRIES
*
* COPYRIGHT= 5740-XYN, 5740-XYS COPYRIGHT IBM CORPORATION 1982.
*            LICENCED MATERIAL-PROGRAM PROPERTY OF IBM,
*            REFER TO COPYRIGHT INSTRUCTIONS FORM NUMBER G120-2083.
*
*   CHANGE ACTIVITY:
* $L0= MVSIPCS,EIP1102,78001,DMGPSR: MVS IPCS INITIAL RELEASE CODE
* $D1= QUALITY,HIP2102,81266,DSDPRW: IMPROVE COMMENTS, REMARKS
*
*** END OF SPECIFICATIONS *******************************************
         MACRO
         BLSCAMM1 &LIST            COUNT SUBLIST ENTRIES           @D1C
         GBLA  &BLSCAGA            PARAMETER SUBLIST COUNT
         LCLA  &CTR                CURRENT LIST BYTE COUNTER
         LCLA  &LEN                LIST LENGTH
         LCLC  &STR                LIST CHARACTER STRING
&CTR     SETA  1                   CURRENT BYTE COUNTER
&STR     SETC  '&LIST'             LIST CHAR STRING
&LEN     SETA  K'&STR              LIST LENGTH
         AIF   (&LEN GT 0).SK1     NON NULL LIST
&BLSCAGA SETA  0                   NULL LIST
         AGO   .END
.SK1     AIF   ('&STR' NE '()').SK2 NOT NULL LIST
&BLSCAGA SETA  0                   NULL LIST
         AGO   .END
.SK2     AIF   ('&STR'(1,1) EQ '(').SK3  MULTI ELEMENT LIST CANDIDATE
&BLSCAGA SETA  1                   ONE ELEMENT LIST
         AGO   .END
.SK3     ANOP
&BLSCAGA SETA  1                   SET UP ELEMENT COUNT LOOP
         AGO   .LPTST              ENTER LOOP
.LOOP    AIF   ('&STR'(&CTR,1) NE '(').SK4
         MNOTE 8,'LIST CONTAINS AN INNER SUBLIST'
         AGO   .ERR                ERROR EXIT
.SK4     AIF   ('&STR'(&CTR,1) NE ',').SK5  NOT ELEMENT END
&BLSCAGA SETA  &BLSCAGA+1           BUMP ELEMENT COUNT
         AGO   .LPTST
.SK5     AIF   ('&STR'(&CTR,1) NE ')').LPTST  NOT END OF PLIST
         AIF   (&CTR EQ &LEN).END   LIST END MATCHES LOGICAL END
         MNOTE 8,'INVALID LIST FORMAT'
         AGO   .ERR
.LPTST   ANOP
&CTR     SETA  &CTR+1               BUMP CURRENT BYTE COUNTER
         AIF   (&CTR LE &LEN).LOOP  NOT END OF LIST
         AGO   .END
.ERR     ANOP
&BLSCAGA SETA  -1                   INDICATE ERROR TO CALLER
.END     MEND

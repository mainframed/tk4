*** START OF SPECIFICATIONS *****************************************
*
* $MAC(BLSCGETF) COMP(SC132) PROD(JIP1329): GET AUTOMATIC STORAGE
*
* COPYRIGHT= 5740-XYN, 5740-XYS COPYRIGHT IBM CORPORATION 1982.
*            LICENCED MATERIAL-PROGRAM PROPERTY OF IBM,
*            REFER TO COPYRIGHT INSTRUCTIONS FORM NUMBER G120-2083.
*
*   CHANGE ACTIVITY:
* $L0= MVSIPCS,EIP1102,78001,DMGPSR: MVS IPCS INITIAL RELEASE CODE
* $D1= QUALITY,HIP2102,81266,DSDPRW: IMPROVE COMMENTS, REMARKS
*
*** END OF SPECIFICATIONS *******************************************
         MACRO
&L       BLSCGETF &R,&LV=,&SP=   GET AUTOMATIC STORAGE             @D1C
         LCLC  &BPT
&BPT     SETC 'DMG&SYSNDX'
&L       L     @14,0(,@01)       USE REGISTER 14 TO ADDRESS DMCB
         LR    @01,@00           LENGTH INTO REG 1 FOR INC BY LOAD ADDR
         LA    @00,7(@01)        THIS AND NEXT 2 INSTRUCTIONS
         SRL   @00,3             ROUND LENGTH TO A MULTIPLE OF EIGHT
         SLL   @00,3             FOR COMPATIBILITY WITH GETMAIN
         A     @00,DMCBFRE(@14)  COMPUTE NEXT FREE ADDRESS
         C     @00,DMCBEOB(@14)  IS THERE ENOUGH ROOM?
         BL    &BPT              IF SO THEN PROCEED
         ABEND 999,DUMP          SHOULD NEVER OCCUR
&BPT     L     @01,DMCBFRE(@14)  PICK UP ADDRESS TO USE FOR @DATD  @D1C
         ST    @00,DMCBFRE(@14)  STORE ADDRESS OF NEXT FREE AREA
         MEND

SD95     TITLE 'I E F S D 0 9 5  ***  SYSOUT WTR JOB SEPARATOR ROUTINE'
         MACRO ,                                                 81159
&NM      PAT   &OPT,&P=,&SIZE=,&SHOW=                            91058
         GBLC  &P@T(256)     PATTERN HOLDER                      81159
         GBLC  &T@O(16),&T@T(16)    TRANSLATE TABLES             81167
         GBLB  &SHOWOFF                                          91058
         GBLA  &P@M,&P@C,&P@P     MAX(256) / CURRENT / CHARS     91058
         GBLA  &T@N          NUMBER OF PATTERNS DEFINED          81167
         GBLA  &LS,&LN,&LB   PATTERN SIZE, NYBBLES, BYTES        91058
         LCLA  &I,&J,&K,&L,&M                                    91058
         LCLC  &C,&D,&STR,&AST                                   91058
&SHOWOFF SETB  (&SHOWOFF OR ('&SHOW' EQ 'OFF') OR ('&SHOW' EQ 'NO'))
&SHOWOFF SETB  (&SHOWOFF AND ('&SHOW' NE 'YES') AND ('&SHOW' NE 'NO'))
         AIF   ('&SIZE' EQ '' AND &LS GT 0).NOTFIR               91058
         AIF   (&SIZE LT 1 OR &SIZE GT 32).UNSIZE                91058
&LS      SETA  &SIZE         BITS                                91058
&LN      SETA  (&LS+3)/4     NYBBLES                             91058
&LB      SETA  (&LS+7)/8     BYTES                               91058
&P@M     SETA  256           SET SIZE OF P@T ARRAY               81159
&P@C     SETA  1             ONE ITEM IN ARRAY                   81159
&P@T(1)  SETC  '00000000'(1,&LN)  SET FOR EMPTY LINE             91058
&T@N     SETA  1             NUMBER OF NEXT PATTERN              81167
.FIRLOOP AIF   (&I GE 16).NOTFIR                                 81167
&I       SETA  &I+1                                              81167
&T@O(&I) SETC  '00000000000000000000000000000000'                81167
&T@T(&I) SETC  '00000000000000000000000000000000'                81167
         AGO   .FIRLOOP                                          81167
.UNSIZE  MNOTE 8,'**** ONLY PATTERN SIZES 1(?) TO 32 ARE SUPPORTED'
         MEXIT ,                                                 91058
.NOTFIR  AIF   ('&OPT' EQ 'END').EXPAND   EXPAND PATTERNS        81159
         AIF   (K'&NM NE 3).NM2                                  81169
         AIF   ('&NM'(1,1) NE 'X').BADNM                         81169
&C       SETC  '&NM'(2,1)                                        81169
&D       SETC  '&NM'(3,1)                                        81169
         AGO   .NMCOM                                            81169
.NM2     AIF   (K'&NM NE 2).BADNM                                81169
&C       SETC  '&NM'(1,1)                                        81167
&D       SETC  '&NM'(2,1)                                        81169
.NMCOM   ANOP  ,                                                 81169
&I       SETA  1                                                 81167
&J       SETA  1                                                 81167
.FINDI   AIF   ('&C' EQ '0123456789ABCDEF'(&I,1)).FINDJ          81169
         AIF   (&I GE 16).BADNM                                  81167
&I       SETA  &I+1                                              81167
         AGO   .FINDI                                            81167
.FINDJ   AIF   ('&D' EQ '0123456789ABCDEF'(&J,1)).FUNDJ          81167
         AIF   (&J GE 16).BADNM                                  81167
&J       SETA  &J+1                                              81167
         AGO   .FINDJ                                            81167
.FUNDJ   AIF   (&I GT 4).FUNDJ4                                  81169
         MNOTE 4,'HEX VALUES LOWER THAN 40 ARE NOT SUPPORTED'    81169
.FUNDJ4  ANOP  ,                                                 81169
&C       SETC  '&C'.'&D'     HEX PORTION OF NAME                 81169
&L       SETA  &T@N/16                                           81167
&M       SETA  &T@N-&L*16                                        81167
&D       SETC  '0123456789ABCDEF'(&L+1,1)                        81167
&D       SETC  '&D'.'0123456789ABCDEF'(&M+1,1)                   81167
&J       SETA  2*&J-1                                            81167
         AIF   ('&P' EQ '').DEFTRAN                              81167
         AIF   (K'&P NE 3).PL2                                   81169
         AIF   ('&P'(1,1) NE 'X').BADP                           81169
&C       SETC  '&P'(2,2)                                         81169
         AGO   .DEFTRAN                                          81169
.PL2     AIF   (K'&P NE 2).BADP                                  81169
&C       SETC  '&P'                                              81167
.DEFTRAN AIF   ('&T@O(&I)'(&J,2) NE '00').DUPNM                  81167
         AIF   (&J EQ 31).LASTRAN                                81167
         AIF   (&J GT 1).MIDTRAN                                 81167
&T@O(&I) SETC  '&D'.'&T@O(&I)'(3,30)                             81167
&T@T(&I) SETC  '&C'.'&T@T(&I)'(3,30)                             81167
         AGO   .COMTRAN                                          81167
.MIDTRAN ANOP  ,                                                 81167
&T@O(&I) SETC  '&T@O(&I)'(1,&J-1).'&D'.'&T@O(&I)'(&J+2,31-&J)    81167
&T@T(&I) SETC  '&T@T(&I)'(1,&J-1).'&C'.'&T@T(&I)'(&J+2,31-&J)    81167
         AGO   .COMTRAN                                          81167
.LASTRAN ANOP  ,                                                 81167
&T@O(&I) SETC  '&T@O(&I)'(1,30).'&D'                             81167
&T@T(&I) SETC  '&T@T(&I)'(1,30).'&C'                             81167
.COMTRAN ANOP  ,                                                 81167
&I       SETA  0                                                 81167
&J       SETA  0                                                 81167
&K       SETA  N'&SYSLIST    GET NUMBER OF LIST ITEMS            81159
&STR     SETC  ''            CLEAR OFFSET STRING                 91058
         AIF   (&K NE &LS).NOT12   COMPLAIN IF NOT COMPLETE      91058
.OUTLOOP AIF   (&I GE &LS).EXPITEM   DONE WITH CHARACTER ?       91058
&I       SETA  &I+1                                              81159
&C       SETC  '&SYSLIST(&I)'                                    81159
         AIF   ('&C' NE '').NOTOM                                81159
&C       SETC  '00000000'(1,&LN)                                 91058
.NOTOM   AIF   (K'&C NE &LN).NOT3                                91058
         AIF   (&SHOWOFF).NOTAST                                 91058
&AST     SETC  '                    '(1,20-&LS/2)                91058
&L       SETA  1                                                 91058
&M       SETA  1                                                 91058
.SHOWI   AIF   ('&C'(&M,1) EQ '0123456789ABCDEF'(&L,1)).SHOWJ    91058
         AIF   (&L GE 16).NOT3                                   91058
&L       SETA  &L+1                                              91058
         AGO   .SHOWI                                            91058
.SHOWJ   ANOP  ,                                                 91058
&AST     SETC  '&AST'.'       *  *   ** *   * * **  ****   *  ** * * **X
               **  ** **** ****'(&L*4-3,4)                       91058
&L       SETA  1                                                 91058
&M       SETA  &M+1                                              91058
         AIF   (&M LE &LN).SHOWI                                 91058
         MNOTE *,' &AST'                                         91058
.NOTAST  ANOP  ,                                                 91058
&J       SETA  0                                                 81159
.INLOOP  AIF   (&J GE &P@C).ADDIN                                81159
&J       SETA  &J+1                                              81159
         AIF   ('&P@T(&J)' NE '&C').INLOOP                       81159
         AGO   .FOUND                                            81159
.ADDIN   AIF   (&J GE &P@M).OFLOW                                81159
&J       SETA  &J+1                                              81159
&P@T(&J) SETC  '&C'                                              81159
&P@C     SETA  &J                                                81159
.FOUND   ANOP  ,                                                 91058
&M       SETA  &J-1                                              91058
         AIF   ('&STR' EQ '').FOUNDNU                            91058
&STR     SETC  '&STR'.','.'&M'                                   91058
         AGO   .OUTLOOP                                          91058
.FOUNDNU ANOP  ,                                                 91058
&STR     SETC  '&M'                                              91058
         AGO   .OUTLOOP                                          81159
.EXPITEM ANOP  ,                                                 81159
&T@N     SETA  &T@N+1        UP NUMBER OF NEXT PATTERN           81167
         DC    AL1(&STR)                                         91058
&P@P     SETA  &P@P+1        NUMBER OF CHARACTERS                91058
         MEXIT ,                                                 81159
.NOT12   MNOTE 4,'*** &LS ITEMS, OR ''END'' REQUIRED'            91058
         MEXIT ,                                                 81159
.NOT3    MNOTE 4,'*** PAT ITEM MUST BE &LN HEX CHARACTERS; #&I IS &C'
         MEXIT ,                                                 81159
.BADNM   MNOTE 4,'NAME FIELD MUST BE TWO HEX OR X AND TWO HEX CHARS'
         MEXIT ,                                                 81167
.DUPNM   MNOTE 4,'CHARACTER PREVIOUSLY DEFINED'                  81167
         MEXIT ,                                                 81167
.BADP    MNOTE 4,'INVALID PRINT VALUE P=&P'                      81167
         MEXIT ,                                                 81167
.OFLOW   MNOTE 4,'*** PAT TABLE OVERFLOW; REDESIGN REQUIRED'     81159
         MEXIT ,                                                 81159
.EXPAND  AIF   ('&P' NE 'FOLD').EXNOFOL                          81167
&T@O(9)  SETC  '&T@O(9)'(1,2).'&T@O(13)'(3,18).'&T@O(9)'(21,12)  81167
&T@T(9)  SETC  '&T@T(9)'(1,2).'&T@T(13)'(3,18).'&T@T(9)'(21,12)  81167
&T@O(10) SETC  '&T@O(10)'(1,2).'&T@O(14)'(3,18).'&T@O(10)'(21,12)
&T@T(10) SETC  '&T@T(10)'(1,2).'&T@T(14)'(3,18).'&T@T(10)'(21,12)
&T@O(11) SETC  '&T@O(11)'(1,4).'&T@O(15)'(5,16).'&T@O(11)'(21,12)
&T@T(11) SETC  '&T@T(11)'(1,4).'&T@T(15)'(5,16).'&T@T(11)'(21,12)
.EXNOFOL ANOP  ,                                                 81169
&I       SETA  4             SKIP FIRST 64 BYTES                 81167
         ORG   *-64          DEFINE PSEUDO-ORIGIN                81167
P&LS.OFF EQU   *             OFFSETS TO PATTERN TABLE            91058
         ORG   P&LS.OFF+64                                       91058
.OFFLOOP AIF   (&I GE 16).OFFDONE                                81167
&I       SETA  &I+1                                              81167
         DC    X'&T@O(&I)'
         AGO   .OFFLOOP                                          81167
.OFFDONE ORG   *-64                                              81167
&I       SETA  4                                                 81167
P&LS.TRAN EQU  *             CHARACTERS FOR PATTERN PRINT        91058
         ORG   P&LS.TRAN+64                                      91058
.TRALOOP AIF   (&I GE 16).TRADONE                                81167
&I       SETA  &I+1                                              81167
         DC    X'&T@T(&I)'
         AGO   .TRALOOP                                          81167
.TRADONE ANOP  ,                                                 81167
&NM      DS    0H                                                81159
&I       SETA  1                                                 81159
&J       SETA  &P@C                                              81159
&J       SETA  &J/8*8                                            91058
         AIF   (&J LT 8).EYNEXT                                  91058
.EXNEXT  DC    X'&P@T(&I),&P@T(&I+1),&P@T(&I+2),&P@T(&I+3),&P@T(&I+4),&*
               P@T(&I+5),&P@T(&I+6),&P@T(&I+7)'                  91058
&I       SETA  &I+8                                              91058
         AIF   (&I LT &J).EXNEXT                                 81159
         AIF   (&J GE &P@C).EZNEXT                               91058
.EYNEXT  DC    X'&P@T(&I)'                                       91058
&I       SETA  &I+1                                              81159
         AIF   (&I LE &P@C).EYNEXT                               81159
.EZNEXT  ANOP  ,             FORCE REDEFINITIONS FOR NEXT SET    91058
&LS      SETA  0                                                 91058
&SHOWOFF SETB  1             CANCEL MNOTE LETTER DISPLAY         91058
  MNOTE *,'THIS FONT USED &P@C OF 256 PATTERNS FOR &P@P CHARACTERS'
&P@P     SETA  0                                                 91058
.MEND    MEND  ,                                                 81159
         SPACE 1
         PUNCH '  ALIAS BIGABC,JESSD095 '                       GP04234
         EJECT ,                                                 91052
         COPY  OPTIONGB                                          81159
         SPACE 1                                                 81159
         SYSPARM LIST=YES                                        81159
***********************************************************************
*                                                                     *
*        CALLING SEQUENCE AND OPTIONS:                                *
*                                                                     *
*        LA    R1,=A(@IN,@OPTS,@OUT,@LINE#)                           *
*        BALR  R14,R15       REFRESHABLE, RE-ENTRANT @ IEFSD095       *
*                                                                     *
*        @IN       ADDRESS OF INPUT TEXT (1-10 BYTES)                 *
*        @LINE#    ADDRESS OF FULLWORD INTEGER WITH CURRENT LINE      *
*              NUMBER OF THE PATTERN (<1 OR >PATTERN JUST FILLS).     *
*        @OUT      ADDRESS OF OUTPUT LINE - ALLOW 150 BYTES           *
*        @OPTS     ADDRESS OF PROGRAM OPTIONS, ETC.                   *
*                                                                     *
*        OPTIONS AREA (4 BYTES MINIMUM) :                             *
*        UCHAR     CHARACTER SET:    0    12*12, SPACED 2             *
*                                    1     8*8, SPACED 1              *
*                                    2     5*5, SPACED 1              *
*        UFLAG1    PROCESSING OPTIONS                                 *
*              80 - 8 MORE BYTES OF OPTIONS FOLLOW THESE FOUR         *
*              08 - AFTER TEXT IS CENTERED, UPDATE CALLER'S AREA      *
*              04 - CENTER THE TEXT                                   *
*              02 - HALF-ADJUST; SHIFTS TEXT HALF-CHAR WIDTH AND      *
*                     IGNORES LAST BYTE IN @IN (PRESUMED BLANK)       *
*              01 - PRODUCE NEGATIVE IMAGE                            *
*        UFLAG2    ADDITIONAL FLAGS                                   *
*              02 - SLANT OUTPUT LEFT; REQUIRES ADDITIONAL CHAR. WIDTH*
*              01 - SLANT OUTPUT RIGHT; NEEDS EXTRA CHAR. WIDTH       *
*        UNUM      NUMBER OF CHARACTERS IN @IN                        *
*                                                                     *
*        OPTIONAL EXTENSION:                                          *
*                                                                     *
*        UOBACK    IF NON-ZERO, BACKGROUND CHARACTER                  *
*        UOFORE    IF NON-ZERO, FOREGROUND CHARACTER                  *
*        UOSEP     SPACE BETWEEN CHARACTERS (DFLT 1, EXCEPT FOR       *
*                    12*12 SIZE WITH 1-9 CHARACTERS, WHICH USES 2)    *
*                                                                     *
*                                                                     *
*                                                                     *
*                                                                     *
*                                                                     *
*                                                                     *
*                                                                     *
***********************************************************************
         EJECT ,                                                 81159
         PRINT &PRTSOR                                           81159
         SPACE 1                                                 81159
***********************************************************************
***********************************************************************
**                                                                   **
**       THIS MODULE IS A PLUG-COMPATIBLE REPLACEMENT FOR IBM'S      **
**       IEFSD095 BIG LETTER ROUTINE (PART OF JOB WRITER/SEPARATOR). **
**         ADDITIONAL FEATURES ARE DOCUMENTED ON PREVIOUS PAGE.      **
**                                                                   **
**       ATTRIBUTES: RENT, REFR, REUS, AMODE ANY, AC(0), RMODE ?     **
**       DEPENDENCIES:  LOCAL PGMHEAD/PGMEXIT AND RELATED MACROS     **
**                                                                   **
**       THE 12*12 CHARACTER SET WAS ADAPTED FROM IBM'S VERSION.     **
**       THE 8*8 CHARACTER SET COMES FROM THE U. OF WATERLOO         **
**                                                                   **
**       OTHER CODE MARKED 81NNN, 86NNN AND 91NNN IS                 **
**       COPYRIGHT 1981, 1986, 1991 EXPERT SYSTEM PROGRAMMING, INC.  **
**                                                                   **
***********************************************************************
***********************************************************************
         SPACE 1                                                 81159
IEFSD095 PGMHEAD BASE=R12,PARM=R11,AM=24,RM=24
         ENTRY BIGABC
BIGABC   EQU   IEFSD095      ENTRY NAME FOR FORTRAN CALLERS      81159
         MVI   RENTFLAG,FGRENT   SHOW RE-ENTRANT ENTRY TAKEN     91052
         B     COMMENT       GO TO COMMON ENTRY                  86064
         SPACE 1                                                 86064
         ENTRY JESSD095      >>>> NON-REFRESHABLE <<<<           86064
*        NON-REENTRANT ENTRY POINT FOR JES CALLS (NO GETMAINS)   86064
*                                                                86064
JESSD095 BSM   R14,0         SAVE JES2 EXIT'S AMODE
         STM   R0,R14,JESWORK-JESSD095(R15)   SAVE CALLER'S REGISTERS
         LA    R0,JESSD095-IEFSD095  OFFSET FROM BASE            91052
         LA    R12,0(,R15)   CLEAN BASE                          86064
         SR    R12,R0        MAKE TRUE BASE ADDRESS              91052
         LR    R11,R1        COPY ENTRY REGISTER                 86064
         LA    R13,JESWORK   SET NEW WORK/SAVE AREA              86086
         SPACE 1
COMMENT  LM    R8,R11,0(R11)   LOAD ENTRY PARAMETERS             86064
         USING DIN,R8        INPUT ADDRESS
         USING DOUT,R10
         USING DCONT,R11     FLAG/CHAR. COUNT
         L     R9,0(,R9)     LOAD LINE NUMBER
         BCTR  R9,0          LINE NO. -1
         LA    R14,CH8BY8    SET FOR NEW SMALL SIZE              86064
         CLI   UCHARS,1      WAS IT REQUESTED ?                  86064
         BE    COMMOPT       YES ?                               86064
         LA    R14,CH5BY5    SET FOR VERY SMALL SET              91052
         BH    COMMOPT                                           91052
         LA    R14,CH12BY12  ELSE OLD DEFAULT                    86064
COMMOPT  MVC   OPTTAB(OPTSIZE),0(R14)  SET OPTIONS               86064
         MVC   FLAG1,UFLAG1  COPY USER'S FLAG FOR MODIFICATION   81159
         LH    R15,MAXCHPL   SET MAX CHARACTERS PER LINE         86064
         LH    R14,MAXLINE   SET LINES PER PATTERN               86064
         LA    R0,2          SET ANOTHER CONSTANT                81159
         SLR   R2,R2                                             81159
         IC    R2,UNUM       LOAD NUMBER OF CHARACTERS IN LINE   91052
         LH    R7,SEPNO      GET BYTES BETWEEN CHARACTERS        91052
         CR    R2,R15        LARGER THAN MAX ?                   81159
         BL    DONESEP       LESS; FULL SPACING                  81159
         LR    R2,R15        TRUNCATE TO MAX                     81159
         CR    R7,R0         LESS THAN TWO ?                     91052
         BL    DONESEP       YES; NO CHANGE                      91052
         BCTR  R7,0          MAKE ONE LESS                       91052
DONESEP  TM    UFLAG1,FGMORE  EXTENDED OPTIONS ?                 91052
         BZ    PASTSEP       NO                                  91052
         ICM   R7,4,UOSEP    DID USER SPECIFY AN OVERRIDE ?      91052
         BZ    PASTSEP       NO                                  91052
         SRA   R7,16         YES; USE IT                         91052
PASTSEP  STH   R7,SEPNO      AND STASH IT BACK                   91052
         LTR   R7,R2         COPY NUMBER OF CHARACTERS
         BNP   EXIT          ERROR                               91052
         TM    FLAG1,FGCENT+FGBACK
         BZ    COMPFILL
         MVI   CENTER,C' '
         MVC   CENTER+1(18),CENTER
         BCTR  R2,0
         SPACE 2
*        DO OUTPUT CENTERING HERE.
         SPACE 1                                                 81159
         EX    R2,MV5
         LR    R6,R8         SAVE OLD INPUT ADDRESS
         LA    R5,CENTER+4
         LR    R4,R15        COPY MAXIMUM CHARACTERS             86064
         BCTR  R4,0            LESS ONE                          86064
         SLR   R1,R1
CNT1     CLI   0(R5),C' '    LEADING BLANK ?
         BNE   CNT2
         LA    R1,1(,R1)
         LA    R5,1(,R5)
         BCT   R4,CNT1
CNT2     SLR   R3,R3
         LR    R4,R15        COPY MAXIMUM CHARACTERS             86064
         BCTR  R4,0            LESS ONE                          86064
         LA    R5,CENTER+13
CNT3     CLI   0(R5),C' '    TRAILING BLANK ?
         BNE   CNT4
         LA    R3,1(,R3)
         BCTR  R5,0
         BCT   R4,CNT3
CNT4     LA    R4,0(R1,R3)   R1 HAS LEFT BLANK COUNT, R3 HAS RIGHT
         CR    R4,R15        MORE THAN 10 ?                      81159
         BL    CNT5
         SLR   R3,R3         ALL BLANK, NO HALF ADJUST
         LA    R8,CENTER
         B     CNT8
CNT5     LA    R4,0(R4,R7)   NO. OF BLANKS + NO. OF CHAR.S
         SR    R4,R15        -10 = NO. OF VALID BLANKS           81159
         LR    R3,R4
         SRL   R4,1          NO. ON LEFT SIDE
         LA    R8,CENTER+4(R1)  LOC. OF NON-BLANK
         SR    R8,R4         START LOC. FOR CENTERED OUTPUT
         SLL   R3,1
         NR    R3,R0         0 OR 1 IN LAST BYTE
CNT8     NI    FLAG1,255-FGHALF-FGCENT
         EX    R3,MERGFLGS   MERGE NEW FLAG BITS                 91052
         TM    FLAG1,FGBACK  UPDATE CALLER'S AREA ?
         BZ    COMPFILL
         EX    R2,MBK
         NI    FLAG1,255-FGBACK
         MVN   UFLAG1,FLAG1  RETURN NEW FLAG BITS TO USER        91052
         B     COMPFILL
MERGFLGS OI    FLAG1,*-*     UPDATE CENTERING BITS               91052
         SPACE 2
*        FILL OUTPUT AREA WITH BLANKS OR FILL CHARACTER
         SPACE 1                                                 81159
COMPFILL LR    R3,R7         COPY NUMBER OF CHARACTERS           91052
         LH    R6,SEPNO      BYTES BETWEEN CHARACTERS (1 OR 2)
         AR    R6,R14        ADD CHARACTER WIDTH                 81159
         MR    R2,R6         TOTAL WIDTH
         TM    UFLAG1,FGNEG  REVERSED IMAGE ?                    91052
         BZ    *+8           NO                                  91052
         AH    R3,SEPNO      ADD LEADING SEPARATOR               91052
         TM    UFLAG2,FGLEFT+FGRITE  SLANT ?                     91052
         BZ    FILLNORM      NO                                  91052
         AR    R3,R14        NEED SPACE FOR ONE MORE CHARACTER   91052
         BCTR  R3,0          LESS ONE BYTE                       91052
FILLNORM TM    UFLAG1,FGMORE   EXTENDED OPTIONS AVAILABLE ?      91052
         BZ    DEFILL        NO; USE DEFAULT                     91052
         ICM   R5,1,UOBACK   LOAD AND TEST BACKGROUND            91052
         BNZ   FILLIGHT      USE IT                              91052
DEFILL   LA    R5,C' '       SET BACKGROUND DEFAULT              91052
         TM    FLAG1,FGNEG   INVERSE BACKGROUND ?                91052
         BZ    FILLIGHT      NO                                  91052
         LA    R5,C'M'       PICK A HEAVY CHARACTER              91052
FILLIGHT STC   R5,OUT        SET FIRST BYTE                      91052
         BCTR  R3,0          ALLOW FOR JUST STORED BYTE          91052
         BCTR  R3,0          FIX FOR EXECUTE                     91052
         EX    R3,ZAP
         LTR   R9,R9         TEST LINE NUMBER (-1)               81159
         BL    EXIT
         CR    R9,R14        PAST TWELFTH LINE ?                 81159
         BNL   EXIT          USE FILL LINE ONLY IF NOT PROPER LINE NO.
         TM    UFLAG2,FGLEFT   SLANT LEFT ?                      91052
         BZ    UNSLANT       NO                                  91052
         AR    R10,R9        INDENT                              91052
         B     NOSLANT                                           91052
UNSLANT  TM    UFLAG2,FGRITE  SLANT RIGHT ?                      91052
         BZ    NOSLANT       NO                                  91052
         AR    R10,R14       ADD HIGH LINE NUMBER                91052
         SR    R10,R9        LESS CURRENT                        91052
         BCTR  R10,0         LESS RELATIVITY                     91052
NOSLANT  TM    UFLAG1,FGNEG  REVERSED IMAGE ?                    91052
         BZ    *+8           NO                                  91052
         AH    R10,SEPNO     YES; USE LEADING SPACER             91052
         TM    FLAG1,FGHALF
         BZ    TEXTLOOP
         CR    R7,R0
         BL    TEXTLOOP      IF ONE CHARACTER ONLY, DO NOT ADJUST
         AH    R10,HADJ      HALF-ADJUST OUTPUT                  86064
         BCTR  R7,0          ONE CHARACTER LESS IF HALF-ADJUST   81159
         SPACE 2
*        LOOP FOR ALL CHARACTERS IN INPUT STRING
         SPACE 1                                                 81159
TEXTLOOP CLI   IN,C' '
         BNH   CHARSKIP
         SLR   R3,R3         CLEAR FOR IC                        81167
         IC    R3,IN         GET CURRENT CHARACTER               81167
         LR    R5,R3         SAVE FOR PRINT CHARACTER LOOKUP     81167
         L     R1,OPTTRANO   GET PATTERN ADDRESS                 86064
         IC    R3,0(R1,R3)   GET PATTERN OFFSET                  86064
         LTR   R3,R3         TEST IF DEFINED                     81167
         BNP   CHARSKIP      SKIP IF NOT DEFINED                 81167
         L     R1,OPTTRANT   GET TRANSLATE BYTE TABLE            86064
         IC    R5,0(R1,R5)   REPLACE CHARACTER BY PRINT BYTE     86064
         MR    R2,R14        GET OFFSET FROM PATTERN (*12)       81167
         L     R1,OPTCHART   GET CHARACTER TABLE                 86064
         SR    R1,R14        MAKE RELATIVE TO 1                  86064
         LA    R3,0(R1,R3)   GET CHARACTER DEFINITION            86064
         IC    R2,0(R3,R9)   LOAD CURRENT LINE'S PATTERN OFFSET  81167
         LH    R1,SCALE      LOAD SCALING FACTOR                 86064
         SLL   R2,0(R1)      DOUBLE FOR HALF-WORD LENGTH         86064
         A     R2,OPTPATT    GET PATTERN TABLE START             86064
         SLR   R1,R1         ZERO FOR IC                         86064
         EX    0,OPTIC       INSERT APPROPRAITE NUMBER OF BYTES  91052
         EX    0,OPTSLL      ALIGN FOR BXH                       91052
         OR    R1,R0         OR IN A LOW ORDER BIT (2)           81159
         SPACE 2
*        STORE CHARACTER PATTERN HERE. USE CHARACTER IF POSITIVE,
*        BLANK IF NEGATIVE FLAG IS SET
         SPACE 1                                                 81159
         LR    R2,R14        SET FOR TWELVE BYTES                81159
         TM    FLAG1,FGNEG
         BZ    CHARHOP                                           91052
         LA    R5,C' '
CHARHOP  TM    UFLAG1,FGMORE  EXTENDED OPTIONS PRESENT ?         91052
         BZ    CHARLOOP      NO; PRODUCE CHARACTER               91052
         ICM   R5,2,UOFORE   GET USER'S FOREGROUND CHARACTER     91052
         BZ    CHARLOOP      NONE                                91052
         SRL   R5,8          SHIFT AND USE                       91052
CHARLOOP BXH   R1,R1,CHARINC
         STC   R5,OUT
CHARINC  LA    R10,1(,R10)
         BCT   R2,CHARLOOP
         B     CHARDONE
CHARSKIP AR    R10,R14       SKIP TWELVE                         81159
CHARDONE AH    R10,SEPNO
         LA    R8,1(,R8)
         BCT   R7,TEXTLOOP
         SPACE 1
EXIT     TM    RENTFLAG,FGRENT    RE-ENTRANT ENTRY ?             91052
         BNZ   EXITG         YES; FREEMAIN AND RETURN            91052
         LM    R0,R15,0(R13)  RELOAD CALLER'S (PRPU) REGISTERS   86086
         BSM   0,R14         RETURN
         SPACE 1                                                 86064
EXITG    PGMEXIT RC=0        RETURN WITH ZERO CC                 86064
         SPACE 2
ZAP      MVC   OUT+1(0),OUT
MV0      MVC   CENTER(0),IN
MV5      MVC   CENTER+4(0),IN
MBK      MVC   0(0,R6),0(R8)
         EJECT ,
         PRINT &PRTMAC                                           91058
CHARPATN EQU   *             START OF CHARACTER PATTERNS         81167
C0       PAT   020,070,020,1FC,3FE,603,603,603,603,603,3FE,1FC,P=F0,   *
               SIZE=12,SHOW=YES                                  91058
C1       PAT   7FE,FFF,C03,C03,C03,FFF,FFF,C03,C03,C03,C03,C03   81159
C2       PAT   FFE,FFF,C03,C03,C06,FFC,FFC,C06,C03,C03,FFF,FFE   81159
C3       PAT   7FE,FFF,C03,C00,C00,C00,C00,C00,C00,C03,FFF,7FE   81159
C4       PAT   FF8,FFC,C06,C03,C03,C03,C03,C03,C03,C06,FFC,FF8   81159
C5       PAT   FFF,FFF,C00,C00,C00,FF0,FF0,C00,C00,C00,FFF,FFF   81159
C6       PAT   FFF,FFF,C00,C00,C00,FF0,FF0,C00,C00,C00,C00,C00   81159
C7       PAT   7FE,FFF,C03,C00,C00,C00,C1F,C1F,C03,C03,FFF,7FE   81159
C8       PAT   C03,C03,C03,C03,C03,FFF,FFF,C03,C03,C03,C03,C03   81159
C9       PAT   7FE,7FE,060,060,060,060,060,060,060,060,7FE,7FE   81159
         SPACE 1                                                 81159
D1       PAT   3FF,3FF,030,030,030,030,030,030,C30,C30,FF0,7E0   81159
D2       PAT   C03,C06,C0C,C18,C30,FE0,FE0,C30,C18,C0C,C06,C03   81159
D3       PAT   C00,C00,C00,C00,C00,C00,C00,C00,C00,C00,FFF,FFF   81159
D4       PAT   C03,E07,F0F,D9B,CF3,C63,C03,C03,C03,C03,C03,C03   81159
* OLD N  PAT   C03,E03,F03,D83,CC3,C63,C33,C1B,C0F,C07,C03,C01   81159
D5       PAT   C03,E03,F03,D83,CC3,C63,C33,C1B,C0F,C07,C03,C03   81159
D6       PAT   FFF,FFF,C03,C03,C03,C03,C03,C03,C03,C03,FFF,FFF   81159
D7       PAT   FFE,FFF,C03,C03,C03,FFF,FFE,C00,C00,C00,C00,C00   81159
D8       PAT   7FE,FFF,C03,C03,C03,C03,C03,C33,C1B,C0F,FFE,7FB   81159
D9       PAT   FFE,FFF,C03,C03,C03,FFF,FFE,C30,C18,C0C,C06,C03   81159
         SPACE 1                                                 81159
E0       PAT   000,0F8,000,1FC,3FE,603,603,603,603,603,3FE,1FC,P=F0
         SPACE 1                                                 81167
E2       PAT   7FE,FFF,C03,C00,E00,7FC,3FE,007,003,C03,FFF,7FE   81159
E3       PAT   FFF,FFF,060,060,060,060,060,060,060,060,060,060   81159
E4       PAT   C03,C03,C03,C03,C03,C03,C03,C03,C03,C03,FFF,7FE   81159
E5       PAT   C03,C03,C03,C03,C03,C03,C03,606,30C,198,0F0,060   81159
E6       PAT   C03,C03,C03,C03,C03,C03,C63,CF3,D9B,F0F,E07,C03   81159
E7       PAT   C03,C03,606,30C,198,0F0,0F0,198,30C,606,C03,C03   81159
E8       PAT   C03,C03,606,30C,198,0F0,060,060,060,060,060,060   81159
E9       PAT   FFF,FFF,006,00C,018,030,060,0C0,180,300,7FF,FFF   81159
         SPACE 1                                                 81159
F0       PAT   3FC,7FE,C03,C03,C03,C03,C03,C03,C03,C03,7FE,3FC   81159
F1       PAT   060,0E0,1E0,060,060,060,060,060,060,060,7FE,7FE   81159
F2       PAT   7FE,FFF,C03,003,003,006,018,060,180,600,FFF,FFF   81159
F3       PAT   7FE,FFF,C03,003,003,01E,01E,003,003,C03,FFF,7FE   81159
F4       PAT   038,078,0D8,198,318,7FF,FFF,018,018,018,018,018   81159
F5       PAT   FFF,FFF,C00,C00,C00,FF8,FFC,006,003,003,FFF,FFE   81159
F6       PAT   7FE,FFF,C03,C00,C00,FFE,FFF,C03,C03,C03,FFF,7FE   81159
F7       PAT   FFF,FFE,C0C,018,030,060,060,060,060,060,060,060   81159
F8       PAT   7FE,FFF,C03,C03,606,3FC,3FC,606,C03,C03,FFF,7FE   81159
F9       PAT   7FE,FFF,C03,C03,C03,FFF,FFF,003,003,C03,FFF,7FE   81159
         SPACE 1                                                 81159
X4A      PAT   000,000,000,060,3FC,7FE,C60,C60,C60,7FE,3FC,060,P=5B
X4B      PAT   000,000,000,000,000,000,000,000,060,0F0,0F0,060   81169
X4C      PAT   000,000,00F,03C,0F0,3C0,F00,3C0,0F0,03C,00F,000   81169
X4D      PAT   038,070,0E0,1C0,1C0,1C0,1C0,1C0,1C0,0E0,070,038   81169
X4E      PAT   000,000,000,060,060,3FC,3FC,060,060,000,000,000   81169
X4F      PAT   060,060,060,060,060,060,060,060,060,060,060,060   81169
X50      PAT   000,380,7C0,C60,C60,CC0,780,386,6EC,C38,FEE,7C7   81169
         SPACE 1                                                 81159
X5A      PAT   060,060,060,060,060,060,060,000,000,060,0F0,060,P=4F
X5B      PAT   050,7FE,FFF,C53,E50,7FC,3FE,057,C53,FFF,7FE,050   81169
X5C      PAT   000,000,000,060,666,1F8,060,1F8,666,060,000,000   81169
X5D      PAT   1C0,0E0,070,038,038,038,038,038,038,070,0E0,1C0   81169
X5E      PAT   000,070,0F8,0F8,070,000,000,070,0F8,0F8,038,070   81169
X5F      PAT   000,000,000,000,000,FFF,FFF,003,003,000,000,000   81169
X60      PAT   000,000,000,000,000,3FC,3FC,000,000,000,000,000   81169
X61      PAT   003,007,00E,01C,038,070,0E0,1C0,380,700,E00,C00   81169
         SPACE 1                                                 81159
X6A      PAT   060,060,060,060,060,000,000,060,060,060,060,060,P=4F
X6B      PAT   000,000,000,000,000,000,000,070,0F8,0F8,038,070   81169
X6C      PAT   703,887,70E,01C,038,070,0E0,1C0,380,70E,E11,C0E   81169
X6D      PAT   000,000,000,000,000,000,000,000,000,000,FFF,FFF   81169
X6E      PAT   000,000,F00,3C0,0F0,03C,00F,03C,0F0,3C0,F00,000   81169
X6F      PAT   1F8,3FC,C03,003,00C,030,060,060,000,060,0F0,060   81169
         SPACE 1                                                 81159
X77      PAT   000,39C,6F6,C63,C03,C03,606,30C,198,0F0,060,000,P=5C
X78      PAT   2AA,7FE,402,402,C93,C03,C63,402,4F2,402,7FE,3FC,P=D6
X79      PAT   FFF,7FF,303,180,0C0,060,060,0C0,180,303,7FF,FFF,P=E2
X7A      PAT   000,060,0F0,0F0,060,000,000,060,0F0,0F0,060,000   81169
X7B      PAT   000,198,198,FFF,FFF,198,198,FFF,FFF,198,198,000   81169
X7C      PAT   7FE,FFF,C03,003,3F3,7F3,C33,C33,C33,C33,7F3,3FE   81169
X7D      PAT   060,060,000,000,000,000,000,000,000,000,000,000   81169
X7E      PAT   000,000,000,000,FFF,FFF,000,000,FFF,FFF,000,000   81169
X7F      PAT   30C,30C,000,000,000,000,000,000,000,000,000,000   81169
         SPACE 2                                                 91052
*        PATTERNS
         SPACE 1                                                 81159
LINEPATN PAT   END,P=FOLD    EXPAND THE PATTERNS                 81167
         EJECT ,
         PRINT &PRTSOR                                           86064
*        CHARACTERS APPEARING IN THE TABLE BELOW WERE PATTERNED AFTER
*        THOSE IN THE PUBLIC DOMAIN VERSION OF U. OF WATERLOO'S SCRIPT.
*                                                                86064
CHARPAT8 EQU   *             START OF SMALL (8*8) PATTERNS       86064
C1       PAT   08,1C,36,63,63,7F,63,63,SIZE=8,SHOW=YES           86064
C2       PAT   7E,63,63,7E,63,63,63,7E                           86064
C3       PAT   3E,63,60,60,60,60,63,3E                           86064
C4       PAT   7E,63,63,63,63,63,63,7E                           86064
C5       PAT   7F,60,60,7C,60,60,60,7F                           86064
C6       PAT   7F,60,60,7C,60,60,60,60                           86064
C7       PAT   3E,63,60,60,67,63,63,3E                           86064
C8       PAT   63,63,63,7F,63,63,63,63                           86064
C9       PAT   3C,18,18,18,18,18,18,3C                           86064
D1       PAT   03,03,03,03,03,63,63,3E                           86064
D2       PAT   63,66,6C,78,78,6C,66,63                           86064
D3       PAT   60,60,60,60,60,60,60,7F                           86064
D4       PAT   41,63,77,7F,6B,63,63,63                           86064
D5       PAT   63,63,73,7B,6F,67,63,63                           86064
D6       PAT   3E,63,63,63,63,63,63,3E                           86064
D7       PAT   7E,63,63,63,7E,60,60,60                           86064
D8       PAT   3E,63,63,63,6B,67,63,3F                           86064
D9       PAT   7E,63,63,63,7E,6C,66,63                           86064
E2       PAT   3E,63,60,3E,03,63,63,3E                           86064
E3       PAT   FF,18,18,18,18,18,18,18                           86064
E4       PAT   63,63,63,63,63,63,63,3E                           86064
E5       PAT   63,63,63,63,63,36,1C,08                           86064
E6       PAT   63,63,63,63,6B,7F,77,22                           86064
E7       PAT   63,63,36,1C,1C,36,63,63                           86064
E8       PAT   63,63,63,36,1C,18,18,18                           86064
E9       PAT   7F,03,06,0C,18,30,60,7F                           86064
F0       PAT   1C,22,63,63,63,63,22,1C                           86097
F1       PAT   0C,1C,0C,0C,0C,0C,0C,1E                           86097
F2       PAT   3E,63,03,06,1C,60,60,7F                           86097
F3       PAT   3E,63,03,0C,03,03,63,3E                           86097
F4       PAT   06,0E,16,26,7F,06,06,06                           86097
F5       PAT   7F,60,60,7E,03,03,63,3E                           86097
F6       PAT   3E,63,60,7C,63,63,63,3E                           86097
F7       PAT   3F,03,03,06,0C,18,18,18                           86097
F8       PAT   3E,63,63,1C,63,63,63,3E                           86097
F9       PAT   3E,63,63,3F,03,03,63,3E                           86097
X4A      PAT   00,04,1F,34,64,34,1F,04,P=5B                      86097
X4B      PAT   00,00,00,00,00,18,18,00                           86064
X4C      PAT   04,08,10,20,20,10,08,04                           86097
X4D      PAT   08,10,20,20,20,20,10,08                           86064
X4E      PAT   00,00,08,08,7F,08,08,00                           86064
X4F      PAT   18,18,18,18,18,18,18,18                           86097
X50      PAT   38,7C,6C,38,3B,6E,7E,3B                           86097
X5A      PAT   18,18,18,18,18,00,18,18,P=4F                      86097
X5B      PAT   08,3E,6B,68,3E,0B,6B,3E                           86064
X5C      PAT   00,00,22,14,7F,14,22,00                           86064
X5D      PAT   10,08,04,04,04,04,08,10                           86064
X5E      PAT   00,18,18,00,18,18,08,10                           86097
X5F      PAT   00,00,00,7F,01,01,00,00                           86097
X60      PAT   00,00,00,00,7F,00,00,00                           86064
X61      PAT   01,03,06,0C,18,30,60,40                           86097
X6A      PAT   18,18,18,00,00,18,18,18,P=4F                      86097
X6B      PAT   00,00,00,00,18,18,08,10                           86064
X6C      PAT   61,63,06,0C,18,30,63,43                           86097
X6D      PAT   00,00,00,00,00,00,7F,7F                           86097
X6E      PAT   20,10,08,04,04,08,10,20                           86097
X6F      PAT   3E,63,06,0C,0C,00,0C,0C                           86097
X77      PAT   00,36,49,41,22,14,08,00,P=5C                      86152
X78      PAT   2A,7F,41,55,49,5D,41,3E,P=D6                      86152
X79      PAT   7F,33,18,0C,0C,18,33,7F,P=E2                      86097
X7A      PAT   00,00,0C,0C,00,0C,0C,00                           86097
X7B      PAT   36,36,7F,36,36,7F,36,36                           86064
X7C      PAT   3E,41,4D,15,25,45,45,3A                           86064
X7D      PAT   18,18,08,10,00,00,00,00                           86064
X7E      PAT   00,00,00,7F,00,7F,00,00                           86097
X7F      PAT   63,63,00,00,00,00,00,00                           86097
         SPACE 1                                                 86064
LINEPAT8 PAT   END,P=FOLD    EXPAND THE SMALLER PATTERNS         86064
         EJECT ,                                                 91052
         PRINT &PRTSOR                                           91052
*        VERY SMALL TABLE FOR TAPE LABELS (5*5 ON 5*6 GRID)      91052
CHARPAT5 EQU   *             START OF SMALL (5*5) PATTERNS       91052
C1       PAT   04,0A,11,1F,11,SIZE=5,SHOW=YES                    91052
C2       PAT   1E,11,1E,11,1E                                    91052
C3       PAT   0F,10,10,10,0F                                    91052
C4       PAT   1E,11,11,11,1E                                    91052
C5       PAT   1E,10,1C,10,1F                                    91052
C6       PAT   1E,10,1C,10,10                                    91052
C7       PAT   0E,10,13,11,0E                                    91052
C8       PAT   11,11,1F,11,11                                    91052
C9       PAT   0E,04,04,04,0E                                    91052
D1       PAT   0F,02,02,12,0C                                    91052
D2       PAT   11,12,1C,12,11                                    91052
D3       PAT   10,10,10,10,1E                                    91052
D4       PAT   11,1B,15,11,11                                    91052
D5       PAT   11,19,15,13,11                                    91052
D6       PAT   1F,11,11,11,1F                                    91052
D7       PAT   1E,11,1E,10,10                                    91052
D8       PAT   1F,11,15,12,1D                                    91052
D9       PAT   1E,11,1E,12,11                                    91052
E2       PAT   0F,10,0E,01,1E                                    91052
E3       PAT   1F,04,04,04,04                                    91052
E4       PAT   11,11,11,11,0E                                    91052
E5       PAT   11,11,11,0A,04                                    91052
E6       PAT   11,11,15,1B,11                                    91052
E7       PAT   11,0A,04,0A,11                                    91052
E8       PAT   11,0A,04,04,04                                    91052
E9       PAT   1F,02,04,08,1F                                    91052
F0       PAT   0E,11,11,11,0E                                    91052
F1       PAT   04,0C,04,04,0E                                    91052
F2       PAT   0E,11,02,04,0F                                    91052
F3       PAT   0E,01,06,01,0E                                    91052
F4       PAT   02,06,0A,1F,02                                    91052
F5       PAT   1E,10,1E,01,1E                                    91052
F6       PAT   0E,10,1E,11,0E                                    91052
F7       PAT   1F,02,04,04,04                                    91052
F8       PAT   0E,11,0E,11,0E                                    91052
F9       PAT   0E,11,0F,01,0E                                    91052
X4A      PAT   02,0F,12,0F,02,P=5B                               91052
X4B      PAT   00,00,00,06,06                                    91052
X4C      PAT   00,06,08,06,00                                    91052
X4D      PAT   03,08,08,08,03                                    91052
X4E      PAT   04,04,1F,04,04                                    91052
X4F      PAT   04,04,04,04,04                                    91052
X50      PAT   0C,14,0D,12,0D                                    91052
X5A      PAT   04,04,04,00,04,P=4F                               91052
X5B      PAT   0F,14,0E,05,1E                                    91052
X5C      PAT   11,0A,1F,0A,11                                    91052
X5D      PAT   0C,02,02,02,0C                                    91052
X5E      PAT   00,04,00,04,04                                    91052
X5F      PAT   00,00,0E,02,00                                    91052
X60      PAT   00,00,0E,00,00                                    91052
X61      PAT   01,02,04,08,10                                    91052
X6A      PAT   04,04,00,04,04,P=4F                               91052
X6B      PAT   00,00,00,06,02                                    91052
X6C      PAT   19,1A,04,0B,13                                    91052
X6D      PAT   00,00,00,00,1F                                    91052
X6E      PAT   00,0C,02,0C,00                                    91052
X6F      PAT   0C,12,04,00,04                                    91052
X77      PAT   0A,15,11,0A,04,P=5C                               91052
X78      PAT   15,1F,11,11,0E,P=D6                               91052
X79      PAT   1F,08,04,08,1F,P=E2                               91052
X7A      PAT   00,06,00,06,00                                    91052
X7B      PAT   0A,1F,0A,1F,0A                                    91052
X7C      PAT   0E,11,17,15,17                                    91052
X7D      PAT   06,06,00,00,00                                    91052
X7E      PAT   00,0E,00,0E,00                                    91052
X7F      PAT   0A,0A,00,00,00                                    91052
         SPACE 1                                                 91052
LINEPAT5 PAT   END,P=FOLD    EXPAND THE SMALLER PATTERNS         91052
         EJECT ,                                                 86064
         PRINT &PRTSOR                                           81159
*        WORKING STORAGE SECTION
CH5BY5   DC    A(P5OFF,P5TRAN,CHARPAT5,LINEPAT5)                 91058
         IC    R1,0(,R2)     INSERT PATTERN FOR THIS LINE        91052
         SLL   R1,31-5       ALIGN                               91052
         DC    Y(10,5,1,3,0)                                     91052
CH8BY8   DC    A(P8OFF,P8TRAN,CHARPAT8,LINEPAT8)                 91058
         IC    R1,0(,R2)     INSERT PATTERN FOR THIS LINE        91052
         SLL   R1,31-8       ALIGN                               91052
         DC    Y(10,8,1,4,0)                                     91052
CH12BY12 DC    A(P12OFF,P12TRAN,CHARPATN,LINEPATN)               91058
         ICM   R1,3,0(R2)    INSERT PATTERN FOR THIS LINE        91052
         SLL   R1,31-12      ALIGN                               91052
         DC    Y(10,12,2,7,1)                                    91052
         SPACE 1                                                 81159
SAVE     DSECT ,
OPTTAB   DS    0F            CHARACTER-SIZE DEPENDENT VALUES     86064
OPTTRANO DS    A             TRANSLATE PATTERN OFFSET            86064
OPTTRANT DS    A             TRANSLATE TABLE POINTER             86064
OPTCHART DS    A             CHARACTER LOOK-UP TABLE             86064
OPTPATT  DS    A             PATTERN LOOKUP TABLE                86064
OPTIC    DS    XL4           IC OR ICM INSTRUCTION               91052
OPTSLL   DS    XL4           SLL                                 91052
MAXCHPL  DS    H             MAXIMUM CHARACTERS PER LINE         86064
MAXLINE  DS    H             MAXIMUM LINES IN PATTERN            86064
SEPNO    DS    H
HADJ     DS    H             INCREMENT FOR HALF-ADJUST           86064
SCALE    DS    H             SLL VALUE FOR PATTERN SIZE          86064
OPTSIZE  EQU   *-OPTTAB      SIZE TO MOVE                        86064
         SPACE 1                                                 86064
FLAG1    DS    X             INITALLY SAME AS UFLAG1
CENTER   DS    CL19
RENTFLAG DS    X                                                 86064
FGRENT   EQU   X'01'           RE-ENTRANT ENTRY POINT            91052
SAVEEND  EQU   *
         SPACE 1                                                 86064
IEFSD095 CSECT ,                                                 86064
         DS    0D                                                86086
JESWORK  DC    XL(SAVEEND-SAVE-1)'0' NON-RENT WORK AREA          86064
         DC    X'00'         RENTFLAG OFF                        86064
         SPACE 2
*        INPUT DATA
         SPACE 1                                                 81159
DIN      DSECT ,
IN       DS    CL10
         SPACE 2
*        OUTPUT DATA SECTION
         SPACE 1                                                 81159
DOUT     DSECT ,
OUT      DS    10CL13   OR 9CL14  MAXIMUM
         SPACE 2
*        CONTROL INPUT
         SPACE 1                                                 81159
DCONT    DSECT ,
UCHARS   DS    X             =0 12*12; =1 8*8 SIZE; =2 5*5       91052
UFLAG1   DS    X             CONTROL FLAGS
FGNEG    EQU   X'01'           REVERSED (NEGATIVE) IMAGE
FGHALF   EQU   X'02'           INDENT HALF A CHARACTER WIDTH
FGCENT   EQU   X'04'           CENTER TEXT
FGBACK   EQU   X'08'           COPY CENTERED DATA AND FLAGS TO USER
FGMORE   EQU   X'80'           ANOTHER SET OF OPTIONS FOLLOWS    91052
UFLAG2   DS    X             MORE FLAGS                          91052
FGLEFT   EQU   X'02'           MAKE TEXT SLANT LEFT              91052
FGRITE   EQU   X'01'           MAKE TEXT SLANT RIGHT             91052
UNUM     DS    X             NO. OF INPUT CHARACTERS TO PROCESS  91052
         SPACE 1                                                 91052
UOBACK   DS    C             OPTIONAL BACKGROUND CHARACTER IF NOT 0
UOFORE   DS    C             OPTIONAL FOREGROUND CHARACTER IF NOT 0
UOSEP    DS    X             OPTIONAL CHARACTER SEPARATION       91052
         DS    XL5           SPARE                               91052
         END   ,

         MACRO ,
&NM      SERVCOMP &DSECT=YES,&PFX=WCM,                                 *
               &FG1=0,&FG2=0,&LINE#=0,&DELTA=1,                        *
               &BUFAD=0,&BUFMX=0,&RECAD=0,&RECMX=0,&CODAD=0      81263
         LCLC  &P,&NAME
&NAME    SETC  '&NM'
&P       SETC  'WCM'
         AIF   ('&NAME' NE '').HAVENM
&NAME    SETC  'SERVCOMP'
.HAVENM  AIF   ('&DSECT' NE 'YES').NOSECT
&NAME    DSECT ,
         AGO   .TESTP
.NOSECT  AIF   ('&NM' EQ '').TESTP
&NM      DS    0A .
.TESTP   AIF   ('&PFX' EQ '').HAVEP
&P       SETC  '&PFX'
.HAVEP   ANOP  ,
&P.BUFAD DC    A(&BUFAD)     CURRENT BLOCK ADDRESS
&P.BUFMX DC    AL2(&BUFMX)     MAXIMUM BLOCK SIZE
&P.BUFLN DC    H'0'            OFFSET TO NEXT LINE
&P.RECAD DC    A(&RECAD)     CURRENT RECORD ADDRESS
&P.RECMX DC    AL2(&RECMX)     MAXIMUM RECORD LENGTH
&P.RECLN DC    H'0'            CURRENT RECORD LENGTH
&P.CODAD DC    A(&CODAD)     ADDRESS OF CODE WORD OR ZERO
&P.LINE# DC    A(&LINE#)       CURRENT LINE NUMBER (BINARY)
&P.LINEB DC    CL8' '          CURRENT LINE NUMBER (EBCDIC)
&P.LINEP DC    A(&LINE#-&DELTA)  PREVIOUS LINE NUMBER
&P.DELTA DC    A(&DELTA)     LINE NUMBERING INCREMENT (FWD)
&P.FG1   DC    AL1(&FG1)     PROCESSING FLAGS
&P.F1NIH EQU   X'80'           NIH FORMAT
&P.F1OSI EQU   X'40'           OSI FORMAT (X'80' IN LINE# FOR FWD)
&P.F1HWD EQU   X'20'           HALF-WORD LINE # (RAND, ETC.)
&P.F1INT EQU   X'10'           NUMBER IN CL8 FORMAT
&P.F1EDT EQU   X'08'           NUMBER IN 4C.3C FORMAT
&P.F1TSO EQU   X'04'           LEFT-ADJUSTED LINE NUMBERS
&P.F1LCC EQU   X'02'           RETURN CARR.CONTROL/LINE/TEXT (+F1TSO)
&P.F1NB# EQU   X'01'           INSERT NUMBERS EVEN IF NON-BLANK
&P.FG2   DC    AL1(&FG2)     CONTROL FLAGS
&P.F2NPR EQU   X'80'           NO LINE DECOMPRESSION (REBLOCK)
&P.F2RDW EQU   X'40'           V-FORMAT RECORD RETURNED
&P.F2COD EQU   X'02'           CODE WORD CHECKED
&P.F2PSW EQU   X'01'           ENCRYPTION/DECRYPTION REQUIRED
&P.FG3   DC    X'00'         NEW NIH LINE FLAGS
&P.F3RAW EQU   X'80'           UNCOMPRESSED RECORD
&P.F3L16 EQU   X'40'           16-BIT LENGTH FIELD
&P.F3NSP EQU   X'20'           NO SPECIAL CONTROL CHARACTERS
&P.F3MRK EQU   X'10'           LINE IS FLAGGED 'CHANGED'
&P.F308  EQU   X'08'             RESERVED
&P.F3NIF EQU   X'F8'           ALL NEW NIH FLAG BITS
&P.F3NIH EQU   X'04'           COPY OF NIH FORMAT FLAG
&P.LINEH DC    C' '         SPILL BYTE FOR EDIT LINE OVERFLOW
         MEND  ,

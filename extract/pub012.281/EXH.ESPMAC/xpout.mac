         MACRO
&NM      XPOUT &MSG,&LEN,&CASE=
         AIF   ('&MSG' EQ '' AND '&LEN' EQ '').MORE
         AIF   ('&MSG' NE '').NOL
&NM      XREAD EXMORE,BAL=EXCPELL,ERR=,CASE=&CASE  'MORE' MESSAGE
         MEXIT
.NOL     ANOP
&NM      XREAD &MSG,&LEN,BAL=EXCPELL,ERR=,CASE=&CASE SUPPLIED MESSAGE
         MEXIT
.MORE    ANOP
&NM      XREAD (R2),(R3),BAL=EXCPOUT,ERR=,CASE=&CASE 'MORE' MESSAGE
         MEND

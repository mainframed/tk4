         MACRO ,
&NM      BASRET &POP,&TYPE=BSM,&RS=R0,&RE=R15,&VECT=0
&NM      SH    R13,=Y(LOCSAVE1-LOCSAVE)  POP THE STACK
         AIF   ('&POP' EQ '*NO').POP
         AIF   ('&VECT' EQ '0').BSM0
         LA    R9,&VECT      GET RETURN OFFSET
         A     R9,4*R9+8(R13) ADJUST RETURN
         ST    R9,4*R9+8(R13) ADJUST RETURN
.BSM0    LM    &RS,&RE,4*&RS+8(R13)  RESTORE CALLER'S REGISTERS
         RET31 R9            RETURN IN CALLER'S MODE
         MEXIT ,
.POP     LM    &RS,&RE,4*&RS+8(R13)  RESTORE CALLER'S REGISTERS
         MEND  ,

         MACRO
&NM      XLINPG &MSG,&LEN,&CASE=,&ENTER=                    NEW GP13012
         GBLC  &MACPLAB
.*  WRITE A PAGE AND GET A RESPONSE.
.*  USED WITH XLINE SERVICE WHEN COLOR OR HIGH-LIGHTING ARE USED
.*
         LCLA  &M
         LCLC  &MS,&L
&M       SETA  &SYSNDX
&L       SETC  'L'''
&MS      SETC  '&MSG'
         AIF   ('&MS' NE '').HAVEMS
&MS      SETC  'EXMORE'
.HAVEMS  ANOP  ,
&NM      MACPARM R2,&MS
         MACPARM R3,&LEN,NULL=&L&MS
.*  XLINPG WRITES A FULL PAGE + A MESSAGE
.*  (2) POINTS TO MESSAGE
.*  (3) HAS MESSAGE LENGTH ( 0 < (3) < 81 )
.*
         MACPARM R15,(R3)    GET LENGTH
         L     R14,EXWSMEND  GET ADDRESS OF MESSAGE BUFFER
         AL    R3,EXWSMEND   GET LENGTH OF SCREEN SIZE + MESSAGE
         SL    R3,BUFAD      GET LENGTH OF SCREEN SIZE + MESSAGE
         SH    R3,BUFSIZ     FINAGLE
         MVC   REPLY,BLANKS  CLEAR INPUT
         BAL   R9,EXCPAGE+4  BRANCH TO COMMON WRITE
           B   EXCWERR         WRITE ERROR
         BAL   R9,EXCPEWRD   WAIT AND READ
         MACPARM &ENTER,NULL=SKIP,MODE=ONE,OP=B,OPR=BR
         MEND

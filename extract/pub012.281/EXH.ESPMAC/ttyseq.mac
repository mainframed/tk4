         MACRO ,
&NM      TTYSEQ &FUN,&TYPE,&HAVE=,&ERR=                 ADDED ON 84106
         GBLC  &MACPLAB
         PUSH  USING
&MACPLAB SETC  '&NM'
         MACPARM R0,&FUN     LOAD FUNCTION REQUEST
         TTYFLAGS ,          EXPAND OPTION FLAG MAPPING
         AIF   (T'&TYPE EQ 'O').HATYP
         AIF   ('&TYPE'(1,1) NE '(').HATYP
         AIF   ('&TYPE'(2,1) EQ '(').HATYP
         MACPARM R15,&TYPE
         MACPARM R15,24,OP=SLL
         MACPARM R0,(R15),OPR=OR
         AGO   .PATYP
.HATYP   ANOP  ,
         MACPARM R0,8,&TYPE,MODE=THREE,NULL=SKIP,OP=ICM         GP02241
.PATYP   AIF   ('&HAVE' EQ 'CVT' OR '&HAVE' EQ 'UCV' OR                *
                '&HAVE' EQ 'VOLT').HACVT
         AIF   (T'&HAVE EQ 'O').NOHA
         MNOTE 4,'INVALID HAVE= PARAMETER IGNORED'
.NOHA    ANOP  ,
&MACPLAB MACPARM R15,CVTPTR,OP=L  GET CVT POINTER
         USING CVTMAP,R15
.HACVT   AIF   ('&HAVE' EQ 'UCV' OR '&HAVE' EQ 'VOLT').HAUCV
         MACPARM R15,CVTUSER,OP=L  GET USER CVT
         USING USERCVT,R15
.HAUCV   AIF   ('&HAVE' EQ 'VOLT').HAVOLT
         MACPARM R15,UCLVOLT,OP=L
         USING USERVOLT,R15
.HAVOLT  ANOP  ,
         MACPARM R15,VTTTYSEQ,OP=L
         BASR  R14,R15
         MACPARM &ERR,NULL=SKIP,MODE=ONE,OP=BZ,OPR=BZR          GP02241
         POP   USING
         MEND  ,

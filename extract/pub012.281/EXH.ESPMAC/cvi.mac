         MACRO
&NM      CVI   &R,&AD,&LEN                                  NEW GP09347
.*   THIS MACRO CONVERTS AN INTEGER TO PRINTABLE FORM. EXPECTED
.*   OUTPUT LENGTH IS 7. VALUES BELOW 1 MILLION ARE SHOWN WITH
.*   A COMMA; LARGER VALUES AS TRUNCATED K WITH NO COMMAS.
.*
         GBLB  &INLINE(50)
&INLINE(8) SETB 1            REQUEST ICONVERT EXPANSION
         LCLC  &L
&L       SETC  'L'''
         AIF   (T'&R EQ 'H').LH
&NM      MACPARM R0,&R,OP=L
         AGO   .COM
.LH      ANOP  ,
&NM      MACPARM R0,&R,OP=LH
.COM     MACPARM R1,&AD
         MACPARM R15,&LEN,NULL=&LEN&AD
         MACPARM R14,ICONVERT,OP=BAL
         MEND

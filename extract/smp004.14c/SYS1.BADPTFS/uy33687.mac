++ PTF (UY33687)        /*    5752-SC1T3-ETI1106-SCP
//UY33687  JOB 5752-33687-0,SC1T3,MSGLEVEL=(1,1),CLASS=A     */  .
++ VER (Z038)
   FMID(ETI1106)
   SUP  (UZ80061,UZ79918,UZ71324,UZ70162,UZ67858,UZ67182,
         UZ62920,UZ60488,UZ57216,UZ56850,UZ56385,UZ55217,
         UZ53201,UZ53089,UZ46760,UZ45903,UZ44846,UZ44753,
         UZ42856,UZ40881,UZ36512,UZ36424,UZ34452,UZ33085,
         UZ31096,UZ31094,UZ30398,UZ29589,UZ29483,UZ29403,
         UZ28843,UZ28545,UZ27854,UZ23353,UY31757,UY30714,
         UY28057,UY15877,UY06435,BZ61617,BZ49617,BZ48875,
         BZ48113,BZ46729,AZ91352,AZ90546,AZ90350,AZ89425,
         AZ87114,AZ85318,AZ84890,AZ76414,AZ72869,AZ72316,
         AZ67665,AZ65329,AZ62047,AZ61617,AZ59270,AZ57305,
         AZ56745,AZ56262,AZ51683,AZ50214,AZ49617,AZ49608,
         AZ48875,AZ48113,AZ46729,AZ46377,AZ45384,AZ44765,
         AZ44359,AZ43490,AZ43223,AZ43111,AZ42972,AZ42197,
         AZ39784,AZ36819,AZ34273,AZ28922,AY20024,AY19005,
         AY18808,AY16630,AY09829,AY02233)                  .
++ IF FMID(HDP2230) THEN REQ (UY05048)                     .
++ IF FMID(JDP2220) THEN REQ (UY05049)                     .
++ IF FMID(HDP2210) THEN REQ (UY05050)                     .
++ IF FMID(JDP1111) THEN REQ (UY05051)                     .
++ IF FMID(JDP1110) THEN REQ (UY05052)                     .
++ IF FMID(JDS1125) THEN REQ (UY05053)                     .
++ IF FMID(HDQ1102) THEN REQ (UY05054)                     .
++ IF FMID(HTC3104) THEN REQ (UY06653)                     .
++ IF FMID(JTC2412) THEN REQ (UZ46759,UY15705,UY05438)     .
++ IF FMID(ETC0108) THEN REQ (UZ54066,UZ23355)             .
++ IF FMID(JTC2212) THEN REQ (UZ54071)                     .
++ IF FMID(JTC2312) THEN REQ (UZ54072)                     .
++ IF FMID(ETC1102) THEN REQ (UZ23354)                     .
++ IF FMID(ETV0108) THEN REQ (UZ23543)                     .
++ IF FMID(EVT1102) THEN REQ (UZ23544)                     .
++ IF FMID(JTC2112) THEN REQ (UZ29094)
 /*
   PROBLEM DESCRIPTION(S):
     OY20024 -
       ADD JCLIN TO TIOC.

   COMPONENT:  5752-SC1T3-ETI1106
   APARS FIXED: OY20024
   SPECIAL CONDITIONS:
     ACTION:
       A "CLPA" MUST BE PERFORMED AT IPL TIME FOR THIS PTF TO BECOME
       ACTIVE.
     ACTION:
       A SYSGEN OF THE OPERATING SYSTEM IS NECESSARY TO ACTIVATE THIS
       CHANGE.
     ACTION:
       USERS WITH PROGRAMS USING TPUT OR TGET MAY NEED TO REASSEMBLE
       FOLLOWING THIS PTF.
     ACTION:
       REASSEMBLY OF APPLICATIONS WHICH USE THE TSB MAY BE REQUIRED
     ACTION:
       RE-ASSEMBLY OF THE TSO USERS PROGRAM MAY BE NECESSARY TO
       ACTIVATE THIS PTF IF THE MACRO(S) INCLUDED ARE USED.
   COMMENTS:
     CROSS REFERENCE-MODULE/MACRO NAMES TO APARS
      ETI1106J  OY20024
      GTSIZE    OY20024
      GTTERM    OY20024
      IEDAY3    OY20024
      IEDAY8    OY20024
      IGC0009C  OY20024
      IGC0009D  OY20024
      IGG019TX  OY20024
      IGG019TY  OY20024
      IGG019TZ  OY20024
      IGG019T3  OY20024
      IGG019T4  OY20024
      IGG019T5  OY20024
      IGG019T6  OY20024
      IGG019T7  OY20024
      IGG019T8  OY20024
      IGG0196S  OY20024
      IKJTIOCP  OY20024
      IKJTSB    OY20024
      IKJXSA    OY20024
      RTAUTOPT  OY20024
      SGIKJ4EC  OY20024
      SGIKJ5EC  OY20024
      SPAUTOPT  OY20024
      STATTN    OY20024
      STAUTOCP  OY20024
      STAUTOLN  OY20024
      STBREAK   OY20024
      STCC      OY20024
      STCLEAR   OY20024
      STCOM     OY20024
      STSIZE    OY20024
      STTIMEOU  OY20024
      STTMPMD   OY20024
      TCLEARQ   OY20024
      TGET      OY20024
      TPG       OY20024
      TPUT      OY20024

     CROSS REFERENCE-APARS TO MODULE/MACRO NAMES
      OY20024   ETI1106J GTSIZE   GTTERM   IEDAY3   IEDAY8   IGC0009C
                IGC0009D IGG019TX IGG019TY IGG019TZ IGG019T3 IGG019T4
                IGG019T5 IGG019T6 IGG019T7 IGG019T8 IGG0196S IKJTIOCP
                IKJTSB   IKJXSA   RTAUTOPT SGIKJ4EC SGIKJ5EC SPAUTOPT
                STATTN   STAUTOCP STAUTOLN STBREAK  STCC     STCLEAR
                STCOM    STSIZE   STTIMEOU STTMPMD  TCLEARQ  TGET
                TPG      TPUT

     THE FOLLOWING MODULES AND/OR MACROS ARE AFFECTED BY THIS PTF:

     MODULES
      IEDAY3
      IEDAY8
      IGC0009C
      IGC0009D
      IGG019TX
      IGG019TY
      IGG019TZ
      IGG019T3
      IGG019T4
      IGG019T5
      IGG019T6
      IGG019T7
      IGG019T8
      IGG0196S

     MACROS
      GTSIZE
      GTTERM
      IKJTIOCP
      IKJTSB
      IKJXSA
      RTAUTOPT
      SGIKJ4EC
      SGIKJ5EC
      SPAUTOPT
      STATTN
      STAUTOCP
      STAUTOLN
      STBREAK
      STCC
      STCLEAR
      STCOM
      STSIZE
      STTIMEOU
      STTMPMD
      TCLEARQ
      TGET
      TPG
      TPUT

     LISTEND
 */.
++ HOLD(UY33687) SYS FMID(ETI1106) REASON(ACTION) DATE(89032)
   COMMENT
    (A "CLPA" MUST BE PERFORMED AT IPL TIME FOR THIS PTF TO BECOME
     ACTIVE.
     A SYSGEN OF THE OPERATING SYSTEM IS NECESSARY TO ACTIVATE THIS
     CHANGE.
     USERS WITH PROGRAMS USING TPUT OR TGET MAY NEED TO REASSEMBLE
     FOLLOWING THIS PTF.
     REASSEMBLY OF APPLICATIONS WHICH USE THE TSB MAY BE REQUIRED
     RE-ASSEMBLY OF THE TSO USERS PROGRAM MAY BE NECESSARY TO
     ACTIVATE THIS PTF IF THE MACRO(S) INCLUDED ARE USED.).
++ JCLIN .
//LKED40X  EXEC  PGM=IEWL,PARM='LET,LIST,XREF,RENT,REFR'
//SYSPRINT  DD  SYSOUT=A
//SYSLMOD  DD  UNIT=3330-1,DISP=OLD,VOL=SER=TCAM12,DSN=SYS1.LPALIB
//AOST3    DD  UNIT=3330-1,DISP=OLD,VOL=SER=DLIB01,DSN=SYS1.AOST3
//SYSUT1  DD  SPACE=(CYL,(5,5)),UNIT=SYSDA,DISP=(,DELETE)
//SYSLIN DD  *
 INCLUDE AOST3(IGC0009D)
 INCLUDE SYSLMOD(IGC0009D)
 ENTRY IGC0009D    ***  EXPECT IEW0461I FOR THE FOLLOWING:     ***     X
                *** IF NO TCAM-IGG0940H. IF NO VTAM- IKT0009D. ***     X
                *** IF NO SESSION MANAGER- IKTTMPX2.
 NAME IGC0009D(R)
 INCLUDE AOST3(IGC0009C)
 INCLUDE SYSLMOD(IGC0009C)
 ENTRY IGC0009C    ***  EXPECT IEW0461 FOR THE FOLLOWING:      ***     X
                *** IF NO TCAM-IGG09300. IF NO VTAM-IKT0009C.  ***     X
                *** IF NO SESSION MANAGER- IKTTMPX1
 NAME IGC0009C(R)
/*
//LPA EXEC PGM=IEBCOPY
//SYSUT3 DD DSN=&SYSUT3,SPACE=(1700,(10,5)),UNIT=SYSDA
//SYSUT4 DD DSN=&SYSUT4,SPACE=(460,(30,24)),UNIT=SYSDA
//SYSPRINT DD SPACE=(3630,(500,100),RLSE),
//        DCB=(RECFM=FB,LRECL=121,BLKSIZE=121,SYSOUT=R
//LPALIB  DD DSN=SYS1.LPALIB,DISP=SHR
//MACLIB  DD DSN=SYS1.MACLIB,DISP=SHR
//AOST3  DD DSN=SYS1.AOST3,DISP=SHR
//ATSOMAC DD DSN=SYS1.ATSOMAC,DISP=SHR
//SYSIN  DD *
 COPY OUTDD=LPALIB,INDD=AOST3
 SELECT MEMBER=(IGG019TX)
 SELECT MEMBER=(IGG019TY,IGG019TZ,IGG019T3,IGG019T4)
 SELECT MEMBER=(IGG019T5,IGG019T6,IGG019T7,IGG019T8)
 SELECT MEMBER=(IGG0196S,IEDAY3,IEEDAY3)
 COPY INDD=ATSOMAC,OUTDD=MACLIB
/*
++ MAC      (GTSIZE  ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
.* NOCHANGE SHIPPED WITH JCLIN                                 @OY20024
&NAME    GTSIZE &A                      PROTOTYPE
         AIF   (N'&SYSLIST EQ 0).PARMOK      IS OPERAND BLANK
.PARMBAD ANOP
         IHBERMAC 238
.* THIS CALL TO ERMAC SAYS 'EXCESS POSITIONAL PARMS.' NONE ARE ALLOWED.
         MEXIT                          EXIT
.PARMOK  ANOP
&NAME    SR    1,1                      PREPARE PARM
         LA    0,11                     LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN LEFT MOST
         SVC   94                       ISSUE SVC
         MEND
++ MAC      (GTTERM  ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    GTTERM &PRMSZE=,&ALTSZE=,&ATTRIB=,&MF=I               @G76XRYU
.* A000000-999999                                              @G76XR00
.* A034000                                                     @OZ90350
.* NOCHANGE SHIPPED WITH JCLIN                                 @OY20024
.*
         LCLC  &NDX                                            @G76XRYU
&NDX     SETC  '&SYSNDX'                                       @G76XRYU
         AIF   ('&MF' EQ 'I' AND '&PRMSZE' EQ '' AND '&ATTRIB' EQ '').E-
               RROR1                                           @G76XRYU
         AIF   ('&MF' EQ 'L').LFORM
         AIF   ('&MF(1)' EQ 'E').EFORM
         AIF   ('&MF' NE 'I').ERROR2
.*********************I -FORM OF MACRO*********************************
&NAME    CNOP  0,4
         BAL   1,*+16                   BRANCH AROUND PARMS    @G76XRYU
GTRM&NDX DC    A(0)                     ADDRESS OF PRIMARY     @G76XRYU
         DC    A(0)                     ADDRESS OF ALTERNATE
         DC    A(0)                     ADDRESS OF ATTRIBUTE   @G76XRYU
         AGO   .STADDR
.EFORM   ANOP
&NAME    CNOP  0,4                                             @OZ90350
         IHBOPLST ,,&NAME,MF=&MF
.STADDR  ANOP
.*********COMMON CODE FOR BOTH I AND E FORM OF MACRO******************
         AIF   ('&PRMSZE' EQ '').LABEL2
         AIF   ('&PRMSZE'(1,1) NE '(').LOADPRM
         ST    &PRMSZE(1),0(,1)         STORE PRIMARY ADDRESS
         AGO   .LABEL2
.LOADPRM ANOP
         AIF   ('&PRMSZE'(K'&PRMSZE,1) EQ ')' OR '&MF' NE 'I').LPARM
         ORG   GTRM&NDX                 PUT ADDR OF PRIMARY    @G76XRYU
         DC    A(&PRMSZE)               IN PARM LIST           @G76XRYU
         ORG
         AGO   .LABEL2                                         @G76XRYU
.LPARM   ANOP                      ..LA ADDR OR EXECUTE FORM   @G76XRYU
         LA    0,&PRMSZE                LOAD ADDRESS OF PRIMARY
         ST    0,0(,1)                  STORE ADDRESS OF PRIMARY
.LABEL2  ANOP
         AIF   ('&ALTSZE' EQ '').IEATRCK                       @G76XRYU
         AIF   ('&ALTSZE'(1,1) NE '(').LOADALT
         ST    &ALTSZE(1),4(,1)         STORE ADDRESS OF ALTERNATE
         AGO   .IEATRCK                                        @G76XRYU
.LOADALT ANOP
         AIF   ('&ALTSZE'(K'&ALTSZE,1) EQ ')' OR '&MF' NE 'I').LAALT
         ORG   GTRM&NDX+4               PUT ALTERNATE SIZE     @G76XRYU
         DC    A(&ALTSZE)               IN PARM LIST           @G76XRYU
         ORG
         AGO   .IEATRCK                                        @G76XRYU
.LAALT   ANOP                     ...LA ADDR OR EXECUTE FORM   @G76XRYU
         LA    0,&ALTSZE                LOAD ADDR OF ALTERNATE @G76XRYU
         ST    0,4(,1)                  STORE ADD OF ALTERNATE @G76XRYU
.*  PROCESS ATTRIBUTE PARM FOR I AND E FORMS WHEN NOT NULL     @G76XRYU
.IEATRCK ANOP                                                  @G76XRYU
         AIF   ('&ATTRIB' EQ '').SVCENTY                       @G76XRYU
         AIF   ('&ATTRIB'(1,1) EQ '(').REGATR                  @G76XRYU
         AIF   ('&ATTRIB'(K'&ATTRIB,1) EQ ')' OR '&MF' NE 'I').LAATRIB
         ORG   GTRM&NDX+8               PUT ATTRIB BYTE ADDR   @G76XRYU
         DC    A(&ATTRIB)               IN PARM LIST           @G76XRYU
         ORG
         AGO   .SVCENTY                                        @G76XRYU
.LAATRIB ANOP                       .. LA ADDR OR EXECUTE FORM @G76XRYU
         LA    0,&ATTRIB                GET ADR OF ATTRIB BYTE @G76XRYU
         ST    0,8(1)                   PUT IN 3RD PARM WORD   @G76XRYU
         AGO   .SVCENTY                                        @G76XRYU
.REGATR  ANOP                                                  @G76XRYU
         ST    &ATTRIB(1),8(1)          REG => 3RD PARM WORD   @G76XRYU
.SVCENTY ANOP
         OI    8(1),128                 END OF LIST INDICATOR  @G76XRYU
         LA    0,17                     ENTRY CODE
         SLL   0,24                     SHIFT TO HIGH ORDER BYTE
         SVC   94                       ISSUE SVC
         MEXIT
.***************  L  - FORM  ***************************
.LFORM   ANOP
&NAME    DS    0F
         AIF   ('&PRMSZE' EQ '').NOPRMAD
         AIF   ('&PRMSZE'(1,1) EQ '(').NOPRMAD
         DC    A(&PRMSZE)               ADDRESS OF PRIMARY PARM ADDR
         AGO   .CHKALT
.NOPRMAD ANOP
         DC    A(0)                     ADDRESS OF PRIMARY PARM ADDR
.CHKALT  AIF   ('&ALTSZE' EQ '').NOALTAD
         AIF   ('&ALTSZE'(1,1) EQ '(').NOALTAD
         DC    A(&ALTSZE)               ADDRESS OF ALTERNATE ADDR
         AGO   .LATTCK                                         @G76XRYU
.NOALTAD ANOP
         DC    A(0)                     ADDR OF ALTERNATE      @G76XRYU
.*  PROCESS ATTRIBUTE PARM FOR LIST FORM                       @G76XRYU
.LATTCK  ANOP                                                  @G76XRYU
         AIF   ('&ATTRIB' NE '').CKATTR                        @G76XRYU
         DC    A(0)                     L-FORM--ATTRIB BYTE    @G76XRYU
         MEXIT                                                 @G76XRYU
.CKATTR  ANOP                                                  @G76XRYU
         AIF   ('&ATTRIB'(1,1) NE '(').ATTROK                  @G76XRYU
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L AND ATTRIB=&ATTRI*
               B'                                              @G76XRYU
         MEXIT                                                 @G76XRYU
.ATTROK  ANOP                                                  @G76XRYU
         DC    A(&ATTRIB)               L-FORM--A(ATTR BYTE)   @G76XRYU
         MEXIT
.ERROR1  ANOP
         IHBERMAC 1006,PRMSZE
         MEXIT
.ERROR2  IHBERMAC 54,,&MF
         MEXIT
         MEND
++ MOD      (IEDAY3  ) DISTLIB(AOST3   )
                                      TALIAS(IEEDAY3 )
 LEPARM (LIST,NCAL,REFR,RENT,XREF,LET) .
ESD      
TXT 
TXT 
TXT 
RLD      
END                            1566896201 020189032
  IDENTIFY IEDAY3('UY33687')
  SETSSI 01113687
++ MOD      (IEDAY8  ) DISTLIB(AOST3   )
                                      TALIAS(IEDAY802) LMOD(IGC0001C)
  .
ESD      
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END                            1566896201 020189032
  IDENTIFY IEDAY8('UY33687')
  SETSSI 01113687
++ MOD      (IGC0009C) DISTLIB(AOST3   )
  .
ESD      
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END                            1566896201 020189032
  IDENTIFY IGC0009C('UY33687')
  SETSSI 01113687
++ MOD      (IGC0009D) DISTLIB(AOST3   )
  .
ESD      
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END                            1566896201 020189032
  IDENTIFY IGC0009D('UY33687')
  SETSSI 01113687
++ MOD      (IGG019TX) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019TX('UY33687')
  SETSSI 01113687
++ MOD      (IGG019TY) DISTLIB(AOST3   )
  .
ESD      
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019TY('UY33687')
  SETSSI 01113687
++ MOD      (IGG019TZ) DISTLIB(AOST3   )
  .
ESD      
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019TZ('UY33687')
  SETSSI 01113687
++ MOD      (IGG019T3) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019T3('UY33687')
  SETSSI 01113687
++ MOD      (IGG019T4) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019T4('UY33687')
  SETSSI 01113687
++ MOD      (IGG019T5) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019T5('UY33687')
  SETSSI 01113687
++ MOD      (IGG019T6) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019T6('UY33687')
  SETSSI 01113687
++ MOD      (IGG019T7) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019T7('UY33687')
  SETSSI 01113687
++ MOD      (IGG019T8) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG019T8('UY33687')
  SETSSI 01113687
++ MOD      (IGG0196S) DISTLIB(AOST3   )
  .
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END                            1566896201 020189032
  IDENTIFY IGG0196S('UY33687')
  SETSSI 01113687
++ MAC      (IKJTIOCP) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
         IKJTIOCP &LIST=NO
TIOCRPT  DSECT
***********************************************************************
*
*
*        THE TIOC REFERENCE POINTER TABLE CONTAINS INFORMATION REQUIRED
*        BY THE TIOC TO MANAGE THE TERMINALS.  IT RESIDES
*        IN THE COMMON AREA AND IS CREATED AND INITIALIZED BY
*        TIOC INITIALIZATION.
*
*        UPDATING OF FIELDS IN THIS CONTROL BLOCK MUST BE
*        SYNCHRONIZED BY HOLDING THE CMS LOCK, EXCEPT FOR
*        THE FOLLOWING FIELDS WHICH MUST BE UPDATED USING
*        COMPARE AND SWAP:
*
*              TIOCUSCT
*
*
*/*MACMEAN TIOCRPT MEANS TERMINAL INPUT/OUTPUT COORDINATOR REFERENCE */
*/*                      POINTER TABLE                               */
*/*MACCOMP Y-2 SC1T3/SJE85                                           */
*/*MACSTAT Y-2 72304/029010                                          */
* C518000,729000                                               @OZ62047
* NOCHANGE SHIPPED WITH JCLIN                                  @OY20024
*
***********************************************************************
         AIF   ('&LIST' EQ 'YES').L10
*
*        SPECIFY LIST=YES ON THE MACRO CALL TO OBTAIN A LISTING
*
         PUSH  PRINT
         PRINT OFF
.L10     ANOP
TIOCQTIP DS    A .                      BRANCH ENTRY POINT TO QTIP
TIOCNBF  DS    CL2 .                    NUMBER OF TS BUFFERS
TIOCNFBF DS    CL2 .                    NUMBER OF TS BFRS ON FREE QUEUE
TIOCBFSZ DS    CL2 .                    TS BUFFER SIZE - IN BYTES
TIOCNTSB DS    CL2 .                    NO. OF TSB'S
TIOCQRET DS    A .                      QTIP RETURN ADDRESS
TIOCOWTH DS    CL2 .                    OWAIT THRESHOLD
TIOCRSTH DS    CL2 .                    RESTART THRESHOLD
TIOCFLG  DS    X .                      FLAG BYTE
*                       BIT DEFINITIONS
*        BITS  5-7                      RESERVED
TIOCSYLW EQU   X'80' .                  SYSTEM IS IN LWAIT
TIOCTSAB EQU   X'40' .                  TIME SHARING ENDING ABNORMALLY
TIOCSTOP EQU   X'20' .                  STOP TS REQUESTED
TIOCTJBF EQU   X'10' .                  TPUT W/TJID FOUND NO TS BUFFERS
TIOCNOBF EQU   X'08' .                  TPUT FOUND NO TS BUFFERS ON
*                                       EITHER FREE OR OUTPUT QUEUE
TIOCQTKY DS    CL1 .                    KEY OF QTIP CALLER
TIOCUSCT DS    H .                      TIOC USER COUNT
TIOCAOMX DS    CL2 .                    CURRENT MAXIMUM NO. OF OUTPUT
*                                       BUFFERS ALLOWED EACH TERMINAL
TIOCAIMX DS    CL2 .                    CURRENT MAXIMUM NO. OF INPUT
*                                       BUFFERS ALLOWED EACH TERMINAL
TIOCUSLW DS    CL2 .                    NO. OF BFRS THAT ARE RESERVED
*                                       ON THE FREE QUEUE.  LESS THAN
*                                       THIS AMOUNT RESULTS IN A
*                                       SYSTEM-WIDE LWAIT
*
TIOCNBFL DS    H .                      NO. OF FREE BUFFER LISTS
TIOCTSBS DS    X .                      SIZE OF TSB'S
TIOCTSB  DS    AL3 .                    ADDRESS OF THE TSB TABLE
TIOCSAVE DS    CL72 .                   REGISTER SAVE AND WORK AREA
TIOCTECB DS    F .                      TIME INTERVAL ECB
TIOCRCLM DS    H .                      RECONNECT LIMIT (MINUTES)
         DS    H .                      RESERVED
TIOCLDS  DS    A                        LINE DISCONNECT SUBTASK TCB
TIOCLIST DS    A                        ADDR OF LIST FOR SNAP  @OZ62047
TIOCFBFL DS    A .                      FREE BUFFER LIST(S).
*                                       ONE LIST FOR EACH PAGE
*                                       CONTAINING TIOC BUFFERS.
*                                       AN EMPTY LIST IS INDICATED
*                                       BY THE COMPLEMENTED ADDRESS
*                                       OF A BUFFER ON THAT PAGE.
*
*        *************************************************************
*    0   *                         TIOCQTIP                          *
*        *************************************************************
*    4   *           TIOCNBF           *           TIOCNFBF          *
*        *************************************************************
*    8   *           TIOCBFSZ          *           TIOCNTSB          *
*        *************************************************************
*   12   *                         TIOCQRET                          *
*        *************************************************************
*   16   *           TIOCOWTH          *           TIOCRSTH          *
*        *************************************************************
*   20   *   TIOCFLG    *   TIOCQTKY   *           TIOCUSCT          *
*        *************************************************************
*   24   *           TIOCAOMX          *           TIOCAIMX          *
*        *************************************************************
*   28   *           TIOCUSLW          *           TIOCNBFL          *
*        *************************************************************
*   32   *   TIOCTSBS   *                  TIOCTSB                   *
*        *************************************************************
*   36   *   TIOCSAVE (72 BYTES)                                     *
*        *************************************************************
*  108   *                         TIOCTECB                          *
*        *************************************************************
*  112   *           TIOCRCLM          *           RESERVED          *
*        *************************************************************
*  116   *                         TIOCLDS                           *
*        *************************************************************
*  120   *                         TIOCLIST                   @OZ62047
*        *************************************************************
*  124   *                         TIOCFBFL                          *
*        *************************************************************
*
         SPACE 3
         AIF   ('&LIST' EQ 'YES').L20
         POP   PRINT
.L20     ANOP
         MEND
++ MAC      (IKJTSB  ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
*/*MACMEAN TSB MEANS TERMINAL STATUS BLOCK                           */
*/*MACCOMP Y-2 SC1T3/SJE85                                           */
*/*MACSTAT Y-2 72347/029010                                          */
*        %GOTO TSBL2;
*/*
         MACRO
         IKJTSB &LIST=NO,&EXT=NO                               ZA16607
TSB      DSECT
***********************************************************************
*
*
*        THE TSB WILL CONTAIN INFORMATION PERTAINING TO A TERMINAL
*        USER'S STATUS.  IT IS OBTAINED DURING TIOC INITIALIZATION
*        AND WILL RESIDE IN THE COMMON AREA.  TSO.VTAM TSB'S   @ZA16607
*        ARE OBTAINED DYNAMICALLY AS NEEDED                    @ZA16607
*
*        UPDATING OF FIELDS IN THIS CONTROL BLOCK MUST BE
*        SYNCHRONIZED BY HOLDING THE CMS LOCK, EXCEPT FOR
*        THE FOLLOWING FIELDS WHICH MUST BE UPDATED USING
*        COMPARE AND SWAP:
*
*              TSBSTAX
*              TSBATTNC
*              TSBTPOST
*
*        METHOD OF ACCESS                                      @ZA16607
*         BAL- IF EXT=YES IS SPECFIED, A DSECT IS PRODUCED FOR @ZA16607
*              TSB EXTENTION (TSBX).  USING ON TSBX GIVES      @ZA16607
*              ADDRESSABILITY FOR ALL TSBX SYMBOLS.            @ZA16607
*         PL/S-SPECIFY %TSBEXT='YES' BEFORE INCLUDING IKJTSB   @ZA16607
*              IF THE TSB EXTENTION (TSBX) IS TO BE MAPPED.    @ZA16607
*              TSBX IS BASED ON TSBEXTNT.                      @ZA16607
*         **NOTE** USE OF EXT=YES FOR BAL OR %TSBEXT=YES FOR   @ZA25904
*                  PL/S IS VALID ONLY FOR SYSTEMS WITH         @ZA25904
*                  TSO/VTAM. USE OF EITHER PARAMETER ON        @ZA25904
*                  SYSTEMS WITHOUT TSO/VTAM WILL RESULT IN     @ZA25904
*                  ASSEMBLER OR COMPILER ERRORS.               @ZA25904
*                                                              @ZA25904
*        CHANGE ACTIVITY
*         AUG 1976 - SU13 TSO/VTAM                             @ZA16607
*         AUG 1977 - SU35 TSO/VTAM LEVEL 3.0 +FEATURES       - @G35SKSR
*        SEPT 1977 - TIOC/VTIOC SPLIT                        - @ZA25904
* C217250-217400,576500-578000                                 @OZ49608
* C217250,576500                                               @OZ46377
* $A=OZ56745    ETI1106  81.07.20  592303:                         @N1A
* A238000,812000 C748800-750000                                    @N1A
* A232000                                                      @OZ59270
* C745200,746000                                               @OZ59270
* A232000    C744800                                           @OZ90546
* NOCHANGE SHIPPED WITH JCLIN                                  @OY20024
*
***********************************************************************
         AIF   ('&LIST' EQ 'YES').L10
*
*        SPECIFY LIST=YES ON THE MACRO CALL TO OBTAIN A LISTING.
*
         PUSH  PRINT
         PRINT OFF
.L10     ANOP
         DS    0D .                     MUST BEGIN ON DOUBLEWORD
TSBASCBA DS    0A .                     POINTER TO ASCB
*
TSBSTAT  DS    X .                      TERMINAL STATUS BYTE
*                       BIT DEFINITIONS
TSBINUSE EQU   X'80' .                  TSB IN USE
TSBLWAIT EQU   X'40' .                  KEYBOARD LOCKED DUE TO A LACK
*                                       OF INPUT BUFFERS
TSBDSPLY EQU   X'20' .                  TSB REPRESENTS A DISPLAY SCREEN
TSBNOBUF EQU   X'10' .                  INDICATES TPUT FOUND NO BUFFERS
TSBITOFF EQU   X'08' .                  PROHIBIT NON-SUPERVISORY INTER-
*                                       TERMINAL MSGS TO USERS TERMINAL
TSBDISC  EQU   X'04' .                  TSB HAS BEEN THRU LOGOFF
TSB3270  EQU   X'02' .                  TSB REPRESENTS A 3270 TERMINAL
TSBATNLD EQU   X'01' .                  ATTN FOR INPUT LINE DELETE
*
TSBASCB  DS    AL3 .                    POINTER TO ASCB
*
TSBFLG1  DS    X .                      FIRST FLAG BYTE
*                       BIT DEFINITIONS
TSBANSR  EQU   X'80' .                  ATTN SIMULATION REQUESTED
TSBOFLSH EQU   X'40' .                  OUTPUT TRAILER Q IS TO BE
*                                       FLUSHED
TSBOWIP  EQU   X'20' .                  A TPUT IS IN PROGRESS
TSBWOWIP EQU   X'10' .                  WAITING IN OWAIT IN PROGRESS
TSBIFLSH EQU   X'08' .                  INPUT QUEUE FLUSH IN PROGRESS
TSBTJOW  EQU   X'04' .                  TJID TPUT ENCOUNTERED OWIP
TSBTJIP  EQU   X'02' .                  A TJID TPUT IS IN PROGRESS
TSBTJBF  EQU   X'01' .                  TJID TPUT FOUND NO TS BUFFERS
*
TSBWTCB  DS    AL3 .                    ADDR OF TCB OF TASK WAITING ON
*                                       TSBECB
TSBLNSZ  DS    X .                      PHYSICAL LINE SIZE OF TERMINAL
TSBOTBFP DS    AL3 .                    PTR TO TRAILER BUFFER(S) AFTER
*                                       HEADER BUFFER FOR MSG HAS BEEN
*                                       REMOVED
TSBNOBF  DS    X .                      NO. OF BUFFERS ON OUTPUT QUEUE
TSBOBFP  DS    AL3 .                    PTR TO OUTPUT BUFFER QUEUE
*
TSBFLG2  DS    X .                      SECOND FLAG BYTE
*                       BIT DEFINITIONS
TSBBIPI  EQU   X'80' .                  PARTIAL LINE PROMPTING COMPLETE
TSBAUTON EQU   X'40' .                  AUTO PROMPTING REQUESTED
TSBBRKIN EQU   X'20' .                  BREAKIN HAS OCCURED
TSBAULST EQU   X'10' .                  AUTO LINE NUMBERING STARTED
TSBAUTOC EQU   X'08' .                  AUTO CHARACTER PROMPT STARTED
TSBSTAUT EQU   X'04' .                  PROMPT USER WITH NEXT LINE NO.
TSBSATN1 EQU   X'02' .                  BITS 6 AND 7 ARE USED TO IND
TSBSATN2 EQU   X'01' .                  THE NO. OF CHARS (1-4) IN THE
*                                       CHAR STRING FOR SIMULATED ATTN
*
TSBITBFP DS    AL3 .                    PTR TO INPUT TRAILER BUFFERS
*                                       RESULTING FROM TGET WITH
*                                       INSUFFICIENT BUFFER SIZE
TSBNIBF  DS    X .                      NO. OF BUFFERS ON INPUT QUEUE
TSBIBFP  DS    AL3 .                    PTR TO INPUT BUFFER QUEUE
*
TSBFLG3  DS    X .                      THIRD FLAG BYTE
*                       BIT DEFINITIONS
TSBATTN  EQU   X'80' .                  ATTENTION HAS BEEN IGNORED
TSBTJMSG EQU   X'40' .                  TSOUTPUT PROCESSING TJID MSG
TSBSPIT  EQU   X'20' .                  STOP PROMPTING IF TCLEARQ OR
*                                       STBREAK
TSBNBKSP EQU   X'10' .                  NEXT CHAR IN USER'S BFFR IS A
*                                       BACKSPACE CHAR
TSBAWOIP EQU   X'08' .                  AN ASID TPUT IS WAITING
*                                       FOR A NORMAL TPUT TO COMPLETE
TSBTPUT  EQU   X'04' .                  TCAM PROCESSING OF A
*                                       TPUT IS NOT YET COMPLETE
*                                       (CORRESPONDS TO QCBTPUT)
TSBNOBRK EQU   X'02' .                  USE OF BREAK FEATURE
*                                       NOT CURRENTLY ALLOWED
*                                       FOR THIS TERMINAL
TSBNFLOP EQU   X'01' .                  FLASHBACK BIT          @ZA02244
TSBFLG5  DS    X .                      FIFTH FLAG BYTE        @ZA16607
*                      BIT DEFINITIONS                         @ZA16607
TSBATMP  EQU   X'80' .                  TERM. CONTROL ROUTINE ACTIVE
*                                       FOR THIS TERMINAL      @ZA24648
TSBSPF   EQU   X'40'                    SPF ACTIVE FOR THIS TERMINAL
TSBLOGON EQU   X'20'                    LOGON INITALIZATION    @OZ46377
TSBPARM  EQU   X'10'                    EXTENDED PARM          @OZ46377
TSBQRY   EQU   X'08'                    CURRENT TERMINAL       @OZ49608
*                                       SUPPORTS DEVICE QUERY  @OZ49608
TSBNEDIT EQU   X'04'                    NOEDIT MODE IN EFFECT  @OZ49608
TSBKEYS  EQU   X'02' .                  PASS ATTN. AND CLEAR KEYS
*                                       TO COMMAND PROCESSOR   @ZA24648
TSBVTAM  EQU   X'01' .                  THIS IS A VTAM TSB     @ZA16607
*                                                              @ZA16607
TSBTERMC DS    0CL2 .                   TERMINAL CHARACTERISTICS
TSBTERM1 DS    X .                      1ST FLAG BYTE
TSBCIHBN EQU   X'80' .                  TIME-OUT INHIBITED
TSBCBRK  EQU   X'40' .                  BREAK FEATURE
TSBCATTN EQU   X'20' .                  ATTENTION FEATURE
TSBC5041 EQU   X'10' .                  LINE IS 5041
TSBC2741 EQU   X'08' .                  TERMINAL IS 2741
TSBSIMND EQU   X'04' .                  SIMMATTN REMEMBER BIT  @OZ90546
TSBTSTR  EQU   X'02' .                  TCAM TRACE ACTIVE      @OZ59270
TSBTGET  EQU   X'01' .                  TCAM TGET NOT COMPLETE @OZ59270
*
TSBTERM2 DS    X .                      2ND FLAG BYTE
TSBCTWX  EQU   X'20' .                  TERMINAL IS TWX
*        EQU   X'10' .                  RESERVED                   @N1A
TSBALTCF EQU   B'00001100' .            ALTERNATE CODE FLAGS       @N1A
*                                       TWO BIT FIELD REPRESENTING @N1A
*                                       THE FOLLOWING BIT VALUES   @N1A
*                                       ASCII-7 00,ASCII-8 01,     @N1A
*                                       RESERVED 10, RESERVED 11   @N1A
TSBASCI7 EQU   B'11110011' .            THE NEGATIVE TO BE USED    @N1A
*                                       TO INDICATE THAT ASCII-7   @N1A
*                                       IS BEING USED............  @N1A
*                                       ...........ASCII-7 EQU 00  @N1A
TSBASCI8 EQU   B'00000100' .            ASCII-8 ALTERNATE CODE     @N1A
*                                       CURRENTLY BEING USED       @N1A
*        EQU   B'00001000' .            RESERVED                   @N1A
*        EQU   B'00001100' .            RESERVED                   @N1A
TSBALTCD EQU   X'02' .                  THE RESOURCE IS USING AN   @N1A
*                                       ALTERNATE CODE             @N1A
TSBC1050 EQU   X'01' .                  TERMINAL IS 1050
*
TSBECB   DS    F .                      ECB FOR INTER-TERMINAL COM-
*                                       MUNICATION (TPUT WITH TJID)
TSBWTJID DS    H .                      TJID OF TASK WAITING ON TSBECB
TSBSTCC  DS    0H .                     SPECIAL USER CHAR FIELD
TSBLNDCC DS    CL1 .                    LINE DELETE CHARACTER
TSBCHDCC DS    CL1 .                    CHARACTER DELETE CHARACTER
TSBATNLC DS    CL2 .                    NO. OF SUCCESSIVE OUTPUT LINES
*                                       BETWEEN ATTENTION SIMULATION
TSBATNTC DS    CL2 .                    NUMBER OF CONTINUOUS 1-SECOND
*                                       TIME INTERVALS
TSBLNNO  DS    CL1 .                    NO. OF LINES ON A DISPLAY
*                                       SCREEN
*
TSBFLG4  DS    X .                      FLAG BYTE
*                      BIT DEFINITIONS
TSBOCAB  EQU   X'80' .                  OUT-OF-CORE ABEND
TSBIWAIT EQU   X'40' .                  INPUT WAIT IN PROGRESS
TSBOWAIT EQU   X'20' .                  OUTPUT WAIT IN PROGRESS
TSBHUNG  EQU   X'10' .                  TERMINAL HAS HUNG UP
TSBHOLD  EQU   X'08' .                  TPUT HOLD IN PROGRESS
TSBCANC  EQU   X'04' .                  SESSION CANCELLED
TSBGETBF EQU   X'02' .                  TJID TPUT MAY GET AN EXTRA
*                                       ALLOWANCE OF OUTPUT BUFFERS
TSBHLDL  EQU   X'01' .                  DON'T DISCONNECT LINE
*                                       AFTER LOGOFF
TSBASRCE DS    CL2 .                    TCAM TERMINAL INDEX.
*                                       EQUIVALENT TO PRFSRCE IN
*                                       TCAM INPUT BUFFERS.
TSBATNCC DS    CL4 .                    CHARACTER STRING USED FOR
*                                       ATTENTION SIMULATION
TSBAUTOS DS    F .                      STARTING AND CURRENT SEQ NO.
*                                       FOR AUTO LINE NUMBERING
TSBAUTOI DS    F .                      INCREMENT VALUE FOR AUTO LINE
*                                       NUMBERING
TSBERSDS DS    F .                      CHARS USED TO ERASE SCREEN
*
TSBCTCB  DS    F .                      TCB ADDRESS OF TASK CURRENTLY
*                                       DOING A TPUT
TSBRCB   DS    0XL8 .                   TCAM RESOURCE CTL BLK
TSBRQCB  DS    A .                      RCB QCB POINTER
TSBLINKA DS    0A .                     RCB LINK WORD
TSBPRI   DS    X .                      TPOSTING PRIORITY
TSBLINKB DS    AL3 .                    RCB LINKING FIELD
*
TSBTPOST DS    0D .                     TPOSTING COMMUNICATIONS AREA
*                                       UPDATED ONLY WITH CS/CDS
TSBTPFLG DS    X .                      TPOSTING FLAGS
*                     BIT DEFINITIONS
*        BITS  3 - 7                    RESERVED
TSBPOSTO EQU   X'80' .                  TPOST OF TSB OUTSTANDING
TSBTPQCB EQU   X'40' .                  TPOST TERM. DEST. QCB
TSBTPAYI EQU   X'20' .                  TPOST TSI TO TSINPUT
TSBNEWID EQU   X'10' .                  UPDATE QCB TJID WITH
*                                       NEW ASCBASID
*
TSBSBASV DS    CL1  .                   NO. OF SBA CHAR. IN    @ZA11104
*                                       FOLLOWING BUFFER       @ZA11104
TSBFLAGM DS    X .                      QCBFLAG SUBSTITUTION MASK.
*                                       INDICATES BIT POSITIONS TO
*                                       CHANGE IN QCBFLAG.
TSBFLAGV DS    X .                      QCBFLAG SUBSTITUTION VALUE.
*                                       INDICATES BIT VALUES TO
*                                       SUBSTITUTE FOR CHANGING
*                                       BIT POSITIONS IN QCBFLAG.
TSBF2M   DS    X .                      QCBTSOF2 SUBSTITUTION MASK
TSBF2V   DS    X .                      QCBTSOF2 SUBSTITUTION VALUE
TSBF1M   DS    X .                      QCBTSOF1 SUBSTITUTION MASK
TSBF1V   DS    X .                      QCBTSOF1 SUBSTITUTION VALUE
*
TSBATTNC DS    X .                      NO. OF UNPROCESSED ATTN'S
TSBSTAX  DS    X .                      NO. OF UNSCHEDULED STAX EXITS
TSBLINE  DS    CL2 .                    LINE ADDRESS OR 3705
*                                       RESOURCE I.D. OF THIS
*                                       TERMINAL.
TSBLECB  DS    0A .                     TIOC LOGOFF WAITS ON THIS ECB
*                                       WHILE TIOC FINISHES TCAM
*                                       PROCESSING FOR A
*                                       TERMINATING MEMORY.
TSBMINL  DS    F .                      NO. OF MINUTES LEFT
*                                       BEFORE A DISCONNECTED
*                                       USER WILL BE LOGGED OFF.
TSBPSWD  DS    CL8 .                    LOGON PASSWORD
TSBEXTNT DS    F .                      ADDRESS OF TSB EXTENTION
*                                                              @ZA16607
TSBPRMR  DS    AL1 .                    NDS PRIM(DEFAULT) ROWS @G35SKSR
TSBPRMC  DS    AL1 .                    NDS PRIM(DEFAULT) COLS @G35SKSR
TSBALTR  DS    AL1 .                    NDS ALTERNATE ROWS     @G35SKSR
TSBALTC  DS    AL1 .                    NDS ALTERNATE COLS     @G35SKSR
TSBTRMID DS    D .                      TERMINAL SYMBOLIC NAME @G32TKKM
TSBSF1   DS    D .                      SECURITY FIELD 1       @G32TKKM
TSBEND   DS    0D .                     MARKS THE END OF THE TSB
*
*        *************************************************************
*    0   *   TSBSTAT    *                  TSBASCB                   *
*        *************************************************************
*    4   *   TSBFLG1    *                  TSBWTCB                   *
*        *************************************************************
*    8   *   TSBLNSZ    *                  TSBOTBFP                  *
*        *************************************************************
*   12   *   TSBNOBF    *                  TSBOBFP                   *
*        *************************************************************
*   16   *   TSBFLG2    *                  TSBITBFP                  *
*        *************************************************************
*   20   *   TSBNIBF    *                  TSBIBFP                   *
*        *************************************************************
*   24   *   TSBFLG3    *   TSBFLG5    *           TSBTERMC          *
*        *************************************************************
*   28   *                         TSBECB                            *
*        *************************************************************
*   32   *           TSBWTJID          *           TSBSTCC           *
*        *************************************************************
*   36   *           TSBATNLC          *           TSBATNTC          *
*        *************************************************************
*   40   *   TSBLNNO    *   TSBFLG4    *           TSBASRCE          *
*        *************************************************************
*   44   *                         TSBATNCC                          *
*        *************************************************************
*   48   *                         TSBAUTOS                          *
*        *************************************************************
*   52   *                         TSBAUTOI                          *
*        *************************************************************
*   56   *                         TSBERSDS                          *
*        *************************************************************
*   60   *                         TSBCTCB                           *
*        *************************************************************
*   64   *                         TSBRQCB                           *
*        *************************************************************
*   68   *   TSBPRI     *                  TSBLINK                   *
*        *************************************************************
*   72   *   TSBTPFLG   *  RESERVED    *   TSBFLAGM   *   TSBFLAGV   *
*        *************************************************************
*   76   *   TSBF2M     *   TSBF2V     *   TSBF1M     *   TSBF1V     *
*        *************************************************************
*   80   *   TSBATTNC   *   TSBSTAX    *           TSBLINE           *
*        *************************************************************
*   84   *                       TSBLECB/MINL                        *
*        *************************************************************
*        *                                                           *
*   88   *                         TSBPSWD                           *
*        *                                                           *
*        *************************************************************
*   96   *                         TSBEXTNT                          *
*        *************************************************************
*  100   * TSBPRMR      * TSBPRMC     * TSBALTR      * TSBALTC       *
*        *************************************************************
*        *                                                           *
*  104   *                         TSBTRMID                          *
*        *                                                           *
*        *************************************************************
*        *                                                           *
*  112   *                          TSBSF1                           *
*        *                                                           *
*        *************************************************************
*
         AIF   ('&EXT' EQ 'NO').TSBXA1                         @ZA16607
         IKTTSBX                                               @ZA34273
.TSBXA1  ANOP                                                  @ZA25904
         SPACE 3
         AIF   ('&LIST' EQ 'YES').L20
         POP   PRINT
.L20     ANOP
         MEND      ,   */
*        %TSBL2: ;
*DECLARE
*  1 TSB      BASED(TSBPTR),
*
*   2 TSBASCBA    PTR(31) BDY(DWORD),    /* . POINTER TO ASCB
*                                                                    */
*    3 TSBSTAT     CHAR(1),              /* . TERMINAL STATUS BYTE
*                                           BIT DEFINITIONS          */
*     4 TSBINUSE BIT(1),                 /* . TSB IN USE             */
*     4 TSBLWAIT BIT(1),                 /* . KEYBOARD LOCKED DUE TO
*                                           A LACK  OF INPUT BUFFERS */
*     4 TSBDSPLY BIT(1),                 /* . TSB REPRESENTS A
*                                           DISPLAY SCREEN           */
*     4 TSBNOBUF BIT(1),                 /* . INDICATES TPUT FOUND
*                                           NO BUFFERS               */
*     4 TSBITOFF BIT(1),                 /* . PROHIBIT
*                                           NON-SUPERVISORY INTER-
*                                           TERMINAL MSGS TO USERS
*                                           TERMINAL                 */
*     4 TSBDISC  BIT(1),                 /* . TSB HAS BEEN THRU
*                                           LOGOFF                   */
*     4 TSB3270  BIT(1),                 /* . TSB REPRESENTS A 3270
*                                           TERMINAL                 */
*     4 TSBATNLD BIT(1),                 /* . ATTN FOR INPUT LINE
*                                           DELETE
*                                                                    */
*    3 TSBASCB    PTR(24) BDY(WORD,2),   /* . POINTER TO ASCB
*                                                                    */
*   2 TSBFLG1     CHAR(1),               /* . FIRST FLAG BYTE  BIT
*                                           DEFINITIONS              */
*    3 TSBANSR  BIT(1),                  /* . ATTN SIMULATION
*                                           REQUESTED                */
*    3 TSBOFLSH BIT(1),                  /* . OUTPUT TRAILER Q IS TO
*                                           BE  FLUSHED              */
*    3 TSBOWIP  BIT(1),                  /* . A TPUT IS IN PROGRESS  */
*    3 TSBWOWIP BIT(1),                  /* . WAITING IN OWAIT IN
*                                           PROGRESS                 */
*    3 TSBIFLSH BIT(1),                  /* . INPUT QUEUE FLUSH IN
*                                           PROGRESS                 */
*    3 TSBTJOW  BIT(1),                  /* . TJID TPUT ENCOUNTERED
*                                           OWIP                     */
*    3 TSBTJIP  BIT(1),                  /* . A TJID TPUT IS IN
*                                           PROGRESS                 */
*    3 TSBTJBF  BIT(1),                  /* . TJID TPUT FOUND NO TS
*                                           BUFFERS
*                                                                    */
*   2 TSBWTCB     PTR(24)  BDY(WORD,2),  /* . ADDR OF TCB OF TASK
*                                           WAITING ON  TSBECB       */
*   2 TSBLNSZ     CHAR(1),               /* . PHYSICAL LINE SIZE OF
*                                           TERMINAL                 */
*   2 TSBOTBFP    PTR(24)  BDY(WORD,2),  /* . PTR TO TRAILER
*                                           BUFFER(S) AFTER  HEADER
*                                           BUFFER FOR MSG HAS BEEN
*                                           REMOVED                  */
*   2 TSBNOBF     CHAR(1),               /* . NO. OF BUFFERS ON
*                                           OUTPUT QUEUE             */
*   2 TSBOBFP     PTR(24)  BDY(WORD,2),  /* . PTR TO OUTPUT BUFFER
*                                           QUEUE
*                                                                    */
*   2 TSBFLG2     CHAR(1),               /* . SECOND FLAG BYTE  BIT
*                                           DEFINITIONS              */
*    3 TSBBIPI  BIT(1),                  /* . PARTIAL LINE PROMPTING
*                                           COMPLETE                 */
*    3 TSBAUTON BIT(1),                  /* . AUTO PROMPTING
*                                           REQUESTED                */
*    3 TSBBRKIN BIT(1),                  /* . BREAKIN HAS OCCURED    */
*    3 TSBAULST BIT(1),                  /* . AUTO LINE NUMBERING
*                                           STARTED                  */
*    3 TSBAUTOC BIT(1),                  /* . AUTO CHARACTER PROMPT
*                                           STARTED                  */
*    3 TSBSTAUT BIT(1),                  /* . PROMPT USER WITH NEXT
*                                           LINE NO.                 */
*    3 TSBSATN1 BIT(1),                  /* . BITS 6 AND 7 ARE USED
*                                           TO IND                   */
*    3 TSBSATN2 BIT(1),                  /* . THE NO. OF CHARS (1-4)
*                                           IN THE  CHAR STRING FOR
*                                           SIMULATED ATTN
*                                                                    */
*   2 TSBITBFP    PTR(24)  BDY(WORD,2),  /* . PTR TO INPUT TRAILER
*                                           BUFFERS  RESULTING FROM
*                                           TGET WITH  INSUFFICIENT
*                                           BUFFER SIZE              */
*   2 TSBNIBF     CHAR(1),               /* . NO. OF BUFFERS ON
*                                           INPUT QUEUE              */
*   2 TSBIBFP     PTR(24)  BDY(WORD,2),  /* . PTR TO INPUT BUFFER
*                                           QUEUE
*                                                                    */
*   2 TSBFLG3     CHAR(1),               /* . THIRD FLAG BYTE        */
*    3 TSBATTN  BIT(1),                  /* . ATTENTION HAS BEEN
*                                           IGNORED                  */
*    3 TSBTJMSG BIT(1),                  /* . TSOUTPUT PROCESSING
*                                           TJID MSG                 */
*    3 TSBSPIT  BIT(1),                  /* . STOP PROMPTING IF
*                                           TCLEARQ OR  STBREAK      */
*    3 TSBNBKSP BIT(1),                  /* . NEXT CHAR IN USER'S
*                                           BFFR IS A  BACKSPACE
*                                           CHAR                     */
*    3 TSBAWOIP BIT(1),                  /* . AN ASID TPUT IS
*                                           WAITING   FOR A NORMAL
*                                           TPUT TO COMPLETE         */
*    3 TSBTPUT  BIT(1),                  /* . TCAM PROCESSING OF A
*                                           TPUT IS NOT YET COMPLETE
*                                           (CORRESPONDS TO QCBTPUT) */
*    3 TSBNOBRK BIT(1),                  /* . USE OF BREAK FEATURE
*                                           NOT CURRENTLY ALLOWED
*                                           FOR THIS TERMINAL        */
*    3 TSBNFLOP BIT(1),                  /* FLASHBACK OF PASSWORD    */
*   2 TSBFLG5     CHAR(1),               /* . FIFTH FLAG BYTE.
*                                                            @ZA16607*/
*    3 TSBATMP       BIT(1),             /* . TERM. CONTROL ROUTINE
*                                           ACTIVE FOR THIS TERMINAL
*                                                            @ZA24648*/
*    3 TSBSPF        BIT(1),             /* . SPF ACTIVE FOR THIS
*                                           TERMINAL         @A29425Z*/
*    3 TSBLOGON      BIT(1),            /* LOGON INIT.       @OZ46377*/
*    3 TSBPARM       BIT(1),            /* EXTENDED PARM     @OZ46377*/
*    3 TSBQRY        BIT(1),            /* CURRENT TERMINAL SUPPORTS
*                                           DEVICE QUERY     @OZ49608*/
*    3 TSBNEDIT      BIT(1),            /* NOEDIT MODE IS IN EFFECT
*                                                            @OZ49608*/
*    3 TSBKEYS       BIT(1),             /* . PASS ATTN. AND CLEAR KEYS
*                                           TO COMMAND PROCESSOR
*                                                            @ZA24648*/
*    3 TSBVTAM       BIT(1),             /* . THIS IS A VTAM TSB
*                                                            @ZA16607*/
*   2 TSBTERMC    CHAR(2),               /* . TERMINAL
*                                           CHARACTERISTICS          */
*    3 TSBTERM1    CHAR(1),              /* . 1ST FLAG BYTE          */
*     4 TSBCIHBN BIT(1),                 /* . TIME-OUT INHIBITED     */
*     4 TSBCBRK  BIT(1),                 /* . BREAK FEATURE          */
*     4 TSBCATTN BIT(1),                 /* . ATTENTION FEATURE      */
*     4 TSBC5041 BIT(1),                 /* . LINE IS 5041           */
*     4 TSBC2741 BIT(1),                 /* . TERMINAL IS 2741
*                                                                    */
*     4 TSBSIMND BIT(1),                 /* SIMMULATED ATTENTION
*                                        REMEMBER BIT (TCAM) @OZ90546*/
*     4 TSBTSTR  BIT(1),                 /* TCAM TRACE ACTIVE@OZ59270*/
*     4 TSBTGET  BIT(1),                 /* TCAM TGET ACTIVE @OZ59270*/
*    3 TSBTERM2    CHAR(1),              /* . 2ND FLAG BYTE          */
*     4 *        BIT(1),                 /* RESERVED                 */
*     4 *        BIT(1),                 /* RESERVED                 */
*     4 TSBCTWX  BIT(1),                 /* . TERMINAL IS TWX        */
*     4 *        BIT(1),                 /* RESERVED                 */
*     4 TSBALTCF      BIT(2),            /* ALTERNATE CODE FLAGS @N1C*/
*     4 TSBALTCD BIT(1),                 /* USING ALTERNATE CODE @N1C*/
*     4 TSBC1050 BIT(1),                 /* . TERMINAL IS 1050
*                                                                    */
*   2 TSBECB      FIXED(31),             /* . ECB FOR INTER-TERMINAL
*                                           COM-  MUNICATION (TPUT
*                                           WITH TJID)               */
*   2 TSBWTJID    FIXED(15),             /* . TJID OF TASK WAITING
*                                           ON TSBECB                */
*   2 TSBSTCC     FIXED(15),             /* . SPECIAL USER CHAR
*                                           FIELD                    */
*    3 TSBLNDCC    CHAR(1),              /* . LINE DELETE CHARACTER  */
*    3 TSBCHDCC    CHAR(1),              /* . CHARACTER DELETE
*                                           CHARACTER                */
*   2 TSBATNLC    CHAR(2),               /* . NO. OF SUCCESSIVE
*                                           OUTPUT LINES  BETWEEN
*                                           ATTENTION SIMULATION     */
*   2 TSBATNTC    CHAR(2),               /* . NUMBER OF CONTINUOUS
*                                           1-SECOND  TIME INTERVALS */
*   2 TSBLNNO     CHAR(1),               /* . NO. OF LINES ON A
*                                           DISPLAY  SCREEN
*                                                                    */
*   2 TSBFLG4     CHAR(1),               /* . FLAG BYTE  BIT
*                                           DEFINITIONS              */
*    3 TSBOCAB  BIT(1),                  /* . OUT-OF-CORE ABEND      */
*    3 TSBIWAIT BIT(1),                  /* . INPUT WAIT IN PROGRESS */
*    3 TSBOWAIT BIT(1),                  /* . OUTPUT WAIT IN
*                                           PROGRESS                 */
*    3 TSBHUNG  BIT(1),                  /* . TERMINAL HAS HUNG UP   */
*    3 TSBHOLD  BIT(1),                  /* . TPUT HOLD IN PROGRESS  */
*    3 TSBCANC  BIT(1),                  /* . SESSION CANCELLED      */
*    3 TSBGETBF BIT(1),                  /* . TJID TPUT MAY GET AN
*                                           EXTRA  ALLOWANCE OF
*                                           OUTPUT BUFFERS           */
*    3 TSBHLDL  BIT(1),                  /* . DON'T DISCONNECT LINE
*                                           AFTER LOGOFF             */
*   2 TSBASRCE    CHAR(2),               /* . TCAM TERMINAL INDEX.
*                                           EQUIVALENT TO PRFSRCE IN
*                                           TCAM INPUT BUFFERS.      */
*   2 TSBATNCC    CHAR(4),               /* . CHARACTER STRING USED
*                                           FOR  ATTENTION
*                                           SIMULATION               */
*   2 TSBAUTOS    FIXED(31),             /* . STARTING AND CURRENT
*                                           SEQ NO.  FOR AUTO LINE
*                                           NUMBERING                */
*   2 TSBAUTOI    FIXED(31),             /* . INCREMENT VALUE FOR
*                                           AUTO LINE  NUMBERING     */
*   2 TSBERSDS    FIXED(31),             /* . CHARS USED TO ERASE
*                                           SCREEN
*                                                                    */
*   2 TSBCTCB     FIXED(31),             /* . TCB ADDRESS OF TASK
*                                           CURRENTLY  DOING A TPUT  */
*   2 TSBRCB      CHAR(8) BDY(WORD),     /* . TCAM RESOURCE CTL BLK  */
*    3 TSBRQCB     PTR(31),              /* . RCB QCB POINTER        */
*    3 TSBLINKA    PTR(31),              /* . RCB LINK WORD          */
*     4 TSBPRI      CHAR(1),             /* . TPOSTING PRIORITY      */
*     4 TSBLINKB    PTR(24) BDY(WORD,2), /* . RCB LINKING FIELD
*                                                                    */
*   2 TSBTPOST    CHAR(8) BDY(DWORD),    /* . TPOSTING
*                                           COMMUNICATIONS AREA
*                                           UPDATED ONLY WITH CS/CDS */
*    3 TSBTPFLG    CHAR(1),              /* . TPOSTING FLAGS  BIT
*                                           DEFINITIONS  BITS 3 - 7
*                                           RESERVED                 */
*     4 TSBPOSTO BIT(1),                 /* . TPOST OF TSB
*                                           OUTSTANDING              */
*     4 TSBTPQCB BIT(1),                 /* . TPOST TERM. DEST. QCB  */
*     4 TSBTPAYI BIT(1),                 /* . TPOST TSI TO TSINPUT   */
*     4 TSBNEWID BIT(1),                 /* . UPDATE QCB TJID WITH
*                                           NEW ASCBASID
*                                                                    */
*     4 *        BIT(1),                 /* RESERVED                 */
*     4 *        BIT(1),                 /* RESERVED                 */
*     4 *        BIT(1),                 /* RESERVED                 */
*     4 *        BIT(1),                 /* RESERVED                 */
*    3 *           CHAR(1),              /* . RESERVED               */
*    3 TSBFLAGM    CHAR(1),              /* . QCBFLAG SUBSTITUTION
*                                           MASK.  INDICATES BIT
*                                           POSITIONS TO  CHANGE IN
*                                           QCBFLAG.                 */
*    3 TSBFLAGV    CHAR(1),              /* . QCBFLAG SUBSTITUTION
*                                           VALUE.  INDICATES BIT
*                                           VALUES TO  SUBSTITUTE
*                                           FOR CHANGING  BIT
*                                           POSITIONS IN QCBFLAG.    */
*    3 TSBF2M      CHAR(1),              /* . QCBTSOF2 SUBSTITUTION
*                                           MASK                     */
*    3 TSBF2V      CHAR(1),              /* . QCBTSOF2 SUBSTITUTION
*                                           VALUE                    */
*    3 TSBF1M      CHAR(1),              /* . QCBTSOF1 SUBSTITUTION
*                                           MASK                     */
*    3 TSBF1V      CHAR(1),              /* . QCBTSOF1 SUBSTITUTION
*                                           VALUE
*                                                                    */
*   2 TSBATTNC    CHAR(1),               /* . NO. OF UNPROCESSED
*                                           ATTN'S                   */
*   2 TSBSTAX     CHAR(1),               /* . NO. OF UNSCHEDULED
*                                           STAX EXITS               */
*   2 TSBLINE     CHAR(2),               /* . LINE ADDRESS OR 3705
*                                           RESOURCE I.D. OF THIS
*                                           TERMINAL.                */
*   2 TSBMINL     FIXED(31),             /* . NO. OF MINUTES LEFT
*                                           BEFORE A DISCONNECTED
*                                           USER WILL BE LOGGED OFF. */
*    3 TSBLECB     PTR(31),              /* . TIOC LOGOFF WAITS ON
*                                           THIS ECB  WHILE TIOC
*                                           FINISHES TCAM
*                                           PROCESSING FOR A
*                                           TERMINATING MEMORY.      */
*   2 TSBPSWD     CHAR(8),               /* . LOGON PASSWORD @ZA16607*/
*   2 TSBEXTNT    PTR(31),               /* . ADDRESS OF TSB EXTENTION
*                                                            @ZA16607*/
*   2 TSBPRMR     FIXED(8),              /* . NDS PRIM(DEFAULT) ROWS
*                                                            @G35SKSR*/
*   2 TSBPRMC     FIXED(8),              /* . NDS PRIM(DEFAULT) COLS
*                                                            @G35SKSR*/
*   2 TSBALTR     FIXED(8),              /* . NDS ALTERNATE ROWS
*                                                            @G35SKSR*/
*   2 TSBALTC     FIXED(8),              /* . NDS ALTERNATE COLS
*                                                            @G35SKSR*/
*   2 TSBTRMID    CHAR(8) BDY(DWORD),    /* . TERMINAL SYMBOLIC NAME
*                                                            @G32TKKM*/
*   2 TSBSF1      CHAR(8) BDY(DWORD),    /* . SECURITY FIELD 1
*                                                            @G32TKKM*/
*   2 TSBEND      CHAR(0) BDY(DWORD);    /* . TSB FORCED TO DOUBLE WORD
*                                             BOUNDARY       @ZA16607*/
*  /* CONSTANTS FOR TSBALTCF                                     @N1A*/
* DCL TSBASCI7 BIT(2) CONSTANT('00'B);/* ASCII 7 CURRENTLY BEING USED
*                                                                @N1A*/
* DCL TSBASCI8 BIT(2) CONSTANT('01'B);/* ASCII 8 CURRENTLY BEING USED
*                                                                @N1A*/
*%IF TSBEXT ^= 'YES' %THEN       /*                          @ZA16607*/
*   %GOTO TSBXA2;                /*                          @ZA16607*/
*                                /*                          @ZA16607*/
*                                /*                          @ZA16607*/
*                                /*                          @ZA16607*/
*%INCLUDE SYSLIB (IKTTSBX);      /*                          @ZA25904*/
*%TSBXA2:  ;                       /*                        @ZA16607*/
++ MAC      (IKJXSA  ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
         IKJXSA
.* A000000-999999                                              @G76XRYU
         SPACE
***********************************************************************
.* A000038,000039                                              @OZ43223
.* C000013,000017,000038,000052,000084                         @OZ43223
.* D000018-000037,000040-000041,000081,000085                  @OZ43223
.* NOCHANGE SHIPPED WITH JCLIN                                 @OY20024
*                                                                     *
*  EXTENDED SUPERVISOR RB SAVE AREA AS USED BY TCAM/TSO MODULES. IF   *
*  USED, IT MUST BE INCLUDED IMMEDIATELY FOLLOWING MACRO 'IKJRB'.     *
*                                                                     *
***********************************************************************
         SPACE
         ORG   RBEXSAVE           START OF RB EXTENDED SAVE AREA
XSAPRM0  DS    0F                 SVC 93 PARMLIST WORD 0      @OZ43223
XSANEDIT EQU   X'80'              NOEDIT OPTION SELECTED
XSAPRMTJ DS    H                  ASID OF TARGET TERMINAL (TPUT ONLY)
XSAPRMSZ DS    H                  SIZE OF DATA BUFFER
XSAPRM1  DS    A                  BUF ADDR FROM PARM LIST      @OZ43223
XSAFLAG  DS    X                  SVC 93 PARMLIST FLAGS2       @OZ43223
*        EQU   X'80'              TPUT END OF LIST FLAG        @OZ43223
*        EQU   X'40'              AVAILABLE                    @OZ43223
XSATCBFX EQU   X'20'              TURN OFF TCBFX AT EXIT
*        EQU   X'10'-X'04'        AVAILABLE                    @OZ43223
XSATPG   EQU   X'02'              TPG MACRO INVOCATION         @OZ43223
XSATNEDT EQU   X'01'              TPUT NOEDIT                  @OZ43223
XSAOPTNS DS    X                  SVC 93 PARMLIST FLAGS1       @OZ43223
*                                                              @OZ43223
*  TGET, TPUT FLAG SETTINGS                                    @OZ43223
*                                                              @OZ43223
MTGET    EQU   X'80'              TGET REQUESTED               @OZ43223
MUSERP   EQU   X'40'              USERID SPECIFIED (TPUT)      @OZ43223
MLOWP    EQU   X'20'              LOWPRI (TPUT ONLY)           @OZ43223
MWAIT    EQU   X'10'              NOWAIT                       @OZ43223
MHOLD    EQU   X'08'              HOLD                         @OZ43223
MBREAK   EQU   X'04'              BREAKIN SPECIFIED (TPUT ONLY)@OZ43223
*                                                              @OZ43223
*   DATA MODE FLAGS:                                           @OZ43223
*                                                              @OZ43223
MFULLSCR EQU   X'03'              FULLSCREEN OPTION (TPUT ONLY)@OZ43223
MCNTRL   EQU   X'02'              CONTROL OPTION (TPUT ONLY)   @OZ43223
MASIS    EQU   X'01'              ASIS OPTION                  @OZ43223
*        EQU   X'00'              EDIT OPTION                  @OZ43223
XSAUBFRS DS    H                  AMOUNT DATA LEFT TO MOVE
XSAUBFRP DS    0F                 LOCATION DATA LEFT TO MOVE
XSAESTAL DS    0CL16              LIST FOR ESTAE MACRO
         ORG   XSAUBFRP+4
XSAWD5   DS    F                  FOR SAVING REGISTERS
XSAWD6   DS    F                  FOR SAVING REGISTERS
         ORG   XSAWD5             USE WORDS 5-6 FOR NAME
XSAENQNM DS    CL8                ENQUEUE NAME FOR ASID TPUT
XSAWD7   DS    0F                 FOR SAVING REGISTERS
XSAENQAD DS    2F                 WORK AREA FOR ENQUEUE/DEQUEUE
XSAUSERP DS    F                  SVC 93 PARMLIST WORD 2       @OZ43223
XSARETRG DS    F                  FOR SAVING RETURN ADDRESS
         DS    CL1                RESERVED
XSAUSERK DS    CL1                KEY OF TGET CALLER
XSARC    DS    H                  RETURN CODE SAVE AREA
XSATJID  DS    H                  CALLER'S ASID
XSAFLAG2 DS    X                  FLAGS
XSAATR   EQU   X'80'              NEXT CHAR IN TIOC BUFFER
*                                 IS A 3270 ATTRIBUTE BYTE
XSABFRAL EQU   X'40'              TIOC BUFFER HAS BEEN ALLOCATED
XSA15D   EQU   X'20'              CHANGE COMPLETION CODE TO 15D
*        X'10'-X'01'              RESERVED
XSAF     DS    X                  FLAGS USED BY TPUT-INITIALIZED FROM
*                                 XSAFLAG
HSW      EQU   X'80'              HEADER BUFFER DONE
PSW      EQU   X'40'              NEED TO TPOST QCB
*        EQU   X'20'              TURN OFF TCBFX AT EXIT
OSW      EQU   X'10'              TSBOWIP TURNED ON BY US
XSADMOVE EQU   X'08'              DATA MOVEMENT GOES ON
XSAAUTH  EQU   X'04'              USER IS AUTHORIZED
*                                 (NOT SOME OTHER TPUT)
XSAIDENQ EQU   X'02'              ASID TPUT-ASID ENQUEUED
XSAPARTO EQU   X'01'              QCBPARTO IS SET ON
         SPACE 2
***********************************************************************
*                                                                   *
*           XSAPRMTJ                           XSAPRMSZ              *
*                              XSAPRM0                                *
***********************************************************************
*                              XSAPRM1                                *
***********************************************************************
*   XSAFLAG        XSAOPTNS                   XSAUBFRS              *
**********************************************************************
*                            XSAUBFRP                                *
* X ******************************************************************
* S                           XSAWD5                                 *
* A                      -----------------                           *
* E *********************   XSAEQNM     ****************************
* S                      -----------------                           *
* T                           XSAWD6                                 *
* A ******************************************************************
* L                           XSAWD7                                 *
*                        -----------------                           *
*************************    XSAENQAD   ****************************
*                         -----------------                           *
***********************************************************************
*                             XSAUSERP                                *
***********************************************************************
*                             XSARETRG                                *
***********************************************************************
*   RESERVED        XSAUSERK                    XSARC               *
***********************************************************************
*            XSATJID                  XSAFLAG2          XSAF        *
***********************************************************************
         MEND
++ MAC      (RTAUTOPT) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    RTAUTOPT &A
.**********************************************************************
.*                                                                    *
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - RTAUTOPT                                                     *
.*                                                                    *
.*FUNCTION - THIS MACRO ALLOWS THE USER TO RESTART AUTOMATIC LINE     *
.*   NUMBERING OR AUTOMATIC CHARACTER PROMPT.                         *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*&NAME  SR    1,1                      PREPARE PARM                  *
.*       LA    0,14                     LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ABOVE IN LEFT MOST IN REG *
.*       SVC   94                       ISSUE SVC                     *
.*       CHANGE ACTIVITY                                              *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.*                                                                    *
.**********************************************************************
         AIF   ('&A' NE '').ERROR
&NAME    SR    1,1                      PREPARE PARM
         LA    0,14                     LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN HIGH ORDER
.*                                      BYTE IN REG
         SVC   94                       ISSUE SVC
         MEXIT
.ERROR   ANOP
         IHBERMAC 36,,&A
         MEXIT
         MEND
++ MAC      (SGIKJ4EC) DISTLIB(AGENLIB ) .
         MACRO
         SGIKJ4EC
.*A480000,841000                                               @OZ72316
.*A842500,849000                                               @OZ77958
.*C842000,846500                                               @OZ77958
.*A844500,850500                                               @OZ83425
.*D080500,081500,843500,849500,852500                          @OZ84345
.*C840000                                                      @OZ89018
.*A480000,784000,841000,846250                                 @OY02233
.*C849000              NEW MODULE ADDED                        @OY09829
.*C845000,851000                                               @OY16630
.*NOCHANGE SHIPPED WITH JCLIN                                  @OY20024
         GBLC  &CI555                                           ZA25904
&CI555   SETC  'AOST3'
         COPY  SGGBLPAK
&SGCTRLC(6)    SETC ''                  MULTIPLE LINKEDIT INTO LPALIB
&SGCTRLC(7)    SETC '&SGCTRLC(20)'      SET VOLUME NO. FOR LPALIB
&SGCTRLC(8)    SETC '&SGCTRLC(19)'      SET UNIT NAME FOR LPALIB
&SGCTRLC(9)    SETC 'LPALIB'            SET DATA SET NAME
&SGCTRLC(10)   SETC ',LET'              SET PARM FIELD
&SGCTRLC(11)   SETC ',RENT'             SET PARM FIELD
&SGCTRLC(12)   SETC ',REFR'             LKED PARM
         COPY  SGLEDPK1
 PUNCH '//&CI555 DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.&CI555'
         COPY  SGLEDPK2
         AIF   (&SGDTCAM EQ 3).NOTCAM                          @OY02233
         AIF   (&SGDMGTB(5) EQ 0).NOTCAM                       @OZ72316
.*
 PUNCH ' ORDER IEDAYQT(P),IEDAYGP,IEDAYII,IEDAYOO,IEDAYAA'
 PUNCH ' ORDER IEDAYLL,IEDAY88,IEDAYHH'
 PUNCH ' INCLUDE &CI555.(IEDAYQT)'
 PUNCH ' INCLUDE &CI555.(IEDAY88)'
 PUNCH ' INCLUDE &CI555.(IEDAYAA)'
 PUNCH ' INCLUDE &CI555.(IEDAYHH)'
 PUNCH ' INCLUDE &CI555.(IEDAYII)'
 PUNCH ' INCLUDE &CI555.(IEDAYLL)'
 PUNCH ' INCLUDE &CI555.(IEDAYOO)'
 PUNCH ' INCLUDE &CI555.(IEDAYGP)'
 PUNCH ' ENTRY   IEDAYQT           FIRST ENTRY POINT '
 PUNCH ' ALIAS   IEDAYQT           FIRST ENTRY POINT '
 PUNCH ' ALIAS   IEDAYQT1          SECOND ENTRY POINT '
 PUNCH ' ALIAS   IEDAYTPQ          THIRD ENTRY POINT '          VS43007
 PUNCH ' NAME    IGC0010A(R)       ALL 8 MODULES IN THIS MEMBER NAME '
.*
         AIF (&SGDTCAM EQ 2).TCAMV2                            @OY02233
.*
 PUNCH ' INCLUDE &CI555.(IEDAY1,IEDAY2)'                       @OZ89018
 PUNCH ' ENTRY IEDAY1'
 PUNCH ' NAME  IGCMC10D(R)'
         AGO   .NOTCAM                                         @OY02233
.*
.TCAMV2  ANOP                                                  @OY02233
 PUNCH ' INCLUDE &CI555.(IEDAY1,IEDAY2,IEDAY1XA)'              @OY02233
 PUNCH ' ENTRY IEDAY1'                                         @OY02233
 PUNCH ' NAME  IGCMC10D(R)'                                    @OY02233
.*                                                             @OY02233
.NOTCAM  ANOP                                                  @OY02233
 PUNCH ' INCLUDE &CI555.(IGC0009C)'                            @OZ77958
         AIF (&SGDTCAM EQ 3).NOTCAM2                           @OY02233
         AIF (NOT &SGDMGTB(5)).NOTCAM2                         @OZ77958
 PUNCH ' INCLUDE &CI555.(IGG09300,IGG09301)'                   @OZ77958
 PUNCH ' INCLUDE &CI555.(IGG09302,IGG09303)'
.NOTCAM2 ANOP                                                  @OZ77958
 SGIKT49C                                                       ZA25904
.NOTSO9C ANOP                                                   ZA25904
         COPY  SGIKJSM1                                        @OZ83425
 PUNCH ' ENTRY IGC0009C   ***  EXPECT IEW0461 FOR THE FOLLOWING:       X
               ***     X'                                      @OY16630
 PUNCH '                 *** IF NO TCAM-IGG09300. IF NO VTAM-IKT0009C. X
               ***     X'                                      @OY16630
 PUNCH '                 *** IF NO SESSION MANAGER-IKTTMPX1'   @OY16630
 PUNCH ' NAME IGC0009C(R)'
.*
 PUNCH ' INCLUDE &CI555.(IGC0009D)'                            @OZ77958
         AIF (&SGDTCAM EQ 3).NOTCAM3                           @OY02233
         AIF (NOT &SGDMGTB(5)).NOTCAM3                         @OZ77958
 PUNCH ' INCLUDE &CI555.(IGG0940A,IGG0940B,IGG0940C)'          @OZ77958
 PUNCH ' INCLUDE &CI555.(IGG0940D,IGG0940E,IGG0940G,IGG09400)'
 PUNCH ' INCLUDE &CI555.(IGG09402,IGG09403,IGG09404,IGG09405)'
 PUNCH ' INCLUDE &CI555.(IGG09406,IGG09407,IGG09408,IGG09409)'
 PUNCH ' INCLUDE &CI555.(IGG0940H,IGG09411)'                   @ZA27085
 PUNCH ' INCLUDE &CI555.(IGG09414,IGG0940X)'                   @OY09829
.NOTCAM3 ANOP                                                  @OZ77958
 SGIKT49D                                                       ZA25904
.NOTSO9D ANOP                                                   ZA25904
         COPY  SGIKJSM2                                        @OZ83425
 PUNCH ' ENTRY IGC0009D    ***  EXPECT IEW0461I FOR THE FOLLOWING:     X
               ***     X'                                      @OY16630
 PUNCH '                *** IF NO TCAM-IGG0940H. IF NO VTAM- IKT0009D. X
               ***     X'                                      @OY16630
 PUNCH '                *** IF NO SESSION MANAGER- IKTTMPX2.'  @OY16630
 PUNCH ' NAME IGC0009D(R)'
.*
 SGIKT410                                                       ZA25904
.NOTSOIO ANOP                                                   ZA25904
.*
 PUNCH '/*'
         MEND
++ MAC      (SGIKJ5EC) DISTLIB(AGENLIB ) .
         MACRO
         SGIKJ5EC
.*C360000                                                      @OZ72316
.*C300500-302000                                               @OZ76414
.*NOCHANGE SHIPPED WITH JCLIN                                  @OY20024
         COPY  SGGBLPAK                                        @OZ72316
         PUNCH ' COPY OUTDD=LPALIB,INDD=AOST3'
         PUNCH ' SELECT MEMBER=(IGG019TX)'
         PUNCH ' SELECT MEMBER=(IGG019TY,IGG019TZ,IGG019T3,IGG019T4)'
         PUNCH ' SELECT MEMBER=(IGG019T5,IGG019T6,IGG019T7,IGG019T8)'
         PUNCH ' SELECT MEMBER=(IGG0196S,IEDAY3,IEEDAY3)'      @OZ76414
         MEND
++ MAC      (SPAUTOPT) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    SPAUTOPT &A
.**********************************************************************
.*                                                                    *
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - SPAUTOPT                                                     *
.*                                                                    *
.*FUNCTION - THE SPAUTOPT MACRO ALLOWS THE USER TO TERMINATE AUTOMA-  *
.*   TIC LINE NUMBERING OR AUTOMATIC CHARACTER PROMPT.                *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*&NAME  SR    1,1                      PREPARE PARM                  *
.*       LA    0,13                     LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN HIGH ORDER  *
.*                                      BYTE OF REGISTER              *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*        CHANGE ACTIVITY                                             *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&A' NE '').ERROR
&NAME    SR    1,1                      PREPARE PARM
         LA    0,13                     LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN HIGH ORDER
.*                                      BYTE IN REG
         SVC   94                       ISSUE SVC
         MEXIT
.ERROR   ANOP
         IHBERMAC 36,,&A
         MEXIT
         MEND
++ MAC      (STATTN  ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STATTN &LINES=,&TENS=,&INPUT=
.**********************************************************************
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*FUNCTION - THE STATTN MACRO IS USED TO SPECIFY THE CONDITIONS UNDER *
.*    WHICH AN ATTENTION IS TO BE SIMULATED BY THE TERMINAL HANDLER.  *
.*    THE SIMULATION ATTENTION MAY NOT BE USED FOR THE LINE DELETE    *
.*   CHARACTER ON INPUT.                                              *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*&NAME  B     *+6                     BRANCH PAST DC'S               *
.*       DC    AL1(10)                  LINES INTEGER                 *
.*       DC    AL1(5)                   TENS INTEGER                  *
.*       SR    0,0                     CLEAR REGISTER                 *
.*       LH    0,*-4                   PUT 2 BYTE PARM. IN REG. 0     *
.*       LA    1,8                      LOAD ENTRY CODE               *
.*       SLL   1,24                     PUT ABOVE IN HIGH ORDER BYTE  *
.*       OR    0,1                      PUT ENTRY CODE IN REG 0       *
.*       CNOP  0,4                                                    *
.*       B     *+8                     BRANCH PAST PARAMETER          *
.*       DC    AL1(244)                 FLAG BYTE                     *
.*       DC    AL3(ADDR)                INPUT ADDRESS                 *
.*       L     1,*-4                   PUT PARAMETER IN REG. 1        *
.*       SVC   94                       ISSUE STATUS SVC              *
.*                                                                    *
.*       CHANGE ACTIVITY                                              *
.* NOCHANGE SHIPPED WITH JCLIN                                 @OY20024
.**********************************************************************
         LCLA  &SW
       AIF   ('&LINES' EQ '' AND '&TENS' EQ '' AND '&INPUT' EQ '').ERR
         AIF   ('&LINES' EQ '').NULLNES
&SW      SETA  X'80'
         AIF   ('&LINES'(1,1) EQ '(' OR '&LINES' EQ '0').LINES0
         AIF   (&LINES GT 255 OR &LINES LT 0).ERROR
&NAME    B     *+6                     BRANCH PAST DC'S
         DC    AL1(&LINES)              LINES INTEGER
         AGO   .CKTENS
.LINES0  ANOP
&NAME    B     *+6                     BRANCH PAST DC'S
         DC    X'00'                   LINES=0,IN REG.,NOT SPECIFIED
         AGO   .CKTENS
.NULLNES ANOP
&SW      SETA  X'00'
         AGO   .LINES0
.CKTENS  AIF   ('&TENS' EQ '').TENS0
&SW      SETA  &SW+X'40'
         AIF   ('&TENS'(1,1) EQ '(' OR '&TENS' EQ '0').TENS0
         AIF   (&TENS GT 255 OR &TENS LT 0).ERROR2
         DC    AL1(&TENS)               TENS INTEGER
         AGO   .LOAD0
.TENS0   ANOP
         DC    X'00'                   TENS=0,IN REG.,NOT SPECIFIED
.LOAD0   LH    0,*-2                   PUT 2 BYTE PARM. IN REG. 0
         SLL   0,16                    CLEAR HIGH ORDER
         SRL   0,16                    PORTION OF REG. 0
         AIF   ('&LINES' EQ '').CKTREG
         AIF   ('&LINES'(1,1) NE '(').CKTREG
         LR    1,&LINES                PUT LINES INTEGER IN REG. 1
         SLL   1,24                     TRUNCATE IF MORE THAN 255
         SRL   1,16                     PUT INTEGER IN 3RD BYTE
         OR    0,1                      PUT LINES INTEGER IN REG 0
.CKTREG  AIF   ('&TENS' EQ '').ENTRYCD
         AIF   ('&TENS'(1,1) NE '(').ENTRYCD
         LR    1,&TENS                 PUT TENS INTEGER IN REG. 1
         SLL   1,24                     TRUNCATE IF MORE THAN 255
         SRL   1,24                     PUT INTEGER IN LOW ORDER BYTE
         OR    0,1                      PUT TENS INTEGER IN REG 0
.ENTRYCD LA    1,8                      LOAD ENTRY CODE
         SLL   1,24                     PUT ABOVE IN HIGH ORDER BYTE
         OR    0,1                      PUT ENTRY CODE IN REG 0
.CKINPUT AIF   ('&INPUT' EQ '').LOADSW
&SW      SETA  &SW+X'20'
.LOADSW  ANOP
         CNOP  0,4
         B     *+8                     BRANCH PAST PARAMETER
         DC    AL1(&SW)                FLAG BYTE
         AIF   ('&INPUT' EQ '').INPUT0
         AIF   ('&INPUT'(1,1) EQ '(').INPUT0
         DC    AL3(&INPUT)             INPUT ADDRESS
         AGO   .LOAD1
.INPUT0  ANOP
         DC    AL3(0)
.LOAD1   L     1,*-4                   PUT PARAMETER IN REG. 1
         AIF   ('&INPUT' EQ '').SVC
         AIF   ('&INPUT'(1,1) NE '(').SVC
         LA    &INPUT,0(&INPUT)        CLEAR HIGH ORDER BYTE
         OR    1,&INPUT                PUT PARAMETER IN REG. 1
.SVC     SVC   94                      ISSUE SVC
         MEXIT
         IHBERMAC   24
.ERR     MEXIT
.ERROR   IHBERMAC 54,,&LINES
         MEXIT
.ERROR2  IHBERMAC 54,,&TENS
         MEND
++ MAC      (STAUTOCP) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STAUTOCP &A
.**********************************************************************
.*                                                                    *
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STAUTOCP                                                     *
.*                                                                    *
.*FUNCTION - THIS MACRO GIVES THE USER THE ABILITY TO REQUEST AUTO-   *
.*   MATIC CHARACTER PROMPT.                                          *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*       CNOP  0,4                                                    *
.*&NAME  SR    1,1                      PREPARE PARM                  *
.*       LA    0,12                     LOAD ENTRY CODE               *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*     CHANGE ACTIVITY                                                *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&A' NE '').ERROR
         CNOP  0,4
&NAME    SR    1,1                      PREPARE PARM
         LA    0,12                     LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN LEFT MOST
*                                       BYTE OF REGISTER
         SVC   94                       ISSUE SVC
         MEXIT
.ERROR   ANOP
         IHBERMAC 36,,&A
         MEXIT
         MEND
++ MAC      (STAUTOLN) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STAUTOLN &S=,&I=
.**********************************************************************
.*                                                                    *
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STAUTOLN                                                     *
.*                                                                    *
.*FUNCTION - THIS MACRO IS USED TO ALLOW THE USER TO REQUEST AUTO-    *
.*   MATIC LINE NUMBERING.                                            *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*&NAME  LA    1,ADDR1                  PUT ADDR OF S VALUE IN REG 1  *
.*       LA    0,9                      LOAD ENTRY CODE IN REG 0      *
.*       SLL   0,24                     SHIFT ENTRY CODE TO HIGH ORDER*
.*       OR    0,1                      PUT ADDR OF S VALUE IN REG 0  *
.*       LA    1,ADDR2                  PUT ADDR OF 2 VALUE IN REG 1  *
.*       SVC   94                       ISSUE STATUS SVC              *
.*                                                                    *
.*      CHANGE ACTIVITY                                               *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&S' EQ '' OR '&I' EQ '').ERROR
         AIF   ('&S'(1,1) EQ '(').SREG
&NAME    LA    1,&S                     PUT ADDR OF S VALUE IN REG 1
         AGO   .ENTRYCD
.SREG    ANOP
&NAME    LR    1,&S                     PUT ADDR OF S VALUE IN REG 1
         LA    1,0(1)                  CLEAR HIGH ORDER BYTE
.ENTRYCD LA    0,9                      LOAD ENTRY CODE IN REG 0
         SLL   0,24                     PUT ENTRY CODE IN HIGH ORDER
         OR    0,1                     PUT ADDR. OF S VALUE IN REG. 0
         AIF   ('&I'(1,1) EQ '(').IREG
         LA    1,&I                    PUT ADDR. OF I VALUE IN REG. 1
         AGO   .SVC
.IREG    LR    1,&I                    PUT ADDR. OF I VALUE IN REG. 1
         LA    1,0(1)                  CLEAR HIGH ORDER BYTE
.SVC     SVC   94                      ISSUE SVC 94
         MEXIT
.ERROR  IHBERMAC 24
         MEND
++ MAC      (STBREAK ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STBREAK &A                     PROTOTYPE
.**********************************************************************
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STBREAK                                                      *
.*                                                                    *
.*FUNCTION - THE STBREAK MACRO IS USED TO SPECIFY THE PRESENCE OR     *
.*   ABSENCE OF THE BREAK FEATURE (APPLICABLE TO IBM 1050 AND 2741    *
.*   TERMINALS).                                                      *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*&NAME  LA    1,128                    LOAD FLAG BYTE                *
.*       SLL   1,24                     PUT ABOVE IN LEFT MOST OF REG *
.*       LA    0,4                      LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN LEFT MOST   *
.*                                      BYTE OF REGISTER              *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*       CHANGE ACTIVITY                                              *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&A' EQ 'YES' OR '&A' EQ '').BREAK
         AIF   ('&A' EQ 'NO').NOBREAK
.ERROR   IHBERMAC 36,,&A
         MEXIT                          EXIT
.BREAK   ANOP
&NAME    LA    1,128                    PREPARE FLAG BYTE
         SLL   1,24                     PREPARE PARAMETER
         AGO   .ENTRYCD                 GO TO ENTRYCD
.NOBREAK ANOP
&NAME    SR    1,1                      PREPARE PARAMETER
.ENTRYCD LA    0,4                      LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN LEFT MOST
.*                                      BYTE OF REGISTER
         SVC   94 .                     ISSUE ASSOCIATED SVC
         MEND
++ MAC      (STCC    ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STCC  &ATN,&LD=,&CD=
.**********************************************************************
.*                                                                    *
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STCC                                                         *
.*                                                                    *
.*FUNCTION - THE STCC MACRO ALLOWS THE USER TO SPECIFY TERMINAL       *
.*   CONTROL CHARACTERS FOR LINE DELETING AND CHARACTER DELETING.     *
.*                                                                    *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF EXPANSION IS BELOW                      *
.*                                                                    *
.*       CNOP  0,4                                                    *
.*&NAME  BAL   1,*+8                    BRANCH PAST DC'S              *
.*       DC    AL1(176)                 FLAG BYTE                     *
.*       DC    X'00'                    NOT USED                      *
.*       DC    C'$'                     LINE-DELETER CHAR             *
.*       DC    C'?'                     CHAR-DELETER CHAR             *
.*       L     1,0(1)                   LOAD PARM IN REG              *
.*       LA    0,7                      LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN HIGH ORDER  *
.*                                      BYTE OF REGISTER              *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*       CHANGE ACTIVITY                                              *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         LCLA  &SW
         AIF   ('&ATN' EQ  '' AND '&LD' EQ '' AND '&CD' EQ  '').ERR
         AIF   ('&ATN' EQ '').NOTHING
         AIF   ('&ATN' EQ 'NATN').NOATT
         AIF   ('&ATN' EQ 'ATTN').ATT
         AGO   .ERROR
.ATT     ANOP
&SW      SETA  X'C0'                    FLAG FOR ATTN SPECIFIED
         AGO   .CKLD                    GO TO CHECK LD
.NOTHING ANOP
&SW      SETA  X'00'                    FLAG FOR 1ST OPERAND NOT THERE
         AGO   .CKLD                    GO TO CHECK LD
.NOATT   ANOP
&SW      SETA  X'80'                    FLAG FOR NATN SPECIFIED
.CKLD    AIF   ('&LD' EQ '').CKCD
&SW      SETA  &SW+X'20'                FLAG FOR LD SPECIFIED
.CKCD    AIF   ('&CD' EQ '').STUPFLG
&SW      SETA  &SW+X'10'                FLAG FOR CD SPECIFIED
.STUPFLG ANOP
         CNOP  0,4
&NAME    BAL   1,*+8                    REG 1 POINTS AT DC LIST
         DC    AL1(&SW)                 FLAG BYTE
         DC    X'00'                    NOT USED
         AIF   ('&LD' EQ '').LD0
         AIF   ('&LD'(1,1) EQ '(').LD0
         DC    &LD                      LD CHAR
         AGO   .CHKCD
.LD0     DC    X'00'                    LD NOT SPECIFIED OR LD IN REG
.CHKCD   AIF   ('&CD' EQ '').CD0
         AIF   ('&CD'(1,1) EQ '(').CD0
         DC    &CD                      CD CHAR
         AGO   .LOAD
.CD0     DC    X'00'                    CD NOT SPECIFIED OR CD IN REG
.LOAD    L     1,0(1)                   LOAD PARM
         AIF   ('&LD' EQ '').CKCDREG
         AIF   ('&LD'(1,1) NE '(').CKCDREG
         LR    0,&LD                    PUT LD CHAR IN REG 0
         SLL   0,8                      SHIFT LD CHAR LEFT ONE BYTE
         OR    1,0                      PUT LD CHAR IN REG 1
.CKCDREG AIF   ('&CD'EQ '').ENTRYCD
         AIF   ('&CD'(1,1) NE '(').ENTRYCD
.CDREG   OR    1,&CD                    PUT CD CHAR IN REG 1
.ENTRYCD LA    0,7                      LOAD ENTRY CODE
         SLL   0,24                     PUT ABOVE IN HIGH ORDER BYTE
         SVC   94                       ISSUE SVC
         MEXIT
.ERROR   IHBERMAC 54,,&ATN
         MEXIT
.ERR     IHBERMAC   24
         MEND
++ MAC      (STCLEAR ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STCLEAR &STRING=               PROTOTYPE
.**********************************************************************
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STCLEAR                                                      *
.*                                                                    *
.*FUNCTION - THIS MACRO IS USED TO SPECIFY THE CHARACTER STRING THAT  *
.*   WILL BE USED TO REQUEST THAT A DISPLAY STATION SCREEN CAN BE     *
.*   ERASED.                                                          *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*NAME   LA    1,CHAR                   PUT ADDR OF CHAR STRING IN REG*
.*       LA    0,16                     LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN HIGH ORDER  *
.*       SVC   94                       ISSUE STATUS SVC              *
.*                                                                    *
.*      CHANGE ACTIVITY                                               *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&STRING' EQ '').ERROR
         AIF   ('&STRING' EQ '0').ZERO
         AIF   ('&STRING'(1,1) EQ '(').REG
&NAME    LA    1,&STRING .              PUT ADDR OF CHAR STRING IN REG
         AGO   .ENTRYCD .
.REG     ANOP
&NAME    LR    1,&STRING .              PUT ADDR OF CHAR STRING IN REG
         AGO   .ENTRYCD
.ZERO    ANOP
&NAME    SR    1,1 .                    ZERO OUT REG
.ENTRYCD LA    0,16 .                   LOAD ENTRY CODE
         SLL   0,24 .                   PUT ABOVE IN HIGH ORDER
         SVC   94 .                     ISSUE STATUS SVC
         AGO   .EXIT
.ERROR   IHBERMAC 24
.EXIT    ANOP
         MEND
++ MAC      (STCOM   ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STCOM &A                       PROTOTYPE
.**********************************************************************
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STCOM                                                        *
.*                                                                    *
.*FUNCTION - THE STCOM MACRO IS USED TO SPECIFY WHETHER OR NOT THE    *
.*   USER WISHES TO RECEIVE INTER-TERMINAL COMMUNICATIONS.            *
.*                                                                    *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*&NAME  LA    1,128                    LOAD FLAG BYTE                *
.*       SLL   0,24                     PUT ENTRY CODE IN LEFT MOST   *
.*                                      BYTE OF REGISTER              *
.*       LA    0,5                      LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN LEFT MOST   *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*       CHANGE ACTIVITY                                              *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&A' EQ 'YES' OR '&A' EQ '').COM
         AIF   ('&A' EQ 'NO').NOCOM
.ERROR   IHBERMAC 36,,&A
         MEXIT                          EXIT
.COM     ANOP
&NAME    LA    1,128                    LOAD FLAG BYTE
         SLL   1,24                     PUT ABOVE IN LEFT MOST OF REG
         AGO   .ENTRYCD                 GO TO ENTRYCD
.NOCOM   ANOP
&NAME    SR    1,1                      PREPARE PARM
.ENTRYCD LA    0,5                      LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN LEFT MOST
.*                                      BYTE OF REGISTER
         SVC   94                       ISSUE SVC
         MEND
++ MAC      (STSIZE  ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STSIZE &SIZE=,&SIZELOC=,&LINE=,&LINELOC=
.**********************************************************************
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STSIZE                                                       *
.*                                                                    *
.*FUNCTION - THE STSIZE MACRO IS USED TO SPECIFY THE LINE SIZE OF THE *
.*   TERMINAL. THE MAXIMUM LINE SIZE THAT CAN BE SPECIFIED IS 255.    *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF EXPANSION IS BELOW                      *
.*                                                                    *
.*&NAME  L     0,10                     LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN LEFT MOST   *
.*                                      BYTE OF REGISTER              *
.*       L     1,15                     LOAD LINE NUMBER              *
.*       OR    0,1                      PUT LINE NUMBER IN PARM REG   *
.*       L     1,120                    LOAD LINE SIZE                *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*      CHANGE ACTIVITY                                               *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
&NAME    LA    0,10                     LOAD ENTRY CODE
         SLL   0,24                     PUT CODE IN HIGH ORDER BYTE
         AIF   ('&LINE' NE '' AND '&LINELOC' EQ '').LNHERE
         AIF ('&LINE' NE '' AND '&LINELOC' NE '').ERROR
         AIF   ('&LINE' EQ '' AND '&LINELOC' NE '').LNADDR
         AGO  .SZLC
.LNHERE  AIF   ('&LINE'(1,1) EQ '(').LNREG
         LA    1,&LINE                  PUT LINE NUMBER IN REG
         AGO   .OREG
.LNREG   LR    1,&LINE                  PUT LINE NUMBER IN REG
         AGO   .OREG
.LNADDR  AIF   ('&LINELOC'(1,1) EQ '(').LNADDRG
         L     1,&LINELOC               GET LINE NUMBER
         AGO   .OREG
.LNADDRG L     1,0(&LINELOC)            GET LINE NUMBER
.OREG    OR    0,1                      PUT LINE NUMBER IN PARM REG
.SZLC    AIF ('&SIZE' NE '' AND '&SIZELOC' NE '').ERROR
         AIF ('&SIZE' EQ '' AND '&SIZELOC' EQ '').ERROR1
         AIF   ('&SIZE' NE '' AND '&SIZELOC' EQ '').SZHERE
         AIF   ('&SIZE' EQ '' AND '&SIZELOC' NE '').SZADDR
         AGO   .ERROR
.SZHERE  AIF   ('&SIZE'(1,1) EQ '(').SZREG
         LA    1,&SIZE
         AGO   .EXIT
.SZREG   ANOP
         LR    1,&SIZE                  PREPARE PARAMETER
         AGO   .EXIT
.SZADDR  AIF   ('&SIZELOC'(1,1) EQ '(').ADDREG
         L     1,&SIZELOC               PREPARE PARAMETER
         AGO   .EXIT
.ADDREG  ANOP
         L     1,0(&SIZELOC)            LOAD LINE SIZE
.EXIT    SVC   94                       ISSUE SVC
         MEXIT
.ERROR1  IHBERMAC 8,,,
         MEXIT
.ERROR   IHBERMAC 54,,,
         MEXIT
         MEND
++ MAC      (STTIMEOU) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STTIMEOU &A                    PROPOTYPE
.**********************************************************************
.*                                                                    *
.*RELEASE 23 DELETIONS                                                *
.*                                                                    *
.*RELEASE 22 DELETIONS                                                *
.*                                                                    *
.*RELEASE 21 DELETIONS                                                *
.*                                                                    *
.*STATUS - CHANGE LEVEL 000                                           *
.*                                                                    *
.*NAME - STTIMEOU                                                     *
.*                                                                    *
.*FUNCTION - THE STTIMEOU MACRO IS USED TO SPECIFY WHETHER OR NOT THE *
.*   TERMINAL HAS THE TIMEOUT FEATURE.                                *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*                                                                    *
.*&NAME  LA    1,128                    LOAD FLAG BYTE                *
.*       SLL   1,24                     PUT ABOVE IN LEFT MOST IN REG *
.*       LA    0,6                      LOAD ENTRY CODE               *
.*       SLL   0,24                     PUT ENTRY CODE IN LEFT MOST   *
.*                                      BYTE OF REGISTER              *
.*       SVC   94                       ISSUE SVC                     *
.*                                                                    *
.*      CHANGE ACTIVITY                                               *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         AIF   ('&A' EQ 'YES' OR '&A' EQ '').TIMEOUT
         AIF   ('&A' EQ 'NO').NOTMOUT
.ERROR   IHBERMAC 36,,&A
         MEXIT                          EXIT
.TIMEOUT ANOP
&NAME    LA    1,128                    LOAD FLAG BYTE
         SLL   1,24                     PUT ABOVE IN LEFT MOST OF REG
         AGO   .ENTRYCD                 GO TO ENTRYCD
.NOTMOUT ANOP
&NAME    SR    1,1                      PREPARE FLAG BYTE
.ENTRYCD LA    0,6                      LOAD ENTRY CODE
         SLL   0,24                     PUT ENTRY CODE IN LEFT MOST
.*                                      BYTE OF REGISTER
         SVC   94                       ISSUE SVC
         MEND
++ MAC      (STTMPMD ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    STTMPMD &A,&KEYS=NO
.**********************************************************************
.*                                                                    *
.* STATUS - NEW MACRO                                           ZA24648
.*                                                                    *
.* NAME - STTMPMD   (SET TMP         MODE)                            *
.*                                                                    *
.* FUNCTION - THE STTMPMD MACRO IS USED TO SPECIFY WHETHER OR NOT     *
.*            AN APPLICATION IS PRESENTING DISPLAYS TO A TSO          *
.*            DISPLAY TERMINAL AS THE TERMINAL CONTROLLER.            *
.*                                                                    *
.*       THE MACRO PROTOTYPE IS ABOVE                                 *
.*                                                                    *
.*       THE STANDARD FORM OF THE EXPANSION IS BELOW                  *
.*&NAME  LA    1,128+64                 SET PARM FLAGS                *
.*       SLL   1,24                     SHIFT TO HIGH ORDER BYTE      *
.*       LA    0,20                     LOAD ENTRY CODE               *
.*       SLL   0,24                     SHIFT TO HIGH ORDER BYTE      *
.*       SVC   94                       TERMINAL CONTROL MACRO SVC    *
.*                                                                    *
.*      CHANGE ACTIVITY                                               *
.* NOCHANGE SHIPPED WITH JCLIN                                @OY20024*
.**********************************************************************
         LCLA  &SYSTMP
         LCLA  &SYSKEYS
&SYSTMP  SETA  128
&SYSKEYS SETA  0
         AIF   ('&KEYS' NE 'ALL' AND '&KEYS' NE 'NO').ERROR1
         AIF   ('&KEYS' EQ 'NO').TESTA
&SYSKEYS SETA  64
.TESTA   ANOP
         AIF   ('&A' EQ 'ON' OR '&A' EQ '').FSON
         AIF   ('&A' NE 'OFF').ERROR
.FSOFF   ANOP
&SYSTMP  SETA  0
.FSON    ANOP
&NAME    LA    1,&SYSTMP+&SYSKEYS       SET PARM FLAGS
         SLL   1,24                     SHIFT TO HIGH ORDER BYTE
         LA    0,20                     LOAD ENTRY CODE
         SLL   0,24                     SHIFT TO HIGH ORDER BYTE
         SVC   94                       TERMINAL CONTROL MACRO SVC
         MEXIT
.ERROR   IHBERMAC 36,,&A
         MEXIT
.ERROR1  IHBERMAC 54,,,
         MEND
++ MAC      (TCLEARQ ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    TCLEARQ &OPT
.*********************************************************************.
.*                                                                   *.
.*RELEASE 23 DELETIONS                                               *.
.*                                                                   *.
.*RELEASE 22 DELETIONS                                               *.
.*                                                                   *.
.*RELEASE 21 DELETIONS                                               *.
.*                                                                   *.
.*STATUS - CHANGE LEVEL 000                                          *.
.*                                                                   *.
.*NAME - TCLEARQ                                                     *.
.*                                                                   *.
.*FUNCTION - THE TCLEARQ MACRO CLEARS THE TIOC INPUT OR OUTPUT QUEUE.*.
.*   IF INPUT IS SPECIFIED, THE TERMINAL INPUT QUEUE WILL BE FLUSHED *.
.*   INCLUDING ANY LINE CURRENTLY BEING ENTERED. IF OUTPUT IS        *.
.*   SPECIFIED, THE ENTIRE TIOC OUTPUT QUEUE WILL BE FLUSHED.        *.
.*                                                                   *.
.*                                                                   *.
.*   TCLEARQ INPUT OR OUTPUT (DEFAULT IS INPUT)                      *.
.*                                                                   *.
.*    CHANGE ACTIVITY                                                *.
.* NOCHANGE SHIPPED WITH JCLIN                               @OY20024*.
.*********************************************************************.
         AIF   ('&OPT' EQ 'INPUT' OR '&OPT' EQ '' OR '&OPT' EQ         X
               'OUTPUT').EXPAND
.ERROR   IHBERMAC 49,,&OPT
         MEXIT
.EXPAND  ANOP
&NAME    LA    0,1                      SET ENTRY CODE
         AIF   ('&OPT' EQ 'OUTPUT').OUT
         LA    1,X'80'                  INDICATE INPUT
         AGO   .SVC
.OUT     SR    1,1                      INDICATE OUTPUT
.SVC     SLDL  0,24                     MOVE TO HI-ORDER BYTES
         SVC   94                       ISSUE SVC
         MEND
++ MAC      (TGET    ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    TGET  &BFF,&SIZE,&EDIT,&WAIT,&MF=                     @G76XRYU
.*                                                                 @01A
.* $MAC(TGET) COMP(Y@) PROD(TIOC):                                 @01A
.*                                                                 @01A
.* CHANGE ACTIVITY =                                               @01A
.* A000000-999999                                              @G76XR00
.* C44364000,44376000                                          @OZ42972
.* $01=OZ43111  ETI1106  79.11.28  579667:                         @01A
.* C448976                                                     @ZA44765
.*A449080,452744                                               @OZ46729
.*C449080,449918-450546,458396-458710                          @OZ48875
.*A447300                                                      @OZ49617
.*C469700                                                      @OZ49617
.*C450608                                                      @OZ51683
.*C018000,447312-447348                                        @OZ56262
.*A447660                                                      @OZ56262
.*A178000                                                      @OZ72869
.*                                                                 @01A
.* NOCHANGE SHIPPED WITH JCLIN                                 @OY20024
         LCLA  &FLAGON,&FLAGOFF,&OPT,&BFFPOS                   @OZ56262
         LCLB  &RET,&E,&W                                          @01C
         LCLC  &ERROPT,&NDX                                    @G76XRYU
&NDX     SETC  '&SYSNDX'                                       @G76XRYU
&OPT     SETA  X'80'
&FLAGON  SETA  128                  ..SET TGET OPT FOR EX FORM @OZ72869
&FLAGOFF SETA  145                     ..SET FOR AND OPERATION @G76XRYU
         AIF   (N'&SYSLIST LE 4).POSOPOK  ..# POS. OPERANDS OK @G76XRYU
         MNOTE 12,'IHB300 EXCESSIVE POSITIONAL OPERANDS SPECIFIED'
         MEXIT                                                 @G76XRYU
.POSOPOK ANOP                            ..CHECK VALID MF PARM @G76XRYU
         AIF   ('&MF' EQ '').FORMOK                            @G76XRYU
         AIF   ('&MF' EQ 'I' OR '&MF' EQ 'L' OR ('&MF(1)' EQ 'E' AND N'X
               &MF EQ 2)).FORMOK                               @G76XRYU
         MNOTE 12,'IHB303 INVALID OPERAND MF=&MF'              @G76XRYU
         MEXIT                                                 @G76XRYU
.FORMOK  ANOP                                                  @G76XRYU
         AIF   (('&BFF' EQ '' OR '&SIZE' EQ '') AND ('&MF' EQ '' OR '&MX
               F' EQ 'I')).ERROR1   ..STANDARD FORM ERROR..    @G76XRYU
         AIF   ('&EDIT' EQ 'R').RF      CHECK FOR R FORM
         AIF   ('&EDIT' EQ '').WAIT       SKIP IF NULL
         AIF   ('&EDIT' EQ 'EDIT').EDI    SET EDIT
         AIF   ('&EDIT' EQ 'ASIS').ASI    SET ASIS
         AIF   ('&EDIT' EQ 'WAIT').WAI    SET WAIT (EDIT PARM OMITTED)
         AIF   ('&EDIT' EQ 'NOWAIT').NOW  SET NOWAIT (EDIT OMITTED)
&ERROPT  SETC  '&EDIT'                  SET FOR ERROR MSG
         AGO   .ERROR3
.WAIT    ANOP
&RET     SETB  1
         AIF   ('&WAIT' EQ '').CHKFORM    SKIP IF NULL
         AIF   ('&WAIT' EQ 'EDIT').EDI    SET EDIT
         AIF   ('&WAIT' EQ 'ASIS').ASI    SET ASIS
         AIF   ('&WAIT' EQ 'WAIT').WAI    SET WAIT
         AIF   ('&WAIT' EQ 'NOWAIT').NOW  SET NOWAIT
&ERROPT  SETC  '&WAIT'                  SET FOR ERROR MSG
         AGO   .ERROR3
.EDI     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&FLAGOFF SETA  &FLAGOFF-1               EDIT FOR EXEC FORM     @G76XRYU
         AGO   .RET
.ASI     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&OPT     SETA  &OPT+1                   ASIS OPTION            @G76XRYU
&FLAGON  SETA  &FLAGON+1                SET ASIS FOR EXECUTE   @G76XRYU
         AGO   .RET
.WAI     ANOP
         AIF   (&W).ERROR2              DUP OPTION
&W       SETB  1                        WAIT OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-16              SET WAIT OPTION FOR EX @G76XRYU
         AGO   .RET
.NOW     ANOP
         AIF   (&W).ERROR2              DUP OPTION
&W       SETB  1                        WAIT OPTION SPECIFIED
&OPT     SETA  &OPT+16                  NOWAIT OPTION          @G76XRYU
&FLAGON  SETA  &FLAGON+16               SET NOWAIT OPT FOR EX  @G76XRYU
         AGO   .RET
.RET     ANOP
         AIF   (&RET).CHKFORM                                  @G76XRYU
         AGO   .WAIT                    NEXT POSITION
.CHKFORM ANOP                                                  @G76XRYU
         AIF   ('&MF' EQ 'L').LFORM    ..LIST EXPANSION...     @G76XRYU
         AIF   ('&MF' EQ 'I' OR '&MF' EQ '').OLDFORM STANDARD      @01C
.******************                                            @G76XRYU
.*  EXECUTE FORM  *                                            @G76XRYU
.******************                                            @G76XRYU
&NAME    CNOP  0,4                     TGET EXECUTE FORM       @G76XRYU
         AIF   ('&MF(2)'(1,1) EQ '(').MFREG  ..IF PARM IS RX.. @G76XRYU
         LA    1,&MF(2)                R1=> EXECUTE PARM LIST  @G76XRYU
         AGO   .GOTPARM                                        @G76XRYU
.MFREG   ANOP                                ..ELSE, IN A REG. @G76XRYU
         AIF   ('&MF(2)' EQ '(1)').GOTPARM  ..IF NOT REG 1..   @G76XRYU
         LR    1,&MF(2)                POINT R1 AT PARM LIST   @G76XRYU
.GOTPARM ANOP                    ...CHECK FLAG BIT SETTINGS    @G76XRYU
         MVI   0(1),0                  INSURE HI BIT OF R0 OFF @G76XRYU
         AIF   (&FLAGOFF EQ 145).SKIPAND .ANY FLAGS TURNED OFF @G76XRYU
         NI    4(1),&FLAGOFF           RESET TGET FLAGS1       @G76XRYU
.SKIPAND ANOP                    ...CHECK FOR FLAGS TO TURN ON @G76XRYU
         AIF   (&FLAGON EQ 0).PARMCK ..SKIP OR IF NO RESETS    @G76XRYU
         OI    4(1),&FLAGON            RESET TGET FLAGS 1      @G76XRYU
.PARMCK  ANOP                                                      @01C
         AIF   ('&SIZE' EQ '').CKBUFF  ...IF BUFF SIZE GIVEN.. @G76XRYU
         AIF   ('&SIZE'(1,1) EQ '(').SIZEREG ..IF INTEGER FORM @G76XRYU
         AIF   (T'&SIZE NE 'N').AROUND         .VALID & ^ NEG. @OZ42972
         AIF   (&SIZE GT 32767).SIZERR          ..NOT > 32767. @G76XRYU
.AROUND  ANOP                                                      @01C
         B     *+6                      BR AROUND SIZE             @01C
         DC    AL2(&SIZE)               SIZE CAN EXCEED 4095       @01C
         LH    0,*-2                   GET THE SIZE VALUE      @G76XRYU
         STH   0,2(1)                  INTO THE PARM LIST      @G76XRYU
         AGO   .CKBUFF                                         @G76XRYU
.SIZEREG ANOP                                  ..ELSE A REG..  @G76XRYU
         STH   &SIZE(1),2(1)           PUT BUFFER SIZE IN PARM @G76XRYU
.CKBUFF  ANOP                                                  @G76XRYU
         AIF   ('&BFF' EQ '').LOAD      ..IF A BUFF ADDR GIVEN @G76XRYU
         AIF   ('&BFF'(1,1) EQ '(').BUFFREG  ..IF AN RX ADDR.. @G76XRYU
         LA    0,&BFF                  GET ADDR OF INPUT BUFF  @G76XRYU
         STCM  0,B'0111',5(1)          PUT IN THE PARM LIST    @G76XRYU
         AGO   .LOAD                                           @G76XRYU
.BUFFREG ANOP                                ..ELSE A REG..    @G76XRYU
         STCM  &BFF(1),B'0111',5(1)    STORE BUFF ADDR IN PARM @G76XRYU
.LOAD    ANOP                          ..LOAD 0 & 1 FOR SVC..  @G76XRYU
         LM    0,1,0(1)                REG 0: BUFFER SIZE      @G76XRYU
*                                      REG 1: FLAGS,BUFF ADDR  @G76XRYU
         AGO   .SVC                                                @01C
.******************                                            @G76XRYU
.*   LIST FORM    *                                            @G76XRYU
.******************                                            @G76XRYU
.LFORM   ANOP                                                  @G76XRYU
&NAME    DS    0F                      TGET LIST FORM          @G76XRYU
         DC    H'0'                    MUST BE 0 FOR TGET      @G76XRYU
         AIF   ('&SIZE' NE '').LSTSIZE  ..IF NO BUFFER SIZE..  @G76XRYU
         DC    H'0'                    BUFFER SIZE HALFWORD    @G76XRYU
         AGO   .LBFADDR                                        @G76XRYU
.LSTSIZE ANOP                           ..ELSE A BUFFER SIZE.. @G76XRYU
         AIF   ('&SIZE'(1,1) EQ '(').REGERR  ..IF NOT A REG..  @G76XRYU
         AIF   (T'&SIZE NE 'N').ARNSIZL IF AN INTEGER              @01C
         AIF   (&SIZE GT 32767).SIZERR        .AND NOT >32767. @G76XRYU
.ARNSIZL DC    AL2(&SIZE)              INPUT BUFFER SIZE           @01C
.LBFADDR ANOP                          ...CHECK FOR BUFF ADDR. @G76XRYU
         DC    AL1(&OPT)               TGET FLAGS              @G76XRYU
         AIF   ('&BFF' NE '').LBFFLAB  ..IF NO BUFFER ADDR..   @G76XRYU
         DC    AL3(0)                  INPUT BUFFER ADDRESS    @G76XRYU
         MEXIT                                                 @G76XRYU
.LBFFLAB ANOP                          ..ELSE BUFFER ADDRESS.. @G76XRYU
         AIF   ('&BFF'(1,1) EQ '(').REGERR  ..IF NOT A REG..   @G76XRYU
&BFFPOS  SETA  2                                               @OZ56262
.LRXCK   ANOP                                                  @OZ56262
         AIF   (&BFFPOS GT K'&BFF).LBFFOK                      @OZ56262
         AIF   ('&BFF'(&BFFPOS,1) EQ '(').RXERR                @OZ56262
&BFFPOS  SETA  &BFFPOS+1                                       @OZ56262
         AGO  .LRXCK                                           @OZ56262
.LBFFOK  ANOP                                                  @OZ56262
         DC    AL3(&BFF)               INPUT BUFFER ADDRESS    @G76XRYU
         MEXIT                                                 @G76XRYU
.REGERR  ANOP                                                  @G76XRYU
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L, REGISTER OPERAND*
                SPECIFIED'                                     @G76XRYU
         MEXIT                                                 @G76XRYU
.RXERR   ANOP                                                  @OZ56262
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L, RX FORM OPERAND X
                SPECIFIED'                                     @OZ56262
         MEXIT                                                 @OZ56262
.OLDFORM AIF   ('&BFF'(1,1) EQ '(' OR '&SIZE'(1,1) EQ '(').REGST   @01C
.*                                                                 @01P
.*   REGULAR EXPANSION                                             @01P
.*                                                                 @01P
         CNOP  0,4                                             @OZ46729
&NAME    DS    0F                                              @OZ46729
         B     *+8                     BRANCH AROUND CONSTANTS @OZ48875
         DC    AL1(&OPT,0)             OPTION BYTE AND FILLER  @OZ48875
         DC    AL2(&SIZE)               BUFFER SIZE                @01P
         L     0,*-4                    LOAD SIZE              @OZ48875
         LA    1,&BFF                   LOAD BUFFER ADDRESS    @OZ48875
         ICM   1,8,*-12                 LOAD OPTION BYTE       @OZ48875
         ICM   0,8,*-15                 CLEAR HIGH ORDER BYTE  @OZ51683
.SVC     SVC   93                       ISSUE SVC                  @01P
         SPACE 1                                                   @01C
         MEXIT                                                     @01P
.*                                                                 @01P
.*   REGISTER NOTATION                                             @01P
.*                                                                 @01P
.REGST   ANOP                                                      @01P
         CNOP  0,4                                             @OZ46729
&NAME    B     *+8                      BRANCH AROUND CONSTANT     @01P
         AIF   ('&BFF'(1,1) EQ '(' AND '&SIZE'(1,1) EQ '(').BOTH   @01C
.*                                      PARAMETERS ARE IN REG FORM @01C
         AIF   ('&SIZE'(1,1) EQ '(').SZREG   SIZE IN REG           @01P
.*                                                                 @01P
.*   BUFFER ADDR IN REGISTER FORM                                  @01P
.*                                                                 @01P
         DC    AL1(&OPT)                OPTION BITS                @01P
         DC    AL3(0)                   BUFFER ADDR                @01P
         LA    1,0(,&BFF(1))            CLR HIGH ORDR BYTE + LD BFR@01P
         O     1,*-8                    SET OPTIONS                @01P
         LA    0,&SIZE                  LOAD SIZE OF BUFFER        @01P
         AGO   .SVC                     GOTO ISSUE SVC             @01P
.*                                                                 @01P
.*   BUFFER SIZE IN REGISTER FORM                                  @01P
.*                                                                 @01P
.SZREG   DC    AL1(&OPT)                OPTION BITS                @01P
         DC    AL3(0)                   FILLER                 @OZ48875
         LA    1,&BFF                   LOAD BUFFER ADDRESS    @OZ48875
         O     1,*-8                    SET OPTIONS            @OZ48875
         AIF   ('&SIZE' EQ '(0)').SVC   SIZE IN REG. 0             @01P
         LR    0,&SIZE(1)               LOAD BUFFER SIZE IN REG 0  @01P
         AGO   .SVC                     GOTO ISSUE SVC             @01P
.*                                                                 @01P
.*   WHEN BOTH ARE IN REGISTER NOTATION                            @01P
.*                                                                 @01P
.BOTH    DC    AL1(&OPT)                OPTION BITS                @01P
         DC    AL3(0)                   BUFFER ADDR                @01P
         LA    1,0(,&BFF(1))            CLR HIGH ORDR BYTE + LD BFR@01P
         O     1,*-8                    SET OPTIONS                @01P
         AIF   ('&SIZE' EQ '(0)').SVC   GOTO SVC IF (0) SPECIFIED  @01P
         LR    0,&SIZE(1)               LOAD BUFFER SIZE IN REG 0  @01P
         AGO   .SVC                     GOTO ISSUE SVC             @01P
.RF      ANOP                                                      @01P
         AIF   ('&WAIT' NE '').RERR                                @01P
         AIF   ('&BFF'(1,1) NE '(' OR '&SIZE'(1,1) NE '(').RERR    @01P
&NAME    DS    0H                                                  @01P
         AIF   ('&BFF' EQ '(1)').SIZE                              @01P
         LR    1,&BFF(1)                LOAD BUFFER ADDRESS IN REG @01P
.SIZE    AIF   ('&SIZE' EQ '(0)').SVC                              @01P
         LR    0,&SIZE(1)               LOAD BUFFER SIZE IN REG 0  @01P
         AGO   .SVC                                                @01P
.SIZERR  MNOTE 12,'IHB300 SIZE NOT IN RANGE 0-32767'               @01C
         MEXIT                                                 @G76XRYU
.RERR    IHBERMAC 192                                              @01P
         MEXIT                                                     @01P
.ERROR1  IHBERMAC 24                                               @01P
         MEXIT                                                     @01P
.ERROR2  IHBERMAC 54,,,                                            @01P
         MEXIT                                                     @01P
.ERROR3  IHBERMAC 49,,&ERROPT                                      @01P
         MEND
         EJECT
TGETTEST CSECT
         USING TGETTEST,12,11,10,9                             @OZ49617
         DS    51X  33 IN HEX
BUFFER   DS    0X
SIZE     EQU   119  77 IN HEX
R2       EQU   2
R3       EQU   3
         TGET BUFFER
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET BUFFER,SIZE
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=I
*        ALL BUFFER + 1 PARM
         TGET BUFFER,SIZE,EDIT
         TGET BUFFER,SIZE,,WAIT
         TGET BUFFER,SIZE,,,MF=I
* ALL BUFFER + 2 PARMS
         TGET BUFFER,SIZE,EDIT,WAIT
         TGET BUFFER,SIZE,EDIT,,MF=I
*        ALL BUFFER +3 PARMS
         TGET BUFFER,SIZE,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=I
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=I
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=I
* ALL SIZE + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (R2),SIZE
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=I
*        ALL (R2) + 1 PARM
         TGET (R2),SIZE,EDIT
         TGET (R2),SIZE,,WAIT
         TGET (R2),SIZE,,,MF=I
* ALL (R2) + 2 PARMS
         TGET (R2),SIZE,EDIT,WAIT
         TGET (R2),SIZE,EDIT,,MF=I
*        ALL (R2) +3 PARMS
         TGET (R2),SIZE,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=I
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=I
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=I
* ALL SIZE + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (2),SIZE
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=I
*        ALL (2) + 1 PARM
         TGET (2),SIZE,EDIT
         TGET (2),SIZE,,WAIT
         TGET (2),SIZE,,,MF=I
* ALL (2) + 2 PARMS
         TGET (2),SIZE,EDIT,WAIT
         TGET (2),SIZE,EDIT,,MF=I
*        ALL (2) +3 PARMS
         TGET (2),SIZE,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=I
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=I
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=I
* ALL SIZE + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET 12(2),SIZE
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=I
*        ALL 12(2) + 1 PARM
         TGET 12(2),SIZE,EDIT
         TGET 12(2),SIZE,,WAIT
         TGET 12(2),SIZE,,,MF=I
* ALL 12(2) + 2 PARMS
         TGET 12(2),SIZE,EDIT,WAIT
         TGET 12(2),SIZE,EDIT,,MF=I
*        ALL 12(2) +3 PARMS
         TGET 12(2),SIZE,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=I
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=I
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=I
* ALL SIZE + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET BUFFER,100
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=I
*        ALL BUFFER + 1 PARM
         TGET BUFFER,100,EDIT
         TGET BUFFER,100,,WAIT
         TGET BUFFER,100,,,MF=I
* ALL BUFFER + 2 PARMS
         TGET BUFFER,100,EDIT,WAIT
         TGET BUFFER,100,EDIT,,MF=I
*        ALL BUFFER +3 PARMS
         TGET BUFFER,100,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=I
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=I
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=I
* ALL 100 + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (R2),100
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=I
*        ALL (R2) + 1 PARM
         TGET (R2),100,EDIT
         TGET (R2),100,,WAIT
         TGET (R2),100,,,MF=I
* ALL (R2) + 2 PARMS
         TGET (R2),100,EDIT,WAIT
         TGET (R2),100,EDIT,,MF=I
*        ALL (R2) +3 PARMS
         TGET (R2),100,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=I
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=I
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=I
* ALL 100 + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (2),100
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=I
*        ALL (2) + 1 PARM
         TGET (2),100,EDIT
         TGET (2),100,,WAIT
         TGET (2),100,,,MF=I
* ALL (2) + 2 PARMS
         TGET (2),100,EDIT,WAIT
         TGET (2),100,EDIT,,MF=I
*        ALL (2) +3 PARMS
         TGET (2),100,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=I
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=I
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=I
* ALL 100 + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET 12(2),100
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=I
*        ALL 12(2) + 1 PARM
         TGET 12(2),100,EDIT
         TGET 12(2),100,,WAIT
         TGET 12(2),100,,,MF=I
* ALL 12(2) + 2 PARMS
         TGET 12(2),100,EDIT,WAIT
         TGET 12(2),100,EDIT,,MF=I
*        ALL 12(2) +3 PARMS
         TGET 12(2),100,EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=I
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=I
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=I
* ALL 100 + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET BUFFER,(R3)
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=I
*        ALL BUFFER + 1 PARM
         TGET BUFFER,(R3),EDIT
         TGET BUFFER,(R3),,WAIT
         TGET BUFFER,(R3),,,MF=I
* ALL BUFFER + 2 PARMS
         TGET BUFFER,(R3),EDIT,WAIT
         TGET BUFFER,(R3),EDIT,,MF=I
*        ALL BUFFER +3 PARMS
         TGET BUFFER,(R3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=I
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=I
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=I
* ALL (R3) + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (R2),(R3)
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=I
*        ALL (R2) + 1 PARM
         TGET (R2),(R3),EDIT
         TGET (R2),(R3),,WAIT
         TGET (R2),(R3),,,MF=I
* ALL (R2) + 2 PARMS
         TGET (R2),(R3),EDIT,WAIT
         TGET (R2),(R3),EDIT,,MF=I
*        ALL (R2) +3 PARMS
         TGET (R2),(R3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=I
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=I
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=I
* ALL (R3) + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (2),(R3)
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=I
*        ALL (2) + 1 PARM
         TGET (2),(R3),EDIT
         TGET (2),(R3),,WAIT
         TGET (2),(R3),,,MF=I
* ALL (2) + 2 PARMS
         TGET (2),(R3),EDIT,WAIT
         TGET (2),(R3),EDIT,,MF=I
*        ALL (2) +3 PARMS
         TGET (2),(R3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=I
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=I
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=I
* ALL (R3) + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET 12(2),(R3)
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=I
*        ALL 12(2) + 1 PARM
         TGET 12(2),(R3),EDIT
         TGET 12(2),(R3),,WAIT
         TGET 12(2),(R3),,,MF=I
* ALL 12(2) + 2 PARMS
         TGET 12(2),(R3),EDIT,WAIT
         TGET 12(2),(R3),EDIT,,MF=I
*        ALL 12(2) +3 PARMS
         TGET 12(2),(R3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=I
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=I
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=I
* ALL (R3) + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET BUFFER,(3)
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=I
*        ALL BUFFER + 1 PARM
         TGET BUFFER,(3),EDIT
         TGET BUFFER,(3),,WAIT
         TGET BUFFER,(3),,,MF=I
* ALL BUFFER + 2 PARMS
         TGET BUFFER,(3),EDIT,WAIT
         TGET BUFFER,(3),EDIT,,MF=I
*        ALL BUFFER +3 PARMS
         TGET BUFFER,(3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=I
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=I
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=I
* ALL (3) + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (R2),(3)
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=I
*        ALL (R2) + 1 PARM
         TGET (R2),(3),EDIT
         TGET (R2),(3),,WAIT
         TGET (R2),(3),,,MF=I
* ALL (R2) + 2 PARMS
         TGET (R2),(3),EDIT,WAIT
         TGET (R2),(3),EDIT,,MF=I
*        ALL (R2) +3 PARMS
         TGET (R2),(3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=I
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=I
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=I
* ALL (3) + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET (2),(3)
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=I
*        ALL (2) + 1 PARM
         TGET (2),(3),EDIT
         TGET (2),(3),,WAIT
         TGET (2),(3),,,MF=I
* ALL (2) + 2 PARMS
         TGET (2),(3),EDIT,WAIT
         TGET (2),(3),EDIT,,MF=I
*        ALL (2) +3 PARMS
         TGET (2),(3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=I
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=I
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=I
* ALL (3) + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=I
*        ALL SINGLE PARMS
         TGET 12(2),(3)
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=I
*        ALL 12(2) + 1 PARM
         TGET 12(2),(3),EDIT
         TGET 12(2),(3),,WAIT
         TGET 12(2),(3),,,MF=I
* ALL 12(2) + 2 PARMS
         TGET 12(2),(3),EDIT,WAIT
         TGET 12(2),(3),EDIT,,MF=I
*        ALL 12(2) +3 PARMS
         TGET 12(2),(3),EDIT,WAIT,MF=I
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=I
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=I
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=I
* ALL (3) + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=I
         TGET ,,EDIT,WAIT,MF=I
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=I
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
* SEPARATOR
         TGET BUFFER
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET BUFFER,SIZE
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=(E,(1))
*        ALL BUFFER + 1 PARM
         TGET BUFFER,SIZE,EDIT
         TGET BUFFER,SIZE,,WAIT
         TGET BUFFER,SIZE,,,MF=(E,(1))
* ALL BUFFER + 2 PARMS
         TGET BUFFER,SIZE,EDIT,WAIT
         TGET BUFFER,SIZE,EDIT,,MF=(E,(1))
*        ALL BUFFER +3 PARMS
         TGET BUFFER,SIZE,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=(E,(1))
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=(E,(1))
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=(E,(1))
* ALL SIZE + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (R2),SIZE
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=(E,(1))
*        ALL (R2) + 1 PARM
         TGET (R2),SIZE,EDIT
         TGET (R2),SIZE,,WAIT
         TGET (R2),SIZE,,,MF=(E,(1))
* ALL (R2) + 2 PARMS
         TGET (R2),SIZE,EDIT,WAIT
         TGET (R2),SIZE,EDIT,,MF=(E,(1))
*        ALL (R2) +3 PARMS
         TGET (R2),SIZE,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=(E,(1))
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=(E,(1))
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=(E,(1))
* ALL SIZE + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (2),SIZE
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=(E,(1))
*        ALL (2) + 1 PARM
         TGET (2),SIZE,EDIT
         TGET (2),SIZE,,WAIT
         TGET (2),SIZE,,,MF=(E,(1))
* ALL (2) + 2 PARMS
         TGET (2),SIZE,EDIT,WAIT
         TGET (2),SIZE,EDIT,,MF=(E,(1))
*        ALL (2) +3 PARMS
         TGET (2),SIZE,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=(E,(1))
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=(E,(1))
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=(E,(1))
* ALL SIZE + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET 12(2),SIZE
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=(E,(1))
*        ALL 12(2) + 1 PARM
         TGET 12(2),SIZE,EDIT
         TGET 12(2),SIZE,,WAIT
         TGET 12(2),SIZE,,,MF=(E,(1))
* ALL 12(2) + 2 PARMS
         TGET 12(2),SIZE,EDIT,WAIT
         TGET 12(2),SIZE,EDIT,,MF=(E,(1))
*        ALL 12(2) +3 PARMS
         TGET 12(2),SIZE,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=(E,(1))
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=(E,(1))
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=(E,(1))
* ALL SIZE + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET BUFFER,100
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=(E,(1))
*        ALL BUFFER + 1 PARM
         TGET BUFFER,100,EDIT
         TGET BUFFER,100,,WAIT
         TGET BUFFER,100,,,MF=(E,(1))
* ALL BUFFER + 2 PARMS
         TGET BUFFER,100,EDIT,WAIT
         TGET BUFFER,100,EDIT,,MF=(E,(1))
*        ALL BUFFER +3 PARMS
         TGET BUFFER,100,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=(E,(1))
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=(E,(1))
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=(E,(1))
* ALL 100 + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (R2),100
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=(E,(1))
*        ALL (R2) + 1 PARM
         TGET (R2),100,EDIT
         TGET (R2),100,,WAIT
         TGET (R2),100,,,MF=(E,(1))
* ALL (R2) + 2 PARMS
         TGET (R2),100,EDIT,WAIT
         TGET (R2),100,EDIT,,MF=(E,(1))
*        ALL (R2) +3 PARMS
         TGET (R2),100,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=(E,(1))
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=(E,(1))
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=(E,(1))
* ALL 100 + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (2),100
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=(E,(1))
*        ALL (2) + 1 PARM
         TGET (2),100,EDIT
         TGET (2),100,,WAIT
         TGET (2),100,,,MF=(E,(1))
* ALL (2) + 2 PARMS
         TGET (2),100,EDIT,WAIT
         TGET (2),100,EDIT,,MF=(E,(1))
*        ALL (2) +3 PARMS
         TGET (2),100,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=(E,(1))
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=(E,(1))
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=(E,(1))
* ALL 100 + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET 12(2),100
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=(E,(1))
*        ALL 12(2) + 1 PARM
         TGET 12(2),100,EDIT
         TGET 12(2),100,,WAIT
         TGET 12(2),100,,,MF=(E,(1))
* ALL 12(2) + 2 PARMS
         TGET 12(2),100,EDIT,WAIT
         TGET 12(2),100,EDIT,,MF=(E,(1))
*        ALL 12(2) +3 PARMS
         TGET 12(2),100,EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=(E,(1))
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=(E,(1))
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=(E,(1))
* ALL 100 + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET BUFFER,(R3)
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=(E,(1))
*        ALL BUFFER + 1 PARM
         TGET BUFFER,(R3),EDIT
         TGET BUFFER,(R3),,WAIT
         TGET BUFFER,(R3),,,MF=(E,(1))
* ALL BUFFER + 2 PARMS
         TGET BUFFER,(R3),EDIT,WAIT
         TGET BUFFER,(R3),EDIT,,MF=(E,(1))
*        ALL BUFFER +3 PARMS
         TGET BUFFER,(R3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=(E,(1))
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=(E,(1))
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=(E,(1))
* ALL (R3) + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (R2),(R3)
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=(E,(1))
*        ALL (R2) + 1 PARM
         TGET (R2),(R3),EDIT
         TGET (R2),(R3),,WAIT
         TGET (R2),(R3),,,MF=(E,(1))
* ALL (R2) + 2 PARMS
         TGET (R2),(R3),EDIT,WAIT
         TGET (R2),(R3),EDIT,,MF=(E,(1))
*        ALL (R2) +3 PARMS
         TGET (R2),(R3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=(E,(1))
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=(E,(1))
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=(E,(1))
* ALL (R3) + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (2),(R3)
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=(E,(1))
*        ALL (2) + 1 PARM
         TGET (2),(R3),EDIT
         TGET (2),(R3),,WAIT
         TGET (2),(R3),,,MF=(E,(1))
* ALL (2) + 2 PARMS
         TGET (2),(R3),EDIT,WAIT
         TGET (2),(R3),EDIT,,MF=(E,(1))
*        ALL (2) +3 PARMS
         TGET (2),(R3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=(E,(1))
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=(E,(1))
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=(E,(1))
* ALL (R3) + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET 12(2),(R3)
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=(E,(1))
*        ALL 12(2) + 1 PARM
         TGET 12(2),(R3),EDIT
         TGET 12(2),(R3),,WAIT
         TGET 12(2),(R3),,,MF=(E,(1))
* ALL 12(2) + 2 PARMS
         TGET 12(2),(R3),EDIT,WAIT
         TGET 12(2),(R3),EDIT,,MF=(E,(1))
*        ALL 12(2) +3 PARMS
         TGET 12(2),(R3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=(E,(1))
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=(E,(1))
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=(E,(1))
* ALL (R3) + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET BUFFER,(3)
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=(E,(1))
*        ALL BUFFER + 1 PARM
         TGET BUFFER,(3),EDIT
         TGET BUFFER,(3),,WAIT
         TGET BUFFER,(3),,,MF=(E,(1))
* ALL BUFFER + 2 PARMS
         TGET BUFFER,(3),EDIT,WAIT
         TGET BUFFER,(3),EDIT,,MF=(E,(1))
*        ALL BUFFER +3 PARMS
         TGET BUFFER,(3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=(E,(1))
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=(E,(1))
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=(E,(1))
* ALL (3) + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (R2),(3)
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=(E,(1))
*        ALL (R2) + 1 PARM
         TGET (R2),(3),EDIT
         TGET (R2),(3),,WAIT
         TGET (R2),(3),,,MF=(E,(1))
* ALL (R2) + 2 PARMS
         TGET (R2),(3),EDIT,WAIT
         TGET (R2),(3),EDIT,,MF=(E,(1))
*        ALL (R2) +3 PARMS
         TGET (R2),(3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=(E,(1))
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=(E,(1))
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=(E,(1))
* ALL (3) + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET (2),(3)
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=(E,(1))
*        ALL (2) + 1 PARM
         TGET (2),(3),EDIT
         TGET (2),(3),,WAIT
         TGET (2),(3),,,MF=(E,(1))
* ALL (2) + 2 PARMS
         TGET (2),(3),EDIT,WAIT
         TGET (2),(3),EDIT,,MF=(E,(1))
*        ALL (2) +3 PARMS
         TGET (2),(3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=(E,(1))
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=(E,(1))
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=(E,(1))
* ALL (3) + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=(E,(1))
*        ALL SINGLE PARMS
         TGET 12(2),(3)
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=(E,(1))
*        ALL 12(2) + 1 PARM
         TGET 12(2),(3),EDIT
         TGET 12(2),(3),,WAIT
         TGET 12(2),(3),,,MF=(E,(1))
* ALL 12(2) + 2 PARMS
         TGET 12(2),(3),EDIT,WAIT
         TGET 12(2),(3),EDIT,,MF=(E,(1))
*        ALL 12(2) +3 PARMS
         TGET 12(2),(3),EDIT,WAIT,MF=(E,(1))
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=(E,(1))
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=(E,(1))
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=(E,(1))
* ALL (3) + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=(E,(1))
         TGET ,,EDIT,WAIT,MF=(E,(1))
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=(E,(1))
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET BUFFER,SIZE
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=L
*        ALL BUFFER + 1 PARM
         TGET BUFFER,SIZE,EDIT
         TGET BUFFER,SIZE,,WAIT
         TGET BUFFER,SIZE,,,MF=L
* ALL BUFFER + 2 PARMS
         TGET BUFFER,SIZE,EDIT,WAIT
         TGET BUFFER,SIZE,EDIT,,MF=L
*        ALL BUFFER +3 PARMS
         TGET BUFFER,SIZE,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=L
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=L
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=L
* ALL SIZE + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (R2),SIZE
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=L
*        ALL (R2) + 1 PARM
         TGET (R2),SIZE,EDIT
         TGET (R2),SIZE,,WAIT
         TGET (R2),SIZE,,,MF=L
* ALL (R2) + 2 PARMS
         TGET (R2),SIZE,EDIT,WAIT
         TGET (R2),SIZE,EDIT,,MF=L
*        ALL (R2) +3 PARMS
         TGET (R2),SIZE,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=L
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=L
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=L
* ALL SIZE + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (2),SIZE
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=L
*        ALL (2) + 1 PARM
         TGET (2),SIZE,EDIT
         TGET (2),SIZE,,WAIT
         TGET (2),SIZE,,,MF=L
* ALL (2) + 2 PARMS
         TGET (2),SIZE,EDIT,WAIT
         TGET (2),SIZE,EDIT,,MF=L
*        ALL (2) +3 PARMS
         TGET (2),SIZE,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=L
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=L
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=L
* ALL SIZE + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,SIZE
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET 12(2),SIZE
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=L
*        ALL 12(2) + 1 PARM
         TGET 12(2),SIZE,EDIT
         TGET 12(2),SIZE,,WAIT
         TGET 12(2),SIZE,,,MF=L
* ALL 12(2) + 2 PARMS
         TGET 12(2),SIZE,EDIT,WAIT
         TGET 12(2),SIZE,EDIT,,MF=L
*        ALL 12(2) +3 PARMS
         TGET 12(2),SIZE,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,SIZE,EDIT
         TGET ,SIZE,,WAIT
         TGET ,SIZE,,,MF=L
* ALL SIZE + 1 PARM
         TGET ,SIZE,EDIT,WAIT
         TGET ,SIZE,=EDIT,,MF=L
* ALL SIZE + 2 PARMS
         TGET ,SIZE,EDIT,WAIT,MF=L
* ALL SIZE + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET BUFFER,100
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=L
*        ALL BUFFER + 1 PARM
         TGET BUFFER,100,EDIT
         TGET BUFFER,100,,WAIT
         TGET BUFFER,100,,,MF=L
* ALL BUFFER + 2 PARMS
         TGET BUFFER,100,EDIT,WAIT
         TGET BUFFER,100,EDIT,,MF=L
*        ALL BUFFER +3 PARMS
         TGET BUFFER,100,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=L
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=L
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=L
* ALL 100 + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (R2),100
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=L
*        ALL (R2) + 1 PARM
         TGET (R2),100,EDIT
         TGET (R2),100,,WAIT
         TGET (R2),100,,,MF=L
* ALL (R2) + 2 PARMS
         TGET (R2),100,EDIT,WAIT
         TGET (R2),100,EDIT,,MF=L
*        ALL (R2) +3 PARMS
         TGET (R2),100,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=L
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=L
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=L
* ALL 100 + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (2),100
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=L
*        ALL (2) + 1 PARM
         TGET (2),100,EDIT
         TGET (2),100,,WAIT
         TGET (2),100,,,MF=L
* ALL (2) + 2 PARMS
         TGET (2),100,EDIT,WAIT
         TGET (2),100,EDIT,,MF=L
*        ALL (2) +3 PARMS
         TGET (2),100,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=L
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=L
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=L
* ALL 100 + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,100
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET 12(2),100
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=L
*        ALL 12(2) + 1 PARM
         TGET 12(2),100,EDIT
         TGET 12(2),100,,WAIT
         TGET 12(2),100,,,MF=L
* ALL 12(2) + 2 PARMS
         TGET 12(2),100,EDIT,WAIT
         TGET 12(2),100,EDIT,,MF=L
*        ALL 12(2) +3 PARMS
         TGET 12(2),100,EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,100,EDIT
         TGET ,100,,WAIT
         TGET ,100,,,MF=L
* ALL 100 + 1 PARM
         TGET ,100,EDIT,WAIT
         TGET ,100,=EDIT,,MF=L
* ALL 100 + 2 PARMS
         TGET ,100,EDIT,WAIT,MF=L
* ALL 100 + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET BUFFER,(R3)
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=L
*        ALL BUFFER + 1 PARM
         TGET BUFFER,(R3),EDIT
         TGET BUFFER,(R3),,WAIT
         TGET BUFFER,(R3),,,MF=L
* ALL BUFFER + 2 PARMS
         TGET BUFFER,(R3),EDIT,WAIT
         TGET BUFFER,(R3),EDIT,,MF=L
*        ALL BUFFER +3 PARMS
         TGET BUFFER,(R3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=L
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=L
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=L
* ALL (R3) + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (R2),(R3)
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=L
*        ALL (R2) + 1 PARM
         TGET (R2),(R3),EDIT
         TGET (R2),(R3),,WAIT
         TGET (R2),(R3),,,MF=L
* ALL (R2) + 2 PARMS
         TGET (R2),(R3),EDIT,WAIT
         TGET (R2),(R3),EDIT,,MF=L
*        ALL (R2) +3 PARMS
         TGET (R2),(R3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=L
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=L
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=L
* ALL (R3) + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (2),(R3)
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=L
*        ALL (2) + 1 PARM
         TGET (2),(R3),EDIT
         TGET (2),(R3),,WAIT
         TGET (2),(R3),,,MF=L
* ALL (2) + 2 PARMS
         TGET (2),(R3),EDIT,WAIT
         TGET (2),(R3),EDIT,,MF=L
*        ALL (2) +3 PARMS
         TGET (2),(R3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=L
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=L
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=L
* ALL (R3) + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,(R3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET 12(2),(R3)
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=L
*        ALL 12(2) + 1 PARM
         TGET 12(2),(R3),EDIT
         TGET 12(2),(R3),,WAIT
         TGET 12(2),(R3),,,MF=L
* ALL 12(2) + 2 PARMS
         TGET 12(2),(R3),EDIT,WAIT
         TGET 12(2),(R3),EDIT,,MF=L
*        ALL 12(2) +3 PARMS
         TGET 12(2),(R3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(R3),EDIT
         TGET ,(R3),,WAIT
         TGET ,(R3),,,MF=L
* ALL (R3) + 1 PARM
         TGET ,(R3),EDIT,WAIT
         TGET ,(R3),=EDIT,,MF=L
* ALL (R3) + 2 PARMS
         TGET ,(R3),EDIT,WAIT,MF=L
* ALL (R3) + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET BUFFER
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET BUFFER,(3)
         TGET BUFFER,,EDIT
         TGET BUFFER,,,WAIT
         TGET BUFFER,,,,MF=L
*        ALL BUFFER + 1 PARM
         TGET BUFFER,(3),EDIT
         TGET BUFFER,(3),,WAIT
         TGET BUFFER,(3),,,MF=L
* ALL BUFFER + 2 PARMS
         TGET BUFFER,(3),EDIT,WAIT
         TGET BUFFER,(3),EDIT,,MF=L
*        ALL BUFFER +3 PARMS
         TGET BUFFER,(3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=L
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=L
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=L
* ALL (3) + ALL PARMS BUT BUFFER
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (R2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (R2),(3)
         TGET (R2),,EDIT
         TGET (R2),,,WAIT
         TGET (R2),,,,MF=L
*        ALL (R2) + 1 PARM
         TGET (R2),(3),EDIT
         TGET (R2),(3),,WAIT
         TGET (R2),(3),,,MF=L
* ALL (R2) + 2 PARMS
         TGET (R2),(3),EDIT,WAIT
         TGET (R2),(3),EDIT,,MF=L
*        ALL (R2) +3 PARMS
         TGET (R2),(3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=L
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=L
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=L
* ALL (3) + ALL PARMS BUT (R2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET (2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET (2),(3)
         TGET (2),,EDIT
         TGET (2),,,WAIT
         TGET (2),,,,MF=L
*        ALL (2) + 1 PARM
         TGET (2),(3),EDIT
         TGET (2),(3),,WAIT
         TGET (2),(3),,,MF=L
* ALL (2) + 2 PARMS
         TGET (2),(3),EDIT,WAIT
         TGET (2),(3),EDIT,,MF=L
*        ALL (2) +3 PARMS
         TGET (2),(3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=L
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=L
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=L
* ALL (3) + ALL PARMS BUT (2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         TGET 12(2)
         TGET ,(3)
         TGET ,,EDIT
         TGET ,,,WAIT
         TGET ,,,,MF=L
*        ALL SINGLE PARMS
         TGET 12(2),(3)
         TGET 12(2),,EDIT
         TGET 12(2),,,WAIT
         TGET 12(2),,,,MF=L
*        ALL 12(2) + 1 PARM
         TGET 12(2),(3),EDIT
         TGET 12(2),(3),,WAIT
         TGET 12(2),(3),,,MF=L
* ALL 12(2) + 2 PARMS
         TGET 12(2),(3),EDIT,WAIT
         TGET 12(2),(3),EDIT,,MF=L
*        ALL 12(2) +3 PARMS
         TGET 12(2),(3),EDIT,WAIT,MF=L
*  ALL PARMS
         TGET ,(3),EDIT
         TGET ,(3),,WAIT
         TGET ,(3),,,MF=L
* ALL (3) + 1 PARM
         TGET ,(3),EDIT,WAIT
         TGET ,(3),=EDIT,,MF=L
* ALL (3) + 2 PARMS
         TGET ,(3),EDIT,WAIT,MF=L
* ALL (3) + ALL PARMS BUT 12(2)
         TGET ,,EDIT,WAIT
         TGET ,,EDIT,MF=L
         TGET ,,EDIT,WAIT,MF=L
* ALL REST OF EDIT COMBINATIONS
         TGET ,,,WAIT,MF=L
* ALL POSSIBLE COMBINATIONS OF OPERANDS?
         END
++ MAC      (TPG     ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    TPG   &BFF,&SIZE,&EDIT,&WAIT,&HOLD,&BRKI,&PRTY,&MF=
.* A000000-999999                                              @G76XRYD
.*D107500-110500                                               @OZ65329
.*NOCHANGE SHIPPED WITH JCLIN                                  @OY20024
.*
         LCLA  &FLAGON,&FLAGOFF,&FLAGS2,&OPT,&RET
         LCLB  &E,&W,&H,&B,&P,&NOEDIT
         LCLC  &PARM,&NDX
&NDX     SETC  '&SYSNDX'
         AIF   (N'&SYSLIST LE 7).POSOPOK .IF TOO MANY OPERANDS
         MNOTE 12,'IHB300 EXCESSIVE POSITIONAL OPERANDS SPECIFIED'
         MEXIT
.POSOPOK ANOP                         ..POSITIONAL OPERANDS OK
         AIF   ('&MF' EQ '').FORMOK     NON-EXTENDED FORM OK
         AIF   ('&MF' EQ 'I' OR '&MF' EQ 'L' OR ('&MF(1)' EQ 'E' AND N'*
               &MF EQ 2)).FORMOK     ...FORMAT OPERANDS OK...
         MNOTE 12,'IHB303 INVALID OPERAND MF=&MF '
         MEXIT
.FORMOK  ANOP
         AIF   (('&BFF' EQ '' OR '&SIZE' EQ '') AND '&MF' EQ '').ERROR1
         AIF   ('&SIZE' EQ '' AND '&MF' EQ 'I').SIZERR
         AIF   ('&BFF' NE '' OR '&MF' NE 'I').BFFEXOK
         MNOTE 12,'IHB300 BUFFER ADDRESS NOT SPECIFIED'
         MEXIT
.BFFEXOK ANOP              ...BUFFER ADDR GIVEN W/ MF=I,E,L
&FLAGOFF SETA  127                   ...SET FOR AND OPERATION
&FLAGOFF SETA  &FLAGOFF-64            ..INSURE USER ID FLAG
.*                                      TURNED OFF FOR EX FORM
&PARM    SETC  '&EDIT'
.CKPARM  ANOP
&RET     SETA  &RET+1
         AIF   ('&PARM' EQ '').RET           NULL, TRY NEXT
         AIF   ('&PARM' EQ 'EDIT').EDI       SET EDIT
         AIF   ('&PARM' EQ 'ASIS').ASI       SET ASIS
         AIF   ('&PARM' EQ 'CONTROL').CON    SET CONTROL
         AIF   ('&PARM' EQ 'FULLSCR').FULLS  SET FULL SCREEN
         AIF   ('&PARM' EQ 'NOEDIT').NOED    SET NO EDIT MODE
         AIF   ('&PARM' EQ 'WAIT').WAI       SET WAIT
         AIF   ('&PARM' EQ 'NOWAIT').NOW     SET NOWAIT
         AIF   ('&PARM' EQ 'HOLD').HOL       SET HOLD
         AIF   ('&PARM' EQ 'NOHOLD').NOH     SET NOHOLD
         AIF   ('&PARM' EQ 'NOBREAK').NOB    SET NOBREAK
         AIF   ('&PARM' EQ 'BREAKIN').BRE    SET BREAKIN
         AIF   ('&PARM' EQ 'HIGHP').HPR      SET HIGHP
         AIF   ('&PARM' EQ 'LOWP').LPR       SET LOWP
         AGO   .ERROR3
.EDI     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&FLAGOFF SETA  &FLAGOFF-3               EDIT FOR EXECUTE FORM
         AGO   .EDDONE
.ASI     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&FLAGOFF SETA  &FLAGOFF-2               1ST BIT OF ASIS FOR EX
&FLAGON  SETA  &FLAGON+1                2ND BIT OF ASIS FOR EX
&OPT     SETA  &OPT+1                   SET EDIT=ASIS
         AGO   .EDDONE
.CON     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&OPT     SETA  &OPT+2                   SET EDIT=CONTROL
&FLAGOFF SETA  &FLAGOFF-1               1ST BIT OF CNTR FOR EX
&FLAGON  SETA  &FLAGON+2                2ND BIT OF CNTR FOR EX
         AGO   .EDDONE
.FULLS   ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECIFIED
&OPT     SETA  &OPT+3                   CNTL+ASIS FOR FULLSCR
&FLAGON  SETA  &FLAGON+3                SET FULLSCREEN FOR EX
         AGO   .EDDONE
.NOED    ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1
&NOEDIT  SETB  1
&OPT     SETA  &OPT+3                   FLAGS1 TO FULLSCR STAN
&FLAGS2  SETA  3                        SET FLAGS2 TO NOEDIT AND CD
&FLAGON  SETA  &FLAGON+3                FLAGS1 TO FULLSCR EXEC
.EDDONE  ANOP                      EDIT OPERAND IN RIGHT PLACE
         AIF   (&RET NE 1).BADPOS  ..IF NOT IN 3RD POS-WARNING
         AGO   .RET                ..ELSE OK
.WAI     ANOP
         AIF   (&W).ERROR2              DUP OPTION
&W       SETB  1                        WAIT OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-16              SET WAIT OPTION IN EX
         AGO   .WAIDONE                 CHECK POSITION
.NOW     ANOP
         AIF   (&W).ERROR2              DUP OPTION
&W       SETB  1                        WAIT OPTION SPECIFIED
&OPT     SETA  &OPT+X'10'               SET WAIT=NOWAIT
&FLAGON  SETA  &FLAGON+16               SET FOR NOWAIT IN EXEC
.WAIDONE ANOP                       ..WAIT IN RIGHT POSITION
         AIF   (&RET NE 2).BADPOS   ..IF NOT 4TH, WARNING
         AGO   .RET                 ..ELSE OK
.HOL     ANOP
         AIF   (&H).ERROR2              DUP OPTION
&H       SETB  1                        HOLD OPTION SPECIFIED
&OPT     SETA  &OPT+X'08'               SET HOLD=HOLD
&FLAGON  SETA  &FLAGON+8                SET FOR HOLD IN EXEC
         AGO   .HOLDONE                 CHECK POSITION
.NOH     ANOP
         AIF   (&H).ERROR2              DUP OPTION
&H       SETB  1                        NOHOLD OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-8               SET FOR NOHOLD IN EXEC
.HOLDONE ANOP                        ..CHECK HOLD POSITION
         AIF   (&RET NE 3).BADPOS    ..IF ^ 5TH OPER, WARNING
         AGO   .RET                  ..ELSE OK
.BRE     ANOP
         AIF   (&B).ERROR2              DUP OPTION
&B       SETB  1                        BREAK OPTION SPECIFIED
&OPT     SETA  &OPT+X'04'               SET BREAKIN
&FLAGON  SETA  &FLAGON+4                SET BREAKIN IN EXEC
         AGO   .BRDONE                  CHECK BREAK POSITION
.NOB     ANOP
         AIF   (&B).ERROR2              DUP OPTION
&B       SETB  1                        BREAK OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-4               SET NOBREAK OPTION EX
.BRDONE  ANOP                           CHECK BREAK POSITION
         AIF   (&RET NE 4).BADPOS    ..IF NOT THE 6TH OPERAND
         AGO   .RET                  ..ELSE OK
.HPR     ANOP
         AIF   (&P).ERROR2              DUP OPTION
&P       SETB  1                        PRIORITY OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-32              SET HI PRIO OPTION EX
         AGO   .PRDONE                  CHECK POSITION
.LPR     ANOP
         AIF   (&P).ERROR2              DUP OPTION
&P       SETB  1                        PRIORITY OPTION SPECIFIED
&OPT     SETA  &OPT+X'20'               SET  LOW PRIORITY OPTION
&FLAGON  SETA  &FLAGON+32               SET LOW PRI OPTION EX
.PRDONE  ANOP                     ..CHECK PRIORITY OPERAND POS
         AIF   (&RET NE 5).BADPOS   ..IF ^7TH OPERAND,WARNING
         AGO   .RET                 ..ELSE OK
.BADPOS  ANOP             ..ISSUE WARNING IF OPERAND MISPLACED
         MNOTE 4,'IHB300 WARNING: &PARM POSITIONAL PARAMETER MISPLACED'
.RET     ANOP
&PARM    SETC  '&WAIT'
         AIF   ('&RET' EQ '1').CKPARM   CHECK WAIT
&PARM    SETC  '&HOLD'
         AIF   ('&RET' EQ '2').CKPARM   CHECK HOLD
&PARM    SETC  '&BRKI'
         AIF   ('&RET' EQ '3').CKPARM   CHECK BRKI
&PARM    SETC  '&PRTY'
         AIF   ('&RET' EQ '4').CKPARM   CHECK PRTY
.*  PARAMETERS PROCESSED
         AIF   (&E).EDITSPE             EDIT OPERAND SPECIFIED?
&OPT     SETA  &OPT+3                   FLAGS1 TO FULLSCR STAN
&FLAGS2  SETA  3                        SET FLAGS2 TO NOEDIT AND CD
&FLAGON  SETA  &FLAGON+3                FLAGS1 TO FULLSCR EXEC
         AGO   .NEDTSPE                 NOEDIT DEFAULTS
.EDITSPE AIF   (&NOEDIT).NEDTSPE        NOEDIT SPECIFIED?
         MNOTE 12,'IHB300 EDIT OPERAND MUST BE ''NOEDIT'' ON TPG MACRO'
         MEXIT
.NEDTSPE ANOP                           NOEDIT SPECIFIED OR DEFAULTS
         AIF   ('&MF' EQ 'L').LFORM       ...LIST EXPANSION...
         AIF   ('&MF' EQ 'I' OR '&MF' EQ '').STFORM .ST. FORM.
.******************
.*  EXECUTE FORM  *
.******************
&NAME    CNOP  0,4                          TPUT EXECUTE FORM
         AIF   ('&MF(2)'(1,1) EQ '(').MFREG  IF IN RX FORM  ..
         LA    1,&MF(2)                     R1=>USER PARM LIST
         AGO   .GOTPARM
.MFREG   ANOP                             .. ELSE, IN A REG ..
         AIF   ('&MF(2)' EQ '(1)').GOTPARM ..IF NOT REG 1..
         LR    1,&MF(2)                     POINT R1 AT PARMS
.GOTPARM ANOP
         AIF   (&FLAGOFF EQ 127).SKIPAND ..TURN OFF ANY FLAGS?
         NI    13(1),&FLAGOFF               RESET FLAGS 1
.SKIPAND ANOP                      ..CHECK FOR FLAGS TURNED ON
         AIF   (&FLAGON EQ 0).NOSET  ..TURN ON ANY FLAGS?
         OI    13(1),&FLAGON                IN EXEC PARM LIST
.NOSET   ANOP
         MVI   12(1),&FLAGS2                RESET FLAGS2
         AGO   .PARMCHK                 ..END UNIQUE E CODE..
.****************************
.*  STANDARD EXTENDED FORM  *
.****************************
.STFORM  ANOP                   ..STANDARD EXTENDED FORM CODE.
&NAME    CNOP  0,4                          STANDARD EXTENDED
         BAL   1,*+20                       BRANCH AROUND PARM
TPG&NDX  DS    0H                           TPUT EXTENDED PARM
         DC    H'0'                         RESERVED
         DC    H'0'                         OUTPUT BUFFER SIZE
         DC    A(0)                         OUTPUT BUFFER ADDR
         DC    A(0)                         RESERVED
         DC    AL1(&FLAGS2)                 FLAGS 2
         DC    AL1(&OPT)                    FLAGS 1
         DC    H'0'                         RESERVED BYTES
.************************************************
.*  COMMON CODE FOR STANDARD AND EXECUTE FORMS  *
.************************************************
.PARMCHK ANOP                           ..GET PARMS FOR E & I
         AIF   ('&SIZE' EQ '').CKID     ...IF BUFF SIZE GIVEN.
         AIF   ('&SIZE'(1,1) EQ '(').SIZEREG  ...IF AN INTEGER
         AIF   (T'&SIZE NE 'N').SIZEQU  BUFSIZE IS EQUATE
         AIF   (&SIZE GT 32767).SIZERR          .NOT > 32767..
.SIZEQU  ANOP
         AIF   ('&MF' NE 'I' AND '&MF' NE '').SIZEEX .STANDARD
         ORG   TPG&NDX+2                    PUT SIZE VALUE
         DC    AL2(&SIZE)                   IN PARM LIST
         ORG
         AGO   .CKID
.SIZEEX  ANOP                         ..IF EXECUTE
         B     *+6                          BR PAST BUFSIZE
         DC    AL2(&SIZE)                   BUFSIZE
         LH    0,*-2                        GET THE SIZE VALUE
         STH   0,2(1)                       INTO THE PARM LIST
         AGO   .CKID
.SIZEREG ANOP                                 ...ELSE A REG ..
         AIF   ('&SIZE(1)' EQ '0' OR '&SIZE(1)' EQ '1').REGBAD
         STH   &SIZE(1),2(1)                PUT SIZE IN PARM
.CKID    ANOP                           ... CHECK IDS ...
         AIF   ('&BFF' EQ '').FINISH    ..IF BUFFER ADDR GIVEN
         AIF   ('&BFF'(1,1) EQ '(').BFFREG  ..IF AN RX ADDR...
         LA    0,&BFF                       GET ADDR OF BUFFER
         ST    0,4(1)                       PUT IN PARM LIST
         AGO   .FINISH
.BFFREG  ANOP                               ..ELSE IN A REG ..
         AIF   ('&BFF(1)' EQ '0' OR '&BFF(1)' EQ '1').REGBAD
         ST    &BFF(1),4(1)                 STORE BUFFER ADDR
.FINISH  ANOP
         OI    12(1),128                    SET HI BIT OF PARM
         ICM   0,B'1000',*-3                SET HI BIT OF R0
.*                                        FROM 128 IN OI INSTR
.SVCNEW  ANOP                           .. ISSUE SVC HERE ...
         SVC   93                           SVC TO MSG ROUTER
         MEXIT
.**********************
.*  LIST FORM CODE    *
.**********************
.LFORM   ANOP
&NAME    DS    0F                           L-FORM PARM LIST
         DC    H'0'                         RESERVED
         AIF   ('&SIZE' NE '').LSTSIZE  .. IF NO BUFFER SIZE .
         DC    H'0'                         BUFF SIZE HALFWORD
         AGO   .LBFADDR
.LSTSIZE ANOP                           .. ELSE A BUFFER SIZE.
         AIF   ('&SIZE'(1,1) EQ '(').REGERR   .IF NOT IN A REG
         AIF   (T'&SIZE NE 'N').SIZEQU0 IF BUFSIZE IS EQUATE
         AIF   (&SIZE GT 32767).SIZERR          .NOT > 32767..
.SIZEQU0 ANOP
         DC    AL2(&SIZE)                   BUFFER SIZE VALUE
.LBFADDR ANOP                           .. CHECK BUFFER ADDR..
         AIF   ('&BFF' NE '').LBFFLAB   ..IF NO BUFFER ADDR..
         DC    A(0)                         BUFFER ADDRESS
         AGO   .LSTUSER
.LBFFLAB ANOP                           .. ELSE BUFFER ADDRESS
         AIF   ('&BFF'(1,1) EQ '(').REGERR  ..IF NOT IN A REG
         DC    A(&BFF)                      ADDR OUTPUT BUFFER
.LSTUSER ANOP
         DC    A(0)                         RESERVED
         DC    AL1(&FLAGS2)                 FLAGS 2
         DC    AL1(&OPT)                    FLAGS 1
         DC    H'0'                         RESERVED
         MEXIT
.************
.*  MNOTES  *
.************
.REGERR  ANOP                              ..REGISTER ERROR..
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L, REGISTER OPERANDX
                SPECIFIED'
         MEXIT
.REGBAD  MNOTE 12,'IHB300 BUFADDR AND BUFSIZE REGS CANNOT BE 0 OR 1'
         MEXIT
.SIZERR  MNOTE 12,'IHB300 SIZE NOT IN RANGE 0-32767'
         MEXIT
.ERROR1  IHBERMAC 24
         MEXIT
.ERROR2  IHBERMAC 54,,,
         MEXIT
.ERROR3  IHBERMAC 49,,&PARM
         MEND
++ MAC      (TPUT    ) DISTLIB(ATSOMAC )
                                      SYSLIB(MACLIB) .
         MACRO
&NAME    TPUT  &BFF,&SIZE,&EDIT,&WAIT,&HOLD,&BRKI,&PRTY,&TJID=,        *
               &TJIDLOC=,&ASID=,&ASIDLOC=,&USERIDL=,&MF=       @G76XRYU
.* A000000-999999                                              @G76XR00
.* A770501,896051,896076,896158,896167,960000                  @OZ43223
.* C896050,896054,896063-896064,896075,896089,896157,896159,   @OZ43223
.* C896166,896168                                              @OZ43223
.* D896058-896062,896083-896087                                @OZ43223
.* C204500,206000-207000,216500,218000-218500,D219000          @OZ44359
.*A167500                                                      @OZ49617
.*C204500,206000,207500,216500,218000,218300                   @OZ48113
.*C008500,167600-167900                                        @OZ56262
.*A175500                                                      @OZ56262
.*C237500-239500,241500                                        @OZ65329
.*D140500                                                      @OZ65329
.*A037500,044500,196500                                        @OZ67665
.*D242399-243599 HI ORDER REG1 NOT CLEARED ON TPUT             @OZ89425
.*NOCHANGE SHIPPED WITH JCLIN                                  @OY20024
.*
         LCLA  &FLAGON,&FLAGOFF,&FLAGS2,&OPT,&NTJ,&RET,&BFFPOS @OZ56262
         LCLB  &E,&W,&H,&B,&P,&OLDBUFF                         @G76XRYU
         LCLC  &TSID,&TSIDLOC,&PARM,&NDX,&ID                   @G76XRYU
&NDX     SETC  '&SYSNDX'                                       @G76XRYU
         AIF   (N'&SYSLIST LE 7).POSOPOK .IF TOO MANY OPERANDS @G76XRYU
         MNOTE 12,'IHB300 EXCESSIVE POSITIONAL OPERANDS SPECIFIED'
         MEXIT                                                 @G76XRYU
.POSOPOK ANOP                         ..POSITIONAL OPERANDS OK @G76XRYU
         AIF   ('&MF' EQ '').FORMOK     NON-EXTENDED FORM OK   @G76XRYU
         AIF   ('&MF' EQ 'I' OR '&MF' EQ 'L' OR ('&MF(1)' EQ 'E' AND N'*
               &MF EQ 2)).FORMOK     ...FORMAT OPERANDS OK...  @G76XRYU
         MNOTE 12,'IHB303 INVALID OPERAND MF=&MF '             @G76XRYU
         MEXIT                                                 @G76XRYU
.FORMOK  ANOP                                                  @G76XRYU
         AIF   (('&BFF' EQ '' OR '&SIZE' EQ '') AND '&MF' EQ '').ERROR1
         AIF   ('&SIZE' EQ '' AND '&MF' EQ 'I').SIZERR         @G76XRYU
         AIF   ('&BFF' NE '' OR '&MF' NE 'I').BFFEXOK          @G76XRYU
         MNOTE 12,'IHB300 BUFFER ADDRESS NOT SPECIFIED'        @G76XRYU
         MEXIT                                                 @G76XRYU
.BFFEXOK ANOP              ...BUFFER ADDR GIVEN W/ MF=I,E,L    @G76XRYU
&ID      SETC  '0'                                             @G76XRYU
&FLAGOFF SETA  127                   ...SET FOR AND OPERATION  @G76XRYU
&NTJ     SETA  N'&TJID+N'&TJIDLOC+N'&ASID+N'&ASIDLOC+N'&USERIDL
         AIF   (&NTJ GT 1).ERROR2
         AIF   (&NTJ EQ 0).KEEPID    ..IF ANY ID SPECIFIED ..  @G76XRYU
&FLAGOFF SETA  &FLAGOFF-64            ..INSURE USER ID FLAG    @G76XRYU
.*                                      TURNED OFF FOR EX FORM @G76XRYU
.KEEPID  ANOP                        ..ELSE RETAIN PRESENT SET @G76XRYU
&TSID    SETC  '&ASID&TJID'
&TSIDLOC SETC  '&ASIDLOC&TJIDLOC'
         AIF   ('&EDIT' EQ 'R').RF      CHECK FOR R FORM
&PARM    SETC  '&EDIT'
         AIF   ('&USERIDL' EQ '').CKPARM
&OPT     SETA  X'40'                    DENOTE USERID SPECIFIED
&FLAGON  SETA  &FLAGON+64               TO OR USER ID FLAG     @G76XRYU
.CKPARM  ANOP
&RET     SETA  &RET+1
         AIF   ('&PARM' EQ '').RET           NULL, TRY NEXT
         AIF   ('&PARM' EQ 'EDIT').EDI       SET EDIT
         AIF   ('&PARM' EQ 'ASIS').ASI       SET ASIS
         AIF   ('&PARM' EQ 'CONTROL').CON    SET CONTROL
         AIF   ('&PARM' EQ 'FULLSCR').FULLS  SET FULL SCREEN    SA60002
         AIF   ('&PARM' EQ 'NOEDIT').NOED    SET NO EDIT MODE  @G76XRYU
         AIF   ('&PARM' EQ 'WAIT').WAI       SET WAIT
         AIF   ('&PARM' EQ 'NOWAIT').NOW     SET NOWAIT
         AIF   ('&PARM' EQ 'HOLD').HOL       SET HOLD
         AIF   ('&PARM' EQ 'NOHOLD').NOH     SET NOHOLD
         AIF   ('&PARM' EQ 'NOBREAK').NOB    SET NOBREAK
         AIF   ('&PARM' EQ 'BREAKIN').BRE    SET BREAKIN
         AIF   ('&PARM' EQ 'HIGHP').HPR      SET HIGHP
         AIF   ('&PARM' EQ 'LOWP').LPR       SET LOWP
         AGO   .ERROR3
.EDI     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&FLAGOFF SETA  &FLAGOFF-3               EDIT FOR EXECUTE FORM  @G76XRYU
         AGO   .EDDONE                                         @G76XRYU
.ASI     ANOP
         AIF   (&E).ERROR2              DUP OPTION
         AIF   (&NTJ EQ 1).ASIDER3      CANT CODE ASID+ USERID @OZ67665
&E       SETB  1                        EDIT OPTION SPECFIED
&FLAGOFF SETA  &FLAGOFF-2               1ST BIT OF ASIS FOR EX @G76XRYU
&FLAGON  SETA  &FLAGON+1                2ND BIT OF ASIS FOR EX @G76XRYU
&OPT     SETA  &OPT+1                   SET EDIT=ASIS
         AGO   .EDDONE                                         @G76XRYU
.CON     ANOP
         AIF   (&E).ERROR2              DUP OPTION
&E       SETB  1                        EDIT OPTION SPECFIED
&OPT     SETA  &OPT+2                   SET EDIT=CONTROL
&FLAGOFF SETA  &FLAGOFF-1               1ST BIT OF CNTR FOR EX @G76XRYU
&FLAGON  SETA  &FLAGON+2                2ND BIT OF CNTR FOR EX @G76XRYU
         AGO   .EDDONE                                         @G76XRYU
.FULLS   ANOP                                                   SA60002
         AIF   (&E).ERROR2              DUP OPTION              SA60002
         AIF   (&NTJ EQ 1).ASIDER2      CANT CODE ASID+ USERID @OZ67665
&E       SETB  1                        EDIT OPTION SPECIFIED   SA60002
&OPT     SETA  &OPT+3                   CNTL+ASIS FOR FULLSCR   SA60002
&FLAGON  SETA  &FLAGON+3                SET FULLSCREEN FOR EX  @G76XRYU
         AGO   .EDDONE                                         @G76XRYU
.NOED    ANOP                                                  @G76XRYU
         AIF   (&E).ERROR2              DUP OPTION             @G76XRYU
         AIF   (&NTJ EQ 1).ASIDERR      CAN'T SAY NOEDIT & ASID@OZ43223
&E       SETB  1                                               @G76XRYU
&OPT     SETA  &OPT+3                   FLAGS1 TO FULLSCR STAN @G76XRYU
&FLAGS2  SETA  1                        SET FLAGS2 TO NOEDIT   @G76XRYU
&FLAGON  SETA  &FLAGON+3                FLAGS1 TO FULLSCR EXEC @G76XRYU
.EDDONE  ANOP                      EDIT OPERAND IN RIGHT PLACE @G76XRYU
         AIF   (&RET NE 1).BADPOS  ..IF NOT IN 3RD POS-WARNING @G76XRYU
         AGO   .RET                ..ELSE OK                   @G76XRYU
.WAI     ANOP
         AIF   (&W).ERROR2              DUP OPTION
&W       SETB  1                        WAIT OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-16              SET WAIT OPTION IN EX  @G76XRYU
         AGO   .WAIDONE                 CHECK POSITION         @G76XRYU
.NOW     ANOP
         AIF   (&W).ERROR2              DUP OPTION
&W       SETB  1                        WAIT OPTION SPECIFIED
&OPT     SETA  &OPT+X'10'               SET WAIT=NOWAIT
&FLAGON  SETA  &FLAGON+16               SET FOR NOWAIT IN EXEC @G76XRYU
.WAIDONE ANOP                       ..WAIT IN RIGHT POSITION   @G76XRYU
         AIF   (&RET NE 2).BADPOS   ..IF NOT 4TH, WARNING      @G76XRYU
         AGO   .RET                 ..ELSE OK                  @G76XRYU
.HOL     ANOP
         AIF   (&H).ERROR2              DUP OPTION
&H       SETB  1                        HOLD OPTION SPECIFIED
&OPT     SETA  &OPT+X'08'               SET HOLD=HOLD
&FLAGON  SETA  &FLAGON+8                SET FOR HOLD IN EXEC   @G76XRYU
         AGO   .HOLDONE                 CHECK POSITION         @G76XRYU
.NOH     ANOP
         AIF   (&H).ERROR2              DUP OPTION
&H       SETB  1                        NOHOLD OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-8               SET FOR NOHOLD IN EXEC @G76XRYU
.HOLDONE ANOP                        ..CHECK HOLD POSITION     @G76XRYU
         AIF   (&RET NE 3).BADPOS    ..IF ^ 5TH OPER, WARNING  @G76XRYU
         AGO   .RET                  ..ELSE OK                 @G76XRYU
.BRE     ANOP
         AIF   (&B).ERROR2              DUP OPTION
&B       SETB  1                        BREAK OPTION SPECIFIED
&OPT     SETA  &OPT+X'04'               SET BREAKIN
&FLAGON  SETA  &FLAGON+4                SET BREAKIN IN EXEC    @G76XRYU
         AGO   .BRDONE                  CHECK BREAK POSITION   @G76XRYU
.NOB     ANOP
         AIF   (&B).ERROR2              DUP OPTION
&B       SETB  1                        BREAK OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-4               SET NOBREAK OPTION EX  @G76XRYU
.BRDONE  ANOP                           CHECK BREAK POSITION   @G76XRYU
         AIF   (&RET NE 4).BADPOS    ..IF NOT THE 6TH OPERAND  @G76XRYU
         AGO   .RET                  ..ELSE OK                 @G76XRYU
.HPR     ANOP
         AIF   (&P).ERROR2              DUP OPTION
&P       SETB  1                        PRIORITY OPTION SPECIFIED
&FLAGOFF SETA  &FLAGOFF-32              SET HI PRIO OPTION EX  @G76XRYU
         AGO   .PRDONE                  CHECK POSITION         @G76XRYU
.LPR     ANOP
         AIF   (&P).ERROR2              DUP OPTION
&P       SETB  1                        PRIORITY OPTION SPECIFIED
&OPT     SETA  &OPT+X'20'               SET  LOW PRIORITY OPTION
&FLAGON  SETA  &FLAGON+32               SET LOW PRI OPTION EX  @G76XRYU
.PRDONE  ANOP                     ..CHECK PRIORITY OPERAND POS @G76XRYU
         AIF   (&RET NE 5).BADPOS   ..IF ^7TH OPERAND,WARNING  @G76XRYU
         AGO   .RET                 ..ELSE OK                  @G76XRYU
.BADPOS  ANOP             ..ISSUE WARNING IF OPERAND MISPLACED @G76XRYU
         MNOTE 4,'IHB300 WARNING: &PARM POSITIONAL PARAMETER MISPLACED'
.RET     ANOP
&PARM    SETC  '&WAIT'
         AIF   ('&RET' EQ '1').CKPARM   CHECK WAIT
&PARM    SETC  '&HOLD'
         AIF   ('&RET' EQ '2').CKPARM   CHECK HOLD
&PARM    SETC  '&BRKI'
         AIF   ('&RET' EQ '3').CKPARM   CHECK BRKI
&PARM    SETC  '&PRTY'
         AIF   ('&RET' EQ '4').CKPARM   CHECK PRTY
.*  PARAMETERS PROCESSED                                       @G76XRYU
         AIF   ('&MF' EQ '' AND &FLAGS2 EQ 0).OLD NON-EXTENDED @G76XRYU
         AIF   ('&MF' EQ 'L').LFORM       ...LIST EXPANSION... @G76XRYU
         AIF   ('&MF' EQ 'I' OR '&MF' EQ '').STFORM .ST. FORM. @G76XRYU
.******************                                            @G76XRYU
.*  EXECUTE FORM  *                                            @G76XRYU
.******************                                            @G76XRYU
&NAME    CNOP  0,4                          TPUT EXECUTE FORM  @G76XRYU
         AIF   ('&MF(2)'(1,1) EQ '(').MFREG  IF IN RX FORM  .. @G76XRYU
         LA    1,&MF(2)                     R1=>USER PARM LIST @G76XRYU
         AGO   .GOTPARM                                        @G76XRYU
.MFREG   ANOP                             .. ELSE, IN A REG .. @G76XRYU
         AIF   ('&MF(2)' EQ '(1)').GOTPARM ..IF NOT REG 1..    @G76XRYU
         LR    1,&MF(2)                     POINT R1 AT PARMS  @G76XRYU
.GOTPARM ANOP                                                  @G76XRYU
         AIF   (&FLAGOFF EQ 127).SKIPAND ..TURN OFF ANY FLAGS? @G76XRYU
         NI    4(1),&FLAGOFF                RESET FLAGS 1      @G76XRYU
.SKIPAND ANOP                      ..CHECK FOR FLAGS TURNED ON @G76XRYU
         AIF   (&FLAGON EQ 0).NOSET  ..TURN ON ANY FLAGS?      @G76XRYU
         OI    4(1),&FLAGON                 IN EXEC PARM LIST  @G76XRYU
.NOSET   ANOP                                                  @G76XRYU
         AIF   (&FLAGS2 EQ 0 AND NOT &E).NOFLAG2 ..IF NEW EDIT @G76XRYU
         MVI   12(1),&FLAGS2                RESET FLAGS2       @G76XRYU
.NOFLAG2 ANOP                                                  @G76XRYU
         AGO   .PARMCHK                 ..END UNIQUE E CODE..  @G76XRYU
.****************************                                  @G76XRYU
.*  STANDARD EXTENDED FORM  *                                  @G76XRYU
.****************************                                  @G76XRYU
.STFORM  ANOP                   ..STANDARD EXTENDED FORM CODE. @G76XRYU
&NAME    CNOP  0,4                          STANDARD EXTENDED  @G76XRYU
         AIF   ('&BFF' NE '(1)').NOTOLD  .IF OLD STANDARD FORM @G76XRYU
         STCM  1,B'0111',*+13               OLD SUPPORT ONLY   @G76XRYU
&OLDBUFF SETB  1                         .FLAG OLD BUFF ADDR.. @G76XRYU
.NOTOLD  ANOP                                                  @G76XRYU
         BAL   1,*+20                       BRANCH AROUND PARM @G76XRYU
TPUT&NDX DS    0H                           TPUT EXTENDED PARM @G76XRYU
         DC    H'0'                         ADDR SPACE ID      @G76XRYU
         DC    H'0'                         OUTPUT BUFFER SIZE @G76XRYU
         DC    AL1(&OPT)                    FLAGS 1            @G76XRYU
         DC    AL3(0)                       OUTPUT BUFFER ADDR @G76XRYU
         DC    A(0)                         ADDRESS OF USER ID @G76XRYU
         DC    AL1(&FLAGS2)                 FLAGS 2            @G76XRYU
         DC    AL3(0)                       RESERVED BYTES     @G76XRYU
.************************************************              @G76XRYU
.*  COMMON CODE FOR STANDARD AND EXECUTE FORMS  *              @G76XRYU
.************************************************              @G76XRYU
.PARMCHK ANOP                           ..GET PARMS FOR E & I  @G76XRYU
         AIF   ('&SIZE' EQ '').CKID     ...IF BUFF SIZE GIVEN. @G76XRYU
         AIF   ('&SIZE'(1,1) EQ '(').SIZEREG  ...IF AN INTEGER @G76XRYU
         AIF   (T'&SIZE NE 'N').SIZEQU  IF AN EQUATE           @OZ43223
         AIF   (&SIZE GT 32767).SIZERR          .NOT > 32767.. @G76XRYU
.SIZEQU  ANOP                                                  @OZ43223
         AIF   ('&MF' NE 'I' AND '&MF' NE '').SIZEEX .STANDARD @G76XRYU
         ORG   TPUT&NDX+2                   PUT SIZE VALUE     @G76XRYU
         DC    AL2(&SIZE)                   IN PARM LIST       @OZ43223
         ORG
         AGO   .CKID                                           @G76XRYU
.SIZEEX  ANOP                         ..IF EXECUTE             @G76XRYU
         B     *+6                          BR PAST SIZE VALUE @OZ43223
         DC    AL2(&SIZE)                   BUFSIZE            @OZ43223
         LH    0,*-2                        GET THE SIZE VALUE @G76XRYU
         STH   0,2(1)                       INTO THE PARM LIST @G76XRYU
         AGO   .CKID                                           @G76XRYU
.SIZEREG ANOP                                 ...ELSE A REG .. @G76XRYU
         STH   &SIZE(1),2(1)                PUT SIZE IN PARM   @G76XRYU
.CKID    ANOP                           ... CHECK IDS ...      @G76XRYU
         AIF   (&NTJ EQ 0).CKADDR       ..IF THERE IS AN ID..  @G76XRYU
         AIF   ('&TSID' EQ '').CKIDLOC  ..IF AN ASID # GIVEN.. @G76XRYU
         AIF   ('&TSID'(1,1) EQ '(').ASIDREG  ..IF AN INTEGER. @G76XRYU
         AIF   ((T'&ASID NE 'N' AND T'&TJID EQ 'O') OR (T'&TJID NE 'N' X
               AND T'&ASID EQ 'O')).IDEQU                      @OZ43223
         AIF   (&TSID GT 32767).IDERROR         .NOT > 32767.. @G76XRYU
.IDEQU   ANOP                                                  @OZ43223
         AIF   ('&MF' NE 'I' AND '&MF' NE '').IDEX ..STANDARD  @G76XRYU
         ORG   TPUT&NDX                     PUT ASID VALUE     @G76XRYU
         DC    AL2(&TSID)                   IN PARM LIST       @G76XRYU
         ORG
         AGO   .CKADDR                                         @G76XRYU
.IDEX    ANOP                               IF EXECUTE         @G76XRYU
         B     *+6                          GET AROUND ID #    @G76XRYU
         DC    AL2(&TSID)                   PUT ID # HERE      @OZ43223
         LH    0,*-2                        STORE ASID # IN    @G76XRYU
         STH   0,0(1)                       PARAMETER LIST     @G76XRYU
         AGO   .CKADDR                                         @G76XRYU
.ASIDREG ANOP                           .. ELSE ASID IN A REG. @G76XRYU
         STH   &TSID,0(1)                   STORE REG IN PARM  @G76XRYU
         AGO   .CKADDR                                         @G76XRYU
.CKIDLOC ANOP                           .. ELSE ID AT AN ADDR  @G76XRYU
.*                                            (ASIDLOC)        @G76XRYU
         AIF   ('&TSIDLOC' EQ '').CKUSER ..IF AN ADDRESS GIVEN @G76XRYU
         AIF   ('&TSIDLOC'(1,1) EQ '(').LOCIDRG  ..IF RX ADDR. @G76XRYU
         MVC   0(2,1),&TSIDLOC              MOVE ID INTO PARMS @G76XRYU
         AGO   .CKADDR                                         @G76XRYU
.LOCIDRG ANOP                           .. ELSE ID ADDR IN REG @G76XRYU
         MVC   0(2,1),0&TSIDLOC             MOVE ID INTO PARMS @G76XRYU
         AGO   .CKADDR                                         @G76XRYU
.CKUSER  ANOP                           ..ELSE A USER ID GIVEN @G76XRYU
         AIF   ('&USERIDL'(1,1) EQ '(').USEREG ..IF RX ADDR..  @G76XRYU
         AIF   ('&USERIDL'(K'&USERIDL,1) EQ ')' OR ('&MF' NE 'I' AND '&*
               MF' NE '')).USERX         ..IF STANDARD FORM    @G76XRYU
         ORG   TPUT&NDX+8                   PUT USER ID ADDR   @G76XRYU
         DC    A(&USERIDL)                  IN PARM LIST       @G76XRYU
         ORG
         AGO   .CKADDR                                         @G76XRYU
.USERX   ANOP                         ..IF EXECUTE OR LA ADDR  @G76XRYU
         LA    0,&USERIDL                   GET USER ID ADDR   @G76XRYU
         ST    0,8(1)                       INTO THE PARM LIST @G76XRYU
         AGO   .CKADDR                                         @G76XRYU
.USEREG  ANOP                           ...      ELSE A REG .. @G76XRYU
         ST    &USERIDL(1),8(1)             PUT ID IN PARM     @G76XRYU
.CKADDR  ANOP                           ..GET OUT BUFFER ADDR  @G76XRYU
         AIF   (&OLDBUFF).FINISH        ..IF OLD FORM,COMPLETE @G76XRYU
         AIF   ('&BFF' EQ '').FINISH    ..IF BUFFER ADDR GIVEN @G76XRYU
         AIF   ('&BFF'(1,1) EQ '(').BFFREG  ..IF AN RX ADDR... @G76XRYU
         LA    0,&BFF                       GET ADDR OF BUFFER @G76XRYU
         STCM  0,B'0111',5(1)               PUT IN PARM LIST   @G76XRYU
         AGO   .FINISH                                         @G76XRYU
.BFFREG  ANOP                               ..ELSE IN A REG .. @G76XRYU
         STCM  &BFF(1),B'0111',5(1)         STORE BUFFER ADDR  @G76XRYU
.FINISH  ANOP                                                  @G76XRYU
         OI    12(1),128                    SET HI BIT OF PARM @G76XRYU
         ICM   0,B'1000',*-3                SET HI BIT OF R0   @G76XRYU
.*                                        FROM 128 IN OI INSTR @G76XRYU
.SVCNEW  ANOP                           .. ISSUE SVC HERE ...  @G76XRYU
         SVC   93                           SVC TO MSG ROUTER  @G76XRYU
         MEXIT                                                 @G76XRYU
.**********************                                        @G76XRYU
.*  LIST FORM CODE    *                                        @G76XRYU
.**********************                                        @G76XRYU
.LFORM   ANOP                                                  @G76XRYU
         AIF   ('&TSIDLOC' EQ '').IDLOCOK ..IF L FORM INVALID. @G76XRYU
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L, ASIDLOC'
         MEXIT                                                 @G76XRYU
.IDLOCOK ANOP                           ..ASIDLOC OPERAND NULL @G76XRYU
&NAME    DS    0F                           L-FORM PARM LIST   @G76XRYU
         AIF   ('&TSID' NE '').LSTID    ..IF NO TSID GIVEN..   @G76XRYU
         DC    H'0'                         ASID HALFWORD      @G76XRYU
         AGO   .LBFFSIZ                                        @G76XRYU
.LSTID   ANOP                           ..ELSE TSID SPECIFIED. @G76XRYU
         AIF   ('&TSID'(1,1) EQ '(').REGERR   ..NOT A REGISTER @G76XRYU
         AIF   ((T'&ASID NE 'N' AND T'&TJID EQ 'O') OR (T'&TJID NE 'N' X
               AND T'&ASID EQ 'O')).IDEQU0                     @OZ43223
         AIF   (&TSID GT 32767).IDERROR         ..NOT > 32767. @G76XRYU
.IDEQU0  ANOP                                                  @OZ43223
         DC    AL2(&TSID)                   ADDR SPACE VALUE   @OZ43223
.LBFFSIZ ANOP                           .. CHECK BUFFER SIZE . @G76XRYU
         AIF   ('&SIZE' NE '').LSTSIZE  .. IF NO BUFFER SIZE . @G76XRYU
         DC    H'0'                         BUFF SIZE HALFWORD @G76XRYU
         AGO   .LBFADDR                                        @G76XRYU
.LSTSIZE ANOP                           .. ELSE A BUFFER SIZE. @G76XRYU
         AIF   ('&SIZE'(1,1) EQ '(').REGERR   .IF NOT IN A REG @G76XRYU
         AIF   (T'&SIZE NE 'N').SIZEQU0 IF AN EQUATE           @OZ43223
         AIF   (&SIZE GT 32767).SIZERR          .NOT > 32767.. @G76XRYU
.SIZEQU0 ANOP                                                  @OZ43223
         DC    AL2(&SIZE)                   BUFFER SIZE VALUE  @OZ43223
.LBFADDR ANOP                           .. CHECK BUFFER ADDR.. @G76XRYU
         DC    AL1(&OPT)                    FLAGS 1            @G76XRYU
         AIF   ('&BFF' NE '').LBFFLAB   ..IF NO BUFFER ADDR..  @G76XRYU
         DC    AL3(0)                       BUFFER ADDRESS     @G76XRYU
         AGO   .LSTUSER                                        @G76XRYU
.LBFFLAB ANOP                           .. ELSE BUFFER ADDRESS @G76XRYU
         AIF   ('&BFF'(1,1) EQ '(').REGERR  ..IF NOT IN A REG  @G76XRYU
&BFFPOS  SETA  2                                               @OZ56262
.LRXCK   ANOP                                                  @OZ56262
         AIF   (&BFFPOS GT K'&BFF).LBFFOK                      @OZ56262
         AIF   ('&BFF'(&BFFPOS,1) EQ '(').RXERR                @OZ56262
&BFFPOS  SETA  &BFFPOS+1                                       @OZ56262
         AGO  .LRXCK                                           @OZ56262
.LBFFOK  ANOP                                                  @OZ56262
         DC    AL3(&BFF)                    ADDR OUTPUT BUFFER @G76XRYU
.LSTUSER ANOP                                                  @G76XRYU
         AIF   ('&USERIDL' NE '').LUSADDR  ..IF NO USER ID ..  @G76XRYU
         DC    A(0)                         USER ID            @G76XRYU
         AGO   .LISTEND                                        @G76XRYU
.LUSADDR ANOP                              ..ELSE USER ID ...  @G76XRYU
         AIF   ('&USERIDL'(1,1) EQ '(').REGERR  ..IF NOT REG . @G76XRYU
         DC    A(&USERIDL)                  USER ID            @G76XRYU
.LISTEND ANOP                               .. GEN FLAGS2 ..   @G76XRYU
         DC    AL1(&FLAGS2)                 FLAGS 2            @G76XRYU
         DC    AL3(0)                       RESERVED           @G76XRYU
         MEXIT                                                 @G76XRYU
.REGERR  ANOP                              ..REGISTER ERROR..  @G76XRYU
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L, REGISTER OPERANDX
                SPECIFIED'                                     @G76XRYU
         MEXIT                                                 @G76XRYU
.RXERR   ANOP                                                  @OZ56262
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: MF=L, RX FORM OPERAND X
                SPECIFIED'                                     @OZ56262
         MEXIT                                                 @OZ56262
.*********************                                         @G76XRYU
.*   REGISTER FORM   *                                         @G76XRYU
.*********************                                         @G76XRYU
.RF      ANOP
         AIF   ('&MF' EQ '').RFNOMF   ..IF MF OPERAND GIVEN... @G76XRYU
         MNOTE 12,'IHB300 INCOMPATIBLE OPERANDS: R, MF'        @G76XRYU
         MEXIT                                                 @G76XRYU
.RFNOMF  ANOP                         ..IF NOEDIT SPECIFIED... @G76XRYU
         AIF   ('&WAIT' NE 'NOEDIT' AND '&HOLD' NE 'NOEDIT' AND '&BRKI'*
               NE 'NOEDIT' AND '&PRTY' NE 'NOEDIT').RFNOED     @G76XRYU
         MNOTE 12,'IHB300, INCOMPATIBLE OPERANDS: R, NOEDIT'   @G76XRYU
         MEXIT                                                 @G76XRYU
.RFNOED  ANOP                         CHECK REMAINING OPERANDS @G76XRYU
         AIF   ('&WAIT' NE '' OR '&HOLD' NE '' OR '&BRKI' NE '' OR '&PRX
               TY' NE '' OR &NTJ GT 0).RERR
         AIF   ('&BFF'(1,1) NE '(' OR '&SIZE'(1,1) NE '(').RERR
&NAME    DS    0H
         AIF   ('&BFF' EQ '(1)').SIZE
         LR    1,&BFF(1)                LOAD OPTIONS & BUFFER ADDR
.SIZE    AIF   ('&SIZE' EQ '(0)').SVC    ..IF REG 0-ISSUE SVC..
         LR    0,&SIZE(1)               LOAD TJID & BUFFER SIZE
         AGO   .SVC                     ... ISSUE SVC CALL ...
.************                                                  @G76XRYU
.*  MNOTES  *                                                  @G76XRYU
.************                                                  @G76XRYU
.SIZERR  ANOP                      ..SIZE INTEGER NOT 0-32767. @G76XRYU
&PARM    SETC  'SIZE'                ..INDICATE BAD SIZE PARM. @G76XRYU
         AGO   .INTERR                                         @G76XRYU
.IDERROR ANOP                      ..ASID INTEGER NOT 0-32767. @G76XRYU
&PARM    SETC  'ASID'                ..INDICATE BAD ASID PARM. @G76XRYU
.INTERR  MNOTE 12,'IHB300 &PARM NOT IN RANGE 0-32767'          @G76XRYU
         MEXIT                                                 @G76XRYU
.RERR    IHBERMAC 192
         MEXIT
.ERROR1  IHBERMAC 24
         MEXIT
.ERROR2  IHBERMAC 54,,,
         MEXIT
.ERROR3  IHBERMAC 49,,&PARM
         MEXIT                                                 @OZ43223
.ASIDERR MNOTE 12,'IHB300 ASID/USERID INVALID WITH NOEDIT'     @OZ43223
         MEXIT                                                 @OZ43223
.ASIDER2 MNOTE 12,'IHB300 ASID/USERID INVALID WITH FULLSCR'    @OZ67665
         MEXIT                                                 @OZ67665
.ASIDER3 MNOTE 12,'IHB300 ASID/USERID INVALID WITH ASIS'       @OZ67665
         MEXIT                                                 @OZ67665
.***********************                                       @G76XRYU
.*  NON-EXTENDED FORM  *                                       @G76XRYU
.***********************                                       @G76XRYU
.OLD     ANOP            ....NON EXTENDED TPUT EXPANSION       @G76XRYU
         AIF   ('&BFF'(1,1) EQ '(' OR '&SIZE'(1,1) EQ '(').REGFM  REG.
.*                                      FORM MACRO
         AIF   ('&TSID' EQ '').CHKLOC   GOTO CHECK TSIDLOC
         AIF   ('&TSID'(1,1) EQ '(').REGFM   REG. FORM MACRO
&ID      SETC  '&TSID'                  SET TSID
         AGO   .EXPAND                  GOTO EXPANSION
.CHKLOC  AIF   ('&TSIDLOC' EQ '').EXPAND  GO EXPAND IF NO 'TSIDLOC'
         AIF   ('&TSIDLOC'(1,1) EQ '(').REGFM  REG. FORM MACRO
.*   REGULAR FORMAT OF MACRO
.EXPAND  CNOP  0,4
         AIF   ('&TSIDLOC' NE '').LOC   TJLOC SPECIFIED
&NAME    B     *+10                    BRANCH AROUND CONSTANTS @OZ48113
         DC    AL2(&ID)                 TSID
         DC    AL2(&SIZE)               BUFFER SIZE
         DC    AL1(&OPT,0)             OPTION BYTE AND FILLER  @OZ48113
         L     0,*-6                    LOAD SIZE              @OZ48113
         LA    1,&BFF                   LOAD BUFFER ADDRESS    @OZ48113
         ICM   1,8,*-10                 LOAD OPTION BYTE       @OZ48113
.SVC     ANOP
         AIF   ('&USERIDL' EQ '').GENSVC
         AIF   ('&USERIDL'(1,1) EQ '(').LR
         LA    15,&USERIDL
         AGO   .GENSVC
.LR      ANOP
         AIF   ('&USERIDL' EQ '(15)').GENSVC
         LR    15,&USERIDL(1)
.GENSVC  ANOP
         SVC   93                       ISSUE TGET/TPUT SVC
         SPACE 1
         MEXIT
.*   TSIDLOC IS SPECIFIED
.LOC     ANOP
&NAME    ICM   0,B'0011',&TSIDLOC       TSID IN HIGH 2 BYTES   @G76XRYU
         SLL   0,16                     SHIFT TJID TO HI-ORDER BYTES
         AIF   (&OPT EQ 0).ZERO         BRANCH IF OPTIONS ARE ZERO
         O     0,*+8                    LOAD BUFFER SIZE
         B     *+10                    BRANCH AROUND CONSTANTS @OZ48113
         DC    AL2(0)                   TJID
         DC    AL2(&SIZE)               BUFFER SIZE
         DC    AL1(&OPT,0)             OPTION BYTE AND FILLER  @OZ48113
         LA    1,&BFF                   LOAD BUFFER ADDRESS    @OZ48113
         ICM   1,8,*-6                  LOAD OPTION BYTE       @OZ48113
         AGO   .SVC                     GOTO ISSUE SVC
.ZERO    LA    1,&SIZE                  LOAD BUFFER SIZE
         OR    0,1                      OR IT INTO REGISTER 0
         LA    1,&BFF                   Z HIGH ORDR BYTE & LD BFR ADDR
         AGO   .SVC                     GOTO ISSUE SVC
.*   REGISTER FORMAT
.REGFM   AIF   ('&TSIDLOC' EQ '').NOLOC   SKIP IF TJIDLOC NOT SPECIFIED
         AIF   ('&TSIDLOC'(1,1) EQ '(').REGLOC    LOC IN REG  FORM
&NAME    ICM   15,B'0011',&TSIDLOC      TSID IN HIGH 2 BYTES   @G76XRYU
         SLL   15,16                    MOVE TJID TO HI=ORDER 2 BYTES
         AGO   .CHKSIZE                 GOTO CHECK SIZE
.REGLOC  ANOP
&NAME    ICM   15,B'0011',0&TSIDLOC     TSID IN HIGH 2 BYTES   @G76XRYU
         SLL   15,16                    MOVE TJID TO HI-ORDER 2 BYTES
         AGO   .CHKSIZE                 GOTO CHECK SIZE
.*   WHEN TJIDLOC IS NOT SPECIFIED
.NOLOC   AIF   ('&TSID' NE '').TJIDYES
&NAME    DS    0H                       TJID IS '0'
         AGO   .CHKSIZE                 GOTO CHECK SIZE
.TJIDYES AIF   ('&TSID'(1,1) EQ '(').IDREG   TJID IN REG FORM
&NAME    LA    15,&TSID                 LOAD TJID
         AGO   .SHIFT                   GOTO SHIFT REG.0
.IDREG   ANOP
&NAME    LR    15,&TSID                 LOAD TJID IN REG 15
.SHIFT   SLL   15,16                    SHIFT TJID TO HI-ORDER BYTE
.*  CHECK SIZE OF BUFFER (BY NOW TJID IS IN HI-ORDER 2 BYTES OF REG 15)
.CHKSIZE AIF   ('&SIZE'(1,1) EQ '(').SZREG   SKIP IF SIZE IN REG
         LA    0,&SIZE                  LOAD SIZE IN REG.0
         AGO   .ORSIZE                  GOTO OR SIZE
.SZREG   AIF   ('&SIZE' EQ '(0)').ORSIZE  GOTO SET SIZE IN REG. 0
         LR    0,&SIZE(1)               LOAD BUFFER SIZE
.ORSIZE  AIF   ('&TSID' EQ '' AND '&TSIDLOC' EQ '').PAST
         OR    0,15                     LOAD TJID + BUFFER SIZE
.PAST    AIF   (&OPT EQ 0 AND '&BFF'(1,1) EQ '(').ORONE
         AIF   (&OPT EQ 0 AND '&BFF'(1,1) NE '(').ZOPT ZERO OPTN
         CNOP  0,4
         AIF   ('&BFF'(1,1) EQ '(').REGGO   BFFR IN REG.       @OZ65329
         CNOP  0,4                                             @OZ65329
         B     *+6                                             @OZ65329
         DC    AL1(&OPT,0)              OPTION BITS AND PAD    @OZ65329
         LA    1,&BFF                   LOAD POINTER TO BUFFER @OZ65329
         ICM   1,8,*-6                  GET OPTION BYTE        @OZ65329
         AGO   .SVC                     GOTO ISSUE SVC
.ZOPT    LA    1,&BFF                   LOAD BUFFER ADDR IN REG 1
         AGO   .SVC                     ISSUE SVC
.REGGO   CNOP  0,4                                             @OZ65329
         B     *+8                                             @OZ65329
         DC    AL1(&OPT)                OPTION BITS            @OZ65329
         DC    AL3(0)                   BUFFER ADDR            @OZ65329
.ORONE   LA    1,0(,&BFF(1))            CLR HIGH ORDR BYTE + LD BFR ADR
         AIF   (&OPT EQ 0).SVC          GOTO ISSUE SVC IF OPT EQ 0
         O     1,*-8                    SET OPTIONS
         AGO   .SVC
         MEND

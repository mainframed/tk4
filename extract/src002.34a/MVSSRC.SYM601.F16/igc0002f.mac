         TITLE '***** IGC0002F   CATALOG CONTROLLER LEVEL 3 *****      *
                        '
IGC0002F CSECT ,                                                   0001
@MAINENT BALR  @15,0                                               0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT-2)
         DC    AL1(16)                                             0001
         DC    C'IGC0002F  77.259'                                 0001
IGG0102F BALR  @15,0                                               0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00170-IGG0102F-2)
         ENTRY IGG0102F
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
RBPRFXLN EQU 64
RBPRFLNA EQU 32
PRBLEN   EQU 136
SIRBLEN  EQU 200
TIRBLEN  EQU 136
IRBLEN   EQU 128
SVRBLEN  EQU 224
*                                                                  0096
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN ROUTINE THROUGH WHICH ALL CALLS TO SVC26     */
*   /* ENTER. IT SAVES ALL THE CRITICAL REGISTERS AFTER OBTAINING THE*/
*   /* WORK AREA.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0096
*   HOLD1=PARMPTR;                  /* PRESERVE PARMLIST ADDRESS.    */
         LR    HOLD1,PARMPTR                                       0096
*   RFY                                                            0097
*    (R6,                                                          0097
*     RETCODE,                                                     0097
*     HOLD1) RSTD;                  /* RESTRICT REGS         @OZ09365*/
*   RFY                                                            0098
*     CAMLSTD BASED(HOLD1);         /* TEMP CHNG CAMLIST BASE        */
*   IF CAMAM0='0'B THEN             /* OS REQUEST?           @OZ09365*/
         TM    CAMAM0(HOLD1),B'00000001'                           0099
         BNZ   @RF00099                                            0099
*     IF CAMLTTR='0'B THEN          /* NOT LOCATE BY TTR?    @OZ09365*/
         TM    CAMLTTR(HOLD1),B'00000010'                          0100
         BNZ   @RF00100                                            0100
*       DO;                         /* THEN DO               @OZ09365*/
*         R6=CAMPTR1;               /* POINT TO NAME         @OZ09365*/
         L     R6,CAMPTR1(,HOLD1)                                  0102
*         GEN;                                                     0103
            CLI 0(R6),X'00'           /*FIRST CHAR ZERO?   @OZ09365*/
            BNE NM0001                /*NO, BR - NAME OK   @OZ09365*/
            LA  RETCODE,20            /*SET INVLD NAME RC  @OZ09365*/
            BR  14                    /*RTRN SVC26 CALLER  @OZ09365*/
NM0001   DS  0H
*       END;                                                       0104
*     ELSE                                                         0105
*       ;                                                          0105
@RF00100 DS    0H                                                  0106
*   ELSE                                                           0106
*     ;                                                            0106
@RF00099 DS    0H                                                  0107
*   RFY                                                            0107
*    (R6,                                                          0107
*     RETCODE,                                                     0107
*     HOLD1) UNRSTD;                /* RELEASE REGS          @OZ09365*/
*   RFY                                                            0108
*     CAMLSTD BASED(CAMPLPTR);      /* RSTR CAMLIST BASE     @OZ09365*/
*   GEN;                                                           0109
        L    0,@SIZDATD
        GETMAIN R,LV=(0)
        LR   12,1                     /* ESTABLISH WORKAREA ADDRESS*/
        USING @DATD,12
        LA   13,@SA00001
*   CAMPLPTR=HOLD1;                                                0110
         ST    HOLD1,CAMPLPTR                                      0110
*   CTGPLPTR=HOLD1;                                                0111
         ST    HOLD1,CTGPLPTR                                      0111
*   XCTLPARM=ADDR(XCTLNAME);                                       0112
         LA    @15,XCTLNAME                                        0112
         ST    @15,XCTLPARM                                        0112
*   XCTLNUL=ALLZERO;                                               0113
         MVC   XCTLNUL(4),ALLZERO                                  0113
*   XCTLNAME='IGG0CLA1';                                           0114
         MVC   XCTLNAME(8),@CC01157                                0114
*   CVTSAV=CVTPTR;                                                 0115
         ST    CVTPTR,CVTSAV                                       0115
*   TCBSAV=TCBPTR;                                                 0116
         ST    TCBPTR,TCBSAV                                       0116
*   SVRBSAV=SVRBPTR;                                               0117
         ST    SVRBPTR,SVRBSAV                                     0117
*   EXITSAV=EXITPTR;                                               0118
         ST    EXITPTR,EXITSAV                                     0118
*   RFY                                                            0119
*    (HOLD1,                                                       0119
*     CVTPTR,                                                      0119
*     TCBPTR,                                                      0119
*     SVRBPTR,                                                     0119
*     EXITPTR) UNRESTRICTED;        /* RELEASE ALL UNNECESSARY     0119
*                                      REGISTERS.                    */
*   PRMLSTSZ=ZERO;                  /* INDICATE NO SECONDARY GETMAIN
*                                      YET.                          */
         SLR   @10,@10                                             0120
         ST    @10,PRMLSTSZ                                        0120
*   WKCVOLVS=WKCVOLVS&&WKCVOLVS;    /* CLEAR CVOL VOLSER     @Z40CSRC*/
         XC    WKCVOLVS(6),WKCVOLVS                                0121
*   SASW=CHAR1;                     /* INIT FOR EXIT ROUT YL026RB    */
         MVC   SASW(1),CHAR1                                       0122
*   WASW=CHAR0;                     /* INIT FOR EXIT ROUT YL026RB    */
         MVC   WASW(1),CHAR0                                       0123
*   STSW=CHAR0;                     /* INIT FOR EXIT ROUT YL026RB    */
         MVC   STSW(1),CHAR0                                       0124
*   RFY                                                            0125
*    (R11,                                                         0125
*     ESTAPARM,                                                    0125
*     RETCODE) RSTD;                /* ESTAE USE YL026RB             */
*   BASEPTR=R11;                    /* INIT ESTALIST YL026RB         */
         ST    R11,BASEPTR                                         0126
*   WAPTR=WORKPTR;                  /* SAVE FOR ESTAE YL026RB        */
         ST    WORKPTR,WAPTR                                       0127
*   GEN;                                                           0128
        XC  PARMLIST(16),PARMLIST
        LA  5,ESTALIST      SETUP FOR ESTAE YL026RB
        ESTAE  ERRORTN,PARAM=(5),XCTL=YES,RECORD=YES,CT,              **
               MF=(E,PARMLIST)
*   IF RETCODE^=ZERO THEN                                          0129
*                                                                  0129
         LTR   RETCODE,RETCODE                                     0129
         BZ    @RF00129                                            0129
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE ESTAE WAS NOT SUCCESSFUL, STOP NOW                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0130
*     DO;                                                          0130
*       RFY                                                        0131
*        (HOLD15,                                                  0131
*         HOLD0,                                                   0131
*         HOLD1,                                                   0131
*         EXITPTR) RSTD;                                           0131
*       HOLD1=ZERO;                                                0132
         SLR   HOLD1,HOLD1                                         0132
*       IF CAMAM0='0'B THEN                                        0133
         L     @10,CAMPLPTR                                        0133
         TM    CAMAM0(@10),B'00000001'                             0133
         BNZ   @RF00133                                            0133
*         IF(CAMOPTNS&OSLOCMSK)=ALLZERO THEN                       0134
         MVC   @TS00001(4),CAMOPTNS(@10)                           0134
         NC    @TS00001(4),OSLOCMSK                                0134
         CLC   @TS00001(4),ALLZERO                                 0134
         BNE   @RF00134                                            0134
*           HOLD15=LOCIOERR;                                       0135
         L     HOLD15,LOCIOERR                                     0135
*         ELSE                                                     0136
*           HOLD15=CATIOERR;        /* LOCATE BY TTR RECEIVES A 28   */
         B     @RC00134                                            0136
@RF00134 L     HOLD15,CATIOERR                                     0136
*       ELSE                                                       0137
*         IF CTGFUNC=CTGLOC×CTGSUPLT='1'B THEN                     0137
         B     @RC00133                                            0137
@RF00133 L     @10,CTGPLPTR                                        0137
         TM    CTGFUNC(@10),B'00100000'                            0137
         BNO   @GL00001                                            0137
         TM    CTGFUNC(@10),B'11000000'                            0137
         BZ    @RT00137                                            0137
@GL00001 L     @10,CTGPLPTR                                        0137
         TM    CTGSUPLT(@10),B'00010000'                           0137
         BNO   @RF00137                                            0137
@RT00137 DS    0H                                                  0138
*           HOLD15=LOCIOERR;                                       0138
         L     HOLD15,LOCIOERR                                     0138
*         ELSE                                                     0139
*           HOLD15=CATIOERR;                                       0139
         B     @RC00137                                            0139
@RF00137 L     HOLD15,CATIOERR                                     0139
*       EXITPTR=EXITSAV;                                           0140
@RC00137 DS    0H                                                  0140
@RC00133 L     EXITPTR,EXITSAV                                     0140
*       MAINPTR=WORKPTR;                                           0141
         LR    MAINPTR,WORKPTR                                     0141
*       GEN(L   0,@SIZDATD);                                       0142
         L   0,@SIZDATD
*       GEN(FREEMAIN R,LV=(0),A=(1));                              0143
         FREEMAIN R,LV=(0),A=(1)
*       PARMPTR=HOLD1;                                             0144
         LR    PARMPTR,HOLD1                                       0144
*       R0=HOLD0;                                                  0145
         LR    R0,HOLD0                                            0145
*       RETCODE=HOLD15;                                            0146
         LR    RETCODE,HOLD15                                      0146
*       RFY                                                        0147
*        (HOLD15,                                                  0147
*         HOLD0,                                                   0147
*         HOLD1,                                                   0147
*         EXITPTR) UNRSTD;                                         0147
*       GEN(BR   14     ALL THRU);                                 0148
         BR   14     ALL THRU
*     END;                                                         0149
*   ELSE                                                           0150
*     ;                                                            0150
@RF00129 DS    0H                                                  0151
*   RFY                                                            0151
*    (R11,                                                         0151
*     ESTAPARM,                                                    0151
*     RETCODE) UNRSTD;              /* FREE USE YL026RB              */
*   CALL STRTCNTL;                  /* ANALYZE REQUEST.              */
         BAL   @14,STRTCNTL                                        0152
*                                                                  0153
*   /*****************************************************************/
*   /*                                                               */
*   /* UPON RETURN FROM STRTCNTL DETERMINE THE ROUTE OF CONTROL TO BE*/
*   /* TAKEN OUT OF THE CATALOG CONTROLLER.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0153
*   IF ROUTE>EXITRT                 /* IF NOT RETURNING      @Z40CSRC
*                                      DIRECTLY TO CALLER    @Z40CSRC*/
*     THEN                                                         0153
*                                                                  0153
         CLC   ROUTE(1),EXITRT                                     0153
         BNH   @RF00153                                            0153
*     /***************************************************************/
*     /*                                                             */
*     /* FOR EXITS BY XCTL TO VSAM CATALOG MANAGEMENT, RESTORE THE   */
*     /* REGS CRITICAL TO THE CATALOG AND EXIT. IF EXITING TO CVOL   */
*     /* PROCESSOR, CONTROL WILL                             @Z40CSRC*/
*     /* RETURN TO CALLER, NOT TO IGG0102F.                  @Z40CSRC*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0154
*     DO;                                                          0154
*       RFY                                                        0155
*        (CVTPTR,                                                  0155
*         TCBPTR,                                                  0155
*         SVRBPTR) RSTD;                                           0155
*       GEN(XC WKCATNM(1),WKCATNM  ZERO FOR VSAM YL026RB);         0156
         XC WKCATNM(1),WKCATNM  ZERO FOR VSAM YL026RB
*       CVTPTR=CVTSAV;                                             0157
         L     CVTPTR,CVTSAV                                       0157
*       TCBPTR=TCBSAV;                                             0158
         L     TCBPTR,TCBSAV                                       0158
*       SVRBPTR=SVRBSAV;                                           0159
         L     SVRBPTR,SVRBSAV                                     0159
*       PARMPTR=CTGPLPTR;                                          0160
         L     PARMPTR,CTGPLPTR                                    0160
*       IF ROUTE=XCTLCVOL THEN      /* IF DIRECT CVOL        @Z40CSRC*/
         CLI   ROUTE,2                                             0161
         BNE   @RF00161                                            0161
*         DO;                       /*                       @Z40CSRC*/
*           CTGPLPTR=NULL;          /* SHOW NO VSAM REQUEST AREA WAS
*                                      GOTTEN.               @Z40CSRC*/
         SLR   @10,@10                                             0163
         ST    @10,CTGPLPTR                                        0163
*           GEN(XCTL EP=IGG0CLCA);  /* TO CVOL PROCESSOR     @Z40CSRC*/
         XCTL EP=IGG0CLCA
*         END;                      /*                       @Z40CSRC*/
*       ELSE                                                       0166
*         ;                         /*                       @Z40CSRC*/
@RF00161 DS    0H                                                  0167
*       XCTLPTR=ADDR(XCTLLIST);                                    0167
         LA    XCTLPTR,XCTLLIST                                    0167
*       GEN(SVC 7           XCTL TO NEXT MODULE);                  0168
         SVC 7           XCTL TO NEXT MODULE
*       RFY                                                        0169
*        (CVTPTR,                                                  0169
*         TCBPTR,                                                  0169
*         SVRBPTR) UNRSTD;                                         0169
*                                                                  0169
*       /*************************************************************/
*       /*                                                           */
*       /* IGG0102F IS THE SECONDARY ENTRY POINT TO THE CATALOG      */
*       /* CONTROLLER. IT IS XCTL'ED TO BY VSAM CATALOG MANAGEMENT   */
*       /* WHEN PROCESSING IS COMPLETE.                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0170
*IGG0102F:                                                         0170
*       ENTRY;                                                     0170
@EP00170 DS    0H                                                  0171
*       SAVERC=VSAMRETC;                                           0171
         ST    VSAMRETC,SAVERC                                     0171
*       SAVER0=R0;                                                 0172
         ST    R0,SAVER0                                           0172
*       GEN(LA   13,@SA00001      SET SAVEAREA ADDRESS);           0173
         LA   13,@SA00001      SET SAVEAREA ADDRESS
*       CALL RESMCNTL;                                             0174
*                                                                  0174
         BAL   @14,RESMCNTL                                        0174
*       /*************************************************************/
*       /*                                                           */
*       /* ANY CONTROLLER-BUILT PARAMETER LIST IS FREED.             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0175
*       IF PRMLSTSZ>ZERO THEN                                      0175
         L     @10,PRMLSTSZ                                        0175
         LTR   @10,@10                                             0175
         BNP   @RF00175                                            0175
*         DO;                                                      0176
*           MAINSIZE=PRMLSTSZ;                                     0177
         LR    MAINSIZE,@10                                        0177
*           MAINPTR=CTGPLPTR;                                      0178
         L     MAINPTR,CTGPLPTR                                    0178
*           GEN(FREEMAIN R,LV=(0),A=(1));                          0179
         FREEMAIN R,LV=(0),A=(1)
*           WASW=CHAR0;             /* EXIT ROUTINE YL026RB          */
         MVC   WASW(1),CHAR0                                       0180
*         END;                                                     0181
*     END;                                                         0182
*                                                                  0182
@RF00175 DS    0H                                                  0183
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR EXITS BY RETURN TO THE CALLER, PRESERVE THE RETURN        */
*   /* REGISTERS, FREE THE WORK AREA FOR THIS CALL AND RETURN.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0183
*   RFY                                                            0183
*    (HOLD15,                                                      0183
*     HOLD0,                                                       0183
*     HOLD1,                                                       0183
*     EXITPTR) RSTD;                                               0183
@RF00153 DS    0H                                                  0184
*   HOLD1=ZERO;                                                    0184
         SLR   HOLD1,HOLD1                                         0184
*   HOLD0=SAVER0;                                                  0185
         L     HOLD0,SAVER0                                        0185
*   HOLD15=SAVERC;                                                 0186
         L     HOLD15,SAVERC                                       0186
*   GEN(ESTAE 0);                                                  0187
         ESTAE 0
*   EXITPTR=EXITSAV;                                               0188
         L     EXITPTR,EXITSAV                                     0188
*   MAINPTR=WORKPTR;                                               0189
         LR    MAINPTR,WORKPTR                                     0189
*   GEN(L   0,@SIZDATD);                                           0190
         L   0,@SIZDATD
*   GEN(FREEMAIN R,LV=(0),A=(1));                                  0191
         FREEMAIN R,LV=(0),A=(1)
*   PARMPTR=HOLD1;                                                 0192
         LR    PARMPTR,HOLD1                                       0192
*   R0=HOLD0;                                                      0193
         LR    R0,HOLD0                                            0193
*   RETCODE=HOLD15;                                                0194
         LR    RETCODE,HOLD15                                      0194
*   RFY                                                            0195
*    (HOLD15,                                                      0195
*     HOLD0,                                                       0195
*     HOLD1) UNRSTD;                                               0195
*   GEN(BR   14          TRANSFER TO THE EXIT PROLOG);             0196
         BR   14          TRANSFER TO THE EXIT PROLOG
*                                                                  0197
*   /*****************************************************************/
*   /*                                                               */
*   /* ERRORTN IS GIVEN CONTROL ON PERCOLATION FROM ANOTHER ESTAE    */
*   /* EXIT ROUTINE, OR RECEIVES CONTROL BECAUSE OF AN INTERRUPT IN  */
*   /* OUR CODE. REGISTER 14 MUST BE SAVED FOR RETURN TO THE RTM. AN */
*   /* RTCA MAY OR MAY NOT BE AVAILABLE. WE ALWAYS PERCOLATE TO THE  */
*   /* NEXT ESTAE ON THE CHAIN, BUT IF WE DETECT A BAD LOCATE        */
*   /* WORKAREA ON AN OS/VS REQUEST, THE USER RECEIVES A 11A ABEND.  */
*   /* REG 13 IS ALWAYS RESTRICTED BY PLS.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0197
*ERRORTN:                                                          0197
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0197
@EL00001 L     @13,4(,@13)                                         0197
@EF00001 DS    0H                                                  0197
@ER00001 BR    @14                                                 0197
ERRORTN  DS    0H                                                  0198
*   DO;                             /* ENTESTAE (11,12)SAVEAREA(@SA00
*                                      009)ERREXIT(NORTCA)PARMREG(15)
*                                      ENTRY CODE FOR ESTAE ROUTINE. */
*                                                                  0198
*     /***************************************************************/
*     /*                                                             */
*     /* IF RTCA ALLOCATED THEN RESTORE CODE AND DATA REGS FROM START*/
*     /* OF USERS PARM LIST, AND ESTABLISH ADDR TO ESTAE SAVE AREA IF*/
*     /* REQUIRED. IF NO RTCA AVAILABLE THEN BRANCH TO ERROR CODE    */
*     /* AFTER ESTABLISHING ADDRESSABILITY                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0199
*     GEN(USING *,GPR15P);                                         0199
         USING *,GPR15P
*     GEN(CH    GPR00F,*+26);       /* CHECK IF RTCA ALLOC FAILED    */
         CH    GPR00F,*+26
*     GEN(BNE   *+24);              /* NO,SAVE RTM REGS              */
         BNE   *+24
*     GEN(DROP  GPR15P);            /* DROP LOCAL ADDR               */
         DROP  GPR15P
*     GEN(LR    15,GPR02P);         /* PTR TO USER PARM LIST         */
         LR    15,GPR02P
*     GEN(L     11,00(15));                                        0204
         L     11,00(15)
*     GEN(L     12,04(15));                                        0205
         L     12,04(15)
*     GEN(LA    GPR13P,@SA00009);   /* SET PTR TO ESTAE SA           */
         LA    GPR13P,@SA00009
*     GEN(B     NORTCA);            /* BRANCH TO ERROR EXIT          */
         B     NORTCA
*     GEN(DC    H'12');             /* NO RTCA AVAIL RC              */
         DC    H'12'
*     GEN(STM   GPR14P,GPR12F,12(GPR13P));/* GOOD R13, SAVE RTM'S  0209
*                                      REGS                          */
         STM   GPR14P,GPR12F,12(GPR13P)
*     GEN(L     15,0(GPR01P));      /* PTR TO USER PARM LIST         */
         L     15,0(GPR01P)
*     GEN(L     11,00(15));                                        0211
         L     11,00(15)
*     GEN(L     12,04(15));                                        0212
         L     12,04(15)
*     GEN(ST    GPR13P,@SA00009+4); /* SET PTR TO RTM SA             */
         ST    GPR13P,@SA00009+4
*     GEN(LA    GPR13P,@SA00009);   /* SET PTR TO ESTAE SA           */
         LA    GPR13P,@SA00009
*   END;                            /* ENTESTAE (11,12)SAVEAREA(@SA00
*                                      009)ERREXIT(NORTCA)PARMREG(15)*/
*   RFY                                                            0216
*    (GPR01P,                                                      0216
*     EXITPTR) RSTD;                                               0216
*   RFY                                                            0217
*     SDWA BASED(GPR01P);                                          0217
*   GEN(ST  14,12(13));                                            0218
         ST  14,12(13)
*   IF SDWAPERC='0'B THEN                                          0219
*                                                                  0219
         TM    SDWAPERC(GPR01P),B'00010000'                        0219
         BNZ   @RF00219                                            0219
*     /***************************************************************/
*     /*                                                             */
*     /* IF WE WERE NOT PERCOLATED TO, CHECK TO SEE IF WE WERE       */
*     /* STORING IN THE USER'S KEY AND GOT A PROTECTION CHECK        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0220
*     IF STSW=CHAR1 THEN                                           0220
         CLC   STSW(1),CHAR1                                       0220
         BNE   @RF00220                                            0220
*       DO;                         /* SETRP COMPCOD(STCHK,SYSTEM)DUM
*                                      P(YES)RC(0)                   */
*         RESPECIFY                                                0222
*          (GPR00P,                                                0222
*           GPR01P,                                                0222
*           GPR14P,                                                0222
*           GPR15P) RSTD;                                          0222
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */
         MVI   SDWARCDE(GPR01P),X'00'                              0223
*         GPR01P->SDWAREQ='1'B;     /* TURN ON DUMP INDICATOR        */
         OI    SDWAREQ(GPR01P),B'10000000'                         0224
*         GPR14P=STCHK;             /* ACCESS COMPLETION CODE        */
         L     GPR14P,STCHK                                        0225
*         GEN(SLL    14,12);        /* SHIFT TO SYSTEM COMPLETION  0226
*                                      CODE                          */
         SLL    14,12
*         GPR01P->SDWACMPC=GPR14P;  /* STORE COMPLETION CODE         */
         STCM  GPR14P,7,SDWACMPC(GPR01P)                           0227
*         RESPECIFY                                                0228
*          (GPR00P,                                                0228
*           GPR01P,                                                0228
*           GPR14P,                                                0228
*           GPR15P) UNRSTD;                                        0228
*       END;                                                       0229
*     ELSE                                                         0230
*       IF SDWACMPC(1:1)='0C'X THEN /* PGM CHK COMPLETION CODE?    0230
*                                                            @ZA03946*/
         B     @RC00220                                            0230
@RF00220 CLI   SDWACMPC(GPR01P),X'0C'                              0230
         BNE   @RF00230                                            0230
*         DO;                                                      0231
*           DO;                     /* SETRP RC(0)RECORD(YES)DUMP(NO)
*                                      RECPARM(RECORD)               */
*             RESPECIFY                                            0233
*              (GPR00P,                                            0233
*               GPR01P,                                            0233
*               GPR14P,                                            0233
*               GPR15P) RSTD;                                      0233
*             GPR01P->SDWARCDE=0;   /* SAVE RC VALUE                 */
         MVI   SDWARCDE(GPR01P),X'00'                              0234
*             GPR01P->SDWARCRD='1'B;/* TURN ON RECORD INDICATOR      */
         OI    SDWARCRD(GPR01P),B'10000000'                        0235
*             GPR15P=ADDR(RECORD);  /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,RECORD                                       0236
*             GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD  0237
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0237
*             GPR01P->SDWAREQ='0'B; /* TURN OFF DUMP INDICATOR       */
         NI    SDWAREQ(GPR01P),B'01111111'                         0238
*             RESPECIFY                                            0239
*              (GPR00P,                                            0239
*               GPR01P,                                            0239
*               GPR14P,                                            0239
*               GPR15P) UNRSTD;                                    0239
*           END;                                                   0240
*           GEN;                                                   0241
        SDUMP HDR='IGC0002F CATLG CTLR 3',SDATA=(PSA,LSQA,RGN)
*         END;                                                     0242
*       ELSE                                                       0243
*         DO;                       /* SETRP RC(0)RECORD(NO)         */
         B     @RC00230                                            0243
@RF00230 DS    0H                                                  0244
*           RESPECIFY                                              0244
*            (GPR00P,                                              0244
*             GPR01P,                                              0244
*             GPR14P,                                              0244
*             GPR15P) RSTD;                                        0244
*           GPR01P->SDWARCDE=0;     /* SAVE RC VALUE                 */
         MVI   SDWARCDE(GPR01P),X'00'                              0245
*           GPR01P->SDWARCRD='0'B;  /* TURN OFF RECORD INDICATOR     */
         NI    SDWARCRD(GPR01P),B'01111111'                        0246
*           RESPECIFY                                              0247
*            (GPR00P,                                              0247
*             GPR01P,                                              0247
*             GPR14P,                                              0247
*             GPR15P) UNRSTD;                                      0247
*         END;                      /*                       @ZA03946*/
*                                                                  0248
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE WERE PERCOLATED TO, DON'T MODIFY DUMP SWITCH SET OPTIONS*/
*   /* FOR RECORD TO SYS1.LOGREC                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0249
*   ELSE                                                           0249
*     DO;                           /* SETRP RECORD(YES)DUMP(IGNORE)R
*                                      C(0)RECPARM(RECORD)           */
         B     @RC00219                                            0249
@RF00219 DS    0H                                                  0250
*       RESPECIFY                                                  0250
*        (GPR00P,                                                  0250
*         GPR01P,                                                  0250
*         GPR14P,                                                  0250
*         GPR15P) RSTD;                                            0250
*       GPR01P->SDWARCDE=0;         /* SAVE RC VALUE                 */
         MVI   SDWARCDE(GPR01P),X'00'                              0251
*       GPR01P->SDWARCRD='1'B;      /* TURN ON RECORD INDICATOR      */
         OI    SDWARCRD(GPR01P),B'10000000'                        0252
*       GPR15P=ADDR(RECORD);        /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,RECORD                                       0253
*       GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD        0254
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0254
*       RESPECIFY                                                  0255
*        (GPR00P,                                                  0255
*         GPR01P,                                                  0255
*         GPR14P,                                                  0255
*         GPR15P) UNRSTD;                                          0255
*     END;                                                         0256
*FREEWA:                                                           0257
*   IF WASW=CHAR1 THEN                                             0257
@RC00219 DS    0H                                                  0257
FREEWA   CLC   WASW(1),CHAR1                                       0257
         BNE   @RF00257                                            0257
*     DO;                                                          0258
*       MAINSIZE=PRMLSTSZ;                                         0259
         L     MAINSIZE,PRMLSTSZ                                   0259
*       MAINPTR=CTGPLPTR;                                          0260
         L     MAINPTR,CTGPLPTR                                    0260
*       GEN(FREEMAIN R,LV=(0),A=(1));                              0261
         FREEMAIN R,LV=(0),A=(1)
*     END;                                                         0262
*   ELSE                                                           0263
*     ;                                                            0263
@RF00257 DS    0H                                                  0264
*   GEN(L   14,12(13));                                            0264
         L   14,12(13)
*   IF SASW=CHAR1 THEN                                             0265
         CLC   SASW(1),CHAR1                                       0265
         BNE   @RF00265                                            0265
*     DO;                                                          0266
*       MAINPTR=WORKPTR;                                           0267
         LR    MAINPTR,WORKPTR                                     0267
*       GEN(L   0,@SIZDATD);                                       0268
         L   0,@SIZDATD
*       GEN(FREEMAIN R,LV=(0),A=(1));                              0269
         FREEMAIN R,LV=(0),A=(1)
*     END;                                                         0270
*   ELSE                                                           0271
*     ;                                                            0271
@RF00265 DS    0H                                                  0272
*   GEN(XR  15,15  ZERO 15 IN CASE NORTCA);                        0272
         XR  15,15  ZERO 15 IN CASE NORTCA
*   GEN(BR  14);                                                   0273
         BR  14
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     0274
*     GPR12F FIXED(31) REG(12),                                    0274
*     GPR00P PTR(31) REG(0),                                       0274
*     GPR01P PTR(31) REG(1),                                       0274
*     GPR02P PTR(31) REG(2),                                       0274
*     GPR13P PTR(31) REG(13),                                      0274
*     GPR14P PTR(31) REG(14),                                      0274
*     GPR15P PTR(31) REG(15);                                      0274
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0275
*     I031F FIXED(31) BASED,                                       0275
*     I031P PTR(31) BASED,                                         0275
*     I015F FIXED(15) BASED,                                       0275
*     I015P PTR(15) BASED,                                         0275
*     I008P PTR(8) BASED,                                          0275
*     I001C CHAR(1) BASED;                                         0275
*NORTCA:                                                           0276
*   GEN(ST  14,12(13));                                            0276
NORTCA   ST  14,12(13)
*   GO TO FREEWA;                                                  0277
         B     FREEWA                                              0277
*   RFY                                                            0278
*    (GPR01P,                                                      0278
*     EXITPTR) UNRSTD;                                             0278
*   END ERRORTN;                                                   0279
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* STRTCNTL IS CALLED ON ALL INITIAL ENTRIES TO DETERMINE THE    */
*   /* TYPE OF REQUEST AND THE TYPE OF FUNCTION THAT IS TO BE        */
*   /* PERFORMED. ALL VSAM-FORMAT REQUESTS ARE PASSED ON TO VSAM     */
*   /* CATALOG MANAGEMENT WITH NO CHANGE. OS/VS REQUESTS WHICH       */
*   /* SPECIFY A CVOL VOLSER                                 @Z40CSRC*/
*   /* ARE ROUTED DIRECTLY TO THE CVOL PROCESSOR. OTHER VALID        */
*   /* OS/VS-FORMAT REQUESTS ARE TRANSLATED INTO VSAM- FORMAT        */
*   /* REQUESTS BEFORE CONTROL IS PASSED TO VSAM CATALOG MANAGEMENT. */
*   /* ALL INVALID OS/VS-FORMAT REQUESTS RETURN TO THE CALLER WITH A */
*   /* RETURN CODE AND DO NOT GO TO VSAM CATALOG MANAGEMENT.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*STRTCNTL:                                                         0280
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0280
STRTCNTL ST    @14,12(,@13)                                        0280
         ST    @13,@SA00003+4                                      0280
         LA    @14,@SA00003                                        0280
         LR    @13,@14                                             0280
*   ROUTE=XCTL;                                                    0281
         MVC   ROUTE(1),XCTL                                       0281
*   IF CAMAM0='0'B THEN             /* IF NOT VSAM           @Z40CSRC*/
*                                                                  0282
         L     @10,CAMPLPTR                                        0282
         TM    CAMAM0(@10),B'00000001'                             0282
         BNZ   @RF00282                                            0282
*     /***************************************************************/
*     /*                                                             */
*     /* IF A CVOL VOLUME SERIAL HAS BEEN SPECIFIED, NO TRANSLATION  */
*     /* TO VSAM FORMAT IS REQUIRED SINCE CONTROL WILL PASS DIRECTLY */
*     /* TO THE OS CVOL PROCESSOR.                           @Z40CSRC*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0283
*     IF CAMCVOL=ON THEN            /* IF CVOL VOLSER        @Z40CSRC*/
         TM    CAMCVOL(@10),B'10000000'                            0283
         BNO   @RF00283                                            0283
*       DO;                         /*                       @Z40CSRC*/
*         ROUTE=XCTLCVOL;           /* WILL XCTL TO CVOL     @Z40CSRC*/
         MVI   ROUTE,X'02'                                         0285
*         WKCVOLVS=CAMCVOLS;        /* COPY CVOL VOLSER      @Z40CSRC*/
         L     @10,CAMCVOLP(,@10)                                  0286
         MVC   WKCVOLVS(6),CAMCVOLS(@10)                           0286
*       END;                        /*                       @Z40CSRC*/
*     ELSE                          /* NO VOLSER SUPPLIED    @Z40CSRC*/
*       DO;                         /* OS/VS TRANSLATING     @Z40CSRC*/
*                                                                  0288
         B     @RC00283                                            0288
@RF00283 DS    0H                                                  0289
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REQUEST IS INDICATED TO BE IN OS/VS FORMAT, THEN */
*         /* A CHECK MUST BE MADE TO SEE IF IT IS A TRANSLATABLE     */
*         /* FUNCTION. THE APPROPRIATE SUBROUTINE THEN CALLED TO MAKE*/
*         /* THE TRANSLATION.                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0289
*         IF CAMBLDA=ON             /* IF BUILD INDEX        @Z40CSRC*/
*             ×CAMDLTA=ON           /* OR DELETE ALIAS       @Z40CSRC*/
*             ×CAMDRPX=ON           /* OR RELEASE CVOL       @Z40CSRC*/
*             ×CAMLNKX=ON THEN      /* OR CONNECT            @Z40CSRC*/
         L     @10,CAMPLPTR                                        0289
         TM    CAMBLDA(@10),B'00010001'                            0289
         BNZ   @RT00289                                            0289
         TM    CAMDRPX(@10),B'10000000'                            0289
         BO    @RT00289                                            0289
         TM    CAMLNKX(@10),B'00001000'                            0289
         BNO   @RF00289                                            0289
@RT00289 DS    0H                                                  0290
*           WORKNAME=CAMIDXNM;      /* COPY INDEX NAME AND PAD RIGHT
*                                      WITH BLANKS           @Z40CSRC*/
         MVI   WORKNAME+8,C' '                                     0290
         MVC   WORKNAME+9(35),WORKNAME+8                           0290
         L     @10,CAMPLPTR                                        0290
         L     @10,CAMPTR1(,@10)                                   0290
         MVC   WORKNAME(8),CAMIDXNM(@10)                           0290
*         ELSE                      /* NOT ALWAYS 8 CHAR     @Z40CSRC*/
*           DO;                     /* MOVE VARIABLE NAME    @Z40CSRC*/
         B     @RC00289                                            0291
@RF00289 DS    0H                                                  0292
*             RFY                                                  0292
*              (R6,                                                0292
*               R7,                                                0292
*               WRKREG) RSTD;       /*                       @YM04805*/
*             R6=CAMPTR1;           /* GET ADDR OF DSNAME    @YM04805*/
         L     @10,CAMPLPTR                                        0293
         L     R6,CAMPTR1(,@10)                                    0293
*             R7=ADDR(WORKNAME);    /* GET ADDR OF WORKNAME  @YM04805*/
         LA    R7,WORKNAME                                         0294
*             WORKNAME=' ';         /* BLANK HOLD AREA       @YM04805*/
         MVI   WORKNAME+1,C' '                                     0295
         MVC   WORKNAME+2(42),WORKNAME+1                           0295
         MVI   WORKNAME,C' '                                       0295
*             WRKREG=44;            /* SET LIMIT OF NAME SIZE      0296
*                                                            @YM04805*/
         LA    WRKREG,44                                           0296
*             GEN;                                                 0297
*                                 /*                       @YM04805*/
MOVENAME CLI   0(R6),C' '    CHECK FOR BLANK               @YM04805
         BE    MN0001        FOUND STOP SCAN AND MOVE      @YM04805
         MVC   0(1,R7),0(R6) NOT BLANK,MOVE IT             @YM04805
         LA    R6,1(R6)      BUMP POINTER                  @YM04805
         LA    R7,1(R7)      BUMP POINTER                  @YM04805
         BCT   WRKREG,MOVENAME LOOP 44 TIMES               @YM04805
MN0001   DS    0H            EXIT                          @YM04805
*             RFY                                                  0298
*              (R6,                                                0298
*               R7,                                                0298
*               WRKREG) UNRSTD;     /*                       @YM04805*/
*           END;                    /* OF MOVING VAR. NM     @Z40CSRC*/
*         CALLTYPE=OSVS;            /* RECORD THE REQUEST FORMAT.    */
@RC00289 MVC   CALLTYPE(1),OSVS                                    0300
*         VOLSTPTR=CAMPTR3;         /* RECORD VOLUME LIST ADDRESS    */
         L     @10,CAMPLPTR                                        0301
         L     @03,CAMPTR3(,@10)                                   0301
         ST    @03,VOLSTPTR                                        0301
*         OPTBITS=CAMOPTNS;         /* RECORD THE OPTION BITS.       */
         MVC   OPTBITS(4),CAMOPTNS(@10)                            0302
*         IF(OPTBITS&OSLOCMSK)=ALLZERO THEN                        0303
*                                                                  0303
         MVC   @TS00001(4),OPTBITS                                 0303
         NC    @TS00001(4),OSLOCMSK                                0303
         CLC   @TS00001(4),ALLZERO                                 0303
         BNE   @RF00303                                            0303
*           /*********************************************************/
*           /*                                                       */
*           /* A LOCATE BY DATA SET NAME IS A VALID FUNCTION. VLOCATE*/
*           /* IS CALLED TO TRANSLATE THE REQUEST TO A VSAM-FORMAT   */
*           /* SUPERLOCATE.                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0304
*           CALL VLOCATE;                                          0304
         BAL   @14,VLOCATE                                         0304
*         ELSE                                                     0305
*           IF(OPTBITS&CATMSK)=ALLZERO&(OPBIT1&CAMCAT)^=ZEROFLD THEN
*                                                                  0305
         B     @RC00303                                            0305
@RF00303 MVC   @TS00001(4),OPTBITS                                 0305
         NC    @TS00001(4),CATMSK                                  0305
         CLC   @TS00001(4),ALLZERO                                 0305
         BNE   @RF00305                                            0305
         MVC   @TS00001(1),OPBIT1                                  0305
         NC    @TS00001(1),CAMCAT                                  0305
         CLC   @TS00001(1),ZEROFLD                                 0305
         BE    @RF00305                                            0305
*             /*******************************************************/
*             /*                                                     */
*             /* A CATALOG REQUEST IS A VALID FUNCTION. VCATLG IS    */
*             /* CALLED TO TRANSLATE THE REQUEST TO A DEFINE NON-VSAM*/
*             /* REQUEST.                                            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0306
*             CALL VCATLG;                                         0306
         BAL   @14,VCATLG                                          0306
*           ELSE                                                   0307
*             IF(OPTBITS&UCATMSK)=ALLZERO&(OPBIT1&CAMUNCAT)^=ZEROFLD
*               THEN                                               0307
*                                                                  0307
         B     @RC00305                                            0307
@RF00305 MVC   @TS00001(4),OPTBITS                                 0307
         NC    @TS00001(4),UCATMSK                                 0307
         CLC   @TS00001(4),ALLZERO                                 0307
         BNE   @RF00307                                            0307
         MVC   @TS00001(1),OPBIT1                                  0307
         NC    @TS00001(1),CAMUNCAT                                0307
         CLC   @TS00001(1),ZEROFLD                                 0307
         BE    @RF00307                                            0307
*               /*****************************************************/
*               /*                                                   */
*               /* AN UNCATALOG REQUEST IS A VALID FUNCTION. VUNCAT  */
*               /* IS CALLED TO TRANSLATE THE REQUEST TO A DELETE    */
*               /* NON-VSAM REQUEST.                                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0308
*               CALL VUNCAT;                                       0308
         BAL   @14,VUNCAT                                          0308
*             ELSE                                                 0309
*               IF(OPTBITS&RECATMSK)=ALLZERO&(OPBIT1&CAMRECAT)^=ZEROFLD
*                 THEN                                             0309
*                                                                  0309
         B     @RC00307                                            0309
@RF00307 MVC   @TS00001(4),OPTBITS                                 0309
         NC    @TS00001(4),RECATMSK                                0309
         CLC   @TS00001(4),ALLZERO                                 0309
         BNE   @RF00309                                            0309
         MVC   @TS00001(1),OPBIT1                                  0309
         NC    @TS00001(1),CAMRECAT                                0309
         CLC   @TS00001(1),ZEROFLD                                 0309
         BE    @RF00309                                            0309
*                 /***************************************************/
*                 /*                                                 */
*                 /* RECATALOG IS A VALID FUNCTION. VRECAT IS CALLED */
*                 /* TO REFORMAT THE REQUEST TO AN ALTER NON-VSAM    */
*                 /* REQUEST.                                        */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0310
*                 CALL VRECAT;                                     0310
         BAL   @14,VRECAT                                          0310
*               ELSE                                               0311
*                                                                  0311
*                 /***************************************************/
*                 /*                                                 */
*                 /* BLDA, BLDG, BLDX, DLTA, DLTX, LNKX, DRPX WILL BE*/
*                 /* TRANSLATED INTO A DUMMY VSAM FUNCTION TO GET    */
*                 /* ORIENTED TO THE PROPER CVOL.                    */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0311
*                 IF(OPTBITS&OLDOSMSK)^=ZERO THEN                  0311
         B     @RC00309                                            0311
@RF00309 L     @10,OPTBITS                                         0311
         N     @10,@CF01108                                        0311
         LTR   @10,@10                                             0311
         BZ    @RF00311                                            0311
*                   CALL VDUMMY;    /* GO TRANSLATE          @Z40CSRC*/
         BAL   @14,VDUMMY                                          0312
*                 ELSE              /* NOT-TRANSLATABLE      @Z40CSRC*/
*                                                                  0313
*                   /*************************************************/
*                   /*                                               */
*                   /* ANY OTHER OS/VS-FORMAT REQUESTS ARE           */
*                   /* NON-TRANSLATABLE AND GENERATE ONLY A RETURN   */
*                   /* CODE. OSFUNCT IS CALLED TO DETERMINE THE      */
*                   /* RETURN CODE.                                  */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0313
*                   CALL OSFUNCT;                                  0313
         B     @RC00311                                            0313
@RF00311 BAL   @14,OSFUNCT                                         0313
*       END;                        /* OF OS/VS TRANSLATING  @Z40CSRC*/
*   ELSE                                                           0315
*                                                                  0315
*     /***************************************************************/
*     /*                                                             */
*     /* VSAM-FORMAT REQUESTS (CTGAM0 = '1'B) DO NOT REQUIRE ANY     */
*     /* TRANSLATION. THEY ARE PASSED DIRECTLY TO VSAM CATALOG       */
*     /* MANAGEMENT WITH NO ACTION TAKEN BY THE CATALOG CONTROLLER,  */
*     /* OTHER THAN RECORDING THE TYPE OF CALL.                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0315
*     CALLTYPE=VSAM;                                               0315
         B     @RC00282                                            0315
@RF00282 MVC   CALLTYPE(1),VSAM                                    0315
*   END STRTCNTL;                                                  0316
@EL00003 L     @13,4(,@13)                                         0316
@EF00003 DS    0H                                                  0316
@ER00003 L     @14,12(,@13)                                        0316
         BR    @14                                                 0316
*                                                                  0317
*   /*****************************************************************/
*   /*                                                               */
*   /* RESMCNTL IS CALLED ON ALL SECONDARY ENTRIES TO DETERMINE WHAT */
*   /* THE ORIGINAL REQUEST WAS AND TO CONTINUE PROCESSING AS        */
*   /* NECESSARY.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0317
*RESMCNTL:                                                         0317
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0317
RESMCNTL ST    @14,12(,@13)                                        0317
         ST    @13,@SA00004+4                                      0317
         LA    @14,@SA00004                                        0317
         LR    @13,@14                                             0317
*   ROUTE=EXITRT;                                                  0318
         MVC   ROUTE(1),EXITRT                                     0318
*   IF CALLTYPE=OSVS THEN                                          0319
*                                                                  0319
         CLC   CALLTYPE(1),OSVS                                    0319
         BNE   @RF00319                                            0319
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE ORIGINAL REQUEST WAS IN OS/VS FORMAT THEN A CHECK    */
*     /* MUST BE MADE TO SEE WHAT THE FUNCTION REQUESTED WAS TO      */
*     /* DETERMINE IF REFORMATTING OF THE OUTPUT IS NECESSARY.       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0320
*     DO;                                                          0320
*       IF(OPTBITS&OSLOCMSK)=ALLZERO THEN                          0321
*                                                                  0321
         MVC   @TS00001(4),OPTBITS                                 0321
         NC    @TS00001(4),OSLOCMSK                                0321
         CLC   @TS00001(4),ALLZERO                                 0321
         BNE   @RF00321                                            0321
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE ORIGINAL REQUEST WAS A LOCATE BY DATA SET NAME,  */
*         /* THEN IT MAY BE NECESSARY TO REFORMAT THE DATA IF A      */
*         /* SUCCESSFUL RETURN CODE IS INDICATED.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0322
*         DO;                                                      0322
*           IF SAVERC=NORMRC×SAVERC=TOOSMALL×SAVERC=SMALLWKA THEN  0323
*                                                                  0323
         L     @10,SAVERC                                          0323
         LTR   @10,@10                                             0323
         BZ    @RT00323                                            0323
         C     @10,TOOSMALL                                        0323
         BE    @RT00323                                            0323
         C     @10,SMALLWKA                                        0323
         BNE   @RF00323                                            0323
@RT00323 DS    0H                                                  0324
*             /*******************************************************/
*             /*                                                     */
*             /* ANY OF THE ABOVE RETURN CODES INDICATES THAT        */
*             /* SUPERLOCATE RETURNED A VOLUME LIST THAT MUST BE     */
*             /* REFORMATTED INTO OS/VS FORMAT.                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0324
*             CALL OSVOLST;                                        0324
         BAL   @14,OSVOLST                                         0324
*           ELSE                                                   0325
*                                                                  0325
*             /*******************************************************/
*             /*                                                     */
*             /* ALL NON-ZERO RETURN CODES MUST BE MAPPED TO A       */
*             /* COMPARABLE OS/VS RETURN CODE.                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0325
*             CALL OSRETCD;                                        0325
         B     @RC00323                                            0325
@RF00323 BAL   @14,OSRETCD                                         0325
*         END;                                                     0326
*       ELSE                                                       0327
*                                                                  0327
*         /***********************************************************/
*         /*                                                         */
*         /* TRANSLATE ANY NON-LOCATE RETURN CODES ON ORIGINAL OS/VS */
*         /* CALLS                                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0327
*         DO;                                                      0327
         B     @RC00321                                            0327
@RF00321 DS    0H                                                  0328
*           IF SAVERC=NORMRC THEN                                  0328
         SLR   @10,@10                                             0328
         C     @10,SAVERC                                          0328
         BNE   @RF00328                                            0328
*             SAVER0=ZERO;                                         0329
         ST    @10,SAVER0                                          0329
*           ELSE                                                   0330
*             CALL OSRETCD;                                        0330
         B     @RC00328                                            0330
@RF00328 BAL   @14,OSRETCD                                         0330
*         END;                                                     0331
*     END;                                                         0332
*   ELSE                                                           0333
*     ;                                                            0333
*                                                                  0333
@RF00319 DS    0H                                                  0334
*   /*****************************************************************/
*   /*                                                               */
*   /* ANY REQUEST OF VSAM FORMAT NEEDS NO REFORMATTING SO THE       */
*   /* CATALOG CONTROLLER TAKES NO FURTHER ACTION.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   END RESMCNTL;                                                  0334
@EL00004 L     @13,4(,@13)                                         0334
@EF00004 DS    0H                                                  0334
@ER00004 L     @14,12(,@13)                                        0334
         BR    @14                                                 0334
*                                                                  0335
*   /*****************************************************************/
*   /*                                                               */
*   /* VLOCATE IS CALLED WHEN AN OS/VS-FORMAT LOCATE BY DATA SET NAME*/
*   /* NEEDS TO BE TRANSLATED TO A VSAM SUPERLOCATE PARAMETER LIST.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*VLOCATE:                                                          0335
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0335
VLOCATE  ST    @14,12(,@13)                                        0335
         ST    @13,@SA00005+4                                      0335
         LA    @14,@SA00005                                        0335
         LR    @13,@14                                             0335
*   CALL GETSPACE(LOCPRMSZ,ADDR(CTGFIELD(2))-ADDR(CTGPL));         0336
         LA    @10,LOCPRMSZ                                        0336
         ST    @10,@AL00001                                        0336
         L     @10,CTGPLPTR                                        0336
         LA    @03,CTGFIELD+4(,@10)                                0336
         SLR   @03,@10                                             0336
         ST    @03,@AFTEMPS                                        0336
         LA    @10,@AFTEMPS                                        0336
         ST    @10,@AL00001+4                                      0336
         LA    @01,@AL00001                                        0336
         BAL   @14,GETSPACE                                        0336
*   CTGNAME='1'B;                                                  0337
         L     @10,CTGPLPTR                                        0337
         OI    CTGNAME(@10),B'00000100'                            0337
*   CTGSUPLT='1'B;                                                 0338
         OI    CTGSUPLT(@10),B'00010000'                           0338
*   CTGENT=CAMPTR1;                                                0339
         L     @03,CAMPLPTR                                        0339
         L     @03,CAMPTR1(,@03)                                   0339
         ST    @03,CTGENT(,@10)                                    0339
*   CTGWKA=ADDR(CTGDYNWA);                                         0340
         LA    @03,CTGDYNWA(,@10)                                  0340
         ST    @03,CTGWKA(,@10)                                    0340
*   CTGWAVL=ADDR(VOLSTCTG);                                        0341
         LA    @15,VOLSTCTG(,@10)                                  0341
         ST    @15,CTGWAVL(,@03)                                   0341
*   CTGCVOL=ADDR(CVOLCTG);                                         0342
         LA    @15,CVOLCTG(,@10)                                   0342
         ST    @15,CTGCVOL(,@10)                                   0342
*   CTGCVDEV=ALLZERO;                                              0343
         MVC   CTGCVDEV(4,@15),ALLZERO                             0343
*   CTGWALV=LISTLEN;                                               0344
         LH    @10,LISTLEN                                         0344
         STH   @10,CTGWALV(,@03)                                   0344
*   RFY                                                            0345
*    (TCBPTR,                                                      0345
*     WRKREG) RSTD;                                                0345
*   TCBPTR=TCBSAV;                                                 0346
         L     TCBPTR,TCBSAV                                       0346
*   STSW=CHAR1;                     /* ESTAE USE-ON YL026RB          */
         MVC   STSW(1),CHAR1                                       0347
*   DO;                             /* MODESET SAVEKEY(OLDKEY)     0348
*                                      EXTKEY(RBT234) WORKREG(WRKREG)*/
*     RESPECIFY                                                    0349
*      (GPR02F) RESTRICTED;                                        0349
*     WRKREG=GPR02F;                /* SAVE REGISTER 2               */
         LR    WRKREG,GPR02F                                       0350
*     IPK;                          /* SAVE CURRENT PSW KEY          */
         IPK                                                       0351
*     OLDKEY=GPR02F;                                               0352
         STC   GPR02F,OLDKEY                                       0352
*     GPR02F=WRKREG;                /* RESTORE REGISTER 2            */
         LR    GPR02F,WRKREG                                       0353
*     WRKREG=TCBRBP;                /* RB PTR FROM TCB               */
         L     WRKREG,TCBRBP(,TCBPTR)                              0354
*     WRKREG=WRKREG->RBLINK;        /* NEXT RB ADDRESS               */
         L     WRKREG,RBLINK(,WRKREG)                              0355
*     WRKREG=WRKREG->RBOPSW(2);     /* PSW KEY FROM RB OLD PSW       */
         SLR   @10,@10                                             0356
         IC    @10,RBOPSW+1(,WRKREG)                               0356
         LR    WRKREG,@10                                          0356
*     SPKA(WRKREG);                 /* SET PSW KEY                   */
         SPKA  0(WRKREG)                                           0357
*     RESPECIFY                                                    0358
*      (GPR02F) UNRESTRICTED;                                      0358
*   END;                            /* MODESET SAVEKEY(OLDKEY)     0359
*                                      EXTKEY(RBT234) WORKREG(WRKREG)
*                                      GET IN USERS KEY              */
*   R2=VOLSTPTR;                                                   0360
         L     R2,VOLSTPTR                                         0360
*   GEN(XC  0(256,2),0(2)  ZERO WORKAREA);                         0361
         XC  0(256,2),0(2)  ZERO WORKAREA
*   R2=R2+256;                                                     0362
         AL    R2,@CF01178                                         0362
*   GEN(XC  0(9,2),0(2)  );                                        0363
         XC  0(9,2),0(2)
*   DO;                             /* MODESET KEYADDR(OLDKEY)     0364
*                                      WORKREG(WRKREG)               */
*     WRKREG=OLDKEY;                /* GET KEY FORM SAVE LOCATION    */
         SLR   WRKREG,WRKREG                                       0365
         IC    WRKREG,OLDKEY                                       0365
*     SPKA(WRKREG);                 /* SET PSW KEY                   */
         SPKA  0(WRKREG)                                           0366
*   END;                            /* MODESET KEYADDR(OLDKEY)     0367
*                                      WORKREG(WRKREG) RESET TO    0367
*                                      CATALOG KEY                   */
*   STSW=CHAR0;                     /* ESTAE USE-OFF YL026RB         */
         MVC   STSW(1),CHAR0                                       0368
*   RFY                                                            0369
*    (TCBPTR,                                                      0369
*     WRKREG) UNRSTD;                                              0369
*   END VLOCATE;                                                   0370
@EL00005 L     @13,4(,@13)                                         0370
@EF00005 DS    0H                                                  0370
@ER00005 L     @14,12(,@13)                                        0370
         BR    @14                                                 0370
*                                                                  0371
*   /*****************************************************************/
*   /*                                                               */
*   /* VCATLG IS CALLED WHEN AN OS/VS-FORMAT CATALOG REQUEST NEEDS TO*/
*   /* BE TRANSLATED TO A DEFINE NON-VSAM PARAMETER LIST.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0371
*VCATLG:                                                           0371
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0371
VCATLG   ST    @14,12(,@13)                                        0371
         ST    @13,@SA00006+4                                      0371
         LA    @14,@SA00006                                        0371
         LR    @13,@14                                             0371
*   VOLUMECT=VOLENTCT;              /* RECORD NUMBER OF VOLIDS.      */
         L     @10,CAMPLPTR                                        0372
         L     @10,CAMPTR3(,@10)                                   0372
         LH    @10,VOLENTCT(,@10)                                  0372
         ST    @10,VOLUMECT                                        0372
*   IF(VOLUMECT<256)&(VOLUMECT>0) THEN                             0373
*                                                                  0373
         C     @10,@CF01178                                        0373
         BNL   @RF00373                                            0373
         LTR   @10,@10                                             0373
         BNP   @RF00373                                            0373
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE NUMBER OF VOLUMES IS WITHIN A VALID RANGE, BUILD THE */
*     /* PARAMETER LIST.                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0374
*     DO;                                                          0374
*       CALL GETSPACE(STDLEN+(VOLUMECT*22)+4,160);                 0375
         MH    @10,@CH01203                                        0375
         AL    @10,STDLEN                                          0375
         AL    @10,@CF00168                                        0375
         ST    @10,@AFTEMPS+4                                      0375
         LA    @10,@AFTEMPS+4                                      0375
         ST    @10,@AL00001                                        0375
         LA    @10,@CF01204                                        0375
         ST    @10,@AL00001+4                                      0375
         LA    @01,@AL00001                                        0375
         BAL   @14,GETSPACE                                        0375
*       CALL BUILDCPL;              /* BUILD A GENERALIZED CPL.      */
         BAL   @14,BUILDCPL                                        0376
*       CTGOPTNS=CTGDEFIN;          /* SPECIFY AS DEFINE CALL.       */
         L     @10,CTGPLPTR                                        0377
         NI    CTGOPTNS(@10),B'00001111'                           0377
         OI    CTGOPTNS(@10),B'00001000'                           0377
*     END;                                                         0378
*   ELSE                                                           0379
*                                                                  0379
*     /***************************************************************/
*     /*                                                             */
*     /* THE CAMLIST IS IN ERROR. TERMINATE THE CALL.                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0379
*     CALL BADPARMS;                                               0379
         B     @RC00373                                            0379
@RF00373 BAL   @14,BADPARMS                                        0379
*   END VCATLG;                                                    0380
@EL00006 L     @13,4(,@13)                                         0380
@EF00006 DS    0H                                                  0380
@ER00006 L     @14,12(,@13)                                        0380
         BR    @14                                                 0380
*                                                                  0381
*   /*****************************************************************/
*   /*                                                               */
*   /* VUNCAT IS CALLED WHEN AN OS/VS-FORMAT UNCATALOG REQUEST NEEDS */
*   /* TO BE TRANSLATED TO A DELETE NON-VSAM PARAMETER LIST.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0381
*VUNCAT:                                                           0381
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0381
VUNCAT   ST    @14,12(,@13)                                        0381
         ST    @13,@SA00007+4                                      0381
         LA    @14,@SA00007                                        0381
         LR    @13,@14                                             0381
*   CALL GETSPACE(LOCPRMSZ,256);                                   0382
         LA    @01,@AL00382                                        0382
         BAL   @14,GETSPACE                                        0382
*   CTGWKA=ADDR(CTGDYNWA);                                         0383
         L     @10,CTGPLPTR                                        0383
         LA    @03,CTGDYNWA(,@10)                                  0383
         ST    @03,CTGWKA(,@10)                                    0383
*   CTGENT=ADDR(WORKNAME);          /*                       @YM04805*/
         LA    @03,WORKNAME                                        0384
         ST    @03,CTGENT(,@10)                                    0384
*   CTGOPTNS=CTGDELET;                                             0385
         NI    CTGOPTNS(@10),B'00011111'                           0385
         OI    CTGOPTNS(@10),B'00011000'                           0385
*   CTGFUNC=CTGCMS;                                                0386
         NI    CTGFUNC(@10),B'10011111'                            0386
         OI    CTGFUNC(@10),B'10000000'                            0386
*   CTGNAME='1'B;                                                  0387
         OI    CTGNAME(@10),B'00000100'                            0387
*   CTGTYPE=CTGTALIN;                                              0388
         MVI   CTGTYPE(@10),C'A'                                   0388
*   WKALEN=LENOPTN;                                                0389
         LH    @03,LENOPTN                                         0389
         STH   @03,WKALEN(,@10)                                    0389
*   IF CAMDOCAT='1'B THEN                                          0390
*                                                                  0390
         L     @03,CAMPLPTR                                        0390
         TM    CAMDOCAT(@03),B'10000000'                           0390
         BNO   @RF00390                                            0390
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT ALLOWED TO ALLOCATE, SO INDICATE TO VSAM             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0391
*     CTGDOCAT='1'B;                                               0391
         OI    CTGDOCAT(@10),B'01000000'                           0391
*   ELSE                                                           0392
*     ;                                                            0392
@RF00390 DS    0H                                                  0393
*   END VUNCAT;                                                    0393
@EL00007 L     @13,4(,@13)                                         0393
@EF00007 DS    0H                                                  0393
@ER00007 L     @14,12(,@13)                                        0393
         BR    @14                                                 0393
*                                                                  0394
*   /*****************************************************************/
*   /*                                                               */
*   /* VRECAT IS CALLED WHEN AN OS/VS-FORMAT RECATALOG REQUEST NEEDS */
*   /* TO BE TRANSLATED TO AN ALTER NON-VSAM PARAMETER LIST.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0394
*VRECAT:                                                           0394
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0394
VRECAT   ST    @14,12(,@13)                                        0394
         ST    @13,@SA00008+4                                      0394
         LA    @14,@SA00008                                        0394
         LR    @13,@14                                             0394
*   VOLUMECT=VOLENTCT;              /* RECORD NUMBER OF VOLIDS.      */
         L     @10,CAMPLPTR                                        0395
         L     @10,CAMPTR3(,@10)                                   0395
         LH    @10,VOLENTCT(,@10)                                  0395
         ST    @10,VOLUMECT                                        0395
*   IF(VOLUMECT<256)&(VOLUMECT>0) THEN                             0396
*                                                                  0396
         C     @10,@CF01178                                        0396
         BNL   @RF00396                                            0396
         LTR   @10,@10                                             0396
         BNP   @RF00396                                            0396
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE NUMBER OF VOLUMES IS WITHIN A VALID RANGE, BUILD THE */
*     /* PARAMETER LIST.                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0397
*     DO;                                                          0397
*       CALL GETSPACE(STDLEN+(VOLUMECT*22)+4,160);                 0398
         MH    @10,@CH01203                                        0398
         AL    @10,STDLEN                                          0398
         AL    @10,@CF00168                                        0398
         ST    @10,@AFTEMPS+8                                      0398
         LA    @10,@AFTEMPS+8                                      0398
         ST    @10,@AL00001                                        0398
         LA    @10,@CF01204                                        0398
         ST    @10,@AL00001+4                                      0398
         LA    @01,@AL00001                                        0398
         BAL   @14,GETSPACE                                        0398
*       CALL BUILDCPL;              /* BUILD A GENERALIZED CPL.      */
         BAL   @14,BUILDCPL                                        0399
*       CTGOPTNS=CTGALTER;          /* SPECIFY AS ALTER CALL.        */
         L     @10,CTGPLPTR                                        0400
         NI    CTGOPTNS(@10),B'00010111'                           0400
         OI    CTGOPTNS(@10),B'00010000'                           0400
*       CTGNEWNM=ADDR(WORKNAME);    /* POINT NEW NAME        @YM04805*/
         LA    @03,WORKNAME                                        0401
         ST    @03,CTGNEWNM(,@10)                                  0401
*       IF CAMDTTR=ON THEN          /* IS DSCBTTR SPECIFIED  @OZ07065*/
         L     @03,CAMPLPTR                                        0402
         TM    CAMDTTR(@03),B'00000010'                            0402
         BNO   @RF00402                                            0402
*         CTGBYPSS=ON;              /* YES,SET PASSWORD      @OZ07065
*                                      BYPASS FLAG           @OZ07065*/
         OI    CTGBYPSS(@10),B'10000000'                           0403
*     END;                                                         0404
*   ELSE                                                           0405
*                                                                  0405
*     /***************************************************************/
*     /*                                                             */
*     /* THE CAMLIST IS IN ERROR. TERMINATE THE CALL.                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0405
*     CALL BADPARMS;                                               0405
         B     @RC00396                                            0405
@RF00396 BAL   @14,BADPARMS                                        0405
*   END VRECAT;                                                    0406
@EL00008 L     @13,4(,@13)                                         0406
@EF00008 DS    0H                                                  0406
@ER00008 L     @14,12(,@13)                                        0406
         BR    @14                                                 0406
*                                                                  0407
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Z40CSRC*/
*   /* THIS ROUTINE CREATES A DUMMY VSAM REQUEST WHICH WILL PROVIDE  */
*   /* ORIENTATION TO THE PROPER CVOL FOR A NUMBER OF CVOL-TYPE      */
*   /* REQUESTS ACCORDING TO THE HIGH-LEVEL INDEX IN THE NAME BEING  */
*   /* PASSED. IF THE NAME IS NOT QUALIFIED A QUALIFIER WILL BE ADDED*/
*   /* TO MEET VSAM CATALOG RULES.                           @Z40CSRC*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*VDUMMY:                                                           0407
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));/*                   @Z40CSRC*/
VDUMMY   ST    @14,12(,@13)                                        0407
         ST    @13,@SA00009+4                                      0407
         LA    @14,@SA00009                                        0407
         LR    @13,@14                                             0407
*   CALL VUNCAT;                    /* CREATE A DELETE NON-VSAM    0408
*                                      REQUEST               @Z40CSRC*/
         BAL   @14,VUNCAT                                          0408
*   CTGTYPE=NULL;                   /* NULL TYPE PREVENTS ACTUAL   0409
*                                      DELETION IN THE VSAM CATALOG
*                                                            @Z40CSRC*/
         L     @10,CTGPLPTR                                        0409
         MVI   CTGTYPE(@10),X'00'                                  0409
*   CTGSRH=ON;                      /* SEARCH NO PRIVATE VSAM      0410
*                                      CATALOGS              @Z40CSRC*/
*                                                                  0410
         OI    CTGSRH(@10),B'00000100'                             0410
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD QUALIFIER IF NECESSARY                            @Z40CSRC*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   RFY                                                            0411
*     WRKREG RSTD;                  /*                       @Z40CSRC*/
*   DO WRKREG=1 TO QIDXLEN          /* SCAN 1ST INDEX        @Z40CSRC*/
*         WHILE WORKNAME(WRKREG)^=QPERIOD;/* UNTIL '.' FND   @Z40CSRC*/
         LA    WRKREG,1                                            0412
@DL00412 LA    @10,WORKNAME-1(WRKREG)                              0412
         CLI   0(@10),C'.'                                         0412
         BE    @DC00412                                            0412
*     IF WORKNAME(WRKREG)=QBLANK THEN/* NAME UNQUALIFIED     @Z40CSRC*/
         LA    @10,WORKNAME-1(WRKREG)                              0413
         CLI   0(@10),C' '                                         0413
         BNE   @RF00413                                            0413
*       DO;                         /*                       @Z40CSRC*/
*         WORKNAME(WRKREG:WRKREG+LENGTH(QDMY)-1)=QDMY;/* MOVE IN   0415
*                                      DUMMY QUALIFIER '.X'  @Z40CSRC*/
         LA    @10,WORKNAME-1(WRKREG)                              0415
         MVC   0(2,@10),@CC01150                                   0415
*         WRKREG=QIDXLEN;           /* SET TO EXIT LOOP      @Z40CSRC*/
         LA    WRKREG,9                                            0416
*       END;                        /*                       @Z40CSRC*/
*   END;                            /* OF SCAN               @Z40CSRC*/
@RF00413 AL    WRKREG,@CF00052                                     0418
         C     WRKREG,@CF01144                                     0418
         BNH   @DL00412                                            0418
@DC00412 DS    0H                                                  0419
*   RFY                                                            0419
*     WRKREG UNRSTD;                /*                       @Z40CSRC*/
*   END VDUMMY;                     /*                       @Z40CSRC*/
@EL00009 L     @13,4(,@13)                                         0420
@EF00009 DS    0H                                                  0420
@ER00009 L     @14,12(,@13)                                        0420
         BR    @14                                                 0420
*                                                                  0421
*   /*****************************************************************/
*   /*                                                               */
*   /* GETSPACE IS CALLED WHEN IT IS NECESSARY TO OBTAIN STORAGE FOR */
*   /* A VSAM CATALOG PARAMETER LIST. THE PARAMETERS SPECIFY THE     */
*   /* TOTAL AMOUNT OF SPACE TO BE OBTAINED AND THE AMOUNT (STARTING */
*   /* WITH THE FIRST BYTE) TO BE SET TO BINARY ZEROES.              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*GETSPACE:                                                         0421
*   PROC(AMOUNT,CLEAR) OPTIONS(SAVEAREA(16),SAVE(14));             0421
GETSPACE ST    @14,12(,@13)                                        0421
         ST    @13,@SA00010+4                                      0421
         LA    @14,@SA00010                                        0421
         LR    @13,@14                                             0421
         MVC   @PC00010(8),0(@01)                                  0421
*   DCL                                                            0422
*     AMOUNT FIXED(31);             /* QUANTITY OF SPACE TO BE     0422
*                                      OBTAINED.                     */
*   DCL                                                            0423
*     CLEAR FIXED(31);              /* QUANTITY OF SPACE TO BE ZEROED
*                                      OUT.                          */
*   DCL                                                            0424
*     SPACE CHAR(256) BASED(MAINPTR);/* STRING FOR CLEARING AREA.    */
*   PRMLSTSZ=AMOUNT;                /* RECORD SIZE.                  */
         L     @10,@PC00010                                        0425
         L     @10,AMOUNT(,@10)                                    0425
         ST    @10,PRMLSTSZ                                        0425
*   MAINSIZE=AMOUNT;                                               0426
         LR    MAINSIZE,@10                                        0426
*   GEN(GETMAIN R,LV=(0)     GETMAIN PARAMETER LIST SIZE);         0427
         GETMAIN R,LV=(0)     GETMAIN PARAMETER LIST SIZE
*   CTGPLPTR=MAINPTR;               /* RECORD LOCATION.              */
         ST    MAINPTR,CTGPLPTR                                    0428
*   WASW=CHAR1;                     /* ON FOR EXIT ROUTINEYL026RB    */
         MVC   WASW(1),CHAR1                                       0429
*   SPACE(1:CLEAR)=SPACE(1:CLEAR)&&SPACE(1:CLEAR);/* SET REQUESTED 0430
*                                      AMOUNT TO BINARY ZEROES.      */
         L     @10,@PC00010+4                                      0430
         L     @10,CLEAR(,@10)                                     0430
         BCTR  @10,0                                               0430
         EX    @10,@SX01250                                        0430
*   IF CAMTIOT='1'B THEN            /* SYZTIOT ENQUED?       @OZ19636*/
         L     @10,CAMPLPTR                                        0431
         TM    CAMTIOT(@10),B'00010000'                            0431
         BNO   @RF00431                                            0431
*     CTGTIOT='1'B;                 /* SET TIOT ENQ OPTN     @OZ19636*/
         L     @10,CTGPLPTR                                        0432
         OI    CTGTIOT(@10),B'00000100'                            0432
*   ELSE                                                           0433
*     ;                                                            0433
@RF00431 DS    0H                                                  0434
*   END GETSPACE;                                                  0434
@EL00010 L     @13,4(,@13)                                         0434
@EF00010 DS    0H                                                  0434
@ER00010 L     @14,12(,@13)                                        0434
         BR    @14                                                 0434
*                                                                  0435
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILDCPL IS CALLED TO SET UP THOSE PARTS OF THE CATALOG       */
*   /* PARAMETER LIST THAT ARE COMMON TO BOTH DEFINE AND ALTER       */
*   /* NON-VSAM (RECATALOG).                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0435
*BUILDCPL:                                                         0435
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0435
*                                                                  0435
BUILDCPL ST    @14,12(,@13)                                        0435
         ST    @13,@SA00011+4                                      0435
         LA    @14,@SA00011                                        0435
         LR    @13,@14                                             0435
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ALL THE POINTERS NECESSARY FOR THE CONSTRUCTION OF A      */
*   /* DEFINE OR ALTER NON-VSAM.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*   CTGFVT=ADDR(FVTFLD);                                           0436
         L     @10,CTGPLPTR                                        0436
         LA    @03,FVTFLD(,@10)                                    0436
         ST    @03,CTGFVT(,@10)                                    0436
*   CTGFVVLT=CTGPLPTR+STDLEN;                                      0437
         LR    @15,@10                                             0437
         AL    @15,STDLEN                                          0437
         ST    @15,CTGFVVLT(,@03)                                  0437
*   CTGFVDVT=ADDR(DEVTPS);                                         0438
         LA    @14,DEVTPS(,@10)                                    0438
         ST    @14,CTGFVDVT(,@03)                                  0438
*   CTGFVFSN=ADDR(FSNENTS);                                        0439
         LA    @10,FSNENTS(,@10)                                   0439
         ST    @10,CTGFVFSN(,@03)                                  0439
*   CTGFVDVT->CTGFLPT(1)=CTGFVVLT+(8*VOLUMECT)+4;                  0440
         L     @09,VOLUMECT                                        0440
         LR    @08,@09                                             0440
         SLA   @08,3                                               0440
         ALR   @15,@08                                             0440
         AL    @15,@CF00168                                        0440
         ST    @15,CTGFLPT(,@14)                                   0440
*   CTGFVFSN->CTGFLPT(1)=CTGFVDVT->CTGFLPT(1)+(12*VOLUMECT);       0441
*                                                                  0441
         MH    @09,@CH00115                                        0441
         ALR   @15,@09                                             0441
         ST    @15,CTGFLPT(,@10)                                   0441
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE POINTER TO THE NAME AND THE POINTER TO THE DSCBTTR   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0442
*   CTGFVENT=ADDR(WORKNAME);        /*                       @YM04805*/
         LA    @10,WORKNAME                                        0442
         ST    @10,CTGFVENT(,@03)                                  0442
*   IF CAMDTTR='1'B THEN                                           0443
         L     @10,CAMPLPTR                                        0443
         TM    CAMDTTR(@10),B'00000010'                            0443
         BNO   @RF00443                                            0443
*     CTGFVSPC=CAMDSCBP;                                           0444
         L     @10,CAMDSCBP(,@10)                                  0444
         ST    @10,CTGFVSPC(,@03)                                  0444
*   ELSE                                                           0445
*     ;                                                            0445
@RF00443 DS    0H                                                  0446
*   IF CAMDOCAT='1'B THEN                                          0446
*                                                                  0446
         L     @10,CAMPLPTR                                        0446
         TM    CAMDOCAT(@10),B'10000000'                           0446
         BNO   @RF00446                                            0446
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT ALLOWED TO ALLOCATE, SO INDICATE TO VSAM             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0447
*     CTGDOCAT='1'B;                                               0447
         L     @10,CTGPLPTR                                        0447
         OI    CTGDOCAT(@10),B'01000000'                           0447
*   ELSE                                                           0448
*     ;                                                            0448
*                                                                  0448
@RF00446 DS    0H                                                  0449
*   /*****************************************************************/
*   /*                                                               */
*   /* THE VOLUME SERIALS, DEVICE TYPES AND FILE SEQUENCE NUMBERS    */
*   /* MUST BE TRANSFERRED TO THE VSAM LIST                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0449
*   RFY                                                            0449
*    (LOOP) RSTD;                                                  0449
*   DO LOOP=1 TO VOLUMECT;                                         0450
         LA    LOOP,1                                              0450
         B     @DE00450                                            0450
@DL00450 DS    0H                                                  0451
*     FSNARRY(LOOP)=FSN(LOOP);                                     0451
         LR    @10,LOOP                                            0451
         ALR   @10,@10                                             0451
         L     @09,CTGPLPTR                                        0451
         L     @09,CTGFVT(,@09)                                    0451
         L     @09,CTGFVFSN(,@09)                                  0451
         L     @09,CTGFLPT(,@09)                                   0451
         ALR   @09,@10                                             0451
         BCTR  @09,0                                               0451
         BCTR  @09,0                                               0451
         LR    @10,LOOP                                            0451
         MH    @10,@CH00115                                        0451
         L     @03,CAMPLPTR                                        0451
         L     @03,CAMPTR3(,@03)                                   0451
         ALR   @03,@10                                             0451
         MVC   FSNARRY(2,@09),FSN-12(@03)                          0451
*     DEVARRY(LOOP)=DEVTYP(LOOP);                                  0452
         LA    @10,12                                              0452
         LR    @05,LOOP                                            0452
         MR    @04,@10                                             0452
         L     @09,CTGPLPTR                                        0452
         L     @09,CTGFVT(,@09)                                    0452
         L     @09,CTGFVDVT(,@09)                                  0452
         L     @09,CTGFLPT(,@09)                                   0452
         ALR   @09,@05                                             0452
         AL    @09,@CF01252                                        0452
         LR    @05,@10                                             0452
         MR    @04,LOOP                                            0452
         L     @10,CAMPLPTR                                        0452
         L     @10,CAMPTR3(,@10)                                   0452
         ALR   @10,@05                                             0452
         AL    @10,@CF01253                                        0452
         MVC   DEVARRY-8(4,@09),DEVTYP-2(@10)                      0452
*     VVOLSER(LOOP)=VOLSER(LOOP);                                  0453
         LR    @10,LOOP                                            0453
         SLA   @10,3                                               0453
         L     @09,CTGPLPTR                                        0453
         L     @09,CTGFVT(,@09)                                    0453
         L     @09,CTGFVVLT(,@09)                                  0453
         ALR   @09,@10                                             0453
         AL    @09,@CF01252                                        0453
         LR    @10,LOOP                                            0453
         MH    @10,@CH00115                                        0453
         L     @03,CAMPLPTR                                        0453
         L     @03,CAMPTR3(,@03)                                   0453
         ALR   @03,@10                                             0453
         AL    @03,@CF01254                                        0453
         MVC   VVOLSER-4(6,@09),VOLSER-6(@03)                      0453
*   END;                                                           0454
         AL    LOOP,@CF00052                                       0454
@DE00450 C     LOOP,VOLUMECT                                       0454
         BNH   @DL00450                                            0454
*   RFY                                                            0455
*    (LOOP) UNRSTD;                                                0455
*                                                                  0455
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ALL CONSTANT FIELDS.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0456
*   CTGFUNC=CTGCMS;                                                0456
         L     @10,CTGPLPTR                                        0456
         NI    CTGFUNC(@10),B'10011111'                            0456
         OI    CTGFUNC(@10),B'10000000'                            0456
*   CTGNAME='1'B;                                                  0457
         OI    CTGNAME(@10),B'00000100'                            0457
*   CTGFVTYP=CTGFVALN;                                             0458
         L     @10,CTGFVT(,@10)                                    0458
         MVI   CTGFVTYP(@10),C'A'                                  0458
*   CTGFVFSN->CTGFLDNO=ONE;                                        0459
         L     @03,ONE                                             0459
         L     @15,CTGFVFSN(,@10)                                  0459
         STC   @03,CTGFLDNO(,@15)                                  0459
*   CTGFVDVT->CTGFLDNO=ONE;                                        0460
         L     @14,CTGFVDVT(,@10)                                  0460
         STC   @03,CTGFLDNO(,@14)                                  0460
*   CTGFVFSN->CTGFLNG(1)=2*VOLUMECT;                               0461
         L     @03,VOLUMECT                                        0461
         LR    @09,@03                                             0461
         ALR   @09,@09                                             0461
         ST    @09,CTGFLNG(,@15)                                   0461
*   CTGFVDVT->CTGFLNG(1)=12*VOLUMECT;                              0462
         LR    @15,@03                                             0462
         MH    @15,@CH00115                                        0462
         ST    @15,CTGFLNG(,@14)                                   0462
*   VLSFLND=8*VOLUMECT;                                            0463
         L     @10,CTGFVVLT(,@10)                                  0463
         SLA   @03,3                                               0463
         STH   @03,VLSFLND(,@10)                                   0463
*   END BUILDCPL;                                                  0464
@EL00011 L     @13,4(,@13)                                         0464
@EF00011 DS    0H                                                  0464
@ER00011 L     @14,12(,@13)                                        0464
         BR    @14                                                 0464
*                                                                  0465
*   /*****************************************************************/
*   /*                                                               */
*   /* BADPARMS IS CALLED WHEN AN ERROR HAS BEEN FOUND IN AN OS/VS   */
*   /* CAMLIST THAT REQUESTED AN OTHERWISE VALID FUNCTION.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0465
*BADPARMS:                                                         0465
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0465
BADPARMS ST    @14,12(,@13)                                        0465
         ST    @13,@SA00012+4                                      0465
         LA    @14,@SA00012                                        0465
         LR    @13,@14                                             0465
*   ROUTE=EXITRT;                   /* BYPASS XCTL TO VSAM.          */
         MVC   ROUTE(1),EXITRT                                     0466
*   SAVERC=CATIOERR;                /* INDICATE CATALOG I/O ERROR    */
         L     @10,CATIOERR                                        0467
         ST    @10,SAVERC                                          0467
*   SAVER0=ZERO;                    /* INDICATE BAD PARAMETER LIST.  */
         SLR   @10,@10                                             0468
         ST    @10,SAVER0                                          0468
*   END BADPARMS;                                                  0469
@EL00012 L     @13,4(,@13)                                         0469
@EF00012 DS    0H                                                  0469
@ER00012 L     @14,12(,@13)                                        0469
         BR    @14                                                 0469
*                                                                  0470
*   /*****************************************************************/
*   /*                                                               */
*   /* OSFUNCT IS CALLED WHEN AN OS/VS-FORMAT REQUEST CANNOT BE      */
*   /* REFORMATTED TO A VSAM FORMAT REQUEST. A RETURN MUST BE        */
*   /* GENERATED TO INDICATE WHY THE REQUEST WAS NOT HONORED.        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*OSFUNCT:                                                          0470
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0470
OSFUNCT  ST    @14,12(,@13)                                        0470
         ST    @13,@SA00013+4                                      0470
         LA    @14,@SA00013                                        0470
         LR    @13,@14                                             0470
*   IF(OPTBITS&LOCTTRMK)=ALLZERO THEN                              0471
*                                                                  0471
         MVC   @TS00001(4),OPTBITS                                 0471
         NC    @TS00001(4),LOCTTRMK                                0471
         CLC   @TS00001(4),ALLZERO                                 0471
         BNE   @RF00471                                            0471
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE REQUEST IS A LOCATE BY BLOCK (TTR) THEN A RETURN CODE*/
*     /* INDICATING CVOL UNAVAILABLE                         @Z40CSRC*/
*     /* WILL BE RETURNED, THE WORKAREA IS ZEROED            @Z40CSRC*/
*     /* AND NO FURTHER PROCESSING IS DONE.                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0472
*     DO;                                                          0472
*       RFY                                                        0473
*        (TCBPTR,                                                  0473
*         WRKREG) RSTD;                                            0473
*       TCBPTR=TCBSAV;                                             0474
         L     TCBPTR,TCBSAV                                       0474
*       STSW=CHAR1;                 /* ESTAE USE-ON YL026RB          */
         MVC   STSW(1),CHAR1                                       0475
*       DO;                         /* MODESET SAVEKEY(OLDKEY)     0476
*                                      EXTKEY(RBT234) WORKREG(WRKREG)*/
*         RESPECIFY                                                0477
*          (GPR02F) RESTRICTED;                                    0477
*         WRKREG=GPR02F;            /* SAVE REGISTER 2               */
         LR    WRKREG,GPR02F                                       0478
*         IPK;                      /* SAVE CURRENT PSW KEY          */
         IPK                                                       0479
*         OLDKEY=GPR02F;                                           0480
         STC   GPR02F,OLDKEY                                       0480
*         GPR02F=WRKREG;            /* RESTORE REGISTER 2            */
         LR    GPR02F,WRKREG                                       0481
*         WRKREG=TCBRBP;            /* RB PTR FROM TCB               */
         L     WRKREG,TCBRBP(,TCBPTR)                              0482
*         WRKREG=WRKREG->RBLINK;    /* NEXT RB ADDRESS               */
         L     WRKREG,RBLINK(,WRKREG)                              0483
*         WRKREG=WRKREG->RBOPSW(2); /* PSW KEY FROM RB OLD PSW       */
         SLR   @10,@10                                             0484
         IC    @10,RBOPSW+1(,WRKREG)                               0484
         LR    WRKREG,@10                                          0484
*         SPKA(WRKREG);             /* SET PSW KEY                   */
         SPKA  0(WRKREG)                                           0485
*         RESPECIFY                                                0486
*          (GPR02F) UNRESTRICTED;                                  0486
*       END;                        /* MODESET SAVEKEY(OLDKEY)     0487
*                                      EXTKEY(RBT234) WORKREG(WRKREG)
*                                      GET IN USERS KEY              */
*       R2=VOLSTPTR;                                               0488
         L     R2,VOLSTPTR                                         0488
*       GEN(XC  0(256,2),0(2)  ZERO WORKAREA);                     0489
         XC  0(256,2),0(2)  ZERO WORKAREA
*       R2=R2+256;                                                 0490
         AL    R2,@CF01178                                         0490
*       GEN(XC  0(9,2),0(2)  );                                    0491
         XC  0(9,2),0(2)
*       DO;                         /* MODESET KEYADDR(OLDKEY)     0492
*                                      WORKREG(WRKREG)               */
*         WRKREG=OLDKEY;            /* GET KEY FORM SAVE LOCATION    */
         SLR   WRKREG,WRKREG                                       0493
         IC    WRKREG,OLDKEY                                       0493
*         SPKA(WRKREG);             /* SET PSW KEY                   */
         SPKA  0(WRKREG)                                           0494
*       END;                        /* MODESET KEYADDR(OLDKEY)     0495
*                                      WORKREG(WRKREG) RESET TO    0495
*                                      CATALOG KEY                   */
*       STSW=CHAR0;                 /* ESTAE USE-OFF YL026RB         */
         MVC   STSW(1),CHAR0                                       0496
*       RFY                                                        0497
*        (TCBPTR,                                                  0497
*         WRKREG) UNRSTD;                                          0497
*       SAVERC=NOCAT;               /* CVOL VOLSER NOT SUPPLIED    0498
*                                                            @Z40CSRC*/
         L     @10,NOCAT                                           0498
         ST    @10,SAVERC                                          0498
*     END;                                                         0499
*   ELSE                                                           0500
*                                                                  0500
*     /***************************************************************/
*     /*                                                             */
*     /* ANY OTHER OS/VS-FORMAT REQUESTS ARE CONSIDERED UNSUPPORTED  */
*     /* REQUESTS AND GENERATE THAT RETURN CODE WITH NO ACTION TAKEN.*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0500
*     SAVERC=UNSUPTED;                                             0500
         B     @RC00471                                            0500
@RF00471 L     @10,UNSUPTED                                        0500
         ST    @10,SAVERC                                          0500
*   SAVER0=ZERO;                                                   0501
@RC00471 SLR   @10,@10                                             0501
         ST    @10,SAVER0                                          0501
*   ROUTE=EXITRT;                                                  0502
         MVC   ROUTE(1),EXITRT                                     0502
*   END OSFUNCT;                                                   0503
@EL00013 L     @13,4(,@13)                                         0503
@EF00013 DS    0H                                                  0503
@ER00013 L     @14,12(,@13)                                        0503
         BR    @14                                                 0503
*                                                                  0504
*   /*****************************************************************/
*   /*                                                               */
*   /* OSVOLST IS CALLED WHEN A VOLUME LIST HAS BEEN FOUND IN THE    */
*   /* VSAM CATALOG AND NEEDS TO REFORMATTED TO OS/VS FORMAT OUTPUT  */
*   /* FOR RETURN TO THE CALLER.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*OSVOLST:                                                          0504
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0504
OSVOLST  ST    @14,12(,@13)                                        0504
         ST    @13,@SA00014+4                                      0504
         LA    @14,@SA00014                                        0504
         LR    @13,@14                                             0504
*   SAVER0=ZERO;                                                   0505
         SLR   @10,@10                                             0505
         ST    @10,SAVER0                                          0505
*   IF CTGGDGB='1'B THEN                                           0506
*                                                                  0506
         L     @10,CTGPLPTR                                        0506
         TM    CTGGDGB(@10),B'00100000'                            0506
         BNO   @RF00506                                            0506
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE DATA SET NAME WAS THAT OF A GDG BASE, THEN IT IS     */
*     /* IMPOSSIBLE TO REFORMAT IT TO OS/VS FORMAT. A DATA SET NOT   */
*     /* FOUND RETURN CODE IS RETURNED INSTEAD.                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0507
*     SAVERC=DSNOTFND;                                             0507
         L     @10,DSNOTFND                                        0507
         ST    @10,SAVERC                                          0507
*   ELSE                                                           0508
*                                                                  0508
*     /***************************************************************/
*     /*                                                             */
*     /* ALL NON-GDG-BASE DATA SETS CAN BE REFORMATTED TO OS/VS      */
*     /* FORMAT BY TRANSFERRING THE VOLUME SERIALS, DEVICE TYPES AND */
*     /* FILE SEQUENCE NUMBERS TO THE OS/VS RETURN AREA. THIS CODE IS*/
*     /* DEPENDENT ON PLS TO GENERATE CODE THAT DOES NOT SAVE HISTORY*/
*     /* INFORMATION IN OUR SAVE AREA. AN ABEND 0C4 IS GIVEN IF      */
*     /* STORING OFF OF REG 12 WHILE IN USER'S KEY.                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0508
*     DO;                                                          0508
         B     @RC00506                                            0508
@RF00506 DS    0H                                                  0509
*       RFY                                                        0509
*        (TCBPTR,                                                  0509
*         WRKREG,                                                  0509
*         LOOP) RSTD;                                              0509
*       TCBPTR=TCBSAV;                                             0510
         L     TCBPTR,TCBSAV                                       0510
*       STSW=CHAR1;                 /* ON FOR EXIT ROUTINE YL026RB   */
         MVC   STSW(1),CHAR1                                       0511
*       DO;                         /* MODESET SAVEKEY(OLDKEY)     0512
*                                      EXTKEY(RBT234) WORKREG(WRKREG)*/
*         RESPECIFY                                                0513
*          (GPR02F) RESTRICTED;                                    0513
*         WRKREG=GPR02F;            /* SAVE REGISTER 2               */
         LR    WRKREG,GPR02F                                       0514
*         IPK;                      /* SAVE CURRENT PSW KEY          */
         IPK                                                       0515
*         OLDKEY=GPR02F;                                           0516
         STC   GPR02F,OLDKEY                                       0516
*         GPR02F=WRKREG;            /* RESTORE REGISTER 2            */
         LR    GPR02F,WRKREG                                       0517
*         WRKREG=TCBRBP;            /* RB PTR FROM TCB               */
         L     WRKREG,TCBRBP(,TCBPTR)                              0518
*         WRKREG=WRKREG->RBLINK;    /* NEXT RB ADDRESS               */
         L     WRKREG,RBLINK(,WRKREG)                              0519
*         WRKREG=WRKREG->RBOPSW(2); /* PSW KEY FROM RB OLD PSW       */
         SLR   @10,@10                                             0520
         IC    @10,RBOPSW+1(,WRKREG)                               0520
         LR    WRKREG,@10                                          0520
*         SPKA(WRKREG);             /* SET PSW KEY                   */
         SPKA  0(WRKREG)                                           0521
*         RESPECIFY                                                0522
*          (GPR02F) UNRESTRICTED;                                  0522
*       END;                        /* MODESET SAVEKEY(OLDKEY)     0523
*                                      EXTKEY(RBT234) WORKREG(WRKREG)
*                                      GET IN USERS KEY              */
*       RFY                                                        0524
*        (TCBPTR,                                                  0524
*         WRKREG) UNRSTD;                                          0524
*       IF CTGWAVCT<MAXVOLS THEN                                   0525
         L     @10,CTGPLPTR                                        0525
         L     @10,CTGWKA(,@10)                                    0525
         LH    @10,CTGWAVCT(,@10)                                  0525
         C     @10,MAXVOLS                                         0525
         BNL   @RF00525                                            0525
*         VOLENTCT=CTGWAVCT;                                       0526
         L     @09,CAMPLPTR                                        0526
         L     @09,CAMPTR3(,@09)                                   0526
         STH   @10,VOLENTCT(,@09)                                  0526
*       ELSE                                                       0527
*         VOLENTCT=MAXVOLS;                                        0527
         B     @RC00525                                            0527
@RF00525 L     @10,CAMPLPTR                                        0527
         L     @10,CAMPTR3(,@10)                                   0527
         L     @09,MAXVOLS                                         0527
         STH   @09,VOLENTCT(,@10)                                  0527
*       DO LOOP=1 TO VOLENTCT;                                     0528
@RC00525 LA    LOOP,1                                              0528
         B     @DE00528                                            0528
@DL00528 DS    0H                                                  0529
*         VOLSER(LOOP)=CTGVLVOL(LOOP);                             0529
         LA    @10,12                                              0529
         LR    @05,LOOP                                            0529
         MR    @04,@10                                             0529
         L     @09,CAMPLPTR                                        0529
         L     @09,CAMPTR3(,@09)                                   0529
         ALR   @09,@05                                             0529
         AL    @09,@CF01254                                        0529
         LR    @05,@10                                             0529
         MR    @04,LOOP                                            0529
         L     @10,CTGPLPTR                                        0529
         L     @10,CTGWKA(,@10)                                    0529
         L     @10,CTGWAVL(,@10)                                   0529
         ALR   @10,@05                                             0529
         AL    @10,@CF01255                                        0529
         MVC   VOLSER-6(6,@09),CTGVLVOL(@10)                       0529
*         DEVTYP(LOOP)=CTGVLDEV(LOOP);                             0530
         LA    @10,12                                              0530
         LR    @05,LOOP                                            0530
         MR    @04,@10                                             0530
         L     @09,CAMPLPTR                                        0530
         L     @09,CAMPTR3(,@09)                                   0530
         ALR   @09,@05                                             0530
         AL    @09,@CF01253                                        0530
         LR    @05,@10                                             0530
         MR    @04,LOOP                                            0530
         L     @10,CTGPLPTR                                        0530
         L     @10,CTGWKA(,@10)                                    0530
         L     @10,CTGWAVL(,@10)                                   0530
         ALR   @10,@05                                             0530
         AL    @10,@CF01254                                        0530
         MVC   DEVTYP-2(4,@09),CTGVLDEV-6(@10)                     0530
*         FSN(LOOP)=CTGVLSEQ(LOOP);                                0531
         LA    @10,12                                              0531
         LR    @05,LOOP                                            0531
         MR    @04,@10                                             0531
         L     @09,CAMPLPTR                                        0531
         L     @09,CAMPTR3(,@09)                                   0531
         LR    @07,@10                                             0531
         MR    @06,LOOP                                            0531
         L     @10,CTGPLPTR                                        0531
         L     @10,CTGWKA(,@10)                                    0531
         L     @10,CTGWAVL(,@10)                                   0531
         BCTR  @10,0                                               0531
         BCTR  @10,0                                               0531
         LH    @10,CTGVLSEQ-10(@07,@10)                            0531
         ALR   @09,@05                                             0531
         STCM  @10,3,FSN-12(@09)                                   0531
*       END;                                                       0532
         AL    LOOP,@CF00052                                       0532
@DE00528 L     @10,CAMPLPTR                                        0532
         L     @10,CAMPTR3(,@10)                                   0532
         CH    LOOP,VOLENTCT(,@10)                                 0532
         BNH   @DL00528                                            0532
*       VOLENTCT=CTGWAVCT;                                         0533
         L     @10,CAMPLPTR                                        0533
         L     @10,CAMPTR3(,@10)                                   0533
         L     @09,CTGPLPTR                                        0533
         L     @09,CTGWKA(,@09)                                    0533
         LH    @03,CTGWAVCT(,@09)                                  0533
         STH   @03,VOLENTCT(,@10)                                  0533
*       IF VOLENTCT=ONE THEN                                       0534
*                                                                  0534
         C     @03,ONE                                             0534
         BNE   @RF00534                                            0534
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE VOLUME COUNT IS ONE THEN THERE IS DSCBTTR        */
*         /* INFORMATION TO MOVE ALSO.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0535
*         RETVCBLK=CTGVLTTR;                                       0535
         L     @09,CTGWAVL(,@09)                                   0535
         MVC   RETVCBLK(3,@10),CTGVLTTR(@09)                       0535
*       RFY                                                        0536
*        (TCBPTR,                                                  0536
*         WRKREG) RSTD;                                            0536
@RF00534 DS    0H                                                  0537
*       DO;                         /* MODESET KEYADDR(OLDKEY)     0537
*                                      WORKREG(WRKREG)               */
*         WRKREG=OLDKEY;            /* GET KEY FORM SAVE LOCATION    */
         SLR   WRKREG,WRKREG                                       0538
         IC    WRKREG,OLDKEY                                       0538
*         SPKA(WRKREG);             /* SET PSW KEY                   */
         SPKA  0(WRKREG)                                           0539
*       END;                        /* MODESET KEYADDR(OLDKEY)     0540
*                                      WORKREG(WRKREG) RESET TO    0540
*                                      CATALOG KEY                   */
*       STSW=CHAR0;                 /* ESTAE USE-0FF YL026RB         */
         MVC   STSW(1),CHAR0                                       0541
*       RFY                                                        0542
*        (TCBPTR,                                                  0542
*         WRKREG,                                                  0542
*         LOOP) UNRSTD;                                            0542
*       SAVERC=NORMRC;                                             0543
         SLR   @10,@10                                             0543
         ST    @10,SAVERC                                          0543
*     END;                                                         0544
*   END OSVOLST;                                                   0545
@EL00014 L     @13,4(,@13)                                         0545
@EF00014 DS    0H                                                  0545
@ER00014 L     @14,12(,@13)                                        0545
         BR    @14                                                 0545
*                                                                  0546
*   /*****************************************************************/
*   /*                                                               */
*   /* OSRETCD IS CALLED TO TRANSLATE VSAM RETURN CODES TO A RETURN  */
*   /* CODE THAT IS WITHIN THE RANGE OF ACCEPTED RETURN CODES FOR    */
*   /* OS/VS.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*OSRETCD:                                                          0546
*   PROC OPTIONS(SAVEAREA(16),SAVE(14));                           0546
OSRETCD  ST    @14,12(,@13)                                        0546
         ST    @13,@SA00015+4                                      0546
         LA    @14,@SA00015                                        0546
         LR    @13,@14                                             0546
*   SAVER0=ZERO;                                                   0547
         SLR   @10,@10                                             0547
         ST    @10,SAVER0                                          0547
*   IF SAVERC=NOCAT×SAVERC=CATNEDED×SAVERC=NOTOPEN THEN            0548
*                                                                  0548
         L     @10,SAVERC                                          0548
         C     @10,NOCAT                                           0548
         BE    @RT00548                                            0548
         C     @10,CATNEDED                                        0548
         BE    @RT00548                                            0548
         C     @10,NOTOPEN                                         0548
         BNE   @RF00548                                            0548
@RT00548 DS    0H                                                  0549
*     /***************************************************************/
*     /*                                                             */
*     /* ANY OF THE ABOVE RETURN CODES MEANS BASICALLY THAT A CATALOG*/
*     /* DOES NOT EXIST OR IS NOT OPEN.                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0549
*     SAVERC=NOCAT;                                                0549
         L     @10,NOCAT                                           0549
         ST    @10,SAVERC                                          0549
*   ELSE                                                           0550
*     IF SAVERC=PRTECTED THEN                                      0550
*                                                                  0550
         B     @RC00548                                            0550
@RF00548 L     @10,SAVERC                                          0550
         C     @10,PRTECTED                                        0550
         BNE   @RF00550                                            0550
*       /*************************************************************/
*       /*                                                           */
*       /* IF A PASSWORD PROTECTION ERROR                    @ZA02503*/
*       /* OCCURRED, THE RETURN                              @ZA02503*/
*       /* CODE INDICATES THAT THE DATA SET                  @ZA02503*/
*       /* WAS NOT FOUND, AND REG 0 IS SET                   @ZA02503*/
*       /* TO THE VSAM RETURN CODE.                          @ZA02503*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0551
*       DO;                         /*                       @ZA02503*/
*         SAVER0=SAVERC;            /*                       @ZA02503*/
         ST    @10,SAVER0                                          0552
*         SAVERC=DSNOTFND;          /*                       @ZA02503*/
         L     @10,DSNOTFND                                        0553
         ST    @10,SAVERC                                          0553
*       END;                        /*                       @ZA02503*/
*     ELSE                                                         0555
*                                                                  0555
*       /*************************************************************/
*       /*                                                           */
*       /* ALL OTHER RETURN CODES ARE DEPENDENT UPON WHETHER THE     */
*       /* ORIGINAL REQUEST WAS A LOCATE OR A NON-LOCATE. A CHECK IS */
*       /* MADE FOR THIS CONDITION.                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0555
*       DO;                                                        0555
         B     @RC00550                                            0555
@RF00550 DS    0H                                                  0556
*         IF(OPTBITS&OSLOCMSK)=ALLZERO THEN                        0556
*                                                                  0556
         MVC   @TS00001(4),OPTBITS                                 0556
         NC    @TS00001(4),OSLOCMSK                                0556
         CLC   @TS00001(4),ALLZERO                                 0556
         BNE   @RF00556                                            0556
*           /*********************************************************/
*           /*                                                       */
*           /* THE ORIGINAL REQUEST WAS A LOCATE SO THE RETURN CODES */
*           /* ARE TRANSLATED ACCORDINGLY.                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0557
*           DO;                                                    0557
*             IF SAVERC=DSNOTFND THEN                              0558
         CLC   SAVERC(4),DSNOTFND                                  0558
         BE    @RT00558                                            0558
*               ;                                                  0559
*                                                                  0559
*             /*******************************************************/
*             /*                                                     */
*             /* DATASET NOT FOUND IS A VALID RETURN CODE AND IS LEFT*/
*             /* AS IS.                                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0560
*             ELSE                                                 0560
*                                                                  0560
*               /*****************************************************/
*               /*                                                   */
*               /* ALL OTHER RETURN CODES FROM A LOCATE HAVE THE     */
*               /* ORIGINAL RETURN CODE FROM VSAM CATALOG MANAGEMENT */
*               /* PUT IN REGISTER 0 AND AN INDICATION OF AN I/O     */
*               /* ERROR PUT IN THE NORMAL RETURN REGISTER (REG 15). */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0560
*               DO;                                                0560
*                 SAVER0=SAVERC;                                   0561
         L     @10,SAVERC                                          0561
         ST    @10,SAVER0                                          0561
*                 SAVERC=LOCIOERR;                                 0562
         L     @10,LOCIOERR                                        0562
         ST    @10,SAVERC                                          0562
*               END;                                               0563
*           END;                                                   0564
*         ELSE                                                     0565
*                                                                  0565
*           /*********************************************************/
*           /*                                                       */
*           /* ALL NON-LOCATE RETURN CODES ARE TRANSLATED IN THE     */
*           /* FOLLOWING BLOCK.                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0565
*           DO;                                                    0565
         B     @RC00556                                            0565
@RF00556 DS    0H                                                  0566
*             IF SAVERC=DSEXISTS THEN/*                      @YM04146*/
*                                                                  0566
         L     @10,SAVERC                                          0566
         C     @10,DSEXISTS                                        0566
         BNE   @RF00566                                            0566
*               /*****************************************************/
*               /*                                                   */
*               /* DATASET ALREADY EXISTS IS A VALID RETURN CODE AND */
*               /* IS LEFT AS IS. REG 0 IS SET TO 8.         @YM04146*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0567
*               SAVER0=SAVERC;      /*                       @YM04146*/
         ST    @10,SAVER0                                          0567
*             ELSE                                                 0568
*               IF SAVERC=INVALTYP THEN                            0568
*                                                                  0568
         B     @RC00566                                            0568
@RF00566 L     @10,SAVERC                                          0568
         C     @10,INVALTYP                                        0568
         BNE   @RF00568                                            0568
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE DATASET ENTRY WAS THE WRONG ENTRY TYPE   */
*                 /* THE RETURN CODE INDICATES THAT THE ENTRY ALREADY*/
*                 /* EXISTED AND REG 0 IS SET TO THE VSAM RETURN     */
*                 /* CODE.                                           */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0569
*                 DO;                                              0569
*                   SAVER0=SAVERC;                                 0570
         ST    @10,SAVER0                                          0570
*                   SAVERC=DSEXISTS;                               0571
         L     @10,DSEXISTS                                        0571
         ST    @10,SAVERC                                          0571
*                 END;                                             0572
*               ELSE                                               0573
*                                                                  0573
*                 /***************************************************/
*                 /*                                                 */
*                 /* ALL OTHER RETURN CODES FROM A NON- LOCATE HAVE  */
*                 /* THE ORIGINAL RETURN FROM VSAM CATALOG MANAGEMENT*/
*                 /* PUT IN REG 0 AND AN INDICATION OF AN I/O ERROR  */
*                 /* PUT IN THE NORMAL RETURN REG (REG 15).          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0573
*                 DO;                                              0573
         B     @RC00568                                            0573
@RF00568 DS    0H                                                  0574
*                   IF SAVERC=NOSPACE THEN                         0574
         CLC   SAVERC(4),NOSPACE                                   0574
         BE    @RT00574                                            0574
*                     ;                                            0575
*                                                                  0575
*                   /*************************************************/
*                   /*                                               */
*                   /* A RETURN CODE OF 20 (NO EXTENTS OR NO SPACE   */
*                   /* AVAILABLE) IS LEFT AS IS SINCE IT IS A VALID  */
*                   /* OS/VS RETURN CODE.                            */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0576
*                   ELSE                                           0576
*                                                                  0576
*                     /***********************************************/
*                     /*                                             */
*                     /* SET AN I/O ERROR INDICATOR AND PUT THE      */
*                     /* ORIGINAL VSAM RETURN CODE INTO REGISTER 0.  */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0576
*                     DO;                                          0576
*                       SAVER0=SAVERC;                             0577
         L     @10,SAVERC                                          0577
         ST    @10,SAVER0                                          0577
*                       SAVERC=CATIOERR;                           0578
         L     @10,CATIOERR                                        0578
         ST    @10,SAVERC                                          0578
*                     END;                                         0579
*                 END;                                             0580
*           END;                                                   0581
*       END;                                                       0582
*   END OSRETCD;                                                   0583
@EL00015 L     @13,4(,@13)                                         0583
@EF00015 DS    0H                                                  0583
@ER00015 L     @14,12(,@13)                                        0583
         BR    @14                                                 0583
*   END IGC0002F                                                   0584
*                                                                  0584
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGWA)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGVL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGCV)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */
*/*%INCLUDE SYSLIB  (IHARB   )                                       */
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */
*                                                                  0584
*       ;                                                          0584
@DATA    DS    0H
@CH00115 DC    H'12'
@CH01203 DC    H'22'
@SX01250 XC    SPACE(0,MAINPTR),SPACE(MAINPTR)
         DS    0F
@AL00382 DC    A(LOCPRMSZ)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF01178)
@DATD    DSECT
         DS    0F
@SA00001 DS    4F
@SA00003 DS    4F
@SA00004 DS    4F
@SA00005 DS    4F
@SA00006 DS    4F
@SA00007 DS    4F
@SA00008 DS    4F
@SA00010 DS    4F
@PC00010 DS    2F
@SA00011 DS    4F
@SA00012 DS    4F
@SA00013 DS    4F
@SA00014 DS    4F
@SA00015 DS    4F
@SA00009 DS    4F
@AL00001 DS    2A
@AFTEMPS DS    3F
IGC0002F CSECT
         DS    0F
@CF00052 DC    F'1'
@CF00168 DC    F'4'
@CF01144 DC    F'9'
@CF01204 DC    F'160'
@CF01178 DC    F'256'
@CF01255 DC    F'-12'
@CF01253 DC    F'-10'
@CF01254 DC    F'-6'
@CF01252 DC    F'-4'
@CF01108 DC    XL4'007D8000'
@DATD    DSECT
         DS    0D
@TS00001 DS    CL4
IGC0002F CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
LOCPRMSZ DC    AL4(382)
NOCAT    DC    A(4)
DSNOTFND DC    F'8'
UNSUPTED DC    F'16'
NOSPACE  DC    A(20)
LOCIOERR DC    A(24)
CATIOERR DC    A(28)
CATNEDED DC    A(36)
TOOSMALL DC    A(40)
SMALLWKA DC    A(44)
PRTECTED DC    A(56)
INVALTYP DC    A(60)
NOTOPEN  DC    A(188)
ONE      DC    F'1'
MAXVOLS  DC    F'20'
STDLEN   DC    AL4(28+92+16+16+20)
STCHK    DC    F'282'
LISTLEN  DC    H'240'
LENOPTN  DC    H'190'
@CC01157 DC    C'IGG0CLA1'
@CC01150 DC    C'.X'
OSLOCMSK DC    X'3A7F8000'
LOCTTRMK DC    X'387F8000'
CATMSK   DC    X'1A3D8000'
UCATMSK  DC    X'327B8000'
RECATMSK DC    X'2A7D8000'
CAMCAT   DC    X'20'
CAMUNCAT DC    X'08'
CAMRECAT DC    X'10'
ALLZERO  DC    X'00000000'
XCTL     DC    AL1(1)
EXITRT   DC    AL1(0)
         DS    CL1
RECORD   DS    CL24
         ORG   RECORD
MODN     DC    CL8'IGC0002F'
CSECTN   DC    CL8'IGC0002F'
FRRID    DC    8X'00'
         ORG   RECORD+24
FIXAREA  DS    CL100
         ORG   FIXAREA
@NM00109 DC    100X'00'
         ORG   FIXAREA+100
@DATD    DSECT
         ORG   @DATD+496    FORCE ALIGNMENT
WORKCLCA DS    CL3600       DEFINE WORKAREA
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IGC0002F CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
TCBPTR   EQU   @04
R0       EQU   @00
MAINSIZE EQU   @00
MAINPTR  EQU   @01
PARMPTR  EQU   @01
R2       EQU   @02
VSAMRETC EQU   @02
HOLD15   EQU   @02
GPR02F   EQU   @02
CVTPTR   EQU   @03
SVRBPTR  EQU   @05
ESTAPARM EQU   @05
R6       EQU   @06
R7       EQU   @07
HOLD0    EQU   @08
LOOP     EQU   @08
HOLD1    EQU   @09
WRKREG   EQU   @09
R11      EQU   @11
WORKPTR  EQU   @12
EXITPTR  EQU   @14
RETCODE  EQU   @15
XCTLPTR  EQU   @15
GPR01P   EQU   @01
GPR00P   EQU   @00
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR00F   EQU   @00
GPR02P   EQU   @02
GPR12F   EQU   @12
GPR13P   EQU   @13
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGBYPSS EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGGTNXT EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGDOCAT EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGCVOL  EQU   CTGCAT
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGTYPE  EQU   CTGPL+18
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGGDGB  EQU   CTGFBFLG
CTGJSCB  EQU   CTGPL+24
CTGFIELD EQU   CTGPL+28
CTGWA    EQU   0
CTGWAVL  EQU   CTGWA
CTGWALV  EQU   CTGWA+4
CTGWAVCT EQU   CTGWA+6
CTGVL    EQU   0
CTGVLVOL EQU   CTGVL
CTGVLDEV EQU   CTGVL+6
CTGVLSEQ EQU   CTGVL+10
CTGVLX   EQU   0
CTGVLTTR EQU   CTGVLX+12
CTGCV    EQU   0
CTGCVDSN EQU   CTGCV+6
CTGCVDEV EQU   CTGCVDSN
CTGFV    EQU   0
CTGFVTYP EQU   CTGFV
CTGFVPRO EQU   CTGFV+1
CTGFVENT EQU   CTGFV+20
CTGFVVLT EQU   CTGFV+40
CTGFVDVT EQU   CTGFV+48
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVFSN EQU   CTGFVAMD
CTGFVLMT EQU   CTGFV+72
CTGFVGAT EQU   CTGFV+76
CTGFVPWD EQU   CTGFV+84
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
TCB      EQU   0
TCBRBP   EQU   TCB
NONADDR  EQU   0
RBPRFX   EQU   0
RBBASIC  EQU   0
RBEXRTNM EQU   RBBASIC
RBTMFLD  EQU   RBEXRTNM
RBSTAB   EQU   RBBASIC+10
XSTAB    EQU   RBSTAB
RBSTAB1  EQU   XSTAB
XSTAB1   EQU   RBSTAB1
RBFTCKPT EQU   XSTAB1
RBSTAB2  EQU   XSTAB+1
XSTAB2   EQU   RBSTAB2
RBTCBNXT EQU   XSTAB2
RBFACTV  EQU   XSTAB2
RBFDYN   EQU   XSTAB2
RBECBWT  EQU   XSTAB2
RBOPSW   EQU   RBBASIC+16
XRBPSW   EQU   RBOPSW
RBOPSWB2 EQU   XRBPSW+1
RBLINK   EQU   RBBASIC+28
XRBLNK   EQU   RBLINK
RBWCF    EQU   XRBLNK
RBLINKB  EQU   XRBLNK+1
RBGRSAVE EQU   RBBASIC+32
XRBREG   EQU   RBGRSAVE
RBGRS0   EQU   XRBREG
RBGRS1   EQU   XRBREG+4
RBGRS2   EQU   XRBREG+8
RBGRS3   EQU   XRBREG+12
RBGRS4   EQU   XRBREG+16
RBGRS5   EQU   XRBREG+20
RBGRS6   EQU   XRBREG+24
RBGRS7   EQU   XRBREG+28
RBGRS8   EQU   XRBREG+32
RBGRS9   EQU   XRBREG+36
RBGRS10  EQU   XRBREG+40
RBGRS11  EQU   XRBREG+44
RBGRS12  EQU   XRBREG+48
RBGRS13  EQU   XRBREG+52
RBGRS14  EQU   XRBREG+56
RBGRS15  EQU   XRBREG+60
XRBESA   EQU   RBBASIC+96
RBPREFIX EQU   0
RBRSV019 EQU   RBPREFIX+14
RBRSV028 EQU   RBPREFIX+15
RBRSV041 EQU   RBPREFIX+27
RBRSV054 EQU   RBPREFIX+39
RBRTOPSW EQU   RBPREFIX+40
RBRTPSW2 EQU   RBRTOPSW+8
RBRTICIL EQU   RBRTPSW2
RBFLAGS1 EQU   RBPREFIX+56
RBINTCDA EQU   RBPREFIX+61
RBSECT   EQU   0
RBPPSAV  EQU   RBSECT
@NM00021 EQU   RBSECT+10
@NM00022 EQU   @NM00021
RBTRSVRB EQU   @NM00022
@NM00024 EQU   @NM00021+1
RBETXR   EQU   @NM00024
RBEP     EQU   RBSECT+12
RBPGMQ   EQU   RBSECT+24
@NM00031 EQU   RBSECT+28
@NM00032 EQU   @NM00031
IRBEND   EQU   RBSECT+96
@NM00035 EQU   RBSECT+96
RBRSV138 EQU   @NM00035+7
RBSCBB   EQU   RBSECT+144
RBSPARM  EQU   RBSCBB+8
RBSFLGS1 EQU   RBSPARM
RBSIOPRC EQU   RBSFLGS1
RBSOWNR  EQU   RBSCBB+12
RBSFLGS2 EQU   RBSOWNR
RBSDATA  EQU   RBSCBB+16
RBSFLG3  EQU   RBSDATA
RBRSV150 EQU   RBSECT+167
SDWA     EQU   0
SDWAFIOB EQU   SDWA+4
SDWAABCC EQU   SDWAFIOB
SDWACMPF EQU   SDWAABCC
SDWAREQ  EQU   SDWACMPF
SDWACMPC EQU   SDWAABCC+1
SDWACTL1 EQU   SDWA+8
SDWACMKA EQU   SDWACTL1
SDWAMWPA EQU   SDWACTL1+1
SDWAPMKA EQU   SDWACTL1+4
SDWACTL2 EQU   SDWA+16
SDWACMKP EQU   SDWACTL2
SDWAMWPP EQU   SDWACTL2+1
SDWAPMKP EQU   SDWACTL2+4
SDWAGRSV EQU   SDWA+24
SDWANAME EQU   SDWA+88
SDWAEC1  EQU   SDWA+104
SDWAEMK1 EQU   SDWAEC1
SDWAMWP1 EQU   SDWAEC1+1
SDWAINT1 EQU   SDWAEC1+2
SDWANXT1 EQU   SDWAEC1+4
SDWAAEC1 EQU   SDWA+112
SDWAILC1 EQU   SDWAAEC1+1
SDWAINC1 EQU   SDWAAEC1+2
SDWAICD1 EQU   SDWAINC1+1
SDWAEC2  EQU   SDWA+120
SDWAEMK2 EQU   SDWAEC2
SDWAMWP2 EQU   SDWAEC2+1
SDWAINT2 EQU   SDWAEC2+2
SDWANXT2 EQU   SDWAEC2+4
SDWAAEC2 EQU   SDWA+128
SDWAILC2 EQU   SDWAAEC2+1
SDWAINC2 EQU   SDWAAEC2+2
SDWAICD2 EQU   SDWAINC2+1
SDWASRSV EQU   SDWA+136
SDWAIDNT EQU   SDWA+200
SDWAMCH  EQU   SDWA+204
SDWASTCK EQU   SDWAMCH
SDWAMCHI EQU   SDWAMCH+8
SDWAMCHS EQU   SDWAMCHI
SDWAMCHD EQU   SDWAMCHI+1
SDWARSR1 EQU   SDWAMCH+12
SDWARSR2 EQU   SDWAMCH+13
SDWAFLGS EQU   SDWA+232
SDWAERRA EQU   SDWAFLGS
SDWAERRB EQU   SDWAFLGS+1
SDWAERRC EQU   SDWAFLGS+2
SDWAPERC EQU   SDWAERRC
SDWAERRD EQU   SDWAFLGS+3
SDWAIOFS EQU   SDWA+238
SDWACPUA EQU   SDWA+248
SDWAPARQ EQU   SDWA+252
SDWARCDE EQU   SDWAPARQ
SDWAACF2 EQU   SDWAPARQ+1
SDWARCRD EQU   SDWAACF2
SDWAACF3 EQU   SDWAPARQ+2
SDWAACF4 EQU   SDWAPARQ+3
SDWALKWA EQU   SDWA+256
SDWALKWS EQU   SDWALKWA
SDWARECP EQU   SDWA+292
SDWASNPA EQU   SDWA+320
SDWADUMP EQU   SDWASNPA
SDWADPFS EQU   SDWADUMP+1
SDWADDAT EQU   SDWASNPA+4
SDWASDAT EQU   SDWADDAT
SDWAPDAT EQU   SDWADDAT+2
SDWADPSA EQU   SDWA+328
SDWADPSL EQU   SDWADPSA
SDWARA   EQU   SDWA+400
SDWADPVA EQU   SDWARA+2
CAMLSTD  EQU   0
CAMOPTNS EQU   CAMLSTD
CAMOPTN1 EQU   CAMOPTNS
CAMCVOL  EQU   CAMOPTN1
CAMLTTR  EQU   CAMOPTN1
CAMOPTN2 EQU   CAMOPTNS+1
CAMDOCAT EQU   CAMOPTN2
CAMBLDA  EQU   CAMOPTN2
CAMLNKX  EQU   CAMOPTN2
CAMDTTR  EQU   CAMOPTN2
CAMDLTA  EQU   CAMOPTN2
CAMOPTN3 EQU   CAMOPTNS+2
CAMDRPX  EQU   CAMOPTN3
CAMTIOT  EQU   CAMOPTN3
CAMAM0   EQU   CAMOPTN3
@NM00090 EQU   CAMLSTD+4
CAMPTR1  EQU   @NM00090
CAMCVOLP EQU   @NM00090+4
CAMPTR3  EQU   @NM00090+8
CAMDSCBP EQU   @NM00090+12
CAMCVOLS EQU   0
CAMIDXNM EQU   0
RETDATA  EQU   0
VOLENTCT EQU   RETDATA
VOLST    EQU   RETDATA+2
DEVTYP   EQU   VOLST
VOLSER   EQU   VOLST+4
FSN      EQU   VOLST+10
RETDSCBT EQU   RETDATA+252
RETVCBLK EQU   RETDSCBT
CTGLSTD  EQU   0
CTGDYNWA EQU   CTGLSTD+32
WKALEN   EQU   CTGDYNWA
VOLSTCTG EQU   CTGLSTD+48
CVOLCTG  EQU   CTGLSTD+288
CTGCATST EQU   0
FVTFLD   EQU   CTGCATST+32
FSNENTS  EQU   CTGCATST+124
DEVTPS   EQU   CTGCATST+148
FSNOVLY  EQU   0
FSNARRY  EQU   FSNOVLY
DEVOVLY  EQU   0
DEVS     EQU   DEVOVLY
DEVARRY  EQU   DEVS+8
VOLSERS  EQU   0
VLSFLND  EQU   VOLSERS
VVOL     EQU   VOLSERS+2
VVOLSER  EQU   VVOL+2
I256C    EQU   0
SPACE    EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
WKCVOLVS EQU   WORKCLCA+92
CVTSAV   EQU   WORKCLCA+100
TCBSAV   EQU   WORKCLCA+104
SVRBSAV  EQU   WORKCLCA+108
SAVERC   EQU   WORKCLCA+112
SAVER1   EQU   WORKCLCA+116
SAVER0   EQU   WORKCLCA+120
EXITSAV  EQU   WORKCLCA+124
CTGPLPTR EQU   WORKCLCA+128
CTGFLPTR EQU   WORKCLCA+132
CAMPLPTR EQU   WORKCLCA+136
PRMLSTSZ EQU   WORKCLCA+140
OPTBITS  EQU   WORKCLCA+144
OPBIT1   EQU   OPTBITS
XCTLLIST EQU   WORKCLCA+148
XCTLPARM EQU   XCTLLIST
XCTLNUL  EQU   XCTLLIST+4
XCTLNAME EQU   XCTLLIST+8
VOLSTPTR EQU   WORKCLCA+164
VOLUMECT EQU   WORKCLCA+168
CALLTYPE EQU   WORKCLCA+172
ROUTE    EQU   WORKCLCA+173
OLDKEY   EQU   WORKCLCA+174
ESTALIST EQU   WORKCLCA+176
BASEPTR  EQU   ESTALIST
WAPTR    EQU   ESTALIST+4
SASW     EQU   ESTALIST+8
WASW     EQU   ESTALIST+9
STSW     EQU   ESTALIST+10
PARMLIST EQU   WORKCLCA+188
WORKNAME EQU   WORKCLCA+204
AMOUNT   EQU   0
CLEAR    EQU   0
@NM00005 EQU   CTGDDNM
CTGPROB  EQU   @NM00005
CTGREASN EQU   CTGPROB+2
RBSECS03 EQU   RBEP
RBCDE    EQU   RBSECS03
RBCDFLGS EQU   RBCDE
RBSECS05 EQU   RBPGMQ
RBSQE    EQU   RBSECS05
RBSECS06 EQU   RBPGMQ
RBIQE    EQU   RBSECS06
RBSECS07 EQU   RBPGMQ
RBIQE2   EQU   RBSECS07
RBSECS08 EQU   IRBEND
RBSECS09 EQU   IRBEND
DSEXISTS EQU   DSNOTFND
ZEROFLD  EQU   ALLZERO
VSAM     EQU   XCTL
OSVS     EQU   EXITRT
CHAR1    EQU   XCTL
CHAR0    EQU   EXITRT
INVALFUN EQU   CATIOERR
PLPTR    EQU   SAVER1
*                                      START UNREFERENCED COMPONENTS
RBRSV161 EQU   RBSECS09+64
RBSIRBWA EQU   RBSECS09
RBIQEWRK EQU   RBSECS08+4
RBNEXAV  EQU   RBSECS08
RBIQEA   EQU   RBIQE2
RBIQE1   EQU   RBIQE+1
RBUSE    EQU   RBIQE
RBSQEA   EQU   RBSQE+1
@NM00036 EQU   RBSQE
RBCDE1   EQU   RBCDE+1
RBCDLOAD EQU   RBCDFLGS
RBCDXCTL EQU   RBCDFLGS
RBCDSYNC EQU   RBCDFLGS
RBCDNODE EQU   RBCDFLGS
RBRSV010 EQU   RBCDFLGS
RBCDATCH EQU   RBCDFLGS
RBRSV009 EQU   RBCDFLGS
RBNOCELL EQU   RBCDFLGS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
@NM00108 EQU   PARMLIST
@NM00107 EQU   ESTALIST+11
@NM00106 EQU   WORKCLCA+175
@NM00105 EQU   OPTBITS+2
OPBIT2   EQU   OPTBITS+1
@NM00104 EQU   WORKCLCA+98
WKCATANM EQU   WORKCLCA+48
WKCATNM  EQU   WORKCLCA+4
@NM00103 EQU   WORKCLCA
@NM00102 EQU   VVOL
@NM00101 EQU   DEVS
@NM00100 EQU   CTGCATST+164
@NM00099 EQU   CTGCATST+140
@NM00098 EQU   CTGCATST+28
@NM00097 EQU   CTGCATST
@NM00096 EQU   CTGLSTD+28
@NM00095 EQU   CTGLSTD
RETCVOL  EQU   RETDATA+259
@NM00094 EQU   RETDATA+256
@NM00093 EQU   RETDSCBT+3
@NM00092 EQU   RETDATA+242
@NM00091 EQU   @NM00090+16
CAMGEN   EQU   CAMOPTNS+3
@NM00089 EQU   CAMOPTN3
@NM00088 EQU   CAMOPTN3
CAMDLTX  EQU   CAMOPTN2
@NM00087 EQU   CAMOPTN2
@NM00086 EQU   CAMOPTN1
@NM00085 EQU   CAMOPTN1
@NM00084 EQU   SDWA+512
SDWAVRA  EQU   SDWARA+4
SDWAURAL EQU   SDWARA+3
@NM00083 EQU   SDWADPVA
SDWAEBC  EQU   SDWADPVA
SDWAHEX  EQU   SDWADPVA
SDWAVRAL EQU   SDWARA
@NM00082 EQU   SDWA+396
SDWACOMP EQU   SDWA+392
SDWARCPL EQU   SDWA+364
@NM00081 EQU   SDWADPSA+32
SDWATO4  EQU   SDWADPSL+28
SDWAFRM4 EQU   SDWADPSL+24
SDWATO3  EQU   SDWADPSL+20
SDWAFRM3 EQU   SDWADPSL+16
SDWATO2  EQU   SDWADPSL+12
SDWAFRM2 EQU   SDWADPSL+8
SDWATO1  EQU   SDWADPSL+4
SDWAFRM1 EQU   SDWADPSL
@NM00080 EQU   SDWADDAT+3
@NM00079 EQU   SDWAPDAT
SDWAUSPL EQU   SDWAPDAT
SDWADPSW EQU   SDWAPDAT
SDWATJPA EQU   SDWAPDAT
SDWATLPA EQU   SDWAPDAT
SDWADREG EQU   SDWAPDAT
SDWADSAH EQU   SDWAPDAT
SDWADSAS EQU   SDWAPDAT
@NM00078 EQU   SDWADDAT+1
@NM00077 EQU   SDWASDAT
SDWAQQS  EQU   SDWASDAT
SDWACBS  EQU   SDWASDAT
SDWAGTF  EQU   SDWASDAT
SDWASWA  EQU   SDWASDAT
SDWALSQA EQU   SDWASDAT
SDWASQA  EQU   SDWASDAT
SDWANUC  EQU   SDWASDAT
@NM00076 EQU   SDWADUMP+2
@NM00075 EQU   SDWADPFS
SDWASLST EQU   SDWADPFS
@NM00074 EQU   SDWADPFS
SDWADLST EQU   SDWADPFS
SDWADPT  EQU   SDWADPFS
SDWADPID EQU   SDWADUMP
SDWADPLA EQU   SDWA+316
SDWAREXN EQU   SDWARECP+16
SDWACSCT EQU   SDWARECP+8
SDWAMODN EQU   SDWARECP
@NM00073 EQU   SDWA+290
SDWAASID EQU   SDWA+288
SDWATALW EQU   SDWALKWS+28
SDWATDLW EQU   SDWALKWS+24
SDWATNLW EQU   SDWALKWS+20
SDWAAPLW EQU   SDWALKWS+16
SDWAIPLW EQU   SDWALKWS+12
SDWAILLW EQU   SDWALKWS+8
SDWAIULW EQU   SDWALKWS+4
SDWAICLW EQU   SDWALKWS
SDWAFLLK EQU   SDWAACF4
SDWACMS  EQU   SDWAACF4
SDWAOPTM EQU   SDWAACF4
SDWATADB EQU   SDWAACF4
SDWATDNB EQU   SDWAACF4
SDWATNCB EQU   SDWAACF4
SDWAILCH EQU   SDWAACF4
SDWAIUCB EQU   SDWAACF4
SDWAICAT EQU   SDWAACF3
SDWAIPRG EQU   SDWAACF3
SDWASALL EQU   SDWAACF3
SDWAASMP EQU   SDWAACF3
SDWADISP EQU   SDWAACF3
@NM00072 EQU   SDWAACF3
@NM00071 EQU   SDWAACF2
SDWAFREE EQU   SDWAACF2
SDWAUPRG EQU   SDWAACF2
@NM00070 EQU   SDWAACF2
SDWASPIN EQU   SDWAACF2
@NM00069 EQU   SDWAACF2
SDWALCPU EQU   SDWACPUA+2
@NM00068 EQU   SDWACPUA
SDWARECA EQU   SDWA+244
SDWARTYA EQU   SDWA+240
@NM00067 EQU   SDWA+239
@NM00066 EQU   SDWAIOFS
SDWANIOP EQU   SDWAIOFS
SDWANOIO EQU   SDWAIOFS
SDWAIOHT EQU   SDWAIOFS
SDWAIOQR EQU   SDWAIOFS
SDWAFMID EQU   SDWA+236
@NM00065 EQU   SDWAERRD
SDWAMCIV EQU   SDWAERRD
SDWARPIV EQU   SDWAERRD
SDWAMABD EQU   SDWAERRD
SDWACTS  EQU   SDWAERRD
SDWASTAE EQU   SDWAERRD
SDWANRBE EQU   SDWAERRD
SDWACLUP EQU   SDWAERRD
@NM00064 EQU   SDWAERRC
SDWAEAS  EQU   SDWAERRC
SDWAIRB  EQU   SDWAERRC
SDWASTAI EQU   SDWAERRC
SDWASTAF EQU   SDWAERRC
SDWASRBM EQU   SDWAERRB
SDWALDIS EQU   SDWAERRB
SDWAENRB EQU   SDWAERRB
SDWATYP1 EQU   SDWAERRB
@NM00063 EQU   SDWAERRB
SDWAPGIO EQU   SDWAERRA
SDWATEXC EQU   SDWAERRA
SDWASVCE EQU   SDWAERRA
SDWAABTM EQU   SDWAERRA
SDWASVCD EQU   SDWAERRA
SDWARKEY EQU   SDWAERRA
SDWAPCHK EQU   SDWAERRA
SDWAMCHK EQU   SDWAERRA
SDWATIME EQU   SDWAMCH+20
SDWARFSA EQU   SDWAMCH+16
@NM00062 EQU   SDWAMCH+14
SDWAVEQR EQU   SDWARSR2
SDWAPGFX EQU   SDWARSR2
SDWAFLSQ EQU   SDWARSR2
SDWAFSQA EQU   SDWARSR2
SDWANUCL EQU   SDWARSR2
SDWASPER EQU   SDWARSR2
SDWAINTC EQU   SDWARSR2
SDWAOFLN EQU   SDWARSR2
SDWACHNG EQU   SDWARSR1
SDWAMSER EQU   SDWARSR1
@NM00061 EQU   SDWARSR1
SDWACPID EQU   SDWAMCH+10
SDWATERR EQU   SDWAMCHD
SDWAFPRX EQU   SDWAMCHD
SDWAINSF EQU   SDWAMCHD
SDWAACR  EQU   SDWAMCHD
SDWASCK  EQU   SDWAMCHD
SDWAPSWU EQU   SDWAMCHD
SDWAREGU EQU   SDWAMCHD
SDWASKYF EQU   SDWAMCHD
@NM00060 EQU   SDWAMCHS
SDWARSRF EQU   SDWAMCHS
SDWARSRC EQU   SDWAMCHS
SDWAINVP EQU   SDWAMCHS
SDWATSVL EQU   SDWAMCHS
SDWARCDF EQU   SDWAMCHS
SDWASRVL EQU   SDWAMCHS
SDWASCKE EQU   SDWASTCK+4
SDWASCKB EQU   SDWASTCK
SDWALNTH EQU   SDWAIDNT+1
SDWASPID EQU   SDWAIDNT
SDWASR15 EQU   SDWASRSV+60
SDWASR14 EQU   SDWASRSV+56
SDWASR13 EQU   SDWASRSV+52
SDWASR12 EQU   SDWASRSV+48
SDWASR11 EQU   SDWASRSV+44
SDWASR10 EQU   SDWASRSV+40
SDWASR09 EQU   SDWASRSV+36
SDWASR08 EQU   SDWASRSV+32
SDWASR07 EQU   SDWASRSV+28
SDWASR06 EQU   SDWASRSV+24
SDWASR05 EQU   SDWASRSV+20
SDWASR04 EQU   SDWASRSV+16
SDWASR03 EQU   SDWASRSV+12
SDWASR02 EQU   SDWASRSV+8
SDWASR01 EQU   SDWASRSV+4
SDWASR00 EQU   SDWASRSV
SDWATRN2 EQU   SDWAAEC2+4
SDWAIPC2 EQU   SDWAICD2
SDWAIMC2 EQU   SDWAICD2
SDWAIPR2 EQU   SDWAICD2
@NM00059 EQU   SDWAINC2
@NM00058 EQU   SDWAILC2
SDWAIL2  EQU   SDWAILC2
@NM00057 EQU   SDWAILC2
@NM00056 EQU   SDWAAEC2
SDWAADD2 EQU   SDWANXT2+1
@NM00055 EQU   SDWANXT2
@NM00054 EQU   SDWAEC2+3
SDWASGN2 EQU   SDWAINT2
SDWAEXP2 EQU   SDWAINT2
SDWADEC2 EQU   SDWAINT2
SDWAFPO2 EQU   SDWAINT2
SDWACC2  EQU   SDWAINT2
@NM00053 EQU   SDWAINT2
SDWAPGM2 EQU   SDWAMWP2
SDWAWAT2 EQU   SDWAMWP2
SDWAMCK2 EQU   SDWAMWP2
SDWAECT2 EQU   SDWAMWP2
SDWAKEY2 EQU   SDWAMWP2
SDWAEXT2 EQU   SDWAEMK2
SDWAIO2  EQU   SDWAEMK2
SDWATRM2 EQU   SDWAEMK2
@NM00052 EQU   SDWAEMK2
SDWAPER2 EQU   SDWAEMK2
@NM00051 EQU   SDWAEMK2
SDWATRAN EQU   SDWAAEC1+4
SDWAIPC1 EQU   SDWAICD1
SDWAIMC1 EQU   SDWAICD1
SDWAIPR1 EQU   SDWAICD1
@NM00050 EQU   SDWAINC1
@NM00049 EQU   SDWAILC1
SDWAIL1  EQU   SDWAILC1
@NM00048 EQU   SDWAILC1
@NM00047 EQU   SDWAAEC1
SDWAADD1 EQU   SDWANXT1+1
@NM00046 EQU   SDWANXT1
@NM00045 EQU   SDWAEC1+3
SDWASGN1 EQU   SDWAINT1
SDWAEXP1 EQU   SDWAINT1
SDWADEC1 EQU   SDWAINT1
SDWAFPO1 EQU   SDWAINT1
SDWACC1  EQU   SDWAINT1
@NM00044 EQU   SDWAINT1
SDWAPGM1 EQU   SDWAMWP1
SDWAWAT1 EQU   SDWAMWP1
SDWAMCK1 EQU   SDWAMWP1
SDWAECT1 EQU   SDWAMWP1
SDWAKEY1 EQU   SDWAMWP1
SDWAEXT1 EQU   SDWAEMK1
SDWAIO1  EQU   SDWAEMK1
SDWATRM1 EQU   SDWAEMK1
@NM00043 EQU   SDWAEMK1
SDWAPER1 EQU   SDWAEMK1
@NM00042 EQU   SDWAEMK1
SDWAIOBR EQU   SDWA+100
SDWAEPA  EQU   SDWA+96
@NM00041 EQU   SDWANAME+4
SDWARBAD EQU   SDWANAME
SDWAGR15 EQU   SDWAGRSV+60
SDWAGR14 EQU   SDWAGRSV+56
SDWAGR13 EQU   SDWAGRSV+52
SDWAGR12 EQU   SDWAGRSV+48
SDWAGR11 EQU   SDWAGRSV+44
SDWAGR10 EQU   SDWAGRSV+40
SDWAGR09 EQU   SDWAGRSV+36
SDWAGR08 EQU   SDWAGRSV+32
SDWAGR07 EQU   SDWAGRSV+28
SDWAGR06 EQU   SDWAGRSV+24
SDWAGR05 EQU   SDWAGRSV+20
SDWAGR04 EQU   SDWAGRSV+16
SDWAGR03 EQU   SDWAGRSV+12
SDWAGR02 EQU   SDWAGRSV+8
SDWAGR01 EQU   SDWAGRSV+4
SDWAGR00 EQU   SDWAGRSV
SDWANXTP EQU   SDWACTL2+5
SDWASGP  EQU   SDWAPMKP
SDWAEUP  EQU   SDWAPMKP
SDWADOP  EQU   SDWAPMKP
SDWAFPP  EQU   SDWAPMKP
SDWACCP  EQU   SDWAPMKP
SDWAILP  EQU   SDWAPMKP
SDWAINTP EQU   SDWACTL2+2
SDWASPVP EQU   SDWAMWPP
SDWAWATP EQU   SDWAMWPP
SDWAMCKP EQU   SDWAMWPP
@NM00040 EQU   SDWAMWPP
SDWAKEYP EQU   SDWAMWPP
SDWAEXTP EQU   SDWACMKP
SDWAIOP  EQU   SDWACMKP
SDWANXTA EQU   SDWACTL1+5
SDWASGA  EQU   SDWAPMKA
SDWAEUA  EQU   SDWAPMKA
SDWADOA  EQU   SDWAPMKA
SDWAFPA  EQU   SDWAPMKA
SDWACCA  EQU   SDWAPMKA
SDWAILA  EQU   SDWAPMKA
SDWAINTA EQU   SDWACTL1+2
SDWASPVA EQU   SDWAMWPA
SDWAWATA EQU   SDWAMWPA
SDWAMCKA EQU   SDWAMWPA
@NM00039 EQU   SDWAMWPA
SDWAKEYA EQU   SDWAMWPA
SDWAEXTA EQU   SDWACMKA
SDWAIOA  EQU   SDWACMKA
@NM00038 EQU   SDWACMPF
SDWASTCC EQU   SDWACMPF
@NM00037 EQU   SDWACMPF
SDWASTEP EQU   SDWACMPF
SDWAPARM EQU   SDWA
SVRBEND  EQU   RBSECT+192
RBFEPARM EQU   RBSECT+168
SIRBEND  EQU   RBSECT+168
RBRSV158 EQU   RBRSV150
RBRSV157 EQU   RBRSV150
RBRSV156 EQU   RBRSV150
RBRSV155 EQU   RBRSV150
RBRSV154 EQU   RBRSV150
RBRSV153 EQU   RBRSV150
RBRSV152 EQU   RBRSV150
RBRSV151 EQU   RBRSV150
RBRSV149 EQU   RBSECT+166
RBRSV148 EQU   RBSECT+164
RBRSV169 EQU   RBSDATA+3
RBSID    EQU   RBSDATA+2
RBSPKEY  EQU   RBSDATA+1
RBRSV168 EQU   RBSFLG3
RBSTERMO EQU   RBSFLG3
RBSBRNTR EQU   RBSFLG3
RBSPRNTR EQU   RBSFLG3
RBSCNCEL EQU   RBSFLG3
RBSRECRD EQU   RBSFLG3
RBSTERMI EQU   RBSFLG3
RBRSV167 EQU   RBSFLG3
RBSOWNRA EQU   RBSOWNR+1
RBSSUPER EQU   RBSFLGS2
RBSKEY0  EQU   RBSFLGS2
RBRSV166 EQU   RBSFLGS2
RBRSV165 EQU   RBSFLGS2
RBSINUSE EQU   RBSFLGS2
RBRSV164 EQU   RBSFLGS2
RBSXCTL2 EQU   RBSFLGS2
RBRSV163 EQU   RBSFLGS2
RBSPARMA EQU   RBSPARM+1
RBSHALT  EQU   RBSIOPRC
RBSNOIOP EQU   RBSIOPRC
RBSASYNC EQU   RBSFLGS1
RBRSV162 EQU   RBSFLGS1
RBSESTAE EQU   RBSFLGS1
RBSDUMMY EQU   RBSFLGS1
RBSSTAR  EQU   RBSFLGS1
RBSSTAI  EQU   RBSFLGS1
RBSEXIT  EQU   RBSCBB+4
RBSCHAIN EQU   RBSCBB
TIRBEND  EQU   @NM00035+8
PRBEND   EQU   @NM00035+8
RBRSV146 EQU   RBRSV138
RBRSV145 EQU   RBRSV138
RBRSV144 EQU   RBRSV138
RBRSV143 EQU   RBRSV138
RBRSV142 EQU   RBRSV138
RBRSV141 EQU   RBRSV138
RBRSV140 EQU   RBRSV138
RBRSV139 EQU   RBRSV138
RBRSV137 EQU   @NM00035+6
RBRSV136 EQU   @NM00035+4
RBRSV135 EQU   @NM00035
@NM00034 EQU   RBSECT+32
@NM00033 EQU   @NM00031+1
RBSCF    EQU   @NM00032
RBPGMQ1  EQU   RBPGMQ+1
@NM00030 EQU   RBPGMQ
@NM00029 EQU   RBSECT+16
@NM00028 EQU   @NM00024
@NM00027 EQU   @NM00024
RBIQETP  EQU   @NM00024
RBUSIQE  EQU   RBETXR
RBATTN   EQU   @NM00024
@NM00026 EQU   @NM00024
@NM00025 EQU   @NM00024
RBPMSVRB EQU   @NM00022
RBATNXIT EQU   @NM00022
@NM00023 EQU   @NM00022
RBWAITP  EQU   @NM00022
RBFNSVRB EQU   RBTRSVRB
RBFTP    EQU   @NM00022
RBSIZE   EQU   RBSECT+8
RBABOPSW EQU   RBSECT+4
RBPPSAV1 EQU   RBPPSAV+1
@NM00020 EQU   RBPPSAV
RBPRFXND EQU   RBPREFIX+64
RBINTCOD EQU   RBINTCDA+1
RBINLNTH EQU   RBINTCDA
RBWCSA   EQU   RBPREFIX+60
RBRSV004 EQU   RBPREFIX+57
RBSSSYN  EQU   RBFLAGS1
RBSCB    EQU   RBFLAGS1
RBLONGWT EQU   RBFLAGS1
RBASIR   EQU   RBFLAGS1
RBRSV159 EQU   RBFLAGS1
RBABEND  EQU   RBFLAGS1
RBXWAIT  EQU   RBFLAGS1
RBSLOCK  EQU   RBFLAGS1
RBRTRAN  EQU   RBRTPSW2+4
RBRTINCD EQU   RBRTICIL+2
RBRTILC  EQU   RBRTICIL+1
RBRSV160 EQU   RBRTICIL
RBRTPSW1 EQU   RBRTOPSW
RBRSV062 EQU   RBRSV054
RBRSV061 EQU   RBRSV054
RBRSV060 EQU   RBRSV054
RBRSV059 EQU   RBRSV054
RBRSV058 EQU   RBRSV054
RBRSV057 EQU   RBRSV054
RBRSV056 EQU   RBRSV054
RBRSV055 EQU   RBRSV054
RBRSV053 EQU   RBPREFIX+38
RBRSV052 EQU   RBPREFIX+36
RBRSV051 EQU   RBPREFIX+32
RBPRFXST EQU   RBPREFIX+32
RBRSV050 EQU   RBPREFIX+28
RBRSV049 EQU   RBRSV041
RBRSV048 EQU   RBRSV041
RBRSV047 EQU   RBRSV041
RBRSV046 EQU   RBRSV041
RBRSV045 EQU   RBRSV041
RBRSV044 EQU   RBRSV041
RBRSV043 EQU   RBRSV041
RBRSV042 EQU   RBRSV041
RBRSV040 EQU   RBPREFIX+26
RBRSV039 EQU   RBPREFIX+24
RBRSV038 EQU   RBPREFIX+20
RBRSV037 EQU   RBPREFIX+16
RBRSV036 EQU   RBRSV028
RBRSV035 EQU   RBRSV028
RBRSV034 EQU   RBRSV028
RBRSV033 EQU   RBRSV028
RBRSV032 EQU   RBRSV028
RBRSV031 EQU   RBRSV028
RBRSV030 EQU   RBRSV028
RBRSV029 EQU   RBRSV028
RBRSV027 EQU   RBRSV019
RBRSV026 EQU   RBRSV019
RBRSV025 EQU   RBRSV019
RBRSV024 EQU   RBRSV019
RBRSV023 EQU   RBRSV019
RBRSV022 EQU   RBRSV019
RBRSV021 EQU   RBRSV019
RBRSV020 EQU   RBRSV019
RBRSV018 EQU   RBPREFIX+13
RBRSV017 EQU   RBPREFIX+12
RBSRV016 EQU   RBPREFIX+11
RBRSV015 EQU   RBPREFIX+10
RBRSV014 EQU   RBPREFIX+8
RBRSV013 EQU   RBPREFIX+4
RBRSV012 EQU   RBPREFIX
RBEXSAVE EQU   XRBESA
XRBREG15 EQU   RBGRS15
XRBREG14 EQU   RBGRS14
XRBREG13 EQU   RBGRS13
XRBREG12 EQU   RBGRS12
XRBREG11 EQU   RBGRS11
XRBREG10 EQU   RBGRS10
XRBREG9  EQU   RBGRS9
XRBREG8  EQU   RBGRS8
XRBREG7  EQU   RBGRS7
XRBREG6  EQU   RBGRS6
XRBREG5  EQU   RBGRS5
XRBREG4  EQU   RBGRS4
XRBREG3  EQU   RBGRS3
XRBREG2  EQU   RBGRS2
XRBREG1  EQU   RBGRS1
XRBREG0  EQU   RBGRS0
XRBLNKA  EQU   RBLINKB
XRBWT    EQU   RBWCF
@NM00019 EQU   RBBASIC+24
RBOPSWPS EQU   RBOPSWB2
@NM00018 EQU   RBOPSWB2
@NM00017 EQU   XRBPSW
@NM00016 EQU   RBBASIC+12
XRBWAIT  EQU   RBECBWT
XRBFRRB  EQU   RBFDYN
@NM00015 EQU   XSTAB2
XRBACTV  EQU   RBFACTV
XRBTCBP  EQU   RBTCBNXT
@NM00014 EQU   XSTAB1
XRBCKPT  EQU   RBFTCKPT
@NM00013 EQU   XSTAB1
@NM00012 EQU   RBBASIC+8
@NM00011 EQU   RBEXRTNM+1
RBTMIND3 EQU   RBTMFLD
RBTMIND2 EQU   RBTMFLD
RBTMCMP  EQU   RBTMFLD
RBWLIM   EQU   RBTMFLD
RBRSV005 EQU   RBTMFLD
RBTMTOD  EQU   RBTMFLD
RBTMQUE  EQU   RBTMFLD
@NM00010 EQU   RBPRFX
CTGFLCHN EQU   CTGFL+12
CTGFLDNM EQU   CTGFL+8
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00009 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
CTGFVWKA EQU   CTGFV+88
CTGFVCPP EQU   CTGFVPWD
CTGFVNAM EQU   CTGFV+80
CTGFVUPG EQU   CTGFVGAT
CTGFVEXT EQU   CTGFVLMT
CTGFVLRS EQU   CTGFV+68
CTGFVBUF EQU   CTGFV+64
CTGFVATR EQU   CTGFV+60
CTGFVTTR EQU   CTGFVSPC
CTGFVRNG EQU   CTGFV+44
CTGFVCRE EQU   CTGFV+36
CTGFVEXP EQU   CTGFV+32
CTGFVOWN EQU   CTGFV+28
CTGFVSTY EQU   CTGFV+24
CTGFVIND EQU   CTGFV+16
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
CTGFVDCH EQU   CTGFV+4
@NM00008 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00007 EQU   CTGFVPRO
CTGFVROF EQU   CTGFVPRO
CTGFVRON EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
CTGCVCC  EQU   CTGCV+50
CTGCVVOL EQU   CTGCV
@NM00006 EQU   CTGVLX
CTGWAGB  EQU   CTGWA+12
CTGWAGCT EQU   CTGWA+10
CTGWAUCT EQU   CTGWA+8
CTGPSWD  EQU   CTGJSCB
@NM00004 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGNOFLD EQU   CTGPL+19
@NM00003 EQU   CTGDSORG
@NM00002 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGAM0   EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
@NM00001 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGUCRAX EQU   CTGGTNXT
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
*                                      END UNREFERENCED COMPONENTS
@RC00134 EQU   @RC00133
@RC00230 EQU   @RC00219
@RC00220 EQU   @RC00219
@RC00282 EQU   @EL00003
@RC00319 EQU   @EL00004
@RC00373 EQU   @EL00006
@RC00396 EQU   @EL00008
@RC00506 EQU   @EL00014
@RC00550 EQU   @EL00015
@RC00548 EQU   @EL00015
@RC00556 EQU   @EL00015
@RC00568 EQU   @EL00015
@RC00566 EQU   @EL00015
@RT00574 EQU   @EL00015
@PB00015 EQU   @EL00001
@RC00283 EQU   @RC00282
@RC00311 EQU   @RC00282
@RC00309 EQU   @RC00282
@RC00307 EQU   @RC00282
@RC00305 EQU   @RC00282
@RC00303 EQU   @RC00282
@RC00321 EQU   @RC00319
@RC00328 EQU   @RC00319
@RF00402 EQU   @RC00396
@PB00014 EQU   @PB00015
@RT00558 EQU   @RC00556
@RC00323 EQU   @RC00321
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IGC0002F,(C'PLS2338',0701,77259)

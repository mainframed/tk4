         TITLE 'IDA019RG--VSAM   I N D E X   C R E A T E               *
                        '
IDA019RG CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IDA019RG  78.172'                                 0001
IDAIST   DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00579-IDAIST)
         ENTRY IDAIST
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
         IDASVR14
*   RAMB=AMBLIX;                    /* SET RAMB TO INDEX SIDE        */
         L     @10,RPLDACB(,RRPL)                                  0163
         L     @10,ACBAMBL(,@10)                                   0163
         L     RAMB,AMBLIX(,@10)                                   0163
*   RWORK1=AMBIWA;                  /* RWORK1 - WORK AREA BASE       */
         L     RWORK1,AMBIWA(,RAMB)                                0164
*   ICWADD=RWORK1;                  /* ICWADD IN FIRST WORK AREA   0165
*                                      CONTAINS POINTER TO CURRENT 0165
*                                      W.A.                          */
         ST    RWORK1,ICWADD(,RWORK1)                              0165
*   ICWREQ=RPARM1;                  /* SAVE REQUEST TYPE             */
         STC   RPARM1,ICWREQ(,RWORK1)                              0166
*   IF PLHLRECL^>AMBLDTA->AMBDSB->AMDCINV/* IS LAST          @X04SVES*/
*       -LENGTH(IDACIDF)            /* RECORD A              @X04SVES*/
*       -LENGTH(IDARDF) THEN        /* SPANNED RECORD        @X04SVES*/
         L     @10,AMBLDTA(,@10)                                   0167
         L     @10,AMBDSB(,@10)                                    0167
         L     @10,AMDCINV(,@10)                                   0167
         SL    @10,@CF00199                                        0167
         C     @10,PLHLRECL(,RPLH)                                 0167
         BL    @RF00167                                            0167
*     ICWNOSEG=ZERO;                /* NO                    @X04SVES*/
         SLR   @10,@10                                             0168
         STH   @10,ICWNOSEG(,RWORK1)                               0168
*   ELSE                            /* YES                   @X04SVES*/
*     ICWNOSEG=PLHNOSEG;            /* SAVE NO. SEGS         @X04SVES*/
         B     @RC00167                                            0169
@RF00167 LH    @10,PLHNOSEG(,RPLH)                                 0169
         STH   @10,ICWNOSEG(,RWORK1)                               0169
*   IF ICWLN=ZERO THEN              /* IS THIS FIRST ENTRY           */
@RC00167 LH    @10,ICWLN(,RWORK1)                                  0170
         LTR   @10,@10                                             0170
         BNZ   @RF00170                                            0170
*     DO;                           /*                               */
*       ICWLN=ICWSS;                /* INITIALIZE WORKAREA LVL       */
         MVC   ICWLN(2,RWORK1),@CH00053                            0172
*       IF PLHARDB->ARDKR=ON THEN   /* IS THIS A KEY RANGE DS        */
         L     @10,PLHARDB(,RPLH)                                  0173
         TM    ARDKR(@10),B'10000000'                              0173
         BNO   @RF00173                                            0173
*         ICWKRDS=ON;               /* YES- SET FLAG IN WA           */
         OI    ICWKRDS(RWORK1),B'00000100'                         0174
*I01:                                                              0175
*       DO;                         /* IDACALL(IDAAQR)               */
@RF00173 DS    0H                                                  0175
I01      DS    0H                                                  0176
*         CALL IDAAQR;              /* EXIT TO IDAAQR                */
         L     @15,@CV00945                                        0176
         BALR  @14,@15                                             0176
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I01;                    /* OBTAIN AN RBA                 */
*       RESPECIFY                                                  0182
*        (RWORK1) RSTD;             /*                               */
*       CALL INTNEWRC;              /* GO INITIALIZE A BUFFER        */
         BAL   @14,INTNEWRC                                        0183
*       AMDNIL=ICWSS;               /* SET AMDSB NO. LVLS TO 1       */
         L     @10,AMBDSB(,RAMB)                                   0184
         MVC   AMDNIL(2,@10),@CH00053                              0184
*       AMDSSRBA=ICWCRBA;           /* SET SS RBA IN AMDSB           */
         L     @15,ICWCRBA(,RWORK1)                                0185
         ST    @15,AMDSSRBA(,@10)                                  0185
*       AMDHLRBA=ICWCRBA;           /* SET HI LVL RBA IN AMDSB       */
         ST    @15,AMDHLRBA(,@10)                                  0186
*       ICWKEY1L=AMDKEYLN;          /* SET KEY LEN FROM AMDSB        */
         LH    @00,AMDKEYLN(,@10)                                  0187
         STH   @00,ICWKEY1L(,RWORK1)                               0187
*       ICWNEST=AMDNEST;            /* MOVE NO. ENTRYS/SECT.         */
         LH    @10,AMDNEST(,@10)                                   0188
         STH   @10,ICWNEST(,RWORK1)                                0188
*     END;                          /* FROM AMDSB TO W.A.            */
*   IF ICWREQ=ZERO THEN             /* THIS A NORMAL REQUEST         */
@RF00170 CLI   ICWREQ(RWORK1),0                                    0190
         BNE   @RF00190                                            0190
*     DO;                           /* YES                           */
*       IF ICWENDRQ=ON THEN         /* IS THIS A CLOSE        SITUAT.*/
         TM    ICWENDRQ(RWORK1),B'00000001'                        0192
         BNO   @RF00192                                            0192
*         DO;                       /* YES                           */
*           RESPECIFY                                              0194
*            (R15) RSTD;            /*                               */
*           R15=ICWNOFIT;           /* SET RETURN CODE- NO FIT       */
         LA    R15,8                                               0195
*           RAMB=AMBLDTA;           /* RESTORE AMB REG               */
         L     @14,RPLDACB(,RRPL)                                  0196
         L     @14,ACBAMBL(,@14)                                   0196
         L     RAMB,AMBLDTA(,@14)                                  0196
*           CALL EXIT;              /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0197
*           RESPECIFY                                              0198
*            (R15) UNRSTD;          /*                               */
*         END;                      /*                               */
*       DO;                         /*                               */
@RF00192 DS    0H                                                  0201
*         RESPECIFY                                                0201
*          (RWORK2,                                                0201
*           RWORK3,                                                0201
*           RWORK4,                                                0201
*           RWORK5) RSTD;           /*                               */
*         RWORK4=ADDR(ICWKEY1);     /* POINT TO CURRENT KEY          */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0202
*         RWORK2=RWORK4+AMDKEYLN;   /* POINT TO PREVIOUS KEY         */
         L     @10,AMBDSB(,RAMB)                                   0203
         LR    RWORK2,RWORK4                                       0203
         AH    RWORK2,AMDKEYLN(,@10)                               0203
*         RWORK3=ICWKEY1L;          /* SET MOVE LENGTH EQUAL         */
         LH    RWORK3,ICWKEY1L(,RWORK1)                            0204
*         RWORK5=RWORK3;            /* TO LENGTH OF KEY              */
         LR    RWORK5,RWORK3                                       0205
*         GEN(MVCL  RWORK2,RWORK4); /* REPLACE PREVIOUS KEY          */
         MVCL  RWORK2,RWORK4
*         RWORK2=ADDR(ICWKEY1);     /* POINT TO CURR KEY AREA        */
         LA    RWORK2,ICWKEY1(,RWORK1)                             0207
*         RWORK4=ADDR(PLHKEY);      /* POINT TO KEY IN PLH           */
         L     RWORK4,PLHKEYPT(,RPLH)                              0208
*         RWORK3=AMDKEYLN;          /* GET KEY LENGTH                */
         L     @10,AMBDSB(,RAMB)                                   0209
         LH    RWORK3,AMDKEYLN(,@10)                               0209
*         RWORK5=RWORK3;            /* SAME LENGTH IN RWORK5         */
         LR    RWORK5,RWORK3                                       0210
*         GEN(MVCL  RWORK2,RWORK4); /* MOVE KEY TO WORK AREA         */
         MVCL  RWORK2,RWORK4
*         RESPECIFY                                                0212
*          (RWORK2,                                                0212
*           RWORK3,                                                0212
*           RWORK4,                                                0212
*           RWORK5) UNRSTD;         /*                               */
*         ICWKEY2L=ICWKEY1L;        /* CURRENT LEN.TO PREV LEN       */
         LH    @10,ICWKEY1L(,RWORK1)                               0213
         STH   @10,ICWKEY2L(,RWORK1)                               0213
*         CALL IDAIST;              /* GO INSERT KEY IN RECORD       */
         L     @15,@CA00988                                        0214
         BALR  @14,@15                                             0214
*         RESPECIFY                                                0215
*          (R15) RSTD;              /*                               */
*         IF ICWWNF=ON THEN         /* DID THE RECORD FIT            */
         TM    ICWWNF(RWORK1),B'10000000'                          0216
         BNO   @RF00216                                            0216
*           R15=ICWNOFIT;           /* NO, SET RETURN CODE           */
         LA    R15,8                                               0217
*         ELSE                      /* YES, RECORD FIT SO            */
*           R15=ZERO;               /* CLEAR RETURN REGISTER         */
         B     @RC00216                                            0218
@RF00216 SLR   R15,R15                                             0218
*         RAMB=AMBLDTA;             /* RESET AMB FOR CALLER          */
@RC00216 L     @14,RPLDACB(,RRPL)                                  0219
         L     @14,ACBAMBL(,@14)                                   0219
         L     RAMB,AMBLDTA(,@14)                                  0219
*         CALL EXIT;                /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0220
*         RESPECIFY                                                0221
*          (R15) UNRSTD;            /*                               */
*       END;                        /*                               */
*     END;                          /*                               */
*   ELSE                            /*                               */
*     IF ICWREQ=ICWCLOSE THEN       /* IS THIS A CLOSE REQUEST       */
         B     @RC00190                                            0224
@RF00190 CLI   ICWREQ(RWORK1),8                                    0224
         BNE   @RF00224                                            0224
*       DO;                         /* YES                           */
*         RESPECIFY                                                0226
*          (RWORK1,                                                0226
*           RWORK2) RSTD;           /*                               */
*         RWORK2=ICWBUFC->BUFCBAD;  /* POINT TO BUFFER               */
         L     @10,ICWBUFC(,RWORK1)                                0227
         L     RWORK2,BUFCBAD(,@10)                                0227
*         IF ICWENDRQ=OFF THEN      /* FIRST ENTRY AT CLOSE          */
         TM    ICWENDRQ(RWORK1),B'00000001'                        0228
         BNZ   @RF00228                                            0228
*           DO;                     /* YES                           */
*             RESPECIFY                                            0230
*               RWORK0 RSTD;        /*                       @X04SVES*/
*             IF ICWNOSEG^=ZERO THEN/* SPANNED RECD          @X04SVES*/
         LH    @10,ICWNOSEG(,RWORK1)                               0231
         LTR   @10,@10                                             0231
         BZ    @RF00231                                            0231
*               RWORK0=(RWORK2->IXHFLPLN)*/* YES, COMPUTE    @X04SVES*/
*                   (ICWNOSEG-ONE); /* SPACE FOR IT          @X04SVES*/
         BCTR  @10,0                                               0232
         LR    @09,@10                                             0232
         SLR   RWORK0,RWORK0                                       0232
         IC    RWORK0,IXHFLPLN(,RWORK2)                            0232
         MR    @08,RWORK0                                          0232
         LR    RWORK0,@09                                          0232
*             ELSE                  /* NO                    @X04SVES*/
*               RWORK0=ZERO;        /* NO SPACE REQD         @X04SVES*/
         B     @RC00231                                            0233
@RF00231 SLR   RWORK0,RWORK0                                       0233
*             IF(RWORK2->IXHLEO-RWORK2->IXHFSO/* IS THERE ROOM FOR   */
*                 -LENGTH(IXSELL))<ICWKEY1L/* AN UNCOMPRESSED KEY    */
*                 +RWORK0 THEN      /* AND SPN RCD           @X04SVES*/
@RC00231 LH    @10,IXHLEO(,RWORK2)                                 0234
         SH    @10,IXHFSO(,RWORK2)                                 0234
         BCTR  @10,0                                               0234
         BCTR  @10,0                                               0234
         LR    @07,RWORK0                                          0234
         LH    @15,ICWKEY1L(,RWORK1)                               0234
         ALR   @07,@15                                             0234
         CLR   @10,@07                                             0234
         BNL   @RF00234                                            0234
*               DO;                 /* NO                            */
*                 RESPECIFY                                        0236
*                   RWORK0 UNRSTD;  /*                       @X04SVES*/
*                 RESPECIFY                                        0237
*                  (R15) RSTD;      /*                               */
*                 R15=ICWNOFIT;     /* SET WONT FIT INDICATION       */
         LA    R15,8                                               0238
*                 ICWENDRQ=ON;      /* SET FLAG                      */
         OI    ICWENDRQ(RWORK1),B'00000001'                        0239
*                 RAMB=AMBLDTA;     /* RESTORE AMB REGISTER          */
         L     @14,RPLDACB(,RRPL)                                  0240
         L     @14,ACBAMBL(,@14)                                   0240
         L     RAMB,AMBLDTA(,@14)                                  0240
*                 CALL EXIT;        /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0241
*                 RESPECIFY                                        0242
*                  (R15) UNRSTD;    /*                               */
*               END;                /*                               */
*           END;                    /*                               */
*         ELSE                      /* NOT FIRST CLOSE ENTRY         */
*           ICWENDRQ=OFF;           /* RESET FLAG                    */
         B     @RC00228                                            0245
@RF00228 NI    ICWENDRQ(RWORK1),B'11111110'                        0245
*         IF ICWVSE=OFF&ICWVNE=OFF THEN/* HAS ANY ENTRY BEEN MADE IN
*                                      THIS RECORD BESIDES THE DUMMY */
@RC00228 TM    ICWVSE(RWORK1),B'00011000'                          0246
         BNZ   @RF00246                                            0246
*           CALL SETBASE;           /* SET BASE RBA          @X04SVES*/
         BAL   @14,SETBASE                                         0247
*         IF ICWNOSEG^=ZERO THEN    /* LAST RCD SPN          @X04SVES*/
@RF00246 LH    @10,ICWNOSEG(,RWORK1)                               0248
         LTR   @10,@10                                             0248
         BZ    @RF00248                                            0248
*           DO ICWCRSEG=ONE TO ICWNOSEG-ONE;/* YES           @X04SVES*/
         LA    @10,1                                               0249
         B     @DE00249                                            0249
@DL00249 DS    0H                                                  0250
*I02:                                                              0250
*             DO;                   /* IDACALL(IDASPNPT)             */
I02      DS    0H                                                  0251
*               CALL IDASPNPT;      /* EXIT TO IDASPNPT              */
         L     @15,@CV00950                                        0251
         BALR  @14,@15                                             0251
*               GEN(BALR @11,0);    /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*               GEN(USING *,@11);   /* ESTABLISH ADDRESSING          */
         USING *,@11
*               GEN(L     @11,=A(@PSTART));/* RELOAD BASE            */
         L     @11,=A(@PSTART)
*               GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING       */
         USING @PSTART,@11
*             END I02;              /* MAKE SR ENTRY         @X04SVES*/
*           END;                    /*                       @X04SVES*/
         LA    @10,1                                               0257
         AH    @10,ICWCRSEG(,RWORK1)                               0257
@DE00249 STH   @10,ICWCRSEG(,RWORK1)                               0257
         LH    @07,ICWNOSEG(,RWORK1)                               0257
         BCTR  @07,0                                               0257
         CR    @10,@07                                             0257
         BNH   @DL00249                                            0257
*I03:                                                              0258
*         DO;                       /* IDACALL(IDAWR)                */
@RF00248 DS    0H                                                  0258
I03      DS    0H                                                  0259
*           CALL IDAWR;             /* EXIT TO IDAWR                 */
         L     @15,@CV00951                                        0259
         BALR  @14,@15                                             0259
*           GEN(BALR @11,0);        /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*           GEN(USING *,@11);       /* ESTABLISH ADDRESSING          */
         USING *,@11
*           GEN(L     @11,=A(@PSTART));/* RELOAD BASE                */
         L     @11,=A(@PSTART)
*           GEN(USING @PSTART,@11); /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*         END I03;                  /* GO WRITE OUT THE BUFFER       */
*         RESPECIFY                                                0265
*          (RWORK1,                                                0265
*           RWORK2) RSTD;           /*                               */
*         DO RWORK2=1 TO AMDNIL;    /* LOOP COVERS ALL LEVELS        */
         LA    RWORK2,1                                            0266
         B     @DE00266                                            0266
@DL00266 DS    0H                                                  0267
*           RPARM1=ICWCHN;          /* SAVE NEXT LEVEL               */
         L     RPARM1,ICWCHN(,RWORK1)                              0267
*           IF ICWWAGM=ON THEN      /* DID WE BUILD THE WA           */
         TM    ICWWAGM(RWORK1),B'01000000'                         0268
         BNO   @RF00268                                            0268
*             DO;                   /* YES                           */
*               RESPECIFY                                          0270
*                (RWORK0) RSTD;     /*                               */
*               R1=RWORK1;          /* POINT TO WORK AREA            */
         LR    R1,RWORK1                                           0271
*               RWORK0=ICWLEN;      /* SET LENGTH OF WORK AREA       */
         LH    RWORK0,ICWLEN(,RWORK1)                              0272
*               GEN(FREEMAIN R,LV=(0),A=(1));/* FREE WORK AREA SPACE */
         FREEMAIN R,LV=(0),A=(1)
*               RRPL=PLHCRPL;       /* RESTORE RPL REGISTER          */
         L     RRPL,PLHCRPL(,RPLH)                                 0274
*               RESPECIFY                                          0275
*                (RWORK0) UNRSTD;   /*                               */
*             END;                  /*                               */
*           RWORK1=RPARM1;          /* MOVE TO NEXT WA LEVEL         */
@RF00268 LR    RWORK1,RPARM1                                       0277
*         END;                      /*                               */
         AL    RWORK2,@CF00053                                     0278
@DE00266 L     @10,AMBDSB(,RAMB)                                   0278
         LH    @10,AMDNIL(,@10)                                    0278
         CLR   RWORK2,@10                                          0278
         BNH   @DL00266                                            0278
*         RWORK1=AMBIWA;            /* POINT BACK TO LVL ONE         */
         L     RWORK1,AMBIWA(,RAMB)                                0279
*         RAMB=AMBLDTA;             /* RESET AMB FOR CALLER          */
         L     @10,RPLDACB(,RRPL)                                  0280
         L     @10,ACBAMBL(,@10)                                   0280
         L     RAMB,AMBLDTA(,@10)                                  0280
*         RESPECIFY                                                0281
*          (R15) RSTD;              /*                               */
*         R15=ZERO;                 /* CLEAR RETURN REG              */
         SLR   R15,R15                                             0282
*         CALL EXIT;                /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0283
*         RESPECIFY                                                0284
*          (RWORK2,                                                0284
*           R15) UNRSTD;            /*                               */
*       END;                        /* ENTRY REQUESTS BUFFER BE    0285
*                                      WRITTEN OUT AND UPPER LEVELS
*                                      OF INDEX UPDATED IF NECESSARY */
*I04:                                                              0286
*   DO;                             /* IDACALL(IDAWR)                */
@RF00224 DS    0H                                                  0286
@RC00190 DS    0H                                                  0286
I04      DS    0H                                                  0287
*     CALL IDAWR;                   /* EXIT TO IDAWR                 */
         L     @15,@CV00951                                        0287
         BALR  @14,@15                                             0287
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I04;                        /* WRITE OUT INDEX RECORD        */
*   RESPECIFY                                                      0293
*    (RWORK1) RSTD;                 /*                               */
*ICA5:                              /*                               */
*I05:                                                              0294
*   DO;                             /* IDACALL(IDAAQR)               */
ICA5     DS    0H                                                  0294
I05      DS    0H                                                  0295
*     CALL IDAAQR;                  /* EXIT TO IDAAQR                */
         L     @15,@CV00945                                        0295
         BALR  @14,@15                                             0295
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I05;                        /* GET AN RBA                    */
*   RESPECIFY                                                      0301
*    (RWORK1) RSTD;                 /*                               */
*   CALL INTNEWRC;                  /* INITIALIZE A BUFFER           */
         BAL   @14,INTNEWRC                                        0302
*   IF ICWREQ^=ZERO THEN            /* IS THIS 1ST TIME HERE         */
         CLI   ICWREQ(RWORK1),0                                    0303
         BE    @RF00303                                            0303
*     DO;                           /* YES                           */
*       ICWREQ=ZERO;                /* AVOID THIS ON NEXT TIME       */
         MVI   ICWREQ(RWORK1),X'00'                                0305
*       RESPECIFY                                                  0306
*        (RWORK2) RSTD;             /*                               */
*       RWORK2=ICWBUFC->BUFCBAD;    /* POINT TO INDEX BUFFER         */
         L     @10,ICWBUFC(,RWORK1)                                0307
         L     RWORK2,BUFCBAD(,@10)                                0307
*       CALL SETBASE;               /* SET BASE RBA          @X04SVES*/
         BAL   @14,SETBASE                                         0308
*     END;                          /*                               */
*   ELSE                            /*                               */
*     CALL IDAIST;                  /* PLACE ENTRY WHICH DID NOT FIT */
         B     @RC00303                                            0310
@RF00303 L     @15,@CA00988                                        0310
         BALR  @14,@15                                             0310
*I06:                                                              0311
*   DO;                             /* IDACALL(IDAWR)                */
@RC00303 DS    0H                                                  0311
I06      DS    0H                                                  0312
*     CALL IDAWR;                   /* EXIT TO IDAWR                 */
         L     @15,@CV00951                                        0312
         BALR  @14,@15                                             0312
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I06;                        /* WRITE OUT THE RECORD          */
*   RESPECIFY                                                      0318
*    (RWORK1) RSTD;                 /*                               */
*   RPARM1=ICWPRBA;                 /* PICK UP RBA OF PREVIOUS       */
         L     RPARM1,ICWPRBA(,RWORK1)                             0319
*I07:                                                              0320
*   DO;                             /* IDACALL(IDAR)                 */
I07      DS    0H                                                  0321
*     CALL IDAR;                    /* EXIT TO IDAR                  */
         L     @15,@CV00949                                        0321
         BALR  @14,@15                                             0321
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I07;                        /* INDEX RECD, READ IT           */
*   RESPECIFY                                                      0327
*    (RWORK1,                                                      0327
*     RWORK2) RSTD;                 /*                               */
*   RWORK2=ICWBUFC->BUFCBAD;        /* POINT TO BUFFER               */
         L     @10,ICWBUFC(,RWORK1)                                0328
         L     RWORK2,BUFCBAD(,@10)                                0328
*   RWORK2->IXHHP=ICWCRBA;          /* SET HORIZ. PTR. IN HDR.       */
         L     @10,ICWCRBA(,RWORK1)                                0329
         ST    @10,IXHHP(,RWORK2)                                  0329
*I08:                                                              0330
*   DO;                             /* IDACALL(IDAER)                */
I08      DS    0H                                                  0331
*     CALL IDAER;                   /* EXIT TO IDAER                 */
         L     @15,@CV00952                                        0331
         BALR  @14,@15                                             0331
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I08;                        /* GO ERASE DUMMY ENTRY          */
*I09:                                                              0337
*   DO;                             /* IDACALL(IDAWR)                */
I09      DS    0H                                                  0338
*     CALL IDAWR;                   /* EXIT TO IDAWR                 */
         L     @15,@CV00951                                        0338
         BALR  @14,@15                                             0338
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I09;                        /* THEN GO WRITE IT              */
*   RESPECIFY                                                      0344
*    (RWORK1) RSTD;                 /*                               */
*   IF ICWLN=AMDNIL THEN            /* IS THIS TOP INDEX LEVEL       */
         L     @10,AMBDSB(,RAMB)                                   0345
         CLC   ICWLN(2,RWORK1),AMDNIL(@10)                         0345
         BNE   @RF00345                                            0345
*     DO;                           /* YES                           */
*       IF ICWCHN=ZERO THEN         /* IS THERE A WORKAREA AT NEXT 0347
*                                      HIGHER LEVEL                  */
         L     @10,ICWCHN(,RWORK1)                                 0347
         LTR   @10,@10                                             0347
         BNZ   @RF00347                                            0347
*         DO;                       /* NO                            */
*           RESPECIFY                                              0349
*            (RWORK2,                                              0349
*             R15) RSTD;            /*                               */
*           RPARM1=ICWLEN;          /* SET LENGTH OF WORK AREA       */
         LH    RPARM1,ICWLEN(,RWORK1)                              0350
*           RWORK2=ADDR(ICWCHN);    /* POINT TO CHAIN FIELD          */
         LA    RWORK2,ICWCHN(,RWORK1)                              0351
*           R1=ADDR(PLHSAVE1);      /* POINT TO PARAM. AREA          */
         LA    R1,PLHSAVE1(,RPLH)                                  0352
*           GEN(GETMAIN EC,LV=(RPARM1),A=(RWORK2),SP=0,MF=(E,(1)));/**/
         GETMAIN EC,LV=(RPARM1),A=(RWORK2),SP=0,MF=(E,(1))
*           IF R15^=ZERO THEN       /* WAS SPACE AVAILABLE           */
         LTR   R15,R15                                             0354
         BZ    @RF00354                                            0354
*             DO;                   /* NO                            */
*               RPLERREG='08'X;     /*                               */
         MVI   RPLERREG(RRPL),X'08'                                0356
*               RPLERRCD=RPLNOVRT;  /*                               */
         MVI   RPLERRCD(RRPL),X'28'                                0357
*               R15=IOERR;          /* SET REG 15 TO ERROR           */
         LA    R15,4                                               0358
*               RAMB=AMBLDTA;       /* RESTORE AMB REG TO DATA       */
         L     @14,RPLDACB(,RRPL)                                  0359
         L     @14,ACBAMBL(,@14)                                   0359
         L     RAMB,AMBLDTA(,@14)                                  0359
*               CALL EXIT;          /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0360
*               RESPECIFY                                          0361
*                (R15) UNRSTD;      /*                               */
*             END;                  /*                               */
*           RESPECIFY                                              0363
*            (RWORK3,                                              0363
*             RWORK4,                                              0363
*             RWORK5) RSTD;         /*                               */
@RF00354 DS    0H                                                  0364
*           RWORK2=ICWCHN;          /* POINT TO NEW BLOCK            */
         L     RWORK2,ICWCHN(,RWORK1)                              0364
*           RWORK5=ZERO;            /* SET PADDING CHARACTER         */
         SLR   RWORK5,RWORK5                                       0365
*           RWORK3=ICWLEN;          /* SET LENGTH                    */
         LH    RWORK3,ICWLEN(,RWORK1)                              0366
*           GEN(MVCL RWORK2,RWORK4);/* CLEAR THE BLOCK               */
         MVCL RWORK2,RWORK4
*           RESPECIFY                                              0368
*            (RWORK2,                                              0368
*             RWORK3,                                              0368
*             RWORK4,                                              0368
*             RWORK5) UNRSTD;       /*                               */
*           R1=ICWCHN;              /* BASE TO NEW WORK AREA         */
         L     R1,ICWCHN(,RWORK1)                                  0369
*           R1->ICWWAGM=ON;         /* MARK AS NOT AN OPEN BLK       */
         OI    ICWWAGM(R1),B'01000000'                             0370
*           R1->ICWLEN=ICWLEN;      /* SET LENGTH FIELD IN WA        */
         LH    @10,ICWLEN(,RWORK1)                                 0371
         STH   @10,ICWLEN(,R1)                                     0371
*           R1->ICWID=ICWID;        /* SET ID FIELD IN WA            */
         MVC   ICWID(1,R1),ICWID(RWORK1)                           0372
*           RRPL=PLHCRPL;           /* RESTORE RPL REGISTER          */
         L     RRPL,PLHCRPL(,RPLH)                                 0373
*         END;                      /*                               */
*     END;                          /*                               */
@RF00347 DS    0H                                                  0376
*   RESPECIFY                                                      0376
*    (RWORK2,                                                      0376
*     RWORK3) RSTD;                 /*                               */
@RF00345 DS    0H                                                  0377
*   RWORK2=ICWLN;                   /* SAVE LEVEL NO.                */
         LH    RWORK2,ICWLN(,RWORK1)                               0377
*   RWORK1=ICWCHN;                  /* MOVE TO NEXT LEVEL            */
         L     RWORK1,ICWCHN(,RWORK1)                              0378
*   RWORK3=AMBIWA;                  /* ADDRESS TO LVL 1 WA           */
         L     RWORK3,AMBIWA(,RAMB)                                0379
*   RWORK3->ICWADD=RWORK1;          /* SET NEW CURRENT LVL           */
         ST    RWORK1,ICWADD(,RWORK3)                              0380
*   IF ICWLN=ZERO THEN              /* WAS WA PREVIOUSLY USED        */
         LH    @10,ICWLN(,RWORK1)                                  0381
         LTR   @10,@10                                             0381
         BNZ   @RF00381                                            0381
*     DO;                           /* NO                            */
*       ICWLN=RWORK2+ONE;           /* PUT IN NEW LEVEL NO.          */
         LA    @10,1                                               0383
         ALR   @10,RWORK2                                          0383
         STH   @10,ICWLN(,RWORK1)                                  0383
*       RESPECIFY                                                  0384
*        (RWORK2,                                                  0384
*         RWORK3) UNRSTD;           /*                               */
*       ICWNEST=AMDNEST;            /* INITIALIZE NO. ENTRYS PER   0385
*                                      SECTION                       */
         L     @15,AMBDSB(,RAMB)                                   0385
         LH    @00,AMDNEST(,@15)                                   0385
         STH   @00,ICWNEST(,RWORK1)                                0385
*       AMDNIL=ICWLN;               /* SHOW HI LEVEL IN AMDSB        */
         STH   @10,AMDNIL(,@15)                                    0386
*I10:                                                              0387
*       DO;                         /* IDACALL(IDAAQR)               */
I10      DS    0H                                                  0388
*         CALL IDAAQR;              /* EXIT TO IDAAQR                */
         L     @15,@CV00945                                        0388
         BALR  @14,@15                                             0388
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I10;                    /*                               */
*       RESPECIFY                                                  0394
*        (RWORK1) RSTD;             /*                               */
*       CALL INTNEWRC;              /* GO INITIALIZE A NEW BUF       */
         BAL   @14,INTNEWRC                                        0395
*       AMDHLRBA=ICWCRBA;           /* SET HI LVL RBA IN AMDSB       */
         L     @10,AMBDSB(,RAMB)                                   0396
         L     @00,ICWCRBA(,RWORK1)                                0396
         ST    @00,AMDHLRBA(,@10)                                  0396
*       IF AMBLCAT=OFF THEN         /* CREATING CATALOG              */
         L     @10,RPLDACB(,RRPL)                                  0397
         L     @10,ACBAMBL(,@10)                                   0397
         TM    AMBLCAT(@10),B'00000010'                            0397
         BNZ   @RF00397                                            0397
*         DO;                       /* NO                            */
*           PLHEOVR=AMBEOVUC;       /* SET CODE TO UPDATE THE CATALOG*/
         MVI   PLHEOVR(RPLH),B'00000100'                           0399
*I11:                                                              0400
*           DO;                     /* IDACALL(IDAEOVIF)             */
I11      DS    0H                                                  0401
*             CALL IDAEOVIF;        /* EXIT TO IDAEOVIF              */
         L     @15,@CV00946                                        0401
         BALR  @14,@15                                             0401
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */
         USING *,@11
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */
         L     @11,=A(@PSTART)
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */
         USING @PSTART,@11
*           END I11;                /* AND GO TO END OF VOL.         */
*           RFY                                                    0407
*            (RWORK1,                                              0407
*             RWORK2) RSTD;         /*                       @X04SVES*/
*           RWORK1=AMBIWA;          /* POINT TO FIRST WORK AREA    0408
*                                                            @X04SVES*/
         L     RWORK1,AMBIWA(,RAMB)                                0408
*           RWORK2=ICWADD;          /* PICK UP CURRENT POINTER     0409
*                                                            @X04SVES*/
         L     RWORK2,ICWADD(,RWORK1)                              0409
*           RWORK1=RWORK2;          /* REESTABLISH BASE OF WORK AREA
*                                                            @X04SVES*/
         LR    RWORK1,RWORK2                                       0410
*           RFY                                                    0411
*             RWORK2 RSTD;          /*                       @X04SVES*/
*         END;                      /*                               */
*     END;                          /*                               */
*   ELSE                            /* A RECORD WAS WRITTEN          */
*     DO;                           /* AT THIS LEVEL                 */
         B     @RC00381                                            0414
@RF00381 DS    0H                                                  0415
*       RPARM1=ICWCRBA;             /* GET CURRENT RECORD RBA        */
         L     RPARM1,ICWCRBA(,RWORK1)                             0415
*I12:                                                              0416
*       DO;                         /* IDACALL(IDAR)                 */
I12      DS    0H                                                  0417
*         CALL IDAR;                /* EXIT TO IDAR                  */
         L     @15,@CV00949                                        0417
         BALR  @14,@15                                             0417
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I12;                    /* AND READ IT                   */
*       RESPECIFY                                                  0423
*        (RWORK1,                                                  0423
*         RWORK2,                                                  0423
*         RWORK3,                                                  0423
*         RWORK4,                                                  0423
*         RWORK5) RSTD;             /*                               */
*       RWORK4=ADDR(ICWKEY1);       /* SET 'FROM' TO PRES. KEY       */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0424
*       RWORK2=RWORK4+AMDKEYLN;     /* SET 'TO' TO PREV. KEY         */
         L     @10,AMBDSB(,RAMB)                                   0425
         LR    RWORK2,RWORK4                                       0425
         AH    RWORK2,AMDKEYLN(,@10)                               0425
*       RWORK3=ICWKEY1L;            /* SET LENGTH OF KEY             */
         LH    RWORK3,ICWKEY1L(,RWORK1)                            0426
*       ICWKEY2L=RWORK3;            /* PRES. LEN. TO PREV. LEN       */
         STH   RWORK3,ICWKEY2L(,RWORK1)                            0427
*       RWORK5=RWORK3;              /*                               */
         LR    RWORK5,RWORK3                                       0428
*       GEN(MVCL  RWORK2,RWORK4);   /* MOVE PRES. TO PREVIOUS        */
         MVCL  RWORK2,RWORK4
*       ICWCERP=ICWCER;             /* SAVE REAR COMPRESSION         */
         IC    @10,ICWCER(,RWORK1)                                 0430
         STC   @10,ICWCERP(,RWORK1)                                0430
*       RESPECIFY                                                  0431
*        (RWORK2,                                                  0431
*         RWORK3,                                                  0431
*         RWORK4,                                                  0431
*         RWORK5) UNRSTD;           /*                               */
*     END;                          /*                               */
*   RPARM1=AMBIWA;                  /* POINT TO LOWEST LEVEL         */
@RC00381 L     RPARM1,AMBIWA(,RAMB)                                0433
*   DO WHILE RPARM1->ICWLN^=ICWLN-ONE;/* FIND NEXT LOWER WA          */
         B     @DE00434                                            0434
@DL00434 DS    0H                                                  0435
*     RPARM1=RPARM1->ICWCHN;        /* RPARM1 WILL ADDRESS THE       */
         L     RPARM1,ICWCHN(,RPARM1)                              0435
*   END;                            /* WA AT THE LOWER LEVEL         */
@DE00434 LH    @10,ICWLN(,RWORK1)                                  0436
         BCTR  @10,0                                               0436
         CH    @10,ICWLN(,RPARM1)                                  0436
         BNE   @DL00434                                            0436
*   RESPECIFY                                                      0437
*    (RWORK0,                                                      0437
*     RWORK2,                                                      0437
*     RWORK3,                                                      0437
*     RWORK4,                                                      0437
*     RWORK5) RSTD;                 /*                               */
*   RWORK0=ZERO;                    /*                               */
         SLR   RWORK0,RWORK0                                       0438
*   RWORK2=RWORK1;                  /* POINT RWORK1 AT THE           */
         LR    RWORK2,RWORK1                                       0439
*   RWORK1=RPARM1;                  /* LOWER LEVEL                   */
         LR    RWORK1,RPARM1                                       0440
*   IF ICWWNF=ON THEN               /* IS THIS A NO FIT CASE         */
         TM    ICWWNF(RWORK1),B'10000000'                          0441
         BNO   @RF00441                                            0441
*     DO;                           /* YES                           */
*       RWORK0=AMDKEYLN;            /* SET FOR PREVIOUS KEY          */
         L     @10,AMBDSB(,RAMB)                                   0443
         LH    RWORK0,AMDKEYLN(,@10)                               0443
*       RWORK5=ICWCERP;             /* GET LENGTH OF PREV. KEY       */
         SLR   RWORK5,RWORK5                                       0444
         IC    RWORK5,ICWCERP(,RWORK1)                             0444
*       ICWWNF=OFF;                 /* HOUSEKEEP FLAG                */
         NI    ICWWNF(RWORK1),B'01111111'                          0445
*     END;                          /*                               */
*   ELSE                            /* NOT A NO FIT CASE             */
*     RWORK5=ICWCER;                /* SET LENGTH OF CURR. KEY       */
         B     @RC00441                                            0447
@RF00441 SLR   RWORK5,RWORK5                                       0447
         IC    RWORK5,ICWCER(,RWORK1)                              0447
*   RWORK4=ADDR(ICWKEY1)+RWORK0;    /* SET 'FROM' ADDRESS            */
@RC00441 LA    RWORK4,ICWKEY1(,RWORK1)                             0448
         ALR   RWORK4,RWORK0                                       0448
*   RESPECIFY                                                      0449
*    (RWORK0) UNRSTD;               /*                               */
*   RWORK1=RWORK2;                  /* SET RWORK1 TO CURR. LVL       */
         LR    RWORK1,RWORK2                                       0450
*   RWORK2=ADDR(ICWKEY1);           /* TO ADD. = CURR. PRES          */
         LA    RWORK2,ICWKEY1(,RWORK1)                             0451
*   RWORK3=RWORK5;                  /* SET LENGTH                    */
         LR    RWORK3,RWORK5                                       0452
*   ICWKEY1L=RWORK5;                /* SET KEY LENGTH IN WA          */
         STH   RWORK5,ICWKEY1L(,RWORK1)                            0453
*   GEN(MVCL  RWORK2,RWORK4);       /* MOVE KEY UP ONE LVL           */
         MVCL  RWORK2,RWORK4
*   RESPECIFY                                                      0455
*    (RWORK2,                                                      0455
*     RWORK3,                                                      0455
*     RWORK4,                                                      0455
*     RWORK5) UNRSTD;               /*                               */
*   CALL IDAIST;                    /* PLACE ENTRY IN BUFFER         */
         L     @15,@CA00988                                        0456
         BALR  @14,@15                                             0456
*   IF ICWWNF=ON THEN               /* DID THE ENTRY FIT             */
         TM    ICWWNF(RWORK1),B'10000000'                          0457
         BNO   @RF00457                                            0457
*     DO;                           /* NO                            */
*       ICWBUFC->BUFCMW=OFF;        /* TURN OFF MUST WRITE FLG       */
         L     @10,ICWBUFC(,RWORK1)                                0459
         NI    BUFCMW(@10),B'01111111'                             0459
*I13:                                                              0460
*       DO;                         /* IDACALL(IDAFREEB)             */
I13      DS    0H                                                  0461
*         CALL IDAFREEB;            /* EXIT TO IDAFREEB              */
         L     @15,@CV00947                                        0461
         BALR  @14,@15                                             0461
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I13;                    /* FREE THE BFR          @X04SVLP*/
*       RESPECIFY                                                  0467
*        (RWORK1,                                                  0467
*         RWORK2) RSTD;             /*                               */
*       RWORK1=AMBIWA;              /* FIRST ICWA            @X04SVES*/
         L     RWORK1,AMBIWA(,RAMB)                                0468
*       RWORK2=ICWADD;              /* OBTAIN CURRENT ICWA   @X04SVES*/
         L     RWORK2,ICWADD(,RWORK1)                              0469
*       RWORK1=RWORK2;              /* SET BASE              @X04SVES*/
         LR    RWORK1,RWORK2                                       0470
*       RESPECIFY                                                  0471
*         RWORK2 UNRSTD;            /*                       @X04SVES*/
*       GO TO ICA5;                 /* BACK TO MOVE UP A LEVEL       */
         B     ICA5                                                0472
*     END;                                                         0473
*   ELSE                            /* THE RECORD FIT                */
*     DO;                           /*                               */
@RF00457 DS    0H                                                  0475
*I14:                                                              0475
*       DO;                         /* IDACALL(IDAWR)                */
I14      DS    0H                                                  0476
*         CALL IDAWR;               /* EXIT TO IDAWR                 */
         L     @15,@CV00951                                        0476
         BALR  @14,@15                                             0476
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I14;                    /* WRITE OUT THE RECORD          */
*       RESPECIFY                                                  0482
*        (RWORK1) RSTD;             /*                               */
*       RWORK1=AMBIWA;              /* POINT BACK TO SS LEVEL        */
         L     RWORK1,AMBIWA(,RAMB)                                0483
*       ICWADD=RWORK1;              /* SAVE LEVEL                    */
         ST    RWORK1,ICWADD(,RWORK1)                              0484
*       CALL INTNEWRC;              /* GET AND INIT A BUFFER         */
         BAL   @14,INTNEWRC                                        0485
*       RESPECIFY                                                  0486
*        (R15) RSTD;                /*                               */
*       R15=ZERO;                   /*                               */
         SLR   R15,R15                                             0487
*       RAMB=AMBLDTA;               /*                               */
         L     @14,RPLDACB(,RRPL)                                  0488
         L     @14,ACBAMBL(,@14)                                   0488
         L     RAMB,AMBLDTA(,@14)                                  0488
*       CALL EXIT;                  /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0489
*     END;                          /*                               */
*   RESPECIFY                                                      0491
*    (R15) UNRSTD;                  /*                               */
*                                                                  0492
*/*                                                                  */
*/*    INTNEWRC SUBROUTINE                                           */
*/*       FUNCTION -                                                 */
*/*        OBTAINS A BUFFER FOR A NEW RECORD.                        */
*/*        CLEARS THE BUFFER TO ZEROS.                               */
*/*        INITIALIZES HEADER.                                       */
*/*        INITIALIZES DUMMY.                                        */
*/*        INITIALIZES CIDF AND RDF.                                 */
*/*        INITIALIZES FREE CI POINTERS, IF SEQ SET.                 */
*/*       INPUT -                                                    */
*/*        RWORK1 = POINTER TO CURRENT WORK AREA.                    */
*/*       OUTPUT- NONE                                               */
*/*       RETURN-                                                    */
*/*        TO CALLER IF NO ERRORS WERE ENCOUNTERED.                  */
*/*        TO CALLER OF INDEX CREATE IN CASE OF I/O ERROR.           */
*/*                                                                  */
*                                                                  0492
*INTNEWRC:                                                         0492
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */
         B     @PB00002                                            0492
INTNEWRC DS    0H                                                  0493
*   GEN SETS(PLHRETO,PLHRET1)(IDASVR14);/* SAVE REG 14               */
         IDASVR14
*I15:                                                              0494
*   DO;                             /* IDACALL(IDAGNFL)              */
I15      DS    0H                                                  0495
*     CALL IDAGNFL;                 /* EXIT TO IDAGNFL               */
         L     @15,@CV00948                                        0495
         BALR  @14,@15                                             0495
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I15;                        /* GET A BUFFER                  */
*   RESPECIFY                                                      0501
*    (RWORK1,                                                      0501
*     RWORK2) RSTD;                 /*                               */
*   RWORK1=AMBIWA;                  /* POINT TO FIRST W.A.           */
         L     RWORK1,AMBIWA(,RAMB)                                0502
*   RWORK2=ICWADD;                  /* PICK UP SAVED POINTER         */
         L     RWORK2,ICWADD(,RWORK1)                              0503
*   RWORK1=RWORK2;                  /* REESTABLISH BASE              */
         LR    RWORK1,RWORK2                                       0504
*   ICWBUFC=RBUFC;                  /* SAVE BUFC POINTER             */
         ST    RBUFC,ICWBUFC(,RWORK1)                              0505
*   RPARM1=ICWCRBA;                 /* GET CURRENT RBA               */
         L     RPARM1,ICWCRBA(,RWORK1)                             0506
*   BUFCVAL=ON;                     /* MARK BUFFER VALID             */
         L     @10,ICWBUFC(,RWORK1)                                0507
         OI    BUFCVAL(@10),B'00000100'                            0507
*   BUFCDDDD=RPARM1;                /* SET RBA TO CURRENT            */
         ST    RPARM1,BUFCDDDD(,@10)                               0508
*   DO;                             /* SET UPDATED BFR               */
*     BUFCORBA=BUFCDDDD;                                           0510
         L     @07,ICWBUFC(,RWORK1)                                0510
         L     @07,BUFCDDDD(,@07)                                  0510
         ST    @07,BUFCORBA(,@10)                                  0510
*     BUFCMW=ON;                                                   0511
         OI    BUFCMW(@10),B'10000000'                             0511
*   END;                            /* SET MUST WRITE FLAG           */
*   BUFXIRBA=RPARM1;                /* SET XCL RBA           @X04SVES*/
         ST    RPARM1,BUFXIRBA(,@10)                               0513
*   BUFCEXC=ON;                     /* SET XCL CTL ON        @X04SVES*/
         OI    BUFCEXC(@10),B'00000010'                            0514
*   RESPECIFY                                                      0515
*    (RWORK3,                                                      0515
*     RWORK4,                                                      0515
*     RWORK5) RSTD;                 /* PROTECT REGISTERS             */
*   RWORK2=RBUFC->BUFCBAD;          /* POINT TO BUFFER               */
         L     RWORK2,BUFCBAD(,RBUFC)                              0516
*   RWORK3=AMDCINV;                 /* SET LENGTH                    */
         L     @10,AMBDSB(,RAMB)                                   0517
         L     RWORK3,AMDCINV(,@10)                                0517
*   RWORK5=ZERO;                    /* ESTABLISH FILL CHAR.          */
         SLR   RWORK5,RWORK5                                       0518
*   GEN(MVCL  RWORK2,RWORK4);       /* ZERO OUT BUFFER               */
         MVCL  RWORK2,RWORK4
*   RESPECIFY                                                      0520
*    (RWORK3,                                                      0520
*     RWORK4,                                                      0520
*     RWORK5) UNRSTD;               /*                               */
*   RWORK2=RBUFC->BUFCBAD;          /* POINT TO BUFFER               */
         L     RWORK2,BUFCBAD(,RBUFC)                              0521
*   RESPECIFY                                                      0522
*     IDAIXH BASED(RWORK2);         /* SET BASE FOR HEADER           */
*   IXHLL=AMDCINV-LENGTH(IDACIDF)-  /* SET RECORD LENGTH IN          */
*       LENGTH(IDARDF);             /* HEADER                        */
         L     @10,AMBDSB(,RAMB)                                   0523
         L     @10,AMDCINV(,@10)                                   0523
         SL    @10,@CF00199                                        0523
         STH   @10,IXHLL(,RWORK2)                                  0523
*   IF ICWLN=ICWSS THEN             /* IS THIS SEQ SET LEVEL         */
         CLC   ICWLN(2,RWORK1),@CH00053                            0524
         BNE   @RF00524                                            0524
*     DO;                           /* YES                           */
*       RESPECIFY                                                  0526
*        (RWORK0) RSTD;             /*                               */
*       RWORK0=AMBLDTA->AMBDSB->AMDCIPCA;/* GET NO. CI/CA            */
         L     @10,RPLDACB(,RRPL)                                  0527
         L     @10,ACBAMBL(,@10)                                   0527
         L     @10,AMBLDTA(,@10)                                   0527
         L     @10,AMBDSB(,@10)                                    0527
         LH    RWORK0,AMDCIPCA(,@10)                               0527
*       IF RWORK0^>T56 THEN         /* WHEN CI/CA IS 256 OR          */
         CL    RWORK0,@CF00958                                     0528
         BH    @RF00528                                            0528
*         ICWPTL=ONE;               /* LESS, PTL IS 1                */
         MVI   ICWPTL(RWORK1),X'01'                                0529
*       ELSE                        /* IF GREATER THAN 256           */
*         ICWPTL=TWO;               /* PTL IS TWO                    */
         B     @RC00528                                            0530
@RF00528 MVI   ICWPTL(RWORK1),X'02'                                0530
*     END;                          /*                               */
*   ELSE                            /* NO, HIGHER LEVEL SO           */
*     ICWPTL=THREE;                 /* SET PTR LENGTH TO 3           */
         B     @RC00524                                            0532
@RF00524 MVI   ICWPTL(RWORK1),X'03'                                0532
*   IXHFLPLN=ICWPTL+LENGTH(IBFLPF)+ /* SET LENGTH OF F + L +         */
*       LENGTH(IBFLPL);             /* POINTER IN HEADER             */
@RC00524 LA    @10,2                                               0533
         SLR   @07,@07                                             0533
         IC    @07,ICWPTL(,RWORK1)                                 0533
         ALR   @10,@07                                             0533
         STC   @10,IXHFLPLN(,RWORK2)                               0533
*   IF ICWPTL=ONE THEN              /* IS POINTER LENGTH 1           */
         CLI   ICWPTL(RWORK1),1                                    0534
         BNE   @RF00534                                            0534
*     IXHPTLS='01'X;                /* YES, SET MASK TO X'01'        */
         MVI   IXHPTLS(RWORK2),X'01'                               0535
*   ELSE                            /*                               */
*     DO;                           /* NO                            */
         B     @RC00534                                            0536
@RF00534 DS    0H                                                  0537
*       IF ICWPTL=TWO THEN          /* IS POINTER LENGTH 2           */
         CLI   ICWPTL(RWORK1),2                                    0537
         BNE   @RF00537                                            0537
*         IXHPTLS='03'X;            /* YES, SET MASK TO X'03'        */
         MVI   IXHPTLS(RWORK2),X'03'                               0538
*       ELSE                        /* NO, IT MUST BE 3 SO           */
*         IXHPTLS='07'X;            /* SET MASK TO X'07'             */
         B     @RC00537                                            0539
@RF00537 MVI   IXHPTLS(RWORK2),X'07'                               0539
*     END;                          /*                               */
@RC00537 DS    0H                                                  0541
*   IXHLV=ICWLN;                    /* PLACE LEVEL NO. IN HDR        */
@RC00534 LH    @10,ICWLN(,RWORK1)                                  0541
         STC   @10,IXHLV(,RWORK2)                                  0541
*   IF ICWLN^=ICWSS THEN            /* IS THIS A HIGHER LEVEL        */
         C     @10,@CF00053                                        0542
         BE    @RF00542                                            0542
*     IXHFSO=LENGTH(IDAIXH);        /* YES, SET INSERT OFFSET JUST 0543
*                                      AFTER HEADER                  */
         MVC   IXHFSO(2,RWORK2),@CH00083                           0543
*   ELSE                            /* SEQ. SET LEVEL                */
*     DO;                           /*                               */
         B     @RC00542                                            0544
@RF00542 DS    0H                                                  0545
*       RESPECIFY                                                  0545
*        (RWORK3,                                                  0545
*         RWORK4) RSTD;             /* PROTECT REGISTERS             */
*       RWORK4=IXHPTLS;             /* PICK UP PTR MASK              */
         SLR   RWORK4,RWORK4                                       0546
         IC    RWORK4,IXHPTLS(,RWORK2)                             0546
*       RWORK3=RWORK2+LENGTH(IDAIXH);/* SET 'TO' ADD. AFTER HDR      */
         LA    RWORK3,24                                           0547
         ALR   RWORK3,RWORK2                                       0547
*       DO RPARM1=(AMBLDTA->AMBDSB->AMDCIPCA)-1/* LOOP TO PLACE      */
*             BY-ONE TO ZERO;       /* UNUSED PTRS INTO RECD.        */
         L     @10,RPLDACB(,RRPL)                                  0548
         L     @10,ACBAMBL(,@10)                                   0548
         L     @10,AMBLDTA(,@10)                                   0548
         L     @10,AMBDSB(,@10)                                    0548
         LH    RPARM1,AMDCIPCA(,@10)                               0548
         BCTR  RPARM1,0                                            0548
         B     @DE00548                                            0548
@DL00548 DS    0H                                                  0549
*         GEN(EX  RWORK4,STOREPT);  /* STORE A PTR                   */
         EX  RWORK4,STOREPT
*         RWORK3=RWORK3+ICWPTL;     /* ADJUST 'TO' ADDRESS           */
         SLR   @10,@10                                             0550
         IC    @10,ICWPTL(,RWORK1)                                 0550
         ALR   RWORK3,@10                                          0550
*       END;                        /*                               */
         BCTR  RPARM1,0                                            0551
@DE00548 LTR   RPARM1,RPARM1                                       0551
         BNM   @DL00548                                            0551
*       IXHFSO=RWORK3-RWORK2-ICWPTL;/* MAKE INSERT OFFSET TO FIRST 0552
*                                      UNUSED BYTE AFTER POINTERS    */
         LR    @10,RWORK3                                          0552
         SLR   @10,RWORK2                                          0552
         SLR   @09,@09                                             0552
         IC    @09,ICWPTL(,RWORK1)                                 0552
         SLR   @10,@09                                             0552
         STH   @10,IXHFSO(,RWORK2)                                 0552
*     END;                          /*                               */
*   IXHLEO=IXHLL-IXHFLPLN;          /* SET LAST ENTRY TO DUMMY       */
@RC00542 LH    @10,IXHLL(,RWORK2)                                  0554
         N     @10,@CF01050                                        0554
         SLR   @09,@09                                             0554
         IC    @09,IXHFLPLN(,RWORK2)                               0554
         SLR   @10,@09                                             0554
         STH   @10,IXHLEO(,RWORK2)                                 0554
*   IXHSEO=IXHLEO;                  /* SET 1ST SECT TO DUMMY         */
         STH   @10,IXHSEO(,RWORK2)                                 0555
*   IF ICWLN^=ICWSS THEN            /* IS THIS HIGH LEVEL            */
         CLC   ICWLN(2,RWORK1),@CH00053                            0556
         BE    @RF00556                                            0556
*     DO;                           /* YES                           */
*       RWORK3=AMBIWA;              /* POINT TO LOWEST LVL WA        */
         L     RWORK3,AMBIWA(,RAMB)                                0558
*       DO WHILE RWORK3->ICWCHN^=RWORK1;/* LOOP TO FIND PREVIOUS     */
         B     @DE00559                                            0559
@DL00559 DS    0H                                                  0560
*         RWORK3=RWORK3->ICWCHN;    /* LEVEL                         */
         L     RWORK3,ICWCHN(,RWORK3)                              0560
*       END;                        /*                               */
@DE00559 C     RWORK1,ICWCHN(,RWORK3)                              0561
         BNE   @DL00559                                            0561
*       RPARM1=(RWORK3->ICWPRBA)/AMDCINV;/* REDUCE DDDD TO DDD       */
         L     @10,AMBDSB(,RAMB)                                   0562
         L     @15,ICWPRBA(,RWORK3)                                0562
         SLR   @14,@14                                             0562
         D     @14,AMDCINV(,@10)                                   0562
         LR    RPARM1,@15                                          0562
*       RWORK3=RWORK2+IXHLEO+       /* POINT TO DUMMYS POINTER       */
*           LENGTH(IBFLPF)+         /*                               */
*           LENGTH(IBFLPL);         /*                               */
         LR    RWORK3,RWORK2                                       0563
         LH    @10,IXHLEO(,RWORK2)                                 0563
         ALR   RWORK3,@10                                          0563
         AL    RWORK3,@CF00146                                     0563
*       RWORK4=IXHPTLS;             /* PICK UP MASK FROM HDR         */
         SLR   RWORK4,RWORK4                                       0564
         IC    RWORK4,IXHPTLS(,RWORK2)                             0564
*       GEN(EX  RWORK4,STOREPT);    /* PLACE DUMMYS POINTER          */
         EX  RWORK4,STOREPT
*     END;                          /*                               */
*   RESPECIFY                                                      0567
*    (RWORK3,                                                      0567
*     RWORK4) UNRSTD;               /* FREE REGISTERS                */
@RF00556 DS    0H                                                  0568
*   RPARM1=RWORK2+IXHLL;            /* POINT TO RDF POSITION         */
         LH    @10,IXHLL(,RWORK2)                                  0568
         N     @10,@CF01050                                        0568
         LR    RPARM1,RWORK2                                       0568
         ALR   RPARM1,@10                                          0568
*   RPARM1->RDFLL=IXHLL;            /* SET RDF LL TO RECD LEN        */
         MVC   RDFLL(2,RPARM1),IXHLL(RWORK2)                       0569
*   RPARM1=RPARM1+LENGTH(IDARDF);   /* POINT TO CIDF                 */
         AL    RPARM1,@CF00159                                     0570
*   RPARM1->CIDFOSET=IXHLL;         /* SET FREE SPACE OFFSET         */
         STH   @10,CIDFOSET(,RPARM1)                               0571
*   ICWVSE=OFF;                     /* MARK SECT ENTRY INVALID       */
*   ICWVNE=OFF;                     /* MARK PREV ENTRY INVALID       */
         NI    ICWVSE(RWORK1),B'11100111'                          0573
*   ICWPSEO=ZERO;                   /* CLEAR SECTION OFFSET          */
         SLR   @10,@10                                             0574
         STH   @10,ICWPSEO(,RWORK1)                                0574
*   ICWSCNT=ZERO;                   /* CLEAR ENTRIES PER SECT.       */
         STH   @10,ICWSCNT(,RWORK1)                                0575
*   CALL EXIT;                      /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0576
*   RESPECIFY                                                      0577
*    (RWORK2) UNRSTD;               /* FREE REGISTER                 */
*   END INTNEWRC;                   /* END OF INTNEWRC SUBR.         */
@EL00002 DS    0H                                                  0578
@EF00002 DS    0H                                                  0578
@ER00002 BR    @14                                                 0578
*                                                                  0579
*/*                                                                  */
*/*    IDAIST SUBROUTINE                                             */
*/*                                                                  */
*/*       FUNCTION -                                                 */
*/*        INSERTS AN ENTRY INTO THE CURRENT INDEX BUFFER RESIDING   */
*/*        IN MEMORY.  IF THE ENTRY WILL NOT FIT INTO THE BUFFER,    */
*/*        FLAG ICWWNF IS SET ON AND CONTROL RETURNED TO THE USER.   */
*/*        IF THE INDEX ENTRY WILL FIT, IT IS INSERTED AND RECORD    */
*/*        HEADER FIELDS WILL BE UPDATED.                            */
*/*                                                                  */
*                                                                  0579
*IDAIST:                                                           0579
*   ENTRY;                          /*                               */
@EP00579 DS    0H                                                  0579
@EC00579 DS    0H                                                  0580
*   RESPECIFY                                                      0580
*    (RWORK2,                                                      0580
*     RWORK3,                                                      0580
*     RWORK4,                                                      0580
*     RWORK5) RSTD;                                                0580
*   GEN SETS(PLHRETO,PLHRET1)(IDASVR14);/* SAVE REG 14               */
         IDASVR14
*   IF ICWLN=ICWSS THEN             /* IF SEQ SET LEVEL              */
         CLC   ICWLN(2,RWORK1),@CH00053                            0582
         BNE   @RF00582                                            0582
*     ICWCERP=ICWCER;               /* SAVE REAR COMPRESSION         */
         IC    @10,ICWCER(,RWORK1)                                 0583
         STC   @10,ICWCERP(,RWORK1)                                0583
*   IF ICWVSE=ON THEN               /* IS THERE A VALID SECT.        */
@RF00582 TM    ICWVSE(RWORK1),B'00010000'                          0584
         BNO   @RF00584                                            0584
*     DO;                           /* YES                           */
*       RWORK4=ADDR(ICWKEY1);       /* POINT TO CURRENT KEY          */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0586
*       IF ICWSCNT=ICWNEST-ONE THEN /* WILL THIS BE A SECTION KEY  0587
*                                                            @ZA14835*/
         LH    @10,ICWNEST(,RWORK1)                                0587
         BCTR  @10,0                                               0587
         CH    @10,ICWSCNT(,RWORK1)                                0587
         BNE   @RF00587                                            0587
*         RWORK2=RWORK4+TWO*AMDKEYLN;/* POINT TO SECTION KEY         */
         L     @10,AMBDSB(,RAMB)                                   0588
         LH    RWORK2,AMDKEYLN(,@10)                               0588
         ALR   RWORK2,RWORK2                                       0588
         ALR   RWORK2,RWORK4                                       0588
*       ELSE                        /* NOT SECTION KEY       @ZA14835*/
*         RWORK2=RWORK4+AMDKEYLN;   /* POINT TO PREV         @ZA14835*/
         B     @RC00587                                            0589
@RF00587 L     @10,AMBDSB(,RAMB)                                   0589
         LR    RWORK2,RWORK4                                       0589
         AH    RWORK2,AMDKEYLN(,@10)                               0589
*       RESPECIFY                                                  0590
*        (RWORK0) RSTD;             /* IN CASE KEYS ARE NOT          */
@RC00587 DS    0H                                                  0591
*       RWORK0=MIN(ICWKEY1L,ICWKEY3L);/* SAME LENGTH (SPLIT)         */
         LH    RWORK0,ICWKEY1L(,RWORK1)                            0591
         LH    @10,ICWKEY3L(,RWORK1)                               0591
         CR    RWORK0,@10                                          0591
         BNH   *+6
         LR    RWORK0,@10                                          0591
*       RWORK3=RWORK0;              /* USE SMALLEST LENGTH           */
         LR    RWORK3,RWORK0                                       0592
*       RWORK5=RWORK3;              /* SAME LENGTH IN RWORK5         */
         LR    RWORK5,RWORK3                                       0593
*       GEN(CLCL  RWORK2,RWORK4);   /* COMPARE CURRENT KEY TO SECT 0594
*                                      KEY TO DETERMINE FRONT      0594
*                                      COMPRESSION                   */
         CLCL  RWORK2,RWORK4
*       ICWCEF=RWORK0-RWORK3;       /* SAVE FRONT COMPRESSION        */
         LR    @10,RWORK0                                          0595
         SLR   @10,RWORK3                                          0595
         STC   @10,ICWCEF(,RWORK1)                                 0595
*       RESPECIFY                                                  0596
*        (RWORK0) UNRSTD;           /* IN WORK AREA                  */
*     END;                          /*                               */
*   ELSE                            /* NO PREVIOUS SECTION           */
*     DO;                                                          0598
         B     @RC00584                                            0598
@RF00584 DS    0H                                                  0599
*       IF ICWSCNT^=ICWNEST-ONE&    /* NOT A SECTION ENTRY           */
*           ICWSPLIT=ON&            /* AND PREVIOUS EXISTS           */
*           ICWVNE=ON&              /* AND WILL NOT BE THE LAST ENTRY
*                                      IN 1ST SECT                   */
*           PLHSAVE2>PLHSAVE1 THEN  /* DURING SPLIT.         @ZA18510*/
         LH    @10,ICWNEST(,RWORK1)                                0599
         BCTR  @10,0                                               0599
         CH    @10,ICWSCNT(,RWORK1)                                0599
         BE    @RF00599                                            0599
         TM    ICWSPLIT(RWORK1),B'00001010'                        0599
         BNO   @RF00599                                            0599
         CLC   PLHSAVE2(4,RPLH),PLHSAVE1(RPLH)                     0599
         BNH   @RF00599                                            0599
*         DO;                                                      0600
*           RWORK4=ADDR(ICWKEY1);   /* PT TO CURR KEY        @ZA18510*/
         LA    RWORK4,ICWKEY1(,RWORK1)                             0601
*           RWORK2=RWORK4+AMDKEYLN; /* PT TO PREV KEY        @ZA18510*/
         L     @10,AMBDSB(,RAMB)                                   0602
         LR    RWORK2,RWORK4                                       0602
         AH    RWORK2,AMDKEYLN(,@10)                               0602
*           RESPECIFY               /* IN CASE KEYS          @ZA18510*/
*            (RWORK0) RSTD;         /* LEN. DIFFER           @ZA18510*/
*           RWORK0=MIN(ICWKEY1L,ICWKEY2L);/* USE THE SMALLEST        */
         LH    RWORK0,ICWKEY1L(,RWORK1)                            0604
         LH    @10,ICWKEY2L(,RWORK1)                               0604
         CR    RWORK0,@10                                          0604
         BNH   *+6
         LR    RWORK0,@10                                          0604
*           RWORK3=RWORK0;          /* LENGTH                @ZA18510*/
         LR    RWORK3,RWORK0                                       0605
*           RWORK5=RWORK3;          /* RWORK5= LENGTH        @ZA18510*/
         LR    RWORK5,RWORK3                                       0606
*           GEN(CLCL RWORK2,RWORK4);/* COMPARE KEY TO PREVIOUS FOR 0607
*                                      FRONT COMPRESSION     @ZA18510*/
         CLCL RWORK2,RWORK4
*           ICWCEF=RWORK0-RWORK3;   /* SAVE FRONT COMPRESS LEN       */
         LR    @10,RWORK0                                          0608
         SLR   @10,RWORK3                                          0608
         STC   @10,ICWCEF(,RWORK1)                                 0608
*           RESPECIFY               /* IN WORK AREA.         @ZA18510*/
*            (RWORK0) UNRSTD;                                      0609
*         END;                                                     0610
*       ELSE                                                       0611
*         ICWCEF=ZERO;              /* SET FRONT COMP. TO ZERO       */
         B     @RC00599                                            0611
@RF00599 MVI   ICWCEF(RWORK1),X'00'                                0611
*     END;                                                         0612
@RC00599 DS    0H                                                  0613
*   IF ICWLN=ICWSS&PLHKRE=OFF&      /* IS THIS SEQ SET, NOT KR       */
*       ICWSPLIT=OFF THEN           /* AND NOT SPLIT INDX RCD        */
@RC00584 CLC   ICWLN(2,RWORK1),@CH00053                            0613
         BNE   @RF00613                                            0613
         TM    PLHKRE(RPLH),B'00001000'                            0613
         BNZ   @RF00613                                            0613
         TM    ICWSPLIT(RWORK1),B'00000010'                        0613
         BNZ   @RF00613                                            0613
*     DO;                           /* YES                           */
*       RWORK2=RPLAREA+AMDRKP;      /* POINT TO NEXT KEY WHICH IS IN
*                                      USERS AREA                    */
         L     @10,AMBDSB(,RAMB)                                   0615
         LH    RWORK2,AMDRKP(,@10)                                 0615
         AL    RWORK2,RPLAREA(,RRPL)                               0615
*       RWORK4=ADDR(ICWKEY1);       /* POINT TO CURRENT KEY          */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0616
*       RWORK3=ICWKEY1L;            /* SET KEY LENGTH                */
         LH    RWORK3,ICWKEY1L(,RWORK1)                            0617
*       RWORK5=RWORK3;              /* SAME LENGTH IN RWORK5         */
         LR    RWORK5,RWORK3                                       0618
*       GEN(CLCL  RWORK2,RWORK4);   /* COMPARE CURRENT KEY TO NEXT 0619
*                                      KEY FOR REAR COMPRESSION    0619
*                                      PURPOSES                      */
         CLCL  RWORK2,RWORK4
*       ICWCER=RWORK4-ADDR(ICWKEY1)+ONE;/* SAVE CHAR. POSITION OF  0620
*                                      DIFFERING CHARACTERS          */
         LA    @10,ICWKEY1(,RWORK1)                                0620
         LCR   @10,@10                                             0620
         ALR   @10,RWORK4                                          0620
         AL    @10,@CF00053                                        0620
         STC   @10,ICWCER(,RWORK1)                                 0620
*     END;                                                         0621
*   ELSE                            /* NOT A SEQ SET INSERT SO       */
*     ICWCER=ICWKEY1L;              /* SHOW NO REAR COMPR.           */
         B     @RC00613                                            0622
@RF00613 LH    @10,ICWKEY1L(,RWORK1)                               0622
         STC   @10,ICWCER(,RWORK1)                                 0622
*   RESPECIFY                                                      0623
*    (RWORK2,                                                      0623
*     RWORK3,                                                      0623
*     RWORK4,                                                      0623
*     RWORK5) UNRSTD;               /* FREE REGS                     */
@RC00613 DS    0H                                                  0624
*   IF ICWCER>ICWCEF THEN           /* DOES REAR COMPRESSION POSITION
*                                      EXCEED FRONT COMPRESSION      */
         CLC   ICWCER(1,RWORK1),ICWCEF(RWORK1)                     0624
         BNH   @RF00624                                            0624
*     ICWCEL=ICWCER-ICWCEF;         /* YES, LENGTH=DIFFERENCE        */
         SLR   @10,@10                                             0625
         IC    @10,ICWCER(,RWORK1)                                 0625
         SLR   @00,@00                                             0625
         IC    @00,ICWCEF(,RWORK1)                                 0625
         SLR   @10,@00                                             0625
         STC   @10,ICWCEL(,RWORK1)                                 0625
*   ELSE                            /* IF NOT, SET THE               */
*     DO;                           /*                       @ZA05901*/
         B     @RC00624                                            0626
@RF00624 DS    0H                                                  0627
*       ICWCEL=ZERO;                /* LENGTH TO ZERO                */
         MVI   ICWCEL(RWORK1),X'00'                                0627
*       ICWCER=ICWCEF;              /* ADJ REAR POS          @ZA05901*/
         IC    @10,ICWCEF(,RWORK1)                                 0628
         STC   @10,ICWCER(,RWORK1)                                 0628
*     END;                          /* END OF <=             @ZA05901*/
*   RESPECIFY                                                      0630
*    (RWORK2,                                                      0630
*     RWORK3,                                                      0630
*     RWORK4) RSTD;                 /* PROTECT REGISTERS             */
@RC00624 DS    0H                                                  0631
*   RWORK2=ICWBUFC->BUFCBAD;        /* POINT TO BUFFER               */
         L     @10,ICWBUFC(,RWORK1)                                0631
         L     RWORK2,BUFCBAD(,@10)                                0631
*   RWORK3=ICWCEL+                  /* COMPUTE SPACE REQUIRED        */
*       RWORK2->IXHFLPLN+           /* TO MAKE AN ENTRY IN           */
*       LENGTH(IXSELL);             /* THE INDEX RECORD              */
         LA    @10,2                                               0632
         SLR   RWORK3,RWORK3                                       0632
         IC    RWORK3,ICWCEL(,RWORK1)                              0632
         SLR   @09,@09                                             0632
         IC    @09,IXHFLPLN(,RWORK2)                               0632
         ALR   RWORK3,@09                                          0632
         ALR   RWORK3,@10                                          0632
*   IF ICWSPLIT=OFF THEN            /* IS THIS A SPLIT OF RECD       */
         TM    ICWSPLIT(RWORK1),B'00000010'                        0633
         BNZ   @RF00633                                            0633
*     DO;                           /* NO, ITS CREATE TIME SO        */
*       RWORK4=RWORK2->IXHLEO-      /* COMPUTE SPACE                 */
*           RWORK2->IXHFSO-         /* REMAINING TO THE FREE         */
*           LENGTH(IXSELL);         /* SPACE AREA OF BUFFER          */
         LH    RWORK4,IXHLEO(,RWORK2)                              0635
         SH    RWORK4,IXHFSO(,RWORK2)                              0635
         SLR   RWORK4,@10                                          0635
*       RWORK3=RWORK3+ICWCEF;       /* ASSURE SPACE FOR FRONT      0636
*                                      UNCOMPRESSED KEY              */
         SLR   @10,@10                                             0636
         IC    @10,ICWCEF(,RWORK1)                                 0636
         ALR   RWORK3,@10                                          0636
*       IF ICWLN=ICWSS THEN         /* IS THIS SS NOT SPLIT  @ZA30108*/
         CLC   ICWLN(2,RWORK1),@CH00053                            0637
         BNE   @RF00637                                            0637
*         RWORK4=RWORK4+ICWPTL;     /* YES, BUMP AVAILABLE   @ZA30108
*                                      SPACE BY PTR LENGTH   @ZA30108*/
         SLR   @10,@10                                             0638
         IC    @10,ICWPTL(,RWORK1)                                 0638
         ALR   RWORK4,@10                                          0638
*     END;                          /*                               */
*   ELSE                            /* INDEX RECORD BEING SPLT       */
*     RWORK4=RWORK2->IXHLEO-        /* SO COMPUTE SPACE              */
*         (PLHSAVE2-RWORK2);        /* AVAILABLE BASED ON THE      0640
*                                      POSITION OF THE BLOCK OF INDEX
*                                      ENTRYS IN THE BUFFER          */
         B     @RC00633                                            0640
@RF00633 L     RWORK4,PLHSAVE2(,RPLH)                              0640
         SLR   RWORK4,RWORK2                                       0640
         LCR   RWORK4,RWORK4                                       0640
         LH    @10,IXHLEO(,RWORK2)                                 0640
         ALR   RWORK4,@10                                          0640
*   IF ICWNOSEG^=ZERO THEN          /* IS ENTRY FOR SPANNED RECORD 0641
*                                                            @X04SVES*/
@RC00633 LH    @10,ICWNOSEG(,RWORK1)                               0641
         LTR   @10,@10                                             0641
         BZ    @RF00641                                            0641
*     DO;                           /* YES                   @X04SVES*/
*       RWORK3=RWORK3+(ICWNOSEG-ONE)/* COMPUTE SPACE         @X04SVES*/
*           *(RWORK2->IXHFLPLN);    /* FOR FIRST THRU N-1 ST SEGMENTS
*                                                            @X04SVES*/
         LR    @15,@10                                             0643
         BCTR  @15,0                                               0643
         SLR   @10,@10                                             0643
         IC    @10,IXHFLPLN(,RWORK2)                               0643
         MR    @14,@10                                             0643
         ALR   RWORK3,@15                                          0643
*     END;                          /*                       @X04SVES*/
*   IF RWORK3>RWORK4 THEN           /* WILL THE ENTRY FIT            */
@RF00641 CR    RWORK3,RWORK4                                       0645
         BNH   @RF00645                                            0645
*     DO;                           /* NO                            */
*       ICWWNF=ON;                  /* SET WONT FIT FLAG ON          */
         OI    ICWWNF(RWORK1),B'10000000'                          0647
*       CALL EXIT;                  /* RETURN                @X04SVES*/
         BAL   @14,EXIT                                            0648
*     END;                          /*                               */
*   ELSE                            /* ENTRY WILL FIT                */
*     IF ICWSCNT=ICWNEST-ONE THEN   /* SHOULD THIS BE A SECT.        */
         B     @RC00645                                            0650
@RF00645 LH    @10,ICWNEST(,RWORK1)                                0650
         BCTR  @10,0                                               0650
         CH    @10,ICWSCNT(,RWORK1)                                0650
         BNE   @RF00650                                            0650
*       DO;                         /* YES                           */
*         RESPECIFY                                                0652
*          (RWORK5) RSTD;           /*                               */
*         IF ICWNOSEG^=ZERO THEN    /* SPANNED RECORD        @X04SVES*/
         LH    @10,ICWNOSEG(,RWORK1)                               0653
         LTR   @10,@10                                             0653
         BZ    @RF00653                                            0653
*           DO ICWCRSEG=ONE TO ICWNOSEG-ONE;/* YES           @X04SVES*/
         LA    @10,1                                               0654
         B     @DE00654                                            0654
@DL00654 DS    0H                                                  0655
*I17:                                                              0655
*             DO;                   /* IDACALL(IDASPNPT)             */
I17      DS    0H                                                  0656
*               CALL IDASPNPT;      /* EXIT TO IDASPNPT              */
         L     @15,@CV00950                                        0656
         BALR  @14,@15                                             0656
*               GEN(BALR @11,0);    /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*               GEN(USING *,@11);   /* ESTABLISH ADDRESSING          */
         USING *,@11
*               GEN(L     @11,=A(@PSTART));/* RELOAD BASE            */
         L     @11,=A(@PSTART)
*               GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING       */
         USING @PSTART,@11
*             END I17;              /* MAKE NULL ENTRY@X04SVES       */
*           END;                    /*                       @X04SVES*/
         LA    @10,1                                               0662
         AH    @10,ICWCRSEG(,RWORK1)                               0662
@DE00654 STH   @10,ICWCRSEG(,RWORK1)                               0662
         LH    @00,ICWNOSEG(,RWORK1)                               0662
         BCTR  @00,0                                               0662
         CR    @10,@00                                             0662
         BNH   @DL00654                                            0662
*         RWORK3=RWORK2+RWORK2->IXHLEO;/* POINT TO INSERTION PT.     */
@RF00653 LR    RWORK3,RWORK2                                       0663
         LH    @10,IXHLEO(,RWORK2)                                 0663
         ALR   RWORK3,@10                                          0663
*         RWORK3->IBFLPF=ICWCEF;    /* PLACE F INTO RECORD           */
         SLR   @10,@10                                             0664
         IC    @10,ICWCEF(,RWORK1)                                 0664
         STC   @10,IBFLPF(,RWORK3)                                 0664
*         RWORK3->IBFLPL=ICWCEL;    /* PLACE L INTO RECORD           */
         SLR   @15,@15                                             0665
         IC    @15,ICWCEL(,RWORK1)                                 0665
         STC   @15,IBFLPL(,RWORK3)                                 0665
*         RWORK2=RWORK3-ICWCEL;     /* POINT TO FIRST BYTE OF KEY  0666
*                                      POSITION IN RECD.             */
         LR    RWORK2,RWORK3                                       0666
         SLR   RWORK2,@15                                          0666
*         RWORK4=ADDR(ICWKEY1)+ICWCEF;/* POINT TO FIRST BYTE OF KEY
*                                      TO BE STORED                  */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0667
         ALR   RWORK4,@10                                          0667
*         RWORK5=ICWCEL;            /* SET LENGTH OF MOVE            */
         LR    RWORK5,@15                                          0668
*         RWORK3=RWORK5;            /* SAME LENGTH IN RWORK3         */
         LR    RWORK3,RWORK5                                       0669
*         GEN(MVCL  RWORK2,RWORK4); /* MOVE KEY TO INDX BUFFER       */
         MVCL  RWORK2,RWORK4
*         RESPECIFY                                                0671
*          (RWORK5) UNRSTD;         /*                               */
*         RWORK2=ICWBUFC->BUFCBAD;  /* POINT TO BUFFER               */
         L     @10,ICWBUFC(,RWORK1)                                0672
         L     RWORK2,BUFCBAD(,@10)                                0672
*         RPARM1=ICWCEL+            /* COMPUTE OFFSET FROM           */
*             LENGTH(IXSELL)+       /* THIS SECT. ENTRY TO           */
*             RWORK2->IXHFLPLN;     /* THE DUMMY ENTRY               */
         LA    @10,2                                               0673
         SLR   @09,@09                                             0673
         IC    @09,ICWCEL(,RWORK1)                                 0673
         LR    RPARM1,@09                                          0673
         ALR   RPARM1,@10                                          0673
         SLR   @00,@00                                             0673
         IC    @00,IXHFLPLN(,RWORK2)                               0673
         ALR   RPARM1,@00                                          0673
*         RWORK4='03'X;             /* SET MASK FOR TWO BYTES        */
         LA    RWORK4,3                                            0674
*         RWORK3=RWORK2+            /* POINT TO SECTION FIELD        */
*             RWORK2->IXHLEO-       /* WHICH POINTS FORWARD          */
*             ICWCEL-               /* TO NEXT SECTION               */
*             LENGTH(IXSELL);       /*                               */
         LR    RWORK3,RWORK2                                       0675
         LH    @00,IXHLEO(,RWORK2)                                 0675
         ALR   RWORK3,@00                                          0675
         SLR   RWORK3,@09                                          0675
         SLR   RWORK3,@10                                          0675
*         GEN(EX  RWORK4,STOREPT);  /* MOVE POINTER TO RECD          */
         EX  RWORK4,STOREPT
*         IF ICWVSE=OFF THEN        /* IS THIS 1ST. SECT.            */
         TM    ICWVSE(RWORK1),B'00010000'                          0677
         BNZ   @RF00677                                            0677
*           DO;                     /* YES                           */
*             ICWVSE=ON;            /* SET FLAG ON                   */
         OI    ICWVSE(RWORK1),B'00010000'                          0679
*             RWORK2->IXHSEO=RWORK2->IXHLEO;/* SET OFFSET TO THE   0680
*                                      FIRST SECTION IN THE INDEX  0680
*                                      RECORD.                       */
         LH    @10,IXHLEO(,RWORK2)                                 0680
         STH   @10,IXHSEO(,RWORK2)                                 0680
*             IF ICWNEST=ONE&ICWLN=ICWSS/* IN CASE 1 ENTRY/SECT      */
*                 &ICWSPLIT=OFF THEN/* CREATE & SS LEVEL             */
         LA    @10,1                                               0681
         CH    @10,ICWNEST(,RWORK1)                                0681
         BNE   @RF00681                                            0681
         CH    @10,ICWLN(,RWORK1)                                  0681
         BNE   @RF00681                                            0681
         TM    ICWSPLIT(RWORK1),B'00000010'                        0681
         BNZ   @RF00681                                            0681
*               CALL SETBASE;       /* SET BASE RBA          @X04SVES*/
         BAL   @14,SETBASE                                         0682
*           END;                    /*                               */
*         ELSE                      /* NOT FIRST SECTION             */
*           DO;                     /*                               */
         B     @RC00677                                            0684
@RF00677 DS    0H                                                  0685
*             RWORK4=RWORK2+ICWPSEO;/* POINT TO PREV. SECTION        */
         LH    @10,ICWPSEO(,RWORK1)                                0685
         LR    RWORK4,RWORK2                                       0685
         ALR   RWORK4,@10                                          0685
*             RWORK3=RWORK4-        /* POINT TO FORWARD CHAIN        */
*                 RWORK4->IBFLPL-   /* POINTER OF THAT SECT          */
*                 LENGTH(IXSELL);   /* ENTRY                         */
         LR    RWORK3,RWORK4                                       0686
         SLR   @09,@09                                             0686
         IC    @09,IBFLPL(,RWORK4)                                 0686
         SLR   RWORK3,@09                                          0686
         BCTR  RWORK3,0                                            0686
         BCTR  RWORK3,0                                            0686
*             RWORK4='03'X;         /* SET MASK FOR TWO BYTES        */
         LA    RWORK4,3                                            0687
*             RPARM1=ICWPSEO-       /* COMPUTE OFFSET BETWEEN        */
*                 RWORK2->IXHLEO;   /* SECTIONS                      */
         SH    @10,IXHLEO(,RWORK2)                                 0688
         LR    RPARM1,@10                                          0688
*             GEN(EX  RWORK4,STOREPT);/* STORE OFFSET IN PREV.     0689
*                                      SECTION                       */
         EX  RWORK4,STOREPT
*           END;                    /*                               */
*         RESPECIFY                                                0691
*          (RWORK5) RSTD;           /*                               */
@RC00677 DS    0H                                                  0692
*         RWORK4=ADDR(ICWKEY1);     /* SET 'FROM' ADDRESS            */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0692
*         RWORK2=RWORK4+TWO*AMDKEYLN;/* SET 'TO' ADDRESS             */
         L     @10,AMBDSB(,RAMB)                                   0693
         LH    RWORK2,AMDKEYLN(,@10)                               0693
         ALR   RWORK2,RWORK2                                       0693
         ALR   RWORK2,RWORK4                                       0693
*         RWORK5=ICWKEY1L;          /* SET LENGTH OF MOVE            */
         LH    RWORK5,ICWKEY1L(,RWORK1)                            0694
*         RWORK3=RWORK5;            /* DITTO                         */
         LR    RWORK3,RWORK5                                       0695
*         GEN(MVCL  RWORK2,RWORK4); /* MOVE KEY TO SECTION KEY       */
         MVCL  RWORK2,RWORK4
*         RESPECIFY                                                0697
*          (RWORK5) UNRSTD;         /*                               */
*         ICWKEY3L=ICWKEY1L;        /* SAVE SECTION LENGTH           */
         LH    @10,ICWKEY1L(,RWORK1)                               0698
         STH   @10,ICWKEY3L(,RWORK1)                               0698
*         RWORK2=ICWBUFC->BUFCBAD;  /* POINT BACK TO BUFFER          */
         L     @10,ICWBUFC(,RWORK1)                                0699
         L     RWORK2,BUFCBAD(,@10)                                0699
*         ICWPSEO=RWORK2->IXHLEO;   /* SET NEW OFFSET TO SECT        */
         LH    @10,IXHLEO(,RWORK2)                                 0700
         STH   @10,ICWPSEO(,RWORK1)                                0700
*         RWORK2->IXHLEO=RWORK2->IXHLEO-/* REESTABLISH NEW           */
*             ICWCEL-               /* OFFSET TO LAST                */
*             RWORK2->IXHFLPLN-     /* ENTRY                         */
*             LENGTH(IXSELL);       /*                               */
         SLR   @09,@09                                             0701
         IC    @09,ICWCEL(,RWORK1)                                 0701
         SLR   @10,@09                                             0701
         SLR   @09,@09                                             0701
         IC    @09,IXHFLPLN(,RWORK2)                               0701
         SLR   @10,@09                                             0701
         BCTR  @10,0                                               0701
         BCTR  @10,0                                               0701
         STH   @10,IXHLEO(,RWORK2)                                 0701
*         IF ICWLN=ICWSSICWSPLIT=ON THEN/* SEQ SET OR SPLIT         */
         CLC   ICWLN(2,RWORK1),@CH00053                            0702
         BE    @RT00702                                            0702
         TM    ICWSPLIT(RWORK1),B'00000010'                        0702
         BNO   @RF00702                                            0702
@RT00702 DS    0H                                                  0703
*           DO;                     /* YES                           */
*             RWORK3=RWORK2+        /* POINT TO FIRST UNUSED         */
*                 RWORK2->IXHFSO-   /* CI POINTER IN THE             */
*                 ICWPTL;           /* RECORD                        */
         LR    RWORK3,RWORK2                                       0704
         LH    @10,IXHFSO(,RWORK2)                                 0704
         ALR   RWORK3,@10                                          0704
         SLR   @10,@10                                             0704
         IC    @10,ICWPTL(,RWORK1)                                 0704
         SLR   RWORK3,@10                                          0704
*             RESPECIFY                                            0705
*              (RWORK0) RSTD;       /*                               */
*             RWORK0=RWORK3;        /* SAVE LOCATION OF PTR.         */
         LR    RWORK0,RWORK3                                       0706
*             RWORK4=RWORK2->IXHPTLS;/* GET MASK FROM HEADER         */
         SLR   RWORK4,RWORK4                                       0707
         IC    RWORK4,IXHPTLS(,RWORK2)                             0707
*             IF RWORK0^<RWORK2+LENGTH(IDAIXH) THEN/* ANY PTRS LEFT  */
         LA    @10,24                                              0708
         ALR   @10,RWORK2                                          0708
         CLR   RWORK0,@10                                          0708
         BL    @RF00708                                            0708
*               GEN(EX  RWORK4,PICKPT);/* YES, PICK UP ONE           */
         EX  RWORK4,PICKPT
*             ELSE                  /* NO                            */
*               RPARM1=AMBLDTA->AMBDSB->AMDCIPCA-ONE;/* GENERATE IT  */
         B     @RC00708                                            0710
@RF00708 L     @10,RPLDACB(,RRPL)                                  0710
         L     @10,ACBAMBL(,@10)                                   0710
         L     @10,AMBLDTA(,@10)                                   0710
         L     @10,AMBDSB(,@10)                                    0710
         LH    RPARM1,AMDCIPCA(,@10)                               0710
         BCTR  RPARM1,0                                            0710
*             RWORK3=RWORK2+        /* POINT TO THE DUMMY            */
*                 RWORK2->IXHLEO+   /* ENTRYS POINTER                */
*                 LENGTH(IBFLPF)+   /* FIELD                         */
*                 LENGTH(IBFLPL);   /*                               */
@RC00708 LR    RWORK3,RWORK2                                       0711
         LH    @10,IXHLEO(,RWORK2)                                 0711
         ALR   RWORK3,@10                                          0711
         AL    RWORK3,@CF00146                                     0711
*             GEN(EX  RWORK4,STOREPT);/* PLACE NEW DUMMY POINTER     */
         EX  RWORK4,STOREPT
*             RWORK2->IXHFSO=RWORK2->IXHFSO/* UPDATE FREESPACE       */
*                 -ICWPTL;          /* OFFSET                        */
         LH    @10,IXHFSO(,RWORK2)                                 0713
         SLR   @09,@09                                             0713
         IC    @09,ICWPTL(,RWORK1)                                 0713
         SLR   @10,@09                                             0713
         STH   @10,IXHFSO(,RWORK2)                                 0713
*             IF RWORK0^<RWORK2+LENGTH(IDAIXH) THEN/* IF HEADER IS 0714
*                                      SAFE FROM VIOLATION FOR SPLIT
*                                      CASE, THEN                    */
         LA    @10,24                                              0714
         ALR   @10,RWORK2                                          0714
         CLR   RWORK0,@10                                          0714
         BL    @RF00714                                            0714
*               DO;                 /* CLEAR PTR. JUST TAKEN         */
*                 RPARM1=ZERO;      /* CLEAR REGISTER                */
         SLR   RPARM1,RPARM1                                       0716
*                 RWORK3=RWORK0;    /* POINT BACK TO PTR AREA        */
         LR    RWORK3,RWORK0                                       0717
*                 GEN(EX  RWORK4,STOREPT);/* CLEAR USED POINTER      */
         EX  RWORK4,STOREPT
*                 RESPECIFY                                        0719
*                  (RWORK0) UNRSTD; /*                               */
*               END;                /*                               */
*           END;                    /*                               */
*         ELSE                      /* HIGHER LEVEL ENTRY            */
*           DO;                                                    0722
         B     @RC00702                                            0722
@RF00702 DS    0H                                                  0723
*             RWORK3=AMBIWA;        /* POINT TO LOW LEVEL            */
         L     RWORK3,AMBIWA(,RAMB)                                0723
*             DO WHILE RWORK3->ICWCHN^=RWORK1;/* LOOP TO FIND PREV.
*                                      LEVEL                         */
         B     @DE00724                                            0724
@DL00724 DS    0H                                                  0725
*               RWORK3=RWORK3->ICWCHN;/*                             */
         L     RWORK3,ICWCHN(,RWORK3)                              0725
*             END;                  /*                               */
@DE00724 C     RWORK1,ICWCHN(,RWORK3)                              0726
         BNE   @DL00724                                            0726
*             RPARM1=(RWORK3->ICWCRBA)/AMDCINV;/* REDUCE DDDD        */
         L     @10,AMBDSB(,RAMB)                                   0727
         L     @15,ICWCRBA(,RWORK3)                                0727
         SLR   @14,@14                                             0727
         D     @14,AMDCINV(,@10)                                   0727
         LR    RPARM1,@15                                          0727
*             RWORK3=RWORK2+        /* POINT TO DUMMYS POINTER       */
*                 RWORK2->IXHLEO+   /*                               */
*                 LENGTH(IBFLPF)+   /*                               */
*                 LENGTH(IBFLPL);   /*                               */
         LR    RWORK3,RWORK2                                       0728
         LH    @10,IXHLEO(,RWORK2)                                 0728
         ALR   RWORK3,@10                                          0728
         AL    RWORK3,@CF00146                                     0728
*             RWORK4=RWORK2->IXHPTLS;/* GET MASK FROM HDR            */
         SLR   RWORK4,RWORK4                                       0729
         IC    RWORK4,IXHPTLS(,RWORK2)                             0729
*             GEN(EX  RWORK4,STOREPT);/* MOVE IN DUMMYS PTR          */
         EX  RWORK4,STOREPT
*           END;                    /*                               */
*         ICWSCNT=ZERO;             /* RESET ENTRYS IN        SECTION*/
@RC00702 SLR   @10,@10                                             0732
         STH   @10,ICWSCNT(,RWORK1)                                0732
*       END;                                                       0733
*     ELSE                          /* NORMAL ENTRY                  */
*       DO;                         /*                               */
         B     @RC00650                                            0734
@RF00650 DS    0H                                                  0735
*         ICWSCNT=ICWSCNT+ONE;      /* INCREASE COUNT IN SECT.       */
         LA    @10,1                                               0735
         AH    @10,ICWSCNT(,RWORK1)                                0735
         STH   @10,ICWSCNT(,RWORK1)                                0735
*         IF ICWVNE=ON THEN         /* IS THERE A PREVIOUS ENTRY     */
         TM    ICWVNE(RWORK1),B'00001000'                          0736
         BNO   @RF00736                                            0736
*           DO;                     /* YES                           */
*             RESPECIFY                                            0738
*              (RWORK5) RSTD;       /*                               */
*             RWORK4=ADDR(ICWKEY1); /* POINT TO CURRENT KEY          */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0739
*             RWORK2=RWORK4+AMDKEYLN;/* POINT TO PREVIOUS KEY        */
         L     @10,AMBDSB(,RAMB)                                   0740
         LR    RWORK2,RWORK4                                       0740
         AH    RWORK2,AMDKEYLN(,@10)                               0740
*             RESPECIFY                                            0741
*              (RWORK0) RSTD;       /* IN CASE KEYS ARE NOT          */
*             RWORK0=MIN(ICWKEY1L,ICWKEY2L);/* SAME LENGTH (SPLIT)   */
         LH    RWORK0,ICWKEY1L(,RWORK1)                            0742
         LH    @10,ICWKEY2L(,RWORK1)                               0742
         CR    RWORK0,@10                                          0742
         BNH   *+6
         LR    RWORK0,@10                                          0742
*             RWORK3=RWORK0;        /* USE SMALLEST LENGTH           */
         LR    RWORK3,RWORK0                                       0743
*             RWORK5=RWORK3;        /* SAME LENGTH IN RWORK5         */
         LR    RWORK5,RWORK3                                       0744
*             GEN(CLCL  RWORK2,RWORK4);/* COMPARE KEY TO PREVIOUS KEY
*                                      FOR FRONT COMPRESS            */
         CLCL  RWORK2,RWORK4
*             RESPECIFY                                            0746
*              (RWORK5) UNRSTD;     /*                               */
*             ICWCEF=RWORK0-RWORK3; /* SAVE FRONT COMPRESSION        */
         LR    @10,RWORK0                                          0747
         SLR   @10,RWORK3                                          0747
         STC   @10,ICWCEF(,RWORK1)                                 0747
*             RESPECIFY                                            0748
*              (RWORK0) UNRSTD;     /* IN WORK AREA                  */
*           END;                                                   0749
*         ELSE                      /* NO PREVIOUS ENTRY SO          */
*           ICWCEF=ZERO;            /* SET COMPRESSION TO 0          */
         B     @RC00736                                            0750
@RF00736 MVI   ICWCEF(RWORK1),X'00'                                0750
*         ICWVNE=ON;                /* SHOW PREV. ENTRY VALID        */
@RC00736 OI    ICWVNE(RWORK1),B'00001000'                          0751
*         IF ICWCER>ICWCEF THEN     /* REAR COMP. PTR > FR.          */
         CLC   ICWCER(1,RWORK1),ICWCEF(RWORK1)                     0752
         BNH   @RF00752                                            0752
*           ICWCEL=ICWCER-ICWCEF;   /* COMP. YES- LEN = DIFF.        */
         SLR   @10,@10                                             0753
         IC    @10,ICWCER(,RWORK1)                                 0753
         SLR   @09,@09                                             0753
         IC    @09,ICWCEF(,RWORK1)                                 0753
         SLR   @10,@09                                             0753
         STC   @10,ICWCEL(,RWORK1)                                 0753
*         ELSE                      /* OTHERWISE THE LENGTH          */
*           DO;                     /*                       @ZA05901*/
         B     @RC00752                                            0754
@RF00752 DS    0H                                                  0755
*             ICWCEL=ZERO;          /* IS ZERO                       */
         MVI   ICWCEL(RWORK1),X'00'                                0755
*             ICWCER=ICWCEF;        /* ADJ REAR POS.         @ZA05901*/
         IC    @10,ICWCEF(,RWORK1)                                 0756
         STC   @10,ICWCER(,RWORK1)                                 0756
*           END;                    /* END OF <=             @ZA05901*/
*         RESPECIFY                                                0758
*          (RWORK5) RSTD;           /*                               */
@RC00752 DS    0H                                                  0759
*         RWORK2=ICWBUFC->BUFCBAD;  /* POINT TO BUFFER               */
         L     @10,ICWBUFC(,RWORK1)                                0759
         L     RWORK2,BUFCBAD(,@10)                                0759
*         IF ICWNOSEG^=ZERO THEN    /* SPANNED RCD           @X04SVES*/
         LH    @10,ICWNOSEG(,RWORK1)                               0760
         LTR   @10,@10                                             0760
         BZ    @RF00760                                            0760
*           DO ICWCRSEG=ONE TO ICWNOSEG-ONE;/* YES           @X04SVES*/
         LA    @10,1                                               0761
         B     @DE00761                                            0761
@DL00761 DS    0H                                                  0762
*I18:                                                              0762
*             DO;                   /* IDACALL(IDASPNPT)             */
I18      DS    0H                                                  0763
*               CALL IDASPNPT;      /* EXIT TO IDASPNPT              */
         L     @15,@CV00950                                        0763
         BALR  @14,@15                                             0763
*               GEN(BALR @11,0);    /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*               GEN(USING *,@11);   /* ESTABLISH ADDRESSING          */
         USING *,@11
*               GEN(L     @11,=A(@PSTART));/* RELOAD BASE            */
         L     @11,=A(@PSTART)
*               GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING       */
         USING @PSTART,@11
*             END I18;              /* MAKE NULL ENTRY@X04SVES       */
*           END;                    /*                       @X04SVES*/
         LA    @10,1                                               0769
         AH    @10,ICWCRSEG(,RWORK1)                               0769
@DE00761 STH   @10,ICWCRSEG(,RWORK1)                               0769
         LH    @00,ICWNOSEG(,RWORK1)                               0769
         BCTR  @00,0                                               0769
         CR    @10,@00                                             0769
         BNH   @DL00761                                            0769
*         RWORK3=RWORK2+RWORK2->IXHLEO;/* POINT TO INSERT POINT      */
@RF00760 LR    RWORK3,RWORK2                                       0770
         LH    @10,IXHLEO(,RWORK2)                                 0770
         ALR   RWORK3,@10                                          0770
*         RWORK3->IBFLPF=ICWCEF;    /* PLACE F INTO RECORD           */
         SLR   @10,@10                                             0771
         IC    @10,ICWCEF(,RWORK1)                                 0771
         STC   @10,IBFLPF(,RWORK3)                                 0771
*         RWORK3->IBFLPL=ICWCEL;    /* PLACE L INTO RECORD           */
         SLR   @15,@15                                             0772
         IC    @15,ICWCEL(,RWORK1)                                 0772
         STC   @15,IBFLPL(,RWORK3)                                 0772
*         RWORK2=RWORK3-ICWCEL;     /* POINT TO FIRST BYTE OF KEY  0773
*                                      POSITION IN RECD.             */
         LR    RWORK2,RWORK3                                       0773
         SLR   RWORK2,@15                                          0773
*         RWORK4=ADDR(ICWKEY1)+ICWCEF;/* POINT TO FIRST BYTE OF KEY
*                                      TO BE STORED                  */
         LA    RWORK4,ICWKEY1(,RWORK1)                             0774
         ALR   RWORK4,@10                                          0774
*         RWORK5=ICWCEL;            /* SET LENGTH                    */
         LR    RWORK5,@15                                          0775
*         RWORK3=RWORK5;            /* SAME LENGTH TO RWORK3         */
         LR    RWORK3,RWORK5                                       0776
*         GEN(MVCL  RWORK2,RWORK4); /* MOVE KEY TO RECORD            */
         MVCL  RWORK2,RWORK4
*         RESPECIFY                                                0778
*          (RWORK5) UNRSTD;         /*                               */
*         RWORK2=ICWBUFC->BUFCBAD;  /* POINT TO BUFFER               */
         L     @10,ICWBUFC(,RWORK1)                                0779
         L     RWORK2,BUFCBAD(,@10)                                0779
*         RWORK2->IXHLEO=RWORK2->IXHLEO-/* REESTABLISH NEW           */
*             ICWCEL-               /* OFFSET TO LAST                */
*             RWORK2->IXHFLPLN;     /* ENTRY                         */
         LH    @10,IXHLEO(,RWORK2)                                 0780
         SLR   @09,@09                                             0780
         IC    @09,ICWCEL(,RWORK1)                                 0780
         SLR   @10,@09                                             0780
         SLR   @09,@09                                             0780
         IC    @09,IXHFLPLN(,RWORK2)                               0780
         SLR   @10,@09                                             0780
         STH   @10,IXHLEO(,RWORK2)                                 0780
*         IF ICWVSE=OFF THEN        /* IF FIRST SECTION HAS          */
         TM    ICWVSE(RWORK1),B'00010000'                          0781
         BNZ   @RF00781                                            0781
*           RWORK2->IXHSEO=RWORK2->IXHLEO;/* NOT BEEN WRITTEN, POINT
*                                      FIRST SECTION DISPLACEMENT TO
*                                      THE DUMMY ENTRY               */
         STH   @10,IXHSEO(,RWORK2)                                 0782
*         ELSE                      /* UPDATE SECTION CHAIN          */
*           DO;                     /* AFTER FIRST SECTION           */
         B     @RC00781                                            0783
@RF00781 DS    0H                                                  0784
*             RWORK4=RWORK2+ICWPSEO;/* POINT TO SECTION ENTRY        */
         LR    RWORK4,RWORK2                                       0784
         LH    @10,ICWPSEO(,RWORK1)                                0784
         ALR   RWORK4,@10                                          0784
*             RWORK3=RWORK4-        /* POINT TO THE FORWARD          */
*                 RWORK4->IBFLPL-   /* CHAINING FIELD OF             */
*                 LENGTH(IXSELL);   /* THAT SECTION ENTRY            */
         LR    RWORK3,RWORK4                                       0785
         SLR   @10,@10                                             0785
         IC    @10,IBFLPL(,RWORK4)                                 0785
         SLR   RWORK3,@10                                          0785
         BCTR  RWORK3,0                                            0785
         BCTR  RWORK3,0                                            0785
*             RWORK4='03'X;         /* MASK FOR TWO BYTES            */
         LA    RWORK4,3                                            0786
*             RPARM1=ZERO;          /* ASSURE A CLEAN REGISTER       */
         SLR   RPARM1,RPARM1                                       0787
*             GEN(EX  RWORK4,PICKPT);/* GET PTR. FLD. IN RPARM1      */
         EX  RWORK4,PICKPT
*             RPARM1=RPARM1+ICWCEL+ /* INCREMENT THE POINTER         */
*                 RWORK2->IXHFLPLN; /* BY LENGTH OF ENTRY            */
         LR    @10,RPARM1                                          0789
         SLR   @09,@09                                             0789
         IC    @09,ICWCEL(,RWORK1)                                 0789
         ALR   @10,@09                                             0789
         SLR   @09,@09                                             0789
         IC    @09,IXHFLPLN(,RWORK2)                               0789
         ALR   @10,@09                                             0789
         LR    RPARM1,@10                                          0789
*             GEN(EX  RWORK4,STOREPT);/* REPLACE THE POINTER         */
         EX  RWORK4,STOREPT
*           END;                    /*                               */
*         IF ICWLN=ICWSSICWSPLIT=ON THEN/* SEQ SET OR SPLIT         */
@RC00781 CLC   ICWLN(2,RWORK1),@CH00053                            0792
         BE    @RT00792                                            0792
         TM    ICWSPLIT(RWORK1),B'00000010'                        0792
         BNO   @RF00792                                            0792
@RT00792 DS    0H                                                  0793
*           DO;                     /* YES                           */
*             RWORK3=RWORK2+        /* POINT TO FIRST UNUSED         */
*                 RWORK2->IXHFSO-   /* CI POINTER IN THE             */
*                 ICWPTL;           /* RECORD                        */
         LR    RWORK3,RWORK2                                       0794
         LH    @10,IXHFSO(,RWORK2)                                 0794
         ALR   RWORK3,@10                                          0794
         SLR   @10,@10                                             0794
         IC    @10,ICWPTL(,RWORK1)                                 0794
         SLR   RWORK3,@10                                          0794
*             RWORK4=RWORK2->IXHPTLS;/* GET MASK FROM HEADER         */
         SLR   RWORK4,RWORK4                                       0795
         IC    RWORK4,IXHPTLS(,RWORK2)                             0795
*             RESPECIFY                                            0796
*              (RWORK0) RSTD;       /*                               */
*             RWORK0=RWORK3;        /* SAVE LOCATION OF PTR.         */
         LR    RWORK0,RWORK3                                       0797
*             IF RWORK0^<RWORK2+LENGTH(IDAIXH) THEN/* ANY PTRS LEFT  */
         LA    @10,24                                              0798
         ALR   @10,RWORK2                                          0798
         CLR   RWORK0,@10                                          0798
         BL    @RF00798                                            0798
*               GEN(EX  RWORK4,PICKPT);/* YES, PICK UP ONE           */
         EX  RWORK4,PICKPT
*             ELSE                  /* NO                            */
*               RPARM1=AMBLDTA->AMBDSB->AMDCIPCA-ONE;/* GENERATE IT  */
         B     @RC00798                                            0800
@RF00798 L     @10,RPLDACB(,RRPL)                                  0800
         L     @10,ACBAMBL(,@10)                                   0800
         L     @10,AMBLDTA(,@10)                                   0800
         L     @10,AMBDSB(,@10)                                    0800
         LH    RPARM1,AMDCIPCA(,@10)                               0800
         BCTR  RPARM1,0                                            0800
*             RWORK3=RWORK2+        /* POINT TO THE DUMMY            */
*                 RWORK2->IXHLEO+   /* ENTRYS POINTER                */
*                 LENGTH(IBFLPF)+   /* FIELD                         */
*                 LENGTH(IBFLPL);   /*                               */
@RC00798 LR    RWORK3,RWORK2                                       0801
         LH    @10,IXHLEO(,RWORK2)                                 0801
         ALR   RWORK3,@10                                          0801
         AL    RWORK3,@CF00146                                     0801
*             GEN(EX  RWORK4,STOREPT);/* PLACE NEW DUMMY POINTER     */
         EX  RWORK4,STOREPT
*             RWORK2->IXHFSO=RWORK2->IXHFSO/* UPDATE FREESPACE       */
*                 -ICWPTL;          /* OFFSET                        */
         LH    @10,IXHFSO(,RWORK2)                                 0803
         SLR   @09,@09                                             0803
         IC    @09,ICWPTL(,RWORK1)                                 0803
         SLR   @10,@09                                             0803
         STH   @10,IXHFSO(,RWORK2)                                 0803
*             IF RWORK0^<RWORK2+LENGTH(IDAIXH) THEN/* IF HEADER IS 0804
*                                      SAFE FROM VIOLATION FOR SPLIT
*                                      CASE, THEN                    */
         LA    @10,24                                              0804
         ALR   @10,RWORK2                                          0804
         CLR   RWORK0,@10                                          0804
         BL    @RF00804                                            0804
*               DO;                 /* CLEAR PTR. JUST TAKEN         */
*                 RPARM1=ZERO;      /* CLEAR REGISTER                */
         SLR   RPARM1,RPARM1                                       0806
*                 RWORK3=RWORK0;    /* POINT BACK TO PTR AREA        */
         LR    RWORK3,RWORK0                                       0807
*                 GEN(EX  RWORK4,STOREPT);/* CLEAR USED POINTER      */
         EX  RWORK4,STOREPT
*                 RESPECIFY                                        0809
*                  (RWORK0) UNRSTD; /*                               */
*               END;                /*                               */
*             IF ICWVSE=OFF&ICWSCNT=ONE&/* FIRST ENTRY IN RECD.      */
*                 ICWSPLIT=OFF THEN /* AND CREATE MODE               */
@RF00804 TM    ICWVSE(RWORK1),B'00010000'                          0811
         BNZ   @RF00811                                            0811
         CLC   ICWSCNT(2,RWORK1),@CH00053                          0811
         BNE   @RF00811                                            0811
         TM    ICWSPLIT(RWORK1),B'00000010'                        0811
         BNZ   @RF00811                                            0811
*               CALL SETBASE;       /* SET BASE RBA          @X04SVES*/
         BAL   @14,SETBASE                                         0812
*           END;                    /*                               */
*         ELSE                      /* NOT SEQ SET LEVEL             */
*           DO;                                                    0814
         B     @RC00792                                            0814
@RF00792 DS    0H                                                  0815
*             RWORK3=AMBIWA;        /* POINT TO LOW LEVEL            */
         L     RWORK3,AMBIWA(,RAMB)                                0815
*             DO WHILE RWORK3->ICWCHN^=RWORK1;/* LOOP TO FIND PREV.  */
         B     @DE00816                                            0816
@DL00816 DS    0H                                                  0817
*               RWORK3=RWORK3->ICWCHN;/* LEVEL                       */
         L     RWORK3,ICWCHN(,RWORK3)                              0817
*             END;                  /*                               */
@DE00816 C     RWORK1,ICWCHN(,RWORK3)                              0818
         BNE   @DL00816                                            0818
*             RPARM1=(RWORK3->ICWCRBA)/AMDCINV;/* REDUCE DDDD        */
         L     @10,AMBDSB(,RAMB)                                   0819
         L     @15,ICWCRBA(,RWORK3)                                0819
         SLR   @14,@14                                             0819
         D     @14,AMDCINV(,@10)                                   0819
         LR    RPARM1,@15                                          0819
*             RWORK3=RWORK2+        /* POINT TO DUMMYS POINTER       */
*                 RWORK2->IXHLEO+   /*                               */
*                 LENGTH(IBFLPF)+   /*                               */
*                 LENGTH(IBFLPL);   /*                               */
         LR    RWORK3,RWORK2                                       0820
         LH    @10,IXHLEO(,RWORK2)                                 0820
         ALR   RWORK3,@10                                          0820
         AL    RWORK3,@CF00146                                     0820
*             RWORK4=RWORK2->IXHPTLS;/* GET MASK FROM HEADER         */
         SLR   RWORK4,RWORK4                                       0821
         IC    RWORK4,IXHPTLS(,RWORK2)                             0821
*             GEN(EX  RWORK4,STOREPT);/* MOVE IN DUMMYS PTR          */
         EX  RWORK4,STOREPT
*             RESPECIFY                                            0823
*              (RWORK2,                                            0823
*               RWORK3,                                            0823
*               RWORK4) UNRSTD;     /*                               */
*           END;                    /*                               */
*       END;                        /*                               */
@RC00792 DS    0H                                                  0826
*   CALL EXIT;                      /* RETURN                @X04SVES*/
@RC00650 DS    0H                                                  0826
@RC00645 BAL   @14,EXIT                                            0826
*                                                                  0827
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * @X04SVES*/
*   /* SETBASE SUBROUTINE                                    @X04SVES*/
*   /*                                                       @X04SVES*/
*   /* FUNCTION                                              @X04SVES*/
*   /* SETS BASE RBA IN THE INDEX RECORD ADDRESSED           @X04SVES*/
*   /* BY RWORK2. THE BASE RBA IS TAKEN FROM THE DATA        @X04SVES*/
*   /* BUFCORBA IF THE FIRST RECORD ADDRESSED IS NOT         @X04SVES*/
*   /* SPANNED. THE BASE RBA IS TAKEN FROM BUFXIRBA          @X04SVES*/
*   /* IF THE FIRST RECORD IS A SPANNED RECORD.              @X04SVES*/
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * @X04SVES*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*SETBASE:                                                          0827
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @X04SVES*/
         B     @PB00003                                            0827
SETBASE  DS    0H                                                  0828
*   RESPECIFY                                                      0828
*    (RWORK1,                                                      0828
*     RWORK2,                                                      0828
*     R14) RSTD;                    /*                       @X04SVES*/
*   IF ICWNOSEG=ZERO THEN           /* SPND RECORD           @X04SVES*/
         LH    @15,ICWNOSEG(,RWORK1)                               0829
         LTR   @15,@15                                             0829
         BNZ   @RF00829                                            0829
*     RWORK2->IXHBRBA=PLHDBUFC->BUFCORBA;/* NO, USE ORBA     @X04SVES*/
         L     @15,PLHDBUFC(,RPLH)                                 0830
         L     @15,BUFCORBA(,@15)                                  0830
         ST    @15,IXHBRBA(,RWORK2)                                0830
*   ELSE                            /* FOR SPND RECDS        @X04SVES*/
*     RWORK2->IXHBRBA=PLHDBUFC->BUFXIRBA;/* USE XIRBA        @X04SVES*/
         B     @RC00829                                            0831
@RF00829 L     @15,PLHDBUFC(,RPLH)                                 0831
         L     @15,BUFXIRBA(,@15)                                  0831
         ST    @15,IXHBRBA(,RWORK2)                                0831
*   END SETBASE;                    /* RETURN                @X04SVES*/
@EL00003 DS    0H                                                  0832
@EF00003 DS    0H                                                  0832
@ER00003 BR    @14                                                 0832
*   RESPECIFY                                                      0833
*    (RWORK1,                                                      0833
*     RWORK2,                                                      0833
*     R14) UNRSTD;                  /*                       @X04SVES*/
*                                                                  0834
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * *@X04SVES */
*   /* EXIT SUBROUTINE                                       @X04SVES*/
*   /*                                                       @X04SVES*/
*   /* FUNCTION:                                             @X04SVES*/
*   /* RESTORES REGISTER 14 FROM THE PLACEHOLDER             @X04SVES*/
*   /* PUSH DOWN LIST AND RETURNS                            @X04SVES*/
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * *@X04SVES */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0834
*EXIT:                                                             0834
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @X04SVES*/
EXIT     DS    0H                                                  0835
*   GEN(IDARST14);                  /* RESTORE R14           @X04SVES*/
         IDARST14
*   END EXIT;                       /* RETURN                @X04SVES*/
@EL00004 DS    0H                                                  0836
@EF00004 DS    0H                                                  0836
@ER00004 BR    @14                                                 0836
@PB00004 DS    0H                                                  0837
*   GEN;                                                           0837
*                                          /*                        */
PICKPT   ICM   RPARM1,@00,@00(RWORK3)      /* OBTAINS POINTER        */
STOREPT  STCM  RPARM1,@00,@00(RWORK3)      /* STORES POINTER         */
*   GEN(IDAPATCH);                  /*                               */
         IDAPATCH
*   END IDA019RG                    /*                               */
*                                                                  0839
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */
*/*%INCLUDE SYSLIB  (IDAARDB )                                       */
*/*%INCLUDE SYSLIB  (IDAICWA )                                       */
*/*%INCLUDE SYSLIB  (IDAIRD  )                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */
*                                                                  0839
*       ;                                                          0839
@EL00001 DS    0H                                                  0839
@EF00001 DS    0H                                                  0839
@ER00001 BR    @14                                                 0839
@DATA    DS    0H
@CH00083 DC    H'24'
@DATD    DSECT
         DS    0F
IDA019RG CSECT
         DS    0F
@CF00053 DC    F'1'
@CH00053 EQU   @CF00053+2
@CF00146 DC    F'2'
@CF00159 DC    F'3'
@CF00199 DC    F'7'
@CF00958 DC    F'256'
@CF01050 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
IDA019RG CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00988 DC    A(IDAIST)
@CV00945 DC    V(IDAAQR)
@CV00946 DC    V(IDAEOVIF)
@CV00947 DC    V(IDAFREEB)
@CV00948 DC    V(IDAGNFL)
@CV00949 DC    V(IDAR)
@CV00950 DC    V(IDASPNPT)
@CV00951 DC    V(IDAWR)
@CV00952 DC    V(IDAER)
         DS    0D
HWORD4   DC    H'4'
@DATD    DSECT
*                                                          /*@X04SVLC*/
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/
RDFLEN   EQU   3                        LENGTH OF RDF
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDA019RG CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RWORK0   EQU   @00
RRPL     EQU   @01
R1       EQU   @01
RPLH     EQU   @02
RAMB     EQU   @03
RBUFC    EQU   @04
RWORK1   EQU   @05
RWORK2   EQU   @06
RWORK3   EQU   @07
RWORK4   EQU   @08
RWORK5   EQU   @09
RPARM1   EQU   @12
R14      EQU   @14
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLERREG EQU   RPLRTNCD
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLDACB  EQU   RPLCOMN+24
RPLAREA  EQU   RPLCOMN+32
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
IDAAMBL  EQU   0
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLSHAR EQU   IDAAMBL+33
AMBLFLG1 EQU   IDAAMBL+35
AMBLCAT  EQU   AMBLFLG1
AMBLFLG2 EQU   IDAAMBL+36
AMBLDTA  EQU   IDAAMBL+52
AMBLIX   EQU   IDAAMBL+56
IDAPLHDR EQU   0
IDAPLH   EQU   0
PLHFLG1  EQU   IDAPLH+2
PLHFLG2  EQU   IDAPLH+3
PLHKRE   EQU   PLHFLG2
PLHEFLGS EQU   IDAPLH+4
PLHFLG3  EQU   IDAPLH+6
PLHAFLGS EQU   IDAPLH+7
PLHCRPL  EQU   IDAPLH+20
PLHCRBA  EQU   IDAPLH+28
PLHJORBA EQU   PLHCRBA
PLHJCODE EQU   IDAPLH+40
PLHEOVR  EQU   IDAPLH+42
PLHARDB  EQU   IDAPLH+44
PLHLRECL EQU   IDAPLH+48
PLHDBUFC EQU   IDAPLH+52
PLHDIOB  EQU   IDAPLH+76
PLHSAVE1 EQU   IDAPLH+84
PLHSAVE2 EQU   IDAPLH+88
PLHRETO  EQU   IDAPLH+116
PLHRET1  EQU   IDAPLH+120
PLHEOVPT EQU   IDAPLH+180
PLHIXSPL EQU   IDAPLH+200
PLHSSRBA EQU   PLHIXSPL
PLHWAX   EQU   IDAPLH+232
PLHNOSEG EQU   IDAPLH+240
PLHKEYPT EQU   IDAPLH+248
PLHEND   EQU   IDAPLH+280
PLHKEY   EQU   0
IDABUFDR EQU   0
BUFDRCIX EQU   IDABUFDR+9
BUFDRFLG EQU   IDABUFDR+11
IDABUFC  EQU   0
BUFCAVL  EQU   IDABUFC
BUFCFLG1 EQU   IDABUFC+1
BUFCVAL  EQU   BUFCFLG1
BUFCEXC  EQU   BUFCFLG1
BUFCIOFL EQU   IDABUFC+2
BUFCMW   EQU   BUFCIOFL
BUFCFLG2 EQU   IDABUFC+3
BUFCPLH  EQU   IDABUFC+4
BUFCDDDD EQU   IDABUFC+8
BUFCORBA EQU   IDABUFC+12
BUFCBAD  EQU   IDABUFC+20
BUFCINV  EQU   IDABUFC+28
BUFXIRBA EQU   IDABUFC+40
IDACIDF  EQU   0
CIDFOSET EQU   IDACIDF
CIDFLL   EQU   IDACIDF+2
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDCIPCA EQU   IDAAMDSB+12
AMDCINV  EQU   IDAAMDSB+20
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
AMDNIL   EQU   AMDSTAT+8
IDAARDB  EQU   0
ARDTYPE  EQU   IDAARDB+1
ARDKR    EQU   ARDTYPE
ARDPRF   EQU   IDAARDB+28
IDAICWA  EQU   0
ICWID    EQU   IDAICWA
ICWFLG1  EQU   IDAICWA+1
ICWWNF   EQU   ICWFLG1
ICWWAGM  EQU   ICWFLG1
ICWVSE   EQU   ICWFLG1
ICWVNE   EQU   ICWFLG1
ICWKRDS  EQU   ICWFLG1
ICWSPLIT EQU   ICWFLG1
ICWENDRQ EQU   ICWFLG1
ICWLEN   EQU   IDAICWA+2
ICWCHN   EQU   IDAICWA+4
ICWBUFC  EQU   IDAICWA+8
ICWCRBA  EQU   IDAICWA+12
ICWPRBA  EQU   IDAICWA+16
ICWPSEO  EQU   IDAICWA+20
ICWSCNT  EQU   IDAICWA+22
ICWADD   EQU   IDAICWA+24
ICWLN    EQU   IDAICWA+40
ICWKEY1L EQU   IDAICWA+42
ICWKEY2L EQU   IDAICWA+44
ICWKEY3L EQU   IDAICWA+46
ICWNEST  EQU   IDAICWA+48
ICWNOSEG EQU   IDAICWA+50
ICWCRSEG EQU   IDAICWA+52
ICWREQ   EQU   IDAICWA+54
ICWPTL   EQU   IDAICWA+55
ICWCER   EQU   IDAICWA+56
ICWCEF   EQU   IDAICWA+57
ICWCEL   EQU   IDAICWA+58
ICWCERP  EQU   IDAICWA+59
ICWKEY1  EQU   IDAICWA+60
IDAIXH   EQU   0
IXHLL    EQU   IDAIXH
IXHFLPLN EQU   IDAIXH+2
IXHPTLS  EQU   IDAIXH+3
IXHBRBA  EQU   IDAIXH+4
IXHHP    EQU   IDAIXH+8
IXHLV    EQU   IDAIXH+16
IXHFSO   EQU   IDAIXH+18
IXHLEO   EQU   IDAIXH+20
IXHSEO   EQU   IDAIXH+22
IDAIBFLP EQU   0
IBFLPF   EQU   IDAIBFLP
IBFLPL   EQU   IDAIBFLP+1
IBFLP3   EQU   IDAIBFLP+2
IBFLP2   EQU   IBFLP3
IDASELL  EQU   0
IXSELL   EQU   IDASELL
IDAIXK   EQU   0
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMB   EQU   0
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBFLG1  EQU   IDAAMB+25
AMBDSORG EQU   IDAAMB+26
AMBIOBAD EQU   IDAAMB+28
AMBINFL  EQU   IDAAMB+42
AMBDEBPT EQU   IDAAMB+44
AMBOFLGS EQU   IDAAMB+48
AMBFLG2  EQU   IDAAMB+49
AMBEOVPT EQU   IDAAMB+56
AMBIWA   EQU   IDAAMB+64
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
IDARDF   EQU   0
RDFRBYTE EQU   IDARDF
RDFSEG   EQU   RDFRBYTE
RDFLL    EQU   IDARDF+1
IDADATA  EQU   0
IDAKEY   EQU   0
ICWKEY2  EQU   0
ICWKEY3  EQU   0
PLHPDL   EQU   0
PLHPDLE  EQU   0
PLHRRN   EQU   0
PLHEXTEN EQU   PLHEND
PLHBMWRK EQU   PLHEXTEN+5
BUFCRSC1 EQU   BUFCAVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PLHBMSV5 EQU   PLHEXTEN+24
PLHBMSV4 EQU   PLHEXTEN+20
PLHBMSV3 EQU   PLHEXTEN+16
PLHBMSV2 EQU   PLHEXTEN+12
PLHBMSV1 EQU   PLHEXTEN+8
PLHRDCNT EQU   PLHEXTEN+6
PLHBMSOV EQU   PLHBMWRK
PLHBEUC  EQU   PLHBMWRK
PLHBMRDF EQU   PLHBMWRK
@NM00018 EQU   PLHEXTEN+4
PLHRESR1 EQU   PLHEXTEN
KEY      EQU   IDAKEY
AMDATA   EQU   IDADATA
RDFEMPTY EQU   RDFRBYTE
RDFREPL  EQU   RDFRBYTE
RDF1ST   EQU   RDFSEG
RDFNOT1  EQU   RDFSEG
RDFCTNU  EQU   RDFRBYTE
RDFTYPE  EQU   RDFRBYTE
AMBTRACE EQU   IDAAMB+120
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBCPA   EQU   IDAAMB+92
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00047 EQU   AMBCSWD1+1
@NM00046 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
AMBLSR   EQU   AMBAFLG
@NM00045 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
AMBPAMBL EQU   IDAAMB+76
AMBPIXP  EQU   IDAAMB+72
@NM00044 EQU   IDAAMB+68
AMBWKA   EQU   IDAAMB+60
AMBAMBXN EQU   AMBEOVPT
AMBEDB   EQU   IDAAMB+52
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
AMBEXFG  EQU   AMBOFLGS
@NM00043 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00042 EQU   AMBOFLGS
AMBDEBAD EQU   AMBDEBPT+1
AMBIFLGS EQU   AMBDEBPT
AMBAMETH EQU   IDAAMB+43
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00041 EQU   AMBINFL
@NM00040 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00039 EQU   IDAAMB+38
AMBDDSN  EQU   IDAAMB+35
AMBCDSN  EQU   IDAAMB+32
AMBIOMB  EQU   AMBIOBAD
@NM00038 EQU   AMBDSORG+1
AMBDORGA EQU   AMBDSORG+1
@NM00037 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBTYPE  EQU   AMBFLG1
AMBCREAT EQU   AMBFLG1
@NM00036 EQU   AMBFLG0
AMBPSDS  EQU   AMBFLG0
AMBCACB  EQU   IDAAMB+16
AMBPH    EQU   IDAAMB+12
AMBBUFC  EQU   IDAAMB+8
AMBLINK  EQU   IDAAMB+4
AMBLEN   EQU   IDAAMB+2
AMBRSC   EQU   IDAAMB+1
AMBID    EQU   IDAAMB
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00035 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBVVIC  EQU   ACBINFLG
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00034 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00033 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00032 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00031 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00030 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00029 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00028 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00027 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00026 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
IXKEY    EQU   IDAIXK
IBFLP1   EQU   IBFLP2
IXHFLGS  EQU   IDAIXH+17
IXHXX    EQU   IDAIXH+12
ICWARDBP EQU   IDAICWA+36
ICWTPTR  EQU   IDAICWA+32
ICWTBASE EQU   IDAICWA+28
ICWRBAOK EQU   ICWFLG1
ARDKEYS  EQU   IDAARDB+29
@NM00025 EQU   ARDPRF
ARDPRFMT EQU   ARDPRF
ARDPRSS  EQU   ARDPRF
ARDRELNO EQU   IDAARDB+26
ARDVOLSR EQU   IDAARDB+20
ARDERBA  EQU   IDAARDB+16
ARDHRBA  EQU   IDAARDB+12
ARDHKRBA EQU   IDAARDB+8
ARDNPTR  EQU   IDAARDB+4
ARDLEN   EQU   IDAARDB+2
ARDUSED  EQU   ARDTYPE
ARDEOD   EQU   ARDTYPE
ARDUOVFL EQU   ARDTYPE
ARDSS    EQU   ARDTYPE
ARDHLI   EQU   ARDTYPE
ARDID    EQU   IDAARDB
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDSTSP  EQU   AMDSTAT
@NM00024 EQU   IDAAMDSB+41
@NM00023 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
@NM00022 EQU   CIDFLL
CIDFBUSY EQU   CIDFLL
BUFCEND  EQU   IDABUFC+64
BUFCUCDN EQU   IDABUFC+60
BUFCUCUP EQU   IDABUFC+56
BUFCMDBT EQU   IDABUFC+52
BUFCHAIN EQU   IDABUFC+48
BUFXORBA EQU   IDABUFC+44
BUFCNXT2 EQU   IDABUFC+37
BUFCIDXL EQU   IDABUFC+36
BUFCDSPC EQU   IDABUFC+32
BUFCWLEN EQU   BUFCINV
BUFCNXT1 EQU   IDABUFC+24
BUFCCPA  EQU   IDABUFC+16
BUFCAMB  EQU   BUFCPLH
@NM00021 EQU   BUFCFLG2
BUFCEOD  EQU   BUFCFLG2
BUFCBSYW EQU   BUFCFLG2
BUFCBSYR EQU   BUFCFLG2
BUFCNLAS EQU   BUFCFLG2
BUFCXDDR EQU   BUFCFLG2
BUFCFIX  EQU   BUFCIOFL
BUFCPFCP EQU   BUFCIOFL
BUFCXEDB EQU   BUFCIOFL
BUFCWC   EQU   BUFCIOFL
BUFCREAL EQU   BUFCIOFL
BUFCRRD  EQU   BUFCIOFL
BUFCFMT  EQU   BUFCIOFL
BUFCEPT  EQU   BUFCFLG1
BUFCER2  EQU   BUFCFLG1
BUFCER1  EQU   BUFCFLG1
BUFCINS  EQU   BUFCFLG1
BUFCSEG  EQU   BUFCFLG1
BUFCUPG  EQU   BUFCFLG1
BUFCUCNT EQU   BUFCAVL
@NM00020 EQU   IDABUFDR+16
BUFDBUFC EQU   IDABUFDR+12
@NM00019 EQU   BUFDRFLG
BUFDRAVL EQU   BUFDRFLG
BUFDRREL EQU   BUFDRFLG
BUFDRTSB EQU   IDABUFDR+10
BUFDRMAX EQU   BUFDRCIX
BUFDRPFN EQU   IDABUFDR+8
BUFDRPFB EQU   IDABUFDR+4
BUFDRLEN EQU   IDABUFDR+2
BUFDRNO  EQU   IDABUFDR+1
BUFDRID  EQU   IDABUFDR
PLHERRET EQU   IDAPLH+276
PLHASCB  EQU   IDAPLH+272
PLHECB   EQU   IDAPLH+268
@NM00017 EQU   IDAPLH+265
PLHDRMSK EQU   IDAPLH+264
PLHR13   EQU   IDAPLH+260
PLHPARM1 EQU   IDAPLH+256
PLHDRRSC EQU   IDAPLH+252
PLHSLRBA EQU   IDAPLH+244
PLHSRCSG EQU   IDAPLH+242
PLHLLOR  EQU   IDAPLH+236
PLHXPLH  EQU   PLHWAX
@NM00016 EQU   PLHIXSPL+8
PLHIXBFC EQU   PLHIXSPL+4
PLHHIREC EQU   PLHSSRBA
PLHISPLP EQU   IDAPLH+196
PLHRBUFC EQU   IDAPLH+192
PLHIBUFC EQU   IDAPLH+188
PLHNRBA  EQU   IDAPLH+184
PLHDDDD  EQU   PLHEOVPT
PLHAR14  EQU   IDAPLH+176
@NM00015 EQU   IDAPLH+172
@NM00014 EQU   IDAPLH+168
PLHASAVE EQU   IDAPLH+164
PLHRETOS EQU   IDAPLH+118
PLHCHAIN EQU   IDAPLH+112
PLHAMB   EQU   IDAPLH+108
PLHSAVE6 EQU   IDAPLH+104
PLHSAVE5 EQU   IDAPLH+100
PLHSAVE4 EQU   IDAPLH+96
PLHSAVE3 EQU   IDAPLH+92
PLHARET  EQU   IDAPLH+80
PLHIIOB  EQU   PLHDIOB
PLHSRSID EQU   IDAPLH+74
PLHRDFC  EQU   IDAPLH+72
PLHRDFP  EQU   IDAPLH+68
PLHFSP   EQU   IDAPLH+64
PLHRECP  EQU   IDAPLH+60
PLHNBUFC EQU   IDAPLH+56
@NM00013 EQU   IDAPLH+43
PLHRCODE EQU   IDAPLH+41
PLHUCODE EQU   PLHJCODE
PLHJNRBA EQU   IDAPLH+36
PLHJRNLL EQU   IDAPLH+32
PLHUPECB EQU   PLHJORBA
PLHDSIDA EQU   IDAPLH+24
PLHMRPL  EQU   IDAPLH+16
PLHBFRNO EQU   IDAPLH+15
PLHFRCNT EQU   IDAPLH+14
PLHRMIN  EQU   IDAPLH+13
PLHDSTYP EQU   IDAPLH+12
PLHACB   EQU   IDAPLH+8
PLHRAE   EQU   PLHAFLGS
PLHRABWD EQU   PLHAFLGS
PLHIOSID EQU   PLHAFLGS
PLHDBDC  EQU   PLHAFLGS
PLHVAMB  EQU   PLHAFLGS
PLHIOSRQ EQU   PLHAFLGS
PLHDRLM  EQU   PLHAFLGS
PLHEOVDF EQU   PLHFLG3
PLHRVRS  EQU   PLHFLG3
PLHBWD   EQU   PLHFLG3
PLHSLVLD EQU   PLHFLG3
PLHRAHD  EQU   PLHFLG3
PLHSRBSG EQU   PLHFLG3
@NM00012 EQU   PLHEFLGS+1
PLHRSTRT EQU   PLHEFLGS+1
PLHDSCAN EQU   PLHEFLGS
PLHINVAL EQU   PLHEFLGS
PLHEODX  EQU   PLHEFLGS
PLHNOADV EQU   PLHEFLGS
PLHSRINV EQU   PLHEFLGS
PLHSKPER EQU   PLHEFLGS
PLH1ST   EQU   PLHEFLGS
PLHNOSPC EQU   PLHEFLGS
PLHIWAIT EQU   PLHFLG2
PLHSVADV EQU   PLHFLG2
PLHCIINS EQU   PLHFLG2
PLHADDTE EQU   PLHFLG2
PLHKEYMD EQU   PLHFLG2
PLHSQINS EQU   PLHFLG2
PLHUPD   EQU   PLHFLG2
@NM00011 EQU   PLHFLG1
PLHDRPND EQU   PLHFLG1
PLHASYRQ EQU   PLHFLG1
PLHRDEXC EQU   PLHFLG1
PLHSSR   EQU   PLHFLG1
PLHASKBF EQU   PLHFLG1
PLHENDRQ EQU   PLHFLG1
PLHEOVW  EQU   PLHFLG1
PLHATV   EQU   IDAPLH+1
PLHAVL   EQU   IDAPLH
PLHIOSDQ EQU   IDAPLHDR+12
PLHDRCUR EQU   IDAPLHDR+10
PLHDRMAX EQU   IDAPLHDR+8
PLHDRREQ EQU   IDAPLHDR+4
PLHELTH  EQU   IDAPLHDR+2
PLHCNT   EQU   IDAPLHDR+1
PLHID    EQU   IDAPLHDR
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00010 EQU   IDAAMBL+40
AMBLNUM  EQU   IDAAMBL+38
AMBLNST  EQU   IDAAMBL+37
@NM00009 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00008 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLVVIC EQU   AMBLFLG1
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
AMBLLEN  EQU   IDAAMBL+34
@NM00007 EQU   AMBLSHAR
AMBLWRIT EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
AMBLID   EQU   IDAAMBL+32
@NM00006 EQU   IDAAMBL+31
@NM00005 EQU   AMBLTYPE
AMBLFIX  EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00004 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLACB  EQU   IDAAMBL+8
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00003 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00002 EQU   RPLRBAR+3
@NM00001 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLRLEN  EQU   RPLCOMN+48
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLWAITX EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLTCBPT EQU   RPLCOMN+28
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00234 EQU   @RC00228
@RF00397 EQU   @RC00381
@RC00528 EQU   @RC00524
@PB00002 EQU   @EC00579
@RF00637 EQU   @RC00633
@RF00681 EQU   @RC00677
@RF00714 EQU   @RC00702
@RF00811 EQU   @RC00792
@RC00829 EQU   @EL00003
@PB00003 EQU   @PB00004
@ENDDATA EQU   *
         END   IDA019RG,(C'PLS2014',0701,78172)

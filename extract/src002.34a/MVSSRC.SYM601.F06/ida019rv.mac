         TITLE 'IDA019RV LOCATE PREVIOUS SEQUENCE SET                  *
                        '
IDA019RV CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IDA019RV  78.172'                                 0001
IDAADVPH DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00331-IDAADVPH)
         ENTRY IDAADVPH
IDARVRS1 DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00460-IDARVRS1)
         ENTRY IDARVRS1
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
         IDASVR14
*   RAMB=AMBLIX;                    /* ASSURE INDEX BLOCKS ARE     0154
*                                      ADDRESSED                     */
         L     @10,RPLDACB(,RRPL)                                  0154
         L     @10,ACBAMBL(,@10)                                   0154
         L     RAMB,AMBLIX(,@10)                                   0154
*   IF PLHSLVLD=ON THEN             /* DOES A VALID 2ND LEVEL INDEX
*                                      EXIST                         */
         TM    PLHSLVLD(RPLH),B'00100000'                          0155
         BNO   @RF00155                                            0155
*     DO;                           /* YES                           */
*       RPARM1=ADDR(PLHIXSPL);      /* POINT TO INDEX LIST           */
         LA    RPARM1,PLHIXSPL(,RPLH)                              0157
*       RPARM1->IXSILN=TWO;         /* SET LEVEL TO 2                */
         MVI   IXSILN(RPARM1),X'02'                                0158
*       RPARM1=PLHSLRBA;            /* GET ITS RBA                   */
         L     RPARM1,PLHSLRBA(,RPLH)                              0159
*I01:                                                              0160
*       DO;                         /* IDACALL(IDAGRB)               */
I01      DS    0H                                                  0161
*         CALL IDAGRB;              /* EXIT TO IDAGRB                */
         L     @15,@CV00908                                        0161
         BALR  @14,@15                                             0161
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I01;                    /* GO READ IT                    */
*       IF RPLERREG^=ZERO THEN      /* I/O ERROR ENCOUNTERED         */
         CLI   RPLERREG(RRPL),0                                    0167
         BE    @RF00167                                            0167
*         CALL EXIT;                /* YES, RETURN TO CALLER         */
         BAL   @14,EXIT                                            0168
*       PLHSAVE6=RBUFC;             /* SAVE BUFC OF RECORD           */
@RF00167 ST    RBUFC,PLHSAVE6(,RPLH)                               0169
*       RBUFC=BUFCBAD;              /* GET ADDRESS OF INDEX RECORD   */
         L     RBUFC,BUFCBAD(,RBUFC)                               0170
*       RPARM1=ADDR(PLHKEY);        /* POINT TO ARGUMENT             */
         L     RPARM1,PLHKEYPT(,RPLH)                              0171
*       RESPECIFY                                                  0172
*         RWORK3 RSTD;              /*                               */
*       RWORK3=PLHISPLP;            /* POINT TO INDEX SEARCH       0173
*                                      PARAMETER LIST                */
         L     RWORK3,PLHISPLP(,RPLH)                              0173
*I02:                                                              0174
*       DO;                         /* IDACALL(IDA019RC)             */
I02      DS    0H                                                  0175
*         CALL IDA019RC;            /* EXIT TO IDA019RC              */
         L     @15,@CV00911                                        0175
         BALR  @14,@15                                             0175
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I02;                    /* SEARCH INDEX RECORD           */
*       RESPECIFY                                                  0181
*         R15 RSTD;                 /*                               */
*       IF R15=ZERO THEN            /* DID A HIT OCCUR               */
         LTR   R15,R15                                             0182
         BNZ   @RF00182                                            0182
*         DO;                       /* YES                           */
*           CALL BACKUP;            /* GO SEE IF AN ENTRY PRECEEDS 0184
*                                      HIT ENTRY                     */
         BAL   @14,BACKUP                                          0184
*           IF R15=ZERO THEN        /* DOES ONE EXIST                */
         LTR   R15,R15                                             0185
         BNZ   @RF00185                                            0185
*             DO;                   /* YES                           */
*               RESPECIFY                                          0187
*                 R15 UNRSTD;       /*                               */
*               PLHSAVE2=RPARM1;    /* SAVE RBA OF N-FIRST           */
         ST    RPARM1,PLHSAVE2(,RPLH)                              0188
*               RBUFC=PLHSAVE6;     /* POINT TO CURRENT BUFC         */
         L     RBUFC,PLHSAVE6(,RPLH)                               0189
*               CALL READSS;        /* READ SEQUENCE SET AND THEN  0190
*                                      EXIT                          */
         BAL   @14,READSS                                          0190
*             END;                  /* END OF N-1 FOUND              */
*         END;                      /* END OF HIT ON SCIB            */
@RF00185 DS    0H                                                  0193
*       RESPECIFY                                                  0193
*         RWORK3 UNRSTD;            /*                               */
@RF00182 DS    0H                                                  0194
*       PLHSLVLD=OFF;               /* SHOW 2ND LEVEL INVALID        */
         NI    PLHSLVLD(RPLH),B'11011111'                          0194
*       RBUFC=PLHSAVE6;             /* REESTABLISH BUFC              */
         L     RBUFC,PLHSAVE6(,RPLH)                               0195
*I03:                                                              0196
*       DO;                         /* IDACALL(IDAFREEB)             */
I03      DS    0H                                                  0197
*         CALL IDAFREEB;            /* EXIT TO IDAFREEB              */
         L     @15,@CV00906                                        0197
         BALR  @14,@15                                             0197
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I03;                    /* FREE THE BUFFER               */
*     END;                          /* END OF SEARCH OF EXISTING   0203
*                                      SECOND LEVEL                  */
*   IF AMDNIL^>ONE THEN             /* IS THERE MORE THAN ONE INDEX
*                                      LEVEL                         */
@RF00155 L     @10,AMBDSB(,RAMB)                                   0204
         LH    @10,AMDNIL(,@10)                                    0204
         C     @10,@CF00053                                        0204
         BH    @RF00204                                            0204
*     DO;                           /* NO                            */
*       RESPECIFY                                                  0206
*         R15 RSTD;                 /*                               */
*       R15=FOUR;                   /* SHOW NO PREVIOUS SEQ SET CAN
*                                      BE FOUND                      */
         LA    R15,4                                               0207
*       CALL EXIT;                  /* RETURN TO CALLER              */
         BAL   @14,EXIT                                            0208
*       RESPECIFY                                                  0209
*         R15 UNRSTD;               /*                               */
*     END;                          /*                               */
*   RPARM1=AMDHLRBA;                /* GET RBA OF HI LEVEL INDEX   0211
*                                      RECORD                        */
@RF00204 L     @10,AMBDSB(,RAMB)                                   0211
         L     RPARM1,AMDHLRBA(,@10)                               0211
*   PLHSAVE4=RPARM1;                /* SAVE CURRENT RECORD RBA       */
         ST    RPARM1,PLHSAVE4(,RPLH)                              0212
*   PLHSAVE1=ZERO;                  /* SHOW NO N-1 FOUND YET         */
         SLR   @05,@05                                             0213
         ST    @05,PLHSAVE1(,RPLH)                                 0213
*   PLHSAVE5=ZERO;                  /* FORCE THROUGH FOLLOWING LOOP
*                                      AT LEAST ONCE                 */
         ST    @05,PLHSAVE5(,RPLH)                                 0214
*   RFY                                                            0215
*     R14 RSTD;                     /*                               */
*   R14=ADDR(PLHIXSPL);             /* POINT TO INX PARM LIST        */
         LA    R14,PLHIXSPL(,RPLH)                                 0216
*   R14->IXSILN=AMDNIL;             /* SET HI LEVEL IN LIST          */
         LH    @15,AMDNIL(,@10)                                    0217
         STC   @15,IXSILN(,R14)                                    0217
*   RFY                                                            0218
*     R14 UNRSTD;                   /*                               */
*   DO WHILE PLHSAVE5^=TWO;         /* LOOP UNTIL LEVEL TWO HAS BEEN
*                                      PROCESSED                     */
         B     @DE00219                                            0219
@DL00219 DS    0H                                                  0220
*     PLHSAVE3=PLHSAVE4;            /* REMEMBER RBA OF RECORD        */
         L     @10,PLHSAVE4(,RPLH)                                 0220
         ST    @10,PLHSAVE3(,RPLH)                                 0220
*I04:                                                              0221
*     DO;                           /* IDACALL(IDAGRB)               */
I04      DS    0H                                                  0222
*       CALL IDAGRB;                /* EXIT TO IDAGRB                */
         L     @15,@CV00908                                        0222
         BALR  @14,@15                                             0222
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */
         USING *,@11
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*     END I04;                      /* READ INDEX RECORD             */
*     IF RPLERREG^=ZERO THEN        /* I/O ERROR ON READ             */
         CLI   RPLERREG(RRPL),0                                    0228
         BE    @RF00228                                            0228
*       CALL EXIT;                  /* YES, RETURN TO CALLER         */
         BAL   @14,EXIT                                            0229
*     PLHSAVE6=RBUFC;               /* SAVE BUFC ADDRESS             */
@RF00228 ST    RBUFC,PLHSAVE6(,RPLH)                               0230
*     RBUFC=BUFCBAD;                /* POINT TO RECORD               */
         L     RBUFC,BUFCBAD(,RBUFC)                               0231
*     RPARM1=ADDR(PLHKEY);          /* POINT TO ARGUMENT             */
         L     RPARM1,PLHKEYPT(,RPLH)                              0232
*     RESPECIFY                                                    0233
*       RWORK3 RSTD;                /*                               */
*     RWORK3=PLHISPLP;              /* SET ADDRESS OF INDEX SEARCH 0234
*                                      PARAMETER LIST                */
         L     RWORK3,PLHISPLP(,RPLH)                              0234
*I05:                                                              0235
*     DO;                           /* IDACALL(IDA019RC)             */
I05      DS    0H                                                  0236
*       CALL IDA019RC;              /* EXIT TO IDA019RC              */
         L     @15,@CV00911                                        0236
         BALR  @14,@15                                             0236
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */
         USING *,@11
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*     END I05;                      /* SEARCH INDEX RECORD           */
*     RESPECIFY                                                    0242
*      (RWORK3,                                                    0242
*       R15) RSTD;                  /*                               */
*     IF R15^=ZERO THEN             /* DID A HIT OCCUR               */
         LTR   R15,R15                                             0243
         BZ    @RF00243                                            0243
*       DO;                         /* NO, SEARCH HORIZONTALLY       */
*         PLHSAVE4=RBUFC->IXHHP;    /* SET RBA FROM HEADER           */
         L     @14,IXHHP(,RBUFC)                                   0245
         ST    @14,PLHSAVE4(,RPLH)                                 0245
*       END;                        /*                               */
*     ELSE                          /* HIT ON SEARCH                 */
*       DO;                         /*                               */
         B     @RC00243                                            0247
@RF00243 DS    0H                                                  0248
*         CALL BACKUP;              /* GO FIND IF A PREVIOUS ENTRY 0248
*                                      EXISTS PRIOR TO THE HIT ENTRY */
         BAL   @14,BACKUP                                          0248
*         IF R15=ZERO THEN          /* DOES ONE EXIST                */
         LTR   R15,R15                                             0249
         BNZ   @RF00249                                            0249
*           DO;                     /* YES                           */
*             PLHSAVE1=RBUFC->IXHLV;/* INDICATE AN N-1 FOUND         */
         SLR   @14,@14                                             0251
         IC    @14,IXHLV(,RBUFC)                                   0251
         ST    @14,PLHSAVE1(,RPLH)                                 0251
*             PLHSAVE2=RPARM1;      /* SAVE RBA OF N-1 ENTRY         */
         ST    RPARM1,PLHSAVE2(,RPLH)                              0252
*           END;                    /*                               */
*         RESPECIFY                                                0254
*           R15 UNRSTD;             /*                               */
@RF00249 DS    0H                                                  0255
*         RESPECIFY                                                0255
*          (RWORK1,                                                0255
*           RWORK2,                                                0255
*           RWORK4) RSTD;           /*                               */
*         RWORK1=ZERO;              /* CLEAR REGISTER FOR PTR.       */
         SLR   RWORK1,RWORK1                                       0256
*         RWORK4=IXSHEP+LENGTH(IBFLPF)+/* GET ADDRESS OF POINTER     */
*             LENGTH(IBFLPL);       /* FIELD                         */
         LA    RWORK4,2                                            0257
         AL    RWORK4,IXSHEP(,RWORK3)                              0257
*         RWORK2=RBUFC->IXHPTLS;    /* GET MASK FROM HEADER          */
         SLR   RWORK2,RWORK2                                       0258
         IC    RWORK2,IXHPTLS(,RBUFC)                              0258
*         GEN;                                                     0259
*                                          /*                        */
     EX      RWORK2,INSERT                 /* PICK UP PTR. IN RWORK3 */
*         PLHSAVE4=RWORK1*AMDCINV+  /* CONVERT POINTER TO AN         */
*             RBUFC->IXHBRBA;       /* RBA AND SAVE IT               */
         L     @10,AMBDSB(,RAMB)                                   0260
         LR    @15,RWORK1                                          0260
         M     @14,AMDCINV(,@10)                                   0260
         AL    @15,IXHBRBA(,RBUFC)                                 0260
         ST    @15,PLHSAVE4(,RPLH)                                 0260
*         RFY                                                      0261
*          (RWORK1,                                                0261
*           RWORK2,                                                0261
*           RWORK3,                                                0261
*           RWORK4) UNRSTD;         /*                               */
*         PLHSAVE5=RBUFC->IXHLV;    /* OBTAIN LEVEL NO.              */
         SLR   @10,@10                                             0262
         IC    @10,IXHLV(,RBUFC)                                   0262
         ST    @10,PLHSAVE5(,RPLH)                                 0262
*         RBUFC=ADDR(PLHIXSPL);     /* POINT TO INX PARM LIST        */
         LA    RBUFC,PLHIXSPL(,RPLH)                               0263
*         RBUFC->IXSILN=PLHSAVE5-ONE;/* SET NEXT LEVEL NO.           */
         BCTR  @10,0                                               0264
         STC   @10,IXSILN(,RBUFC)                                  0264
*       END;                        /*                               */
*     RBUFC=PLHSAVE6;               /* REESTABLISH RBUFC             */
@RC00243 L     RBUFC,PLHSAVE6(,RPLH)                               0266
*     IF PLHSAVE5^=TWO×PLHSAVE1>TWO THEN/* FREE BUFFER WHEN NOT 2ND
*                                      LEVEL INDEX OR WHEN PREVIOUS
*                                      ENTRY WAS FOUND               */
         LA    @10,2                                               0267
         C     @10,PLHSAVE5(,RPLH)                                 0267
         BNE   @RT00267                                            0267
         C     @10,PLHSAVE1(,RPLH)                                 0267
         BNL   @RF00267                                            0267
@RT00267 DS    0H                                                  0268
*I06:                                                              0268
*       DO;                         /* IDACALL(IDAFREEB)             */
I06      DS    0H                                                  0269
*         CALL IDAFREEB;            /* EXIT TO IDAFREEB              */
         L     @15,@CV00906                                        0269
         BALR  @14,@15                                             0269
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I06;                    /* FREE INDEX BUFFER             */
*     RPARM1=PLHSAVE4;              /* PICK UP RBA OF RECORD TO BE 0275
*                                      READ                          */
@RF00267 L     RPARM1,PLHSAVE4(,RPLH)                              0275
*   END;                            /*                               */
@DE00219 CLC   PLHSAVE5(4,RPLH),@CF00155                           0276
         BNE   @DL00219                                            0276
*   PLHSLVLD=ON;                    /* SHOW 2ND LEVEL INDEX RECORD IS
*                                      VALID                         */
         OI    PLHSLVLD(RPLH),B'00100000'                          0277
*   PLHSLRBA=PLHSAVE3;              /* SAVE RBA OF 2ND LEVEL         */
         L     @10,PLHSAVE3(,RPLH)                                 0278
         ST    @10,PLHSLRBA(,RPLH)                                 0278
*   IF PLHSAVE1=ZERO THEN           /* HAS ANY N-1 ENTRY BEEN FOUND  */
         L     @10,PLHSAVE1(,RPLH)                                 0279
         LTR   @10,@10                                             0279
         BNZ   @RF00279                                            0279
*     DO;                           /* NO                            */
*       IF PLHSAVE4=PLHSSRBA THEN   /* DOES 2ND LVL POINT TO PREVIOUS
*                                      SEQ SET                       */
         CLC   PLHSAVE4(4,RPLH),PLHSSRBA(RPLH)                     0281
         BNE   @RF00281                                            0281
*         DO;                       /* YES                           */
*           RFY                                                    0283
*             R15 RSTD;             /*                               */
*           R15=FOUR;               /* SHOW END OF DATA              */
         LA    R15,4                                               0284
*           CALL EXIT;              /* RETURN TO CALLER              */
         BAL   @14,EXIT                                            0285
*           RFY                                                    0286
*             R15 UNRSTD;           /*                               */
*         END;                      /*                               */
*       PLHSAVE2=PLHSAVE4;          /* SET RBA OF RECORD TO BE     0288
*                                      RETRIEVED                     */
@RF00281 L     @10,PLHSAVE4(,RPLH)                                 0288
         ST    @10,PLHSAVE2(,RPLH)                                 0288
*       CALL READSS;                /* GO BRING IN SEQ SET           */
         BAL   @14,READSS                                          0289
*     END;                          /*                               */
*   RFY                                                            0291
*     R14 RSTD;                     /*                               */
@RF00279 DS    0H                                                  0292
*   R14=ADDR(PLHIXSPL);             /* POINT TO INDEX LIST           */
         LA    R14,PLHIXSPL(,RPLH)                                 0292
*   R14->IXSILN=PLHSAVE5;           /* SET LEVEL AT TOP              */
         L     @15,PLHSAVE5(,RPLH)                                 0293
         STC   @15,IXSILN(,R14)                                    0293
*   RFY                                                            0294
*     R14 UNRSTD;                   /*                               */
*   DO WHILE PLHSAVE1^=TWO;         /* LOOP UNTIL LEVEL TWO HAS BEEN
*                                      PROCESSED                     */
         B     @DE00295                                            0295
@DL00295 DS    0H                                                  0296
*     RPARM1=PLHSAVE2;              /* PICK UP RBA OF RECORD TO BE 0296
*                                      READ                          */
         L     RPARM1,PLHSAVE2(,RPLH)                              0296
*I07:                                                              0297
*     DO;                           /* IDACALL(IDAGRB)               */
I07      DS    0H                                                  0298
*       CALL IDAGRB;                /* EXIT TO IDAGRB                */
         L     @15,@CV00908                                        0298
         BALR  @14,@15                                             0298
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */
         USING *,@11
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*     END I07;                      /* GO READ THE RECORD            */
*     IF RPLERREG^=ZERO THEN        /* I/O ERROR                     */
         CLI   RPLERREG(RRPL),0                                    0304
         BE    @RF00304                                            0304
*       CALL EXIT;                  /* YES, RETURN TO CALLER         */
         BAL   @14,EXIT                                            0305
*     PLHSAVE3=PLHSAVE2;            /* SAVE RBA FOR PLHSLRBA         */
@RF00304 L     @10,PLHSAVE2(,RPLH)                                 0306
         ST    @10,PLHSAVE3(,RPLH)                                 0306
*     RFY                                                          0307
*      (RWORK1,                                                    0307
*       RWORK2,                                                    0307
*       RWORK3,                                                    0307
*       RWORK4) RSTD;               /*                               */
*     RWORK3=BUFCBAD;               /* POINT TO BUFFER               */
         L     RWORK3,BUFCBAD(,RBUFC)                              0308
*     RWORK4=RWORK3+RWORK3->IXHLEO+ /* POINT TO PTR. FIELD OF        */
*         LENGTH(IBFLPF)+LENGTH(IBFLPL);/* HIGHEST KEY IN RECORD     */
         LR    RWORK4,RWORK3                                       0309
         AH    RWORK4,IXHLEO(,RWORK3)                              0309
         AL    RWORK4,@CF00155                                     0309
*     RWORK1=ZERO;                  /* CLEAR REGISTER FOR PTR        */
         SLR   RWORK1,RWORK1                                       0310
*     RWORK2=RWORK3->IXHPTLS;       /* GET MASK FROM HEADER          */
         SLR   RWORK2,RWORK2                                       0311
         IC    RWORK2,IXHPTLS(,RWORK3)                             0311
*     GEN;                                                         0312
*                                          /*                        */
     EX      RWORK2,INSERT                 /* PICK UP PTR. IN RWORK1 */
*     PLHSAVE2=RWORK1*AMDCINV+      /* CONVERT THE HIGH KEY          */
*         RWORK3->IXHBRBA;          /* PTR. TO AN RBA                */
         L     @10,AMBDSB(,RAMB)                                   0313
         LR    @15,RWORK1                                          0313
         M     @14,AMDCINV(,@10)                                   0313
         AL    @15,IXHBRBA(,RWORK3)                                0313
         ST    @15,PLHSAVE2(,RPLH)                                 0313
*     PLHSAVE1=RWORK3->IXHLV;       /* SAVE LEVEL NUMBER             */
         SLR   @10,@10                                             0314
         IC    @10,IXHLV(,RWORK3)                                  0314
         ST    @10,PLHSAVE1(,RPLH)                                 0314
*     RFY                                                          0315
*       R14 RSTD;                   /*                               */
*     R14=ADDR(PLHIXSPL);           /* POINT TO INDEX LIST           */
         LA    R14,PLHIXSPL(,RPLH)                                 0316
*     R14->IXSILN=PLHSAVE5-ONE;     /* SET NEW LEVEL                 */
         L     @15,PLHSAVE5(,RPLH)                                 0317
         BCTR  @15,0                                               0317
         STC   @15,IXSILN(,R14)                                    0317
*     RFY                                                          0318
*       R14 UNRSTD;                 /*                               */
*     RFY                                                          0319
*      (RWORK1,                                                    0319
*       RWORK2,                                                    0319
*       RWORK3,                                                    0319
*       RWORK4) UNRSTD;             /*                               */
*     IF PLHSAVE1^=TWO THEN         /* IF NOT LAST TIME              */
         C     @10,@CF00155                                        0320
         BE    @RF00320                                            0320
*I08:                                                              0321
*       DO;                         /* IDACALL(IDAFREEB)             */
I08      DS    0H                                                  0322
*         CALL IDAFREEB;            /* EXIT TO IDAFREEB              */
         L     @15,@CV00906                                        0322
         BALR  @14,@15                                             0322
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I08;                    /* FREE THE BUFFER               */
*   END;                            /*                               */
@RF00320 DS    0H                                                  0328
@DE00295 CLC   PLHSAVE1(4,RPLH),@CF00155                           0328
         BNE   @DL00295                                            0328
*   PLHSLRBA=PLHSAVE3;              /* STORE RBA OF 2ND LEVEL        */
         L     @10,PLHSAVE3(,RPLH)                                 0329
         ST    @10,PLHSLRBA(,RPLH)                                 0329
*   CALL READSS;                    /* GO READ SEQUENCE SET AND    0330
*                                      RETURN TO CALLER              */
         BAL   @14,READSS                                          0330
*                                                                  0331
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*   /* IDAADVPH SUBROUTINE FOR ADVANCING PLACEHOLDER TO NEXT POSITION*/
*   /* WHILE DOING BACKWARD PROCESSING * * * * * * * * * * * * * * * */
*   /* * * * * * * * * * * * * * * * *                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*IDAADVPH:                                                         0331
*   ENTRY;                          /*                               */
@EP00331 DS    0H                                                  0332
*   GEN(IDASVR14);                  /* SAVE REGISTER 14              */
         IDASVR14
*   RESPECIFY                                                      0333
*     R14 UNRSTD;                   /*                               */
*   IF PLHASKBF=ON THEN             /* WERE BUFFERS REQUESTED        */
         TM    PLHASKBF(RPLH),B'00100000'                          0334
         BNO   @RF00334                                            0334
*     DO;                           /* YES                           */
*       RPARM1=ZERO;                /* ASK FOR LIMIT                 */
         SLR   RPARM1,RPARM1                                       0336
*I09:                                                              0337
*       DO;                         /* IDACALL(IDAABF)               */
I09      DS    0H                                                  0338
*         CALL IDAABF;              /* EXIT TO IDAABF                */
         L     @15,@CV00905                                        0338
         BALR  @14,@15                                             0338
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I09;                    /* GO ADD BUFFERS                */
*     END;                          /*                               */
*   IF PLHSKPER=ON×PLHRECP=PLHDBUFC->/* READ SKIP ON OR AT           */
*       BUFCBAD THEN                /* BEGINNING OF BUFFER           */
@RF00334 TM    PLHSKPER(RPLH),B'00100000'                          0345
         BO    @RT00345                                            0345
         L     @10,PLHDBUFC(,RPLH)                                 0345
         CLC   PLHRECP(4,RPLH),BUFCBAD(@10)                        0345
         BNE   @RF00345                                            0345
@RT00345 DS    0H                                                  0346
*     DO;                           /* YES                           */
*       IF RPLUPD=ON THEN           /* UPDATE REQUEST                */
         TM    RPLUPD(RRPL),B'00000010'                            0347
         BNO   @RF00347                                            0347
*         PLHRDEXC=ON;              /* YES, SET READ EXCLUSIVE FLAG
*                                      IN PLH                        */
         OI    PLHRDEXC(RPLH),B'00001000'                          0348
*       ELSE                        /* NO                            */
*         PLHRDEXC=OFF;             /* DONT NEED EXCL CTL            */
         B     @RC00347                                            0349
@RF00347 NI    PLHRDEXC(RPLH),B'11110111'                          0349
*       PLHSKPER=OFF;               /* HOUSEKEEP SKIP FLAG           */
@RC00347 NI    PLHSKPER(RPLH),B'11011111'                          0350
*GETNXBF:                                                          0351
*       IF AMBGSR=OFF&AMBLSR=OFF&   /* NOT DB/DC PROCESSING          */
*           RPLKEY=ON&              /* AND KEYED MODE AND            */
*           PLHIBUFC->BUFCRRD=ON THEN/* SEQUENCE SET IS INVALID      */
GETNXBF  TM    AMBGSR(RAMB),B'01100000'                            0351
         BNZ   @RF00351                                            0351
         TM    RPLKEY(RRPL),B'10000000'                            0351
         BNO   @RF00351                                            0351
         L     @10,PLHIBUFC(,RPLH)                                 0351
         TM    BUFCRRD(@10),B'00100000'                            0351
         BNO   @RF00351                                            0351
*         DO;                       /* YES                           */
*           PLHSAVE2=RPLOPTCD;      /* SAVE USERS OPTIONS            */
         L     @10,RPLOPTCD(,RRPL)                                 0353
         ST    @10,PLHSAVE2(,RPLH)                                 0353
*           RPLDIR=ON;              /* FORCE DIRECT                  */
*           RPLSEQ=OFF;             /* TURN OFF SEQUENTIAL           */
         OI    RPLDIR(RRPL),B'01000000'                            0355
         NI    RPLSEQ(RRPL),B'11011111'                            0355
*           RPLLRD=OFF;             /* TURN OFF LAST RECORD          */
         NI    RPLLRD(RRPL),B'11110111'                            0356
*           PLHRABWD=ON;            /* SET INTERNAL CALL BIT         */
         OI    PLHRABWD(RPLH),B'00000100'                          0357
*           RPARM1=ADDR(PLHKEY);    /* SEARCH ON PLH KEY             */
         L     RPARM1,PLHKEYPT(,RPLH)                              0358
*I10:                                                              0359
*           DO;                     /* IDACALL(IDA019RA)             */
I10      DS    0H                                                  0360
*             CALL IDA019RA;        /* EXIT TO IDA019RA              */
         L     @15,@CV00909                                        0360
         BALR  @14,@15                                             0360
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */
         USING *,@11
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */
         L     @11,=A(@PSTART)
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */
         USING @PSTART,@11
*           END I10;                /* CALL DIRECT RECORD LOC.       */
*           PLHRABWD=OFF;           /* RESET INTERNAL BIT            */
         NI    PLHRABWD(RPLH),B'11111011'                          0366
*           RPLOPTCD=PLHSAVE2;      /* RESTORE RPL OPTIONS           */
         L     @10,PLHSAVE2(,RPLH)                                 0367
         ST    @10,RPLOPTCD(,RRPL)                                 0367
*           IF RPLERREG=ZERO THEN   /* ERROR ENCOUNTERED             */
         CLI   RPLERREG(RRPL),0                                    0368
         BNE   @RF00368                                            0368
*             DO;                   /* NO                            */
*               IF PLHRECP=PLHDBUFC->BUFCBAD THEN/* AT BEGINNING OF
*                                      THE BUFFER                    */
         L     @10,PLHDBUFC(,RPLH)                                 0370
         CLC   PLHRECP(4,RPLH),BUFCBAD(@10)                        0370
         BE    @RT00370                                            0370
*                 GO TO GETNXBF;    /* YES, READ NEXT CI             */
*               CALL MVBWD;         /* MOVE TO NEXT RECORD           */
         BAL   @14,MVBWD                                           0372
*               CALL EXIT;          /* AND EXIT                      */
         BAL   @14,EXIT                                            0373
*             END;                  /*                               */
*           ELSE                    /* ERROR ENCOUNTERED SO          */
*             GO TO IDAAPH01;       /* PROCESS IT                    */
*         END;                      /*                               */
*       RBUFC=PLHDBUFC;             /* POINT TO CURRENT BUFC         */
@RF00351 L     RBUFC,PLHDBUFC(,RPLH)                               0377
*       PLHDDDD=BUFCDDDD;           /* SAVE RBA IN PLH.              */
         L     @10,BUFCDDDD(,RBUFC)                                0378
         ST    @10,PLHDDDD(,RPLH)                                  0378
*I11:                                                              0379
*       DO;                         /* IDACALL(IDAFREEB)             */
I11      DS    0H                                                  0380
*         CALL IDAFREEB;            /* EXIT TO IDAFREEB              */
         L     @15,@CV00906                                        0380
         BALR  @14,@15                                             0380
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I11;                    /* FREE THE BUFFER               */
*I12:                                                              0386
*       DO;                         /* IDACALL(IDAGNXT)              */
I12      DS    0H                                                  0387
*         CALL IDAGNXT;             /* EXIT TO IDAGNXT               */
         L     @15,@CV00907                                        0387
         BALR  @14,@15                                             0387
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I12;                    /* GET NEXT CONTROL INTRVL       */
*       IF RPLERREG=ZERO THEN       /* BUFFER MGR ERROR              */
         CLI   RPLERREG(RRPL),0                                    0393
         BNE   @RF00393                                            0393
*         DO;                       /* NO                            */
*           RESPECIFY                                              0395
*            (RWORK1,                                              0395
*             RWORK2) RSTD;         /*                               */
*           RPARM1=BUFCBAD;         /* POINT TO START OF BUFF        */
         L     RPARM1,BUFCBAD(,RBUFC)                              0396
*           RWORK1=RPARM1+AMDCINV-  /* POINT TO CIDF IN              */
*               LENGTH(IDACIDF);    /* BUFFER                        */
*                                                                  0397
         L     @10,AMBDSB(,RAMB)                                   0397
         LR    RWORK1,RPARM1                                       0397
         AL    RWORK1,AMDCINV(,@10)                                0397
         SL    RWORK1,@CF00067                                     0397
*           /*********************************************************/
*           /*                                                       */
*           /* VALIDATE THE CIDF. IF INVALID TREAT LIKE DATA READ    */
*           /* ERROR AS FAR AS POSITIONING IS CONCERNED.     @ZA31009*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0398
*           IF RWORK1->IDACIDF=ZERO THEN/* CIDF = ZERO?      @ZA31009*/
         ICM   @10,15,IDACIDF(RWORK1)                              0398
         BNZ   @RF00398                                            0398
*             DO;                   /* YES                   @ZA31009*/
*               RPLDDDD=BUFCDDDD;   /* PASS RBA BACK         @ZA31009*/
         L     @10,BUFCDDDD(,RBUFC)                                0400
         ST    @10,RPLDDDD(,RRPL)                                  0400
*               RPLERREG='08'X;     /* LOGICAL ERROR         @ZA31009*/
         MVI   RPLERREG(RRPL),X'08'                                0401
*               RPLERRCD=RPLINCNV;  /* BAD CI                @ZA31009*/
         MVI   RPLERRCD(RRPL),X'9C'                                0402
*               PLHSKPER=ON;        /* SKIP OVER CI          @ZA31009*/
         OI    PLHSKPER(RPLH),B'00100000'                          0403
*               CALL EXIT;          /* EXIT MODULE           @ZA31009*/
         BAL   @14,EXIT                                            0404
*             END;                  /* END ZERO CIDF         @ZA31009*/
*                                                                  0405
*           /*********************************************************/
*           /*                                                       */
*           /* SEE IF A BUSY CI WAS READ IN. IF THE CI IS BUSY IT    */
*           /* MEANS THAT CI SPLIT HAS BEEN INTERRUPTED AND CI       */
*           /* REBUILD MUST BE CALLED IN ORDER TO EITHER CORRECT THE */
*           /* CI OR SYNCHRONIZE ANY FURTHER PROCESSING.     @ZA31009*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0406
*           IF RWORK1->CIDFBUSY=ON THEN/* IF INTRPT CI       @ZA31009*/
@RF00398 TM    CIDFBUSY(RWORK1),B'10000000'                        0406
         BNO   @RF00406                                            0406
*             DO;                   /* SPLIT, FIX.           @ZA31009*/
*I13:                                                              0408
*               DO;                 /* IDACALL(IDA019S6)             */
I13      DS    0H                                                  0409
*                 CALL IDA019S6;    /* EXIT TO IDA019S6              */
         L     @15,@CV00910                                        0409
         BALR  @14,@15                                             0409
*                 GEN(BALR @11,0);  /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*                 GEN(USING *,@11); /* ESTABLISH ADDRESSING          */
         USING *,@11
*                 GEN(L     @11,=A(@PSTART));/* RELOAD BASE          */
         L     @11,=A(@PSTART)
*                 GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING     */
         USING @PSTART,@11
*               END I13;            /* CALL REBUILD          @ZA31009*/
*               IF RPLERREG^=ZERO THEN/* IF ERROR,           @ZA31009*/
         CLI   RPLERREG(RRPL),0                                    0415
         BE    @RF00415                                            0415
*                 CALL EXIT;        /* EXIT MODULE           @ZA31009*/
         BAL   @14,EXIT                                            0416
*               RPARM1=PLHDBUFC->BUFCBAD;/* PTR TO BFR       @ZA31009*/
@RF00415 L     @10,PLHDBUFC(,RPLH)                                 0417
         L     RPARM1,BUFCBAD(,@10)                                0417
*               RWORK1=RPARM1+AMDCINV-/* PTR TO CIDF IN      @ZA31009*/
*                   LENGTH(IDACIDF);/* BUFFER                @ZA31009*/
         L     @10,AMBDSB(,RAMB)                                   0418
         LR    RWORK1,RPARM1                                       0418
         AL    RWORK1,AMDCINV(,@10)                                0418
         SL    RWORK1,@CF00067                                     0418
*             END;                  /* END CI REBUILD        @ZA31009*/
*           RWORK2=RWORK1-LENGTH(IDARDF);/* POINT TO 1ST RDF         */
@RF00406 LR    RWORK2,RWORK1                                       0420
         SL    RWORK2,@CF00157                                     0420
*           RBUFC=RPARM1+RWORK1->CIDFOSET;/* POINT TO FREESPACE      */
         LR    RBUFC,RPARM1                                        0421
         AH    RBUFC,CIDFOSET(,RWORK1)                             0421
*           IF RBUFC^>RPARM1×       /* IS BUFFER EMPTY OR            */
*               (RWORK2->RDFNOT1=ON&/* NOT 1ST SPN RCD SEG           */
*               RPLKEY=ON) THEN     /* AND KEYED MODE                */
         CR    RBUFC,RPARM1                                        0422
         BNH   @RT00422                                            0422
         TM    RDFNOT1(RWORK2),B'00100000'                         0422
         BNO   @RF00422                                            0422
         TM    RPLKEY(RRPL),B'10000000'                            0422
         BO    @RT00422                                            0422
*             GO TO GETNXBF;        /* YES, GET ANOTHER              */
*           IF RPLKEY=ON THEN       /* KEYED REQUEST                 */
@RF00422 TM    RPLKEY(RRPL),B'10000000'                            0424
         BNO   @RF00424                                            0424
*             DO;                   /* YES                           */
*               RWORK2=AMDRKP+RPARM1;/* POINT TO FIRST KEY           */
         L     @10,AMBDSB(,RAMB)                                   0426
         LR    RWORK2,RPARM1                                       0426
         AH    RWORK2,AMDRKP(,@10)                                 0426
*               RBUFC=AMDKEYLN;     /* GET KEY LENGTH                */
         LH    RBUFC,AMDKEYLN(,@10)                                0427
*               IF PLHKEY(1:RBUFC)^>/* IS PLH KEY LESS OR            */
*                   RWORK2->KEY(1:RBUFC) THEN/* EQUAL TO RECORD KEY  */
         L     @10,PLHKEYPT(,RPLH)                                 0428
         LR    @07,RBUFC                                           0428
         BCTR  @07,0                                               0428
         EX    @07,@SC01000                                        0428
         BNH   @RT00428                                            0428
*                 GO TO GETNXBF;    /* YES                           */
*             END;                  /*                               */
*           PLHRDFP=RWORK1;         /* POINT TO CIDF OF RECORD       */
@RF00424 ST    RWORK1,PLHRDFP(,RPLH)                               0431
*           RESPECIFY                                              0432
*             RWORK1 UNRSTD;        /*                               */
*           PLHFSP=RPARM1+PLHRDFP-> /* SET FREE SPACE POINTER        */
*               CIDFOSET;           /* IN PLH                        */
         L     @10,PLHRDFP(,RPLH)                                  0433
         LR    @07,RPARM1                                          0433
         AH    @07,CIDFOSET(,@10)                                  0433
         ST    @07,PLHFSP(,RPLH)                                   0433
*           PLHRECP=PLHFSP;         /* START LAST RECORD POINTER AT
*                                      EXTREME END                   */
         ST    @07,PLHRECP(,RPLH)                                  0434
*           PLHRDFP=PLHFSP+PLHRDFP->CIDFLL-/* START RDF POINTER 1 RDF*/
*               LENGTH(IDARDF);     /* TO THE LEFT OF THE LEFTMOST 0435
*                                      RDF                           */
         AH    @07,CIDFLL(,@10)                                    0435
         SL    @07,@CF00157                                        0435
         ST    @07,PLHRDFP(,RPLH)                                  0435
*           PLHRDFC=ONE;            /* FAKE COUNT AT ONE             */
         MVC   PLHRDFC(2,RPLH),@CH00053                            0436
*           CALL MVBWD;             /* GO SET PLH POINTERS           */
         BAL   @14,MVBWD                                           0437
*           IF RPLKEY=ON THEN       /* KEYED REQUEST                 */
         TM    RPLKEY(RRPL),B'10000000'                            0438
         BNO   @RF00438                                            0438
*             DO;                   /* YES                           */
*               RWORK2=AMDRKP+PLHRECP;/* POINT AT LAST KEY           */
         L     @10,AMBDSB(,RAMB)                                   0440
         LH    RWORK2,AMDRKP(,@10)                                 0440
         AL    RWORK2,PLHRECP(,RPLH)                               0440
*               DO WHILE PLHKEY(1:RBUFC)^>/* LOOP TO LOCATE KEY LESS */
*                     RWORK2->KEY(1:RBUFC);/* THAN KEY IN PLH        */
         B     @DE00441                                            0441
@DL00441 DS    0H                                                  0442
*                 CALL MVBWD;       /* MOVE TO THE NEXT RECORD AT THE
*                                      LEFT                          */
         BAL   @14,MVBWD                                           0442
*                 RWORK2=PLHRECP+AMDRKP;/* GET ADDRESS OF KEY        */
         L     @10,AMBDSB(,RAMB)                                   0443
         LH    RWORK2,AMDRKP(,@10)                                 0443
         AL    RWORK2,PLHRECP(,RPLH)                               0443
*               END;                /*                               */
@DE00441 L     @10,PLHKEYPT(,RPLH)                                 0444
         LR    @07,RBUFC                                           0444
         BCTR  @07,0                                               0444
         EX    @07,@SC01000                                        0444
         BNH   @DL00441                                            0444
*             END;                  /*                               */
*           CALL EXIT;              /* RETURN TO CALLER              */
@RF00438 BAL   @14,EXIT                                            0446
*           RESPECIFY                                              0447
*             RWORK2 UNRSTD;        /*                               */
*         END;                      /*                               */
*       ELSE                        /* ERROR FROM BUFF. MGR.         */
*IDAAPH01:                                                         0449
*         DO;                       /*                               */
         B     @RC00393                                            0449
@RF00393 DS    0H                                                  0449
IDAAPH01 DS    0H                                                  0450
*           IF RPLERRCD=RPLEXCL THEN/* EXCLUSIVE CONTROL ERROR       */
         CLI   RPLERRCD(RRPL),20                                   0450
         BNE   @RF00450                                            0450
*             DO;                   /* YES                           */
*               PLHDSCAN=ON;        /* SET SCANDATA FLAG             */
*               PLHNOADV=OFF;       /* ADVANCE ON RETRY              */
         OI    PLHDSCAN(RPLH),B'00000001'                          0453
         NI    PLHNOADV(RPLH),B'11110111'                          0453
*             END;                  /*                               */
*           CALL EXIT;              /* RETURN TO CALLER              */
@RF00450 BAL   @14,EXIT                                            0455
*         END;                      /*                               */
*     END;                          /*                               */
@RC00393 DS    0H                                                  0458
*   CALL MVBWD;                     /* MOVE TO NEXT RECORD           */
@RF00345 BAL   @14,MVBWD                                           0458
*   CALL EXIT;                      /* RETURN TO CALLER              */
         BAL   @14,EXIT                                            0459
*                                                                  0460
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*   /* IDARVRS1 ROUTINE TO CHANGE THE CHAINING OF BUFFERS TO ORDERING*/
*   /* BY INPUT RBA * * * * * * * * * * * * * * * * * * * * * * * * **/
*   /* * * * * * *                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0460
*IDARVRS1:                                                         0460
*   ENTRY;                          /*                               */
@EP00460 DS    0H                                                  0461
*   RESPECIFY                                                      0461
*    (RWORK1,                                                      0461
*     RWORK2,                                                      0461
*     RWORK3,                                                      0461
*     RWORK4,                                                      0461
*     RWORK5,                                                      0461
*     R14) RSTD;                    /*                               */
*   IF PLHBFRNO^>ONE THEN           /* MORE THAN 1 BUFFER            */
         CLI   PLHBFRNO(RPLH),1                                    0462
         BH    @RF00462                                            0462
*     DO;                           /* NO                            */
*       RBUFC=PLHDBUFC;             /* SET BUFFER PTR                */
         L     RBUFC,PLHDBUFC(,RPLH)                               0464
*       PLHRVRS=OFF;                /* CLEAR REVERSE BIT             */
         NI    PLHRVRS(RPLH),B'11110111'                           0465
*       RETURN;                     /* BACK TO CALLER                */
@EL00001 DS    0H                                                  0466
@EF00001 DS    0H                                                  0466
@ER00001 BR    @14                                                 0466
*     END;                          /*                               */
*   GEN(IDASVR14);                  /* SAVE RETURN ADDRESS           */
*                                                                  0468
@RF00462 DS    0H                                                  0468
         IDASVR14
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND THE SMALLEST INPUT RBA IN THE CHAIN                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0469
*   RWORK1=PLHDBUFC;                /* START AT 1ST BUFC             */
         L     RWORK1,PLHDBUFC(,RPLH)                              0469
*   RWORK1->BUFCNXT1=ZERO;          /* CLEAR CHAIN                   */
         SLR   @15,@15                                             0470
         ST    @15,BUFCNXT1(,RWORK1)                               0470
*   RWORK3=RWORK1->BUFCNXT2;        /* POINT TO NEXT BUFC IN THE   0471
*                                      CHAIN                         */
         L     RWORK3,BUFCNXT2-1(,RWORK1)                          0471
         LA    RWORK3,0(,RWORK3)                                   0471
*   RESPECIFY                                                      0472
*     RWORK0 RSTD;                  /*                               */
*   RWORK0=RWORK1->BUFCDDDD;        /* GET INPUT RBA FROM FIRST BUFC */
         L     RWORK0,BUFCDDDD(,RWORK1)                            0473
*   DO RWORK5=TWO TO PLHBFRNO;      /* LOOP FROM THE 2ND TO THE LAST
*                                      BUFC IN CHAIN                 */
         LA    RWORK5,2                                            0474
         B     @DE00474                                            0474
@DL00474 DS    0H                                                  0475
*     RWORK3->BUFCNXT1=ZERO;        /* CLEAR CHAIN FIELD             */
         SLR   @15,@15                                             0475
         ST    @15,BUFCNXT1(,RWORK3)                               0475
*     RWORK2=RWORK3->BUFCDDDD;      /* PICK UP INPUT RBA             */
         L     RWORK2,BUFCDDDD(,RWORK3)                            0476
*     IF RWORK2<RWORK0 THEN         /* IS THIS RBA LESS THAN THE   0477
*                                      SMALLEST FOUND SO FAR         */
         CLR   RWORK2,RWORK0                                       0477
         BNL   @RF00477                                            0477
*       DO;                         /* YES                           */
*         RWORK0=RWORK2;            /* MAKE IT NEW SMALLEST          */
         LR    RWORK0,RWORK2                                       0479
*         RWORK1=RWORK3;            /* SAVE ADDRESS OF BUFC WITH   0480
*                                      SMALLEST RBA                  */
         LR    RWORK1,RWORK3                                       0480
*       END;                        /*                               */
*     RWORK3=RWORK3->BUFCNXT2;      /* MOVE TO NEXT BUFC             */
@RF00477 L     @15,BUFCNXT2-1(,RWORK3)                             0482
         LA    @15,0(,@15)                                         0482
         LR    RWORK3,@15                                          0482
*   END;                            /* END LOOP TO FIND SMALLEST   0483
*                                      INPUT RBA                     */
         AL    RWORK5,@CF00053                                     0483
@DE00474 SLR   @15,@15                                             0483
         IC    @15,PLHBFRNO(,RPLH)                                 0483
         CR    RWORK5,@15                                          0483
         BNH   @DL00474                                            0483
*   RBUFC=RWORK1;                   /* SAVE ADDRESS OF LOWEST RBA FOR
*                                      CALLER                        */
*                                                                  0484
         LR    RBUFC,RWORK1                                        0484
*   /*****************************************************************/
*   /*                                                               */
*   /* RECHAIN BUFFERS IN ORDER OF INPUT RBA                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0485
*   DO RWORK5=TWO TO PLHBFRNO;      /* RECHAIN ALL BUT LAST          */
         LA    RWORK5,2                                            0485
         B     @DE00485                                            0485
@DL00485 DS    0H                                                  0486
*     R14=ZERO;                     /* SHOW NO LARGER RBA HAS BEEN 0486
*                                      FOUND                         */
         SLR   R14,R14                                             0486
*     RWORK3=RWORK1->BUFCNXT2;      /* START OF SEARCH               */
         L     RWORK3,BUFCNXT2-1(,RWORK1)                          0487
         LA    RWORK3,0(,RWORK3)                                   0487
*     DO RWORK2=TWO TO PLHBFRNO;    /* LOOP THRU ALL BUFCS IN CHAIN
*                                      EXCEPT CURRENT                */
         LA    RWORK2,2                                            0488
         B     @DE00488                                            0488
@DL00488 DS    0H                                                  0489
*       IF RWORK3->BUFCDDDD^<RWORK0 THEN/* IS RBA GREATER THAN OR  0489
*                                      EQUAL LAST SAVED RBA          */
         L     @15,BUFCDDDD(,RWORK3)                               0489
         CLR   @15,RWORK0                                          0489
         BL    @RF00489                                            0489
*         DO;                       /* YES                           */
*           IF RWORK3->BUFCNXT1=ZERO&/* NO LARGER FOUND OR           */
*               (RWORK3->BUFCDDDD-RWORK0<R14/* THIS ONE IS CLOSER    */
*               ×RWORK1->BUFCNXT1=ZERO) THEN/* THAN ANY SO FAR UNUSED*/
         SLR   @10,@10                                             0491
         C     @10,BUFCNXT1(,RWORK3)                               0491
         BNE   @RF00491                                            0491
         SLR   @15,RWORK0                                          0491
         CLR   @15,R14                                             0491
         BL    @RT00491                                            0491
         C     @10,BUFCNXT1(,RWORK1)                               0491
         BNE   @RF00491                                            0491
@RT00491 DS    0H                                                  0492
*             DO;                   /* YES                           */
*               R14=RWORK3->BUFCDDDD-RWORK0;/* SAVE DIFFERENCE       */
         L     R14,BUFCDDDD(,RWORK3)                               0493
         SLR   R14,RWORK0                                          0493
*               RWORK1->BUFCNXT1=RWORK3;/* ENTER ALTERNATE CHAIN     */
         ST    RWORK3,BUFCNXT1(,RWORK1)                            0494
*             END;                  /*                               */
*         END;                      /*                               */
@RF00491 DS    0H                                                  0497
*       RWORK3=RWORK3->BUFCNXT2;    /* MOVE TO NEXT BUFC             */
@RF00489 L     @15,BUFCNXT2-1(,RWORK3)                             0497
         LA    @15,0(,@15)                                         0497
         LR    RWORK3,@15                                          0497
*     END;                          /*                               */
         AL    RWORK2,@CF00053                                     0498
@DE00488 SLR   @15,@15                                             0498
         IC    @15,PLHBFRNO(,RPLH)                                 0498
         CLR   RWORK2,@15                                          0498
         BNH   @DL00488                                            0498
*     RWORK1=RWORK1->BUFCNXT1;      /* NEW BUFC TO GET CHAIN         */
         L     RWORK1,BUFCNXT1(,RWORK1)                            0499
*     RWORK0=RWORK1->BUFCDDDD;      /* RBA IN THE BUFC FOR COMPARSION
*                                      PURPOSES                      */
         L     RWORK0,BUFCDDDD(,RWORK1)                            0500
*   END;                            /*                               */
         AL    RWORK5,@CF00053                                     0501
@DE00485 SLR   @15,@15                                             0501
         IC    @15,PLHBFRNO(,RPLH)                                 0501
         CR    RWORK5,@15                                          0501
         BNH   @DL00485                                            0501
*   RWORK1->BUFCNXT1=RBUFC;         /* POINT HIGHEST TO LOWEST       */
         ST    RBUFC,BUFCNXT1(,RWORK1)                             0502
*   PLHRVRS=OFF;                    /* RESET REVERSE INDICATOR       */
         NI    PLHRVRS(RPLH),B'11110111'                           0503
*   RFY                                                            0504
*    (RWORK0,                                                      0504
*     RWORK1,                                                      0504
*     RWORK2,                                                      0504
*     RWORK3,                                                      0504
*     RWORK4,                                                      0504
*     RWORK5,                                                      0504
*     R14) UNRSTD;                                                 0504
*   CALL EXIT;                      /* RETURN TO CALLER              */
         BAL   @14,EXIT                                            0505
*                                                                  0506
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*   /* BACKUP SUBROUTINE FUNCTION: GIVEN AN INDEX RECORD WHICH HAS   */
*   /* PREVIOUSLY BEEN SEARCHED BY SCIB (IDA019RC), THIS ROUTINE     */
*   /* LOCATES THE INDEX ENTRY JUST PREVIOUS TO (NEXT LOWER KEY) THE */
*   /* ENTRY FOUND BY SCIB INPUT: RWORK3 = ADDRESS OF INDEX SEARCH   */
*   /* PARAMETER LIST USED BY SCIB RBUFC = ADDRESS OF FIRST BYTE OF  */
*   /* INDEX BUFFER OUTPUT: R15 = 0 INDICATES PREVIOUS ENTRY FOUND   */
*   /* R15 = 4 INDICATES NO PREVIOUS ENTRY EXISTS RPARM1 = POINTER   */
*   /* FIELD OF PREVIOUS ENTRY CONVERTED TO AN RBA * * * * * * * * * */
*   /* * * * * * * * * * * * * * * * * * * * * * *                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0506
*BACKUP:                                                           0506
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */
         B     @PB00002                                            0506
BACKUP   DS    0H                                                  0507
*   RESPECIFY                                                      0507
*    (RWORK0,                                                      0507
*     RWORK1,                                                      0507
*     RWORK2,                                                      0507
*     RWORK3,                                                      0507
*     R14) RSTD;                    /*                               */
*   RWORK1=RBUFC+RBUFC->IXHLL;      /* POINT TO END OF RECORD        */
         LR    RWORK1,RBUFC                                        0508
         LH    @15,IXHLL(,RBUFC)                                   0508
         N     @15,@CF01002                                        0508
         ALR   RWORK1,@15                                          0508
*   RWORK0=RBUFC->IXHFLPLN;         /* PICK UP F+L+POINTER LL        */
         SLR   RWORK0,RWORK0                                       0509
         IC    RWORK0,IXHFLPLN(,RBUFC)                             0509
*   RWORK1=RWORK1-RWORK0;           /* POINT TO F FIELD OF LAST    0510
*                                      RECORD                        */
         SLR   RWORK1,RWORK0                                       0510
*   IF RWORK1=IXSHEP THEN           /* IS HIT ENTRY THE LAST ENTRY IN
*                                      RECORD                        */
         C     RWORK1,IXSHEP(,RWORK3)                              0511
         BNE   @RF00511                                            0511
*     DO;                           /* YES                           */
*       RESPECIFY                                                  0513
*         R15 RSTD;                 /*                               */
*       R15=FOUR;                   /* SHOW NO N-1 ENTRY             */
         LA    R15,4                                               0514
*       RETURN;                     /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0515
@EF00002 DS    0H                                                  0515
@ER00002 BR    @14                                                 0515
*       RESPECIFY                                                  0516
*         R15 UNRSTD;               /*                               */
*     END;                          /*                               */
*   IF IXSHEP=IXSLEP THEN           /* IS PRECEEDING ENTRY A SECTION */
@RF00511 CLC   IXSHEP(4,RWORK3),IXSLEP(RWORK3)                     0518
         BNE   @RF00518                                            0518
*     DO;                           /* YES                           */
*       RWORK2=IXSSEP;              /* SET TARGET ADDRESS AT SECTION
*                                      ENTRY HIT                     */
         L     RWORK2,IXSSEP(,RWORK3)                              0520
*       RWORK1=RBUFC+RBUFC->IXHSEO; /* SET STARTING ADDRESS AT FIRST
*                                      SECTION                       */
         LR    RWORK1,RBUFC                                        0521
         AH    RWORK1,IXHSEO(,RBUFC)                               0521
*       RPARM1=RWORK1;              /* SAVE FOR N-1 ENTRY            */
         LR    RPARM1,RWORK1                                       0522
*       DO WHILE RWORK1>RWORK2;     /* LOOP STOPS WHEN HIT ENTRY IS
*                                      ENCOUNTERED                   */
         B     @DE00523                                            0523
@DL00523 DS    0H                                                  0524
*         RPARM1=RWORK1;            /* SAVE N-1                      */
         LR    RPARM1,RWORK1                                       0524
*         RWORK1=RWORK1-RWORK1->IBFLPL;/* BACK POINTER ACROSS KEY    */
         SLR   @15,@15                                             0525
         IC    @15,IBFLPL(,RWORK1)                                 0525
         SLR   RWORK1,@15                                          0525
*         RWORK1=RWORK1-LENGTH(IXSELL);/* BACK POINTER ACROSS LL     */
         BCTR  RWORK1,0                                            0526
         BCTR  RWORK1,0                                            0526
*         RWORK1=RPARM1-RWORK1->IXSELL;/* MOVE TO NEXT SECTION       */
         LR    @15,RPARM1                                          0527
         SLR   @10,@10                                             0527
         ICM   @10,3,IXSELL(RWORK1)                                0527
         SLR   @15,@10                                             0527
         LR    RWORK1,@15                                          0527
*       END;                        /*                               */
@DE00523 CLR   RWORK1,RWORK2                                       0528
         BH    @DL00523                                            0528
*     END;                          /* END OF SECTION SEARCH         */
*   ELSE                            /*                               */
*     DO;                           /*                               */
         B     @RC00518                                            0530
@RF00518 DS    0H                                                  0531
*       RWORK1=IXSLEP;              /* START SEARCH AT LOW ENTRY IN
*                                      SECTION                       */
         L     RWORK1,IXSLEP(,RWORK3)                              0531
*       RWORK2=IXSHEP;              /* SET TARGET ADDRESS AT HIT   0532
*                                      ENTRY                         */
         L     RWORK2,IXSHEP(,RWORK3)                              0532
*       RPARM1=RWORK1;              /* SAVE N-1 ENTRY ADDRESS        */
         LR    RPARM1,RWORK1                                       0533
*       DO WHILE RWORK1>RWORK2;     /* LOOP STOPS WHEN HIT ENTRY IS
*                                      FOUND                         */
         B     @DE00534                                            0534
@DL00534 DS    0H                                                  0535
*         RPARM1=RWORK1;            /* SAVE N-1                      */
         LR    RPARM1,RWORK1                                       0535
*         RWORK1=RWORK1-RPARM1->IBFLPL-/* BACKUP OVER KEY FIELD      */
*             RWORK0;               /* POINTER, AND L FIELD          */
         LR    @15,RWORK1                                          0536
         SLR   @10,@10                                             0536
         IC    @10,IBFLPL(,RPARM1)                                 0536
         SLR   @15,@10                                             0536
         SLR   @15,RWORK0                                          0536
         LR    RWORK1,@15                                          0536
*       END;                        /*                               */
@DE00534 CLR   RWORK1,RWORK2                                       0537
         BH    @DL00534                                            0537
*     END;                          /* END NON-SECTION SEARCH        */
*   RESPECIFY                                                      0539
*     RWORK4 RSTD;                  /*                               */
@RC00518 DS    0H                                                  0540
*   RESPECIFY                                                      0540
*     RWORK0 UNRSTD;                /*                               */
*   RWORK1=ZERO;                    /* CLEAR REGISTER TO CONTAIN   0541
*                                      POINTER                       */
         SLR   RWORK1,RWORK1                                       0541
*   RWORK4=RPARM1+LENGTH(IBFLPF)+   /* POINT TO POINTER FIELD        */
*       LENGTH(IBFLPL);             /* OF N-1 ENTRY                  */
         LA    RWORK4,2                                            0542
         ALR   RWORK4,RPARM1                                       0542
*   RWORK2=RBUFC->IXHPTLS;          /* GET MASK FROM HEADER          */
         SLR   RWORK2,RWORK2                                       0543
         IC    RWORK2,IXHPTLS(,RBUFC)                              0543
*   GEN;                                                           0544
    EX     RWORK2,INSERT                   /* EXTRACT THE POINTER    */
*   RESPECIFY                                                      0545
*    (RWORK2,                                                      0545
*     RWORK4) UNRSTD;               /*                               */
*   RPARM1=RWORK1*AMDCINV+          /* CONVERT POINTER TO RBA        */
*       RBUFC->IXHBRBA;             /* FOR RETURN TO CALLER          */
         L     @15,AMBDSB(,RAMB)                                   0546
         LR    @09,RWORK1                                          0546
         M     @08,AMDCINV(,@15)                                   0546
         AL    @09,IXHBRBA(,RBUFC)                                 0546
         LR    RPARM1,@09                                          0546
*   RESPECIFY                                                      0547
*     RWORK1 UNRSTD;                /*                               */
*   RESPECIFY                                                      0548
*     R15 RSTD;                     /*                               */
*   R15=ZERO;                       /* SHOW N-1 FOUND                */
         SLR   R15,R15                                             0549
*   RESPECIFY                                                      0550
*     R14 UNRSTD;                   /*                               */
*   END BACKUP;                     /*                               */
         B     @EL00002                                            0551
*   RESPECIFY                                                      0552
*     R15 UNRSTD;                   /*                               */
*                                                                  0553
*   /*****************************************************************/
*   /*                                                               */
*   /* READSS SUBROUTINE FUNCTION- READS THE SEQUENCE SET WHICH HAS  */
*   /* BEEN DETERMINED TO BE THE PREVIOUS SEQUENCE SET AND DECIDES IF*/
*   /* IT ACTUALLY PRECEEDS THE CURRENT SEQUENCE SET. IF NOT, A      */
*   /* HORIZONTAL SEARCH IS USED TO LOCATE THE PRECEEDING SEQUENCE   */
*   /* SET                                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*READSS:                            /* SUBROUTINE NAME               */
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */
READSS   DS    0H                                                  0554
*   RFY                                                            0554
*     R14 RSTD;                     /* PROTECT R14                   */
*   R14=ADDR(PLHIXSPL);             /* POINT TO INDEX LIST           */
         LA    R14,PLHIXSPL(,RPLH)                                 0555
*   R14->IXSILN=ONE;                /* SET LEVEL AT ONE              */
         MVI   IXSILN(R14),X'01'                                   0556
*   RFY                                                            0557
*     R14 UNRSTD;                   /* FREE REG 14                   */
*   PLHSAVE1=ZERO;                  /* CLEAR READ COUNT              */
         SLR   @10,@10                                             0558
         ST    @10,PLHSAVE1(,RPLH)                                 0558
*   DO UNTIL PLHSAVE2=PLHSSRBA;     /* EXIT WHEN HORIZONTAL POINTER
*                                      EQUALS CURRENT SEQUENCE SET   */
@DL00559 DS    0H                                                  0560
*I14:                                                              0560
*     DO;                           /* IDACALL(IDAFREEB)             */
I14      DS    0H                                                  0561
*       CALL IDAFREEB;              /* EXIT TO IDAFREEB              */
         L     @15,@CV00906                                        0561
         BALR  @14,@15                                             0561
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */
         USING *,@11
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*     END I14;                      /* FREE BUFFER                   */
*     PLHSSR=ON;                    /* INDICATE SEQ SET READ         */
         OI    PLHSSR(RPLH),B'00010000'                            0567
*     RPARM1=PLHSAVE2;              /* GET RBA OF RECORD             */
         L     @10,PLHSAVE2(,RPLH)                                 0568
         LR    RPARM1,@10                                          0568
*     PLHSAVE3=PLHSAVE2;            /* HOLD RBA OF RECORD            */
         ST    @10,PLHSAVE3(,RPLH)                                 0569
*I15:                                                              0570
*     DO;                           /* IDACALL(IDAGRB)               */
I15      DS    0H                                                  0571
*       CALL IDAGRB;                /* EXIT TO IDAGRB                */
         L     @15,@CV00908                                        0571
         BALR  @14,@15                                             0571
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */
         USING *,@11
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*     END I15;                      /* READ RECORD                   */
*     IF RPLERREG^=ZERO THEN        /* IF I/O ERROR HAS HIT,         */
         CLI   RPLERREG(RRPL),0                                    0577
         BE    @RF00577                                            0577
*       CALL EXIT;                  /* LEAVE IMMEDIATELY             */
         BAL   @14,EXIT                                            0578
*     PLHSAVE2=BUFCBAD->IXHHP;      /* SAVE HORIZONTAL POINTER       */
@RF00577 L     @10,BUFCBAD(,RBUFC)                                 0579
         L     @10,IXHHP(,@10)                                     0579
         ST    @10,PLHSAVE2(,RPLH)                                 0579
*     PLHSAVE1=PLHSAVE1+ONE;        /* INCREMENT READ COUNT          */
         LA    @10,1                                               0580
         AL    @10,PLHSAVE1(,RPLH)                                 0580
         ST    @10,PLHSAVE1(,RPLH)                                 0580
*   END;                            /*                               */
@DE00559 CLC   PLHSAVE2(4,RPLH),PLHSSRBA(RPLH)                     0581
         BNE   @DL00559                                            0581
*   PLHSSRBA=PLHSAVE3;              /* SAVE CURRENT RBA              */
         L     @10,PLHSAVE3(,RPLH)                                 0582
         ST    @10,PLHSSRBA(,RPLH)                                 0582
*   IF PLHSAVE1>ONE THEN            /* IF MORE THAN ONE READ         */
         CLC   PLHSAVE1(4,RPLH),@CF00053                           0583
         BNH   @RF00583                                            0583
*     PLHSLVLD=OFF;                 /* SET 2ND LEVEL INVALID         */
         NI    PLHSLVLD(RPLH),B'11011111'                          0584
*   RFY                                                            0585
*     R15 RSTD;                     /*                               */
@RF00583 DS    0H                                                  0586
*   R15=ZERO;                       /* SET OK CODE FOR CALLER        */
         SLR   R15,R15                                             0586
*   CALL EXIT;                      /* RETURN TO CALLER              */
         BAL   @14,EXIT                                            0587
*   RFY                                                            0588
*     R15 UNRSTD;                   /*                               */
*   END READSS;                     /* END OF SUBROUTINE             */
@EL00003 DS    0H                                                  0589
@EF00003 DS    0H                                                  0589
@ER00003 BR    @14                                                 0589
*                                                                  0590
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*   /* MOVE TO PREVIOUS RECORD PROCEDURE * * * * * * * * * * * * * * */
*   /* * * * * * * * * * * * * * * * * *                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*MVBWD:                                                            0590
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/*                             */
MVBWD    DS    0H                                                  0591
*   RESPECIFY                                                      0591
*     R14 RSTD;                     /*                               */
*   IF PLHRDFC>ONE THEN             /* HAS THIS COLLECTION OF FIXED
*                                      LENGTH RECORDS BEEN PROCESSED */
         LH    @15,PLHRDFC(,RPLH)                                  0592
         C     @15,@CF00053                                        0592
         BNH   @RF00592                                            0592
*     DO;                           /* NO                            */
*       PLHRDFC=PLHRDFC-ONE;        /* REDUCE COUNT                  */
         BCTR  @15,0                                               0594
         STH   @15,PLHRDFC(,RPLH)                                  0594
*       PLHRECP=PLHRECP-PLHLRECL;   /* MOVE RECORD POINTER TO NEXT 0595
*                                      RECORD                        */
         L     @15,PLHRECP(,RPLH)                                  0595
         SL    @15,PLHLRECL(,RPLH)                                 0595
         ST    @15,PLHRECP(,RPLH)                                  0595
*       RETURN;                     /* RETURN TO CALLER              */
@EL00004 DS    0H                                                  0596
@EF00004 DS    0H                                                  0596
@ER00004 BR    @14                                                 0596
*     END;                          /*                               */
*   PLHRDFP=PLHRDFP+LENGTH(IDARDF); /* MOVE TO NEXT RDF              */
@RF00592 LA    @15,3                                               0598
         L     @10,PLHRDFP(,RPLH)                                  0598
         ALR   @10,@15                                             0598
         ST    @10,PLHRDFP(,RPLH)                                  0598
*   IF PLHRDFP->RDFCTNU=ON THEN     /* IS THIS LL FOR OLD SET        */
         TM    RDFCTNU(@10),B'01000000'                            0599
         BNO   @RF00599                                            0599
*     PLHRDFP=PLHRDFP+LENGTH(IDARDF);/* YES, MOVE OVER IT            */
         ALR   @10,@15                                             0600
         ST    @10,PLHRDFP(,RPLH)                                  0600
*   IF PLHRDFP->RDFREPL=ON THEN     /* IS THIS A COUNT RDF           */
@RF00599 L     @15,PLHRDFP(,RPLH)                                  0601
         TM    RDFREPL(@15),B'00001000'                            0601
         BNO   @RF00601                                            0601
*     DO;                           /* YES                           */
*       RPARM1=PLHRDFP+LENGTH(IDARDF);/* POINT TO LL RDF             */
         LA    RPARM1,3                                            0603
         ALR   RPARM1,@15                                          0603
*       PLHLRECL=RPARM1->RDFLL;     /* SET RECORD LENGTH             */
         SLR   @10,@10                                             0604
         ICM   @10,3,RDFLL(RPARM1)                                 0604
         ST    @10,PLHLRECL(,RPLH)                                 0604
*       PLHRDFC=PLHRDFP->RDFLL;     /* SET RECORD COUNT              */
         MVC   PLHRDFC(2,RPLH),RDFLL(@15)                          0605
*     END;                          /*                               */
*   ELSE                            /*                               */
*     DO;                           /*                               */
         B     @RC00601                                            0607
@RF00601 DS    0H                                                  0608
*       PLHLRECL=PLHRDFP->RDFLL;    /* SET RECORD LENGTH             */
         L     @15,PLHRDFP(,RPLH)                                  0608
         SLR   @10,@10                                             0608
         ICM   @10,3,RDFLL(@15)                                    0608
         ST    @10,PLHLRECL(,RPLH)                                 0608
*       PLHRDFC=ONE;                /* SET COUNT TO 1                */
         MVC   PLHRDFC(2,RPLH),@CH00053                            0609
*     END;                          /*                               */
*   PLHRECP=PLHRECP-PLHLRECL;       /* SET RECORD POINTER            */
@RC00601 L     @15,PLHRECP(,RPLH)                                  0611
         SL    @15,PLHLRECL(,RPLH)                                 0611
         ST    @15,PLHRECP(,RPLH)                                  0611
*   RESPECIFY                                                      0612
*     R14 UNRSTD;                   /*                               */
*   END MVBWD;                      /* RETURN TO CALLER              */
         B     @EL00004                                            0613
*                                                                  0614
*   /*****************************************************************/
*   /*                                                               */
*   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*   /* EXIT SUBROUTINE FUNCTION: RESTORES REGISTER 14 FROM THE       */
*   /* PLACEHOLDER PUSH DOWN LIST AND RETURNS * * * * * * * * * * * **/
*   /* * * * * * * * * * * * * * * * * * * *                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*EXIT:                                                             0614
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */
EXIT     DS    0H                                                  0615
*   GEN(IDARST14);                  /* RESTORE REGISTER 14           */
         IDARST14
*   END EXIT;                       /* RETURN                        */
@EL00005 DS    0H                                                  0616
@EF00005 DS    0H                                                  0616
@ER00005 BR    @14                                                 0616
@PB00005 DS    0H                                                  0617
*   GEN;                                                           0617
*                                          /*                        */
INSERT   ICM   RWORK1,@00,@00(RWORK4)      /* USED TO PICK UP POINTER*/
*   GEN(IDAPATCH);                  /* PATCH SPACE                   */
         IDAPATCH
*   END IDA019RV                    /* MODULE END                    */
*                                                                  0619
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */
*/*%INCLUDE SYSLIB  (IDAIXSPL)                                       */
*/*%INCLUDE SYSLIB  (IDAIRD  )                                       */
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */
*                                                                  0619
*       ;                                                          0619
         B     @EL00001                                            0619
@DATA    DS    0H
@SC01000 CLC   PLHKEY(0,@10),KEY(RWORK2)
@DATD    DSECT
         DS    0F
IDA019RV CSECT
         DS    0F
@CF00053 DC    F'1'
@CH00053 EQU   @CF00053+2
@CF00155 DC    F'2'
@CF00157 DC    F'3'
@CF00067 DC    F'4'
@CF01002 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
IDA019RV CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00905 DC    V(IDAABF)
@CV00906 DC    V(IDAFREEB)
@CV00907 DC    V(IDAGNXT)
@CV00908 DC    V(IDAGRB)
@CV00909 DC    V(IDA019RA)
@CV00910 DC    V(IDA019S6)
@CV00911 DC    V(IDA019RC)
         DS    0D
HWORD4   DC    H'4'
@DATD    DSECT
*                                                          /*@X04SVLC*/
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/
RDFLEN   EQU   3                        LENGTH OF RDF
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDA019RV CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RWORK0   EQU   @00
RRPL     EQU   @01
RPLH     EQU   @02
RAMB     EQU   @03
RBUFC    EQU   @04
RWORK1   EQU   @05
RWORK2   EQU   @06
RWORK3   EQU   @07
RWORK4   EQU   @08
RWORK5   EQU   @09
RPARM1   EQU   @12
R14      EQU   @14
R15      EQU   @15
R1       EQU   @01
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLERREG EQU   RPLRTNCD
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLDACB  EQU   RPLCOMN+24
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLDIR   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLKEY   EQU   RPLOPT2
RPLADR   EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLDDDD  EQU   RPLRBAR+4
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMBL  EQU   0
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLSHAR EQU   IDAAMBL+33
AMBLFLG1 EQU   IDAAMBL+35
AMBLFLG2 EQU   IDAAMBL+36
AMBLIX   EQU   IDAAMBL+56
IDAAMB   EQU   0
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBFLG1  EQU   IDAAMB+25
AMBDSORG EQU   IDAAMB+26
AMBIOBAD EQU   IDAAMB+28
AMBINFL  EQU   IDAAMB+42
AMBDEBPT EQU   IDAAMB+44
AMBOFLGS EQU   IDAAMB+48
AMBFLG2  EQU   IDAAMB+49
AMBEOVPT EQU   IDAAMB+56
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
AMBLSR   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
IDAPLHDR EQU   0
IDAPLH   EQU   0
PLHFLG1  EQU   IDAPLH+2
PLHASKBF EQU   PLHFLG1
PLHSSR   EQU   PLHFLG1
PLHRDEXC EQU   PLHFLG1
PLHFLG2  EQU   IDAPLH+3
PLHEFLGS EQU   IDAPLH+4
PLHSKPER EQU   PLHEFLGS
PLHNOADV EQU   PLHEFLGS
PLHDSCAN EQU   PLHEFLGS
PLHFLG3  EQU   IDAPLH+6
PLHSLVLD EQU   PLHFLG3
PLHRVRS  EQU   PLHFLG3
PLHAFLGS EQU   IDAPLH+7
PLHRABWD EQU   PLHAFLGS
PLHBFRNO EQU   IDAPLH+15
PLHCRBA  EQU   IDAPLH+28
PLHJORBA EQU   PLHCRBA
PLHJCODE EQU   IDAPLH+40
PLHLRECL EQU   IDAPLH+48
PLHDBUFC EQU   IDAPLH+52
PLHRECP  EQU   IDAPLH+60
PLHFSP   EQU   IDAPLH+64
PLHRDFP  EQU   IDAPLH+68
PLHRDFC  EQU   IDAPLH+72
PLHDIOB  EQU   IDAPLH+76
PLHSAVE1 EQU   IDAPLH+84
PLHSAVE2 EQU   IDAPLH+88
PLHSAVE3 EQU   IDAPLH+92
PLHSAVE4 EQU   IDAPLH+96
PLHSAVE5 EQU   IDAPLH+100
PLHSAVE6 EQU   IDAPLH+104
PLHRETO  EQU   IDAPLH+116
PLHRET1  EQU   IDAPLH+120
PLHEOVPT EQU   IDAPLH+180
PLHDDDD  EQU   PLHEOVPT
PLHIBUFC EQU   IDAPLH+188
PLHISPLP EQU   IDAPLH+196
PLHIXSPL EQU   IDAPLH+200
PLHSSRBA EQU   PLHIXSPL
PLHWAX   EQU   IDAPLH+232
PLHSLRBA EQU   IDAPLH+244
PLHKEYPT EQU   IDAPLH+248
PLHEND   EQU   IDAPLH+280
PLHKEY   EQU   0
IDABUFDR EQU   0
BUFDRCIX EQU   IDABUFDR+9
BUFDRFLG EQU   IDABUFDR+11
IDABUFC  EQU   0
BUFCAVL  EQU   IDABUFC
BUFCFLG1 EQU   IDABUFC+1
BUFCIOFL EQU   IDABUFC+2
BUFCRRD  EQU   BUFCIOFL
BUFCFLG2 EQU   IDABUFC+3
BUFCPLH  EQU   IDABUFC+4
BUFCDDDD EQU   IDABUFC+8
BUFCBAD  EQU   IDABUFC+20
BUFCNXT1 EQU   IDABUFC+24
BUFCINV  EQU   IDABUFC+28
BUFCNXT2 EQU   IDABUFC+37
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDCINV  EQU   IDAAMDSB+20
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
AMDNIL   EQU   AMDSTAT+8
IDAIXSPL EQU   0
IXSILN   EQU   IDAIXSPL+13
IXSBFLG  EQU   IDAIXSPL+17
IXSHEP   EQU   IDAIXSPL+20
IXSSEP   EQU   IDAIXSPL+24
IXSLEP   EQU   IDAIXSPL+28
IDAIXH   EQU   0
IXHLL    EQU   IDAIXH
IXHFLPLN EQU   IDAIXH+2
IXHPTLS  EQU   IDAIXH+3
IXHBRBA  EQU   IDAIXH+4
IXHHP    EQU   IDAIXH+8
IXHLV    EQU   IDAIXH+16
IXHLEO   EQU   IDAIXH+20
IXHSEO   EQU   IDAIXH+22
IDAIBFLP EQU   0
IBFLPF   EQU   IDAIBFLP
IBFLPL   EQU   IDAIBFLP+1
IBFLP3   EQU   IDAIBFLP+2
IBFLP2   EQU   IBFLP3
IDASELL  EQU   0
IXSELL   EQU   IDASELL
IDAIXK   EQU   0
IDACIDF  EQU   0
CIDFOSET EQU   IDACIDF
CIDFLL   EQU   IDACIDF+2
CIDFBUSY EQU   CIDFLL
IDARDF   EQU   0
RDFRBYTE EQU   IDARDF
RDFCTNU  EQU   RDFRBYTE
RDFSEG   EQU   RDFRBYTE
RDFNOT1  EQU   RDFSEG
RDFREPL  EQU   RDFRBYTE
RDFLL    EQU   IDARDF+1
IDADATA  EQU   0
IDAKEY   EQU   0
KEY      EQU   IDAKEY
PLHPDL   EQU   0
PLHPDLE  EQU   0
PLHRRN   EQU   0
PLHEXTEN EQU   PLHEND
PLHBMWRK EQU   PLHEXTEN+5
BUFCRSC1 EQU   BUFCAVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PLHBMSV5 EQU   PLHEXTEN+24
PLHBMSV4 EQU   PLHEXTEN+20
PLHBMSV3 EQU   PLHEXTEN+16
PLHBMSV2 EQU   PLHEXTEN+12
PLHBMSV1 EQU   PLHEXTEN+8
PLHRDCNT EQU   PLHEXTEN+6
PLHBMSOV EQU   PLHBMWRK
PLHBEUC  EQU   PLHBMWRK
PLHBMRDF EQU   PLHBMWRK
@NM00040 EQU   PLHEXTEN+4
PLHRESR1 EQU   PLHEXTEN
AMDATA   EQU   IDADATA
RDFEMPTY EQU   RDFRBYTE
RDF1ST   EQU   RDFSEG
RDFTYPE  EQU   RDFRBYTE
@NM00047 EQU   CIDFLL
IXKEY    EQU   IDAIXK
IBFLP1   EQU   IBFLP2
IXHFSO   EQU   IDAIXH+18
IXHFLGS  EQU   IDAIXH+17
IXHXX    EQU   IDAIXH+12
IXSPEC   EQU   IDAIXSPL+19
IXSEKON  EQU   IDAIXSPL+18
@NM00046 EQU   IXSBFLG
IXSLELV  EQU   IXSBFLG
IXSSSRH  EQU   IXSBFLG
IXSNOSR  EQU   IDAIXSPL+16
IXSKLEN  EQU   IDAIXSPL+14
IXSTLN   EQU   IDAIXSPL+12
IXSARG   EQU   IDAIXSPL+8
IXSBUFC  EQU   IDAIXSPL+4
IXSSTRBA EQU   IDAIXSPL
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDSTSP  EQU   AMDSTAT
@NM00045 EQU   IDAAMDSB+41
@NM00044 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
BUFCEND  EQU   IDABUFC+64
BUFCUCDN EQU   IDABUFC+60
BUFCUCUP EQU   IDABUFC+56
BUFCMDBT EQU   IDABUFC+52
BUFCHAIN EQU   IDABUFC+48
BUFXORBA EQU   IDABUFC+44
BUFXIRBA EQU   IDABUFC+40
BUFCIDXL EQU   IDABUFC+36
BUFCDSPC EQU   IDABUFC+32
BUFCWLEN EQU   BUFCINV
BUFCCPA  EQU   IDABUFC+16
BUFCORBA EQU   IDABUFC+12
BUFCAMB  EQU   BUFCPLH
@NM00043 EQU   BUFCFLG2
BUFCEOD  EQU   BUFCFLG2
BUFCBSYW EQU   BUFCFLG2
BUFCBSYR EQU   BUFCFLG2
BUFCNLAS EQU   BUFCFLG2
BUFCXDDR EQU   BUFCFLG2
BUFCFIX  EQU   BUFCIOFL
BUFCPFCP EQU   BUFCIOFL
BUFCXEDB EQU   BUFCIOFL
BUFCWC   EQU   BUFCIOFL
BUFCREAL EQU   BUFCIOFL
BUFCFMT  EQU   BUFCIOFL
BUFCMW   EQU   BUFCIOFL
BUFCEPT  EQU   BUFCFLG1
BUFCEXC  EQU   BUFCFLG1
BUFCVAL  EQU   BUFCFLG1
BUFCER2  EQU   BUFCFLG1
BUFCER1  EQU   BUFCFLG1
BUFCINS  EQU   BUFCFLG1
BUFCSEG  EQU   BUFCFLG1
BUFCUPG  EQU   BUFCFLG1
BUFCUCNT EQU   BUFCAVL
@NM00042 EQU   IDABUFDR+16
BUFDBUFC EQU   IDABUFDR+12
@NM00041 EQU   BUFDRFLG
BUFDRAVL EQU   BUFDRFLG
BUFDRREL EQU   BUFDRFLG
BUFDRTSB EQU   IDABUFDR+10
BUFDRMAX EQU   BUFDRCIX
BUFDRPFN EQU   IDABUFDR+8
BUFDRPFB EQU   IDABUFDR+4
BUFDRLEN EQU   IDABUFDR+2
BUFDRNO  EQU   IDABUFDR+1
BUFDRID  EQU   IDABUFDR
PLHERRET EQU   IDAPLH+276
PLHASCB  EQU   IDAPLH+272
PLHECB   EQU   IDAPLH+268
@NM00039 EQU   IDAPLH+265
PLHDRMSK EQU   IDAPLH+264
PLHR13   EQU   IDAPLH+260
PLHPARM1 EQU   IDAPLH+256
PLHDRRSC EQU   IDAPLH+252
PLHSRCSG EQU   IDAPLH+242
PLHNOSEG EQU   IDAPLH+240
PLHLLOR  EQU   IDAPLH+236
PLHXPLH  EQU   PLHWAX
@NM00038 EQU   PLHIXSPL+8
PLHIXBFC EQU   PLHIXSPL+4
PLHHIREC EQU   PLHSSRBA
PLHRBUFC EQU   IDAPLH+192
PLHNRBA  EQU   IDAPLH+184
PLHAR14  EQU   IDAPLH+176
@NM00037 EQU   IDAPLH+172
@NM00036 EQU   IDAPLH+168
PLHASAVE EQU   IDAPLH+164
PLHRETOS EQU   IDAPLH+118
PLHCHAIN EQU   IDAPLH+112
PLHAMB   EQU   IDAPLH+108
PLHARET  EQU   IDAPLH+80
PLHIIOB  EQU   PLHDIOB
PLHSRSID EQU   IDAPLH+74
PLHNBUFC EQU   IDAPLH+56
PLHARDB  EQU   IDAPLH+44
@NM00035 EQU   IDAPLH+43
PLHEOVR  EQU   IDAPLH+42
PLHRCODE EQU   IDAPLH+41
PLHUCODE EQU   PLHJCODE
PLHJNRBA EQU   IDAPLH+36
PLHJRNLL EQU   IDAPLH+32
PLHUPECB EQU   PLHJORBA
PLHDSIDA EQU   IDAPLH+24
PLHCRPL  EQU   IDAPLH+20
PLHMRPL  EQU   IDAPLH+16
PLHFRCNT EQU   IDAPLH+14
PLHRMIN  EQU   IDAPLH+13
PLHDSTYP EQU   IDAPLH+12
PLHACB   EQU   IDAPLH+8
PLHRAE   EQU   PLHAFLGS
PLHIOSID EQU   PLHAFLGS
PLHDBDC  EQU   PLHAFLGS
PLHVAMB  EQU   PLHAFLGS
PLHIOSRQ EQU   PLHAFLGS
PLHDRLM  EQU   PLHAFLGS
PLHEOVDF EQU   PLHFLG3
PLHBWD   EQU   PLHFLG3
PLHRAHD  EQU   PLHFLG3
PLHSRBSG EQU   PLHFLG3
@NM00034 EQU   PLHEFLGS+1
PLHRSTRT EQU   PLHEFLGS+1
PLHINVAL EQU   PLHEFLGS
PLHEODX  EQU   PLHEFLGS
PLHSRINV EQU   PLHEFLGS
PLH1ST   EQU   PLHEFLGS
PLHNOSPC EQU   PLHEFLGS
PLHIWAIT EQU   PLHFLG2
PLHSVADV EQU   PLHFLG2
PLHCIINS EQU   PLHFLG2
PLHKRE   EQU   PLHFLG2
PLHADDTE EQU   PLHFLG2
PLHKEYMD EQU   PLHFLG2
PLHSQINS EQU   PLHFLG2
PLHUPD   EQU   PLHFLG2
@NM00033 EQU   PLHFLG1
PLHDRPND EQU   PLHFLG1
PLHASYRQ EQU   PLHFLG1
PLHENDRQ EQU   PLHFLG1
PLHEOVW  EQU   PLHFLG1
PLHATV   EQU   IDAPLH+1
PLHAVL   EQU   IDAPLH
PLHIOSDQ EQU   IDAPLHDR+12
PLHDRCUR EQU   IDAPLHDR+10
PLHDRMAX EQU   IDAPLHDR+8
PLHDRREQ EQU   IDAPLHDR+4
PLHELTH  EQU   IDAPLHDR+2
PLHCNT   EQU   IDAPLHDR+1
PLHID    EQU   IDAPLHDR
AMBTRACE EQU   IDAAMB+120
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBCPA   EQU   IDAAMB+92
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00032 EQU   AMBCSWD1+1
@NM00031 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
@NM00030 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
AMBPAMBL EQU   IDAAMB+76
AMBPIXP  EQU   IDAAMB+72
@NM00029 EQU   IDAAMB+68
AMBIWA   EQU   IDAAMB+64
AMBWKA   EQU   IDAAMB+60
AMBAMBXN EQU   AMBEOVPT
AMBEDB   EQU   IDAAMB+52
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
AMBEXFG  EQU   AMBOFLGS
@NM00028 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00027 EQU   AMBOFLGS
AMBDEBAD EQU   AMBDEBPT+1
AMBIFLGS EQU   AMBDEBPT
AMBAMETH EQU   IDAAMB+43
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00026 EQU   AMBINFL
@NM00025 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00024 EQU   IDAAMB+38
AMBDDSN  EQU   IDAAMB+35
AMBCDSN  EQU   IDAAMB+32
AMBIOMB  EQU   AMBIOBAD
@NM00023 EQU   AMBDSORG+1
AMBDORGA EQU   AMBDSORG+1
@NM00022 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBTYPE  EQU   AMBFLG1
AMBCREAT EQU   AMBFLG1
@NM00021 EQU   AMBFLG0
AMBPSDS  EQU   AMBFLG0
AMBCACB  EQU   IDAAMB+16
AMBPH    EQU   IDAAMB+12
AMBBUFC  EQU   IDAAMB+8
AMBLINK  EQU   IDAAMB+4
AMBLEN   EQU   IDAAMB+2
AMBRSC   EQU   IDAAMB+1
AMBID    EQU   IDAAMB
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLDTA  EQU   IDAAMBL+52
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00020 EQU   IDAAMBL+40
AMBLNUM  EQU   IDAAMBL+38
AMBLNST  EQU   IDAAMBL+37
@NM00019 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00018 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLCAT  EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLVVIC EQU   AMBLFLG1
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
AMBLLEN  EQU   IDAAMBL+34
@NM00017 EQU   AMBLSHAR
AMBLWRIT EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
AMBLID   EQU   IDAAMBL+32
@NM00016 EQU   IDAAMBL+31
@NM00015 EQU   AMBLTYPE
AMBLFIX  EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00014 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLACB  EQU   IDAAMBL+8
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00013 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBVVIC  EQU   ACBINFLG
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00012 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00011 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00010 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00009 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00008 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00007 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00006 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00005 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00004 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00003 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
@NM00002 EQU   RPLRBAR+3
@NM00001 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLRLEN  EQU   RPLCOMN+48
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLWAITX EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLAREA  EQU   RPLCOMN+32
RPLTCBPT EQU   RPLCOMN+28
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00370 EQU   GETNXBF
@RF00368 EQU   IDAAPH01
@RT00422 EQU   GETNXBF
@RT00428 EQU   GETNXBF
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDA019RV,(C'PLS2139',0701,78172)

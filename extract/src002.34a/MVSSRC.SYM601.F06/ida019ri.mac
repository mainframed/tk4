         TITLE 'IDA019RI--VSAM INDEX UPGRADE                           *
                        '
IDA019RI CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IDA019RI  78.209'                                 0001
IDAHLINS DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00177-IDAHLINS)
         ENTRY IDAHLINS
IDANEWRD DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00611-IDANEWRD)
         ENTRY IDANEWRD
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*   RWORK0=ZERO;                    /* SET FOR RI CALL@X04SVES       */
         SLR   RWORK0,RWORK0                                       0175
*   GOTO MAINENT;                   /* MAIN ENTRY PT.        @X04SVRQ*/
         B     MAINENT                                             0176
*/*    ENTRY POINT TO MAKE HIGH LEVEL INDEX INSERT                   */
*                                                                  0177
*IDAHLINS:                                                         0177
*   ENTRY;                          /* ENTRY FOR UPGRADING INDEX HIGH
*                                      LEVELS.               @X04SVRQ*/
@EP00177 DS    0H                                                  0178
*   RWORK0=ONE;                     /* SET FOR HI LVL        @X04SVES*/
         LA    RWORK0,1                                            0178
*MAINENT:                                                          0179
*   GEN SETS(PLHRETO,PLHRET1)(IDASVR14);/* SAVE REG 14       @X04SVRQ*/
MAINENT  IDASVR14
*   RESPECIFY                                                      0180
*     R14 UNRSTD;                   /*                       @X04SVES*/
*                                                                  0180
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IMWA FIELDS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0181
*   IMWCIMVN=ZERO;                  /* ZERO NO. OF CIS TO MOVE       */
         L     @10,AMBIWA(,RAMB)                                   0181
         L     @05,ICWCHN(,@10)                                    0181
         SLR   @15,@15                                             0181
         STH   @15,IMWCIMVN(,@05)                                  0181
*   IMWRIPL=OFF;                    /* RESET RIPPLE FLAG             */
*   IMWNEWHL=OFF;                   /* RESET NEW HIGH LV FLAG        */
         NI    IMWRIPL(@05),B'00111111'                            0183
*   IMWIXSP=ADDR(IMWISWKA);         /* SET PTR TO IX SEARCH PL       */
         LA    @15,IMWISWKA(,@05)                                  0184
         ST    @15,IMWIXSP(,@05)                                   0184
*   RPARM1=ZERO;                    /* 1ST CALL TO IDA019RJ          */
         SLR   RPARM1,RPARM1                                       0185
*   ICWADD=ADDR(IDAICWA);           /* POINT TO CURRENT ICWA         */
         ST    @10,ICWADD(,@10)                                    0186
*   RBUFC=PLHIBUFC;                 /* PTR TO SEQ. SET BUFC          */
         L     RBUFC,PLHIBUFC(,RPLH)                               0187
*   ICWBUFC=RBUFC;                  /* SET PTR IN ICW                */
         ST    RBUFC,ICWBUFC(,@10)                                 0188
*   IMWBUFP=RBUFC->BUFCBAD;         /* SET POINTER TO RECORD         */
         L     @15,BUFCBAD(,RBUFC)                                 0189
         ST    @15,IMWBUFP(,@05)                                   0189
*   IF RWORK0=ONE THEN              /* HI LVL INSERT         @X04SVES*/
         CL    RWORK0,@CF00053                                     0190
         BE    @RT00190                                            0190
*     GO TO HLINSERT;               /* YES                   @X04SVES*/
*   RESPECIFY                                                      0192
*     RWORK0 UNRSTD;                /*                       @X04SVES*/
*   ICWCRBA=RBUFC->BUFCDDDD;        /* SET RBA IN ICW                */
         L     @05,BUFCDDDD(,RBUFC)                                0193
         ST    @05,ICWCRBA(,@10)                                   0193
*   PLHSSRBA=RBUFC->BUFCDDDD;       /* SAVE RBA IN PLH               */
         ST    @05,PLHSSRBA(,RPLH)                                 0194
*   IF PLHADDTE=ON&RPLRLEN^>AMBLDTA->/* ADD TO END           @X04SVES*/
*       AMBDSB->AMDCINV-            /* OF DATA SET           @X04SVES*/
*       (LENGTH(IDACIDF)+LENGTH(IDARDF)) THEN/* PROCESSING AND NOT A
*                                      SPANNED RECORD        @X04SVES*/
         TM    PLHADDTE(RPLH),B'00010000'                          0195
         BNO   @RF00195                                            0195
         L     @05,RPLDACB(,RRPL)                                  0195
         L     @05,ACBAMBL(,@05)                                   0195
         L     @05,AMBLDTA(,@05)                                   0195
         L     @05,AMBDSB(,@05)                                    0195
         L     @05,AMDCINV(,@05)                                   0195
         SL    @05,@CF00295                                        0195
         C     @05,RPLRLEN(,RRPL)                                  0195
         BL    @RF00195                                            0195
*     DO;                           /* YES.                          */
*                                                                  0196
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN INDEX RECORD AND EXTRACT THE LAST TWO (HIGH KEY)     */
*       /* SECTION ENTRIES.                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0197
*       RPARM1=ADDR(ICWKEY1);       /* POINT TO KEY AREA             */
         LA    RPARM1,ICWKEY1(,@10)                                0197
*       ICWPSEO=IXHSEO;             /* OFFSET TO 1ST SECTION         */
         LH    @05,IXHSEO(,@15)                                    0198
         STH   @05,ICWPSEO(,@10)                                   0198
*       RBUFC=ZERO;                 /* FORCE ONCE THRU LOOP          */
         SLR   RBUFC,RBUFC                                         0199
*       RFY                                                        0200
*        (RWORK1,                                                  0200
*         RWORK2,                                                  0200
*         RWORK3) RSTD;                                            0200
*       DO WHILE RBUFC^=IXHLEO;     /* LOOP UP TO LAST ENTRY         */
         B     @DE00201                                            0201
@DL00201 DS    0H                                                  0202
*         CALL EXTKEY;              /* EXTRACT SECTION KEY           */
         BAL   @14,EXTKEY                                          0202
*         RBUFC=ICWPSEO-RWORK3;     /* POINT TO NEXT SECTION         */
         L     @10,AMBIWA(,RAMB)                                   0203
         LH    RBUFC,ICWPSEO(,@10)                                 0203
         SLR   RBUFC,RWORK3                                        0203
*         ICWPSEO=RBUFC;            /* SET POINTER IN WORKAREA       */
         STH   RBUFC,ICWPSEO(,@10)                                 0204
*       END;                        /* END OF EXTRACT LOOP           */
@DE00201 L     @10,AMBIWA(,RAMB)                                   0205
         L     @15,ICWCHN(,@10)                                    0205
         L     @15,IMWBUFP(,@15)                                   0205
         CH    RBUFC,IXHLEO(,@15)                                  0205
         BNE   @DL00201                                            0205
*       ICWKEY1L=RWORK1+RWORK2;     /* SAVE KEY LENGTH               */
         LR    @00,RWORK1                                          0206
         ALR   @00,RWORK2                                          0206
         STH   @00,ICWKEY1L(,@10)                                  0206
*       ICWKEY3L=RWORK3;            /* SAVE SECTION LENGTH           */
         STH   RWORK3,ICWKEY3L(,@10)                               0207
*       RPARM1=RPARM1+AMDKEYLN;     /* POINT TO NEXT KEY AREA        */
         L     @15,AMBDSB(,RAMB)                                   0208
         AH    RPARM1,AMDKEYLN(,@15)                               0208
*       RWORK1=ICWKEY1L;            /* PICK UP KEY LENGTH            */
         LR    RWORK1,@00                                          0209
*       IF RWORK1^=ZERO THEN        /* LENGTH = 0                    */
         LTR   RWORK1,RWORK1                                       0210
         BZ    @RF00210                                            0210
*         DO;                       /* NO.                           */
*           RPARM1->KEY(1:RWORK1)=  /* COPY KEY TO PREPARE           */
*               ICWKEY1(1:RWORK1);  /* FOR EXTRACT OF NEXT KEY       */
         LR    @15,RWORK1                                          0212
         BCTR  @15,0                                               0212
         EX    @15,@SM01169                                        0212
*           CALL EXTKEY;            /* EXTRACT LAST SECTION          */
         BAL   @14,EXTKEY                                          0213
*           ICWKEY2L=RWORK1+RWORK2; /* SET LENGTH OF LAST KEY        */
         L     @10,AMBIWA(,RAMB)                                   0214
         LR    @00,RWORK1                                          0214
         ALR   @00,RWORK2                                          0214
         STH   @00,ICWKEY2L(,@10)                                  0214
*         END;                      /* END OF LAST EXTRACT           */
*       ELSE                        /*                               */
*         ICWKEY2L=RWORK1;          /* SET LAST LENGTH = 0           */
         B     @RC00210                                            0216
@RF00210 L     @10,AMBIWA(,RAMB)                                   0216
         STH   RWORK1,ICWKEY2L(,@10)                               0216
*       IMWXPTR=IXHHP;              /* SAVE HORIZONTAL POINTER       */
@RC00210 L     @10,AMBIWA(,RAMB)                                   0217
         L     @10,ICWCHN(,@10)                                    0217
         L     @15,IMWBUFP(,@10)                                   0217
         L     @00,IXHHP(,@15)                                     0217
         ST    @00,IMWXPTR(,@10)                                   0217
*       RBUFC=PLHIBUFC;             /* POINT TO INDEX BUFC           */
         L     RBUFC,PLHIBUFC(,RPLH)                               0218
*       RFY                                                        0219
*        (RWORK1,                                                  0219
*         RWORK2,                                                  0219
*         RWORK3) UNRSTD;           /*                       @X04SVES*/
*I01:                                                              0220
*       DO;                         /* IDACALL(IDAFREEB)             */
I01      DS    0H                                                  0221
*         CALL IDAFREEB;            /* EXIT TO IDAFREEB              */
         L     @15,@CV01029                                        0221
         BALR  @14,@15                                             0221
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I01;                    /* FREE BUFFER           @X04SVLP*/
*       ICWLN=ONE;                  /* SET INDEX LEVEL NUMBER        */
         L     @10,AMBIWA(,RAMB)                                   0227
         MVC   ICWLN(2,@10),@CH00053                               0227
*       IF AMDRANGE=ON THEN         /* SET KEY RANGE         @X04SVES*/
         L     @05,AMBDSB(,RAMB)                                   0228
         TM    AMDRANGE(@05),B'00000100'                           0228
         BNO   @RF00228                                            0228
*         ICWKRDS=ON;               /* REMINDER              @X04SVES*/
         OI    ICWKRDS(@10),B'00000100'                            0229
*I02:                                                              0230
*       DO;                         /* IDACALL(IDANEWRD)             */
@RF00228 DS    0H                                                  0230
I02      DS    0H                                                  0231
*         CALL IDANEWRD;            /* EXIT TO IDANEWRD              */
         L     @15,@CA01084                                        0231
         BALR  @14,@15                                             0231
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I02;                    /* INIT NEW RECORD       @X04SVRQ*/
*       IF RPLERREG^=ZERO THEN      /* IF ERROR IN NEW RECORD        */
         CLI   RPLERREG(RRPL),0                                    0237
         BNE   @RT00237                                            0237
*         GO TO WTERR;              /* EXIT                          */
*       RFY                                                        0239
*         IDAIXH BASED(RBUFC);                                     0239
*       RBUFC=IMWBUFP;              /* POINT TO RECORD BUFFER        */
         L     @10,AMBIWA(,RAMB)                                   0240
         L     @15,ICWCHN(,@10)                                    0240
         L     RBUFC,IMWBUFP(,@15)                                 0240
*       PLHSSRBA=ICWCRBA;           /* NEW SS RBA FOR CA SPLIT       */
         L     @05,ICWCRBA(,@10)                                   0241
         ST    @05,PLHSSRBA(,RPLH)                                 0241
*       RPARM1=AMBLDTA->AMBDSB->AMDCIPCA;/* PICK UP CI PER CA VALUE  */
         L     @05,RPLDACB(,RRPL)                                  0242
         L     @05,ACBAMBL(,@05)                                   0242
         L     @05,AMBLDTA(,@05)                                   0242
         L     @05,AMBDSB(,@05)                                    0242
         LH    RPARM1,AMDCIPCA(,@05)                               0242
*       IF RPARM1^>T56 THEN         /* MORE THAN 256                 */
         C     RPARM1,@CF01045                                     0243
         BH    @RF00243                                            0243
*         DO;                       /* NO.                           */
*           ICWPTL=ONE;             /* SET PTR LENGTH                */
         MVI   ICWPTL(@10),X'01'                                   0245
*           IXHPTLS='01'X;          /* SET PTR LENGTH MASK           */
         MVI   IXHPTLS(RBUFC),X'01'                                0246
*         END;                      /* END OF NOT > 256              */
*       ELSE                        /* > 256                         */
*         DO;                       /* YES.                          */
         B     @RC00243                                            0248
@RF00243 DS    0H                                                  0249
*           ICWPTL=TWO;             /* SET PTR LENGTH                */
         L     @10,AMBIWA(,RAMB)                                   0249
         MVI   ICWPTL(@10),X'02'                                   0249
*           IXHPTLS='03'X;          /* SET PTR LENGTH MASK           */
         MVI   IXHPTLS(RBUFC),X'03'                                0250
*         END;                      /* END OF > 256                  */
*       IXHFLPLN=ICWPTL+LENGTH(IBFLPF)+/* SET F,L,PTR COMBINED       */
*           LENGTH(IBFLPL);         /* FIELDS LENGTH                 */
@RC00243 L     @10,AMBIWA(,RAMB)                                   0252
         LA    @05,2                                               0252
         SLR   @00,@00                                             0252
         IC    @00,ICWPTL(,@10)                                    0252
         ALR   @05,@00                                             0252
         STC   @05,IXHFLPLN(,RBUFC)                                0252
*       RFY                                                        0253
*        (RWORK1,                                                  0253
*         RWORK2) RSTD;                                            0253
*       RWORK1=IXHPTLS;             /* PICK UP PTR MASK              */
         SLR   RWORK1,RWORK1                                       0254
         IC    RWORK1,IXHPTLS(,RBUFC)                              0254
*       RWORK2=IMWBUFP+LENGTH(IDAIXH);/* POINT BEYOND HEADER         */
         L     @10,ICWCHN(,@10)                                    0255
         LA    RWORK2,24                                           0255
         AL    RWORK2,IMWBUFP(,@10)                                0255
*       DO RPARM1=RPARM1-1 BY-1 TO 1;/* LOOP SETTING PTRS            */
         LR    @10,RPARM1                                          0256
         BCTR  @10,0                                               0256
         LR    RPARM1,@10                                          0256
         B     @DE00256                                            0256
@DL00256 DS    0H                                                  0257
*         GEN(EX RWORK1,STOREPT);   /* STORE POINTER VALUE           */
         EX RWORK1,STOREPT
*         RWORK2=RWORK2+ICWPTL;     /* NEXT POINTER LOCATION         */
         L     @10,AMBIWA(,RAMB)                                   0258
         SLR   @07,@07                                             0258
         IC    @07,ICWPTL(,@10)                                    0258
         ALR   RWORK2,@07                                          0258
*       END;                        /* END OF SET PTRS LOOP          */
         BCTR  RPARM1,0                                            0259
@DE00256 LTR   RPARM1,RPARM1                                       0259
         BP    @DL00256                                            0259
*       IXHFSO=RWORK2-IMWBUFP;      /* SET OFFSET TO INSERT SP       */
         L     @10,AMBIWA(,RAMB)                                   0260
         L     @07,ICWCHN(,@10)                                    0260
         L     @15,IMWBUFP(,@07)                                   0260
         LR    @00,RWORK2                                          0260
         SLR   @00,@15                                             0260
         STH   @00,IXHFSO(,RBUFC)                                  0260
*       IXHLEO=IXHLL-IXHFLPLN;      /* POINT TO 1ST ENTRY            */
         LH    @00,IXHLL(,RBUFC)                                   0261
         N     @00,@CF01171                                        0261
         SLR   @14,@14                                             0261
         IC    @14,IXHFLPLN(,RBUFC)                                0261
         SLR   @00,@14                                             0261
         STH   @00,IXHLEO(,RBUFC)                                  0261
*       IXHSEO=IXHLEO;              /* COPY OFFSET                   */
         STH   @00,IXHSEO(,RBUFC)                                  0262
*       IXHHP=IMWXPTR;              /* SET HORIZ. PTR FROM OLD       */
         L     @07,IMWXPTR(,@07)                                   0263
         ST    @07,IXHHP(,RBUFC)                                   0263
*       IXHLV=ONE;                  /* SET LEVEL NUMBER              */
         MVI   IXHLV(RBUFC),X'01'                                  0264
*       IXHBRBA=ICWTBASE;           /* SET BASE DATA RBA             */
         L     @07,ICWTBASE(,@10)                                  0265
         ST    @07,IXHBRBA(,RBUFC)                                 0265
*       RWORK1=ICWKEY2L;            /* L VALUE FOR ENTRY             */
         LH    RWORK1,ICWKEY2L(,@10)                               0266
*       IF RWORK1^=ZERO THEN        /* L = 0                         */
         LTR   RWORK1,RWORK1                                       0267
         BZ    @RF00267                                            0267
*         DO;                       /* NO.                           */
*           RWORK2=IMWBUFP+IXHLEO;  /* POINT TO F LOCATION           */
         ALR   @15,@00                                             0269
         LR    RWORK2,@15                                          0269
*           RWORK2->IBFLPL=RWORK1;  /* SET ENTRY L VALUE             */
         STC   RWORK1,IBFLPL(,RWORK2)                              0270
*           RWORK2=RWORK2-RWORK1;   /* BACK UP TO KEY FIELD          */
         SLR   RWORK2,RWORK1                                       0271
*           RBUFC=ADDR(ICWKEY1)+AMDKEYLN;/* POINT TO KEY             */
         LA    RBUFC,ICWKEY1(,@10)                                 0272
         L     @10,AMBDSB(,RAMB)                                   0272
         AH    RBUFC,AMDKEYLN(,@10)                                0272
*           RWORK2->KEY(1:RWORK1)=  /* MOVE KEY CHARACTERS           */
*               RBUFC->KEY(1:RWORK1);/* INTO INDEX RECORD            */
         LR    @10,RWORK1                                          0273
         BCTR  @10,0                                               0273
         EX    @10,@SM01172                                        0273
*         END;                      /* END OF L NOT = 0              */
*       RFY                                                        0275
*         IDAIXH BASED(IMWBUFP);                                   0275
@RF00267 DS    0H                                                  0276
*       RFY                                                        0276
*        (RWORK1,                                                  0276
*         RWORK2) UNRSTD;           /*                       @X04SVES*/
*I03:                                                              0277
*       DO;                         /* IDACALL(IWRITE)               */
I03      DS    0H                                                  0278
*         CALL IWRITE;              /* EXIT TO IWRITE                */
         BAL   @14,IWRITE                                          0278
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I03;                    /* WRITE INDEX RECORD            */
*       CALL GETSREC;               /* GET OLD SEQ. SET RECORD       */
*                                                                  0284
         BAL   @14,GETSREC                                         0284
*       /*************************************************************/
*       /*                                                           */
*       /* LOCATE LAST KEY IN FULL DATA CONTROL INTERVAL             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0285
*       RFY                                                        0285
*        (RWORK1,                                                  0285
*         RWORK2,                                                  0285
*         RWORK3) RSTD;                                            0285
*       RWORK1=PLHDBUFC->BUFCBAD;   /* POINT TO DATA BUFFER          */
         L     @10,PLHDBUFC(,RPLH)                                 0286
         L     RWORK1,BUFCBAD(,@10)                                0286
*       RWORK2=RWORK1+              /* POINT TO CIDF                 */
*           AMBLDTA->AMBDSB->AMDCINV-/*                              */
*           LENGTH(IDACIDF);        /*                               */
         L     @10,RPLDACB(,RRPL)                                  0287
         L     @10,ACBAMBL(,@10)                                   0287
         L     @10,AMBLDTA(,@10)                                   0287
         L     @10,AMBDSB(,@10)                                    0287
         LR    RWORK2,RWORK1                                       0287
         AL    RWORK2,AMDCINV(,@10)                                0287
         SL    RWORK2,@CF00067                                     0287
*       RWORK1=RWORK1+RWORK2->CIDFOSET;/* POINT BEYOND LAST REC      */
         AH    RWORK1,CIDFOSET(,RWORK2)                            0288
*       RWORK2=RWORK1+RWORK2->CIDFLL;/* POINT TO LAST RDF            */
         LR    @10,RWORK1                                          0289
         AH    @10,CIDFLL(,RWORK2)                                 0289
         LR    RWORK2,@10                                          0289
*       IF RWORK2->RDFREPL=ON THEN  /* GROUP RDF                     */
         TM    RDFREPL(RWORK2),B'00001000'                         0290
         BNO   @RF00290                                            0290
*         RWORK2=RWORK2+LENGTH(IDARDF);/* MOVE OVER FOR LENGTH       */
         AL    RWORK2,@CF00164                                     0291
*       RBUFC=RWORK1-RWORK2->RDFLL+ /* POSITION TO LAST KEY          */
*           AMDRKP;                 /* IN BUFFER                     */
@RF00290 LR    RBUFC,RWORK1                                        0292
         SLR   @10,@10                                             0292
         ICM   @10,3,RDFLL(RWORK2)                                 0292
         SLR   RBUFC,@10                                           0292
         L     @10,AMBDSB(,RAMB)                                   0292
         LH    @15,AMDRKP(,@10)                                    0292
         ALR   RBUFC,@15                                           0292
*       IMWIKEYP=RBUFC;             /* SET POINTER IN WA             */
         L     @14,AMBIWA(,RAMB)                                   0293
         L     @14,ICWCHN(,@14)                                    0293
         ST    RBUFC,IMWIKEYP(,@14)                                0293
*       RWORK2=RPLAREA+AMDRKP;      /* POINT TO NEW RECORD KEY       */
         AL    @15,RPLAREA(,RRPL)                                  0294
         LR    RWORK2,@15                                          0294
*       RWORK1=AMDKEYLN;            /* KEY LENGTH                    */
         LH    RWORK1,AMDKEYLN(,@10)                               0295
*       RWORK3=RWORK1;              /* COPY                          */
         LR    RWORK3,RWORK1                                       0296
*       GEN(CLCL RBUFC,RWORK2);     /* COMPARE                       */
         CLCL RBUFC,RWORK2
*       IMWIEL=AMDKEYLN-RWORK1+ONE; /* F+L VALUE                     */
         L     @10,AMBIWA(,RAMB)                                   0298
         L     @15,ICWCHN(,@10)                                    0298
         L     @14,AMBDSB(,RAMB)                                   0298
         LH    @00,AMDKEYLN(,@14)                                  0298
         SLR   @00,RWORK1                                          0298
         AL    @00,@CF00053                                        0298
         STC   @00,IMWIEL(,@15)                                    0298
*       IF IXHLEO=IXHSEO THEN       /* ONLY 1 SECTION                */
         L     @15,IMWBUFP(,@15)                                   0299
         CLC   IXHLEO(2,@15),IXHSEO(@15)                           0299
         BNE   @RF00299                                            0299
*         ICWKEY1L=ZERO;            /* YES. NO FRONT COMPRESS        */
         SLR   @00,@00                                             0300
         STH   @00,ICWKEY1L(,@10)                                  0300
*       RBUFC=IMWIKEYP;             /* POINT TO INSERT KEY           */
@RF00299 L     @10,AMBIWA(,RAMB)                                   0301
         L     @15,ICWCHN(,@10)                                    0301
         L     RBUFC,IMWIKEYP(,@15)                                0301
*       RWORK2=ADDR(ICWKEY1);       /* POINT TO PREVIOUS SECT.       */
         LA    RWORK2,ICWKEY1(,@10)                                0302
*       RWORK1=ICWKEY1L;            /* F+L VALUE                     */
         LH    RWORK1,ICWKEY1L(,@10)                               0303
*       IF RWORK1^=ZERO THEN        /* F+L = 0                       */
         LTR   RWORK1,RWORK1                                       0304
         BZ    @RF00304                                            0304
*         DO;                       /* NO.                           */
*           IF RWORK1>IMWIEL THEN   /* F+L > NEW ENTRY F+L           */
         SLR   @10,@10                                             0306
         IC    @10,IMWIEL(,@15)                                    0306
         CR    RWORK1,@10                                          0306
         BNH   @RF00306                                            0306
*             RWORK1=IMWIEL;        /* YES. USE NEW ENTRY F+L        */
         LR    RWORK1,@10                                          0307
*           RWORK3=RWORK1;          /* COPY                          */
@RF00306 LR    RWORK3,RWORK1                                       0308
*           RPARM1=RWORK1;          /* SAVE                          */
         LR    RPARM1,RWORK1                                       0309
*           GEN(CLCL RBUFC,RWORK2); /* COMPARE                       */
         CLCL RBUFC,RWORK2
*           ICWKEY1L=RPARM1-RWORK1; /* NEW ENTRY F VALUE             */
         L     @10,AMBIWA(,RAMB)                                   0311
         LR    @00,RPARM1                                          0311
         SLR   @00,RWORK1                                          0311
         STH   @00,ICWKEY1L(,@10)                                  0311
*         END;                      /* END OF FRONT COMPRESS         */
*       IMWIEL=IMWIEL-ICWKEY1L;     /* NEW ENTRY L VALUE             */
@RF00304 L     @10,AMBIWA(,RAMB)                                   0313
         L     @15,ICWCHN(,@10)                                    0313
         SLR   @00,@00                                             0313
         IC    @00,IMWIEL(,@15)                                    0313
         SH    @00,ICWKEY1L(,@10)                                  0313
         STC   @00,IMWIEL(,@15)                                    0313
*       RWORK1=IMWBUFP+IXHLEO;      /* POINT TO LAST ENTRY           */
         L     @10,IMWBUFP(,@15)                                   0314
         LH    RWORK1,IXHLEO(,@10)                                 0314
         ALR   RWORK1,@10                                          0314
*       RWORK2=RWORK1->IBFLPL;      /* PICK UP L VALUE               */
         SLR   RWORK2,RWORK2                                       0315
         IC    RWORK2,IBFLPL(,RWORK1)                              0315
*       IF RWORK2^=ZERO THEN        /* = 0                           */
         LTR   RWORK2,RWORK2                                       0316
         BZ    @RF00316                                            0316
*         DO;                       /* NO.                           */
*           RWORK1=RWORK1-RWORK2;   /* POSITION TO KEY               */
         SLR   RWORK1,RWORK2                                       0318
*           RWORK2=RWORK2-ONE;      /* REDUCE FOR EX                 */
         BCTR  RWORK2,0                                            0319
*           GEN(EX RWORK2,ZEROK);   /* ZERO OLD KEY                  */
         EX RWORK2,ZEROK
*         END;                      /* END OF OLD KEY CLEAR          */
*       RWORK2=IMWIEL;              /* NEW ENTRY L VALUE             */
@RF00316 L     @10,AMBIWA(,RAMB)                                   0322
         L     @15,ICWCHN(,@10)                                    0322
         SLR   RWORK2,RWORK2                                       0322
         IC    RWORK2,IMWIEL(,@15)                                 0322
*       RWORK1=IMWBUFP+IXHLEO;      /* POINT TO ENTRY LOCATION       */
         L     @14,IMWBUFP(,@15)                                   0323
         LH    RWORK1,IXHLEO(,@14)                                 0323
         ALR   RWORK1,@14                                          0323
*       RWORK1->IBFLPF=ICWKEY1L;    /* SET F VALUE                   */
         LH    @10,ICWKEY1L(,@10)                                  0324
         STC   @10,IBFLPF(,RWORK1)                                 0324
*       RWORK1->IBFLPL=RWORK2;      /* SET L VALUE                   */
         STC   RWORK2,IBFLPL(,RWORK1)                              0325
*       RBUFC=IMWIKEYP;             /* POINT TO KEY                  */
         L     RBUFC,IMWIKEYP(,@15)                                0326
*       IF RWORK2^=ZERO THEN        /* L = 0                         */
         LTR   RWORK2,RWORK2                                       0327
         BZ    @RF00327                                            0327
*         DO;                       /* NO.                           */
*           RWORK1=RWORK1-RWORK2;   /* POSITION TO KEY               */
         SLR   RWORK1,RWORK2                                       0329
*           RWORK1->KEY(1:RWORK2)=  /* INSERT KEY CHARACTERS         */
*               RBUFC->KEY(ICWKEY1L+1:ICWKEY1L/* OFFSET F THRU F+L   */
*               +RWORK2);           /*                               */
         LR    @15,RWORK2                                          0330
         BCTR  @15,0                                               0330
         ALR   @10,RBUFC                                           0330
         EX    @15,@SM01174                                        0330
*         END;                      /* END OF ENTRY BUILD            */
*       IXHHP=ICWCRBA;              /* SET HORIZ. PTR                */
*                                                                  0332
@RF00327 L     @10,AMBIWA(,RAMB)                                   0332
         L     @15,ICWCHN(,@10)                                    0332
         L     @15,IMWBUFP(,@15)                                   0332
         L     @00,ICWCRBA(,@10)                                   0332
         ST    @00,IXHHP(,@15)                                     0332
*       /*************************************************************/
*       /*                                                           */
*       /* SET INFORMATION NEEDED FOR INSERT INTO LEVEL 2            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0333
*       RWORK1=ICWKEY1L+RWORK2;     /* NEW ENTRY F + L               */
         LR    RWORK1,RWORK2                                       0333
         LH    @00,ICWKEY1L(,@10)                                  0333
         ALR   RWORK1,@00                                          0333
*       ICWKEY1L=RWORK1;            /* SET IN WORK AREA              */
         STH   RWORK1,ICWKEY1L(,@10)                               0334
*       ICWKEY1(1:RWORK1)=RBUFC->KEY/* MOVE KEY CHARACTERS           */
*           (1:RWORK1);             /* TO WORK AREA                  */
         LR    @15,RWORK1                                          0335
         BCTR  @15,0                                               0335
         EX    @15,@SM01176                                        0335
*       RFY                                                        0336
*        (RWORK1,                                                  0336
*         RWORK2,                                                  0336
*         RWORK3) UNRSTD;           /*                       @X04SVES*/
*I04:                                                              0337
*       DO;                         /* IDACALL(IWRITE)               */
I04      DS    0H                                                  0338
*         CALL IWRITE;              /* EXIT TO IWRITE                */
         BAL   @14,IWRITE                                          0338
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I04;                    /* WRITE INDEX RECORD            */
*     END;                          /* END OF ADD TO END             */
*   ELSE                            /* NOT ADD TO END                */
*     DO;                           /* SPLIT SEQ. SET RECORD         */
*                                                                  0345
         B     @RC00195                                            0345
@RF00195 DS    0H                                                  0346
*       /*************************************************************/
*       /*                                                           */
*       /* CALL IDA019RJ (SPLIT INDEX RECORD) TO SPLIT THE SEQUENCE  */
*       /* SET RECORD FORMING A NEW RECORD FOR THE CONTROL AREA.     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0346
*SPLIT1:                                                           0346
*I05:                                                              0346
*       DO;                         /* IDACALL(IDA019RJ)             */
SPLIT1   DS    0H                                                  0346
I05      DS    0H                                                  0347
*         CALL IDA019RJ;            /* EXIT TO IDA019RJ              */
         L     @15,@CV01034                                        0347
         BALR  @14,@15                                             0347
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I05;                                                   0352
*       RFY                                                        0353
*         R15 RESTRICTED;           /* RESTRICT REGISTER R15         */
*       IF AMBTRACE^=ZERO THEN      /* IS IDATRACE ACTIVE    @ZA29388*/
         L     @14,AMBTRACE(,RAMB)                                 0354
         LTR   @14,@14                                             0354
         BZ    @RF00354                                            0354
*         DO;                       /*                       @ZA29388*/
*           RFY                                                    0356
*             RWORK1 RESTRICTED;    /*                       @ZA29388*/
*           RWORK1=R15;             /* SAVE REG15            @ZA29388*/
         LR    RWORK1,R15                                          0357
*           CALL IDA019ST;          /* CALL IDATRACE         @ZA29388*/
         L     @15,@CV01101                                        0358
         BALR  @14,@15                                             0358
*           GEN(DC X'000D');        /* TRACE ID              @ZA29388*/
         DC X'000D'
*           R15=RWORK1;             /* RESTORE REG15         @ZA29388*/
         LR    R15,RWORK1                                          0360
*           RFY                                                    0361
*             RWORK1 UNRSTD;        /*                       @ZA29388*/
*         END;                      /*                       @ZA29388*/
*       IF R15^=ZERO THEN           /* SPLIT ERROR                   */
@RF00354 LTR   R15,R15                                             0363
         BZ    @RF00363                                            0363
*         DO;                       /* YES.                          */
*           IF R15=IXWRERR THEN     /* INDEX WRITE ERROR             */
         C     R15,@CF00067                                        0365
         BE    @RT00365                                            0365
*             GO TO EXIT;           /* YES. EXIT                     */
*           ELSE                    /*                               */
*             DO;                   /* COULD NOT SPLIT               */
*               RFY                                                0368
*                 R15 UNRSTD;       /*                       @X04SVES*/
*               RBUFC=ICWBUFC;      /* POINT TO IDX BUFC             */
         L     @10,AMBIWA(,RAMB)                                   0369
         L     RBUFC,ICWBUFC(,@10)                                 0369
*               RBUFC->BUFCMW=OFF;  /* RESET MUST WRITE              */
         NI    BUFCMW(RBUFC),B'01111111'                           0370
*               RBUFC->BUFCVAL=OFF; /* RESET VALID CONTENTS FREE   0371
*                                      BUFFER                        */
         NI    BUFCVAL(RBUFC),B'11111011'                          0371
*I06:                                                              0372
*               DO;                 /* IDACALL(IDAFREEB)             */
I06      DS    0H                                                  0373
*                 CALL IDAFREEB;    /* EXIT TO IDAFREEB              */
         L     @15,@CV01029                                        0373
         BALR  @14,@15                                             0373
*                 GEN(BALR @11,0);  /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*                 GEN(USING *,@11); /* ESTABLISH ADDRESSING          */
         USING *,@11
*                 GEN(L     @11,=A(@PSTART));/* RELOAD BASE          */
         L     @11,=A(@PSTART)
*                 GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING     */
         USING @PSTART,@11
*               END I06;            /* FREE BFR              @X04SVLP*/
*               CALL GETSREC;       /* GET OLD SEQ. SET RECORD       */
         BAL   @14,GETSREC                                         0379
*               RPARM1=ICWTPTR;     /* CURRENT SPLIT OFFSET          */
         L     @10,AMBIWA(,RAMB)                                   0380
         L     RPARM1,ICWTPTR(,@10)                                0380
*               CALL FINDSP;        /* SCAN TO SET FOR ADVANCE       */
         BAL   @14,FINDSP                                          0381
*               RFY                                                0382
*                 RWORK0 RSTD;      /*                       @X04SVES*/
*               CALL LNEXTE;        /* MOVE TO NEXT ENTRY            */
         BAL   @14,LNEXTE                                          0383
*               IMWCIMVN=IMWCIMVN+ONE+RWORK0;/* INCREMENT NO. CIS TO
*                                      MOVE BACK TO OLD CA   @X04SVES*/
         L     @10,AMBIWA(,RAMB)                                   0384
         L     @10,ICWCHN(,@10)                                    0384
         LA    @05,1                                               0384
         AH    @05,IMWCIMVN(,@10)                                  0384
         ALR   @05,RWORK0                                          0384
         STH   @05,IMWCIMVN(,@10)                                  0384
*               RFY                                                0385
*                 RWORK0 UNRSTD;    /*                       @X04SVES*/
*               GO TO SPLIT1;       /* TRY SPLIT AGAIN               */
         B     SPLIT1                                              0386
*             END;                  /* END COULD NOT SPLIT           */
*         END;                      /* END OF SPLIT ERROR            */
*     END;                          /* END OF SPLIT SS RECORD        */
@RF00363 DS    0H                                                  0390
*                                                                  0390
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INFORMATION IN IMWA FOR IDA019RH (INDEX INSERT)           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0390
*   AMBLDTA->AMBIWA->DIWSAVE4=ZERO; /* SHOW CALL NOT FROM SF @X04SVES*/
@RC00195 L     @10,RPLDACB(,RRPL)                                  0390
         L     @10,ACBAMBL(,@10)                                   0390
         L     @10,AMBLDTA(,@10)                                   0390
         L     @10,AMBIWA(,@10)                                    0390
         SLR   @05,@05                                             0390
         ST    @05,DIWSAVE4(,@10)                                  0390
*HLINSERT:                                                         0391
*   IMWIKEYP=ADDR(ICWKEY1);         /* POINT TO INSERT KEY           */
HLINSERT L     @10,AMBIWA(,RAMB)                                   0391
         L     @05,ICWCHN(,@10)                                    0391
         LA    @15,ICWKEY1(,@10)                                   0391
         ST    @15,IMWIKEYP(,@05)                                  0391
*   RBUFC=ICWKEY1L;                 /* SET KEY LENGTH                */
         LH    RBUFC,ICWKEY1L(,@10)                                0392
*   IMWIEL=RBUFC;                   /* F+L OF NEW ENTRY              */
         STC   RBUFC,IMWIEL(,@05)                                  0393
*   IMWIPTR=ICWPRBA/AMDCINV;        /* OLD RECORD PTR                */
         L     @14,AMBDSB(,RAMB)                                   0394
         L     @09,AMDCINV(,@14)                                   0394
         L     @07,ICWPRBA(,@10)                                   0394
         SLR   @06,@06                                             0394
         DR    @06,@09                                             0394
         ST    @07,IMWIPTR(,@05)                                   0394
*   IMWXPTR=ICWCRBA/AMDCINV;        /* NEW RECORD PTR                */
         L     @07,ICWCRBA(,@10)                                   0395
         SLR   @06,@06                                             0395
         DR    @06,@09                                             0395
         ST    @07,IMWXPTR(,@05)                                   0395
*   IF AMDNIL=ONE THEN              /* ONLY 1 LEVEL OF INDEX         */
         LA    @09,1                                               0396
         LH    @08,AMDNIL(,@14)                                    0396
         CR    @08,@09                                             0396
         BE    @RT00396                                            0396
*     GO TO BUILDHL;                /* YES. BUILD NEW HIGH LV        */
*                                                                  0397
*   /*****************************************************************/
*   /*                                                               */
*   /* SET PARAMETERS AND CALL IDA019RB (INDEX SEARCH) TO LOCATE     */
*   /* INSERT POINT IN NEXT HIGHER LEVEL.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0398
*   IXSILN=AMDNIL;                  /* INITIAL SEARCH LEVEL          */
         L     @05,IMWIXSP(,@05)                                   0398
         STC   @08,IXSILN(,@05)                                    0398
*   IXSTLN=ICWLN+ONE;               /* FINAL SEARCH LEVEL            */
         AH    @09,ICWLN(,@10)                                     0399
         STC   @09,IXSTLN(,@05)                                    0399
*   IXSSTRBA=AMDHLRBA;              /* INITIAL SEARCH RBA            */
         L     @00,AMDHLRBA(,@14)                                  0400
         ST    @00,IXSSTRBA(,@05)                                  0400
*   IXSARG=ADDR(ICWKEY1);           /* PTR TO SEARCH ARG             */
         ST    @15,IXSARG(,@05)                                    0401
*   IF RBUFC^=AMDKEYLN THEN         /* PADDING NEEDED                */
         CH    RBUFC,AMDKEYLN(,@14)                                0402
         BE    @RF00402                                            0402
*     DO;                           /* YES                           */
*       ICWKEY1(RBUFC+ONE:RBUFC+ONE)='FF'X;/* INSERT FF AT END       */
         ALR   @10,RBUFC                                           0404
         MVI   ICWKEY1(@10),X'FF'                                  0404
*     END;                          /* END OF PAD                    */
*   PLHISPLP=IMWIXSP;               /* PTR TO SEARCH PARM LIST       */
@RF00402 L     @10,AMBIWA(,RAMB)                                   0406
         L     @10,ICWCHN(,@10)                                    0406
         L     @10,IMWIXSP(,@10)                                   0406
         ST    @10,PLHISPLP(,RPLH)                                 0406
*SEARCH:                            /*                               */
*I07:                                                              0407
*   DO;                             /* IDACALL(IDA019RB)             */
SEARCH   DS    0H                                                  0407
I07      DS    0H                                                  0408
*     CALL IDA019RB;                /* EXIT TO IDA019RB              */
         L     @15,@CV01032                                        0408
         BALR  @14,@15                                             0408
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I07;                        /* CALL SEARCH                   */
*   IF RPLERREG^='00'X THEN         /* SEARCH ERROR                  */
         CLI   RPLERREG(RRPL),0                                    0414
         BE    @RF00414                                            0414
*     DO;                           /* YES.                          */
*WTERR:                             /* WRITE INDEX ERROR             */
*       RFY                                                        0416
*         R15 RESTRICTED;           /* RESTRICT REGISTER R15         */
WTERR    DS    0H                                                  0417
*       R15=IXWRERR;                /* SET ERROR CODE                */
         LA    R15,4                                               0417
*EXIT:                                                             0418
*       GEN(IDARST14);              /* RESTORE R14                   */
EXIT     IDARST14
*       RETURN;                     /* RETURN TO CALLER              */
@EL00001 DS    0H                                                  0419
@EF00001 DS    0H                                                  0419
@ER00001 BR    @14                                                 0419
*     END;                          /* END OF SEARCH ERROR           */
*   RFY                                                            0421
*     R15 UNRSTD;                   /*                       @X04SVES*/
*                                                                  0421
@RF00414 DS    0H                                                  0422
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPLETE IMWA INFORMATION NEEDED BY IDA019RH                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*   IMWBUFP=IXSBUFC->BUFCBAD;       /* POINT TO IDX RECORD           */
         L     @10,AMBIWA(,RAMB)                                   0422
         L     @10,ICWCHN(,@10)                                    0422
         L     @05,IMWIXSP(,@10)                                   0422
         L     @15,IXSBUFC(,@05)                                   0422
         L     @00,BUFCBAD(,@15)                                   0422
         ST    @00,IMWBUFP(,@10)                                   0422
*   IF IMWIEL<IXSPEC THEN           /* DETERMINE ENTRY L             */
         CLC   IMWIEL(1,@10),IXSPEC(@05)                           0423
         BNL   @RF00423                                            0423
*     IMWIEL=ZERO;                  /* VALUE                         */
         MVI   IMWIEL(@10),X'00'                                   0424
*   ELSE                            /*                               */
*     IMWIEL=IMWIEL-IXSPEC;         /* L = TOTAL - F VALUE           */
         B     @RC00423                                            0425
@RF00423 L     @10,AMBIWA(,RAMB)                                   0425
         L     @10,ICWCHN(,@10)                                    0425
         L     @05,IMWIXSP(,@10)                                   0425
         SLR   @00,@00                                             0425
         IC    @00,IMWIEL(,@10)                                    0425
         SLR   @15,@15                                             0425
         IC    @15,IXSPEC(,@05)                                    0425
         SLR   @00,@15                                             0425
         STC   @00,IMWIEL(,@10)                                    0425
*   RFY                                                            0426
*    (RWORK1,                                                      0426
*     RWORK2,                                                      0426
*     RWORK3) RSTD;                 /*                       @X04SVES*/
@RC00423 DS    0H                                                  0427
*   RWORK3=IMWBUFP->IXHPTLS;        /* PICK UP MASK          @X04SVES*/
         L     @10,AMBIWA(,RAMB)                                   0427
         L     @10,ICWCHN(,@10)                                    0427
         L     @15,IMWBUFP(,@10)                                   0427
         SLR   RWORK3,RWORK3                                       0427
         IC    RWORK3,IXHPTLS(,@15)                                0427
*   RWORK2=IXSHEP+LENGTH(IBFLPF)+LENGTH(IBFLPL);/* POINT TO POINTER
*                                      FIELD                 @X04SVES*/
         L     @10,IMWIXSP(,@10)                                   0428
         LA    RWORK2,2                                            0428
         AL    RWORK2,IXSHEP(,@10)                                 0428
*   RWORK1=ZERO;                    /* CLEAR PICKUP REGISTER @X04SVES*/
         SLR   RWORK1,RWORK1                                       0429
*   GEN(EX  RWORK3,GETPTR);         /* PICKUP PTR            @X04SVES*/
         EX  RWORK3,GETPTR
*   IF(RWORK1^=IMWIPTRAMBLDTA->AMBIWA->DIWSAVE4^=ZERO)&IMWRIPL=OFF
*     THEN                          /* PTR NOT IN RECORD OR SF CALL
*                                      BUT NOT RIPPLE TO HIGHER LEVEL
*                                                            @X04SVES*/
         L     @10,AMBIWA(,RAMB)                                   0431
         L     @10,ICWCHN(,@10)                                    0431
         C     RWORK1,IMWIPTR(,@10)                                0431
         BNE   @GL00002                                            0431
         L     @10,RPLDACB(,RRPL)                                  0431
         L     @10,ACBAMBL(,@10)                                   0431
         L     @10,AMBLDTA(,@10)                                   0431
         L     @10,AMBIWA(,@10)                                    0431
         L     @10,DIWSAVE4(,@10)                                  0431
         LTR   @10,@10                                             0431
         BZ    @RF00431                                            0431
@GL00002 L     @10,AMBIWA(,RAMB)                                   0431
         L     @10,ICWCHN(,@10)                                    0431
         TM    IMWRIPL(@10),B'01000000'                            0431
         BNZ   @RF00431                                            0431
*     DO;                           /* YES                   @X04SVES*/
*       IF AMBLDTA->AMBIWA->DIWSAVE4=ZERO THEN/* IS CALL FROM SF CASE
*                                      1                     @X04SVES*/
         L     @15,RPLDACB(,RRPL)                                  0433
         L     @15,ACBAMBL(,@15)                                   0433
         L     @15,AMBLDTA(,@15)                                   0433
         L     @15,AMBIWA(,@15)                                    0433
         L     @00,DIWSAVE4(,@15)                                  0433
         LTR   @00,@00                                             0433
         BNZ   @RF00433                                            0433
*         IMWIPTR=RWORK1;           /* NO, MAKE INSERT PTR SAME AS 0434
*                                      EXISTING HIT POINTER  @X04SVES*/
         ST    RWORK1,IMWIPTR(,@10)                                0434
*       ELSE                        /* SF CASE 1 CALL        @X04SVES*/
*         DO;                       /*                       @X04SVES*/
         B     @RC00433                                            0435
@RF00433 DS    0H                                                  0436
*           IMWIPTR=IMWXPTR;        /* EXCHANGE POINTERS     @X04SVES*/
         L     @10,AMBIWA(,RAMB)                                   0436
         L     @10,ICWCHN(,@10)                                    0436
         L     @00,IMWXPTR(,@10)                                   0436
         ST    @00,IMWIPTR(,@10)                                   0436
*           IMWXPTR=RWORK1;         /* SET NEXT POINTER UNCHANGED  0437
*                                                            @X04SVES*/
         ST    RWORK1,IMWXPTR(,@10)                                0437
*         END;                      /*                       @X04SVES*/
*     END;                          /*                       @X04SVES*/
@RC00433 DS    0H                                                  0440
*   RFY                                                            0440
*    (RWORK1,                                                      0440
*     RWORK2,                                                      0440
*     RWORK3) UNRSTD;               /*                       @X04SVES*/
*                                                                  0440
@RF00431 DS    0H                                                  0441
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL IDA019RH TO INSERT ENTRY INTO INDEX RECORD.              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*   RPARM1=IXHLENT;                 /* SET HL INERT CODE             */
         LA    RPARM1,8                                            0441
*I08:                                                              0442
*   DO;                             /* IDACALL(IDA019RH)             */
I08      DS    0H                                                  0443
*     CALL IDA019RH;                /* EXIT TO IDA019RH              */
         L     @15,@CV01033                                        0443
         BALR  @14,@15                                             0443
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I08;                                                       0448
*   RFY                                                            0449
*     R15 RESTRICTED;                                              0449
*   RAMB=AMBLIX;                    /* POINT TO INDEX AMB            */
         L     @14,RPLDACB(,RRPL)                                  0450
         L     @14,ACBAMBL(,@14)                                   0450
         L     RAMB,AMBLIX(,@14)                                   0450
*   IF R15=IMWNOFIT&IMWRIPL=OFF THEN/* DID INSERT FIT        @X04SVES*/
         C     R15,@CF00062                                        0451
         BNE   @RF00451                                            0451
         L     @14,AMBIWA(,RAMB)                                   0451
         L     @10,ICWCHN(,@14)                                    0451
         TM    IMWRIPL(@10),B'01000000'                            0451
         BNZ   @RF00451                                            0451
*     DO;                           /* NO.                           */
*       IMWSVIEL=ICWKEY1L;          /* SAVE LENGTH OF KEY            */
         LH    @05,ICWKEY1L(,@14)                                  0453
         STC   @05,IMWSVIEL(,@10)                                  0453
*       IMWKEY1(1:AMDKEYLN)=        /* SAVE INSERT KEY IN            */
*           ICWKEY1(1:AMDKEYLN);    /* IMWA                          */
         L     @05,AMBDSB(,RAMB)                                   0454
         LH    @05,AMDKEYLN(,@05)                                  0454
         BCTR  @05,0                                               0454
         EX    @05,@SM01180                                        0454
*       RBUFC=IMWBUFP+IXHLEO;       /* POINT TO LAST ENTRY           */
         L     @10,IMWBUFP(,@10)                                   0455
         LH    @09,IXHLEO(,@10)                                    0455
         LR    RBUFC,@10                                           0455
         ALR   RBUFC,@09                                           0455
*       RPARM1=RBUFC->IBFLPL;       /* PICK UP L VALUE               */
         SLR   RPARM1,RPARM1                                       0456
         IC    RPARM1,IBFLPL(,RBUFC)                               0456
*       RPARM1=RPARM1+LENGTH(IXSELL);/* ADD LENGTH OF LL FIELD       */
         LA    @05,2                                               0457
         ALR   RPARM1,@05                                          0457
*       RBUFC=IXHLEO-RPARM1;        /* OFFSET TO LAST ENTRY          */
         SLR   @09,RPARM1                                          0458
         LR    RBUFC,@09                                           0458
*       RPARM1=(IXHLL-(IXHLEO-RPARM1))/TWO;/* MIDPOINT OFFSET        */
         LR    @06,@09                                             0459
         LCR   @06,@06                                             0459
         LH    @10,IXHLL(,@10)                                     0459
         N     @10,@CF01171                                        0459
         ALR   @06,@10                                             0459
         SRDA  @06,32                                              0459
         DR    @06,@05                                             0459
         LR    RPARM1,@07                                          0459
*       RPARM1=RPARM1+RBUFC;        /* OFFSET FROM START             */
         ALR   RPARM1,RBUFC                                        0460
*       RFY                                                        0461
*         R15 UNRSTD;                                              0461
*       ICWTPTR=ZERO;               /* ASSURE FINDSP WILL SPLT ONE 0462
*                                      ENTRY TO THE RIGHT            */
         SLR   @10,@10                                             0462
         ST    @10,ICWTPTR(,@14)                                   0462
*       CALL FINDSP;                /* LOCATE SPLIT POINT            */
*                                                                  0463
         BAL   @14,FINDSP                                          0463
*       /*************************************************************/
*       /*                                                           */
*       /* SET PARAMETERS FOR IDA019RJ (SPLIT INDEX RECORD)          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0464
*       ICWBUFC=IXSBUFC;            /* SET PTR TO IDX BUFC           */
         L     @10,AMBIWA(,RAMB)                                   0464
         L     @05,ICWCHN(,@10)                                    0464
         L     @05,IMWIXSP(,@05)                                   0464
         L     @05,IXSBUFC(,@05)                                   0464
         ST    @05,ICWBUFC(,@10)                                   0464
*       ICWCRBA=ICWBUFC->BUFCDDDD;  /* SET RBA TO SPLIT              */
         L     @05,BUFCDDDD(,@05)                                  0465
         ST    @05,ICWCRBA(,@10)                                   0465
*       RPARM1=ZERO;                /* 1ST SPLIT REQUEST             */
         SLR   RPARM1,RPARM1                                       0466
*SPLIT2:                            /* CALL SPLIT RECORD             */
*I09:                                                              0467
*       DO;                         /* IDACALL(IDA019RJ)             */
SPLIT2   DS    0H                                                  0467
I09      DS    0H                                                  0468
*         CALL IDA019RJ;            /* EXIT TO IDA019RJ              */
         L     @15,@CV01034                                        0468
         BALR  @14,@15                                             0468
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I09;                                                   0473
*       RFY                                                        0474
*         R15 RESTRICTED;                                          0474
*       IF AMBTRACE^=ZERO THEN      /* IS IDATRACE ACTIVE    @ZA29388*/
         L     @14,AMBTRACE(,RAMB)                                 0475
         LTR   @14,@14                                             0475
         BZ    @RF00475                                            0475
*         DO;                       /*                       @ZA29388*/
*           RFY                                                    0477
*             RWORK1 RESTRICTED;    /*                       @ZA29388*/
*           RWORK1=R15;             /* SAVE REG15            @ZA29388*/
         LR    RWORK1,R15                                          0478
*           CALL IDA019ST;          /* CALL IDATRACE         @ZA29388*/
         L     @15,@CV01101                                        0479
         BALR  @14,@15                                             0479
*           GEN(DC X'000D');        /* TRACE ID              @ZA29388*/
         DC X'000D'
*           R15=RWORK1;             /* RESTORE REG15         @ZA29388*/
         LR    R15,RWORK1                                          0481
*           RFY                                                    0482
*             RWORK1 UNRSTD;        /*                       @ZA29388*/
*         END;                      /*                       @ZA29388*/
*       IF R15^=ZERO THEN           /* COULD NOT SPLIT               */
@RF00475 LTR   R15,R15                                             0484
         BZ    @RF00484                                            0484
*         DO;                       /* YES.                          */
*           IF R15=IXWRERR THEN     /* WRITE ERROR                   */
         C     R15,@CF00067                                        0486
         BE    @RT00486                                            0486
*             GO TO EXIT;           /* YES. EXIT                     */
*                                                                  0487
*           /*********************************************************/
*           /*                                                       */
*           /* SPLIT COULD NOT BE MADE AT REQUESTED OFFSET. WILL MOVE*/
*           /* OFFSET TO NEXT HIGHER KEY ENTRY AND TRY AGAIN         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0488
*           RBUFC=ICWBUFC;          /* INDEX BUFC                    */
         L     @14,AMBIWA(,RAMB)                                   0488
         L     RBUFC,ICWBUFC(,@14)                                 0488
*           RBUFC->BUFCMW=OFF;      /* RESET MUST WRITE FLAG         */
         NI    BUFCMW(RBUFC),B'01111111'                           0489
*           RBUFC->BUFCVAL=OFF;     /* RESET VALID RBA FLAG          */
         NI    BUFCVAL(RBUFC),B'11111011'                          0490
*I10:                                                              0491
*           DO;                     /* IDACALL(IDAFREEB)             */
I10      DS    0H                                                  0492
*             CALL IDAFREEB;        /* EXIT TO IDAFREEB              */
         L     @15,@CV01029                                        0492
         BALR  @14,@15                                             0492
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */
         USING *,@11
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */
         L     @11,=A(@PSTART)
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */
         USING @PSTART,@11
*           END I10;                /* FREE BFR              @X04SVLP*/
*           CALL GETSREC;           /* GET OLD INDEX RECORD          */
         BAL   @14,GETSREC                                         0498
*           CALL LNEXTE;            /* LOCATE NEXT ENTRY             */
         BAL   @14,LNEXTE                                          0499
*           GO TO SPLIT2;           /* TRY SPLIT AGAIN               */
         B     SPLIT2                                              0500
*           RFY                                                    0501
*             R15 UNRSTD;           /* RELEASE R15                   */
*         END;                      /* END OF COULD NOT SPLIT        */
*       IMWRIPL=ON;                 /* INDICATE RIPPLE NEEDED        */
*                                                                  0503
@RF00484 L     @10,AMBIWA(,RAMB)                                   0503
         L     @05,ICWCHN(,@10)                                    0503
         OI    IMWRIPL(@05),B'01000000'                            0503
*       /*************************************************************/
*       /*                                                           */
*       /* SET PARAMETERS TO LOCATE INSERT POINT. START SEARCH WITH  */
*       /* OLD RECORD.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0504
*       IXSILN=ICWLN;               /* INITIAL SEARCH LEVEL          */
         L     @15,IMWIXSP(,@05)                                   0504
         LH    @14,ICWLN(,@10)                                     0504
         STC   @14,IXSILN(,@15)                                    0504
*       IXSTLN=ICWLN;               /* FINAL SEARCH LEVEL            */
         STC   @14,IXSTLN(,@15)                                    0505
*       IXSSTRBA=ICWPRBA;           /* INITIAL SEARCH RBA            */
         L     @10,ICWPRBA(,@10)                                   0506
         ST    @10,IXSSTRBA(,@15)                                  0506
*       IXSARG=ADDR(IMWKEY1);       /* SEARCH ARG                    */
         LA    @10,IMWKEY1(,@05)                                   0507
         ST    @10,IXSARG(,@15)                                    0507
*       IMWIKEYP=IXSARG;            /* POINT TO INSERT KEY           */
         ST    @10,IMWIKEYP(,@05)                                  0508
*       IMWIEL=IMWSVIEL;            /* RESTORE KEY LENGTH            */
         IC    @10,IMWSVIEL(,@05)                                  0509
         STC   @10,IMWIEL(,@05)                                    0509
*       GO TO SEARCH;               /* GO TO SEARCH INDEX            */
         B     SEARCH                                              0510
*     END;                          /* END OF ENTRY WON'T FIT        */
*   ELSE                            /*                       @X04SVES*/
*     DO;                           /*                       @X04SVES*/
@RF00451 DS    0H                                                  0513
*       RFY                                                        0513
*         R15 RSTD;                 /*                       @X04SVES*/
*       IF R15=IMWNOFIT&IMWBUFP->IXHLV=TWO THEN/* IF NO FIT AND LEVEL
*                                      2                     @X04SVES*/
         C     R15,@CF00062                                        0514
         BNE   @RF00514                                            0514
         L     @14,AMBIWA(,RAMB)                                   0514
         L     @14,ICWCHN(,@14)                                    0514
         L     @10,IMWBUFP(,@14)                                   0514
         CLI   IXHLV(@10),2                                        0514
         BNE   @RF00514                                            0514
*         DO;                       /*                       @X04SVES*/
*           AMBLDTA->AMBIWA->DIWSAVE1=/* SAVE RBA            @X04SVES*/
*               IXSBUFC->BUFCDDDD;  /* IN CASE SF IS CALLER  @X04SVES*/
         L     @10,RPLDACB(,RRPL)                                  0516
         L     @10,ACBAMBL(,@10)                                   0516
         L     @10,AMBLDTA(,@10)                                   0516
         L     @10,AMBIWA(,@10)                                    0516
         L     @14,IMWIXSP(,@14)                                   0516
         L     @14,IXSBUFC(,@14)                                   0516
         L     @14,BUFCDDDD(,@14)                                  0516
         ST    @14,DIWSAVE1(,@10)                                  0516
*           AMBLDTA->AMBIWA->DIWFSPF=ON;/* SET FLAG          @X04SVES*/
         OI    DIWFSPF(@10),B'10000000'                            0517
*         END;                      /*                       @X04SVES*/
*       RFY                                                        0519
*         R15 UNRSTD;               /*                       @X04SVES*/
@RF00514 DS    0H                                                  0520
*     END;                          /*                       @X04SVES*/
*                                                                  0521
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT COMPLETE. WRITE INDEX RECORD                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0521
*WRITE:                                                            0521
*I11:                                                              0521
*   DO;                             /* IDACALL(IWRITE)               */
WRITE    DS    0H                                                  0521
I11      DS    0H                                                  0522
*     CALL IWRITE;                  /* EXIT TO IWRITE                */
         BAL   @14,IWRITE                                          0522
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I11;                        /* WRITE INDEX RECORD            */
*   IF IMWRIPL=OFF THEN             /* RIPPLE REQUIRED               */
         L     @10,AMBIWA(,RAMB)                                   0528
         L     @05,ICWCHN(,@10)                                    0528
         TM    IMWRIPL(@05),B'01000000'                            0528
         BNZ   @RF00528                                            0528
*     DO;                           /* NO.                           */
*       IF IMWNEWHL=ON THEN         /* NEW HIGH LEVEL BUILT          */
         TM    IMWNEWHL(@05),B'10000000'                           0530
         BNO   @RF00530                                            0530
*         DO;                       /* YES.                          */
*           IMWNEWHL=OFF;           /* RESET NEW HL FLAG             */
         NI    IMWNEWHL(@05),B'01111111'                           0532
*           AMDNIL=AMDNIL+ONE;      /* INCREMENT NO. OF LEVELS       */
         L     @05,AMBDSB(,RAMB)                                   0533
         LA    @00,1                                               0533
         AH    @00,AMDNIL(,@05)                                    0533
         STH   @00,AMDNIL(,@05)                                    0533
*           AMDHLRBA=ICWCRBA;       /* SET NEW HIGH LV RBA           */
         L     @10,ICWCRBA(,@10)                                   0534
         ST    @10,AMDHLRBA(,@05)                                  0534
*           PLHEOVR=AMBEOVUC;       /* UPDATE CATALOG CODE           */
         MVI   PLHEOVR(RPLH),B'00000100'                           0535
*I12:                                                              0536
*           DO;                     /* IDACALL(IDAEOVIF)             */
I12      DS    0H                                                  0537
*             CALL IDAEOVIF;        /* EXIT TO IDAEOVIF              */
         L     @15,@CV01028                                        0537
         BALR  @14,@15                                             0537
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */
         USING *,@11
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */
         L     @11,=A(@PSTART)
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */
         USING @PSTART,@11
*           END I12;                                               0542
*         END;                      /* END OF NEW HL PROCESS         */
*       RPARM1=IMWCIMVN;            /* NO. OF CIS TO MOVE BACK       */
@RF00530 L     @10,AMBIWA(,RAMB)                                   0544
         L     @10,ICWCHN(,@10)                                    0544
         LH    RPARM1,IMWCIMVN(,@10)                               0544
*       PLHISPLP=ADDR(PLHIXSPL);    /* RESTORE POINTER TO INDEX    0545
*                                      SEARCH PARAMETER LIST @X04SVES*/
         LA    @10,PLHIXSPL(,RPLH)                                 0545
         ST    @10,PLHISPLP(,RPLH)                                 0545
*       RFY                                                        0546
*         R15 RSTD;                                                0546
*       R15=ZERO;                   /* GOOD RETURN CODE              */
         SLR   R15,R15                                             0547
*       GEN(IDARST14);              /* RESTORE R14                   */
         IDARST14
*       RETURN;                     /* RETURN TO CALLER              */
         B     @EL00001                                            0549
*       RFY                                                        0550
*         R15 UNRSTD;                                              0550
*     END;                          /* END OF NOT RIPPLE             */
*   IMWRIPL=OFF;                    /* RESET RIPPLE FLAG             */
@RF00528 L     @10,AMBIWA(,RAMB)                                   0552
         L     @05,ICWCHN(,@10)                                    0552
         NI    IMWRIPL(@05),B'10111111'                            0552
*   IF ICWLN^=AMDNIL THEN           /*                               */
         L     @05,AMBDSB(,RAMB)                                   0553
         CLC   ICWLN(2,@10),AMDNIL(@05)                            0553
         BE    @RF00553                                            0553
*     DO;                           /*                       @X04SVES*/
*       AMBLDTA->AMBIWA->DIWSAVE4=ZERO;/* ASSURE CALL IS SHOWN AS  0555
*                                      FROM RI               @X04SVES*/
         L     @10,RPLDACB(,RRPL)                                  0555
         L     @10,ACBAMBL(,@10)                                   0555
         L     @10,AMBLDTA(,@10)                                   0555
         L     @10,AMBIWA(,@10)                                    0555
         SLR   @05,@05                                             0555
         ST    @05,DIWSAVE4(,@10)                                  0555
*       GO TO HLINSERT;             /* RIPPLE INSERT                 */
         B     HLINSERT                                            0556
*     END;                          /*                       @X04SVES*/
*                                                                  0557
*   /*****************************************************************/
*   /*                                                               */
*   /* A NEW HIGH LEVEL RECORD MUST BE BUILD                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*BUILDHL:                                                          0558
*   IMWNEWHL=ON;                    /* NEW HIGH LEVEL NEEDED         */
@RF00553 DS    0H                                                  0558
BUILDHL  L     @10,AMBIWA(,RAMB)                                   0558
         L     @05,ICWCHN(,@10)                                    0558
         OI    IMWNEWHL(@05),B'10000000'                           0558
*   IMWIPTR=ICWPRBA/AMDCINV;        /*                               */
         L     @15,AMBDSB(,RAMB)                                   0559
         L     @15,AMDCINV(,@15)                                   0559
         L     @07,ICWPRBA(,@10)                                   0559
         SLR   @06,@06                                             0559
         DR    @06,@15                                             0559
         ST    @07,IMWIPTR(,@05)                                   0559
*   IMWXPTR=ICWCRBA/AMDCINV;        /*                               */
         L     @07,ICWCRBA(,@10)                                   0560
         SLR   @06,@06                                             0560
         DR    @06,@15                                             0560
         ST    @07,IMWXPTR(,@05)                                   0560
*   ICWLN=ICWLN+ONE;                /*                               */
         LA    @05,1                                               0561
         AH    @05,ICWLN(,@10)                                     0561
         STH   @05,ICWLN(,@10)                                     0561
*I13:                                                              0562
*   DO;                             /* IDACALL(IDANEWRD)             */
I13      DS    0H                                                  0563
*     CALL IDANEWRD;                /* EXIT TO IDANEWRD              */
         L     @15,@CA01084                                        0563
         BALR  @14,@15                                             0563
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I13;                        /* INIT NEW RECORD       @X04SVRQ*/
*   IF RPLERREG^=ZERO THEN          /* IF ERROR IN NEW RECORD        */
         CLI   RPLERREG(RRPL),0                                    0569
         BNE   @RT00569                                            0569
*     GO TO WTERR;                  /* EXIT                          */
*   RFY                                                            0571
*    (RWORK0,                                                      0571
*     RWORK2,                                                      0571
*     RWORK3,                                                      0571
*     RWORK4,                                                      0571
*     RWORK5) RSTD;                                                0571
*   RFY                                                            0572
*     IDAIXH BASED(RWORK2);                                        0572
*   RWORK2=IMWBUFP;                 /* POINT TO START OF REC.        */
         L     @10,AMBIWA(,RAMB)                                   0573
         L     @05,ICWCHN(,@10)                                    0573
         L     RWORK2,IMWBUFP(,@05)                                0573
*   IXHFLPLN=LENGTH(IBFLP3)+LENGTH(IBFLPL)/* SET LENGTH OF F,L,PTR   */
*       +LENGTH(IBFLPF);            /* FIELDS IN HEADER              */
         LA    @15,5                                               0574
         STC   @15,IXHFLPLN(,RWORK2)                               0574
*   IXHPTLS=T3BMASK;                /* SET PTR LENGTH MASK           */
         MVI   IXHPTLS(RWORK2),B'00000111'                         0575
*   IXHLV=AMDNIL+ONE;               /* SET LEVEL NUMBER              */
         L     @14,AMBDSB(,RAMB)                                   0576
         LA    @10,1                                               0576
         AH    @10,AMDNIL(,@14)                                    0576
         STC   @10,IXHLV(,RWORK2)                                  0576
*   IXHFSO=LENGTH(IDAIXH);          /* SET INSERT SPACE OFFSET       */
*                                                                  0577
         MVC   IXHFSO(2,RWORK2),@CH00088                           0577
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD FIRST ENTRY IN NEW HIGH LEVEL RECORD, MAKE IT A SECTION */
*   /* ENTRY.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*   RPARM1=IXHLL-IXHFLPLN;          /* OFFSET TO 1ST ENTRY F         */
         LCR   @15,@15                                             0578
         LH    RPARM1,IXHLL(,RWORK2)                               0578
         N     RPARM1,@CF01171                                     0578
         ALR   @15,RPARM1                                          0578
         LR    RPARM1,@15                                          0578
*   IXHSEO=RPARM1;                  /* SET VALUE IN HEADER           */
         STH   RPARM1,IXHSEO(,RWORK2)                              0579
*   RPARM1=RPARM1+RWORK2;           /* POINT TO F LOCATION           */
         ALR   RPARM1,RWORK2                                       0580
*   RWORK4=ICWKEY1L;                /* PICK UP L VALUE               */
         L     @10,AMBIWA(,RAMB)                                   0581
         LH    RWORK4,ICWKEY1L(,@10)                               0581
*   RPARM1->IBFLPL=RWORK4;          /* SET L IN ENTRY                */
         STC   RWORK4,IBFLPL(,RPARM1)                              0582
*   RWORK3=IMWIPTR;                 /* PICK UP PTR                   */
         L     RWORK3,IMWIPTR(,@05)                                0583
*   GEN SETS(IBFLP3)(STCM RWORK3,7,IBFLP3(RPARM1));/* SET PTR IN ENT.*/
         STCM RWORK3,7,IBFLP3(RPARM1)
*   RPARM1=RPARM1-RWORK4;           /* POSITION TO KEY FIELD         */
         SLR   RPARM1,RWORK4                                       0585
*   RPARM1->KEY(1:RWORK4)=          /* MOVE KEY INTO                 */
*       ICWKEY1(1:RWORK4);          /* ENTRY                         */
         LR    @10,RWORK4                                          0586
         BCTR  @10,0                                               0586
         L     @05,AMBIWA(,RAMB)                                   0586
         EX    @10,@SM01185                                        0586
*   RPARM1=RPARM1-LENGTH(IXSELL);   /* POSITION TO LL FIELD          */
         LA    @10,2                                               0587
         SLR   RPARM1,@10                                          0587
*   RWORK4=RWORK4+IXHFLPLN          /* COMPUTE OFFSET TO NEXT        */
*       +LENGTH(IXSELL);            /* ENTRY F FIELD                 */
         SLR   @15,@15                                             0588
         IC    @15,IXHFLPLN(,RWORK2)                               0588
         LR    @14,RWORK4                                          0588
         ALR   @14,@15                                             0588
         ALR   @14,@10                                             0588
         LR    RWORK4,@14                                          0588
*   RPARM1->IXSELL=RWORK4;          /* SET LL VALUE IN ENTRY         */
         STCM  RWORK4,3,IXSELL(RPARM1)                             0589
*   RPARM1=RPARM1-IXHFLPLN;         /* POSITION TO NEXT ENTRY        */
         SLR   RPARM1,@15                                          0590
*   RWORK3=IMWXPTR;                 /* PICK UP PTR                   */
         L     @10,ICWCHN(,@05)                                    0591
         L     RWORK3,IMWXPTR(,@10)                                0591
*   GEN SETS(IBFLP3)(STCM RWORK3,7,IBFLP3(RPARM1));/* SET PTR IN ENT */
         STCM RWORK3,7,IBFLP3(RPARM1)
*   IXHLEO=RPARM1-RWORK2;           /* SET OFFSET TO LAST ENTRY IN 0593
*                                      HEADER                        */
         LR    @10,RPARM1                                          0593
         SLR   @10,RWORK2                                          0593
         STH   @10,IXHLEO(,RWORK2)                                 0593
*   GO TO WRITE;                    /* WRITE HIGH LEVEL              */
         B     WRITE                                               0594
*   GEN;                                                           0595
STOREPT  STCM  RPARM1,@00,@00(RWORK2)   /*                           */
ZEROK    XC    @00(@00,RWORK1),@00(RWORK1)  /*                       */
GETPTR   ICM   RWORK1,@00,@00(RWORK2)  /*                    @X04SVES*/
*   RFY                                                            0596
*    (RWORK0,                                                      0596
*     RWORK2,                                                      0596
*     RWORK3,                                                      0596
*     RWORK4,                                                      0596
*     RWORK5) UNRSTD;                                              0596
*   RFY                                                            0597
*     IDAIXH BASED(IMWBUFP);                                       0597
*                                                                  0598
*/*  *****************************************************************/
*/*   EXTKEY SUBROUTINE                                              */
*/*    FUNCTION - EXTRACT SECTION ENTRY AT OFFSET ICWPSEO WITHIN     */
*/*               RECORD.                                            */
*/*    INPUT -                                                       */
*/*           ICWPSEO - OFFSET FROM START OF RECORD TO ENTRY TO      */
*/*                     EXTRACT.                                     */
*/*           RPARM1 - POINTER TO AREA WHERE KEY IS RETURNED         */
*/*    OUTPUT-                                                       */
*/*            UNFRONT COMPRESSED KEY IN AREA POINTED TO BY RPARM1   */
*/*                                                                  */
*/*            RWORK1 - ENTRY F VALUE                                */
*/*            RWORK2 - ENTRY L VALUE                                */
*/*            RWORK3 - OFFSET FROM THIS ENTRY TO NEXT SECTION ENTRY */
*/*                                                                  */
*/*  *****************************************************************/
*                                                                  0598
*EXTKEY:                                                           0598
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0598
         B     @PB00002                                            0598
EXTKEY   DS    0H                                                  0599
*   RFY                                                            0599
*    (RWORK1,                                                      0599
*     RWORK2,                                                      0599
*     RWORK3,                                                      0599
*     R14) RSTD;                                                   0599
*   RBUFC=IMWBUFP+ICWPSEO;          /* POINT TO SECTION ENTRY        */
         L     @15,AMBIWA(,RAMB)                                   0600
         L     @10,ICWCHN(,@15)                                    0600
         LH    RBUFC,ICWPSEO(,@15)                                 0600
         AL    RBUFC,IMWBUFP(,@10)                                 0600
*   RWORK1=RBUFC->IBFLPF;           /* PICK UP F                     */
         SLR   RWORK1,RWORK1                                       0601
         IC    RWORK1,IBFLPF(,RBUFC)                               0601
*   RWORK2=RBUFC->IBFLPL;           /* PICK UP L                     */
         SLR   RWORK2,RWORK2                                       0602
         IC    RWORK2,IBFLPL(,RBUFC)                               0602
*   RWORK3=RBUFC-RWORK2;            /* POINT TO KEY                  */
         LR    RWORK3,RBUFC                                        0603
         SLR   RWORK3,RWORK2                                       0603
*   IF RWORK2^=ZERO THEN            /* ANY KEY CHARACTERS            */
         LTR   RWORK2,RWORK2                                       0604
         BZ    @RF00604                                            0604
*     RPARM1->KEY(RWORK1+1:RWORK1+RWORK2)=/* YES. MOVE KEY           */
*         RWORK3->KEY(1:RWORK2);    /* CHARACTERS                    */
         LR    @15,RPARM1                                          0605
         ALR   @15,RWORK1                                          0605
         LR    @10,RWORK2                                          0605
         BCTR  @10,0                                               0605
         EX    @10,@SM01187                                        0605
*   RWORK3=RWORK3-LENGTH(IXSELL);   /* LOCATE LL FIELD               */
@RF00604 BCTR  RWORK3,0                                            0606
         BCTR  RWORK3,0                                            0606
*   RWORK3=RWORK3->IXSELL;          /* OFFSET TO NEXT SECTION        */
         SLR   @15,@15                                             0607
         ICM   @15,3,IXSELL(RWORK3)                                0607
         LR    RWORK3,@15                                          0607
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0608
@EF00002 DS    0H                                                  0608
@ER00002 BR    @14                                                 0608
*   RFY                                                            0609
*    (RWORK1,                                                      0609
*     RWORK2,                                                      0609
*     RWORK3,                                                      0609
*     R14) UNRSTD;                  /*                               */
*   END EXTKEY;                     /* END OF EXTRACT KEY            */
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* NEWRCRD SUBROUTINE FUNCTION - OBTAIN RBA AND BUFFER FOR A NEW */
*   /* INDEX RECORD. ZERO THE BUFFER, SET CIDF,RDF AND IXHLL INPUT - */
*   /* ICWLN = LEVEL NUMBER OF NEW RECORD OUTPUT- IXSBUFC = POINTER  */
*   /* TO BUFC OF NEW RECORD IMWBUFP = POINTER TO START OF NEW ROCORD*/
*   /* BUFFER                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0611
*IDANEWRD:                                                         0611
*   ENTRY;                          /*                       @X04SVRQ*/
@EP00611 DS    0H                                                  0611
@EC00611 DS    0H                                                  0612
*   GEN SETS(PLHRETO,PLHRET1)(IDASVR14);/* SAVE REGISTER 14          */
         IDASVR14
*   RFY                                                            0613
*     RWORK1 RSTD;                                                 0613
*   RWORK1=AMBIWA;                  /* POINT TO ICWA OBTAIN RBA FOR
*                                      NEW HL                        */
         L     RWORK1,AMBIWA(,RAMB)                                0614
*I14:                                                              0615
*   DO;                             /* IDACALL(IDAAQR)               */
I14      DS    0H                                                  0616
*     CALL IDAAQR;                  /* EXIT TO IDAAQR                */
         L     @15,@CV01027                                        0616
         BALR  @14,@15                                             0616
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I14;                        /* GET EMPTY BUFFER              */
*   RFY                                                            0622
*     RWORK1 UNRSTD;                /*                       @X04SVES*/
*I15:                                                              0623
*   DO;                             /* IDACALL(IDAGNFL)              */
I15      DS    0H                                                  0624
*     CALL IDAGNFL;                 /* EXIT TO IDAGNFL               */
         L     @15,@CV01030                                        0624
         BALR  @14,@15                                             0624
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I15;                        /*                               */
*   IF RPLERREG^=ZERO THEN          /* ANY ERRORS            @X04SVES*/
         CLI   RPLERREG(RRPL),0                                    0630
         BE    @RF00630                                            0630
*     DO;                           /* YES                   @X04SVES*/
*       GEN(IDARST14);              /* RESTORE REG 14        @X04SVES*/
         IDARST14
*       RETURN;                     /* RETURN                @X04SVES*/
         B     @EL00001                                            0633
*     END;                          /*                       @X04SVES*/
*   RFY                                                            0635
*     RWORK2 RSTD;                  /*                       @X04SVES*/
@RF00630 DS    0H                                                  0636
*   RWORK2=ADDR(IMWISWKA);          /* POINT TO SEARCH PARAMETER LIST
*                                                            @X04SVES*/
         L     @10,AMBIWA(,RAMB)                                   0636
         L     @05,ICWCHN(,@10)                                    0636
         LA    RWORK2,IMWISWKA(,@05)                               0636
*   RWORK2->IXSBUFC=RBUFC;          /* SET POINTER TO INDEX BUFC   0637
*                                                            @X04SVES*/
         ST    RBUFC,IXSBUFC(,RWORK2)                              0637
*   RFY                                                            0638
*     RWORK2 UNRSTD;                /*                       @X04SVES*/
*   RBUFC->BUFCDDDD=ICWCRBA;        /* SET RBA IN BUFC               */
         L     @10,ICWCRBA(,@10)                                   0639
         ST    @10,BUFCDDDD(,RBUFC)                                0639
*   RBUFC->BUFXIRBA=ICWCRBA;        /* SET XCL RBA           @X04SVES*/
         ST    @10,BUFXIRBA(,RBUFC)                                0640
*   RBUFC->BUFCEXC=ON;              /* SET XCL CTL           @X04SVES*/
         OI    BUFCEXC(RBUFC),B'00000010'                          0641
*   RFY                                                            0642
*     RWORK0 RSTD;                  /*                               */
*   RFY                                                            0643
*    (RWORK2,                                                      0643
*     RWORK3,                                                      0643
*     RWORK4,                                                      0643
*     RWORK5) RSTD;                 /*                               */
*   RWORK2=RBUFC->BUFCBAD;          /* PTR TO BUFFER                 */
         L     RWORK2,BUFCBAD(,RBUFC)                              0644
*   IMWBUFP=RWORK2;                 /* POINT TO BUFFER START         */
         ST    RWORK2,IMWBUFP(,@05)                                0645
*   RWORK0=AMDCINV;                 /* CONTROL INTERVAL SIZE         */
         L     @10,AMBDSB(,RAMB)                                   0646
         L     RWORK0,AMDCINV(,@10)                                0646
*   RWORK5=ZERO;                    /* ZERO PAD                      */
         SLR   RWORK5,RWORK5                                       0647
*   RWORK3=RWORK0;                  /* LENGTH FOR MVCL               */
         LR    RWORK3,RWORK0                                       0648
*   GEN(MVCL RWORK2,RWORK4);        /* ZERO BUFFER                   */
         MVCL RWORK2,RWORK4
*   RWORK2=RBUFC->BUFCBAD;          /* POINT TO BUFFER               */
         L     RWORK2,BUFCBAD(,RBUFC)                              0650
*   RESPECIFY                                                      0651
*     IDAIXH BASED(RWORK2);         /* ADDRESSABILITY                */
*   IXHLL=RWORK0-LENGTH(IDACIDF)    /* SET RECORD LENGTH             */
*       -LENGTH(IDARDF);            /* IN HEADER FIELD               */
         LR    @10,RWORK0                                          0652
         SL    @10,@CF00295                                        0652
         STH   @10,IXHLL(,RWORK2)                                  0652
*   RPARM1=RWORK2+IXHLL;            /* POINT TO RDF LOCATION         */
         LR    RPARM1,RWORK2                                       0653
         ALR   RPARM1,@10                                          0653
*   RPARM1->RDFLL=IXHLL;            /* SET RDF LL FIELD              */
         MVC   RDFLL(2,RPARM1),IXHLL(RWORK2)                       0654
*   RPARM1=RPARM1+LENGTH(IDARDF);   /* POINT TO CIDF LOCATION        */
         AL    RPARM1,@CF00164                                     0655
*   RPARM1->CIDFOSET=IXHLL;         /* SET CIDF FREE SP OFFSET       */
         STH   @10,CIDFOSET(,RPARM1)                               0656
*   RFY                                                            0657
*    (RWORK0,                                                      0657
*     RWORK2,                                                      0657
*     RWORK3,                                                      0657
*     RWORK4,                                                      0657
*     RWORK5) UNRSTD;                                              0657
*   RFY                                                            0658
*     IDAIXH BASED(IMWBUFP);                                       0658
*   GEN(IDARST14);                  /* RESTORE R14                   */
         IDARST14
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00001                                            0660
*                                                                  0661
*   /*****************************************************************/
*   /*                                                               */
*   /* IWRITE SUBROUTINE FUNCTION - WRITE INDEX RECORD AND FREE      */
*   /* BUFFER INPUT - IXSBUFC = POINT TO INDEX BUFC - BUFCDDDD OF    */
*   /* BUFC = RECORD RBA OUTPUT - NONE ERROR RETURN IS TO CALLER OF  */
*   /* CALLER WITH R15 = 4                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0661
*IWRITE:                                                           0661
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0661
IWRITE   DS    0H                                                  0662
*   GEN SETS(PLHRETO,PLHRET1)(IDASVR14);/* SAVE REGISTER 14          */
         IDASVR14
*   RPARM1=IXWRITE;                 /* WRITE INDEX RECORD            */
         LA    RPARM1,4                                            0663
*I16:                                                              0664
*   DO;                             /* IDACALL(IDA019RH)             */
I16      DS    0H                                                  0665
*     CALL IDA019RH;                /* EXIT TO IDA019RH              */
         L     @15,@CV01033                                        0665
         BALR  @14,@15                                             0665
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I16;                                                       0670
*   IF RPLERREG^='00'X THEN         /* WRITE ERROR                   */
         CLI   RPLERREG(RRPL),0                                    0671
         BE    @RF00671                                            0671
*     DO;                           /* YES.                          */
*       RFY                                                        0673
*         R15 RSTD;                 /* RESTRICT R15                  */
*       R15=IXWRERR;                /* WRITE ERROR CODE              */
         LA    R15,4                                               0674
*       GEN(IDARST14);              /* RESTORE R14                   */
         IDARST14
*       GEN(IDARST14);              /* BACK UP R14 TO CALLER         */
         IDARST14
*       RETURN;                     /* OF CALLER. RETURN             */
@EL00003 DS    0H                                                  0677
@EF00003 DS    0H                                                  0677
@ER00003 BR    @14                                                 0677
*       RFY                                                        0678
*         R15 UNRSTD;               /* RELEASE R15                   */
*     END;                          /* END OF WRITE ERROR            */
*   RAMB=AMBLIX;                    /* POINT TO INDEX AMB            */
@RF00671 L     @10,RPLDACB(,RRPL)                                  0680
         L     @10,ACBAMBL(,@10)                                   0680
         L     RAMB,AMBLIX(,@10)                                   0680
*   RBUFC=IXSBUFC;                  /* POINT TO INDEX BUFC FREE INDEX
*                                      BUFFER                        */
         L     @10,AMBIWA(,RAMB)                                   0681
         L     @10,ICWCHN(,@10)                                    0681
         L     @10,IMWIXSP(,@10)                                   0681
         L     RBUFC,IXSBUFC(,@10)                                 0681
*I17:                                                              0682
*   DO;                             /* IDACALL(IDAFREEB)             */
I17      DS    0H                                                  0683
*     CALL IDAFREEB;                /* EXIT TO IDAFREEB              */
         L     @15,@CV01029                                        0683
         BALR  @14,@15                                             0683
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I17;                        /* FREE BFR              @X04SVLP*/
*   GEN(IDARST14);                  /* RESTORE R14                   */
         IDARST14
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00003                                            0690
*   END IWRITE;                     /* END OF IWRITE ROUTINE         */
*                                                                  0692
*   /*****************************************************************/
*   /*                                                               */
*   /* GETSREC SUBROUTINE FUNCTION - GET OLD UNMODIFIED INDEX RECORD */
*   /* INPUT - ICWPRBA = RBA OF OLD RECORD OUTPUT - ICWBUFC = POINTER*/
*   /* TO INDEX BUFC - IMW-IXSBUFC = POINTER TO INDEX BUFC - IMWBUFP */
*   /* = POINTER TO INDEX BUFFER                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0692
*GETSREC:                                                          0692
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0692
GETSREC  DS    0H                                                  0693
*   GEN(IDASVR14);                  /* SAVE R14                      */
         IDASVR14
*   RPARM1=ADDR(PLHIXSPL);          /* GET IDX PARM          @X04SVES*/
         LA    RPARM1,PLHIXSPL(,RPLH)                              0694
*   RPARM1->IXSILN=ICWLN;           /* SET LEVEL NO.         @X04SVES*/
         L     @10,AMBIWA(,RAMB)                                   0695
         LH    @05,ICWLN(,@10)                                     0695
         STC   @05,IXSILN(,RPARM1)                                 0695
*   RPARM1=ICWPRBA;                 /* OLD SS RBA                    */
         L     RPARM1,ICWPRBA(,@10)                                0696
*   IF ICWLN=ONE THEN               /* LEVEL 1                       */
         C     @05,@CF00053                                        0697
         BNE   @RF00697                                            0697
*     PLHSSR=ON;                    /* YES. SET SEQ. SET READ        */
         OI    PLHSSR(RPLH),B'00010000'                            0698
*   ELSE                            /* NO.                           */
*     PLHSSR=OFF;                   /* RESET SEQ. SET READ           */
         B     @RC00697                                            0699
@RF00697 NI    PLHSSR(RPLH),B'11101111'                            0699
*I18:                                                              0700
*   DO;                             /* IDACALL(IDAGRB)               */
@RC00697 DS    0H                                                  0700
I18      DS    0H                                                  0701
*     CALL IDAGRB;                  /* EXIT TO IDAGRB                */
         L     @15,@CV01031                                        0701
         BALR  @14,@15                                             0701
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */
         USING *,@11
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */
         L     @11,=A(@PSTART)
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*   END I18;                                                       0706
*   IF RPLERREG^='00'X THEN         /* ERROR                         */
         CLI   RPLERREG(RRPL),0                                    0707
         BE    @RF00707                                            0707
*     DO;                           /* YES.                          */
*       RFY                                                        0709
*         R15 RSTD;                 /*                               */
*       R15=IXWRERR;                /* INDEX UPGRADE ERROR           */
         LA    R15,4                                               0710
*       GEN(IDARST14);              /* RESTORE R14                   */
         IDARST14
*       GEN(IDARST14);              /* RESTORE PREVIOUS R14          */
         IDARST14
*       RETURN;                     /* EXIT TO CALLER OF CALL        */
@EL00004 DS    0H                                                  0713
@EF00004 DS    0H                                                  0713
@ER00004 BR    @14                                                 0713
*       RFY                                                        0714
*         R15 UNRSTD;               /*                               */
*     END;                          /* END OF ERROR                  */
*   IXSBUFC=RBUFC;                  /* SET POINTER IN IMWA           */
@RF00707 L     @10,AMBIWA(,RAMB)                                   0716
         L     @05,ICWCHN(,@10)                                    0716
         L     @15,IMWIXSP(,@05)                                   0716
         ST    RBUFC,IXSBUFC(,@15)                                 0716
*   ICWBUFC=RBUFC;                  /* SET POINTER IN ICWA           */
         ST    RBUFC,ICWBUFC(,@10)                                 0717
*   IMWBUFP=RBUFC->BUFCBAD;         /* SET BUFFERNPOINTER            */
         L     @10,BUFCBAD(,RBUFC)                                 0718
         ST    @10,IMWBUFP(,@05)                                   0718
*   GEN(IDARST14);                  /* RESTORE R14                   */
         IDARST14
*   RETURN;                         /* RETURN                        */
         B     @EL00004                                            0720
*   END GETSREC;                    /* END GETSREC SUBROUTINE        */
*                                                                  0722
*   /*****************************************************************/
*   /*                                                               */
*   /* FINDSP FIND SPLIT POINT SUBROUTINE INPUT -RPARM1 = OFFSET OF  */
*   /* RIGHTMOST LIMIT FOR SPLIT OUTPUT -IMWNSOFF = OFFSET TO SECTION*/
*   /* ENTRY OF SECTION CONTAINING SPLIT POINT. -ICWTPTR = OFFSET TO */
*   /* F OF ENTRY AT WHICH SPLIT WILL OCCUR THE INDEX RECORD IS      */
*   /* SCANNED FROM RIGHT TO LEFT TO LOCATE THE FIRST ENTRY WITH     */
*   /* OFFSET =< THE VALUE SPECIFIED BY RPARM1.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0722
*FINDSP:                                                           0722
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0722
FINDSP   DS    0H                                                  0723
*   RFY                                                            0723
*    (RWORK0,                                                      0723
*     RWORK1,                                                      0723
*     RWORK2,                                                      0723
*     RWORK3,                                                      0723
*     R14) RSTD;                                                   0723
*   RWORK3=ZERO;                    /*                               */
         SLR   RWORK3,RWORK3                                       0724
*   RWORK1=IXHLL;                   /* OFFSET TO 1ST ENTRY+1         */
         L     @15,AMBIWA(,RAMB)                                   0725
         L     @15,ICWCHN(,@15)                                    0725
         L     @15,IMWBUFP(,@15)                                   0725
         LH    RWORK1,IXHLL(,@15)                                  0725
         N     RWORK1,@CF01171                                     0725
*   RBUFC=IMWBUFP+RWORK1;           /* PTR TO LOW END OF SECT.       */
         LR    RBUFC,RWORK1                                        0726
         ALR   RBUFC,@15                                           0726
*   RWORK2=IXHSEO;                  /* OFFSET TO 1ST SECTION SCAN  0727
*                                      RECORD TO                     */
         LH    RWORK2,IXHSEO(,@15)                                 0727
*   DO WHILE RWORK2>RPARM1;         /* LOCATE SECTION                */
         B     @DE00728                                            0728
@DL00728 DS    0H                                                  0729
*     RWORK1=RWORK2;                /* SAVE OFFSET TO SECTION        */
         LR    RWORK1,RWORK2                                       0729
*     RBUFC=IMWBUFP+RWORK2;         /* SET PTR TO SECTION ENT.       */
         L     @15,AMBIWA(,RAMB)                                   0730
         L     @15,ICWCHN(,@15)                                    0730
         LR    RBUFC,RWORK2                                        0730
         AL    RBUFC,IMWBUFP(,@15)                                 0730
*     RWORK3=RBUFC->IBFLPL+LENGTH(IXSELL);/* OFFSET TO LL            */
         LA    RWORK3,2                                            0731
         SLR   @15,@15                                             0731
         IC    @15,IBFLPL(,RBUFC)                                  0731
         ALR   RWORK3,@15                                          0731
*     RBUFC=RBUFC-RWORK3;           /* SET PTR TO LL FIELD           */
         SLR   RBUFC,RWORK3                                        0732
*     RWORK2=RWORK2-RBUFC->IXSELL;  /* OFFSET TO NEXT SECTION        */
         SLR   @15,@15                                             0733
         ICM   @15,3,IXSELL(RBUFC)                                 0733
         SLR   RWORK2,@15                                          0733
*   END;                            /* END OF LOCATE SECTION         */
@DE00728 CLR   RWORK2,RPARM1                                       0734
         BH    @DL00728                                            0734
*XXX1:                                                             0735
*   IMWNSOFF=RWORK2;                /* SAVE OFFSET TO NXT SECT       */
XXX1     L     @15,AMBIWA(,RAMB)                                   0735
         L     @15,ICWCHN(,@15)                                    0735
         STH   RWORK2,IMWNSOFF(,@15)                               0735
*   RWORK2=RWORK1;                  /* SAVE PREVIOUS SECTION         */
*                                                                  0736
         LR    RWORK2,RWORK1                                       0736
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN SECTION TO LOCATE ENTRY                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0737
*   RWORK0=IXHFLPLN;                /* LENGTH OF F,L,PTR FIELD       */
         L     @15,IMWBUFP(,@15)                                   0737
         SLR   RWORK0,RWORK0                                       0737
         IC    RWORK0,IXHFLPLN(,@15)                               0737
*   RWORK1=RWORK1-RWORK3-RWORK0;    /* ADJUST RWORK1 TO POINT TO F OF
*                                      1ST ENTRY                     */
         LR    @15,RWORK1                                          0738
         SLR   @15,RWORK3                                          0738
         SLR   @15,RWORK0                                          0738
         LR    RWORK1,@15                                          0738
*   RWORK3=RWORK3+RWORK0;           /* INITIALIZE ENTRY LENGTH       */
         ALR   RWORK3,RWORK0                                       0739
*   DO WHILE RWORK1>RPARM1&         /* SCAN SECTION TO LOCATE        */
*         RWORK1>IMWNSOFF;          /* SPLIT POINT ENTRY             */
         B     @DE00740                                            0740
@DL00740 DS    0H                                                  0741
*     RBUFC=IMWBUFP+RWORK1;         /* POINT TO F FIELD              */
         L     @15,AMBIWA(,RAMB)                                   0741
         L     @15,ICWCHN(,@15)                                    0741
         LR    RBUFC,RWORK1                                        0741
         AL    RBUFC,IMWBUFP(,@15)                                 0741
*     RWORK3=RBUFC->IBFLPL+RWORK0;  /* OFFSET TO NEXT ENTRY          */
         SLR   RWORK3,RWORK3                                       0742
         IC    RWORK3,IBFLPL(,RBUFC)                               0742
         ALR   RWORK3,RWORK0                                       0742
*     RWORK1=RWORK1-RWORK3;         /* ADJUST ENTRY OFFSET           */
         SLR   RWORK1,RWORK3                                       0743
*   END;                            /* END OF SECTION SCAN           */
@DE00740 CR    RWORK1,RPARM1                                       0744
         BNH   @DC00740                                            0744
         L     @15,AMBIWA(,RAMB)                                   0744
         L     @15,ICWCHN(,@15)                                    0744
         CH    RWORK1,IMWNSOFF(,@15)                               0744
         BH    @DL00740                                            0744
@DC00740 DS    0H                                                  0745
*   IF RWORK1^=ICWTPTR THEN         /* FOUND PREV. SPLT. POINT       */
         L     @15,AMBIWA(,RAMB)                                   0745
         C     RWORK1,ICWTPTR(,@15)                                0745
         BE    @RF00745                                            0745
*     DO;                           /* NO, SO                        */
*       RWORK1=RWORK1+RWORK3;       /* MOVE SPLIT POINT ONE          */
         ALR   RWORK1,RWORK3                                       0747
*       ICWTPTR=RWORK1;             /* ENTRY TO THE RIGHT            */
         ST    RWORK1,ICWTPTR(,@15)                                0748
*       IF RWORK1=RWORK2 THEN       /* CROSS SECTION BOUNDARY        */
         CLR   RWORK1,RWORK2                                       0749
         BNE   @RF00749                                            0749
*         IMWNSOFF=RWORK2;          /* RESET SECTION POINTER         */
         L     @15,ICWCHN(,@15)                                    0750
         STH   RWORK2,IMWNSOFF(,@15)                               0750
*     END;                          /*                               */
*   RFY                                                            0752
*    (RWORK0,                                                      0752
*     RWORK1,                                                      0752
*     RWORK2,                                                      0752
*     RWORK3,                                                      0752
*     R14) UNRSTD;                  /*                       @X04SVES*/
*   RETURN;                         /* RETURN TO CALLER              */
@EL00005 DS    0H                                                  0753
@EF00005 DS    0H                                                  0753
@ER00005 BR    @14                                                 0753
*   END FINDSP;                     /* END OF FIND SPLIT POINT       */
         B     @EL00005                                            0754
*                                                                  0755
*   /*****************************************************************/
*   /*                                                               */
*   /* LNEXTE LOCATE NEXT HIGHER KEY ENTRY SUBROUTINE INPUT - ICWTPTR*/
*   /* = CURRENT SPLIT ENTRY OFFSET IMWNSOFF= OFFSET TO SECTION ENTRY*/
*   /* OF SECTION CONTAINING ICWTPTR ENTRY OUTPUT - ICWTPTR = OFFSET */
*   /* OF NEXT HIGHER KEY ENTRY IMWNSOFF - ADJUSTED TO NEXT SECTION  */
*   /* ENTRY OFFSET WHEN ICWTPTR CROSSES A SECTION RPARM1 = 8 TO     */
*   /* INDICATE NOT FIRST CALL TO IDA019RJ RWORK0 = NO. NON-LAST     */
*   /* SPANNED                                               @X04SVES*/
*   /* RECORD SEGMENTS                                       @X04SVES*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0755
*LNEXTE:                                                           0755
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0755
LNEXTE   DS    0H                                                  0756
*   RFY                                                            0756
*    (RWORK1,                                                      0756
*     RWORK3,                                                      0756
*     R14) RSTD;                    /*                               */
*   RWORK1=ICWTPTR;                 /* PICK UP CURRENT OFFSET        */
         L     @15,AMBIWA(,RAMB)                                   0757
         L     RWORK1,ICWTPTR(,@15)                                0757
*   RBUFC=IMWBUFP+RWORK1;           /* POINT TO ENTRY                */
         L     @15,ICWCHN(,@15)                                    0758
         LR    RBUFC,RWORK1                                        0758
         AL    RBUFC,IMWBUFP(,@15)                                 0758
*   RWORK3=RBUFC->IBFLPL;           /* PICK UP L VALUE               */
         SLR   RWORK3,RWORK3                                       0759
         IC    RWORK3,IBFLPL(,RBUFC)                               0759
*   IF RWORK1=IMWNSOFF THEN         /* SECTION ENTRY                 */
         LH    @10,IMWNSOFF(,@15)                                  0760
         CR    RWORK1,@10                                          0760
         BNE   @RF00760                                            0760
*     DO;                           /* YES.                          */
*       RWORK3=RWORK3+LENGTH(IXSELL);/* ADD SECT. LL LENGTH          */
         AL    RWORK3,@CF00162                                     0762
*       RBUFC=RBUFC-RWORK3;         /* POINT TO LL FIELD             */
         SLR   RBUFC,RWORK3                                        0763
*       IMWNSOFF=IMWNSOFF-          /* ADJUST SECTION OFFSET         */
*           RBUFC->IXSELL;          /* TO NEXT SECTION               */
         SLR   @06,@06                                             0764
         ICM   @06,3,IXSELL(RBUFC)                                 0764
         SLR   @10,@06                                             0764
         STH   @10,IMWNSOFF(,@15)                                  0764
*     END;                          /* END OF SECTION ENTRY          */
*   RWORK3=RWORK3+IXHFLPLN;         /* ADD LENGTH OF F,L,PTR         */
@RF00760 L     @15,AMBIWA(,RAMB)                                   0766
         L     @10,ICWCHN(,@15)                                    0766
         L     @10,IMWBUFP(,@10)                                   0766
         SLR   @06,@06                                             0766
         IC    @06,IXHFLPLN(,@10)                                  0766
         ALR   RWORK3,@06                                          0766
*   ICWTPTR=RWORK1-RWORK3;          /* ADJUST SPLIT OFFSET           */
         LR    @06,RWORK1                                          0767
         SLR   @06,RWORK3                                          0767
         ST    @06,ICWTPTR(,@15)                                   0767
*   RBUFC=IMWBUFP+ICWTPTR;          /* PICK UP CURRENT OFFSET      0768
*                                                            @X04SVES*/
         ALR   @10,@06                                             0768
         LR    RBUFC,@10                                           0768
*   RFY                                                            0769
*     RWORK0 RSTD;                  /*                       @X04SVES*/
*   RWORK0=ZERO;                    /* CLEAR COUNT           @X04SVES*/
         SLR   RWORK0,RWORK0                                       0770
*   DO WHILE RBUFC->IBFLPF=         /* IS THIS A             @X04SVES*/
*         AMDKEYLN;                 /* SPANNED RECORD SEGMENT, NOT 0771
*                                      THE FIRST             @X04SVES*/
         B     @DE00771                                            0771
@DL00771 DS    0H                                                  0772
*     RBUFC=RBUFC-IMWBUFP->         /* YES, MOVE TO          @X04SVES*/
*         IXHFLPLN;                 /* NEXT SEGMENT          @X04SVES*/
         L     @15,AMBIWA(,RAMB)                                   0772
         L     @10,ICWCHN(,@15)                                    0772
         L     @10,IMWBUFP(,@10)                                   0772
         SLR   @06,@06                                             0772
         IC    @06,IXHFLPLN(,@10)                                  0772
         SLR   RBUFC,@06                                           0772
*     ICWTPTR=ICWTPTR-IMWBUFP->     /* MOVE SPLIT            @X04SVES*/
*         IXHFLPLN;                 /* POINT TO NEXT SEGMENT @X04SVES*/
         LCR   @06,@06                                             0773
         AL    @06,ICWTPTR(,@15)                                   0773
         ST    @06,ICWTPTR(,@15)                                   0773
*     RWORK0=RWORK0+ONE;            /* BUMP SEG COUNT        @X04SVES*/
         AL    RWORK0,@CF00053                                     0774
*   END;                            /*                       @X04SVES*/
@DE00771 L     @15,AMBDSB(,RAMB)                                   0775
         SLR   @10,@10                                             0775
         IC    @10,IBFLPF(,RBUFC)                                  0775
         CH    @10,AMDKEYLN(,@15)                                  0775
         BE    @DL00771                                            0775
*   RPARM1=SPRETRY;                 /* TRY SPLIT AGAIN               */
         LA    RPARM1,8                                            0776
*   RFY                                                            0777
*    (RWORK0,                                                      0777
*     RWORK1,                                                      0777
*     RWORK3,                                                      0777
*     R14) UNRSTD;                  /*                       @X04SVES*/
*   RETURN;                         /* RETURN TO CALLER              */
@EL00006 DS    0H                                                  0778
@EF00006 DS    0H                                                  0778
@ER00006 BR    @14                                                 0778
*   END LNEXTE;                     /* END LOCATE NEXT ENTRY         */
*   GEN(IDAPATCH);                  /* DEFINE PATCH SPACE            */
         IDAPATCH
*   END IDA019RI                    /* END OF INDEX UPGRADE          */
*                                                                  0781
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */
*/*%INCLUDE SYSLIB  (IDAICWA )                                       */
*/*%INCLUDE SYSLIB  (IDAIMWA )                                       */
*/*%INCLUDE SYSLIB  (IDADIWA )                                       */
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */
*/*%INCLUDE SYSLIB  (IDAIXSPL)                                       */
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */
*/*%INCLUDE SYSLIB  (IDAIRD  )                                       */
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */
*                                                                  0781
*       ;                                                          0781
         B     @EL00001                                            0781
@DATA    DS    0H
@CH00088 DC    H'24'
@SM01169 MVC   KEY(0,RPARM1),ICWKEY1(@10)
@SM01172 MVC   KEY(0,RWORK2),KEY(RBUFC)
@SM01174 MVC   KEY(0,RWORK1),KEY(@10)
@SM01176 MVC   ICWKEY1(0,@10),KEY(RBUFC)
@SM01180 MVC   IMWKEY1(0,@10),ICWKEY1(@14)
@SM01185 MVC   KEY(0,RPARM1),ICWKEY1(@05)
@SM01187 MVC   KEY(0,@15),KEY(RWORK3)
@DATD    DSECT
         DS    0F
IDA019RI CSECT
         DS    0F
@CF00053 DC    F'1'
@CH00053 EQU   @CF00053+2
@CF00162 DC    F'2'
@CF00164 DC    F'3'
@CF00067 DC    F'4'
@CF00295 DC    F'7'
@CF00062 DC    F'8'
@CF01045 DC    F'256'
@CF01171 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
IDA019RI CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA01084 DC    A(IDANEWRD)
@CV01027 DC    V(IDAAQR)
@CV01028 DC    V(IDAEOVIF)
@CV01029 DC    V(IDAFREEB)
@CV01030 DC    V(IDAGNFL)
@CV01031 DC    V(IDAGRB)
@CV01032 DC    V(IDA019RB)
@CV01033 DC    V(IDA019RH)
@CV01034 DC    V(IDA019RJ)
@CV01101 DC    V(IDA019ST)
         DS    0D
HWORD4   DC    H'4'
@DATD    DSECT
*                                                          /*@X04SVLC*/
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/
RDFLEN   EQU   3                        LENGTH OF RDF
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDA019RI CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RWORK0   EQU   @00
RRPL     EQU   @01
RPLH     EQU   @02
RAMB     EQU   @03
RBUFC    EQU   @04
RWORK1   EQU   @05
RWORK2   EQU   @06
RWORK3   EQU   @07
RWORK4   EQU   @08
RWORK5   EQU   @09
RPARM1   EQU   @12
R14      EQU   @14
R15      EQU   @15
R1       EQU   @01
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLERREG EQU   RPLRTNCD
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLDACB  EQU   RPLCOMN+24
RPLAREA  EQU   RPLCOMN+32
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLRLEN  EQU   RPLCOMN+48
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMBL  EQU   0
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLSHAR EQU   IDAAMBL+33
AMBLFLG1 EQU   IDAAMBL+35
AMBLFLG2 EQU   IDAAMBL+36
AMBLDTA  EQU   IDAAMBL+52
AMBLIX   EQU   IDAAMBL+56
IDAAMB   EQU   0
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBFLG1  EQU   IDAAMB+25
AMBDSORG EQU   IDAAMB+26
AMBIOBAD EQU   IDAAMB+28
AMBINFL  EQU   IDAAMB+42
AMBDEBPT EQU   IDAAMB+44
AMBOFLGS EQU   IDAAMB+48
AMBFLG2  EQU   IDAAMB+49
AMBEOVPT EQU   IDAAMB+56
AMBIWA   EQU   IDAAMB+64
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
AMBTRACE EQU   IDAAMB+120
IDAPLHDR EQU   0
IDAPLH   EQU   0
PLHFLG1  EQU   IDAPLH+2
PLHSSR   EQU   PLHFLG1
PLHFLG2  EQU   IDAPLH+3
PLHADDTE EQU   PLHFLG2
PLHEFLGS EQU   IDAPLH+4
PLHFLG3  EQU   IDAPLH+6
PLHAFLGS EQU   IDAPLH+7
PLHCRBA  EQU   IDAPLH+28
PLHJORBA EQU   PLHCRBA
PLHJCODE EQU   IDAPLH+40
PLHEOVR  EQU   IDAPLH+42
PLHRSCS  EQU   IDAPLH+43
PLHDBUFC EQU   IDAPLH+52
PLHDIOB  EQU   IDAPLH+76
PLHRETO  EQU   IDAPLH+116
PLHRET1  EQU   IDAPLH+120
PLHEOVPT EQU   IDAPLH+180
PLHIBUFC EQU   IDAPLH+188
PLHISPLP EQU   IDAPLH+196
PLHIXSPL EQU   IDAPLH+200
PLHSSRBA EQU   PLHIXSPL
PLHWAX   EQU   IDAPLH+232
PLHKEYPT EQU   IDAPLH+248
PLHTMRPL EQU   IDAPLH+265
PLHEND   EQU   IDAPLH+280
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDRANGE EQU   AMDATTR
AMDNEST  EQU   IDAAMDSB+4
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDCIPCA EQU   IDAAMDSB+12
AMDCINV  EQU   IDAAMDSB+20
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
AMDNIL   EQU   AMDSTAT+8
IDAICWA  EQU   0
ICWFLG1  EQU   IDAICWA+1
ICWKRDS  EQU   ICWFLG1
ICWCHN   EQU   IDAICWA+4
ICWBUFC  EQU   IDAICWA+8
ICWCRBA  EQU   IDAICWA+12
ICWPRBA  EQU   IDAICWA+16
ICWPSEO  EQU   IDAICWA+20
ICWADD   EQU   IDAICWA+24
ICWTBASE EQU   IDAICWA+28
ICWTPTR  EQU   IDAICWA+32
ICWLN    EQU   IDAICWA+40
ICWKEY1L EQU   IDAICWA+42
ICWKEY2L EQU   IDAICWA+44
ICWKEY3L EQU   IDAICWA+46
ICWPTL   EQU   IDAICWA+55
ICWKEY1  EQU   IDAICWA+60
IDAIMWA  EQU   0
IMWFLAGS EQU   IDAIMWA+1
IMWNEWHL EQU   IMWFLAGS
IMWRIPL  EQU   IMWFLAGS
IMWIXSP  EQU   IDAIMWA+4
IMWISWKA EQU   IDAIMWA+8
IMWIKEYP EQU   IDAIMWA+44
IMWXPTR  EQU   IDAIMWA+48
IMWIPTR  EQU   IDAIMWA+52
IMWBUFP  EQU   IDAIMWA+60
IMWIEL   EQU   IDAIMWA+65
IMWSVIEL EQU   IDAIMWA+66
IMWCIMVN EQU   IDAIMWA+68
IMWNSOFF EQU   IDAIMWA+70
IMWKEY1  EQU   IDAIMWA+76
IDADIWA  EQU   0
DIWFLG1  EQU   IDADIWA+4
DIWFLG2  EQU   IDADIWA+5
DIWFSPF  EQU   DIWFLG2
DIWSAVE  EQU   IDADIWA+28
DIWSAVE1 EQU   DIWSAVE
DIWSAVE4 EQU   DIWSAVE+12
IDABUFDR EQU   0
BUFDRCIX EQU   IDABUFDR+9
BUFDRFLG EQU   IDABUFDR+11
IDABUFC  EQU   0
BUFCAVL  EQU   IDABUFC
BUFCFLG1 EQU   IDABUFC+1
BUFCVAL  EQU   BUFCFLG1
BUFCEXC  EQU   BUFCFLG1
BUFCIOFL EQU   IDABUFC+2
BUFCMW   EQU   BUFCIOFL
BUFCFLG2 EQU   IDABUFC+3
BUFCPLH  EQU   IDABUFC+4
BUFCDDDD EQU   IDABUFC+8
BUFCBAD  EQU   IDABUFC+20
BUFCINV  EQU   IDABUFC+28
BUFXIRBA EQU   IDABUFC+40
IDAIXSPL EQU   0
IXSSTRBA EQU   IDAIXSPL
IXSBUFC  EQU   IDAIXSPL+4
IXSARG   EQU   IDAIXSPL+8
IXSTLN   EQU   IDAIXSPL+12
IXSILN   EQU   IDAIXSPL+13
IXSBFLG  EQU   IDAIXSPL+17
IXSPEC   EQU   IDAIXSPL+19
IXSHEP   EQU   IDAIXSPL+20
IDACIDF  EQU   0
CIDFOSET EQU   IDACIDF
CIDFLL   EQU   IDACIDF+2
IDAIXH   EQU   0
IXHLL    EQU   IDAIXH
IXHFLPLN EQU   IDAIXH+2
IXHPTLS  EQU   IDAIXH+3
IXHBRBA  EQU   IDAIXH+4
IXHHP    EQU   IDAIXH+8
IXHLV    EQU   IDAIXH+16
IXHFSO   EQU   IDAIXH+18
IXHLEO   EQU   IDAIXH+20
IXHSEO   EQU   IDAIXH+22
IDAIBFLP EQU   0
IBFLPF   EQU   IDAIBFLP
IBFLPL   EQU   IDAIBFLP+1
IBFLP3   EQU   IDAIBFLP+2
IBFLP2   EQU   IBFLP3
IDASELL  EQU   0
IXSELL   EQU   IDASELL
IDAIXK   EQU   0
IDARDF   EQU   0
RDFRBYTE EQU   IDARDF
RDFSEG   EQU   RDFRBYTE
RDFREPL  EQU   RDFRBYTE
RDFLL    EQU   IDARDF+1
IDADATA  EQU   0
IDAKEY   EQU   0
KEY      EQU   IDAKEY
ICWKEY2  EQU   0
ICWKEY3  EQU   0
PLHKEY   EQU   0
PLHPDL   EQU   0
PLHPDLE  EQU   0
PLHRRN   EQU   0
PLHEXTEN EQU   PLHEND
PLHBMWRK EQU   PLHEXTEN+5
BUFCRSC1 EQU   BUFCAVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PLHBMSV5 EQU   PLHEXTEN+24
PLHBMSV4 EQU   PLHEXTEN+20
PLHBMSV3 EQU   PLHEXTEN+16
PLHBMSV2 EQU   PLHEXTEN+12
PLHBMSV1 EQU   PLHEXTEN+8
PLHRDCNT EQU   PLHEXTEN+6
PLHBMSOV EQU   PLHBMWRK
PLHBEUC  EQU   PLHBMWRK
PLHBMRDF EQU   PLHBMWRK
@NM00042 EQU   PLHEXTEN+4
PLHRESR1 EQU   PLHEXTEN
AMDATA   EQU   IDADATA
RDFEMPTY EQU   RDFRBYTE
RDF1ST   EQU   RDFSEG
RDFNOT1  EQU   RDFSEG
RDFCTNU  EQU   RDFRBYTE
RDFTYPE  EQU   RDFRBYTE
IXKEY    EQU   IDAIXK
IBFLP1   EQU   IBFLP2
IXHFLGS  EQU   IDAIXH+17
IXHXX    EQU   IDAIXH+12
@NM00062 EQU   CIDFLL
CIDFBUSY EQU   CIDFLL
IXSLEP   EQU   IDAIXSPL+28
IXSSEP   EQU   IDAIXSPL+24
IXSEKON  EQU   IDAIXSPL+18
@NM00061 EQU   IXSBFLG
IXSLELV  EQU   IXSBFLG
IXSSSRH  EQU   IXSBFLG
IXSNOSR  EQU   IDAIXSPL+16
IXSKLEN  EQU   IDAIXSPL+14
BUFCEND  EQU   IDABUFC+64
BUFCUCDN EQU   IDABUFC+60
BUFCUCUP EQU   IDABUFC+56
BUFCMDBT EQU   IDABUFC+52
BUFCHAIN EQU   IDABUFC+48
BUFXORBA EQU   IDABUFC+44
BUFCNXT2 EQU   IDABUFC+37
BUFCIDXL EQU   IDABUFC+36
BUFCDSPC EQU   IDABUFC+32
BUFCWLEN EQU   BUFCINV
BUFCNXT1 EQU   IDABUFC+24
BUFCCPA  EQU   IDABUFC+16
BUFCORBA EQU   IDABUFC+12
BUFCAMB  EQU   BUFCPLH
@NM00060 EQU   BUFCFLG2
BUFCEOD  EQU   BUFCFLG2
BUFCBSYW EQU   BUFCFLG2
BUFCBSYR EQU   BUFCFLG2
BUFCNLAS EQU   BUFCFLG2
BUFCXDDR EQU   BUFCFLG2
BUFCFIX  EQU   BUFCIOFL
BUFCPFCP EQU   BUFCIOFL
BUFCXEDB EQU   BUFCIOFL
BUFCWC   EQU   BUFCIOFL
BUFCREAL EQU   BUFCIOFL
BUFCRRD  EQU   BUFCIOFL
BUFCFMT  EQU   BUFCIOFL
BUFCEPT  EQU   BUFCFLG1
BUFCER2  EQU   BUFCFLG1
BUFCER1  EQU   BUFCFLG1
BUFCINS  EQU   BUFCFLG1
BUFCSEG  EQU   BUFCFLG1
BUFCUPG  EQU   BUFCFLG1
BUFCUCNT EQU   BUFCAVL
@NM00059 EQU   IDABUFDR+16
BUFDBUFC EQU   IDABUFDR+12
@NM00058 EQU   BUFDRFLG
BUFDRAVL EQU   BUFDRFLG
BUFDRREL EQU   BUFDRFLG
BUFDRTSB EQU   IDABUFDR+10
BUFDRMAX EQU   BUFDRCIX
BUFDRPFN EQU   IDABUFDR+8
BUFDRPFB EQU   IDABUFDR+4
BUFDRLEN EQU   IDABUFDR+2
BUFDRNO  EQU   IDABUFDR+1
BUFDRID  EQU   IDABUFDR
@NM00057 EQU   IDADIWA+92
@NM00056 EQU   IDADIWA+88
@NM00055 EQU   IDADIWA+84
@NM00054 EQU   IDADIWA+80
@NM00053 EQU   IDADIWA+76
@NM00052 EQU   IDADIWA+72
@NM00051 EQU   IDADIWA+68
@NM00050 EQU   IDADIWA+64
@NM00049 EQU   IDADIWA+60
@NM00048 EQU   IDADIWA+56
DIWINRBA EQU   IDADIWA+52
DIWRKCT  EQU   IDADIWA+48
DIWSAVE5 EQU   DIWSAVE+16
DIWSAVE3 EQU   DIWSAVE+8
DIWSAVE2 EQU   DIWSAVE+4
DIWSPLTP EQU   IDADIWA+24
DIWBUFC  EQU   IDADIWA+20
DIWPLH   EQU   IDADIWA+16
DIWHRBA  EQU   IDADIWA+12
DIWLRBA  EQU   IDADIWA+8
@NM00047 EQU   IDADIWA+6
DIW1ST   EQU   DIWFLG1
DIWNOT1  EQU   DIWFLG1
DIWSHIFT EQU   DIWFLG1
DIWGSPC  EQU   DIWFLG1
DIWEOKR  EQU   DIWFLG1
DIWPFERR EQU   DIWFLG1
DIWCISPL EQU   DIWFLG1
DIWCAS   EQU   DIWFLG1
DIWLEN   EQU   IDADIWA+2
DIWATV   EQU   IDADIWA+1
DIWID    EQU   IDADIWA
@NM00046 EQU   IDAIMWA+72
@NM00045 EQU   IDAIMWA+67
IMWFGAIN EQU   IDAIMWA+64
IMWLBUFC EQU   IDAIMWA+56
IMWXKEYP EQU   IDAIMWA+40
IMWLEN   EQU   IDAIMWA+2
IMWBSE   EQU   IMWFLAGS
IMWID    EQU   IDAIMWA
ICWCERP  EQU   IDAICWA+59
ICWCEL   EQU   IDAICWA+58
ICWCEF   EQU   IDAICWA+57
ICWCER   EQU   IDAICWA+56
ICWREQ   EQU   IDAICWA+54
ICWCRSEG EQU   IDAICWA+52
ICWNOSEG EQU   IDAICWA+50
ICWNEST  EQU   IDAICWA+48
ICWARDBP EQU   IDAICWA+36
ICWSCNT  EQU   IDAICWA+22
ICWLEN   EQU   IDAICWA+2
ICWENDRQ EQU   ICWFLG1
ICWSPLIT EQU   ICWFLG1
ICWVNE   EQU   ICWFLG1
ICWVSE   EQU   ICWFLG1
ICWRBAOK EQU   ICWFLG1
ICWWAGM  EQU   ICWFLG1
ICWWNF   EQU   ICWFLG1
ICWID    EQU   IDAICWA
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDSTSP  EQU   AMDSTAT
@NM00044 EQU   IDAAMDSB+41
@NM00043 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
PLHERRET EQU   IDAPLH+276
PLHASCB  EQU   IDAPLH+272
PLHECB   EQU   IDAPLH+268
@NM00041 EQU   IDAPLH+266
@NM00040 EQU   PLHTMRPL
PLHTMIOB EQU   PLHTMRPL
PLHTMINX EQU   PLHTMRPL
PLHTMDTA EQU   PLHTMRPL
PLHTMDIW EQU   PLHTMRPL
PLHTMBUF EQU   PLHTMRPL
PLHTERM  EQU   PLHTMRPL
PLHDRMSK EQU   IDAPLH+264
PLHR13   EQU   IDAPLH+260
PLHPARM1 EQU   IDAPLH+256
PLHDRRSC EQU   IDAPLH+252
PLHSLRBA EQU   IDAPLH+244
PLHSRCSG EQU   IDAPLH+242
PLHNOSEG EQU   IDAPLH+240
PLHLLOR  EQU   IDAPLH+236
PLHXPLH  EQU   PLHWAX
@NM00039 EQU   PLHIXSPL+8
PLHIXBFC EQU   PLHIXSPL+4
PLHHIREC EQU   PLHSSRBA
PLHRBUFC EQU   IDAPLH+192
PLHNRBA  EQU   IDAPLH+184
PLHDDDD  EQU   PLHEOVPT
PLHAR14  EQU   IDAPLH+176
@NM00038 EQU   IDAPLH+172
@NM00037 EQU   IDAPLH+168
PLHASAVE EQU   IDAPLH+164
PLHRETOS EQU   IDAPLH+118
PLHCHAIN EQU   IDAPLH+112
PLHAMB   EQU   IDAPLH+108
PLHSAVE6 EQU   IDAPLH+104
PLHSAVE5 EQU   IDAPLH+100
PLHSAVE4 EQU   IDAPLH+96
PLHSAVE3 EQU   IDAPLH+92
PLHSAVE2 EQU   IDAPLH+88
PLHSAVE1 EQU   IDAPLH+84
PLHARET  EQU   IDAPLH+80
PLHIIOB  EQU   PLHDIOB
PLHSRSID EQU   IDAPLH+74
PLHRDFC  EQU   IDAPLH+72
PLHRDFP  EQU   IDAPLH+68
PLHFSP   EQU   IDAPLH+64
PLHRECP  EQU   IDAPLH+60
PLHNBUFC EQU   IDAPLH+56
PLHLRECL EQU   IDAPLH+48
PLHARDB  EQU   IDAPLH+44
@NM00036 EQU   PLHRSCS
PLHDBPER EQU   PLHRSCS
PLHDSERR EQU   PLHRSCS
PLHASYER EQU   PLHRSCS
@NM00035 EQU   PLHRSCS
PLHBUFHD EQU   PLHRSCS
PLHINEOV EQU   PLHRSCS
PLHRCODE EQU   IDAPLH+41
PLHUCODE EQU   PLHJCODE
PLHJNRBA EQU   IDAPLH+36
PLHJRNLL EQU   IDAPLH+32
PLHUPECB EQU   PLHJORBA
PLHDSIDA EQU   IDAPLH+24
PLHCRPL  EQU   IDAPLH+20
PLHMRPL  EQU   IDAPLH+16
PLHBFRNO EQU   IDAPLH+15
PLHFRCNT EQU   IDAPLH+14
PLHRMIN  EQU   IDAPLH+13
PLHDSTYP EQU   IDAPLH+12
PLHACB   EQU   IDAPLH+8
PLHRAE   EQU   PLHAFLGS
PLHRABWD EQU   PLHAFLGS
PLHIOSID EQU   PLHAFLGS
PLHDBDC  EQU   PLHAFLGS
PLHVAMB  EQU   PLHAFLGS
PLHIOSRQ EQU   PLHAFLGS
PLHDRLM  EQU   PLHAFLGS
PLHEOVDF EQU   PLHFLG3
PLHRVRS  EQU   PLHFLG3
PLHBWD   EQU   PLHFLG3
PLHSLVLD EQU   PLHFLG3
PLHRAHD  EQU   PLHFLG3
PLHSRBSG EQU   PLHFLG3
@NM00034 EQU   PLHEFLGS+1
PLHRSTRT EQU   PLHEFLGS+1
PLHDSCAN EQU   PLHEFLGS
PLHINVAL EQU   PLHEFLGS
PLHEODX  EQU   PLHEFLGS
PLHNOADV EQU   PLHEFLGS
PLHSRINV EQU   PLHEFLGS
PLHSKPER EQU   PLHEFLGS
PLH1ST   EQU   PLHEFLGS
PLHNOSPC EQU   PLHEFLGS
PLHIWAIT EQU   PLHFLG2
PLHSVADV EQU   PLHFLG2
PLHCIINS EQU   PLHFLG2
PLHKRE   EQU   PLHFLG2
PLHKEYMD EQU   PLHFLG2
PLHSQINS EQU   PLHFLG2
PLHUPD   EQU   PLHFLG2
@NM00033 EQU   PLHFLG1
PLHDRPND EQU   PLHFLG1
PLHASYRQ EQU   PLHFLG1
PLHRDEXC EQU   PLHFLG1
PLHASKBF EQU   PLHFLG1
PLHENDRQ EQU   PLHFLG1
PLHEOVW  EQU   PLHFLG1
PLHATV   EQU   IDAPLH+1
PLHAVL   EQU   IDAPLH
PLHIOSDQ EQU   IDAPLHDR+12
PLHDRCUR EQU   IDAPLHDR+10
PLHDRMAX EQU   IDAPLHDR+8
PLHDRREQ EQU   IDAPLHDR+4
PLHELTH  EQU   IDAPLHDR+2
PLHCNT   EQU   IDAPLHDR+1
PLHID    EQU   IDAPLHDR
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBCPA   EQU   IDAAMB+92
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00032 EQU   AMBCSWD1+1
@NM00031 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
AMBLSR   EQU   AMBAFLG
@NM00030 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
AMBPAMBL EQU   IDAAMB+76
AMBPIXP  EQU   IDAAMB+72
@NM00029 EQU   IDAAMB+68
AMBWKA   EQU   IDAAMB+60
AMBAMBXN EQU   AMBEOVPT
AMBEDB   EQU   IDAAMB+52
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
AMBEXFG  EQU   AMBOFLGS
@NM00028 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00027 EQU   AMBOFLGS
AMBDEBAD EQU   AMBDEBPT+1
AMBIFLGS EQU   AMBDEBPT
AMBAMETH EQU   IDAAMB+43
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00026 EQU   AMBINFL
@NM00025 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00024 EQU   IDAAMB+38
AMBDDSN  EQU   IDAAMB+35
AMBCDSN  EQU   IDAAMB+32
AMBIOMB  EQU   AMBIOBAD
@NM00023 EQU   AMBDSORG+1
AMBDORGA EQU   AMBDSORG+1
@NM00022 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBTYPE  EQU   AMBFLG1
AMBCREAT EQU   AMBFLG1
@NM00021 EQU   AMBFLG0
AMBPSDS  EQU   AMBFLG0
AMBCACB  EQU   IDAAMB+16
AMBPH    EQU   IDAAMB+12
AMBBUFC  EQU   IDAAMB+8
AMBLINK  EQU   IDAAMB+4
AMBLEN   EQU   IDAAMB+2
AMBRSC   EQU   IDAAMB+1
AMBID    EQU   IDAAMB
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00020 EQU   IDAAMBL+40
AMBLNUM  EQU   IDAAMBL+38
AMBLNST  EQU   IDAAMBL+37
@NM00019 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00018 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLCAT  EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLVVIC EQU   AMBLFLG1
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
AMBLLEN  EQU   IDAAMBL+34
@NM00017 EQU   AMBLSHAR
AMBLWRIT EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
AMBLID   EQU   IDAAMBL+32
@NM00016 EQU   IDAAMBL+31
@NM00015 EQU   AMBLTYPE
AMBLFIX  EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00014 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLACB  EQU   IDAAMBL+8
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00013 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBVVIC  EQU   ACBINFLG
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00012 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00011 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00010 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00009 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00008 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00007 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00006 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00005 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00004 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00003 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00002 EQU   RPLRBAR+3
@NM00001 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLWAITX EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLTCBPT EQU   RPLCOMN+28
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00190 EQU   HLINSERT
@RT00237 EQU   WTERR
@RT00365 EQU   EXIT
@RT00396 EQU   BUILDHL
@RT00486 EQU   EXIT
@RT00569 EQU   WTERR
@PB00002 EQU   @EC00611
@RF00745 EQU   @EL00005
@RF00749 EQU   @EL00005
@ENDDATA EQU   *
         END   IDA019RI,(C'PLS1658',0701,78209)

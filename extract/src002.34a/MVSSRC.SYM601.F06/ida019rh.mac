         TITLE 'IDA019RH--VSAM INDEX INSERT                            *
                        '
IDA019RH CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IDA019RH  78.172'                                 0001
IDAIVIXB DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00531-IDAIVIXB)
         ENTRY IDAIVIXB
IDASPACE DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00545-IDASPACE)
         ENTRY IDASPACE
IDAIXCHK DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00564-IDAIXCHK)
         ENTRY IDAIXCHK
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
         IDASVR14
*   RAMB=AMBLIX;                    /* POINT TO INDEX AMB            */
         L     @10,RPLDACB(,RRPL)                                  0166
         L     @10,ACBAMBL(,@10)                                   0166
         L     RAMB,AMBLIX(,@10)                                   0166
*   IF RPARM1=IXENTRY THEN          /* SEQ. SET INSERT REQUEST       */
         LTR   RPARM1,RPARM1                                       0167
         BNZ   @RF00167                                            0167
*     DO;                           /* YES.                          */
*                                                                  0168
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE IMWA POINTERS                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0169
*       IMWIXSP=ADDR(IMWISWKA);     /* POINT TO IX SEARCH WA         */
         L     @15,AMBIWA(,RAMB)                                   0169
         L     @15,ICWCHN(,@15)                                    0169
         LA    @14,IMWISWKA(,@15)                                  0169
         ST    @14,IMWIXSP(,@15)                                   0169
*       IXSBUFC=PLHIBUFC;           /* SET IX BUFC POINTER           */
         L     @09,PLHIBUFC(,RPLH)                                 0170
         ST    @09,IXSBUFC(,@14)                                   0170
*       IMWBUFP=IXSBUFC->BUFCBAD;   /* SET IX REC POINTER            */
         L     @14,BUFCBAD(,@09)                                   0171
         ST    @14,IMWBUFP(,@15)                                   0171
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*   THERE ARE TWO CONTROL INTERVALS OF DATA SET BY CONTROL INTERVAL*/
*/*   SPLIT. THE TWO BUFFERS ARE LOCATED VIA PLHDBUFC AND DIWBUFC.   */
*/*   DETERMINE WHICH BUFFER CONTAINS THE LOWEST KEY VALUES. SET     */
*/*   PLHSAVE1 TO POINT TO LOW KEY BUFC AND PLHSAVE2 TO POINT TO HIGH*/
*/*   KEY BUFC.                                                      */
*/*   ALSO, SET IMWXKEYP TO POINT TO THE KEY OF THE FIRST (LOWEST    */
*/*   KEY) RECORD OF THE HIGH KEY BUFFER. THIS WILL BE USED TO       */
*/*   DETERMINE REAR COMPRESSION OF THE SEQUENCE SET ENTRY.          */
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0172
*       RPARM1=AMDKEYLN;            /* PICK UP KEY LENGTH            */
         L     @14,AMBDSB(,RAMB)                                   0172
         LH    RPARM1,AMDKEYLN(,@14)                               0172
*       RWORK1=PLHDBUFC;            /* POINT TO BOTH DATA            */
         L     RWORK1,PLHDBUFC(,RPLH)                              0173
*       RWORK2=AMBLDTA;             /* POINT TO DATA AMB             */
         L     RWORK2,AMBLDTA(,@10)                                0174
*       RWORK3=RWORK2->AMBDSB;      /* POINT TO DATA AMDSB           */
         L     RWORK3,AMBDSB(,RWORK2)                              0175
*       RESPECIFY                                                  0176
*         IDAAMDSB BASED(RWORK3);   /* LOCATE AMDSB VIA RWORK3       */
*       RWORK2=RWORK2->AMBIWA->DIWBUFC;/* WORK AREA DATA BUFC        */
         L     @10,AMBIWA(,RWORK2)                                 0177
         L     @10,DIWBUFC(,@10)                                   0177
         LR    RWORK2,@10                                          0177
*       PLHSAVE1=RWORK1;            /* SAVE PTRS                     */
         ST    RWORK1,PLHSAVE1(,RPLH)                              0178
*       RFY                                                        0179
*         RWORK4 RSTD;              /*                       @ZA02289*/
*       RWORK0=AMDCINV-LENGTH(IDACIDF);/* GET CI LENGTH - CIDF     0180
*                                                            @ZA02289*/
         L     RWORK0,AMDCINV(,RWORK3)                             0180
         SL    RWORK0,@CF00067                                     0180
*       RWORK4=RWORK2->BUFCBAD+RWORK0;/* POINT TO WORK CIDF  @ZA02289*/
         L     @10,BUFCBAD(,RWORK2)                                0181
         LR    RWORK4,RWORK0                                       0181
         ALR   RWORK4,@10                                          0181
*       IF RWORK4->CIDFLL^=RWORK0 THEN/* WORK BFR EMPTY      @ZA02289*/
         LH    @09,CIDFLL(,RWORK4)                                 0182
         CLR   RWORK0,@09                                          0182
         BE    @RF00182                                            0182
*         DO;                       /* NO, NOT SPND RECORD CASE    0183
*                                                            @ZA02289*/
*           PLHSAVE2=RWORK2;        /* SAVE POINTER                  */
         ST    RWORK2,PLHSAVE2(,RPLH)                              0184
*           RWORK1=RWORK1->BUFCBAD+AMDRKP;/* POINT TO BUF1 LOW KEY   */
         LH    @09,AMDRKP(,RWORK3)                                 0185
         L     @14,BUFCBAD(,RWORK1)                                0185
         ALR   @14,@09                                             0185
         LR    RWORK1,@14                                          0185
*           RWORK2=RWORK2->BUFCBAD+AMDRKP;/* POINT TO BUF2 LOW KEY   */
         ALR   @10,@09                                             0186
         LR    RWORK2,@10                                          0186
*           IF RWORK1->KEY(1:RPARM1)>/* IS BUF1 KEY GREATER          */
*               RWORK2->KEY(1:RPARM1) THEN/* THAN BUF2 KEY           */
         LR    @10,RPARM1                                          0187
         BCTR  @10,0                                               0187
         EX    @10,@SC01071                                        0187
         BNH   @RF00187                                            0187
*             DO;                   /* YES.                          */
*               RWORK0=PLHSAVE1;    /* EXCHANGE PTRS SO THAT         */
         L     @10,PLHSAVE1(,RPLH)                                 0189
         LR    RWORK0,@10                                          0189
*               PLHSAVE1=PLHSAVE2;  /* PLHSAVE1 POINTS TO BUFC       */
         L     @10,PLHSAVE2(,RPLH)                                 0190
         ST    @10,PLHSAVE1(,RPLH)                                 0190
*               PLHSAVE2=RWORK0;    /* CONTAINING INSERT KEY         */
         ST    RWORK0,PLHSAVE2(,RPLH)                              0191
*               IMWXKEYP=RWORK1;    /* SET PTR TO NEXT KEY           */
         ST    RWORK1,IMWXKEYP(,@15)                               0192
*             END;                  /* END OF EXCHANGE               */
*           ELSE                    /*                               */
*             IMWXKEYP=RWORK2;      /* SET PTR TO NEXT KEY           */
         B     @RC00187                                            0194
@RF00187 L     @10,AMBIWA(,RAMB)                                   0194
         L     @10,ICWCHN(,@10)                                    0194
         ST    RWORK2,IMWXKEYP(,@10)                               0194
*         END;                      /*                       @ZA02289*/
*       ELSE                        /*                       @ZA02289*/
*         DO;                       /* SPANNED RECORD CASE   @ZA02289*/
         B     @RC00182                                            0196
@RF00182 DS    0H                                                  0197
*           RESPECIFY                                              0197
*             RWORK4 UNRSTD;        /*                       @ZA02289*/
*           PLHSAVE2=ZERO;          /* SET SPND RECD INDICATOR     0198
*                                                            @ZA02289*/
         SLR   @10,@10                                             0198
         ST    @10,PLHSAVE2(,RPLH)                                 0198
*         END;                      /*                       @ZA02289*/
*                                                                  0200
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*   SET RPARM1 TO POINT TO THE KEY OF THE LAST (HIGHEST KEY) RECORD*/
*/*   OF THE LOW KEY BUFFER. THIS KEY WILL BE THE NEW KEY INSERTED   */
*/*   INTO THE SEQUENCE SET.                                         */
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0200
*       RWORK1=PLHSAVE1->BUFCBAD;   /* START OF LOW KEY BUFFER       */
@RC00182 L     @10,PLHSAVE1(,RPLH)                                 0200
         L     RWORK1,BUFCBAD(,@10)                                0200
*       RWORK2=RWORK1+              /* LOW KEY BUFFER                */
*           AMDCINV-                /* CIDF                          */
*           LENGTH(IDACIDF);        /*                               */
         LR    RWORK2,RWORK1                                       0201
         AL    RWORK2,AMDCINV(,RWORK3)                             0201
         SL    RWORK2,@CF00067                                     0201
*       RWORK1=RWORK1+RWORK2->CIDFOSET;/* START OF FREE SPACE        */
         AH    RWORK1,CIDFOSET(,RWORK2)                            0202
*       RWORK2=RWORK1+RWORK2->CIDFLL;/* POINT TO LAST RDF            */
         LR    @10,RWORK1                                          0203
         AH    @10,CIDFLL(,RWORK2)                                 0203
         LR    RWORK2,@10                                          0203
*       IF RWORK2->RDFREPL=ON THEN  /* LOCATE RDF CONTAINING         */
         TM    RDFREPL(RWORK2),B'00001000'                         0204
         BNO   @RF00204                                            0204
*         RWORK2=RWORK2+LENGTH(IDARDF);/* LENGTH OF LAST RECORD      */
         AL    RWORK2,@CF00157                                     0205
*       RPARM1=RWORK1-RWORK2->RDFLL+/* POINT TO KEY OF LAST          */
*           AMDRKP;                 /* RECORD IN BUFFER.             */
@RF00204 LR    RPARM1,RWORK1                                       0206
         SLR   @10,@10                                             0206
         ICM   @10,3,RDFLL(RWORK2)                                 0206
         SLR   RPARM1,@10                                          0206
         LH    @10,AMDRKP(,RWORK3)                                 0206
         ALR   RPARM1,@10                                          0206
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*   CONVERT THE DATA RBAS INTO SEQUENCE SET POINTER VALUES.        */
*/*      SET IMWIPTR = LOW KEY BUFFER SEQ. SET PTR VALUE.            */
*/*      SET IMWXPTR = HIGH KEY BUFFER SEQ. SET PTR VALUE.           */
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0207
*       RWORK2=AMDCINV;             /* DATA CONTROL INTV SIZE        */
         L     RWORK2,AMDCINV(,RWORK3)                             0207
*       RBUFC=IMWBUFP;              /* POINT SCIB TO RECORD          */
         L     @15,AMBIWA(,RAMB)                                   0208
         L     @15,ICWCHN(,@15)                                    0208
         L     RBUFC,IMWBUFP(,@15)                                 0208
*       RWORK1=RBUFC->IXHBRBA;      /* PICK UP BASE RBA              */
         L     RWORK1,IXHBRBA(,RBUFC)                              0209
*       IF PLHSAVE2=ZERO THEN       /* SPANNED RECORD        @ZA02289*/
         L     @14,PLHSAVE2(,RPLH)                                 0210
         LTR   @14,@14                                             0210
         BNZ   @RF00210                                            0210
*         DO;                       /* YES                   @ZA02289*/
*           PLHSAVE5=(PLHSAVE1->BUFCORBA-/* COMPUTE PTR.     @ZA02289*/
*               RWORK1)/RWORK2;     /* VALUE FOR CURRENT BUFFER    0212
*                                                            @ZA02289*/
         L     @14,PLHSAVE1(,RPLH)                                 0212
         L     @08,BUFCORBA(,@14)                                  0212
         SLR   @08,RWORK1                                          0212
         LR    @15,@08                                             0212
         SLR   @14,@14                                             0212
         DR    @14,RWORK2                                          0212
         ST    @15,PLHSAVE5(,RPLH)                                 0212
*           PLHSAVE6=(AMBLDTA->AMBIWA->/* COMPUTE PTR.       @ZA02289*/
*               DIWBUFC->BUFCORBA-  /* VALUE FOR DI          @ZA02289*/
*               RWORK1)/RWORK2;     /* WORK BUFFER           @ZA02289*/
         L     @14,RPLDACB(,RRPL)                                  0213
         L     @14,ACBAMBL(,@14)                                   0213
         L     @14,AMBLDTA(,@14)                                   0213
         L     @14,AMBIWA(,@14)                                    0213
         L     @14,DIWBUFC(,@14)                                   0213
         L     @08,BUFCORBA(,@14)                                  0213
         SLR   @08,RWORK1                                          0213
         LR    @15,@08                                             0213
         SLR   @14,@14                                             0213
         DR    @14,RWORK2                                          0213
         ST    @15,PLHSAVE6(,RPLH)                                 0213
*           RFY                                                    0214
*             RWORK4 RSTD;          /*                       @ZA02289*/
*           RWORK4=RPLAREA+AMDRKP;  /* POINT TO KEY OF RECORD TO BE
*                                      INSERTED              @ZA02289*/
         AL    @10,RPLAREA(,RRPL)                                  0215
         LR    RWORK4,@10                                          0215
*           IF RPARM1->KEY(1:AMDKEYLN)</* IS HI KEY OF       @ZA02289*/
*               RWORK4->KEY(1:AMDKEYLN) THEN/* DATA BUFFER LESS THAN
*                                      KEY OF RECORD BEING INSERTED
*                                                            @ZA02289*/
         LH    @10,AMDKEYLN(,RWORK3)                               0216
         BCTR  @10,0                                               0216
         EX    @10,@SC01073                                        0216
         BNL   @RF00216                                            0216
*             DO;                   /* YES                   @ZA02289*/
*               IMWXKEYP=RWORK4;    /* NEXT KEY IS KEY OF RECORD   0218
*                                      BEING INSERTED        @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0218
         L     @10,ICWCHN(,@10)                                    0218
         ST    RWORK4,IMWXKEYP(,@10)                               0218
*               IMWXPTR=PLHSAVE6;   /* SET NEXT POINTER TO DI WORK 0219
*                                      BUFFER                @ZA02289*/
         ST    @15,IMWXPTR(,@10)                                   0219
*               IMWIPTR=PLHSAVE5;   /* SET INSERT POINTER TO CURRENT
*                                      DATA BF@ZA02289               */
         L     @15,PLHSAVE5(,RPLH)                                 0220
         ST    @15,IMWIPTR(,@10)                                   0220
*             END;                  /*                       @ZA02289*/
*           ELSE                    /*                       @ZA02289*/
*             DO;                   /* DATA BUFFER KEY GREATER     0222
*                                                            @ZA02289*/
         B     @RC00216                                            0222
@RF00216 DS    0H                                                  0223
*               IMWXKEYP=PLHSAVE1->BUFCBAD+/* SET NEXT TO LOW KEY OF
*                                      DATA BUFFER           @ZA28175*/
*                   AMDRKP;                                        0223
         L     @10,AMBIWA(,RAMB)                                   0223
         L     @10,ICWCHN(,@10)                                    0223
         L     @15,PLHSAVE1(,RPLH)                                 0223
         LH    @14,AMDRKP(,RWORK3)                                 0223
         AL    @14,BUFCBAD(,@15)                                   0223
         ST    @14,IMWXKEYP(,@10)                                  0223
*               RPARM1=RWORK4;      /* SET INSERT KEY TO KEY OF    0224
*                                      RECORD BEING STORED   @ZA02289*/
         LR    RPARM1,RWORK4                                       0224
*               IMWXPTR=PLHSAVE5;   /* SET NEXT POINTER TO CURRENT 0225
*                                      DATA BF@ZA02289               */
         L     @15,PLHSAVE5(,RPLH)                                 0225
         ST    @15,IMWXPTR(,@10)                                   0225
*               IMWIPTR=PLHSAVE6;   /* SET INSERT POINTER TO DI WORK
*                                      BUFFER                @ZA02289*/
         L     @15,PLHSAVE6(,RPLH)                                 0226
         ST    @15,IMWIPTR(,@10)                                   0226
*             END;                  /*                       @ZA02289*/
*         END;                      /*                       @ZA02289*/
*       ELSE                        /* NOT SR                @ZA02289*/
*         DO;                       /*                       @ZA02289*/
         B     @RC00210                                            0229
@RF00210 DS    0H                                                  0230
*           RESPECIFY                                              0230
*             RWORK4 UNRSTD;        /*                       @ZA02289*/
*           IMWIPTR=(PLHSAVE1->BUFCORBA-RWORK1)/* COMPUTE SEQ. SET 0231
*                                      PTR                           */
*               /RWORK2;            /* OF NEW ENTRY                  */
         L     @10,AMBIWA(,RAMB)                                   0231
         L     @10,ICWCHN(,@10)                                    0231
         L     @08,PLHSAVE1(,RPLH)                                 0231
         L     @14,BUFCORBA(,@08)                                  0231
         SLR   @14,RWORK1                                          0231
         LR    @09,@14                                             0231
         SLR   @08,@08                                             0231
         DR    @08,RWORK2                                          0231
         ST    @09,IMWIPTR(,@10)                                   0231
*           IMWXPTR=(PLHSAVE2->BUFCORBA-RWORK1)/* COMPUTE SEQ. SET 0232
*                                      PTR                           */
*               /RWORK2;            /* OF FOLLOWING ENTRY            */
         L     @14,PLHSAVE2(,RPLH)                                 0232
         L     @08,BUFCORBA(,@14)                                  0232
         SLR   @08,RWORK1                                          0232
         LR    @15,@08                                             0232
         SLR   @14,@14                                             0232
         DR    @14,RWORK2                                          0232
         ST    @15,IMWXPTR(,@10)                                   0232
*         END;                      /*                       @ZA02289*/
*       IMWLBUFC=PLHSAVE1;          /* SET LOW KEY BUFC              */
@RC00210 L     @10,AMBIWA(,RAMB)                                   0234
         L     @10,ICWCHN(,@10)                                    0234
         L     @08,PLHSAVE1(,RPLH)                                 0234
         ST    @08,IMWLBUFC(,@10)                                  0234
*                                                                  0235
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*   FOR A DIRECT INSERT REQUEST WITH THE INSERT POINT AT THE END   */
*/*   OF THE LOW KEY BUFFER, USE THE KEY FROM THE RECORD LOCATED VIA */
*/*   RPLAREA AS THE INSERT KEY. NORMALLY THIS IS THE SAME AS THE    */
*/*   KEY OF THE LAST RECORD IN THE LOW KEY BUFFER, BECAUSE THE      */
*/*   DATA INSERT WAS PERFORMED BEFORE CALLING THIS MODULE. IN THE   */
*/*   CASE WHERE THE NEW (INSERT) RECORD IS TOO LARGE TO FIT IN      */
*/*   EITHER CONTROL INTERVAL AFTER THE SPLIT, THE INSERT HAS NOT    */
*/*   BEEN MADE BEFORE ENTRY TO THIS MODULE. USING THE KEY FROM THE  */
*/*   RPLAREA RECORD INSURES THAT THE CORRECT INDEX KEY IS BUILT     */
*/*   IN ALL CASES.                                                  */
*/*   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0235
*       IF AMBSIS=OFF&              /* IF NON-SIS OR         @ZA31009*/
*           RPLSEQ=OFF&PLHRECP=PLHFSP/* FOR DIRECT ADD TO END        */
*           &PLHRECP>=IMWLBUFC->BUFCBAD/* OF THE LOW KEY     @ZA31009*/
*           &PLHRECP<=(IMWLBUFC->BUFCBAD+AMDCINV)/* BUFFER   @ZA31009*/
*           &PLHSAVE2^=ZERO THEN    /* NOT SPN RCD.          @ZA02289*/
         TM    AMBSIS(RAMB),B'00000100'                            0235
         BNZ   @RF00235                                            0235
         TM    RPLSEQ(RRPL),B'00100000'                            0235
         BNZ   @RF00235                                            0235
         L     @10,PLHRECP(,RPLH)                                  0235
         C     @10,PLHFSP(,RPLH)                                   0235
         BNE   @RF00235                                            0235
         L     @08,BUFCBAD(,@08)                                   0235
         CR    @10,@08                                             0235
         BL    @RF00235                                            0235
         AL    @08,AMDCINV(,RWORK3)                                0235
         CR    @10,@08                                             0235
         BH    @RF00235                                            0235
         L     @10,PLHSAVE2(,RPLH)                                 0235
         LTR   @10,@10                                             0235
         BZ    @RF00235                                            0235
*         RPARM1=RPLAREA+AMDRKP;    /* NEW RECORD KEY                */
         LH    RPARM1,AMDRKP(,RWORK3)                              0236
         AL    RPARM1,RPLAREA(,RRPL)                               0236
*       IMWIKEYP=RPARM1;                                           0237
@RF00235 L     @10,AMBIWA(,RAMB)                                   0237
         L     @10,ICWCHN(,@10)                                    0237
         ST    RPARM1,IMWIKEYP(,@10)                               0237
*                                                                  0238
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SCIB TO LOCATE INSERT POINT WITHIN INDEX RECORD AND  */
*       /* TO DETERMINE F-VALUE FOR THE INSERT ENTRY.                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0238
*       RWORK3=ADDR(IMWISWKA);      /* POINT TO PARM AREA            */
         LA    RWORK3,IMWISWKA(,@10)                               0238
*       RESPECIFY                                                  0239
*         IDAAMDSB BASED(AMBDSB);                                  0239
*I01:                                                              0240
*       DO;                         /* IDACALL(IDA019RC)             */
I01      DS    0H                                                  0241
*         CALL IDA019RC;            /* EXIT TO IDA019RC              */
         L     @15,@CV01004                                        0241
         BALR  @14,@15                                             0241
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */
         USING *,@11
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */
         L     @11,=A(@PSTART)
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */
         USING @PSTART,@11
*       END I01;                                                   0246
*       RESPECIFY                                                  0247
*        (RWORK1,                                                  0247
*         RWORK2,                                                  0247
*         RWORK3) RSTD;                                            0247
*       IF(RPLSEQ=ON×AMBSIS=ON)&    /* SEQUENTIAL INSERT,    @ZA31009*/
*           PLHSAVE2^=ZERO&         /* NOT SPANNED RECORD    @ZA31009*/
*           PLHRECP>=IMWLBUFC->BUFCBAD&/* INTO LOW KEY       @ZA31009*/
*           PLHRECP<=(IMWLBUFC->BUFCBAD+/* BUFFER            @ZA31009*/
*           AMBLDTA->AMBDSB->AMDCINV)&/*                     @ZA31009*/
*           RPLUPD=OFF THEN         /* AND NOT UPD           @ZA02289*/
         TM    RPLSEQ(RRPL),B'00100000'                            0248
         BO    @GL00009                                            0248
         TM    AMBSIS(RAMB),B'00000100'                            0248
         BNO   @RF00248                                            0248
@GL00009 L     @10,PLHSAVE2(,RPLH)                                 0248
         LTR   @10,@10                                             0248
         BZ    @RF00248                                            0248
         L     @10,PLHRECP(,RPLH)                                  0248
         L     @08,AMBIWA(,RAMB)                                   0248
         L     @08,ICWCHN(,@08)                                    0248
         L     @15,IMWLBUFC(,@08)                                  0248
         L     @15,BUFCBAD(,@15)                                   0248
         CR    @10,@15                                             0248
         BL    @RF00248                                            0248
         L     @14,RPLDACB(,RRPL)                                  0248
         L     @14,ACBAMBL(,@14)                                   0248
         L     @14,AMBLDTA(,@14)                                   0248
         L     @14,AMBDSB(,@14)                                    0248
         AL    @15,AMDCINV(,@14)                                   0248
         CR    @10,@15                                             0248
         BH    @RF00248                                            0248
         TM    RPLUPD(RRPL),B'00000010'                            0248
         BNZ   @RF00248                                            0248
*         DO;                       /* YES.                          */
*                                                                  0249
*           /*********************************************************/
*           /*                                                       */
*           /* THIS IS THE INITIAL CONTROL INTERVAL SPLIT FOR A MASS */
*           /* INSERT. MAKE THE INDEX ENTRY SO THAT THERE ARE NO KEY */
*           /* VALUES BETWEEN IT AND THE NEXT EXISTING DATA KEY.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0250
*           RPARM1=AMDKEYLN;        /* KEY LENGTH                    */
         L     @10,AMBDSB(,RAMB)                                   0250
         LH    RPARM1,AMDKEYLN(,@10)                               0250
*           IMWKEY1(1:RPARM1)=IMWXKEYP->KEY(1:RPARM1);/* MOVE NEXT   */
         LR    @10,RPARM1                                          0251
         BCTR  @10,0                                               0251
         L     @15,IMWXKEYP(,@08)                                  0251
         EX    @10,@SM01075                                        0251
*           RWORK2=ADDR(IMWKEY1);   /* POINT TO INSERT KEY           */
         LA    RWORK2,IMWKEY1(,@08)                                0252
*           RWORK1=RWORK2+RPARM1-ONE;/* LAST CHARACTER OF KEY        */
         LR    RWORK1,RWORK2                                       0253
         ALR   RWORK1,RPARM1                                       0253
         BCTR  RWORK1,0                                            0253
*           GEN;                                                   0254
             SR    RWORK3,RWORK3            CLEAR REGISTER
ZLOOP        IC    RWORK3,D0(,RWORK1)       PICK UP KEY CHARACTER
             LTR   RWORK3,RWORK3            VALUE ZERO
             BNZ   ZEXIT                    NO.
             MVI   D0(RWORK1),MONE          SET CHAR = -1
             BCTR  RWORK1,D0                DECREMENT POINTER
             B     ZLOOP                    LOOP
ZEXIT        BCTR  RWORK3,D0                DECREMENT KEY CHARACTER
             STC   RWORK3,D0(,RWORK1)       SET NEW VALUE
D0           EQU   0                   ZERO DISPLACEMENT
MONE         EQU  X'FF'                MINUS ONE
*           RBUFC=IMWIKEYP;         /* PTR TO SCIB ARG               */
         L     @10,AMBIWA(,RAMB)                                   0255
         L     @10,ICWCHN(,@10)                                    0255
         L     RBUFC,IMWIKEYP(,@10)                                0255
*           RWORK1=RPARM1;          /* KEY LENGTH FOR CLCL           */
         LR    RWORK1,RPARM1                                       0256
*           IMWIKEYP=RWORK2;        /* SET PTR TO INSERT KEY         */
         ST    RWORK2,IMWIKEYP(,@10)                               0257
*           RWORK3=RPARM1;          /* KEY LENGTH FOR CLCL           */
         LR    RWORK3,RPARM1                                       0258
*           GEN(CLCL  RBUFC,RWORK2);/* COMPARE KEYS                  */
         CLCL  RBUFC,RWORK2
*           RWORK1=RPARM1-RWORK1;   /* NUMBER OF EQUAL BYTES         */
         LR    @10,RPARM1                                          0260
         SLR   @10,RWORK1                                          0260
         LR    RWORK1,@10                                          0260
*           IF RWORK1<IXSPEC THEN   /* IF LESS THAN SCIB VALUE       */
         L     @10,AMBIWA(,RAMB)                                   0261
         L     @10,ICWCHN(,@10)                                    0261
         L     @10,IMWIXSP(,@10)                                   0261
         SLR   @08,@08                                             0261
         IC    @08,IXSPEC(,@10)                                    0261
         CR    RWORK1,@08                                          0261
         BNL   @RF00261                                            0261
*             IXSPEC=RWORK1;        /* USE NEW VALUE                 */
         STC   RWORK1,IXSPEC(,@10)                                 0262
*           IMWIEL=RPARM1-IXSPEC;   /* NO REAR COMPRESSION           */
@RF00261 L     @10,AMBIWA(,RAMB)                                   0263
         L     @10,ICWCHN(,@10)                                    0263
         L     @08,IMWIXSP(,@10)                                   0263
         LR    @15,RPARM1                                          0263
         SLR   @14,@14                                             0263
         IC    @14,IXSPEC(,@08)                                    0263
         SLR   @15,@14                                             0263
         STC   @15,IMWIEL(,@10)                                    0263
*         END;                      /* END OF MI ENTRY ADJUST        */
*       ELSE                        /*                               */
*         DO;                       /*                               */
*                                                                  0265
         B     @RC00248                                            0265
@RF00248 DS    0H                                                  0266
*           /*********************************************************/
*           /*                                                       */
*           /* NORMAL ENTRY PROCESSING. DETERMINE REAR COMPRESSION   */
*           /* BASED ON LOW KEY IN FOLLOWING CONTROL INTERVAL.       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0266
*           CALL COMPRS;            /* SUBROUTINE COMPRESSES         */
         BAL   @14,COMPRS                                          0266
*         END;                      /* END OF REAR COMPRESSION       */
*HLINSERT:                                                         0268
*       IMWFGAIN=ZERO;              /* SET F-GAIN = 0                */
@RC00248 DS    0H                                                  0268
HLINSERT L     @10,AMBIWA(,RAMB)                                   0268
         L     @10,ICWCHN(,@10)                                    0268
         MVI   IMWFGAIN(@10),X'00'                                 0268
*       RESPECIFY                                                  0269
*         RWORK4 RSTD;                                             0269
*       IMWBSE=OFF;                 /* SHOW SECTION NOT REQD.        */
         NI    IMWBSE(@10),B'11011111'                             0270
*       RWORK4=IXSHEP-IXSNOSR*IXHFLPLN;/* POINT TO HIT ENTRY @ZA02289*/
         L     @15,IMWIXSP(,@10)                                   0271
         L     @10,IMWBUFP(,@10)                                   0271
         SLR   @09,@09                                             0271
         IC    @09,IXHFLPLN(,@10)                                  0271
         SLR   @14,@14                                             0271
         IC    @14,IXSNOSR(,@15)                                   0271
         MR    RWORK4,@14                                          0271
         LCR   @09,@09                                             0271
         AL    @09,IXSHEP(,@15)                                    0271
         LR    RWORK4,@09                                          0271
*       IF IXSSEP=RWORK4 THEN       /* HIT ENTRY A SECTION           */
         C     RWORK4,IXSSEP(,@15)                                 0272
         BNE   @RF00272                                            0272
*         DO;                       /* ROUTINE TO MAKE        SECTION*/
*           IF(PLHADDTE=ON&IXHLV=ONE)×/* IF ADD TO END AND SS        */
*               (IXHLV^=ONE&        /* OR NOT SEQ SET AND            */
*               (IXSHEP->IBFLPL=ZERO&/* SEARCH FOUND END OF          */
*               (IXSHEP->IBFLPF=ZERO))) THEN/* DATA SET, THEN WE MAY
*                                      BUILD A SECTION ENTRY         */
         TM    PLHADDTE(RPLH),B'00010000'                          0274
         BNO   @GL00011                                            0274
         CLI   IXHLV(@10),1                                        0274
         BE    @RT00274                                            0274
@GL00011 L     @10,AMBIWA(,RAMB)                                   0274
         L     @10,ICWCHN(,@10)                                    0274
         L     @09,IMWBUFP(,@10)                                   0274
         CLI   IXHLV(@09),1                                        0274
         BE    @RF00274                                            0274
         L     @10,IMWIXSP(,@10)                                   0274
         L     @10,IXSHEP(,@10)                                    0274
         CLI   IBFLPL(@10),0                                       0274
         BNE   @RF00274                                            0274
         CLI   IBFLPF(@10),0                                       0274
         BNE   @RF00274                                            0274
@RT00274 DS    0H                                                  0275
*             DO;                   /*                               */
*               RESPECIFY                                          0276
*                (RWORK0) RSTD;     /*                               */
*               IF IXHSEO>RWORK4-IMWBUFP THEN/* OTHER SECTIONS BEFORE
*                                      THE LAST                      */
         L     @10,AMBIWA(,RAMB)                                   0277
         L     @10,ICWCHN(,@10)                                    0277
         L     @09,IMWBUFP(,@10)                                   0277
         LR    @15,RWORK4                                          0277
         SLR   @15,@09                                             0277
         CH    @15,IXHSEO(,@09)                                    0277
         BNL   @RF00277                                            0277
*                 RWORK0=IXSLEP;    /* YES, COUNT FROM LOW ENTRY IN
*                                      THIS SECTION                  */
         L     @10,IMWIXSP(,@10)                                   0278
         L     RWORK0,IXSLEP(,@10)                                 0278
*               ELSE                /* NO, START AT BEGINNING        */
*                 RWORK0=IMWBUFP+IXHLL-IXHFLPLN;/* OF INDEX RECORD   */
         B     @RC00277                                            0279
@RF00277 L     @10,AMBIWA(,RAMB)                                   0279
         L     @10,ICWCHN(,@10)                                    0279
         L     @10,IMWBUFP(,@10)                                   0279
         LH    RWORK0,IXHLL(,@10)                                  0279
         N     RWORK0,@CF01078                                     0279
         ALR   RWORK0,@10                                          0279
         SLR   @09,@09                                             0279
         IC    @09,IXHFLPLN(,@10)                                  0279
         SLR   RWORK0,@09                                          0279
*               RWORK1=RWORK0;      /* SAVE BEGINNING ADDRESS        */
@RC00277 LR    RWORK1,RWORK0                                       0280
*               RWORK2=ZERO;        /* CLEAR ENTRY COUNT             */
         SLR   RWORK2,RWORK2                                       0281
*               DO WHILE RWORK1^<RWORK4;/* LOOP COUNTS ENTRYS        */
         B     @DE00282                                            0282
@DL00282 DS    0H                                                  0283
*                 IF RWORK1->IBFLPF^=/* IF NOT               @ZA02289*/
*                     AMDKEYLN THEN /* SR ENTRY              @ZA02289*/
         L     @10,AMBDSB(,RAMB)                                   0283
         SLR   @09,@09                                             0283
         IC    @09,IBFLPF(,RWORK1)                                 0283
         CH    @09,AMDKEYLN(,@10)                                  0283
         BE    @RF00283                                            0283
*                   RWORK2=RWORK2+ONE;/* BUMP COUNT OF ENTRYS        */
         AL    RWORK2,@CF00053                                     0284
*                 RWORK1=RWORK1-(RWORK1->/* POINT BACK TO NEXT       */
*                     IBFLPL+IXHFLPLN);/* INDEX ENTRY                */
@RF00283 L     @10,AMBIWA(,RAMB)                                   0285
         L     @10,ICWCHN(,@10)                                    0285
         L     @10,IMWBUFP(,@10)                                   0285
         SLR   @09,@09                                             0285
         IC    @09,IBFLPL(,RWORK1)                                 0285
         SLR   @15,@15                                             0285
         IC    @15,IXHFLPLN(,@10)                                  0285
         ALR   @09,@15                                             0285
         SLR   RWORK1,@09                                          0285
*               END;                /* END OF COUNT ENTRY LOOP       */
@DE00282 CR    RWORK1,RWORK4                                       0286
         BNL   @DL00282                                            0286
*               IF RWORK2^<AMDNEST THEN/* TIME FOR SECTION ENTRY     */
         L     @10,AMBDSB(,RAMB)                                   0287
         LH    @10,AMDNEST(,@10)                                   0287
         CLR   RWORK2,@10                                          0287
         BL    @RF00287                                            0287
*                 DO;               /* YES, ITS JUST TIME            */
*                   IMWIEL=IMWIEL+IXSPEC;/* SET TOTAL LENGTH         */
         L     @10,AMBIWA(,RAMB)                                   0289
         L     @10,ICWCHN(,@10)                                    0289
         L     @09,IMWIXSP(,@10)                                   0289
         SLR   @15,@15                                             0289
         IC    @15,IMWIEL(,@10)                                    0289
         SLR   @14,@14                                             0289
         IC    @14,IXSPEC(,@09)                                    0289
         ALR   @15,@14                                             0289
         STC   @15,IMWIEL(,@10)                                    0289
*                   IXSPEC=ZERO;    /* RESET COMPARE COUNT           */
         MVI   IXSPEC(@09),X'00'                                   0290
*                   RWORK1=IMWBUFP+IXHSEO;/* POINT TO FIRST SECTION  */
         L     @09,IMWBUFP(,@10)                                   0291
         LH    RWORK1,IXHSEO(,@09)                                 0291
         ALR   RWORK1,@09                                          0291
*                   RWORK2=IMWIKEYP;/* POINT TO ARGUMENT             */
         L     RWORK2,IMWIKEYP(,@10)                               0292
*                   DO WHILE RWORK1>IXSSEP;/* SET LOOP TO SCAN FROM
*                                      FIRST SECTION TO SECTION    0293
*                                      PRECEEDING ENTRY POINT        */
         B     @DE00293                                            0293
@DL00293 DS    0H                                                  0294
*                     RWORK0=RWORK1->IBFLPL;/* PICK UP LENGTH OF   0294
*                                      ENTRY                         */
         SLR   RWORK0,RWORK0                                       0294
         IC    RWORK0,IBFLPL(,RWORK1)                              0294
*                     RWORK3=RWORK1-RWORK0;/* POINT TO BEGINNING OF
*                                      STORED KEY                    */
         LR    RWORK3,RWORK1                                       0295
         SLR   RWORK3,RWORK0                                       0295
*                     IF RWORK1->IBFLPF=IXSPEC THEN/* NEW F = THIS F */
         L     @10,AMBIWA(,RAMB)                                   0296
         L     @10,ICWCHN(,@10)                                    0296
         L     @10,IMWIXSP(,@10)                                   0296
         CLC   IBFLPF(1,RWORK1),IXSPEC(@10)                        0296
         BNE   @RF00296                                            0296
*                       DO WHILE RWORK0>ZERO;/* LOOP TO COMPARE INDEX
*                                      ENTRY WITH ARGUMENT           */
         B     @DE00297                                            0297
@DL00297 DS    0H                                                  0298
*                         IF RWORK2->KEY(1)=/* COMPARE A BYTE OF   0298
*                                      INDEX                         */
*                             RWORK3->KEY(1) THEN/* WITH AN ARGUMENT
*                                      BYTE                          */
         CLC   KEY(1,RWORK2),KEY(RWORK3)                           0298
         BNE   @RF00298                                            0298
*                           DO;     /*                               */
*                             IXSPEC=IXSPEC+ONE;/* BUMP COMPARE COUNT*/
         L     @10,AMBIWA(,RAMB)                                   0300
         L     @10,ICWCHN(,@10)                                    0300
         L     @10,IMWIXSP(,@10)                                   0300
         LA    @09,1                                               0300
         SLR   @15,@15                                             0300
         IC    @15,IXSPEC(,@10)                                    0300
         ALR   @15,@09                                             0300
         STC   @15,IXSPEC(,@10)                                    0300
*                             RWORK2=RWORK2+ONE;/* ADDRESS NEXT ARG.
*                                      BYTE                          */
         ALR   RWORK2,@09                                          0301
*                             RWORK3=RWORK3+ONE;/* ADDRESS NEXT ENTRY
*                                      BYTE                          */
         ALR   RWORK3,@09                                          0302
*                             RWORK0=RWORK0-ONE;/* COUNT OFF ONE MORE
*                                      BYTE                          */
         BCTR  RWORK0,0                                            0303
*                           END;    /*                               */
*                         ELSE      /*                               */
*                           RWORK0=ZERO;/* NO MATCH, FORCE END OF  0305
*                                      LOOP                          */
         B     @RC00298                                            0305
@RF00298 SLR   RWORK0,RWORK0                                       0305
*                       END;        /*                               */
@RC00298 DS    0H                                                  0306
@DE00297 CL    RWORK0,@CF00059                                     0306
         BH    @DL00297                                            0306
*                     RWORK3=RWORK1-(RWORK1->IBFLPL+/* SET REGISTER  */
*                         LENGTH(IXSELL));/* TO POINT TO SECT LL     */
@RF00296 LA    RWORK3,2                                            0307
         SLR   @10,@10                                             0307
         IC    @10,IBFLPL(,RWORK1)                                 0307
         ALR   RWORK3,@10                                          0307
         LCR   RWORK3,RWORK3                                       0307
         ALR   RWORK3,RWORK1                                       0307
*                     RWORK1=RWORK1-/* BACK UP POINTER TO            */
*                         RWORK3->IXSELL;/* NEXT SECTION ENTRY       */
         SLR   @10,@10                                             0308
         ICM   @10,3,IXSELL(RWORK3)                                0308
         SLR   RWORK1,@10                                          0308
*                   END;            /*                               */
@DE00293 L     @10,AMBIWA(,RAMB)                                   0309
         L     @10,ICWCHN(,@10)                                    0309
         L     @09,IMWIXSP(,@10)                                   0309
         C     RWORK1,IXSSEP(,@09)                                 0309
         BH    @DL00293                                            0309
*                   RESPECIFY                                      0310
*                    (RWORK0) UNRSTD;/*                              */
*                   IMWIEL=IMWIEL-IXSPEC;/* SET TOTAL KEY LENGTH     */
         SLR   @00,@00                                             0311
         IC    @00,IMWIEL(,@10)                                    0311
         SLR   @15,@15                                             0311
         IC    @15,IXSPEC(,@09)                                    0311
         SLR   @00,@15                                             0311
         STC   @00,IMWIEL(,@10)                                    0311
*                   IF IXHLV=ONE THEN/* IS THIS SEQ SET LEVEL        */
         L     @10,IMWBUFP(,@10)                                   0312
         CLI   IXHLV(@10),1                                        0312
         BNE   @RF00312                                            0312
*                     DO;           /* YES, REDETERMINE REAR         */
*                       CALL COMPRS;/* COMPRESSION                   */
         BAL   @14,COMPRS                                          0314
*                     END;          /*                               */
*                   IMWBSE=ON;      /* SHOW SECTION CREATED          */
@RF00312 L     @10,AMBIWA(,RAMB)                                   0316
         L     @10,ICWCHN(,@10)                                    0316
         OI    IMWBSE(@10),B'00100000'                             0316
*                   GO TO INS1;     /*                               */
         B     INS1                                                0317
*                 END;              /* END OF SECTION ENTRY          */
*             END;                  /*                               */
*         END;                      /*                               */
*       ELSE                        /*                               */
*INS1:                                                             0321
*         DO;                       /*                               */
         B     @RC00272                                            0321
@RF00272 DS    0H                                                  0321
INS1     DS    0H                                                  0322
*           RPARM1=RWORK4->IBFLPL;  /* PICK UP ENTRY L VALUE         */
         SLR   RPARM1,RPARM1                                       0322
         IC    RPARM1,IBFLPL(,RWORK4)                              0322
*           RWORK2=RWORK4->IBFLPF;  /* PICK UP ENTRY F VALUE         */
         SLR   RWORK2,RWORK2                                       0323
         IC    RWORK2,IBFLPF(,RWORK4)                              0323
*           RWORK1=IXSPEC+IMWIEL;   /* NEW ENTRY F + L               */
         L     @10,AMBIWA(,RAMB)                                   0324
         L     @10,ICWCHN(,@10)                                    0324
         L     @09,IMWIXSP(,@10)                                   0324
         SLR   RWORK1,RWORK1                                       0324
         IC    RWORK1,IXSPEC(,@09)                                 0324
         SLR   @09,@09                                             0324
         IC    @09,IMWIEL(,@10)                                    0324
         ALR   RWORK1,@09                                          0324
*           IF RWORK1<RWORK2 THEN   /* NEW LENGTH < OLD F            */
         CLR   RWORK1,RWORK2                                       0325
         BNL   @RF00325                                            0325
*             RPARM1=ZERO;          /* YES. NO RECOMPRESSION         */
         SLR   RPARM1,RPARM1                                       0326
*           RWORK1=RWORK1-RWORK2;   /* REDUCE LENGTH BY OLD F        */
@RF00325 SLR   RWORK1,RWORK2                                       0327
*           RBUFC=RWORK4-RPARM1;    /* POINT TO 1ST KEY CHAR.        */
         LR    RBUFC,RWORK4                                        0328
         SLR   RBUFC,RPARM1                                        0328
*           IF RWORK1<RPARM1 THEN   /* RESULT < OLD L                */
         CR    RWORK1,RPARM1                                       0329
         BNL   @RF00329                                            0329
*             RPARM1=RWORK1;        /* YES. USE RESULT               */
         LR    RPARM1,RWORK1                                       0330
*           IF RPARM1^=ZERO THEN    /* L = 0                         */
@RF00329 LTR   RPARM1,RPARM1                                       0331
         BZ    @RF00331                                            0331
*             DO;                   /* NO.                           */
*               RWORK2=IMWIKEYP+RWORK2;/* POINT TO F+1 TH CHAR OF NEW
*                                      ENTRY                         */
         L     @10,AMBIWA(,RAMB)                                   0333
         L     @10,ICWCHN(,@10)                                    0333
         AL    RWORK2,IMWIKEYP(,@10)                               0333
*               RWORK1=RPARM1;      /* COMPARE LENGTH                */
         LR    RWORK1,RPARM1                                       0334
*               RWORK3=RPARM1;      /* COMPARE LENGTH                */
         LR    RWORK3,RPARM1                                       0335
*               GEN(CLCL  RBUFC,RWORK2);/* COMPARE                   */
         CLCL  RBUFC,RWORK2
*               IMWFGAIN=RPARM1-RWORK1;/* SAVE EQUAL COMPARE CNT     */
         L     @10,AMBIWA(,RAMB)                                   0337
         L     @10,ICWCHN(,@10)                                    0337
         LR    @09,RPARM1                                          0337
         SLR   @09,RWORK1                                          0337
         STC   @09,IMWFGAIN(,@10)                                  0337
*             END;                  /* END OF F-GAIN DETERMTN        */
*         END;                      /* END OF NON-SECTION NEXT       */
@RF00331 DS    0H                                                  0340
*       RESPECIFY                                                  0340
*         RWORK4 UNRSTD;                                           0340
*                                                                  0340
@RC00272 DS    0H                                                  0341
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE NUMBER OF FREE BYTES IN INDEX RECORD.           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0341
*       RBUFC=IMWBUFP+IXHLEO;       /* POINT TO LAST ENTRY           */
         L     @10,AMBIWA(,RAMB)                                   0341
         L     @10,ICWCHN(,@10)                                    0341
         L     @15,IMWBUFP(,@10)                                   0341
         LH    @14,IXHLEO(,@15)                                    0341
         LR    RBUFC,@15                                           0341
         ALR   RBUFC,@14                                           0341
*       RWORK1=RBUFC->IBFLPL;       /* PICK UP L OF ENTRY            */
         SLR   RWORK1,RWORK1                                       0342
         IC    RWORK1,IBFLPL(,RBUFC)                               0342
*       RWORK1=RWORK1+LENGTH(IXSELL);/* ADD LENGTH OF LL             */
         LA    @09,2                                               0343
         ALR   RWORK1,@09                                          0343
*       RWORK3=IXHLEO-IXHFSO-RWORK1;/* NO. OF FREE BYTES             */
         SH    @14,IXHFSO(,@15)                                    0344
         SLR   @14,RWORK1                                          0344
         LR    RWORK3,@14                                          0344
*       RWORK3=RWORK3-AMDKEYLN;     /* RESERVE BYTES FOR MAX.        */
         L     @14,AMBDSB(,RAMB)                                   0345
         SH    RWORK3,AMDKEYLN(,@14)                               0345
*       PLHSAVE1=RBUFC-RWORK1;      /* POINT TO LEFT BYTE            */
*                                                                  0346
         LR    @00,RBUFC                                           0346
         SLR   @00,RWORK1                                          0346
         ST    @00,PLHSAVE1(,RPLH)                                 0346
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE NUMBER OF BYTES NEEDED FOR NEW ENTRY            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0347
*       RWORK1=IMWIEL;              /* NEW ENTRY L VALUE             */
         SLR   RWORK1,RWORK1                                       0347
         IC    RWORK1,IMWIEL(,@10)                                 0347
*       IF IXHLV=ONE THEN           /* SEQUENCE SET INSERT           */
         CLI   IXHLV(@15),1                                        0348
         BNE   @RF00348                                            0348
*         RWORK1=RWORK1+LENGTH(IBFLPF)/* ADD ROOM FOR F              */
*             +LENGTH(IBFLPL);      /* ADD ROOM FOR L                */
         ALR   RWORK1,@09                                          0349
*       ELSE                        /* NOT SEQ. SET INSERT           */
*         RWORK1=RWORK1+IXHFLPLN;   /* ADD ROOM FOR F,L,PTR          */
         B     @RC00348                                            0350
@RF00348 L     @10,AMBIWA(,RAMB)                                   0350
         L     @10,ICWCHN(,@10)                                    0350
         L     @10,IMWBUFP(,@10)                                   0350
         SLR   @00,@00                                             0350
         IC    @00,IXHFLPLN(,@10)                                  0350
         ALR   RWORK1,@00                                          0350
*       IF IMWBSE=ON THEN           /* IF ENTRY BECAME A SECT        */
@RC00348 L     @10,AMBIWA(,RAMB)                                   0351
         L     @10,ICWCHN(,@10)                                    0351
         TM    IMWBSE(@10),B'00100000'                             0351
         BNO   @RF00351                                            0351
*         RWORK1=RWORK1+LENGTH(IXSELL);/* ADD SPACE FOR LL           */
         AL    RWORK1,@CF00155                                     0352
*                                                                  0353
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF ENTRY WILL FIT IN INDEX RECORD.              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0353
*       RWORK3=RWORK3+IMWFGAIN;     /* PICK UP FGAIN                 */
@RF00351 L     @10,AMBIWA(,RAMB)                                   0353
         L     @10,ICWCHN(,@10)                                    0353
         SLR   @00,@00                                             0353
         IC    @00,IMWFGAIN(,@10)                                  0353
         ALR   RWORK3,@00                                          0353
*       IF RWORK1>RWORK3 THEN       /* ROOM FOR NEW ENTRY            */
         CR    RWORK1,RWORK3                                       0354
         BNH   @RF00354                                            0354
*         DO;                       /* NO.                           */
*           IF IXHLV=ONE&RBUFC->IBFLPF/* LAST SS RECORD@ZA02289      */
*               =ZERO&RBUFC->IBFLPL=ZERO THEN/*              @ZA02289*/
         L     @10,IMWBUFP(,@10)                                   0356
         CLI   IXHLV(@10),1                                        0356
         BNE   @RF00356                                            0356
         CLI   IBFLPF(RBUFC),0                                     0356
         BNE   @RF00356                                            0356
         CLI   IBFLPL(RBUFC),0                                     0356
         BNE   @RF00356                                            0356
*INOFIT:                                                           0357
*             DO;                   /* YES- WILL NOT FIT             */
INOFIT   DS    0H                                                  0358
*               RESPECIFY                                          0358
*                 R15 RSTD;                                        0358
*               R15=IMWNOFIT;       /* SET WONT FIT RTN CODE         */
         LA    R15,8                                               0359
*               RAMB=AMBLDTA;       /* POINT TO DATA AMB             */
         L     @14,RPLDACB(,RRPL)                                  0360
         L     @14,ACBAMBL(,@14)                                   0360
         L     RAMB,AMBLDTA(,@14)                                  0360
*               GEN(IDARST14);      /* RESTORE R14                   */
         IDARST14
*               RETURN;             /* RETURN                        */
@EL00001 DS    0H                                                  0362
@EF00001 DS    0H                                                  0362
@ER00001 BR    @14                                                 0362
*               RESPECIFY                                          0363
*                 R15 UNRSTD;                                      0363
*             END;                  /* END OF ERROR RETURN           */
*           ELSE                    /* NOT LAST SS RECORD            */
*             DO;                   /* RE-ESTIMATE SPACE             */
@RF00356 DS    0H                                                  0366
*               RWORK3=RWORK3+AMDKEYLN;/* ADD BACK KEYSIZE           */
         L     @10,AMBDSB(,RAMB)                                   0366
         AH    RWORK3,AMDKEYLN(,@10)                               0366
*               IF RWORK1>RWORK3 THEN/* FIT WITH NO RESERVE          */
         CR    RWORK1,RWORK3                                       0367
         BH    @RT00367                                            0367
*                 GO TO INOFIT;     /* NO                            */
*               PLHSAVE6=IMWIEL+IXSPEC+LENGTH(IXSELL);/* L+F+2       */
         L     @10,AMBIWA(,RAMB)                                   0369
         L     @10,ICWCHN(,@10)                                    0369
         L     @15,IMWIXSP(,@10)                                   0369
         SLR   @00,@00                                             0369
         IC    @00,IMWIEL(,@10)                                    0369
         SLR   @14,@14                                             0369
         IC    @14,IXSPEC(,@15)                                    0369
         ALR   @00,@14                                             0369
         AL    @00,@CF00155                                        0369
         ST    @00,PLHSAVE6(,RPLH)                                 0369
*               PLHSAVE5=RWORK1-IMWFGAIN;/* INSERT SPACE NEEDED      */
         LR    @00,RWORK1                                          0370
         SLR   @14,@14                                             0370
         IC    @14,IMWFGAIN(,@10)                                  0370
         SLR   @00,@14                                             0370
         ST    @00,PLHSAVE5(,RPLH)                                 0370
*               RBUFC=IXSHEP-IMWBUFP;/* INSERT POINT OFFSET          */
         L     @10,IMWBUFP(,@10)                                   0371
         L     RBUFC,IXSHEP(,@15)                                  0371
         SLR   RBUFC,@10                                           0371
*               RPARM1=IMWBUFP;     /* POINT TO IX RECORD            */
         LR    RPARM1,@10                                          0372
*I02:                                                              0373
*               DO;                 /* IDACALL(IDAIXCHK)             */
I02      DS    0H                                                  0374
*                 CALL IDAIXCHK;    /* EXIT TO IDAIXCHK              */
         L     @15,@CA01049                                        0374
         BALR  @14,@15                                             0374
*                 GEN(BALR @11,0);  /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*                 GEN(USING *,@11); /* ESTABLISH ADDRESSING          */
         USING *,@11
*                 GEN(L     @11,=A(@PSTART));/* RELOAD BASE          */
         L     @11,=A(@PSTART)
*                 GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING     */
         USING @PSTART,@11
*               END I02;            /* SCAN FOR RESERVED             */
*               RFY                                                0380
*                (RWORK1,                                          0380
*                 RWORK2,                                          0380
*                 RWORK3,                                          0380
*                 R15) RSTD;                                       0380
*               IF R15^=ZERO THEN   /* NOT ENOUGH SPACE              */
         LTR   R15,R15                                             0381
         BNZ   @RT00381                                            0381
*                 GO TO INOFIT;     /* ENTRY WILL NOT FIT            */
*               RFY                                                0383
*                 R15 UNRSTD;                                      0383
*             END;                  /* END RE-ESTIMATE SPACE         */
*         END;                      /* NOT ROOM FOR RESERVE          */
*                                                                  0386
*       /*************************************************************/
*       /*                                                           */
*       /* MAKE RE-ADJUSTMENT TO ENTRY FOLLOWING INSERT POINT.       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0386
*       RWORK3=IMWFGAIN;            /* PICK UP FGAIN VALUE           */
@RF00354 L     @10,AMBIWA(,RAMB)                                   0386
         L     @10,ICWCHN(,@10)                                    0386
         SLR   RWORK3,RWORK3                                       0386
         IC    RWORK3,IMWFGAIN(,@10)                               0386
*       IF RWORK3^=ZERO THEN        /* VALUE = 0                     */
         LTR   RWORK3,RWORK3                                       0387
         BZ    @RF00387                                            0387
*         DO;                       /* NO.                           */
*           RBUFC=IXSHEP-(IXSNOSR*IXHFLPLN);/* POINT TO FOLLOWING  0389
*                                      ENT.                  @ZA02289*/
         L     @15,IMWIXSP(,@10)                                   0389
         L     @10,IMWBUFP(,@10)                                   0389
         SLR   @14,@14                                             0389
         IC    @14,IXHFLPLN(,@10)                                  0389
         SLR   @09,@09                                             0389
         IC    @09,IXSNOSR(,@15)                                   0389
         MR    @08,@14                                             0389
         L     RBUFC,IXSHEP(,@15)                                  0389
         SLR   RBUFC,@09                                           0389
*           RPARM1=RBUFC->IBFLPL;   /* PICK UP L OF ENTRY            */
         SLR   @10,@10                                             0390
         IC    @10,IBFLPL(,RBUFC)                                  0390
         LR    RPARM1,@10                                          0390
*           RBUFC->IBFLPF=RBUFC->IBFLPF/* INCREMENT F OF ENTRY       */
*               +RWORK3;            /* BY FGAIN VALUE                */
         SLR   @00,@00                                             0391
         IC    @00,IBFLPF(,RBUFC)                                  0391
         ALR   @00,RWORK3                                          0391
         STC   @00,IBFLPF(,RBUFC)                                  0391
*           RBUFC->IBFLPL=RBUFC->IBFLPL/* REDUCE L OF ENTRY          */
*               -RWORK3;            /* BY FGAIN VALUE                */
         SLR   @10,RWORK3                                          0392
         STC   @10,IBFLPL(,RBUFC)                                  0392
*           RBUFC=RBUFC-RPARM1;     /* POINT TO LEFTMOST BYTE        */
         SLR   RBUFC,RPARM1                                        0393
*           RWORK2=RBUFC+RWORK3;    /* POINT 1ST REMAIN BYTE         */
         LR    RWORK2,RBUFC                                        0394
         ALR   RWORK2,RWORK3                                       0394
*           RWORK1=IXHFLPLN+RPARM1-RWORK3/* MVCL LENGTH              */
*               +(IXSNOSR*IXHFLPLN);/*                       @ZA02289*/
         ALR   @14,RPARM1                                          0395
         SLR   @14,RWORK3                                          0395
         ALR   @14,@09                                             0395
         LR    RWORK1,@14                                          0395
*           PLHSAVE2=RBUFC+RWORK1;  /* END OF ENTRIES TO LEFT        */
         LR    @10,RBUFC                                           0396
         ALR   @10,RWORK1                                          0396
         ST    @10,PLHSAVE2(,RPLH)                                 0396
*           RWORK3=RWORK1;          /* COPY MVCL LENGTH              */
         LR    RWORK3,RWORK1                                       0397
*           GEN(MVCL  RBUFC,RWORK2);/* MOVE ENTRY LEFT               */
         MVCL  RBUFC,RWORK2
*         END;                      /* END OF NEXT ENTRY ADJST       */
*       ELSE                        /*                               */
*         PLHSAVE2=IXSHEP+IXHFLPLN; /* END OF ENTRIES TO LEFT        */
         B     @RC00387                                            0400
@RF00387 L     @10,AMBIWA(,RAMB)                                   0400
         L     @10,ICWCHN(,@10)                                    0400
         L     @15,IMWIXSP(,@10)                                   0400
         L     @10,IMWBUFP(,@10)                                   0400
         SLR   @00,@00                                             0400
         IC    @00,IXHFLPLN(,@10)                                  0400
         AL    @00,IXSHEP(,@15)                                    0400
         ST    @00,PLHSAVE2(,RPLH)                                 0400
*                                                                  0401
*       /*************************************************************/
*       /*                                                           */
*       /* REMOVE FREE DATA CI PTR FOR SEQUENCE SET INSERT           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0401
*       RWORK1=IXHFLPLN-LENGTH(IBFLPF)/* COMPUTE PTR LENGTH          */
*           -LENGTH(IBFLPL);        /*                               */
@RC00387 L     @10,AMBIWA(,RAMB)                                   0401
         L     @10,ICWCHN(,@10)                                    0401
         L     @10,IMWBUFP(,@10)                                   0401
         SLR   RWORK1,RWORK1                                       0401
         IC    RWORK1,IXHFLPLN(,@10)                               0401
         BCTR  RWORK1,0                                            0401
         BCTR  RWORK1,0                                            0401
*       PLHSAVE3=RWORK1;            /* SAVE PTR LENGTH               */
         ST    RWORK1,PLHSAVE3(,RPLH)                              0402
*       IF IXHLV=ONE THEN           /* SEQUENCE SET                  */
         CLI   IXHLV(@10),1                                        0403
         BNE   @RF00403                                            0403
*         DO;                       /* YES.                          */
*           IXHFSO=IXHFSO-RWORK1;   /* REDUCE FREE SP OFFSET         */
         LH    @00,IXHFSO(,@10)                                    0405
         SLR   @00,RWORK1                                          0405
         STH   @00,IXHFSO(,@10)                                    0405
*           RWORK2=ZERO;            /* ZERO REGISTER                 */
         SLR   RWORK2,RWORK2                                       0406
*           RWORK1=IMWBUFP+IXHFSO;  /* POINT TO USED PTR             */
         ALR   @00,@10                                             0407
         LR    RWORK1,@00                                          0407
*           RWORK3=IXHPTLS;         /* PICK UP PTR LENGTH MASK       */
         SLR   RWORK3,RWORK3                                       0408
         IC    RWORK3,IXHPTLS(,@10)                                0408
*           GEN(EX  RWORK3,SETPTR); /* ZERO USED PTR                 */
         EX  RWORK3,SETPTR
*         END;                      /* END OF USED PTR ERASE         */
*                                                                  0410
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE ENTRIES LEFT TO FORM SPACE FOR NEW ENTRY             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0411
*       RPARM1=IMWIEL+IXHFLPLN-IMWFGAIN;/* LEFT SHIFT AMOUNT         */
@RF00403 L     @10,AMBIWA(,RAMB)                                   0411
         L     @10,ICWCHN(,@10)                                    0411
         L     @15,IMWBUFP(,@10)                                   0411
         SLR   RPARM1,RPARM1                                       0411
         IC    RPARM1,IMWIEL(,@10)                                 0411
         SLR   @00,@00                                             0411
         IC    @00,IXHFLPLN(,@15)                                  0411
         ALR   RPARM1,@00                                          0411
         SLR   @00,@00                                             0411
         IC    @00,IMWFGAIN(,@10)                                  0411
         SLR   RPARM1,@00                                          0411
*       IF IMWBSE=ON THEN           /* IF ENTRY BECAME A SECT        */
         TM    IMWBSE(@10),B'00100000'                             0412
         BNO   @RF00412                                            0412
*         RPARM1=RPARM1+LENGTH(IXSELL);/* ADD SPACE FOR LL           */
         AL    RPARM1,@CF00155                                     0413
*       IF RPARM1>ZERO THEN         /* SHIFT AMOUNT = 0              */
@RF00412 LTR   RPARM1,RPARM1                                       0414
         BNP   @RF00414                                            0414
*         DO;                       /* NO.                           */
*           RWORK2=PLHSAVE1;        /* POINT TO LEFT BYTE            */
         L     RWORK2,PLHSAVE1(,RPLH)                              0416
*           RWORK1=PLHSAVE2-RWORK2; /* MOVE LENGTH                   */
         L     RWORK1,PLHSAVE2(,RPLH)                              0417
         SLR   RWORK1,RWORK2                                       0417
*           RBUFC=RWORK2-RPARM1;    /* BACK UP TO PTR BY SHIFT       */
         LR    RBUFC,RWORK2                                        0418
         SLR   RBUFC,RPARM1                                        0418
*           RWORK3=RWORK1;          /* COPY MVCL LENGTH              */
         LR    RWORK3,RWORK1                                       0419
*           GEN(MVCL  RBUFC,RWORK2);/* SHIFT ENTRIES LEFT            */
         MVCL  RBUFC,RWORK2
*         END;                      /* END OF SHIFT CODE             */
*                                                                  0421
*       /*************************************************************/
*       /*                                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0422
*                                                                  0422
*       /*************************************************************/
*       /*                                                           */
*       /* INSERT NEW INDEX ENTRY.                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0422
*       RBUFC=IXSHEP;               /* NEW ENTRY LOCATION            */
@RF00414 L     @10,AMBIWA(,RAMB)                                   0422
         L     @10,ICWCHN(,@10)                                    0422
         L     @15,IMWIXSP(,@10)                                   0422
         L     RBUFC,IXSHEP(,@15)                                  0422
*       RBUFC->IBFLPF=IXSPEC;       /* SET F                         */
         IC    @00,IXSPEC(,@15)                                    0423
         STC   @00,IBFLPF(,RBUFC)                                  0423
*       RBUFC->IBFLPL=IMWIEL;       /* SET L                         */
         IC    @00,IMWIEL(,@10)                                    0424
         STC   @00,IBFLPL(,RBUFC)                                  0424
*       RWORK1=ADDR(RBUFC->IBFLP3); /* PTR LOCATION                  */
         LA    RWORK1,IBFLP3(,RBUFC)                               0425
*       RWORK3=IXHPTLS;             /* PTR LENGTH MASK               */
         L     @15,IMWBUFP(,@10)                                   0426
         SLR   RWORK3,RWORK3                                       0426
         IC    RWORK3,IXHPTLS(,@15)                                0426
*       RWORK2=IMWIPTR;             /* PICK UP PTR VALUE             */
         L     RWORK2,IMWIPTR(,@10)                                0427
*       GEN(EX  RWORK3,SETPTR);     /* SET PTR IN ENTRY              */
         EX  RWORK3,SETPTR
*       RWORK1=IMWIEL;              /* NUMBER OF KEY CHAR.           */
         L     @10,AMBIWA(,RAMB)                                   0429
         L     @10,ICWCHN(,@10)                                    0429
         SLR   RWORK1,RWORK1                                       0429
         IC    RWORK1,IMWIEL(,@10)                                 0429
*       RBUFC=RBUFC-RWORK1;         /* SET TO PTR FOR MVCL           */
         SLR   RBUFC,RWORK1                                        0430
*       PLHSAVE3=RBUFC-PLHSAVE3;    /* SET PTR TO NEXT ENT.PTR       */
         LR    @00,RBUFC                                           0431
         SL    @00,PLHSAVE3(,RPLH)                                 0431
         ST    @00,PLHSAVE3(,RPLH)                                 0431
*       RWORK2=IMWIKEYP+IXSPEC;     /* SET FROM PTR                  */
         L     @15,IMWIXSP(,@10)                                   0432
         SLR   RWORK2,RWORK2                                       0432
         IC    RWORK2,IXSPEC(,@15)                                 0432
         AL    RWORK2,IMWIKEYP(,@10)                               0432
*       RWORK3=RWORK1;              /* COPY MVCL LENGTH              */
         LR    RWORK3,RWORK1                                       0433
*       GEN(MVCL  RBUFC,RWORK2);    /* INSERT KEY CHARACTERS         */
*                                                                  0434
         MVCL  RBUFC,RWORK2
*       /*************************************************************/
*       /*                                                           */
*       /* SET PTR IN FOLLOWING ENTRY.                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0435
*       RWORK2=IMWXPTR;             /* NEXT ENTRY PTR VALUE          */
         L     @10,AMBIWA(,RAMB)                                   0435
         L     @10,ICWCHN(,@10)                                    0435
         L     RWORK2,IMWXPTR(,@10)                                0435
*       RWORK1=PLHSAVE3;            /* PTR TO PTR LOCATION           */
         L     RWORK1,PLHSAVE3(,RPLH)                              0436
*       IF IMWBSE=ON THEN           /* IF THIS IS A SECTION          */
         TM    IMWBSE(@10),B'00100000'                             0437
         BNO   @RF00437                                            0437
*         RWORK1=RWORK1-LENGTH(IXSELL);/* BACK OVER CHAIN FIELD      */
         BCTR  RWORK1,0                                            0438
         BCTR  RWORK1,0                                            0438
*       RWORK3=IXHPTLS;             /* PTR LENGTH MASK               */
@RF00437 L     @10,AMBIWA(,RAMB)                                   0439
         L     @10,ICWCHN(,@10)                                    0439
         L     @15,IMWBUFP(,@10)                                   0439
         SLR   RWORK3,RWORK3                                       0439
         IC    RWORK3,IXHPTLS(,@15)                                0439
*       IF IXSNOSR^=ZERO THEN       /* IS THE NEXT ENTRY FOR A     0440
*                                      SPANNED RECORD        @ZA02289*/
         L     @10,IMWIXSP(,@10)                                   0440
         CLI   IXSNOSR(@10),0                                      0440
         BE    @RF00440                                            0440
*         DO;                       /* YES                   @ZA02289*/
*           PLHSAVE3=IXSNOSR*IXHFLPLN;/* SET MOVE LL         @ZA02289*/
         SLR   @09,@09                                             0442
         IC    @09,IXHFLPLN(,@15)                                  0442
         SLR   @00,@00                                             0442
         IC    @00,IXSNOSR(,@10)                                   0442
         MR    @08,@00                                             0442
         ST    @09,PLHSAVE3(,RPLH)                                 0442
*           RFY                                                    0443
*             RWORK4 RSTD;          /*                       @ZA02289*/
*           RWORK4=ZERO;            /* CLEAR BEFORE EXTRACTING     0444
*                                      POINTER FIELD         @ZA02289*/
         SLR   RWORK4,RWORK4                                       0444
*           GEN(EX  RWORK3,GETPTR); /* EXTRACT POINTER@ZA02289       */
         EX  RWORK3,GETPTR
*           IF RWORK4=RWORK2 THEN   /* SAME AS POINTER WHICH WILL BE
*                                      STORED                @ZA02289*/
         CLR   RWORK4,RWORK2                                       0446
         BNE   @RF00446                                            0446
*             IXSNOSR=ZERO;         /* YES, CLEAR FIELD SO NO      0447
*                                      ADJUSTMENTS WILL BE MADE LATER
*                                                            @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0447
         L     @10,ICWCHN(,@10)                                    0447
         L     @10,IMWIXSP(,@10)                                   0447
         MVI   IXSNOSR(@10),X'00'                                  0447
*           RFY                                                    0448
*             RWORK4 UNRSTD;        /*                       @ZA02289*/
@RF00446 DS    0H                                                  0449
*         END;                      /*                       @ZA02289*/
*       ELSE                        /*                       @ZA02289*/
*         GEN(EX  RWORK3,SETPTR);   /* SET PTR IN ENTRY              */
*                                                                  0450
         B     @RC00440                                            0450
@RF00440 DS    0H                                                  0450
         EX  RWORK3,SETPTR
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD LL FIELD IF ENTRY WAS A SECTION                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0451
*       IF IMWBSE=ON THEN           /* WAS ENTRY MADE A SECT         */
@RC00440 L     @10,AMBIWA(,RAMB)                                   0451
         L     @10,ICWCHN(,@10)                                    0451
         TM    IMWBSE(@10),B'00100000'                             0451
         BNO   @RF00451                                            0451
*         DO;                       /* YES                           */
*           RWORK1=RWORK1+IXHFLPLN- /* POINT TO LL FIELD             */
*               LENGTH(IBFLPL)-     /* OF THE ENTRY                  */
*               LENGTH(IBFLPF);     /*                               */
         L     @15,IMWBUFP(,@10)                                   0453
         LR    @00,RWORK1                                          0453
         SLR   @14,@14                                             0453
         IC    @14,IXHFLPLN(,@15)                                  0453
         ALR   @00,@14                                             0453
         BCTR  @00,0                                               0453
         BCTR  @00,0                                               0453
         LR    RWORK1,@00                                          0453
*           RWORK1->IXSELL=RPARM1+  /* SET VALUE OF LL FIELD         */
*               IMWFGAIN;           /*                               */
         LR    @00,RPARM1                                          0454
         SLR   @15,@15                                             0454
         IC    @15,IMWFGAIN(,@10)                                  0454
         ALR   @00,@15                                             0454
         STCM  @00,3,IXSELL(RWORK1)                                0454
*         END;                      /*                               */
*       ELSE                                                       0456
*         ;                         /*                               */
*                                                                  0456
@RF00451 DS    0H                                                  0457
*       /*************************************************************/
*       /*                                                           */
*       /* ADJUST OFFSET TO SECTION CONTAINING NEW ENTRY             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0457
*       IF IMWBSE=OFF THEN          /* SECTION ENTRY MADE            */
         L     @10,AMBIWA(,RAMB)                                   0457
         L     @10,ICWCHN(,@10)                                    0457
         TM    IMWBSE(@10),B'00100000'                             0457
         BNZ   @RF00457                                            0457
*         DO;                       /* NO                            */
*           IF IXSSEP-IMWBUFP=IXHSEO THEN/* INSERT IN 1ST SECTION    */
         L     @15,IMWIXSP(,@10)                                   0459
         L     @10,IMWBUFP(,@10)                                   0459
         L     @00,IXSSEP(,@15)                                    0459
         SLR   @00,@10                                             0459
         LH    @15,IXHSEO(,@10)                                    0459
         CR    @00,@15                                             0459
         BNE   @RF00459                                            0459
*             IXHSEO=IXHSEO-RPARM1; /* REDUCE 1ST SECT. OFFSET       */
         SLR   @15,RPARM1                                          0460
         STH   @15,IXHSEO(,@10)                                    0460
*           ELSE                    /* NOT 1ST SECT. INSERT          */
*             DO;                   /*                               */
         B     @RC00459                                            0461
@RF00459 DS    0H                                                  0462
*               RWORK1=IXSLEP+IXHFLPLN;/* PTR TO LL OF PREV. SECT    */
         L     @10,AMBIWA(,RAMB)                                   0462
         L     @10,ICWCHN(,@10)                                    0462
         L     @15,IMWIXSP(,@10)                                   0462
         L     @10,IMWBUFP(,@10)                                   0462
         SLR   RWORK1,RWORK1                                       0462
         IC    RWORK1,IXHFLPLN(,@10)                               0462
         AL    RWORK1,IXSLEP(,@15)                                 0462
*               RWORK2=ZERO;        /* ZERO REGISTER                 */
         SLR   RWORK2,RWORK2                                       0463
*               GEN(ICM  RWORK2,3,0(RWORK1));/* PICK UP LL           */
         ICM  RWORK2,3,0(RWORK1)
*               RWORK2=RWORK2+RPARM1;/* ADD INCREASE TO LL           */
         ALR   RWORK2,RPARM1                                       0465
*               GEN(STCM RWORK2,3,0(RWORK1));/* STORE NEW LL VALUE   */
         STCM RWORK2,3,0(RWORK1)
*             END;                  /* END PREV. LL ADJUST           */
*           IMWFGAIN=ZERO;          /* CLEAR FGAIN TO KEEP LEO     0468
*                                      INDEPENDENT OF IT             */
@RC00459 L     @10,AMBIWA(,RAMB)                                   0468
         L     @10,ICWCHN(,@10)                                    0468
         MVI   IMWFGAIN(@10),X'00'                                 0468
*         END;                      /*                               */
*                                                                  0469
*       /*************************************************************/
*       /*                                                           */
*       /* ADJUST OFFSET TO LAST ENTRY IN INDEX RECORD.              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0470
*       IXHLEO=IXHLEO-RPARM1-       /* BACK UP OFFSET TO             */
*           IMWFGAIN;               /* THE LAST ENTRY IN INDX        */
*                                                                  0470
@RF00457 L     @10,AMBIWA(,RAMB)                                   0470
         L     @10,ICWCHN(,@10)                                    0470
         L     @15,IMWBUFP(,@10)                                   0470
         LH    @00,IXHLEO(,@15)                                    0470
         SLR   @00,RPARM1                                          0470
         SLR   @14,@14                                             0470
         IC    @14,IMWFGAIN(,@10)                                  0470
         SLR   @00,@14                                             0470
         STH   @00,IXHLEO(,@15)                                    0470
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZA02289*/
*       /* PROCESS FOLLOWING SPANNED RECORD ENTRY            @ZA02289*/
*       /*                                                   @ZA02289*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0471
*       IF IXSNOSR^=ZERO THEN       /* DOES INSERT PRECEED A SPANNED
*                                      RECORD                @ZA02289*/
         L     @10,IMWIXSP(,@10)                                   0471
         CLI   IXSNOSR(@10),0                                      0471
         BE    @RF00471                                            0471
*         DO;                       /* YES                   @ZA02289*/
*           RFY                                                    0473
*            (RWORK0,                                              0473
*             RWORK4) RSTD;         /*                       @ZA02289*/
*           DO RPARM1=ONE TO IXSNOSR;/* LOOP TO SHIFT ENTRY FOR KEY
*                                      TO LEFT               @ZA02289*/
         LA    RPARM1,1                                            0474
         B     @DE00474                                            0474
@DL00474 DS    0H                                                  0475
*             RWORK0=IXSHEP-IXSHEP->/* POINT TO LEFT         @ZA02289*/
*                 IBFLPL;           /* END OF KEY            @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0475
         L     @10,ICWCHN(,@10)                                    0475
         L     @09,IMWIXSP(,@10)                                   0475
         L     @09,IXSHEP(,@09)                                    0475
         LR    RWORK0,@09                                          0475
         SLR   @15,@15                                             0475
         IC    @15,IBFLPL(,@09)                                    0475
         SLR   RWORK0,@15                                          0475
*             IF IMWBSE=ON THEN     /* SECTION               @ZA02289*/
         TM    IMWBSE(@10),B'00100000'                             0476
         BNO   @RF00476                                            0476
*               RWORK0=RWORK0-LENGTH(IXSELL);/* YES, MOVE TO END OF
*                                      LL FIELD              @ZA02289*/
         BCTR  RWORK0,0                                            0477
         BCTR  RWORK0,0                                            0477
*             RWORK4=RWORK0;        /* SET 'FROM'            @ZA02289*/
@RF00476 LR    RWORK4,RWORK0                                       0478
*             RWORK2=RWORK0-IXHFLPLN;/* SET 'TO'             @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0479
         L     @10,ICWCHN(,@10)                                    0479
         L     @09,IMWBUFP(,@10)                                   0479
         LR    RWORK2,RWORK0                                       0479
         SLR   @15,@15                                             0479
         IC    @15,IXHFLPLN(,@09)                                  0479
         SLR   RWORK2,@15                                          0479
*             RWORK3=IXSHEP-RWORK4+ /* SET LENGTH            @ZA02289*/
*                 LENGTH(IBFLPF)+LENGTH(IBFLPL);/* OF MOVE   @ZA02289*/
         L     @10,IMWIXSP(,@10)                                   0480
         L     RWORK3,IXSHEP(,@10)                                 0480
         SLR   RWORK3,RWORK4                                       0480
         AL    RWORK3,@CF00155                                     0480
*             RWORK0=RWORK2;        /* SAVE POSITION         @ZA02289*/
         LR    RWORK0,RWORK2                                       0481
*             RFY                                                  0482
*               RWORK5 RSTD;        /*                       @ZA02289*/
*             RWORK5=RWORK3;        /* SET LENGTH            @ZA02289*/
         LR    RWORK5,RWORK3                                       0483
*             GEN(MVCL  RWORK2,RWORK4);/* MOVE KEY LEFT      @ZA02289*/
         MVCL  RWORK2,RWORK4
*             RFY                                                  0485
*               RWORK5 UNRSTD;      /*                       @ZA02289*/
*             RWORK1=RWORK0-IXHFLPLN+/* ADDRESS POINTER@ZA02289      */
*                 LENGTH(IBFLPF)+   /* WHICH WILL            @ZA02289*/
*                 LENGTH(IBFLPL);   /* MOVE                  @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0486
         L     @10,ICWCHN(,@10)                                    0486
         L     @10,IMWBUFP(,@10)                                   0486
         LR    RWORK1,RWORK0                                       0486
         SLR   @09,@09                                             0486
         IC    @09,IXHFLPLN(,@10)                                  0486
         SLR   RWORK1,@09                                          0486
         AL    RWORK1,@CF00155                                     0486
*             RWORK3=IXHPTLS;       /* GET MASK              @ZA02289*/
         SLR   RWORK3,RWORK3                                       0487
         IC    RWORK3,IXHPTLS(,@10)                                0487
*             GEN(EX  RWORK3,GETPTR);/* PICK UP POINTER@ZA02289      */
         EX  RWORK3,GETPTR
*             GEN(EX  RWORK3,STOREPTR);/* SET POINTER        @ZA02289*/
         EX  RWORK3,STOREPTR
*             IXSHEP=RWORK2-LENGTH(IBFLPL)-/* SET NEW HEP    @ZA02289*/
*                 LENGTH(IBFLPF);   /*                       @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0490
         L     @10,ICWCHN(,@10)                                    0490
         L     @09,IMWIXSP(,@10)                                   0490
         LA    @15,2                                               0490
         LR    @14,RWORK2                                          0490
         SLR   @14,@15                                             0490
         ST    @14,IXSHEP(,@09)                                    0490
*             RWORK2=RWORK2+IXHFLPLN-/* POINT TO F           @ZA02289*/
*                 LENGTH(IBFLPF)-   /* FIELD OF SPND         @ZA02289*/
*                 LENGTH(IBFLPL);   /* RCD ENTRY TO BE CREATED     0491
*                                                            @ZA02289*/
         L     @09,IMWBUFP(,@10)                                   0491
         LR    @14,RWORK2                                          0491
         SLR   @10,@10                                             0491
         IC    @10,IXHFLPLN(,@09)                                  0491
         ALR   @14,@10                                             0491
         SLR   @14,@15                                             0491
         LR    RWORK2,@14                                          0491
*             RWORK2->IBFLPF=AMDKEYLN;/* SET TO KEY LL       @ZA02289*/
         L     @10,AMBDSB(,RAMB)                                   0492
         LH    @10,AMDKEYLN(,@10)                                  0492
         STC   @10,IBFLPF(,RWORK2)                                 0492
*             RWORK2->IBFLPL=ZERO;  /* CLEAR L BYTE          @ZA02289*/
         MVI   IBFLPL(RWORK2),X'00'                                0493
*             RWORK2=IMWXPTR;       /* NEXT ENTRY POINTER VALUE    0494
*                                                            @ZA02289*/
         L     @10,AMBIWA(,RAMB)                                   0494
         L     @10,ICWCHN(,@10)                                    0494
         L     RWORK2,IMWXPTR(,@10)                                0494
*             GEN(EX  RWORK3,SETPTR);/* REPLACE WITH NEW ENTRY     0495
*                                                            @ZA02289*/
         EX  RWORK3,SETPTR
*           END;                    /*                       @ZA02289*/
         AL    RPARM1,@CF00053                                     0496
@DE00474 L     @10,AMBIWA(,RAMB)                                   0496
         L     @10,ICWCHN(,@10)                                    0496
         L     @10,IMWIXSP(,@10)                                   0496
         SLR   @09,@09                                             0496
         IC    @09,IXSNOSR(,@10)                                   0496
         CR    RPARM1,@09                                          0496
         BNH   @DL00474                                            0496
*           RFY                                                    0497
*            (RWORK0,                                              0497
*             RWORK4) UNRSTD;       /*                       @ZA02289*/
*         END;                      /*                       @ZA02289*/
*     END;                          /* END OF INSERT PROCESS         */
*   ELSE                            /*                               */
*     DO;                           /*                               */
         B     @RC00167                                            0500
@RF00167 DS    0H                                                  0501
*       IF RPARM1=IXWRITE THEN      /* WRITE INDEX REQUEST           */
         C     RPARM1,@CF00067                                     0501
         BNE   @RF00501                                            0501
*         DO;                       /* YES.                          */
*           RBUFC=IXSBUFC;          /* POINT TO BUFC                 */
         L     @10,AMBIWA(,RAMB)                                   0503
         L     @10,ICWCHN(,@10)                                    0503
         L     @10,IMWIXSP(,@10)                                   0503
         L     RBUFC,IXSBUFC(,@10)                                 0503
*           RFY                                                    0504
*             IDABUFC BASED(RBUFC); /*                               */
*           DO;                     /* SET UPDATED BFR               */
*             BUFCORBA=BUFCDDDD;                                   0506
         L     @10,BUFCDDDD(,RBUFC)                                0506
         ST    @10,BUFCORBA(,RBUFC)                                0506
*             BUFCMW=ON;                                           0507
         OI    BUFCMW(RBUFC),B'10000000'                           0507
*           END;                                                   0508
*           BUFCVAL=ON;             /* MARK BUFFER VALID     @ZA02289*/
         OI    BUFCVAL(RBUFC),B'00000100'                          0509
*I04:                                                              0510
*           DO;                     /* IDACALL(IDAWRBFR)             */
I04      DS    0H                                                  0511
*             CALL IDAWRBFR;        /* EXIT TO IDAWRBFR              */
         L     @15,@CV01003                                        0511
         BALR  @14,@15                                             0511
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */
         BALR @11,0
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */
         USING *,@11
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */
         L     @11,=A(@PSTART)
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */
         USING @PSTART,@11
*           END I04;                                               0516
*           RBUFC=IXSBUFC;          /* POINT TO BUFC                 */
         L     @10,AMBIWA(,RAMB)                                   0517
         L     @10,ICWCHN(,@10)                                    0517
         L     @10,IMWIXSP(,@10)                                   0517
         L     RBUFC,IXSBUFC(,@10)                                 0517
*           CALL IDAIVIXB;          /* INVALIDATE OTHER COPIES       */
         L     @15,@CA01053                                        0518
         BALR  @14,@15                                             0518
*         END;                      /* END OF WRITE REQUEST          */
*       ELSE                        /* NOT WRITE REQUEST             */
*         DO;                       /*                               */
         B     @RC00501                                            0520
@RF00501 DS    0H                                                  0521
*           IF RPARM1=IXHLENT THEN  /* HIGHER LEVEL INSERT           */
         C     RPARM1,@CF00062                                     0521
         BE    @RT00521                                            0521
*             GO TO HLINSERT;       /* YES. GO TO INSERT CODE        */
*         END;                      /*                               */
*     END;                          /* END OF NOT SS INSERT          */
@RC00501 DS    0H                                                  0525
*   RESPECIFY                                                      0525
*     R15 RSTD;                                                    0525
@RC00167 DS    0H                                                  0526
*   R15=ZERO;                       /* ENTRY MADE RETURN CODE        */
         SLR   R15,R15                                             0526
*   RAMB=AMBLDTA;                   /* POINT TO DATA AMB             */
         L     @14,RPLDACB(,RRPL)                                  0527
         L     @14,ACBAMBL(,@14)                                   0527
         L     RAMB,AMBLDTA(,@14)                                  0527
*   GEN(IDARST14);                  /* RESTORE R14                   */
         IDARST14
*   RETURN;                         /* RETURN                        */
         B     @EL00001                                            0529
*   RESPECIFY                                                      0530
*     R15 UNRSTD;                                                  0530
*                                                                  0530
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO INVALIDATE INDEX BUFFERS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*IDAIVIXB:                                                         0531
*   ENTRY;                          /* INVALIDATE BUFFERS            */
@EP00531 DS    0H                                                  0532
*   RFY                                                            0532
*    (RWORK2,                                                      0532
*     RWORK3,                                                      0532
*     R14) RSTD;                    /*                       @ZA02289*/
*   RFY                                                            0533
*     IDABUFDR BASED(AMBBUFC);      /* LOCATE BUFC HEADER            */
*   IF AMBLSR=ON×AMBGSR=ON THEN     /* DB/DC OPTION          @ZA02289*/
         TM    AMBLSR(RAMB),B'01100000'                            0534
         BNZ   @RT00534                                            0534
*     RETURN;                       /* YES, RETURN           @ZA02289*/
*   RWORK3=RBUFC->BUFCORBA;         /* PICK UP OUTPUT RBA            */
         L     RWORK3,BUFCORBA(,RBUFC)                             0536
*   RWORK2=BUFDBUFC;                /* POINT TO FIRST INDEX BUFC   0537
*                                                            @ZA02289*/
         L     @15,AMBBUFC(,RAMB)                                  0537
         L     RWORK2,BUFDBUFC(,@15)                               0537
*   DO UNTIL RWORK2=ZERO;           /* SCAN ALL INDEX BUFCS  @ZA02289*/
@DL00538 DS    0H                                                  0539
*     IF RWORK2^=RBUFC&             /* SKIP INPUT BUFC               */
*         RWORK2->BUFCDDDD=RWORK3&  /* RBAS MATCH                    */
*         RWORK2->BUFCVAL=ON THEN   /* RBA VALID                     */
         CLR   RWORK2,RBUFC                                        0539
         BE    @RF00539                                            0539
         CL    RWORK3,BUFCDDDD(,RWORK2)                            0539
         BNE   @RF00539                                            0539
         TM    BUFCVAL(RWORK2),B'00000100'                         0539
         BNO   @RF00539                                            0539
*       RWORK2->BUFCRRD=ON;         /* SET READ REQUIRED             */
         OI    BUFCRRD(RWORK2),B'00100000'                         0540
*     RWORK2=RWORK2->BUFCHAIN;      /* MOVE TO NEXT BUFC     @ZA02289*/
@RF00539 L     RWORK2,BUFCHAIN(,RWORK2)                            0541
*   END;                            /* END OF BUFC SCAN LOOP         */
@DE00538 LTR   RWORK2,RWORK2                                       0542
         BNZ   @DL00538                                            0542
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00001                                            0543
*   RFY                                                            0544
*    (RWORK2,                                                      0544
*     RWORK3,                                                      0544
*     R14) UNRSTD;                  /*                       @ZA02289*/
*                                                                  0545
*   /*****************************************************************/
*   /*                                                               */
*   /* IDASPACE ROUTINE FUNCTION - THIS ROUTINE WILL DETERMINE IF    */
*   /* THERE IS ENOUGH ROOM IN AN INDEX RECORD TO INSURE THAT THE    */
*   /* RECORD CAN BE SPLIT IN THE FUTURE. INPUT - RPARM1 = POINTER TO*/
*   /* INDEX RECORD OUTPUT - R15 = 0 IF REQUIRED SPACE EXISTS R15 = 8*/
*   /* IF REQUIRED SPACE DOES NOT EXIST RESTRICTIONS - THIS ROUTINE  */
*   /* MUST NOT ALTER THE CONTENTS OF RWORK1, RPARM1, OR PLHSAVE1    */
*   /* THRU PLHSAVE6.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0545
*IDASPACE:                                                         0545
*   ENTRY;                          /* FREESPACE CHECK ENTRY         */
@EP00545 DS    0H                                                  0546
*   RFY                                                            0546
*    (RWORK1,                                                      0546
*     RWORK2,                                                      0546
*     RWORK3,                                                      0546
*     R14) RSTD;                                                   0546
*   RFY                                                            0547
*     IDAIXH BASED(RPARM1);                                        0547
*   RBUFC=RPARM1+IXHLEO;            /* POINT TO LAST ENTRY           */
         LH    @15,IXHLEO(,RPARM1)                                 0548
         LR    RBUFC,RPARM1                                        0548
         ALR   RBUFC,@15                                           0548
*   RWORK2=RBUFC->IBFLPL;           /* PICK UP L VALUE               */
         SLR   RWORK2,RWORK2                                       0549
         IC    RWORK2,IBFLPL(,RBUFC)                               0549
*   RWORK2=RWORK2+LENGTH(IXSELL);   /* ADD LENGTH OF LL FIELD        */
         AL    RWORK2,@CF00155                                     0550
*   RBUFC=IXHLEO-IXHFSO-RWORK2;     /* AMOUNT OF FREESPACE           */
         SH    @15,IXHFSO(,RPARM1)                                 0551
         SLR   @15,RWORK2                                          0551
         LR    RBUFC,@15                                           0551
*   IF RBUFC<AMDKEYLN THEN          /* IS IT LESS THAN KEYSIZE       */
         L     @15,AMBDSB(,RAMB)                                   0552
         CH    RBUFC,AMDKEYLN(,@15)                                0552
         BNL   @RF00552                                            0552
*     DO;                           /* YES.                          */
*                                                                  0553
*       /*************************************************************/
*       /*                                                           */
*       /* MUST SCAN THE RECORD TO DETERMINE THE AMOUNT OF SPACE     */
*       /* NEEDED IN ORDER TO INSURE THAT THE RECORD CAN BE SPLIT IN */
*       /* THE FUTURE AT ANY ENTRY.                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0554
*       RBUFC=IXHLL;                /* OFFSET TO END OF RECORD       */
         LH    RBUFC,IXHLL(,RPARM1)                                0554
         N     RBUFC,@CF01078                                      0554
*       GEN(IDASVR14);              /* SAVE R14                      */
         IDASVR14
*       CALL IDAIXCHK;              /* SCAN AND CHECK ENTRIES        */
         L     @15,@CA01049                                        0556
         BALR  @14,@15                                             0556
*       RFY                                                        0557
*         R15 RSTD;                 /* R15 HAS RETURN CODE           */
*       GEN(IDARST14);              /* RESTORE R14                   */
         IDARST14
*       RETURN;                     /* RETURN TO CALLER              */
         B     @EL00001                                            0559
*     END;                          /* END LESS THAN KEYSIZE         */
*   R15=ZERO;                       /* OK RETURN CODE                */
@RF00552 SLR   R15,R15                                             0561
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00001                                            0562
*   RFY                                                            0563
*    (RWORK1,                                                      0563
*     RWORK2,                                                      0563
*     RWORK3,                                                      0563
*     R14,                                                         0563
*     R15) UNRSTD;                                                 0563
*                                                                  0564
*   /*****************************************************************/
*   /*                                                               */
*   /* IDAIXCHK ROUTINE FUNCTION - THIS ROUTINE CHECKS THAT THERE IS */
*   /* ROOM IN THE INDEX RECORD FOR ANY ENTRY TO BECOME THE LAST     */
*   /* ENTRY IN THE RECORD. INPUT - RPARM1 = POINTER TO INDEX RECORD */
*   /* RBUFC = INSERT POINT OFFSET IF THE INSERT POINT IS TO BE      */
*   /* PROCESSED BY THE SCAN, THE FOLLOWING ADDITIONAL INPUT IS      */
*   /* GIVEN- PLHSAVE5 = AMOUNT OF SPACE TO BE USED BY INSERT        */
*   /* PLHSAVE6 = AMOUNT OF SPACE NEEDED FOR INSERT TO BE THE LAST   */
*   /* ENTRY IN THE RECORD. OUTPUT - R15 = 0 IF REQUIRED SPACE EXISTS*/
*   /* R15 = 8 IF REQUIRED SPACE DOES NOT EXIST RESTRICTIONS - THIS  */
*   /* ROUTINE MUST NOT ALTER THE CONTENTS OF RWORK1, RPARM1, OR     */
*   /* PLHSAVE1 THRU PLHSAVE6.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0564
*IDAIXCHK:                                                         0564
*   ENTRY;                          /* CHECK SPACE ENTRY             */
@EP00564 DS    0H                                                  0565
*   RFY                                                            0565
*    (RWORK0,                                                      0565
*     RWORK1,                                                      0565
*     RWORK2,                                                      0565
*     RWORK3,                                                      0565
*     RWORK4,                                                      0565
*     R14,                                                         0565
*     RWORK5) RSTD;                                                0565
*   RFY                                                            0566
*     IDAIXH BASED(RPARM1);                                        0566
*   RWORK2=IXHLL;                   /* OFFSET TO END OF RECORD       */
         LH    RWORK2,IXHLL(,RPARM1)                               0567
         N     RWORK2,@CF01078                                     0567
*   RWORK3=IXHSEO;                  /* OFFSET TO 1ST SECTION         */
         LH    RWORK3,IXHSEO(,RPARM1)                              0568
*   RWORK5=ZERO;                    /* CLEAR INSERT FLAG             */
         SLR   RWORK5,RWORK5                                       0569
*   RFY                                                            0570
*     R15 RSTD;                     /*                               */
*   IF IXHLV=ONE THEN               /* SEQUENCE SET                  */
         CLI   IXHLV(RPARM1),1                                     0571
         BNE   @RF00571                                            0571
*     DO;                           /* YES. ADJUST FOR PTRS          */
*       RWORK4=AMBLDTA;             /* LOCATE DATA AMB               */
         L     @10,RPLDACB(,RRPL)                                  0573
         L     @10,ACBAMBL(,@10)                                   0573
         L     RWORK4,AMBLDTA(,@10)                                0573
*       R15=RWORK4->AMBDSB->AMDCIPCA;/* CI/CA                        */
         L     @10,AMBDSB(,RWORK4)                                 0574
         LH    R15,AMDCIPCA(,@10)                                  0574
*       IF IXHPTLS>ONE THEN         /* TWO BYTE PTRS                 */
         CLI   IXHPTLS(RPARM1),1                                   0575
         BNH   @RF00575                                            0575
*         R15=R15+R15;              /* YES. DOUBLE                   */
         ALR   R15,R15                                             0576
*       R15=R15+LENGTH(IDAIXH);     /* ADD ON HEADER                 */
@RF00575 AL    R15,@CF00083                                        0577
*     END;                          /* END SEQ SET                   */
*   ELSE                            /* NOT SEQ SET                   */
*     R15=LENGTH(IDAIXH);           /* ONLY HEADER                   */
         B     @RC00571                                            0579
@RF00571 LA    R15,24                                              0579
*   DO WHILE RWORK2=>IXHLEO;        /* LOOP THRU ALL ENTRIES         */
@RC00571 B     @DE00580                                            0580
@DL00580 DS    0H                                                  0581
*     RWORK4=IXHFLPLN;              /* LENGTH OF F,L,PTR             */
         SLR   RWORK4,RWORK4                                       0581
         IC    RWORK4,IXHFLPLN(,RPARM1)                            0581
*     RWORK2=RWORK2-RWORK4;         /* BACK UP TO F BYTE             */
         SLR   RWORK2,RWORK4                                       0582
*     IF IXHLV=ONE THEN             /* SEQUENCE SET                  */
         CLI   IXHLV(RPARM1),1                                     0583
         BNE   @RF00583                                            0583
*       DO;                         /* YES                           */
*         RWORK4=RWORK4-LENGTH(IBFLPF)-LENGTH(IBFLPL);/* PTR L       */
         BCTR  RWORK4,0                                            0585
         BCTR  RWORK4,0                                            0585
*         R15=R15-RWORK4;           /* ADJUST FOR MORE FREESP        */
         SLR   R15,RWORK4                                          0586
*       END;                        /* END SS ADJUSTMENT             */
*     IF RWORK2=RBUFC THEN          /* INSERT POINT                  */
@RF00583 CLR   RWORK2,RBUFC                                        0588
         BNE   @RF00588                                            0588
*       DO;                         /* YES                           */
*         RWORK4=RWORK2-PLHSAVE6;   /* ALLOW FOR GROWTH              */
         LR    RWORK4,RWORK2                                       0590
         SL    RWORK4,PLHSAVE6(,RPLH)                              0590
*         IF RWORK4<R15 THEN        /* ROOM AVAILABLE                */
         CR    RWORK4,R15                                          0591
         BNL   @RF00591                                            0591
*           DO;                     /* NO                            */
*             R15=IMWNOFIT;         /* NOT ENOUGH SPACE              */
         LA    R15,8                                               0593
*             RETURN;               /* RETURN TO CALLER              */
         B     @EL00001                                            0594
*           END;                    /* END NOT ENOUGH                */
*         R15=R15+PLHSAVE6;         /* REDUCE FREESP FOR INSRT       */
@RF00591 AL    R15,PLHSAVE6(,RPLH)                                 0596
*         RWORK5=ONE;               /* SHOW INSERT POINT             */
         LA    RWORK5,1                                            0597
*       END;                        /* END INSERT POINT              */
*     RWORK4=RPARM1+RWORK2;         /* SET POINTER                   */
@RF00588 LR    RWORK4,RPARM1                                       0599
         ALR   RWORK4,RWORK2                                       0599
*     RWORK0=RWORK4->IBFLPF;        /* PICK UP F FIELD               */
         SLR   RWORK0,RWORK0                                       0600
         IC    RWORK0,IBFLPF(,RWORK4)                              0600
*     IF RWORK0^=AMDKEYLN THEN      /* NON-LAST SPANNED RECORD     0601
*                                      SEGMENT               @ZA02289*/
         L     @10,AMBDSB(,RAMB)                                   0601
         LH    @10,AMDKEYLN(,@10)                                  0601
         CLR   RWORK0,@10                                          0601
         BE    @RF00601                                            0601
*       DO;                         /* NO                    @ZA02289*/
*         RWORK2=RWORK2-RWORK4->IBFLPL;/* BACK UP OVER KEY           */
         SLR   @10,@10                                             0603
         IC    @10,IBFLPL(,RWORK4)                                 0603
         SLR   RWORK2,@10                                          0603
*         IF RWORK2=<RWORK3 THEN    /* AT SECTION BOUNDARY           */
         CLR   RWORK2,RWORK3                                       0604
         BH    @RF00604                                            0604
*           DO;                     /* YES.                          */
*             RWORK2=RWORK2-LENGTH(IXSELL);/* BACK OVER LL FIELD     */
         BCTR  RWORK2,0                                            0606
         BCTR  RWORK2,0                                            0606
*             RWORK4=RPARM1+RWORK2; /* SET POINTER                   */
         LR    RWORK4,RPARM1                                       0607
         ALR   RWORK4,RWORK2                                       0607
*             RWORK3=RWORK3-RWORK4->IXSELL;/* ADJUST TO NEXT SECT    */
         SLR   @10,@10                                             0608
         ICM   @10,3,IXSELL(RWORK4)                                0608
         SLR   RWORK3,@10                                          0608
*           END;                    /* END SECTION BOUNDARY          */
*         ELSE                      /* NOT SECTION                   */
*           RWORK0=RWORK0+LENGTH(IXSELL);/* ADD LL FIELD LENGTH      */
         B     @RC00604                                            0610
@RF00604 AL    RWORK0,@CF00155                                     0610
*         RWORK4=RWORK2-RWORK0;     /* LEFTMOST OFFSET NEEDED        */
@RC00604 LR    RWORK4,RWORK2                                       0611
         SLR   RWORK4,RWORK0                                       0611
*         IF RWORK4<R15 THEN        /* OFFSET < FREESPACE            */
         CR    RWORK4,R15                                          0612
         BNL   @RF00612                                            0612
*           DO;                     /* YES.                          */
*             R15=IMWNOFIT;         /* NOT ENOUGH SPACE LEFT         */
         LA    R15,8                                               0614
*             RETURN;               /* RETURN TO CALLER              */
         B     @EL00001                                            0615
*           END;                    /* END NOT ENOUGH SPACE          */
*         IF RWORK5^=ZERO THEN      /* INSERT POINT                  */
@RF00612 LTR   RWORK5,RWORK5                                       0617
         BZ    @RF00617                                            0617
*           DO;                     /* YES                           */
*             R15=R15-PLHSAVE6+PLHSAVE5;/* READJUST SPACE            */
         LR    @10,R15                                             0619
         SL    @10,PLHSAVE6(,RPLH)                                 0619
         AL    @10,PLHSAVE5(,RPLH)                                 0619
         LR    R15,@10                                             0619
*             RWORK5=ZERO;          /* CLEAR FLAG                    */
         SLR   RWORK5,RWORK5                                       0620
*           END;                    /*                               */
*       END;                        /*                       @ZA02289*/
@RF00617 DS    0H                                                  0623
*   END;                            /* END SCAN LOOP                 */
@RF00601 DS    0H                                                  0623
@DE00580 LH    @10,IXHLEO(,RPARM1)                                 0623
         CLR   RWORK2,@10                                          0623
         BNL   @DL00580                                            0623
*   R15=ZERO;                       /* ENOUGH SPACE EXISTS           */
         SLR   R15,R15                                             0624
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00001                                            0625
*   RFY                                                            0626
*    (RWORK0,                                                      0626
*     RWORK1,                                                      0626
*     RWORK2,                                                      0626
*     RWORK3,                                                      0626
*     RWORK4,                                                      0626
*     RWORK5,                                                      0626
*     R14,                                                         0626
*     R15) UNRSTD;                                                 0626
*                                                                  0627
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPRS SUBROUTINE DETERMINES THE LENGTH OF AN INDEX AFTER THE */
*   /* FRONT COMPRESSION HAS BEEN DETERMINED                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0627
*   RESPECIFY                                                      0627
*    (RWORK1,                                                      0627
*     RWORK2,                                                      0627
*     RWORK3,                                                      0627
*     RWORK4,                                                      0627
*     R14) RSTD;                                                   0627
*COMPRS:                            /*                               */
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */
COMPRS   DS    0H                                                  0629
*   RPARM1=AMDKEYLN;                /* KEY LENGTH                    */
         L     @15,AMBDSB(,RAMB)                                   0629
         LH    RPARM1,AMDKEYLN(,@15)                               0629
*   RBUFC=IMWIKEYP;                 /* POINT TO INSERT KEY           */
         L     @15,AMBIWA(,RAMB)                                   0630
         L     @15,ICWCHN(,@15)                                    0630
         L     RBUFC,IMWIKEYP(,@15)                                0630
*   RWORK1=RPARM1;                  /* CLCL LENGTH                   */
         LR    RWORK1,RPARM1                                       0631
*   RWORK2=IMWXKEYP;                /* POINT TO NEXT KEY             */
         L     RWORK2,IMWXKEYP(,@15)                               0632
*   RWORK3=RPARM1;                  /* CLCL LENGTH                   */
         LR    RWORK3,RPARM1                                       0633
*   GEN(CLCL  RBUFC,RWORK2);        /* LOCATE DIFFER POSITION        */
         CLCL  RBUFC,RWORK2
*   RWORK1=RPARM1-RWORK1+ONE;       /* REQUIRED KEY LENGTH           */
         LR    @15,RPARM1                                          0635
         SLR   @15,RWORK1                                          0635
         AL    @15,@CF00053                                        0635
         LR    RWORK1,@15                                          0635
*   IF RWORK1<IXSPEC THEN           /* REQUIRED LESS THAN F          */
         L     @15,AMBIWA(,RAMB)                                   0636
         L     @15,ICWCHN(,@15)                                    0636
         L     @10,IMWIXSP(,@15)                                   0636
         SLR   @09,@09                                             0636
         IC    @09,IXSPEC(,@10)                                    0636
         CR    RWORK1,@09                                          0636
         BNL   @RF00636                                            0636
*     IMWIEL=ZERO;                  /* NO L BYTES NEEDED             */
         MVI   IMWIEL(@15),X'00'                                   0637
*   ELSE                            /* NEED TO SAVE ALL BYTES        */
*     IMWIEL=RWORK1-IXSPEC;         /* BETWEEN F AND DIFFER          */
         B     @RC00636                                            0638
@RF00636 L     @15,AMBIWA(,RAMB)                                   0638
         L     @15,ICWCHN(,@15)                                    0638
         L     @10,IMWIXSP(,@15)                                   0638
         LR    @09,RWORK1                                          0638
         SLR   @00,@00                                             0638
         IC    @00,IXSPEC(,@10)                                    0638
         SLR   @09,@00                                             0638
         STC   @09,IMWIEL(,@15)                                    0638
*   END COMPRS;                     /*                               */
@EL00002 DS    0H                                                  0639
@EF00002 DS    0H                                                  0639
@ER00002 BR    @14                                                 0639
*   RESPECIFY                                                      0640
*    (RWORK1,                                                      0640
*     RWORK2,                                                      0640
*     RWORK3,                                                      0640
*     RWORK4,                                                      0640
*     R14) UNRSTD;                                                 0640
*   GEN;                                                           0641
SETPTR   STCM  RWORK2,@00,@00(RWORK1)      /*                        */
GETPTR   ICM   RWORK4,@00,@00(RWORK1)      /*                @ZA02289*/
STOREPTR STCM  RWORK4,@00,@00(RWORK2)      /*                @ZA02289*/
*   GEN(IDAPATCH);                                                 0642
         IDAPATCH
*   END IDA019RH                                                   0643
*                                                                  0643
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */
*/*%INCLUDE SYSLIB  (IDADIWA )                                       */
*/*%INCLUDE SYSLIB  (IDAICWA )                                       */
*/*%INCLUDE SYSLIB  (IDAIMWA )                                       */
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */
*/*%INCLUDE SYSLIB  (IDAIXSPL)                                       */
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */
*/*%INCLUDE SYSLIB  (IDAIRD  )                                       */
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */
*                                                                  0643
*       ;                                                          0643
         B     @EL00001                                            0643
@DATA    DS    0H
@SC01071 CLC   KEY(0,RWORK1),KEY(RWORK2)
@SC01073 CLC   KEY(0,RPARM1),KEY(RWORK4)
@SM01075 MVC   IMWKEY1(0,@08),KEY(@15)
@DATD    DSECT
         DS    0F
IDA019RH CSECT
         DS    0F
@CF00059 DC    F'0'
@CF00053 DC    F'1'
@CF00155 DC    F'2'
@CF00157 DC    F'3'
@CF00067 DC    F'4'
@CF00062 DC    F'8'
@CF00083 DC    F'24'
@CF01078 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
IDA019RH CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA01053 DC    A(IDAIVIXB)
@CA01049 DC    A(IDAIXCHK)
@CV01003 DC    V(IDAWRBFR)
@CV01004 DC    V(IDA019RC)
         DS    0D
HWORD4   DC    H'4'
@DATD    DSECT
*                                                          /*@X04SVLC*/
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/
RDFLEN   EQU   3                        LENGTH OF RDF
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDA019RH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RWORK0   EQU   @00
RRPL     EQU   @01
RPLH     EQU   @02
RAMB     EQU   @03
RBUFC    EQU   @04
RWORK1   EQU   @05
RWORK2   EQU   @06
RWORK3   EQU   @07
RWORK4   EQU   @08
RWORK5   EQU   @09
RPARM1   EQU   @12
R14      EQU   @14
R15      EQU   @15
R1       EQU   @01
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLDACB  EQU   RPLCOMN+24
RPLAREA  EQU   RPLCOMN+32
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLSEQ   EQU   RPLOPT1
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMBL  EQU   0
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLSHAR EQU   IDAAMBL+33
AMBLFLG1 EQU   IDAAMBL+35
AMBLFLG2 EQU   IDAAMBL+36
AMBLDTA  EQU   IDAAMBL+52
AMBLIX   EQU   IDAAMBL+56
IDAAMB   EQU   0
AMBBUFC  EQU   IDAAMB+8
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBFLG1  EQU   IDAAMB+25
AMBDSORG EQU   IDAAMB+26
AMBIOBAD EQU   IDAAMB+28
AMBINFL  EQU   IDAAMB+42
AMBDEBPT EQU   IDAAMB+44
AMBOFLGS EQU   IDAAMB+48
AMBFLG2  EQU   IDAAMB+49
AMBEOVPT EQU   IDAAMB+56
AMBIWA   EQU   IDAAMB+64
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
AMBLSR   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
IDAPLHDR EQU   0
IDAPLH   EQU   0
PLHFLG1  EQU   IDAPLH+2
PLHFLG2  EQU   IDAPLH+3
PLHADDTE EQU   PLHFLG2
PLHEFLGS EQU   IDAPLH+4
PLHFLG3  EQU   IDAPLH+6
PLHAFLGS EQU   IDAPLH+7
PLHCRBA  EQU   IDAPLH+28
PLHJORBA EQU   PLHCRBA
PLHJCODE EQU   IDAPLH+40
PLHDBUFC EQU   IDAPLH+52
PLHRECP  EQU   IDAPLH+60
PLHFSP   EQU   IDAPLH+64
PLHDIOB  EQU   IDAPLH+76
PLHSAVE1 EQU   IDAPLH+84
PLHSAVE2 EQU   IDAPLH+88
PLHSAVE3 EQU   IDAPLH+92
PLHSAVE5 EQU   IDAPLH+100
PLHSAVE6 EQU   IDAPLH+104
PLHRETO  EQU   IDAPLH+116
PLHRET1  EQU   IDAPLH+120
PLHEOVPT EQU   IDAPLH+180
PLHIBUFC EQU   IDAPLH+188
PLHIXSPL EQU   IDAPLH+200
PLHSSRBA EQU   PLHIXSPL
PLHWAX   EQU   IDAPLH+232
PLHKEYPT EQU   IDAPLH+248
PLHEND   EQU   IDAPLH+280
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDCIPCA EQU   IDAAMDSB+12
AMDCINV  EQU   IDAAMDSB+20
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
IDADIWA  EQU   0
DIWFLG1  EQU   IDADIWA+4
DIWFLG2  EQU   IDADIWA+5
DIWBUFC  EQU   IDADIWA+20
DIWSAVE  EQU   IDADIWA+28
IDAICWA  EQU   0
ICWFLG1  EQU   IDAICWA+1
ICWCHN   EQU   IDAICWA+4
IDAIMWA  EQU   0
IMWFLAGS EQU   IDAIMWA+1
IMWBSE   EQU   IMWFLAGS
IMWIXSP  EQU   IDAIMWA+4
IMWISWKA EQU   IDAIMWA+8
IMWXKEYP EQU   IDAIMWA+40
IMWIKEYP EQU   IDAIMWA+44
IMWXPTR  EQU   IDAIMWA+48
IMWIPTR  EQU   IDAIMWA+52
IMWLBUFC EQU   IDAIMWA+56
IMWBUFP  EQU   IDAIMWA+60
IMWFGAIN EQU   IDAIMWA+64
IMWIEL   EQU   IDAIMWA+65
IMWKEY1  EQU   IDAIMWA+76
IDABUFDR EQU   0
BUFDRCIX EQU   IDABUFDR+9
BUFDRFLG EQU   IDABUFDR+11
BUFDBUFC EQU   IDABUFDR+12
IDABUFC  EQU   0
BUFCAVL  EQU   IDABUFC
BUFCFLG1 EQU   IDABUFC+1
BUFCVAL  EQU   BUFCFLG1
BUFCIOFL EQU   IDABUFC+2
BUFCMW   EQU   BUFCIOFL
BUFCRRD  EQU   BUFCIOFL
BUFCFLG2 EQU   IDABUFC+3
BUFCPLH  EQU   IDABUFC+4
BUFCDDDD EQU   IDABUFC+8
BUFCORBA EQU   IDABUFC+12
BUFCBAD  EQU   IDABUFC+20
BUFCINV  EQU   IDABUFC+28
BUFCHAIN EQU   IDABUFC+48
IDAIXSPL EQU   0
IXSBUFC  EQU   IDAIXSPL+4
IXSNOSR  EQU   IDAIXSPL+16
IXSBFLG  EQU   IDAIXSPL+17
IXSPEC   EQU   IDAIXSPL+19
IXSHEP   EQU   IDAIXSPL+20
IXSSEP   EQU   IDAIXSPL+24
IXSLEP   EQU   IDAIXSPL+28
IDACIDF  EQU   0
CIDFOSET EQU   IDACIDF
CIDFLL   EQU   IDACIDF+2
IDAIXH   EQU   0
IXHLL    EQU   IDAIXH
IXHFLPLN EQU   IDAIXH+2
IXHPTLS  EQU   IDAIXH+3
IXHBRBA  EQU   IDAIXH+4
IXHLV    EQU   IDAIXH+16
IXHFSO   EQU   IDAIXH+18
IXHLEO   EQU   IDAIXH+20
IXHSEO   EQU   IDAIXH+22
IDAIBFLP EQU   0
IBFLPF   EQU   IDAIBFLP
IBFLPL   EQU   IDAIBFLP+1
IBFLP3   EQU   IDAIBFLP+2
IBFLP2   EQU   IBFLP3
IDASELL  EQU   0
IXSELL   EQU   IDASELL
IDAIXK   EQU   0
IDARDF   EQU   0
RDFRBYTE EQU   IDARDF
RDFSEG   EQU   RDFRBYTE
RDFREPL  EQU   RDFRBYTE
RDFLL    EQU   IDARDF+1
IDADATA  EQU   0
IDAKEY   EQU   0
KEY      EQU   IDAKEY
ICWKEY2  EQU   0
ICWKEY3  EQU   0
PLHKEY   EQU   0
PLHPDL   EQU   0
PLHPDLE  EQU   0
PLHRRN   EQU   0
PLHEXTEN EQU   PLHEND
PLHBMWRK EQU   PLHEXTEN+5
BUFCRSC1 EQU   BUFCAVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PLHBMSV5 EQU   PLHEXTEN+24
PLHBMSV4 EQU   PLHEXTEN+20
PLHBMSV3 EQU   PLHEXTEN+16
PLHBMSV2 EQU   PLHEXTEN+12
PLHBMSV1 EQU   PLHEXTEN+8
PLHRDCNT EQU   PLHEXTEN+6
PLHBMSOV EQU   PLHBMWRK
PLHBEUC  EQU   PLHBMWRK
PLHBMRDF EQU   PLHBMWRK
@NM00040 EQU   PLHEXTEN+4
PLHRESR1 EQU   PLHEXTEN
AMDATA   EQU   IDADATA
RDFEMPTY EQU   RDFRBYTE
RDF1ST   EQU   RDFSEG
RDFNOT1  EQU   RDFSEG
RDFCTNU  EQU   RDFRBYTE
RDFTYPE  EQU   RDFRBYTE
IXKEY    EQU   IDAIXK
IBFLP1   EQU   IBFLP2
IXHFLGS  EQU   IDAIXH+17
IXHXX    EQU   IDAIXH+12
IXHHP    EQU   IDAIXH+8
@NM00060 EQU   CIDFLL
CIDFBUSY EQU   CIDFLL
IXSEKON  EQU   IDAIXSPL+18
@NM00059 EQU   IXSBFLG
IXSLELV  EQU   IXSBFLG
IXSSSRH  EQU   IXSBFLG
IXSKLEN  EQU   IDAIXSPL+14
IXSILN   EQU   IDAIXSPL+13
IXSTLN   EQU   IDAIXSPL+12
IXSARG   EQU   IDAIXSPL+8
IXSSTRBA EQU   IDAIXSPL
BUFCEND  EQU   IDABUFC+64
BUFCUCDN EQU   IDABUFC+60
BUFCUCUP EQU   IDABUFC+56
BUFCMDBT EQU   IDABUFC+52
BUFXORBA EQU   IDABUFC+44
BUFXIRBA EQU   IDABUFC+40
BUFCNXT2 EQU   IDABUFC+37
BUFCIDXL EQU   IDABUFC+36
BUFCDSPC EQU   IDABUFC+32
BUFCWLEN EQU   BUFCINV
BUFCNXT1 EQU   IDABUFC+24
BUFCCPA  EQU   IDABUFC+16
BUFCAMB  EQU   BUFCPLH
@NM00058 EQU   BUFCFLG2
BUFCEOD  EQU   BUFCFLG2
BUFCBSYW EQU   BUFCFLG2
BUFCBSYR EQU   BUFCFLG2
BUFCNLAS EQU   BUFCFLG2
BUFCXDDR EQU   BUFCFLG2
BUFCFIX  EQU   BUFCIOFL
BUFCPFCP EQU   BUFCIOFL
BUFCXEDB EQU   BUFCIOFL
BUFCWC   EQU   BUFCIOFL
BUFCREAL EQU   BUFCIOFL
BUFCFMT  EQU   BUFCIOFL
BUFCEPT  EQU   BUFCFLG1
BUFCEXC  EQU   BUFCFLG1
BUFCER2  EQU   BUFCFLG1
BUFCER1  EQU   BUFCFLG1
BUFCINS  EQU   BUFCFLG1
BUFCSEG  EQU   BUFCFLG1
BUFCUPG  EQU   BUFCFLG1
BUFCUCNT EQU   BUFCAVL
@NM00057 EQU   IDABUFDR+16
@NM00056 EQU   BUFDRFLG
BUFDRAVL EQU   BUFDRFLG
BUFDRREL EQU   BUFDRFLG
BUFDRTSB EQU   IDABUFDR+10
BUFDRMAX EQU   BUFDRCIX
BUFDRPFN EQU   IDABUFDR+8
BUFDRPFB EQU   IDABUFDR+4
BUFDRLEN EQU   IDABUFDR+2
BUFDRNO  EQU   IDABUFDR+1
BUFDRID  EQU   IDABUFDR
@NM00055 EQU   IDAIMWA+72
IMWNSOFF EQU   IDAIMWA+70
IMWCIMVN EQU   IDAIMWA+68
@NM00054 EQU   IDAIMWA+67
IMWSVIEL EQU   IDAIMWA+66
IMWLEN   EQU   IDAIMWA+2
IMWRIPL  EQU   IMWFLAGS
IMWNEWHL EQU   IMWFLAGS
IMWID    EQU   IDAIMWA
ICWKEY1  EQU   IDAICWA+60
ICWCERP  EQU   IDAICWA+59
ICWCEL   EQU   IDAICWA+58
ICWCEF   EQU   IDAICWA+57
ICWCER   EQU   IDAICWA+56
ICWPTL   EQU   IDAICWA+55
ICWREQ   EQU   IDAICWA+54
ICWCRSEG EQU   IDAICWA+52
ICWNOSEG EQU   IDAICWA+50
ICWNEST  EQU   IDAICWA+48
ICWKEY3L EQU   IDAICWA+46
ICWKEY2L EQU   IDAICWA+44
ICWKEY1L EQU   IDAICWA+42
ICWLN    EQU   IDAICWA+40
ICWARDBP EQU   IDAICWA+36
ICWTPTR  EQU   IDAICWA+32
ICWTBASE EQU   IDAICWA+28
ICWADD   EQU   IDAICWA+24
ICWSCNT  EQU   IDAICWA+22
ICWPSEO  EQU   IDAICWA+20
ICWPRBA  EQU   IDAICWA+16
ICWCRBA  EQU   IDAICWA+12
ICWBUFC  EQU   IDAICWA+8
ICWLEN   EQU   IDAICWA+2
ICWENDRQ EQU   ICWFLG1
ICWSPLIT EQU   ICWFLG1
ICWKRDS  EQU   ICWFLG1
ICWVNE   EQU   ICWFLG1
ICWVSE   EQU   ICWFLG1
ICWRBAOK EQU   ICWFLG1
ICWWAGM  EQU   ICWFLG1
ICWWNF   EQU   ICWFLG1
ICWID    EQU   IDAICWA
@NM00053 EQU   IDADIWA+92
@NM00052 EQU   IDADIWA+88
@NM00051 EQU   IDADIWA+84
@NM00050 EQU   IDADIWA+80
@NM00049 EQU   IDADIWA+76
@NM00048 EQU   IDADIWA+72
@NM00047 EQU   IDADIWA+68
@NM00046 EQU   IDADIWA+64
@NM00045 EQU   IDADIWA+60
@NM00044 EQU   IDADIWA+56
DIWINRBA EQU   IDADIWA+52
DIWRKCT  EQU   IDADIWA+48
DIWSAVE5 EQU   DIWSAVE+16
DIWSAVE4 EQU   DIWSAVE+12
DIWSAVE3 EQU   DIWSAVE+8
DIWSAVE2 EQU   DIWSAVE+4
DIWSAVE1 EQU   DIWSAVE
DIWSPLTP EQU   IDADIWA+24
DIWPLH   EQU   IDADIWA+16
DIWHRBA  EQU   IDADIWA+12
DIWLRBA  EQU   IDADIWA+8
@NM00043 EQU   IDADIWA+6
DIWFSPF  EQU   DIWFLG2
DIW1ST   EQU   DIWFLG1
DIWNOT1  EQU   DIWFLG1
DIWSHIFT EQU   DIWFLG1
DIWGSPC  EQU   DIWFLG1
DIWEOKR  EQU   DIWFLG1
DIWPFERR EQU   DIWFLG1
DIWCISPL EQU   DIWFLG1
DIWCAS   EQU   DIWFLG1
DIWLEN   EQU   IDADIWA+2
DIWATV   EQU   IDADIWA+1
DIWID    EQU   IDADIWA
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00042 EQU   IDAAMDSB+41
@NM00041 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
PLHERRET EQU   IDAPLH+276
PLHASCB  EQU   IDAPLH+272
PLHECB   EQU   IDAPLH+268
@NM00039 EQU   IDAPLH+265
PLHDRMSK EQU   IDAPLH+264
PLHR13   EQU   IDAPLH+260
PLHPARM1 EQU   IDAPLH+256
PLHDRRSC EQU   IDAPLH+252
PLHSLRBA EQU   IDAPLH+244
PLHSRCSG EQU   IDAPLH+242
PLHNOSEG EQU   IDAPLH+240
PLHLLOR  EQU   IDAPLH+236
PLHXPLH  EQU   PLHWAX
@NM00038 EQU   PLHIXSPL+8
PLHIXBFC EQU   PLHIXSPL+4
PLHHIREC EQU   PLHSSRBA
PLHISPLP EQU   IDAPLH+196
PLHRBUFC EQU   IDAPLH+192
PLHNRBA  EQU   IDAPLH+184
PLHDDDD  EQU   PLHEOVPT
PLHAR14  EQU   IDAPLH+176
@NM00037 EQU   IDAPLH+172
@NM00036 EQU   IDAPLH+168
PLHASAVE EQU   IDAPLH+164
PLHRETOS EQU   IDAPLH+118
PLHCHAIN EQU   IDAPLH+112
PLHAMB   EQU   IDAPLH+108
PLHSAVE4 EQU   IDAPLH+96
PLHARET  EQU   IDAPLH+80
PLHIIOB  EQU   PLHDIOB
PLHSRSID EQU   IDAPLH+74
PLHRDFC  EQU   IDAPLH+72
PLHRDFP  EQU   IDAPLH+68
PLHNBUFC EQU   IDAPLH+56
PLHLRECL EQU   IDAPLH+48
PLHARDB  EQU   IDAPLH+44
@NM00035 EQU   IDAPLH+43
PLHEOVR  EQU   IDAPLH+42
PLHRCODE EQU   IDAPLH+41
PLHUCODE EQU   PLHJCODE
PLHJNRBA EQU   IDAPLH+36
PLHJRNLL EQU   IDAPLH+32
PLHUPECB EQU   PLHJORBA
PLHDSIDA EQU   IDAPLH+24
PLHCRPL  EQU   IDAPLH+20
PLHMRPL  EQU   IDAPLH+16
PLHBFRNO EQU   IDAPLH+15
PLHFRCNT EQU   IDAPLH+14
PLHRMIN  EQU   IDAPLH+13
PLHDSTYP EQU   IDAPLH+12
PLHACB   EQU   IDAPLH+8
PLHRAE   EQU   PLHAFLGS
PLHRABWD EQU   PLHAFLGS
PLHIOSID EQU   PLHAFLGS
PLHDBDC  EQU   PLHAFLGS
PLHVAMB  EQU   PLHAFLGS
PLHIOSRQ EQU   PLHAFLGS
PLHDRLM  EQU   PLHAFLGS
PLHEOVDF EQU   PLHFLG3
PLHRVRS  EQU   PLHFLG3
PLHBWD   EQU   PLHFLG3
PLHSLVLD EQU   PLHFLG3
PLHRAHD  EQU   PLHFLG3
PLHSRBSG EQU   PLHFLG3
@NM00034 EQU   PLHEFLGS+1
PLHRSTRT EQU   PLHEFLGS+1
PLHDSCAN EQU   PLHEFLGS
PLHINVAL EQU   PLHEFLGS
PLHEODX  EQU   PLHEFLGS
PLHNOADV EQU   PLHEFLGS
PLHSRINV EQU   PLHEFLGS
PLHSKPER EQU   PLHEFLGS
PLH1ST   EQU   PLHEFLGS
PLHNOSPC EQU   PLHEFLGS
PLHIWAIT EQU   PLHFLG2
PLHSVADV EQU   PLHFLG2
PLHCIINS EQU   PLHFLG2
PLHKRE   EQU   PLHFLG2
PLHKEYMD EQU   PLHFLG2
PLHSQINS EQU   PLHFLG2
PLHUPD   EQU   PLHFLG2
@NM00033 EQU   PLHFLG1
PLHDRPND EQU   PLHFLG1
PLHASYRQ EQU   PLHFLG1
PLHRDEXC EQU   PLHFLG1
PLHSSR   EQU   PLHFLG1
PLHASKBF EQU   PLHFLG1
PLHENDRQ EQU   PLHFLG1
PLHEOVW  EQU   PLHFLG1
PLHATV   EQU   IDAPLH+1
PLHAVL   EQU   IDAPLH
PLHIOSDQ EQU   IDAPLHDR+12
PLHDRCUR EQU   IDAPLHDR+10
PLHDRMAX EQU   IDAPLHDR+8
PLHDRREQ EQU   IDAPLHDR+4
PLHELTH  EQU   IDAPLHDR+2
PLHCNT   EQU   IDAPLHDR+1
PLHID    EQU   IDAPLHDR
AMBTRACE EQU   IDAAMB+120
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBCPA   EQU   IDAAMB+92
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00032 EQU   AMBCSWD1+1
@NM00031 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
@NM00030 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
AMBPAMBL EQU   IDAAMB+76
AMBPIXP  EQU   IDAAMB+72
@NM00029 EQU   IDAAMB+68
AMBWKA   EQU   IDAAMB+60
AMBAMBXN EQU   AMBEOVPT
AMBEDB   EQU   IDAAMB+52
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
AMBEXFG  EQU   AMBOFLGS
@NM00028 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00027 EQU   AMBOFLGS
AMBDEBAD EQU   AMBDEBPT+1
AMBIFLGS EQU   AMBDEBPT
AMBAMETH EQU   IDAAMB+43
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00026 EQU   AMBINFL
@NM00025 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00024 EQU   IDAAMB+38
AMBDDSN  EQU   IDAAMB+35
AMBCDSN  EQU   IDAAMB+32
AMBIOMB  EQU   AMBIOBAD
@NM00023 EQU   AMBDSORG+1
AMBDORGA EQU   AMBDSORG+1
@NM00022 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBTYPE  EQU   AMBFLG1
AMBCREAT EQU   AMBFLG1
@NM00021 EQU   AMBFLG0
AMBPSDS  EQU   AMBFLG0
AMBCACB  EQU   IDAAMB+16
AMBPH    EQU   IDAAMB+12
AMBLINK  EQU   IDAAMB+4
AMBLEN   EQU   IDAAMB+2
AMBRSC   EQU   IDAAMB+1
AMBID    EQU   IDAAMB
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00020 EQU   IDAAMBL+40
AMBLNUM  EQU   IDAAMBL+38
AMBLNST  EQU   IDAAMBL+37
@NM00019 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00018 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLCAT  EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLVVIC EQU   AMBLFLG1
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
AMBLLEN  EQU   IDAAMBL+34
@NM00017 EQU   AMBLSHAR
AMBLWRIT EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
AMBLID   EQU   IDAAMBL+32
@NM00016 EQU   IDAAMBL+31
@NM00015 EQU   AMBLTYPE
AMBLFIX  EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00014 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLACB  EQU   IDAAMBL+8
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00013 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBVVIC  EQU   ACBINFLG
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00012 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00011 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00010 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00009 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00008 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00007 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00006 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00005 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00004 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00003 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00002 EQU   RPLRBAR+3
@NM00001 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLRLEN  EQU   RPLCOMN+48
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLWAITX EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLTCBPT EQU   RPLCOMN+28
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLERREG EQU   RPLRTNCD
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00187 EQU   @RC00182
@RC00216 EQU   @RC00210
@RF00274 EQU   @RC00272
@RF00287 EQU   @RC00272
@RT00367 EQU   INOFIT
@RT00381 EQU   INOFIT
@RF00471 EQU   @RC00167
@RT00521 EQU   HLINSERT
@RT00534 EQU   @EL00001
@RC00636 EQU   @EL00002
@ENDDATA EQU   *
         END   IDA019RH,(C'PLS2021',0701,78172)

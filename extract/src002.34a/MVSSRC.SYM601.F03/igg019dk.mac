         TITLE 'IGG019DK -- SAM-SI BSAM PROCESSING MODULE.             *
                        '
IGG019DK CSECT                          START CSECT AT ZERO
        DC    A(ENTREAD)                READ ROUTINE ENTRY
        DC    A(ENTWRITE)               WRITE ROUTINE ENTRY
        DC    A(ENTCHECK)               CHECK ROUTINE ENTRY
        DC    A(ENTCNTRL)               CNTRL ROUTINE ENTRY
        DC    A(ENTNOTE)                NOTE ROUTINE ENTRY
        DC    A(ENTPOINT)               POINT ROUTINE ENTRY
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         USING  *,15
ENTREAD  SAVE  (14,12)
*       RDECB = R1;                     /* PTR TO DECB  (REG 7)     */
         LR    RDECB,R1                                            0117
*       RDCB  = DECDCBAD;               /* PTR TO DCB   (REG 8)     */
         L     RDCB,DECDCBAD(,RDECB)                               0118
*       R6 = 0;                         /* OFFSET INTO BRANCH TABLE */
         SLR   R6,R6                                               0119
*       GEN (B  BEGIN-ENTREAD(,R15));   /* BRANCH DOWN              */
*                                                                  0120
         B  BEGIN-ENTREAD(,R15)
*/*******************************************************************/
*                                                                  0121
*                                                                  0121
*ENTWRITE:                              /* ENTRY FOR WRITE MACRO    */
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */
ENTWRITE SAVE  (14,12)
*       RDECB = R1;                     /* PTR TO DECB  (REG 7)     */
         LR    RDECB,R1                                            0122
*       RDCB  = DECDCBAD;               /* PTR TO DCB   (REG 8)     */
         L     RDCB,DECDCBAD(,RDECB)                               0123
*       R6 = 4;                         /* OFFSET INTO BRANCH TABLE */
         LA    R6,4                                                0124
*       GEN  (B  BEGIN-ENTWRITE(,R15)); /* BRANCH DOWN              */
*                                                                  0125
         B  BEGIN-ENTWRITE(,R15)
*/*******************************************************************/
*                                                                  0126
*                                                                  0126
*ENTCHECK:                              /* ENTRY FOR CHECK MACRO    */
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */
ENTCHECK SAVE  (14,12)
*       RDECB = R1;                     /* PTR TO DECB  (REG 7)     */
         LR    RDECB,R1                                            0127
*       RDCB  = DECDCBAD;               /* PTR TO DCB   (REG 8)     */
         L     RDCB,DECDCBAD(,RDECB)                               0128
*       R6 = 8;                         /* OFFSET INTO BRANCH TABLE */
         LA    R6,8                                                0129
*       GEN (B  BEGIN-ENTCHECK(,R15));  /* BRANCH DOWN              */
*                                                                  0130
         B  BEGIN-ENTCHECK(,R15)
*/*******************************************************************/
*                                                                  0131
*                                                                  0131
*ENTCNTRL:                              /* ENTRY FOR CNTRL MACRO    */
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */
ENTCNTRL SAVE  (14,12)
*       RDCB = R1;                      /* PTR TO DCB (REG 8)       */
         LR    RDCB,R1                                             0132
*       R6 = 12;                        /* OFFSET INTO BRANCH TABLE */
         LA    R6,12                                               0133
*       GEN (B  BEGIN-ENTCNTRL(,R15));  /* BRANCH DOWN              */
*                                                                  0134
         B  BEGIN-ENTCNTRL(,R15)
*/*******************************************************************/
*                                                                  0135
*                                                                  0135
*ENTPOINT:                              /* ENTRY FOR POINT MACRO    */
*       GEN (B ENTNOTE-ENTPOINT(,R15)); /* BRANCH IF NOTE           */
ENTPOINT B ENTNOTE-ENTPOINT(,R15)
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */
         SAVE  (14,12)
*       RDCB = R1;                      /* PTR TO DCB (REG 8)       */
         LR    RDCB,R1                                             0137
*       R6 = 20;                        /* OFFSET INTO BRANCH TABLE */
         LA    R6,20                                               0138
*       GEN  (B  BEGIN-ENTPOINT(,R15)); /* BRANCH DOWN              */
*                                                                  0139
         B  BEGIN-ENTPOINT(,R15)
*/*******************************************************************/
*                                                                  0140
*                                                                  0140
*ENTNOTE:                               /* ENTRY FOR NOTE MACRO     */
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */
ENTNOTE  SAVE  (14,12)
*       RDCB = R1;                      /* PTR TO DCB (REG 8)       */
         LR    RDCB,R1                                             0141
*       R6 = 16;                        /* OFFSET INTO BRANCH TABLE */
*                                                                  0142
         LA    R6,16                                               0142
*/*******************************************************************/
*                                                                  0143
*                                                                  0143
*        GEN;                           /* GENERATE ASSEMBLY CODE   */
*                                                                  0143
BEGIN    BALR  R11,0                    LOAD R11 FOR BASE REG
         USING *,R11                    ASSIGN ASSEMBLER BASE REG
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0145
*                                                                  0145
*/*******************************************************************/
*                                                                  0145
*                                                                  0145
*        RCICB = DCBCICB;               /* PTR TO JCICB (REG 4)     */
*                                                                  0145
         L     RCICB,DCBCICB(,RDCB)                                0145
*/*******************************************************************/
*                                                                  0146
*                                                                  0146
*        GEN;                           /* GENERATE ASSEMBLY CODE   */
*                                                                  0146
         ST    R13,CIREGBC(,RCICB)      BACKCHAIN
         LA    R13,CIREGSAV(,RCICB)     ADDR THIS SAVEAREA
         USING @DATD-CIWK1,RCICB        ADDRESSIBILITY FOR TEMPS
*/*******************************************************************/
*                                                                  0147
*                                                                  0147
*        RRPL=ADDR(CIRPL);              /* PTR TO RPL (REG 2)       */
*                                                                  0147
         LA    RRPL,CIRPL(,RCICB)                                  0147
*/******BRANCH TO APPROPRIATE PROCESSING ROUTINE*********************/
*                                                                  0148
*                                                                  0148
*        R6 = R6+ADDR(BRNCHTAB);        /* POINT TO BRNCH TAB ENTRY */
         LA    @12,BRNCHTAB                                        0148
         ALR   R6,@12                                              0148
*        GEN (L    R6,0(,R6)                GET ADDRESS CORRECT RTN);
         L    R6,0(,R6)                GET ADDRESS CORRECT RTN
*        GEN (BR   R6                       GO TO CORRECT ROUTINE );
*                                                                  0150
*                                                                  0150
         BR   R6                       GO TO CORRECT ROUTINE
*        RELEASE (R6);                  /* RELEASE TO COMPILER      */
*                                                                  0151
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0153
*                                                                  0153
*/*******************************************************************/
*/*                                                                 */
*/*             JES TRANSLATOR BSAM READ ROUTINE                    */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0153
*                                                                  0153
*READRTN: ;                             /* ENTER READ ROUTINE       */
*                                                                  0153
*                                                                  0153
READRTN  DS    0H                                                  0154
*/*******************************************************************/
*                                                                  0154
*                                                                  0154
*        RPLDECB = RDECB;               /* RPL PTR TO DECB          */
*                                                                  0154
         ST    RDECB,RPLDECB(,RRPL)                                0154
*/*******************************************************************/
*                                                                  0155
*                                                                  0155
*        IF CIFPOINT = '0'B             /* TEST IF POINT ERROR      */
*          THEN DECSDECB = 0;           /* NO - ZERO OUT ENTIRE ECB */
         TM    CIFPOINT(RCICB),B'00000010'                         0155
         BNZ   @RF00155                                            0155
         SLR   @12,@12                                             0156
         ST    @12,DECSDECB(,RDECB)                                0156
*          ELSE DO;                     /* INVALID POINT REQUEST    */
         B     @RC00155                                            0157
@RF00155 DS    0H                                                  0158
*               DECSDECB = '41200000'X; /* SET ERROR CODE IN ECB    */
         MVC   DECSDECB(4,RDECB),@CF00501                          0158
*               GO TO EXIT;             /* RETURN TO CALLER         */
         B     EXIT                                                0159
*               END;                                               0160
*                                                                  0160
*/*******************************************************************/
*                                                                  0161
*                                                                  0161
*        RPLAREA = DECAREA;             /* INIT RPL I/O AREA FIELD  */
*                                                                  0161
@RC00155 L     @12,DECAREA(,RDECB)                                 0161
         ST    @12,RPLAREA(,RRPL)                                  0161
*/*******************************************************************/
*                                                                  0162
*                                                                  0162
*                                                                  0162
*        IF DCBRECFM(1:2) = '01'B       /* VARIABLE LENGTH RECORD   */
*          THEN DO;                     /* YES, DO FOLLOWING        */
         TM    DCBRECFM(RDCB),B'01000000'                          0162
         BNO   @RF00162                                            0162
         TM    DCBRECFM(RDCB),B'10000000'                          0162
         BNZ   @RF00162                                            0162
*            RPLAREA = RPLAREA + 8;     /* MOVE PTR > BDW & RDW     */
         AH    @12,@CH00059                                        0164
         ST    @12,RPLAREA(,RRPL)                                  0164
*            GO TO GTCNT;               /* GO TO SET I/O COUNTER    */
         B     GTCNT                                               0165
*               END;                    /* END OF DO GROUP          */
*          ELSE;                        /* NO, NOT VARIABLE LENGTH  */
*                                                                  0167
@RF00162 DS    0H                                                  0168
*/*******************************************************************/
*                                                                  0168
*                                                                  0168
*        IF DCBRECFM(4)   = '1'B        /* TEST IF BLOCKED RECORDS  */
*          THEN DO;                     /* YES - MULTIPLE RECORDS   */
         TM    DCBRECFM(RDCB),B'00010000'                          0168
         BNO   @RF00168                                            0168
*            CIIOCNT = DCBBLKSI/DCBLRECL;/* NUMBER OF BLOCKS        */
         SLR   @15,@15                                             0170
         ICM   @15,3,DCBBLKSI(RDCB)                                0170
         SLR   @14,@14                                             0170
         SLR   @12,@12                                             0170
         ICM   @12,3,DCBLRECL(RDCB)                                0170
         DR    @14,@12                                             0170
         ST    @15,CIIOCNT(,RCICB)                                 0170
*            CIWK1 = CIIOCNT;           /* FOR TEST FOR SHORT BLOCK */
         ST    @15,CIWK1(,RCICB)                                   0171
*            GO TO GETIT;               /* GO TO GET MACRO          */
         B     GETIT                                               0172
*               END;                    /* END OF DO GROUP          */
*          ELSE;                        /* UNBLOCKED RECORDS        */
*                                                                  0174
@RF00168 DS    0H                                                  0175
*/*******************************************************************/
*                                                                  0175
*                                                                  0175
*GTCNT:  CIIOCNT = 1;                   /* SET I/O COUNTER TO 1     */
*                                                                  0175
*                                                                  0175
GTCNT    MVC   CIIOCNT(4,RCICB),@CF00061                           0175
*/*******************************************************************/
*/*                                                                 */
*/*            ISSUE JES GET MACRO                                  */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0176
*                                                                  0176
*GETIT:  GEN  (GET   RPL=(RRPL));       /* JES GET MACRO            */
*                                                                  0176
GETIT    GET   RPL=(RRPL)
*/******AFTER RETURN FROM JES ***************************************/
*                                                                  0177
*                                                                  0177
*                                                                  0177
*        IF R15 = 0 THEN                /* NORMAL COMPLETION?  Y02082*/
         LTR   R15,R15                                             0177
         BNZ   @RF00177                                            0177
*          IF DCBRECFM(1:2) = '10'B     /* YES, BUT IF FIXED,  Y02082*/
*           & RPLRLEN ^= RPLBUFL THEN   /* AND NOT EXACT LEN,  Y02082*/
         TM    DCBRECFM(RDCB),B'10000000'                          0178
         BNO   @RF00178                                            0178
         TM    DCBRECFM(RDCB),B'01000000'                          0178
         BNZ   @RF00178                                            0178
         CLC   RPLRLEN(4,RRPL),RPLBUFL(RRPL)                       0178
         BE    @RF00178                                            0178
*            DO;                        /* TREAT AS LOGIC ERR. Y02082*/
*              RPLRTNCD = '08'X;        /* SET LOGIC ERROR     Y02082*/
         MVI   RPLRTNCD(RRPL),X'08'                                0180
*              RPLERRCD = RPLINBUF;     /* SET WRONG LEN CODE  Y02144*/
         MVC   RPLERRCD(1,RRPL),RPLINBUF                           0181
*            END;                       /*                     Y02082*/
*          ELSE                         /* NO ERROR CONDITION  Y02082*/
*            DO;                        /* ENCOUNTERED.        Y02082*/
         B     @RC00178                                            0183
@RF00178 DS    0H                                                  0184
*              DECBCODE = '7F'X;        /* SET NORMAL ECB CODE Y02082*/
         MVI   DECBCODE(RDECB),X'7F'                               0184
*              GO TO RECV;              /* GO CHECK FOR V FMT  Y02082*/
         B     RECV                                                0185
*            END;                       /*                     Y02082*/
*        ELSE;                          /* AN ERROR EXISTS     Y02082*/
@RF00177 DS    0H                                                  0188
*        IF RPLRTNCD = '08'X            /* FOR LOGICAL ERRORS, Y02082*/
*           & RPLERRCD = RPLEODER THEN  /* DUE TO END OF DATA, Y02144*/
@RC00177 CLI   RPLRTNCD(RRPL),8                                    0188
         BNE   @RF00188                                            0188
         CLC   RPLERRCD(1,RRPL),RPLEODER                           0188
         BE    @RT00188                                            0188
*          GO TO EODADRTN;              /* GO SET UP FOR EODAD Y02082*/
*        ELSE                           /* OTHER LOGICAL ERROR Y02082*/
*          GO TO QMAPPED;               /* GO SET UP FOR SYNAD Y02082*/
*                                                                  0190
         B     QMAPPED                                             0190
*/*******************************************************************/
*                                                                  0191
*                                                                  0191
*RECV:   IF DCBRECFM(1:2) = '01'B       /* VARIABLE LENGTH RECORDS  */
*          THEN DO;                     /* YES, DO FOLLOWING        */
RECV     TM    DCBRECFM(RDCB),B'01000000'                          0191
         BNO   @RF00191                                            0191
         TM    DCBRECFM(RDCB),B'10000000'                          0191
         BNZ   @RF00191                                            0191
*            RDW = RPLRLEN + 4;         /* SET LENGTH OF RECORD     */
         L     @12,RPLAREA(,RRPL)                                  0193
         LA    @10,4                                               0193
         L     @09,RPLRLEN(,RRPL)                                  0193
         ALR   @09,@10                                             0193
         LR    @06,@12                                             0193
         AL    @06,@CF00554                                        0193
         ST    @09,RDW+4(,@06)                                     0193
*            FILLER = 0;                /* ZERO OUT FILLER          */
         SLR   @09,@09                                             0194
         LR    @06,@12                                             0194
         BCTR  @06,0                                               0194
         BCTR  @06,0                                               0194
         STH   @09,FILLER+2(,@06)                                  0194
*            BDW = RDW + 4;             /* SET LENGTH OF BLOCK      */
         L     @06,DECAREA(,RDECB)                                 0195
         AL    @12,@CF00554                                        0195
         AL    @10,RDW+4(,@12)                                     0195
         ST    @10,BDW(,@06)                                       0195
*            FILLERB = 0;               /* ZERO OUT FILLER          */
         STH   @09,FILLERB(,@06)                                   0196
*            GO TO REND;                /* BYPASS FOLLOWING TEST    */
         B     REND                                                0197
*               END;                    /* END OF DO GROUP          */
*          ELSE;                        /* NOT VARIABLE LENGTH RCD  */
*                                                                  0199
@RF00191 DS    0H                                                  0200
*/*******************************************************************/
*                                                                  0200
*                                                                  0200
*        CIIOCNT = CIIOCNT - 1;         /* REDUCE I/O COUNTER BY 1  */
*                                                                  0200
         L     @12,CIIOCNT(,RCICB)                                 0200
         BCTR  @12,0                                               0200
         ST    @12,CIIOCNT(,RCICB)                                 0200
*        IF CIIOCNT ^= 0                /* MORE RECORDS             */
*          THEN DO;                     /* YES                      */
         LTR   @12,@12                                             0201
         BZ    @RF00201                                            0201
*            IF DCBLRECL = 0            /* TEST FOR RECORD LENGTH   */
*               THEN RPLAREA = RPLAREA + DCBBLKSI;/* USE BLKSIZE    */
         ICM   @12,3,DCBLRECL(RDCB)                                0203
         BNZ   @RF00203                                            0203
         SLR   @12,@12                                             0204
         ICM   @12,3,DCBBLKSI(RDCB)                                0204
         AL    @12,RPLAREA(,RRPL)                                  0204
         ST    @12,RPLAREA(,RRPL)                                  0204
*               ELSE RPLAREA = RPLAREA + DCBLRECL;/* USE RCD LENGTH */
         B     @RC00203                                            0205
@RF00203 SLR   @12,@12                                             0205
         ICM   @12,3,DCBLRECL(RDCB)                                0205
         AL    @12,RPLAREA(,RRPL)                                  0205
         ST    @12,RPLAREA(,RRPL)                                  0205
*            GO TO GETIT;               /* GET ANOTHER RECORD       */
         B     GETIT                                               0206
*               END;                    /* END OF DO GROUP          */
*          ELSE;                        /* NO MORE RECORDS          */
*                                                                  0208
@RF00201 DS    0H                                                  0209
*/*******************************************************************/
*/*   TEST FOR FIXED BLOCKED RECORDS AND DCBNCP NOT EQUAL TO @ZA29473*/
*/*   ONE AND IF FOUND - PLACE RESIDUAL COUNT IN PSEUSE IOB  @ZA29473*/
*/********************************************************** @ZA29473*/
*                                                                  0209
*REND:   IF DCBRECFM(1:2) = '10'B & DCBRECFM(4)   = '1'B/*         0209
*                                          IF FIXED BLOCK RECORDS    */
*        & DCBNCP >  '01'X              /* GO STORE RESIDUAL @ZA29473*/
*             THEN GO TO FIXBLOCK;      /* IN PSEUDO IOB     @ZA29473*/
REND     TM    DCBRECFM(RDCB),B'10000000'                          0209
         BNO   @RF00209                                            0209
         TM    DCBRECFM(RDCB),B'01000000'                          0209
         BNZ   @RF00209                                            0209
         TM    DCBRECFM(RDCB),B'00010000'                          0209
         BNO   @RF00209                                            0209
         CLI   DCBNCP(RDCB),1                                      0209
         BH    @RT00209                                            0209
*        IF DCBRECFM(1:2) = '10'B & DCBRECFM(4)   = '1'B/*         0211
*                                                            @ZA29473*/
*          THEN DECRESDU = RPLRLEN * CIIOCNT;                      0211
@RF00209 TM    DCBRECFM(RDCB),B'10000000'                          0211
         BNO   @RF00211                                            0211
         TM    DCBRECFM(RDCB),B'01000000'                          0211
         BNZ   @RF00211                                            0211
         TM    DCBRECFM(RDCB),B'00010000'                          0211
         BNO   @RF00211                                            0211
         L     @15,RPLRLEN(,RRPL)                                  0212
         M     @14,CIIOCNT(,RCICB)                                 0212
         STH   @15,DECRESDU(,RDECB)                                0212
*          ELSE DECRESDU = DCBBLKSI - RPLRLEN;                     0213
*                                                                  0213
         B     @RC00211                                            0213
@RF00211 SLR   @12,@12                                             0213
         ICM   @12,3,DCBBLKSI(RDCB)                                0213
         SL    @12,RPLRLEN(,RRPL)                                  0213
         STH   @12,DECRESDU(,RDECB)                                0213
*        IF DECRESDU < '0000'X          /* TEST IF NEGATIVE         */
*          THEN DECRESDU = '0000'X;     /* SET TO ZERO VALUE        */
*                                                                  0214
@RC00211 CLC   DECRESDU(2,RDECB),@CB00519                          0214
         BNL   @RF00214                                            0214
         MVC   DECRESDU(2,RDECB),@CB00519                          0215
*        CIRESID = DECRESDU;            /* COUNT INTO DUMY IOB Y02082*/
@RF00214 SLR   @12,@12                                             0216
         ICM   @12,3,DECRESDU(RDECB)                               0216
         ST    @12,CIRESID(,RCICB)                                 0216
*        DECIOBPT = ADDR(CIIOB);        /* POINT DECB TO 'IOB' Y02082*/
*                                                                  0217
         LA    @12,CIIOB(,RCICB)                                   0217
         ST    @12,DECIOBPT(,RDECB)                                0217
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */
         B     EXIT                                                0218
*FIXBLOCK:                              /*                   @ZA29473*/
*         DECRESDU = RPLRLEN * CIIOCNT; /*SAVE RESIDUAL CNT  @ZA29473*/
FIXBLOCK L     @15,RPLRLEN(,RRPL)                                  0219
         M     @14,CIIOCNT(,RCICB)                                 0219
         STH   @15,DECRESDU(,RDECB)                                0219
*         CIRESID  = DUMMYPTR;          /*POINT TO NEXT IOB  @ZA29473*/
         L     @12,CIRESID(,RCICB)                                 0220
         L     @12,DUMMYPTR(,@12)                                  0220
         ST    @12,CIRESID(,RCICB)                                 0220
*         DUMMYCNT = DECRESDU;          /*STORE CNT IN IOB   @ZA29473*/
         ST    @15,DUMMYCNT(,@12)                                  0221
*         DECIOBPT = ADDR(DUMMYIOB);    /*POINT DECB TO IOB  @ZA29473*/
         LA    @12,DUMMYIOB(,@12)                                  0222
         ST    @12,DECIOBPT(,RDECB)                                0222
*         GO TO EXIT;                   /*RETURN TO REQUESTOR@ZA29473*/
         B     EXIT                                                0223
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0225
*                                                                  0225
*/*******************************************************************/
*/*                                                                 */
*/*                 JES TRANSLATOR BSAM WRITE ROUTINE               */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0225
*                                                                  0225
*WRITERTN: ;                            /* ENTRY TO WRITE ROUTINE   */
*                                                                  0225
WRITERTN DS    0H                                                  0226
*        DECSDECB=0;                    /* ZERO OUT ENTIRE ECB      */
*                                                                  0226
         SLR   @12,@12                                             0226
         ST    @12,DECSDECB(,RDECB)                                0226
*        RPLAREA = DECAREA;             /* INIT RPL I/O AREA FIELD  */
*                                                                  0227
         MVC   RPLAREA(4,RRPL),DECAREA(RDECB)                      0227
*        RPLDECB = RDECB;               /* RPL PTR TO DECB          */
*                                                                  0228
         ST    RDECB,RPLDECB(,RRPL)                                0228
*/*******************************************************************/
*                                                                  0229
*        IF DCBRECFM(1:2) = '11'B       /* UNDEFINED RECORDS        */
*          THEN IF DECTYP(1) = '1'B     /* LENGTH SPECIFIED AS 'S'  */
         TM    DCBRECFM(RDCB),B'11000000'                          0229
         BNO   @RF00229                                            0229
*            THEN DO;                   /* YES                      */
         TM    DECTYP(RDECB),B'10000000'                           0230
         BNO   @RF00230                                            0230
*              RPLRLEN = DCBBLKSI;      /* GET LENGTH FROM BLOCKSIZE*/
         SLR   @12,@12                                             0232
         ICM   @12,3,DCBBLKSI(RDCB)                                0232
         ST    @12,RPLRLEN(,RRPL)                                  0232
*              GO TO WRCNT;             /* PUT ONE RECORD           */
         B     WRCNT                                               0233
*                 END;                  /* END OF DO GROUP          */
*            ELSE DO;                   /* OTHERWISE                */
@RF00230 DS    0H                                                  0236
*              RPLRLEN = DECLNGTH;      /* GET LENGTH FROM DECB     */
         LH    @12,DECLNGTH(,RDECB)                                0236
         ST    @12,RPLRLEN(,RRPL)                                  0236
*              GO TO WRCNT;             /* PUT ONE RECORD           */
         B     WRCNT                                               0237
*                 END;                  /* END OF DO GROUP          */
*          ELSE;                        /* NOT UNDEFINED RECORDS    */
*                                                                  0239
@RF00229 DS    0H                                                  0240
*        IF DCBRECFM(1:2) = '10'B       /* FIXED LENGTH RECORD      */
*          THEN DO;                     /* YES                      */
         TM    DCBRECFM(RDCB),B'10000000'                          0240
         BNO   @RF00240                                            0240
         TM    DCBRECFM(RDCB),B'01000000'                          0240
         BNZ   @RF00240                                            0240
*            RPLRLEN = DCBBLKSI;        /* GET LENGTH FROM BLOCKSIZE*/
         SLR   @12,@12                                             0242
         ICM   @12,3,DCBBLKSI(RDCB)                                0242
         ST    @12,RPLRLEN(,RRPL)                                  0242
*            IF DCBRECFM(4)   = '1'B    /* BLOCKED RECORD FORMAT    */
*              THEN DO;                 /* YES                      */
         TM    DCBRECFM(RDCB),B'00010000'                          0243
         BNO   @RF00243                                            0243
*                RPLRLEN = DCBLRECL;    /* GET LENGTH FROM DCBLRECL */
         SLR   @10,@10                                             0245
         ICM   @10,3,DCBLRECL(RDCB)                                0245
         ST    @10,RPLRLEN(,RRPL)                                  0245
*                CIIOCNT = DCBBLKSI/DCBLRECL;  /* DETERMINE COUNTER */
         LR    @15,@12                                             0246
         SLR   @14,@14                                             0246
         DR    @14,@10                                             0246
         ST    @15,CIIOCNT(,RCICB)                                 0246
*                GO TO WRITIT;          /* GO TO TEST CONTROL CHAR  */
         B     WRITIT                                              0247
*                   END;                /* END OF DO GROUP          */
*              ELSE GO TO WRCNT;        /* UNBLOCKED RECORD FORMAT  */
*               END;                    /* END OF DO GROUP          */
*          ELSE;                        /* NOT FIXED OR FIXED BLOCK */
*                                                                  0251
@RF00240 DS    0H                                                  0252
*/*******************************************************************/
*                                                                  0252
*        /* VARIABLE LENGTH SPANNED RECORDS ?                       */
*        IF DCBRECFM(1:2)='01'B & DCBRECFM(5)='1'B THEN            0252
*                                                                  0252
         TM    DCBRECFM(RDCB),B'01000000'                          0252
         BNO   @RF00252                                            0252
         TM    DCBRECFM(RDCB),B'10000000'                          0252
         BNZ   @RF00252                                            0252
         TM    DCBRECFM(RDCB),B'00001000'                          0252
         BNO   @RF00252                                            0252
*          DO;                          /* YES PROCESS VS RECORDS    */
*            IF BDWLL > DCBBLKSI THEN   /* BDW GT BLKSIZE?    XA01441*/
         L     @12,DECAREA(,RDECB)                                 0254
         SLR   @10,@10                                             0254
         ICM   @10,3,DCBBLKSI(RDCB)                                0254
         CH    @10,BDWLL(,@12)                                     0254
         BL    @RT00254                                            0254
*              GO TO ABEND;             /* BAD BDW, TERMINATE XA01441*/
*                                                                  0255
*            RPLAREA = RPLAREA + 8;     /* ADJUST PTR TO RPLAREA    */
*                                                                  0256
         LA    @12,8                                               0256
         AL    @12,RPLAREA(,RRPL)                                  0256
         ST    @12,RPLAREA(,RRPL)                                  0256
*            IF CIFVSRI = '0'B          /* INCOMPLETE RECORD BEING 0257
*                                          PROCESSED ?              */
*              THEN                     /* NO                       */
         TM    CIFVSRI(RCICB),B'00010000'                          0257
         BNZ   @RF00257                                            0257
*                CIRECPTR = CIRAREA;    /* PTR TO RECORD AREA       */
         MVC   CIRECPTR(4,RCICB),CIRAREA(RCICB)                    0258
*              ELSE;                    /* PROCESSING INCOMPLETE   0259
*                                          RECORD                   */
@RF00257 DS    0H                                                  0260
*            CIFVSRI = '0'B;            /* RESET INCOMPL RECORD FLG */
*                                                                  0260
         NI    CIFVSRI(RCICB),B'11101111'                          0260
*            CIBLKPTR = RPLAREA - 8;    /* PTR TO USER BLOCK        */
         L     @12,RPLAREA(,RRPL)                                  0261
         SH    @12,@CH00059                                        0261
         ST    @12,CIBLKPTR(,RCICB)                                0261
*CONTIN01:   CISEGLEN = RDWLL - 4;      /* GET SEGMENT LENGTH       */
*                                                                  0262
CONTIN01 L     @12,RPLAREA(,RRPL)                                  0262
         AL    @12,@CF00554                                        0262
         LH    @12,RDWLL+4(,@12)                                   0262
         SH    @12,@CH00147                                        0262
         ST    @12,CISEGLEN(,RCICB)                                0262
*            IF CIRECPTR = CIRAREA + CILWAREA  /* IS REC AREA FILLED*/
*              THEN GO TO NOMOVE;       /* YES, DONT MOVE SEGMENT IN*/
         L     @10,CIRECPTR(,RCICB)                                0263
         L     @09,CIRAREA(,RCICB)                                 0263
         AL    @09,CILWAREA(,RCICB)                                0263
         CR    @10,@09                                             0263
         BE    @RT00263                                            0263
*                                       /* NO, WILL ENTIRE SEG FIT ?*/
*            RWORK = CIRECPTR + CISEGLEN; /* CALC SPACE NEEDED      */
         ALR   @12,@10                                             0265
         LR    RWORK,@12                                           0265
*            IF RWORK > CIRAREA + CILWAREA /* DOES IT FIT IN AREA?  */
*              THEN                     /* NO, FILL IN WHAT FITS    */
         CR    RWORK,@09                                           0266
         BNH   @RF00266                                            0266
*                CISEGLEN = CIRAREA + CILWAREA - CIRECPTR;         0267
*                                                                  0267
         SLR   @09,@10                                             0267
         ST    @09,CISEGLEN(,RCICB)                                0267
*/******MOVE SEGMENT TO RECORD AREA**********************************/
*         GEN;                                                     0268
@RF00266 DS    0H                                                  0268
             L    R14,RPLAREA(,RRPL)                 /*     @ZA09150*/
             LR   R0,R11                             /*     @ZA09150*/
             L    R15,CISEGLEN(,RCICB)               /*     @ZA09150*/
             LR   R11,R15                            /*     @ZA09150*/
             L    R10,CIRECPTR(,RCICB)               /*     @ZA09150*/
             MVCL R10,R14                            /*     @ZA09150*/
             LR   R11,R0                             /*     @ZA09150*/
             LR   R0,R0                              /*     @ZA09150*/
*            CIRECPTR = CIRECPTR + CISEGLEN; /* UPDATE SEGMENT PTR  */
         L     @12,CISEGLEN(,RCICB)                                0269
         L     @10,CIRECPTR(,RCICB)                                0269
         ALR   @10,@12                                             0269
         ST    @10,CIRECPTR(,RCICB)                                0269
*            RPLRLEN = RPLRLEN + CISEGLEN; /* UPDATE RECORD LENGTH  */
*                                                                  0270
         AL    @12,RPLRLEN(,RRPL)                                  0270
         ST    @12,RPLRLEN(,RRPL)                                  0270
*/******IS THIS END OF BLOCK ****************************************/
*NOMOVE:                                                           0271
*            RWORK = RPLAREA + RDWLL;   /* CALC END OF THIS SEGMENT */
NOMOVE   L     @12,RPLAREA(,RRPL)                                  0271
         LR    @10,@12                                             0271
         AL    @10,@CF00554                                        0271
         LH    RWORK,RDWLL+4(,@10)                                 0271
         ALR   RWORK,@12                                           0271
*            IF RWORK = CIBLKPTR + BDWLL + 4  /* IS IT ALSO EOB?    */
*              THEN                     /* YES, END OF BLOCK        */
         L     @10,DECAREA(,RDECB)                                 0272
         LH    @10,BDWLL(,@10)                                     0272
         AL    @10,CIBLKPTR(,RCICB)                                0272
         AH    @10,@CH00147                                        0272
         CR    RWORK,@10                                           0272
         BNE   @RF00272                                            0272
*                DO;                                               0273
*                /* COMPLETE RECORD OR LAST SEGMENT OF RECORD       */
*                IF SEGCC = '00'X × SEGCC = '02'X                  0274
*                  THEN DO;             /* YES                      */
         LR    @10,@12                                             0274
         BCTR  @10,0                                               0274
         BCTR  @10,0                                               0274
         CLI   SEGCC+2(@10),X'00'                                  0274
         BE    @RT00274                                            0274
         BCTR  @12,0                                               0274
         BCTR  @12,0                                               0274
         CLI   SEGCC+2(@12),X'02'                                  0274
         BNE   @RF00274                                            0274
@RT00274 DS    0H                                                  0275
*                    CIFVSEOB = '1'B;   /* INDICATE END OF BLOCK    */
         OI    CIFVSEOB(RCICB),B'00001000'                         0276
*                    GO TO CONTIN02;    /* RECORD READY FOR WRITE   */
         B     CONTIN02                                            0277
*                       END;            /* END OF DO GROUP          */
*                  ELSE DO;             /* NOT COMPLETE RECORD NOR 0279
*                                          LAST SEGMENT             */
@RF00274 DS    0H                                                  0280
*                    CIFVSRI = '1'B;    /* INDICATE INCOMPLETE RECD */
         OI    CIFVSRI(RCICB),B'00010000'                          0280
*                    DECBCODE = '7F'X;  /* POST AS COMPLETE W/NO ER */
         MVI   DECBCODE(RDECB),X'7F'                               0281
*                    GO TO EXIT;        /* WAIT FOR NEXT BLOCK      */
         B     EXIT                                                0282
*                       END;            /* END OF DO GROUP          */
*                END;                   /* DO GROUP-NOT LAST SEG    */
*              ELSE;                    /* NOT END OF BLOCK         */
@RF00272 DS    0H                                                  0286
*              /* IS POINTER WITHIN BOUNDS ?                        */
*              RWORK = RPLAREA + RDWLL; /* CALC END OF SEGMENT      */
         L     @12,RPLAREA(,RRPL)                                  0286
         LR    @10,@12                                             0286
         AL    @10,@CF00554                                        0286
         LH    @10,RDWLL+4(,@10)                                   0286
         ALR   @10,@12                                             0286
         LR    RWORK,@10                                           0286
*              IF RWORK > CIBLKPTR + BDWLL + 4 THEN   /* TOO LONG?  */
         L     @12,DECAREA(,RDECB)                                 0287
         LH    @12,BDWLL(,@12)                                     0287
         AL    @12,CIBLKPTR(,RCICB)                                0287
         AH    @12,@CH00147                                        0287
         CR    RWORK,@12                                           0287
         BH    @RT00287                                            0287
*                                       /* POINTER NOT WITHIN BOUNDS*/
*                  GO TO ABEND;         /* ISSUE ABEND FOR USER     */
*              ELSE;                    /* POINTER IS WITHIN BOUNDS */
*                                                                  0289
*              CIRECPTR = RPLAREA + RDWLL;/* UPDATE RECORD PTR      */
         ST    @10,CIRECPTR(,RCICB)                                0290
*CONTIN02:     RPLAREA = CIRAREA;       /* SAVE AREA POINTER        */
CONTIN02 MVC   RPLAREA(4,RRPL),CIRAREA(RCICB)                      0291
*              GO TO WRITIT;            /* GO WRITE RECORD          */
*                                                                  0292
         B     WRITIT                                              0292
*CONTIN03:     RPLAREA = CIRECPTR;      /* RESTORE RECORD POINTER   */
CONTIN03 MVC   RPLAREA(4,RRPL),CIRECPTR(RCICB)                     0293
*              RPLRLEN = 0;             /* INITIALIZE RECORD LENGTH */
         SLR   @12,@12                                             0294
         ST    @12,RPLRLEN(,RRPL)                                  0294
*              CIRECPTR = CIRAREA;      /* INITIALIZE RECORD PTR    */
         MVC   CIRECPTR(4,RCICB),CIRAREA(RCICB)                    0295
*              GO TO CONTIN01;          /* CONTINUE WITH BLOCK      */
         B     CONTIN01                                            0296
*          END;                         /* END OF SPANNED RCD GROUP */
*                                                                  0297
*/*******************************************************************/
*                                       /* NOT VARIABLE SPANNED     */
*        IF DCBRECFM(1:2) = '01'B THEN  /* VARIABLE LENGTH RECORD ? */
@RF00252 TM    DCBRECFM(RDCB),B'01000000'                          0298
         BNO   @RF00298                                            0298
         TM    DCBRECFM(RDCB),B'10000000'                          0298
         BNZ   @RF00298                                            0298
*          DO;                          /* YES                      */
*            IF BDWLL > DCBBLKSI THEN   /* IS BDW TOO BIG?    XA01441*/
         L     @12,DECAREA(,RDECB)                                 0300
         LH    @12,BDWLL(,@12)                                     0300
         SLR   @10,@10                                             0300
         ICM   @10,3,DCBBLKSI(RDCB)                                0300
         CR    @12,@10                                             0300
         BH    @RT00300                                            0300
*              GO TO ABEND;             /* YES, TERMINATE     XA01441*/
*            RPLAREA = RPLAREA + 8;     /* SET POINTER > BDW & RDW  */
         LA    @10,8                                               0302
         AL    @10,RPLAREA(,RRPL)                                  0302
         ST    @10,RPLAREA(,RRPL)                                  0302
*            RPLRLEN = RDWLL - 4;       /* GET LENGTH FROM RDWLL    */
         LA    @09,4                                               0303
         AL    @10,@CF00554                                        0303
         LH    @10,RDWLL+4(,@10)                                   0303
         LR    @06,@10                                             0303
         SLR   @06,@09                                             0303
         ST    @06,RPLRLEN(,RRPL)                                  0303
*            CIIOCNT = RDWLL;           /* SET RECORD LENGTH        */
         ST    @10,CIIOCNT(,RCICB)                                 0304
*            CISAMWA = BDWLL - 4;       /* SET BLOCK LENGTH         */
         SLR   @12,@09                                             0305
         ST    @12,CISAMWA(,RCICB)                                 0305
*            GO TO WRITIT;              /* GO TO TEST CONTROL CHAR  */
         B     WRITIT                                              0306
*          END;                         /* END OF DO GROUP          */
*        ELSE                           /* LOGICAL ERROR-NO RECFM   */
*          RPLRLEN = DCBBLKSI;          /* ASSUME U,TYPE S          */
*                                                                  0308
@RF00298 SLR   @12,@12                                             0308
         ICM   @12,3,DCBBLKSI(RDCB)                                0308
         ST    @12,RPLRLEN(,RRPL)                                  0308
*/*******************************************************************/
*                                                                  0309
*WRCNT:  CIIOCNT = 1;                   /* SET I/O COUNTER TO 1.    */
*                                                                  0309
WRCNT    MVC   CIIOCNT(4,RCICB),@CF00061                           0309
*/*******************************************************************/
*/*                                                                 */
*/*            ISSUE JES PUT MACRO                                  */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0310
*                                       /* CARRIAGE CONTROL CHAR    */
*WRITIT: IF DCBRECFM(6:7)='10'B × DCBRECFM(6:7)='01'B  /* SPECIFIED */
*              THEN DO;                 /* YES                      */
WRITIT   TM    DCBRECFM(RDCB),B'00000100'                          0310
         BNO   @GL00008                                            0310
         TM    DCBRECFM(RDCB),B'00000010'                          0310
         BZ    @RT00310                                            0310
@GL00008 TM    DCBRECFM(RDCB),B'00000010'                          0310
         BNO   @RF00310                                            0310
         TM    DCBRECFM(RDCB),B'00000100'                          0310
         BNZ   @RF00310                                            0310
@RT00310 DS    0H                                                  0311
*                   RPLCCHAR = RPLAREA;  /* POINTER TO CONTROL CHAR */
         L     @12,RPLAREA(,RRPL)                                  0312
         ST    @12,RPLCCHAR(,RRPL)                                 0312
*                   RPLAREA  = RPLAREA + 1;  /* SET PTR > CTL CHAR  */
         AL    @12,@CF00061                                        0313
         ST    @12,RPLAREA(,RRPL)                                  0313
*                   RPLRLEN  = RPLRLEN - 1;  /* REDUCE LENGTH BY 1  */
         L     @12,RPLRLEN(,RRPL)                                  0314
         BCTR  @12,0                                               0314
         ST    @12,RPLRLEN(,RRPL)                                  0314
*                   END;                                           0315
*              ELSE;                    /* NO CONTROL CHARACTER     */
*                                                                  0316
@RF00310 DS    0H                                                  0317
*/*******************************************************************/
*                                                                  0317
*        GEN (PUT   RPL=(RRPL));        /* JES PUT MACRO            */
         PUT   RPL=(RRPL)
*/*******************************************************************/
*                                                                  0318
*                                                                  0318
*                                                                  0318
*        IF R15 ^= 0 THEN               /* TEST FOR ANY ERRORS       */
         LTR   R15,R15                                             0318
         BZ    @RF00318                                            0318
*          DO;                          /* JES DETECTED AN ERROR     */
*            DECBCODE = '41'X;          /* POST ECB IN ERROR         */
         MVI   DECBCODE(RDECB),X'41'                               0320
*            DECBCOND = ERR3;           /* SET BSAM WRITE ERR  Y02144*/
         MVC   DECBCOND(1,RDECB),ERR3                              0321
*            GO TO EXIT;                /* RETURN TO USER     ZA02178*/
         B     EXIT                                                0322
*          END;                                                    0323
*        ELSE                           /* WRITE WAS OK              */
*          DECBCODE = '7F'X;            /* POST ECB AS NORMAL        */
*                                                                  0324
@RF00318 MVI   DECBCODE(RDECB),X'7F'                               0324
*/*******************************************************************/
*                                                                  0325
*        IF DCBRECFM(1:2) = '01'B & DCBRECFM(5)   = '1'B THEN/*    0325
*                                          VAR LENGTH SPANNED RCDS  */
*                                                                  0325
         TM    DCBRECFM(RDCB),B'01000000'                          0325
         BNO   @RF00325                                            0325
         TM    DCBRECFM(RDCB),B'10000000'                          0325
         BNZ   @RF00325                                            0325
         TM    DCBRECFM(RDCB),B'00001000'                          0325
         BNO   @RF00325                                            0325
*          DO;                          /* YES                      */
*            RPLRLEN = 0;               /* INITIALIZE RECORD LENGTH */
         SLR   @12,@12                                             0327
         ST    @12,RPLRLEN(,RRPL)                                  0327
*            IF CIFVSEOB = '1'B THEN    /* IS IT END OF BLOCK ?     */
         TM    CIFVSEOB(RCICB),B'00001000'                         0328
         BNO   @RF00328                                            0328
*              DO;                      /* YES                      */
*                CIFVSEOB = '0'B;       /* RESET END OF BLOCK FLAG  */
         NI    CIFVSEOB(RCICB),B'11110111'                         0330
*                GO TO EXIT;            /* WAIT FOR NEXT BLOCK      */
         B     EXIT                                                0331
*              END;                     /* END OF EOB GROUP         */
*            ELSE                       /* NOT END OF BLOCK         */
*              GO TO CONTIN03;          /* PROCESS NEXT SEGMENT     */
*          END;                         /* END OF SPANNED RECD GROUP*/
*        ELSE;                          /* NOT SPANNED RECORDS      */
*                                                                  0335
@RF00325 DS    0H                                                  0336
*        IF DCBRECFM(1:2) = '01'B THEN  /* VARIABLE LENGTH RECORDS  */
         TM    DCBRECFM(RDCB),B'01000000'                          0336
         BNO   @RF00336                                            0336
         TM    DCBRECFM(RDCB),B'10000000'                          0336
         BNZ   @RF00336                                            0336
*          DO;                          /* YES, DO FOLLOWING        */
*            CISAMWA = CISAMWA - CIIOCNT;/* REDUCE BLOCK COUNT      */
         L     @12,CISAMWA(,RCICB)                                 0338
         SL    @12,CIIOCNT(,RCICB)                                 0338
         ST    @12,CISAMWA(,RCICB)                                 0338
*            IF CISAMWA =< 0 THEN       /* TEST IF MORE TO WRITE    */
         LTR   @12,@12                                             0339
         BNP   @RT00339                                            0339
*              GO TO EXIT;              /* NO, PROCESSING COMPLETE  */
*            ELSE                       /* YES, DO FOLLOWING        */
*              DO;                      /* MORE DATA TO WRITE       */
*                RPLAREA = RPLAREA + RPLRLEN + 4;/* POINT PAST RCD  */
         LA    @12,4                                               0342
         L     @10,RPLAREA(,RRPL)                                  0342
         AL    @10,RPLRLEN(,RRPL)                                  0342
         ALR   @10,@12                                             0342
         ST    @10,RPLAREA(,RRPL)                                  0342
*                RPLRLEN = RDWLL - 4;   /* SUBTRACT LENGTH OF RDWLL */
         AL    @10,@CF00554                                        0343
         LH    @10,RDWLL+4(,@10)                                   0343
         LCR   @12,@12                                             0343
         ALR   @12,@10                                             0343
         ST    @12,RPLRLEN(,RRPL)                                  0343
*                CIIOCNT = RDWLL;       /* SET TO RECORD LENGTH     */
         ST    @10,CIIOCNT(,RCICB)                                 0344
*                GO TO WRITIT;          /* GO TO TEST CONTROL CHAR  */
         B     WRITIT                                              0345
*              END;                     /* END OF DO GROUP          */
*          END;                         /* END OF DO GROUP          */
*                                                                  0347
*        ELSE;                          /* NOT VARIABLE RECORDS     */
@RF00336 DS    0H                                                  0349
*        CIIOCNT = CIIOCNT - 1;         /* DECREMENT COUNT          */
         L     @12,CIIOCNT(,RCICB)                                 0349
         BCTR  @12,0                                               0349
         ST    @12,CIIOCNT(,RCICB)                                 0349
*        IF CIIOCNT ^= 0 THEN           /* FIXED BLOCKED × UNBLOCKED*/
         LTR   @12,@12                                             0350
         BZ    @RF00350                                            0350
*          DO;                          /* FIXED LENGTH BLOCKED     */
*            IF DCBLRECL = 0 THEN       /* USE LRECL OR BLKSIZE     */
         ICM   @12,3,DCBLRECL(RDCB)                                0352
         BNZ   @RF00352                                            0352
*              RPLAREA = RPLAREA + DCBBLKSI;  /* BLOCKSIZE          */
         SLR   @12,@12                                             0353
         ICM   @12,3,DCBBLKSI(RDCB)                                0353
         AL    @12,RPLAREA(,RRPL)                                  0353
         ST    @12,RPLAREA(,RRPL)                                  0353
*            ELSE                                                  0354
*              RPLAREA = RPLAREA + DCBLRECL;  /* USE LRECL          */
         B     @RC00352                                            0354
@RF00352 SLR   @12,@12                                             0354
         ICM   @12,3,DCBLRECL(RDCB)                                0354
         AL    @12,RPLAREA(,RRPL)                                  0354
         ST    @12,RPLAREA(,RRPL)                                  0354
*            /* CARRIAGE CONTROL CHARACTER SPECIFIED ?              */
*            IF DCBRECFM(6:7)='10'B × DCBRECFM(6:7)='01'B THEN     0355
@RC00352 TM    DCBRECFM(RDCB),B'00000100'                          0355
         BNO   @GL00010                                            0355
         TM    DCBRECFM(RDCB),B'00000010'                          0355
         BZ    @RT00355                                            0355
@GL00010 TM    DCBRECFM(RDCB),B'00000010'                          0355
         BNO   @RF00355                                            0355
         TM    DCBRECFM(RDCB),B'00000100'                          0355
         BNZ   @RF00355                                            0355
@RT00355 DS    0H                                                  0356
*              DO;                      /* YES, CONTROL CHARACTER   */
*                RPLAREA = RPLAREA - 1; /* REPOSITION RPLAREA       */
         L     @12,RPLAREA(,RRPL)                                  0357
         BCTR  @12,0                                               0357
         ST    @12,RPLAREA(,RRPL)                                  0357
*                RPLRLEN = RPLRLEN +1;  /* RESTORE LENGTH           */
         LA    @12,1                                               0358
         AL    @12,RPLRLEN(,RRPL)                                  0358
         ST    @12,RPLRLEN(,RRPL)                                  0358
*              END;                                                0359
*            GO TO WRITIT;              /* PUT ANOTHER RECORD       */
         B     WRITIT                                              0360
*          END;                         /* END OF DO GROUP          */
*        ELSE;                          /* UNBLOCKED                */
*                                                                  0362
@RF00350 DS    0H                                                  0363
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */
         B     EXIT                                                0363
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0365
*                                                                  0365
*/*******************************************************************/
*/*                                                                 */
*/*             JES TRANSLATOR BSAM CHECK ROUTINE                   */
*/*                                                                 */
*/*                 FOR OUTPUT ONLY                                 */
*/*                 FOR INPUT, IGG019BB IS ENTERED                  */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0365
*                                                                  0365
*CHECKRTN: ;                            /* ENTER CHECK ROUTINE      */
*                                                                  0365
CHECKRTN DS    0H                                                  0366
*/*******************************************************************/
*/*                                                                 */
*/* TEST FOR ANY ERRORS - ALL BITS ON EXCEPT FIRST                  */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0366
*        RESTRICT (R12);                /* RESTRICT FROM COMPILER   */
*                                                                  0366
*                                                                  0366
*        IF DECBCODE='7F'X              /* TEST FOR ANY ERRORS      */
*          THEN                         /* NO                       */
         CLI   DECBCODE(RDECB),X'7F'                               0367
         BE    @RT00367                                            0367
*            GO TO EXIT;                /* BRANCH OUT IF NONE       */
*                                                                  0368
*          ELSE DO;                     /* IF AN ERROR IS PRESENT   */
*            R0 = ADDR(CISYNNAM);       /* COMING FROM INTERF. RTN  */
         LA    R0,CISYNNAM(,RCICB)                                 0370
*      GEN  (LOAD  EPLOC=(0));          /* LOAD SYNAD ROUTINE       */
         LOAD  EPLOC=(0)
*            R15 = R0;                  /* SET UP ADDRESS FOR CALL  */
         LR    R15,R0                                              0372
*            R1 = RRPL;                 /* SET UP LINKAGE AS IF     */
         LR    R1,RRPL                                             0373
*      GEN  (BALR  R14,R15);            /* CALL SYNAD ROUTINE       */
*                                                                  0374
         BALR  R14,R15
*            R0 = ADDR(CISYNNAM);       /* POINT TO NAME AGAIN      */
         LA    R0,CISYNNAM(,RCICB)                                 0375
*      GEN  (DELETE EPLOC=(0));         /* AND DELETE SYNAD MODULE  */
         DELETE EPLOC=(0)
*               END;                                               0377
*                                                                  0377
*        RELEASE (R12);                 /* RELEASE REG TO COMPILER  */
*                                                                  0378
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0380
*                                                                  0380
*/*******************************************************************/
*/*                                                                 */
*/*             SAVE ERROR DATA IN CURRENT DECB FOR CHECK           */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0380
*                                                                  0380
*                                                                  0380
*        RESTRICT (R6);                 /* RESTRICT FROM COMPILER   */
*                                                                  0380
*QMAPPED:                               /* BSAM ERROR               */
*                                                                  0381
*        DECBCODE = '41'X;              /* SET ERROR CONDITION      */
*                                                                  0381
QMAPPED  MVI   DECBCODE(RDECB),X'41'                               0381
*        /* MAP JES RETURN CODE TO SAM-SI ERROR INDEX FOR SYNAD      */
*                                                                  0382
*        IF RPLRTNCD = '08'X            /* FOR LOGICAL ERROR   Y02144*/
*           & RPLERRCD = RPLINBUF THEN  /* DUE TO WRONG LENGTH Y02144*/
         CLI   RPLRTNCD(RRPL),8                                    0382
         BNE   @RF00382                                            0382
         CLC   RPLERRCD(1,RRPL),RPLINBUF                           0382
         BNE   @RF00382                                            0382
*          DECBCOND = ERR1;             /* SET BSAM LEN ERROR  Y02144*/
         MVC   DECBCOND(1,RDECB),ERR1                              0383
*        ELSE                           /* OTHERWISE ,         Y02144*/
*          DECBCOND = ERR2;             /* SET BSAM READ ERROR Y02144*/
*                                                                  0384
         B     @RC00382                                            0384
@RF00382 MVC   DECBCOND(1,RDECB),ERR2                              0384
*        /* CHECK ROUTINE WILL PICK UP CODE AND PUT IT IN REGISTER  */
*                                                                  0385
*        GO TO REND;                    /* RETURN TO REQUESTOR      */
*                                                                  0385
         B     REND                                                0385
*        RELEASE (R6);                  /* RELEASE REG TO COMPILER  */
*                                                                  0386
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0388
*                                                                  0388
*/*******************************************************************/
*/*                                                                 */
*/*            RETURN TO REQUESTOR                                  */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0388
*                                                                  0388
*        GEN;                           /* GENERATE EXIT            */
*                                                                  0388
*                                                                  0388
*                                                                  0388
*                                                                  0388
*                                                                  0388
EXIT     L     R13,CIREGBC(,RCICB)      POINT TO USER SAVEAREA
         RETURN (14,12)                 RESTORE USER REGS
*/********************************************************************/
*/*                                                                  */
*/*      SCHEDULE 002 ABEND FOR INVALID BDW OR RDW                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0389
*ABEND:  GEN (DMABCOND 204,SVC=YES,DCB=(RDCB)); /* REQUEST     Y02144
*                                       ABEND VIA PROB. DETERMINATION*/
ABEND    DMABCOND 204,SVC=YES,DCB=(RDCB)
*/********************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0391
*                                                                  0391
*/*******************************************************************/
*/*                                                                 */
*/*            JES TRANSLATOR BSAM CNTRL ROUTINE                    */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0391
*                                                                  0391
*/*******************************************************************/
*/*   THE REQUEST IS IGNORED AND                                    */
*/*   CONTROL IS RETURNED TO THE PROGRAM                            */
*/*   REQUESTING THIS FUNCTION.                                     */
*/*******************************************************************/
*                                                                  0391
*                                                                  0391
*                                                                  0391
*CNTRLRTN: ;                            /* ENTER CNTRLRTN           */
*                                                                  0391
*/*******************************************************************/
*                                                                  0392
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */
*                                                                  0392
         B     EXIT                                                0392
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0394
*                                                                  0394
*/*******************************************************************/
*/*                                                                 */
*/*            JES TRANSLATOR NOTE ROUTINE                          */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0394
*                                                                  0394
*                                                                  0394
*NOTERTN: ;                             /*  ENTRY TO NOTERTN        */
*                                                                  0394
NOTERTN  DS    0H                                                  0395
*        USERSAV(25:28) = RPLDDDD;      /* MOVE RBA TO REG 1 AREA   */
*                                                                  0395
         L     @12,CIREGBC(,RCICB)                                 0395
         MVC   USERSAV+24(4,@12),RPLDDDD(RRPL)                     0395
*/*******************************************************************/
*                                                                  0396
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */
*                                                                  0396
         B     EXIT                                                0396
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0398
*                                                                  0398
*/*******************************************************************/
*/*                                                                 */
*/*           JES TRANSLATOR POINT ROUTINE                          */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0398
*                                                                  0398
*        RESTRICT (R5);                 /* RESTRICT FROM COMPILER   */
*                                                                  0398
*                                                                  0398
*POINTRTN: ;                            /* ENTRY TO POINT ROUTINE   */
*                                                                  0399
POINTRTN DS    0H                                                  0400
*        IF DCBMACRF(11)  = '1'B × DCBMACRF(10)  = '1'B/*          0400
*                                          DCB OPENED FOR OUTPUT    */
*          THEN DO;                     /* YES                      */
         TM    DCBMACRF+1(RDCB),B'01100000'                        0400
         BZ    @RF00400                                            0400
*            CIFPOINT = '1'B;           /* INVALID POINT REQUEST    */
         OI    CIFPOINT(RCICB),B'00000010'                         0402
*            GO TO EXIT;                /* SKIP PROCESSING          */
         B     EXIT                                                0403
*               END;                    /* END OF DO GROUP          */
*          ELSE;                        /* THIS IS INPUT            */
*                                                                  0405
@RF00400 DS    0H                                                  0406
*/*******************************************************************/
*                                                                  0406
*                                                                  0406
*        RPLARG  = R0;                  /* PTR TO ARGUMENT          */
         ST    R0,RPLARG(,RRPL)                                    0406
*        R5 = R0;                       /* ADDRESSIBILITY - RPLARGAR*/
         LR    R5,R0                                               0407
*        RPLDDDD = RPLARGAR;            /* MOVE ARGUMENT INTO RPL   */
         MVC   RPLDDDD(4,RRPL),RPLARGAR(R5)                        0408
*        RPLARG = ADDR(RPLRBAR);        /* ADDRESS OF POINT ARGUMENT*/
*                                                                  0409
         LA    @12,RPLRBAR(,RRPL)                                  0409
         ST    @12,RPLARG(,RRPL)                                   0409
*        RELEASE  (R5);                 /* RELEASE REG TO COMPILER  */
*                                                                  0410
*                                                                  0410
*        IF R15 ^= 0                    /* TEST FOR ANY ERRORS      */
*          THEN CIFPOINT = '1'B;        /* YES - JES ERROR          */
         LTR   R15,R15                                             0411
         BZ    @RF00411                                            0411
         OI    CIFPOINT(RCICB),B'00000010'                         0412
*          ELSE CIFPOINT = '0'B;        /* NO ERRORS                */
*                                                                  0413
         B     @RC00411                                            0413
@RF00411 NI    CIFPOINT(RCICB),B'11111101'                         0413
*/*******************************************************************/
*                                                                  0414
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */
*                                                                  0414
         B     EXIT                                                0414
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0416
*                                                                  0416
*/*******************************************************************/
*/*                                                                 */
*/*            EODAD (END OF DATA) ROUTINE                          */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0416
*                                                                  0416
*EODADRTN: ;                            /* ENTRY TO EODAD ROUTINE   */
*                                                                  0416
EODADRTN DS    0H                                                  0417
*/*******************************************************************/
*                                                                  0417
*        IF DCBRECFM(1:2) = '10'B &     /* IF FIXED                 */
*           DCBRECFM(4)   = '1'B &      /* AND BLOCKED              */
*           CIWK1 ^= CIIOCNT            /* AND SHORT BLOCK          */
*          THEN DECBCODE = '7F'X;       /* SET COMPLETION CODE      */
         TM    DCBRECFM(RDCB),B'10000000'                          0417
         BNO   @RF00417                                            0417
         TM    DCBRECFM(RDCB),B'01000000'                          0417
         BNZ   @RF00417                                            0417
         TM    DCBRECFM(RDCB),B'00010000'                          0417
         BNO   @RF00417                                            0417
         CLC   CIWK1(4,RCICB),CIIOCNT(RCICB)                       0417
         BE    @RF00417                                            0417
         MVI   DECBCODE(RDECB),X'7F'                               0418
*          ELSE DECBCODE = '42'X;       /* SET COMPLETION CODE - EOF*/
         B     @RC00417                                            0419
@RF00417 MVI   DECBCODE(RDECB),X'42'                               0419
*        GO TO REND;                    /* RETURN TO CALLER         */
*                                                                  0420
         B     REND                                                0420
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0422
*                                                                  0422
*/*******************************************************************/
*                                                                  0422
*        GEN;                           /* ADDRESS CONSTANTS        */
*                                                                  0422
BRNCHTAB DC    A(READRTN)               ADDRESS READ ROUTINE
         DC    A(WRITERTN)              ADDRESS WRITE ROUTINE
         DC    A(CHECKRTN)              ADDRESS CHECK ROUTINE
         DC    A(CNTRLRTN)              ADDRESS CONTROL ROUTINE
         DC    A(NOTERTN)               ADDRESS NOTE ROUTINE
         DC    A(POINTRTN)              ADDRESS POINT ROUTINE
*/*******************************************************************/
*                                                                  0423
*                                                                  0423
*       END IGG019DK                    /* END OF BSAM MODULE       */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        *
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        *
*/*%INCLUDE SYSLIB  (IDARMRCD)                                        *
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        *
*;                                                                 0423
@EL00001 DS    0H                                                  0423
@EF00001 DS    0H                                                  0423
@ER00001 BR    @14                                                 0423
@DATA    DS    0H
@CH00147 DC    H'4'
@CH00059 DC    H'8'
@DATD    DSECT
         DS    0F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
@TEMPS   EQU   @ZTEMPS
@L       EQU   @ZLEN
IGG019DK CSECT
         DS    0F
@CF00061 DC    F'1'
@CF00554 DC    F'-4'
@CF00501 DC    XL4'41200000'
@DATD    DSECT
         DS    0D
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
@DATEND  EQU   *
IGG019DK CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@SIZ001  EQU   @SIZDATD
         DS    0D
ERR1     DC    AL1(1)
ERR2     DC    AL1(2)
ERR3     DC    AL1(3)
RPLDVOL  DC    AL1(4)
RPLMOKEY DC    AL1(8)
RPLWTBFR DC    AL1(12)
RPLEODER DC    AL1(4)
RPLDUP   DC    AL1(8)
RPLSEQCK DC    AL1(12)
RPLNOREC DC    AL1(16)
RPLEXCL  DC    AL1(20)
RPLNOMNT DC    AL1(24)
RPLNOEXT DC    AL1(28)
RPLINRBA DC    AL1(32)
RPLNOKR  DC    AL1(36)
RPLNOVRT DC    AL1(40)
RPLINBUF DC    AL1(44)
RPLNOPLH DC    AL1(64)
RPLINACC DC    AL1(68)
RPLINKEY DC    AL1(72)
RPLINADR DC    AL1(76)
RPLERSER DC    AL1(80)
RPLINLOC DC    AL1(84)
RPLNOPTR DC    AL1(88)
RPLINUPD DC    AL1(92)
RPLKEYCH DC    AL1(96)
RPLDLCER DC    AL1(100)
RPLINVP  DC    AL1(104)
RPLINLEN DC    AL1(108)
RPLKEYLC DC    AL1(112)
RPLINLRQ DC    AL1(116)
RPLINTCB DC    AL1(120)
RPLSRLOC DC    AL1(132)
RPLARSRK DC    AL1(136)
RPLSRISG DC    AL1(140)
RPLNBRCD DC    AL1(144)
RPLNXPTR DC    AL1(148)
RPLNOBFR DC    AL1(152)
RPLIRRNO DC    AL1(192)
RPLRRADR DC    AL1(196)
RPLPAACI DC    AL1(200)
RPLPUTBK DC    AL1(204)
RPLINVEQ DC    AL1(208)
RPLRDERD DC    AL1(4)
RPLRDERI DC    AL1(8)
RPLRDERS DC    AL1(12)
RPLWTERD DC    AL1(16)
RPLWTERI DC    AL1(20)
RPLWTERS DC    AL1(24)
RPLBASER DC    AL1(0)
RPLBASUM DC    AL1(1)
RPLAIXER DC    AL1(2)
RPLAIXUM DC    AL1(3)
RPLUPGER DC    AL1(4)
RPLUPGUM DC    AL1(5)
@CB00519 DC    X'0000'
PATCH    DC    CL100' '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
@0       EQU   00
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
R0       EQU   @00
RWORK    EQU   @00
R1       EQU   @01
RRPL     EQU   @02
RCICB    EQU   @04
R5       EQU   @05
R6       EQU   @06
RDECB    EQU   @07
RDCB     EQU   @08
R11      EQU   @11
R12      EQU   @12
R15      EQU   @15
R10      EQU   @10
R13      EQU   @13
R14      EQU   @14
DECB     EQU   0
DECSDECB EQU   DECB
DECBCODE EQU   DECSDECB
DECBCOND EQU   DECSDECB+1
DECRESDU EQU   DECSDECB+2
DECTYP   EQU   DECB+4
DECLNGTH EQU   DECB+6
DECDCBAD EQU   DECB+8
DECAREA  EQU   DECB+12
DECIOBPT EQU   DECB+16
IFGSDCB  EQU   0
DCBBUFCB EQU   IFGSDCB+20
DCBIOBAD EQU   IFGSDCB+28
@NM00004 EQU   IFGSDCB+32
DCBHIARC EQU   @NM00004
DCBBFTEK EQU   DCBHIARC
DCBRECFM EQU   IFGSDCB+36
DCBDDNAM EQU   IFGSDCB+40
DCBMACRF EQU   DCBDDNAM+2
DCBREAD  EQU   IFGSDCB+49
DCBWRITE EQU   DCBREAD
DCBGET   EQU   DCBWRITE
DCBPUT   EQU   DCBGET
DCBCHECK EQU   IFGSDCB+53
DCBGERR  EQU   DCBCHECK
DCBBLKSI EQU   IFGSDCB+62
DCBIOBA  EQU   IFGSDCB+68
DCBCICB  EQU   DCBIOBA
DCBEOBAD EQU   IFGSDCB+72
DCBLCCW  EQU   DCBEOBAD
DCBEOBR  EQU   DCBLCCW
DCBNCP   EQU   DCBEOBR
@NM00005 EQU   IFGSDCB+76
DCBEOBW  EQU   @NM00005
DCBRECAD EQU   DCBEOBW
DCBDIRCT EQU   IFGSDCB+80
DCBLRECL EQU   IFGSDCB+82
@NM00006 EQU   IFGSDCB+84
DCBCNTRL EQU   @NM00006+1
DCBNOTE  EQU   DCBCNTRL
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLCCHAR EQU   RPLCOMN+20
RPLAREA  EQU   RPLCOMN+32
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLRLEN  EQU   RPLCOMN+48
RPLBUFL  EQU   RPLCOMN+52
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLDDDD  EQU   RPLRBAR+4
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
IFGJCICB EQU   0
CIDUMIOB EQU   IFGJCICB
CIIOB    EQU   CIDUMIOB+8
CIRESID  EQU   CIDUMIOB+20
CISYNNAM EQU   IFGJCICB+108
CIREGSAV EQU   IFGJCICB+116
CIREGBC  EQU   CIREGSAV+4
CIFLAGS  EQU   IFGJCICB+188
CIFLAG2  EQU   CIFLAGS+1
CIFLAG3  EQU   CIFLAGS+2
CIFVSRI  EQU   CIFLAG3
CIFVSEOB EQU   CIFLAG3
CIFPOINT EQU   CIFLAG3
CIRPL    EQU   IFGJCICB+192
CILWAREA EQU   IFGJCICB+304
CIIOCNT  EQU   IFGJCICB+308
CISEGLEN EQU   CIIOCNT
CIBLKPTR EQU   IFGJCICB+312
CIRAREA  EQU   IFGJCICB+316
CIRECPTR EQU   IFGJCICB+320
CISAMWA  EQU   IFGJCICB+324
CIWK1    EQU   IFGJCICB+328
CISVCLST EQU   IFGJCICB+336
CISYNADA EQU   CISVCLST
CIBLDL   EQU   CISVCLST+4
CIBSP    EQU   CISVCLST+8
CIFEOV   EQU   CISVCLST+12
CISTOW   EQU   CISVCLST+16
RPLEXT   EQU   76
RPLCICB  EQU   RPLEXT
RPLSAVE  EQU   RPLEXT+4
RPLDECB  EQU   RPLEXT+8
USERSAV  EQU   0
BDW      EQU   0
BDWLL    EQU   BDW
FILLERB  EQU   BDW+2
RDW      EQU   -4
RDWLL    EQU   RDW
FILLER   EQU   RDW+2
SEGCC    EQU   FILLER
RPLARGAR EQU   0
DUMMYIO  EQU   0
DUMMYPTR EQU   DUMMYIO
DUMMYIOB EQU   DUMMYIO+8
DUMMYCNT EQU   DUMMYIO+20
SEGMENT  EQU   0
*                                      START UNREFERENCED COMPONENTS
DUMMYDCB EQU   DUMMYIO+28
@NM00023 EQU   DUMMYIO+24
@NM00022 EQU   DUMMYIO+16
DUMMYEPT EQU   DUMMYIO+12
@NM00021 EQU   DUMMYIO+5
DYMMYECB EQU   DUMMYIO+4
@NM00020 EQU   FILLER+1
RPLRPLPT EQU   RPLEXT+12
@NM00019 EQU   RPLDECB+1
RPLRUDYN EQU   RPLDECB
@NM00018 EQU   RPLSAVE+1
RPLBFREL EQU   RPLSAVE
@NM00017 EQU   RPLCICB+1
RPLCIFLG EQU   RPLCICB
CISTOWRC EQU   CISTOW
CIFEOVRC EQU   CIFEOV
CIBSPRC  EQU   CIBSP
CIBLDLRC EQU   CIBLDL
CISYNRC  EQU   CISYNADA
CIWK2    EQU   IFGJCICB+332
CIFDBCK  EQU   IFGJCICB+284
CIRPLEXT EQU   IFGJCICB+268
CIFLAG4  EQU   CIFLAGS+3
@NM00016 EQU   CIFLAG3
CIFERROR EQU   CIFLAG3
CIFRAGM  EQU   CIFLAG3
CIFCLOSE EQU   CIFLAG3
CIFFSTP  EQU   CIFLAG3
@NM00015 EQU   CIFLAG2
CIFMDEVT EQU   CIFLAG2
CIFMDSOR EQU   CIFLAG2
CIFLAG1  EQU   CIFLAGS
CIREGS   EQU   CIREGSAV+12
CIREGFC  EQU   CIREGSAV+8
@NM00014 EQU   CIREGSAV
CIACBED  EQU   IFGJCICB+88
CIACBD   EQU   IFGJCICB+32
CIDCBPTR EQU   CIDUMIOB+28
@NM00013 EQU   CIDUMIOB+24
@NM00012 EQU   CIDUMIOB+16
CIECBPTR EQU   CIDUMIOB+12
@NM00011 EQU   CIDUMIOB+5
CIECBCD  EQU   CIDUMIOB+4
CINXTIOB EQU   CIDUMIOB
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00010 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
@NM00009 EQU   RPLRBAR+3
@NM00008 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLWAITX EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLTCBPT EQU   RPLCOMN+28
RPLDACB  EQU   RPLCOMN+24
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLERREG EQU   RPLRTNCD
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
DCBEOB   EQU   IFGSDCB+92
DCBPRECL EQU   IFGSDCB+90
@NM00007 EQU   IFGSDCB+88
DCBPOINT EQU   DCBNOTE
DCBEROPT EQU   @NM00006
DCBQSWS  EQU   DCBDIRCT
DCBCCCW  EQU   DCBRECAD
DCBOFFSW EQU   IFGSDCB+67
DCBOFFSR EQU   IFGSDCB+66
DCBWCPL  EQU   IFGSDCB+65
DCBWCPO  EQU   IFGSDCB+64
DCBCIND2 EQU   IFGSDCB+61
DCBCIND1 EQU   IFGSDCB+60
DCBSYNAD EQU   IFGSDCB+57
DCBIOBL  EQU   IFGSDCB+56
DCBPERR  EQU   DCBGERR
DCBOPTCD EQU   IFGSDCB+52
DCBMACR  EQU   DCBPUT+1
DCBIFLG  EQU   DCBPUT
DCBOFLGS EQU   IFGSDCB+48
DCBDEBAD EQU   DCBDDNAM+5
DCBIFLGS EQU   DCBDDNAM+4
DCBTIOT  EQU   DCBDDNAM
DCBEXLST EQU   IFGSDCB+37
DCBEODAD EQU   IFGSDCB+33
DCBBFALN EQU   DCBBFTEK
DCBSVCXL EQU   DCBIOBAD
DCBDSORG EQU   IFGSDCB+26
DCBBUFL  EQU   IFGSDCB+24
DCBBUFNO EQU   DCBBUFCB
@NM00003 EQU   IFGSDCB+16
@NM00002 EQU   IFGSDCB
DECNEXT  EQU   DECB+20
DECTYPE  EQU   DECB+5
@NM00001 EQU   DECBCODE
DECBCOMP EQU   DECBCODE
DECBWAIT EQU   DECBCODE
*                                      END UNREFERENCED COMPONENTS
@RC00178 EQU   @RC00177
@RT00188 EQU   EODADRTN
@RF00188 EQU   QMAPPED
@RC00203 EQU   GETIT
@RT00209 EQU   FIXBLOCK
@RF00243 EQU   WRCNT
@RT00254 EQU   ABEND
@RT00263 EQU   NOMOVE
@RT00287 EQU   ABEND
@RT00300 EQU   ABEND
@RF00328 EQU   CONTIN03
@RT00339 EQU   EXIT
@RF00355 EQU   WRITIT
@RT00367 EQU   EXIT
@RC00382 EQU   REND
CNTRLRTN EQU   EXIT
@RC00411 EQU   EXIT
@RC00417 EQU   REND
@EL01    EQU   @EL00001
@ENDDATA EQU   *
         END   IGG019DK,(C'PLS0858',0701,78076)

         TITLE 'IGG0199G  -  SAM-SI OPEN EXECUTOR                      *
                        '
IGG0199G CSECT ,                                                   0001
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
*                                                                  0057
         MODESET EXTKEY=DATAMGT
*        /************************************************************/
*        /* CORE IS OBTAINED FOR AN ACB OPEN LIST PLUS SPACE FOR     */
*        /* COPIES OF THE DCB JFCBS WHICH ARE ALSO USED FOR THE ACB  */
*        /* OPEN.  THE NUMBER OF SPOOL DCBS CURRENTLY BEING OPENED   */
*        /* WAS SAVED IN THE WTG TABLE BY THE PREVIOUS SAM-SI OPEN   */
*        /* EXECUTOR (IGG0199F).  IF THIS ROUTINE IS REENTERED FROM  */
*        /* RECOVERY (IE DELAY ABEND) AFTER ONE OF THE CURRENT DCBS  */
*        /* FAILED, THEN SPOOL DCB COUNT WILL HAVE BEEN CLEARED      */
*        /* FROM THE WTG TABLE, AND THE ACB OPEN IS NOT NEEDED.      */
*        /************************************************************/
*                                                                  0058
*        RSIZE = WTGTBLEN               /* SPOOL DCB COUNT     Y02120*/
*                *(LENGTH(OPENNTRY)     /* TIMES ENTRY LEN     Y02120*/
*                + LENGTH(IECJFCB));    /* PLUS JFCB SIZE      Y02120*/
*                                                                  0058
         SLR   RSIZE,RSIZE                                         0058
         IC    RSIZE,WTGTBLEN(,RWTG)                               0058
         MH    RSIZE,@CH00699                                      0058
*        IF RSIZE = 0 THEN              /* WAS DCB COUNT =0 ?  YM3946*/
         LTR   RSIZE,RSIZE                                         0059
         BZ    @RT00059                                            0059
*          GO TO RESCAN;                /* YES, SKIP ACB OPEN  YM3946*/
*                                                                  0060
*        GEN (GETMAIN R,LV=(RSIZE),SP=250);/* GET CORE         Y02120*/
*                                                                  0061
         GETMAIN R,LV=(RSIZE),SP=250
*        ROPEN = R1;                    /* SAVE ADDRESS OF LIST     */
         LR    ROPEN,R1                                            0062
*        RESTRICT (ROPENC,RJFCBC);             /* RESTRICT REGISTERS*/
*        ROPENC = ROPEN;                /* POINT TO CURRENT ENTRY   */
         LR    ROPENC,ROPEN                                        0064
*        RESPECIFY OPENNTRY BASED(ROPENC);/* BASE REGISTER          */
*        RPARC = RPAR;                   /* START AT TOP OF LIST    */
*                                                                  0066
         LR    RPARC,RPAR                                          0066
*        /* CALCULATE START OF JFCB COPY AREA                        */
*        RJFCBC = ROPEN +               /* LOC OF OPEN LIST    Y02120*/
*           WTGTBLEN * LENGTH(OPENNTRY);/* PLUS SIZE OF LIST   Y02120*/
         SLR   RJFCBC,RJFCBC                                       0067
         IC    RJFCBC,WTGTBLEN(,RWTG)                              0067
         SLA   RJFCBC,2                                            0067
         ALR   RJFCBC,ROPEN                                        0067
*        WTGTBLEN = 0;                  /* CLEAR THE DCB COUNT Y02120*/
*                                                                  0068
         MVI   WTGTBLEN(RWTG),X'00'                                0068
*        /************************************************************/
*        /* ESTABLISH USER KEY WHILE BUILDING THE ACB OPEN LIST      */
*        /* AND FOR ISSUING OPEN FOR THE ACBS.                       */
*        /************************************************************/
*                                                                  0069
*        R0 = RJFCBC;                   /* SAVE JFCB COPY PTR  Y02082*/
         LR    R0,RJFCBC                                           0069
*        RUKEY = DXUKEY;                /* GET USER KEY IN REG Y02082*/
         L     @12,WTGCWA-1(,RWTGC)                                0070
         SLR   RUKEY,RUKEY                                         0070
         IC    RUKEY,DXUKEY(,@12)                                  0070
*        GEN (MODESET KEYADDR=(2));     /* CHANGE TO USER KEY  Y02082*/
         MODESET KEYADDR=(2)
*        RJFCBC = R0;                   /* RESTORE JFCB PTR    Y02082*/
         LR    RJFCBC,R0                                           0072
*                                                                  0073
*SCANWTG:                               /* START OF SCAN LOOP       */
*        DO RWTGC = ADDR(WTG1ENT) BY LENGTH(WTGC);/* SCAN PARAMETERS*/
SCANWTG  LA    RWTGC,WTG1ENT(,RWTG)                                0073
@DL00073 DS    0H                                                  0074
*        /* TEST WTG TABLE ENTRIES TO SEE IF DCB(S) WERE            */
*        /* PROCESSED BY THE CI.                                    */
*                                                                  0074
*        /* IS THE ID AT WTGC THE ID OF THIS MODULE ?               */
*        IF WTGCID = '9G'                                          0074
*          THEN                         /* YES                      */
         CLC   WTGCID(2,RWTGC),@CC00641                            0074
         BNE   @RF00074                                            0074
*            DO;                                                   0075
*              /* SET OPEN OPTION IN ACB EQUAL TO DCB OPEN OPTION   */
*              OPENOPT = PARCOPT;                                  0076
         MVC   OPENOPT(1,ROPENC),PARCOPT(RPARC)                    0076
*              RESPECIFY IFGSDCB BASED(PARCDCB);/* BASE REGISTER    */
*              RESPECIFY IFGJCICB BASED(DCBCICB);/* BASE REGISTER   */
*              OPENACB = ADDR(CIACBD);  /* ADDR OF ACB TO OPEN      */
*                                                                  0079
         L     @12,PARCDCB-1(,RPARC)                               0079
         LA    @12,0(,@12)                                         0079
         L     @10,DCBCICB(,@12)                                   0079
         LA    @10,CIACBD(,@10)                                    0079
         STCM  @10,7,OPENACB(ROPENC)                               0079
*              RESPECIFY IFGACB BASED(OPENACB); /* BASE REG    Y02120*/
*              NEWJFCB = IECJFCB;       /* COPY JFCB           Y02120*/
         L     @15,WTGCWA-1(,RWTGC)                                0081
         MVC   NEWJFCB(176,RJFCBC),IECJFCB(@15)                    0081
*              JFCBMASK = JFCBMASK && JFCBMASK; /* ZERO MASK   Y02120
*                                       IN COPIED JFCB         Y02120*/
         XC    JFCBMASK(8,RJFCBC),JFCBMASK(RJFCBC)                 0082
*              ACBUJFCB = ADDR(NEWJFCB);/* POINT TO JFCB COPY  Y02120*/
         ST    RJFCBC,ACBUJFCB(,@10)                               0083
*              IF DCBOPTCD(8)='1'B THEN ACBOPT(3)='1'B;    /*@ZA24446*/
         TM    DCBOPTCD(@12),B'00000001'                           0084
         BNO   @RF00084                                            0084
         OI    ACBOPT(@10),B'00100000'                             0085
*              /* IF USER HAS ASKED FOR OPTCD J IN HIS DCB   @ZA24446*/
*              /* THEN SHOW ACB AS ALSO REQUESTING OPBCD J   @ZA24446*/
*                                                                  0086
*              /* UPDATE PTR TO CURRENT ENTRY IN ACB PARAMETER LIST */
*              ROPENC = ROPENC + LENGTH(OPENNTRY);                 0086
*                                                                  0086
@RF00084 LA    ROPENC,4(,ROPENC)                                   0086
*              /* UPDATE PTR TO CURRENT JFCB COPY                    */
*              RJFCBC = RJFCBC + LENGTH(IECJFCB);                  0087
         LA    RJFCBC,176(,RJFCBC)                                 0087
*            END;                       /* END OF THIS MODULE PROC  */
*          ELSE                         /* NO                       */
*                                                                  0089
*            /* IS THIS THE END OF THE WTG TABLE ?                  */
*            IF WTGCID = '0S'                                      0089
*              THEN                     /* YES                      */
         B     @RC00074                                            0089
@RF00074 CLC   WTGCID(2,RWTGC),@CC00646                            0089
         BE    @RT00089                                            0089
*                GO TO GIVEOPEN;        /* PREPARE TO ISSUE OPEN    */
*            RPARC = RPARC + LENGTH(PARCNTRY); /* INDEX ENTRY       */
@RC00074 LA    RPARC,4(,RPARC)                                     0091
*        END SCANWTG;                   /* LOOP THROUGH WTG ENTRIES */
         LA    RWTGC,8(,RWTGC)                                     0092
         B     @DL00073                                            0092
*        /***********************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*        /***********************************************************/
*        /*                                                         */
*        /* ISSUE OPEN ON THE ACB(S)                                */
*        /*                                                         */
*        /***********************************************************/
*                                                                  0094
*GIVEOPEN:                                                         0094
*        /* ADJUST POINTER TO LAST ENTRY IN PARAMETER LIST          */
*        ROPENC = ROPENC - 4;                                      0094
*                                                                  0094
GIVEOPEN SL    ROPENC,@CF00074                                     0094
*        /* INDICATE END OF LIST                                    */
*        OPENOPT (1) = '1'B;                                       0095
*                                                                  0095
         OI    OPENOPT(ROPENC),B'10000000'                         0095
*        GEN (OPEN  MF=(E,(ROPEN)),TYPE=J);/* ISSUE OPEN ON ACB(S)  */
*                                                                  0096
         OPEN  MF=(E,(ROPEN)),TYPE=J
*        /* RELEASE CORE USED FOR OPEN PARAMETER LIST               */
*        GEN (FREEMAIN R,LV=(RSIZE),A=(ROPEN),SP=250);/* FREE CORE  */
*                                                                  0097
         FREEMAIN R,LV=(RSIZE),A=(ROPEN),SP=250
*        RESPECIFY OPENNTRY BASED(NOBASE);/* DROP ADDRESSABILITY    */
*        RELEASE (ROPENC,ROPEN,RSIZE,RJFCBC);  /* RELEASE REGISTERS */
*                                                                  0099
*        /************************************************************/
*        /* PREPARE TO SCAN THE WTG TABLE FOR REQUIRED FINAL         */
*        /* PROCESSING BY THIS MODULE .                              */
*        /************************************************************/
*                                                                  0100
*RESCAN:                                /* BEGIN RESCAN OF WTG YM3946*/
*        RPARC = RPAR;                  /* 1ST ENTRY IN PARM LIST   */
*                                                                  0100
RESCAN   LR    RPARC,RPAR                                          0100
*        /************************************************************/
*        /* NOW RESET BACK TO DATA MANAGEMENT KEY FOR DCB (COPY)     */
*        /* PROCESSING. THE SUBROUTINE "PROCESS" IS ENTERED AND      */
*        /* RETURNS CONTROL IN THIS KEY.                             */
*        /************************************************************/
*                                                                  0101
*        GEN (MODESET EXTKEY=DATAMGT);  /* SET DATA MGT KEY    Y02082*/
         MODESET EXTKEY=DATAMGT
*                                                                  0102
*SCANLOOP:                                                         0102
*        DO RWTGC = ADDR(WTG1ENT) BY LENGTH(WTGC);                 0102
SCANLOOP LA    RWTGC,WTG1ENT(,RWTG)                                0102
@DL00102 DS    0H                                                  0103
*        IF WTGCID = '9G'               /* THIS MOD NEEDED FOR DCB  */
*          THEN                         /* YES                      */
         CLC   WTGCID(2,RWTGC),@CC00641                            0103
         BNE   @RF00103                                            0103
*            DO;                        /* DO FOLLOWING             */
*              R13 = ADDR(DXCCW(1));    /* USE CCW1-CCW9 AS SAVEAREA*/
         L     R13,WTGCWA-1(,RWTGC)                                0105
         LA    R13,0(,R13)                                         0105
         LA    R13,DXCCW(,R13)                                     0105
*              CALL PROCESS;            /* PROCESS THE CURRENT DCB  */
*                                                                  0106
         BAL   @14,PROCESS                                         0106
*              IF R15 ^= 0 THEN         /* IS DCB IN ERROR ?   XM5620*/
         LTR   R15,R15                                             0107
         BZ    @RF00107                                            0107
*                DO;                    /* YES, PREPARE EXIT   XM5620
*                                          TO PROB DET RTN FOR ABEND */
*                  WTGID = PDID;        /* ID INTO WTG TABLE   XM5620*/
         MVC   WTGID(2,RWTG),PDID                                  0109
*                  WTGTTR = PDTTR;      /* TTR INTO WTG TABLE  XM5620*/
         MVC   WTGTTR(3,RWTG),PDTTR                                0110
*                  DXCALLID = '9G';     /* DENOTE CALLER ID    XM5620*/
         L     @12,WTGCWA-1(,RWTGC)                                0111
         LA    @12,0(,@12)                                         0111
         MVC   DXCALLID(2,@12),@CC00641                            0111
*                  RDCB = PARCDCB;      /* RELOAD DCB REG      XM5620*/
         L     RDCB,PARCDCB-1(,RPARC)                              0112
         LA    RDCB,0(,RDCB)                                       0112
*                  ATFABEND = '1'B;     /* AUDIT TRAIL-ABEND   Y02144*/
         OI    ATFABEND(@12),B'01000000'                           0113
*                  R0 = R15;            /* SET PARM REG WITH   XM5620
*                                          INTERNAL ABEND CODE       */
         LR    R0,R15                                              0114
*                  ROPEN = WTGCWA;      /* SET WORKAREA PTR  @ZA15974*/
         LR    ROPEN,@12                                           0115
*                  GO TO XFER;          /* BRANCH TO XCTL      XM5620*/
         B     XFER                                                0116
*                END;                   /* END ERROR DCB LOGIC XM5620*/
*                                                                  0117
*              WTGCID = XCTLID;         /* INDICATE NEXT LOAD FOR IT*/
@RF00107 MVC   WTGCID(2,RWTGC),XCTLID                              0118
*              WTGCTTR = XCTLTTR;                                  0119
         MVC   WTGCTTR(3,RWTGC),XCTLTTR                            0119
*            END;                       /* END OF PROCESSING        */
*                                                                  0120
*        IF WTGID = '9G'                /* NO NEXT MOD SELECTED YET */
*          & WTGCID(1) ^= '00'X         /* CURRENT DCB NEEDS MORE   */
*            THEN                       /* SO SELECT NEXT MOD FOR IT*/
@RF00103 CLC   WTGID(2,RWTG),@CC00641                              0121
         BNE   @RF00121                                            0121
         CLI   WTGCID(RWTGC),X'00'                                 0121
         BE    @RF00121                                            0121
*              DO;                      /* DO FOLLOWING NEXT MOD    */
*                WTGID = WTGCID;                                   0123
         MVC   WTGID(2,RWTG),WTGCID(RWTGC)                         0123
*                WTGTTR = RPARC - RPAR; /* SAVE OFFSET TO ENTRY     */
         LR    @12,RPARC                                           0124
         SLR   @12,RPAR                                            0124
         STCM  @12,7,WTGTTR(RWTG)                                  0124
*              END;                     /* END OF NEXT MOD PROCESS  */
*                                                                  0125
*        IF WTGCID = '0S'               /* ALL DCBS SCANNED         */
*          THEN                         /* YES                      */
@RF00121 CLC   WTGCID(2,RWTGC),@CC00646                            0126
         BNE   @RF00126                                            0126
*            DO;                                                   0127
*              RPARC = RPAR + WTGTTR;   /* USE SAVED OFFSET TO RESET
*                                          RPARC FOR NEXT MODULE    */
         SLR   @12,@12                                             0128
         ICM   @12,7,WTGTTR(RWTG)                                  0128
         LR    RPARC,RPAR                                          0128
         ALR   RPARC,@12                                           0128
*              RWTGC = ADDR(WTG1ENT)    /* ALSO RESET RWTGC         */
*                      + 2 * WTGTTR;    /*(EACH ENTRY TWICE AS LONG)*/
*                                                                  0129
         LA    RWTGC,WTG1ENT(,RWTG)                                0129
         ALR   @12,@12                                             0129
         ALR   RWTGC,@12                                           0129
*              WTGTTR = WTGCTTR;        /* NOW STORE REAL TTR       */
         MVC   WTGTTR(3,RWTG),WTGCTTR(RWTGC)                       0130
*XFER:                                  /* PREPARE FOR XCTL    XM5620*/
*              R15 = ADDR(DXCCW(1));    /* GET ADDRESS OF NEXT MOD  */
XFER     L     @12,WTGCWA-1(,RWTGC)                                0131
         LA    @12,0(,@12)                                         0131
         LA    R15,DXCCW(,@12)                                     0131
*              DXCCW(2) = 0;            /* CLR DCB PTR IN LIST Y02082*/
         SLR   @10,@10                                             0132
         STCM  @10,15,DXCCW+4(@12)                                 0132
*              GEN (XCTL  EPLOC=(RWTG),SF=(E,(15))); /*        Y02082*/
         XCTL  EPLOC=(RWTG),SF=(E,(15))
*            END;                                                  0134
*        RPARC = RPARC + LENGTH(PARCNTRY);                         0135
@RF00126 LA    RPARC,4(,RPARC)                                     0135
*        END SCANLOOP;                  /* CONTINUE SCAN W/NEXT DCB */
         LA    RWTGC,8(,RWTGC)                                     0136
         B     @DL00102                                            0136
*        /***********************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0138
*                                                                  0138
*PROCESS:                                                          0138
*        PROCEDURE                                                 0138
*              OPTIONS(NOSAVEAREA);                                0138
*                                                                  0138
@EL00001 DS    0H                                                  0138
@EF00001 DS    0H                                                  0138
@ER00001 BR    @14                                                 0138
PROCESS  STM   @14,@12,12(@13)                                     0138
*        DCL   RDEB    REG(6) PTR (24); /* BASE FOR DEB             */
*        DCL   RACB    REG(9) PTR (24); /* BASE FOR ACB             */
*        DCL   RCICB   REG(12) PTR(24); /* BASE FOR CICB            */
*                                                                  0141
*        /* RESTRICT THE FOLLOWING REGISTERS FROM THE COMPILER      */
*        RESTRICT (RDCB,RPARC,RWTGC,RACB,RDEB,RSIZE,R1,RCICB);     0142
*                                                                  0142
*        RDCB = PARCDCB;                /* POINTER TO DCB           */
         L     RDCB,PARCDCB-1(,RPARC)                              0143
         LA    RDCB,0(,RDCB)                                       0143
*        RESPECIFY IFGSDCB BASED(RDCB); /* BASE REGISTER            */
*        RCICB = DCBCICB;               /* POINTER TO CICB          */
         L     RCICB,DCBCICB(,RDCB)                                0145
*        RESPECIFY IFGJCICB BASED(RCICB);/* BASE REGISTER           */
*        RACB = ADDR(CIACBD);           /* RESTORE ACB BASE         */
         LA    RACB,CIACBD(,RCICB)                                 0147
*        RESPECIFY IFGACB BASED (RACB); /* BASE REGISTER            */
*                                                                  0148
*        /************************************************************/
*        /* VERIFY THE ACB HAS BEEN OPENED FOR THIS DCB.  IF THE     */
*        /* SUBSYSTEM COULD NOT OPEN THE ACB, DISCONTINUE FURTHER    */
*        /* PROCESSING FOR THE DCB.                                  */
*        /************************************************************/
*                                                                  0149
*        R0 = RDCB;                     /* SAVE DCB ADDRESS    Y02082*/
         LR    R0,RDCB                                             0149
*        RUKEY = DXUKEY;                /* GET USERS KEY       Y02082*/
         L     @10,WTGCWA-1(,RWTGC)                                0150
         SLR   RUKEY,RUKEY                                         0150
         IC    RUKEY,DXUKEY(,@10)                                  0150
*        GEN (MODESET KEYADDR=(2));     /* GO TO USER KEY FOR  Y02082
*                                       ACB TEST AND DEBCHK.   Y02082*/
         MODESET KEYADDR=(2)
*        RDCB = R0;                     /* RESORE DCB BASE     Y02082*/
         LR    RDCB,R0                                             0152
*        IF ACBOPEN = '0'B THEN         /* DID ACB OPEN OK?    Y02082*/
         TM    ACBOPEN(RACB),B'00010000'                           0153
         BNZ   @RF00153                                            0153
*          DO;                          /* NO, GIVE UP ON DCB  Y02082*/
*            GEN (MODESET EXTKEY=DATAMGT);/* RESTORE DM KEY    Y02082*/
         MODESET EXTKEY=DATAMGT
*            R1 = 227;                  /* SET OPEN FAIL CODE  Y02082*/
         LA    R1,227                                              0156
*            GO TO ABEND;               /* TO ERROR EXIT       Y02082*/
         B     ABEND                                               0157
*          END;                         /* END BAD OPEN        Y02082*/
*        ELSE;                          /* OPEN OK...CONTINUE  Y02082*/
@RF00153 DS    0H                                                  0160
*        /************************************************************/
*        /* OBTAIN VALID DEB ADDRESS FROM ACB BY ISSUING DEBCHK.     */
*        /* DEBCHK WILL ABEND IF DEB NOT VALID.  IF DEB IS OK,       */
*        /* ITS ADDRESS IS RETURNED IN REG 1.                        */
*        /************************************************************/
*                                                                  0160
*        GEN (DEBCHK (RACB),AM=SUBSYS); /* TEST ACB'S DEB      Y02082*/
         DEBCHK (RACB),AM=SUBSYS
*        RDEB = R1;                     /* PTR TO VALID DEB    Y02082*/
         LR    RDEB,R1                                             0161
*        RESPECIFY DEBBASIC BASED(RDEB);/* BASE REGISTER FOR DEB     */
*                                                                  0162
*        GEN (MODESET EXTKEY=DATAMGT);  /* RETURN TO DM KEY    Y02082*/
*                                                                  0163
         MODESET EXTKEY=DATAMGT
*        /***********************************************************/
*        /* OPEN FOR THE ACB HAS CREATED THE DEB AND POINTED IT TO  */
*        /* THE ACB. WE ALSO CHAIN THE DCB TO THIS DEB AND PLACE A  */
*        /* POINTER TO THE DCB IN DEBECBAD.                         */
*        /***********************************************************/
*                                                                  0164
*        DCBDEBAD = RDEB;               /* POINT DCB TO DEB          */
         STCM  RDEB,7,DCBDEBAD(RDCB)                               0164
*        DEBECBB = DXUDCBAD;            /* DEB PTR TO REAL DCB Y02082*/
         L     @10,WTGCWA-1(,RWTGC)                                0165
         MVC   DEBECBB(3,RDEB),DXUDCBAD+1(@10)                     0165
*        DEBCINDI = '1'B;               /* INDICATE CI PROCESS Y02120*/
*                                                                  0166
         OI    DEBCINDI(RDEB),B'00001000'                          0166
*        /* WE MUST NOW CLEAR THE ACB MODIFICATION MASK SAVED IN     */
*        /* THE DEB EXTENSION AS A RESULT OF THE ACB OPEN. THIS IS   */
*        /* TO ALLOW COMMON OPEN TO SAVE THE DCB MODIFICATION MASK   */
*        /* AT THIS LOCATION WHEN SAM-SI EXECUTORS RETURN.           */
*                                                                  0167
*        DEBXTNPT -> DEBXDCBM = 0;      /* CLR ACB MOD MASK    Y02134*/
*                                                                  0167
         L     @10,DCBDEBAD-1(,RDCB)                               0167
         LA    @10,0(,@10)                                         0167
         AL    @10,@CF00705                                        0167
         L     @10,DEBXTNPT+8(,@10)                                0167
         SLR   @00,@00                                             0167
         ST    @00,DEBXDCBM(,@10)                                  0167
*/*******************************************************************/
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */
         EJECT
*                                                                  0169
*                                                                  0169
*        /***********************************************************/
*        /* VERIFY DCB ATTRIBUTES -                                 */
*        /*   R1 IS  PRIMED WITH THE PROBLEM DETERMINATION INTERNAL */
*        /*   ABEND CODE FOR THE ATTRIBUTE CURRENTLY BEING CHECKED. */
*        /*   IN THE EVENT OF AN ERROR, THE CODE IS RETURNED TO THE */
*        /*   CALLING ROUTINE IN REG 15.  IF NO ERRORS ARE FOUND,   */
*        /*   REG 1 IS CLEARED TO ZERO.                             */
*        /***********************************************************/
*                                                                  0169
*        R1 = 57;                       /* TEST OPEN OPTIONS - INPUT */
         LA    R1,57                                               0169
*        IF PARCOPOP = '0000'B          /* DCB OPENED FOR INPUT      */
*           × PARCOPOP = '0011'B THEN   /*  OR INOUT,          Y02082*/
         TM    PARCOPOP(RPARC),B'00001111'                         0170
         BZ    @RT00170                                            0170
         TM    PARCOPOP(RPARC),B'00000011'                         0170
         BNO   @RF00170                                            0170
         TM    PARCOPOP(RPARC),B'00001100'                         0170
         BNZ   @RF00170                                            0170
@RT00170 DS    0H                                                  0171
*          IF DCBMACRF(02:03) = '00'B THEN/*                       0171
*                                          MACRF MUST BE READ × GET  */
         TM    DCBMACRF(RDCB),B'01100000'                          0171
         BZ    @RT00171                                            0171
*            GOTO ABEND;                /* TERMINATE OPEN IF NOT     */
*          ELSE                         /* OPTIONS AGREE       Y02082*/
*            IF DCBMACRF(6) = '1'B      /* WAS POINT REQUESTED Y02082*/
*               & DCBCIND2(8) = '0'B THEN/*                        0173
*                                          FOR BSAM DCB ?      Y02082*/
         TM    DCBMACRF(RDCB),B'00000100'                          0173
         BNO   @RF00173                                            0173
         TM    DCBCIND2(RDCB),B'00000001'                          0173
         BZ    @RT00173                                            0173
*              GO TO BADOPT;            /* MACRF=P, TERMINATE  Y02082*/
*            ELSE                       /* MACRF IS OK,        Y02082*/
*              GO TO CHKDSORG;          /* CONTINUE OPEN       Y02082*/
         B     CHKDSORG                                            0175
*        ELSE;                          /* OPEN NOT FOR INPUT  Y02082*/
*                                                                  0176
@RF00170 DS    0H                                                  0177
*        R1 = 58;                       /* TEST OPEN OPTIONS - OUTPUT*/
         LA    R1,58                                               0177
*        IF PARCOPOP = '1111'B          /* DCB OPENED FOR OUTPUT     */
*           × PARCOPOP = '1110'B        /*  OR EXTEND,       @ZA27040*/
*           × PARCOPOP = '0111'B   THEN /*  OR OUTIN,          Y02082*/
         TM    PARCOPOP(RPARC),B'00001111'                         0178
         BO    @RT00178                                            0178
         TM    PARCOPOP(RPARC),B'00001110'                         0178
         BNO   @GL00004                                            0178
         TM    PARCOPOP(RPARC),B'00000001'                         0178
         BZ    @RT00178                                            0178
@GL00004 TM    PARCOPOP(RPARC),B'00000111'                         0178
         BNO   @RF00178                                            0178
         TM    PARCOPOP(RPARC),B'00001000'                         0178
         BNZ   @RF00178                                            0178
@RT00178 DS    0H                                                  0179
*          IF DCBMACRF(10:11) = '00'B THEN/*                       0179
*                                          MACRF MUST BE WRITE × PUT */
         TM    DCBMACRF+1(RDCB),B'01100000'                        0179
         BZ    @RT00179                                            0179
*            GOTO ABEND;                /* TERMINATE IF NOT          */
*          ELSE                         /* OPTIONS AGREE       Y02082*/
*            IF DCBMACRF(14) = '1'B     /* WAS POINT REQUESTED Y02082*/
*               & DCBCIND2(8) = '0'B   THEN/*                      0181
*                                          FOR BSAM DCB ?      Y02082*/
         TM    DCBMACRF+1(RDCB),B'00000100'                        0181
         BNO   @RF00181                                            0181
         TM    DCBCIND2(RDCB),B'00000001'                          0181
         BZ    @RT00181                                            0181
*              GO TO BADOPT;            /* MACRF=P, QUIT       Y02082*/
*            ELSE                       /* MACRF IS OK,        Y02082*/
*              GO TO CHKDSORG;          /* CONTINUE OPEN       Y02082*/
         B     CHKDSORG                                            0183
*        ELSE;                          /* NOT OUTPUT EITHER   Y02082*/
*                                                                  0184
@RF00178 DS    0H                                                  0185
*BADOPT: R1 = 226;                      /* INVALID OPTIONS     Y02082*/
BADOPT   LA    R1,226                                              0185
*        GO TO ABEND;                   /* TERMINATE OPEN      Y02082*/
*                                                                  0186
         B     ABEND                                               0186
*CHKDSORG:                                                         0187
*        R1 = 106;                      /* TEST DSORG         XM5620*/
CHKDSORG LA    R1,106                                              0187
*        IF DCBDSORG(2) ^= '1'B THEN    /* IF NOT PHYS SEQUENTIAL   */
         TM    DCBDSORG(RDCB),B'01000000'                          0188
         BNO   @RT00188                                            0188
*          GOTO ABEND;                  /* TERMINATE OPEN           */
*                                                                  0189
*                                                                  0189
*        R1 = 107;                      /* TEST RECFM         XM5620*/
         LA    R1,107                                              0190
*        IF DCBRECFM(1:3) = '001'B THEN /* RECFM=D (ASCII VARIABLE)?*/
         TM    DCBRECFM(RDCB),B'00100000'                          0191
         BNO   @RF00191                                            0191
         TM    DCBRECFM(RDCB),B'11000000'                          0191
         BZ    @RT00191                                            0191
*          GOTO ABEND;                  /* IF SO, TERMINATE OPEN    */
*        ELSE;                          /* FORMAT F, V, OR U        */
*                                                                  0193
*                                                                  0193
@RF00191 DS    0H                                                  0194
*        IF PARCOPOP = '0000'B          /* OPENING FOR INPUT ?      */
*         × PARCOPOP = '0011'B THEN     /* THEN IF RECFM=           */
         TM    PARCOPOP(RPARC),B'00001111'                         0194
         BZ    @RT00194                                            0194
         TM    PARCOPOP(RPARC),B'00000011'                         0194
         BNO   @RF00194                                            0194
         TM    PARCOPOP(RPARC),B'00001100'                         0194
         BNZ   @RF00194                                            0194
@RT00194 DS    0H                                                  0195
*          IF DCBRECFM(1:2) = '01'B     /*  VARIABLE LENGTH,        */
*          & DCBRECFM(5)   = '1'B       /*  SPANNED RECORDS         */
*           THEN GOTO ABEND;            /* TERMINATE OPEN           */
*                                                                  0195
*                                                                  0195
         TM    DCBRECFM(RDCB),B'01000000'                          0195
         BNO   @RF00195                                            0195
         TM    DCBRECFM(RDCB),B'10000000'                          0195
         BNZ   @RF00195                                            0195
         TM    DCBRECFM(RDCB),B'00001000'                          0195
         BO    @RT00195                                            0195
*        R1 = 61;                       /* TEST LRECL          XM5620*/
@RF00195 DS    0H                                                  0197
@RF00194 LA    R1,61                                               0197
*    /*****************************************************/       0198
*    /*IF BLKSIZE AND LRECL ARE BOTH PRESENT - AND LRECL IS  @ZA27045*/
*    /*GREATER - THEN GO TO ABEND UNLESS VARIABLE SPANNED    @ZA27045*/
*    /*OR UNDEFINED RECORDS ARE USED......................   @ZA30316*/
*    /*****************************************************/       0198
*    GEN ( TM DCBRECFM(RDCB),X'48');                       /*@ZA27045*/
          TM DCBRECFM(RDCB),X'48'
*    GEN ( BO SPANPASS);                                   /*@ZA27045*/
          BO SPANPASS
*    GEN ( TM DCBRECFM(RDCB),X'C0');                       /*@ZA30316*/
          TM DCBRECFM(RDCB),X'C0'
*    GEN ( BO SPANPASS);                                   /*@ZA30316*/
          BO SPANPASS
*    IF DCBLRECL ^= 0 & DCBBLKSI ^= 0 &                    /*@ZA27045*/
*                 DCBLRECL > DCBBLKSI                      /*@ZA27045*/
*        THEN GOTO                          /*               @ZA27045*/
         LH    @10,DCBLRECL(,RDCB)                                 0202
         N     @10,@CF00706                                        0202
         LTR   @10,@10                                             0202
         BZ    @RF00202                                            0202
         LH    @10,DCBBLKSI(,RDCB)                                 0202
         N     @10,@CF00706                                        0202
         LTR   @10,@10                                             0202
         BZ    @RF00202                                            0202
         CLC   DCBLRECL(2,RDCB),DCBBLKSI(RDCB)                     0202
         BH    @RT00202                                            0202
*        ABEND;                             /*               @ZA27045*/
*SPANPASS:                                                 /*@ZA27045*/
*        IF DCBLRECL = 0                /* NO RECORD LENGTH GIVEN   */
*         & DCBCIND2(8) = '1'B/*                                   0204
*                                          REQUIRED FOR QSAM        */
*           THEN IF DCBRECFM(1:2) = '01'B/*                        0204
*                                          SKIP V-TYPE RCDS   XM5989*/
@RF00202 DS    0H                                                  0204
SPANPASS LH    @10,DCBLRECL(,RDCB)                                 0204
         N     @10,@CF00706                                        0204
         LTR   @10,@10                                             0204
         BNZ   @RF00204                                            0204
         TM    DCBCIND2(RDCB),B'00000001'                          0204
         BNO   @RF00204                                            0204
*             THEN;                     /*                    XM5989*/
         TM    DCBRECFM(RDCB),B'01000000'                          0205
         BNO   @RF00205                                            0205
         TM    DCBRECFM(RDCB),B'10000000'                          0205
         BNZ   @RF00205                                            0205
*             ELSE GOTO ABEND;          /* TERMINATE OPEN     XM5989*/
*                                                                  0207
*        IF DCBRECFM(1:2) = '01'B & DCBRECFM(5) = '0'B/*           0208
*                                          V-TYPE RCDS        XM0455*/
*         & DCBLRECL > DCBBLKSI - 4     /* CHECK LRECL        XM5989*/
*           THEN                        /*                    XM5989*/
@RF00204 TM    DCBRECFM(RDCB),B'01000000'                          0208
         BNO   @RF00208                                            0208
         TM    DCBRECFM(RDCB),B'10000000'                          0208
         BNZ   @RF00208                                            0208
         TM    DCBRECFM(RDCB),B'00001000'                          0208
         BNZ   @RF00208                                            0208
         LH    @10,DCBBLKSI(,RDCB)                                 0208
         N     @10,@CF00706                                        0208
         SL    @10,@CF00074                                        0208
         LH    @00,DCBLRECL(,RDCB)                                 0208
         N     @00,@CF00706                                        0208
         CR    @10,@00                                             0208
         BL    @RT00208                                            0208
*             GOTO ABEND;               /* LRECL IS TOO BIG   XM5989*/
*                                                                  0209
*                                                                  0209
*        R1 = 61;                       /* TEST BLKSIZE        XM5620*/
@RF00208 LA    R1,61                                               0210
*        IF DCBCIND2(8) = '0'B THEN     /* BLKSIZE REQUIRED FOR BSAM */
         TM    DCBCIND2(RDCB),B'00000001'                          0211
         BNZ   @RF00211                                            0211
*          IF DCBBLKSI = 0 THEN         /* IS BLKSIZE PRESENT        */
         LH    @10,DCBBLKSI(,RDCB)                                 0212
         N     @10,@CF00706                                        0212
         LTR   @10,@10                                             0212
         BZ    @RT00212                                            0212
*            GOTO ABEND;                /* NO - TERMINATE OPEN       */
*          ELSE;                        /* YES - CONTINUE OPEN       */
*                                                                  0214
*                                                                  0214
*        R1 = 72;                       /* TEST BUFL           XM5620*/
@RF00211 LA    R1,72                                               0215
*        IF DCBBUFNO ^= 0               /* WE NEED BUFFERS          */
*          THEN                         /* SEE IF SIZE IS AVAILABLE */
         CLI   DCBBUFNO(RDCB),0                                    0216
         BE    @RF00216                                            0216
*            IF DCBBUFL = 0             /* --NO IT ISNT             */
*              THEN DCBBUFL = DCBBLKSI; /* DEFAULT IT FROM BLKSI    */
         LH    @10,DCBBUFL(,RDCB)                                  0217
         N     @10,@CF00706                                        0217
         LTR   @10,@10                                             0217
         BNZ   @RF00217                                            0217
         LH    @10,DCBBLKSI(,RDCB)                                 0218
         N     @10,@CF00706                                        0218
         STH   @10,DCBBUFL(,RDCB)                                  0218
*              ELSE                     /* --YES IT IS              */
*                IF DCBBUFL < DCBBLKSI  /* IS IT BIG ENOUGH?        */
*                  & DCBCIND2(8) = '1'B /* FOR QSAM?        @ZA10277*/
*                  THEN GOTO ABEND;     /* IF NOT, ABEND            */
*                                                                  0219
         B     @RC00217                                            0219
@RF00217 CLC   DCBBUFL(2,RDCB),DCBBLKSI(RDCB)                      0219
         BNL   @RF00219                                            0219
         TM    DCBCIND2(RDCB),B'00000001'                          0219
         BO    @RT00219                                            0219
*        R1 = 61;                       /* TEST BUFL & BLKSI  XM3337*/
@RF00219 DS    0H                                                  0221
@RC00217 DS    0H                                                  0221
@RF00216 LA    R1,61                                               0221
*        IF DCBCIND2(8) = '0'B & DCBBUFNO = 0 THEN/*               0222
*                                                BSAM AND NO  XM3337*/
         TM    DCBCIND2(RDCB),B'00000001'                          0222
         BNZ   @RF00222                                            0222
         CLI   DCBBUFNO(RDCB),0                                    0222
         BE    @RT00222                                            0222
*                                       /* NEED TO BUILD BUF  XM3337*/
*          GOTO CHKBFTEK;               /* CONTINUE OPEN      XM3337*/
*  IF DCBBUFCC(32)^= '1'B THEN          /* BUF ALREADY BUILT @ZA30207*/
@RF00222 TM    DCBBUFCC+3(RDCB),B'00000001'                        0224
         BNO   @RT00224                                            0224
*  GO TO  CHKBFTEK ;                    /* CONTINUE OPEN     @ZA28861*/
*             ELSE IF DCBBUFL = 0       /* BUFFER LENGTH =0   XM3337*/
*                    & DCBBLKSI = 0 THEN /* AND BLOCKSIZE =0  XM3337*/
         LH    @10,DCBBUFL(,RDCB)                                  0226
         N     @10,@CF00706                                        0226
         LTR   @10,@10                                             0226
         BNZ   @RF00226                                            0226
         LH    @10,DCBBLKSI(,RDCB)                                 0226
         N     @10,@CF00706                                        0226
         LTR   @10,@10                                             0226
         BNZ   @RF00226                                            0226
*             DCBBLKSI = DCBLRECL;      /* SET BLK=LRECL    @ZA18528*/
         LH    @10,DCBLRECL(,RDCB)                                 0227
         N     @10,@CF00706                                        0227
         STH   @10,DCBBLKSI(,RDCB)                                 0227
*                  ELSE IF DCBBLKSI = 0 /* BLOCKSIZE = 0      YM5890*/
*             & DCBLRECL = 0 THEN GOTO ABEND;/* DCBLRECL=0  @ZA27045*/
*                                                                  0228
*                                                                  0228
         B     @RC00226                                            0228
@RF00226 LH    @10,DCBBLKSI(,RDCB)                                 0228
         N     @10,@CF00706                                        0228
         LTR   @10,@10                                             0228
         BNZ   @RF00228                                            0228
         LH    @10,DCBLRECL(,RDCB)                                 0228
         N     @10,@CF00706                                        0228
         LTR   @10,@10                                             0228
         BZ    @RT00228                                            0228
*CHKBFTEK:                              /* TEST BFTEK         XM3337*/
*        IF DCBBFTEK = '00'X            /* BUFTEK/BUFALN NOT GIVEN  */
*          THEN                         /* NO                       */
@RF00228 DS    0H                                                  0230
@RC00226 DS    0H                                                  0230
CHKBFTEK CLI   DCBBFTEK(RDCB),X'00'                                0230
         BNE   @RF00230                                            0230
*            DCBBFTEK = '46'X;          /* DEFAULT TO BFTEK=S,ALN=D */
*                                                                  0231
*                                                                  0231
         MVI   DCBBFTEK(RDCB),X'46'                                0231
*        R1 = 47;                       /* TEST OPTCD          XM5620*/
@RF00230 LA    R1,47                                               0232
*        IF DCBOPTCD(5) = '1'B          /* ASCII TRANSLATE          */
*         × DCBOPTCD(7) = '1'B          /* USER TOTALTING           */
*             THEN                      /* OPTION(S) INDICATED      */
         TM    DCBOPTCD(RDCB),B'00001010'                          0233
         BNZ   @RT00233                                            0233
*               GOTO ABEND;             /* --BOTH INVALID           */
*                                                                  0234
*NOABEND:                               /* NORMAL RETURN LOC   XM5620*/
*        R1 = 0;                        /* CLEAR RETURN REG    XM5620*/
NOABEND  SLR   R1,R1                                               0235
*ABEND:                                 /* ERROR RETURN LOC    XM5620*/
*        RETURN CODE(R1);               /* RETURN TO CALLER    XM5620*/
*                                                                  0236
ABEND    LR    @15,R1                                              0236
         L     @14,12(,@13)                                        0236
         LM    @00,@12,20(@13)                                     0236
         BR    @14                                                 0236
*        END PROCESS;                                              0237
*                                                                  0237
*        END IGG0199G                   /* END OF IGG0199G MODULE    */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        *
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        *
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        *
*/*%INCLUDE SYSLIB  (IFGACB  )                                        *
*;                                                                 0238
@DATA    DS    0H
@CH00699 DC    H'180'
@DATD    DSECT
         DS    0F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
@TEMPS   EQU   @ZTEMPS
@L       EQU   @ZLEN
IGG0199G CSECT
         DS    0F
@CF00074 DC    F'4'
@CF00705 DC    F'-8'
@CF00706 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
IGG0199G CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@SIZ001  EQU   @SIZDATD
         DS    0D
@CC00641 DC    C'9G'
@CC00646 DC    C'0S'
         DS    CL4
LOADLIST DS    CL14
         ORG   LOADLIST
@NM00015 DS    CL6
         ORG   @NM00015
XCTLID   DC    CL2'9W'
XCTLTTR  DC    AL3(0)
XCTLLEN  DC    AL1(0)
         ORG   LOADLIST+6
PDENTRY  DS    CL6
         ORG   PDENTRY
PDID     DC    CL2'6M'
PDTTR    DC    AL3(0)
PDLEN    DC    AL1(0)
         ORG   LOADLIST+12
@NM00016 DC    AL2(0)
         ORG   LOADLIST+14
@DATD    DSECT
IGG0199G CSECT
PATCH    EQU   *
         DS    CL(IGG0199G+1280-PATCH)  AMOUNT OF UNUSED SPACE   XM3337
PATCH#   EQU   *-PATCH                  LENGTH OF UNUSED SPACE
         ORG   PATCH                    SET ORIGIN FOR PATCH AREA
         DC    (PATCH#)C' '             BLANK OUT PATCH AREA
         DC    C'019'                   SVC CODE
         DC    AL1((LOADLIST-IGG0199G)/8) DISPLACEMENT TO TABLE
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
@DATEND  EQU   *
IGG0199G CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
@0       EQU   00
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
R0       EQU   @00
R1       EQU   @01
RDCB     EQU   @02
RJFCBC   EQU   @02
RUKEY    EQU   @02
RSIZE    EQU   @03
ROPEN    EQU   @04
RPAR     EQU   @05
RWTG     EQU   @06
RPARC    EQU   @07
RWTGC    EQU   @08
ROPENC   EQU   @09
R13      EQU   @13
R15      EQU   @15
RDEB     EQU   @06
RACB     EQU   @09
RCICB    EQU   @12
WTG      EQU   0
WTGMDNAM EQU   WTG
WTGID    EQU   WTGMDNAM+6
WTGTTR   EQU   WTG+14
WTGTBLEN EQU   WTG+29
WTG1ENT  EQU   WTG+32
WTGC     EQU   0
WTGCID   EQU   WTGC
WTGCTTR  EQU   WTGC+2
WTGCWA   EQU   WTGC+5
PARCNTRY EQU   0
PARCOPT  EQU   PARCNTRY
PARCOPOP EQU   PARCOPT
PARCDCB  EQU   PARCNTRY+1
OPENNTRY EQU   0
OPENOPT  EQU   OPENNTRY
OPENACB  EQU   OPENNTRY+1
IECDSECT EQU   0
IECJFCB  EQU   IECDSECT+100
DXCCW    EQU   IECDSECT+368
DXCALLID EQU   IECDSECT+456
DXUKEY   EQU   IECDSECT+526
DXUDCBAD EQU   IECDSECT+568
DXATEXC1 EQU   IECDSECT+604
NEWJFCB  EQU   0
JFCBMASK EQU   NEWJFCB+72
IFGSDCB  EQU   0
DCBBUFCB EQU   IFGSDCB+20
DCBBUFNO EQU   DCBBUFCB
DCBBUFL  EQU   IFGSDCB+24
DCBDSORG EQU   IFGSDCB+26
DCBIOBAD EQU   IFGSDCB+28
@NM00019 EQU   IFGSDCB+32
DCBHIARC EQU   @NM00019
DCBBFTEK EQU   DCBHIARC
DCBRECFM EQU   IFGSDCB+36
DCBDDNAM EQU   IFGSDCB+40
DCBMACRF EQU   DCBDDNAM+2
DCBDEBAD EQU   DCBDDNAM+5
DCBREAD  EQU   IFGSDCB+49
DCBWRITE EQU   DCBREAD
DCBGET   EQU   DCBWRITE
DCBPUT   EQU   DCBGET
DCBOPTCD EQU   IFGSDCB+52
DCBCHECK EQU   IFGSDCB+53
DCBGERR  EQU   DCBCHECK
DCBCIND2 EQU   IFGSDCB+61
DCBBLKSI EQU   IFGSDCB+62
DCBIOBA  EQU   IFGSDCB+68
DCBCICB  EQU   DCBIOBA
DCBEOBAD EQU   IFGSDCB+72
DCBLCCW  EQU   DCBEOBAD
DCBEOBR  EQU   DCBLCCW
@NM00020 EQU   IFGSDCB+76
DCBEOBW  EQU   @NM00020
DCBRECAD EQU   DCBEOBW
DCBDIRCT EQU   IFGSDCB+80
DCBLRECL EQU   IFGSDCB+82
@NM00021 EQU   IFGSDCB+84
DCBCNTRL EQU   @NM00021+1
DCBNOTE  EQU   DCBCNTRL
NOBASE   EQU   0
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBCINDI EQU   DEBFLGS1
DEBUSRPG EQU   DEBBASIC+16
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBECBB  EQU   DEBECBAD+1
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBAPPAD EQU   DEBBASIC+28
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
DEBXDCBM EQU   DEBXTN+8
IFGJCICB EQU   0
CIDUMIOB EQU   IFGJCICB
CIACBD   EQU   IFGJCICB+32
CIREGSAV EQU   IFGJCICB+116
CIFLAGS  EQU   IFGJCICB+188
CIFLAG2  EQU   CIFLAGS+1
CIFLAG3  EQU   CIFLAGS+2
CIIOCNT  EQU   IFGJCICB+308
CISVCLST EQU   IFGJCICB+336
CISYNADA EQU   CISVCLST
CIBLDL   EQU   CISVCLST+4
CIBSP    EQU   CISVCLST+8
CIFEOV   EQU   CISVCLST+12
CISTOW   EQU   CISVCLST+16
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBOPEN  EQU   ACBOFLGS
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
DEBXTNPT EQU   -8
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
ATFLAGS  EQU   DXATEXC1
ATFOPEN  EQU   ATFLAGS
ATFABEND EQU   ATFOPEN
ATFCLOSE EQU   ATFLAGS+1
DCBBUFCC EQU   DCBBUFCB
*                                      START UNREFERENCED COMPONENTS
@NM00044 EQU   ATFCLOSE
ATFCICBF EQU   ATFCLOSE
ATFMDMSK EQU   ATFCLOSE
ATFCHECK EQU   ATFOPEN
ATFSYNC  EQU   ATFOPEN
ATFBSAM  EQU   ATFOPEN
ATFQSAM  EQU   ATFOPEN
@NM00043 EQU   ATFOPEN
ATFCICBG EQU   ATFOPEN
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00042 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBVVIC  EQU   ACBINFLG
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00041 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00040 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00039 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00038 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00037 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00036 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00035 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00034 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00033 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
CISTOWRC EQU   CISTOW
CIFEOVRC EQU   CIFEOV
CIBSPRC  EQU   CIBSP
CIBLDLRC EQU   CIBLDL
CISYNRC  EQU   CISYNADA
CIWK2    EQU   IFGJCICB+332
CIWK1    EQU   IFGJCICB+328
CISAMWA  EQU   IFGJCICB+324
CIRECPTR EQU   IFGJCICB+320
CIRAREA  EQU   IFGJCICB+316
CIBLKPTR EQU   IFGJCICB+312
CISEGLEN EQU   CIIOCNT
CILWAREA EQU   IFGJCICB+304
CIFDBCK  EQU   IFGJCICB+284
CIRPLEXT EQU   IFGJCICB+268
CIRPL    EQU   IFGJCICB+192
CIFLAG4  EQU   CIFLAGS+3
@NM00032 EQU   CIFLAG3
CIFPOINT EQU   CIFLAG3
CIFERROR EQU   CIFLAG3
CIFVSEOB EQU   CIFLAG3
CIFVSRI  EQU   CIFLAG3
CIFRAGM  EQU   CIFLAG3
CIFCLOSE EQU   CIFLAG3
CIFFSTP  EQU   CIFLAG3
@NM00031 EQU   CIFLAG2
CIFMDEVT EQU   CIFLAG2
CIFMDSOR EQU   CIFLAG2
CIFLAG1  EQU   CIFLAGS
CIREGS   EQU   CIREGSAV+12
CIREGFC  EQU   CIREGSAV+8
CIREGBC  EQU   CIREGSAV+4
@NM00030 EQU   CIREGSAV
CISYNNAM EQU   IFGJCICB+108
CIACBED  EQU   IFGJCICB+88
CIDCBPTR EQU   CIDUMIOB+28
@NM00029 EQU   CIDUMIOB+24
CIRESID  EQU   CIDUMIOB+20
@NM00028 EQU   CIDUMIOB+16
CIECBPTR EQU   CIDUMIOB+12
CIIOB    EQU   CIDUMIOB+8
@NM00027 EQU   CIDUMIOB+5
CIECBCD  EQU   CIDUMIOB+4
CINXTIOB EQU   CIDUMIOB
DEBXSAMB EQU   DEBXTN+28
DEBXOPNJ EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXDSSI EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCEAD EQU   DEBXCEA+1
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCEAD  EQU   DEBCEA+1
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOEAD EQU   DEBEOEA+1
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBESMVR EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00026 EQU   DEBACS08+12
@NM00025 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00024 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00023 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBLRECL EQU   DEBACSMD+14
DEBBLKSI EQU   DEBACSMD+12
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBNMTRK EQU   DEBDASD+14
DEBENDHH EQU   DEBDASD+12
DEBENDCC EQU   DEBDASD+10
DEBSTRHH EQU   DEBDASD+8
DEBSTRCC EQU   DEBDASD+6
DEBBINUM EQU   DEBDASD+4
DEBUCBA  EQU   DEBUCBAD+1
DEBDVMOD EQU   DEBUCBAD
DEBAPPB  EQU   DEBAPPAD+1
DEBEXSCL EQU   DEBAPPAD
DEBDCBB  EQU   DEBDCBAD+1
DEBDEBID EQU   DEBPROTG
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBNMEXT EQU   DEBUSRPG
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
DCBEOB   EQU   IFGSDCB+92
DCBPRECL EQU   IFGSDCB+90
@NM00022 EQU   IFGSDCB+88
DCBPOINT EQU   DCBNOTE
DCBEROPT EQU   @NM00021
DCBQSWS  EQU   DCBDIRCT
DCBCCCW  EQU   DCBRECAD
DCBNCP   EQU   DCBEOBR
DCBOFFSW EQU   IFGSDCB+67
DCBOFFSR EQU   IFGSDCB+66
DCBWCPL  EQU   IFGSDCB+65
DCBWCPO  EQU   IFGSDCB+64
DCBCIND1 EQU   IFGSDCB+60
DCBSYNAD EQU   IFGSDCB+57
DCBIOBL  EQU   IFGSDCB+56
DCBPERR  EQU   DCBGERR
DCBMACR  EQU   DCBPUT+1
DCBIFLG  EQU   DCBPUT
DCBOFLGS EQU   IFGSDCB+48
DCBIFLGS EQU   DCBDDNAM+4
DCBTIOT  EQU   DCBDDNAM
DCBEXLST EQU   IFGSDCB+37
DCBEODAD EQU   IFGSDCB+33
DCBBFALN EQU   DCBBFTEK
DCBSVCXL EQU   DCBIOBAD
@NM00018 EQU   IFGSDCB+16
@NM00017 EQU   IFGSDCB
@NM00014 EQU   NEWJFCB
DXATEXC2 EQU   IECDSECT+608
@NM00013 EQU   IECDSECT+572
@NM00012 EQU   IECDSECT+527
@NM00011 EQU   IECDSECT+458
@NM00010 EQU   IECDSECT+440
@NM00009 EQU   IECDSECT+364
@NM00008 EQU   IECDSECT+320
@NM00007 EQU   IECDSECT+280
@NM00006 EQU   IECDSECT+276
@NM00005 EQU   IECDSECT
@NM00004 EQU   PARCOPT
WTGPATH  EQU   WTG+30
WTGFLEN  EQU   WTG+27
WTGTLEN  EQU   WTG+24
@NM00003 EQU   WTG+17
@NM00002 EQU   WTG+8
@NM00001 EQU   WTGMDNAM
*                                      END UNREFERENCED COMPONENTS
@RT00059 EQU   RESCAN
@RT00089 EQU   GIVEOPEN
@RT00171 EQU   ABEND
@RT00173 EQU   BADOPT
@RF00173 EQU   CHKDSORG
@RT00179 EQU   ABEND
@RT00181 EQU   BADOPT
@RF00181 EQU   CHKDSORG
@RT00188 EQU   ABEND
@RT00191 EQU   ABEND
@RT00195 EQU   ABEND
@RT00202 EQU   ABEND
@RF00205 EQU   ABEND
@RT00208 EQU   ABEND
@RT00212 EQU   ABEND
@RT00219 EQU   ABEND
@RT00222 EQU   CHKBFTEK
@RT00224 EQU   CHKBFTEK
@RT00228 EQU   ABEND
@RT00233 EQU   ABEND
@PB00002 EQU   @EL00001
@EL01    EQU   @EL00001
@ENDDATA EQU   *
         END   IGG0199G,(C'PLS0741',0701,78100)

         TITLE 'IEAVNP1A - NIP VSAM OPEN                               *
                        '
IEAVNP1A CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IEAVNP1A  77.018'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @11,4095(,@10)                                      0001
         LA    @12,4095(,@11)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@12                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0001
         USING @DATD,@08                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @08,8(,@13)                                         0001
         LR    @13,@08                                             0001
         MVC   @PC00001(12),0(@01)                                 0001
*
* REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF
* NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES
* WILL ASSEMBLE PROPERLY.
         STM  R2,R3,LOCPTR
*   MAINPOOL=NIPPOOL;               /* MOVE FOR BETTER ACCESS        */
         L     @09,ACBPTR                                          0321
         L     @09,NIPSPPTR(,@09)                                  0321
         SLR   @15,@15                                             0321
         IC    @15,NIPPOOL(,@09)                                   0321
         ST    @15,MAINPOOL                                        0321
*   COREPTR1=ZERO;                  /* INITIALIZE MAPPING BLOCK PTR  */
         SLR   @09,@09                                             0322
         ST    @09,COREPTR1                                        0322
*   BITBANK='00000000'B;            /* INIT SWITCHES                 */
         MVI   BITBANK,B'00000000'                                 0323
*   ERFLAG=ZERO;                    /* CLEAR ERROR FLAG              */
         STH   @09,ERFLAG                                          0324
*   COREAVIL=ZERO;                  /* INIT CORE AVAILABLE FIELD     */
         ST    @09,COREAVIL                                        0325
*   CALL CATIN;                     /* GET CATLG INFO                */
         BAL   @14,CATIN                                           0326
*   CALL BLDAMBL;                   /* CREATE AN AMBL                */
         BAL   @14,BLDAMBL                                         0327
*   IF NOCATLG=ON THEN              /* IF NOT A CATALOG              */
         TM    NOCATLG,B'10000000'                                 0328
         BNO   @RF00328                                            0328
*     CALL VMNTVER;                 /* VOLUME MOUNT                  */
         BAL   @14,VMNTVER                                         0329
*   CALL BLDDDEB;                   /* BUILD DUMMY DEB               */
@RF00328 BAL   @14,BLDDDEB                                         0330
*   DO IX1=CTAMBNO TO 1 BY-1;       /* BUILD BLOCKS PER AMB          */
         L     @09,CTAMBNO                                         0331
         ST    @09,IX1                                             0331
         B     @DE00331                                            0331
@DL00331 DS    0H                                                  0332
*     CWAPT=WAPT(CTAMBNO+ONE-IX1);  /* POINT TO AMBWORK              */
         LA    @07,1                                               0332
         AL    @07,CTAMBNO                                         0332
         SLR   @07,@09                                             0332
         SLA   @07,2                                               0332
         L     CWAPT,WAPT-4(@07)                                   0332
*     CALL BLDAMB;                  /* BUILD THE AMB                 */
         BAL   @14,BLDAMB                                          0333
*     CALL BLDAMDSB;                /* BUILD THE AMDSB               */
         BAL   @14,BLDAMDSB                                        0334
*     CALL BLDIWA;                  /* BUILD THE INSERT WORK AREA    */
         BAL   @14,BLDIWA                                          0335
*     IF IX1=CTAMBNO THEN           /* 1ST TIME                      */
         CLC   IX1(4),CTAMBNO                                      0336
         BNE   @RF00336                                            0336
*       CALL BUFNOSET;              /* COMPUTE BUFFER NBR            */
         BAL   @14,BUFNOSET                                        0337
*     CALL BLDBUFC;                 /* BLD BUFFER CTL BLKS           */
@RF00336 BAL   @14,BLDBUFC                                         0338
*     CALL BLDIOMB;                 /* BLD IOMB                      */
         BAL   @14,BLDIOMB                                         0339
*     CALL BLDBFRS;                 /* BUILD BUFFERS                 */
         BAL   @14,BLDBFRS                                         0340
*     CALL BLDCPA;                  /* CHANNEL PROGRAM AREA          */
         BAL   @14,BLDCPA                                          0341
*     CALL BLDARDB;                 /* ADDR RANGE DEF BLK            */
         BAL   @14,BLDARDB                                         0342
*     IF AMBTYPE=AMBDATA THEN       /* BUILD PLACEHOLDERS FOR        */
         TM    AMBTYPE(AMBPT),B'01000000'                          0343
         BNZ   @RF00343                                            0343
*       CALL BLDPLHDR;              /* DATA AMB ONLY                 */
         BAL   @14,BLDPLHDR                                        0344
*     CALL BLDLPMB;                 /* LOGICAL PHYSICAL MAPPING      */
@RF00343 BAL   @14,BLDLPMB                                         0345
*     CALL BLDEDB;                  /* EXTENT DEFINITION             */
         BAL   @14,BLDEDB                                          0346
*     CALL BLDRDEB;                 /* BUILD REAL DEB        @Z30SSRL*/
         BAL   @14,BLDRDEB                                         0347
*     CALL CHNBLKS;                 /* CHAIN BLOCKS                  */
         BAL   @14,CHNBLKS                                         0348
*   END;                                                           0349
         SLR   @09,@09                                             0349
         BCTR  @09,0                                               0349
         AL    @09,IX1                                             0349
         ST    @09,IX1                                             0349
@DE00331 LTR   @09,@09                                             0349
         BP    @DL00331                                            0349
*EXIT:                                                             0350
*                                                                  0350
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAN UP AND RETURN TO CALLER                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0350
*   CALL FREEMAIN;                  /* FREE ANY REMAINING UNUSED SQA
*                                                            @YM08548*/
EXIT     BAL   @14,FREEMAIN                                        0350
*   RESPECIFY                                                      0351
*    (R0,                                                          0351
*     R1) RESTRICTED;                                              0351
*                                                                  0351
*   /*****************************************************************/
*   /*                                                               */
*   /* TO MUCH ERROR?                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*   IF ERFLAG>ZERORBA THEN          /* TO MUCH ERROR                 */
         LH    @09,ERFLAG                                          0352
         CH    @09,ZERORBA                                         0352
         BNH   @RF00352                                            0352
*     DO;                                                          0353
*       ACBAMBL=ZERO;               /* CLEAR POINTER                 */
         L     @09,ACBPTR                                          0354
         SLR   @15,@15                                             0354
         ST    @15,ACBAMBL(,@09)                                   0354
*       COREPTRN=COREPTR1;          /* INIT PTR                      */
         L     @09,COREPTR1                                        0355
         ST    @09,COREPTRN                                        0355
*       DO WHILE COREPTRN^=ZERO;    /* FREE CONTROL BLOCKS           */
         B     @DE00356                                            0356
@DL00356 DS    0H                                                  0357
*         DO IX=CORENBR TO 1 BY-1;  /* FREE WHAT THIS COREBLK PTS    */
         L     @09,COREPTRN                                        0357
         LH    @09,CORENBR(,@09)                                   0357
         ST    @09,IX                                              0357
         B     @DE00357                                            0357
@DL00357 DS    0H                                                  0358
*           R0=CORER0(IX);          /* SET FREEMAIN REG              */
         L     @15,COREPTRN                                        0358
         SLA   @09,3                                               0358
         L     R0,CORER0-8(@09,@15)                                0358
*           R1=COREPTR(IX);         /* SET FREEMAIN REG              */
         L     R1,COREPTR-8(@09,@15)                               0359
*           GEN(STM   R2,R3,TEMPSR);/* SAVE REGS                     */
         STM   R2,R3,TEMPSR
*           GEN(LM    R2,R3,LOCPTR);/* LOAD PTRS FOR SERVICE RTN     */
         LM    R2,R3,LOCPTR
*           GEN(FREEMAIN R,LV=(0),A=(1));/* FREE CONTROL BLOCK       */
         FREEMAIN R,LV=(0),A=(1)
*           GEN(LM     R2,R3,TEMPSR);/* RESTORE REGS                 */
         LM     R2,R3,TEMPSR
*         END;                                                     0364
         SLR   @09,@09                                             0364
         BCTR  @09,0                                               0364
         AL    @09,IX                                              0364
         ST    @09,IX                                              0364
@DE00357 LTR   @09,@09                                             0364
         BP    @DL00357                                            0364
*         COREPTR1=CORELAST;        /* STEP TO NEXT MAPPING BLOCK    */
         L     @09,COREPTRN                                        0365
         L     @15,CORELAST(,@09)                                  0365
         ST    @15,COREPTR1                                        0365
*         R0=COREDESC;              /* SET FREEMAIN REG              */
         L     R0,COREDESC(,@09)                                   0366
*         R1=COREPTRN;                                             0367
         LR    R1,@09                                              0367
*         GEN;                                                     0368
        STM   R2,R3,TEMPSR             SAVE REGS
        LM    R2,R3,LOCPTR             LOAD PTRS FOR SERVICE ROUTINE
        FREEMAIN  R,LV=(0),A=(1)       CLEAR
        LM    R2,R3,TEMPSR
*         COREPTRN=COREPTR1;        /* NEXT MAPPING BLOCK            */
         L     @09,COREPTR1                                        0369
         ST    @09,COREPTRN                                        0369
*       END;                                                       0370
@DE00356 L     @09,COREPTRN                                        0370
         LTR   @09,@09                                             0370
         BNZ   @DL00356                                            0370
*     END;                                                         0371
*   ELSE                            /* NOT TO MUCH ERROR             */
*     DO;                                                          0372
*                                                                  0372
         B     @RC00352                                            0372
@RF00352 DS    0H                                                  0373
*/* VSAM DATA SET IS UN OFFICIALLY OPEN                              */
*                                                                  0373
*       ACBOPEN=ON;                 /* SET OPEN FLAG                 */
         L     @09,ACBPTR                                          0373
         OI    ACBOPEN(@09),B'00010000'                            0373
*       IF NOCATLG=ON THEN          /* ARE WE OPENING THE CATALOG    */
         TM    NOCATLG,B'10000000'                                 0374
         BNO   @RF00374                                            0374
*         DO;                       /* NO , DO                       */
*                                                                  0375
*           /*********************************************************/
*           /*                                                       */
*           /* FREE AMBWORKS                                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0376
*           IF DATAWAPT^=ZERO THEN  /* DID WE GET AN AMBWORK         */
         L     @09,DATAWAPT                                        0376
         LTR   @09,@09                                             0376
         BZ    @RF00376                                            0376
*             DO;                                                  0377
*               FREELEN=SWKLEN;     /* SET LENGTH                    */
         LH    @15,SWKLEN                                          0378
         STH   @15,FREELEN                                         0378
*               FREEAD=DATAWAPT;    /* SET ADDRESS OF CORE TO BE   0379
*                                      FREED                         */
         ST    @09,FREEAD                                          0379
*               CALL FREEWORK;      /* CALL FREE WORKING STORAGE     */
         BAL   @14,FREEWORK                                        0380
*             END;                                                 0381
*           IF INDXWAPT^=ZERO THEN  /* IS THERE AN INDEX WORKAREA    */
@RF00376 L     @09,INDXWAPT                                        0382
         LTR   @09,@09                                             0382
         BZ    @RF00382                                            0382
*             DO;                   /* YES, DO                       */
*               FREELEN=SWKLEN;     /* SET LENGTH                    */
         LH    @15,SWKLEN                                          0384
         STH   @15,FREELEN                                         0384
*               FREEAD=INDXWAPT;    /* SET ADDRESS                   */
         ST    @09,FREEAD                                          0385
*               CALL FREEWORK;      /* CALL FREE WORKING STORAGE     */
         BAL   @14,FREEWORK                                        0386
*             END;                                                 0387
*         END;                                                     0388
@RF00382 DS    0H                                                  0389
*       R0=COREPTR1;                /* SETUP TO RETURN MAPPING BLK 0389
*                                      PTR                           */
@RF00374 L     R0,COREPTR1                                         0389
*       GEN REFS(R13) SETS(R0,R1);                                 0390
        L     R1,K4(R13)
        ST    R0,O24(R1)           MAPPING BLOCK PTR IN REG SAVE AREA
*     END;                                                         0391
*   RETURN CODE(ERFLAG);            /* RETURN TO CALLER              */
@RC00352 LH    @09,ERFLAG                                          0392
         L     @13,4(,@13)                                         0392
         L     @00,@SIZDATD                                        0392
         LR    @01,@08                                             0392
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@09                                             0392
         L     @14,12(,@13)                                        0392
         LM    @00,@12,20(@13)                                     0392
         BR    @14                                                 0392
*   RFY                                                            0393
*    (R0,                                                          0393
*     R1) UNRSTD;                                                  0393
*CATIN:                                                            0394
*                                                                  0394
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NEEDED, GET INFO FROM CATALOG. IN EITHER CASE MAKE         */
*   /* PRELIMINARY PREPARATIONS TO USE CATALOG INFORMATION.          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0394
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0394
@EL00001 L     @13,4(,@13)                                         0394
@EF00001 L     @00,@SIZDATD                                        0394
         LR    @01,@08                                             0394
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0394
         BR    @14                                                 0394
CATIN    DS    0H                                                  0395
*   RFY                                                            0395
*     IDAAMDSB BASED(ADDR(CTAMDSB));                               0395
*   RSAVLA=RET;                                                    0396
         ST    RET,RSAVLA                                          0396
*   IF NOCATLG=ON THEN              /* ARE WE OPENING THE CATLG?     */
         TM    NOCATLG,B'10000000'                                 0397
         BNO   @RF00397                                            0397
*     CALL CATLGINT;                /* NO GET INFO FROM CATLG        */
         BAL   @14,CATLGINT                                        0398
*   ELSE                            /* WE HAVE A CATLG               */
*     DO;                           /* INFO EXISTS MOVE POINTERS     */
         B     @RC00397                                            0399
@RF00397 DS    0H                                                  0400
*       DATAWAPT=DWKPTR;            /* POINTS TO DATA AMBWORK        */
         L     @09,DWKPTR                                          0400
         ST    @09,DATAWAPT                                        0400
*       INDXWAPT=IWKPTR;            /* POINTS TO INDEX AMBWORK       */
         L     @09,IWKPTR                                          0401
         ST    @09,INDXWAPT                                        0401
*     END;                                                         0402
*                                                                  0402
*/* MOVE SOME INFO FROM AMBWORK'S TO CLUSTER DESCRIPTION             */
*                                                                  0403
*   CWAPT=DATAWAPT;                 /* POINT TO DATA WORKAREA        */
@RC00397 L     CWAPT,DATAWAPT                                      0403
*   AMACATLG=ADDR(IDACLDSC);        /* ADDR OF CLUSTER DESCRIPTION   */
         LA    @09,IDACLDSC                                        0404
         ST    @09,AMACATLG(,CWAPT)                                0404
*   CTDDSN=CTHSHDSN;                /* CI NBR FOR DATA ENTRY         */
         MVC   CTDDSN(3),CTHSHDSN(CWAPT)                           0405
*   CTCISIZD=CTCISIZ;               /* CI SIZE FOR DATA              */
         L     @09,CTCISIZ(,CWAPT)                                 0406
         ST    @09,CTCISIZD                                        0406
*   CTFLG1=CTAUTH;                  /* SET AUTHORIZATION             */
         MVC   CTFLG1(1),CTAUTH(CWAPT)                             0407
*   IF CTRDONLY=ON THEN             /* READ ONLY?                    */
         TM    CTRDONLY(CWAPT),B'00000100'                         0408
         BNO   @RF00408                                            0408
*     CTFLG1=ZERO;                  /* YES, INDICATE                 */
         MVI   CTFLG1,X'00'                                        0409
*   CTAMBNO=ONE;                    /* INDICATE ONE AMB              */
@RF00408 MVC   CTAMBNO(4),@CF00076                                 0410
*   IF INDXWAPT^=ZERO THEN          /* IS THERE AN INDEX?            */
         L     @09,INDXWAPT                                        0411
         LTR   @09,@09                                             0411
         BZ    @RF00411                                            0411
*     DO;                           /* YES, DO                       */
*       CWAPT=INDXWAPT;             /* SET PTR TO INDEX AMBWORK      */
         LR    CWAPT,@09                                           0413
*       AMACATLG=ADDR(IDACLDSC);    /* SET CI SIZE FOR INDEX         */
         LA    @09,IDACLDSC                                        0414
         ST    @09,AMACATLG(,CWAPT)                                0414
*       CTCISIZI=CTCISIZ;           /* SET CI SIZE FOR INDEX         */
         L     @09,CTCISIZ(,CWAPT)                                 0415
         ST    @09,CTCISIZI                                        0415
*       IF CTRDONLY='0'B THEN       /* IS INDEX READ ONLY?           */
         TM    CTRDONLY(CWAPT),B'00000100'                         0416
         BNZ   @RF00416                                            0416
*         CTFLG1=ZERO;              /* CLUSTER IS READ ONLY          */
         MVI   CTFLG1,X'00'                                        0417
*       CTAMBNO=TWO;                /* INDICATE 2 AMBS               */
@RF00416 MVC   CTAMBNO(4),@CF00044                                 0418
*     END;                                                         0419
*   ELSE                            /* NO INDEX                      */
*     CTCISIZI=ZERO;                /* INDICATE NO INDEX             */
         B     @RC00411                                            0420
@RF00411 SLR   @09,@09                                             0420
         ST    @09,CTCISIZI                                        0420
*   RET=RSAVLA;                     /* RETURN ADDRESS                */
@RC00411 L     RET,RSAVLA                                          0421
*   END CATIN;                                                     0422
@EL00002 DS    0H                                                  0422
@EF00002 DS    0H                                                  0422
@ER00002 BR    @14                                                 0422
*CATLGINT:                                                         0423
*                                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE AND USE AND INTERFACE TO THE CATALOG INPUT IS THE      */
*   /* DATASET NAME OUTPUT IS ONE OR 2 AMBWORK AREAS                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0423
CATLGINT DS    0H                                                  0424
*   RSAVLB=RET;                     /* SAVE RETURN ADDRESS           */
         ST    RET,RSAVLB                                          0424
*   WKLEN=SWKLEN*TWO;               /* INDICATE LENGTH FOR GETMAIN   */
         LH    @09,SWKLEN                                          0425
         ALR   @09,@09                                             0425
         STH   @09,WKLEN                                           0425
*   CALL GETWORK;                   /* GET WORKING STORAGE           */
         BAL   @14,GETWORK                                         0426
*   CTGPLPTR=WKCORE;                /* PT TO CAT PARMLIST            */
         L     @03,WKCORE                                          0427
         LR    CTGPLPTR,@03                                        0427
*   CTGFLPTR=CTGPLPTR+              /* PT TO LIST FIELD              */
*       LENGTH(CTGPL)+              /* WHICH FOLLOWS CAT PARMLIST    */
*       LENGTH(CTGFIELD)*SIX;       /* ALLOW FOR 6 FIELD PTRS        */
         LA    CTGFLPTR,52                                         0428
         ALR   CTGFLPTR,CTGPLPTR                                   0428
*   CATWKPTR=CTGFLPTR+              /* PT TO CATLG WORKAREA          */
*       (LENGTH(CTGFL)+             /* WHICH FOLLOWS FIELD LISTS     */
*       LENGTH(CTGFLDAT))*H18;      /* ALLOW FOR 18 FIELD LISTS      */
         LA    CATWKPTR,432                                        0429
         ALR   CATWKPTR,CTGFLPTR                                   0429
*   CATWKPTR=((CATWKPTR+SEVEN)/EIGHT)*EIGHT;/* ROUND TO DWORD BDY    */
         LA    @00,7                                               0430
         ALR   @00,CATWKPTR                                        0430
         SRDA  @00,32                                              0430
         D     @00,@CF00058                                        0430
         SLA   @01,3                                               0430
         LR    CATWKPTR,@01                                        0430
*   WORKLEN=WKCORE+SWKLEN*TWO-      /* COMPUTE LENGTH OF WORK AREA   */
*       CATWKPTR;                   /*                               */
         LH    @07,SWKLEN                                          0431
         ALR   @07,@07                                             0431
         ALR   @03,@07                                             0431
         SLR   @03,CATWKPTR                                        0431
         STH   @03,WORKLEN(,CATWKPTR)                              0431
*   CATBLKLN=CATWKPTR-CTGPLPTR;     /* LENGTH OF CTGPL & CTGFL BLOCKS*/
         LR    @15,CATWKPTR                                        0432
         SLR   @15,CTGPLPTR                                        0432
         ST    @15,CATBLKLN                                        0432
*   WKLEN=SWKLEN*TWO;               /* SET LENGTH FOR GETMAIN        */
         STH   @07,WKLEN                                           0433
*   CALL GETWORK;                   /* GET SPAC FOR AMBWORKS         */
         BAL   @14,GETWORK                                         0434
*   DATAWAPT=WKCORE;                /* SET PTR TO DATA AMBWORK       */
         L     @07,WKCORE                                          0435
         ST    @07,DATAWAPT                                        0435
*   INDXWAPT=WKCORE+SWKLEN;         /* SET PTR TO INDEX AMBWORK      */
         LH    @04,SWKLEN                                          0436
         LR    @15,@07                                             0436
         ALR   @15,@04                                             0436
         ST    @15,INDXWAPT                                        0436
*   CWAPT=DATAWAPT;                 /* ADDRESSABILITY                */
         LR    CWAPT,@07                                           0437
*   AMALEN=SWKLEN;                  /* SET LENGTH FOR FREEMAIN ECT   */
         STH   @04,AMALEN(,CWAPT)                                  0438
*   CWAPT=INDXWAPT;                 /* ADDRESSABILITY                */
         LR    CWAPT,@15                                           0439
*   AMALEN=SWKLEN;                  /* SET LENGTH                    */
         STH   @04,AMALEN(,CWAPT)                                  0440
*   CALL LOC1;                      /* LOCATE CI NBRS & CATACB       */
         BAL   @14,LOC1                                            0441
*   CALL LOC2;                      /* LOCATE MISC DATA SET ATTR     */
         BAL   @14,LOC2                                            0442
*   CALL LOC3;                      /* LOCATE VOLUME INFO            */
         BAL   @14,LOC3                                            0443
*   FREEAD=CTGPLPTR;                /* SET UP TO FREE LOCATE LIST    */
         ST    CTGPLPTR,FREEAD                                     0444
*   FREELEN=CATBLKLN;               /*                               */
         L     @15,CATBLKLN                                        0445
         STH   @15,FREELEN                                         0445
*   CALL FREEWORK;                  /* FREE THE LOCATE PARM LIST     */
         BAL   @14,FREEWORK                                        0446
*   FREEAD=CATWKPTR;                /* POINT TO LOCATE WKAREA        */
         ST    CATWKPTR,FREEAD                                     0447
*   FREELEN=WORKLEN;                /* SET LENGTH                    */
         LH    @15,WORKLEN(,CATWKPTR)                              0448
         STH   @15,FREELEN                                         0448
*   CALL FREEWORK;                  /* FREE LOCATE WORKAREA          */
         BAL   @14,FREEWORK                                        0449
*   RET=RSAVLB;                     /* SET RETURN ADDR               */
         L     RET,RSAVLB                                          0450
*   END;                                                           0451
@EL00003 DS    0H                                                  0451
@EF00003 DS    0H                                                  0451
@ER00003 BR    @14                                                 0451
*LOC1:                                                             0452
*                                                                  0452
*   /*****************************************************************/
*   /*                                                               */
*   /* ON THIS FIRST CALL TO THE CATALOG, WE GET DATA SET TYPE, CI   */
*   /* NBR(S) AND A POINTER TO THE CATALOG ACB                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0452
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0452
LOC1     DS    0H                                                  0453
*   RSAVLC=RET;                     /* SAVE RETURN                   */
         ST    RET,RSAVLC                                          0453
*   IX=LENGTH(LOCDES);              /* SET UP TO CLEAR               */
         MVC   IX(4),@CF04196                                      0454
*   GEN REFS(IX) NOSETS;                                           0455
        STM   R2,R5,TEMPSR           SAVE REGS
        L     R5,IX
        LA    R4,LOCDES
        SR    R3,R3
        SR    R2,R2
        MVCL  R4,R2                    CLEAR LOCATE DESC RECORD
        LM    R2,R5,TEMPSR
*   NAME44=ON;                      /* LOCATE BY NAME                */
         OI    NAME44,B'10000000'                                  0456
*   FLACTIVE(1,1)=ON;                                              0457
         OI    FLACTIVE,B'10000000'                                0457
*   FLACTIVE(2,1)=ON;               /* ACTIVATE 3 FIELDS             */
         OI    FLACTIVE+60,B'10000000'                             0458
*   FLACTIVE(3,1)=ON;                                              0459
         OI    FLACTIVE+120,B'10000000'                            0459
*   FLACTIVE(4,1)=ON;                                              0460
         OI    FLACTIVE+180,B'10000000'                            0460
*   FLNAME(1,1)='DSTYPNAM';         /* DATA SET TYPE - NAME          */
         MVC   FLNAME(8),@CC04010                                  0461
*   FLNAME(2,1)='CATACB  ';         /* INIT SYMBOLIC FIELD NAMES     */
         MVC   FLNAME+60(8),@CC04011                               0462
*   FLNAME(3,1)='NAMEDS  ';         /* ASSOCIATED NAMES              */
         MVC   FLNAME+120(8),@CC04012                              0463
*   FLNAME(4,1)='CATTR   ';         /* CLUSTER ATTRIBUTES            */
         MVC   FLNAME+180(8),@CC04013                              0464
*   DSNDD=' ';                      /* CLEAR TO BLANKS               */
         MVI   DSNDD+1,C' '                                        0465
         MVC   DSNDD+2(42),DSNDD+1                                 0465
         MVI   DSNDD,C' '                                          0465
*   DSNDD(1:DSNSIZE)=DSN(1:DSNSIZE);/* INIT DSN                      */
         L     @07,ACBPTR                                          0466
         L     @07,NIPSPPTR(,@07)                                  0466
         SLR   @15,@15                                             0466
         IC    @15,DSNSIZE(,@07)                                   0466
         BCTR  @15,0                                               0466
         EX    @15,@SM04228                                        0466
*   CALL CTINTRFC;                  /* INIT CTGPL,CTGFL & ISSUE SVC
*                                      26                            */
         BAL   @14,CTINTRFC                                        0467
*   CTGFLPTR=CTGFIELD(ONE);         /* INIT CURRENT FIELD            */
         L     CTGFLPTR,CTGFIELD(,CTGPLPTR)                        0468
*   CALL TESTLOC;                   /* TEST LOCATE                   */
         BAL   @14,TESTLOC                                         0469
*   MEMNUM=ONE;                     /* INDICATE 1 CLUSTER MEMBER     */
         MVI   MEMNUM,X'01'                                        0470
*   IF ENTYPE='C' THEN              /* WAS ENTRY A CLUSTER           */
         L     @07,CTGFLPT(,CTGFLPTR)                              0471
         CLI   ENTYPE(@07),C'C'                                    0471
         BNE   @RF00471                                            0471
*     DO;                           /* YES                           */
*       DSNCCI=ENTIDNO;             /* RECORD CLUSTER CI             */
         MVC   DSNCCI(3),ENTIDNO(@07)                              0473
*       CTGFLPTR=CTGFIELD(THREE);   /* ADDRESSABILITY FOR THIRD FIELD*/
         L     CTGFLPTR,CTGFIELD+8(,CTGPLPTR)                      0474
*       CALL TESTLOC;               /* TEST LOCATE                   */
         BAL   @14,TESTLOC                                         0475
*       IF TYPE='D' THEN            /* DATA ENTRY ?                  */
         L     @07,CTGFLPT(,CTGFLPTR)                              0476
         CLI   TYPE(@07),C'D'                                      0476
         BNE   @RF00476                                            0476
*         DO;                       /* YES                           */
*           DSNDCI=NAME;            /* RECORD DATA CI                */
         MVC   DSNDCI(3),NAME(@07)                                 0478
*           CWAPT=DATAWAPT;         /* PT TO DATA AMBWORK            */
         L     CWAPT,DATAWAPT                                      0479
*         END;                                                     0480
*       ELSE                        /* NOT DATA ENTRY                */
*         DO;                                                      0481
         B     @RC00476                                            0481
@RF00476 DS    0H                                                  0482
*           DSNICI=NAME;            /* RECORD INDEX CI               */
         L     @07,CTGFLPT(,CTGFLPTR)                              0482
         MVC   DSNICI(3),NAME(@07)                                 0482
*           CWAPT=INDXWAPT;         /* POINT TO INDEX AMBWORK        */
         L     CWAPT,INDXWAPT                                      0483
*         END;                                                     0484
*       CTHSHDSN=NAME;              /* CI NBR IN AMBWORK             */
@RC00476 L     @07,CTGFLPT(,CTGFLPTR)                              0485
         MVC   CTHSHDSN(3,CWAPT),NAME(@07)                         0485
*       IF CWAPT=DATAWAPT THEN      /* WORKING ON DATA AMBWORK?      */
         C     CWAPT,DATAWAPT                                      0486
         BNE   @RF00486                                            0486
*         CWAPT=INDXWAPT;           /* YES, SWITCH TO INDEX          */
         L     CWAPT,INDXWAPT                                      0487
*       ELSE                        /* WORKING ON INDEX              */
*         CWAPT=DATAWAPT;                                          0488
         B     @RC00486                                            0488
@RF00486 L     CWAPT,DATAWAPT                                      0488
*       IF CTGFLNG(ONE)>LENGTH(NAMEDS) THEN/* INDEXED DS             */
@RC00486 LA    @07,4                                               0489
         C     @07,CTGFLNG(,CTGFLPTR)                              0489
         BNL   @RF00489                                            0489
*         DO;                       /* YES                           */
*           MEMNUM=TWO;             /* SET NBR DATA SETS TO 2        */
         MVI   MEMNUM,X'02'                                        0491
*           CTGFLPT(ONE)=CTGFLPT(ONE)+LENGTH(NAMEDS);/* ADDRESABILITY
*                                      FOR NEXT NAMEDS               */
         AL    @07,CTGFLPT(,CTGFLPTR)                              0492
         ST    @07,CTGFLPT(,CTGFLPTR)                              0492
*           IF TYPE='D' THEN        /* DATA                          */
         CLI   TYPE(@07),C'D'                                      0493
         BNE   @RF00493                                            0493
*             DSNDCI=NAME;          /* RECORD DATA CI                */
         MVC   DSNDCI(3),NAME(@07)                                 0494
*           ELSE                    /* INDEX                         */
*             DSNICI=NAME;          /* RECORD INDEX CI               */
         B     @RC00493                                            0495
@RF00493 L     @07,CTGFLPT(,CTGFLPTR)                              0495
         MVC   DSNICI(3),NAME(@07)                                 0495
*           CTHSHDSN=NAME;          /* RECORD IN AMBWORK             */
@RC00493 L     @07,CTGFLPT(,CTGFLPTR)                              0496
         MVC   CTHSHDSN(3,CWAPT),NAME(@07)                         0496
*         END;                                                     0497
*       CTGFLPTR=CTGFIELD(FOUR);    /* CHECK FOR PAGE SPACE          */
@RF00489 L     CTGFLPTR,CTGFIELD+12(,CTGPLPTR)                     0498
*       CALL TESTLOC;               /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0499
*       IF PGSPFLG=ON THEN          /* IS PAGE SPACE?                */
         L     @07,CTGFLPT(,CTGFLPTR)                              0500
         TM    PGSPFLG(@07),B'00000001'                            0500
         BNO   @RF00500                                            0500
*         SWPGSP=ON;                /* YES, INDICATE                 */
         OI    SWPGSP,B'01000000'                                  0501
*     END;                                                         0502
@RF00500 DS    0H                                                  0503
*   IF MEMNUM^=TWO THEN             /* NOT A CLUSTER ENTRY           */
@RF00471 CLI   MEMNUM,2                                            0503
         BE    @RF00503                                            0503
*     DO;                                                          0504
*       IF DSNDCI=ZERO THEN         /* DATA SET INIT                 */
         SLR   @07,@07                                             0505
         SLR   @03,@03                                             0505
         ICM   @03,7,DSNDCI                                        0505
         CR    @07,@03                                             0505
         BNE   @RF00505                                            0505
*         IF DSNICI^=ZERO THEN      /* DO WE HAVE AN INDEX           */
         SLR   @03,@03                                             0506
         ICM   @03,7,DSNICI                                        0506
         CR    @07,@03                                             0506
         BE    @RF00506                                            0506
*           DSNDCI=DSNICI;          /* PROCESSINDEX AS DATA          */
         MVC   DSNDCI(3),DSNICI                                    0507
*         ELSE                      /* IS CLUSTER                    */
*           DSNDCI=ENTIDNO;         /* NOW CLUSTER-INIT CI           */
         B     @RC00506                                            0508
@RF00506 L     @07,CTGFLPT(,CTGFLPTR)                              0508
         MVC   DSNDCI(3),ENTIDNO(@07)                              0508
*       CWAPT=DATAWAPT;                                            0509
@RC00506 DS    0H                                                  0509
@RF00505 L     CWAPT,DATAWAPT                                      0509
*       CTHSHDSN=DSNDCI;                                           0510
         MVC   CTHSHDSN(3,CWAPT),DSNDCI                            0510
*       FREELEN=SWKLEN;                                            0511
         LH    @07,SWKLEN                                          0511
         STH   @07,FREELEN                                         0511
*       FREEAD=INDXWAPT;                                           0512
         L     @07,INDXWAPT                                        0512
         ST    @07,FREEAD                                          0512
*       CALL FREEWORK;              /* FREE WORKING STORAGE          */
         BAL   @14,FREEWORK                                        0513
*       INDXWAPT=ZERO;              /* CLEAR POINTER NO INDEX        */
         SLR   @07,@07                                             0514
         ST    @07,INDXWAPT                                        0514
*     END;                                                         0515
*   CTGFLPTR=CTGFIELD(TWO);         /* ADDRESSABILITY TO SECOND FIELD*/
@RF00503 L     CTGFLPTR,CTGFIELD+4(,CTGPLPTR)                      0516
*   CWAPT=DATAWAPT;                 /* POINT TO DATA AMBWORK         */
         L     CWAPT,DATAWAPT                                      0517
*   CALL TESTLOC;                   /* TEST LOCATE                   */
         BAL   @14,TESTLOC                                         0518
*   DSCATACB=CATACB;                /* NOTE CAT ACB ADDR             */
         L     @07,CTGFLPT(,CTGFLPTR)                              0519
         L     @07,CATACB(,@07)                                    0519
         ST    @07,DSCATACB                                        0519
*   CTHSHCAT=CATACB;                                               0520
         ST    @07,CTHSHCAT(,CWAPT)                                0520
*   IF MEMNUM=TWO THEN              /* DO WE HAVE AN INDEX           */
         CLI   MEMNUM,2                                            0521
         BNE   @RF00521                                            0521
*     INDXWAPT->CTHSHCAT=CATACB;                                   0522
         L     @03,INDXWAPT                                        0522
         ST    @07,CTHSHCAT(,@03)                                  0522
*   RET=RSAVLC;                                                    0523
@RF00521 L     RET,RSAVLC                                          0523
*   END LOC1;                                                      0524
@EL00004 DS    0H                                                  0524
@EF00004 DS    0H                                                  0524
@ER00004 BR    @14                                                 0524
*LOC2:                                                             0525
*                                                                  0525
*   /*****************************************************************/
*   /*                                                               */
*   /* GET SECOND GROUP OF LOCATE FIELDS                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0525
LOC2     DS    0H                                                  0526
*   RSAVLC=RET;                                                    0526
         ST    RET,RSAVLC                                          0526
*   LOCTYPE=ZERO;                   /* CLR LOCATE DESCRIPTER REC     */
         MVI   LOCTYPE,X'00'                                       0527
*   DSNCI=DSNDCI;                   /* PROCESS DATA SET FIRST        */
         MVC   DSNCI(3),DSNDCI                                     0528
*   ID3=ON;                         /* INDICATE LOCATE BY CI NBR     */
         OI    ID3,B'00100000'                                     0529
*   DO IX=1 TO 6;                                                  0530
         LA    @07,1                                               0530
         ST    @07,IX                                              0530
@DL00530 DS    0H                                                  0531
*     FLACTIVE(IX,1)=ON;            /* INDICATE 6 FIELDS             */
         LR    @15,@07                                             0531
         MH    @15,@CH03052                                        0531
         LA    @14,FLACTIVE-60(@15)                                0531
         OI    0(@14),B'10000000'                                  0531
*   END;                                                           0532
         AL    @07,@CF00076                                        0532
         ST    @07,IX                                              0532
         C     @07,@CF00113                                        0532
         BNH   @DL00530                                            0532
*   FLNAME(1,1)='OWNERID ';                                        0533
         MVC   FLNAME(8),@CC04020                                  0533
*   FLNAME(2,1)='DSATTR  ';                                        0534
         MVC   FLNAME+60(8),@CC04021                               0534
*   FLNAME(3,1)='BUFSIZE ';                                        0535
         MVC   FLNAME+120(8),@CC04022                              0535
*   FLNAME(4,1)='ENTNAME ';                                        0536
         MVC   FLNAME+180(8),@CC04023                              0536
*   FLNAME(5,1)='AMDSBCAT';                                        0537
         MVC   FLNAME+240(8),@CC04024                              0537
*   FLNAME(6,1)='HURBADS ';                                        0538
         MVC   FLNAME+300(8),@CC04025                              0538
*   CWAPT=DATAWAPT;                                                0539
         L     CWAPT,DATAWAPT                                      0539
*   DO IX6=1 TO MEMNUM;             /* PROCESS DATA AND INDEX        */
         LA    @07,1                                               0540
         B     @DE00540                                            0540
@DL00540 DS    0H                                                  0541
*     CALL CTINTRFC;                /* CATLG INTERFACE RTN           */
         BAL   @14,CTINTRFC                                        0541
*     CTGFLPTR=CTGFIELD(ONE);                                      0542
         L     CTGFLPTR,CTGFIELD(,CTGPLPTR)                        0542
*     CALL TESTLOC;                 /* TEST FOR SUCCESSFULL LOCATE   */
         BAL   @14,TESTLOC                                         0543
*     CTGFLPTR=CTGFIELD(TWO);       /* NEXT FIELD                    */
         L     CTGFLPTR,CTGFIELD+4(,CTGPLPTR)                      0544
*     CALL TESTLOC;                 /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0545
*     CTATTRA=DSATTR;               /* INIT DS OPTIONS               */
         L     @07,CTGFLPT(,CTGFLPTR)                              0546
         MVC   CTATTRA(1,CWAPT),DSATTR(@07)                        0546
*     IF CROSSREG=SHRF THEN         /* FULL INTEGRITY?               */
         TM    CROSSREG(@07),B'11000000'                           0547
         BNZ   @RF00547                                            0547
*       CTSHRF=ON;                  /* YES                           */
         OI    CTSHRF(CWAPT),B'00100000'                           0548
*     ELSE                          /* NOT FULL INTEGRITY            */
*       IF CROSSREG=SHRW THEN       /* WRITE INTEGRITY?              */
         B     @RC00547                                            0549
@RF00547 L     @07,CTGFLPT(,CTGFLPTR)                              0549
         TM    CROSSREG(@07),B'01000000'                           0549
         BNO   @RF00549                                            0549
         TM    CROSSREG(@07),B'10000000'                           0549
         BNZ   @RF00549                                            0549
*         CTSHRW=ON;                /* YES                           */
         OI    CTSHRW(CWAPT),B'01000000'                           0550
*       ELSE                        /* NOT WRITE INTEGRITY           */
*         IF CROSSREG=SHR THEN      /* FULL SHR?                     */
         B     @RC00549                                            0551
@RF00549 L     @07,CTGFLPT(,CTGFLPTR)                              0551
         TM    CROSSREG(@07),B'10000000'                           0551
         BNO   @RF00551                                            0551
         TM    CROSSREG(@07),B'01000000'                           0551
         BNZ   @RF00551                                            0551
*           CTSHARE=ON;             /* YES                           */
         OI    CTSHARE(CWAPT),B'10000000'                          0552
*         ELSE                      /* NOT FULL SHR - SOMETHING WRONG*/
*           CTHELP=ON;              /* INVALIDATE BFRS               */
         B     @RC00551                                            0553
@RF00551 OI    CTHELP(CWAPT),B'00010000'                           0553
*     IF CROSSSYS=HELP THEN         /* SHARED DASD BFR INVALIDATION  */
@RC00551 DS    0H                                                  0554
@RC00549 DS    0H                                                  0554
@RC00547 L     @07,CTGFLPT(,CTGFLPTR)                              0554
         TM    CROSSSYS(@07),B'00110000'                           0554
         BNO   @RF00554                                            0554
*       CTSDHELP=ON;                                               0555
         OI    CTSDHELP(CWAPT),B'00001000'                         0555
*     CTGFLPTR=CTGFIELD(THREE);     /* NEXT FIELD                    */
@RF00554 L     CTGFLPTR,CTGFIELD+8(,CTGPLPTR)                      0556
*     CALL TESTLOC;                 /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0557
*     CTBUFSIZ=BUFSIZE;             /* INIT BUFSIZE                  */
         L     @07,CTGFLPT(,CTGFLPTR)                              0558
         L     @07,BUFSIZE(,@07)                                   0558
         ST    @07,CTBUFSIZ(,CWAPT)                                0558
*     CTGFLPTR=CTGFIELD(FOUR);      /* NEXT FIELD                    */
         L     CTGFLPTR,CTGFIELD+12(,CTGPLPTR)                     0559
*     CALL TESTLOC;                 /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0560
*     CTDATANM=ENTNAME;             /* INIT DSN                      */
         L     @07,CTGFLPT(,CTGFLPTR)                              0561
         MVC   CTDATANM(44,CWAPT),ENTNAME(@07)                     0561
*     CTGFLPTR=CTGFIELD(FIVE);      /* NEXT FIELD                    */
         L     CTGFLPTR,CTGFIELD+16(,CTGPLPTR)                     0562
*     CALL TESTLOC;                 /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0563
*     IX2=LENGTH(IDAAMDSB);                                        0564
         LA    @07,96                                              0564
         ST    @07,IX2                                             0564
*     CTAMDSB(1:IX2)=AMDSBCAT(1:IX2);/* INIT AMDSB                   */
         BCTR  @07,0                                               0565
         L     @04,CTGFLPT(,CTGFLPTR)                              0565
         EX    @07,@SM04230                                        0565
*     CTCISIZ=AMDCINV;                                             0566
         L     @07,AMDCINV+132(,CWAPT)                             0566
         ST    @07,CTCISIZ(,CWAPT)                                 0566
*     CTGFLPTR=CTGFIELD(SIX);       /* NEXT FIELD                    */
         L     CTGFLPTR,CTGFIELD+20(,CTGPLPTR)                     0567
*     CALL TESTLOC;                 /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0568
*     CTHURBA=HURBADS;              /* INIT DS HI RBA                */
         L     @07,CTGFLPT(,CTGFLPTR)                              0569
         L     @07,HURBADS(,@07)                                   0569
         ST    @07,CTHURBA(,CWAPT)                                 0569
*     DSNCI=DSNICI;                 /* CURRENT CI NBR IS INDEX       */
         MVC   DSNCI(3),DSNICI                                     0570
*     CWAPT=INDXWAPT;               /* SET UP FOR INDEX LOOP THROUGH */
         L     CWAPT,INDXWAPT                                      0571
*   END;                            /* DO LOOP                       */
         LA    @07,1                                               0572
         AL    @07,IX6                                             0572
@DE00540 ST    @07,IX6                                             0572
         SLR   @04,@04                                             0572
         IC    @04,MEMNUM                                          0572
         CR    @07,@04                                             0572
         BNH   @DL00540                                            0572
*   DO IX=1 TO 6;                                                  0573
         LA    @07,1                                               0573
         ST    @07,IX                                              0573
@DL00573 DS    0H                                                  0574
*     FLACTIVE(IX,1)=OFFX;          /* CLEAR FLAG                    */
         LR    @15,@07                                             0574
         MH    @15,@CH03052                                        0574
         LA    @14,FLACTIVE-60(@15)                                0574
         NI    0(@14),B'01111111'                                  0574
*   END;                                                           0575
         AL    @07,@CF00076                                        0575
         ST    @07,IX                                              0575
         C     @07,@CF00113                                        0575
         BNH   @DL00573                                            0575
*   RET=RSAVLC;                                                    0576
         L     RET,RSAVLC                                          0576
*   END LOC2;                                                      0577
@EL00005 DS    0H                                                  0577
@EF00005 DS    0H                                                  0577
@ER00005 BR    @14                                                 0577
*LOC3:                                                             0578
*                                                                  0578
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THIRD GROUP OF CATLG FIELDS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0578
LOC3     DS    0H                                                  0579
*   RSAVLC=RET;                                                    0579
         ST    RET,RSAVLC                                          0579
*   LOCTYPE=ZERO;                   /* CLR LOCATE DESCRIPTER REC     */
         MVI   LOCTYPE,X'00'                                       0580
*   ID3=ON;                         /* INDICATE LOCATE BY CI         */
         OI    ID3,B'00100000'                                     0581
*   FLACTIVE(1,1)=ON;               /* INDICATE FIELD IS ACTIVE      */
         OI    FLACTIVE,B'10000000'                                0582
*   FLNAME(1,1)='VOLDEV  ';         /* INIT FIELD NAME               */
         MVC   FLNAME(8),@CC04029                                  0583
*   FLACTIVE(1,2)=ON;                                              0584
         OI    FLACTIVE+20,B'10000000'                             0584
*   FLNAME(1,2)='ITYPEXT ';                                        0585
         MVC   FLNAME+20(8),@CC04030                               0585
*   FLTSTPTR(1,2)=ADDR(SSTEST);     /* INIT PTR TO TEST DATA         */
         LA    @07,SSTEST                                          0586
         ST    @07,FLTSTPTR+20                                     0586
*   FLTSTLEN(1,2)=ONE;              /* INIT LENGTH OF TEST DATA      */
         LA    @04,1                                               0587
         ST    @04,FLTSTLEN+20                                     0587
*   FLCOND(1,2)='10'X;              /* INDICATE TYPE OF TEST         */
         MVI   FLCOND+20,X'10'                                     0588
*   FLACTIVE(2,1)=ON;                                              0589
         OI    FLACTIVE+60,B'10000000'                             0589
*   FLNAME(2,1)='VOLDEV  ';                                        0590
         MVC   FLNAME+60(8),@CC04029                               0590
*   FLACTIVE(2,2)=ON;                                              0591
         OI    FLACTIVE+80,B'10000000'                             0591
*   FLNAME(2,2)='ITYPEXT ';                                        0592
         MVC   FLNAME+80(8),@CC04030                               0592
*   FLTSTPTR(2,2)=ADDR(SSTEST);                                    0593
         ST    @07,FLTSTPTR+80                                     0593
*   FLTSTLEN(2,2)=ONE;                                             0594
         ST    @04,FLTSTLEN+80                                     0594
*   FLCOND(2,2)='80'X;                                             0595
         MVI   FLCOND+80,X'80'                                     0595
*   FLACTIVE(3,1)=ON;                                              0596
         OI    FLACTIVE+120,B'10000000'                            0596
*   FLNAME(3,1)='VOLPHY  ';                                        0597
         MVC   FLNAME+120(8),@CC04031                              0597
*   DSNCI=DSNDCI;                   /* INIT DATA CI NBR              */
         MVC   DSNCI(3),DSNDCI                                     0598
*   CWAPT=DATAWAPT;                                                0599
         L     CWAPT,DATAWAPT                                      0599
*   CALL CTINTRFC;                  /* CATLG INTERFACE RTN           */
         BAL   @14,CTINTRFC                                        0600
*   CALL MERGVOL;                   /* MERGE INFO INTO AMBWORK       */
         BAL   @14,MERGVOL                                         0601
*   IF MEMNUM^=ONE THEN             /* CLUSTER                       */
         CLI   MEMNUM,1                                            0602
         BE    @RF00602                                            0602
*     DO;                                                          0603
*       DSNCI=DSNICI;               /* INIT INDEX CI NBR             */
         MVC   DSNCI(3),DSNICI                                     0604
*       CWAPT=INDXWAPT;                                            0605
         L     CWAPT,INDXWAPT                                      0605
*       CALL CTINTRFC;              /* CATLG INTERFACE RTN           */
         BAL   @14,CTINTRFC                                        0606
*       CALL MERGVOL;               /* MERGE INFO INTO AMBWORK       */
         BAL   @14,MERGVOL                                         0607
*     END;                                                         0608
*   RET=RSAVLC;                                                    0609
@RF00602 L     RET,RSAVLC                                          0609
*   END LOC3;                                                      0610
@EL00006 DS    0H                                                  0610
@EF00006 DS    0H                                                  0610
@ER00006 BR    @14                                                 0610
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* MERGE INFORMATION FROM LOCATE FIELDS INTO AMBWORK             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0611
*MERGVOL:                                                          0611
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0611
MERGVOL  DS    0H                                                  0612
*   RSAVLD=RET;                                                    0612
         ST    RET,RSAVLD                                          0612
*   CTGFLPTR=CTGFIELD(ONE);         /* POINT TO FIRST LOCATE FIELD   */
         L     CTGFLPTR,CTGFIELD(,CTGPLPTR)                        0613
*   SW1=OFFX;                       /* CLEAR SW                      */
         NI    SW1,B'01111111'                                     0614
*   IF CTGFLPT(ONE)^=ZERO THEN      /* LOCATE SUCCESSFUL?            */
         L     @07,CTGFLPT(,CTGFLPTR)                              0615
         LTR   @07,@07                                             0615
         BZ    @RF00615                                            0615
*     DO;                           /* YES                           */
*       CTSTRKAU=NOTRKAU;           /* TRACK/ALLOC UNIT TO AMBWORK   */
         LH    @04,NOTRKAU(,@07)                                   0617
         ST    @04,CTSTRKAU(,CWAPT)                                0617
*       CTSBLKTR=NOBLKTRK;          /* BLK/TRK TO AMBWORK            */
         LH    @04,NOBLKTRK(,@07)                                  0618
         ST    @04,CTSBLKTR(,CWAPT)                                0618
*       CTSBYTRK=NOBYTTRK;          /* SET INCASE OF TRKOVFL         */
         L     @04,NOBYTTRK(,@07)                                  0619
         ST    @04,CTSBYTRK(,CWAPT)                                0619
*       CTSBYTAU=NOBYTAU;           /* SET IN CASE OF TRKOVFL        */
         L     @07,NOBYTAU(,@07)                                   0620
         ST    @07,CTSBYTAU(,CWAPT)                                0620
*       SW1=ON;                                                    0621
         OI    SW1,B'10000000'                                     0621
*     END;                                                         0622
*   CTGFLPTR=CTGFIELD(TWO);         /* PT TO 2ND LOCATE FIELD        */
@RF00615 L     CTGFLPTR,CTGFIELD+4(,CTGPLPTR)                      0623
*   IF CTGFLPT(ONE)^=ZERO THEN      /* LOCATE SUCCESSFUL?            */
         L     @07,CTGFLPT(,CTGFLPTR)                              0624
         LTR   @07,@07                                             0624
         BZ    @RF00624                                            0624
*     DO;                           /* YES                           */
*       CTTRKAU=NOTRKAU;            /* TRK/ALLOC TO AMB WORK         */
         LH    @04,NOTRKAU(,@07)                                   0626
         ST    @04,CTTRKAU(,CWAPT)                                 0626
*       CTBLKTR=NOBLKTRK;           /* BLK/TRK TO AMB WORK           */
         LH    @04,NOBLKTRK(,@07)                                  0627
         ST    @04,CTBLKTR(,CWAPT)                                 0627
*       CTBYTTRK=NOBYTTRK;          /* SET FOR TRACK OVERFLOW        */
         L     @04,NOBYTTRK(,@07)                                  0628
         ST    @04,CTBYTTRK(,CWAPT)                                0628
*       CTBYTAU=NOBYTAU;            /* SET FOR POS TRK OVERFLOW      */
         L     @07,NOBYTAU(,@07)                                   0629
         ST    @07,CTBYTAU(,CWAPT)                                 0629
*       SW1=ON;                                                    0630
         OI    SW1,B'10000000'                                     0630
*     END;                                                         0631
*   ELSE                            /* NO                            */
*     CTGFLPTR=CTGFIELD(ONE);       /* RESET POINTER TO FIRST        */
         B     @RC00624                                            0632
@RF00624 L     CTGFLPTR,CTGFIELD(,CTGPLPTR)                        0632
*   IF SW1=OFFX THEN                /* IF NEITHER LOCATE SUCESSFUL   */
@RC00624 TM    SW1,B'10000000'                                     0633
         BNZ   @RF00633                                            0633
*     DO;                           /*                               */
*       ERFLAG=LOCERR;              /* SET RETURN CODE               */
         LH    @09,LOCERR                                          0635
         STH   @09,ERFLAG                                          0635
*       RETURN TO EXIT;             /* BAIL OUT                      */
         LA    @14,EXIT                                            0636
@EL00007 DS    0H                                                  0636
@EF00007 DS    0H                                                  0636
@ER00007 BR    @14                                                 0636
*     END;                                                         0637
*   CTBLKSZ=PHYBLKSZ;               /* BLOCK SIZE TO AMBWORK         */
@RF00633 L     @07,CTGFLPT(,CTGFLPTR)                              0638
         L     @04,PHYBLKSZ(,@07)                                  0638
         ST    @04,CTBLKSZ(,CWAPT)                                 0638
*   CTDEVTYP=DEVTYP;                /* INIT DEVICE TYPE CODE         */
         MVC   CTDEVTYP(4,CWAPT),DEVTYP(@07)                       0639
*   CTGFLPTR=CTGFIELD(THREE);       /* POINT TO 3RD LOCATE FIELD     */
         L     CTGFLPTR,CTGFIELD+8(,CTGPLPTR)                      0640
*   CALL TESTLOC;                   /* DID WE GET FIELD              */
         BAL   @14,TESTLOC                                         0641
*   WKPT7=CTGFLPT(ONE);             /* LOCAL BASE                    */
         L     WKPT7,CTGFLPT(,CTGFLPTR)                            0642
*   RFY                                                            0643
*     VOLPHY BASED(WKPT7);          /* SAVES MANY INST               */
*   WKPT8=ADDR(LL2X);                                              0644
         LA    @04,2                                               0644
         LA    WKPT8,LL1(,WKPT7)                                   0644
         ICM   @15,12,LL1(WKPT7)                                   0644
         SRA   @15,16                                              0644
         ALR   WKPT8,@15                                           0644
         ALR   WKPT8,@04                                           0644
*   RFY                                                            0645
*     LL2X BASED(WKPT8);                                           0645
*   WKPT9=ADDR(LL3X);                                              0646
         LR    @15,WKPT8                                           0646
         ICM   @14,12,LL2(WKPT8)                                   0646
         SRA   @14,16                                              0646
         ALR   @15,@14                                             0646
         ALR   @15,@04                                             0646
         ST    @15,WKPT9                                           0646
*   RFY                                                            0647
*     LL3X BASED(WKPT9);                                           0647
*   WORKPTR1=WKPT7+CTGFLNG(ONE);    /* PT TO END OF CAT INFO         */
         LR    @04,WKPT7                                           0648
         AL    @04,CTGFLNG(,CTGFLPTR)                              0648
         ST    @04,WORKPTR1                                        0648
*   WORKPTR5=ADDR(AMBWORK)+         /* POIN TO VOL ENT               */
*       LENGTH(AMBWORK)+LENGTH(CTVOLENT);/* POINT TO 1ST KEY RANGE 0649
*                                      ENTRY                         */
         LA    WORKPTR5,252                                        0649
         ALR   WORKPTR5,CWAPT                                      0649
*   RESPECIFY                                                      0650
*     CTKEYENT BASED(WORKPTR5);     /* ADDRESSABILITY FOR KEY ENTRY  */
*   RESPECIFY                                                      0651
*     CTEXTENT BASED(WORKPTR6);     /* ADDRESSABILITY FOR EXTENT   0651
*                                      ENTRY                         */
*   VOLENTNO=ONE;                   /* CLEAR VOL ENTRY CT IN AMBWORK */
         MVC   VOLENTNO(2,CWAPT),@CH00076                          0652
*   CTVOLSER=VOLSER;                /* NOTE VOLSER                   */
         LA    @04,232                                             0653
         ALR   @04,CWAPT                                           0653
         MVC   CTVOLSER(6,@04),VOLSER(WKPT7)                       0653
*   IF AMDKEYLN^=ZERO THEN          /* DO WE HAVE A KEY              */
         LH    @15,AMDKEYLN+132(,CWAPT)                            0654
         LTR   @15,@15                                             0654
         BZ    @RF00654                                            0654
*     CTKEYLEN=AMDKEYLN;            /* PUT KEY LENGTH IN CTVOLENT    */
         STH   @15,CTKEYLEN(,@04)                                  0655
*   ELSE                            /* NO KEY                        */
*     CTKEYLEN=FOUR;                                               0656
         B     @RC00654                                            0656
@RF00654 MVC   CTKEYLEN+232(2,CWAPT),@CH00048                      0656
*   DO WHILE(WKPT7<WORKPTR1);       /* PROCESS KEY RANGE THIS VOL    */
@RC00654 B     @DE00657                                            0657
@DL00657 DS    0H                                                  0658
*     WORKPTR6=ADDR(CTKEY)+         /* POINT TO 1ST EXTENT BLOCK     */
*         CTKEYLEN*TWO;             /* FOR THIS KEY RANGE            */
         LA    @04,CTKEY(,WORKPTR5)                                0658
         LH    @15,CTKEYLEN+232(,CWAPT)                            0658
         ALR   @15,@15                                             0658
         ALR   @04,@15                                             0658
         ST    @04,WORKPTR6                                        0658
*     IF(WORKPTR6+LL3)>             /* IF THE WORK AREA NEEDED IS    */
*         (ADDR(AMBWORK)+AMALEN)    /* BIGER THAN THE ONE WE HAVE    */
*       THEN                        /* YES                           */
         L     @01,WKPT9                                           0659
         ICM   @15,12,LL3(@01)                                     0659
         SRA   @15,16                                              0659
         ALR   @04,@15                                             0659
         LR    @15,CWAPT                                           0659
         AH    @15,AMALEN(,CWAPT)                                  0659
         CR    @04,@15                                             0659
         BNH   @RF00659                                            0659
*       CALL AMBWKRB;               /* GET A BIGGER ONE              */
         BAL   @14,AMBWKRB                                         0660
*     IF SSW=ON THEN                /* SEQ SET W/DATA?               */
@RF00659 TM    SSW(WKPT7),B'10000000'                              0661
         BNO   @RF00661                                            0661
*       CTSSWDTA=ON;                /* YES NOTE IN AMBWORK           */
         OI    CTSSWDTA(WORKPTR5),B'10000000'                      0662
*     CTNOKEXT=LL3/LENGTH(EXTENT);  /* COMPUTE NBR EXTENTS           */
@RF00661 L     @04,WKPT9                                           0663
         ICM   @00,12,LL3(@04)                                     0663
         SRA   @00,16                                              0663
         SRDA  @00,32                                              0663
         D     @00,@CF03059                                        0663
         STC   @01,CTNOKEXT(,WORKPTR5)                             0663
*     CTKHKRBA=HKRBA;               /* RECORD HI KEY RBA             */
         MVC   CTKHKRBA(4,WORKPTR5),HKRBA(WKPT7)                   0664
*     CTKHURBA=HURBA;               /* RECORD HI USED RBA            */
         MVC   CTKHURBA(4,WORKPTR5),HURBA(WKPT7)                   0665
*     CTKHARBA=HARBA;               /* RECORD HI ALLOCATED RBA       */
         MVC   CTKHARBA(4,WORKPTR5),HARBA(WKPT7)                   0666
*     CTKRELNO=RREPNO;              /* INIT VOL OCCURRENCE NBR       */
         LH    @04,RREPNO(,WKPT7)                                  0667
         STH   @04,CTKRELNO(,WORKPTR5)                             0667
*     IF LL1^=ZERO THEN             /* IF THERE IS A LOW KEY RANGE   */
         ICM   @04,12,LL1(WKPT7)                                   0668
         SRA   @04,16                                              0668
         LTR   @04,@04                                             0668
         BZ    @RF00668                                            0668
*       CTKEY(1:LL1)=LOKEYV(1:LL1); /* NOTE KEY RANGE                */
         BCTR  @04,0                                               0669
         EX    @04,@SM04233                                        0669
*     IF LL1<CTKEYLEN THEN          /* LOW KEY SHORT                 */
@RF00668 ICM   @04,12,LL1(WKPT7)                                   0670
         SRA   @04,16                                              0670
         LH    @15,CTKEYLEN+232(,CWAPT)                            0670
         CR    @04,@15                                             0670
         BNL   @RF00670                                            0670
*       DO;                                                        0671
*         CTKEY(LL1+ONE)=PADKEYLO;                                 0672
         ALR   @04,WORKPTR5                                        0672
         MVC   CTKEY(1,@04),PADKEYLO                               0672
*         CTKEY(LL1+TWO:CTKEYLEN)=CTKEY(LL1+ONE:CTKEYLEN-ONE);     0673
         ICM   @04,12,LL1(WKPT7)                                   0673
         SRA   @04,16                                              0673
         ALR   @04,WORKPTR5                                        0673
         ICM   @14,12,LL1(WKPT7)                                   0673
         SRA   @14,16                                              0673
         SLR   @15,@14                                             0673
         BCTR  @15,0                                               0673
         BCTR  @15,0                                               0673
         ALR   @14,WORKPTR5                                        0673
         MVC   @TS00001(256),CTKEY(@14)                            0673
         EX    @15,@SM04235                                        0673
*       END;                                                       0674
*     IF LL2^=ZERO THEN             /* IS HIGH KEY                   */
@RF00670 ICM   @04,12,LL2(WKPT8)                                   0675
         SRA   @04,16                                              0675
         LTR   @04,@04                                             0675
         BZ    @RF00675                                            0675
*       CTKEY(CTKEYLEN+ONE:CTKEYLEN+LL2)=HIKEYV(1:LL2);            0676
         LH    @01,CTKEYLEN+232(,CWAPT)                            0676
         ALR   @01,WORKPTR5                                        0676
         BCTR  @04,0                                               0676
         EX    @04,@SM04237                                        0676
*     IF LL2<CTKEYLEN THEN          /* IS HIGH KEY SHORT             */
@RF00675 ICM   @04,12,LL2(WKPT8)                                   0677
         SRA   @04,16                                              0677
         LH    @15,CTKEYLEN+232(,CWAPT)                            0677
         CR    @04,@15                                             0677
         BNL   @RF00677                                            0677
*       DO;                                                        0678
*         CTKEY(CTKEYLEN+LL2+ONE)=PADKEYHI;                        0679
         ALR   @04,@15                                             0679
         ST    @04,@TF00001                                        0679
         ALR   @04,WORKPTR5                                        0679
         MVC   CTKEY(1,@04),PADKEYHI                               0679
*         CTKEY(CTKEYLEN+LL2+TWO:CTKEYLEN*TWO)=CTKEY(CTKEYLEN+LL2+ONE:
*             CTKEYLEN*TWO-ONE);                                   0680
         LR    @04,WORKPTR5                                        0680
         AL    @04,@TF00001                                        0680
         ALR   @15,@15                                             0680
         SL    @15,@TF00001                                        0680
         BCTR  @15,0                                               0680
         BCTR  @15,0                                               0680
         LR    @01,WORKPTR5                                        0680
         AL    @01,@TF00001                                        0680
         MVC   @TS00001(256),CTKEY(@01)                            0680
         EX    @15,@SM04235                                        0680
*       END;                                                       0681
*     CTNOEXT=CTNOEXT+CTNOKEXT;     /* UPDATE NBR EXTS THIS VOL      */
@RF00677 LA    @04,232                                             0682
         ALR   @04,CWAPT                                           0682
         SLR   @15,@15                                             0682
         IC    @15,CTNOEXT(,@04)                                   0682
         SLR   @14,@14                                             0682
         IC    @14,CTNOKEXT(,WORKPTR5)                             0682
         ALR   @15,@14                                             0682
         STC   @15,CTNOEXT(,@04)                                   0682
*     CTNOKEY=CTNOKEY+ONE;          /* UPD NBR KEY RNGS THIS VOL     */
         LA    @02,1                                               0683
         AH    @02,CTNOKEY(,@04)                                   0683
         STH   @02,CTNOKEY(,@04)                                   0683
*     IF LL3^=ZERO THEN             /* IS THERE EXTENT INFO          */
         L     @04,WKPT9                                           0684
         ICM   @02,12,LL3(@04)                                     0684
         SRA   @02,16                                              0684
         LTR   @02,@02                                             0684
         BZ    @RF00684                                            0684
*       CTEXTENT(1:LL3)=EXTENT(1:LL3);/* RECORD EXT INFO             */
         L     @01,WORKPTR6                                        0685
         BCTR  @02,0                                               0685
         EX    @02,@SM04239                                        0685
*     WORKPTR5=WORKPTR6+LL3;        /* STEP KEY BASE                 */
@RF00684 L     @04,WKPT9                                           0686
         ICM   @04,12,LL3(@04)                                     0686
         SRA   @04,16                                              0686
         L     WORKPTR5,WORKPTR6                                   0686
         ALR   WORKPTR5,@04                                        0686
*     WKPT7=WKPT7+                  /* BEGIN TO                      */
*         LENGTH(VOLPHY)+LL1+       /* STEP CATLG FIELD PTR          */
*         LENGTH(LL2)+LL2+          /* TO NEXT CATLG VOL ENTRY       */
*         LENGTH(LL3)+LL3;          /*                               */
         LA    @15,2                                               0687
         LA    @14,25                                              0687
         ALR   @14,WKPT7                                           0687
         ICM   @01,12,LL1(WKPT7)                                   0687
         SRA   @01,16                                              0687
         ALR   @14,@01                                             0687
         ALR   @14,@15                                             0687
         ICM   @01,12,LL2(WKPT8)                                   0687
         SRA   @01,16                                              0687
         ALR   @14,@01                                             0687
         ALR   @14,@15                                             0687
         ALR   @14,@04                                             0687
         LR    WKPT7,@14                                           0687
*     IF WKPT7<WORKPTR1 THEN        /* IS THERE A NEXT ENTRY?        */
         C     WKPT7,WORKPTR1                                      0688
         BNL   @RF00688                                            0688
*       DO;                         /* YES,DO                        */
*         IF VOLSER^=CTVOLSER THEN  /* MUST BE THE SAME VOLUME       */
         CLC   VOLSER(6,WKPT7),CTVOLSER+232(CWAPT)                 0690
         BE    @RF00690                                            0690
*           DO;                     /* NO DO                         */
*             ERFLAG=VOLERR;        /* SET RETURN CODE               */
         LH    @09,VOLERR                                          0692
         STH   @09,ERFLAG                                          0692
*             RETURN TO EXIT;       /* BAIL OUT                      */
         LA    @14,EXIT                                            0693
         BR    @14                                                 0693
*           END;                                                   0694
*         IF(ADDR(CTKEY)+CTKEYLEN*TWO)>/* IS THERE ENOUGH            */
*             (ADDR(AMBWORK)+AMALEN) THEN/* ROOM FOR ANOTHER ENTRY?  */
@RF00690 LA    @04,CTKEY(,WORKPTR5)                                0695
         LH    @15,CTKEYLEN+232(,CWAPT)                            0695
         ALR   @15,@15                                             0695
         ALR   @04,@15                                             0695
         LR    @15,CWAPT                                           0695
         AH    @15,AMALEN(,CWAPT)                                  0695
         CR    @04,@15                                             0695
         BNH   @RF00695                                            0695
*           CALL AMBWKRB;           /* IF NOT CALL FOR MORE          */
         BAL   @14,AMBWKRB                                         0696
*       END;                                                       0697
@RF00695 DS    0H                                                  0698
*   END;                                                           0698
@RF00688 DS    0H                                                  0698
@DE00657 C     WKPT7,WORKPTR1                                      0698
         BL    @DL00657                                            0698
*   RET=RSAVLD;                                                    0699
         L     RET,RSAVLD                                          0699
*   END MERGVOL;                                                   0700
         B     @EL00007                                            0700
*CTINTRFC:                                                         0701
*                                                                  0701
*   /*****************************************************************/
*   /*                                                               */
*   /* CATLG PARMLIST BUILDER                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0701
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0701
CTINTRFC DS    0H                                                  0702
*   RSAVLD=RET;                                                    0702
         ST    RET,RSAVLD                                          0702
*   IX=LENGTH(CTGPL)+LENGTH(CTGFIELD)*SIX;/* COMPUTE LENGTH OF PARM
*                                      LIST                          */
         LA    @07,52                                              0703
         ST    @07,IX                                              0703
*   CTGPL(1:IX)=CTGPL(1:IX)&&       /* CLEAR PARMLIST                */
*       CTGPL(1:IX);                                               0704
         LR    @04,@07                                             0704
         BCTR  @04,0                                               0704
         EX    @04,@SX04241                                        0704
*   CTGFLPTR=CTGPLPTR+IX;           /* POINT TO 1ST FIELD LIST       */
         ALR   @07,CTGPLPTR                                        0705
         LR    CTGFLPTR,@07                                        0705
*   CTGBYPSS=ON;                    /* BYPASS SECURITY CHECKING      */
         OI    CTGBYPSS(CTGPLPTR),B'10000000'                      0706
*   CTGAM0=ON;                      /* INDICATE VSAM DATA SET        */
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0707
*   CTGFUNC='001'B;                 /* INDICATE LOCATE REQUEST       */
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0708
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0708
*   CTGWKA=CATWKPTR;                /* ADDR OF WK AREA FOR CATLG INFO*/
         ST    CATWKPTR,CTGWKA(,CTGPLPTR)                          0709
*   IF NAME44=ON THEN               /* ENTRY TYPE = REAL NAME        */
         TM    NAME44,B'10000000'                                  0710
         BNO   @RF00710                                            0710
*     DO;                           /* YES, DO                       */
*       CTGNAME=ON;                 /* INDICATE REAL NAME            */
*       CTGCNAME=ON;                /* INDICATE CATLG ACB PTR = 0    */
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0713
*       CTGENT=ADDR(DSNDD);         /* INIT DSN PTR                  */
         LA    @07,DSNDD                                           0714
         ST    @07,CTGENT(,CTGPLPTR)                               0714
*     END;                                                         0715
*   ELSE                            /* NO, DO                        */
*     DO;                                                          0716
         B     @RC00710                                            0716
@RF00710 DS    0H                                                  0717
*       CTGENT=ADDR(DSNCI);         /* SET PTR TO CI NBR             */
         LA    @07,DSNCI                                           0717
         ST    @07,CTGENT(,CTGPLPTR)                               0717
*       CTGCAT=ADDR(DSCATACB);      /* SET PTR TO CAT ACB            */
         LA    @07,DSCATACB                                        0718
         ST    @07,CTGCAT(,CTGPLPTR)                               0718
*     END;                                                         0719
*   DO IX3=1 TO 6                   /* PROCESS ALL LOCATES           */
*         WHILE(FLACTIVE(IX3,1)=ON);                               0720
@RC00710 LA    IX3,1                                               0720
@DL00720 LR    @04,IX3                                             0720
         MH    @04,@CH03052                                        0720
         LA    @03,FLACTIVE-60(@04)                                0720
         TM    0(@03),B'10000000'                                  0720
         BNO   @DC00720                                            0720
*     CTGFIELD(IX3)=CTGFLPTR;       /* SET CTGPL FIELD PTR           */
         LR    @04,IX3                                             0721
         SLA   @04,2                                               0721
         ST    CTGFLPTR,CTGFIELD-4(@04,CTGPLPTR)                   0721
*     DO IX2=1 TO 3                 /* PROCESS ALL FIELDS FOR        */
*           WHILE(FLACTIVE(IX3,IX2)=ON);/* THIS LOCATE               */
         LA    @04,1                                               0722
         ST    @04,IX2                                             0722
@DL00722 LR    @03,IX3                                             0722
         MH    @03,@CH00088                                        0722
         ALR   @03,@04                                             0722
         MH    @03,@CH03059                                        0722
         LA    @01,FLACTIVE-80(@03)                                0722
         TM    0(@01),B'10000000'                                  0722
         BNO   @DC00722                                            0722
*       IX=LENGTH(CTGFL)+           /* COMPUTE LENGTH OF FIELD       */
*           LENGTH(CTGFLDAT);                                      0723
         LA    @15,24                                              0723
         ST    @15,IX                                              0723
*       CTGFL(1:IX)=CTGFL(1:IX)&&   /* CLEAR FIELD                   */
*           CTGFL(1:IX);                                           0724
         LR    @14,@15                                             0724
         BCTR  @14,0                                               0724
         EX    @14,@SX04244                                        0724
*       CTGFLCHN=CTGFLPTR+IX;       /* INITIATE FIELD CHAIN PTR      */
         ALR   @15,CTGFLPTR                                        0725
         ST    @15,CTGFLCHN(,CTGFLPTR)                             0725
*       CTGFLDNM=ADDR(FLNAME(IX3,IX2));/* INIT SYMBOLIC NAME PTR     */
         LA    @14,FLNAME-80(@03)                                  0726
         ST    @14,CTGFLDNM(,CTGFLPTR)                             0726
*       CTGFLNG(ONE)=FLTSTLEN(IX3,IX2);/* LENGTH OF TEST DATA        */
         L     @14,FLTSTLEN-80(@03)                                0727
         ST    @14,CTGFLNG(,CTGFLPTR)                              0727
*       CTGFLPT(ONE)=FLTSTPTR(IX3,IX2);/* POINTER TO TEST DATA       */
         L     @14,FLTSTPTR-80(@03)                                0728
         ST    @14,CTGFLPT(,CTGFLPTR)                              0728
*       CTGFLDNO=ONE;               /* NBR OF CTGFLPT'S              */
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0729
*       CTGFLDCD=FLCOND(IX3,IX2);   /* TEST CONDITION                */
         LA    @01,FLCOND-80(@03)                                  0730
         MVC   CTGFLDCD(1,CTGFLPTR),0(@01)                         0730
*       WORKPTR3=CTGFLPTR;          /* NOTE ADDR - NEED LAST IN DO   */
         ST    CTGFLPTR,WORKPTR3                                   0731
*       CTGFLPTR=CTGFLCHN;          /* ADDRESSABILITY NXT FIELD      */
         LR    CTGFLPTR,@15                                        0732
*     END;                                                         0733
         AL    @04,@CF00076                                        0733
         ST    @04,IX2                                             0733
         C     @04,@CF00088                                        0733
         BNH   @DL00722                                            0733
@DC00722 DS    0H                                                  0734
*     CTGFLPTR=WORKPTR3;            /* STEP FIELD BACK               */
         L     @04,WORKPTR3                                        0734
         LR    CTGFLPTR,@04                                        0734
*     CTGFLCHN=ZERO;                /* NOT USED SO CLEAR             */
         SLR   @03,@03                                             0735
         ST    @03,CTGFLCHN(,CTGFLPTR)                             0735
*     CTGFLPTR=WORKPTR3+IX;         /* RESTORE ADDRESSABILITY        */
         AL    @04,IX                                              0736
         LR    CTGFLPTR,@04                                        0736
*   END;                                                           0737
         AL    IX3,@CF00076                                        0737
         C     IX3,@CF00113                                        0737
         BNH   @DL00720                                            0737
@DC00720 DS    0H                                                  0738
*   CTGNOFLD=IX3-ONE;               /* NBR FIELD LIST PTR'S          */
         LR    @04,IX3                                             0738
         BCTR  @04,0                                               0738
         STC   @04,CTGNOFLD(,CTGPLPTR)                             0738
*   SW1=ON;                         /* INDICATE RETRY POSSIBLE       */
         OI    SW1,B'10000000'                                     0739
*   DO WHILE SW1=ON;                                               0740
         B     @DE00740                                            0740
@DL00740 DS    0H                                                  0741
*     RFY                                                          0741
*      (R1,                                                        0741
*       RETCODE) RSTD;                                             0741
*     R1=CTGPLPTR;                  /* INIT PARMLIST PTR             */
         LR    R1,CTGPLPTR                                         0742
*     GEN(SVC 26);                  /* LOCATE SVC                    */
         SVC 26
*     CATCDF=RETCODE;               /* RETURN CODE                   */
         ST    RETCODE,CATCDF                                      0744
*     RFY                                                          0745
*      (R1,                                                        0745
*       RETCODE) UNRSTD;                                           0745
*     IF CATCODEF^=ZERO THEN        /* SUCCESSFUL LOCATE?            */
         CLI   CATCODEF,0                                          0746
         BE    @RF00746                                            0746
*       IF(CATCODEF=SMALL1         /* NO, WAS THE WORK AREA TO      */
*           CATCODEF=SMALL2) THEN   /* SMALL                         */
         CLI   CATCODEF,40                                         0747
         BE    @RT00747                                            0747
         CLI   CATCODEF,44                                         0747
         BNE   @RF00747                                            0747
@RT00747 DS    0H                                                  0748
*         CALL REBLDWA;             /* YES, GET A LARGER WORK AREA   */
         BAL   @14,REBLDWA                                         0748
*       ELSE                        /* LOCATE FAILED                 */
*         DO;                                                      0749
         B     @RC00747                                            0749
@RF00747 DS    0H                                                  0750
*           ERFLAG=LOCERR;          /* SET ERROR CODE                */
         LH    @09,LOCERR                                          0750
         STH   @09,ERFLAG                                          0750
*           RETURN TO EXIT;         /* BAIL OUT                      */
         LA    @14,EXIT                                            0751
@EL00008 DS    0H                                                  0751
@EF00008 DS    0H                                                  0751
@ER00008 BR    @14                                                 0751
*         END;                                                     0752
*     ELSE                          /* LOCATE OK                     */
*       SW1=OFFX;                                                  0753
         B     @RC00746                                            0753
@RF00746 NI    SW1,B'01111111'                                     0753
*   END;                                                           0754
@RC00746 DS    0H                                                  0754
@DE00740 TM    SW1,B'10000000'                                     0754
         BO    @DL00740                                            0754
*   RET=RSAVLD;                                                    0755
         L     RET,RSAVLD                                          0755
*   END CTINTRFC;                                                  0756
         B     @EL00008                                            0756
*TESTLOC:                                                          0757
*                                                                  0757
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR FIELD NOT FOUND & IF NOT FOUND BAIL OUT              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0757
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0757
TESTLOC  DS    0H                                                  0758
*   RSAVLE=RET;                                                    0758
         ST    RET,RSAVLE                                          0758
*   IF CTGFLPT(ONE)=ZERO THEN       /* IF LOCATE UNSUCCESSFULL       */
         L     @07,CTGFLPT(,CTGFLPTR)                              0759
         LTR   @07,@07                                             0759
         BNZ   @RF00759                                            0759
*     DO;                                                          0760
*       ERFLAG=LOCERR;              /* SET RETURN CODE               */
         LH    @09,LOCERR                                          0761
         STH   @09,ERFLAG                                          0761
*       RETURN TO EXIT;             /* BAIL OUT                      */
         LA    @14,EXIT                                            0762
@EL00009 DS    0H                                                  0762
@EF00009 DS    0H                                                  0762
@ER00009 BR    @14                                                 0762
*     END;                                                         0763
*   RET=RSAVLE;                                                    0764
@RF00759 L     RET,RSAVLE                                          0764
*   END TESTLOC;                                                   0765
         B     @EL00009                                            0765
*REBLDWA:                                                          0766
*                                                                  0766
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD A LARGER CATALOG WORK AREA                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0766
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0766
REBLDWA  DS    0H                                                  0767
*   RSAVLE=RET;                                                    0767
         ST    RET,RSAVLE                                          0767
*   WKLEN=REQLEN;                   /* LENGTH FOR GETMAIN            */
         LH    @07,REQLEN(,CATWKPTR)                               0768
         STH   @07,WKLEN                                           0768
*   CALL GETWORK;                   /* GETWORKING STORAGE            */
         BAL   @14,GETWORK                                         0769
*   FREEAD=CTGWKA;                  /* ADDR OF OLD AREA              */
         L     @07,CTGWKA(,CTGPLPTR)                               0770
         ST    @07,FREEAD                                          0770
*   FREELEN=WORKLEN;                /* LENGTH TO FREE                */
         LH    @07,WORKLEN(,CATWKPTR)                              0771
         STH   @07,FREELEN                                         0771
*   CALL FREEWORK;                  /* FREE WORKING STORAGE          */
         BAL   @14,FREEWORK                                        0772
*   CTGWKA=WKCORE;                  /* PTR TO NEW WORK AREA          */
         L     @07,WKCORE                                          0773
         ST    @07,CTGWKA(,CTGPLPTR)                               0773
*   CATWKPTR=CTGWKA;                                               0774
         LR    CATWKPTR,@07                                        0774
*   WORKLEN=WKLEN;                  /* INIT LENGTH NEW WORK AREA     */
         LH    @07,WKLEN                                           0775
         STH   @07,WORKLEN(,CATWKPTR)                              0775
*   RET=RSAVLE;                                                    0776
         L     RET,RSAVLE                                          0776
*   END REBLDWA;                                                   0777
@EL00010 DS    0H                                                  0777
@EF00010 DS    0H                                                  0777
@ER00010 BR    @14                                                 0777
*AMBWKRB:                                                          0778
*                                                                  0778
*   /*****************************************************************/
*   /*                                                               */
*   /* EXPAND AMBWORK TO ALLOW MORE KEY RANGES AND OR EXTENTS        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0778
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0778
AMBWKRB  DS    0H                                                  0779
*   RSAVLE=RET;                                                    0779
         ST    RET,RSAVLE                                          0779
*   WKLEN=AMALEN+MAX(LL3,SWKLEN);   /* SET LENGTH FOR GETMAIN        */
         L     @04,WKPT9                                           0780
         ICM   @04,12,LL3(@04)                                     0780
         SRA   @04,16                                              0780
         LH    @15,SWKLEN                                          0780
         CR    @04,@15                                             0780
         BNL   *+6
         LR    @04,@15                                             0780
         AH    @04,AMALEN(,CWAPT)                                  0780
         STH   @04,WKLEN                                           0780
*   CALL GETWORK;                   /* GETWORKING STORAGE            */
         BAL   @14,GETWORK                                         0781
*   WORKPTR3=WKCORE-CWAPT;          /* DETERMINE ADJUSTMENT TO     0782
*                                      AMBWORK POINTERS              */
         L     @04,WKCORE                                          0782
         SLR   @04,CWAPT                                           0782
         ST    @04,WORKPTR3                                        0782
*   WORKPTR4=CWAPT;                 /* SO THAT CWAPT CAN BE IN REG   */
         ST    CWAPT,WORKPTR4                                      0783
*   WORKPTR2=AMALEN;                                               0784
         LH    @04,AMALEN(,CWAPT)                                  0784
         ST    @04,WORKPTR2                                        0784
*   GEN NOSETS REFS(WORKPTR2,WORKPTR4,WKCORE);                     0785
        STM   R2,R5,TEMPSR             SAVE REGS
        L     R2,WKCORE                POINT TO NEW BLOCK
        L     R3,WORKPTR2                    BLOCK LENGTH
        L     R4,WORKPTR4                 POINT TO OLD BLOCK
        LR    R5,R3
        MVCL  R2,R4                    COPY BLOCK
        LM    R2,R4,TEMPSR             RESTORE REGS
*   FREEAD=CWAPT;                                                  0786
         ST    CWAPT,FREEAD                                        0786
*   FREELEN=AMALEN;                                                0787
         LH    @04,AMALEN(,CWAPT)                                  0787
         STH   @04,FREELEN                                         0787
*   CALL FREEWORK;                  /* FREE OLD AMBWORK              */
         BAL   @14,FREEWORK                                        0788
*   IF CWAPT=DATAWAPT THEN          /* EXTENDING DATA AMBWORK?       */
         C     CWAPT,DATAWAPT                                      0789
         BNE   @RF00789                                            0789
*     DATAWAPT=WKCORE;              /* YES, RESET POINTER            */
         L     @15,WKCORE                                          0790
         ST    @15,DATAWAPT                                        0790
*   ELSE                            /* NO                            */
*     INDXWAPT=WKCORE;              /* RESET INDEX POINTER           */
         B     @RC00789                                            0791
@RF00789 L     @15,WKCORE                                          0791
         ST    @15,INDXWAPT                                        0791
*   CWAPT=WKCORE;                   /* ADDRESSABILITY FOR NEW AREA   */
@RC00789 L     CWAPT,WKCORE                                        0792
*   AMALEN=WKLEN;                   /* RECORD NEW WORKAREA LENGTH    */
         LH    @04,WKLEN                                           0793
         STH   @04,AMALEN(,CWAPT)                                  0793
*   WORKPTR5=WORKPTR5+WORKPTR3;     /* ADJUST AMB WORK POINTERS      */
         L     @04,WORKPTR3                                        0794
         ALR   WORKPTR5,@04                                        0794
*   WORKPTR6=WORKPTR6+WORKPTR3;                                    0795
         AL    @04,WORKPTR6                                        0795
         ST    @04,WORKPTR6                                        0795
*   RET=RSAVLE;                                                    0796
         L     RET,RSAVLE                                          0796
*   RFY                                                            0797
*     IDAAMDSB BASED(AMBDSB);                                      0797
*   END AMBWKRB;                                                   0798
@EL00011 DS    0H                                                  0798
@EF00011 DS    0H                                                  0798
@ER00011 BR    @14                                                 0798
*BLDAMBL:                                                          0799
*                                                                  0799
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE BUILD THE AMBL. INPUT IS THE ACB, AND THE        */
*   /* IDACLDSG                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0799
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0799
BLDAMBL  DS    0H                                                  0800
*   RSAVLA=RET;                                                    0800
         ST    RET,RSAVLA                                          0800
*   CWAPT=DATAWAPT;                 /* POINT TO DATA WORK AREA       */
         L     CWAPT,DATAWAPT                                      0801
*   CORELEN=LENGTH(IDAAMBL)+        /* LENGTH OF AMBL +              */
*       (CTAMBNO-THREE)*FOUR;       /* AMB POINTERS                  */
         L     @09,CTAMBNO                                         0802
         SL    @09,@CF00088                                        0802
         SLA   @09,2                                               0802
         AL    @09,@CF04206                                        0802
         ST    @09,CORELEN                                         0802
*   CALL GETCORE;                   /* GET & 0 CORE FOR AMBL         */
         BAL   @14,GETCORE                                         0803
*   ACBAMBL=COREADDR;               /* POINTER IN ACB                */
         L     @09,COREADDR                                        0804
         L     @01,ACBPTR                                          0804
         ST    @09,ACBAMBL(,@01)                                   0804
*   IF NOCATLG=OFFX THEN            /* IF CATALOG                    */
         TM    NOCATLG,B'10000000'                                 0805
         BNZ   @RF00805                                            0805
*     AMBLCAT=ON;                   /* SO INDICATE IN AMBL           */
         OI    AMBLCAT(@09),B'00000010'                            0806
*   AMBLLEN=CORELEN;                /* SET AMBL LENGTH               */
@RF00805 L     @09,ACBPTR                                          0807
         L     @15,ACBAMBL(,@09)                                   0807
         L     @14,CORELEN                                         0807
         STC   @14,AMBLLEN(,@15)                                   0807
*   AMBLNUM=CTAMBNO;                /* SET NUMBER OF AMB'S           */
         L     @14,CTAMBNO                                         0808
         STH   @14,AMBLNUM(,@15)                                   0808
*   AMBLACB=ADDR(IFGACB);           /* BACK POINTER TO ACB           */
         ST    @09,AMBLACB(,@15)                                   0809
*   AMBLID=IDXAMBL;                 /* SET ID                        */
         MVI   AMBLID(@15),B'01010000'                             0810
*   AMBLFLG1=AMBLFLG1CTFLG1;       /* SET AUTHORITY                 */
         OC    AMBLFLG1(1,@15),CTFLG1                              0811
*   AMBLWRIT=ON;                                                   0812
         OI    AMBLWRIT(@15),B'00100000'                           0812
*   AMBLFIX=ON;                     /* SET FIX INDICATOR     @Z30SSRL*/
         OI    AMBLFIX(@15),B'00001000'                            0813
*   IF ACBSTRNO^=ZERO THEN          /* IF IT EXISTS,                 */
         CLI   ACBSTRNO(@09),0                                     0814
         BE    @RF00814                                            0814
*     AMBLNST=ACBSTRNO;             /* GET NBR OF STRINGS FROM ACB   */
         IC    @14,ACBSTRNO(,@09)                                  0815
         STC   @14,AMBLNST(,@15)                                   0815
*   ELSE                            /* NO STRINGS NOT SPECIFIED      */
*     AMBLNST=NSTDEFLT;             /* SET NST TO DEFAULT            */
         B     @RC00814                                            0816
@RF00814 L     @09,ACBPTR                                          0816
         L     @09,ACBAMBL(,@09)                                   0816
         MVI   AMBLNST(@09),X'01'                                  0816
*   RET=RSAVLA;                                                    0817
@RC00814 L     RET,RSAVLA                                          0817
*   END BLDAMBL;                                                   0818
@EL00012 DS    0H                                                  0818
@EF00012 DS    0H                                                  0818
@ER00012 BR    @14                                                 0818
*VMNTVER:                                                          0819
*                                                                  0819
*   /*****************************************************************/
*   /*                                                               */
*   /* VOLUME MOUNT                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0819
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0819
VMNTVER  DS    0H                                                  0820
*   RSAVLA=RET;                                                    0820
         ST    RET,RSAVLA                                          0820
*   CWAPT=DATAWAPT;                 /* ADDRESSABILITY                */
         L     CWAPT,DATAWAPT                                      0821
*   MNTPARM=MNTPARM&&MNTPARM;       /* CLEAR PARAMETER AREA          */
         XC    MNTPARM(24),MNTPARM                                 0822
*   RFY                                                            0823
*     NIPMNTPL BASED(ADDR(MNTPARM));/* ADDR FOR PARM LIST            */
*   NMNTVS=CTVOLSER;                /* MOVE VOLUME SERIAL NBR TO PARM*/
         LA    @09,MNTPARM                                         0824
         MVC   NMNTVS(6,@09),CTVOLSER+232(CWAPT)                   0824
*   NMNTDSA=ADDR(CTDATANM);         /* ADDR OF DS NAME               */
         LA    @04,CTDATANM(,CWAPT)                                0825
         STCM  @04,15,NMNTDSA(@09)                                 0825
*   RFY                                                            0826
*     R1 RSTD;                                                     0826
*   GEN REFS(NVTMOUNT);                                            0827
         STM   R2,R3,TEMPSR
        LM    R2,R3,LOCPTR
        IEAPMNIP TYPE=MOUNT,PARAM=MNTPARM,OPT=(,LC,LI)
PSTPRM   LM    R2,R3,TEMPSR
*   IF R1=ZERO THEN                 /* IS MOUNTED?                   */
         LTR   R1,R1                                               0828
         BNZ   @RF00828                                            0828
*     DO;                           /* NO, DO                        */
*       ERFLAG=MNTERR;                                             0830
         LH    @09,MNTERR                                          0830
         STH   @09,ERFLAG                                          0830
*       RETURN TO EXIT;             /* GET OUT                       */
         LA    @14,EXIT                                            0831
@EL00013 DS    0H                                                  0831
@EF00013 DS    0H                                                  0831
@ER00013 BR    @14                                                 0831
*     END;                                                         0832
*   CTVOLUCB=R1;                    /* STORE ADDRESS OF UCB          */
@RF00828 LA    @09,232                                             0833
         LR    @04,CWAPT                                           0833
         ALR   @04,@09                                             0833
         ST    R1,CTVOLUCB(,@04)                                   0833
*   CWAPT=INDXWAPT;                 /* PT TO INDEX AMB WORK AREA   0834
*                                                            @ZM00062*/
         L     CWAPT,INDXWAPT                                      0834
*   IF CWAPT^=ZERO THEN             /* IF WORK AREA EXIST    @ZM00062*/
         LTR   CWAPT,CWAPT                                         0835
         BZ    @RF00835                                            0835
*     CTVOLUCB=R1;                  /* STORE UCB POINTER     @ZM00062*/
         ALR   @09,CWAPT                                           0836
         ST    R1,CTVOLUCB(,@09)                                   0836
*   RFY                                                            0837
*     R1 UNRSTD;                                                   0837
@RF00835 DS    0H                                                  0838
*   RET=RSAVLA;                                                    0838
         L     RET,RSAVLA                                          0838
*   END VMNTVER;                                                   0839
         B     @EL00013                                            0839
*BLDDDEB:                                                          0840
*                                                                  0840
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE BUILDS A DUMMY DEB IT IS CHAINED OFF OF THE      */
*   /* CURRENT TCB. THE DEB POINTS TO THE ACB AND THE ACB POINTS BACK*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0840
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0840
BLDDDEB  DS    0H                                                  0841
*   RSAVLA=RET;                                                    0841
         ST    RET,RSAVLA                                          0841
*   CORELEN=DDEBLEN;                /* REQUEST LENGTH FOR DUMMY DEB  */
         LH    @09,DDEBLEN                                         0842
         ST    @09,CORELEN                                         0842
*   CALL GETCORE;                   /* GET CORE DDEB                 */
         BAL   @14,GETCORE                                         0843
*   RDEBAD=COREADDR                 /* ADDR OF START OF AREA         */
*       +LENGTH(DEBPREFX);          /* POINT TO AFTER DEB PREFIX     */
         L     @09,COREADDR                                        0844
         LA    RDEBAD,16                                           0844
         ALR   RDEBAD,@09                                          0844
*   ACBDEB=RDEBAD;                  /* SET PTR IN ACB                */
         L     @15,ACBPTR                                          0845
         STCM  RDEBAD,7,ACBDEB(@15)                                0845
*   DDEBADR=RDEBAD-LENGTH(DEB);                                    0846
         LR    DDEBADR,RDEBAD                                      0846
         SL    DDEBADR,@CF03057                                    0846
*   RESPECIFY                                                      0847
*     DEB BASED(DDEBADR);           /* POINT TO IMAGINARY START OF 0847
*                                      DEB ADDRESSES PREFIX ONLY     */
*   DEBLNGTH=DDEBLEN/EIGHT;         /* INIT LENGTH IN DWORDS         */
         LH    @00,DDEBLEN                                         0848
         SRDA  @00,32                                              0848
         D     @00,@CF00058                                        0848
         STC   @01,DEBLNGTH(,DDEBADR)                              0848
*   DEBTCBB=ADDR(TCB);              /* INIT POINTER TO TCB           */
         L     @01,NVTPTR                                          0849
         MVC   DEBTCBB(3,RDEBAD),NVTMSTCB+1(@01)                   0849
*   DEBDCBB=ADDR(IFGACB);           /* INIT PTR TO ACB               */
         STCM  @15,7,DEBDCBB(RDEBAD)                               0850
*   DEBDEBID=IDXDEB;                /* INIT ID IN DEB                */
         MVI   DEBDEBID(RDEBAD),B'00001111'                        0851
*   DDEBADR=COREADDR;               /* SAVE DDEB ADDR                */
         LR    DDEBADR,@09                                         0852
*   RESPECIFY                                                      0853
*     DEB BASED(DEBAPPAD);                                         0853
*   RET=RSAVLA;                                                    0854
         L     RET,RSAVLA                                          0854
*   END BLDDDEB;                                                   0855
@EL00014 DS    0H                                                  0855
@EF00014 DS    0H                                                  0855
@ER00014 BR    @14                                                 0855
*BLDAMB:                                                           0856
*                                                                  0856
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD AN AMB                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0856
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0856
BLDAMB   DS    0H                                                  0857
*   RSAVLA=RET;                                                    0857
         ST    RET,RSAVLA                                          0857
*   CORELEN=LENGTH(IDAAMB);         /* SET FOR CORE REQ              */
         MVC   CORELEN(4),@CF04197                                 0858
*   CALL GETCORE;                   /* GET CORE FOR AMB              */
         BAL   @14,GETCORE                                         0859
*   AMBPT=COREADDR;                 /* LOAD AMB PTR                  */
         L     AMBPT,COREADDR                                      0860
*   AMBDORGA=ON;                    /* DSORG INDICATES VSAM          */
         OI    AMBDORGA(AMBPT),B'00001000'                         0861
*   AMBEXFG=AMBEXOFF;               /* SET LOCK BIT OFF              */
         OI    AMBEXFG(AMBPT),B'00000010'                          0862
*   AMBCDSN=DSNCCI;                 /*                               */
         MVC   AMBCDSN(3,AMBPT),DSNCCI                             0863
*   AMBCACB=CTHSHCAT;               /* SAVE CATLG ACB PTR            */
         L     @09,CTHSHCAT(,CWAPT)                                0864
         ST    @09,AMBCACB(,AMBPT)                                 0864
*   AMBDDSN=CTHSHDSN;               /* AMD DATA SET NAME             */
         MVC   AMBDDSN(3,AMBPT),CTHSHDSN(CWAPT)                    0865
*   AMBID=IDXAMB;                   /* SET IDENT                     */
         MVI   AMBID(AMBPT),B'01000000'                            0866
*   AMBLEN=LENGTH(IDAAMB);          /* SET LENGTH                    */
         MVC   AMBLEN(2,AMBPT),@CH04197                            0867
*   AMBAMETH=ACBAMETH;              /* COPY ACCESS METHOD FIELD      */
         L     @09,ACBPTR                                          0868
         IC    @07,ACBAMETH(,@09)                                  0868
         STC   @07,AMBAMETH(,AMBPT)                                0868
*   IF AMBLCAT=ON THEN              /* IF OPENING THE CATALOG        */
         L     @07,ACBAMBL(,@09)                                   0869
         TM    AMBLCAT(@07),B'00000010'                            0869
         BNO   @RF00869                                            0869
*     DO;                           /* THEN DO                       */
*       AMBCACB=ADDR(IFGACB);       /* SET FLAG                      */
         ST    @09,AMBCACB(,AMBPT)                                 0871
*       AMBMCAT=ON;                 /* SET FLAG                      */
         OI    AMBMCAT(AMBPT),B'00100000'                          0872
*     END;                                                         0873
*   ELSE                            /* NOT A CATLOG                  */
*     AMBCACB=CBSACB;               /* POINT TO ACB FOR CATALOG      */
         B     @RC00869                                            0874
@RF00869 L     @09,CVTPTR                                          0874
         L     @09,CVTCBSP(,@09)                                   0874
         L     @09,CBSACB(,@09)                                    0874
         ST    @09,AMBCACB(,AMBPT)                                 0874
*   IF CWAPT=DATAWAPT THEN          /* IS AMB FOR DATA               */
@RC00869 C     CWAPT,DATAWAPT                                      0875
         BNE   @RF00875                                            0875
*     DO;                           /* YES                           */
*       AMBTYPE=AMBDATA;            /* INDICATE DATA AMB             */
         NI    AMBTYPE(AMBPT),B'10111111'                          0877
*       AMBLDTA=ADDR(IDAAMB);       /* SET PTR IN AMBL               */
         L     @09,ACBPTR                                          0878
         L     @09,ACBAMBL(,@09)                                   0878
         ST    AMBPT,AMBLDTA(,@09)                                 0878
*       IF SWPGSP=ON THEN           /* IF A PAGE SPACE               */
         TM    SWPGSP,B'01000000'                                  0879
         BNO   @RF00879                                            0879
*         AMBPSDS=ON;               /* SO INDICATE                   */
         OI    AMBPSDS(AMBPT),B'10000000'                          0880
*     END;                                                         0881
*   ELSE                            /* AMBL FOR INDEX                */
*     DO;                                                          0882
         B     @RC00875                                            0882
@RF00875 DS    0H                                                  0883
*       AMBTYPE=AMBINDEX;           /* INDICATE INDEX AMB            */
         OI    AMBTYPE(AMBPT),B'01000000'                          0883
*       AMBLDTA->AMBLINK=AMBPT;     /* PT TO DATA AMB                */
         L     @09,ACBPTR                                          0884
         L     @09,ACBAMBL(,@09)                                   0884
         L     @07,AMBLDTA(,@09)                                   0884
         ST    AMBPT,AMBLINK(,@07)                                 0884
*       AMBLDTA->AMBPIXP=AMBPT;                                    0885
         ST    AMBPT,AMBPIXP(,@07)                                 0885
*       AMBLIX=ADDR(IDAAMB);                                       0886
         ST    AMBPT,AMBLIX(,@09)                                  0886
*     END;                                                         0887
*   IF ACBUBF=ON&                   /* IF USER BUFFS SPECIFIED       */
*       AMBTYPE=AMBDATA THEN        /* IF DATA AMB                   */
@RC00875 L     @09,ACBPTR                                          0888
         TM    ACBUBF(@09),B'00000001'                             0888
         BNO   @RF00888                                            0888
         TM    AMBTYPE(AMBPT),B'01000000'                          0888
         BNZ   @RF00888                                            0888
*     AMBUBF=ON;                                                   0889
         OI    AMBUBF(AMBPT),B'00000100'                           0889
*   AMBPAMBL=ADDR(IDAAMBL);         /* COPY POINTER TO AMBL          */
@RF00888 L     @09,ACBPTR                                          0890
         L     @09,ACBAMBL(,@09)                                   0890
         ST    @09,AMBPAMBL(,AMBPT)                                0890
*   RET=RSAVLA;                                                    0891
         L     RET,RSAVLA                                          0891
*   END BLDAMB;                                                    0892
@EL00015 DS    0H                                                  0892
@EF00015 DS    0H                                                  0892
@ER00015 BR    @14                                                 0892
*BLDAMDSB:                                                         0893
*                                                                  0893
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD AN AMDSB                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0893
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0893
BLDAMDSB DS    0H                                                  0894
*   RSAVLA=RET;                                                    0894
         ST    RET,RSAVLA                                          0894
*   CORELEN=LENGTH(IDAAMDSB)+LENGTH(AMDSTAT);                      0895
         MVC   CORELEN(4),@CF04208                                 0895
*   CALL GETCORE;                   /* GET CORE FOR AMDSB            */
         BAL   @14,GETCORE                                         0896
*   AMBDSB=COREADDR;                /* CHAIN AMDSB OFF OF AMB        */
         L     @09,COREADDR                                        0897
         ST    @09,AMBDSB(,AMBPT)                                  0897
*   IDAAMDSB=CTAMDSB;               /* COPY AMDSB                    */
         MVC   IDAAMDSB(96,@09),CTAMDSB(CWAPT)                     0898
*   IX=AMBDSB+LENGTH(AMDSTAT);      /* ADJUST A BASE                 */
         LA    @07,48                                              0899
         ALR   @07,@09                                             0899
         ST    @07,IX                                              0899
*   IX->AMDSTAT=AMDSTAT;            /* FOR A SECOND SET OF STATISTICS*/
         MVC   AMDSTAT(48,@07),AMDSTAT(@09)                        0900
*   AMDSBID=IDXAMDSB;               /* IDENT                         */
         MVI   AMDSBID(@09),B'01100000'                            0901
*   AMDLEN=CORELEN;                 /* LENGTH OF BLOCK               */
         L     @07,CORELEN                                         0902
         STH   @07,AMDLEN(,@09)                                    0902
*   RET=RSAVLA;                                                    0903
         L     RET,RSAVLA                                          0903
*   END BLDAMDSB;                                                  0904
@EL00016 DS    0H                                                  0904
@EF00016 DS    0H                                                  0904
@ER00016 BR    @14                                                 0904
*BLDIWA:                                                           0905
*                                                                  0905
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD AN INSERT WORK AREA                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0905
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0905
BLDIWA   DS    0H                                                  0906
*   RSAVLA=RET;                                                    0906
         ST    RET,RSAVLA                                          0906
*   IF AMBTYPE=AMBDATA THEN         /* DATA AMB?                     */
         TM    AMBTYPE(AMBPT),B'01000000'                          0907
         BNZ   @RF00907                                            0907
*     DO;                                                          0908
*       CORELEN=LENGTH(IDADIWA);                                   0909
         MVC   CORELEN(4),@CF04207                                 0909
*       CALL GETCORE;               /* GET A BLOCK OF CORE           */
         BAL   @14,GETCORE                                         0910
*       AMBIWA=COREADDR;            /* CHAIN                         */
         L     @09,COREADDR                                        0911
         ST    @09,AMBIWA(,AMBPT)                                  0911
*       DIWID=IDXDIWA;              /* SET IDENT                     */
         MVI   DIWID(@09),B'01000001'                              0912
*       DIWLEN=CORELEN;             /* INIT LENGTH                   */
         L     @07,CORELEN                                         0913
         STH   @07,DIWLEN(,@09)                                    0913
*       DIWCISPL=ON;                                               0914
         OI    DIWCISPL(@09),B'01000000'                           0914
*     END;                                                         0915
*   ELSE                            /* INDEX AMBL                    */
*     DO;                                                          0916
         B     @RC00907                                            0916
@RF00907 DS    0H                                                  0917
*       CORELEN=LENGTH(IDAIMWA)+THREE*AMDKEYLN;/* SET CORE REQUEST 0917
*                                      SIZE                          */
         L     @09,AMBDSB(,AMBPT)                                  0917
         LH    @09,AMDKEYLN(,@09)                                  0917
         MH    @09,@CH00088                                        0917
         AL    @09,@CF04209                                        0917
         ST    @09,CORELEN                                         0917
*       CALL GETCORE;               /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         0918
*       AMBIWA=COREADDR;            /* CHAIN OFF AMB                 */
         L     @09,COREADDR                                        0919
         ST    @09,AMBIWA(,AMBPT)                                  0919
*       AMBIWA->IMWID=IDXIMWA;      /* SET IDENT                     */
         MVI   IMWID(@09),B'01000010'                              0920
*       AMBIWA->IMWLEN=CORELEN;     /* INIT IMWA LENGTH              */
         L     @07,CORELEN                                         0921
         STH   @07,IMWLEN(,@09)                                    0921
*       CORELEN=LENGTH(IDAICWA)+THREE*AMDKEYLN;                    0922
         L     @09,AMBDSB(,AMBPT)                                  0922
         LH    @09,AMDKEYLN(,@09)                                  0922
         MH    @09,@CH00088                                        0922
         AL    @09,@CF03052                                        0922
         ST    @09,CORELEN                                         0922
*       CALL GETCORE;               /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         0923
*       COREADDR->ICWCHN=AMBIWA;    /* CHAIN IMWA OFF ICWA           */
         L     @09,COREADDR                                        0924
         L     @07,AMBIWA(,AMBPT)                                  0924
         ST    @07,ICWCHN(,@09)                                    0924
*       AMBIWA=COREADDR;                                           0925
         ST    @09,AMBIWA(,AMBPT)                                  0925
*       ICWLEN=CORELEN;                                            0926
         L     @07,CORELEN                                         0926
         STH   @07,ICWLEN(,@09)                                    0926
*       ICWID=IDXICWA;                                             0927
         MVI   ICWID(@09),B'01000011'                              0927
*     END;                                                         0928
*   RET=RSAVLA;                                                    0929
@RC00907 L     RET,RSAVLA                                          0929
*   END BLDIWA;                                                    0930
@EL00017 DS    0H                                                  0930
@EF00017 DS    0H                                                  0930
@ER00017 BR    @14                                                 0930
*BUFNOSET:                                                         0931
*                                                                  0931
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPUTE BUFFER ATTRIBUTES                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0931
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0931
BUFNOSET DS    0H                                                  0932
*   RSAVLA=RET;                                                    0932
         ST    RET,RSAVLA                                          0932
*   BUFND=ACBBUFND;                 /* BUFFER NBR FOR DATA           */
         L     @09,ACBPTR                                          0933
         LH    @07,ACBBUFND(,@09)                                  0933
         ST    @07,BUFND                                           0933
*   BUFNI=ACBBUFNI;                 /* BUFFER NBR FOR INDEX          */
         LH    @07,ACBBUFNI(,@09)                                  0934
         ST    @07,BUFNI                                           0934
*   BUFSP=ACBBUFSP;                 /* BUFFER SPACE                  */
         L     BUFSP,ACBBUFSP(,@09)                                0935
*   IF AMBLCAT=ON THEN              /* IF CATALOG SET NBR OF STRINGS */
         L     @09,ACBAMBL(,@09)                                   0936
         TM    AMBLCAT(@09),B'00000010'                            0936
         BNO   @RF00936                                            0936
*     AMBLNST=ONE;                                                 0937
         MVI   AMBLNST(@09),X'01'                                  0937
*   REQDBUF=AMBLNST;                                               0938
@RF00936 L     @02,ACBPTR                                          0938
         L     @02,ACBAMBL(,@02)                                   0938
         SLR   @15,@15                                             0938
         IC    @15,AMBLNST(,@02)                                   0938
         LR    REQDBUF,@15                                         0938
*   REQIBUF=AMBLNST;                                               0939
         LR    REQIBUF,@15                                         0939
*   REQBUFSP=CTCISIZI*REQIBUF+      /* CALC MIN BUFFER SPACE         */
*       CTCISIZD*REQDBUF;                                          0940
         LR    @01,REQIBUF                                         0940
         M     @00,CTCISIZI                                        0940
         LR    @15,REQDBUF                                         0940
         M     @14,CTCISIZD                                        0940
         ALR   @01,@15                                             0940
         LR    REQBUFSP,@01                                        0940
*   IF AMBUBF=ON THEN               /* IF USER BFR                   */
         TM    AMBUBF(AMBPT),B'00000100'                           0941
         BNO   @RF00941                                            0941
*     BUFND=REQDBUF;                                               0942
         ST    REQDBUF,BUFND                                       0942
*   ELSE                            /* NOT USER BUFFERING            */
*     BUFND=MAX(BUFND,REQDBUF);     /* BUFNO FOR DATA & INDEX IS SET */
         B     @RC00941                                            0943
@RF00941 L     @02,BUFND                                           0943
         CR    @02,REQDBUF                                         0943
         BNL   *+6
         LR    @02,REQDBUF                                         0943
         ST    @02,BUFND                                           0943
*   BUFNI=MAX(BUFNI,REQIBUF);       /* TO THE > OF USER SPEC &       */
@RC00941 L     @15,BUFNI                                           0944
         CR    @15,REQIBUF                                         0944
         BNL   *+6
         LR    @15,REQIBUF                                         0944
         ST    @15,BUFNI                                           0944
*   CURBFSPI=CTCISIZI*BUFNI;        /* MINIMUM REQUIREMENTS TO       */
         M     @14,CTCISIZI                                        0945
         ST    @15,CURBFSPI                                        0945
*   CURBFSPD=CTCISIZD*BUFND;        /* PROCESS THE DATA SET          */
         L     @01,CTCISIZD                                        0946
         M     @00,BUFND                                           0946
         ST    @01,CURBFSPD                                        0946
*   CURBUFSP=CURBFSPI+CURBFSPD;     /* CURRENT BUFFER SPACE          */
         ALR   @15,@01                                             0947
         LR    CURBUFSP,@15                                        0947
*   BUFSP=MAX(BUFSP,CTBUFSIZ,REQBUFSP);/* BUFSP GREAT ENOUGH         */
         L     @15,CTBUFSIZ(,CWAPT)                                0948
         CR    @15,BUFSP                                           0948
         BNL   *+6
         LR    @15,BUFSP                                           0948
         CR    @15,REQBUFSP                                        0948
         BNL   *+6
         LR    @15,REQBUFSP                                        0948
         LR    BUFSP,@15                                           0948
*   IF AMBLCAT^=ON THEN             /* LEAVE BUFFERS AS IS IF CAT    */
         L     @04,ACBPTR                                          0949
         L     @04,ACBAMBL(,@04)                                   0949
         TM    AMBLCAT(@04),B'00000010'                            0949
         BO    @RF00949                                            0949
*     IF BUFSP<CURBUFSP THEN        /* CURRENT BFR SPACE OVER LIMIT? */
         CR    BUFSP,CURBUFSP                                      0950
         BNL   @RF00950                                            0950
*       CALL TRIMMER;               /* YES - CUT NBR OF BFRS         */
         BAL   @14,TRIMMER                                         0951
*     ELSE                          /* NO                            */
*       CALL BEEFER;                /* INCREASE NBR OF BFRS TO COMPLY*/
         B     @RC00950                                            0952
@RF00950 BAL   @14,BEEFER                                          0952
*   RET=RSAVLA;                                                    0953
@RC00950 DS    0H                                                  0953
@RF00949 L     RET,RSAVLA                                          0953
*TRIMMER:                                                          0954
*                                                                  0954
*   /*****************************************************************/
*   /*                                                               */
*   /* DECREASE THE NUMBER OF BUFFERS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0954
         B     @PB00019                                            0954
TRIMMER  DS    0H                                                  0955
*   RSAVLB=RET;                                                    0955
         ST    RET,RSAVLB                                          0955
*   IF ACBDIR=ON THEN               /* DIRECT PROCESSING?            */
         L     @04,ACBPTR                                          0956
         TM    ACBDIR(@04),B'00001000'                             0956
         BNO   @RF00956                                            0956
*     DO;                           /* YES                           */
*       BUFND=MAX(REQDBUF,(BUFND-   /* DECREASE DATA BFRS UNTIL CURNT*/
*           (CURBUFSP+CTCISIZD-     /* BFR SPACE =< MAX OR NBR OF  0958
*                                      DATA                          */
*           ONE-BUFSP)/CTCISIZD));  /* BFRS = MINIMUM REQUIRED       */
         L     @04,CTCISIZD                                        0958
         LR    @00,CURBUFSP                                        0958
         ALR   @00,@04                                             0958
         BCTR  @00,0                                               0958
         SLR   @00,BUFSP                                           0958
         SRDA  @00,32                                              0958
         DR    @00,@04                                             0958
         LCR   @01,@01                                             0958
         AL    @01,BUFND                                           0958
         CR    @01,REQDBUF                                         0958
         BNL   *+6
         LR    @01,REQDBUF                                         0958
         ST    @01,BUFND                                           0958
*       CURBUFSP=CTCISIZD*BUFND+    /* UPDATE CURRENT BUFFER SPACE   */
*           CURBFSPI;               /*                               */
         LR    @15,@04                                             0959
         MR    @14,@01                                             0959
         AL    @15,CURBFSPI                                        0959
         LR    CURBUFSP,@15                                        0959
*       IF CURBUFSP>BUFSP THEN      /* MORE TO TRIM?                 */
         CR    CURBUFSP,BUFSP                                      0960
         BNH   @RF00960                                            0960
*         BUFNI=MAX(REQIBUF,(BUFNI- /* YES,                          */
*             (CURBUFSP+CTCISIZI-   /* DECREMENT INDEX               */
*             ONE-BUFSP)/CTCISIZI));/* BUFFERS                       */
         L     @07,CTCISIZI                                        0961
         LR    @00,CURBUFSP                                        0961
         ALR   @00,@07                                             0961
         BCTR  @00,0                                               0961
         SLR   @00,BUFSP                                           0961
         SRDA  @00,32                                              0961
         DR    @00,@07                                             0961
         LCR   @01,@01                                             0961
         AL    @01,BUFNI                                           0961
         CR    @01,REQIBUF                                         0961
         BNL   *+6
         LR    @01,REQIBUF                                         0961
         ST    @01,BUFNI                                           0961
*     END;                                                         0962
*   ELSE                            /* PROCESSING IS NOT DIRECT      */
*     DO;                                                          0963
         B     @RC00956                                            0963
@RF00956 DS    0H                                                  0964
*       IF CTCISIZI^=ZERO THEN      /* DO WE HAVE AN INDEX           */
         L     @04,CTCISIZI                                        0964
         LTR   @04,@04                                             0964
         BZ    @RF00964                                            0964
*         DO;                                                      0965
*           BUFNI=MAX(REQIBUF+ONE,  /* DECREASE INDEX                */
*               (BUFNI-(CURBUFSP+   /* BUFFERS                       */
*               CTCISIZI-ONE-BUFSP)/CTCISIZI));                    0966
         LA    @15,1                                               0966
         ALR   @15,REQIBUF                                         0966
         LR    @00,CURBUFSP                                        0966
         ALR   @00,@04                                             0966
         BCTR  @00,0                                               0966
         SLR   @00,BUFSP                                           0966
         SRDA  @00,32                                              0966
         DR    @00,@04                                             0966
         LCR   @01,@01                                             0966
         AL    @01,BUFNI                                           0966
         CR    @15,@01                                             0966
         BNL   *+6
         LR    @15,@01                                             0966
         ST    @15,BUFNI                                           0966
*           CURBUFSP=(CTCISIZI*     /* UPDATE CURRENT BUFFER SPACE   */
*               BUFNI+CURBFSPD);                                   0967
         LR    @01,@04                                             0967
         MR    @00,@15                                             0967
         AL    @01,CURBFSPD                                        0967
         LR    CURBUFSP,@01                                        0967
*         END;                                                     0968
*       IF CURBUFSP>BUFSP THEN      /* IF MORE TO TRIM               */
@RF00964 CR    CURBUFSP,BUFSP                                      0969
         BNH   @RF00969                                            0969
*         DO;                                                      0970
*           BUFND=MAX(REQDBUF,      /*                               */
*               (BUFND-(CURBUFSP+   /* YES DECREASE DATA BUFFERS     */
*               CTCISIZD-ONE-BUFSP)/CTCISIZD));                    0971
         L     @04,CTCISIZD                                        0971
         LR    @00,CURBUFSP                                        0971
         ALR   @00,@04                                             0971
         BCTR  @00,0                                               0971
         SLR   @00,BUFSP                                           0971
         SRDA  @00,32                                              0971
         DR    @00,@04                                             0971
         LCR   @01,@01                                             0971
         AL    @01,BUFND                                           0971
         CR    @01,REQDBUF                                         0971
         BNL   *+6
         LR    @01,REQDBUF                                         0971
         ST    @01,BUFND                                           0971
*           CURBUFSP=CURBFSPI+CTCISIZD*BUFND;/* UPDATE CURRENT BUFFER
*                                      SPACE                         */
         LR    @15,@04                                             0972
         MR    @14,@01                                             0972
         AL    @15,CURBFSPI                                        0972
         LR    CURBUFSP,@15                                        0972
*           IF CURBUFSP>BUFSP THEN  /* MORE TO TRIM?                 */
         CR    CURBUFSP,BUFSP                                      0973
         BNH   @RF00973                                            0973
*             BUFNI=REQIBUF;        /* CUT TO BARE BONES             */
         ST    REQIBUF,BUFNI                                       0974
*         END;                                                     0975
@RF00973 DS    0H                                                  0976
*     END;                                                         0976
@RF00969 DS    0H                                                  0977
*   RET=RSAVLB;                                                    0977
@RC00956 L     RET,RSAVLB                                          0977
*   END TRIMMER;                                                   0978
@EL00019 DS    0H                                                  0978
@EF00019 DS    0H                                                  0978
@ER00019 BR    @14                                                 0978
*BEEFER:                                                           0979
*                                                                  0979
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREASE THE NUMBER OF BUFFERS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0979
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0979
BEEFER   DS    0H                                                  0980
*   RSAVLB=RET;                                                    0980
         ST    RET,RSAVLB                                          0980
*   IF ACBDIR=ON THEN               /* IF DIRECT PROCESSING          */
         L     @09,ACBPTR                                          0981
         TM    ACBDIR(@09),B'00001000'                             0981
         BNO   @RF00981                                            0981
*     DO;                           /* YES INCREASE INDEX BUFFERS    */
*       IF CTCISIZI^=ZERO THEN      /* DO WE HAVE AN INDEX           */
         L     @09,CTCISIZI                                        0983
         LTR   @09,@09                                             0983
         BZ    @RF00983                                            0983
*         DO;                                                      0984
*           BUFNI=BUFNI+            /* NOT TO EXCEED BUFSP           */
*               (BUFSP-CURBUFSP)/CTCISIZI;                         0985
         LR    @00,BUFSP                                           0985
         SLR   @00,CURBUFSP                                        0985
         SRDA  @00,32                                              0985
         DR    @00,@09                                             0985
         AL    @01,BUFNI                                           0985
         ST    @01,BUFNI                                           0985
*           CURBUFSP=CTCISIZI*BUFNI+/* UPDATE CURRENT BUFFER         */
*               CURBFSPD;           /* SPACE                         */
         LR    @03,@09                                             0986
         MR    CURBUFSP,@01                                        0986
         AL    @03,CURBFSPD                                        0986
         LR    CURBUFSP,@03                                        0986
*         END;                                                     0987
*       ELSE                        /* IS AN INDEX                   */
*         BUFND=BUFND+(BUFSP-CURBUFSP)/CTCISIZD;                   0988
         B     @RC00983                                            0988
@RF00983 LR    @00,BUFSP                                           0988
         SLR   @00,CURBUFSP                                        0988
         SRDA  @00,32                                              0988
         D     @00,CTCISIZD                                        0988
         AL    @01,BUFND                                           0988
         ST    @01,BUFND                                           0988
*     END;                                                         0989
*   ELSE                            /* NOT DIRECT PROCESSING         */
*     DO;                                                          0990
         B     @RC00981                                            0990
@RF00981 DS    0H                                                  0991
*       IF CTCISIZI<=BUFSP-CURBUFSP THEN/* ROOM FOR 1 INDEX BFRS     */
         L     @09,CTCISIZI                                        0991
         LR    @07,BUFSP                                           0991
         SLR   @07,CURBUFSP                                        0991
         CR    @09,@07                                             0991
         BH    @RF00991                                            0991
*         DO;                       /* YES DO                        */
*           BUFNI=BUFNI+ONE;        /* BUMP INDEX BFR NBR            */
         LA    @07,1                                               0993
         AL    @07,BUFNI                                           0993
         ST    @07,BUFNI                                           0993
*           CURBUFSP=CURBUFSP+CTCISIZI;/* UPDT CURRENT BFR SPACE     */
         ALR   CURBUFSP,@09                                        0994
*           BUFND=BUFND+            /* REMAINING SPACE USED          */
*               (BUFSP-CURBUFSP)/CTCISIZD;/* FOR DATA BUFFERS        */
         L     @04,CTCISIZD                                        0995
         LR    @00,BUFSP                                           0995
         SLR   @00,CURBUFSP                                        0995
         SRDA  @00,32                                              0995
         DR    @00,@04                                             0995
         AL    @01,BUFND                                           0995
         ST    @01,BUFND                                           0995
*           CURBUFSP=CTCISIZD*BUFND+CTCISIZI*BUFNI;                0996
         LR    @15,@04                                             0996
         MR    @14,@01                                             0996
         LR    @01,@09                                             0996
         MR    @00,@07                                             0996
         ALR   @15,@01                                             0996
         LR    CURBUFSP,@15                                        0996
*           IF CTCISIZI^=ZERO THEN  /* IF INDX SIZ NOT 0             */
         LTR   @09,@09                                             0997
         BZ    @RF00997                                            0997
*             DO;                                                  0998
*               BUFNI=BUFNI+        /* REMAINING SPACE USED FOR      */
*                   (BUFSP-CURBUFSP)/CTCISIZI;/* INDEX BUFFERS       */
         LR    @00,BUFSP                                           0999
         SLR   @00,CURBUFSP                                        0999
         SRDA  @00,32                                              0999
         DR    @00,@09                                             0999
         ALR   @07,@01                                             0999
         ST    @07,BUFNI                                           0999
*             END;                                                 1000
*         END;                                                     1001
@RF00997 DS    0H                                                  1002
*     END;                                                         1002
@RF00991 DS    0H                                                  1003
*   RET=RSAVLB;                                                    1003
@RC00981 L     RET,RSAVLB                                          1003
*   END BEEFER;                                                    1004
@EL00020 DS    0H                                                  1004
@EF00020 DS    0H                                                  1004
@ER00020 BR    @14                                                 1004
*   END BUFNOSET;                                                  1005
@EL00018 DS    0H                                                  1005
@EF00018 DS    0H                                                  1005
@ER00018 BR    @14                                                 1005
*BLDBUFC:                                                          1006
*                                                                  1006
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD A BUFDR                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1006
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1006
BLDBUFC  DS    0H                                                  1007
*   RSAVLA=RET;                                                    1007
         ST    RET,RSAVLA                                          1007
*   IF AMBTYPE=AMBDATA THEN         /* IS THIS A DATA AMB?           */
         TM    AMBTYPE(AMBPT),B'01000000'                          1008
         BNZ   @RF01008                                            1008
*     BUFNO=BUFND;                  /* YES BUFNO= NBR DATA BFRS      */
         L     BUFNO,BUFND                                         1009
*   ELSE                            /* INDEX                         */
*     BUFNO=BUFNI;                  /* BUFNO = NBR OF INDEX BFRS     */
         B     @RC01008                                            1010
@RF01008 L     BUFNO,BUFNI                                         1010
*   CORELEN=LENGTH(IDABUFDR)+BUFNO*LENGTH(IDABUFC);/* SET BLOCK    1011
*                                      LENGTH FOR GMAIN              */
@RC01008 LR    @09,BUFNO                                           1011
         SLA   @09,6                                               1011
         AL    @09,@CF03059                                        1011
         ST    @09,CORELEN                                         1011
*   CALL GETCORE;                   /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1012
*   AMBBUFC=COREADDR;               /* CHAIN BUFC OFF AMB            */
         L     @09,COREADDR                                        1013
         ST    @09,AMBBUFC(,AMBPT)                                 1013
*   BUFDRID=IDXBUFDR;               /* SET ID                        */
         MVI   BUFDRID(@09),B'01110000'                            1014
*   BUFDRNO=BUFNO;                  /* BUFFER NBR                    */
         STC   BUFNO,BUFDRNO(,@09)                                 1015
*   BUFDRLEN=LENGTH(IDABUFC);       /* SET BUFC LENGTH               */
         MVC   BUFDRLEN(2,@09),@CH01157                            1016
*   IF AMBTYPE=AMBDATA THEN         /* IS AMB FOR DATA?              */
         TM    AMBTYPE(AMBPT),B'01000000'                          1017
         BNZ   @RF01017                                            1017
*     DO;                           /* YES DO                        */
*       BUFDRMAX=MAX(BUFND-AMBLNST-ONE,BUFND/AMBLNST);/* SET MAX   1019
*                                      BUFFERS                       */
         L     @07,BUFND                                           1019
         L     @04,ACBPTR                                          1019
         L     @04,ACBAMBL(,@04)                                   1019
         SLR   @03,@03                                             1019
         IC    @03,AMBLNST(,@04)                                   1019
         LR    @04,@07                                             1019
         SLR   @04,@03                                             1019
         BCTR  @04,0                                               1019
         LR    @00,@07                                             1019
         SRDA  @00,32                                              1019
         DR    @00,@03                                             1019
         CR    @04,@01                                             1019
         BNL   *+6
         LR    @04,@01                                             1019
         STC   @04,BUFDRMAX(,@09)                                  1019
*       IF BUFNO>AMBLNST+ONE THEN   /* EXTRA BUFFERS?                */
         AL    @03,@CF00076                                        1020
         CR    BUFNO,@03                                           1020
         BNH   @RF01020                                            1020
*         BUFDRAVL=ON;              /* INDICATE BFR AVAILABLE        */
         OI    BUFDRAVL(@09),B'01000000'                           1021
*     END;                                                         1022
*   ELSE                            /* AMB IS FOR INDEX              */
*     BUFDRCIX=MAX((BUFNO-AMBLNST-ONE),0);/* INIT NBR COMMON INDEX 1023
*                                      BFRS EXCLUDING HIGH LEVEL IF
*                                      IT IEXISTS                    */
         B     @RC01017                                            1023
@RF01017 L     @09,AMBBUFC(,AMBPT)                                 1023
         L     @07,ACBPTR                                          1023
         L     @07,ACBAMBL(,@07)                                   1023
         LR    @04,BUFNO                                           1023
         SLR   @03,@03                                             1023
         IC    @03,AMBLNST(,@07)                                   1023
         SLR   @04,@03                                             1023
         BCTR  @04,0                                               1023
         SLR   @07,@07                                             1023
         CR    @04,@07                                             1023
         BNL   *+6
         LR    @04,@07                                             1023
         STC   @04,BUFDRCIX(,@09)                                  1023
*   RESPECIFY                                                      1024
*     IDABUFC BASED(IX);                                           1024
@RC01017 DS    0H                                                  1025
*   IX=ADDR(IDABUFDR)+LENGTH(IDABUFDR);/* ADDRESSABILITY FOR BUFC    */
         LA    @09,20                                              1025
         AL    @09,AMBBUFC(,AMBPT)                                 1025
         ST    @09,IX                                              1025
*   BUFCEPT=ON;                                                    1026
         OI    BUFCEPT(@09),B'00000001'                            1026
*   BUFCNXT1=IX+LENGTH(IDABUFC);    /* INIT CHAIN PTR                */
         LA    @07,64                                              1027
         ALR   @07,@09                                             1027
         ST    @07,BUFCNXT1(,@09)                                  1027
*   BUFCFIX=ON;                                                    1028
         OI    BUFCFIX(@09),B'00000001'                            1028
*   IF AMDWCK=ON THEN               /* WRITE CHECK                   */
         L     @07,AMBDSB(,AMBPT)                                  1029
         TM    AMDWCK(@07),B'01000000'                             1029
         BNO   @RF01029                                            1029
*     BUFCWC=ON;                                                   1030
         OI    BUFCWC(@09),B'00001000'                             1030
*   IF AMBTYPE=AMBINDEX&            /* ONLY 1 INDEX BUFFER PER       */
*       BUFNO=AMBLNST THEN          /* STRING                        */
@RF01029 TM    AMBTYPE(AMBPT),B'01000000'                          1031
         BNO   @RF01031                                            1031
         L     @09,ACBPTR                                          1031
         L     @09,ACBAMBL(,@09)                                   1031
         SLR   @07,@07                                             1031
         IC    @07,AMBLNST(,@09)                                   1031
         CR    BUFNO,@07                                           1031
         BNE   @RF01031                                            1031
*     BUFCAVL='FF'X;                                               1032
         L     @09,IX                                              1032
         MVI   BUFCAVL(@09),X'FF'                                  1032
*   IX=IX+LENGTH(IDABUFC);          /* PT TO SECOND BUFC             */
@RF01031 LA    @09,64                                              1033
         AL    @09,IX                                              1033
         ST    @09,IX                                              1033
*   DO IX2=BUFDRNO-ONE TO 1 BY-1;   /* INIT REMAINING BUFC'S         */
         L     @09,AMBBUFC(,AMBPT)                                 1034
         SLR   @07,@07                                             1034
         IC    @07,BUFDRNO(,@09)                                   1034
         BCTR  @07,0                                               1034
         ST    @07,IX2                                             1034
         B     @DE01034                                            1034
@DL01034 DS    0H                                                  1035
*     BUFCNXT1=IX+LENGTH(IDABUFC);  /* INIT CHAIN PTR                */
         L     @09,IX                                              1035
         LA    @07,64                                              1035
         ALR   @07,@09                                             1035
         ST    @07,BUFCNXT1(,@09)                                  1035
*     IF AMDWCK=ON THEN             /* WRITE CHECK?                  */
         L     @07,AMBDSB(,AMBPT)                                  1036
         TM    AMDWCK(@07),B'01000000'                             1036
         BNO   @RF01036                                            1036
*       BUFCWC=ON;                  /* SET WRITE CHECK BIT           */
         OI    BUFCWC(@09),B'00001000'                             1037
*     BUFCEPT=ON;                                                  1038
@RF01036 L     @09,IX                                              1038
         OI    BUFCEPT(@09),B'00000001'                            1038
*     BUFCFIX=ON;                   /* INDICATE FIXED CORE           */
         OI    BUFCFIX(@09),B'00000001'                            1039
*     IX=IX+LENGTH(IDABUFC);        /* NEXT BUFC                     */
         AL    @09,@CF01157                                        1040
         ST    @09,IX                                              1040
*   END;                                                           1041
         SLR   @07,@07                                             1041
         BCTR  @07,0                                               1041
         AL    @07,IX2                                             1041
         ST    @07,IX2                                             1041
@DE01034 LTR   @07,@07                                             1041
         BP    @DL01034                                            1041
*   IX=IX-LENGTH(IDABUFC);                                         1042
         L     @09,IX                                              1042
         SL    @09,@CF01157                                        1042
         ST    @09,IX                                              1042
*   BUFCNXT1=ADDR(IDABUFDR)+LENGTH(IDABUFDR);                      1043
         LA    @07,20                                              1043
         AL    @07,AMBBUFC(,AMBPT)                                 1043
         ST    @07,BUFCNXT1(,@09)                                  1043
*   RET=RSAVLA;                                                    1044
         L     RET,RSAVLA                                          1044
*   END BLDBUFC;                                                   1045
@EL00021 DS    0H                                                  1045
@EF00021 DS    0H                                                  1045
@ER00021 BR    @14                                                 1045
*BLDIOMB:                                                          1046
*                                                                  1046
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD IOMB'S AND CALL THE ROUTINES WHICH BUILD THE BLOCKS     */
*   /* CONNECTED TO IT                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1046
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1046
BLDIOMB  DS    0H                                                  1047
*   RSAVLB=RET;                                                    1047
         ST    RET,RSAVLB                                          1047
*   IF AMBTYPE=AMBDATA THEN         /* COMPUTE LENGTH OF VSL         */
         TM    AMBTYPE(AMBPT),B'01000000'                          1048
         BNZ   @RF01048                                            1048
*     PFPL=PFPD+EIGHT+BUFDRMAX;     /*                               */
         L     @09,AMBBUFC(,AMBPT)                                 1049
         LA    PFPL,32                                             1049
         SLR   @07,@07                                             1049
         IC    @07,BUFDRMAX(,@09)                                  1049
         ALR   PFPL,@07                                            1049
*   ELSE                            /* INDEX                         */
*     PFPL=PFPI;                                                   1050
         B     @RC01048                                            1050
@RF01048 LA    PFPL,32                                             1050
*   IX=(LENGTH(IDAIOMB)+H11)/EIGHT*EIGHT+/* COMPUTE LENGTH OF ONE    */
*       (PFPL+SEVEN)/EIGHT*EIGHT+   /* SET OF CONTROL BLOCKS         */
*       (LENGTH(IOSB)+SEVEN)/EIGHT*EIGHT+(LENGTH(SRBSECT)+SEVEN)/EIGHT*
*       EIGHT;                                                     1051
@RC01048 LA    @00,7                                               1051
         ALR   @00,PFPL                                            1051
         SRDA  @00,32                                              1051
         D     @00,@CF00058                                        1051
         SLA   @01,3                                               1051
         AL    @01,@CF04217                                        1051
         ST    @01,IX                                              1051
*   IX=IX+((LENGTH(IQESECT)+SEVEN)/EIGHT*EIGHT);/* ADD IQE   @ZA09991*/
         AL    @01,@CF00140                                        1052
         ST    @01,IX                                              1052
*   CORELEN=IX*AMBLNST;             /* COMPUTE CORE LENGTH NEEDED    */
         L     @09,ACBPTR                                          1053
         L     @09,ACBAMBL(,@09)                                   1053
         SLR   @07,@07                                             1053
         IC    @07,AMBLNST(,@09)                                   1053
         MR    @00,@07                                             1053
         ST    @01,CORELEN                                         1053
*   CALL GETCORE;                   /* GET IT                        */
         BAL   @14,GETCORE                                         1054
*   IQEPTR=COREADDR;                /* LOAD IQE ADDR         @ZA09991*/
         L     IQEPTR,COREADDR                                     1055
*   IOMBAD=IQEPTR+                  /* LOAD IOMB ADDRESS     @ZA09991*/
*       ((LENGTH(IQESECT)+SEVEN)/EIGHT*EIGHT);/*             @ZA09991*/
         LA    IOMBAD,24                                           1056
         ALR   IOMBAD,IQEPTR                                       1056
*   AMBIOMB=IOMBAD;                 /* START CHAIN FROM AMB          */
         ST    IOMBAD,AMBIOMB(,AMBPT)                              1057
*   DO IX9=AMBLNST TO 1 BY-1;       /* INITIALIZE ALL IOMBS          */
         L     @09,ACBPTR                                          1058
         L     @09,ACBAMBL(,@09)                                   1058
         SLR   @07,@07                                             1058
         IC    @07,AMBLNST(,@09)                                   1058
         ST    @07,IX9                                             1058
         B     @DE01058                                            1058
@DL01058 DS    0H                                                  1059
*     IOMAMB=ADDR(IDAAMB);          /* PT TO AMB                     */
         ST    AMBPT,IOMAMB(,IOMBAD)                               1059
*     IOMIQE=IQEPTR;                /* PT TO DUMMY IQE       @ZA09991*/
         ST    IQEPTR,IOMIQE(,IOMBAD)                              1060
*     IOMIOSB=ADDR(IOSB);           /* PT IOMB TO IOSB               */
         LA    @09,136                                             1061
         ALR   @09,IOMBAD                                          1061
         ST    @09,IOMIOSB(,IOMBAD)                                1061
*     IOMVSL=ADDR(SRBSECT)+(LENGTH(SRBSECT)+SEVEN)/EIGHT*EIGHT;    1062
         LA    @09,296                                             1062
         ALR   @09,IOMBAD                                          1062
         ST    @09,IOMVSL(,IOMBAD)                                 1062
*     IOMNXT1=ADDR(IDAIOMB)+IX;                                    1063
         LR    @09,IOMBAD                                          1063
         AL    @09,IX                                              1063
         ST    @09,IOMNXT1(,IOMBAD)                                1063
*     IOMBID='IOMB';                /* SET ID (IMP UNTIL DR5)        */
         MVC   IOMBID(4,IOMBAD),@CC04098                           1064
*     IOMECBPT=ADDR(IDAIOMB)+       /* ECB POINTER                   */
*         (LENGTH(IDAIOMB)+THREE)/FOUR*FOUR;                       1065
         LA    @09,132                                             1065
         ALR   @09,IOMBAD                                          1065
         ST    @09,IOMECBPT(,IOMBAD)                               1065
*     IOMUFLD=IOMECBPT-20;          /* SET IOMBXN POINTER SO THAT THE
*                                      ECB IN THE EXTENTION OVERLAYS
*                                      THE OTHER ECB         @ZA15977*/
         SL    @09,@CF03059                                        1066
         ST    @09,IOMUFLD(,IOMBAD)                                1066
*     CALL BLDIOSB;                 /* BUILD IOSB                    */
         BAL   @14,BLDIOSB                                         1067
*     IOMBAD=IOMNXT1;                                              1068
         L     IOMBAD,IOMNXT1(,IOMBAD)                             1068
*     IQEPTR=IQEPTR+IX;             /* STEP IQE POINTER      @ZA09991*/
         AL    IQEPTR,IX                                           1069
*   END;                                                           1070
         SLR   @07,@07                                             1070
         BCTR  @07,0                                               1070
         AL    @07,IX9                                             1070
         ST    @07,IX9                                             1070
@DE01058 LTR   @07,@07                                             1070
         BP    @DL01058                                            1070
*   IOMBAD=IOMBAD-IX;               /* STEP BACK TO LAST IOMB        */
         SL    IOMBAD,IX                                           1071
*   IOMNXT1=ZERO;                                                  1072
         SLR   @09,@09                                             1072
         ST    @09,IOMNXT1(,IOMBAD)                                1072
*   RET=RSAVLB;                                                    1073
         L     RET,RSAVLB                                          1073
*BLDIOSB:                                                          1074
*                                                                  1074
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD AN IOSB -ADDRESSING ESTABLISHED IN BLD IOMB             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1074
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1074
         B     @PB00023                                            1074
BLDIOSB  DS    0H                                                  1075
*   RSAVLC=RET;                                                    1075
         ST    RET,RSAVLC                                          1075
*   IOSACHN='11'B;                  /* DATA & COMMAND CHAINING       */
         LA    @09,136                                             1076
         ALR   @09,IOMBAD                                          1076
         OI    IOSACHN(@09),B'11000000'                            1076
*   IOSDVRID='03'X;                 /* DRIVER IDENTIFICATION         */
         MVI   IOSDVRID(@09),X'03'                                 1077
*   IOSCKEY=ZERO;                   /* CHANNEL PGM PROTECT KEY       */
         MVI   IOSCKEY(@09),X'00'                                  1078
*   IOSUSE=IOMBAD;                  /* POINT BACK TO IOMB            */
         ST    IOMBAD,IOSUSE(,@09)                                 1079
*   IOSSRB=ADDR(SRBSECT);           /* POINT TO SRB                  */
         LA    @07,248                                             1080
         ALR   @07,IOMBAD                                          1080
         ST    @07,IOSSRB(,@09)                                    1080
*   IOSNRM=ABPNE;                   /* PT TO NORMAL END APPENDAGE    */
         L     @07,CVTPTR                                          1081
         L     @07,CVTIOBP(,@07)                                   1081
         L     @04,ABPNE(,@07)                                     1081
         ST    @04,IOSNRM(,@09)                                    1081
*   IOSABN=ABPAE;                   /* PT TO ABNORMAL END APNDGE     */
         L     @07,ABPAE(,@07)                                     1082
         ST    @07,IOSABN(,@09)                                    1082
*   IOSFMSK='88'X;                  /* FILE MASK TO STOP FORMAT WRITE
*                                      AND FULL SEEKS                */
         MVI   IOSFMSK(@09),X'88'                                  1083
*   CALL BLDSRB;                    /* BUILD SRB                     */
         BAL   @14,BLDSRB                                          1084
*   IOSASID=ASCBASID;               /* ADDR SPACE ID                 */
         L     @09,SRBASCB+248(,IOMBAD)                            1085
         MVC   @TS00001(2),ASCBASID(@09)                           1085
         MVC   IOSASID+136(2,IOMBAD),@TS00001                      1085
*   RET=RSAVLC;                                                    1086
         L     RET,RSAVLC                                          1086
*   END BLDIOSB;                                                   1087
@EL00023 DS    0H                                                  1087
@EF00023 DS    0H                                                  1087
@ER00023 BR    @14                                                 1087
*BLDSRB:                                                           1088
*                                                                  1088
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD AN SRB SPACE IS ALLOCATED, SET PTR'S TO IOSB & ASCB     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1088
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1088
BLDSRB   DS    0H                                                  1089
*   RSAVLD=RET;                                                    1089
         ST    RET,RSAVLD                                          1089
*   SRBASCB=NVTMASCB;                                              1090
         LA    @09,248                                             1090
         ALR   @09,IOMBAD                                          1090
         L     @07,NVTPTR                                          1090
         L     @07,NVTMASCB(,@07)                                  1090
         ST    @07,SRBASCB(,@09)                                   1090
*   SRBPARM=ADDR(IOSB);                                            1091
         LA    @07,136                                             1091
         ALR   @07,IOMBAD                                          1091
         ST    @07,SRBPARM(,@09)                                   1091
*   SRBEP=ABPABP;                   /* ENTRY POINT FOR BLK PROC      */
         L     @07,CVTPTR                                          1092
         L     @07,CVTIOBP(,@07)                                   1092
         L     @07,ABPABP(,@07)                                    1092
         ST    @07,SRBEP(,@09)                                     1092
*   RET=RSAVLD;                                                    1093
         L     @09,RSAVLD                                          1093
         LR    RET,@09                                             1093
*   END BLDSRB;                                                    1094
@EL00024 DS    0H                                                  1094
@EF00024 DS    0H                                                  1094
@ER00024 BR    @14                                                 1094
*   END BLDIOMB;                                                   1095
@EL00022 DS    0H                                                  1095
@EF00022 DS    0H                                                  1095
@ER00022 BR    @14                                                 1095
*BLDBFRS:                                                          1096
*                                                                  1096
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET BUFFERS FOR AN ASSOCIATED AMB. INPUT IS */
*   /* AMB, BUFCDR & AMDSB                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1096
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1096
BLDBFRS  DS    0H                                                  1097
*   RSAVLA=RET;                                                    1097
         ST    RET,RSAVLA                                          1097
*   IF AMBUBF=OFFX THEN             /* IS USER PROVIDING BUFFERS?    */
         TM    AMBUBF(AMBPT),B'00000100'                           1098
         BNZ   @RF01098                                            1098
*     DO;                                                          1099
*       CORELEN=AMDCINV*(BUFDRNO+1);/* GET CORE FOR ALL BUFFERS      */
         L     @09,AMBDSB(,AMBPT)                                  1100
         L     @07,AMBBUFC(,AMBPT)                                 1100
         SLR   @04,@04                                             1100
         IC    @04,BUFDRNO(,@07)                                   1100
         LA    @07,1                                               1100
         ALR   @07,@04                                             1100
         LR    @01,@07                                             1100
         M     @00,AMDCINV(,@09)                                   1100
         ST    @01,CORELEN                                         1100
*       IX2=BUFDRNO;                /* PROCESS ALL BUFFERS           */
         ST    @04,IX2                                             1101
*       CALL GETCORE;               /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1102
*       WKBUF1=((COREADDR+2047)/2048)*2048;/* COMPUTE        @VS34502*/
         L     @09,COREADDR                                        1103
         LA    @00,2047                                            1103
         ALR   @00,@09                                             1103
         SRDA  @00,32                                              1103
         D     @00,@CF04112                                        1103
         SLA   @01,11                                              1103
         LR    WKBUF1,@01                                          1103
*       WKBUF1=WKBUF1-COREADDR;     /* DIST TO NEXT 2K BNDY  @VS34502*/
         SLR   WKBUF1,@09                                          1104
*       WKBUF2=((COREADDR+AMDCINV-1)/AMDCINV)*AMDCINV;/* COMPUTE   1105
*                                                            @VS34502*/
         L     @07,AMBDSB(,AMBPT)                                  1105
         L     @07,AMDCINV(,@07)                                   1105
         LR    @01,@09                                             1105
         ALR   @01,@07                                             1105
         BCTR  @01,0                                               1105
         LR    @14,@01                                             1105
         SRDA  @14,32                                              1105
         DR    @14,@07                                             1105
         MR    @14,@07                                             1105
         LR    WKBUF2,@15                                          1105
*       WKBUF2=WKBUF2-COREADDR;     /* DIST TO NEXT RECORD BNDY    1106
*                                                            @VS34502*/
         SLR   WKBUF2,@09                                          1106
*       IF WKBUF2^=0&WKBUF1<AMDCINV*BUFDRNO THEN/* ADJUST SO THAT    */
         LTR   WKBUF2,WKBUF2                                       1107
         BZ    @RF01107                                            1107
         L     @04,AMBBUFC(,AMBPT)                                 1107
         LR    @15,@07                                             1107
         SLR   @07,@07                                             1107
         IC    @07,BUFDRNO(,@04)                                   1107
         MR    @14,@07                                             1107
         CR    WKBUF1,@15                                          1107
         BNL   @RF01107                                            1107
*         COREADDR=COREADDR+WKBUF2; /* BUFFER DOESNT OVERLAP 2K BNDY
*                                                            @VS34502*/
         ALR   @09,WKBUF2                                          1108
         ST    @09,COREADDR                                        1108
*       IX=ADDR(IDABUFDR)+LENGTH(IDABUFDR);/* ADDRESS OF 1ST BUFC    */
@RF01107 LA    @09,20                                              1109
         AL    @09,AMBBUFC(,AMBPT)                                 1109
         ST    @09,IX                                              1109
*       RESPECIFY                                                  1110
*         IDABUFC BASED(IX);                                       1110
*       DO IX2=IX2 TO 1 BY-1;                                      1111
         L     @09,IX2                                             1111
         B     @DE01111                                            1111
@DL01111 DS    0H                                                  1112
*         BUFCBAD=COREADDR;         /* PTR FR BUFC TO BUFFER         */
         L     @07,COREADDR                                        1112
         L     @04,IX                                              1112
         ST    @07,BUFCBAD(,@04)                                   1112
*         IX=IX+LENGTH(IDABUFC);    /* POINT TO NEXT BUFC            */
         AL    @04,@CF01157                                        1113
         ST    @04,IX                                              1113
*         COREADDR=COREADDR+AMDCINV;/* POINT TO NEXT BUFFER          */
         L     @04,AMBDSB(,AMBPT)                                  1114
         AL    @07,AMDCINV(,@04)                                   1114
         ST    @07,COREADDR                                        1114
*       END;                                                       1115
         BCTR  @09,0                                               1115
         ST    @09,IX2                                             1115
@DE01111 LTR   @09,@09                                             1115
         BP    @DL01111                                            1115
*     END;                                                         1116
*   RET=RSAVLA;                                                    1117
@RF01098 L     RET,RSAVLA                                          1117
*   END BLDBFRS;                                                   1118
@EL00025 DS    0H                                                  1118
@EF00025 DS    0H                                                  1118
@ER00025 BR    @14                                                 1118
*BLDCPA:                                                           1119
*                                                                  1119
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE CHANNEL PROGRAM AREA                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1119
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1119
BLDCPA   DS    0H                                                  1120
*   RSAVLA=RET;                                                    1120
         ST    RET,RSAVLA                                          1120
*   IX4=ADDR(IDABUFDR)+LENGTH(IDABUFDR);/*                   @ZA01935*/
         LA    IX4,20                                              1121
         AL    IX4,AMBBUFC(,AMBPT)                                 1121
*   RESPECIFY                                                      1122
*     IDABUFC BASED(IX4);           /* ADDRESSING FOR BUFC   @ZA01935*/
*   IX=AMDCINV/CTBLKSZ;             /* FIND BLKS/CINV                */
         L     @09,AMBDSB(,AMBPT)                                  1123
         L     @07,CTBLKSZ(,CWAPT)                                 1123
         L     @14,AMDCINV(,@09)                                   1123
         SRDA  @14,32                                              1123
         DR    @14,@07                                             1123
         ST    @15,IX                                              1123
*   IF CTBLKSZ>PGSIZE THEN          /* IS PHYSICAL BLK SIZE>PGSIZ    */
         CH    @07,PGSIZE                                          1124
         BNH   @RF01124                                            1124
*     IX3=TWELVE;                   /* IDAL IS 3 WORDS       @ZA11056*/
         LA    IX3,12                                              1125
*   ELSE                            /* BLKSIZE NOT GREATER THAN PAGE
*                                      SIZE                          */
*     IX3=EIGHT;                    /* IDAL IS 2 WORDS       @ZA11056*/
         B     @RC01124                                            1126
@RF01124 LA    IX3,8                                               1126
*   IX3=(IX3*IX+SEVEN)/EIGHT*EIGHT; /* GET SIZE OF IDAL & VPL        */
@RC01124 L     @09,IX                                              1127
         LR    @15,IX3                                             1127
         MR    @14,@09                                             1127
         LR    @00,@15                                             1127
         AL    @00,@CF00285                                        1127
         SRDA  @00,32                                              1127
         D     @00,@CF00058                                        1127
         SLA   @01,3                                               1127
         LR    IX3,@01                                             1127
*   IX2=THREE*IX+THREE;             /* CCW'S FOR UPDATE WRITE      1128
*                                                            @Z30SSRL*/
         LA    @04,3                                               1128
         LR    @01,@09                                             1128
         MR    @00,@04                                             1128
         ALR   @01,@04                                             1128
         ST    @01,IX2                                             1128
*   WCCWN=IX2;                                                     1129
         ST    @01,WCCWN                                           1129
*   IF BUFCWC=ON THEN               /* IF WRITE CHECK SPECIFIED      */
         TM    BUFCWC(IX4),B'00001000'                             1130
         BNO   @RF01130                                            1130
*     IX2=IX2+IX+FIVE;              /* ADD CCW'S FOR WC      @Z30SSRL*/
         ALR   @01,@09                                             1131
         AL    @01,@CF01094                                        1131
         ST    @01,IX2                                             1131
*   RCCWN=IX+FIVE;                  /* CCW'S FOR READ        @Z30SSRL*/
@RF01130 L     @09,IX                                              1132
         LA    @04,5                                               1132
         LR    RCCWN,@09                                           1132
         ALR   RCCWN,@04                                           1132
*   IX2=IX2+RCCWN;                  /* TOTAL CCW'S                   */
         LR    @15,RCCWN                                           1133
         AL    @15,IX2                                             1133
         ST    @15,IX2                                             1133
*   CORELEN=(LENGTH(IDACPA)+SEVEN)/ /* LENGTH OF BASIC SECTION       */
*       EIGHT*EIGHT+IX2*EIGHT+      /* CCW SPACE                     */
*       TWO*IX3+                    /* REAL PG LST & VIRTUL PG LS    */
*       (IX*LENGTH(SEARCHID)+SEVEN)/EIGHT*EIGHT;/* SEARCH ID AREA    */
         SLA   @15,3                                               1134
         AL    @15,@CF04201                                        1134
         LR    @02,IX3                                             1134
         ALR   @02,@02                                             1134
         ALR   @15,@02                                             1134
         LR    @01,@09                                             1134
         MR    @00,@04                                             1134
         LR    @00,@01                                             1134
         AL    @00,@CF00285                                        1134
         SRDA  @00,32                                              1134
         D     @00,@CF00058                                        1134
         SLA   @01,3                                               1134
         ALR   @15,@01                                             1134
         ST    @15,CORELEN                                         1134
*   RESPECIFY                                                      1135
*     CCW BASED(IX5);                                              1135
*   RESPECIFY                                                      1136
*     SEARCHID BASED(IX6);                                         1136
*   DO IX8=BUFDRNO TO 1 BY-1;       /* LOOP THROUGH BUFC'S           */
         L     @09,AMBBUFC(,AMBPT)                                 1137
         SLR   @04,@04                                             1137
         IC    @04,BUFDRNO(,@09)                                   1137
         ST    @04,IX8                                             1137
         B     @DE01137                                            1137
@DL01137 DS    0H                                                  1138
*     CALL GETCORE;                 /* STORAGE FOR CPA               */
         BAL   @14,GETCORE                                         1138
*     IF IX8=BUFDRNO THEN           /* FIRST CPA?                    */
         L     @09,AMBBUFC(,AMBPT)                                 1139
         L     @04,IX8                                             1139
         SLR   @02,@02                                             1139
         IC    @02,BUFDRNO(,@09)                                   1139
         CR    @04,@02                                             1139
         BNE   @RF01139                                            1139
*       AMBCPA=COREADDR;            /* YES, START CPA CHAIN          */
         L     @09,COREADDR                                        1140
         ST    @09,AMBCPA(,AMBPT)                                  1140
*     ELSE                          /* NO,                           */
*       DO;                                                        1141
         B     @RC01139                                            1141
@RF01139 DS    0H                                                  1142
*         CPANXT1=COREADDR;         /* CONTINUE CPA CHAIN            */
         L     @09,COREADDR                                        1142
         L     @04,BUFCCPA(,IX4)                                   1142
         ST    @09,CPANXT1(,@04)                                   1142
*         CPACPCHN=COREADDR;        /* SET DYNAMIC CHAIN             */
         ST    @09,CPACPCHN(,@04)                                  1143
*         IX4=IX4+LENGTH(IDABUFC);  /* NEXT BUFC                     */
         AL    IX4,@CF01157                                        1144
*       END;                                                       1145
*     BUFCCPA=COREADDR;             /* SET PTR                       */
@RC01139 L     @09,COREADDR                                        1146
         ST    @09,BUFCCPA(,IX4)                                   1146
*     CALL BLDCPADR;                /* BUILD CPA HEADER              */
         BAL   @14,BLDCPADR                                        1147
*     CALL BLDCPAW;                 /* INIT WRT CHAN PGM SEGMENT     */
         BAL   @14,BLDCPAW                                         1148
*     IF BUFCWC=ON THEN             /* IF WRT CHK REQUESTED          */
         TM    BUFCWC(IX4),B'00001000'                             1149
         BNO   @RF01149                                            1149
*       CALL BLDCPAWC;              /* BUILD WRT CHK CHAN PGM SEG    */
         BAL   @14,BLDCPAWC                                        1150
*     IF CPAVPLV=ON THEN            /* IF VPL IS VALID               */
@RF01149 L     @09,BUFCCPA(,IX4)                                   1151
         TM    CPAVPLV(@09),B'10000000'                            1151
         BNO   @RF01151                                            1151
*       CALL BLDCPAVL;              /* BUILD VIRTUAL PG LIST         */
         BAL   @14,BLDCPAVL                                        1152
*     CALL BLDCPAR;                 /* BUILD CPA                     */
@RF01151 BAL   @14,BLDCPAR                                         1153
*   END;                                                           1154
         SLR   @04,@04                                             1154
         BCTR  @04,0                                               1154
         AL    @04,IX8                                             1154
         ST    @04,IX8                                             1154
@DE01137 LTR   @04,@04                                             1154
         BP    @DL01137                                            1154
*   CPANXT1=AMBCPA;                 /* IF LAST BUFC , LAST CPA       */
         L     @09,BUFCCPA(,IX4)                                   1155
         L     @07,AMBCPA(,AMBPT)                                  1155
         ST    @07,CPANXT1(,@09)                                   1155
*   CPACPCHN=AMBCPA;                /* POINTS TO FIRST               */
         ST    @07,CPACPCHN(,@09)                                  1156
*   RET=RSAVLA;                                                    1157
         L     RET,RSAVLA                                          1157
*BLDCPADR:                                                         1158
*                                                                  1158
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CHANNEL PROGRAM AREA HEADER                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1158
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1158
         B     @PB00027                                            1158
BLDCPADR DS    0H                                                  1159
*   RSAVLB=RET;                                                    1159
         ST    RET,RSAVLB                                          1159
*   CPAID=IDXCPA;                   /* SET ID                        */
         L     @09,BUFCCPA(,IX4)                                   1160
         MVI   CPAID(@09),B'01110001'                              1160
*   CPALEN=CORELEN;                 /* SET CPA LENGTH                */
         L     @04,CORELEN                                         1161
         STH   @04,CPALEN(,@09)                                    1161
*   CPABCINV=IX;                    /* BLKS PER CONTROL INTERVAL     */
         L     @04,IX                                              1162
         STH   @04,CPABCINV(,@09)                                  1162
*   IX5=(ADDR(IDACPA)+LENGTH(IDACPA)+SEVEN)/EIGHT*EIGHT;/* 1ST CCW   */
         LA    @15,8                                               1163
         LA    @00,103                                             1163
         ALR   @00,@09                                             1163
         SRDA  @00,32                                              1163
         DR    @00,@15                                             1163
         SLA   @01,3                                               1163
         LR    IX5,@01                                             1163
*   IF BUFCWC=ON THEN               /* IF WRITE CHECK SPEC           */
         TM    BUFCWC(IX4),B'00001000'                             1164
         BNO   @RF01164                                            1164
*     DO;                                                          1165
*       CPAWCKS=IX5;                /* WRITE CHECK FIRST             */
         ST    IX5,CPAWCKS(,@09)                                   1166
*       CPAWCKE=CPAWCKS+(IX+FOUR)*LENGTH(CCW);/* PT TO LAST CCW    1167
*                                                            @Z30SSRL*/
         L     @02,BUFCCPA(,IX4)                                   1167
         L     @02,CPAWCKS(,@02)                                   1167
         AL    @04,@CF00048                                        1167
         SLA   @04,3                                               1167
         ALR   @02,@04                                             1167
         ST    @02,CPAWCKE(,@09)                                   1167
*       CPAWCPS=CPAWCKE+LENGTH(CCW);/* WRITE CCW'S NEXT              */
         ALR   @02,@15                                             1168
         ST    @02,CPAWCPS(,@09)                                   1168
*     END;                                                         1169
*   ELSE                            /* NO WRITE CHECK                */
*     CPAWCPS=IX5;                  /* WRITE CCW'S 1ST               */
         B     @RC01164                                            1170
@RF01164 L     @09,BUFCCPA(,IX4)                                   1170
         ST    IX5,CPAWCPS(,@09)                                   1170
*   CPAWCPE=CPAWCPS+(WCCWN-ONE)*LENGTH(CCW);/* LAST WCP CCW          */
@RC01164 L     @09,BUFCCPA(,IX4)                                   1171
         L     @04,CPAWCPS(,@09)                                   1171
         L     @02,WCCWN                                           1171
         BCTR  @02,0                                               1171
         SLA   @02,3                                               1171
         ALR   @02,@04                                             1171
         ST    @02,CPAWCPE(,@09)                                   1171
*   CPAWREAL=CPAWCPS;               /* VIRTUAL ADDR OF WRT CHN PG    */
         ST    @04,CPAWREAL(,@09)                                  1172
*   CPAIDAL=CPAWCPE+LENGTH(CCW);    /* ADDR OF REAL PG LIST          */
         LA    @04,8                                               1173
         ALR   @02,@04                                             1173
         ST    @02,CPAIDAL(,@09)                                   1173
*   CPAVPL=CPAIDAL+IX3;             /* ADDR OF VIRTUAL PAGE LIST     */
         ALR   @02,IX3                                             1174
         ST    @02,CPAVPL(,@09)                                    1174
*   CPAWSID=CPAVPL+IX3;             /* ADDR OF SEARCH ID TBL         */
         ALR   @02,IX3                                             1175
         ST    @02,CPAWSID(,@09)                                   1175
*   CPARCPS=CPAWSID+(LENGTH(SEARCHID)*IX+SEVEN)/EIGHT*EIGHT;/* ADR OF
*                                      READ CP                       */
         L     @15,IX                                              1176
         LR    @00,@15                                             1176
         MH    @00,@CH01094                                        1176
         AL    @00,@CF00285                                        1176
         SRDA  @00,32                                              1176
         DR    @00,@04                                             1176
         SLA   @01,3                                               1176
         ALR   @02,@01                                             1176
         ST    @02,CPARCPS(,@09)                                   1176
*   CPARREAL=CPARCPS;               /* VIRTUAL ADDR OF READ CP       */
         ST    @02,CPARREAL(,@09)                                  1177
*   CPARCPE=CPARCPS+(FOUR+IX)*LENGTH(CCW);/* ADDR OF LAST RD CCW   1178
*                                                            @Z30SSRL*/
         AL    @15,@CF00048                                        1178
         SLA   @15,3                                               1178
         ALR   @02,@15                                             1178
         ST    @02,CPARCPE(,@09)                                   1178
*   CPAVPLV=ON;                     /* UPL VALID ON FOR NOW          */
         OI    CPAVPLV(@09),B'10000000'                            1179
*   IF AMBUBF=ON THEN               /* IF USER BUFR                  */
         TM    AMBUBF(AMBPT),B'00000100'                           1180
         BNO   @RF01180                                            1180
*     CPAVPLV=OFFX;                 /* BUFR ADDR NOT VALID           */
         NI    CPAVPLV(@09),B'01111111'                            1181
*   RET=RSAVLB;                                                    1182
@RF01180 L     RET,RSAVLB                                          1182
*   END BLDCPADR;                                                  1183
@EL00027 DS    0H                                                  1183
@EF00027 DS    0H                                                  1183
@ER00027 BR    @14                                                 1183
*BLDCPAW:                                                          1184
*                                                                  1184
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE UPDATE WRITE CHANNEL PROGRAM SEGMENT               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1184
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1184
BLDCPAW  DS    0H                                                  1185
*   RSAVLB=RET;                                                    1185
         ST    RET,RSAVLB                                          1185
*   IX5=CPAWCPS;                    /* POINT TO FIRST CCW            */
         L     @04,BUFCCPA(,IX4)                                   1186
         L     IX5,CPAWCPS(,@04)                                   1186
*   CCWCODE=CCSEEKH;                /* SET COMMAND CODE              */
         MVI   CCWCODE(IX5),X'1B'                                  1187
*   CCWAREA=ADDR(CPAWSEEK);         /* POINT BACK TO HEADER          */
         LA    @15,CPAWSEEK(,@04)                                  1188
         STCM  @15,7,CCWAREA(IX5)                                  1188
*   CCWCC=ON;                       /* COMMAND CHAINING BIT          */
         OI    CCWCC(IX5),B'01000000'                              1189
*   CCWLEN=LENGTH(CPAWSEEK);        /* LENGTH OF SEEK ARG            */
         MVC   CCWLEN(2,IX5),@CH00113                              1190
*   IX6=CPAWSID;                    /* PT TO SEARCH TO ARG           */
         L     @15,CPAWSID(,@04)                                   1191
         ST    @15,IX6                                             1191
*   IX5=IX5+LENGTH(CCW);            /* NEXT CCW                      */
         LA    @15,8                                               1192
         ALR   IX5,@15                                             1192
*   IX7=CPAIDAL;                    /* POINT TO REAL PG LIST         */
         L     IX7,CPAIDAL(,@04)                                   1193
*   CCWCODE=CCSS;                   /* SET SET SECTOR COMMAND CODE 1194
*                                                            @Z30SSRL*/
         MVI   CCWCODE(IX5),X'23'                                  1194
*   CCWCC=ON;                       /* SET COMMAND CHAIN     @Z30SSRL*/
*   CCWSLI=ON;                      /* SET SLI               @Z30SSRL*/
         OI    CCWCC(IX5),B'01100000'                              1196
*   CCWLEN=ONE;                     /* SET LENGTH            @Z30SSRL*/
         MVC   CCWLEN(2,IX5),@CH00076                              1197
*   CCWAREA=ADDR(CPAWSECT);         /* SET ADDRESS           @Z30SSRL*/
         LA    @04,CPAWSECT(,@04)                                  1198
         STCM  @04,7,CCWAREA(IX5)                                  1198
*   IX5=IX5+LENGTH(CCW);            /* UPDATE CCW POINTER    @Z30SSRL*/
         ALR   IX5,@15                                             1199
*   DO IX9=IX TO 1 BY-1;            /* BLD 3 CCW/BLKSIZE OR PGSIZ BLD
*                                      SEARCH ID EQ CCW              */
         L     @04,IX                                              1200
         ST    @04,IX9                                             1200
         B     @DE01200                                            1200
@DL01200 DS    0H                                                  1201
*     IF IX9=IX THEN                /* IF FIRST SET OF 3 CCW'S       */
         C     @04,IX                                              1201
         BNE   @RF01201                                            1201
*       CCWCODE=CCSIDEQ;            /* NO MT ON                      */
         MVI   CCWCODE(IX5),X'31'                                  1202
*     ELSE                          /* NOT FIRST SET                 */
*       CCWCODE=CCMTSIDE;           /* IF NOT 1ST MT ON              */
         B     @RC01201                                            1203
@RF01201 MVI   CCWCODE(IX5),X'B1'                                  1203
*     CCWAREA=ADDR(SEARCHID);       /* AREA IN SRCH ID ARG TBL       */
@RC01201 L     @04,IX6                                             1204
         STCM  @04,7,CCWAREA(IX5)                                  1204
*     IX6=IX6+LENGTH(SEARCHID);     /* STEP TO NEXT SRCH ID ARG      */
         LA    @15,5                                               1205
         ALR   @04,@15                                             1205
         ST    @04,IX6                                             1205
*     CCWCC=ON;                     /* COMMAND CHAINING              */
         OI    CCWCC(IX5),B'01000000'                              1206
*     CCWLEN=LENGTH(SEARCHID);      /* SET SEARCH LENGTH             */
         STH   @15,CCWLEN(,IX5)                                    1207
*     IX5=IX5+LENGTH(CCW);          /* NEXT CCW                      */
         LA    @04,8                                               1208
         ALR   IX5,@04                                             1208
*     CCWCODE=CCTIC;                /* COMMAND CODE IS TIC           */
         MVI   CCWCODE(IX5),X'08'                                  1209
*     CCWAREA=ADDR(CCW)-LENGTH(CCW);/* TIC OT CCW-1                  */
         LR    @15,IX5                                             1210
         SLR   @15,@04                                             1210
         STCM  @15,7,CCWAREA(IX5)                                  1210
*     IX5=IX5+LENGTH(CCW);          /* NEXT CCW                      */
         ALR   IX5,@04                                             1211
*     CCWCODE=CCWD;                 /* COMMAND CODE IS WRITE         */
         MVI   CCWCODE(IX5),X'05'                                  1212
*     CCWAREA=IX7;                  /* AREA IN IDAL                  */
         STCM  IX7,7,CCWAREA(IX5)                                  1213
*     CCWCC=ON;                     /* COMMAND CHAINING              */
*     CCWIDAL=ON;                   /* SET IDAL BIT ON               */
         OI    CCWCC(IX5),B'01000100'                              1215
*     IF CTBLKSZ>PGSIZE THEN        /* IF PHYSICAL BLKSIZE>PGSIZE    */
         LH    @15,PGSIZE                                          1216
         C     @15,CTBLKSZ(,CWAPT)                                 1216
         BNL   @RF01216                                            1216
*       DO;                                                        1217
*         IX7=IX7+EIGHT;            /* PT TO NEXT IDAL ENTRY         */
         ALR   IX7,@04                                             1218
*         CCWLEN=PGSIZE;            /* SET LENGTH                    */
         STH   @15,CCWLEN(,IX5)                                    1219
*       END;                                                       1220
*     ELSE                          /* NOT GREATER THAN PAGE SIZE    */
*       DO;                                                        1221
         B     @RC01216                                            1221
@RF01216 DS    0H                                                  1222
*         IX7=IX7+FOUR;             /* PT TO NEXT IDAL ENTRY         */
         AL    IX7,@CF00048                                        1222
*         CCWLEN=CTBLKSZ;           /* SET LENGTH                    */
         L     @04,CTBLKSZ(,CWAPT)                                 1223
         STH   @04,CCWLEN(,IX5)                                    1223
*       END;                                                       1224
*     IX5=IX5+LENGTH(CCW);          /* NEXT CCW                      */
@RC01216 AL    IX5,@CF00058                                        1225
*   END;                                                           1226
         SLR   @04,@04                                             1226
         BCTR  @04,0                                               1226
         AL    @04,IX9                                             1226
         ST    @04,IX9                                             1226
@DE01200 LTR   @04,@04                                             1226
         BP    @DL01200                                            1226
*   CCWCODE=CCNOP;                  /* COMMAND IS NOP                */
         MVI   CCWCODE(IX5),X'03'                                  1227
*   CCWSLI=ON;                                                     1228
         OI    CCWSLI(IX5),B'00100000'                             1228
*   CCWLEN=TWO;                                                    1229
         MVC   CCWLEN(2,IX5),@CH00044                              1229
*   RET=RSAVLB;                                                    1230
         L     RET,RSAVLB                                          1230
*   END BLDCPAW;                                                   1231
@EL00028 DS    0H                                                  1231
@EF00028 DS    0H                                                  1231
@ER00028 BR    @14                                                 1231
*BLDCPAWC:                                                         1232
*                                                                  1232
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD A WRITE CHECK CHANNEL PROGRAM                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1232
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1232
BLDCPAWC DS    0H                                                  1233
*   RSAVLB=RET;                                                    1233
         ST    RET,RSAVLB                                          1233
*   IX5=CPAWCKS;                    /* PT TO 1S CCW AREA             */
         L     @04,BUFCCPA(,IX4)                                   1234
         L     IX5,CPAWCKS(,@04)                                   1234
*   IX7=CPAIDAL;                    /* PT TO IDAL AREA               */
         L     IX7,CPAIDAL(,@04)                                   1235
*   CCWCODE=CCSEEKH;                /* COMAND IS SEEK HEAD           */
         MVI   CCWCODE(IX5),X'1B'                                  1236
*   CCWAREA=ADDR(CPAWSEEK);         /* SEEK ARG IN CPA HEADER        */
         LA    @15,CPAWSEEK(,@04)                                  1237
         STCM  @15,7,CCWAREA(IX5)                                  1237
*   CCWCC=ON;                       /* COMMAND CHAINING              */
         OI    CCWCC(IX5),B'01000000'                              1238
*   CCWLEN=LENGTH(CPAWSEEK);        /* PT TO NEXT CCW                */
         MVC   CCWLEN(2,IX5),@CH00113                              1239
*   IX5=IX5+LENGTH(CCW);            /* NEXT CCW                      */
         LA    @15,8                                               1240
         ALR   IX5,@15                                             1240
*   CCWCODE=CCSS;                   /* SET SET SECTOR COMMAND CODE 1241
*                                                            @Z30SSRL*/
         MVI   CCWCODE(IX5),X'23'                                  1241
*   CCWCC=ON;                       /* SET COMMAND CHAIN     @Z30SSRL*/
*   CCWSLI=ON;                      /* SET SLI               @Z30SSRL*/
         OI    CCWCC(IX5),B'01100000'                              1243
*   CCWLEN=ONE;                     /* SET LENGTH            @Z30SSRL*/
         MVC   CCWLEN(2,IX5),@CH00076                              1244
*   CCWAREA=ADDR(CPAWSECT);         /* SET ADDRESS           @Z30SSRL*/
         LA    @14,CPAWSECT(,@04)                                  1245
         STCM  @14,7,CCWAREA(IX5)                                  1245
*   IX5=IX5+LENGTH(CCW);            /* UPDATE CCW POINTER    @Z30SSRL*/
         ALR   IX5,@15                                             1246
*   CCWCODE=CCSIDEQ;                /* COMMAND IS SRCH ID EQ         */
         MVI   CCWCODE(IX5),X'31'                                  1247
*   CCWAREA=CPAWSID;                                               1248
         MVC   CCWAREA(3,IX5),CPAWSID+1(@04)                       1248
*   CCWCC=ON;                       /* COMMAND CHAINING              */
         OI    CCWCC(IX5),B'01000000'                              1249
*   CCWLEN=LENGTH(SEARCHID);        /* CCW LENGTH                    */
         MVC   CCWLEN(2,IX5),@CH01094                              1250
*   IX5=IX5+LENGTH(CCW);                                           1251
         ALR   IX5,@15                                             1251
*   CCWCODE=CCTIC;                  /* COMMAND IS TIC                */
         MVI   CCWCODE(IX5),X'08'                                  1252
*   CCWAREA=IX5-LENGTH(CCW);        /* POINT BACK            @Z30SSRL*/
         LR    @04,IX5                                             1253
         SLR   @04,@15                                             1253
         STCM  @04,7,CCWAREA(IX5)                                  1253
*   IX5=IX5+LENGTH(CCW);                                           1254
         ALR   IX5,@15                                             1254
*   DO IX9=IX TO 1 BY-1;            /* CREAT RL CCW'S                */
         L     @04,IX                                              1255
         ST    @04,IX9                                             1255
         B     @DE01255                                            1255
@DL01255 DS    0H                                                  1256
*     IF IX9=IX THEN                /* FIRST CCW?                    */
         C     @04,IX                                              1256
         BNE   @RF01256                                            1256
*       CCWCODE=CCRD;               /* NO MT FOR 1ST                 */
         MVI   CCWCODE(IX5),X'06'                                  1257
*     ELSE                          /* NOT FIRST                     */
*       CCWCODE=CCMTRD;             /* CCW CODE IS MT READ           */
         B     @RC01256                                            1258
@RF01256 MVI   CCWCODE(IX5),X'86'                                  1258
*     CCWAREA=IX7;                  /* AREA IS IDAL                  */
@RC01256 STCM  IX7,7,CCWAREA(IX5)                                  1259
*     CCWCC=ON;                     /* COMMAND CHAINING              */
*     CCWST=ON;                     /* SUPPRESS DATA TRANSFER        */
         OI    CCWCC(IX5),B'01010000'                              1261
*     IF CTBLKSZ>PGSIZE THEN        /* IF PHYSICAL SIZE > PGSIZE     */
         LH    @04,PGSIZE                                          1262
         C     @04,CTBLKSZ(,CWAPT)                                 1262
         BNL   @RF01262                                            1262
*       CCWLEN=PGSIZE;              /* LENGTH EQUALS PAGE SIZE       */
         STH   @04,CCWLEN(,IX5)                                    1263
*     ELSE                          /* PHYSICAL SIZE < PAGESIZE      */
*       CCWLEN=CTBLKSZ;             /* SET LENGTH                    */
         B     @RC01262                                            1264
@RF01262 L     @04,CTBLKSZ(,CWAPT)                                 1264
         STH   @04,CCWLEN(,IX5)                                    1264
*     IX5=IX5+LENGTH(CCW);          /* NEXT CCW                      */
@RC01262 AL    IX5,@CF00058                                        1265
*   END;                                                           1266
         SLR   @04,@04                                             1266
         BCTR  @04,0                                               1266
         AL    @04,IX9                                             1266
         ST    @04,IX9                                             1266
@DE01255 LTR   @04,@04                                             1266
         BP    @DL01255                                            1266
*   CCWCODE=CCNOP;                  /* COMMAND CODE IS NOP           */
         MVI   CCWCODE(IX5),X'03'                                  1267
*   CCWSLI=ON;                      /* SUPPRESS LENGTH ERROR         */
         OI    CCWSLI(IX5),B'00100000'                             1268
*   CCWLEN=TWO;                                                    1269
         MVC   CCWLEN(2,IX5),@CH00044                              1269
*   RET=RSAVLB;                                                    1270
         L     RET,RSAVLB                                          1270
*   END BLDCPAWC;                                                  1271
@EL00029 DS    0H                                                  1271
@EF00029 DS    0H                                                  1271
@ER00029 BR    @14                                                 1271
*BLDCPAVL:                                                         1272
*                                                                  1272
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD VIRTUAL PAGE LISTS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1272
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1272
BLDCPAVL DS    0H                                                  1273
*   RSAVLB=RET;                                                    1273
         ST    RET,RSAVLB                                          1273
*   IX5=CPAVPL;                     /* POINT TO VIRTUAL PAGE LIST    */
         L     @09,BUFCCPA(,IX4)                                   1274
         L     IX5,CPAVPL(,@09)                                    1274
*   IXA=CPAIDAL;                                                   1275
         L     @09,CPAIDAL(,@09)                                   1275
         ST    @09,IXA                                             1275
*   IX6=BUFCBAD;                    /* POINT TO BUFFER               */
         L     @09,BUFCBAD(,IX4)                                   1276
         ST    @09,IX6                                             1276
*   GEN REFS(IX6);                                                 1277
        L     R1,IX6                   LOAD VIRTUAL ADDR
        LRA   R1,0(0,R1)               LOAD REAL ADDR
        ST    R1,IX6                   STORE READ ADDR
*   IF CTBLKSZ>PGSIZE THEN          /* IF PHYSICAL BLKSIZ>PGSIZ      */
         LH    @09,PGSIZE                                          1278
         C     @09,CTBLKSZ(,CWAPT)                                 1278
         BNL   @RF01278                                            1278
*     DO;                           /*                       @Z30SSRL*/
*       IX7=PGSIZE;                 /* INCR IS PAGE SIZE             */
         LH    @04,PGSIZE                                          1280
         LR    IX7,@04                                             1280
*       IX=IX+IX;                   /* TWO ENTRIES NEEDED    @Z30SSRL*/
         L     @04,IX                                              1281
         LR    @15,@04                                             1281
         ALR   @15,@04                                             1281
         ST    @15,IX                                              1281
*     END;                          /*                       @Z30SSRL*/
*   ELSE                            /* PHYSICAL SIZE < PAGESIZE      */
*     IX7=CTBLKSZ;                  /* INCR IS PHYSICAL BLKSIZE      */
         B     @RC01278                                            1283
@RF01278 L     IX7,CTBLKSZ(,CWAPT)                                 1283
*   DO IX9=IX TO 1 BY-1;            /* ONE ENTRY PER INCR            */
@RC01278 L     @04,IX                                              1284
         ST    @04,IX9                                             1284
         B     @DE01284                                            1284
@DL01284 DS    0H                                                  1285
*     IX5->VPLENT=IX6;              /* POINT VPL TO PART OF BUFF     */
         L     @15,IX6                                             1285
         STCM  @15,15,VPLENT(IX5)                                  1285
*     IXA->VPLENT=IX6;              /* POINT IDAL TO BUFFER          */
         L     @14,IXA                                             1286
         STCM  @15,15,VPLENT(@14)                                  1286
*     IX6=IX6+IX7;                  /* BUMP BUFFER POINTER           */
         ALR   @15,IX7                                             1287
         ST    @15,IX6                                             1287
*     IX5=IX5+LENGTH(VPLENT);       /* BUMP VPL POINTER              */
         LA    @15,4                                               1288
         ALR   IX5,@15                                             1288
*     IXA=IXA+LENGTH(VPLENT);                                      1289
         ALR   @14,@15                                             1289
         ST    @14,IXA                                             1289
*   END;                                                           1290
         BCTR  @04,0                                               1290
         ST    @04,IX9                                             1290
@DE01284 LTR   @04,@04                                             1290
         BP    @DL01284                                            1290
*   RET=RSAVLB;                                                    1291
         L     RET,RSAVLB                                          1291
*   END BLDCPAVL;                                                  1292
@EL00030 DS    0H                                                  1292
@EF00030 DS    0H                                                  1292
@ER00030 BR    @14                                                 1292
*BLDCPAR:                                                          1293
*                                                                  1293
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD READ CHANNEL PROGRAM SEGMENT                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1293
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1293
BLDCPAR  DS    0H                                                  1294
*   RSAVLB=RET;                                                    1294
         ST    RET,RSAVLB                                          1294
*   IX5=CPARCPS;                    /* POINT TO 1S READ CCW          */
         L     @04,BUFCCPA(,IX4)                                   1295
         L     IX5,CPARCPS(,@04)                                   1295
*   CCWCODE=CCSEEKH;                /* COMMAND CODE IS SEEK HEAD     */
         MVI   CCWCODE(IX5),X'1B'                                  1296
*   CCWAREA=ADDR(CPARSEEK);         /* POINT AREA TO HEADER          */
         LA    @15,CPARSEEK(,@04)                                  1297
         STCM  @15,7,CCWAREA(IX5)                                  1297
*   CCWCC=ON;                       /* COMMAND CHAINING              */
         OI    CCWCC(IX5),B'01000000'                              1298
*   CCWLEN=LENGTH(CPARSEEK);        /* SEEK ARG LENGTH               */
         MVC   CCWLEN(2,IX5),@CH00113                              1299
*   IX5=IX5+LENGTH(CCW);                                           1300
         LA    @15,8                                               1300
         ALR   IX5,@15                                             1300
*   CCWCODE=CCSS;                   /* SET SET SECTOR COMMAND CODE 1301
*                                                            @Z30SSRL*/
         MVI   CCWCODE(IX5),X'23'                                  1301
*   CCWCC=ON;                       /* SET COMMAND CHAIN     @Z30SSRL*/
*   CCWSLI=ON;                      /* SET SLI               @Z30SSRL*/
         OI    CCWCC(IX5),B'01100000'                              1303
*   CCWLEN=ONE;                     /* SET LENGTH            @Z30SSRL*/
         MVC   CCWLEN(2,IX5),@CH00076                              1304
*   CCWAREA=ADDR(CPARSECT);         /* SET ADDRESS           @Z30SSRL*/
         LA    @14,CPARSECT(,@04)                                  1305
         STCM  @14,7,CCWAREA(IX5)                                  1305
*   IX5=IX5+LENGTH(CCW);            /* UPDATE CCW POINTER    @Z30SSRL*/
         ALR   IX5,@15                                             1306
*   CCWCODE=CCSIDEQ;                /* CMD CODE IS SRCH ID EQUAL     */
         MVI   CCWCODE(IX5),X'31'                                  1307
*   CCWAREA=ADDR(CPARSID);          /* PT BACK TO HEADER             */
         LA    @14,CPARSID(,@04)                                   1308
         STCM  @14,7,CCWAREA(IX5)                                  1308
*   CCWCC=ON;                       /* COMMAND CHAINING              */
*   CCWSLI=ON;                      /* SUPRESS INCORRECT LENGTH      */
         OI    CCWCC(IX5),B'01100000'                              1310
*   CCWLEN=LENGTH(CPARSID);         /* ARG LENGTH                    */
         MVC   CCWLEN(2,IX5),@CH01094                              1311
*   IX5=IX5+LENGTH(CCW);                                           1312
         ALR   IX5,@15                                             1312
*   CCWCODE=CCTIC;                  /* COMMAND CODE IS TIC           */
         MVI   CCWCODE(IX5),X'08'                                  1313
*   CCWAREA=ADDR(CCW)-LENGTH(CCW);  /* PT BACK 1 CCW                 */
         LR    @14,IX5                                             1314
         SLR   @14,@15                                             1314
         STCM  @14,7,CCWAREA(IX5)                                  1314
*   IX5=IX5+LENGTH(CCW);            /* NEXT CCW                      */
         ALR   IX5,@15                                             1315
*   IX7=CPAIDAL;                    /* POINT TO 1ST OF IDAL          */
         L     IX7,CPAIDAL(,@04)                                   1316
*   DO IX9=IX TO 1 BY-1;            /* 1 RD CCW/BLK/C INV            */
         L     @04,IX                                              1317
         ST    @04,IX9                                             1317
         B     @DE01317                                            1317
@DL01317 DS    0H                                                  1318
*     IF IX9=IX THEN                /* FIRST?                        */
         C     @04,IX                                              1318
         BNE   @RF01318                                            1318
*       CCWCODE=CCRD;               /* NO MT FOR 15T RD DATA         */
         MVI   CCWCODE(IX5),X'06'                                  1319
*     ELSE                          /* NOT FIRST                     */
*       CCWCODE=CCMTRD;             /* OTHERWISE MT ON               */
         B     @RC01318                                            1320
@RF01318 MVI   CCWCODE(IX5),X'86'                                  1320
*     CCWAREA=IX7;                  /* CCWAREA IN IDAL               */
@RC01318 STCM  IX7,7,CCWAREA(IX5)                                  1321
*     CCWCC=ON;                     /* COMMAND CHAINING              */
*     CCWIDAL=ON;                   /* SET IDAL BIT ON               */
         OI    CCWCC(IX5),B'01000100'                              1323
*     IF CTBLKSZ>PGSIZE THEN        /* IF PHYSICAL BLKSIZE>PGSIZE    */
         LH    @04,PGSIZE                                          1324
         C     @04,CTBLKSZ(,CWAPT)                                 1324
         BNL   @RF01324                                            1324
*       DO;                                                        1325
*         IX7=IX7+EIGHT;            /* BUMP IDAL PTR                 */
         AL    IX7,@CF00058                                        1326
*         CCWLEN=PGSIZE;            /* LENGTH                        */
         STH   @04,CCWLEN(,IX5)                                    1327
*       END;                                                       1328
*     ELSE                          /* PHYSICAL SIZE < PAGESIZE      */
*       DO;                                                        1329
         B     @RC01324                                            1329
@RF01324 DS    0H                                                  1330
*         IX7=IX7+FOUR;             /* BUMP PTR TO IDAL              */
         AL    IX7,@CF00048                                        1330
*         CCWLEN=CTBLKSZ;                                          1331
         L     @04,CTBLKSZ(,CWAPT)                                 1331
         STH   @04,CCWLEN(,IX5)                                    1331
*       END;                                                       1332
*     IX5=IX5+LENGTH(CCW);                                         1333
@RC01324 AL    IX5,@CF00058                                        1333
*   END;                                                           1334
         SLR   @04,@04                                             1334
         BCTR  @04,0                                               1334
         AL    @04,IX9                                             1334
         ST    @04,IX9                                             1334
@DE01317 LTR   @04,@04                                             1334
         BP    @DL01317                                            1334
*   CCWCODE=CCNOP;                  /* LAST CCW IS NOP               */
         MVI   CCWCODE(IX5),X'03'                                  1335
*   CCWSLI=ON;                                                     1336
         OI    CCWSLI(IX5),B'00100000'                             1336
*   CCWLEN=TWO;                                                    1337
         MVC   CCWLEN(2,IX5),@CH00044                              1337
*   RET=RSAVLB;                                                    1338
         L     RET,RSAVLB                                          1338
*   END BLDCPAR;                                                   1339
@EL00031 DS    0H                                                  1339
@EF00031 DS    0H                                                  1339
@ER00031 BR    @14                                                 1339
*   END BLDCPA;                                                    1340
@EL00026 DS    0H                                                  1340
@EF00026 DS    0H                                                  1340
@ER00026 BR    @14                                                 1340
*BLDARDB:                                                          1341
*                                                                  1341
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD ARDB                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1341
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1341
BLDARDB  DS    0H                                                  1342
*   RSAVLA=RET;                                                    1342
         ST    RET,RSAVLA                                          1342
*   ARDBSIZE=LENGTH(IDAARDB)+CTKEYLEN*TWO;/* SIZE OF ONE ARDB        */
         LA    @09,232                                             1343
         ALR   @09,CWAPT                                           1343
         LH    @07,CTKEYLEN(,@09)                                  1343
         ALR   @07,@07                                             1343
         AL    @07,@CF03727                                        1343
         ST    @07,ARDBSIZE                                        1343
*   ARDBSIZE=(ARDBSIZE+THREE)/FOUR*FOUR;/* ROUND UP TO WORD          */
         LR    @00,@07                                             1344
         AL    @00,@CF00088                                        1344
         SRDA  @00,32                                              1344
         D     @00,@CF00048                                        1344
         SLA   @01,2                                               1344
         ST    @01,ARDBSIZE                                        1344
*   CORELEN=ARDBSIZE*CTNOKEY;       /* CORE LENGTH FOR ALL ARDBS     */
         MH    @01,CTNOKEY(,@09)                                   1345
         ST    @01,CORELEN                                         1345
*   CALL GETCORE;                   /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1346
*   IX3=COREADDR;                                                  1347
         L     IX3,COREADDR                                        1347
*   ARDBAD=IX3;                                                    1348
         ST    IX3,ARDBAD                                          1348
*   RESPECIFY                                                      1349
*     IDAARDB BASED(IX3);                                          1349
*   RESPECIFY                                                      1350
*     CTKEYENT BASED(IX2);                                         1350
*   HRBAFLG=ZERO;                   /* ASSUME 0 HIGH RBA             */
         SLR   HRBAFLG,HRBAFLG                                     1351
*   IX2=ADDR(CTVOLENT)+LENGTH(CTVOLENT);/* ADDRESSABILITY FOR CTKEYEN*/
         LA    @09,252                                             1352
         ALR   @09,CWAPT                                           1352
         ST    @09,IX2                                             1352
*   LASTARDB=ADDR(IDAARDB);         /* SAVE PTR FOR LATER            */
         LR    LASTARDB,IX3                                        1353
*   DO IX=1 TO CTNOKEY;                                            1354
         LA    @09,1                                               1354
         B     @DE01354                                            1354
@DL01354 DS    0H                                                  1355
*     ARDLEN=ARDBSIZE;              /* LENGTH OF ARDB                */
         L     @02,ARDBSIZE                                        1355
         STH   @02,ARDLEN(,IX3)                                    1355
*     IF IX^=ONE THEN               /* FIRST?                        */
         C     @09,@CF00076                                        1356
         BE    @RF01356                                            1356
*       LASTARDB->ARDNPTR=ADDR(IDAARDB);/* PT LST ARDB TO THIS ARDB  */
         ST    IX3,ARDNPTR(,LASTARDB)                              1357
*     LASTARDB=ADDR(IDAARDB);                                      1358
@RF01356 LR    LASTARDB,IX3                                        1358
*     ARDID=IDXARDB;                /* SET ID                        */
         MVI   ARDID(IX3),B'01100001'                              1359
*     IF AMBTYPE=AMBINDEX THEN      /* IS INDEX                      */
         TM    AMBTYPE(AMBPT),B'01000000'                          1360
         BNO   @RF01360                                            1360
*       IF CTSSWDTA=ON THEN         /* IF SEQ SET W/DATA THIS KEY    */
         L     @09,IX2                                             1361
         TM    CTSSWDTA(@09),B'10000000'                           1361
         BNO   @RF01361                                            1361
*         ARDSS=ON;                 /* FLAG ARDB FOR KEY RANGE       */
         OI    ARDSS(IX3),B'00100000'                              1362
*       ELSE                        /* NOT SSW/DATA                  */
*         ARDHLI=ON;                                               1363
         B     @RC01361                                            1363
@RF01361 OI    ARDHLI(IX3),B'01000000'                             1363
*     IF AMDRANGE=ON&ARDHLI=OFFX THEN/* USING KEY RANGE?             */
@RC01361 DS    0H                                                  1364
@RF01360 L     @09,AMBDSB(,AMBPT)                                  1364
         TM    AMDRANGE(@09),B'00000100'                           1364
         BNO   @RF01364                                            1364
         TM    ARDHLI(IX3),B'01000000'                             1364
         BNZ   @RF01364                                            1364
*       ARDKR=ON;                   /* YES, FLAG                     */
         OI    ARDKR(IX3),B'10000000'                              1365
*     ARDRELNO=CTKRELNO;            /* VOL OCCURENCE NBR             */
@RF01364 L     @09,IX2                                             1366
         LH    @15,CTKRELNO(,@09)                                  1366
         STH   @15,ARDRELNO(,IX3)                                  1366
*     ARDPRF=CTKEYFLG;              /* SET PREFORMAT INDICATOR       */
         MVC   ARDPRF(1,IX3),CTKEYFLG(@09)                         1367
*     ARDHKRBA=CTKHKRBA;            /* SET HI KEY RBA                */
         L     @15,CTKHKRBA(,@09)                                  1368
         ST    @15,ARDHKRBA(,IX3)                                  1368
*     HRBAHOLD=CTKHURBA;            /* HIGH USED RBA                 */
         L     HRBAHOLD,CTKHURBA(,@09)                             1369
*     IF HRBAHOLD^=ZERO THEN        /* TEST FOR ZERO HIGH USED RBA   */
         LTR   HRBAHOLD,HRBAHOLD                                   1370
         BZ    @RF01370                                            1370
*       HRBAFLG=HRBAHOLD;           /* SAVE IT AS A FLAG             */
         LR    HRBAFLG,HRBAHOLD                                    1371
*     ARDHRBA=HRBAHOLD;             /* HI USED RBA THIS KEY RNG      */
@RF01370 ST    HRBAHOLD,ARDHRBA(,IX3)                              1372
*     ARDERBA=CTKHARBA;             /* HI ALLOCATED RBA              */
         L     @09,IX2                                             1373
         L     @02,CTKHARBA(,@09)                                  1373
         ST    @02,ARDERBA(,IX3)                                   1373
*     ARDKEYS(1:CTKEYLEN*TWO)=      /* SET HI & LOW KEYS FOR         */
*         CTKEY(1:CTKEYLEN*TWO);    /* THIS KEY RANGE                */
         LA    @02,232                                             1374
         ALR   @02,CWAPT                                           1374
         LH    @15,CTKEYLEN(,@02)                                  1374
         ALR   @15,@15                                             1374
         LR    @14,@15                                             1374
         BCTR  @14,0                                               1374
         EX    @14,@SM04248                                        1374
*     ARDVOLSR=CTVOLSER;            /* VOLUME SERIAL NBR             */
         MVC   ARDVOLSR(6,IX3),CTVOLSER(@02)                       1375
*     IX3=IX3+ARDBSIZE;             /* PT TO NEXT ARDB               */
         AL    IX3,ARDBSIZE                                        1376
*     IX2=IX2+LENGTH(CTEXTENT)*CTNOKEXT+LENGTH(CTKEYENT)+CTKEYLEN*TWO;
         SLR   @02,@02                                             1377
         IC    @02,CTNOKEXT(,@09)                                  1377
         MH    @02,@CH03059                                        1377
         ALR   @09,@02                                             1377
         AL    @09,@CF00073                                        1377
         ALR   @09,@15                                             1377
         ST    @09,IX2                                             1377
*                                   /* IX2 PTS TO NXT KEY ENTRY      */
*   END;                                                           1378
         LA    @09,1                                               1378
         AL    @09,IX                                              1378
@DE01354 ST    @09,IX                                              1378
         CH    @09,CTNOKEY+232(,CWAPT)                             1378
         BNH   @DL01354                                            1378
*   IF HRBAFLG=ZERO THEN            /* DID WE FIND A NON-ZERO HIGH 1379
*                                      RBA                           */
         LTR   HRBAFLG,HRBAFLG                                     1379
         BNZ   @RF01379                                            1379
*     ERFLAG=ZERORBA;               /* NO SET ERROR FLAG             */
         LH    @09,ZERORBA                                         1380
         STH   @09,ERFLAG                                          1380
*   IX2=ADDR(CTVOLENT)+LENGTH(CTVOLENT);/* PT TO 1ST KEY RNG ENTRY   */
@RF01379 LA    @15,252                                             1381
         ALR   @15,CWAPT                                           1381
         ST    @15,IX2                                             1381
*   IX3=ARDBAD;                                                    1382
         L     IX3,ARDBAD                                          1382
*   ARDRBA=ZERO;                    /* HIGH RBA TO ZERO              */
         SLR   ARDRBA,ARDRBA                                       1383
*   LOKYAD=ADDR(ARDKEYS);           /* ADDRESS OF LOW KEY            */
         LA    LOKYAD,ARDKEYS(,IX3)                                1384
*   LOKYARDB=IX3;                                                  1385
         LR    LOKYARDB,IX3                                        1385
*   HARDBAD=IX3;                    /* SAVE ADDRESS OF ARDB          */
         LR    HARDBAD,IX3                                         1386
*   DO IX=1 TO CTNOKEY;             /* PROCESS ALL ARDBS             */
         LA    @15,1                                               1387
         B     @DE01387                                            1387
@DL01387 DS    0H                                                  1388
*     IF ARDERBA>ARDRBA THEN        /* IS HIGHEST RBA STILL HI?      */
         L     @15,ARDERBA(,IX3)                                   1388
         CLR   @15,ARDRBA                                          1388
         BNH   @RF01388                                            1388
*       DO;                         /* NO, DO                        */
*         ARDRBA=ARDERBA;           /* REPLACE RBA WITH HIGHER       */
         LR    ARDRBA,@15                                          1390
*         HARDBAD=IX3;              /* SAVE ADDRESS OF ARDB          */
         LR    HARDBAD,IX3                                         1391
*       END;                                                       1392
*     IF ARDKEYS(1:CTKEYLEN)<LOKY(1:CTKEYLEN) THEN/* TEST KEY        */
@RF01388 LH    @15,CTKEYLEN+232(,CWAPT)                            1393
         BCTR  @15,0                                               1393
         EX    @15,@SC04250                                        1393
         BNL   @RF01393                                            1393
*       DO;                                                        1394
*         LOKYARDB=IX3;                                            1395
         LR    LOKYARDB,IX3                                        1395
*         LOKYAD=ADDR(ARDKEYS);                                    1396
         LA    LOKYAD,ARDKEYS(,IX3)                                1396
*       END;                                                       1397
*     IX3=ARDNPTR;                  /* NEXT ARDB                     */
@RF01393 L     IX3,ARDNPTR(,IX3)                                   1398
*   END;                                                           1399
         LA    @15,1                                               1399
         AL    @15,IX                                              1399
@DE01387 ST    @15,IX                                              1399
         CH    @15,CTNOKEY+232(,CWAPT)                             1399
         BNH   @DL01387                                            1399
*   IX3=HARDBAD;                    /* PT TO ARDB W/ HI RBA          */
         LR    IX3,HARDBAD                                         1400
*   ARDEOD=ON;                                                     1401
*                                                                  1401
         OI    ARDEOD(IX3),B'00001000'                             1401
*   /*****************************************************************/
*   /*                                                               */
*   /* CHAIN ARDB'S IN ASCENDING KEY ORDER                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1402
*   IF AMBTYPE=AMBDATA THEN         /* IF AMB FOR DATA               */
         TM    AMBTYPE(AMBPT),B'01000000'                          1402
         BNZ   @RF01402                                            1402
*     DO;                                                          1403
*       IX2=ARDBAD;                 /* IX2 PT'S TO 1ST ARDB          */
         L     @07,ARDBAD                                          1404
         ST    @07,IX2                                             1404
*       DO IX=1 TO CTNOKEY;         /* PROCESS ALL ARDBS             */
         LA    @07,1                                               1405
         B     @DE01405                                            1405
@DL01405 DS    0H                                                  1406
*         IX3=ARDBAD;               /* IX3 PT'S TO 1ST ARDB          */
         L     IX3,ARDBAD                                          1406
*         TEMPLKAR=ZERO;            /* 0 TEMP ARDB PTR               */
         SLR   TEMPLKAR,TEMPLKAR                                   1407
*         DO IX9=1 TO CTNOKEY;      /* INNER PASS THRU ALL ARDBS     */
         LA    @04,1                                               1408
         B     @DE01408                                            1408
@DL01408 DS    0H                                                  1409
*           IF IX2->ARDKEYS(1:CTKEYLEN)>/* DOES THIS ARDB HAVE HIGHER*/
*               IX3->ARDKEYS(1:CTKEYLEN) THEN/* KEY THAN CURRENT?    */
         LH    @04,CTKEYLEN+232(,CWAPT)                            1409
         BCTR  @04,0                                               1409
         L     @03,IX2                                             1409
         EX    @04,@SC04252                                        1409
         BNH   @RF01409                                            1409
*             DO;                   /* YES, PROCEED                  */
*               IF TEMPLKAR=ZERO THEN/* POTENTIAL NXT EXIST?         */
         LTR   TEMPLKAR,TEMPLKAR                                   1411
         BNZ   @RF01411                                            1411
*                 TEMPLKAR=ZERO;    /* NO ESTABLISH POTENTIAL NXT    */
         SLR   TEMPLKAR,TEMPLKAR                                   1412
*               ELSE                /* NO NEXT                       */
*                 DO;                                              1413
         B     @RC01411                                            1413
@RF01411 DS    0H                                                  1414
*                   IF IX3->ARDKEYS(1:CTKEYLEN)</* ARDB KEY < EXIST  */
*                       TEMPLKAR->ARDKEYS(1:CTKEYLEN) THEN/* NXT KEY */
         LH    @04,CTKEYLEN+232(,CWAPT)                            1414
         BCTR  @04,0                                               1414
         EX    @04,@SC04254                                        1414
         BNL   @RF01414                                            1414
*                     TEMPLKAR=IX3; /* YES,THIS ARDB NEW NXT POTE    */
         LR    TEMPLKAR,IX3                                        1415
*                 END;                                             1416
*             END;                                                 1417
*           ELSE                    /* NO HIGHER KEY                 */
*             DO;                                                  1418
         B     @RC01409                                            1418
@RF01409 DS    0H                                                  1419
*               IF IX3->ARDKEYS(1:CTKEYLEN)=/* ARE THE ARDB'S = AND  */
*                   IX2->ARDKEYS(1:CTKEYLEN)&/* IF SO                */
*                   IX3>IX2 THEN    /* IS IT A FORWARD CHAIN?        */
         L     @04,IX2                                             1419
         LH    @03,CTKEYLEN+232(,CWAPT)                            1419
         BCTR  @03,0                                               1419
         EX    @03,@SC04256                                        1419
         BNE   @RF01419                                            1419
         CR    IX3,@04                                             1419
         BNH   @RF01419                                            1419
*                 TEMPLKAR=IX3;     /* YES, SET NEW NXT POTENTIAL    */
         LR    TEMPLKAR,IX3                                        1420
*             END;                  /* ARDB                          */
@RF01419 DS    0H                                                  1422
*           IX3=IX3+ARDLEN;         /* NXT ARDB FOR INNER LOOP       */
@RC01409 AH    IX3,ARDLEN(,IX3)                                    1422
*         END;                                                     1423
         LA    @04,1                                               1423
         AL    @04,IX9                                             1423
@DE01408 ST    @04,IX9                                             1423
         CH    @04,CTNOKEY+232(,CWAPT)                             1423
         BNH   @DL01408                                            1423
*         IX2->ARDNPTR=TEMPLKAR;    /* PT TO NXT ASCENDING ARDB      */
         L     @04,IX2                                             1424
         ST    TEMPLKAR,ARDNPTR(,@04)                              1424
*         IX2=IX2+ARDLEN;           /* NXT ARDB FOR OUTER LOOP       */
         AH    @04,ARDLEN(,IX3)                                    1425
         ST    @04,IX2                                             1425
*       END;                                                       1426
         LA    @07,1                                               1426
         AL    @07,IX                                              1426
@DE01405 ST    @07,IX                                              1426
         CH    @07,CTNOKEY+232(,CWAPT)                             1426
         BNH   @DL01405                                            1426
*       ARDBAD=LOKYARDB;            /* PT TO LOWEST ARDB             */
         ST    LOKYARDB,ARDBAD                                     1427
*     END;                                                         1428
*   RET=RSAVLA;                                                    1429
@RF01402 L     RET,RSAVLA                                          1429
*   END BLDARDB;                                                   1430
@EL00032 DS    0H                                                  1430
@EF00032 DS    0H                                                  1430
@ER00032 BR    @14                                                 1430
*BLDPLHDR:                                                         1431
*                                                                  1431
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE PLH(S). THERE IS ONE PLH PER STRING. THERE ARE NO   */
*   /* PLHS FOR AN INDEX AMB.                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1431
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1431
BLDPLHDR DS    0H                                                  1432
*   RSAVLA=RET;                                                    1432
         ST    RET,RSAVLA                                          1432
*   CORELEN=LENGTH(IDAPLHDR)+       /* COMPUTE CORE LENGTH           */
*       (LENGTH(IDAPLH)+(AMDKEYLN+THREE)/FOUR*FOUR)*/* REQUIRED      */
*       AMBLNST;                                                   1433
         L     @09,AMBDSB(,AMBPT)                                  1433
         LA    @00,3                                               1433
         AH    @00,AMDKEYLN(,@09)                                  1433
         SRDA  @00,32                                              1433
         D     @00,@CF00048                                        1433
         SLA   @01,2                                               1433
         AL    @01,@CF04221                                        1433
         L     @09,ACBPTR                                          1433
         L     @09,ACBAMBL(,@09)                                   1433
         SLR   @07,@07                                             1433
         IC    @07,AMBLNST(,@09)                                   1433
         MR    @00,@07                                             1433
         AL    @01,@CF00073                                        1433
         ST    @01,CORELEN                                         1433
*   CALL GETCORE;                   /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1434
*   AMBPH=COREADDR;                 /* ADDRESSING FOR PLH            */
         L     @09,COREADDR                                        1435
         ST    @09,AMBPH(,AMBPT)                                   1435
*   PLHID=IDXPLH;                   /* CONTROL BLOCK IDENT           */
         MVI   PLHID(@09),B'00110000'                              1436
*   PLHCNT=AMBLNST;                 /* NBR PLH = NBR STRINGS         */
         L     @07,ACBPTR                                          1437
         L     @07,ACBAMBL(,@07)                                   1437
         SLR   @04,@04                                             1437
         IC    @04,AMBLNST(,@07)                                   1437
         STC   @04,PLHCNT(,@09)                                    1437
*   PLHELTH=LENGTH(IDAPLH)+(AMDKEYLN+THREE)/FOUR*FOUR;/* PLH LENGTH  */
         L     @07,AMBDSB(,AMBPT)                                  1438
         LA    @00,3                                               1438
         AH    @00,AMDKEYLN(,@07)                                  1438
         SRDA  @00,32                                              1438
         D     @00,@CF00048                                        1438
         SLA   @01,2                                               1438
         AL    @01,@CF04221                                        1438
         STH   @01,PLHELTH(,@09)                                   1438
*   IX=ADDR(IDAPLHDR)+LENGTH(IDAPLHDR);/* PT TO 1ST PLH              */
         AL    @09,@CF00073                                        1439
         ST    @09,IX                                              1439
*   RESPECIFY                                                      1440
*     IDAPLH BASED(IX);                                            1440
*   DO IX2=AMBLNST TO 1 BY-1;       /* LOOP THRU PLH ENTRIES         */
         ST    @04,IX2                                             1441
         B     @DE01441                                            1441
@DL01441 DS    0H                                                  1442
*     PLHFRCNT=ONE;                                                1442
         L     @09,IX                                              1442
         MVI   PLHFRCNT(@09),X'01'                                 1442
*     PLH1ST=ON;                    /* INDICATE UNUSED               */
         OI    PLH1ST(@09),B'01000000'                             1443
*     PLHRMIN=ONE;                  /* READ THRESHOLD                */
         MVI   PLHRMIN(@09),X'01'                                  1444
*     PLHBFRNO=ONE;                 /* TOTAL NBR OF BUFFERS          */
         MVI   PLHBFRNO(@09),X'01'                                 1445
*     PLHDSIDA=ADDR(PLHACB);                                       1446
         LA    @07,PLHACB(,@09)                                    1446
         ST    @07,PLHDSIDA(,@09)                                  1446
*     PLHARDB=ARDBAD;               /* PT TO 1ST ARDB                */
         L     @07,ARDBAD                                          1447
         ST    @07,PLHARDB(,@09)                                   1447
*     IX=IX+PLHELTH;                /* PT TO NEXT PLH                */
         L     @07,AMBPH(,AMBPT)                                   1448
         AH    @09,PLHELTH(,@07)                                   1448
         ST    @09,IX                                              1448
*   END;                                                           1449
         BCTR  @04,0                                               1449
         ST    @04,IX2                                             1449
@DE01441 LTR   @04,@04                                             1449
         BP    @DL01441                                            1449
*   RET=RSAVLA;                                                    1450
         L     RET,RSAVLA                                          1450
*   END BLDPLHDR;                                                  1451
@EL00033 DS    0H                                                  1451
@EF00033 DS    0H                                                  1451
@ER00033 BR    @14                                                 1451
*BLDLPMB:                                                          1452
*                                                                  1452
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE LPMB(S)                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1452
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1452
BLDLPMB  DS    0H                                                  1453
*   RSAVLA=RET;                                                    1453
         ST    RET,RSAVLA                                          1453
*   IF AMBTYPE=AMBINDEX&AMDSDT=ON THEN/* IF INDEX & SSW/             */
         TM    AMBTYPE(AMBPT),B'01000000'                          1454
         BNO   @RF01454                                            1454
         L     @09,AMBDSB(,AMBPT)                                  1454
         TM    AMDSDT(@09),B'00100000'                             1454
         BNO   @RF01454                                            1454
*     DO;                           /*                       @Z30SSRL*/
*       IX=TWO;                     /* THEN 2 LPMBS                  */
         MVC   IX(4),@CF00044                                      1456
*       LENGLPMB=(LENGTH(IDALPMB)+MAX(CTBLKTR,CTSBLKTR)+SEVEN)&-EIGHT;
         L     LENGLPMB,CTBLKTR(,CWAPT)                            1457
         L     @07,CTSBLKTR(,CWAPT)                                1457
         CR    LENGLPMB,@07                                        1457
         BNL   *+6
         LR    LENGLPMB,@07                                        1457
         AL    LENGLPMB,@CF03734                                   1457
         N     LENGLPMB,@CF04222                                   1457
*                                   /* LENGTH OF LPMB        @Z30SSRL*/
*     END;                          /*                       @Z30SSRL*/
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /*                       @Z30SSRL*/
         B     @RC01454                                            1459
@RF01454 DS    0H                                                  1460
*       IX=ONE;                     /* 1 LPMB                        */
         MVC   IX(4),@CF00076                                      1460
*       LENGLPMB=(LENGTH(IDALPMB)+CTBLKTR+SEVEN)&-EIGHT;/* LENGTH OF
*                                      ONE LPMB              @Z30SSRL*/
         LA    LENGLPMB,35                                         1461
         AL    LENGLPMB,CTBLKTR(,CWAPT)                            1461
         N     LENGLPMB,@CF04222                                   1461
*     END;                          /*                       @Z30SSRL*/
*   CORELEN=LENGLPMB*IX;            /* INIT CORE AMOUNT      @Z30SSRL*/
@RC01454 LR    @01,LENGLPMB                                        1463
         M     @00,IX                                              1463
         ST    @01,CORELEN                                         1463
*   CALL GETCORE;                   /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1464
*   LPMBAD=COREADDR;                /* SET ADDRESSING FOR LPMB       */
         L     @07,COREADDR                                        1465
         ST    @07,LPMBAD                                          1465
*   RESPECIFY                                                      1466
*     IDALPMB BASED(LPMBAD+LENGLPMB*(IX-ONE));/* ADDRESSING  @Z30SSRL*/
*   DO IX=IX TO 1 BY-1;             /* INIT FIELDS FOR LPMB(S)       */
         L     @07,IX                                              1467
         B     @DE01467                                            1467
@DL01467 DS    0H                                                  1468
*     LPMBID=IDXLPMB;               /* SET IDENT                     */
         LR    @01,@07                                             1468
         BCTR  @01,0                                               1468
         MR    @00,LENGLPMB                                        1468
         AL    @01,LPMBAD                                          1468
         MVI   LPMBID(@01),B'10010001'                             1468
*     LPMBLEN=LENGLPMB;             /* SET LENGTH            @Z30SSRL*/
         STH   LENGLPMB,LPMBLEN(,@01)                              1469
*     IF AMDREPL=ON THEN            /* SET REPLICATION BIT IF ON     */
         L     @07,AMBDSB(,AMBPT)                                  1470
         TM    AMDREPL(@07),B'00010000'                            1470
         BNO   @RF01470                                            1470
*       LPMREPL=ON;                 /* IN AMDSB                      */
         OI    LPMREPL(@01),B'01000000'                            1471
*     IF AMBTYPE=AMBINDEX&          /* IF INDEX & SSW/DATA &         */
*         AMDSDT=ON&IX=TWO THEN     /* SS/DATA LPMB                  */
@RF01470 TM    AMBTYPE(AMBPT),B'01000000'                          1472
         BNO   @RF01472                                            1472
         L     @07,AMBDSB(,AMBPT)                                  1472
         TM    AMDSDT(@07),B'00100000'                             1472
         BNO   @RF01472                                            1472
         L     @07,IX                                              1472
         C     @07,@CF00044                                        1472
         BNE   @RF01472                                            1472
*       DO;                         /* YES, DO                       */
*         LPMSS=ON;                 /* SET SS W/DATA FLAG            */
*         LPMREPL=ON;               /* FORCE REPLICATION             */
         LR    @01,@07                                             1475
         BCTR  @01,0                                               1475
         MR    @00,LENGLPMB                                        1475
         AL    @01,LPMBAD                                          1475
         OI    LPMSS(@01),B'01100000'                              1475
*       END;                                                       1476
*     LPMTPC=DEVTABTC;              /* COPY TRACKS PER CYLINDER      */
@RF01472 L     @01,IX                                              1477
         BCTR  @01,0                                               1477
         MR    @00,LENGLPMB                                        1477
         AL    @01,LPMBAD                                          1477
         L     @07,CVTPTR                                          1477
         L     @07,CVTZDTAB(,@07)                                  1477
         L     @04,CTVOLUCB+232(,CWAPT)                            1477
         SLR   @15,@15                                             1477
         IC    @15,UCBTBYT4(,@04)                                  1477
         ALR   @15,@07                                             1477
         SLR   @04,@04                                             1477
         IC    @04,DEVTABOF(,@15)                                  1477
         ALR   @07,@04                                             1477
         LH    @07,DEVTABTC(,@07)                                  1477
         STH   @07,LPMTPC(,@01)                                    1477
*     LPMBLKSZ=CTBLKSZ;             /* BLOCKSIZE FROM CATLG          */
         L     @07,CTBLKSZ(,CWAPT)                                 1478
         ST    @07,LPMBLKSZ(,@01)                                  1478
*     IF LPMSS=OFFX THEN            /* SEQUENCE SET LPMB?            */
         TM    LPMSS(@01),B'00100000'                              1479
         BNZ   @RF01479                                            1479
*       DO;                         /* NO, DO                        */
*         LPMTRKAU=CTTRKAU;         /* TRK/ALLOC UNIT FROM CATLG     */
         L     @07,CTTRKAU(,CWAPT)                                 1481
         STH   @07,LPMTRKAU(,@01)                                  1481
*         LPMBLKTR=CTBLKTR;         /* BLK/TRK FROM CATLG            */
         L     @07,CTBLKTR(,CWAPT)                                 1482
         STH   @07,LPMBLKTR(,@01)                                  1482
*       END;                                                       1483
*     ELSE                          /* SS W/DTA LPMB                 */
*       DO;                                                        1484
         B     @RC01479                                            1484
@RF01479 DS    0H                                                  1485
*         LPMTRKAU=CTSTRKAU;                                       1485
         L     @01,IX                                              1485
         BCTR  @01,0                                               1485
         MR    @00,LENGLPMB                                        1485
         AL    @01,LPMBAD                                          1485
         L     @07,CTSTRKAU(,CWAPT)                                1485
         STH   @07,LPMTRKAU(,@01)                                  1485
*         LPMBLKTR=CTSBLKTR;                                       1486
         L     @07,CTSBLKTR(,CWAPT)                                1486
         STH   @07,LPMBLKTR(,@01)                                  1486
*       END;                                                       1487
*     IF UCB2OPT3=ON THEN           /* UCB IND RPS DEVICE    @Z30SSRL*/
@RC01479 L     @07,CTVOLUCB+232(,CWAPT)                            1488
         TM    UCB2OPT3(@07),B'00010000'                           1488
         BNO   @RF01488                                            1488
*       DO;                         /*                       @Z30SSRL*/
*         LPMBRPS=ON;               /* IND RPS IN LPMB       @Z30SSRL*/
         L     @01,IX                                              1490
         BCTR  @01,0                                               1490
         MR    @00,LENGLPMB                                        1490
         AL    @01,LPMBAD                                          1490
         OI    LPMBRPS(@01),B'10000000'                            1490
*         IF AMBPSDS=OFFX THEN      /* IF NOT PAGE SPACE DS  @Z30SSRL*/
         TM    AMBPSDS(AMBPT),B'10000000'                          1491
         BNZ   @RF01491                                            1491
*           DO;                     /*                       @Z30SSRL*/
*             LPMBSSTH=ON;          /* LPMB SET SECTOR TABLE @Z30SSRL*/
*                                                                  1493
         OI    LPMBSSTH(@01),B'00001000'                           1493
*             /*******************************************************/
*             /*                                                     */
*             /* BUILD SET SECTOR TABLE                      @Z30SSRL*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1494
*             DD=LPMBLKSZ;          /* SET BLOCK SIZE        @Z30SSRL*/
         L     @04,LPMBLKSZ(,@01)                                  1494
         STH   @04,DD                                              1494
*             K='00'X;              /* KEY IS ALWAYS ZERO    @Z30SSRL*/
         MVI   K,X'00'                                             1495
*             U=UCBTBYT4;           /* SET DEVICE TYPE       @Z30SSRL*/
         IC    @04,UCBTBYT4(,@07)                                  1496
         STC   @04,U                                               1496
*             DO C2=1 TO LPMBLKTR BY 1;/* LOOP THROUGH BLOCKS      1497
*                                                            @Z30SSRL*/
         LA    C2,1                                                1497
         B     @DE01497                                            1497
@DL01497 DS    0H                                                  1498
*               R=C2;               /* SET BLOCK NUMBER      @Z30SSRL*/
         STC   C2,R                                                1498
*               SSA=ADDR(LPMBSST(C2));/* ADDR OF SECTOR LIST @Z30SSRL*/
         L     @01,IX                                              1499
         BCTR  @01,0                                               1499
         MR    @00,LENGLPMB                                        1499
         AL    @01,LPMBAD                                          1499
         LA    @04,LPMBSST-1(C2,@01)                               1499
         STCM  @04,7,SSA                                           1499
*               RESPECIFY                                          1500
*                (R0,                                              1500
*                 R9,                                              1500
*                 R10,                                             1500
*                 R11,                                             1500
*                 RET,                                             1500
*                 R15) RESTRICTED;  /*                       @Z30SSRL*/
*               R0=DDKR;            /* LOAD REG ZERO         @Z30SSRL*/
         L     R0,DDKR                                             1501
*               R2=USSA;            /* LOAD DEVICE TYPE AND ADDRESS
*                                                            @Z30SSRL*/
         L     R2,USSA                                             1502
*               STM(R0,R13,REGSAVE);/* SAVE REGISTERS        @Z30SSRL*/
         STM   R0,R13,REGSAVE                                      1503
*               CALL CVT0SCR1;      /* CALL CONVERT ROUTINE  @Z30SSRL*/
         L     @04,CVTPTR                                          1504
         L     @15,CVT0SCR1(,@04)                                  1504
         BALR  @14,@15                                             1504
*               LM(R0,R13,REGSAVE); /* RESTORE REGISTERS     @Z30SSRL*/
         LM    R0,R13,REGSAVE                                      1505
*               RESPECIFY                                          1506
*                (R0,                                              1506
*                 R9,                                              1506
*                 R10,                                             1506
*                 R11,                                             1506
*                 RET,                                             1506
*                 R15) UNRESTRICTED;/*                       @Z30SSRL*/
*             END;                  /*                       @Z30SSRL*/
         AL    C2,@CF00076                                         1507
@DE01497 L     @01,IX                                              1507
         BCTR  @01,0                                               1507
         MR    @00,LENGLPMB                                        1507
         AL    @01,LPMBAD                                          1507
         CH    C2,LPMBLKTR(,@01)                                   1507
         BNH   @DL01497                                            1507
*           END;                    /*                       @Z30SSRL*/
*       END;                        /*                       @Z30SSRL*/
@RF01491 DS    0H                                                  1510
*     IF AMBTYPE=AMBDATA THEN       /* IF DATA AMB                   */
@RF01488 TM    AMBTYPE(AMBPT),B'01000000'                          1510
         BNZ   @RF01510                                            1510
*       IF CTTOVFL=OFFX THEN        /* TRACK OVERFLOW?               */
         TM    CTTOVFL(CWAPT),B'00000001'                          1511
         BNZ   @RF01511                                            1511
*         LPMAUSZ=AMDCINV*AMDCIPCA; /* SET BYTE/ALLOC UNIT FIELD     */
         L     @01,IX                                              1512
         BCTR  @01,0                                               1512
         MR    @00,LENGLPMB                                        1512
         AL    @01,LPMBAD                                          1512
         L     @07,AMBDSB(,AMBPT)                                  1512
         L     @04,AMDCINV(,@07)                                   1512
         MH    @04,AMDCIPCA(,@07)                                  1512
         ST    @04,LPMAUSZ(,@01)                                   1512
*       ELSE                        /* TRACK OVERFLOW                */
*         DO;                                                      1513
         B     @RC01511                                            1513
@RF01511 DS    0H                                                  1514
*           LPMAUSZ=CTBYTAU;        /* IF TRKOVF INFO FROM CATLG     */
         L     @01,IX                                              1514
         BCTR  @01,0                                               1514
         MR    @00,LENGLPMB                                        1514
         AL    @01,LPMBAD                                          1514
         L     @07,CTBYTAU(,CWAPT)                                 1514
         ST    @07,LPMAUSZ(,@01)                                   1514
*           LPMBTOFL=ON;            /* SET TRACKOVERFLOW FLAG        */
         OI    LPMBTOFL(@01),B'00010000'                           1515
*         END;                                                     1516
*     ELSE                          /* INDEX                         */
*       IF IX=TWOLPMREPL=ON THEN   /* SSW/ & 1ST LPMB OR REPL       */
         B     @RC01510                                            1517
@RF01510 L     @07,IX                                              1517
         C     @07,@CF00044                                        1517
         BE    @RT01517                                            1517
         LR    @01,@07                                             1517
         BCTR  @01,0                                               1517
         MR    @00,LENGLPMB                                        1517
         AL    @01,LPMBAD                                          1517
         TM    LPMREPL(@01),B'01000000'                            1517
         BNO   @RF01517                                            1517
@RT01517 DS    0H                                                  1518
*         LPMAUSZ=AMDCINV;          /* YES, SET BYTES/ALLOC UNIT     */
         L     @01,IX                                              1518
         BCTR  @01,0                                               1518
         MR    @00,LENGLPMB                                        1518
         AL    @01,LPMBAD                                          1518
         L     @07,AMBDSB(,AMBPT)                                  1518
         L     @07,AMDCINV(,@07)                                   1518
         ST    @07,LPMAUSZ(,@01)                                   1518
*       ELSE                        /* NO SSW 1ST                    */
*         LPMAUSZ=AMDCINV*LPMBLKTR; /* SET BYTES/ALLOC               */
         B     @RC01517                                            1519
@RF01517 L     @01,IX                                              1519
         BCTR  @01,0                                               1519
         MR    @00,LENGLPMB                                        1519
         AL    @01,LPMBAD                                          1519
         L     @07,AMBDSB(,AMBPT)                                  1519
         L     @07,AMDCINV(,@07)                                   1519
         MH    @07,LPMBLKTR(,@01)                                  1519
         ST    @07,LPMAUSZ(,@01)                                   1519
*     IF(AMBTYPE=AMBDATALPMREPL=OFFX) THEN/* DATA AMB OR NOT      1520
*                                      REPLICATED            @Y007876*/
@RC01517 DS    0H                                                  1520
@RC01510 TM    AMBTYPE(AMBPT),B'01000000'                          1520
         BZ    @RT01520                                            1520
         L     @01,IX                                              1520
         BCTR  @01,0                                               1520
         MR    @00,LENGLPMB                                        1520
         AL    @01,LPMBAD                                          1520
         TM    LPMREPL(@01),B'01000000'                            1520
         BNZ   @RF01520                                            1520
@RT01520 DS    0H                                                  1521
*       IF CTTOVFL=OFFX THEN        /* TRACK OVERFLOW?               */
         TM    CTTOVFL(CWAPT),B'00000001'                          1521
         BNZ   @RF01521                                            1521
*         LPMBPTRK=LPMBLKSZ*LPMBLKTR;/* RBA BYTES/TRK FIELD          */
         L     @01,IX                                              1522
         BCTR  @01,0                                               1522
         MR    @00,LENGLPMB                                        1522
         AL    @01,LPMBAD                                          1522
         L     @07,LPMBLKSZ(,@01)                                  1522
         MH    @07,LPMBLKTR(,@01)                                  1522
         ST    @07,LPMBPTRK(,@01)                                  1522
*       ELSE                        /* TRACK OVERFLOW                */
*         LPMBPTRK=CTBYTTRK;        /* IF TRKOVF INFO FROM CATLG     */
         B     @RC01521                                            1523
@RF01521 L     @01,IX                                              1523
         BCTR  @01,0                                               1523
         MR    @00,LENGLPMB                                        1523
         AL    @01,LPMBAD                                          1523
         L     @07,CTBYTTRK(,CWAPT)                                1523
         ST    @07,LPMBPTRK(,@01)                                  1523
*     ELSE                          /* INDEX                         */
*       LPMBPTRK=LPMAUSZ;           /* BYTES PER TRACK       @Z30SSRL*/
         B     @RC01520                                            1524
@RF01520 L     @01,IX                                              1524
         BCTR  @01,0                                               1524
         MR    @00,LENGLPMB                                        1524
         AL    @01,LPMBAD                                          1524
         L     @07,LPMAUSZ(,@01)                                   1524
         ST    @07,LPMBPTRK(,@01)                                  1524
*   END;                                                           1525
@RC01520 SLR   @07,@07                                             1525
         BCTR  @07,0                                               1525
         AL    @07,IX                                              1525
         ST    @07,IX                                              1525
@DE01467 LTR   @07,@07                                             1525
         BP    @DL01467                                            1525
*   RET=RSAVLA;                                                    1526
         L     RET,RSAVLA                                          1526
*   END BLDLPMB;                                                   1527
@EL00034 DS    0H                                                  1527
@EF00034 DS    0H                                                  1527
@ER00034 BR    @14                                                 1527
*BLDEDB:                                                           1528
*                                                                  1528
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE EDB                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1528
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1528
BLDEDB   DS    0H                                                  1529
*   RSAVLA=RET;                                                    1529
         ST    RET,RSAVLA                                          1529
*   IX2=ADDR(CTVOLENT)+LENGTH(CTVOLENT);                           1530
         LA    @09,252                                             1530
         ALR   @09,CWAPT                                           1530
         ST    @09,IX2                                             1530
*   IX3=ADDR(CTKEY)+CTKEYLEN*TWO;                                  1531
         LA    IX3,CTKEY(,@09)                                     1531
         LA    @09,232                                             1531
         ALR   @09,CWAPT                                           1531
         LH    @04,CTKEYLEN(,@09)                                  1531
         ALR   @04,@04                                             1531
         ALR   IX3,@04                                             1531
*   RESPECIFY                                                      1532
*     CTKEYENT BASED(IX2);          /* ADDRESSING FOR KEY &          */
*   RESPECIFY                                                      1533
*     CTEXTENT BASED(IX3);          /* EXTENT PARTS OF AMBWORK       */
*   RESPECIFY                                                      1534
*     IDAEDBHD BASED(IX4);          /* EDB HEADER                    */
*   RESPECIFY                                                      1535
*     IDAEDB BASED(IX4);            /* EDB                           */
*   RESPECIFY                                                      1536
*     IDALPMB BASED(IX);            /* ADDRESSING FOR LPMB           */
*   CORELEN=LENGTH(IDAEDBHD)+LENGTH(IDAEDB)*CTNOEXT;/* SET SIZE OF 1537
*                                      EDB                           */
         SLR   @07,@07                                             1537
         IC    @07,CTNOEXT(,@09)                                   1537
         MH    @07,@CH00140                                        1537
         AL    @07,@CF00058                                        1537
         ST    @07,CORELEN                                         1537
*   CALL GETCORE;                   /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1538
*   IX4=COREADDR;                                                  1539
         L     IX4,COREADDR                                        1539
*   AMBEDB=IX4;                     /* AMB POINTS TO EDB HDR         */
         ST    IX4,AMBEDB(,AMBPT)                                  1540
*   EDBID=IDXEDB;                   /* SET ID                        */
         MVI   EDBID(IX4),X'90'                                    1541
*   EDBNO=CTNOEXT;                  /* NBR EXT FOR EDB               */
         LA    @09,232                                             1542
         ALR   @09,CWAPT                                           1542
         IC    @07,CTNOEXT(,@09)                                   1542
         STC   @07,EDBNO(,IX4)                                     1542
*   EDBLEN=LENGTH(IDAEDB);                                         1543
         MVC   EDBLEN(2,IX4),@CH00140                              1543
*   IX4=IX4+LENGTH(IDAEDBHD);       /* PT TO 1ST EDB                 */
         AL    IX4,@CF00058                                        1544
*   IX5=ZERO;                                                      1545
         SLR   IX5,IX5                                             1545
*   DO IX7=CTNOKEY TO 1 BY-1;       /* PROCESS ALL KEY RANGES        */
         ST    @09,@TF00001                                        1546
         L     @07,@TF00001                                        1546
         LH    IX7,CTNOKEY(,@07)                                   1546
         B     @DE01546                                            1546
@DL01546 DS    0H                                                  1547
*     IF AMDSDT=ON&CTSSWDTA=ON&     /* IF SS/D FOR DATA SET &        */
*         AMBTYPE=AMBINDEX THEN     /* IF AMB FOR INDEX              */
         L     @07,AMBDSB(,AMBPT)                                  1547
         TM    AMDSDT(@07),B'00100000'                             1547
         BNO   @RF01547                                            1547
         L     @07,IX2                                             1547
         TM    CTSSWDTA(@07),B'10000000'                           1547
         BNO   @RF01547                                            1547
         TM    AMBTYPE(AMBPT),B'01000000'                          1547
         BNO   @RF01547                                            1547
*       IX=LPMBAD+LPMBLEN;          /* POINT TO SS LPMB      @Z30SSRL*/
         L     @07,IX                                              1548
         LH    @07,LPMBLEN(,@07)                                   1548
         AL    @07,LPMBAD                                          1548
         ST    @07,IX                                              1548
*     ELSE                          /* NOT SS LPMB                   */
*       IX=LPMBAD;                                                 1549
         B     @RC01547                                            1549
@RF01547 L     @07,LPMBAD                                          1549
         ST    @07,IX                                              1549
*     IX3=ADDR(CTKEY)+CTKEYLEN*TWO; /* PT TO 1ST EXT ENTRY           */
@RC01547 L     @04,IX2                                             1550
         LA    IX3,CTKEY(,@04)                                     1550
         LH    @15,CTKEYLEN+232(,CWAPT)                            1550
         ALR   @15,@15                                             1550
         ALR   IX3,@15                                             1550
*     DO IX8=CTNOKEXT TO 1 BY-1;    /* PROCESS ALL EXTENT ENTRIES    */
         SLR   @15,@15                                             1551
         IC    @15,CTNOKEXT(,@04)                                  1551
         ST    @15,IX8                                             1551
         B     @DE01551                                            1551
@DL01551 DS    0H                                                  1552
*       EDBM=IX5;                   /* SET EDB NBR                   */
         STC   IX5,EDBM(,IX4)                                      1552
*       IX5=IX5+ONE;                /* BUMP CTR                      */
         LA    @04,1                                               1553
         ALR   IX5,@04                                             1553
*       EDBLPMBA=IX;                /* INIT LPMB PTR                 */
         L     @15,IX                                              1554
         ST    @15,EDBLPMBA(,IX4)                                  1554
*       EDBLORBA=CTRBABEG;          /* INIT LOW RBA THIS EXTENT      */
         MVC   EDBLORBA(4,IX4),CTRBABEG(IX3)                       1555
*       EDBHIRBA=CTRBAEND;          /* INIT HI RBA THIS EXT          */
         MVC   EDBHIRBA(4,IX4),CTRBAEND(IX3)                       1556
*       EDBSTTRK=CTCCBEG*LPMTPC+CTHHBEG;/* REL TRK ADDR              */
         SLR   @14,@14                                             1557
         ICM   @14,3,CTCCBEG(IX3)                                  1557
         MH    @14,LPMTPC(,@15)                                    1557
         SLR   @15,@15                                             1557
         ICM   @15,3,CTHHBEG(IX3)                                  1557
         ALR   @14,@15                                             1557
         ST    @14,EDBSTTRK(,IX4)                                  1557
*       IF AMDSDT=ON&               /* IF SS/D &                     */
*           AMBTYPE=AMBDATA THEN    /* DATA AMB                      */
         L     @01,AMBDSB(,AMBPT)                                  1558
         TM    AMDSDT(@01),B'00100000'                             1558
         BNO   @RF01558                                            1558
         TM    AMBTYPE(AMBPT),B'01000000'                          1558
         BNZ   @RF01558                                            1558
*         EDBSTTRK=EDBSTTRK+ONE;    /* DATA STARTS ON NEXT TRK       */
         ALR   @14,@04                                             1559
         ST    @14,EDBSTTRK(,IX4)                                  1559
*       IX4=IX4+LENGTH(IDAEDB);     /* PT TO NEXT EDB                */
@RF01558 AL    IX4,@CF00140                                        1560
*       IX3=IX3+LENGTH(CTEXTENT);   /* PT TO NEXT EXT ENT            */
         AL    IX3,@CF03059                                        1561
*     END;                                                         1562
         SLR   @15,@15                                             1562
         BCTR  @15,0                                               1562
         AL    @15,IX8                                             1562
         ST    @15,IX8                                             1562
@DE01551 LTR   @15,@15                                             1562
         BP    @DL01551                                            1562
*     IX2=IX3;                                                     1563
         ST    IX3,IX2                                             1563
*   END;                                                           1564
         BCTR  IX7,0                                               1564
@DE01546 LTR   IX7,IX7                                             1564
         BP    @DL01546                                            1564
*   AMBEDB->EDBLPMBC=LPMBAD;                                       1565
         L     @09,AMBEDB(,AMBPT)                                  1565
         L     @07,LPMBAD                                          1565
         ST    @07,EDBLPMBC(,@09)                                  1565
*   RET=RSAVLA;                                                    1566
         L     RET,RSAVLA                                          1566
*   END BLDEDB;                                                    1567
@EL00035 DS    0H                                                  1567
@EF00035 DS    0H                                                  1567
@ER00035 BR    @14                                                 1567
*BLDRDEB:                                                          1568
*                                                                  1568
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE REAL DEB                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1568
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1568
BLDRDEB  DS    0H                                                  1569
*   RSAVLA=RET;                                                    1569
         ST    RET,RSAVLA                                          1569
*   CORELEN=((LENGTH(DEBAVT)+       /* APPENDAGE VECTOR TABLE      1570
*                                                            @Z30SSRL*/
*       LENGTH(DEBPREFX)+           /* PREFIX SECTION        @Z30SSRL*/
*       LENGTH(DEBBASIC)+           /* BASIC SECTION         @Z30SSRL*/
*       LENGTH(DEBDASD)*CTNOEXT)+SEVEN)/EIGHT*EIGHT;/* PLUS EXTENDS
*                                      ROUND UP TO DOUBLE WORDS    1570
*                                                            @Z30SSRL*/
         SLR   @00,@00                                             1570
         IC    @00,CTNOEXT+232(,CWAPT)                             1570
         SLA   @00,4                                               1570
         AL    @00,@CF04223                                        1570
         SRDA  @00,32                                              1570
         D     @00,@CF00058                                        1570
         SLA   @01,3                                               1570
         ST    @01,CORELEN                                         1570
*   CALL GETCORE;                   /* GET CORE FOR CTL BLKS         */
         BAL   @14,GETCORE                                         1571
*   RDEBAD=COREADDR+LENGTH(DEBAVT)+ /*                               */
*       LENGTH(DEBPREFX);           /* PT TO DEB PROPER              */
         L     @09,COREADDR                                        1572
         LA    RDEBAD,36                                           1572
         ALR   RDEBAD,@09                                          1572
*   AMBDEBAD=RDEBAD;                                               1573
         STCM  RDEBAD,7,AMBDEBAD(AMBPT)                            1573
*   DEBTCBAD=ADDR(TCB);                                            1574
         L     @07,NVTPTR                                          1574
         L     @07,NVTMSTCB(,@07)                                  1574
         ST    @07,DEBTCBAD(,RDEBAD)                               1574
*   DEBAPPB=COREADDR;               /* PT TO APPENDAGE VECTOR TBL    */
         STCM  @09,7,DEBAPPB(RDEBAD)                               1575
*   IX4=ADDR(DEBBASND);                                            1576
         LA    IX4,DEBBASND(,RDEBAD)                               1576
*   RESPECIFY                                                      1577
*     DEBDASD BASED(IX4);                                          1577
*   RESPECIFY                                                      1578
*     CTKEYENT BASED(IX2);                                         1578
*   RESPECIFY                                                      1579
*     CTEXTENT BASED(IX3);                                         1579
*   DEBEOEAD=ADDR(CVTBRET);         /* DUMMY EOE ENTRY               */
         L     @09,DEBAPPAD(,RDEBAD)                               1580
         L     @07,CVTPTR                                          1580
         LA    @04,CVTBRET(,@07)                                   1580
         STCM  @04,7,DEBEOEAD(@09)                                 1580
*   DEBCEAD=ABPNE;                                                 1581
         L     @07,CVTIOBP(,@07)                                   1581
         MVC   DEBCEAD(3,@09),ABPNE+1(@07)                         1581
*   DEBXCEAD=ABPAE;                                                1582
         MVC   DEBXCEAD(3,@09),ABPAE+1(@07)                        1582
*   IF CTRELOP=ON THEN              /* RELEASE OPTION                */
         TM    CTRELOP(CWAPT),B'00100000'                          1583
         BNO   @RF01583                                            1583
*     DEBRLSE=ON;                   /* SET RELEASE OPT IF SPEC       */
         OI    DEBRLSE(RDEBAD),B'00010000'                         1584
*   DEBNMEXT=CTNOEXT;               /* NUMBER OF EXTENTS             */
@RF01583 LA    @09,232                                             1585
         ALR   @09,CWAPT                                           1585
         IC    @07,CTNOEXT(,@09)                                   1585
         STC   @07,DEBNMEXT(,RDEBAD)                               1585
*   DEBPRIOR=TCBDSP;                /* PRIORITY                      */
         L     @07,NVTPTR                                          1586
         L     @07,NVTMSTCB(,@07)                                  1586
         IC    @04,TCBDSP(,@07)                                    1586
         STC   @04,DEBPRIOR(,RDEBAD)                               1586
*   DEBPROTG=TCBPKF;                /* PROTECT KEY                   */
         MVC   DEBPROTG(1,RDEBAD),TCBPKF(@07)                      1587
*   DEBDEBID=DEBDEBIDIDXDEB;       /* DEB IDENT IN LO ORDER BITS    */
         OI    DEBDEBID(RDEBAD),B'00001111'                        1588
*   DEBEXSCL=EXSCALE;               /* EXTENT SCALE FOR DASD         */
         IC    @07,EXSCALE                                         1589
         STC   @07,DEBEXSCL(,RDEBAD)                               1589
*   DEBLNGTH=CORELEN/EIGHT;         /* DEB LENGTH IN DOUBLEWORDS     */
         L     @07,DEBAPPAD(,RDEBAD)                               1590
         L     @00,CORELEN                                         1590
         SRDA  @00,32                                              1590
         D     @00,@CF00058                                        1590
         STC   @01,DEBLNGTH(,@07)                                  1590
*   IX2=ADDR(CTVOLENT)+LENGTH(CTVOLENT);/* PT TO 1ST KEY RANGE       */
         LA    @07,252                                             1591
         ALR   @07,CWAPT                                           1591
         ST    @07,IX2                                             1591
*   DO IX6=CTNOKEY TO 1 BY-1;       /* PROCESS ALL KEY RANGES        */
         LH    @09,CTNOKEY(,@09)                                   1592
         ST    @09,IX6                                             1592
         B     @DE01592                                            1592
@DL01592 DS    0H                                                  1593
*     IX3=ADDR(CTKEY)+CTKEYLEN*TWO; /* PT TO 1ST EXTENT ENTRY        */
         L     @09,IX2                                             1593
         LA    IX3,CTKEY(,@09)                                     1593
         LH    @04,CTKEYLEN+232(,CWAPT)                            1593
         ALR   @04,@04                                             1593
         ALR   IX3,@04                                             1593
*     DO IX7=CTNOKEXT TO 1 BY-1;    /* PROCESS ALL EXTENT ENTIRES    */
         L     @04,IX2                                             1594
         SLR   IX7,IX7                                             1594
         IC    IX7,CTNOKEXT(,@04)                                  1594
         B     @DE01594                                            1594
@DL01594 DS    0H                                                  1595
*       DEBUCBA=CTVOLUCB;           /* UCB PTR                       */
         MVC   DEBUCBA(3,IX4),CTVOLUCB+233(CWAPT)                  1595
*       DEBSTRCC(1:10)=CTABSBEG(1:10);                             1596
         MVC   DEBSTRCC(10,IX4),CTABSBEG(IX3)                      1596
*       DEBDVMOD=FMSKWR;            /* SET FILE MASK FOR WRITES      */
         IC    @04,FMSKWR                                          1597
         STC   @04,DEBDVMOD(,IX4)                                  1597
*       IX4=IX4+LENGTH(DEBDASD);    /* PT TO NEXT DEB EXTENT         */
         AL    IX4,@CF00073                                        1598
*       IX3=IX3+LENGTH(CTEXTENT);   /* PT TO NXT EXTENT ENTRY        */
         AL    IX3,@CF03059                                        1599
*     END;                                                         1600
         BCTR  IX7,0                                               1600
@DE01594 LTR   IX7,IX7                                             1600
         BP    @DL01594                                            1600
*     IX2=IX3;                      /* PT TO NXT KEY RANGE           */
         ST    IX3,IX2                                             1601
*   END;                                                           1602
         SLR   @09,@09                                             1602
         BCTR  @09,0                                               1602
         AL    @09,IX6                                             1602
         ST    @09,IX6                                             1602
@DE01592 LTR   @09,@09                                             1602
         BP    @DL01592                                            1602
*   RET=RSAVLA;                                                    1603
         L     RET,RSAVLA                                          1603
*   END BLDRDEB;                                                   1604
@EL00036 DS    0H                                                  1604
@EF00036 DS    0H                                                  1604
@ER00036 BR    @14                                                 1604
*CHNBLKS:                                                          1605
*                                                                  1605
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE COMPLETES CHAINING CONTROL BLOCKS TOGETHER       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1605
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1605
CHNBLKS  DS    0H                                                  1606
*   RSAVLA=RET;                                                    1606
         ST    RET,RSAVLA                                          1606
*   RESPECIFY                                                      1607
*     IDAPLH BASED(IX2);                                           1607
*   RESPECIFY                                                      1608
*     IDABUFC BASED(IX3);                                          1608
*   RESPECIFY                                                      1609
*     IDAIOMB BASED(IX4);                                          1609
*   AMDPARDB=ARDBAD;                                               1610
         L     @09,AMBDSB(,AMBPT)                                  1610
         L     @02,ARDBAD                                          1610
         ST    @02,AMDPARDB(,@09)                                  1610
*   IX3=AMBBUFC+LENGTH(IDABUFDR);   /* PT TO 1ST BUFC                */
         L     @09,AMBBUFC(,AMBPT)                                 1611
         LA    IX3,20                                              1611
         ALR   IX3,@09                                             1611
*   IX4=AMBIOMB;                    /* PT TO 1ST IOMB                */
         L     IX4,AMBIOMB(,AMBPT)                                 1612
*   IF AMBTYPE=AMBINDEX THEN        /* PROCESS INDEX AMBWORK FIRST   */
         TM    AMBTYPE(AMBPT),B'01000000'                          1613
         BNO   @RF01613                                            1613
*     DO;                                                          1614
*       IX2=AMBLDTA->AMBPH+LENGTH(IDAPLHDR);/* PT TO 1ST DATA PLH    */
         L     @02,ACBPTR                                          1615
         L     @02,ACBAMBL(,@02)                                   1615
         L     @01,AMBLDTA(,@02)                                   1615
         LA    @00,16                                              1615
         AL    @00,AMBPH(,@01)                                     1615
         ST    @00,IX2                                             1615
*       IF BUFDRNO>AMBLNST THEN     /* MORE BUFC'S THAN PLH'S?       */
         CLC   BUFDRNO(1,@09),AMBLNST(@02)                         1616
         BNH   @RF01616                                            1616
*         IX3=IX3+LENGTH(IDABUFC);  /* SAVE 1ST FOR HIGH LEVEL       */
         AL    IX3,@CF01157                                        1617
*       DO IX=AMBLNST TO 1 BY-1;                                   1618
@RF01616 L     @09,ACBPTR                                          1618
         L     @09,ACBAMBL(,@09)                                   1618
         SLR   @02,@02                                             1618
         IC    @02,AMBLNST(,@09)                                   1618
         ST    @02,IX                                              1618
         B     @DE01618                                            1618
@DL01618 DS    0H                                                  1619
*         IOMPLH=ADDR(IDAPLH);      /* PT IOMB BACK                  */
         L     @09,IX2                                             1619
         ST    @09,IOMPLH(,IX4)                                    1619
*         PLHIBUFC=IX3;             /* ASSIGN BUFC                   */
         ST    IX3,PLHIBUFC(,@09)                                  1620
*         BUFCPLH=ADDR(IDAPLH);     /* CONNECT BACK                  */
         ST    @09,BUFCPLH(,IX3)                                   1621
*         BUFCAVL='FF'X;            /* SET ASSIGNED BYTE             */
         MVI   BUFCAVL(IX3),X'FF'                                  1622
*         IX3=IX3+LENGTH(IDABUFC);  /* NEXT BUFC                     */
         AL    IX3,@CF01157                                        1623
*         IX2=IX2+PLHELTH;          /* POINT TO NEXT PLH             */
         L     @01,AMBPH(,AMBPT)                                   1624
         AH    @09,PLHELTH(,@01)                                   1624
         ST    @09,IX2                                             1624
*         IX4=IOMNXT1;              /* NEXT IOMB                     */
         L     IX4,IOMNXT1(,IX4)                                   1625
*       END;                                                       1626
         BCTR  @02,0                                               1626
         ST    @02,IX                                              1626
@DE01618 LTR   @02,@02                                             1626
         BP    @DL01618                                            1626
*     END;                                                         1627
*   ELSE                            /* DATA AMBWORK                  */
*     DO;                                                          1628
         B     @RC01613                                            1628
@RF01613 DS    0H                                                  1629
*       DIWBUFC=ADDR(IDABUFDR)+LENGTH(IDABUFDR);                   1629
         L     @09,AMBIWA(,AMBPT)                                  1629
         LA    @02,20                                              1629
         AL    @02,AMBBUFC(,AMBPT)                                 1629
         ST    @02,DIWBUFC(,@09)                                   1629
*       IX2=AMBPH+LENGTH(IDAPLHDR);                                1630
         L     @09,AMBPH(,AMBPT)                                   1630
         LA    @02,16                                              1630
         ALR   @02,@09                                             1630
         ST    @02,IX2                                             1630
*       DO IX=PLHCNT TO 1 BY-1;                                    1631
         SLR   @02,@02                                             1631
         IC    @02,PLHCNT(,@09)                                    1631
         ST    @02,IX                                              1631
         B     @DE01631                                            1631
@DL01631 DS    0H                                                  1632
*         PLHDBUFC=ADDR(IDABUFC);                                  1632
         L     @09,IX2                                             1632
         ST    IX3,PLHDBUFC(,@09)                                  1632
*         PLHNBUFC=ADDR(IDABUFC);                                  1633
         ST    IX3,PLHNBUFC(,@09)                                  1633
*         BUFCAVL='FF'X;                                           1634
         MVI   BUFCAVL(IX3),X'FF'                                  1634
*         BUFCPLH=ADDR(IDAPLH);                                    1635
         ST    @09,BUFCPLH(,IX3)                                   1635
*         PLHDIOB=ADDR(IDAIOMB);                                   1636
         ST    IX4,PLHDIOB(,@09)                                   1636
*         IOMPLH=ADDR(IDAPLH);                                     1637
         ST    @09,IOMPLH(,IX4)                                    1637
*         IX2=IX2+PLHELTH;                                         1638
         L     @01,AMBPH(,AMBPT)                                   1638
         AH    @09,PLHELTH(,@01)                                   1638
         ST    @09,IX2                                             1638
*         IX3=IX3+LENGTH(IDABUFC);                                 1639
         AL    IX3,@CF01157                                        1639
*         IX4=IOMNXT1;                                             1640
         L     IX4,IOMNXT1(,IX4)                                   1640
*       END;                                                       1641
         BCTR  @02,0                                               1641
         ST    @02,IX                                              1641
@DE01631 LTR   @02,@02                                             1641
         BP    @DL01631                                            1641
*     END;                                                         1642
*   RET=RSAVLA;                                                    1643
@RC01613 L     RET,RSAVLA                                          1643
*   END CHNBLKS;                                                   1644
@EL00037 DS    0H                                                  1644
@EF00037 DS    0H                                                  1644
@ER00037 BR    @14                                                 1644
*GETWORK:                                                          1645
*                                                                  1645
*   /*****************************************************************/
*   /*                                                               */
*   /* GET WORKING STORAGE - USE & FREED IN THIS MODULE              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1645
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1645
GETWORK  DS    0H                                                  1646
*   RSAVLF=RET;                                                    1646
         ST    RET,RSAVLF                                          1646
*   WKLEN=(WKLEN+SEVEN)/EIGHT*EIGHT;                               1647
         LA    @00,7                                               1647
         AH    @00,WKLEN                                           1647
         SRDA  @00,32                                              1647
         D     @00,@CF00058                                        1647
         SLA   @01,3                                               1647
         STH   @01,WKLEN                                           1647
*   RFY                                                            1648
*     RETCODE RSTD;                                                1648
*   GEN REFS(WKLEN,LOCPTR) SETS(WKCORE,RETCODE);                   1649
         STM R2,R5,TEMPSR
         LH    R5,WKLEN
         LM   R2,R3,LOCPTR
         GETMAIN EC,LV=(R5),A=WKCORE,SP=0,MF=(E,MAINLIST)
*   IF RETCODE^=ZERO THEN           /* IF GETMAIN WAS UNSUCCESSFULL  */
         LTR   RETCODE,RETCODE                                     1650
         BZ    @RF01650                                            1650
*     DO;                                                          1651
*       GEN(LM   R2,R5,TEMPSR);                                    1652
         LM   R2,R5,TEMPSR
*       ERFLAG=GETERR;              /* SET CODE                      */
         LH    @14,GETERR                                          1653
         STH   @14,ERFLAG                                          1653
*       RETURN TO EXIT;             /* BAIL OUT                      */
         LA    @14,EXIT                                            1654
@EL00038 DS    0H                                                  1654
@EF00038 DS    0H                                                  1654
@ER00038 BR    @14                                                 1654
*     END;                                                         1655
*   GEN(L     R4,WKCORE);                                          1656
@RF01650 DS    0H                                                  1656
         L     R4,WKCORE
*   GEN(SR    R3,R3);                                              1657
         SR    R3,R3
*   GEN(MVCL R4,R2);                                               1658
         MVCL R4,R2
*   GEN(LM R2,R5,TEMPSR);                                          1659
         LM R2,R5,TEMPSR
*   RFY                                                            1660
*     RETCODE UNRSTD;                                              1660
*   RET=RSAVLF;                                                    1661
         L     RET,RSAVLF                                          1661
*   END GETWORK;                                                   1662
         B     @EL00038                                            1662
*FREEWORK:                                                         1663
*                                                                  1663
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE TEMPORARY WORKING STORAGE                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1663
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1663
FREEWORK DS    0H                                                  1664
*   RSAVLF=RET;                                                    1664
         ST    RET,RSAVLF                                          1664
*   GEN REFS(LOCPTR) SETS(FREELEN,FREEAD,MAINLIST);                1665
         STM  R2,R5,TEMPSR
         LH    R5,FREELEN
         LA    R4,FREEAD
         LM   R2,R3,LOCPTR
         FREEMAIN E,LV=(R5),A=(R4),SP=0,MF=(E,MAINLIST)
         LM  R2,R5,TEMPSR
*   RET=RSAVLF;                                                    1666
         L     RET,RSAVLF                                          1666
*   END FREEWORK;                                                  1667
@EL00039 DS    0H                                                  1667
@EF00039 DS    0H                                                  1667
@ER00039 BR    @14                                                 1667
*GETCORE:                                                          1668
*                                                                  1668
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR CONTROL BLOCKS                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1668
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1668
GETCORE  DS    0H                                                  1669
*   RSAVLF=RET;                                                    1669
         ST    RET,RSAVLF                                          1669
*   CORELEN=(CORELEN+SEVEN)/EIGHT*EIGHT;/* ROUND TO DOUBLE WORD      */
         LA    @00,7                                               1670
         AL    @00,CORELEN                                         1670
         SRDA  @00,32                                              1670
         D     @00,@CF00058                                        1670
         SLA   @01,3                                               1670
         ST    @01,CORELEN                                         1670
*   IF SWPGSP=OFFX THEN             /* ANY MAPPING BLOCKS FOR PGSP   */
         TM    SWPGSP,B'01000000'                                  1671
         BNZ   @RF01671                                            1671
*     DO;                           /* NO                            */
*       IF COREPTR1=ZERO THEN       /* FIRST TIME IN?                */
         L     @00,COREPTR1                                        1673
         LTR   @00,@00                                             1673
         BNZ   @RF01673                                            1673
*         DO;                       /* YES DO                        */
*           CALL GETMAIN;           /* GET A BLOCK                   */
         BAL   @14,GETMAIN                                         1675
*           COREPTR1=COREADR2;      /* PTR TO TOP OF COREBLK CHAIN   */
         L     @04,COREADR2                                        1676
         ST    @04,COREPTR1                                        1676
*           COREPTRN=COREADR2;      /* PTR TO CURRENT COREBLK        */
         ST    @04,COREPTRN                                        1677
*           COREBKPL=MAINPOOL;                                     1678
         L     @00,MAINPOOL                                        1678
         STC   @00,COREBKPL(,@04)                                  1678
*           CORESIZE=LENGTH(COREBLK);                              1679
         LA    @15,96                                              1679
         STCM  @15,7,CORESIZE(@04)                                 1679
*           COREADR2=COREADR2+LENGTH(COREBLK);/* UPDATE AVAILABLE  1680
*                                      CORE PTR                      */
         ALR   @04,@15                                             1680
         ST    @04,COREADR2                                        1680
*           COREAVIL=COREAVIL-LENGTH(COREBLK);/* UPDATE CORE AMOUNT
*                                      AVAILABLE                     */
         LCR   @15,@15                                             1681
         AL    @15,COREAVIL                                        1681
         ST    @15,COREAVIL                                        1681
*         END;                                                     1682
*       IF CORENBR=TEN THEN         /* IS CURRENT COREBLK USED UP?   */
@RF01673 L     @04,COREPTRN                                        1683
         CLC   CORENBR(2,@04),@CH00035                             1683
         BNE   @RF01683                                            1683
*         DO;                       /* YES, CREATE A NEW ONE         */
*           IF COREAVIL<LENGTH(COREBLK) THEN/* ENOUGH CORE?          */
         L     @04,COREAVIL                                        1685
         C     @04,@CF04201                                        1685
         BNL   @RF01685                                            1685
*             DO;                   /* NO GET MORE                   */
*               CALL FREEMAIN;      /* FREE OLD CORE                 */
         BAL   @14,FREEMAIN                                        1687
*               CALL GETMAIN;       /* GET NEW CORE                  */
         BAL   @14,GETMAIN                                         1688
*             END;                                                 1689
*           CORELAST=COREADR2;      /* CHAIN NEW BLOCK               */
@RF01685 L     @04,COREADR2                                        1690
         L     @15,COREPTRN                                        1690
         ST    @04,CORELAST(,@15)                                  1690
*           COREPTRN=COREADR2;      /* STEP BASE                     */
         ST    @04,COREPTRN                                        1691
*           COREBKPL=MAINPOOL;                                     1692
         L     @00,MAINPOOL                                        1692
         STC   @00,COREBKPL(,@04)                                  1692
*           CORESIZE=LENGTH(COREBLK);                              1693
         LA    @15,96                                              1693
         STCM  @15,7,CORESIZE(@04)                                 1693
*           COREADR2=COREADR2+      /* AVAILABLE CORE PTR            */
*               LENGTH(COREBLK);                                   1694
         ALR   @04,@15                                             1694
         ST    @04,COREADR2                                        1694
*           COREAVIL=COREAVIL-      /* AVAILABLE CORE SIZE           */
*               LENGTH(COREBLK);                                   1695
         LCR   @15,@15                                             1695
         AL    @15,COREAVIL                                        1695
         ST    @15,COREAVIL                                        1695
*         END;                                                     1696
*     END;                                                         1697
@RF01683 DS    0H                                                  1698
*   IF CORELEN>COREAVIL THEN        /* ENOUGH CORE FOR REQUEST?      */
@RF01671 L     @04,CORELEN                                         1698
         C     @04,COREAVIL                                        1698
         BNH   @RF01698                                            1698
*     DO;                           /* NO, DO                        */
*       CALL FREEMAIN;              /* FREE OLD CORE                 */
         BAL   @14,FREEMAIN                                        1700
*       CALL GETMAIN;               /* GET NEW CORE                  */
         BAL   @14,GETMAIN                                         1701
*     END;                                                         1702
*   COREADDR=COREADR2;              /* PTR FOR CALLER                */
@RF01698 L     @04,COREADR2                                        1703
         ST    @04,COREADDR                                        1703
*   COREADR2=COREADR2+CORELEN;      /* STEP POINTER                  */
         L     @15,CORELEN                                         1704
         LR    @14,@04                                             1704
         ALR   @14,@15                                             1704
         ST    @14,COREADR2                                        1704
*   COREAVIL=COREAVIL-CORELEN;      /* AVAILABLE CORE SIZE           */
         L     @14,COREAVIL                                        1705
         SLR   @14,@15                                             1705
         ST    @14,COREAVIL                                        1705
*   IF SWPGSP=OFFX THEN             /* DO WE HAVE PAGE SPACE?        */
         TM    SWPGSP,B'01000000'                                  1706
         BNZ   @RF01706                                            1706
*     DO;                           /* NO, DON T TRY TO FILL IN      */
*       CORENBR=CORENBR+ONE;        /* STEP INDEX TO CORE CTL BLK    */
         L     @14,COREPTRN                                        1708
         LA    @00,1                                               1708
         AH    @00,CORENBR(,@14)                                   1708
         STH   @00,CORENBR(,@14)                                   1708
*       COREPTR(CORENBR)=COREADDR;                                 1709
         SLA   @00,3                                               1709
         LR    @01,@00                                             1709
         ST    @04,COREPTR-8(@01,@14)                              1709
*       COREPOOL(CORENBR)=NIPPOOL;  /* BUILD CORE TABLE ENTRY FOR    */
         L     @04,ACBPTR                                          1710
         L     @04,NIPSPPTR(,@04)                                  1710
         SLR   @01,@01                                             1710
         IC    @01,NIPPOOL(,@04)                                   1710
         LR    @04,@00                                             1710
         STC   @01,COREPOOL-8(@04,@14)                             1710
*       CORELNTH(CORENBR)=CORELEN;  /* REQUEST                       */
         ALR   @14,@00                                             1711
         STCM  @15,7,CORELNTH-8(@14)                               1711
*     END;                                                         1712
*   RET=RSAVLF;                                                    1713
@RF01706 L     RET,RSAVLF                                          1713
*   END GETCORE;                                                   1714
@EL00040 DS    0H                                                  1714
@EF00040 DS    0H                                                  1714
@ER00040 BR    @14                                                 1714
*GETMAIN:                                                          1715
*                                                                  1715
*   /*****************************************************************/
*   /*                                                               */
*   /* GET MAIN STORAGE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1715
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1715
GETMAIN  DS    0H                                                  1716
*   RSAVLG=RET;                                                    1716
         ST    RET,RSAVLG                                          1716
*   MAINMIN=LENGTH(COREBLK)+CORELEN;                               1717
         LA    @04,96                                              1717
         AL    @04,CORELEN                                         1717
         ST    @04,MAINMIN                                         1717
*   MAINLEN=MAX(2048,MAINMIN);                                     1718
         LA    @15,2048                                            1718
         CR    @04,@15                                             1718
         BNL   *+6
         LR    @04,@15                                             1718
         ST    @04,MAINLEN                                         1718
*   RFY                                                            1719
*     RETCODE RSTD;                                                1719
*   GEN REFS(MAINPOOL,LOCPTR) SETS(COREADR2,MAINMIN,RETCODE);      1720
*                                                         /*@ZA15678*/
         STM R2,R5,TEMPSR
         L     R4,MAINPOOL
         LM   R2,R3,LOCPTR
         GETMAIN VC,LA=MAINMIN,A=COREADR2,SP=(R4),MF=(E,MAINLIST)
         LM   R2,R5,TEMPSR
*   IF RETCODE^=ZERO THEN           /* DID WE GET THE CORE           */
         LTR   RETCODE,RETCODE                                     1721
         BZ    @RF01721                                            1721
*     DO;                                                          1722
*       ERFLAG=GETERR;                                             1723
         LH    @14,GETERR                                          1723
         STH   @14,ERFLAG                                          1723
*       RETURN TO EXIT;             /* GET OUT                       */
         LA    @14,EXIT                                            1724
@EL00041 DS    0H                                                  1724
@EF00041 DS    0H                                                  1724
@ER00041 BR    @14                                                 1724
*     END;                                                         1725
*   GEN NOSETS;                                                    1726
@RF01721 DS    0H                                                  1726
        L     R4,COREADR2
        L     R5,COREAVIL
        SR    R3,R3
        MVCL  R4,R2
        LM    R2,R5,TEMPSR
*   RFY                                                            1727
*     RETCODE UNRSTD;                                              1727
*   RET=RSAVLG;                                                    1728
         L     RET,RSAVLG                                          1728
*   END GETMAIN;                                                   1729
         B     @EL00041                                            1729
*FREEMAIN:                                                         1730
*                                                                  1730
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE MAIN STORAGE                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1730
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1730
FREEMAIN DS    0H                                                  1731
*   GEN REFS(MAINPOOL,LOCPTR) SETS(COREAVIL,MAINLIST,RSAVLG);      1731
*                                                         /*@ZA15678*/
        ST    R14,RSAVLG
        STM   R2,R5,TEMPSR             SAVE REGS
        L     R4,COREAVIL              NUMBER OF BYTES FROM LAST TIME
        LTR   R4,R4                    ARE THERE ANY
        BZ    ASM1                                NO
        L     R0,MAINPOOL              LOAD SUBPOOL NUMBER
        LM    R2,R3,LOCPTR             LOAD NVT,CVT POINTERS
        LA    R5,COREADR2
        FREEMAIN V,A=(R5),SP=(0),MF=(E,MAINLIST)
ASM1     LM    R2,R5,TEMPSR             RESTORE REGS
        L     R14,RSAVLG
*   END FREEMAIN;                                                  1732
@EL00042 DS    0H                                                  1732
@EF00042 DS    0H                                                  1732
@ER00042 BR    @14                                                 1732
*   END IEAVNP1A                                                   1733
*                                                                  1733
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMCBS   )                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAIDXCB)                                       */
*/*%INCLUDE SYSLIB  (IHAIQE  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */
*/*%INCLUDE SYSLIB  (IDACTREC)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */
*/*%INCLUDE SYSLIB  (IDAEDB  )                                       */
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */
*/*%INCLUDE SYSLIB  (IDAARDB )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */
*/*%INCLUDE SYSLIB  (IDACPA  )                                       */
*/*%INCLUDE SYSLIB  (IDALPMB )                                       */
*/*%INCLUDE SYSLIB  (IDADIWA )                                       */
*/*%INCLUDE SYSLIB  (IDAIMWA )                                       */
*/*%INCLUDE SYSLIB  (IDAICWA )                                       */
*/*%INCLUDE SYSLIB  (IEAPMNIP)                                       */
*/*%INCLUDE SYSLIB  (IECDIOSB)                                       */
*/*%INCLUDE SYSLIB  (IDAIOMB )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IEZABP  )                                       */
*/*%INCLUDE SYSLIB  (IHANVT  )                                       */
*                                                                  1733
*       ;                                                          1733
@DATA    DS    0H
@CH00035 DC    H'10'
@SM04228 MVC   DSNDD(0),DSN(@07)
@SM04230 MVC   CTAMDSB(0,CWAPT),AMDSBCAT(@04)
@SM04233 MVC   CTKEY(0,WORKPTR5),LOKEYV(WKPT7)
@SM04235 MVC   CTKEY+1(0,@04),@TS00001
@SM04237 MVC   CTKEY(0,@01),HIKEYV(WKPT8)
@SM04239 MVC   CTEXTENT(0,@01),EXTENT(@04)
@SX04241 XC    CTGPL(0,CTGPLPTR),CTGPL(CTGPLPTR)
@SX04244 XC    CTGFL(0,CTGFLPTR),CTGFL(CTGFLPTR)
@SM04248 MVC   ARDKEYS(0,IX3),CTKEY(@09)
@SC04250 CLC   ARDKEYS(0,IX3),LOKY(LOKYAD)
@SC04252 CLC   ARDKEYS(0,@03),ARDKEYS(IX3)
@SC04254 CLC   ARDKEYS(0,IX3),ARDKEYS(TEMPLKAR)
@SC04256 CLC   ARDKEYS(0,IX3),ARDKEYS(@04)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@TF00001 DS    F
IEAVNP1A CSECT
         DS    0F
@CF00076 DC    F'1'
@CH00076 EQU   @CF00076+2
@CF00044 DC    F'2'
@CH00044 EQU   @CF00044+2
@CF00088 DC    F'3'
@CH00088 EQU   @CF00088+2
@CF00048 DC    F'4'
@CH00048 EQU   @CF00048+2
@CF01094 DC    F'5'
@CH01094 EQU   @CF01094+2
@CF00113 DC    F'6'
@CH00113 EQU   @CF00113+2
@CF00285 DC    F'7'
@CF00058 DC    F'8'
@CF00073 DC    F'16'
@CF03059 DC    F'20'
@CH03059 EQU   @CF03059+2
@CF00140 DC    F'24'
@CH00140 EQU   @CF00140+2
@CF03727 DC    F'29'
@CF03734 DC    F'35'
@CF03057 DC    F'36'
@CF04207 DC    F'48'
@CF03052 DC    F'60'
@CH03052 EQU   @CF03052+2
@CF01157 DC    F'64'
@CH01157 EQU   @CF01157+2
@CF04206 DC    F'68'
@CF04223 DC    F'75'
@CF04209 DC    F'76'
@CF04201 DC    F'96'
@CF04197 DC    F'120'
@CH04197 EQU   @CF04197+2
@CF04208 DC    F'144'
@CF04221 DC    F'280'
@CF04217 DC    F'296'
@CF04196 DC    F'421'
@CF04112 DC    F'2048'
@CF04222 DC    F'-8'
@DATD    DSECT
         DS    0D
COREADDR DS    A
CORELEN  DS    F
COREPTR1 DS    A
COREPTRN DS    A
COREADR2 DS    A
COREAVIL DS    F
WKCORE   DS    A
WCCWN    DS    F
FREEAD   DS    A
CATBLKLN DS    A
ARDBSIZE DS    F
RSAVLA   DS    A
RSAVLB   DS    A
RSAVLC   DS    A
RSAVLD   DS    A
RSAVLE   DS    A
RSAVLF   DS    A
RSAVLG   DS    A
WORKPTR1 DS    A
WORKPTR2 DS    A
WORKPTR3 DS    A
WORKPTR4 DS    A
WKPT9    DS    A
WORKPTR6 DS    A
IX       DS    A
IX1      DS    A
IX2      DS    A
IX6      DS    A
IX8      DS    A
IX9      DS    A
IXA      DS    A
ARDBAD   DS    A
LPMBAD   DS    A
PLHAD    DS    A
BUFND    DS    F
BUFNI    DS    F
CURBFSPD DS    F
CURBFSPI DS    F
DDKR     DS    AL4
         ORG   DDKR
DD       DS    FL2
K        DS    FL1
R        DS    FL1
         ORG   DDKR+4
USSA     DS    AL4
         ORG   USSA
U        DS    FL1
SSA      DS    AL3
         ORG   USSA+4
WKADDR   DS    A
WUCBPT   DS    A
ERFLAG   DS    H
WKLEN    DS    H
FREELEN  DS    H
MEMNUM   DS    FL1
@TS00001 DS    CL256
         DS    CL1
TCATWDS  DS    CL8
         ORG   TCATWDS
DATAWAPT DS    AL4
INDXWAPT DS    AL4
         ORG   TCATWDS+8
IDACLDSC DS    CL21
         ORG   IDACLDSC
CTAMBNO  DS    FL4
CTDDSN   DS    CL3
CTIDSN   DS    CL3
@NM00134 DS    CL2
CTCISIZD DS    FL4
CTCISIZI DS    FL4
CTFLG1   DS    CL1
         ORG   IDACLDSC+21
         DS    CL3
MAINPARM DS    CL12
         ORG   MAINPARM
MAINMIN  DS    AL4
MAINLEN  DS    AL4
MAINPOOL DS    AL4
         ORG   MAINPARM+12
LOCDES   DS    CL421
         ORG   LOCDES
DSNDD    DS    CL44
DSNCCI   DS    CL3
DSNDCI   DS    CL3
DSNICI   DS    CL3
DSNCI    DS    CL3
DSCATACB DS    AL4
FL       DS    CL20
         ORG   FL+0
FLNAME   DS    CL8
FLTSTPTR DS    AL4
FLTSTLEN DS    FL4
FLCOND   DS    CL1
FLFLG    DS    BL1
         ORG   FLFLG+0
FLACTIVE DS    BL1
         ORG   FL+18
@NM00137 DS    CL2
         ORG   LOCDES+420
LOCTYPE  DS    BL1
         ORG   LOCTYPE
NAME44   DS    BL1
NAME6    EQU   LOCTYPE+0
ID3      EQU   LOCTYPE+0
RETRY    EQU   LOCTYPE+0
UPD      EQU   LOCTYPE+0
VMT      EQU   LOCTYPE+0
PSWRD    EQU   LOCTYPE+0
         ORG   LOCDES+421
BITBANK  DS    BL1
         ORG   BITBANK
SW1      DS    BL1
SWPGSP   EQU   BITBANK+0
         ORG   BITBANK+1
         DS    CL2
CATCDF   DS    CL4
         ORG   CATCDF
@NM00143 DS    CL3
CATCODEF DS    FL1
         ORG   CATCDF+4
REGSAVE  DS    CL56
LOCPTR   DS    CL8
         ORG   LOCPTR
NVTPTR   DS    AL4
CVTPTR   DS    AL4
         ORG   LOCPTR+8
MNTPARM  DS    CL24
MAINLIST DS    3A
TEMPSR   DS    4A
IEAVNP1A CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ZERORBA  DC    H'4'
MNTERR   DC    H'8'
LOCERR   DC    H'12'
VOLERR   DC    H'16'
GETERR   DC    H'20'
PGSIZE   DC    H'4096'
DDEBLEN  DC    H'56'
SWKLEN   DC    H'1024'
EXSCALE  DC    BL1'00000100'
FMSKWR   DC    BL1'00010000'
@CC04010 DC    C'DSTYPNAM'
@CC04011 DC    C'CATACB  '
@CC04012 DC    C'NAMEDS  '
@CC04013 DC    C'CATTR   '
@CC04020 DC    C'OWNERID '
@CC04021 DC    C'DSATTR  '
@CC04022 DC    C'BUFSIZE '
@CC04023 DC    C'ENTNAME '
@CC04024 DC    C'AMDSBCAT'
@CC04025 DC    C'HURBADS '
@CC04029 DC    C'VOLDEV  '
@CC04030 DC    C'ITYPEXT '
@CC04031 DC    C'VOLPHY  '
@CC04098 DC    C'IOMB'
SSTEST   DC    X'80'
NULL     DC    X'000000000000'
PADKEYLO DC    X'00'
PADKEYHI DC    X'FF'
         DS    CL1
PATCH    DS    25A
@DATD    DSECT
PARMLIST EQU   @PC00001            PLS PARMATER LIST SAVE AREA
@DATD    DSECT
K4      EQU  4
O24     EQU  24
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVNP1A CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
AMBPT    EQU   @06
LENGLPMB EQU   @09
C2       EQU   @07
BUFSP    EQU   @03
REQIBUF  EQU   @09
REQDBUF  EQU   @07
REQBUFSP EQU   @04
CURBUFSP EQU   @02
WKBUF2   EQU   @02
WKBUF1   EQU   @03
BUFNO    EQU   @02
IOMBAD   EQU   @02
RDEBAD   EQU   @02
DDEBADR  EQU   @03
IX7      EQU   @09
IX5      EQU   @02
IX4      EQU   @03
IX3      EQU   @07
WKPT8    EQU   @07
WKPT7    EQU   @03
WORKPTR5 EQU   @02
LASTARDB EQU   @03
TEMPLKAR EQU   @02
ARDRBA   EQU   @02
HRBAFLG  EQU   @04
HRBAHOLD EQU   @02
HARDBAD  EQU   @03
LOKYARDB EQU   @09
PFPL     EQU   @02
LOKYAD   EQU   @04
RCCWN    EQU   @02
CATWKPTR EQU   @09
CWAPT    EQU   @05
CTGFLPTR EQU   @02
CTGPLPTR EQU   @06
IQEPTR   EQU   @03
CBSPTR   EQU   @01
TCBPTR   EQU   @01
DEBPTR   EQU   @01
DEBDAPTR EQU   @01
DEBEXPTR EQU   @01
DEBSBPTR EQU   @01
UCBPTR   EQU   @01
IOSBPTR  EQU   @01
SRBPTR   EQU   @01
ASCBPTR  EQU   @01
RNVT     EQU   @02
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R9       EQU   @09
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R15      EQU   @15
RET      EQU   @14
RETCODE  EQU   @15
RCVT     EQU   @03
RENTRY   EQU   @15
REXIT    EQU   @14
RPARM    EQU   @01
R12      EQU   @12
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
AMCBS    EQU   0
CBSACB   EQU   AMCBS+8
CBSCMP   EQU   AMCBS+16
CBSVSRT  EQU   AMCBS+32
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBUBF   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBSTRNO EQU   ACBCOMN+15
ACBBUFND EQU   ACBCOMN+16
ACBBUFNI EQU   ACBCOMN+18
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBDVIND EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBDEB   EQU   ACBDDNM+5
ACBOFLGS EQU   ACBCOMN+48
ACBOPEN  EQU   ACBOFLGS
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBVVIC  EQU   ACBINFLG
ACBUJFCB EQU   ACBCOMN+52
ACBBUFSP EQU   ACBCOMN+56
ACBBLKSZ EQU   ACBCOMN+60
IQESECT  EQU   0
IQELNK   EQU   IQESECT
IQEIRB   EQU   IQESECT+8
IQEFLAGS EQU   IQEIRB
IQETCB   EQU   IQESECT+12
IDAAMDSB EQU   0
AMDSBID  EQU   IDAAMDSB
AMDATTR  EQU   IDAAMDSB+1
AMDWCK   EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDLEN   EQU   IDAAMDSB+2
AMDNEST  EQU   IDAAMDSB+4
AMDKEYLN EQU   IDAAMDSB+8
AMDCIPCA EQU   IDAAMDSB+12
AMDCINV  EQU   IDAAMDSB+20
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDPARDB EQU   IDAAMDSB+36
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
AMBWORK  EQU   0
AMACATLG EQU   AMBWORK
AMALEN   EQU   AMBWORK+6
VOLENTNO EQU   AMBWORK+12
CTINFO   EQU   AMBWORK+14
CTATTRA  EQU   CTINFO
CTRELOP  EQU   CTATTRA
CTRDONLY EQU   CTATTRA
CTTOVFL  EQU   CTATTRA
CTATTRB  EQU   CTINFO+1
CTSHROP  EQU   CTINFO+2
CTSHARE  EQU   CTSHROP
CTSHRW   EQU   CTSHROP
CTSHRF   EQU   CTSHROP
CTHELP   EQU   CTSHROP
CTSDHELP EQU   CTSHROP
CTAUTH   EQU   CTINFO+3
CTBLKSZ  EQU   CTINFO+6
CTDEVTYP EQU   CTINFO+10
CTDEV2   EQU   CTDEVTYP+1
CTTRKAU  EQU   CTINFO+14
CTSTRKAU EQU   CTINFO+18
CTBLKTR  EQU   CTINFO+22
CTSBLKTR EQU   CTINFO+26
CTBYTAU  EQU   CTINFO+30
CTSBYTAU EQU   CTINFO+34
CTBYTTRK EQU   CTINFO+38
CTSBYTRK EQU   CTINFO+42
CTHSHDSN EQU   CTINFO+46
CTHSHCAT EQU   CTINFO+50
CTHURBA  EQU   CTINFO+54
CTBUFSIZ EQU   CTINFO+58
CTCISIZ  EQU   CTINFO+62
CTDATANM EQU   CTINFO+74
CTAMDSB  EQU   CTINFO+118
CTVOLENT EQU   0
CTVOLFLG EQU   CTVOLENT
CTNOEXT  EQU   CTVOLENT+1
CTVOLUCB EQU   CTVOLENT+4
CTNOKEY  EQU   CTVOLENT+8
CTKEYLEN EQU   CTVOLENT+10
CTVOLSER EQU   CTVOLENT+12
CTKEYENT EQU   0
CTKEYFLG EQU   CTKEYENT
CTSSWDTA EQU   CTKEYFLG
CTNOKEXT EQU   CTKEYENT+1
CTKRELNO EQU   CTKEYENT+2
CTKHKRBA EQU   CTKEYENT+4
CTKHURBA EQU   CTKEYENT+8
CTKHARBA EQU   CTKEYENT+12
CTKEY    EQU   CTKEYENT+16
CTEXTENT EQU   0
CTABSBEG EQU   CTEXTENT+2
CTCCBEG  EQU   CTABSBEG
CTHHBEG  EQU   CTABSBEG+2
CTABSEND EQU   CTEXTENT+6
CTRBABEG EQU   CTEXTENT+12
CTRBAEND EQU   CTEXTENT+16
CVTMAP   EQU   0
CVTZDTAB EQU   CVTMAP+64
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTBRET  EQU   CVTMAP+82
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVT0SCR1 EQU   CVTMAP+232
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTCBSP  EQU   CVTMAP+256
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBDSP   EQU   TCB+35
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBXSCT  EQU   TCB+240
TCBXSCT1 EQU   TCBXSCT
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBTCBB  EQU   DEBTCBAD+1
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBRLSE  EQU   DEBOFLGS
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBNMEXT EQU   DEBUSRPG
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBPRIOR EQU   DEBECBAD
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBDEBID EQU   DEBPROTG
DEBDCBB  EQU   DEBDCBAD+1
DEBAPPAD EQU   DEBBASIC+28
DEBEXSCL EQU   DEBAPPAD
DEBAPPB  EQU   DEBAPPAD+1
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBDVMOD EQU   DEBUCBAD
DEBUCBA  EQU   DEBUCBAD+1
DEBSTRCC EQU   DEBDASD+6
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBEOEAD EQU   DEBEOEA+1
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBCEAD  EQU   DEBCEA+1
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBXCEAD EQU   DEBXCEA+1
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBLNGTH EQU   DEBPREFX+12
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
IDAEDBHD EQU   0
EDBID    EQU   IDAEDBHD
EDBNO    EQU   IDAEDBHD+1
EDBLEN   EQU   IDAEDBHD+2
EDBLPMBC EQU   IDAEDBHD+4
IDAEDB   EQU   0
EDBFLG1  EQU   IDAEDB+2
EDBM     EQU   IDAEDB+3
EDBLPMBA EQU   IDAEDB+4
EDBSTTRK EQU   IDAEDB+8
EDBLORBA EQU   IDAEDB+12
EDBHIRBA EQU   IDAEDB+16
IDAPLHDR EQU   0
PLHID    EQU   IDAPLHDR
PLHCNT   EQU   IDAPLHDR+1
PLHELTH  EQU   IDAPLHDR+2
IDAPLH   EQU   0
PLHFLG1  EQU   IDAPLH+2
PLHFLG2  EQU   IDAPLH+3
PLHEFLGS EQU   IDAPLH+4
PLH1ST   EQU   PLHEFLGS
PLHFLG3  EQU   IDAPLH+6
PLHAFLGS EQU   IDAPLH+7
PLHACB   EQU   IDAPLH+8
PLHRMIN  EQU   IDAPLH+13
PLHFRCNT EQU   IDAPLH+14
PLHBFRNO EQU   IDAPLH+15
PLHDSIDA EQU   IDAPLH+24
PLHCRBA  EQU   IDAPLH+28
PLHJORBA EQU   PLHCRBA
PLHJRNLL EQU   IDAPLH+32
PLHJCODE EQU   IDAPLH+40
PLHARDB  EQU   IDAPLH+44
PLHDBUFC EQU   IDAPLH+52
PLHNBUFC EQU   IDAPLH+56
PLHDIOB  EQU   IDAPLH+76
PLHEOVPT EQU   IDAPLH+180
PLHIBUFC EQU   IDAPLH+188
PLHIXSPL EQU   IDAPLH+200
PLHSSRBA EQU   PLHIXSPL
PLHWAX   EQU   IDAPLH+232
PLHKEYPT EQU   IDAPLH+248
PLHEND   EQU   IDAPLH+280
IDAARDB  EQU   0
ARDID    EQU   IDAARDB
ARDTYPE  EQU   IDAARDB+1
ARDKR    EQU   ARDTYPE
ARDHLI   EQU   ARDTYPE
ARDSS    EQU   ARDTYPE
ARDEOD   EQU   ARDTYPE
ARDLEN   EQU   IDAARDB+2
ARDNPTR  EQU   IDAARDB+4
ARDHKRBA EQU   IDAARDB+8
ARDHRBA  EQU   IDAARDB+12
ARDERBA  EQU   IDAARDB+16
ARDVOLSR EQU   IDAARDB+20
ARDRELNO EQU   IDAARDB+26
ARDPRF   EQU   IDAARDB+28
ARDKEYS  EQU   IDAARDB+29
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00057 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
IDABUFDR EQU   0
BUFDRID  EQU   IDABUFDR
BUFDRNO  EQU   IDABUFDR+1
BUFDRLEN EQU   IDABUFDR+2
BUFDRCIX EQU   IDABUFDR+9
BUFDRMAX EQU   BUFDRCIX
BUFDRFLG EQU   IDABUFDR+11
BUFDRAVL EQU   BUFDRFLG
IDABUFC  EQU   0
BUFCAVL  EQU   IDABUFC
BUFCFLG1 EQU   IDABUFC+1
BUFCEPT  EQU   BUFCFLG1
BUFCIOFL EQU   IDABUFC+2
BUFCWC   EQU   BUFCIOFL
BUFCFIX  EQU   BUFCIOFL
BUFCFLG2 EQU   IDABUFC+3
BUFCPLH  EQU   IDABUFC+4
BUFCCPA  EQU   IDABUFC+16
BUFCBAD  EQU   IDABUFC+20
BUFCNXT1 EQU   IDABUFC+24
BUFCINV  EQU   IDABUFC+28
IDAAMB   EQU   0
AMBID    EQU   IDAAMB
AMBLEN   EQU   IDAAMB+2
AMBLINK  EQU   IDAAMB+4
AMBBUFC  EQU   IDAAMB+8
AMBPH    EQU   IDAAMB+12
AMBCACB  EQU   IDAAMB+16
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBPSDS  EQU   AMBFLG0
AMBFLG1  EQU   IDAAMB+25
AMBTYPE  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBDSORG EQU   IDAAMB+26
AMBDORGA EQU   AMBDSORG+1
AMBIOBAD EQU   IDAAMB+28
AMBIOMB  EQU   AMBIOBAD
AMBCDSN  EQU   IDAAMB+32
AMBDDSN  EQU   IDAAMB+35
AMBINFL  EQU   IDAAMB+42
AMBAMETH EQU   IDAAMB+43
AMBDEBPT EQU   IDAAMB+44
AMBDEBAD EQU   AMBDEBPT+1
AMBOFLGS EQU   IDAAMB+48
AMBEXFG  EQU   AMBOFLGS
AMBFLG2  EQU   IDAAMB+49
AMBEDB   EQU   IDAAMB+52
AMBEOVPT EQU   IDAAMB+56
AMBWKA   EQU   IDAAMB+60
AMBIWA   EQU   IDAAMB+64
AMBPIXP  EQU   IDAAMB+72
AMBPAMBL EQU   IDAAMB+76
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
AMBCPA   EQU   IDAAMB+92
IDAAMBL  EQU   0
AMBLACB  EQU   IDAAMBL+8
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLFIX  EQU   AMBLTYPE
AMBLID   EQU   IDAAMBL+32
AMBLSHAR EQU   IDAAMBL+33
AMBLWRIT EQU   AMBLSHAR
AMBLLEN  EQU   IDAAMBL+34
AMBLFLG1 EQU   IDAAMBL+35
AMBLVVIC EQU   AMBLFLG1
AMBLCAT  EQU   AMBLFLG1
AMBLFLG2 EQU   IDAAMBL+36
AMBLNST  EQU   IDAAMBL+37
AMBLNUM  EQU   IDAAMBL+38
AMBLDTA  EQU   IDAAMBL+52
AMBLIX   EQU   IDAAMBL+56
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGBYPSS EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDCD EQU   CTGFL+1
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLCHN EQU   CTGFL+12
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
IDACPA   EQU   0
CPAID    EQU   IDACPA
CPALEN   EQU   IDACPA+2
CPAWREAL EQU   IDACPA+4
CPAWCPS  EQU   IDACPA+8
CPAWCPE  EQU   IDACPA+12
CPAWCKS  EQU   IDACPA+16
CPAWCKE  EQU   IDACPA+20
CPARREAL EQU   IDACPA+24
CPARCPS  EQU   IDACPA+28
CPARCPE  EQU   IDACPA+32
CPAWPHAD EQU   IDACPA+36
CPAWSEEK EQU   CPAWPHAD+1
CPAWSID  EQU   IDACPA+44
CPARPHAD EQU   IDACPA+52
CPARSEEK EQU   CPARPHAD+1
CPARSID  EQU   CPARSEEK+2
CPAIDAL  EQU   IDACPA+60
CPAVPL   EQU   IDACPA+64
CPABCINV EQU   IDACPA+80
CPASTAT1 EQU   IDACPA+83
CPAVPLV  EQU   CPASTAT1
CPAFLAGS EQU   IDACPA+84
CPAFLAG1 EQU   CPAFLAGS
CPAFLAG2 EQU   CPAFLAGS+1
CPARSECT EQU   IDACPA+86
CPAWSECT EQU   IDACPA+87
CPANXT1  EQU   IDACPA+88
CPACPCHN EQU   IDACPA+92
CPACCW   EQU   0
IDALPMB  EQU   0
LPMBID   EQU   IDALPMB
LPMBFLGS EQU   IDALPMB+1
LPMBRPS  EQU   LPMBFLGS
LPMREPL  EQU   LPMBFLGS
LPMSS    EQU   LPMBFLGS
LPMBTOFL EQU   LPMBFLGS
LPMBSSTH EQU   LPMBFLGS
LPMBLEN  EQU   IDALPMB+2
LPMAUSZ  EQU   IDALPMB+4
LPMBPTRK EQU   IDALPMB+8
LPMBLKSZ EQU   IDALPMB+12
LPMTRKAU EQU   IDALPMB+16
LPMTPC   EQU   IDALPMB+18
LPMBLKTR EQU   IDALPMB+20
LPMBSST  EQU   IDALPMB+28
IDADIWA  EQU   0
DIWID    EQU   IDADIWA
DIWLEN   EQU   IDADIWA+2
DIWFLG1  EQU   IDADIWA+4
DIWCISPL EQU   DIWFLG1
DIWFLG2  EQU   IDADIWA+5
DIWBUFC  EQU   IDADIWA+20
DIWSAVE  EQU   IDADIWA+28
IDAIMWA  EQU   0
IMWID    EQU   IDAIMWA
IMWFLAGS EQU   IDAIMWA+1
IMWLEN   EQU   IDAIMWA+2
IDAICWA  EQU   0
ICWID    EQU   IDAICWA
ICWFLG1  EQU   IDAICWA+1
ICWLEN   EQU   IDAICWA+2
ICWCHN   EQU   IDAICWA+4
NWTOHDR  EQU   0
NWTOFL   EQU   NWTOHDR+2
NWTORLST EQU   0
NWTORFL  EQU   NWTORLST+10
NIPSPE   EQU   0
NIPMNTPL EQU   0
NMNTDS   EQU   NIPMNTPL
NMNTDSA  EQU   NMNTDS
NMNTVS   EQU   NIPMNTPL+12
NMNTFL   EQU   NIPMNTPL+20
NIPOPNPL EQU   0
NOPNDS   EQU   NIPOPNPL
NOPNFL   EQU   NIPOPNPL+20
NIPSCHDL EQU   0
IOSB     EQU   0
IOSFLA   EQU   IOSB
IOSACHN  EQU   IOSFLA
IOSFLB   EQU   IOSB+1
IOSFLC   EQU   IOSB+2
IOSDVALT EQU   IOSFLC
IOSDVRID EQU   IOSB+4
IOSASID  EQU   IOSB+6
IOSPKEY  EQU   IOSB+12
IOSOPT   EQU   IOSB+14
IOSOPT2  EQU   IOSB+15
@NM00105 EQU   IOSB+20
IOSCSW   EQU   @NM00105+1
IOSTATUS EQU   IOSCSW+3
IOSSRB   EQU   IOSB+28
IOSUSE   EQU   IOSB+32
IOSIPIB  EQU   IOSB+44
IOSNRM   EQU   IOSB+60
IOSABN   EQU   IOSB+64
IOSDIE   EQU   IOSB+68
IOSDIEFG EQU   IOSDIE
IOSPATH  EQU   IOSB+86
IOSCHN   EQU   IOSPATH
IOSFMSK  EQU   IOSB+88
IOSCKEY  EQU   IOSB+89
IOSEEKA  EQU   IOSB+100
IOSCCHH  EQU   IOSEEKA+3
IOSSKHH  EQU   IOSCCHH+2
IDAIOMB  EQU   0
IOMBID   EQU   IDAIOMB
IOMPLH   EQU   IDAIOMB+12
IOMAMB   EQU   IDAIOMB+16
IOMIQE   EQU   IDAIOMB+20
IOMECBPT EQU   IDAIOMB+24
IOMVSL   EQU   IDAIOMB+28
IOMIOSB  EQU   IDAIOMB+36
IOMFLAGS EQU   IDAIOMB+40
IOMFL    EQU   IOMFLAGS
IOMAPEND EQU   IOMFL
IOMSTIND EQU   IOMFLAGS+2
IOMSAVER EQU   IDAIOMB+52
IOMNXT1  EQU   IDAIOMB+116
IOMUFLD  EQU   IDAIOMB+120
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBASCB  EQU   SRB+8
SRBFLC   EQU   SRB+12
SRBEP    EQU   SRB+20
SRBPARM  EQU   SRB+28
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBASID EQU   ASCB+36
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
IEZABP   EQU   0
ABPABP   EQU   IEZABP+8
ABPNE    EQU   IEZABP+12
ABPAE    EQU   IEZABP+16
NVT      EQU   0
NVTNPATR EQU   NVT+54
NVTNPREN EQU   NVTNPATR
NVTFLLB  EQU   NVT+55
NVTMSTCB EQU   NVT+56
NVTMASCB EQU   NVT+64
NVTABSAV EQU   NVT+140
NVTFLCN  EQU   NVT+211
NVTWTPSW EQU   NVT+224
NVTWPSW2 EQU   NVTWTPSW+4
NVTFLWSC EQU   NVTWPSW2+3
NVTLOAD  EQU   NVT+232
NVTSENSE EQU   NVT+236
NVTSWAIT EQU   NVT+240
NVTTIME  EQU   NVT+244
NVTUCBFN EQU   NVT+248
NVTWTO   EQU   NVT+252
NVTWTOR  EQU   NVT+256
NVTWTOR2 EQU   NVT+260
NVTOPEN  EQU   NVT+264
NVTMOUNT EQU   NVT+268
NVTVIRT  EQU   NVT+276
NVTREAL  EQU   NVT+280
NVTSCHED EQU   NVT+284
NVTOPIO  EQU   NVT+288
NVTXCTL  EQU   NVT+428
NVTLOCAT EQU   NVT+436
NVTFLPO  EQU   NVT+528
@NM00133 EQU   0
NIPPOOL  EQU   @NM00133
DSNSIZE  EQU   @NM00133+1
DSN      EQU   @NM00133+2
COREBLK  EQU   0
CORELAST EQU   COREBLK
CORENBR  EQU   COREBLK+4
COREDESC EQU   COREBLK+8
COREBKPL EQU   COREDESC
CORESIZE EQU   COREDESC+1
COREENT  EQU   COREBLK+12
COREPTR  EQU   COREENT
CORER0   EQU   COREENT+4
COREPOOL EQU   CORER0
CORELNTH EQU   CORER0+1
CCW      EQU   0
CCWCODE  EQU   CCW
CCWAREA  EQU   CCW+1
CCWFLGS  EQU   CCW+4
CCWCC    EQU   CCWFLGS
CCWSLI   EQU   CCWFLGS
CCWST    EQU   CCWFLGS
CCWIDAL  EQU   CCWFLGS
CCWLEN   EQU   CCW+6
SEARCHID EQU   0
VPLENT   EQU   0
LOKY     EQU   0
BUFSIZE  EQU   0
AMDSBCAT EQU   0
HURBADS  EQU   0
DSTYPNAM EQU   0
ENTYPE   EQU   DSTYPNAM
ENTIDNO  EQU   DSTYPNAM+1
CATACB   EQU   0
NAMEDS   EQU   0
TYPE     EQU   NAMEDS
NAME     EQU   NAMEDS+1
ENTNAME  EQU   0
VOLDEV   EQU   0
DEVTYP   EQU   VOLDEV
PHYBLKSZ EQU   VOLDEV+4
NOBLKTRK EQU   VOLDEV+8
NOTRKAU  EQU   VOLDEV+10
NOBYTTRK EQU   VOLDEV+12
NOBYTAU  EQU   VOLDEV+16
VOLPHY   EQU   0
RREPNO   EQU   VOLPHY
VOLSER   EQU   VOLPHY+2
VOLFLG   EQU   VOLPHY+8
HRBAS    EQU   VOLPHY+10
HKRBA    EQU   HRBAS
HURBA    EQU   HRBAS+4
HARBA    EQU   HRBAS+8
ITYPEXT  EQU   VOLPHY+22
SSW      EQU   ITYPEXT
LL1      EQU   VOLPHY+23
LOKEYV   EQU   VOLPHY+25
LL2X     EQU   0
LL2      EQU   LL2X
HIKEYV   EQU   LL2X+2
LL3X     EQU   0
LL3      EQU   LL3X
EXTENT   EQU   LL3X+2
DSATTR   EQU   0
DSATTR1  EQU   DSATTR
DSATTR2  EQU   DSATTR+1
CROSSREG EQU   DSATTR2
CROSSSYS EQU   DSATTR2
CATTR    EQU   0
PGSPFLG  EQU   CATTR
CATWORK  EQU   0
WORKLEN  EQU   CATWORK
REQLEN   EQU   CATWORK+2
DEVTABOF EQU   0
DEVTAB   EQU   0
DEVTABTC EQU   DEVTAB+2
ICWKEY2  EQU   0
ICWKEY3  EQU   0
IQEEND   EQU   0
LRECL    EQU   0
OWNERID  EQU   0
PLHKEY   EQU   0
UCBBGN   EQU   0
ACBPTR   EQU   PARMLIST
NOCATLG  EQU   ACBPTR
DWKPTR   EQU   PARMLIST+4
IWKPTR   EQU   PARMLIST+8
ACBX     EQU   0
DAMBWKX  EQU   0
IAMBWKX  EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTIOBP  EQU   CVTS01+360
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
PLHEXTEN EQU   PLHEND
PLHBMWRK EQU   PLHEXTEN+5
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00056 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
@NM00085 EQU   CTGDDNM
CTGPROB  EQU   @NM00085
CTGREASN EQU   CTGPROB+2
IOSATTSC EQU   IOSIPIB
IOSWTOWA EQU   IOSIPIB
IOSPCISC EQU   IOSIPIB
NIPSPPTR EQU   ACBDDNM
WAPT     EQU   TCATWDS
BUFCRSC1 EQU   BUFCAVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOSPCIWA EQU   IOSPCISC+44
IOSPCIRS EQU   IOSPCISC+8
@NM00110 EQU   IOSPCISC+4
@NM00109 EQU   IOSPCISC
IOSWRNDR EQU   IOSWTOWA+4
IOSWTOPT EQU   IOSWTOWA+3
IOSWTOCP EQU   IOSWTOWA+2
IOSWTOCH EQU   IOSWTOWA
IOSATTWA EQU   IOSATTSC+40
@NM00108 EQU   IOSATTSC+24
IOSATTSN EQU   IOSATTSC
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00056
UCBSKPFG EQU   @NM00056
UCBRIPND EQU   @NM00056
UCBRTIAC EQU   @NM00056
UCBRSV79 EQU   @NM00056
UCBRSV78 EQU   @NM00056
UCBRSV77 EQU   @NM00056
UCBOLTEP EQU   @NM00056
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00055 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
PLHBMSV5 EQU   PLHEXTEN+24
PLHBMSV4 EQU   PLHEXTEN+20
PLHBMSV3 EQU   PLHEXTEN+16
PLHBMSV2 EQU   PLHEXTEN+12
PLHBMSV1 EQU   PLHEXTEN+8
PLHRDCNT EQU   PLHEXTEN+6
PLHBMSOV EQU   PLHBMWRK
PLHBEUC  EQU   PLHBMWRK
PLHBMRDF EQU   PLHBMWRK
@NM00052 EQU   PLHEXTEN+4
PLHRESR1 EQU   PLHEXTEN
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00144 EQU   DEVTAB
@NM00142 EQU   CATTR
@NM00141 EQU   DSATTR2
TRKOVF   EQU   DSATTR1
@NM00140 EQU   DSATTR1
@NM00139 EQU   EXTENT+20
RBAEXT   EQU   EXTENT+12
ABSOLUTE EQU   EXTENT+2
DSSN     EQU   EXTENT
PFRM     EQU   ITYPEXT
NOEXTNT  EQU   VOLPHY+9
OVERFLOW EQU   VOLFLG
CANDIDAT EQU   VOLFLG
PRIME    EQU   VOLFLG
@NM00138 EQU   CCW+5
CCWPCI   EQU   CCWFLGS
CCWDC    EQU   CCWFLGS
@NM00136 EQU   COREBLK+92
@NM00135 EQU   COREBLK+6
NVTLPAHA EQU   NVT+548
NVTLPALO EQU   NVT+544
NVTRMSG  EQU   NVT+540
NVTRLOCK EQU   NVT+536
NVTRCODE EQU   NVT+532
@NM00132 EQU   NVT+529
@NM00131 EQU   NVTFLPO
NVTFLWS  EQU   NVTFLPO
NVTFLQS  EQU   NVTFLPO
@NM00130 EQU   NVTFLPO
NVTSYSP  EQU   NVTFLPO
NVTFLLST EQU   NVTFLPO
NVTRSV48 EQU   NVT+524
NVTRSV47 EQU   NVT+520
NVTRSV46 EQU   NVT+516
@NM00129 EQU   NVT+512
NVTREALR EQU   NVT+508
NVTFASVT EQU   NVT+504
NVTRSV45 EQU   NVT+496
NVTVRLNG EQU   NVT+492
NVTVRREG EQU   NVT+488
NVTLVIRT EQU   NVT+484
NVTRSV4A EQU   NVT+480
NVTLPAND EQU   NVT+476
NVTRMSS  EQU   NVT+472
NVTRPQE  EQU   NVT+468
NVTRLLE  EQU   NVT+464
NVTRJPQ  EQU   NVT+460
NVTVMSS  EQU   NVT+456
NVTVPQE  EQU   NVT+452
NVTVLLE  EQU   NVT+448
NVTVJPQ  EQU   NVT+444
NVTLSEC  EQU   NVTLOCAT+4
NVTLFST  EQU   NVTLOCAT
NVTXSEC  EQU   NVTXCTL+4
NVTXFST  EQU   NVTXCTL
@NM00128 EQU   NVT+425
NVTLPACT EQU   NVT+424
NVTCSLPG EQU   NVT+420
NVTCSIOB EQU   NVT+416
NVTCSLNM EQU   NVT+412
NVTCSLIB EQU   NVT+408
NVTBLDL  EQU   NVT+404
NVTVRBLD EQU   NVT+400
@NM00127 EQU   NVT+392
NVTVRTCB EQU   NVT+388
NVTVVTCB EQU   NVT+384
NVTSPUCB EQU   NVT+382
NVTRSV44 EQU   NVT+380
NVTQSBUF EQU   NVT+376
NVTPTAB  EQU   NVT+372
NVTPAREA EQU   NVT+368
NVTRSV43 EQU   NVT+364
@NM00126 EQU   NVT+363
NVTABWS1 EQU   NVT+362
NVTABCD1 EQU   NVT+360
@NM00125 EQU   NVT+358
NVTCPUAD EQU   NVT+356
NVTTOD   EQU   NVT+352
NVTSPE   EQU   NVT+344
NVTMBEND EQU   NVT+340
NVTMBUF  EQU   NVT+336
NVTDCBSN EQU   NVT+332
NVTDCBOC EQU   NVT+328
NVTDCBIC EQU   NVT+324
@NM00124 EQU   NVT+308
NVTNMBLD EQU   NVT+304
NVTNIPM  EQU   NVT+292
NVTPRMPT EQU   NVT+272
NVTIX    EQU   NVTFLWSC
NVTFLWS1 EQU   NVTWPSW2+2
NVTIDPSW EQU   NVTWPSW2
NVTWPSW1 EQU   NVTWTPSW
NVTMCPSW EQU   NVT+216
@NM00123 EQU   NVT+212
@NM00122 EQU   NVTFLCN
NVTFLRAC EQU   NVTFLCN
NVTFLNCK EQU   NVTFLCN
NVTFLNHC EQU   NVTFLCN
NVTFLASM EQU   NVTFLCN
NVTMP    EQU   NVTFLCN
NVTFLIOC EQU   NVTFLCN
NVTFLAC  EQU   NVTFLCN
NVTFLSG  EQU   NVT+210
NVTTRACE EQU   NVT+208
NVTNXPTR EQU   NVT+204
NVTNXSIZ EQU   NVT+202
@NM00121 EQU   NVT+200
NVTSGPSA EQU   NVT+196
NVTN0MSG EQU   NVT+192
NVTVVPG1 EQU   NVT+188
NVTNBFND EQU   NVT+184
NVTNUCND EQU   NVT+180
NVTSTMAP EQU   NVT+176
NVTRTMSA EQU   NVT+172
NVTMFASA EQU   NVT+168
NVTLSPQE EQU   NVT+164
NVTALSQA EQU   NVT+160
NVTPQSAV EQU   NVT+156
NVTSVC60 EQU   NVT+148
NVTABSEC EQU   NVTABSAV+4
NVTABFST EQU   NVTABSAV
NVTNVSQA EQU   NVT+138
NVTRSVMN EQU   NVT+136
NVTNBMIN EQU   NVT+134
NVTRGNAV EQU   NVT+132
NVTLSQNO EQU   NVT+130
NVTSQANO EQU   NVT+128
NVTLSQAS EQU   NVT+124
NVTLNGFX EQU   NVT+120
NVTIGXER EQU   NVT+116
@NM00120 EQU   NVT+112
NVTRSV49 EQU   NVT+108
NVTNVRSZ EQU   NVT+104
NVTMFA   EQU   NVT+100
NVTDSSNG EQU   NVT+96
NVTMSLNK EQU   NVT+92
NVTVVMDI EQU   NVT+88
NVTIGCER EQU   NVT+84
NVTVBLDL EQU   NVT+80
NVTSVCTB EQU   NVT+76
NVTRSV42 EQU   NVT+72
NVTRSV41 EQU   NVT+68
NVTCMTCB EQU   NVT+60
@NM00119 EQU   NVTFLLB
NVTFLSLB EQU   NVTFLLB
@NM00118 EQU   NVTNPATR
NVTNPREU EQU   NVTNPREN
@NM00117 EQU   NVTNPREN
NVTNPSFX EQU   NVT+53
@NM00116 EQU   NVT+52
NVTNPSUF EQU   NVT
ABPSIOD  EQU   IEZABP+4
ABPBR14  EQU   IEZABP+2
ABPLEN   EQU   IEZABP+1
ABPID    EQU   IEZABP
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
@NM00115 EQU   SRB+40
@NM00114 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBRMTR  EQU   SRB+24
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBFLNK  EQU   SRB+4
SRBID    EQU   SRB
IOMSTCB  EQU   IDAIOMB+128
IOMSRBP  EQU   IDAIOMB+124
IOMSAVEF EQU   IOMSAVER+60
IOMSAVEE EQU   IOMSAVER+56
IOMSAVED EQU   IOMSAVER+52
IOMSAVEC EQU   IOMSAVER+48
IOMSAVEB EQU   IOMSAVER+44
IOMSAVEA EQU   IOMSAVER+40
IOMSAVE9 EQU   IOMSAVER+36
IOMSAVE8 EQU   IOMSAVER+32
IOMSAVE7 EQU   IOMSAVER+28
IOMSAVE6 EQU   IOMSAVER+24
IOMSAVE5 EQU   IOMSAVER+20
IOMSAVE4 EQU   IOMSAVER+16
IOMSAVE3 EQU   IOMSAVER+12
IOMSAVE2 EQU   IOMSAVER+8
IOMSAVE1 EQU   IOMSAVER+4
IOMSAVE0 EQU   IOMSAVER
IOMNSEG  EQU   IDAIOMB+50
IOMNBUF  EQU   IDAIOMB+48
IOMNMOD  EQU   IDAIOMB+46
IOMLOCK  EQU   IDAIOMB+45
IOMPFERR EQU   IDAIOMB+44
IOMCKEY  EQU   IDAIOMB+43
IOMSR    EQU   IOMSTIND
IOMSRBM  EQU   IOMSTIND
IOMSLOC  EQU   IOMSTIND
IOMLLOCK EQU   IOMSTIND
IOMEOVXC EQU   IOMSTIND
IOMEOVTS EQU   IOMSTIND
IOMEOVW  EQU   IOMSTIND
IOMAMUSE EQU   IOMSTIND
@NM00113 EQU   IOMFL+1
IOMIRBSW EQU   IOMFL+1
IOMEEXIT EQU   IOMFL+1
@NM00112 EQU   IOMFL+1
IOMCPRB  EQU   IOMFL+1
IOMDDR   EQU   IOMFL+1
IOMCSW   EQU   IOMFL
IOMPGFIX EQU   IOMFL
IOMADERR EQU   IOMFL
IOMCBERR EQU   IOMFL
@NM00111 EQU   IOMFL
IOMPURGE EQU   IOMFL
IOMAE    EQU   IOMAPEND
IOMNE    EQU   IOMAPEND
IOMPGAD  EQU   IDAIOMB+32
IOMCPA   EQU   IDAIOMB+8
IOMBUFC  EQU   IDAIOMB+4
IOSEND   EQU   IOSB+108
IOSSKR   EQU   IOSEEKA+7
IOSSKH2  EQU   IOSSKHH+1
IOSSKH1  EQU   IOSSKHH
IOSSKCC  EQU   IOSCCHH
IOSSKBB  EQU   IOSEEKA+1
IOSSKM   EQU   IOSEEKA
IOSEEK   EQU   IOSB+92
IOSMDM   EQU   IOSB+91
IOSMDB   EQU   IOSB+90
IOSCKEY7 EQU   IOSCKEY
IOSCKEY6 EQU   IOSCKEY
IOSCKEY5 EQU   IOSCKEY
IOSCKEY4 EQU   IOSCKEY
@NM00107 EQU   IOSCKEY
IOSCUDEV EQU   IOSPATH+1
@NM00106 EQU   IOSCHN
IOSPATH3 EQU   IOSCHN
IOSPATH2 EQU   IOSCHN
IOSEXP   EQU   IOSCHN
IOSGDP   EQU   IOSCHN
IOSAFF   EQU   IOSB+85
IOSRSS1B EQU   IOSB+84
IOSDSID  EQU   IOSB+80
IOSVST   EQU   IOSB+76
IOSRST   EQU   IOSB+72
IOSNOTRS EQU   IOSDIEFG
IOSPCI   EQU   IOSB+56
IOSERP   EQU   IOSB+52
IOSPCHN  EQU   IOSB+48
IOSSNS   EQU   IOSB+42
IOSAPMSK EQU   IOSB+40
IOSRES4A EQU   IOSB+36
IOSCSWRC EQU   IOSCSW+5
IOSTSB   EQU   IOSTATUS+1
IOSTSA   EQU   IOSTATUS
IOSCSWCA EQU   IOSCSW
IOSCC    EQU   @NM00105
IOSUCB   EQU   IOSB+16
IOSOPT2X EQU   IOSOPT2
IOSHTP   EQU   IOSOPT2
IOSRELSE EQU   IOSOPT
IOSAPR   EQU   IOSOPT
IOSTSLL  EQU   IOSOPT
IOSNERP  EQU   IOSOPT
IOSPSLL  EQU   IOSOPT
IOSQISCE EQU   IOSOPT
IOSDEP   EQU   IOSOPT
IOSBYP   EQU   IOSOPT
IOSCOD   EQU   IOSB+13
IOSPKY7  EQU   IOSPKEY
IOSPGDPX EQU   IOSPKEY
IOSIDR   EQU   IOSPKEY
IOSLCL   EQU   IOSPKEY
@NM00104 EQU   IOSPKEY
IOSPGAD  EQU   IOSB+8
IOSPRLVL EQU   IOSB+5
IOSPROC  EQU   IOSB+3
IOSFLC7  EQU   IOSFLC
IOSCTCNR EQU   IOSFLC
IOSRWAIT EQU   IOSFLC
IOSTP    EQU   IOSFLC
IOSCC3WE EQU   IOSFLC
IOSVERIF EQU   IOSDVALT
IOSDVMNT EQU   IOSFLC
IOSLOG   EQU   IOSFLB
IOSBDCST EQU   IOSFLB
IOSMSG   EQU   IOSFLB
IOSFLB4  EQU   IOSFLB
IOSFLB3  EQU   IOSFLB
IOSFLB2  EQU   IOSFLB
IOSSDR   EQU   IOSFLB
IOSDIESE EQU   IOSFLB
IOSIOSB  EQU   IOSFLA
IOSDOM   EQU   IOSFLA
IOSEX    EQU   IOSFLA
IOSSMDB  EQU   IOSFLA
IOSSMDA  EQU   IOSFLA
IOSERR   EQU   IOSFLA
IOSCCHN  EQU   IOSACHN
IOSDCHN  EQU   IOSACHN
NSCHDCPU EQU   NIPSCHDL+8
NSCHDPRM EQU   NIPSCHDL+4
NSCHDPTR EQU   NIPSCHDL
@NM00103 EQU   NIPOPNPL+22
NOPNRC   EQU   NIPOPNPL+21
NOPNFLSX EQU   NOPNFL
NOPNFLLC EQU   NOPNFL
NOPNFLLB EQU   NOPNFL
NOPNFLNB EQU   NOPNFL
NOPNFLI  EQU   NOPNFL
NOPNFLM  EQU   NOPNFL
NOPNFAU  EQU   NOPNFL
NOPNFRS  EQU   NOPNFL
NOPNUCB  EQU   NIPOPNPL+16
NOPNDCB  EQU   NIPOPNPL+12
NOPNDSA  EQU   NOPNDS
@NM00102 EQU   NIPMNTPL+21
NMNTFLB  EQU   NMNTFL
NMNTFLC  EQU   NMNTFL
NMNTFLI  EQU   NMNTFL
NMNTFUS  EQU   NMNTFL
@NM00101 EQU   NMNTFL
NMNTDT   EQU   NIPMNTPL+18
NMNTUCB  EQU   NMNTVS
NIPSPEA  EQU   NIPSPE+4
NIPSPEQ  EQU   NIPSPE
NWTORMSG EQU   NWTORLST+12
@NM00100 EQU   NWTORLST+11
@NM00099 EQU   NWTORFL
NWTORFLB EQU   NWTORFL
@NM00098 EQU   NWTORFL
NWTORFLA EQU   NWTORFL
NMTORRDL EQU   NWTORLST+8
NWTORECB EQU   NWTORLST+4
NWTORRPA EQU   NWTORLST
@NM00097 EQU   NWTOFL
NWTOFLNC EQU   NWTOFL
NWTOFLNH EQU   NWTOFL
NWTOLNG  EQU   NWTOHDR
ICWKEY1  EQU   IDAICWA+60
ICWCERP  EQU   IDAICWA+59
ICWCEL   EQU   IDAICWA+58
ICWCEF   EQU   IDAICWA+57
ICWCER   EQU   IDAICWA+56
ICWPTL   EQU   IDAICWA+55
ICWREQ   EQU   IDAICWA+54
ICWCRSEG EQU   IDAICWA+52
ICWNOSEG EQU   IDAICWA+50
ICWNEST  EQU   IDAICWA+48
ICWKEY3L EQU   IDAICWA+46
ICWKEY2L EQU   IDAICWA+44
ICWKEY1L EQU   IDAICWA+42
ICWLN    EQU   IDAICWA+40
ICWARDBP EQU   IDAICWA+36
ICWTPTR  EQU   IDAICWA+32
ICWTBASE EQU   IDAICWA+28
ICWADD   EQU   IDAICWA+24
ICWSCNT  EQU   IDAICWA+22
ICWPSEO  EQU   IDAICWA+20
ICWPRBA  EQU   IDAICWA+16
ICWCRBA  EQU   IDAICWA+12
ICWBUFC  EQU   IDAICWA+8
ICWENDRQ EQU   ICWFLG1
ICWSPLIT EQU   ICWFLG1
ICWKRDS  EQU   ICWFLG1
ICWVNE   EQU   ICWFLG1
ICWVSE   EQU   ICWFLG1
ICWRBAOK EQU   ICWFLG1
ICWWAGM  EQU   ICWFLG1
ICWWNF   EQU   ICWFLG1
IMWKEY1  EQU   IDAIMWA+76
@NM00096 EQU   IDAIMWA+72
IMWNSOFF EQU   IDAIMWA+70
IMWCIMVN EQU   IDAIMWA+68
@NM00095 EQU   IDAIMWA+67
IMWSVIEL EQU   IDAIMWA+66
IMWIEL   EQU   IDAIMWA+65
IMWFGAIN EQU   IDAIMWA+64
IMWBUFP  EQU   IDAIMWA+60
IMWLBUFC EQU   IDAIMWA+56
IMWIPTR  EQU   IDAIMWA+52
IMWXPTR  EQU   IDAIMWA+48
IMWIKEYP EQU   IDAIMWA+44
IMWXKEYP EQU   IDAIMWA+40
IMWISWKA EQU   IDAIMWA+8
IMWIXSP  EQU   IDAIMWA+4
IMWBSE   EQU   IMWFLAGS
IMWRIPL  EQU   IMWFLAGS
IMWNEWHL EQU   IMWFLAGS
DIWSAVE5 EQU   DIWSAVE+16
DIWSAVE4 EQU   DIWSAVE+12
DIWSAVE3 EQU   DIWSAVE+8
DIWSAVE2 EQU   DIWSAVE+4
DIWSAVE1 EQU   DIWSAVE
DIWSPLTP EQU   IDADIWA+24
DIWPLH   EQU   IDADIWA+16
DIWHRBA  EQU   IDADIWA+12
DIWLRBA  EQU   IDADIWA+8
@NM00094 EQU   IDADIWA+6
DIWFSPF  EQU   DIWFLG2
DIW1ST   EQU   DIWFLG1
DIWNOT1  EQU   DIWFLG1
DIWSHIFT EQU   DIWFLG1
DIWGSPC  EQU   DIWFLG1
DIWEOKR  EQU   DIWFLG1
DIWPFERR EQU   DIWFLG1
DIWCAS   EQU   DIWFLG1
DIWATV   EQU   IDADIWA+1
LPMBEXT  EQU   IDALPMB+24
@NM00093 EQU   IDALPMB+22
@NM00092 EQU   LPMBFLGS
CPACCWTC EQU   CPACCW+24
CPACCWSI EQU   CPACCW+16
CPACCWSS EQU   CPACCW+8
CPACCWSK EQU   CPACCW
CPATKOFL EQU   CPAFLAG2
CPAPFENT EQU   CPAFLAG2
CPAXLRA  EQU   CPAFLAG2
CPARREPL EQU   CPAFLAG2
CPAWREPL EQU   CPAFLAG2
@NM00091 EQU   CPAFLAG1
CPACHNED EQU   CPAFLAG1
CPARRPS  EQU   CPAFLAG1
CPAWRPS  EQU   CPAFLAG1
CPARV    EQU   CPAFLAG1
CPAWCV   EQU   CPAFLAG1
CPAWV    EQU   CPAFLAG1
CPASSECT EQU   IDACPA+82
CPABLKSZ EQU   IDACPA+76
CPAWORK2 EQU   IDACPA+72
CPAWORK1 EQU   IDACPA+68
@NM00090 EQU   CPARPHAD+7
CPARBB   EQU   CPARSEEK
@NM00089 EQU   CPARPHAD
CPAFWCNT EQU   IDACPA+48
CPAWPHR  EQU   CPAWPHAD+7
CPAWCHR  EQU   CPAWSEEK+2
CPAWBB   EQU   CPAWSEEK
@NM00088 EQU   CPAWPHAD
@NM00087 EQU   IDACPA+1
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00086 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGPSWD  EQU   CTGJSCB
@NM00084 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00083 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00082 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00081 EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00080 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00079 EQU   IDAAMBL+40
@NM00078 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00077 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLSDS  EQU   AMBLVVIC
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
@NM00076 EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
@NM00075 EQU   IDAAMBL+31
@NM00074 EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00073 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00072 EQU   AMBCSWD1+1
@NM00071 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
AMBLSR   EQU   AMBAFLG
@NM00070 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
@NM00069 EQU   IDAAMB+68
AMBAMBXN EQU   AMBEOVPT
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
@NM00068 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00067 EQU   AMBOFLGS
AMBIFLGS EQU   AMBDEBPT
AMBSDS   EQU   AMBINFL
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00066 EQU   AMBINFL
@NM00065 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00064 EQU   IDAAMB+38
@NM00063 EQU   AMBDSORG+1
@NM00062 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBCREAT EQU   AMBFLG1
@NM00061 EQU   AMBFLG0
AMBSWSP  EQU   AMBFLG0
AMBRSC   EQU   IDAAMB+1
BUFCEND  EQU   IDABUFC+64
BUFCUCDN EQU   IDABUFC+60
BUFCUCUP EQU   IDABUFC+56
BUFCMDBT EQU   IDABUFC+52
BUFCHAIN EQU   IDABUFC+48
BUFXORBA EQU   IDABUFC+44
BUFXIRBA EQU   IDABUFC+40
BUFCNXT2 EQU   IDABUFC+37
BUFCIDXL EQU   IDABUFC+36
BUFCDSPC EQU   IDABUFC+32
BUFCWLEN EQU   BUFCINV
BUFCORBA EQU   IDABUFC+12
BUFCDDDD EQU   IDABUFC+8
BUFCAMB  EQU   BUFCPLH
@NM00060 EQU   BUFCFLG2
BUFCBSYW EQU   BUFCFLG2
BUFCBSYR EQU   BUFCFLG2
BUFCNLAS EQU   BUFCFLG2
BUFCXDDR EQU   BUFCFLG2
BUFCPFCP EQU   BUFCIOFL
BUFCXEDB EQU   BUFCIOFL
BUFCREAL EQU   BUFCIOFL
BUFCRRD  EQU   BUFCIOFL
BUFCFMT  EQU   BUFCIOFL
BUFCMW   EQU   BUFCIOFL
BUFCEXC  EQU   BUFCFLG1
BUFCVAL  EQU   BUFCFLG1
BUFCER2  EQU   BUFCFLG1
BUFCER1  EQU   BUFCFLG1
BUFCINS  EQU   BUFCFLG1
BUFCSEG  EQU   BUFCFLG1
BUFCUPG  EQU   BUFCFLG1
BUFCUCNT EQU   BUFCAVL
@NM00059 EQU   IDABUFDR+16
BUFDBUFC EQU   IDABUFDR+12
@NM00058 EQU   BUFDRFLG
BUFDRREL EQU   BUFDRFLG
BUFDRTSB EQU   IDABUFDR+10
BUFDRPFN EQU   IDABUFDR+8
BUFDRPFB EQU   IDABUFDR+4
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00057
UCBHALI  EQU   @NM00057
UCBRSV09 EQU   @NM00057
UCBRSV08 EQU   @NM00057
UCBRSV07 EQU   @NM00057
UCBRSV06 EQU   @NM00057
UCBRSV05 EQU   @NM00057
UCBRSV04 EQU   @NM00057
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00054 EQU   UCB
@NM00053 EQU   ARDPRF
ARDPRFMT EQU   ARDPRF
ARDPRSS  EQU   ARDPRF
ARDUSED  EQU   ARDTYPE
ARDUOVFL EQU   ARDTYPE
PLHERRET EQU   IDAPLH+276
PLHASCB  EQU   IDAPLH+272
PLHECB   EQU   IDAPLH+268
@NM00051 EQU   IDAPLH+265
PLHDRMSK EQU   IDAPLH+264
PLHR13   EQU   IDAPLH+260
PLHPARM1 EQU   IDAPLH+256
PLHDRRSC EQU   IDAPLH+252
PLHRRN   EQU   PLHKEYPT
PLHSLRBA EQU   IDAPLH+244
PLHSRCSG EQU   IDAPLH+242
PLHNOSEG EQU   IDAPLH+240
PLHLLOR  EQU   IDAPLH+236
PLHXPLH  EQU   PLHWAX
@NM00050 EQU   PLHIXSPL+8
PLHIXBFC EQU   PLHIXSPL+4
PLHHIREC EQU   PLHSSRBA
PLHISPLP EQU   IDAPLH+196
PLHRBUFC EQU   IDAPLH+192
PLHNRBA  EQU   IDAPLH+184
PLHDDDD  EQU   PLHEOVPT
PLHAR14  EQU   IDAPLH+176
@NM00049 EQU   IDAPLH+172
@NM00048 EQU   IDAPLH+168
PLHASAVE EQU   IDAPLH+164
PLHRET1  EQU   IDAPLH+120
@NM00047 EQU   IDAPLH+118
PLHRETO  EQU   IDAPLH+116
PLHCHAIN EQU   IDAPLH+112
PLHAMB   EQU   IDAPLH+108
PLHSAVE6 EQU   IDAPLH+104
PLHSAVE5 EQU   IDAPLH+100
PLHSAVE4 EQU   IDAPLH+96
PLHSAVE3 EQU   IDAPLH+92
PLHSAVE2 EQU   IDAPLH+88
PLHSAVE1 EQU   IDAPLH+84
PLHARET  EQU   IDAPLH+80
PLHIIOB  EQU   PLHDIOB
PLHSRSID EQU   IDAPLH+74
PLHRDFC  EQU   IDAPLH+72
PLHRDFP  EQU   IDAPLH+68
PLHFSP   EQU   IDAPLH+64
PLHRECP  EQU   IDAPLH+60
PLHLRECL EQU   IDAPLH+48
@NM00046 EQU   IDAPLH+43
PLHEOVR  EQU   IDAPLH+42
PLHRCODE EQU   IDAPLH+41
PLHUCODE EQU   PLHJCODE
PLHJNRBA EQU   IDAPLH+36
PLHCNCL2 EQU   PLHJRNLL
PLHUPECB EQU   PLHJORBA
PLHCRPL  EQU   IDAPLH+20
PLHMRPL  EQU   IDAPLH+16
PLHDSTYP EQU   IDAPLH+12
PLHRABWD EQU   PLHAFLGS
PLHIOSID EQU   PLHAFLGS
PLHDBDC  EQU   PLHAFLGS
PLHVAMB  EQU   PLHAFLGS
PLHIOSRQ EQU   PLHAFLGS
PLHDRLM  EQU   PLHAFLGS
PLHEOVDF EQU   PLHFLG3
PLHRVRS  EQU   PLHFLG3
PLHBWD   EQU   PLHFLG3
PLHSLVLD EQU   PLHFLG3
PLHRAHD  EQU   PLHFLG3
PLHSRBSG EQU   PLHFLG3
@NM00045 EQU   PLHEFLGS+1
PLHRSTRT EQU   PLHEFLGS+1
PLHDSCAN EQU   PLHEFLGS
PLHINVAL EQU   PLHEFLGS
PLHEODX  EQU   PLHEFLGS
PLHNOADV EQU   PLHEFLGS
PLHSRINV EQU   PLHEFLGS
PLHSKPER EQU   PLHEFLGS
PLHNOSPC EQU   PLHEFLGS
PLHIWAIT EQU   PLHFLG2
PLHSVADV EQU   PLHFLG2
PLHCIINS EQU   PLHFLG2
PLHKRE   EQU   PLHFLG2
PLHADDTE EQU   PLHFLG2
PLHKEYMD EQU   PLHFLG2
PLHSQINS EQU   PLHFLG2
PLHUPD   EQU   PLHFLG2
PLHSR    EQU   PLHFLG1
PLHDRPND EQU   PLHFLG1
PLHASYRQ EQU   PLHFLG1
PLHRDEXC EQU   PLHFLG1
PLHSSR   EQU   PLHFLG1
PLHASKBF EQU   PLHFLG1
PLHENDRQ EQU   PLHFLG1
PLHEOVW  EQU   PLHFLG1
PLHATV   EQU   IDAPLH+1
PLHAVL   EQU   IDAPLH
PLHIOSDQ EQU   IDAPLHDR+12
PLHDRCUR EQU   IDAPLHDR+10
PLHDRMAX EQU   IDAPLHDR+8
PLHDRREQ EQU   IDAPLHDR+4
EDBTKBAL EQU   IDAEDB+20
@NM00044 EQU   EDBFLG1
EDBPSDS  EQU   EDBFLG1
EDBTOFLW EQU   EDBFLG1
EDBLKR   EQU   EDBFLG1
@NM00043 EQU   IDAEDB
DEBXSAMB EQU   DEBXTN+28
DEBXOPNJ EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXDSSI EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBESMVR EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00042 EQU   DEBACS08+12
@NM00041 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00040 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00039 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBLRECL EQU   DEBACSMD+14
DEBBLKSI EQU   DEBACSMD+12
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBNMTRK EQU   DEBDASD+14
DEBENDHH EQU   DEBDASD+12
DEBENDCC EQU   DEBDASD+10
DEBSTRHH EQU   DEBDASD+8
DEBBINUM EQU   DEBDASD+4
DEBECBB  EQU   DEBECBAD+1
DEBUSRPB EQU   DEBUSRPG+1
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBNMSUB EQU   DEBTCBAD
@NM00038 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00037 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBRV327 EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBRV326 EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBSTAWA EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBCCPVI EQU   TCBXSCT+2
TCBRV325 EQU   TCBXSCT+1
TCBRV324 EQU   TCBXSCT1
TCBRV323 EQU   TCBXSCT1
TCBRV322 EQU   TCBXSCT1
TCBRV321 EQU   TCBXSCT1
TCBRV320 EQU   TCBXSCT1
TCBRV319 EQU   TCBXSCT1
TCBS3A   EQU   TCBXSCT1
TCBACTIV EQU   TCBXSCT1
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00036 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00035 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00034 EQU   CVTFIX+248
@NM00033 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00032 EQU   CTEXTENT+20
CTNOTRKS EQU   CTEXTENT+10
CTHHEND  EQU   CTABSEND+2
CTCCEND  EQU   CTABSEND
@NM00031 EQU   CTEXTENT+1
CTEXTFLG EQU   CTEXTENT
CTPRFMT  EQU   CTKEYFLG
CTKEYEN1 EQU   CTVOLENT+20
@NM00030 EQU   CTVOLENT+18
@NM00029 EQU   CTVOLENT+2
CTOFLOW  EQU   CTVOLFLG
CTVOLMT  EQU   CTVOLFLG
@NM00028 EQU   CTINFO+214
CTEXEX   EQU   CTINFO+66
@NM00027 EQU   CTINFO+49
CTVIRT   EQU   CTDEV2
CTBRPS   EQU   CTDEV2
@NM00026 EQU   CTDEV2
@NM00025 EQU   CTDEVTYP
@NM00024 EQU   CTINFO+4
CTUPD    EQU   CTAUTH
CTCINV   EQU   CTAUTH
CTFULL   EQU   CTAUTH
CTUNUSE  EQU   CTSHROP
CTINTDS  EQU   CTSHROP
@NM00023 EQU   CTSHROP
CTINDX   EQU   CTATTRB
CTINDXSS EQU   CTATTRB
CTCYL    EQU   CTATTRB
CTOPEN   EQU   CTATTRB
CTTEMPEX EQU   CTATTRA
@NM00022 EQU   CTATTRA
CTERASE  EQU   CTATTRA
CTUNIQ   EQU   CTATTRA
CTAMDSPD EQU   CTATTRA
AMATIOE  EQU   AMBWORK+8
AMATIOT  EQU   AMBWORK+4
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00021 EQU   IDAAMDSB+41
@NM00020 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDRKP   EQU   IDAAMDSB+6
AMDAXRKP EQU   AMDNEST
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDDST   EQU   AMDATTR
IQEOUTLM EQU   IQESECT+20
IQEDCB   EQU   IQESECT+16
IQETCBA  EQU   IQETCB+1
IQESTAT2 EQU   IQETCB
IQEIRBA  EQU   IQEIRB+1
@NM00019 EQU   IQEFLAGS
@NM00018 EQU   IQEFLAGS
@NM00017 EQU   IQEFLAGS
@NM00016 EQU   IQEFLAGS
@NM00015 EQU   IQEFLAGS
@NM00014 EQU   IQEFLAGS
@NM00013 EQU   IQEFLAGS
IQEPURGE EQU   IQEFLAGS
IQEPARAM EQU   IQESECT+4
IQELNKA  EQU   IQELNK+1
IQESTAT1 EQU   IQELNK
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
@NM00012 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
@NM00011 EQU   ACBINFLG+1
ACBBYPSS EQU   ACBINFLG
ACBSDS   EQU   ACBVVIC
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00010 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00009 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00008 EQU   ACBOFLGS
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00007 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00006 EQU   ACBDSORG
ACBOPTJ  EQU   ACBDVIND
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00005 EQU   ACBCCTYP
ACBTRCID EQU   ACBCCTYP
@NM00004 EQU   ACBRECFM
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00003 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00002 EQU   ACBMACR3
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00001 EQU   ACBMACR2
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
CBSVPTR  EQU   CBSVSRT+4
CBSVUSE  EQU   CBSVSRT
CBSCRTCB EQU   AMCBS+28
CBSCRACA EQU   AMCBS+24
CBSCAXCN EQU   AMCBS+20
CBSMCUCB EQU   CBSCMP
CBSCBP   EQU   AMCBS+12
CBSMCSTA EQU   AMCBS+4
CBSSIZ   EQU   AMCBS+2
CBSID    EQU   AMCBS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00747 EQU   @RC00746
@RF00879 EQU   @RC00875
@RF00960 EQU   @RC00956
@RC00983 EQU   @RC00981
@PB00020 EQU   @EL00018
@RF01020 EQU   @RC01017
@PB00024 EQU   @EL00022
@PB00031 EQU   @EL00026
@RC01411 EQU   @RC01409
@RF01414 EQU   @RC01409
@RC01511 EQU   @RC01510
@RC01521 EQU   @RC01520
@PB00019 EQU   @PB00020
@PB00023 EQU   @PB00024
@PB00030 EQU   @PB00031
@PB00029 EQU   @PB00030
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@ENDDATA EQU   *
         END   IEAVNP1A,(C'PLS0223',0701,77018)

         TITLE '**************** IDCCP01: COMPARET FSR *****************
               *        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCCP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCCP01   76.301'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @12,4095(,@10)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0279
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN ROUTINE FOR THE COMPARET FSR ROUTINE. SET AND*/
*   /* PRINTS THE FINAL COMPLETION MESSAGE BEFORE RETURNING TO THE   */
*   /* AMS EXECUTIVE                                         @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*   IF GDTDBG=NULLPTR THEN                                         0279
         L     @08,@PC00001                                        0279
         L     @08,GDTDBG(,@08)                                    0279
         LTR   @08,@08                                             0279
         BZ    @RT00279                                            0279
*     ;                                                            0280
*   ELSE                                                           0281
*     CALL IDCDB010(GDTTBL,'CPAA'); /*                       @Z40LB65*/
         L     @08,@PC00001                                        0281
         ST    @08,@AL00001                                        0281
         LA    @15,@CC01284                                        0281
         ST    @15,@AL00001+4                                      0281
         MVI   @AL00001+4,X'80'                                    0281
         L     @15,GDTDBG(,@08)                                    0281
         LA    @01,@AL00001                                        0281
         BALR  @14,@15                                             0281
*   OLDERID2=NEWERID2;                                             0282
@RT00279 L     @02,@PC00001                                        0282
         L     @15,GDTTR2(,@02)                                    0282
         MVC   @TS00001(95),NEWERID2(@15)                          0282
         MVC   OLDERID2(95,@15),@TS00001                           0282
*   NEWID2='CPAA';                  /*                       @Z40LB65*/
*                                                                  0283
         MVC   NEWID2(4,@15),@CC01284                              0283
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PARAMETER LISTS AND POINTERS FOR THE       @Z40LB65*/
*   /* UPRINT, OPEN UEXCP, UALLOC, ACQUIRE USSC, COPYTABL    @Z40LB65*/
*   /* USSC, AND GET UEXCP MACROS.                           @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0284
*   RESPECIFY                                                      0284
*     CKAGL BASED(CKPTR);           /*                       @Z40LB65*/
*   DDSTRU=ADDR(PRINTAB);           /*                       @Z40LB65*/
         LA    @15,PRINTAB                                         0285
         ST    @15,DDSTRU                                          0285
*   PRINTAB=''B;                    /*                       @Z40LB65*/
         XC    PRINTAB(20),PRINTAB                                 0286
*   DARGSMOD=CP0MSG;                /*                       @Z40LB65*/
         MVC   DARGSMOD(3,@15),@CC01281                            0287
*   INTTBL=''B;                     /*                       @Z40LB65*/
         XC    INTTBL(61),INTTBL                                   0288
*   EXOPTR=ADDR(EXOLIST);           /*                       @Z40LB65*/
         LA    EXOPTR,EXOLIST                                      0289
*   RESPECIFY                                                      0290
*     EXOARG BASED(EXOPTR);         /*                       @Z40LB65*/
*   EXOARG=''B;                     /*                       @Z40LB65*/
         XC    EXOARG(34,EXOPTR),EXOARG(EXOPTR)                    0291
*   ALL1PTR=ADDR(ALL1LIST);         /*                       @Z40LB65*/
         LA    ALL1PTR,ALL1LIST                                    0292
*   ALL2PTR=ADDR(ALL2LIST);         /*                       @Z40LB65*/
         LA    ALL2PTR,ALL2LIST                                    0293
*   ALL1LIST=''B;                   /*                       @Z40LB65*/
         XC    ALL1LIST(31),ALL1LIST                               0294
*   ALL2LIST=''B;                   /*                       @Z40LB65*/
         XC    ALL2LIST(31),ALL2LIST                               0295
*   CKPTR=ADDR(UCBLIST);            /*                       @Z40LB65*/
         LA    CKPTR,UCBLIST                                       0296
*   CKAGL=''B;                      /*                       @Z40LB65*/
         XC    CKAGL(29,CKPTR),CKAGL(CKPTR)                        0297
*   ACQPTR=ADDR(ACQLST2);           /*                       @Z40LB65*/
         LA    @15,ACQLST2                                         0298
         ST    @15,ACQPTR                                          0298
*   ACQLST1=''B;                    /*                       @Z40LB65*/
         XC    ACQLST1(96),ACQLST1                                 0299
*   ACQLST2=''B;                    /*                       @Z40LB65*/
         XC    ACQLST2(96),ACQLST2                                 0300
*   COTPTR=ADDR(COTBLIST);          /*                       @Z40LB65*/
         LA    @15,COTBLIST                                        0301
         ST    @15,COTPTR                                          0301
*   COTBLIST=''B;                   /*                       @Z40LB65*/
         XC    COTBLIST(24),COTBLIST                               0302
*   RESPECIFY                                                      0303
*     EXGARG BASED(EXGPTR);         /*                       @Z40LB65*/
*   EXGPTR=ADDR(EXGALIST);          /*                       @Z40LB65*/
         LA    EXGPTR,EXGALIST                                     0304
*   EXGARG=''B;                     /*                       @Z40LB65*/
         XC    EXGARG(32,EXGPTR),EXGARG(EXGPTR)                    0305
*   NULLDDN=''B;                    /*                       @Z40LB65*/
         XC    NULLDDN(8),NULLDDN                                  0306
*   WORKPTR1=0;                     /*                       @Z40LB65*/
         SLR   @15,@15                                             0307
         ST    @15,WORKPTR1                                        0307
*   WORKPTR2=0;                     /*                       @Z40LB65*/
*                                                                  0308
         ST    @15,WORKPTR2                                        0308
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN SPACE FOR TWO TRACK BUFFERS (8448 BYTES EACH)  @Z40LB65*/
*   /* AND THE OUTPUT BUFFER (792 BYTES)                     @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   CALL IDCSAGS0(GDTTBL,CORESIZE,TRKPTR1);/*                @Z40LB65*/
         ST    @02,@AL00001                                        0309
         LA    @15,@CF01177                                        0309
         ST    @15,@AL00001+4                                      0309
         LA    @15,TRKPTR1                                         0309
         ST    @15,@AL00001+8                                      0309
         MVI   @AL00001+8,X'80'                                    0309
         L     @15,GDTGSP(,@02)                                    0309
         LA    @01,@AL00001                                        0309
         BALR  @14,@15                                             0309
*   RESPECIFY                                                      0310
*     RTNREG RSTD;                                                 0310
*   TESTRC=RTNREG;                                                 0311
         LR    TESTRC,RTNREG                                       0311
*   RESPECIFY                                                      0312
*     RTNREG UNRSTD;                /*                       @Z40LB65*/
*   IF TESTRC^=LASTCC00 THEN                                       0313
         LTR   TESTRC,TESTRC                                       0313
         BZ    @RF00313                                            0313
*     LASTCOND=LASTCC08;            /*                       @Z40LB65*/
         L     @06,@PC00001+8                                      0314
         MVC   LASTCOND(2,@06),@CH00178                            0314
*   ELSE                                                           0315
*     DO;                           /*                       @Z40LB65*/
         B     @RC00313                                            0315
@RF00313 DS    0H                                                  0316
*       TRKPTR2=TRKPTR1+TRKSIZE;    /*                       @Z40LB65*/
         L     @15,@CF01179                                        0316
         L     @14,TRKPTR1                                         0316
         ALR   @14,@15                                             0316
         ST    @14,TRKPTR2                                         0316
*       OUTPTR=TRKPTR2+TRKSIZE;     /*                       @Z40LB65*/
*                                                                  0317
         ALR   @14,@15                                             0317
         LR    OUTPTR,@14                                          0317
*       /*************************************************************/
*       /*                                                           */
*       /* CALL OPENPROC TO ALLOCATE AND OPEN WORK DATA SETS,        */
*       /*                                                   @Z40LB65*/
*       /* AND TO INSURE THAT THEY ARE MASS STORAGE VOLUMES  @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0318
*       CALL OPENPROC;              /*                       @Z40LB65*/
         BAL   @14,OPENPROC                                        0318
*       RESPECIFY                                                  0319
*         RTNREG RSTD;                                             0319
*       TESTRC=RTNREG;                                             0320
         LR    TESTRC,RTNREG                                       0320
*       RESPECIFY                                                  0321
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC=LASTCC12 THEN                                    0322
         LA    @06,12                                              0322
         CR    TESTRC,@06                                          0322
         BNE   @RF00322                                            0322
*         LASTCOND=LASTCC12;        /*                       @Z40LB65*/
         L     @05,@PC00001+8                                      0323
         STH   @06,LASTCOND(,@05)                                  0323
*     END;                          /*                       @Z40LB65*/
*                                                                  0324
@RF00322 DS    0H                                                  0325
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SUCCESSFUL, CALL COPYPROC TO COPY BOTH MSC TABLES  @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   IF LASTCOND=LASTCC00 THEN                                      0325
@RC00313 L     @06,@PC00001+8                                      0325
         LH    @06,LASTCOND(,@06)                                  0325
         LTR   @06,@06                                             0325
         BNZ   @RF00325                                            0325
*     DO;                           /*                       @Z40LB65*/
*       CALL COPYPROC;              /*                       @Z40LB65*/
         BAL   @14,COPYPROC                                        0327
*       RESPECIFY                                                  0328
*         RTNREG RSTD;                                             0328
*       TESTRC=RTNREG;                                             0329
         LR    TESTRC,RTNREG                                       0329
*       RESPECIFY                                                  0330
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC=LASTCC12 THEN                                    0331
         LA    @06,12                                              0331
         CR    TESTRC,@06                                          0331
         BNE   @RF00331                                            0331
*         LASTCOND=LASTCC12;        /*                       @Z40LB65*/
         L     @05,@PC00001+8                                      0332
         STH   @06,LASTCOND(,@05)                                  0332
*     END;                          /*                       @Z40LB65*/
*                                                                  0333
@RF00331 DS    0H                                                  0334
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SUCCESSFUL, CALL COMPPROC TO COMPARE THE TABLES    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   IF LASTCOND=LASTCC00 THEN                                      0334
@RF00325 L     @06,@PC00001+8                                      0334
         LH    @06,LASTCOND(,@06)                                  0334
         LTR   @06,@06                                             0334
         BNZ   @RF00334                                            0334
*     DO;                           /*                       @Z40LB65*/
*       CALL COMPPROC;              /*                       @Z40LB65*/
         BAL   @14,COMPPROC                                        0336
*       RESPECIFY                                                  0337
*         RTNREG RSTD;                                             0337
*       TESTRC=RTNREG;                                             0338
         LR    TESTRC,RTNREG                                       0338
*       RESPECIFY                                                  0339
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       LASTCOND=TESTRC;            /*                       @Z40LB65*/
         L     @09,@PC00001+8                                      0340
         STH   TESTRC,LASTCOND(,@09)                               0340
*     END;                          /*                       @Z40LB65*/
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE SPACE FOR THE TRACK BUFFERS                  @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*   CALL IDCSAFS0(GDTTBL,TRKPTR1);  /*                       @Z40LB65*/
*                                                                  0342
@RF00334 L     @09,@PC00001                                        0342
         ST    @09,@AL00001                                        0342
         LA    @06,TRKPTR1                                         0342
         ST    @06,@AL00001+4                                      0342
         L     @15,GDTFSP(,@09)                                    0342
         LA    @01,@AL00001                                        0342
         BALR  @14,@15                                             0342
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ACQSW2 = ON SET UP THE SECOND ACQUIRE LIST IN ORDER TO     */
*   /* RELINQUISH THE DATA SET SPACE. SPECIFY THE UNBIND OPTION.     */
*   /*                                                       @ZA14727*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   IF ACQSW2=ON THEN                                              0343
         TM    ACQSW2,B'00001000'                                  0343
         BNO   @RF00343                                            0343
*     DO;                           /*                       @ZA14727*/
*       ACQLST2=ACQLST2&&ACQLST2;   /*                       @ZA14727*/
         XC    ACQLST2(96),ACQLST2                                 0345
*       ACQPTR=ADDR(ACQLST2);       /*                       @ZA14727*/
         LA    @09,ACQLST2                                         0346
         ST    @09,ACQPTR                                          0346
*       ARLL=LENGTH(ACQLST2);       /*                       @ZA14727*/
         MVC   ARLL(4,@09),@CF01205                                0347
*       AROP=4;                     /*                       @ZA14727*/
         MVI   AROP(@09),X'04'                                     0348
*       ARBDUBD=ON;                 /*                       @ZA14727*/
         OI    ARBDUBD(@09),B'10000000'                            0349
*       ARNMEXT=1;                  /*                       @ZA14727*/
         MVI   ARNMEXT(@09),X'01'                                  0350
*       ARVOL=WORKVOL2;             /*                       @ZA14727*/
         MVC   ARVOL(6,@09),WORKVOL2                               0351
*       AREXT(1,1:2)=SCYL2;         /*                       @ZA14727*/
         MVC   AREXT(2,@09),SCYL2                                  0352
*       AREXT(1,3:4)=ECYL2;         /*                       @ZA14727*/
         MVC   AREXT+2(2,@09),ECYL2                                0353
*     END;                          /*                       @ZA14727*/
*                                                                  0354
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ACQSW1 = ON SET UP THE FIRST ACQUIRE LIST IN ORDER TO      */
*   /* RELINQUISH THE DATA SET SPACE. SPECIFY THE UNBIND OPTION.     */
*   /*                                                       @ZA14727*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*   IF ACQSW1=ON THEN                                              0355
@RF00343 TM    ACQSW1,B'00010000'                                  0355
         BNO   @RF00355                                            0355
*     DO;                           /*                       @ZA14727*/
*       ACQLST1=ACQLST1&&ACQLST1;   /*                       @ZA14727*/
         XC    ACQLST1(96),ACQLST1                                 0357
*       ACQPTR=ADDR(ACQLST1);       /*                       @ZA14727*/
         LA    @09,ACQLST1                                         0358
         ST    @09,ACQPTR                                          0358
*       ARLL=LENGTH(ACQLST1);       /*                       @ZA14727*/
         MVC   ARLL(4,@09),@CF01205                                0359
*       AROP=4;                     /*                       @ZA14727*/
         MVI   AROP(@09),X'04'                                     0360
*       ARBDUBD=ON;                 /*                       @ZA14727*/
         OI    ARBDUBD(@09),B'10000000'                            0361
*       ARNMEXT=1;                  /*                       @ZA14727*/
         MVI   ARNMEXT(@09),X'01'                                  0362
*       ARVOL=WORKVOL1;             /*                       @ZA14727*/
         MVC   ARVOL(6,@09),WORKVOL1                               0363
*       AREXT(1,1:2)=SCYL1;         /*                       @ZA14727*/
         MVC   AREXT(2,@09),SCYL1                                  0364
*       AREXT(1,3:4)=ECYL1;         /*                       @ZA14727*/
*                                                                  0365
         MVC   AREXT+2(2,@09),ECYL1                                0365
*       /*************************************************************/
*       /*                                                           */
*       /* IF BOTH SWITCHES ARE ON, CHAIN THE SECOND RELINQUISH TO   */
*       /* THE FIRST.                                        @ZA14727*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0366
*       IF ACQSW2=ON THEN           /*                       @ZA14727*/
         TM    ACQSW2,B'00001000'                                  0366
         BNO   @RF00366                                            0366
*         ARNEDB=ADDR(ACQLST2);     /*                       @ZA14727*/
         LA    @06,ACQLST2                                         0367
         ST    @06,ARNEDB(,@09)                                    0367
*     END;                          /*                       @ZA14727*/
@RF00366 DS    0H                                                  0369
*/*   IF EITHER ACQUIRE SWITCH IS ON THEN WE WANT TO SET THE         */
*/*   SWITCHES OFF AND ISSUE USSC TO RELINQUISH THE SPACE.   @ZA14727*/
*                                                                  0369
*   IF ACQSW1=ON×ACQSW2=ON THEN     /*                       @ZA14727*/
@RF00355 TM    ACQSW1,B'00011000'                                  0369
         BZ    @RF00369                                            0369
*     DO;                           /*                       @ZA14727*/
*       ACQSW1=OFF;                 /*                       @ZA14727*/
*       ACQSW2=OFF;                 /*                       @ZA14727*/
         NI    ACQSW1,B'11100111'                                  0372
*       CALL IDCSASS0(GDTTBL,RELINQ,ACQPTR,REASONCD);/*      @ZA14727*/
         L     @09,@PC00001                                        0373
         ST    @09,@AL00001                                        0373
         LA    @06,RELINQ                                          0373
         ST    @06,@AL00001+4                                      0373
         LA    @06,ACQPTR                                          0373
         ST    @06,@AL00001+8                                      0373
         LA    @06,REASONCD                                        0373
         ST    @06,@AL00001+12                                     0373
         MVI   @AL00001+12,X'80'                                   0373
         L     @15,GDTSSC(,@09)                                    0373
         LA    @01,@AL00001                                        0373
         BALR  @14,@15                                             0373
*       RESPECIFY                                                  0374
*         RTNREG RSTD;                                             0374
*       TESTRC=RTNREG;                                             0375
         LR    TESTRC,RTNREG                                       0375
*       RESPECIFY                                                  0376
*         RTNREG UNRSTD;            /*                       @ZA14727*/
*       IF TESTRC^=0 THEN           /*                       @ZA14727*/
         LTR   TESTRC,TESTRC                                       0377
         BZ    @RF00377                                            0377
*         DO;                       /*                       @ZA14727*/
*                                                                  0378
*           /*********************************************************/
*           /*                                                       */
*           /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE     @ZA14727*/
*           /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.       */
*           /*                                               @ZA14727*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0379
*           CALL SSCMSG(REASONCD);  /*                       @ZA14727*/
         LA    @09,REASONCD                                        0379
         ST    @09,@AL00001                                        0379
         LA    @01,@AL00001                                        0379
         BAL   @14,SSCMSG                                          0379
*           LASTCOND=LASTCC04;      /*                       @ZA14727*/
         L     @09,@PC00001+8                                      0380
         MVC   LASTCOND(2,@09),@CH00041                            0380
*         END;                      /*                       @ZA14727*/
*     END;                          /*                       @ZA14727*/
*                                                                  0382
@RF00377 DS    0H                                                  0383
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WORKPTR1 IS ^= 0 THEN THE WORKDATASET1 WAS OPENED  @Z40LB65*/
*   /* AND MUST BE CLOSED AND POSSIBLY DEALLOCATED.          @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   IF WORKPTR1^=NULLPTR THEN                                      0383
@RF00369 L     @09,WORKPTR1                                        0383
         LTR   @09,@09                                             0383
         BZ    @RF00383                                            0383
*     DO;                           /*                       @Z40LB65*/
*       CALL IDCIO050(GDTTBL,CLOSE,WORKPTR1);/*              @Z40LB65*/
         L     @09,@PC00001                                        0385
         ST    @09,@AL00001                                        0385
         LA    @06,CLOSE                                           0385
         ST    @06,@AL00001+4                                      0385
         LA    @06,WORKPTR1                                        0385
         ST    @06,@AL00001+8                                      0385
         MVI   @AL00001+8,X'80'                                    0385
         L     @15,GDTEXP(,@09)                                    0385
         LA    @01,@AL00001                                        0385
         BALR  @14,@15                                             0385
*       RESPECIFY                                                  0386
*         RTNREG RSTD;                                             0386
*       TESTRC=RTNREG;                                             0387
         LR    TESTRC,RTNREG                                       0387
*       RESPECIFY                                                  0388
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0389
         LTR   TESTRC,TESTRC                                       0389
         BZ    @RF00389                                            0389
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/
         L     @09,@PC00001+8                                      0390
         LH    @06,LASTCOND(,@09)                                  0390
         LA    @15,4                                               0390
         CR    @06,@15                                             0390
         BNL   *+6
         LR    @06,@15                                             0390
         STH   @06,LASTCOND(,@09)                                  0390
*     END;                          /*                       @Z40LB65*/
@RF00389 DS    0H                                                  0392
*   IF ADDR(WDS1)^=NULLPTR&DDNAME1^=NULLDDN THEN                   0392
@RF00383 L     @09,@PC00001+4                                      0392
         L     @09,FDTPTR+16(,@09)                                 0392
         LTR   @09,@09                                             0392
         BZ    @RF00392                                            0392
         CLC   DDNAME1(8),NULLDDN                                  0392
         BE    @RF00392                                            0392
*     DO;                           /*                       @Z40LB65*/
*       RESPECIFY                                                  0394
*         ALLAGL BASED(ALL1PTR);    /*                       @Z40LB65*/
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/
         L     @09,@PC00001                                        0395
         ST    @09,@AL00001                                        0395
         ST    ALL1PTR,@AL00001+4                                  0395
         MVI   @AL00001+4,X'80'                                    0395
         L     @15,GDTDLC(,@09)                                    0395
         LA    @01,@AL00001                                        0395
         BALR  @14,@15                                             0395
*       RESPECIFY                                                  0396
*         RTNREG RSTD;                                             0396
*       TESTRC=RTNREG;                                             0397
         LR    TESTRC,RTNREG                                       0397
*       RESPECIFY                                                  0398
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0399
         LTR   TESTRC,TESTRC                                       0399
         BZ    @RF00399                                            0399
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/
         L     @09,@PC00001+8                                      0400
         LH    @15,LASTCOND(,@09)                                  0400
         LA    @14,4                                               0400
         CR    @15,@14                                             0400
         BNL   *+6
         LR    @15,@14                                             0400
         STH   @15,LASTCOND(,@09)                                  0400
*     END;                          /*                       @Z40LB65*/
*                                                                  0401
@RF00399 DS    0H                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WORKPTR2 IS ^= 0 THEN THE WORKDATASET2 WAS OPENED  @Z40LB65*/
*   /* AND MUST BE CLOSED AND POSSIBLY DEALLOCATED.          @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   IF WORKPTR2^=NULLPTR THEN                                      0402
@RF00392 L     @09,WORKPTR2                                        0402
         LTR   @09,@09                                             0402
         BZ    @RF00402                                            0402
*     DO;                           /*                       @Z40LB65*/
*       CALL IDCIO050(GDTTBL,CLOSE,WORKPTR2);/*              @Z40LB65*/
         L     @09,@PC00001                                        0404
         ST    @09,@AL00001                                        0404
         LA    @02,CLOSE                                           0404
         ST    @02,@AL00001+4                                      0404
         LA    @02,WORKPTR2                                        0404
         ST    @02,@AL00001+8                                      0404
         MVI   @AL00001+8,X'80'                                    0404
         L     @15,GDTEXP(,@09)                                    0404
         LA    @01,@AL00001                                        0404
         BALR  @14,@15                                             0404
*       RESPECIFY                                                  0405
*         RTNREG RSTD;                                             0405
*       TESTRC=RTNREG;                                             0406
         LR    TESTRC,RTNREG                                       0406
*       RESPECIFY                                                  0407
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0408
         LTR   TESTRC,TESTRC                                       0408
         BZ    @RF00408                                            0408
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/
         L     @09,@PC00001+8                                      0409
         LH    @15,LASTCOND(,@09)                                  0409
         LA    @14,4                                               0409
         CR    @15,@14                                             0409
         BNL   *+6
         LR    @15,@14                                             0409
         STH   @15,LASTCOND(,@09)                                  0409
*     END;                          /*                       @Z40LB65*/
@RF00408 DS    0H                                                  0411
*   IF ADDR(WDS2)^=NULLPTR&DDNAME2^=NULLDDN THEN                   0411
@RF00402 L     @09,@PC00001+4                                      0411
         L     @09,FDTPTR+20(,@09)                                 0411
         LTR   @09,@09                                             0411
         BZ    @RF00411                                            0411
         CLC   DDNAME2(8),NULLDDN                                  0411
         BE    @RF00411                                            0411
*     DO;                           /*                       @Z40LB65*/
*       RESPECIFY                                                  0413
*         ALLAGL BASED(ALL2PTR);    /*                       @Z40LB65*/
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/
         L     @09,@PC00001                                        0414
         ST    @09,@AL00001                                        0414
         ST    ALL2PTR,@AL00001+4                                  0414
         MVI   @AL00001+4,X'80'                                    0414
         L     @15,GDTDLC(,@09)                                    0414
         LA    @01,@AL00001                                        0414
         BALR  @14,@15                                             0414
*       RESPECIFY                                                  0415
*         RTNREG RSTD;                                             0415
*       TESTRC=RTNREG;                                             0416
         LR    TESTRC,RTNREG                                       0416
*       RESPECIFY                                                  0417
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0418
         LTR   TESTRC,TESTRC                                       0418
         BZ    @RF00418                                            0418
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/
         L     @15,@PC00001+8                                      0419
         LH    @14,LASTCOND(,@15)                                  0419
         LA    @09,4                                               0419
         CR    @14,@09                                             0419
         BNL   *+6
         LR    @14,@09                                             0419
         STH   @14,LASTCOND(,@15)                                  0419
*     END;                          /*                       @Z40LB65*/
*                                                                  0420
@RF00418 DS    0H                                                  0421
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE APPROPRIATE COMPLETION MESSAGE              @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*   PRINTAB=''B;                    /*                       @Z40LB65*/
@RF00411 XC    PRINTAB(20),PRINTAB                                 0421
*   DARGSMOD=UNIVMSG;               /*                       @Z40LB65*/
         L     @15,DDSTRU                                          0422
         MVC   DARGSMOD(3,@15),@CC01279                            0422
*   DARGDBP=ADDR(LASTCOND);         /*                       @Z40LB65*/
         L     @14,@PC00001+8                                      0423
         ST    @14,DARGDBP(,@15)                                   0423
*   DARGILP=LENGTH(LASTCOND);       /*                       @Z40LB65*/
         MVC   DARGILP(2,@15),@CH00152                             0424
*   IF LASTCOND=LASTCC12 THEN       /*                       @Z40LB65*/
         CLC   LASTCOND(2,@14),@CH00567                            0425
         BNE   @RF00425                                            0425
*     DARGSENT=MSG3003I;            /*                       @Z40LB65*/
         MVI   DARGSENT(@15),X'03'                                 0426
*   ELSE                                                           0427
*     IF LASTCOND=LASTCC08 THEN     /*                       @Z40LB65*/
         B     @RC00425                                            0427
@RF00425 L     @15,@PC00001+8                                      0427
         CLC   LASTCOND(2,@15),@CH00178                            0427
         BNE   @RF00427                                            0427
*       DARGSENT=MSG3004I;          /*                       @Z40LB65*/
         L     @01,DDSTRU                                          0428
         MVI   DARGSENT(@01),X'04'                                 0428
*     ELSE                          /*                       @Z40LB65*/
*       DARGSENT=MSG0001I;          /*                       @Z40LB65*/
         B     @RC00427                                            0429
@RF00427 L     @01,DDSTRU                                          0429
         MVI   DARGSENT(@01),X'01'                                 0429
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/
*                                                                  0430
@RC00427 DS    0H                                                  0430
@RC00425 L     @15,@PC00001                                        0430
         ST    @15,@AL00001                                        0430
         LA    @14,@CF00114                                        0430
         ST    @14,@AL00001+4                                      0430
         LA    @14,DDSTRU                                          0430
         ST    @14,@AL00001+8                                      0430
         MVI   @AL00001+8,X'80'                                    0430
         L     @15,GDTPRT(,@15)                                    0430
         LA    @01,@AL00001                                        0430
         BALR  @14,@15                                             0430
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR A FULL REGION DUMP AND RETURN TO AMS       @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*   IF GDTDBG=NULLPTR THEN                                         0431
         L     @15,@PC00001                                        0431
         L     @15,GDTDBG(,@15)                                    0431
         LTR   @15,@15                                             0431
         BZ    @RT00431                                            0431
*     ;                                                            0432
*   ELSE                                                           0433
*     CALL IDCDB010(GDTTBL,'CPAZ'); /*                       @Z40LB65*/
         L     @15,@PC00001                                        0433
         ST    @15,@AL00001                                        0433
         LA    @14,@CC01295                                        0433
         ST    @14,@AL00001+4                                      0433
         MVI   @AL00001+4,X'80'                                    0433
         L     @15,GDTDBG(,@15)                                    0433
         LA    @01,@AL00001                                        0433
         BALR  @14,@15                                             0433
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0434
*                                                                  0434
@RT00431 L     @15,@PC00001                                        0434
         ST    @15,@AL00001                                        0434
         LA    @14,MODID                                           0434
         ST    @14,@AL00001+4                                      0434
         L     @14,@PC00001+8                                      0434
         ST    @14,@AL00001+8                                      0434
         MVI   @AL00001+8,X'80'                                    0434
         L     @15,GDTEPL(,@15)                                    0434
         LA    @01,@AL00001                                        0434
         BALR  @14,@15                                             0434
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0435
*                                                                  0435
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - OPENPROC                            @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE ALLOCATES AND OPENS THE      @Z40LB65*/
*/*                WORK DATA SETS AND INSURES THAT THEY      @Z40LB65*/
*/*                ARE MASS STORAGE VOLUMES.                 @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - FUNCTION DEFINITION TABLE                    @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - INTTBL INITIALIZED WITH THE WORK VOLUME     @Z40LB65*/
*/*                SERIAL NUMBER AND WITH THE START AND      @Z40LB65*/
*/*                END CYLINDER ADDRESSES AND A RETURN CODE  @Z40LB65*/
*/*                0 = SUCCESSFUL COMPLETION                 @Z40LB65*/
*/*                12 = UNSUCCESSFUL COMPLETION              @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0435
*OPENPROC:                                                         0435
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
*                                                                  0435
@EL00001 L     @13,4(,@13)                                         0435
@EF00001 L     @00,@SIZDATD                                        0435
         LR    @01,@11                                             0435
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0435
         BR    @14                                                 0435
OPENPROC STM   @14,@12,12(@13)                                     0435
         ST    @13,@SA00002+4                                      0435
         LA    @14,@SA00002                                        0435
         ST    @14,8(,@13)                                         0435
         LR    @13,@14                                             0435
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*   DCL                                                            0436
*     OPENCODE FIXED(15);           /* OPENWORK RET CODE     @Z40LB65*/
*   DCL                                                            0437
*     IOINFO CHAR(LENGTH(IOINFOPT));/* UIOINFO FLAGS         @Z40LB65*/
*   DCL                                                            0438
*     VOLSRPTR PTR(31);             /* PTR TO VOLSER'S       @Z40LB65
*                                      FROM UIOINFO MACRO    @Z40LB65*/
*                                                                  0438
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA STRUCTURE FOR RETURN OF VOLUME      @Z40LB65*/
*   /* SERIAL NUMBERS FROM UIOINFO MACRO                     @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0439
*   DCL                                                            0439
*     1 INFOAREA CHAR(38) BDY(WORD),                               0439
*      2 HEADER CHAR(4) BDY(WORD),  /* HEADER INFORMATION    @Z40LB65*/
*       3 WORKLEN FIXED(15),        /* WORK AREA LENGTH      @Z40LB65*/
*       3 RETNLEN FIXED(15),        /* DATA RETURNED LEN     @Z40LB65*/
*      2 TYPE FIXED(15),            /* DATA TYPE             @Z40LB65*/
*      2 DATALEN FIXED(15),         /* DATA LENGTH           @Z40LB65*/
*      2 VOLAREA(5) CHAR(6);        /* VOLUME SER NUMBERS    @Z40LB65*/
*   DCL                                                            0440
*     UCBPTR PTR(31);               /* UCB PTR FIELD         @Z40LB65*/
*   OLDERID2=NEWERID2;                                             0441
         L     @09,@PC00001                                        0441
         L     @15,GDTTR2(,@09)                                    0441
         MVC   @TS00001(95),NEWERID2(@15)                          0441
         MVC   OLDERID2(95,@15),@TS00001                           0441
*   NEWID2='CPBA';                  /*                       @Z40LB65*/
         MVC   NEWID2(4,@15),@CC01311                              0442
*   OPENCODE=''B;                   /*                       @Z40LB65*/
         SLR   @15,@15                                             0443
         LR    OPENCODE,@15                                        0443
*   VOLSRPTR=ADDR(INFOAREA);        /*                       @Z40LB65*/
         LA    @14,INFOAREA                                        0444
         ST    @14,VOLSRPTR                                        0444
*   WORKLEN=LENGTH(INFOAREA);       /*                       @Z40LB65*/
         MVC   WORKLEN(2),@CH01303                                 0445
*   UCBPTR=''B;                     /*                       @Z40LB65*/
         ST    @15,UCBPTR                                          0446
*   RESPECIFY                                                      0447
*     IOINFOPT BASED(ADDR(IOINFO)); /*                       @Z40LB65*/
*   IOINFOPT=''B;                   /*                       @Z40LB65*/
*                                                                  0448
         LA    @15,IOINFO                                          0448
         MVI   IOINFOPT(@15),X'00'                                 0448
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF THE WDS1 PARAMETER IS SPECIFIED.      @Z40LB65*/
*   /* THIS PARM INDICATES THAT A DSN WAS GIVEN AND THE UALLOC MACRO */
*   /* IS ISSUED TO OBTAIN A DDNAME FOR THE DSNAME. IF NOT SPECIFIED,*/
*   /* USE THE DDNAME FROM THE WFILE PARM.                   @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0449
*   IF ADDR(WDS1)^=NULLPTR THEN                                    0449
         L     @15,@PC00001+4                                      0449
         L     @15,FDTPTR+16(,@15)                                 0449
         LTR   @15,@15                                             0449
         BZ    @RF00449                                            0449
*     DO;                           /*                       @Z40LB65*/
*       RESPECIFY                                                  0451
*         ALLAGL BASED(ALL1PTR);    /*                       @Z40LB65*/
*       ALLDSN=ADDR(WDS1VAL);       /*                       @Z40LB65*/
         LA    @02,WDS1VAL(,@15)                                   0452
         ST    @02,ALLDSN(,ALL1PTR)                                0452
*       ALLSTSOD=ON;                /*                       @Z40LB65*/
         OI    ALLSTSOD(ALL1PTR),B'00000001'                       0453
*       ALLDSPKP=ON;                /*                       @Z40LB65*/
         OI    ALLDSPKP(ALL1PTR),B'00001000'                       0454
*       ALLOPTDS=ON;                /*                       @Z40LB65*/
*       ALLOPTVL=OFF;               /*                       @Z40LB65*/
         OI    ALLOPTDS(ALL1PTR),B'01000000'                       0456
         NI    ALLOPTVL(ALL1PTR),B'01111111'                       0456
*       ALLULP=ADDR(ULLIST);        /*                       @Z40LB65*/
         LA    @02,ULLIST                                          0457
         ST    @02,ALLULP(,ALL1PTR)                                0457
*       ULCOUNT=1;                  /*                       @Z40LB65*/
         MVC   ULCOUNT(2),@CH00218                                 0458
*       ULDEVLEN=LENGTH(ULCON);     /*                       @Z40LB65*/
         MVC   ULDEVLEN(2),@CH00285                                0459
*       ULDEVTYP=ULCON;             /*                       @Z40LB65*/
         MVI   ULDEVTYP+5,C' '                                     0460
         MVC   ULDEVTYP+6(2),ULDEVTYP+5                            0460
         MVC   ULDEVTYP(5),@CC01271                                0460
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/
         ST    @09,@AL00001                                        0461
         ST    ALL1PTR,@AL00001+4                                  0461
         MVI   @AL00001+4,X'80'                                    0461
         L     @15,GDTALC(,@09)                                    0461
         LA    @01,@AL00001                                        0461
         BALR  @14,@15                                             0461
*       RESPECIFY                                                  0462
*         RTNREG RSTD;                                             0462
*       TESTRC=RTNREG;                                             0463
         LR    TESTRC,RTNREG                                       0463
*       RESPECIFY                                                  0464
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0465
         LTR   TESTRC,TESTRC                                       0465
         BZ    @RF00465                                            0465
*         DO;                       /*                       @Z40LB65*/
*           OPENCODE=LASTCC12;      /*                       @Z40LB65*/
         LA    OPENCODE,12                                         0467
*           DDNAME1=''B;            /*                       @Z40LB65*/
         XC    DDNAME1(8),DDNAME1                                  0468
*         END;                      /*                       @Z40LB65*/
*       ELSE                                                       0470
*         DDNAME1=ALLDDN;           /*                       @Z40LB65*/
         B     @RC00465                                            0470
@RF00465 MVC   DDNAME1(8),ALLDDN(ALL1PTR)                          0470
*     END;                          /*                       @Z40LB65*/
*   ELSE                                                           0472
*     DDNAME1=FILE1VAL;             /*                       @Z40LB65*/
*                                                                  0472
         B     @RC00449                                            0472
@RF00449 L     @09,@PC00001+4                                      0472
         L     @09,FDTPTR+8(,@09)                                  0472
         MVC   DDNAME1(8),FILE1VAL(@09)                            0472
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE THE UIOINFO MACRO TO       @Z40LB65*/
*   /* RETRIEVE THE VOLSER FROM THE JFCB. USE THE DDNAME PLACED IN   */
*   /* THE DDNAME1 FIELD.                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   IF OPENCODE=LASTCC00 THEN                                      0473
@RC00449 LTR   OPENCODE,OPENCODE                                   0473
         BNZ   @RF00473                                            0473
*     DO;                           /*                       @Z40LB65*/
*       IOINFVOL=ON;                /*                       @Z40LB65*/
         LA    @09,IOINFO                                          0475
         OI    IOINFVOL(@09),B'01000000'                           0475
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,VOLSRPTR,DDNAME1);/*   @Z40LB65*/
         L     @02,@PC00001                                        0476
         ST    @02,@AL00001                                        0476
         ST    @09,@AL00001+4                                      0476
         LA    @09,VOLSRPTR                                        0476
         ST    @09,@AL00001+8                                      0476
         LA    @09,DDNAME1                                         0476
         ST    @09,@AL00001+12                                     0476
         MVI   @AL00001+12,X'80'                                   0476
         L     @15,GDTIFO(,@02)                                    0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*       RESPECIFY                                                  0477
*         RTNREG RSTD;                                             0477
*       TESTRC=RTNREG;                                             0478
         LR    TESTRC,RTNREG                                       0478
*       RESPECIFY                                                  0479
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0480
         LTR   TESTRC,TESTRC                                       0480
         BZ    @RF00480                                            0480
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/
         LA    OPENCODE,12                                         0481
*       WORKVOL1=VOLAREA(1);        /*                       @Z40LB65*/
@RF00480 MVC   WORKVOL1(6),VOLAREA                                 0482
*     END;                          /*                       @Z40LB65*/
*                                                                  0483
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE UMSSUNIT MACRO TO CHECK    @Z40LB65*/
*   /* THE WORK DATA SET FOR BEING ON A MASS STORAGE VOLUME. PRIOR TO*/
*   /* ISSUING THE MACRO TEST IF THE DATA SET WAS ALLOCATED          */
*   /* DYNAMICALLY. IF YES, PLACE THE VOLSER IN THE CKAGL PARM LIST  */
*   /* SO THAT IF AN ERROR OCCURS THE VOLSER WILL BE USED INSTEAD OF */
*   /* THE DDNAME                                            @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   IF OPENCODE=LASTCC00 THEN                                      0484
@RF00473 SLR   @09,@09                                             0484
         CR    OPENCODE,@09                                        0484
         BNE   @RF00484                                            0484
*     DO;                           /*                       @Z40LB65*/
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Z40LB65*/
         LA    @15,UCBPTR                                          0486
         ST    @15,CKUCBPTR(,CKPTR)                                0486
*       CKDDNAME=DDNAME1;           /*                       @Z40LB65*/
         MVC   CKDDNAME(8,CKPTR),DDNAME1                           0487
*       CKTESTVT=ON;                /*                       @Z40LB65*/
         OI    CKTESTVT(CKPTR),B'10000000'                         0488
*       IF ADDR(WDS1)^=NULLPTR THEN                                0489
         L     @15,@PC00001+4                                      0489
         C     @09,FDTPTR+16(,@15)                                 0489
         BE    @RF00489                                            0489
*         CKLABELP=ADDR(WORKVOL1);  /*                       @Z40LB65*/
         LA    @09,WORKVOL1                                        0490
         ST    @09,CKLABELP(,CKPTR)                                0490
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB65*/
@RF00489 L     @09,@PC00001                                        0491
         ST    @09,@AL00001                                        0491
         LA    @02,CHECK                                           0491
         ST    @02,@AL00001+4                                      0491
         ST    CKPTR,@AL00001+8                                    0491
         MVI   @AL00001+8,X'80'                                    0491
         L     @15,GDTUNT(,@09)                                    0491
         LA    @01,@AL00001                                        0491
         BALR  @14,@15                                             0491
*       RESPECIFY                                                  0492
*         RTNREG RSTD;                                             0492
*       TESTRC=RTNREG;                                             0493
         LR    TESTRC,RTNREG                                       0493
*       RESPECIFY                                                  0494
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0495
         LTR   TESTRC,TESTRC                                       0495
         BZ    @RF00495                                            0495
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/
         LA    OPENCODE,12                                         0496
*     END;                          /*                       @Z40LB65*/
*                                                                  0497
@RF00495 DS    0H                                                  0498
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE THE UEXCP MACRO TO OPEN    @Z40LB65*/
*   /* WORKDATASET1. UPON RETURN FROM SUCCESSFUL OPEN OF THE DATA SET*/
*   /* THE BEGINNING AND ENDING ADDRESS MUST BE ON A CYLINDER        */
*   /* BOUNDARY. IF NOT, THE BEG CYLINDER ADDR IS ROUNDED UP AND THE */
*   /* END CYL IS ROUNDED DOWN.                              @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0498
*   IF OPENCODE=LASTCC00 THEN                                      0498
@RF00484 LTR   OPENCODE,OPENCODE                                   0498
         BNZ   @RF00498                                            0498
*     DO;                           /*                       @Z40LB65*/
*       EXODDN=ADDR(DDNAME1);       /*                       @Z40LB65*/
         LA    @09,DDNAME1                                         0500
         ST    @09,EXODDN(,EXOPTR)                                 0500
*       EXOEXT=ADDR(EXTCHRS1);      /*                       @Z40LB65*/
         LA    @09,EXTCHRS1                                        0501
         ST    @09,EXOEXT(,EXOPTR)                                 0501
*       EXOCTLBK=ADDR(WORKPTR1);    /*                       @Z40LB65*/
         LA    @09,WORKPTR1                                        0502
         ST    @09,EXOCTLBK(,EXOPTR)                               0502
*       EXOTAB=ON;                  /*                       @Z40LB65*/
         OI    EXOTAB(EXOPTR),B'10000000'                          0503
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                 @Z40LB65*/
         L     @09,@PC00001                                        0504
         ST    @09,@AL00001                                        0504
         LA    @02,OPEN                                            0504
         ST    @02,@AL00001+4                                      0504
         ST    EXOPTR,@AL00001+8                                   0504
         MVI   @AL00001+8,X'80'                                    0504
         L     @15,GDTEXP(,@09)                                    0504
         LA    @01,@AL00001                                        0504
         BALR  @14,@15                                             0504
*       RESPECIFY                                                  0505
*         RTNREG RSTD;                                             0505
*       TESTRC=RTNREG;                                             0506
         LR    TESTRC,RTNREG                                       0506
*       RESPECIFY                                                  0507
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC=0 THEN                                           0508
         LTR   TESTRC,TESTRC                                       0508
         BNZ   @RF00508                                            0508
*         DO;                       /*                       @Z40LB65*/
*           IF STRK1^=NULL THEN                                    0510
         CLC   STRK1(2),NULL                                       0510
         BE    @RF00510                                            0510
*             SCYL1=SCYL1+1;        /*                       @Z40LB65*/
         LA    @09,1                                               0511
         LH    @15,SCYL1                                           0511
         N     @15,@CF01444                                        0511
         ALR   @09,@15                                             0511
         STH   @09,SCYL1                                           0511
*           IF ETRK1^=NULL THEN                                    0512
@RF00510 CLC   ETRK1(2),NULL                                       0512
         BE    @RF00512                                            0512
*             ECYL1=ECYL1-1;        /*                       @Z40LB65*/
         SLR   @09,@09                                             0513
         ICM   @09,3,ECYL1                                         0513
         BCTR  @09,0                                               0513
         STCM  @09,3,ECYL1                                         0513
*         END;                      /*                       @Z40LB65*/
*       ELSE                                                       0515
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/
         B     @RC00508                                            0515
@RF00508 LA    OPENCODE,12                                         0515
*     END;                          /*                       @Z40LB65*/
*                                                                  0516
@RC00508 DS    0H                                                  0517
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF THE WDS2 PARAMETER IS SPECIFIED.      @Z40LB65*/
*   /* THIS PARM INDICATES THAT A DSN WAS GIVEN AND THE UALLOC MACRO */
*   /* IS ISSUED TO OBTAIN A DDNAME FOR THE DSNAME. IF NOT SPECIFIED,*/
*   /* USE THE DDNAME FROM THE WFILE2 PARM.                  @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0517
*   IF ADDR(WDS2)^=NULLPTR THEN                                    0517
@RF00498 L     @09,@PC00001+4                                      0517
         L     @09,FDTPTR+20(,@09)                                 0517
         LTR   @09,@09                                             0517
         BZ    @RF00517                                            0517
*     DO;                           /*                       @Z40LB65*/
*       RESPECIFY                                                  0519
*         ALLAGL BASED(ALL2PTR);    /*                       @Z40LB65*/
*       ALLDSN=ADDR(WDS2VAL);       /*                       @Z40LB65*/
         LA    @09,WDS2VAL(,@09)                                   0520
         ST    @09,ALLDSN(,ALL2PTR)                                0520
*       ALLSTSOD=ON;                /*                       @Z40LB65*/
         OI    ALLSTSOD(ALL2PTR),B'00000001'                       0521
*       ALLDSPKP=ON;                /*                       @Z40LB65*/
         OI    ALLDSPKP(ALL2PTR),B'00001000'                       0522
*       ALLOPTDS=ON;                /*                       @Z40LB65*/
*       ALLOPTVL=OFF;               /*                       @Z40LB65*/
         OI    ALLOPTDS(ALL2PTR),B'01000000'                       0524
         NI    ALLOPTVL(ALL2PTR),B'01111111'                       0524
*       ALLULP=ADDR(ULLIST);        /*                       @Z40LB65*/
         LA    @09,ULLIST                                          0525
         ST    @09,ALLULP(,ALL2PTR)                                0525
*       ULCOUNT=1;                  /*                       @Z40LB65*/
         MVC   ULCOUNT(2),@CH00218                                 0526
*       ULDEVLEN=LENGTH(ULCON);     /*                       @Z40LB65*/
         MVC   ULDEVLEN(2),@CH00285                                0527
*       ULDEVTYP=ULCON;             /*                       @Z40LB65*/
         MVI   ULDEVTYP+5,C' '                                     0528
         MVC   ULDEVTYP+6(2),ULDEVTYP+5                            0528
         MVC   ULDEVTYP(5),@CC01271                                0528
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/
         L     @09,@PC00001                                        0529
         ST    @09,@AL00001                                        0529
         ST    ALL2PTR,@AL00001+4                                  0529
         MVI   @AL00001+4,X'80'                                    0529
         L     @15,GDTALC(,@09)                                    0529
         LA    @01,@AL00001                                        0529
         BALR  @14,@15                                             0529
*       RESPECIFY                                                  0530
*         RTNREG RSTD;                                             0530
*       TESTRC=RTNREG;                                             0531
         LR    TESTRC,RTNREG                                       0531
*       RESPECIFY                                                  0532
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0533
         LTR   TESTRC,TESTRC                                       0533
         BZ    @RF00533                                            0533
*         DO;                       /*                       @Z40LB65*/
*           OPENCODE=LASTCC12;      /*                       @Z40LB65*/
         LA    OPENCODE,12                                         0535
*           DDNAME2=''B;            /*                       @Z40LB65*/
         XC    DDNAME2(8),DDNAME2                                  0536
*         END;                      /*                       @Z40LB65*/
*       ELSE                                                       0538
*         DDNAME2=ALLDDN;           /*                       @Z40LB65*/
         B     @RC00533                                            0538
@RF00533 MVC   DDNAME2(8),ALLDDN(ALL2PTR)                          0538
*     END;                          /*                       @Z40LB65*/
*   ELSE                                                           0540
*     DDNAME2=FILE2VAL;             /*                       @Z40LB65*/
*                                                                  0540
         B     @RC00517                                            0540
@RF00517 L     @09,@PC00001+4                                      0540
         L     @09,FDTPTR+12(,@09)                                 0540
         MVC   DDNAME2(8),FILE2VAL(@09)                            0540
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE THE UIOINFO MACRO TO       @Z40LB65*/
*   /* RETRIEVE THE VOLSER FROM THE JFCB. USE THE DDNAME PLACED IN   */
*   /* THE DDNAME2 FIELD.                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*   IF OPENCODE=LASTCC00 THEN                                      0541
@RC00517 LTR   OPENCODE,OPENCODE                                   0541
         BNZ   @RF00541                                            0541
*     DO;                           /*                       @Z40LB65*/
*       IOINFVOL=ON;                /*                       @Z40LB65*/
         LA    @09,IOINFO                                          0543
         OI    IOINFVOL(@09),B'01000000'                           0543
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,VOLSRPTR,DDNAME2);/*   @Z40LB65*/
         L     @02,@PC00001                                        0544
         ST    @02,@AL00001                                        0544
         ST    @09,@AL00001+4                                      0544
         LA    @09,VOLSRPTR                                        0544
         ST    @09,@AL00001+8                                      0544
         LA    @09,DDNAME2                                         0544
         ST    @09,@AL00001+12                                     0544
         MVI   @AL00001+12,X'80'                                   0544
         L     @15,GDTIFO(,@02)                                    0544
         LA    @01,@AL00001                                        0544
         BALR  @14,@15                                             0544
*       RESPECIFY                                                  0545
*         RTNREG RSTD;                                             0545
*       TESTRC=RTNREG;                                             0546
         LR    TESTRC,RTNREG                                       0546
*       RESPECIFY                                                  0547
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0548
         LTR   TESTRC,TESTRC                                       0548
         BZ    @RF00548                                            0548
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/
         LA    OPENCODE,12                                         0549
*       WORKVOL2=VOLAREA(1);        /*                       @Z40LB65*/
@RF00548 MVC   WORKVOL2(6),VOLAREA                                 0550
*     END;                          /*                       @Z40LB65*/
*                                                                  0551
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE UMSSUNIT MACRO TO CHECK    @Z40LB65*/
*   /* THE WORK DATA SET FOR BEING ON A MASS STORAGE VOLUME. PRIOR TO*/
*   /* ISSUING THE MACRO TEST IF THE DATA SET WAS ALLOCATED          */
*   /* DYNAMICALLY. IF YES, PLACE THE VOLSER IN THE CKAGL PARM LIST  */
*   /* SO THAT IF AN ERROR OCCURS THE VOLSER WILL BE USED INSTEAD OF */
*   /* THE DDNAME                                            @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0552
*   IF OPENCODE=LASTCC00 THEN                                      0552
@RF00541 SLR   @09,@09                                             0552
         CR    OPENCODE,@09                                        0552
         BNE   @RF00552                                            0552
*     DO;                           /*                       @Z40LB65*/
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Z40LB65*/
         LA    @15,UCBPTR                                          0554
         ST    @15,CKUCBPTR(,CKPTR)                                0554
*       CKDDNAME=DDNAME2;           /*                       @Z40LB65*/
         MVC   CKDDNAME(8,CKPTR),DDNAME2                           0555
*       CKTESTVT=ON;                /*                       @Z40LB65*/
         OI    CKTESTVT(CKPTR),B'10000000'                         0556
*       IF ADDR(WDS2)^=NULLPTR THEN                                0557
         L     @15,@PC00001+4                                      0557
         C     @09,FDTPTR+20(,@15)                                 0557
         BE    @RF00557                                            0557
*         CKLABELP=ADDR(WORKVOL2);  /*                       @Z40LB65*/
         LA    @09,WORKVOL2                                        0558
         ST    @09,CKLABELP(,CKPTR)                                0558
*       ELSE                                                       0559
*         CKLABELP=''B;             /*                       @Z40LB65*/
         B     @RC00557                                            0559
@RF00557 SLR   @09,@09                                             0559
         ST    @09,CKLABELP(,CKPTR)                                0559
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB65*/
@RC00557 L     @09,@PC00001                                        0560
         ST    @09,@AL00001                                        0560
         LA    @02,CHECK                                           0560
         ST    @02,@AL00001+4                                      0560
         ST    CKPTR,@AL00001+8                                    0560
         MVI   @AL00001+8,X'80'                                    0560
         L     @15,GDTUNT(,@09)                                    0560
         LA    @01,@AL00001                                        0560
         BALR  @14,@15                                             0560
*       RESPECIFY                                                  0561
*         RTNREG RSTD;                                             0561
*       TESTRC=RTNREG;                                             0562
         LR    TESTRC,RTNREG                                       0562
*       RESPECIFY                                                  0563
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC^=0 THEN                                          0564
         LTR   TESTRC,TESTRC                                       0564
         BZ    @RF00564                                            0564
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/
         LA    OPENCODE,12                                         0565
*     END;                          /*                       @Z40LB65*/
*                                                                  0566
@RF00564 DS    0H                                                  0567
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE THE UEXCP MACRO TO OPEN    @Z40LB65*/
*   /* WORKDATASET2. UPON RETURN FROM SUCCESSFUL OPEN OF THE DATA SET*/
*   /* THE BEGINNING AND ENDING ADDRESS MUST BE ON A CYLINDER        */
*   /* BOUNDARY. IF NOT, THE BEG CYLINDER ADDR IS ROUNDED UP AND THE */
*   /* END CYL IS ROUNDED DOWN.                              @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0567
*   IF OPENCODE=LASTCC00 THEN                                      0567
@RF00552 LTR   OPENCODE,OPENCODE                                   0567
         BNZ   @RF00567                                            0567
*     DO;                           /*                       @Z40LB65*/
*       EXODDN=ADDR(DDNAME2);       /*                       @Z40LB65*/
         LA    @09,DDNAME2                                         0569
         ST    @09,EXODDN(,EXOPTR)                                 0569
*       EXOEXT=ADDR(EXTCHRS2);      /*                       @Z40LB65*/
         LA    @09,EXTCHRS2                                        0570
         ST    @09,EXOEXT(,EXOPTR)                                 0570
*       EXOCTLBK=ADDR(WORKPTR2);    /*                       @Z40LB65*/
         LA    @09,WORKPTR2                                        0571
         ST    @09,EXOCTLBK(,EXOPTR)                               0571
*       EXOTAB=ON;                  /*                       @Z40LB65*/
         OI    EXOTAB(EXOPTR),B'10000000'                          0572
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                 @Z40LB65*/
         L     @09,@PC00001                                        0573
         ST    @09,@AL00001                                        0573
         LA    @05,OPEN                                            0573
         ST    @05,@AL00001+4                                      0573
         ST    EXOPTR,@AL00001+8                                   0573
         MVI   @AL00001+8,X'80'                                    0573
         L     @15,GDTEXP(,@09)                                    0573
         LA    @01,@AL00001                                        0573
         BALR  @14,@15                                             0573
*       RESPECIFY                                                  0574
*         RTNREG RSTD;                                             0574
*       TESTRC=RTNREG;                                             0575
         LR    TESTRC,RTNREG                                       0575
*       RESPECIFY                                                  0576
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*       IF TESTRC=0 THEN                                           0577
         LTR   TESTRC,TESTRC                                       0577
         BNZ   @RF00577                                            0577
*         DO;                       /*                       @Z40LB65*/
*           IF STRK2^=NULL THEN                                    0579
         CLC   STRK2(2),NULL                                       0579
         BE    @RF00579                                            0579
*             SCYL2=SCYL2+1;        /*                       @Z40LB65*/
         LA    @09,1                                               0580
         LH    @06,SCYL2                                           0580
         N     @06,@CF01444                                        0580
         ALR   @09,@06                                             0580
         STH   @09,SCYL2                                           0580
*           IF ETRK2^=NULL THEN                                    0581
@RF00579 CLC   ETRK2(2),NULL                                       0581
         BE    @RF00581                                            0581
*             ECYL2=ECYL2-1;        /*                       @Z40LB65*/
         SLR   @09,@09                                             0582
         ICM   @09,3,ECYL2                                         0582
         BCTR  @09,0                                               0582
         STCM  @09,3,ECYL2                                         0582
*         END;                      /*                       @Z40LB65*/
*       ELSE                                                       0584
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/
         B     @RC00577                                            0584
@RF00577 LA    OPENCODE,12                                         0584
*     END;                          /*                       @Z40LB65*/
@RC00577 DS    0H                                                  0586
*   RETURN CODE(OPENCODE);          /*                       @Z40LB65*/
@RF00567 LR    @15,OPENCODE                                        0586
         L     @13,4(,@13)                                         0586
         L     @14,12(,@13)                                        0586
         LM    @00,@12,20(@13)                                     0586
         BR    @14                                                 0586
*   END OPENPROC;                   /*                       @Z40LB65*/
*                                                                  0588
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - COPYPROC                            @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE BINDS THE SPACE OF THE WORK  @Z40LB65*/
*/*                DATA SETS AND COPIES THE PRIMARY AND      @Z40LB65*/
*/*                SECONDARY MSC TABLES TO THEM.             @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - FDTTBL AND WORK AREA CALLED INTTBL           @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Z40LB65*/
*/*              0 = SUCCESSFUL COMPLETION                   @Z40LB65*/
*/*              12 = UNSUCCESSFUL COMPLETION                @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0588
*COPYPROC:                                                         0588
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
*                                                                  0588
COPYPROC STM   @14,@12,12(@13)                                     0588
         ST    @13,@SA00003+4                                      0588
         LA    @14,@SA00003                                        0588
         ST    @14,8(,@13)                                         0588
         LR    @13,@14                                             0588
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0589
*   DCL                                                            0589
*     COPYCODE FIXED(15);           /* COPYPROC RETURN CODE  @Z40LB65*/
*   DCL                                                            0590
*     ECBCODE CHAR(1);              /* ECB CODE FROM USSC    @Z40LB65*/
*   DCL                                                            0591
*     ECBLEN FIXED(31) CONSTANT(4); /* LENGTH OF ECB         @Z40LB65*/
*                                                                  0591
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE INDEXES FOR THE TABLE ENTRIES IN THE          @Z40LB65*/
*   /* MESSAGE RETURNED FROM USSC.                           @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0592
*   DCL                                                            0592
*     SDGINDEX FIXED(8) CONSTANT(1);/* SDG INDEX             @Z40LB65*/
*   DCL                                                            0593
*     VVAINDEX FIXED(8) CONSTANT(10);/* VVA INDEX            @Z40LB65*/
*   DCL                                                            0594
*     DOINDEX FIXED(8) CONSTANT(13);/* DIAG/OVLY INDEX       @Z40LB65*/
*   DCL                                                            0595
*     HEX0 CHAR(2) STATIC INIT('0000'X);/* ARCOMPC CODE      @ZA14727*/
*   OLDERID2=NEWERID2;                                             0596
         L     @05,@PC00001                                        0596
         L     @15,GDTTR2(,@05)                                    0596
         MVC   @TS00001(95),NEWERID2(@15)                          0596
         MVC   OLDERID2(95,@15),@TS00001                           0596
*   NEWID2='CPCA';                  /*                       @Z40LB65*/
         MVC   NEWID2(4,@15),@CC01328                              0597
*   COPYCODE=''B;                   /*                       @Z40LB65*/
*                                                                  0598
         SLR   COPYCODE,COPYCODE                                   0598
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE USSC MACRO WITH THE ACQUIRE OPTION TO BIND  @Z40LB65*/
*   /* THE WDS1 & WDS2 SPACE BY SPECIFYING THE BIND OPTION.  @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0599
*   ARLL=LENGTH(ACQLIST);           /*                       @Z40LB65*/
         L     @15,ACQPTR                                          0599
         MVC   ARLL(4,@15),@CF01205                                0599
*   AROP=2;                         /*                       @Z40LB65*/
         MVI   AROP(@15),X'02'                                     0600
*   ARBDUBD=ON;                     /*                       @Z40LB65*/
*   ARINH=ON;                       /*                       @Z40LB65*/
         OI    ARBDUBD(@15),B'10100000'                            0602
*   ARNMEXT=1;                      /*                       @Z40LB65*/
         MVI   ARNMEXT(@15),X'01'                                  0603
*   ARVOL=WORKVOL2;                 /*                       @Z40LB65*/
         MVC   ARVOL(6,@15),WORKVOL2                               0604
*   AREXT(1,1:2)=SCYL2;             /*                       @Z40LB65*/
         MVC   AREXT(2,@15),SCYL2                                  0605
*   AREXT(1,3:4)=ECYL2;             /*                       @Z40LB65*/
*                                                                  0606
         MVC   AREXT+2(2,@15),ECYL2                                0606
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        @Z40LB65*/
*   /* USSC PARM LIST FOR WDS2 ACQUIRE                       @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0607
*   IF GDTDBG=NULLPTR THEN                                         0607
         L     @05,GDTDBG(,@05)                                    0607
         LTR   @05,@05                                             0607
         BZ    @RT00607                                            0607
*     ;                                                            0608
*   ELSE                                                           0609
*     DO;                                                          0609
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Z40LB65*/
         LA    DMPINDEX,DMPSTG                                     0610
*       DMPITMNM='ACQLST2';                                        0611
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0611
         MVC   DMPITMNM(7,DMPINDEX),@CC01329                       0611
*       DMPITMPT=ADDR(ACQLST2);                                    0612
         LA    @05,ACQLST2                                         0612
         ST    @05,DMPITMPT(,DMPINDEX)                             0612
*       DMPITMLN=LENGTH(ACQLIST);                                  0613
         MVC   DMPITMLN(2,DMPINDEX),@CH01205                       0613
*       DMPITMTP='H';                                              0614
         MVI   DMPITMTP(DMPINDEX),C'H'                             0614
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Z40LB65*/
         AL    DMPINDEX,@CF00473                                   0615
*       DMPTRM=DMPTRMVL;                                           0616
         MVI   DMPTRM(DMPINDEX),X'FF'                              0616
*     END;                          /*                       @Z40LB65*/
*   IF GDTDBG=NULLPTR THEN                                         0618
@RT00607 L     @05,@PC00001                                        0618
         L     @05,GDTDBG(,@05)                                    0618
         LTR   @05,@05                                             0618
         BZ    @RT00618                                            0618
*     ;                                                            0619
*   ELSE                                                           0620
*     CALL IDCDB010(GDTTBL,'CPCB',ADDR(DMPSTG));/*           @Z40LB65*/
         L     @05,@PC00001                                        0620
         ST    @05,@AL00001                                        0620
         LA    @15,@CC01331                                        0620
         ST    @15,@AL00001+4                                      0620
         LA    @15,DMPSTG                                          0620
         ST    @15,@AFTEMPS                                        0620
         LA    @15,@AFTEMPS                                        0620
         ST    @15,@AL00001+8                                      0620
         MVI   @AL00001+8,X'80'                                    0620
         L     @15,GDTDBG(,@05)                                    0620
         LA    @01,@AL00001                                        0620
         BALR  @14,@15                                             0620
*   ACQPTR=ADDR(ACQLST1);           /*                       @Z40LB65*/
@RT00618 LA    @05,ACQLST1                                         0621
         ST    @05,ACQPTR                                          0621
*   ARLL=LENGTH(ACQLIST);           /*                       @Z40LB65*/
         MVC   ARLL(4,@05),@CF01205                                0622
*   AROP=2;                         /*                       @Z40LB65*/
         MVI   AROP(@05),X'02'                                     0623
*   ARBDUBD=ON;                     /*                       @Z40LB65*/
*   ARINH=ON;                       /*                       @Z40LB65*/
         OI    ARBDUBD(@05),B'10100000'                            0625
*   ARNMEXT=1;                      /*                       @Z40LB65*/
         MVI   ARNMEXT(@05),X'01'                                  0626
*   ARVOL=WORKVOL1;                 /*                       @Z40LB65*/
         MVC   ARVOL(6,@05),WORKVOL1                               0627
*   AREXT(1,1:2)=SCYL1;             /*                       @Z40LB65*/
         MVC   AREXT(2,@05),SCYL1                                  0628
*   AREXT(1,3:4)=ECYL1;             /*                       @Z40LB65*/
         MVC   AREXT+2(2,@05),ECYL1                                0629
*   ARNEDB=ADDR(ACQLST2);           /*                       @Z40LB65*/
*                                                                  0630
         LA    @15,ACQLST2                                         0630
         ST    @15,ARNEDB(,@05)                                    0630
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        @Z40LB65*/
*   /* USSC PARM LIST FOR WDS1 ACQUIRE                       @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0631
*   IF GDTDBG=NULLPTR THEN                                         0631
         L     @05,@PC00001                                        0631
         L     @05,GDTDBG(,@05)                                    0631
         LTR   @05,@05                                             0631
         BZ    @RT00631                                            0631
*     ;                                                            0632
*   ELSE                                                           0633
*     DO;                                                          0633
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Z40LB65*/
         LA    DMPINDEX,DMPSTG                                     0634
*       DMPITMNM='ACQLST1';                                        0635
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0635
         MVC   DMPITMNM(7,DMPINDEX),@CC01332                       0635
*       DMPITMPT=ADDR(ACQLST1);                                    0636
         LA    @05,ACQLST1                                         0636
         ST    @05,DMPITMPT(,DMPINDEX)                             0636
*       DMPITMLN=LENGTH(ACQLIST);                                  0637
         MVC   DMPITMLN(2,DMPINDEX),@CH01205                       0637
*       DMPITMTP='H';                                              0638
         MVI   DMPITMTP(DMPINDEX),C'H'                             0638
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Z40LB65*/
         AL    DMPINDEX,@CF00473                                   0639
*       DMPTRM=DMPTRMVL;                                           0640
         MVI   DMPTRM(DMPINDEX),X'FF'                              0640
*     END;                          /*                       @Z40LB65*/
*   IF GDTDBG=NULLPTR THEN                                         0642
@RT00631 L     @05,@PC00001                                        0642
         L     @05,GDTDBG(,@05)                                    0642
         LTR   @05,@05                                             0642
         BZ    @RT00642                                            0642
*     ;                                                            0643
*   ELSE                                                           0644
*     CALL IDCDB010(GDTTBL,'CPCC',ADDR(DMPSTG));/*           @Z40LB65*/
         L     @05,@PC00001                                        0644
         ST    @05,@AL00001                                        0644
         LA    @15,@CC01333                                        0644
         ST    @15,@AL00001+4                                      0644
         LA    @15,DMPSTG                                          0644
         ST    @15,@AFTEMPS                                        0644
         LA    @15,@AFTEMPS                                        0644
         ST    @15,@AL00001+8                                      0644
         MVI   @AL00001+8,X'80'                                    0644
         L     @15,GDTDBG(,@05)                                    0644
         LA    @01,@AL00001                                        0644
         BALR  @14,@15                                             0644
*   CALL IDCSASS0(GDTTBL,ACQUIRE,ACQPTR,REASONCD);/*         @Z40LB65*/
@RT00642 L     @05,@PC00001                                        0645
         ST    @05,@AL00001                                        0645
         LA    @02,ACQUIRE                                         0645
         ST    @02,@AL00001+4                                      0645
         LA    @02,ACQPTR                                          0645
         ST    @02,@AL00001+8                                      0645
         LA    @02,REASONCD                                        0645
         ST    @02,@AL00001+12                                     0645
         MVI   @AL00001+12,X'80'                                   0645
         L     @15,GDTSSC(,@05)                                    0645
         LA    @01,@AL00001                                        0645
         BALR  @14,@15                                             0645
*   RESPECIFY                                                      0646
*     RTNREG RSTD;                                                 0646
*   TESTRC=RTNREG;                                                 0647
         LR    TESTRC,RTNREG                                       0647
*   RESPECIFY                                                      0648
*     RTNREG UNRSTD;                /*                       @Z40LB65*/
*   IF TESTRC=4 THEN                                               0649
         C     TESTRC,@CF00041                                     0649
         BNE   @RF00649                                            0649
*     DO;                           /*                       @Z40LB65*/
*                                                                  0650
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE         @Z40LB65*/
*       /* REASON WHY A NON-ZERO REASON CODE WAS RETURNED.   @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0651
*       CALL SSCMSG(REASONCD);      /*                       @Z40LB65*/
         LA    @15,REASONCD                                        0651
         ST    @15,@AL00001                                        0651
         LA    @01,@AL00001                                        0651
         BAL   @14,SSCMSG                                          0651
*       COPYCODE=LASTCC12;          /*                       @Z40LB65*/
*                                                                  0652
         LA    COPYCODE,12                                         0652
*       /*************************************************************/
*       /*                                                           */
*       /* NEXT WE CHECK WHICH (OR BOTH) ACQUIRES FAILED. WE WILL    */
*       /* NEED TO DO RELINQUISHES TO UNBIND SPACE LATER.    @ZA14727*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0653
*       ACQPTR=ADDR(ACQLST2);       /*                       @ZA14727*/
         LA    @05,ACQLST2                                         0653
         ST    @05,ACQPTR                                          0653
*       IF ARCOMPC=HEX0 THEN        /*                       @ZA14727*/
         CLC   ARCOMPC(2,@05),HEX0                                 0654
         BNE   @RF00654                                            0654
*         ACQSW2=ON;                /*                       @ZA14727*/
         OI    ACQSW2,B'00001000'                                  0655
*       ACQPTR=ADDR(ACQLST1);       /*                       @ZA14727*/
@RF00654 LA    @05,ACQLST1                                         0656
         ST    @05,ACQPTR                                          0656
*       IF ARCOMPC=HEX0 THEN        /*                       @ZA14727*/
         CLC   ARCOMPC(2,@05),HEX0                                 0657
         BNE   @RF00657                                            0657
*         ACQSW1=ON;                /*                       @ZA14727*/
         OI    ACQSW1,B'00010000'                                  0658
*     END;                          /*                       @X50AC65*/
*                                                                  0659
@RF00657 DS    0H                                                  0660
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYCODE = 0 INITIALIZE THE COTBLIST PARM LIST     @Z40LB65*/
*   /* FOR THE COPYTABL ORDER OF THE USSC MACRO FOR WDS1.    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0660
*   IF COPYCODE=LASTCC00 THEN                                      0660
@RF00649 SLR   @05,@05                                             0660
         CR    COPYCODE,@05                                        0660
         BNE   @RF00660                                            0660
*     DO;                           /*                       @Z40LB65*/
*       ACQSW1=ON;                  /*                       @ZA14727*/
*       ACQSW2=ON;                  /*                       @ZA14727*/
         OI    ACQSW1,B'00011000'                                  0663
*       DCOTBTID=COPYPRIM;          /*                       @Z40LB65*/
         MVC   DCOTBTID(1),COPYPRIM                                0664
*       COTBEXTS(1:2)=SCYL1;        /*                       @Z40LB65*/
         MVC   COTBEXTS(2),SCYL1                                   0665
*       COTBEXTS(3:4)=ECYL1;        /*                       @Z40LB65*/
         MVC   COTBEXTS+2(2),ECYL1                                 0666
*       COTBVOL=WORKVOL1;           /*                       @Z40LB65*/
*                                                                  0667
         MVC   COTBVOL(6),WORKVOL1                                 0667
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF    @Z40LB65*/
*       /* USSC PARM LIST                                    @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0668
*       IF GDTDBG=NULLPTR THEN                                     0668
         L     @15,@PC00001                                        0668
         C     @05,GDTDBG(,@15)                                    0668
         BE    @RT00668                                            0668
*         ;                                                        0669
*       ELSE                                                       0670
*         DO;                                                      0670
*           DMPINDEX=ADDR(DMPSTG);  /*                       @Z40LB65*/
         LA    DMPINDEX,DMPSTG                                     0671
*           DMPITMNM='COTBLIST';                                   0672
         MVC   DMPITMNM(8,DMPINDEX),@CC01334                       0672
*           DMPITMPT=ADDR(COTBLIST);                               0673
         LA    @05,COTBLIST                                        0673
         ST    @05,DMPITMPT(,DMPINDEX)                             0673
*           DMPITMLN=LENGTH(COTBLIST);                             0674
         MVC   DMPITMLN(2,DMPINDEX),@CH00309                       0674
*           DMPITMTP='H';                                          0675
         MVI   DMPITMTP(DMPINDEX),C'H'                             0675
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0676
         AL    DMPINDEX,@CF00473                                   0676
*           DMPTRM=DMPTRMVL;                                       0677
         MVI   DMPTRM(DMPINDEX),X'FF'                              0677
*         END;                      /*                       @Z40LB65*/
*       IF GDTDBG=NULLPTR THEN                                     0679
@RT00668 L     @05,@PC00001                                        0679
         L     @05,GDTDBG(,@05)                                    0679
         LTR   @05,@05                                             0679
         BZ    @RT00679                                            0679
*         ;                                                        0680
*       ELSE                                                       0681
*         CALL IDCDB010(GDTTBL,'CPCD',ADDR(DMPSTG));/*       @Z40LB65*/
*                                                                  0681
         L     @05,@PC00001                                        0681
         ST    @05,@AL00001                                        0681
         LA    @15,@CC01335                                        0681
         ST    @15,@AL00001+4                                      0681
         LA    @15,DMPSTG                                          0681
         ST    @15,@AFTEMPS                                        0681
         LA    @15,@AFTEMPS                                        0681
         ST    @15,@AL00001+8                                      0681
         MVI   @AL00001+8,X'80'                                    0681
         L     @15,GDTDBG(,@05)                                    0681
         LA    @01,@AL00001                                        0681
         BALR  @14,@15                                             0681
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE COPY TABLE OPTION OF THE USSC MACRO TO  @Z40LB65*/
*       /* COPY THE PRIMARY MSC TABLES TO WDS1.              @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0682
*       CALL IDCSASS0(GDTTBL,COPYTABL,COTPTR,REASONCD,ECBCODE,CTMSGPTR)
*           ;                                                      0682
@RT00679 L     @05,@PC00001                                        0682
         ST    @05,@AL00001                                        0682
         LA    @02,COPYTABL                                        0682
         ST    @02,@AL00001+4                                      0682
         LA    @02,COTPTR                                          0682
         ST    @02,@AL00001+8                                      0682
         LA    @02,REASONCD                                        0682
         ST    @02,@AL00001+12                                     0682
         LA    @02,ECBCODE                                         0682
         ST    @02,@AL00001+16                                     0682
         LA    @02,CTMSGPTR                                        0682
         ST    @02,@AL00001+20                                     0682
         MVI   @AL00001+20,X'80'                                   0682
         L     @15,GDTSSC(,@05)                                    0682
         LA    @01,@AL00001                                        0682
         BALR  @14,@15                                             0682
*       RESPECIFY                                                  0683
*         RTNREG RSTD;                                             0683
*       TESTRC=RTNREG;                                             0684
         LR    TESTRC,RTNREG                                       0684
*       RESPECIFY                                                  0685
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*                                                                  0685
*       /*************************************************************/
*       /*                                                           */
*       /* TEST THE RETURN CODE FROM USSC. IF THE RETURN     @Z40LB65*/
*       /* CODE IS 04 CALL SSCMSG TO PRINT OUT MESSAGE TO EXPLAIN THE*/
*       /* ERROR. IF THE RETURN CODE IS 04 OR 08 ISSUE THE UPRINT    */
*       /* MACRO TO PRINT MESSAGE IDC31180I INDICATING THE TABLES    */
*       /* COULD NOT BE COPIED.                              @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0686
*       IF TESTRC=4 THEN                                           0686
         C     TESTRC,@CF00041                                     0686
         BNE   @RF00686                                            0686
*         CALL SSCMSG(REASONCD,ECBCODE);/*                   @Z40LB65*/
         LA    @05,REASONCD                                        0687
         ST    @05,@AL00001                                        0687
         LA    @05,ECBCODE                                         0687
         ST    @05,@AL00001+4                                      0687
         LA    @01,@AL00001                                        0687
         BAL   @14,SSCMSG                                          0687
*       IF TESTRC=4×TESTRC=8 THEN                                  0688
@RF00686 C     TESTRC,@CF00041                                     0688
         BE    @RT00688                                            0688
         C     TESTRC,@CF00178                                     0688
         BNE   @RF00688                                            0688
@RT00688 DS    0H                                                  0689
*         DO;                       /*                       @Z40LB65*/
*           COPYCODE=LASTCC12;      /*                       @Z40LB65*/
         LA    COPYCODE,12                                         0690
*           DARGSENT=MSG31180;      /*                       @Z40LB65*/
         L     @05,DDSTRU                                          0691
         MVI   DARGSENT(@05),X'01'                                 0691
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB65*/
         L     @05,@PC00001                                        0692
         ST    @05,@AL00001                                        0692
         LA    @15,@CF00114                                        0692
         ST    @15,@AL00001+4                                      0692
         LA    @15,DDSTRU                                          0692
         ST    @15,@AL00001+8                                      0692
         MVI   @AL00001+8,X'80'                                    0692
         L     @15,GDTPRT(,@05)                                    0692
         LA    @01,@AL00001                                        0692
         BALR  @14,@15                                             0692
*         END;                      /*                       @Z40LB65*/
*       ELSE                                                       0694
*         DO;                       /*                       @Z40LB65*/
*                                                                  0694
         B     @RC00688                                            0694
@RF00688 DS    0H                                                  0695
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        */
*           /*                                               @Z40LB65*/
*           /* THE RETURNED MESSAGE AREA                     @Z40LB65*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0695
*           IF GDTDBG=NULLPTR THEN                                 0695
         L     @05,@PC00001                                        0695
         L     @05,GDTDBG(,@05)                                    0695
         LTR   @05,@05                                             0695
         BZ    @RT00695                                            0695
*             ;                                                    0696
*           ELSE                                                   0697
*             DO;                                                  0697
*               DMPINDEX=ADDR(DMPSTG);/*                     @Z40LB65*/
         LA    DMPINDEX,DMPSTG                                     0698
*               DMPITMNM='CTMSG';                                  0699
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0699
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0699
         MVC   DMPITMNM(5,DMPINDEX),@CC01336                       0699
*               DMPITMPT=ADDR(CTMSG);                              0700
         L     @05,CTMSGPTR                                        0700
         ST    @05,DMPITMPT(,DMPINDEX)                             0700
*               DMPITMLN=LENGTH(CTMSG)+4;                          0701
         MVC   DMPITMLN(2,DMPINDEX),@CH01208                       0701
*               DMPITMTP='H';                                      0702
         MVI   DMPITMTP(DMPINDEX),C'H'                             0702
*               DMPINDEX=DMPINDEX+DMPELEMT;                        0703
         AL    DMPINDEX,@CF00473                                   0703
*               DMPTRM=DMPTRMVL;                                   0704
         MVI   DMPTRM(DMPINDEX),X'FF'                              0704
*             END;                  /*                       @Z40LB65*/
*           IF GDTDBG=NULLPTR THEN                                 0706
@RT00695 L     @05,@PC00001                                        0706
         L     @05,GDTDBG(,@05)                                    0706
         LTR   @05,@05                                             0706
         BZ    @RT00706                                            0706
*             ;                                                    0707
*           ELSE                                                   0708
*             CALL IDCDB010(GDTTBL,'CPCE',ADDR(DMPSTG));/*   @Z40LB65*/
         L     @05,@PC00001                                        0708
         ST    @05,@AL00001                                        0708
         LA    @15,@CC01337                                        0708
         ST    @15,@AL00001+4                                      0708
         LA    @15,DMPSTG                                          0708
         ST    @15,@AFTEMPS                                        0708
         LA    @15,@AFTEMPS                                        0708
         ST    @15,@AL00001+8                                      0708
         MVI   @AL00001+8,X'80'                                    0708
         L     @15,GDTDBG(,@05)                                    0708
         LA    @01,@AL00001                                        0708
         BALR  @14,@15                                             0708
*         END;                      /*                       @Z40LB65*/
@RT00706 DS    0H                                                  0710
*     END;                          /*                       @Z40LB65*/
*                                                                  0710
@RC00688 DS    0H                                                  0711
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYCODE = 0 RETRIEVE THE NECESSARY ADDRESSES      @Z40LB65*/
*   /* FROM THE MESSAGE AREA AND PLACE THEM IN THE           @Z40LB65*/
*   /* INTTBL WORK AREA.                                     @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0711
*   IF COPYCODE=LASTCC00 THEN                                      0711
@RF00660 LTR   COPYCODE,COPYCODE                                   0711
         BNZ   @RF00711                                            0711
*     DO;                           /*                       @Z40LB65*/
*       CTMSGPTR=CTMSGPTR+ECBLEN;   /*                       @Z40LB65*/
*                                                                  0713
         LA    @05,4                                               0713
         L     @15,CTMSGPTR                                        0713
         ALR   @15,@05                                             0713
         ST    @15,CTMSGPTR                                        0713
*       /*************************************************************/
*       /*                                                           */
*       /* RETRIEVE THE ADDRESS FOR THE SDG RECORDS          @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0714
*       SDGC=CTTBLCC(SDGINDEX);     /*                       @Z40LB65*/
         SLR   @14,@14                                             0714
         IC    @14,CTTBLCC(,@15)                                   0714
         STC   @14,SDGC                                            0714
*       SDGH=CTTBLHH(SDGINDEX);     /*                       @Z40LB65*/
         MVC   SDGH(1),CTTBLHH(@15)                                0715
*       SDGR=CTTBLRR(SDGINDEX);     /*                       @Z40LB65*/
*                                                                  0716
         MVC   SDGR(1),CTTBLRR(@15)                                0716
*       /*************************************************************/
*       /*                                                           */
*       /* RETRIEVE THE ADDRESS FOR THE VVA RECORD           @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0717
*       VVAC=CTTBLCC(VVAINDEX);     /*                       @Z40LB65*/
         MVC   VVAC(1),CTTBLCC+36(@15)                             0717
*       VVAH=CTTBLHH(VVAINDEX);     /*                       @Z40LB65*/
         MVC   VVAH(1),CTTBLHH+36(@15)                             0718
*       VVAR=CTTBLRR(VVAINDEX);     /*                       @Z40LB65*/
*                                                                  0719
         MVC   VVAR(1),CTTBLRR+36(@15)                             0719
*       /*************************************************************/
*       /*                                                           */
*       /* RETRIEVE THE ADDRESS FOR THE DIAG/OVLY RECORD     @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0720
*       DOC=CTTBLCC(DOINDEX);       /*                       @Z40LB65*/
         MVC   DOC(1),CTTBLCC+48(@15)                              0720
*       DOH=CTTBLHH(DOINDEX);       /*                       @Z40LB65*/
         MVC   DOH(1),CTTBLHH+48(@15)                              0721
*       DOR=CTTBLRR(DOINDEX);       /*                       @Z40LB65*/
*                                                                  0722
         MVC   DOR(1),CTTBLRR+48(@15)                              0722
*       /*************************************************************/
*       /*                                                           */
*       /* COMPUTE CYLINDER DIFFERENCE (ADDRDIF1) FROM       @Z40LB65*/
*       /* ORIGINAL VOLUME TO THE WORK DATA SET VOLUME. THIS IS DONE */
*       /* BY SUBTRACTING THE FIRST CYLINDER VALUE OF THE FIRST ENTRY*/
*       /* FROM THE FIELD CTREALCC.                          @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0723
*       ADDRDIF1=CTREALCC-SDGC;     /*                       @Z40LB65*/
*                                                                  0723
         LCR   @14,@14                                             0723
         SLR   @09,@09                                             0723
         ICM   @09,3,CTREALCC(@15)                                 0723
         ALR   @14,@09                                             0723
         STH   @14,ADDRDIF1                                        0723
*       /*************************************************************/
*       /*                                                           */
*       /* RESET MESSAGE POINTER TO POINT TO THE ECB AND     @Z40LB65*/
*       /* ISSUE UFSPACE MACRO TO FREE UP MESSAGE AREA.      @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0724
*       CTMSGPTR=CTMSGPTR-ECBLEN;   /*                       @Z40LB65*/
         SLR   @15,@05                                             0724
         ST    @15,CTMSGPTR                                        0724
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/*                    @Z40LB65*/
         L     @05,@PC00001                                        0725
         ST    @05,@AL00001                                        0725
         LA    @15,CTMSGPTR                                        0725
         ST    @15,@AL00001+4                                      0725
         L     @15,GDTFSP(,@05)                                    0725
         LA    @01,@AL00001                                        0725
         BALR  @14,@15                                             0725
*     END;                          /*                       @Z40LB65*/
*                                                                  0726
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYCODE = 0 INITIALIZE THE COTBLIST PARM LIST     @Z40LB65*/
*   /* FOR THE COPYTABL ORDER OF THE USSC MACRO FOR WDS2.    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0727
*   IF COPYCODE=LASTCC00 THEN                                      0727
@RF00711 SLR   @05,@05                                             0727
         CR    COPYCODE,@05                                        0727
         BNE   @RF00727                                            0727
*     DO;                           /*                       @Z40LB65*/
*       DCOTBTID=COPYSEC;           /*                       @Z40LB65*/
         MVC   DCOTBTID(1),COPYSEC                                 0729
*       COTBEXTS(1:2)=SCYL2;        /*                       @Z40LB65*/
         MVC   COTBEXTS(2),SCYL2                                   0730
*       COTBEXTS(3:4)=ECYL2;        /*                       @Z40LB65*/
         MVC   COTBEXTS+2(2),ECYL2                                 0731
*       COTBVOL=WORKVOL2;           /*                       @Z40LB65*/
*                                                                  0732
         MVC   COTBVOL(6),WORKVOL2                                 0732
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF    @Z40LB65*/
*       /* USSC PARM LIST                                    @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0733
*       IF GDTDBG=NULLPTR THEN                                     0733
         L     @15,@PC00001                                        0733
         C     @05,GDTDBG(,@15)                                    0733
         BE    @RT00733                                            0733
*         ;                                                        0734
*       ELSE                                                       0735
*         DO;                                                      0735
*           DMPINDEX=ADDR(DMPSTG);  /*                       @Z40LB65*/
         LA    DMPINDEX,DMPSTG                                     0736
*           DMPITMNM='COTBLIST';                                   0737
         MVC   DMPITMNM(8,DMPINDEX),@CC01334                       0737
*           DMPITMPT=ADDR(COTBLIST);                               0738
         LA    @05,COTBLIST                                        0738
         ST    @05,DMPITMPT(,DMPINDEX)                             0738
*           DMPITMLN=LENGTH(COTBLIST);                             0739
         MVC   DMPITMLN(2,DMPINDEX),@CH00309                       0739
*           DMPITMTP='H';                                          0740
         MVI   DMPITMTP(DMPINDEX),C'H'                             0740
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0741
         AL    DMPINDEX,@CF00473                                   0741
*           DMPTRM=DMPTRMVL;                                       0742
         MVI   DMPTRM(DMPINDEX),X'FF'                              0742
*         END;                      /*                       @Z40LB65*/
*       IF GDTDBG=NULLPTR THEN                                     0744
@RT00733 L     @05,@PC00001                                        0744
         L     @05,GDTDBG(,@05)                                    0744
         LTR   @05,@05                                             0744
         BZ    @RT00744                                            0744
*         ;                                                        0745
*       ELSE                                                       0746
*         CALL IDCDB010(GDTTBL,'CPCF',ADDR(DMPSTG));/*       @Z40LB65*/
*                                                                  0746
         L     @05,@PC00001                                        0746
         ST    @05,@AL00001                                        0746
         LA    @15,@CC01338                                        0746
         ST    @15,@AL00001+4                                      0746
         LA    @15,DMPSTG                                          0746
         ST    @15,@AFTEMPS                                        0746
         LA    @15,@AFTEMPS                                        0746
         ST    @15,@AL00001+8                                      0746
         MVI   @AL00001+8,X'80'                                    0746
         L     @15,GDTDBG(,@05)                                    0746
         LA    @01,@AL00001                                        0746
         BALR  @14,@15                                             0746
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE COPY TABLE OPTION OF THE USSC MACRO TO  @Z40LB65*/
*       /* COPY THE SECONDARY MSC TABLES TO WDS2.            @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0747
*       CALL IDCSASS0(GDTTBL,COPYTABL,COTPTR,REASONCD,ECBCODE,CTMSGPTR)
*           ;                                                      0747
@RT00744 L     @05,@PC00001                                        0747
         ST    @05,@AL00001                                        0747
         LA    @02,COPYTABL                                        0747
         ST    @02,@AL00001+4                                      0747
         LA    @02,COTPTR                                          0747
         ST    @02,@AL00001+8                                      0747
         LA    @02,REASONCD                                        0747
         ST    @02,@AL00001+12                                     0747
         LA    @02,ECBCODE                                         0747
         ST    @02,@AL00001+16                                     0747
         LA    @02,CTMSGPTR                                        0747
         ST    @02,@AL00001+20                                     0747
         MVI   @AL00001+20,X'80'                                   0747
         L     @15,GDTSSC(,@05)                                    0747
         LA    @01,@AL00001                                        0747
         BALR  @14,@15                                             0747
*       RESPECIFY                                                  0748
*         RTNREG RSTD;                                             0748
*       TESTRC=RTNREG;                                             0749
         LR    TESTRC,RTNREG                                       0749
*       RESPECIFY                                                  0750
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*                                                                  0750
*       /*************************************************************/
*       /*                                                           */
*       /* TEST THE RETURN CODE FROM USSC. IF THE RETURN     @Z40LB65*/
*       /* CODE IS 04 CALL SSCMSG TO PRINT OUT MESSAGE TO EXPLAIN THE*/
*       /* ERROR. IF THE RETURN CODE IS 04 OR 08 ISSUE THE UPRINT    */
*       /* MACRO TO PRINT MESSAGE IDC31181I INDICATING THE TABLES    */
*       /* COULD NOT BE COPIED.                              @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0751
*       IF TESTRC=4 THEN                                           0751
         C     TESTRC,@CF00041                                     0751
         BNE   @RF00751                                            0751
*         CALL SSCMSG(REASONCD,ECBCODE);/*                   @Z40LB65*/
         LA    @05,REASONCD                                        0752
         ST    @05,@AL00001                                        0752
         LA    @05,ECBCODE                                         0752
         ST    @05,@AL00001+4                                      0752
         LA    @01,@AL00001                                        0752
         BAL   @14,SSCMSG                                          0752
*       IF TESTRC=4×TESTRC=8 THEN                                  0753
@RF00751 C     TESTRC,@CF00041                                     0753
         BE    @RT00753                                            0753
         C     TESTRC,@CF00178                                     0753
         BNE   @RF00753                                            0753
@RT00753 DS    0H                                                  0754
*         DO;                       /*                       @Z40LB65*/
*           COPYCODE=LASTCC12;      /*                       @Z40LB65*/
         LA    COPYCODE,12                                         0755
*           DARGSENT=MSG31181;      /*                       @Z40LB65*/
         L     @05,DDSTRU                                          0756
         MVI   DARGSENT(@05),X'02'                                 0756
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB65*/
         L     @05,@PC00001                                        0757
         ST    @05,@AL00001                                        0757
         LA    @15,@CF00114                                        0757
         ST    @15,@AL00001+4                                      0757
         LA    @15,DDSTRU                                          0757
         ST    @15,@AL00001+8                                      0757
         MVI   @AL00001+8,X'80'                                    0757
         L     @15,GDTPRT(,@05)                                    0757
         LA    @01,@AL00001                                        0757
         BALR  @14,@15                                             0757
*         END;                      /*                       @Z40LB65*/
*     END;                          /*                       @Z40LB65*/
*                                                                  0759
@RF00753 DS    0H                                                  0760
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYCODE = 0 RETRIEVE THE NECESSARY ADDRESSES      @Z40LB65*/
*   /* FROM THE MESSAGE AREA.                                @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0760
*   IF COPYCODE=LASTCC00 THEN                                      0760
@RF00727 LTR   COPYCODE,COPYCODE                                   0760
         BNZ   @RF00760                                            0760
*     DO;                           /*                       @Z40LB65*/
*       CTMSGPTR=CTMSGPTR+ECBLEN;   /*                       @Z40LB65*/
*                                                                  0762
         LA    @05,4                                               0762
         L     @15,CTMSGPTR                                        0762
         ALR   @15,@05                                             0762
         ST    @15,CTMSGPTR                                        0762
*       /*************************************************************/
*       /*                                                           */
*       /* COMPUTE CYLINDER DIFFERENCE (ADDRDIF2) FROM       @Z40LB65*/
*       /* ORIGINAL VOLUME TO THE WORK DATA SET VOLUME. THIS IS DONE */
*       /* BY SUBTRACTING THE FIRST CYLINDER VALUE OF THE FIRST ENTRY*/
*       /* FROM THE FIELD CTREALCC.                          @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0763
*       ADDRDIF2=CTREALCC-SDGC;     /*                       @Z40LB65*/
*                                                                  0763
         SLR   @14,@14                                             0763
         ICM   @14,3,CTREALCC(@15)                                 0763
         SLR   @09,@09                                             0763
         IC    @09,SDGC                                            0763
         SLR   @14,@09                                             0763
         STH   @14,ADDRDIF2                                        0763
*       /*************************************************************/
*       /*                                                           */
*       /* RESET MESSAGE POINTER TO POINT TO THE ECB AND     @Z40LB65*/
*       /* ISSUE UFSPACE MACRO TO FREE UP MESSAGE AREA.      @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0764
*       CTMSGPTR=CTMSGPTR-ECBLEN;   /*                       @Z40LB65*/
         SLR   @15,@05                                             0764
         ST    @15,CTMSGPTR                                        0764
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/*                    @Z40LB65*/
         L     @05,@PC00001                                        0765
         ST    @05,@AL00001                                        0765
         LA    @15,CTMSGPTR                                        0765
         ST    @15,@AL00001+4                                      0765
         L     @15,GDTFSP(,@05)                                    0765
         LA    @01,@AL00001                                        0765
         BALR  @14,@15                                             0765
*     END;                          /*                       @Z40LB65*/
*   RETURN CODE(COPYCODE);          /*                       @Z40LB65*/
@RF00760 LR    @15,COPYCODE                                        0767
         L     @13,4(,@13)                                         0767
         L     @14,12(,@13)                                        0767
         LM    @00,@12,20(@13)                                     0767
         BR    @14                                                 0767
*   END COPYPROC;                   /*                       @Z40LB65*/
*                                                                  0769
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - COMPPROC                            @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE CAUSES TRACKS TO BE READ     @Z40LB65*/
*/*                FROM EACH WORK DATA SET AND COMPARES      @Z40LB65*/
*/*                THE PRIMARY AND SECONDARY RECORDS         @Z40LB65*/
*/*                CAUSING ALL INCONSISTENCIES TO BE         @Z40LB65*/
*/*                REPORTED.                                 @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - FDTTBL AND WORK AREA CALLED INTTBL           @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Z40LB65*/
*/*              0 = SUCCESSFUL COMPLETION                   @Z40LB65*/
*/*              12 = UNSUCCESSFUL COMPLETION                @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0769
*COMPPROC:                                                         0769
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
*                                                                  0769
COMPPROC STM   @14,@12,12(@13)                                     0769
         ST    @13,@SA00004+4                                      0769
         LA    @14,@SA00004                                        0769
         ST    @14,8(,@13)                                         0769
         LR    @13,@14                                             0769
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0770
*   DCL                                                            0770
*     COMPCODE FIXED(15);           /* COMPPROC RETURN CODE  @Z40LB65*/
*   OLDERID2=NEWERID2;                                             0771
         L     @08,@PC00001                                        0771
         L     @08,GDTTR2(,@08)                                    0771
         MVC   @TS00001(95),NEWERID2(@08)                          0771
         MVC   OLDERID2(95,@08),@TS00001                           0771
*   NEWID2='CPDA';                  /*                       @Z40LB65*/
         MVC   NEWID2(4,@08),@CC01343                              0772
*   COMPCODE=''B;                   /*                       @Z40LB65*/
         SLR   COMPCODE,COMPCODE                                   0773
*   FIRSTERR=OFF;                   /*                       @Z40LB65*/
*                                                                  0774
         NI    FIRSTERR,B'11011111'                                0774
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS 24 CYLINDERS (TRACE EXCLUDED) INDIVIDUALLY.   @Z40LB65*/
*   /* WITHIN EACH CYLINDER PROCESS 19 TRACKS INDIVIDUALLY   @Z40LB65*/
*   /* EXCEPT FOR TRACKS BELONGING TO TABLES NOT COMPARED.   @Z40LB65*/
*   /* WITHIN EACH TRACK PROCESS 32 RECORDS INDIVIDUALLY.    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0775
*   DO C=SDGC TO(SDGC+23);          /*                       @Z40LB65*/
         SLR   @08,@08                                             0775
         IC    @08,SDGC                                            0775
         B     @DE00775                                            0775
@DL00775 DS    0H                                                  0776
*     DO H=0 TO 18;                 /*                       @Z40LB65*/
*                                                                  0776
         SLR   @08,@08                                             0776
         STC   @08,H                                               0776
@DL00776 DS    0H                                                  0777
*       /*************************************************************/
*       /*                                                           */
*       /* BYPASS THE MSG BUF, JOURNAL, AND SCHE Q RECORDS   @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0777
*       IF C=VVAC&H>VVAH THEN                                      0777
         CLC   C(1),VVAC                                           0777
         BNE   @RF00777                                            0777
         CLC   H(1),VVAH                                           0777
         BNH   @RF00777                                            0777
*         DO;                       /*                       @Z40LB65*/
*           C=DOC;                  /*                       @Z40LB65*/
         MVC   C(1),DOC                                            0779
*           H=DOH;                  /*                       @Z40LB65*/
         MVC   H(1),DOH                                            0780
*         END;                      /*                       @Z40LB65*/
*                                                                  0781
*       /*************************************************************/
*       /*                                                           */
*       /* CALL TRKRDR TO READ CORRESPONDING TRACKS FROM     @Z40LB65*/
*       /* WDS1 AND WDS2.                                    @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0782
*       R=1;                        /*                       @Z40LB65*/
@RF00777 MVI   R,X'01'                                             0782
*       CALL TRKRDR;                /*                       @Z40LB65*/
         BAL   @14,TRKRDR                                          0783
*       RESPECIFY                                                  0784
*         RTNREG RSTD;                                             0784
*       TESTRC=RTNREG;                                             0785
         LR    TESTRC,RTNREG                                       0785
*       RESPECIFY                                                  0786
*         RTNREG UNRSTD;            /*                       @Z40LB65*/
*                                                                  0786
*       /*************************************************************/
*       /*                                                           */
*       /* IF TRKRDR ENCOUNTERS AN I/O ERROR, PROCESSING MUST        */
*       /*                                                   @Z40LB65*/
*       /* TERMINATE SINCE FURTHER I/O REQUESTS FOR THAT DATA        */
*       /*                                                   @Z40LB65*/
*       /* SET WILL RESULT IN 'REQUEST PURGED' SYNAD ERRORS. @Z40LB65*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0787
*       IF TESTRC=LASTCC12 THEN                                    0787
         LA    @08,12                                              0787
         CR    TESTRC,@08                                          0787
         BNE   @RF00787                                            0787
*         DO;                       /*                       @Z40LB65*/
*           COMPCODE=LASTCC12;      /*                       @Z40LB65*/
         LR    COMPCODE,@08                                        0789
*           C=SDGC+24;              /*                       @Z40LB65*/
         LA    @08,24                                              0790
         SLR   @07,@07                                             0790
         IC    @07,SDGC                                            0790
         ALR   @08,@07                                             0790
         STC   @08,C                                               0790
*           H=19;                   /*                       @Z40LB65*/
         MVI   H,X'13'                                             0791
*         END;                      /*                       @Z40LB65*/
*       ELSE                                                       0793
*         DO R=1 TO 32;             /*                       @Z40LB65*/
*                                                                  0793
         B     @RC00787                                            0793
@RF00787 LA    @08,1                                               0793
         STC   @08,R                                               0793
@DL00793 DS    0H                                                  0794
*           /*********************************************************/
*           /*                                                       */
*           /* LOCATE THE PROPER RECORDS                     @Z40LB65*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0794
*           RECPTR1=TRKPTR1+(R-1)*RECSIZE;/*                 @Z40LB65*/
         BCTR  @08,0                                               0794
         MH    @08,@CH01175                                        0794
         L     RECPTR1,TRKPTR1                                     0794
         ALR   RECPTR1,@08                                         0794
*           RECPTR2=TRKPTR2+(R-1)*RECSIZE;/*                 @Z40LB65*/
*                                                                  0795
         AL    @08,TRKPTR2                                         0795
         LR    RECPTR2,@08                                         0795
*           /*********************************************************/
*           /*                                                       */
*           /* TEST THE CHRS FOR DISCREPANCIES               @Z40LB65*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0796
*           IF PCHR^=CHR×SCHR^=CHR THEN                            0796
         CLC   PCHR(3,RECPTR1),CHR                                 0796
         BNE   @RT00796                                            0796
         CLC   SCHR(3,RECPTR2),CHR                                 0796
         BE    @RF00796                                            0796
@RT00796 DS    0H                                                  0797
*             CHRERROR=ON;          /*                       @Z40LB65*/
         OI    CHRERROR,B'10000000'                                0797
*           ELSE                                                   0798
*             CHRERROR=OFF;         /*                       @Z40LB65*/
*                                                                  0798
         B     @RC00796                                            0798
@RF00796 NI    CHRERROR,B'01111111'                                0798
*           /*********************************************************/
*           /*                                                       */
*           /* COMPARE THE PREFIXES AND RECORDS              @Z40LB65*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0799
*           IF PPREFIX^=SPREFIX×PREC^=SREC THEN                    0799
@RC00796 CLC   PPREFIX(8,RECPTR1),SPREFIX(RECPTR2)                 0799
         BNE   @RT00799                                            0799
         CLC   PREC(256,RECPTR1),SREC(RECPTR2)                     0799
         BE    @RF00799                                            0799
@RT00799 DS    0H                                                  0800
*             MATCHERR=ON;          /*                       @Z40LB65*/
         OI    MATCHERR,B'01000000'                                0800
*           ELSE                                                   0801
*             MATCHERR=OFF;         /*                       @Z40LB65*/
*                                                                  0801
         B     @RC00799                                            0801
@RF00799 NI    MATCHERR,B'10111111'                                0801
*           /*********************************************************/
*           /*                                                       */
*           /* WERE THERE ANY DISCREPANCIES IN THIS RECORD?  @Z40LB65*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0802
*           IF CHRERROR=ON×MATCHERR=ON THEN                        0802
@RC00799 TM    CHRERROR,B'11000000'                                0802
         BZ    @RF00802                                            0802
*             DO;                   /*                       @Z40LB65*/
*                                                                  0803
*               /*****************************************************/
*               /*                                                   */
*               /* CALL HEADSET TO ESTABLISH HEADINGS ON THE @Z40LB65*/
*               /* OCCURENCE OF THE FIRST MISMATCH.          @Z40LB65*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0804
*               IF FIRSTERR=OFF THEN                               0804
         TM    FIRSTERR,B'00100000'                                0804
         BNZ   @RF00804                                            0804
*                 DO;               /*                       @Z40LB65*/
*                   CALL HEADSET;   /*                       @Z40LB65*/
         BAL   @14,HEADSET                                         0806
*                   FIRSTERR=ON;    /*                       @Z40LB65*/
         OI    FIRSTERR,B'00100000'                                0807
*                 END;              /*                       @Z40LB65*/
*                                                                  0808
*               /*****************************************************/
*               /*                                                   */
*               /* CALL MISMATCH TO FIND ALL INCONSISTENCIES @Z40LB65*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0809
*               CALL MISMATCH;      /*                       @Z40LB65*/
@RF00804 BAL   @14,MISMATCH                                        0809
*             END;                  /*                       @Z40LB65*/
*         END;                      /*                       @Z40LB65*/
@RF00802 LA    @08,1                                               0811
         SLR   @07,@07                                             0811
         IC    @07,R                                               0811
         ALR   @08,@07                                             0811
         STC   @08,R                                               0811
         C     @08,@CF00220                                        0811
         BNH   @DL00793                                            0811
*     END;                          /*                       @Z40LB65*/
@RC00787 LA    @08,1                                               0812
         SLR   @07,@07                                             0812
         IC    @07,H                                               0812
         ALR   @08,@07                                             0812
         STC   @08,H                                               0812
         C     @08,@CF01345                                        0812
         BNH   @DL00776                                            0812
*   END;                            /*                       @Z40LB65*/
         LA    @08,1                                               0813
         SLR   @07,@07                                             0813
         IC    @07,C                                               0813
         ALR   @08,@07                                             0813
@DE00775 STC   @08,C                                               0813
         LA    @07,23                                              0813
         SLR   @05,@05                                             0813
         IC    @05,SDGC                                            0813
         ALR   @07,@05                                             0813
         CR    @08,@07                                             0813
         BNH   @DL00775                                            0813
*   RETURN CODE(COMPCODE);          /*                       @Z40LB65*/
         LR    @15,COMPCODE                                        0814
         L     @13,4(,@13)                                         0814
         L     @14,12(,@13)                                        0814
         LM    @00,@12,20(@13)                                     0814
         BR    @14                                                 0814
*   END COMPPROC;                   /*                       @Z40LB65*/
*                                                                  0816
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - TRKRDR                              @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE READS A TRACK FROM EACH      @Z40LB65*/
*/*                WORK DATA SET INTO ITS TRACK BUFFER       @Z40LB65*/
*/*                AREA (TRKBUF1, TRKBUF2)                   @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - WORK AREAS: INTTBL, TRKBUF1, TRKBUF2         @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - INTTBL, TRKBUF1, TRKBUF2 AND RETURN CODE    @Z40LB65*/
*/*              0 = SUCCESSFUL COMPLETION                   @Z40LB65*/
*/*              12 = UNSUCCESSFUL COMPLETION                @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0816
*TRKRDR:                                                           0816
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
*                                                                  0816
TRKRDR   STM   @14,@12,12(@13)                                     0816
         ST    @13,@SA00005+4                                      0816
         LA    @14,@SA00005                                        0816
         ST    @14,8(,@13)                                         0816
         LR    @13,@14                                             0816
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0817
*   DCL                                                            0817
*     TRKCODE FIXED(15);            /* TRKRDR RETURN CODE    @Z40LB65*/
*                                                                  0817
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE STRUCTURES FOR SEEK ADDRESSES                 @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0818
*   DCL                                                            0818
*     1 CCHHR,                      /* SEARCH CCHHR          @Z40LB65*/
*      2 CC FIXED(15),              /* SEARCH CYLINDER       @Z40LB65*/
*      2 HH FIXED(15),              /* SEARCH HEAD           @Z40LB65*/
*      2 RR FIXED(8);               /* SEARCH RECORD         @Z40LB65*/
*   DCL                                                            0819
*     1 CCHHR1,                     /* SEEK CCHHR FOR WDS1   @Z40LB65*/
*      2 CC1 FIXED(15),             /* WDS1 SEEK CYLINDER    @Z40LB65*/
*      2 HH1 FIXED(15),             /* WDS1 SEEK HEAD        @Z40LB65*/
*      2 RR1 FIXED(8);              /* WDS1 SEEK RECORD      @Z40LB65*/
*   DCL                                                            0820
*     1 CCHHR2,                     /* SEEK CCHHR FOR WDS2   @Z40LB65*/
*      2 CC2 FIXED(15),             /* WDS2 SEEK CYLINDER    @Z40LB65*/
*      2 HH2 FIXED(15),             /* WDS2 SEEK HEAD        @Z40LB65*/
*      2 RR2 FIXED(8);              /* WDS2 SEEK RECORD      @Z40LB65*/
*   OLDERID2=NEWERID2;                                             0821
         L     @02,@PC00001                                        0821
         L     @15,GDTTR2(,@02)                                    0821
         MVC   @TS00001(95),NEWERID2(@15)                          0821
         MVC   OLDERID2(95,@15),@TS00001                           0821
*   NEWID2='CPEA';                  /*                       @Z40LB65*/
         MVC   NEWID2(4,@15),@CC01366                              0822
*   TRKCODE=''B;                    /*                       @Z40LB65*/
*                                                                  0823
         SLR   TRKCODE,TRKCODE                                     0823
*   /*****************************************************************/
*   /*                                                               */
*   /* TRANSLATE CHR TO CCHHR                                @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0824
*   CC=C;                           /*                       @Z40LB65*/
         SLR   @15,@15                                             0824
         IC    @15,C                                               0824
         STH   @15,CC                                              0824
*   HH=H;                           /*                       @Z40LB65*/
         SLR   @14,@14                                             0825
         IC    @14,H                                               0825
         STH   @14,HH                                              0825
*   RR=R;                           /*                       @Z40LB65*/
*                                                                  0826
         MVC   RR(1),R                                             0826
*   /*****************************************************************/
*   /*                                                               */
*   /* PREPARE THE UEXCP ARGUMENT LIST (EXGARG) AND ISSUE    @Z40LB65*/
*   /* THE UEXCP MACRO TO READ 1 TRACK OF DATA FROM WDS1.    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*   EXGCTLBK=WORKPTR1;              /*                       @Z40LB65*/
         L     @14,WORKPTR1                                        0827
         ST    @14,EXGCTLBK(,EXGPTR)                               0827
*   CCHHR1=CCHHR;                   /*                       @Z40LB65*/
         MVC   CCHHR1(5),CCHHR                                     0828
*   CC1=CC+ADDRDIF1;                /*                       @Z40LB65*/
         LH    @14,ADDRDIF1                                        0829
         N     @14,@CF01444                                        0829
         ALR   @15,@14                                             0829
         STH   @15,CC1                                             0829
*   EXGCCHH1=ADDR(CCHHR1);          /*                       @Z40LB65*/
         LA    @15,CCHHR1                                          0830
         ST    @15,EXGCCHH1(,EXGPTR)                               0830
*   EXGCCHH2=ADDR(CCHHR);           /*                       @Z40LB65*/
         LA    @15,CCHHR                                           0831
         ST    @15,EXGCCHH2(,EXGPTR)                               0831
*   EXGRECNO=32;                    /*                       @Z40LB65*/
         MVC   EXGRECNO(4,EXGPTR),@CF00220                         0832
*   EXGDATAP=TRKPTR1;               /*                       @Z40LB65*/
         L     @15,TRKPTR1                                         0833
         ST    @15,EXGDATAP(,EXGPTR)                               0833
*   EXGDATAL=RECSIZE;               /*                       @Z40LB65*/
*                                                                  0834
         MVC   EXGDATAL(2,EXGPTR),@CH01175                         0834
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UEXCP MACRO TO READ IN A TRACK OF DATA      @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0835
*   CALL IDCIO050(GDTTBL,GET,EXGARG);/*                      @Z40LB65*/
         ST    @02,@AL00001                                        0835
         LA    @15,GET                                             0835
         ST    @15,@AL00001+4                                      0835
         ST    EXGPTR,@AL00001+8                                   0835
         MVI   @AL00001+8,X'80'                                    0835
         L     @15,GDTEXP(,@02)                                    0835
         LA    @01,@AL00001                                        0835
         BALR  @14,@15                                             0835
*   RESPECIFY                                                      0836
*     RTNREG RSTD;                                                 0836
*   TESTRC=RTNREG;                                                 0837
         LR    TESTRC,RTNREG                                       0837
*   RESPECIFY                                                      0838
*     RTNREG UNRSTD;                /*                       @Z40LB65*/
*   IF TESTRC^=0 THEN                                              0839
         LTR   TESTRC,TESTRC                                       0839
         BZ    @RF00839                                            0839
*     TRKCODE=LASTCC12;             /*                       @Z40LB65*/
*                                                                  0840
         LA    TRKCODE,12                                          0840
*   /*****************************************************************/
*   /*                                                               */
*   /* PREPARE THE UEXCP ARGUMENT LIST (EXGARG) AND ISSUE    @Z40LB65*/
*   /* THE UEXCP MACRO TO READ 1 TRACK OF DATA FROM WDS2.    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*   EXGCTLBK=WORKPTR2;              /*                       @Z40LB65*/
@RF00839 L     @02,WORKPTR2                                        0841
         ST    @02,EXGCTLBK(,EXGPTR)                               0841
*   CCHHR2=CCHHR;                   /*                       @Z40LB65*/
         MVC   CCHHR2(5),CCHHR                                     0842
*   CC2=CC+ADDRDIF2;                /*                       @Z40LB65*/
         LH    @02,ADDRDIF2                                        0843
         N     @02,@CF01444                                        0843
         AH    @02,CC                                              0843
         STH   @02,CC2                                             0843
*   EXGCCHH1=ADDR(CCHHR2);          /*                       @Z40LB65*/
         LA    @02,CCHHR2                                          0844
         ST    @02,EXGCCHH1(,EXGPTR)                               0844
*   EXGCCHH2=ADDR(CCHHR);           /*                       @Z40LB65*/
         LA    @02,CCHHR                                           0845
         ST    @02,EXGCCHH2(,EXGPTR)                               0845
*   EXGRECNO=32;                    /*                       @Z40LB65*/
         MVC   EXGRECNO(4,EXGPTR),@CF00220                         0846
*   EXGDATAP=TRKPTR2;               /*                       @Z40LB65*/
         L     @02,TRKPTR2                                         0847
         ST    @02,EXGDATAP(,EXGPTR)                               0847
*   EXGDATAL=RECSIZE;               /*                       @Z40LB65*/
*                                                                  0848
         MVC   EXGDATAL(2,EXGPTR),@CH01175                         0848
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UEXCP MACRO TO READ IN A TRACK OF DATA      @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0849
*   CALL IDCIO050(GDTTBL,GET,EXGARG);/*                      @Z40LB65*/
         L     @02,@PC00001                                        0849
         ST    @02,@AL00001                                        0849
         LA    @15,GET                                             0849
         ST    @15,@AL00001+4                                      0849
         ST    EXGPTR,@AL00001+8                                   0849
         MVI   @AL00001+8,X'80'                                    0849
         L     @15,GDTEXP(,@02)                                    0849
         LA    @01,@AL00001                                        0849
         BALR  @14,@15                                             0849
*   RESPECIFY                                                      0850
*     RTNREG RSTD;                                                 0850
*   TESTRC=RTNREG;                                                 0851
         LR    TESTRC,RTNREG                                       0851
*   RESPECIFY                                                      0852
*     RTNREG UNRSTD;                /*                       @Z40LB65*/
*   IF TESTRC^=0 THEN                                              0853
         LTR   TESTRC,TESTRC                                       0853
         BZ    @RF00853                                            0853
*     TRKCODE=LASTCC12;             /*                       @Z40LB65*/
         LA    TRKCODE,12                                          0854
*   RETURN CODE(TRKCODE);           /*                       @Z40LB65*/
@RF00853 LR    @15,TRKCODE                                         0855
         L     @13,4(,@13)                                         0855
         L     @14,12(,@13)                                        0855
         LM    @00,@12,20(@13)                                     0855
         BR    @14                                                 0855
*   END TRKRDR;                     /*                       @Z40LB65*/
*                                                                  0857
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - HEADSET                             @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE ESTABLISHES THE SUBTITLE     @Z40LB65*/
*/*                LINE FOR THE REPORT                       @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - STATIC TEXT MODULE HEADING ENTRY             @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - COMPLETED TITLE BUFFER                      @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0857
*HEADSET:                                                          0857
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
*                                                                  0857
HEADSET  STM   @14,@12,12(@13)                                     0857
         ST    @13,@SA00006+4                                      0857
         LA    @14,@SA00006                                        0857
         ST    @14,8(,@13)                                         0857
         LR    @13,@14                                             0857
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0858
*   DCL                                                            0858
*     HEADING FIXED(8) CONSTANT(3); /* CP0 STID 3            @Z40LB65*/
*                                                                  0858
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE PCARG LIST FOR THE UESTA MACRO                @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0859
*   DCL                                                            0859
*     1 PCARG,                                                     0859
*      2 PCMTLP PTR(31),            /* MAIN TITLE LINE PTR   @Z40LB65*/
*      2 PCSTLP PTR(31),            /* SUB-TITLE LINE PTR    @Z40LB65*/
*      2 PCFLP PTR(31),             /* FOOTING LINE PTR      @Z40LB65*/
*      2 PCPCP PTR(31),             /*                       @Z40LB65*/
*      2 PCPNL FIXED(15),           /* PAGE NO LOCATION      @Z40LB65*/
*      2 PCPTL FIXED(15),           /* TIME LOCATION         @Z40LB65*/
*      2 PCPDL FIXED(15),           /* DATE LOCATION         @Z40LB65*/
*      2 PCMTLC FIXED(15),          /* MAIN TITLE LINE CNT   @Z40LB65*/
*      2 PCSTLC FIXED(15),          /* SUB-TITLE LINE CNT    @Z40LB65*/
*      2 PCFLC FIXED(15),           /* FOOTING LINE CNT      @Z40LB65*/
*      2 PCLW FIXED(15),            /* LINE WIDTH            @Z40LB65*/
*      2 PCPD FIXED(15),            /* PAGE DEPTH            @Z40LB65*/
*      2 PCDSC PTR(8);              /* DEFAULT SPACE VAL     @Z40LB65*/
*   OLDERID2=NEWERID2;                                             0860
         L     @15,@PC00001                                        0860
         L     @14,GDTTR2(,@15)                                    0860
         MVC   @TS00001(95),NEWERID2(@14)                          0860
         MVC   OLDERID2(95,@14),@TS00001                           0860
*   NEWID2='CPFA';                  /*                       @Z40LB65*/
         MVC   NEWID2(4,@14),@CC01385                              0861
*   PCARG=''B;                      /*                       @Z40LB65*/
*                                                                  0862
         XC    PCARG(33),PCARG                                     0862
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO READ SUBTITLE INTO TITLEBUF @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0863
*   PRINTAB=''B;                    /*                       @Z40LB65*/
         XC    PRINTAB(20),PRINTAB                                 0863
*   DARGRETP=ADDR(TITLEBUF);        /*                       @Z40LB65*/
         L     @14,DDSTRU                                          0864
         LA    @09,TITLEBUF                                        0864
         ST    @09,DARGRETP(,@14)                                  0864
*   DARGRETL=LENGTH(TITLEBUF);      /*                       @Z40LB65*/
         MVC   DARGRETL(2,@14),@CH01258                            0865
*   DARGSMOD=CP0MSG;                /*                       @Z40LB65*/
         MVC   DARGSMOD(3,@14),@CC01281                            0866
*   DARGSENT=HEADING;               /*                       @Z40LB65*/
         MVI   DARGSENT(@14),X'03'                                 0867
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/
         ST    @15,@AL00001                                        0868
         LA    @14,@CF00114                                        0868
         ST    @14,@AL00001+4                                      0868
         LA    @14,DDSTRU                                          0868
         ST    @14,@AL00001+8                                      0868
         MVI   @AL00001+8,X'80'                                    0868
         L     @15,GDTPRT(,@15)                                    0868
         LA    @01,@AL00001                                        0868
         BALR  @14,@15                                             0868
*   DARGRETP=''B;                   /*                       @Z40LB65*/
         SLR   @15,@15                                             0869
         L     @14,DDSTRU                                          0869
         ST    @15,DARGRETP(,@14)                                  0869
*   DARGRETL=''B;                   /*                       @Z40LB65*/
*                                                                  0870
         STH   @15,DARGRETL(,@14)                                  0870
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE PARM LIST FOR UESTA MACRO                  @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0871
*   PCSTLP=ADDR(TITLEBUF);          /*                       @Z40LB65*/
         LA    @15,TITLEBUF                                        0871
         ST    @15,PCSTLP                                          0871
*   PCSTLC=1;                       /*                       @Z40LB65*/
*                                                                  0872
         MVC   PCSTLC(2),@CH00218                                  0872
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UESTA MACRO TO ESTABLISH THE TITLE          @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0873
*   CALL AMSTP042(GDTTBL,PRTFILE,PCARG);/*                   @Z40LB65*/
         L     @15,@PC00001                                        0873
         ST    @15,@AL00001                                        0873
         LA    @14,@CF00114                                        0873
         ST    @14,@AL00001+4                                      0873
         LA    @14,PCARG                                           0873
         ST    @14,@AL00001+8                                      0873
         L     @15,GDTESA(,@15)                                    0873
         LA    @01,@AL00001                                        0873
         BALR  @14,@15                                             0873
*   END HEADSET;                    /*                       @Z40LB65*/
@EL00006 L     @13,4(,@13)                                         0874
@EF00006 DS    0H                                                  0874
@ER00006 LM    @14,@12,12(@13)                                     0874
         BR    @14                                                 0874
*                                                                  0875
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - MISMATCH                            @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE COMPARES RECORDS CHARACTER-  @Z40LB65*/
*/*                BY-CHARACTER AND FORMATS THE RECORDS      @Z40LB65*/
*/*                FOR PRINTING IN REPORT FORM BY REPORTER.  @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - PRIMARY AND SECONDARY RECORDS                @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - SECBUF INITIALIZED                          @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0875
*MISMATCH:                                                         0875
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
MISMATCH STM   @14,@12,12(@13)                                     0875
         ST    @13,@SA00007+4                                      0875
         LA    @14,@SA00007                                        0875
         ST    @14,8(,@13)                                         0875
         LR    @13,@14                                             0875
*   OLDERID2=NEWERID2;                                             0876
         L     @08,@PC00001                                        0876
         L     @08,GDTTR2(,@08)                                    0876
         MVC   @TS00001(95),NEWERID2(@08)                          0876
         MVC   OLDERID2(95,@08),@TS00001                           0876
*   NEWID2='CPGA';                  /*                       @Z40LB65*/
*                                                                  0877
         MVC   NEWID2(4,@08),@CC01389                              0877
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL SECONDARY BUFFER WITH PERIODS AS IF THERE WERE   @Z40LB65*/
*   /* NO MISMATCHES.                                        @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0878
*   SECBUF(1)=PERIOD;               /*                       @Z40LB65*/
         MVI   SECBUF,C'.'                                         0878
*   MVC(SECBUF(2:256),SECBUF(1:255));/*                      @Z40LB65*/
         MVC   SECBUF+1(255),SECBUF                                0879
*   SECBUF(257:512)=SECBUF(1:256);  /*                       @Z40LB65*/
         MVC   SECBUF+256(256),SECBUF                              0880
*   SECBUF(513:528)=SECBUF(1:16);   /*                       @Z40LB65*/
*                                                                  0881
         MVC   SECBUF+512(16),SECBUF                               0881
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPARE RECORDS CHARACTER-BY CHARACTER TO LOCATE THE  @Z40LB65*/
*   /* MISMATCHES.                                           @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0882
*   DO LOC=1 TO RECSIZE;            /*                       @Z40LB65*/
         LA    LOC,1                                               0882
@DL00882 DS    0H                                                  0883
*     IF P(LOC)^=S(LOC) THEN                                       0883
         LR    @08,RECPTR1                                         0883
         ALR   @08,LOC                                             0883
         AL    @08,@CF01450                                        0883
         LR    @02,RECPTR2                                         0883
         ALR   @02,LOC                                             0883
         AL    @02,@CF01450                                        0883
         CLC   P(1,@08),S(@02)                                     0883
         BE    @RF00883                                            0883
*       DO;                         /*                       @Z40LB65*/
*                                                                  0884
*         /***********************************************************/
*         /*                                                         */
*         /* FOR MISMATCHES TRANSLATE THE SECONDARY CHARACTER        */
*         /*                                                 @Z40LB65*/
*         /* TO PRINTABLE HEX AND PLACE IT IN THE SECONDARY  @Z40LB65*/
*         /* RECORD OUTPUT BUFFER                            @Z40LB65*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0885
*         SBYTEPTR=ADDR(S(LOC));    /*                       @Z40LB65*/
         LR    SBYTEPTR,RECPTR2                                    0885
         AL    SBYTEPTR,@CF01450                                   0885
         LA    SBYTEPTR,S(LOC,SBYTEPTR)                            0885
*         HEXCHARS=''B;             /*                       @Z40LB65*/
         XC    HEXCHARS(2),HEXCHARS                                0886
*         MVZ(HEXCHAR(1),SECBYTE);  /*                       @Z40LB65*/
         MVZ   HEXCHAR(1),SECBYTE(SBYTEPTR)                        0887
*         SRL(HEXCHAR(1),4);        /*                       @Z40LB65*/
         SLR   @08,@08                                             0888
         IC    @08,HEXCHAR                                         0888
         SRL   @08,4                                               0888
         STC   @08,HEXCHAR                                         0888
*         MVN(HEXCHAR(2),SECBYTE);  /*                       @Z40LB65*/
         MVN   HEXCHAR+1(1),SECBYTE(SBYTEPTR)                      0889
*         DO NIBBLE=1 TO 2;         /*                       @Z40LB65*/
         LA    NIBBLE,1                                            0890
@DL00890 DS    0H                                                  0891
*           IF HEXCHAR(NIBBLE)>9 THEN                              0891
         LA    @08,9                                               0891
         SLR   @15,@15                                             0891
         IC    @15,HEXCHAR-1(NIBBLE)                               0891
         CR    @15,@08                                             0891
         BNH   @RF00891                                            0891
*             HEXCHAR(NIBBLE)=ALPHA+(HEXCHAR(NIBBLE)-9);           0892
         SLR   @15,@08                                             0892
         SLR   @08,@08                                             0892
         IC    @08,ALPHA                                           0892
         ALR   @15,@08                                             0892
         STC   @15,HEXCHAR-1(NIBBLE)                               0892
*           ELSE                                                   0893
*             HEXCHAR(NIBBLE)=NUMERIC+HEXCHAR(NIBBLE);/*     @Z40LB65*/
         B     @RC00891                                            0893
@RF00891 SLR   @08,@08                                             0893
         IC    @08,NUMERIC                                         0893
         SLR   @15,@15                                             0893
         IC    @15,HEXCHAR-1(NIBBLE)                               0893
         ALR   @08,@15                                             0893
         STC   @08,HEXCHAR-1(NIBBLE)                               0893
*         END;                      /*                       @Z40LB65*/
@RC00891 AL    NIBBLE,@CF00218                                     0894
         CL    NIBBLE,@CF00152                                     0894
         BNH   @DL00890                                            0894
*         SECBUF(2*LOC-1:2*LOC)=HEXCHARS;/*                  @Z40LB65*/
         LR    @08,LOC                                             0895
         ALR   @08,@08                                             0895
         LA    @02,SECBUF-2(@08)                                   0895
         MVC   0(2,@02),HEXCHARS                                   0895
*       END;                        /*                       @Z40LB65*/
*   END;                            /*                       @Z40LB65*/
@RF00883 AL    LOC,@CF00218                                        0897
         CL    LOC,@CF01175                                        0897
         BNH   @DL00882                                            0897
*   CALL REPORTER;                  /*                       @Z40LB65*/
         BAL   @14,REPORTER                                        0898
*   END MISMATCH;                   /*                       @Z40LB65*/
@EL00007 L     @13,4(,@13)                                         0899
@EF00007 DS    0H                                                  0899
@ER00007 LM    @14,@12,12(@13)                                     0899
         BR    @14                                                 0899
*                                                                  0900
*/********************************************************************/
*/*                                                          @Z40LB65*/
*/*     PROCEDURE NAME - REPORTER                            @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     FUNCTION - THIS ROUTINE PRINTS THE MISMATCHING       @Z40LB65*/
*/*                RECORDS IN REPORT FORM.                   @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     INPUT - RECORD BUFFERS (PBLOCK, SECBUF, OUTBUF)      @Z40LB65*/
*/*                                                          @Z40LB65*/
*/*     OUTPUT - REPORT OF MISMATCHING RECORDS.              @Z40LB65*/
*/*                                                          @Z40LB65*/
*/********************************************************************/
*                                                                  0900
*REPORTER:                                                         0900
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/
*                                                                  0900
REPORTER STM   @14,@12,12(@13)                                     0900
         ST    @13,@SA00008+4                                      0900
         LA    @14,@SA00008                                        0900
         ST    @14,8(,@13)                                         0900
         LR    @13,@14                                             0900
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0901
*   DCL                                                            0901
*     CHRLINE FIXED(8) CONSTANT(4); /* CHR OUTPUT LINE       @Z40LB65*/
*   DCL                                                            0902
*     CHRELINE FIXED(8) CONSTANT(5);/* CHR ERROR LINE        @Z40LB65*/
*   DCL                                                            0903
*     RECORDS FIXED(8) CONSTANT(6); /* RECORD LINES          @Z40LB65*/
*   OLDERID2=NEWERID2;                                             0904
         L     @08,@PC00001                                        0904
         L     @08,GDTTR2(,@08)                                    0904
         MVC   @TS00001(95),NEWERID2(@08)                          0904
         MVC   OLDERID2(95,@08),@TS00001                           0904
*   NEWID2='CPHA';                  /*                       @Z40LB65*/
*                                                                  0905
         MVC   NEWID2(4,@08),@CC01406                              0905
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE PROPER CHR RECORD                           @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0906
*   DARGDBP=ADDR(CHR);              /*                       @Z40LB65*/
         L     @08,DDSTRU                                          0906
         LA    @02,CHR                                             0906
         ST    @02,DARGDBP(,@08)                                   0906
*   DARGILP=LENGTH(CHR);            /*                       @Z40LB65*/
         MVC   DARGILP(2,@08),@CH00161                             0907
*   IF CHRERROR=ON THEN                                            0908
         TM    CHRERROR,B'10000000'                                0908
         BNO   @RF00908                                            0908
*     DARGSENT=CHRELINE;            /*                       @Z40LB65*/
         MVI   DARGSENT(@08),X'05'                                 0909
*   ELSE                                                           0910
*     DARGSENT=CHRLINE;             /*                       @Z40LB65*/
         B     @RC00908                                            0910
@RF00908 L     @08,DDSTRU                                          0910
         MVI   DARGSENT(@08),X'04'                                 0910
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/
*                                                                  0911
@RC00908 L     @08,@PC00001                                        0911
         ST    @08,@AL00001                                        0911
         LA    @02,@CF00114                                        0911
         ST    @02,@AL00001+4                                      0911
         LA    @02,DDSTRU                                          0911
         ST    @02,@AL00001+8                                      0911
         MVI   @AL00001+8,X'80'                                    0911
         L     @15,GDTPRT(,@08)                                    0911
         LA    @01,@AL00001                                        0911
         BALR  @14,@15                                             0911
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT AND PRINT THE RECORDS THAT DID NOT MATCH       @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0912
*   OPPREFIX=PPREFIX;               /*                       @Z40LB65*/
         MVC   OPPREFIX(8,OUTPTR),PPREFIX(RECPTR1)                 0912
*   OSPREFIX=SECBUF(1:16);          /*                       @Z40LB65*/
         MVC   OSPREFIX(16,OUTPTR),SECBUF                          0913
*   DO LINE=1 TO 8;                 /*                       @Z40LB65*/
         LA    LINE,1                                              0914
@DL00914 DS    0H                                                  0915
*     OPLINE(LINE)=PREC(32*(LINE-1)+1:32*LINE);/*            @Z40LB65*/
         LR    @08,LINE                                            0915
         MH    @08,@CH01205                                        0915
         ST    @08,@TF00001                                        0915
         ALR   @08,OUTPTR                                          0915
         AL    @08,@CF01451                                        0915
         MVI   OPLINE-23(@08),C' '                                 0915
         MVC   OPLINE-22(30,@08),OPLINE-23(@08)                    0915
         LR    @15,LINE                                            0915
         SLL   @15,5                                               0915
         LR    @14,LINE                                            0915
         BCTR  @14,0                                               0915
         LR    @07,@14                                             0915
         SLL   @07,5                                               0915
         SLR   @15,@07                                             0915
         BCTR  @15,0                                               0915
         ALR   @07,RECPTR1                                         0915
         EX    @15,@SM01452                                        0915
*     OSLINE(LINE)=SECBUF(64*(LINE-1)+17:64*LINE+16);/*      @Z40LB65*/
         LR    @08,OUTPTR                                          0916
         AL    @08,@TF00001                                        0916
         AL    @08,@CF01454                                        0916
         MVI   OSLINE-55(@08),C' '                                 0916
         MVC   OSLINE-54(62,@08),OSLINE-55(@08)                    0916
         LR    @15,LINE                                            0916
         SLL   @15,6                                               0916
         SLL   @14,6                                               0916
         SLR   @15,@14                                             0916
         BCTR  @15,0                                               0916
         LA    @01,SECBUF+16(@14)                                  0916
         EX    @15,@SM01455                                        0916
*   END;                            /*                       @Z40LB65*/
         AL    LINE,@CF00218                                       0917
         CL    LINE,@CF00178                                       0917
         BNH   @DL00914                                            0917
*   DARGDBP=ADDR(OUTBUF);           /*                       @Z40LB65*/
         L     @08,DDSTRU                                          0918
         ST    OUTPTR,DARGDBP(,@08)                                0918
*   DARGILP=LENGTH(OUTBUF);         /*                       @Z40LB65*/
         MVC   DARGILP(2,@08),@CH01201                             0919
*   DARGSENT=RECORDS;               /*                       @Z40LB65*/
         MVI   DARGSENT(@08),X'06'                                 0920
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/
         L     @15,@PC00001                                        0921
         ST    @15,@AL00001                                        0921
         LA    @14,@CF00114                                        0921
         ST    @14,@AL00001+4                                      0921
         LA    @14,DDSTRU                                          0921
         ST    @14,@AL00001+8                                      0921
         MVI   @AL00001+8,X'80'                                    0921
         L     @15,GDTPRT(,@15)                                    0921
         LA    @01,@AL00001                                        0921
         BALR  @14,@15                                             0921
*   END REPORTER;                   /*                       @Z40LB65*/
@EL00008 L     @13,4(,@13)                                         0922
@EF00008 DS    0H                                                  0922
@ER00008 LM    @14,@12,12(@13)                                     0922
         BR    @14                                                 0922
*                                                                  0923
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  0923
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           0923
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00009                                    0923
         MVC   @PC00009(8),0(@01)                                  0923
*                                   /*                       @Y30LB39*/
*                                                                  0924
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0924
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0924
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0924
*                                   /*                       @Y30LB39*/
*   DCL                                                            0924
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            0925
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0925
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0926
*                                   /*                       @Y30LB39*/
*   DCL                                                            0926
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            0927
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0927
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0928
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0928
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0928
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0929
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0929
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0929
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0930
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0930
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0930
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0931
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0931
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0931
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0932
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0932
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0933
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0933
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0933
         L     @15,@PC00001                                        0933
         L     @14,GDTTR2(,@15)                                    0933
         MVC   @TS00001(95),NEWERID2(@14)                          0933
         MVC   OLDERID2(95,@14),@TS00001                           0933
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0934
         MVC   NEWID2(4,@14),@CC01429                              0934
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0935
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0935
         LA    @14,SSDRGLT                                         0935
         ST    @14,SSDLPTR                                         0935
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0936
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              0936
         L     @09,@PC00009                                        0936
         L     @09,SSRCODE(,@09)                                   0936
         LTR   @09,@09                                             0936
         BNP   @RF00936                                            0936
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0937
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0938
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0938
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        0939
         ST    @03,DARGRETP(,@14)                                  0939
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            0940
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 0941
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0942
         MVC   DARGRETL(2,@14),@CH01433                            0942
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0943
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0943
         ST    @15,@AL00001                                        0943
         LA    @03,@CF00114                                        0943
         ST    @03,@AL00001+4                                      0943
         LA    @03,SSDLPTR                                         0943
         ST    @03,@AL00001+8                                      0943
         MVI   @AL00001+8,X'80'                                    0943
         L     @15,GDTPRT(,@15)                                    0943
         LA    @01,@AL00001                                        0943
         BALR  @14,@15                                             0943
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0944
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          0944
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   0945
@DL00945 DS    0H                                                  0946
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00218                                   0946
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0947
@DE00945 L     @03,@PC00009                                        0947
         LR    @15,ENTRYNUM                                        0947
         ALR   @15,@15                                             0947
         LH    @15,SSARRAY-2(@15)                                  0947
         CH    @15,SSRHALF(,@03)                                   0947
         BE    @DC00945                                            0947
         SLR   @14,@14                                             0947
         CR    @15,@14                                             0947
         BNE   @DL00945                                            0947
@DC00945 DS    0H                                                  0948
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0948
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0948
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @09,SSDLPTR                                         0949
         MVC   DARGSMOD(3,@09),SSMODSS0                            0949
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@09)                             0950
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             0951
         BNE   @RF00951                                            0951
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@09)                                   0953
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00041                             0954
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0957
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0957
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC00936                                            0957
@RF00936 DS    0H                                                  0958
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0958
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         0959
         MVC   DARGSMOD(3,@15),SSMODCM0                            0959
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            0960
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00009+4                                      0961
         ST    @14,DARGDBP(,@15)                                   0961
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00218                             0962
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0963
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0964
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0964
@RC00936 L     @15,@PC00001                                        0964
         ST    @15,@AL00001                                        0964
         LA    @14,@CF00114                                        0964
         ST    @14,@AL00001+4                                      0964
         LA    @14,SSDLPTR                                         0964
         ST    @14,@AL00001+8                                      0964
         MVI   @AL00001+8,X'80'                                    0964
         L     @15,GDTPRT(,@15)                                    0964
         LA    @01,@AL00001                                        0964
         BALR  @14,@15                                             0964
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0965
         L     @14,@SA00009                                        0965
         LM    @00,@12,@SA00009+8                                  0965
         BR    @14                                                 0965
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCCP01                     /*                       @Z40LB65*/
*                                                                  0967
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSCP )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  0967
*       ;                                                          0967
@DATA    DS    0H
@CH00161 DC    H'3'
@CH00285 DC    H'5'
@CH00567 DC    H'12'
@CH00309 DC    H'24'
@CH01303 DC    H'38'
@CH01208 DC    H'64'
@CH01433 DC    H'120'
@CH01258 DC    H'121'
@CH01201 DC    H'792'
@SM01452 MVC   OPLINE-24(0,@08),PREC(@07)
@SM01455 MVC   OSLINE-56(0,@08),0(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    18F
@SA00003 DS    18F
@SA00004 DS    18F
@SA00009 DS    15F
@PC00009 DS    2F
@SA00005 DS    18F
@SA00006 DS    18F
@SA00007 DS    18F
@SA00008 DS    18F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    1F
IDCCP01  CSECT
         DS    0F
@CF00114 DC    F'0'
@CF00218 DC    F'1'
@CH00218 EQU   @CF00218+2
@CF00152 DC    F'2'
@CH00152 EQU   @CF00152+2
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00178 DC    F'8'
@CH00178 EQU   @CF00178+2
@CF00473 DC    F'16'
@CF01345 DC    F'18'
@CF00220 DC    F'32'
@CF01205 DC    F'96'
@CH01205 EQU   @CF01205+2
@CF01175 DC    F'264'
@CH01175 EQU   @CF01175+2
@CF01179 DC    F'8448'
@CF01177 DC    F'17688'
@CF01451 DC    F'-72'
@CF01454 DC    F'-40'
@CF01450 DC    F'-1'
@CF01444 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
ACQPTR   DS    A
WORKPTR1 DS    A
WORKPTR2 DS    A
REASONCD DS    F
TRKPTR1  DS    A
TRKPTR2  DS    A
COTPTR   DS    A
VOLSRPTR DS    A
UCBPTR   DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
COTBLIST DS    CL24
         ORG   COTBLIST
COTBLL   DS    FL4
COTBOP   DS    FL1
@NM00091 DS    CL1
COTBFLG  DS    BL2
         ORG   COTBFLG
COTBTID  DS    BL1
@NM00092 EQU   COTBFLG+0
COTBTRX  DS    BL1
COTBTRY  EQU   COTBFLG+1
COTBTRA  EQU   COTBFLG+1
COTBTRI  EQU   COTBFLG+1
@NM00093 EQU   COTBFLG+1
         ORG   COTBLIST+8
COTBEXTS DS    CL4
COTBVOL  DS    CL6
COTBASID DS    CL2
COTBECB  DS    FL4
         ORG   COTBLIST+24
PRINTAB  DS    CL20
HEXCHARS DS    CL2
         ORG   HEXCHARS
HEXCHAR  DS    2CL1
         ORG   HEXCHARS+2
SWITCHES DS    BL1
         ORG   SWITCHES
CHRERROR DS    BL1
MATCHERR EQU   SWITCHES+0
FIRSTERR EQU   SWITCHES+0
ACQSW1   EQU   SWITCHES+0
ACQSW2   EQU   SWITCHES+0
@NM00099 EQU   SWITCHES+0
         ORG   SWITCHES+1
SECBUF   DS    CL528
CHR      DS    CL3
         ORG   CHR
C        DS    FL1
H        DS    FL1
R        DS    FL1
         ORG   CHR+3
INTTBL   DS    CL61
         ORG   INTTBL
ADDRDIF1 DS    FL2
ADDRDIF2 DS    FL2
DDNAME1  DS    CL8
DDNAME2  DS    CL8
EXTCHRS1 DS    CL10
         ORG   EXTCHRS1
SBDY1    DS    CL5
         ORG   SBDY1
SCYL1    DS    CL2
STRK1    DS    CL2
SREC1    DS    CL1
         ORG   EXTCHRS1+5
EBDY1    DS    CL5
         ORG   EBDY1
ECYL1    DS    CL2
ETRK1    DS    CL2
EREC1    DS    CL1
         ORG   INTTBL+30
WORKVOL1 DS    CL6
EXTCHRS2 DS    CL10
         ORG   EXTCHRS2
SBDY2    DS    CL5
         ORG   SBDY2
SCYL2    DS    CL2
STRK2    DS    CL2
SREC2    DS    CL1
         ORG   EXTCHRS2+5
EBDY2    DS    CL5
         ORG   EBDY2
ECYL2    DS    CL2
ETRK2    DS    CL2
EREC2    DS    CL1
         ORG   INTTBL+46
WORKVOL2 DS    CL6
SDGCHR   DS    CL3
         ORG   SDGCHR
SDGC     DS    FL1
SDGH     DS    FL1
SDGR     DS    FL1
         ORG   INTTBL+55
VVACHR   DS    CL3
         ORG   VVACHR
VVAC     DS    FL1
VVAH     DS    FL1
VVAR     DS    FL1
         ORG   INTTBL+58
DOCHR    DS    CL3
         ORG   DOCHR
DOC      DS    FL1
DOH      DS    FL1
DOR      DS    FL1
         ORG   INTTBL+61
NULLDDN  DS    CL8
         ORG   NULLDDN
NULL     DS    CL2
@NM00104 DS    CL6
         ORG   NULLDDN+8
TITLEBUF DS    CL121
UCBLIST  DS    CL29
EXOLIST  DS    CL34
ALL1LIST DS    CL31
ALL2LIST DS    CL31
EXGALIST DS    CL32
ACQLST1  DS    CL96
ACQLST2  DS    CL96
         DS    CL1
ULLIST   DS    CL12
         ORG   ULLIST
ULCOUNT  DS    FL2
ULDEVLEN DS    FL2
ULDEVTYP DS    CL8
         ORG   ULLIST+12
DMPSTG   DS    CL17
IOINFO   DS    CL1
INFOAREA DS    CL38
         ORG   INFOAREA
HEADER   DS    CL4
         ORG   HEADER
WORKLEN  DS    FL2
RETNLEN  DS    FL2
         ORG   INFOAREA+4
TYPE     DS    FL2
DATALEN  DS    FL2
VOLAREA  DS    5CL6
         ORG   INFOAREA+38
ECBCODE  DS    CL1
         DS    CL1
CCHHR    DS    CL5
         ORG   CCHHR
CC       DS    FL2
HH       DS    FL2
RR       DS    FL1
         ORG   CCHHR+5
         DS    CL1
CCHHR1   DS    CL5
         ORG   CCHHR1
CC1      DS    FL2
HH1      DS    FL2
RR1      DS    FL1
         ORG   CCHHR1+5
         DS    CL1
CCHHR2   DS    CL5
         ORG   CCHHR2
CC2      DS    FL2
HH2      DS    FL2
RR2      DS    FL1
         ORG   CCHHR2+5
         DS    CL3
PCARG    DS    CL33
         ORG   PCARG
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    AL1
         ORG   PCARG+33
SSDRGLT  DS    CL20
         DS    CL3
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCCP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ALPHA    DC    XL1'C0'
NUMERIC  DC    XL1'F0'
SSMSGNUM DC    AL1(56)
@CC01334 DC    C'COTBLIST'
@CC01329 DC    C'ACQLST2'
@CC01332 DC    C'ACQLST1'
@CC01271 DC    C'SDG00'
@CC01336 DC    C'CTMSG'
@CC01284 DC    C'CPAA'
@CC01295 DC    C'CPAZ'
@CC01311 DC    C'CPBA'
@CC01328 DC    C'CPCA'
@CC01331 DC    C'CPCB'
@CC01333 DC    C'CPCC'
@CC01335 DC    C'CPCD'
@CC01337 DC    C'CPCE'
@CC01338 DC    C'CPCF'
@CC01343 DC    C'CPDA'
@CC01366 DC    C'CPEA'
@CC01385 DC    C'CPFA'
@CC01389 DC    C'CPGA'
@CC01406 DC    C'CPHA'
@CC01429 DC    C'SSAA'
@CC01279 DC    C'UV0'
@CC01281 DC    C'CP0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
FIXAREA  DS    CL350
         ORG   FIXAREA
@NM00098 DC    350X'00'
         ORG   FIXAREA+350
COPYPRIM DC    X'80'
COPYSEC  DC    X'C0'
MODID    DC    CL4'CP01'
HEX0     DC    X'0000'
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
TRKCODE  EQU   @05
COMPCODE EQU   @06
COPYCODE EQU   @04
OPENCODE EQU   @04
NIBBLE   EQU   @02
LOC      EQU   @04
LINE     EQU   @02
OUTPTR   EQU   @09
RECPTR2  EQU   @05
RECPTR1  EQU   @03
SBYTEPTR EQU   @02
EXGPTR   EQU   @04
ALL2PTR  EQU   @08
ALL1PTR  EQU   @07
EXOPTR   EQU   @06
CKPTR    EQU   @05
DMPINDEX EQU   @02
TESTRC   EQU   @03
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
ARR1     EQU   @01
COTBR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOSI0 EQU   0
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
IOINFVOL EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTREALCC EQU   CTMSG+1
CTARRAY  EQU   CTMSG+4
CTTBLCC  EQU   CTARRAY+1
CTTBLHH  EQU   CTARRAY+2
CTTBLRR  EQU   CTARRAY+3
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKLABELP EQU   CKAGL+24
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXODDN   EQU   EXOARG+8
EXOEXT   EQU   EXOARG+24
EXOCTLBK EQU   EXOARG+28
EXOPT    EQU   EXOARG+32
EXOTAB   EQU   EXOPT
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXGCTLBK EQU   EXGARG+8
EXGCCHH1 EQU   EXGARG+12
EXGCCHH2 EQU   EXGARG+16
EXGRECNO EQU   EXGARG+20
EXGDATAP EQU   EXGARG+24
EXGDATAL EQU   EXGARG+30
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00072 EQU   SV82LIST+4
SV82DCBP EQU   @NM00072
@NM00073 EQU   SV82LIST+12
SV82WRKP EQU   @NM00073
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
FILE1    EQU   0
FILE1VAL EQU   FILE1+1
FILE2    EQU   0
FILE2VAL EQU   FILE2+1
WDS1     EQU   0
WDS1FLG  EQU   WDS1+10
WDS1VAL  EQU   WDS1+21
WDS2     EQU   0
WDS2FLG  EQU   WDS2+10
WDS2VAL  EQU   WDS2+21
ACQLIST  EQU   0
ARLL     EQU   ACQLIST
AROP     EQU   ACQLIST+4
ARFLG    EQU   ACQLIST+6
ARBDUBD  EQU   ARFLG
ARINH    EQU   ARFLG
ARNMEXT  EQU   ACQLIST+7
ARVOL    EQU   ACQLIST+8
ARCOMPC  EQU   ACQLIST+26
AREXT    EQU   ACQLIST+28
ARNEDB   EQU   ACQLIST+92
SECBYTE  EQU   0
PBLOCK   EQU   0
PPREFIX  EQU   PBLOCK
PCHR     EQU   PPREFIX+1
PREC     EQU   PBLOCK+8
SBLOCK   EQU   0
SPREFIX  EQU   SBLOCK
SCHR     EQU   SPREFIX+1
SREC     EQU   SBLOCK+8
OUTBUF   EQU   0
OPPREFIX EQU   OUTBUF
OSPREFIX EQU   OUTBUF+8
OLINE    EQU   OUTBUF+24
OPLINE   EQU   OLINE
OSLINE   EQU   OLINE+32
AMSTP041 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
WDS      EQU   0
WFILE    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
DCOTBTID EQU   COTBTID
P        EQU   PBLOCK
S        EQU   SBLOCK
*                                      START UNREFERENCED COMPONENTS
@NM00105 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00103 EQU   SPREFIX+4
@NM00102 EQU   SPREFIX
@NM00101 EQU   PPREFIX+4
@NM00100 EQU   PPREFIX
@NM00097 EQU   AREXT
@NM00096 EQU   ACQLIST+25
ARHOST   EQU   ACQLIST+20
ARECB    EQU   ACQLIST+16
ARASID   EQU   ACQLIST+14
@NM00095 EQU   ARFLG
ARDRES   EQU   ARFLG
@NM00094 EQU   ACQLIST+5
WDS2LEN  EQU   WDS2+20
WDS2MEM  EQU   WDS2+12
WDS2MLN  EQU   WDS2+11
WDS2FUQ  EQU   WDS2FLG
WDS2POS  EQU   WDS2+9
WDS2PAS  EQU   WDS2+1
WDS2PLN  EQU   WDS2
WDS1LEN  EQU   WDS1+20
WDS1MEM  EQU   WDS1+12
WDS1MLN  EQU   WDS1+11
WDS1FUQ  EQU   WDS1FLG
WDS1POS  EQU   WDS1+9
WDS1PAS  EQU   WDS1+1
WDS1PLN  EQU   WDS1
FILE2LEN EQU   FILE2
FILE1LEN EQU   FILE1
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00090 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00089 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00088 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00087 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00086 EQU   VSDSCR+5
@NM00085 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00084 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00083 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00082 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00081 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00080 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00079 EQU   VSDVTOC
@NM00078 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00077 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00076 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00075 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00074 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00071 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00070 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00069 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00068 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00067 EQU   RCTAGL+10
@NM00066 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00065 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00064 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00063 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00062 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00061 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00060 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00059 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00058 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00057 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00056 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00055 EQU   EXSPACE+8
@NM00054 EQU   EXSPACE+6
@NM00053 EQU   EXSPACE+4
@NM00052 EQU   EXSPACE+1
@NM00051 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00050 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGCNT  EQU   DARGLIST+14
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RC00465 EQU   @RC00449
@RF00512 EQU   @RC00508
@RC00533 EQU   @RC00517
@RF00581 EQU   @RC00577
@RF00951 EQU   @RC00936
@PB00009 EQU   @EL00001
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCCP01,(C'PLS2038',0603,76301)

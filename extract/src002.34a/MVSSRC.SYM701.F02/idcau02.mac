         TITLE '**************** IDCAU02: AUDITMSS FSR *****************
               *        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCAU02  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCAU02   76.177'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @12,4095(,@10)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(16),0(@01)                                 0002
*   IF GDTDBG=NULLPTR THEN                                         0286
         L     @08,@PC00001                                        0286
         L     @08,GDTDBG(,@08)                                    0286
         LTR   @08,@08                                             0286
         BZ    @RT00286                                            0286
*     ;                                                            0287
*   ELSE                                                           0288
*     CALL IDCDB010(GDTTBL,'AUBA'); /*                       @Z40LB38*/
         L     @08,@PC00001                                        0288
         ST    @08,@AL00001                                        0288
         LA    @15,@CC01194                                        0288
         ST    @15,@AL00001+4                                      0288
         MVI   @AL00001+4,X'80'                                    0288
         L     @15,GDTDBG(,@08)                                    0288
         LA    @01,@AL00001                                        0288
         BALR  @14,@15                                             0288
*   OLDERID2=NEWERID2;                                             0289
@RT00286 L     @08,@PC00001                                        0289
         L     @02,GDTTR2(,@08)                                    0289
         MVC   @TS00001(95),NEWERID2(@02)                          0289
         MVC   OLDERID2(95,@02),@TS00001                           0289
*   NEWID2='AUBA';                  /*                       @Z40LB38*/
*                                                                  0290
         MVC   NEWID2(4,@02),@CC01194                              0290
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PARAMETER LIST AND POINTERS                @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0291
*   DDSTRU=ADDR(PRINTAB);           /*                       @Z40LB38*/
         LA    @02,PRINTAB                                         0291
         ST    @02,DDSTRU                                          0291
*   LASTCOND=''B;                   /*                       @Z40LB38*/
         SLR   @02,@02                                             0292
         STH   @02,LASTCOND                                        0292
*   FLAGS=''B;                      /*                       @Z40LB38*/
         MVI   FLAGS,X'00'                                         0293
*   CORESIZE=(MAXY*MAXX)+(MAXY*MAXX);/*                      @Z40LB38*/
*                                                                  0294
         MVC   CORESIZE(4),@CF01207                                0294
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UGSPACE MACRO TO GET 6K OF STORAGE.         @Z40LB38*/
*   /* DIVIDE THE STORAGE UP INTO THE Z0 AND Z1 ARRAYS.      @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0295
*   CALL IDCSAGS0(GDTTBL,CORESIZE,RTNAREA);/*                @Z40LB38*/
         ST    @08,@AL00001                                        0295
         LA    @02,CORESIZE                                        0295
         ST    @02,@AL00001+4                                      0295
         LA    @02,RTNAREA                                         0295
         ST    @02,@AL00001+8                                      0295
         MVI   @AL00001+8,X'80'                                    0295
         L     @15,GDTGSP(,@08)                                    0295
         LA    @01,@AL00001                                        0295
         BALR  @14,@15                                             0295
*   RESPECIFY                                                      0296
*     RTNREG RSTD;                                                 0296
*   TESTRC=RTNREG;                                                 0297
         LR    TESTRC,RTNREG                                       0297
*   RESPECIFY                                                      0298
*     RTNREG UNRSTD;                /*                       @Z40LB38*/
*                                                                  0298
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE RETURN CODE FROM UGSPACE IS 0. IF NOT     @Z40LB38*/
*   /* SET A RETURN CODE OF 12 AND EXIT. IF YES, CONTINUE.   @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0299
*   IF TESTRC=0 THEN                                               0299
         LTR   TESTRC,TESTRC                                       0299
         BNZ   @RF00299                                            0299
*     DO;                           /*                       @Z40LB38*/
*       Z0PTR=RTNAREA;              /*                       @Z40LB38*/
         L     @08,RTNAREA                                         0301
         LR    Z0PTR,@08                                           0301
*       Z1PTR=RTNAREA+(MAXY*MAXX);  /*                       @Z40LB38*/
*                                                                  0302
         AL    @08,@CF01206                                        0302
         LR    Z1PTR,@08                                           0302
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP DO LOOPS TO ZERO OUT BOTH ARRAYS           @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0303
*       DO Y=1 TO MAXY;             /*                       @Z40LB38*/
         LA    Y,1                                                 0303
@DL00303 DS    0H                                                  0304
*         DO X=1 TO MAXX;           /*                       @Z40LB38*/
         LA    X,1                                                 0304
@DL00304 DS    0H                                                  0305
*           Z0ARRAY(Y,X)=''B;       /*                       @Z40LB38*/
         LR    @08,Y                                               0305
         MH    @08,@CH01110                                        0305
         ALR   @08,X                                               0305
         ST    @08,@TF00001                                        0305
         ALR   @08,Z0PTR                                           0305
         AL    @08,@CF01213                                        0305
         MVI   Z0ARRAY(@08),X'00'                                  0305
*           Z1ARRAY(Y,X)=''B;       /*                       @Z40LB38*/
         LR    @08,Z1PTR                                           0306
         AL    @08,@TF00001                                        0306
         AL    @08,@CF01213                                        0306
         MVI   Z1ARRAY(@08),X'00'                                  0306
*         END;                      /*                       @Z40LB38*/
         AL    X,@CF00220                                          0307
         C     X,@CF01110                                          0307
         BNH   @DL00304                                            0307
*       END;                        /*                       @Z40LB38*/
*                                                                  0308
         AL    Y,@CF00220                                          0308
         C     Y,@CF01109                                          0308
         BNH   @DL00303                                            0308
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP A LOOP TO FIND THE LOWEST X VALUE FOR THIS @Z40LB38*/
*       /* MODEL. THIS IS DONE BY STARTING WITH THE HEADER BLOCK     */
*       /* ADDRESS FOR THE MSF BEING REPORTED ON AND SCANNING THROUGH*/
*       /* THE CUBE ADDRESSES UNTIL A 'FF' IS FOUND.         @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0309
*       I=1;                        /*                       @Z40LB38*/
         LA    I,1                                                 0309
*       DO WHILE NOTFOUND=OFF;      /*                       @Z40LB38*/
         B     @DE00310                                            0310
@DL00310 DS    0H                                                  0311
*         IF CUBEADDR(I)=LASTCUBE THEN                             0311
         L     @08,@PC00001+8                                      0311
         L     @08,MAPPTR(,@08)                                    0311
         SLR   @03,@03                                             0311
         IC    @03,CUBEADDR-1(I,@08)                               0311
         C     @03,LASTCUBE                                        0311
         BNE   @RF00311                                            0311
*           NOTFOUND=ON;            /*                       @Z40LB38*/
         OI    NOTFOUND,B'01000000'                                0312
*         I=I+1;                    /*                       @Z40LB38*/
@RF00311 AL    I,@CF00220                                          0313
*       END;                        /*                       @Z40LB38*/
*                                                                  0314
@DE00310 TM    NOTFOUND,B'01000000'                                0314
         BZ    @DL00310                                            0314
*       /*************************************************************/
*       /*                                                           */
*       /* THE END OF THE CUBE ADDRESSES IN THE HEADER BLOCK HAS BEEN*/
*       /* FOUND. NEXT THE LOW 'X' IS CALCULATED BY THE FOLLOWING    */
*       /* FORMULA: X = MAX HIGHEST RELATIVE X - NUMBER OF CUBE PTRS */
*       /* / NUMBER OF CUBE PTRS PER CHUNK * RANGE OF X PER CHUNK -  */
*       /* 2. THE MINUS 2 ACCOUNTS FOR THE FACT THAT THE LAST CHUNK  */
*       /* IS ONLY HALF FULL.                                @Z40LB38*/
*       /* THE PLUS 1 KEEPS THE INDEXING CORRECT FOR         @Z40LB38*/
*       /* PLS CODING.                                       @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0315
*       LOWX=MAXX-(((I/CUBES)*CUBERANG)-2)+1;/*              @Z40LB38*/
         LA    @03,2                                               0315
         LR    @00,I                                               0315
         SRDA  @00,32                                              0315
         D     @00,@CF00661                                        0315
         SLA   @01,2                                               0315
         LCR   @01,@01                                             0315
         ALR   @01,@03                                             0315
         AL    @01,@CF01110                                        0315
         AL    @01,@CF00220                                        0315
         LR    LOWX,@01                                            0315
*       CELLPTR=MAPPTR+(LIBSIZE*BLOCKSIZ);/*                 @Z40LB38*/
         L     @02,@PC00001+8                                      0316
         LA    @15,1320                                            0316
         AL    @15,MAPPTR(,@02)                                    0316
         ST    @15,CELLPTR                                         0316
*       ORIGLIB=ON;                 /*                       @Z40LB38*/
*                                                                  0317
         OI    ORIGLIB,B'10000000'                                 0317
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD PARAMETER LIST AND ISSUE THE UPRINT MACRO   @Z40LB38*/
*       /* TO RETRIEVE THE REPORT CHARACTERS FROM THE STATIC TEXT    */
*       /* MODULE.                                           @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0318
*       PRINTAB=''B;                /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0318
*       DARGRETP=ADDR(PRNTCHAR);    /*                       @Z40LB38*/
         L     @02,DDSTRU                                          0319
         LA    @15,PRNTCHAR                                        0319
         ST    @15,DARGRETP(,@02)                                  0319
*       DARGRETL=LENGTH(PRNTCHAR);  /*                       @Z40LB38*/
         STH   @03,DARGRETL(,@02)                                  0320
*       DARGSMOD=AUOMSG;            /*                       @Z40LB38*/
         MVC   DARGSMOD(3,@02),@CC01191                            0321
*       DARGSENT=AU0CHAR;           /*                       @Z40LB38*/
         MVI   DARGSENT(@02),X'20'                                 0322
*       CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*             @Z40LB38*/
*                                                                  0323
         L     @15,@PC00001                                        0323
         ST    @15,@AL00001                                        0323
         L     @14,@PC00001+12                                     0323
         ST    @14,@AL00001+4                                      0323
         LA    @14,DDSTRU                                          0323
         ST    @14,@AL00001+8                                      0323
         MVI   @AL00001+8,X'80'                                    0323
         L     @15,GDTPRT(,@15)                                    0323
         LA    @01,@AL00001                                        0323
         BALR  @14,@15                                             0323
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SCANREC TO SCAN THE ORIGINAL CELLMAP TO PUT  @Z40LB38*/
*       /* BLANKS IN THE REPORT ARRAYS WHERE THE ACCESS HOLES AND    */
*       /* DRD'S ARE LOCATED.                                @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0324
*       CALL SCANREC;               /*                       @Z40LB38*/
         BAL   @14,SCANREC                                         0324
*       CELLPTR=MAPPTR+BLOCKSIZ;    /*                       @Z40LB38*/
         L     @15,@PC00001+8                                      0325
         LA    @14,264                                             0325
         AL    @14,MAPPTR(,@15)                                    0325
         ST    @14,CELLPTR                                         0325
*       ORIGLIB=OFF;                /*                       @Z40LB38*/
*                                                                  0326
         NI    ORIGLIB,B'01111111'                                 0326
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SCANREC TO SCAN THE REQUESTED MSF TO         @Z40LB38*/
*       /* DETERMINE WHETHER EACH CELL IS OCCUPIED OR VACANT.        */
*       /*                                                   @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0327
*       CALL SCANREC;               /*                       @Z40LB38*/
         BAL   @14,SCANREC                                         0327
*       Z0=ON;                      /*                       @Z40LB38*/
*                                                                  0328
*       /*************************************************************/
*       /*                                                           */
*       /* CALL PRINTREC TO PRINT THE Z0 SIDE OF THE REPORT. @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0329
*       FIRSTTIM=ON;                /*                       @Z40LB38*/
         OI    Z0,B'00110000'                                      0329
*       CALL PRINTREC;              /*                       @Z40LB38*/
         BAL   @14,PRINTREC                                        0330
*       Z0=OFF;                     /*                       @Z40LB38*/
*                                                                  0331
         NI    Z0,B'11011111'                                      0331
*       /*************************************************************/
*       /*                                                           */
*       /* CALL PRINTREC TO PRINT THE Z1 SIDE OF THE REPORT. @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0332
*       CALL PRINTREC;              /*                       @Z40LB38*/
         BAL   @14,PRINTREC                                        0332
*       LASTCOND=LASTCC00;          /*                       @Z40LB38*/
         SLR   @15,@15                                             0333
         STH   @15,LASTCOND                                        0333
*     END;                          /*                       @Z40LB38*/
*   ELSE                                                           0335
*     DO;                           /*                       @Z40LB38*/
*                                                                  0335
         B     @RC00299                                            0335
@RF00299 DS    0H                                                  0336
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE UPRINT MACRO TO PRINT MESSAGE IDC3004I  @Z40LB38*/
*       /* BECAUSE STORAGE WAS NOT AVAILABLE.                @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0336
*       PRINTAB=''B;                /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0336
*       DARGSMOD=UVOMSG;            /*                       @Z40LB38*/
         L     @15,DDSTRU                                          0337
         MVC   DARGSMOD(3,@15),@CC01189                            0337
*       DARGSENT=MSG3004I;          /*                       @Z40LB38*/
         MVI   DARGSENT(@15),X'04'                                 0338
*       CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*             @Z40LB38*/
         L     @15,@PC00001                                        0339
         ST    @15,@AL00001                                        0339
         L     @14,@PC00001+12                                     0339
         ST    @14,@AL00001+4                                      0339
         LA    @14,DDSTRU                                          0339
         ST    @14,@AL00001+8                                      0339
         MVI   @AL00001+8,X'80'                                    0339
         L     @15,GDTPRT(,@15)                                    0339
         LA    @01,@AL00001                                        0339
         BALR  @14,@15                                             0339
*       LASTCOND=LASTCC12;          /*                       @Z40LB38*/
         MVC   LASTCOND(2),@CH00569                                0340
*     END;                          /*                       @Z40LB38*/
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF LASTCOND IS ZERO INDICATING THAT THE          @Z40LB38*/
*   /* STORAGE FOR THE WORK ARRAYS WAS OBTAINED. IF YES, ISSUE THE   */
*   /* UFSPACE MACRO TO FREE THE AREA.                       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*   IF LASTCOND=LASTCC00 THEN                                      0342
@RC00299 LH    @15,LASTCOND                                        0342
         LTR   @15,@15                                             0342
         BNZ   @RF00342                                            0342
*     CALL IDCSAFS0(GDTTBL,RTNAREA);/*                       @Z40LB38*/
*                                                                  0343
         L     @15,@PC00001                                        0343
         ST    @15,@AL00001                                        0343
         LA    @14,RTNAREA                                         0343
         ST    @14,@AL00001+4                                      0343
         L     @15,GDTFSP(,@15)                                    0343
         LA    @01,@AL00001                                        0343
         BALR  @14,@15                                             0343
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR A FULL REGION DUMP AND RETURN TO AMS       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0344
*   IF GDTDBG=NULLPTR THEN                                         0344
@RF00342 L     @15,@PC00001                                        0344
         L     @15,GDTDBG(,@15)                                    0344
         LTR   @15,@15                                             0344
         BZ    @RT00344                                            0344
*     ;                                                            0345
*   ELSE                                                           0346
*     CALL IDCDB010(GDTTBL,'AUBZ'); /*                       @Z40LB38*/
         L     @15,@PC00001                                        0346
         ST    @15,@AL00001                                        0346
         LA    @14,@CC01198                                        0346
         ST    @14,@AL00001+4                                      0346
         MVI   @AL00001+4,X'80'                                    0346
         L     @15,GDTDBG(,@15)                                    0346
         LA    @01,@AL00001                                        0346
         BALR  @14,@15                                             0346
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0347
*                                                                  0347
@RT00344 L     @15,@PC00001                                        0347
         ST    @15,@AL00001                                        0347
         LA    @14,MODID                                           0347
         ST    @14,@AL00001+4                                      0347
         LA    @14,LASTCOND                                        0347
         ST    @14,@AL00001+8                                      0347
         MVI   @AL00001+8,X'80'                                    0347
         L     @15,GDTEPL(,@15)                                    0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*                                                                  0348
*/********************************************************************/
*/*                                                          @Z40LB38*/
*/*      PROCEDURE NAME - SCANREC                            @Z40LB38*/
*/*                                                          @Z40LB38*/
*/*      FUNCTION - THIS ROUTINE SCANS THE MSF REQUESTED.    @Z40LB38*/
*/*                 THE SCAN STARTS AT THE LOW 'X' VALUE     @Z40LB38*/
*/*                 AND CONTINUES TO THE END OF THE MSF.     @Z40LB38*/
*/*                 IF THE MSF IS THE ORIGINAL CELLMAP,      @Z40LB38*/
*/*                 THIS ROUTINE PUTS BLANKS IN THE ARRAYS   @Z40LB38*/
*/*                 FOR BOTH SIDES OF THE MSF.               @Z40LB38*/
*/*                 OTHERWISE, IT PUTS SPECIAL CHARACTERS    @Z40LB38*/
*/*                 IN THE ARRAYS TO INDICATE THAT THE CELL  @Z40LB38*/
*/*                 IS OCCUPIED OR VACANT.                   @Z40LB38*/
*/*                                                          @Z40LB38*/
*/*      INPUT - SINCE PARAMETERS ARE NOT PASSED EXPLICITLY  @Z40LB38*/
*/*              TO THIS ROUTINE, THE INPUT IS IMPLICIT      @Z40LB38*/
*/*              AND CONSISTS OF THE FOLLOWING VALUES.       @Z40LB38*/
*/*              POINTER TO FIRST BLOCK OF MSF, FLAG TO      @Z40LB38*/
*/*              INDICATE ORIGINAL CELLMAP OR NOT AND LOW    @Z40LB38*/
*/*              'X' VALUE.                                  @Z40LB38*/
*/*                                                          @Z40LB38*/
*/*      OUTPUT - 2 ARRAYS WITH THE APPROPRIATE  DATA        @Z40LB38*/
*/*               FILLED IN  FOR THE REPORT.                 @Z40LB38*/
*/*                                                          @Z40LB38*/
*/********************************************************************/
*                                                                  0348
*SCANREC:                                                          0348
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB38*/
*                                                                  0348
@EL00001 L     @13,4(,@13)                                         0348
@EF00001 L     @00,@SIZDATD                                        0348
         LR    @01,@11                                             0348
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0348
         BR    @14                                                 0348
SCANREC  DS    0H                                                  0349
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND INITIALIZE WORK FIELDS TO     @Z40LB38*/
*   /* ZERO.                                                 @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   RETADDR1=REG14;                 /*                       @Z40LB38*/
         ST    REG14,RETADDR1                                      0349
*   X=1;                            /*                       @Z40LB38*/
         LA    @05,1                                               0350
         LR    X,@05                                               0350
*   Y=''B;                          /*                       @Z40LB38*/
         SLR   @02,@02                                             0351
         LR    Y,@02                                               0351
*   TEMPX=''B;                      /*                       @Z40LB38*/
*                                                                  0352
         ST    @02,TEMPX                                           0352
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE OUTER MOST LOOP FOR THE CELL MAP SCAN.    @Z40LB38*/
*   /* IT SCANS EACH OF THE FOUR DATA BLOCKS PER CELLMAP RECORD.     */
*   /*                                                       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0353
*   DO BLKINDEX=1 TO BLKNUM BY 1;   /*                       @Z40LB38*/
         ST    @05,BLKINDEX                                        0353
@DL00353 DS    0H                                                  0354
*     CHUNKPTR=ADDR(STRTCHNK);      /*                       @Z40LB38*/
*                                                                  0354
         L     @05,CELLPTR                                         0354
         LA    @05,STRTCHNK(,@05)                                  0354
         ST    @05,CHUNKPTR                                        0354
*     /***************************************************************/
*     /*                                                             */
*     /* THIS LOOP SCANS THE CHUNKS IN A BLOCK. THERE ARE 8  @Z40LB38*/
*     /* 32 BYTE CHUNKS PER BLOCK.                           @Z40LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0355
*     DO CHKINDEX=1 TO CHUNKNUM BY 1;/*                      @Z40LB38*/
         LA    @05,1                                               0355
         ST    @05,CHKINDEX                                        0355
@DL00355 DS    0H                                                  0356
*       CUBEPTR=CHUNKPTR;           /*                       @Z40LB38*/
*                                                                  0356
         L     CUBEPTR,CHUNKPTR                                    0356
*       /*************************************************************/
*       /*                                                           */
*       /* THIS LOOP SCANS THE CUBES PER CHUNK. THERE ARE 8  @Z40LB38*/
*       /* 4 BYTE CUBES PER CHUNK. HOWEVER, THE LAST CUBE IN EACH    */
*       /* CHUNK IS UNUSED AND IS SET TO ZEROES.             @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0357
*       DO CUBINDEX=1 TO CUBENUM BY 1;/*                     @Z40LB38*/
*                                                                  0357
         LA    @05,1                                               0357
         ST    @05,CUBINDEX                                        0357
@DL00357 DS    0H                                                  0358
*         /***********************************************************/
*         /*                                                         */
*         /* THIS LOOP SCANS EACH BIT PER BYTE AND TESTS FOR ON      */
*         /*                                                 @Z40LB38*/
*         /* OR OFF INDICATING WHETHER THE CELL IS VACANT OR         */
*         /* OCCUPIED.                                       @Z40LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0358
*         DO BYTINDEX=1 TO BYTENUM BY 1;/*                   @Z40LB38*/
         LA    BYTINDEX,1                                          0358
@DL00358 DS    0H                                                  0359
*           TEMPX=TEMPX+1;          /*                       @Z40LB38*/
         LA    @15,1                                               0359
         L     @14,TEMPX                                           0359
         ALR   @14,@15                                             0359
         ST    @14,TEMPX                                           0359
*           Y=Y+1;                  /*                       @Z40LB38*/
*                                                                  0360
         ALR   Y,@15                                               0360
*           /*********************************************************/
*           /*                                                       */
*           /* TEST IF THE LOW X VALUE HAS BEEN REACHED YET. IF      */
*           /*                                               @Z40LB38*/
*           /* YES, CONTINUE. IF NO, INCREMENT X VALUE AND POINTERS  */
*           /* AND GO TO THE NEXT BYTE.                      @Z40LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0361
*           IF X+TEMPX=>LOWX THEN                                  0361
         ALR   @14,X                                               0361
         CR    @14,LOWX                                            0361
         BL    @RF00361                                            0361
*             DO;                   /*                       @Z40LB38*/
*                                                                  0362
*               /*****************************************************/
*               /*                                                   */
*               /* TEST IF THIS IS THE ORIGINAL CELLMAP. IF YES, MOVE*/
*               /*                                           @Z40LB38*/
*               /* A BLANK INTO THE OUTPUT ARRAY FOR EVERY POSITION  */
*               /* FOR WHICH THE CORRESPONDING BIT IS OFF. THIS      */
*               /* INDICATES THAT CELL LOCATION IS NOT AVAILABLE FOR */
*               /* USE BECAUSE IT IS A HARDWARE FIXTURE.     @Z40LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0363
*               IF ORIGLIB=ON THEN                                 0363
         TM    ORIGLIB,B'10000000'                                 0363
         BNO   @RF00363                                            0363
*                 DO;               /*                       @Z40LB38*/
*                                                                  0364
*                   /*************************************************/
*                   /*                                               */
*                   /* ALLOW FOR THE LOWEST MSF X, Y=0, Z=0  @Z40LB38*/
*                   /* TO BE ONE OF THE RESERVED CELLS.      @Z40LB38*/
*                   /* LOWEST X CAN EQUAL 234, 206, OR 178.  @Z40LB38*/
*                   /* ORIGINAL CELL MAP IS OK FOR           @Z40LB38*/
*                   /* LOWEST X EQUAL 150 (MODEL A4/B4).     @Z40LB38*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0365
*                   IF FRSTORG=OFF&Y=1 THEN                        0365
         TM    FRSTORG,B'00000100'                                 0365
         BNZ   @RF00365                                            0365
         CR    Y,@15                                               0365
         BNE   @RF00365                                            0365
*                     DO;           /*                       @Z40LB38*/
*                       Z0ARRAY(Y,X)=BLANK;/*                @Z40LB38*/
         LR    @15,Y                                               0367
         MH    @15,@CH01110                                        0367
         ALR   @15,X                                               0367
         ALR   @15,Z0PTR                                           0367
         AL    @15,@CF01213                                        0367
         MVC   Z0ARRAY(1,@15),BLANK                                0367
*                       FRSTORG=ON; /*                       @Z40LB38*/
         OI    FRSTORG,B'00000100'                                 0368
*                     END;          /*                       @Z40LB38*/
*                   ELSE                                           0370
*                     IF X0Z0(BYTINDEX)=OFF THEN                   0370
         B     @RC00365                                            0370
@RF00365 LR    @01,CUBEPTR                                         0370
         ALR   @01,BYTINDEX                                        0370
         AL    @01,@CF01205                                        0370
         TM    X0Z0(@01),B'10000000'                               0370
         BNZ   @RF00370                                            0370
*                       Z0ARRAY(Y,X)=BLANK;/*                @Z40LB38*/
         LR    @15,Y                                               0371
         MH    @15,@CH01110                                        0371
         ALR   @15,X                                               0371
         ALR   @15,Z0PTR                                           0371
         AL    @15,@CF01213                                        0371
         MVC   Z0ARRAY(1,@15),BLANK                                0371
*                   IF X0Z1(BYTINDEX)=OFF THEN                     0372
@RF00370 DS    0H                                                  0372
@RC00365 LR    @01,CUBEPTR                                         0372
         ALR   @01,BYTINDEX                                        0372
         AL    @01,@CF01205                                        0372
         TM    X0Z1(@01),B'01000000'                               0372
         BNZ   @RF00372                                            0372
*                     Z1ARRAY(Y,X)=BLANK;/*                  @Z40LB38*/
         LR    @15,Y                                               0373
         MH    @15,@CH01110                                        0373
         ALR   @15,X                                               0373
         ALR   @15,Z1PTR                                           0373
         AL    @15,@CF01213                                        0373
         MVC   Z1ARRAY(1,@15),BLANK                                0373
*                   IF X1Z0(BYTINDEX)=OFF THEN                     0374
@RF00372 LR    @01,CUBEPTR                                         0374
         ALR   @01,BYTINDEX                                        0374
         AL    @01,@CF01205                                        0374
         TM    X1Z0(@01),B'00100000'                               0374
         BNZ   @RF00374                                            0374
*                     Z0ARRAY(Y,X+1)=BLANK;/*                @Z40LB38*/
         LR    @15,Y                                               0375
         MH    @15,@CH01110                                        0375
         ALR   @15,X                                               0375
         ALR   @15,Z0PTR                                           0375
         AL    @15,@CF01219                                        0375
         MVC   Z0ARRAY(1,@15),BLANK                                0375
*                   IF X1Z1(BYTINDEX)=OFF THEN                     0376
@RF00374 LR    @01,CUBEPTR                                         0376
         ALR   @01,BYTINDEX                                        0376
         AL    @01,@CF01205                                        0376
         TM    X1Z1(@01),B'00010000'                               0376
         BNZ   @RF00376                                            0376
*                     Z1ARRAY(Y,X+1)=BLANK;/*                @Z40LB38*/
*                                                                  0377
         LR    @15,Y                                               0377
         MH    @15,@CH01110                                        0377
         ALR   @15,X                                               0377
         ALR   @15,Z1PTR                                           0377
         AL    @15,@CF01219                                        0377
         MVC   Z1ARRAY(1,@15),BLANK                                0377
*                   /*************************************************/
*                   /*                                               */
*                   /* TEST IF THIS IS THE LAST DATA BLOCK IN THE    */
*                   /* MSF.                                  @Z40LB38*/
*                   /* IF NO, TEST THE REST OF THE BITS IN THE BYTE. */
*                   /* IF YES, DO NOT TEST THESE BITS BECAUSE THEY   */
*                   /* ARE NOT USED.                         @Z40LB38*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0378
*                   IF BLKINDEX^=BLKNUM THEN                       0378
@RF00376 CLC   BLKINDEX(4),@CF00043                                0378
         BE    @RF00378                                            0378
*                     DO;           /*                       @Z40LB38*/
*                       IF X2Z0(BYTINDEX)=OFF THEN                 0380
         LR    @01,CUBEPTR                                         0380
         ALR   @01,BYTINDEX                                        0380
         AL    @01,@CF01205                                        0380
         TM    X2Z0(@01),B'00001000'                               0380
         BNZ   @RF00380                                            0380
*                         Z0ARRAY(Y,X+2)=BLANK;/*            @Z40LB38*/
         LR    @15,Y                                               0381
         MH    @15,@CH01110                                        0381
         ALR   @15,X                                               0381
         ALR   @15,Z0PTR                                           0381
         AL    @15,@CF01220                                        0381
         MVC   Z0ARRAY(1,@15),BLANK                                0381
*                       IF X2Z1(BYTINDEX)=OFF THEN                 0382
@RF00380 LR    @01,CUBEPTR                                         0382
         ALR   @01,BYTINDEX                                        0382
         AL    @01,@CF01205                                        0382
         TM    X2Z1(@01),B'00000100'                               0382
         BNZ   @RF00382                                            0382
*                         Z1ARRAY(Y,X+2)=BLANK;/*            @Z40LB38*/
         LR    @15,Y                                               0383
         MH    @15,@CH01110                                        0383
         ALR   @15,X                                               0383
         ALR   @15,Z1PTR                                           0383
         AL    @15,@CF01220                                        0383
         MVC   Z1ARRAY(1,@15),BLANK                                0383
*                       IF X3Z0(BYTINDEX)=OFF THEN                 0384
@RF00382 LR    @01,CUBEPTR                                         0384
         ALR   @01,BYTINDEX                                        0384
         AL    @01,@CF01205                                        0384
         TM    X3Z0(@01),B'00000010'                               0384
         BNZ   @RF00384                                            0384
*                         Z0ARRAY(Y,X+3)=BLANK;/*            @Z40LB38*/
         LR    @15,Y                                               0385
         MH    @15,@CH01110                                        0385
         ALR   @15,X                                               0385
         ALR   @15,Z0PTR                                           0385
         AL    @15,@CF01221                                        0385
         MVC   Z0ARRAY(1,@15),BLANK                                0385
*                       IF X3Z1(BYTINDEX)=OFF THEN                 0386
@RF00384 LR    @01,CUBEPTR                                         0386
         ALR   @01,BYTINDEX                                        0386
         AL    @01,@CF01205                                        0386
         TM    X3Z1(@01),B'00000001'                               0386
         BNZ   @RF00386                                            0386
*                         Z1ARRAY(Y,X+3)=BLANK;/*            @Z40LB38*/
         LR    @15,Y                                               0387
         MH    @15,@CH01110                                        0387
         ALR   @15,X                                               0387
         ALR   @15,Z1PTR                                           0387
         AL    @15,@CF01221                                        0387
         MVC   Z1ARRAY(1,@15),BLANK                                0387
*                     END;          /*                       @Z40LB38*/
*                 END;              /*                       @Z40LB38*/
*                                                                  0389
*               /*****************************************************/
*               /*                                                   */
*               /* THIS IS NOT THE ORIGINAL CELLMAP. THIS MEANS THAT */
*               /*                                           @Z40LB38*/
*               /* EACH BIT WILL BE TESTED AS ABOVE EXCEPT THAT IT   */
*               /* MUST ALSO BE COMPARED WITH THE OUTPUT ARRAY. IF   */
*               /* THERE IS A BLANK IN THE CORRESPONDING POSITION IN */
*               /* THE OUTPUT ARRAY, A HARDWARE FIXTURE IS IN THIS   */
*               /* SPOT AND THE OCCUPANCY STATUS WILL NOT BE CHANGED.*/
*               /* THE REPORT WILL SHOW VACANT AND OCCUPIED          */
*               /* CHARACTERS FOR CELL LOCATIONS AND BLANKS FOR      */
*               /* HARDWARE FIXTURES.                        @Z40LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0390
*               ELSE                                               0390
*                 DO;               /*                       @Z40LB38*/
         B     @RC00363                                            0390
@RF00363 DS    0H                                                  0391
*                   IF X0Z0(BYTINDEX)=ON&Z0ARRAY(Y,X)^=BLANK THEN  0391
         LR    @01,CUBEPTR                                         0391
         ALR   @01,BYTINDEX                                        0391
         AL    @01,@CF01205                                        0391
         TM    X0Z0(@01),B'10000000'                               0391
         BNO   @RF00391                                            0391
         LR    @15,Y                                               0391
         MH    @15,@CH01110                                        0391
         ALR   @15,X                                               0391
         ST    @15,@TF00001                                        0391
         ALR   @15,Z0PTR                                           0391
         AL    @15,@CF01213                                        0391
         CLC   Z0ARRAY(1,@15),BLANK                                0391
         BE    @RF00391                                            0391
*                     Z0ARRAY(Y,X)=VACANT;/*                 @Z40LB38*/
         LR    @01,Z0PTR                                           0392
         AL    @01,@TF00001                                        0392
         AL    @01,@CF01213                                        0392
         MVC   Z0ARRAY(1,@01),VACANT                               0392
*                   IF X0Z0(BYTINDEX)=OFF&Z0ARRAY(Y,X)^=BLANK THEN 0393
@RF00391 LR    @01,CUBEPTR                                         0393
         ALR   @01,BYTINDEX                                        0393
         AL    @01,@CF01205                                        0393
         TM    X0Z0(@01),B'10000000'                               0393
         BNZ   @RF00393                                            0393
         LR    @15,Y                                               0393
         MH    @15,@CH01110                                        0393
         ALR   @15,X                                               0393
         ST    @15,@TF00001                                        0393
         ALR   @15,Z0PTR                                           0393
         AL    @15,@CF01213                                        0393
         CLC   Z0ARRAY(1,@15),BLANK                                0393
         BE    @RF00393                                            0393
*                     Z0ARRAY(Y,X)=OCCUPIED;/*               @Z40LB38*/
         LR    @01,Z0PTR                                           0394
         AL    @01,@TF00001                                        0394
         AL    @01,@CF01213                                        0394
         MVC   Z0ARRAY(1,@01),OCCUPIED                             0394
*                   IF X0Z1(BYTINDEX)=ON&Z1ARRAY(Y,X)^=BLANK THEN  0395
@RF00393 LR    @01,CUBEPTR                                         0395
         ALR   @01,BYTINDEX                                        0395
         AL    @01,@CF01205                                        0395
         TM    X0Z1(@01),B'01000000'                               0395
         BNO   @RF00395                                            0395
         LR    @15,Y                                               0395
         MH    @15,@CH01110                                        0395
         ALR   @15,X                                               0395
         ST    @15,@TF00001                                        0395
         ALR   @15,Z1PTR                                           0395
         AL    @15,@CF01213                                        0395
         CLC   Z1ARRAY(1,@15),BLANK                                0395
         BE    @RF00395                                            0395
*                     Z1ARRAY(Y,X)=VACANT;/*                 @Z40LB38*/
         LR    @01,Z1PTR                                           0396
         AL    @01,@TF00001                                        0396
         AL    @01,@CF01213                                        0396
         MVC   Z1ARRAY(1,@01),VACANT                               0396
*                   IF X0Z1(BYTINDEX)=OFF&Z1ARRAY(Y,X)^=BLANK THEN 0397
@RF00395 LR    @01,CUBEPTR                                         0397
         ALR   @01,BYTINDEX                                        0397
         AL    @01,@CF01205                                        0397
         TM    X0Z1(@01),B'01000000'                               0397
         BNZ   @RF00397                                            0397
         LR    @15,Y                                               0397
         MH    @15,@CH01110                                        0397
         ALR   @15,X                                               0397
         ST    @15,@TF00001                                        0397
         ALR   @15,Z1PTR                                           0397
         AL    @15,@CF01213                                        0397
         CLC   Z1ARRAY(1,@15),BLANK                                0397
         BE    @RF00397                                            0397
*                     Z1ARRAY(Y,X)=OCCUPIED;/*               @Z40LB38*/
         LR    @01,Z1PTR                                           0398
         AL    @01,@TF00001                                        0398
         AL    @01,@CF01213                                        0398
         MVC   Z1ARRAY(1,@01),OCCUPIED                             0398
*                   IF X1Z0(BYTINDEX)=ON&Z0ARRAY(Y,X+1)^=BLANK THEN
@RF00397 LR    @01,CUBEPTR                                         0399
         ALR   @01,BYTINDEX                                        0399
         AL    @01,@CF01205                                        0399
         TM    X1Z0(@01),B'00100000'                               0399
         BNO   @RF00399                                            0399
         LR    @15,Y                                               0399
         MH    @15,@CH01110                                        0399
         ALR   @15,X                                               0399
         ST    @15,@TF00001                                        0399
         ALR   @15,Z0PTR                                           0399
         AL    @15,@CF01219                                        0399
         CLC   Z0ARRAY(1,@15),BLANK                                0399
         BE    @RF00399                                            0399
*                     Z0ARRAY(Y,X+1)=VACANT;/*               @Z40LB38*/
         LR    @01,Z0PTR                                           0400
         AL    @01,@TF00001                                        0400
         AL    @01,@CF01219                                        0400
         MVC   Z0ARRAY(1,@01),VACANT                               0400
*                   IF X1Z0(BYTINDEX)=OFF&Z0ARRAY(Y,X+1)^=BLANK THEN
@RF00399 LR    @01,CUBEPTR                                         0401
         ALR   @01,BYTINDEX                                        0401
         AL    @01,@CF01205                                        0401
         TM    X1Z0(@01),B'00100000'                               0401
         BNZ   @RF00401                                            0401
         LR    @15,Y                                               0401
         MH    @15,@CH01110                                        0401
         ALR   @15,X                                               0401
         ST    @15,@TF00001                                        0401
         ALR   @15,Z0PTR                                           0401
         AL    @15,@CF01219                                        0401
         CLC   Z0ARRAY(1,@15),BLANK                                0401
         BE    @RF00401                                            0401
*                     Z0ARRAY(Y,X+1)=OCCUPIED;/*             @Z40LB38*/
         LR    @01,Z0PTR                                           0402
         AL    @01,@TF00001                                        0402
         AL    @01,@CF01219                                        0402
         MVC   Z0ARRAY(1,@01),OCCUPIED                             0402
*                   IF X1Z1(BYTINDEX)=ON&Z1ARRAY(Y,X+1)^=BLANK THEN
@RF00401 LR    @01,CUBEPTR                                         0403
         ALR   @01,BYTINDEX                                        0403
         AL    @01,@CF01205                                        0403
         TM    X1Z1(@01),B'00010000'                               0403
         BNO   @RF00403                                            0403
         LR    @15,Y                                               0403
         MH    @15,@CH01110                                        0403
         ALR   @15,X                                               0403
         ST    @15,@TF00001                                        0403
         ALR   @15,Z1PTR                                           0403
         AL    @15,@CF01219                                        0403
         CLC   Z1ARRAY(1,@15),BLANK                                0403
         BE    @RF00403                                            0403
*                     Z1ARRAY(Y,X+1)=VACANT;/*               @Z40LB38*/
         LR    @01,Z1PTR                                           0404
         AL    @01,@TF00001                                        0404
         AL    @01,@CF01219                                        0404
         MVC   Z1ARRAY(1,@01),VACANT                               0404
*                   IF X1Z1(BYTINDEX)=OFF&Z1ARRAY(Y,X+1)^=BLANK THEN
@RF00403 LR    @01,CUBEPTR                                         0405
         ALR   @01,BYTINDEX                                        0405
         AL    @01,@CF01205                                        0405
         TM    X1Z1(@01),B'00010000'                               0405
         BNZ   @RF00405                                            0405
         LR    @15,Y                                               0405
         MH    @15,@CH01110                                        0405
         ALR   @15,X                                               0405
         ST    @15,@TF00001                                        0405
         ALR   @15,Z1PTR                                           0405
         AL    @15,@CF01219                                        0405
         CLC   Z1ARRAY(1,@15),BLANK                                0405
         BE    @RF00405                                            0405
*                     Z1ARRAY(Y,X+1)=OCCUPIED;/*             @Z40LB38*/
*                                                                  0406
         LR    @01,Z1PTR                                           0406
         AL    @01,@TF00001                                        0406
         AL    @01,@CF01219                                        0406
         MVC   Z1ARRAY(1,@01),OCCUPIED                             0406
*                   /*************************************************/
*                   /*                                               */
*                   /* TEST IF THIS IS THE LAST DATA BLOCK IN THE    */
*                   /* MSF.                                  @Z40LB38*/
*                   /* IF NO, TEST THE REST OF THE BITS IN THE BYTE. */
*                   /* IF YES, DO NOT TEST THESE BITS BECAUSE THEY   */
*                   /* ARE NOT USED.                         @Z40LB38*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0407
*                   IF BLKINDEX^=BLKNUM THEN                       0407
@RF00405 CLC   BLKINDEX(4),@CF00043                                0407
         BE    @RF00407                                            0407
*                     DO;           /*                       @Z40LB38*/
*                       IF X2Z0(BYTINDEX)=ON&Z0ARRAY(Y,X+2)^=BLANK THEN
         LR    @01,CUBEPTR                                         0409
         ALR   @01,BYTINDEX                                        0409
         AL    @01,@CF01205                                        0409
         TM    X2Z0(@01),B'00001000'                               0409
         BNO   @RF00409                                            0409
         LR    @15,Y                                               0409
         MH    @15,@CH01110                                        0409
         ALR   @15,X                                               0409
         ST    @15,@TF00001                                        0409
         ALR   @15,Z0PTR                                           0409
         AL    @15,@CF01220                                        0409
         CLC   Z0ARRAY(1,@15),BLANK                                0409
         BE    @RF00409                                            0409
*                         Z0ARRAY(Y,X+2)=VACANT;/*           @Z40LB38*/
         LR    @01,Z0PTR                                           0410
         AL    @01,@TF00001                                        0410
         AL    @01,@CF01220                                        0410
         MVC   Z0ARRAY(1,@01),VACANT                               0410
*                       IF X2Z0(BYTINDEX)=OFF&Z0ARRAY(Y,X+2)^=BLANK
*                         THEN                                     0411
@RF00409 LR    @01,CUBEPTR                                         0411
         ALR   @01,BYTINDEX                                        0411
         AL    @01,@CF01205                                        0411
         TM    X2Z0(@01),B'00001000'                               0411
         BNZ   @RF00411                                            0411
         LR    @15,Y                                               0411
         MH    @15,@CH01110                                        0411
         ALR   @15,X                                               0411
         ST    @15,@TF00001                                        0411
         ALR   @15,Z0PTR                                           0411
         AL    @15,@CF01220                                        0411
         CLC   Z0ARRAY(1,@15),BLANK                                0411
         BE    @RF00411                                            0411
*                         Z0ARRAY(Y,X+2)=OCCUPIED;/*         @Z40LB38*/
         LR    @01,Z0PTR                                           0412
         AL    @01,@TF00001                                        0412
         AL    @01,@CF01220                                        0412
         MVC   Z0ARRAY(1,@01),OCCUPIED                             0412
*                       IF X2Z1(BYTINDEX)=ON&Z1ARRAY(Y,X+2)^=BLANK THEN
@RF00411 LR    @01,CUBEPTR                                         0413
         ALR   @01,BYTINDEX                                        0413
         AL    @01,@CF01205                                        0413
         TM    X2Z1(@01),B'00000100'                               0413
         BNO   @RF00413                                            0413
         LR    @15,Y                                               0413
         MH    @15,@CH01110                                        0413
         ALR   @15,X                                               0413
         ST    @15,@TF00001                                        0413
         ALR   @15,Z1PTR                                           0413
         AL    @15,@CF01220                                        0413
         CLC   Z1ARRAY(1,@15),BLANK                                0413
         BE    @RF00413                                            0413
*                         Z1ARRAY(Y,X+2)=VACANT;/*           @Z40LB38*/
         LR    @01,Z1PTR                                           0414
         AL    @01,@TF00001                                        0414
         AL    @01,@CF01220                                        0414
         MVC   Z1ARRAY(1,@01),VACANT                               0414
*                       IF X2Z1(BYTINDEX)=OFF&Z1ARRAY(Y,X+2)^=BLANK
*                         THEN                                     0415
@RF00413 LR    @01,CUBEPTR                                         0415
         ALR   @01,BYTINDEX                                        0415
         AL    @01,@CF01205                                        0415
         TM    X2Z1(@01),B'00000100'                               0415
         BNZ   @RF00415                                            0415
         LR    @15,Y                                               0415
         MH    @15,@CH01110                                        0415
         ALR   @15,X                                               0415
         ST    @15,@TF00001                                        0415
         ALR   @15,Z1PTR                                           0415
         AL    @15,@CF01220                                        0415
         CLC   Z1ARRAY(1,@15),BLANK                                0415
         BE    @RF00415                                            0415
*                         Z1ARRAY(Y,X+2)=OCCUPIED;/*         @Z40LB38*/
         LR    @01,Z1PTR                                           0416
         AL    @01,@TF00001                                        0416
         AL    @01,@CF01220                                        0416
         MVC   Z1ARRAY(1,@01),OCCUPIED                             0416
*                       IF X3Z0(BYTINDEX)=ON&Z0ARRAY(Y,X+3)^=BLANK THEN
@RF00415 LR    @01,CUBEPTR                                         0417
         ALR   @01,BYTINDEX                                        0417
         AL    @01,@CF01205                                        0417
         TM    X3Z0(@01),B'00000010'                               0417
         BNO   @RF00417                                            0417
         LR    @15,Y                                               0417
         MH    @15,@CH01110                                        0417
         ALR   @15,X                                               0417
         ST    @15,@TF00001                                        0417
         ALR   @15,Z0PTR                                           0417
         AL    @15,@CF01221                                        0417
         CLC   Z0ARRAY(1,@15),BLANK                                0417
         BE    @RF00417                                            0417
*                         Z0ARRAY(Y,X+3)=VACANT;/*           @Z40LB38*/
         LR    @01,Z0PTR                                           0418
         AL    @01,@TF00001                                        0418
         AL    @01,@CF01221                                        0418
         MVC   Z0ARRAY(1,@01),VACANT                               0418
*                       IF X3Z0(BYTINDEX)=OFF&Z0ARRAY(Y,X+3)^=BLANK
*                         THEN                                     0419
@RF00417 LR    @01,CUBEPTR                                         0419
         ALR   @01,BYTINDEX                                        0419
         AL    @01,@CF01205                                        0419
         TM    X3Z0(@01),B'00000010'                               0419
         BNZ   @RF00419                                            0419
         LR    @15,Y                                               0419
         MH    @15,@CH01110                                        0419
         ALR   @15,X                                               0419
         ST    @15,@TF00001                                        0419
         ALR   @15,Z0PTR                                           0419
         AL    @15,@CF01221                                        0419
         CLC   Z0ARRAY(1,@15),BLANK                                0419
         BE    @RF00419                                            0419
*                         Z0ARRAY(Y,X+3)=OCCUPIED;/*         @Z40LB38*/
         LR    @01,Z0PTR                                           0420
         AL    @01,@TF00001                                        0420
         AL    @01,@CF01221                                        0420
         MVC   Z0ARRAY(1,@01),OCCUPIED                             0420
*                       IF X3Z1(BYTINDEX)=ON&Z1ARRAY(Y,X+3)^=BLANK THEN
@RF00419 LR    @01,CUBEPTR                                         0421
         ALR   @01,BYTINDEX                                        0421
         AL    @01,@CF01205                                        0421
         TM    X3Z1(@01),B'00000001'                               0421
         BNO   @RF00421                                            0421
         LR    @15,Y                                               0421
         MH    @15,@CH01110                                        0421
         ALR   @15,X                                               0421
         ST    @15,@TF00001                                        0421
         ALR   @15,Z1PTR                                           0421
         AL    @15,@CF01221                                        0421
         CLC   Z1ARRAY(1,@15),BLANK                                0421
         BE    @RF00421                                            0421
*                         Z1ARRAY(Y,X+3)=VACANT;/*           @Z40LB38*/
         LR    @01,Z1PTR                                           0422
         AL    @01,@TF00001                                        0422
         AL    @01,@CF01221                                        0422
         MVC   Z1ARRAY(1,@01),VACANT                               0422
*                       IF X3Z1(BYTINDEX)=OFF&Z1ARRAY(Y,X+3)^=BLANK
*                         THEN                                     0423
@RF00421 LR    @01,CUBEPTR                                         0423
         ALR   @01,BYTINDEX                                        0423
         AL    @01,@CF01205                                        0423
         TM    X3Z1(@01),B'00000001'                               0423
         BNZ   @RF00423                                            0423
         LR    @15,Y                                               0423
         MH    @15,@CH01110                                        0423
         ALR   @15,X                                               0423
         ST    @15,@TF00001                                        0423
         ALR   @15,Z1PTR                                           0423
         AL    @15,@CF01221                                        0423
         CLC   Z1ARRAY(1,@15),BLANK                                0423
         BE    @RF00423                                            0423
*                         Z1ARRAY(Y,X+3)=OCCUPIED;/*         @Z40LB38*/
         LR    @01,Z1PTR                                           0424
         AL    @01,@TF00001                                        0424
         AL    @01,@CF01221                                        0424
         MVC   Z1ARRAY(1,@01),OCCUPIED                             0424
*                     END;          /*                       @Z40LB38*/
*                 END;              /*                       @Z40LB38*/
*             END;                  /*                       @Z40LB38*/
*           ELSE                                                   0428
*             TEMPX=TEMPX+1;        /*                       @Z40LB38*/
         B     @RC00361                                            0428
@RF00361 LA    @15,1                                               0428
         AL    @15,TEMPX                                           0428
         ST    @15,TEMPX                                           0428
*         END;                      /*                       @Z40LB38*/
@RC00361 AL    BYTINDEX,@CF00220                                   0429
         C     BYTINDEX,@CF00043                                   0429
         BNH   @DL00358                                            0429
*         CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                    @Z40LB38*/
         AL    CUBEPTR,@CF00043                                    0430
*         TEMPX=''B;                /*                       @Z40LB38*/
         SLR   @05,@05                                             0431
         ST    @05,TEMPX                                           0431
*       END;                        /*                       @Z40LB38*/
*                                                                  0432
         LA    @05,1                                               0432
         AL    @05,CUBINDEX                                        0432
         ST    @05,CUBINDEX                                        0432
         C     @05,@CF00661                                        0432
         BNH   @DL00357                                            0432
*       /*************************************************************/
*       /*                                                           */
*       /* TEST IF THIS IS THE LAST DATA BLOCK IN THE MSF.   @Z40LB38*/
*       /* IF YES, THERE WILL ONLY BE ONE CHUNK IN THIS BLOCK AND THE*/
*       /* SCAN WILL BE TERMINATED AT THIS POINT. IF NO, CONTINUE    */
*       /* WITH THE REST OF THE CHUNKS.                      @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0433
*       IF BLKINDEX=BLKNUM THEN                                    0433
         CLC   BLKINDEX(4),@CF00043                                0433
         BNE   @RF00433                                            0433
*         CHKINDEX=CHUNKNUM;        /*                       @Z40LB38*/
         MVC   CHKINDEX(4),@CF00180                                0434
*       CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*                   @Z40LB38*/
@RF00433 LA    @05,32                                              0435
         AL    @05,CHUNKPTR                                        0435
         ST    @05,CHUNKPTR                                        0435
*       X=X+4;                      /*                       @Z40LB38*/
         AL    X,@CF00043                                          0436
*       TEMPX=''B;                  /*                       @Z40LB38*/
         SLR   @05,@05                                             0437
         ST    @05,TEMPX                                           0437
*       Y=''B;                      /*                       @Z40LB38*/
         LR    Y,@05                                               0438
*     END;                          /*                       @Z40LB38*/
         LA    @05,1                                               0439
         AL    @05,CHKINDEX                                        0439
         ST    @05,CHKINDEX                                        0439
         C     @05,@CF00180                                        0439
         BNH   @DL00355                                            0439
*     CELLPTR=CELLPTR+BLOCKSIZ;     /*                       @Z40LB38*/
         LA    @05,264                                             0440
         AL    @05,CELLPTR                                         0440
         ST    @05,CELLPTR                                         0440
*   END;                            /*                       @Z40LB38*/
         LA    @05,1                                               0441
         AL    @05,BLKINDEX                                        0441
         ST    @05,BLKINDEX                                        0441
         C     @05,@CF00043                                        0441
         BNH   @DL00353                                            0441
*   REG14=RETADDR1;                 /*                       @Z40LB38*/
         L     REG14,RETADDR1                                      0442
*   RETURN;                         /*                       @Z40LB38*/
@EL00002 DS    0H                                                  0443
@EF00002 DS    0H                                                  0443
@ER00002 BR    @14                                                 0443
*   END SCANREC;                    /*                       @Z40LB38*/
*                                                                  0445
*/********************************************************************/
*/*                                                          @Z40LB38*/
*/*      PROCEDURE NAME - PRINTREC                           @Z40LB38*/
*/*                                                          @Z40LB38*/
*/*      FUNCTION - THIS ROUTINE PRINTS THE HEADER LINES     @Z40LB38*/
*/*                  AND REPORT INFORMATION FOR A PARTICULAR @Z40LB38*/
*/*                  SIDE OF THE MSF.  IT ALSO CALCULATES    @Z40LB38*/
*/*                  AND PRINTS EMPTY AND FULL CELL COUNTS   @Z40LB38*/
*/*                  FOR EACH SIDE OF THE MSF.               @Z40LB38*/
*/*                                                          @Z40LB38*/
*/*      INPUT - SINCE PARAMETERS ARE NOT PASSED EXPLICITLY  @Z40LB38*/
*/*              TO THIS ROUTINE, THE INPUT IS IMPLICIT      @Z40LB38*/
*/*              AND CONSISTS OF THE FOLLOWING VALUES.       @Z40LB38*/
*/*              A FLAG INDICATING WHETHER THE Z0 OR Z1      @Z40LB38*/
*/*              SIDE IS BEING SCANNED, THE Z ARRAY AND      @Z40LB38*/
*/*              THE OUTPUT DATA SET POINTER.                @Z40LB38*/
*/*                                                          @Z40LB38*/
*/*      OUTPUT - A PRINTED REPORT OF ONE SIDE OF THE MSF    @Z40LB38*/
*/*                                                          @Z40LB38*/
*/********************************************************************/
*                                                                  0445
*PRINTREC:                                                         0445
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB38*/
*                                                                  0445
PRINTREC DS    0H                                                  0446
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS.                              @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0446
*   RETADDR1=REG14;                 /*                       @Z40LB38*/
*                                                                  0446
         ST    REG14,RETADDR1                                      0446
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE WHICH ARRAY IS BEING USED AND SET UP      @Z40LB38*/
*   /* A COMMON DSECT TO BE USED BY THIS PROCEDURE.          @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*   IF Z0=ON THEN                                                  0447
         TM    Z0,B'00100000'                                      0447
         BNO   @RF00447                                            0447
*     DO;                           /*                       @Z40LB38*/
*       ZVALUE=Z00;                 /*                       @Z40LB38*/
         MVC   ZVALUE(2),Z00                                       0449
*       ZPTR=Z0PTR;                 /*                       @Z40LB38*/
         LR    ZPTR,Z0PTR                                          0450
*     END;                          /*                       @Z40LB38*/
*   ELSE                                                           0452
*     DO;                           /*                       @Z40LB38*/
         B     @RC00447                                            0452
@RF00447 DS    0H                                                  0453
*       ZVALUE=Z11;                 /*                       @Z40LB38*/
         MVC   ZVALUE(2),Z11                                       0453
*       ZPTR=Z1PTR;                 /*                       @Z40LB38*/
         LR    ZPTR,Z1PTR                                          0454
*     END;                          /*                       @Z40LB38*/
*   PRINTAB=''B;                    /*                       @Z40LB38*/
@RC00447 XC    PRINTAB(36),PRINTAB                                 0456
*   PRINTBUF=BLANK;                 /*                       @Z40LB38*/
*                                                                  0457
         MVI   PRINTBUF+1,C' '                                     0457
         MVC   PRINTBUF+2(118),PRINTBUF+1                          0457
         MVC   PRINTBUF(1),BLANK                                   0457
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE PARAMETER LIST AND ISSUE THE UPRINT MACRO   @Z40LB38*/
*   /* TO PRINT THE TITLE OF THE REPORT.                     @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0458
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @04,DDSTRU                                          0458
         MVC   DARGSMOD(3,@04),@CC01191                            0458
*   IF Z0=ON THEN                                                  0459
         TM    Z0,B'00100000'                                      0459
         BNO   @RF00459                                            0459
*     DARGSENT=AU0BACK;             /*                       @ZA11011*/
         MVI   DARGSENT(@04),X'14'                                 0460
*   ELSE                                                           0461
*     DARGSENT=AU0FRONT;            /*                       @ZA11011*/
         B     @RC00459                                            0461
@RF00459 L     @04,DDSTRU                                          0461
         MVI   DARGSENT(@04),X'22'                                 0461
*   DARGCNT=2;                      /*                       @Z40LB38*/
@RC00459 LA    @04,2                                               0462
         L     @15,DDSTRU                                          0462
         STH   @04,DARGCNT(,@15)                                   0462
*   DARGINS(1)=1;                   /*                       @Z40LB38*/
         MVC   DARGINS(2,@15),@CH00220                             0463
*   DARGINL(1)=LENGTH(MSFNUM);      /*                       @Z40LB38*/
         MVC   DARGINL(2,@15),@CH00043                             0464
*   DARGDTM(1)=ADDR(MSFNUM);        /*                       @Z40LB38*/
         L     @14,@PC00001+4                                      0465
         ST    @14,DARGDTM(,@15)                                   0465
*   DARGINS(2)=2;                   /*                       @Z40LB38*/
         STH   @04,DARGINS+8(,@15)                                 0466
*   DARGINL(2)=LENGTH(ZVALUE);      /*                       @Z40LB38*/
         STH   @04,DARGINL+8(,@15)                                 0467
*   DARGDTM(2)=ADDR(ZVALUE);        /*                       @Z40LB38*/
         LA    @04,ZVALUE                                          0468
         ST    @04,DARGDTM+8(,@15)                                 0468
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
*                                                                  0469
         L     @04,@PC00001                                        0469
         ST    @04,@AL00001                                        0469
         L     @15,@PC00001+12                                     0469
         ST    @15,@AL00001+4                                      0469
         LA    @15,DDSTRU                                          0469
         ST    @15,@AL00001+8                                      0469
         MVI   @AL00001+8,X'80'                                    0469
         L     @15,GDTPRT(,@04)                                    0469
         LA    @01,@AL00001                                        0469
         BALR  @14,@15                                             0469
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT BLANK LINE TO SPACE TITLE LINE.                 @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*   PRINTAB=''B;                    /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0470
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @04,DDSTRU                                          0471
         MVC   DARGSMOD(3,@04),@CC01191                            0471
*   DARGSENT=AU0PRINT;              /*                       @Z40LB38*/
         MVI   DARGSENT(@04),X'21'                                 0472
*   DARGDBP=ADDR(PRINTBUF);         /*                       @Z40LB38*/
         LA    @15,PRINTBUF                                        0473
         ST    @15,DARGDBP(,@04)                                   0473
*   DARGILP=LENGTH(PRINTBUF);       /*                       @Z40LB38*/
         MVC   DARGILP(2,@04),@CH01107                             0474
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
*                                                                  0475
         L     @04,@PC00001                                        0475
         ST    @04,@AL00001                                        0475
         L     @15,@PC00001+12                                     0475
         ST    @15,@AL00001+4                                      0475
         LA    @15,DDSTRU                                          0475
         ST    @15,@AL00001+8                                      0475
         MVI   @AL00001+8,X'80'                                    0475
         L     @15,GDTPRT(,@04)                                    0475
         LA    @01,@AL00001                                        0475
         BALR  @14,@15                                             0475
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE FIRSTIM SWITCH IS ON INDICATING THAT      @Z40LB38*/
*   /* THIS IS THE FIRST TIME THAT THIS ROUTINE HAS BEEN EXECUTED. IF*/
*   /* YES, SELECT THE PROPER RANGE OF X VALUES AND BAR VALUES FOR   */
*   /* THE REPORT LINES.                                     @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   IF FIRSTTIM=ON THEN                                            0476
         TM    FIRSTTIM,B'00010000'                                0476
         BNO   @RF00476                                            0476
*     DO;                           /*                       @Z40LB38*/
*       IF LOWX=MODEL1 THEN                                        0478
         C     LOWX,@CF01127                                       0478
         BNE   @RF00478                                            0478
*         DO;                       /*                       @Z40LB38*/
*           BARSTID=AU0MARK1;       /*                       @Z40LB38*/
         MVC   BARSTID(4),@CF01083                                 0480
*           NUMSTID=AU0XNUM1;       /*                       @Z40LB38*/
         MVC   NUMSTID(4),@CF01167                                 0481
*         END;                      /*                       @Z40LB38*/
*       IF LOWX=MODEL2 THEN                                        0483
@RF00478 C     LOWX,@CF01129                                       0483
         BNE   @RF00483                                            0483
*         DO;                       /*                       @Z40LB38*/
*           BARSTID=AU0MARK2;       /*                       @Z40LB38*/
         MVC   BARSTID(4),@CF00311                                 0485
*           NUMSTID=AU0XNUM2;       /*                       @Z40LB38*/
         MVC   NUMSTID(4),@CF01169                                 0486
*         END;                      /*                       @Z40LB38*/
*       IF LOWX=MODEL3 THEN                                        0488
@RF00483 C     LOWX,@CF00823                                       0488
         BNE   @RF00488                                            0488
*         DO;                       /*                       @Z40LB38*/
*           BARSTID=AU0MARK3;       /*                       @Z40LB38*/
         MVC   BARSTID(4),@CF01176                                 0490
*           NUMSTID=AU0XNUM3;       /*                       @Z40LB38*/
         MVC   NUMSTID(4),@CF00820                                 0491
*         END;                      /*                       @Z40LB38*/
*       IF LOWX=MODEL4 THEN                                        0493
@RF00488 C     LOWX,@CF00220                                       0493
         BNE   @RF00493                                            0493
*         DO;                       /*                       @Z40LB38*/
*           BARSTID=AU0MARK4;       /*                       @Z40LB38*/
         MVC   BARSTID(4),@CF01109                                 0495
*           NUMSTID=AU0XNUM4;       /*                       @Z40LB38*/
         MVC   NUMSTID(4),@CF01172                                 0496
*         END;                      /*                       @Z40LB38*/
*       PRNTINDX=LENGTH(YVALSTRT(1));/*                      @Z40LB38*/
@RF00493 LA    PRNTINDX,5                                          0498
*       FIRSTTIM=OFF;               /*                       @Z40LB38*/
         NI    FIRSTTIM,B'11101111'                                0499
*     END;                          /*                       @Z40LB38*/
*   PRINTAB=''B;                    /*                       @Z40LB38*/
@RF00476 XC    PRINTAB(36),PRINTAB                                 0501
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @04,DDSTRU                                          0502
         MVC   DARGSMOD(3,@04),@CC01191                            0502
*   DARGSENT=NUMSTID;               /*                       @Z40LB38*/
*                                                                  0503
         MVC   DARGSENT(1,@04),NUMSTID+3                           0503
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO PRINT OUT THE NUMERAL       @Z40LB38*/
*   /* LINE AND VERTICAL BAR LINE FOR THE TOP LINE OF THE REPORT.    */
*   /*                                                       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
         L     @04,@PC00001                                        0504
         ST    @04,@AL00001                                        0504
         L     @03,@PC00001+12                                     0504
         ST    @03,@AL00001+4                                      0504
         LA    @03,DDSTRU                                          0504
         ST    @03,@AL00001+8                                      0504
         MVI   @AL00001+8,X'80'                                    0504
         L     @15,GDTPRT(,@04)                                    0504
         LA    @01,@AL00001                                        0504
         BALR  @14,@15                                             0504
*   DARGSENT=BARSTID;               /*                       @Z40LB38*/
         L     @04,DDSTRU                                          0505
         MVC   DARGSENT(1,@04),BARSTID+3                           0505
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
         L     @04,@PC00001                                        0506
         ST    @04,@AL00001                                        0506
         L     @03,@PC00001+12                                     0506
         ST    @03,@AL00001+4                                      0506
         LA    @03,DDSTRU                                          0506
         ST    @03,@AL00001+8                                      0506
         MVI   @AL00001+8,X'80'                                    0506
         L     @15,GDTPRT(,@04)                                    0506
         LA    @01,@AL00001                                        0506
         BALR  @14,@15                                             0506
*   YINDEX=1;                       /*                       @Z40LB38*/
         LA    YINDEX,1                                            0507
*   VACANCNT=''B;                   /*                       @Z40LB38*/
         SLR   @04,@04                                             0508
         ST    @04,VACANCNT                                        0508
*   OCCUPCNT=''B;                   /*                       @Z40LB38*/
         ST    @04,OCCUPCNT                                        0509
*   STARTREP=ON;                    /*                       @Z40LB38*/
*                                                                  0510
         OI    STARTREP,B'00001000'                                0510
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE UPRINT PARAMETER LIST FOR PRINTING OUT THE     */
*   /* LINES OF THE REPORT.                                  @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0511
*   PRINTAB=''B;                    /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0511
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @04,DDSTRU                                          0512
         MVC   DARGSMOD(3,@04),@CC01191                            0512
*   DARGSENT=AU0PRINT;              /*                       @Z40LB38*/
         MVI   DARGSENT(@04),X'21'                                 0513
*   DARGDBP=ADDR(PRINTBUF);         /*                       @Z40LB38*/
         LA    @03,PRINTBUF                                        0514
         ST    @03,DARGDBP(,@04)                                   0514
*   DARGILP=LENGTH(PRINTBUF);       /*                       @Z40LB38*/
*                                                                  0515
         MVC   DARGILP(2,@04),@CH01107                             0515
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP A DO LOOP TO PRINT THE LINES OF THE REPORT.    @Z40LB38*/
*   /* THIS IS DONE BY STARTING AT THE HIGH VALUE OF Y AND BUILDING  */
*   /* EACH LINE OF THE REPORT WITH ALL THE X VALUES FOR ONE Y VALUE */
*   /* AND PRINTING THE LINE.                                @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*   DO Y=MAXY TO 1 BY-1;            /*                       @Z40LB38*/
         LA    Y,28                                                0516
@DL00516 DS    0H                                                  0517
*     PRINTBUF=BLANK;               /*                       @Z40LB38*/
*                                                                  0517
         MVI   PRINTBUF+1,C' '                                     0517
         MVC   PRINTBUF+2(118),PRINTBUF+1                          0517
         MVC   PRINTBUF(1),BLANK                                   0517
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP A DO LOOP TO MOVE EACH X VALUE FOR ONE       @Z40LB38*/
*     /* PARTICULAR Y VALUE INTO THE PRINT BUFFER.           @Z40LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0518
*     DO X=LOWX TO MAXX BY 1;       /*                       @Z40LB38*/
         LR    X,LOWX                                              0518
         B     @DE00518                                            0518
@DL00518 DS    0H                                                  0519
*       PRINTBUF(PRNTINDX+1+X-LOWX)=ZARRAY(Y,X);/*           @Z40LB38*/
*                                                                  0519
         LA    @15,1                                               0519
         LR    @14,PRNTINDX                                        0519
         ALR   @14,@15                                             0519
         ALR   @14,X                                               0519
         SLR   @14,LOWX                                            0519
         LA    @01,PRINTBUF-1(@14)                                 0519
         LR    @14,Y                                               0519
         MH    @14,@CH01110                                        0519
         ALR   @14,X                                               0519
         ST    @14,@TF00001                                        0519
         ALR   @14,ZPTR                                            0519
         AL    @14,@CF01213                                        0519
         MVC   0(1,@01),ZARRAY(@14)                                0519
*       /*************************************************************/
*       /*                                                           */
*       /* COUNT THE VACANT AND OCCUPIED CELLS IN THE MSF.   @Z40LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0520
*       IF ZARRAY(Y,X)=VACANT THEN                                 0520
         LR    @01,ZPTR                                            0520
         AL    @01,@TF00001                                        0520
         AL    @01,@CF01213                                        0520
         CLC   ZARRAY(1,@01),VACANT                                0520
         BNE   @RF00520                                            0520
*         VACANCNT=VACANCNT+1;      /*                       @Z40LB38*/
         AL    @15,VACANCNT                                        0521
         ST    @15,VACANCNT                                        0521
*       IF ZARRAY(Y,X)=OCCUPIED THEN                               0522
@RF00520 LR    @15,Y                                               0522
         MH    @15,@CH01110                                        0522
         ALR   @15,X                                               0522
         ALR   @15,ZPTR                                            0522
         AL    @15,@CF01213                                        0522
         CLC   ZARRAY(1,@15),OCCUPIED                              0522
         BNE   @RF00522                                            0522
*         OCCUPCNT=OCCUPCNT+1;      /*                       @Z40LB38*/
         LA    @15,1                                               0523
         AL    @15,OCCUPCNT                                        0523
         ST    @15,OCCUPCNT                                        0523
*     END;                          /*                       @Z40LB38*/
*                                                                  0524
@RF00522 AL    X,@CF00220                                          0524
@DE00518 C     X,@CF01110                                          0524
         BNH   @DL00518                                            0524
*     /***************************************************************/
*     /*                                                             */
*     /* IF THIS IS THE FIRST LINE OF THE REPORT, PUT THE    @Z40LB38*/
*     /* HIGH Y VALUE ON THIS LINE.                          @Z40LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0525
*     IF STARTREP=ON THEN                                          0525
         TM    STARTREP,B'00001000'                                0525
         BNO   @RF00525                                            0525
*       DO;                         /*                       @Z40LB38*/
*         PRINTBUF(1:PRNTINDX)=YVALSTRT(YINDEX);/*           @Z40LB38*/
         LR    @15,PRNTINDX                                        0527
         BCTR  @15,0                                               0527
         LR    @14,YINDEX                                          0527
         MH    @14,@CH00287                                        0527
         LA    @01,YVALSTRT-5(@14)                                 0527
         EX    @15,@SM01224                                        0527
*         PRINTBUF((X-LOWX)+1+PRNTINDX:(X-LOWX)+2*PRNTINDX)=YVALEND(
*             YINDEX);              /*                       @Z40LB38*/
         LA    @15,1                                               0528
         LR    @01,X                                               0528
         SLR   @01,LOWX                                            0528
         LR    @00,@01                                             0528
         ALR   @00,@15                                             0528
         ALR   @00,PRNTINDX                                        0528
         LR    @15,@00                                             0528
         ST    @14,@TF00001                                        0528
         LA    @14,PRINTBUF-1(@15)                                 0528
         LR    @15,PRNTINDX                                        0528
         ALR   @15,@15                                             0528
         ALR   @01,@15                                             0528
         SLR   @01,@00                                             0528
         L     @15,@TF00001                                        0528
         ST    @01,@TF00001                                        0528
         LA    @01,YVALEND-5(@15)                                  0528
         L     @15,@TF00001                                        0528
         EX    @15,@SM01226                                        0528
*         YINDEX=YINDEX+1;          /*                       @Z40LB38*/
         LA    @15,1                                               0529
         ALR   YINDEX,@15                                          0529
*         STARTREP=OFF;             /*                       @Z40LB38*/
         NI    STARTREP,B'11110111'                                0530
*       END;                        /*                       @Z40LB38*/
*                                                                  0531
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF THIS IS THE FIFTH OR THE LAST LINE     @Z40LB38*/
*     /* OF THE REPORT. IF YES, PRINT THE Y VALUE FOR THIS LINE.     */
*     /*                                                     @Z40LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0532
*     IF(Y-1)//5=0Y=1 THEN                                        0532
@RF00525 LR    @00,Y                                               0532
         BCTR  @00,0                                               0532
         SRDA  @00,32                                              0532
         D     @00,@CF00287                                        0532
         LTR   @00,@00                                             0532
         BZ    @RT00532                                            0532
         C     Y,@CF00220                                          0532
         BNE   @RF00532                                            0532
@RT00532 DS    0H                                                  0533
*       DO;                         /*                       @Z40LB38*/
*         PRINTBUF(1:PRNTINDX)=YVALSTRT(YINDEX);/*           @Z40LB38*/
         LR    @15,PRNTINDX                                        0534
         BCTR  @15,0                                               0534
         LR    @14,YINDEX                                          0534
         MH    @14,@CH00287                                        0534
         LA    @01,YVALSTRT-5(@14)                                 0534
         EX    @15,@SM01224                                        0534
*         PRINTBUF((X-LOWX)+1+PRNTINDX:(X-LOWX)+2*PRNTINDX)=YVALEND(
*             YINDEX);              /*                       @Z40LB38*/
         LA    @15,1                                               0535
         LR    @01,X                                               0535
         SLR   @01,LOWX                                            0535
         LR    @00,@01                                             0535
         ALR   @00,@15                                             0535
         ALR   @00,PRNTINDX                                        0535
         LR    @15,@00                                             0535
         ST    @14,@TF00001                                        0535
         LA    @14,PRINTBUF-1(@15)                                 0535
         LR    @15,PRNTINDX                                        0535
         ALR   @15,@15                                             0535
         ALR   @01,@15                                             0535
         SLR   @01,@00                                             0535
         L     @15,@TF00001                                        0535
         ST    @01,@TF00001                                        0535
         LA    @01,YVALEND-5(@15)                                  0535
         L     @15,@TF00001                                        0535
         EX    @15,@SM01226                                        0535
*         YINDEX=YINDEX+1;          /*                       @Z40LB38*/
         LA    @03,1                                               0536
         ALR   YINDEX,@03                                          0536
*       END;                        /*                       @Z40LB38*/
*                                                                  0537
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE THE UPRINT MACRO TO PRINT A LINE OF THE REPORT        */
*     /*                                                     @Z40LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0538
*     CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*               @Z40LB38*/
@RF00532 L     @03,@PC00001                                        0538
         ST    @03,@AL00001                                        0538
         L     @15,@PC00001+12                                     0538
         ST    @15,@AL00001+4                                      0538
         LA    @15,DDSTRU                                          0538
         ST    @15,@AL00001+8                                      0538
         MVI   @AL00001+8,X'80'                                    0538
         L     @15,GDTPRT(,@03)                                    0538
         LA    @01,@AL00001                                        0538
         BALR  @14,@15                                             0538
*   END;                            /*                       @Z40LB38*/
         BCTR  Y,0                                                 0539
         LTR   Y,Y                                                 0539
         BP    @DL00516                                            0539
*   PRINTAB=''B;                    /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0540
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @15,DDSTRU                                          0541
         MVC   DARGSMOD(3,@15),@CC01191                            0541
*   DARGSENT=BARSTID;               /*                       @Z40LB38*/
*                                                                  0542
         MVC   DARGSENT(1,@15),BARSTID+3                           0542
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO PRINT OUT THE VERTICAL      @Z40LB38*/
*   /* BAR LINE AND NUMERAL LINE FOR THE BOTTOM OF THE REPORT.       */
*   /*                                                       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0543
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
         L     @15,@PC00001                                        0543
         ST    @15,@AL00001                                        0543
         L     @14,@PC00001+12                                     0543
         ST    @14,@AL00001+4                                      0543
         LA    @14,DDSTRU                                          0543
         ST    @14,@AL00001+8                                      0543
         MVI   @AL00001+8,X'80'                                    0543
         L     @15,GDTPRT(,@15)                                    0543
         LA    @01,@AL00001                                        0543
         BALR  @14,@15                                             0543
*   DARGSENT=NUMSTID;               /*                       @Z40LB38*/
         L     @01,DDSTRU                                          0544
         MVC   DARGSENT(1,@01),NUMSTID+3                           0544
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
*                                                                  0545
         L     @15,@PC00001                                        0545
         ST    @15,@AL00001                                        0545
         L     @14,@PC00001+12                                     0545
         ST    @14,@AL00001+4                                      0545
         LA    @14,DDSTRU                                          0545
         ST    @14,@AL00001+8                                      0545
         MVI   @AL00001+8,X'80'                                    0545
         L     @15,GDTPRT(,@15)                                    0545
         LA    @01,@AL00001                                        0545
         BALR  @14,@15                                             0545
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE PARAMETER LIST AND ISSUE THE UPRINT MACRO   @Z40LB38*/
*   /* TO PRINT OUT THE OCCUPIED COUNT.                      @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*   PRINTAB=''B;                    /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0546
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @15,DDSTRU                                          0547
         MVC   DARGSMOD(3,@15),@CC01191                            0547
*   DARGSENT=AU0FULL;               /*                       @Z40LB38*/
         MVI   DARGSENT(@15),X'1D'                                 0548
*   DARGCNT=1;                      /*                       @Z40LB38*/
         LA    @14,1                                               0549
         STH   @14,DARGCNT(,@15)                                   0549
*   DARGINS(1)=1;                   /*                       @Z40LB38*/
         STH   @14,DARGINS(,@15)                                   0550
*   DARGINL(1)=LENGTH(OCCUPCNT);    /*                       @Z40LB38*/
         MVC   DARGINL(2,@15),@CH00043                             0551
*   DARGDTM(1)=ADDR(OCCUPCNT);      /*                       @Z40LB38*/
         LA    @14,OCCUPCNT                                        0552
         ST    @14,DARGDTM(,@15)                                   0552
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
*                                                                  0553
         L     @15,@PC00001                                        0553
         ST    @15,@AL00001                                        0553
         L     @14,@PC00001+12                                     0553
         ST    @14,@AL00001+4                                      0553
         LA    @14,DDSTRU                                          0553
         ST    @14,@AL00001+8                                      0553
         MVI   @AL00001+8,X'80'                                    0553
         L     @15,GDTPRT(,@15)                                    0553
         LA    @01,@AL00001                                        0553
         BALR  @14,@15                                             0553
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO PRINT OUT THE VACANT        @Z40LB38*/
*   /* COUNT.                                                @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0554
*   PRINTAB=''B;                    /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0554
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @15,DDSTRU                                          0555
         MVC   DARGSMOD(3,@15),@CC01191                            0555
*   DARGSENT=AU0EMPTY;              /*                       @Z40LB38*/
         MVI   DARGSENT(@15),X'1E'                                 0556
*   DARGCNT=1;                      /*                       @Z40LB38*/
         LA    @14,1                                               0557
         STH   @14,DARGCNT(,@15)                                   0557
*   DARGINS(1)=1;                   /*                       @Z40LB38*/
         STH   @14,DARGINS(,@15)                                   0558
*   DARGINL(1)=LENGTH(VACANCNT);    /*                       @Z40LB38*/
         MVC   DARGINL(2,@15),@CH00043                             0559
*   DARGDTM(1)=ADDR(VACANCNT);      /*                       @Z40LB38*/
         LA    @14,VACANCNT                                        0560
         ST    @14,DARGDTM(,@15)                                   0560
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
*                                                                  0561
         L     @15,@PC00001                                        0561
         ST    @15,@AL00001                                        0561
         L     @14,@PC00001+12                                     0561
         ST    @14,@AL00001+4                                      0561
         LA    @14,DDSTRU                                          0561
         ST    @14,@AL00001+8                                      0561
         MVI   @AL00001+8,X'80'                                    0561
         L     @15,GDTPRT(,@15)                                    0561
         LA    @01,@AL00001                                        0561
         BALR  @14,@15                                             0561
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD PARAMETER LIST AND ISSUE THE UPRINT MACRO       @Z40LB38*/
*   /* TO PRINT OUT THE LEGEND OF THE CHARACTERS USED IN THIS REPORT.*/
*   /*                                                       @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   PRINTAB=''B;                    /*                       @Z40LB38*/
         XC    PRINTAB(36),PRINTAB                                 0562
*   DARGSMOD=AUOMSG;                /*                       @Z40LB38*/
         L     @15,DDSTRU                                          0563
         MVC   DARGSMOD(3,@15),@CC01191                            0563
*   DARGSENT=AU0LEGND;              /*                       @Z40LB38*/
         MVI   DARGSENT(@15),X'1F'                                 0564
*   DARGCNT=2;                      /*                       @Z40LB38*/
         LA    @14,2                                               0565
         STH   @14,DARGCNT(,@15)                                   0565
*   DARGINS(1)=1;                   /*                       @Z40LB38*/
         LA    @05,1                                               0566
         STH   @05,DARGINS(,@15)                                   0566
*   DARGINL(1)=LENGTH(VACANT);      /*                       @Z40LB38*/
         STH   @05,DARGINL(,@15)                                   0567
*   DARGDTM(1)=ADDR(VACANT);        /*                       @Z40LB38*/
         LA    @04,VACANT                                          0568
         ST    @04,DARGDTM(,@15)                                   0568
*   DARGINS(2)=2;                   /*                       @Z40LB38*/
         STH   @14,DARGINS+8(,@15)                                 0569
*   DARGINL(2)=LENGTH(OCCUPIED);    /*                       @Z40LB38*/
         STH   @05,DARGINL+8(,@15)                                 0570
*   DARGDTM(2)=ADDR(OCCUPIED);      /*                       @Z40LB38*/
         LA    @14,OCCUPIED                                        0571
         ST    @14,DARGDTM+8(,@15)                                 0571
*   CALL AMSTP011(GDTTBL,PRINTPTR,DDSTRU);/*                 @Z40LB38*/
*                                                                  0572
         L     @15,@PC00001                                        0572
         ST    @15,@AL00001                                        0572
         L     @14,@PC00001+12                                     0572
         ST    @14,@AL00001+4                                      0572
         LA    @14,DDSTRU                                          0572
         ST    @14,@AL00001+8                                      0572
         MVI   @AL00001+8,X'80'                                    0572
         L     @15,GDTPRT(,@15)                                    0572
         LA    @01,@AL00001                                        0572
         BALR  @14,@15                                             0572
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN.                    @Z40LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   REG14=RETADDR1;                 /*                       @Z40LB38*/
         L     REG14,RETADDR1                                      0573
*   END PRINTREC;                   /*                       @Z40LB38*/
@EL00003 DS    0H                                                  0574
@EF00003 DS    0H                                                  0574
@ER00003 BR    @14                                                 0574
*   END IDCAU02                     /*                       @Z40LB38*/
*                                                                  0575
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*                                                                  0575
*       ;                                                          0575
@DATA    DS    0H
@CH00569 DC    H'12'
@CH01107 DC    H'120'
@SM01224 MVC   PRINTBUF(0),0(@01)
@SM01226 MVC   0(0,@14),0(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@AL00001 DS    3A
@TF00001 DS    F
IDCAU02  CSECT
         DS    0F
@CF00220 DC    F'1'
@CH00220 EQU   @CF00220+2
@CF00043 DC    F'4'
@CH00043 EQU   @CF00043+2
@CF00287 DC    F'5'
@CH00287 EQU   @CF00287+2
@CF00661 DC    F'7'
@CF00180 DC    F'8'
@CF01167 DC    F'21'
@CF01083 DC    F'22'
@CF01169 DC    F'23'
@CF00311 DC    F'24'
@CF00820 DC    F'25'
@CF01176 DC    F'26'
@CF01172 DC    F'27'
@CF01109 DC    F'28'
@CF00823 DC    F'29'
@CF01129 DC    F'57'
@CF01127 DC    F'85'
@CF01110 DC    F'98'
@CH01110 EQU   @CF01110+2
@CF01206 DC    F'2744'
@CF01207 DC    F'5488'
@CF01213 DC    F'-99'
@CF01219 DC    F'-98'
@CF01220 DC    F'-97'
@CF01221 DC    F'-96'
@CF01205 DC    F'-1'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RTNAREA  DS    A
CELLPTR  DS    A
CHUNKPTR DS    A
RETADDR1 DS    A
BLKINDEX DS    F
CHKINDEX DS    F
CUBINDEX DS    F
TEMPX    DS    F
NUMSTID  DS    F
BARSTID  DS    F
VACANCNT DS    F
OCCUPCNT DS    F
CORESIZE DS    F
LISTPTR  DS    A
WORK1    DS    A
WORK2    DS    A
WORK3    DS    A
WORK4    DS    A
LASTCOND DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
PRINTAB  DS    CL36
ZVALUE   DS    CL2
PRNTCHAR DS    CL2
         ORG   PRNTCHAR
OCCUPIED DS    CL1
VACANT   DS    CL1
         ORG   PRNTCHAR+2
FLAGS    DS    BL1
         ORG   FLAGS
ORIGLIB  DS    BL1
NOTFOUND EQU   FLAGS+0
Z0       EQU   FLAGS+0
FIRSTTIM EQU   FLAGS+0
STARTREP EQU   FLAGS+0
FRSTORG  EQU   FLAGS+0
@NM00086 EQU   FLAGS+0
         ORG   FLAGS+1
PRINTBUF DS    CL120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCAU02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
LASTCUBE DC    XL4'FF'
@CC01194 DC    C'AUBA'
@CC01198 DC    C'AUBZ'
@CC01189 DC    C'UV0'
@CC01191 DC    C'AU0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
FIXAREA  DS    CL250
         ORG   FIXAREA
@NM00085 DC    250X'00'
         ORG   FIXAREA+250
BLANK    DC    X'40'
Z00      DC    CL2'Z0'
Z11      DC    CL2'Z1'
MODID    DC    CL4'AU02'
YVALSTRT DS    CL5
         ORG   YVALSTRT+0
@NM00089 DC    CL5'27 - '
@NM00090 DC    CL5'25 - '
@NM00091 DC    CL5'20 - '
@NM00092 DC    CL5'15 - '
@NM00093 DC    CL5'10 - '
@NM00094 DC    CL5' 5 - '
@NM00095 DC    CL5' 0 - '
         ORG   YVALSTRT+65
YVALEND  DS    CL5
         ORG   YVALEND+0
@NM00096 DC    CL5' - 27'
@NM00097 DC    CL5' - 25'
@NM00098 DC    CL5' - 20'
@NM00099 DC    CL5' - 15'
@NM00100 DC    CL5' - 10'
@NM00101 DC    CL5' - 5 '
@NM00102 DC    CL5' - 0 '
         ORG   YVALEND+65
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
YINDEX   EQU   @02
PRNTINDX EQU   @09
BYTINDEX EQU   @05
Y        EQU   @04
X        EQU   @03
I        EQU   @02
LOWX     EQU   @08
CUBEPTR  EQU   @02
Z1PTR    EQU   @07
Z0PTR    EQU   @06
ZPTR     EQU   @05
TESTRC   EQU   @03
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
REG14    EQU   @14
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00066 EQU   SV82LIST+4
SV82DCBP EQU   @NM00066
@NM00067 EQU   SV82LIST+12
SV82WRKP EQU   @NM00067
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
HDRBLK   EQU   0
CUBEADDR EQU   HDRBLK+30
CELLBLK  EQU   0
STRTCHNK EQU   CELLBLK+8
CHUNK    EQU   0
CUBE     EQU   0
CUBEBYTE EQU   0
X0Z0     EQU   CUBEBYTE
X0Z1     EQU   CUBEBYTE
X1Z0     EQU   CUBEBYTE
X1Z1     EQU   CUBEBYTE
X2Z0     EQU   CUBEBYTE
X2Z1     EQU   CUBEBYTE
X3Z0     EQU   CUBEBYTE
X3Z1     EQU   CUBEBYTE
ZARRAY   EQU   0
Z0ARRAY  EQU   0
Z1ARRAY  EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
MSFNUM   EQU   0
MAPPTR   EQU   0
PRINTPTR EQU   0
*                                      START UNREFERENCED COMPONENTS
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00088 EQU   CELLBLK
BITMAP   EQU   HDRBLK+8
@NM00087 EQU   HDRBLK
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00084 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00083 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00082 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00081 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00080 EQU   VSDSCR+5
@NM00079 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00078 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00077 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00076 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00075 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00074 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00073 EQU   VSDVTOC
@NM00072 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00071 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00070 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00069 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00068 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00065 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00064 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00063 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00062 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00061 EQU   RCTAGL+10
@NM00060 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00059 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00058 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00057 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00056 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00055 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00054 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00053 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00052 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00051 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00050 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RC00363 EQU   @RC00361
@RF00407 EQU   @RC00361
@RF00423 EQU   @RC00361
@PB00003 EQU   @EL00001
@RF00378 EQU   @RC00363
@RF00386 EQU   @RC00363
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCAU02,(C'PLS0107',0603,76177)

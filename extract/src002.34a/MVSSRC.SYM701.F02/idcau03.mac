         TITLE '********** IDCAU03: AUDITMSS - CHECK AND READ LABEL ****
               ******** '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCAU03  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCAU03   76.356'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(20),0(@01)                                 0002
*                                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN ROUTINE FOR IDCAU03.                 @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   IF GDTDBG=NULLPTR THEN                                         0400
         L     @15,@PC00001                                        0400
         L     @15,GDTDBG(,@15)                                    0400
         LTR   @15,@15                                             0400
         BZ    @RT00400                                            0400
*     ;                                                            0401
*   ELSE                                                           0402
*     CALL IDCDB010(GDTTBL,'AUCA'); /*                       @Z40LB25*/
         L     @15,@PC00001                                        0402
         ST    @15,@AL00001                                        0402
         LA    @14,@CC01538                                        0402
         ST    @14,@AL00001+4                                      0402
         MVI   @AL00001+4,X'80'                                    0402
         L     @15,GDTDBG(,@15)                                    0402
         LA    @01,@AL00001                                        0402
         BALR  @14,@15                                             0402
*   OLDERID2=NEWERID2;                                             0403
@RT00400 L     @02,@PC00001                                        0403
         L     @15,GDTTR2(,@02)                                    0403
         MVC   @TS00001(95),NEWERID2(@15)                          0403
         MVC   OLDERID2(95,@15),@TS00001                           0403
*   NEWID2='AUCA';                  /*                       @Z40LB25*/
*                                                                  0404
         MVC   NEWID2(4,@15),@CC01538                              0404
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LISTS AND POINTERS.                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0405
*   REASONCD=0;                     /*                       @Z40LB25*/
         SLR   @15,@15                                             0405
         ST    @15,REASONCD                                        0405
*   FLAGS=''B;                      /* INIT WORK FLAGS       @Z40LB25*/
         XC    FLAGS(3),FLAGS                                      0406
*   DDSTRU=ADDR(PRINTAB);           /* PRINT MESSAGES        @Z40LB25*/
         LA    @14,PRINTAB                                         0407
         ST    @14,DDSTRU                                          0407
*   LASTCOND=LASTCC00;              /* NULL COND CODE        @Z40LB25*/
         STH   @15,LASTCOND                                        0408
*   RDCKPTR=ADDR(QURYAREA);         /* ICBQUERY LIST AREA    @Z40LB25*/
         LA    @15,QURYAREA                                        0409
         ST    @15,RDCKPTR                                         0409
*   QURYAREA=''B;                   /* ZERO PARM LIST        @Z40LB25*/
*                                                                  0410
         XC    QURYAREA(44),QURYAREA                               0410
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE SIZE OF STORAGE NECESSARY.              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   CORESIZE=(BLKSIZE*BLKNUM)*WRKTABNM;/*                    @Z40LB25*/
*                                                                  0411
         MVC   CORESIZE(4),@CF01638                                0411
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ZEROED STORAGE FOR THE WORKAREA.                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   CALL IDCSAGS0(GDTTBL,CORESIZE,WRKMAPTR,SETZERO);/*       @Z40LB25*/
         ST    @02,@AL00001                                        0412
         LA    @15,CORESIZE                                        0412
         ST    @15,@AL00001+4                                      0412
         LA    @15,WRKMAPTR                                        0412
         ST    @15,@AL00001+8                                      0412
         LA    @15,SETZERO                                         0412
         ST    @15,@AL00001+12                                     0412
         MVI   @AL00001+12,X'80'                                   0412
         L     @15,GDTGSP(,@02)                                    0412
         LA    @01,@AL00001                                        0412
         BALR  @14,@15                                             0412
*   RESPECIFY                                                      0413
*     RTNREG RSTD;                                                 0413
*   TESTRC=RTNREG;                                                 0414
         LR    TESTRC,RTNREG                                       0414
*   RESPECIFY                                                      0415
*     RTNREG UNRSTD;                /*                       @Z40LB25*/
*                                                                  0415
*   /*****************************************************************/
*   /*                                                               */
*   /* IF STORAGE GOTTEN, SET UP ADDRESSING TO WORK AREAS    @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   IF TESTRC=0 THEN                                               0416
         LTR   TESTRC,TESTRC                                       0416
         BNZ   @RF00416                                            0416
*     DO;                           /*                       @Z40LB25*/
*       GOTCORE=ON;                 /*                       @Z40LB25*/
         OI    GOTCORE,B'10000000'                                 0418
*       XYZ1PTR=WRKMAPTR+CORESIZE/3;/*                       @Z40LB25*/
         L     @05,WRKMAPTR                                        0419
         L     @15,CORESIZE                                        0419
         LA    @14,3                                               0419
         LR    @00,@15                                             0419
         SRDA  @00,32                                              0419
         DR    @00,@14                                             0419
         ALR   @01,@05                                             0419
         ST    @01,XYZ1PTR                                         0419
*       XYZ2PTR=WRKMAPTR+(CORESIZE*2)/3;/*                   @Z40LB25*/
*                                                                  0420
         ST    @14,@TF00001                                        0420
         M     @14,@CF00158                                        0420
         D     @14,@TF00001                                        0420
         ALR   @05,@15                                             0420
         ST    @05,XYZ2PTR                                         0420
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP A LOOP TO FIND THE LOWEST X VALUE FOR THIS @Z40LB25*/
*       /* MODEL. THIS IS DONE BY STARTING WITH THE HEADER BLOCK     */
*       /* ADDRESS FOR THE MSF BEING REPORTED ON AND THROUGH SCANNING*/
*       /* THE CUBE ADDRESSES UNTIL A 'FF' IS FOUND.         @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0421
*       I=1;                        /*                       @Z40LB25*/
         LA    I,1                                                 0421
*       DO WHILE LOXFOUND=OFF;      /*                       @Z40LB25*/
         B     @DE00422                                            0422
@DL00422 DS    0H                                                  0423
*         IF CUBEADDR(I)=LASTCUBE THEN                             0423
         L     @05,@PC00001+8                                      0423
         L     @05,BLKPTR(,@05)                                    0423
         ALR   @05,I                                               0423
         CLC   CUBEADDR-1(1,@05),LASTCUBE                          0423
         BNE   @RF00423                                            0423
*           LOXFOUND=ON;            /*                       @Z40LB25*/
         OI    LOXFOUND,B'01000000'                                0424
*         I=I+1;                    /*                       @Z40LB25*/
@RF00423 AL    I,@CF00224                                          0425
*       END;                        /*                       @Z40LB25*/
*                                                                  0426
@DE00422 TM    LOXFOUND,B'01000000'                                0426
         BZ    @DL00422                                            0426
*       /*************************************************************/
*       /*                                                           */
*       /* THE END OF THE CUBE ADDRESSES IN THE HEADER BLOCK HAS BEEN*/
*       /* FOUND. NEXT THE LOW 'X' IS CALCULATED BY THE FOLLOWING    */
*       /* FORMULA:                                          @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0427
*                                                                  0427
*       /*************************************************************/
*       /*                                                           */
*       /* X = MAX HIGHEST RELATIVE X - NUMBER OF CUBE PTRS / NUMBER */
*       /* OF CUBE PTRS PER CHUNK * RANGE OF X PER CHUNK - 2.        */
*       /*                                                   @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0427
*                                                                  0427
*       /*************************************************************/
*       /*                                                           */
*       /* THE MINUS 2 ACCOUNTS FOR THE FACT THAT THE        @Z40LB25*/
*       /* LAST CHUNK IS ONLY HALF FULL.                     @Z40LB25*/
*       /* THE + 150 ACCOUNTS FOR THE XRANGES OF             @Z40LB25*/
*       /* 150 TO 247.                                       @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0427
*       MSFLOWX=MAXX-(((I/CUBES)*CUBERANG)-2)+XSTART;/*      @Z40LB25*/
*                                                                  0427
         LR    @00,I                                               0427
         SRDA  @00,32                                              0427
         D     @00,@CF00663                                        0427
         SLA   @01,2                                               0427
         LCR   @01,@01                                             0427
         AL    @01,@CF00158                                        0427
         AL    @01,@CF01241                                        0427
         AL    @01,@CF01256                                        0427
         ST    @01,MSFLOWX                                         0427
*       /*************************************************************/
*       /*                                                           */
*       /* ALLOW ALL THE RESERVED CELLS TO BE PROCESSED      @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0428
*       DO I=1 TO 2;                /*                       @Z40LB25*/
         LA    I,1                                                 0428
@DL00428 DS    0H                                                  0429
*         IF I=1 THEN                                              0429
         C     I,@CF00224                                          0429
         BNE   @RF00429                                            0429
*           DO;                     /*                       @Z40LB25*/
*             CHUNKPTR=ADDR(ORIGCUBE(1));/* ORIG CELL MAP    @Z40LB25*/
         L     @05,@PC00001+8                                      0431
         L     @05,BLKPTR(,@05)                                    0431
         LA    @15,ORIGCUBE(,@05)                                  0431
         ST    @15,CHUNKPTR                                        0431
*             CELLPTR=ADDR(ORIGMAP(1));/*                    @Z40LB25*/
         LA    @05,ORIGMAP(,@05)                                   0432
         ST    @05,CELLPTR                                         0432
*           END;                    /*                       @Z40LB25*/
*         ELSE                                                     0434
*           DO;                     /*                       @Z40LB25*/
         B     @RC00429                                            0434
@RF00429 DS    0H                                                  0435
*             CHUNKPTR=ADDR(CELLCUBE(1));/* CURRENT CELL MAP @Z40LB25*/
         L     @05,@PC00001+8                                      0435
         L     @05,BLKPTR(,@05)                                    0435
         LA    @15,CELLCUBE(,@05)                                  0435
         ST    @15,CHUNKPTR                                        0435
*             CELLPTR=ADDR(CELLMAP(1));/*                    @Z40LB25*/
         LA    @05,CELLMAP(,@05)                                   0436
         ST    @05,CELLPTR                                         0436
*           END;                    /*                       @Z40LB25*/
*         Z=0;                      /*                       @Z40LB25*/
@RC00429 SLR   @05,@05                                             0438
         STH   @05,Z                                               0438
*         Y=0;                      /*                       @Z40LB25*/
         ST    @05,Y                                               0439
*         X=MSFLOWX;                /* MSF LOW X             @Z40LB25*/
*                                                                  0440
         L     @05,MSFLOWX                                         0440
         STH   @05,X                                               0440
*         /***********************************************************/
*         /*                                                         */
*         /* SET X=150 OR 178 OR 206 OR 234, Y=0, Z=0        @Z40LB25*/
*         /* IN THE ORIGINAL AND CURRENT CELL MAPS ON        @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0441
*         CALL LOCTOBIT;            /*                       @Z40LB25*/
         BAL   @14,LOCTOBIT                                        0441
*         IF I=1 THEN                                              0442
         C     I,@CF00224                                          0442
         BNE   @RF00442                                            0442
*           DO;                     /*                       @Z40LB25*/
*             CHUNKPTR=ADDR(ORIGCUBE(1));/* ORIG CELL MAP    @Z40LB25*/
         L     @05,@PC00001+8                                      0444
         L     @05,BLKPTR(,@05)                                    0444
         LA    @15,ORIGCUBE(,@05)                                  0444
         ST    @15,CHUNKPTR                                        0444
*             CELLPTR=ADDR(ORIGMAP(1));/*                    @Z40LB25*/
         LA    @05,ORIGMAP(,@05)                                   0445
         ST    @05,CELLPTR                                         0445
*           END;                    /*                       @Z40LB25*/
*         ELSE                                                     0447
*           DO;                     /*                       @Z40LB25*/
         B     @RC00442                                            0447
@RF00442 DS    0H                                                  0448
*             CHUNKPTR=ADDR(CELLCUBE(1));/* CURRENT CELL MAP @Z40LB25*/
         L     @05,@PC00001+8                                      0448
         L     @05,BLKPTR(,@05)                                    0448
         LA    @15,CELLCUBE(,@05)                                  0448
         ST    @15,CHUNKPTR                                        0448
*             CELLPTR=ADDR(CELLMAP(1));/*                    @Z40LB25*/
         LA    @05,CELLMAP(,@05)                                   0449
         ST    @05,CELLPTR                                         0449
*           END;                    /*                       @Z40LB25*/
*         Z=0;                      /*                       @Z40LB25*/
@RC00442 SLR   @05,@05                                             0451
         STH   @05,Z                                               0451
*         Y=0;                      /*                       @Z40LB25*/
         ST    @05,Y                                               0452
*         X=247;                    /* 247                   @Z40LB25*/
*                                                                  0453
         MVC   X(2),@CH01541                                       0453
*         /***********************************************************/
*         /*                                                         */
*         /* SET X=247, Y=0, Z=0 IN ORIGINAL CELL MAP        @Z40LB25*/
*         /* AND CURRENT CELL MAP ON                         @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0454
*         CALL LOCTOBIT;            /*                       @Z40LB25*/
         BAL   @14,LOCTOBIT                                        0454
*         IF I=1 THEN                                              0455
         C     I,@CF00224                                          0455
         BNE   @RF00455                                            0455
*           DO;                     /*                       @Z40LB25*/
*             CHUNKPTR=ADDR(ORIGCUBE);/* ORIG CELL MAP       @Z40LB25*/
         L     @05,@PC00001+8                                      0457
         L     @05,BLKPTR(,@05)                                    0457
         LA    @15,ORIGCUBE(,@05)                                  0457
         ST    @15,CHUNKPTR                                        0457
*             CELLPTR=ADDR(ORIGMAP);/*                       @Z40LB25*/
         LA    @05,ORIGMAP(,@05)                                   0458
         ST    @05,CELLPTR                                         0458
*           END;                    /*                       @Z40LB25*/
*         ELSE                                                     0460
*           DO;                     /*                       @Z40LB25*/
         B     @RC00455                                            0460
@RF00455 DS    0H                                                  0461
*             CHUNKPTR=ADDR(CELLCUBE(1));/* CURRENT CELL MAP @Z40LB25*/
         L     @05,@PC00001+8                                      0461
         L     @05,BLKPTR(,@05)                                    0461
         LA    @15,CELLCUBE(,@05)                                  0461
         ST    @15,CHUNKPTR                                        0461
*             CELLPTR=ADDR(CELLMAP(1));/*                    @Z40LB25*/
         LA    @05,CELLMAP(,@05)                                   0462
         ST    @05,CELLPTR                                         0462
*           END;                    /*                       @Z40LB25*/
*         Z=0;                      /*                       @Z40LB25*/
@RC00455 SLR   @05,@05                                             0464
         STH   @05,Z                                               0464
*         Y=7;                      /* CHANGE Y FROM 8 TO 7  @ZA16129*/
         MVC   Y(4),@CF00663                                       0465
*         X=247;                    /* 247                   @Z40LB25*/
*                                                                  0466
         MVC   X(2),@CH01541                                       0466
*         /***********************************************************/
*         /*                                                         */
*         /* SET X=247, Y=7, Z=0 IN ORIGINAL CELL MAP        @ZA16129*/
*         /* AND CURRENT CELL MAP ON                         @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0467
*         CALL LOCTOBIT;            /*                       @Z40LB25*/
         BAL   @14,LOCTOBIT                                        0467
*       END;                        /*                       @Z40LB25*/
*                                                                  0468
         AL    I,@CF00224                                          0468
         C     I,@CF00158                                          0468
         BNH   @DL00428                                            0468
*       /*************************************************************/
*       /*                                                           */
*       /* CREATE THE WORK MAP                               @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0469
*       CALL INITMAP;               /*                       @Z40LB25*/
*                                                                  0469
         BAL   @14,INITMAP                                         0469
*       /*************************************************************/
*       /*                                                           */
*       /* SET USER REQUESTED LOCATIONS INTO WORKMAP         @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0470
*       CALL LIMITS;                /*                       @Z40LB25*/
         BAL   @14,LIMITS                                          0470
*       LASTCOND=LIMITSRC;          /*                       @Z40LB25*/
*                                                                  0471
         LH    @15,LIMITSRC                                        0471
         STH   @15,LASTCOND                                        0471
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF THE USER SPECIFIED ONLY CELLS WHICH      @Z40LB25*/
*       /* ARE IN RESERVED AREAS. (WORKMAP WILL CONTAIN      @Z40LB25*/
*       /* ALL ZEROS.)                                       @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0472
*       IF ADDR(CELL)^=NULLPTR&LASTCOND=LASTCC00 THEN              0472
         SLR   @14,@14                                             0472
         L     @07,@PC00001+4                                      0472
         C     @14,FDTPTR+40(,@07)                                 0472
         BE    @RF00472                                            0472
         CR    @15,@14                                             0472
         BNE   @RF00472                                            0472
*         DO;                       /*                       @Z40LB25*/
*           DO I=1 TO BLKNUM WHILE CELFOUND=OFF;/*           @Z40LB25*/
         LA    I,1                                                 0474
@DL00474 TM    CELFOUND,B'00000010'                                0474
         BNZ   @DC00474                                            0474
*             DO II=1 TO LENGTH(WRKCUBE) WHILE CELFOUND=OFF;/*     0475
*                                                            @Z40LB25*/
         LA    II,1                                                0475
@DL00475 TM    CELFOUND,B'00000010'                                0475
         BNZ   @DC00475                                            0475
*               IF WRKCUBE(I,II)^=CELLSET THEN                     0476
         LR    @05,I                                               0476
         MH    @05,@CH01230                                        0476
         ALR   @05,II                                              0476
         L     @02,WRKMAPTR                                        0476
         ALR   @02,@05                                             0476
         AL    @02,@CF01670                                        0476
         CLC   WRKCUBE-8(1,@02),CELLSET                            0476
         BE    @RF00476                                            0476
*                 CELFOUND=ON;      /*                       @Z40LB25*/
         OI    CELFOUND,B'00000010'                                0477
*             END;                  /*                       @Z40LB25*/
@RF00476 AL    II,@CF00224                                         0478
         C     II,@CF01398                                         0478
         BNH   @DL00475                                            0478
@DC00475 DS    0H                                                  0479
*           END;                    /*                       @Z40LB25*/
         AL    I,@CF00224                                          0479
         C     I,@CF00047                                          0479
         BNH   @DL00474                                            0479
@DC00474 DS    0H                                                  0480
*           IF CELFOUND=OFF THEN                                   0480
*                                                                  0480
         TM    CELFOUND,B'00000010'                                0480
         BNZ   @RF00480                                            0480
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE MSG IDC31142I                         @Z40LB25*/
*             /* NO VALID CELLS SPECIFIED                    @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0481
*             DO;                   /*                       @Z40LB25*/
*               LASTCOND=LASTCC12;  /*                       @Z40LB25*/
         MVC   LASTCOND(2),@CH00571                                0482
*               PRINTAB=''B;        /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0483
*               DARGSMOD=AUDMSG;    /*                       @Z40LB25*/
         L     @15,DDSTRU                                          0484
         MVC   DARGSMOD(3,@15),@CC01440                            0484
*               DARGSENT=MG21142C;  /*                       @Z40LB25*/
         MVI   DARGSENT(@15),X'07'                                 0485
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB25*/
         L     @15,@PC00001                                        0486
         ST    @15,@AL00001                                        0486
         LA    @14,@CF00120                                        0486
         ST    @14,@AL00001+4                                      0486
         LA    @14,DDSTRU                                          0486
         ST    @14,@AL00001+8                                      0486
         MVI   @AL00001+8,X'80'                                    0486
         L     @15,GDTPRT(,@15)                                    0486
         LA    @01,@AL00001                                        0486
         BALR  @14,@15                                             0486
*             END;                  /*                       @Z40LB25*/
*         END;                      /*                       @Z40LB25*/
*                                                                  0488
@RF00480 DS    0H                                                  0489
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO XYZ1 WORK AREAS. USED BY PROCXRNG.           @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0489
*       IF LASTCOND^=LASTCC12&ADDR(XRNG)^=NULLPTR THEN             0489
@RF00472 CLC   LASTCOND(2),@CH00571                                0489
         BE    @RF00489                                            0489
         L     @15,@PC00001+4                                      0489
         L     @15,FDTPTR+28(,@15)                                 0489
         LTR   @15,@15                                             0489
         BZ    @RF00489                                            0489
*         DO;                       /*                       @Z40LB25*/
*           DO I=1 TO BLKNUM;       /*                       @Z40LB25*/
         LA    I,1                                                 0491
@DL00491 DS    0H                                                  0492
*             DO II=1 TO LENGTH(XYZ1CUBE);/*                 @Z40LB25*/
         LA    II,1                                                0492
@DL00492 DS    0H                                                  0493
*               XYZ1CUBE(I,II)=XYZ1CUBE(I,II)&&XYZ1CUBE(I,II);/*   0493
*                                                            @Z40LB25*/
         LR    @05,I                                               0493
         MH    @05,@CH01230                                        0493
         ALR   @05,II                                              0493
         L     @02,XYZ1PTR                                         0493
         ALR   @02,@05                                             0493
         AL    @02,@CF01670                                        0493
         XC    XYZ1CUBE-8(1,@02),XYZ1CUBE-8(@02)                   0493
*             END;                  /*                       @Z40LB25*/
         AL    II,@CF00224                                         0494
         C     II,@CF01398                                         0494
         BNH   @DL00492                                            0494
*           END;                    /*                       @Z40LB25*/
         AL    I,@CF00224                                          0495
         C     I,@CF00047                                          0495
         BNH   @DL00491                                            0495
*         END;                      /*                       @Z40LB25*/
*                                                                  0496
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR CHECK REPORT, BASED ON THE INPUT        @Z40LB25*/
*       /* MSF CELL MAPS                                     @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0497
*       IF ADDR(CHK)^=NULLPTR&LASTCOND^=LASTCC12 THEN              0497
@RF00489 SLR   @15,@15                                             0497
         L     @14,@PC00001+4                                      0497
         C     @15,FDTPTR+4(,@14)                                  0497
         BE    @RF00497                                            0497
         CLC   LASTCOND(2),@CH00571                                0497
         BE    @RF00497                                            0497
*         DO;                       /*                       @Z40LB25*/
*           HDCKPTR=ADDR(HDSETCK);  /*                       @Z40LB25
*                                      PRT CHECK PARM LST    @Z40LB25*/
         LA    @14,HDSETCK                                         0499
         ST    @14,HDCKPTR                                         0499
*           HDSETCK=''B;            /* ZERO CK FLAGS         @Z40LB25*/
         XC    HDSETCK(4),HDSETCK                                  0500
*           HDRDPTR=NULLPTR;        /*                       @Z40LB25*/
*                                                                  0501
         ST    @15,HDRDPTR                                         0501
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK REPORT                                  @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0502
*           CALL CHECKLIB;          /*                       @Z40LB25*/
*                                                                  0502
         BAL   @14,CHECKLIB                                        0502
*           /*********************************************************/
*           /*                                                       */
*           /* NO CHECK REPORT PRINTED BECAUSE NO            @Z40LB25*/
*           /* DISCREPANCIES WERE FOUND                      @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0503
*           IF XYZ1PRTD=OFF&XYZ2PRTD=OFF&RLBLPRTD=OFF&CHECKRC=LASTCC00
*             THEN                                                 0503
         TM    XYZ1PRTD,B'00000011'                                0503
         BNZ   @RF00503                                            0503
         TM    RLBLPRTD,B'10000000'                                0503
         BNZ   @RF00503                                            0503
         LH    @15,CHECKRC                                         0503
         LTR   @15,@15                                             0503
         BNZ   @RF00503                                            0503
*             DO;                   /*                       @Z40LB25*/
*               PRINTAB=''B;        /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0505
*               DARGSMOD=AUDMSG;    /*                       @Z40LB25*/
         L     @15,DDSTRU                                          0506
         MVC   DARGSMOD(3,@15),@CC01440                            0506
*               DARGSENT=MG31146I;  /*                       @Z40LB25*/
         MVI   DARGSENT(@15),X'2E'                                 0507
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB25*/
         L     @15,@PC00001                                        0508
         ST    @15,@AL00001                                        0508
         LA    @14,@CF00120                                        0508
         ST    @14,@AL00001+4                                      0508
         LA    @14,DDSTRU                                          0508
         ST    @14,@AL00001+8                                      0508
         MVI   @AL00001+8,X'80'                                    0508
         L     @15,GDTPRT(,@15)                                    0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*             END;                  /*                       @Z40LB25*/
*                                                                  0509
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN THE HIGHEST CONDITION CODE             @VS41112*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0510
*           IF CHECKRC>LASTCOND THEN                               0510
@RF00503 LH    @15,CHECKRC                                         0510
         CH    @15,LASTCOND                                        0510
         BNH   @RF00510                                            0510
*             LASTCOND=CHECKRC;     /*                       @Z40LB25*/
         STH   @15,LASTCOND                                        0511
*         END;                      /*                       @Z40LB25*/
*       ELSE                                                       0513
*                                                                  0513
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR READ LABEL REPORT                     @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0513
*         IF ADDR(RDLBL)^=NULLPTR&LASTCOND^=LASTCC12 THEN          0513
         B     @RC00497                                            0513
@RF00497 SLR   @15,@15                                             0513
         L     @14,@PC00001+4                                      0513
         C     @15,FDTPTR+8(,@14)                                  0513
         BE    @RF00513                                            0513
         CLC   LASTCOND(2),@CH00571                                0513
         BE    @RF00513                                            0513
*           DO;                     /*                       @Z40LB25*/
*             HDRDPTR=ADDR(HDSETRD);/*                       @Z40LB25
*                                      PRT READ PARM LST     @Z40LB25*/
         LA    @14,HDSETRD                                         0515
         ST    @14,HDRDPTR                                         0515
*             HDSETRD=''B;          /*                       @Z40LB25
*                                      ZERO READ FLAGS       @Z40LB25*/
         XC    HDSETRD(8),HDSETRD                                  0516
*             HDCKPTR=NULLPTR;      /*                       @Z40LB25*/
*                                                                  0517
         ST    @15,HDCKPTR                                         0517
*             /*******************************************************/
*             /*                                                     */
*             /* READ LABEL REPORT                           @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0518
*             CALL READLBL;         /*                       @Z40LB25*/
*                                                                  0518
         BAL   @14,READLBL                                         0518
*             /*******************************************************/
*             /*                                                     */
*             /* NO READLABEL REPORT PRINTED BECAUSE NO      @Z40LB25*/
*             /* DISCREPANCIES WERE FOUND                    @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0519
*             IF XYZ1PRTD=OFF&XYZ2PRTD=OFF&RLBLPRTD=OFF&READRC=LASTCC00
*               THEN                                               0519
         TM    XYZ1PRTD,B'00000011'                                0519
         BNZ   @RF00519                                            0519
         TM    RLBLPRTD,B'10000000'                                0519
         BNZ   @RF00519                                            0519
         LH    @15,READRC                                          0519
         LTR   @15,@15                                             0519
         BNZ   @RF00519                                            0519
*               DO;                 /*                       @Z40LB25*/
*                 PRINTAB=''B;      /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0521
*                 DARGSMOD=AUDMSG;  /*                       @Z40LB25*/
         L     @15,DDSTRU                                          0522
         MVC   DARGSMOD(3,@15),@CC01440                            0522
*                 DARGSENT=MG31146I;/*                       @Z40LB25*/
         MVI   DARGSENT(@15),X'2E'                                 0523
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Z40LB25*/
         L     @15,@PC00001                                        0524
         ST    @15,@AL00001                                        0524
         LA    @14,@CF00120                                        0524
         ST    @14,@AL00001+4                                      0524
         LA    @14,DDSTRU                                          0524
         ST    @14,@AL00001+8                                      0524
         MVI   @AL00001+8,X'80'                                    0524
         L     @15,GDTPRT(,@15)                                    0524
         LA    @01,@AL00001                                        0524
         BALR  @14,@15                                             0524
*               END;                /*                       @Z40LB25*/
*                                                                  0525
*             /*******************************************************/
*             /*                                                     */
*             /* RETURN THE HIGHEST CONDITION CODE           @VS41112*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0526
*             IF READRC>LASTCOND THEN                              0526
@RF00519 LH    @15,READRC                                          0526
         CH    @15,LASTCOND                                        0526
         BNH   @RF00526                                            0526
*               LASTCOND=READRC;    /*                       @Z40LB25*/
         STH   @15,LASTCOND                                        0527
*           END;                    /*                       @Z40LB25*/
*                                                                  0528
@RF00526 DS    0H                                                  0529
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF A REPORT WAS PRINTED SO                  @Z40LB25*/
*       /* SUBTITLES AND HEADERS CAN BE CLEARED.             @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0529
*       IF XYZ1PRTD=ON×XYZ2PRTD=ON×RLBLPRTD=ON THEN                0529
@RF00513 DS    0H                                                  0529
@RC00497 TM    XYZ1PRTD,B'00000011'                                0529
         BNZ   @RT00529                                            0529
         TM    RLBLPRTD,B'10000000'                                0529
         BNO   @RF00529                                            0529
@RT00529 DS    0H                                                  0530
*         CALL AMSTP044(GDTTBL,PRINTME);/*                   @Z40LB25*/
         L     @15,@PC00001                                        0530
         ST    @15,@AL00001                                        0530
         L     @14,@PC00001+12                                     0530
         ST    @14,@AL00001+4                                      0530
         MVI   @AL00001+4,X'80'                                    0530
         L     @15,GDTRES(,@15)                                    0530
         LA    @01,@AL00001                                        0530
         BALR  @14,@15                                             0530
*     END;                          /*                       @Z40LB25*/
*                                                                  0531
*   /*****************************************************************/
*   /*                                                               */
*   /* STORAGE IS NOT AVAILABLE                              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0532
*   ELSE                                                           0532
*     DO;                           /*                       @Z40LB25*/
         B     @RC00416                                            0532
@RF00416 DS    0H                                                  0533
*       PRINTAB=''B;                /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0533
*       DARGSMOD=UNIVMSG;           /*                       @Z40LB25*/
         L     @15,DDSTRU                                          0534
         MVC   DARGSMOD(3,@15),@CC01438                            0534
*       DARGSENT=MSG3004I;          /*                       @Z40LB25*/
         MVI   DARGSENT(@15),X'04'                                 0535
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Z40LB25*/
         L     @15,@PC00001                                        0536
         ST    @15,@AL00001                                        0536
         L     @14,@PC00001+12                                     0536
         ST    @14,@AL00001+4                                      0536
         LA    @14,DDSTRU                                          0536
         ST    @14,@AL00001+8                                      0536
         MVI   @AL00001+8,X'80'                                    0536
         L     @15,GDTPRT(,@15)                                    0536
         LA    @01,@AL00001                                        0536
         BALR  @14,@15                                             0536
*       LASTCOND=LASTCC12;          /*                       @Z40LB25*/
         MVC   LASTCOND(2),@CH00571                                0537
*     END;                          /*                       @Z40LB25*/
*                                                                  0538
*   /*****************************************************************/
*   /*                                                               */
*   /* IF STORAGE GOTTEN, FREE IT                            @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0539
*   IF GOTCORE=ON THEN              /*                       @Z40LB25*/
@RC00416 TM    GOTCORE,B'10000000'                                 0539
         BNO   @RF00539                                            0539
*     CALL IDCSAFS0(GDTTBL,WRKMAPTR);/*                      @Z40LB25*/
*                                                                  0540
         L     @15,@PC00001                                        0540
         ST    @15,@AL00001                                        0540
         LA    @14,WRKMAPTR                                        0540
         ST    @14,@AL00001+4                                      0540
         L     @15,GDTFSP(,@15)                                    0540
         LA    @01,@AL00001                                        0540
         BALR  @14,@15                                             0540
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR A FULL REGION DUMP AND RETURN              @Z40LB25*/
*   /* TO IDCAU01                                            @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*   IF GDTDBG=NULLPTR THEN                                         0541
@RF00539 L     @15,@PC00001                                        0541
         L     @15,GDTDBG(,@15)                                    0541
         LTR   @15,@15                                             0541
         BZ    @RT00541                                            0541
*     ;                                                            0542
*   ELSE                                                           0543
*     CALL IDCDB010(GDTTBL,'AUCZ'); /*                       @Z40LB25*/
         L     @15,@PC00001                                        0543
         ST    @15,@AL00001                                        0543
         LA    @14,@CC01546                                        0543
         ST    @14,@AL00001+4                                      0543
         MVI   @AL00001+4,X'80'                                    0543
         L     @15,GDTDBG(,@15)                                    0543
         LA    @01,@AL00001                                        0543
         BALR  @14,@15                                             0543
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0544
*                                                                  0544
@RT00541 L     @15,@PC00001                                        0544
         ST    @15,@AL00001                                        0544
         LA    @14,MODID                                           0544
         ST    @14,@AL00001+4                                      0544
         LA    @14,LASTCOND                                        0544
         ST    @14,@AL00001+8                                      0544
         MVI   @AL00001+8,X'80'                                    0544
         L     @15,GDTEPL(,@15)                                    0544
         LA    @01,@AL00001                                        0544
         BALR  @14,@15                                             0544
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0545
*                                                                  0545
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - INITMAP                              @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - FOR THE FOLLOWING PARAMETERS OF CHECK -    @Z40LB25*/
*   /* XRANGE AND ALL, OR CELL AND ALL, OR CELL              @Z40LB25*/
*   /* AND FULL, OR CELL WITH EMPTY, AND FOR THE CELL        @Z40LB25*/
*   /* PARAMETER OF READLABEL, THE ORIGINAL CELL MAP         @Z40LB25*/
*   /* IS PLACED INTO WORKMAP. ON BITS                       @Z40LB25*/
*   /* WILL INDICATE EMPTY AND FULL CELLS, AND OFF BITS      @Z40LB25*/
*   /* WILL INDICATE MSF ACCESS AREAS, DRDS, ETC.            @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FOR READLABEL AND XRANGE, OR CHECK WITH FULL OR       @Z40LB25*/
*   /* EMPTY, THE CURRENT MSF CELL MAP IS PLACED INTO        @Z40LB25*/
*   /* WORKMAP. ON BITS WILL INDICATE                        @Z40LB25*/
*   /* EMPTY CELLS AND OFF BITS WILL INDICATE                @Z40LB25*/
*   /* FULL CELLS, MSF ACCESS AREAS, DRDS, ETC.              @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FOR CHECK WITH XRANGE AND FULL OR READLABEL           @Z40LB25*/
*   /* WITH XRANGE THE MSC CELL MAP IS COPIED                @Z40LB25*/
*   /* CELL INTO WORKMAP, THE BIT SETTINGS                   @Z40LB25*/
*   /* IN WORKMAP ARE REVERSED, AND THE ORIGINAL             @Z40LB25*/
*   /* MAP IS 'ANDED' WITH THE CONTENTS OF WORKMAP.          @Z40LB25*/
*   /* ON BITS IN WORKMAP WILL INDICATE FULL CELLS.          @Z40LB25*/
*   /* OFF BITS WILL INDICATE EMPTY CELLS, MSF ACCESS        @Z40LB25*/
*   /* AREAS, DRDS, ETC.                                     @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* MSC CURRENT CELL MAP                                  @Z40LB25*/
*   /* MSC ORIGINAL CELL MAP                                 @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0545
*INITMAP:                                                          0545
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  0545
@EL00001 L     @13,4(,@13)                                         0545
@EF00001 L     @00,@SIZDATD                                        0545
         LR    @01,@08                                             0545
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0545
         BR    @14                                                 0545
INITMAP  ST    @14,12(,@13)                                        0545
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE FOLLOWING CHECK PARAMETERS - XRANGE       @Z40LB25*/
*   /* AND ALL, CELL AND ALL, CELL AND EMPTY, OR CELL        @Z40LB25*/
*   /* AND FULL. FOR READ, PROCESS THE CELL PARAMETER -      @Z40LB25*/
*   /* (THIS WILL ALLOW THE READ REGARDLESS OF THE CELL      @Z40LB25*/
*   /* BEING EMPTY OR FULL.                                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*   IF(ADDR(XRNG)^=NULLPTR&ADDR(CHALL)^=NULLPTR)×(ADDR(CELL)^=NULLPTR&(
*       ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR×ADDR(FULL)^=NULLPTR))
*       ×(ADDR(RDLBL)^=NULLPTR&ADDR(CELL)^=NULLPTR) THEN           0546
         SLR   @15,@15                                             0546
         L     @14,@PC00001+4                                      0546
         C     @15,FDTPTR+28(,@14)                                 0546
         BE    @GL00011                                            0546
         C     @15,FDTPTR+20(,@14)                                 0546
         BNE   @RT00546                                            0546
@GL00011 SLR   @15,@15                                             0546
         L     @14,@PC00001+4                                      0546
         C     @15,FDTPTR+40(,@14)                                 0546
         BE    @GL00010                                            0546
         C     @15,FDTPTR+20(,@14)                                 0546
         BNE   @RT00546                                            0546
         C     @15,FDTPTR+16(,@14)                                 0546
         BNE   @RT00546                                            0546
         C     @15,FDTPTR+12(,@14)                                 0546
         BNE   @RT00546                                            0546
@GL00010 SLR   @15,@15                                             0546
         L     @14,@PC00001+4                                      0546
         C     @15,FDTPTR+8(,@14)                                  0546
         BE    @RF00546                                            0546
         C     @15,FDTPTR+40(,@14)                                 0546
         BE    @RF00546                                            0546
@RT00546 DS    0H                                                  0547
*     DO;                           /*                       @Z40LB25*/
*                                                                  0547
*       /*************************************************************/
*       /*                                                           */
*       /* PLACE THE ORIGINAL CELL MAP INTO WORKMAP          @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0548
*       DO I=1 TO BLKNUM;           /*                       @Z40LB25*/
         LA    I,1                                                 0548
@DL00548 DS    0H                                                  0549
*         WRKCUBE(I)=ORIGCUBE(I);   /*                       @Z40LB25*/
         LR    @05,I                                               0549
         MH    @05,@CH01230                                        0549
         L     @01,WRKMAPTR                                        0549
         ALR   @01,@05                                             0549
         AL    @01,@CF01672                                        0549
         L     @15,@PC00001+8                                      0549
         L     @15,BLKPTR(,@15)                                    0549
         ALR   @15,@05                                             0549
         MVC   WRKCUBE-8(256,@01),ORIGCUBE-264(@15)                0549
*       END;                        /*                       @Z40LB25*/
         AL    I,@CF00224                                          0550
         C     I,@CF00047                                          0550
         BNH   @DL00548                                            0550
*       RETURN;                     /*                       @Z40LB25*/
@EL00002 DS    0H                                                  0551
@EF00002 DS    0H                                                  0551
@ER00002 L     @14,12(,@13)                                        0551
         BR    @14                                                 0551
*     END;                          /*                       @Z40LB25*/
*                                                                  0552
*   /*****************************************************************/
*   /*                                                               */
*   /* PLACE THE CURRENT MSF CELL MAP INTO WORKMAP           @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   DO I=1 TO BLKNUM;               /* COPY MSC CELL MAP     @Z40LB25*/
@RF00546 LA    I,1                                                 0553
@DL00553 DS    0H                                                  0554
*     WRKCUBE(I)=CELLCUBE(I);       /*                       @Z40LB25*/
         LR    @05,I                                               0554
         MH    @05,@CH01230                                        0554
         L     @01,WRKMAPTR                                        0554
         ALR   @01,@05                                             0554
         AL    @01,@CF01672                                        0554
         L     @15,@PC00001+8                                      0554
         L     @15,BLKPTR(,@15)                                    0554
         ALR   @15,@05                                             0554
         MVC   WRKCUBE-8(256,@01),CELLCUBE-264(@15)                0554
*   END;                            /*                       @Z40LB25*/
*                                                                  0555
         AL    I,@CF00224                                          0555
         C     I,@CF00047                                          0555
         BNH   @DL00553                                            0555
*   /*****************************************************************/
*   /*                                                               */
*   /* EMPTY AND XRANGE PARAMETERS OF CHECK?                 @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0556
*   IF ADDR(XRNG)^=NULLPTR&ADDR(EMPTY)^=NULLPTR THEN               0556
         SLR   @15,@15                                             0556
         L     @14,@PC00001+4                                      0556
         C     @15,FDTPTR+28(,@14)                                 0556
         BE    @RF00556                                            0556
         C     @15,FDTPTR+16(,@14)                                 0556
         BNE   @RT00556                                            0556
*     RETURN;                       /*                       @Z40LB25*/
*                                                                  0557
*   /*****************************************************************/
*   /*                                                               */
*   /* REVERSE THE BITS IN THE CURRENT CELL MAP.             @Z40LB25*/
*   /* 1 BITS INDICATE FULL CELLS, FANS, DRDS, ETC.          @Z40LB25*/
*   /* 0 BITS INDICATE AVAILABLE CELLS.                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*   DO I=1 TO BLKNUM;               /* 4 BLOCKS LOOP         @Z40LB25*/
@RF00556 LA    I,1                                                 0558
@DL00558 DS    0H                                                  0559
*     DO II=1 TO LENGTH(WRKCUBE);   /* 1 BLOCK LOOP          @Z40LB25*/
         LA    II,1                                                0559
@DL00559 DS    0H                                                  0560
*       WRKCUBE(I,II)=WRKCUBE(I,II)&&FLIPBITS;/*             @Z40LB25
*                                      REVERSE BITS          @Z40LB25*/
         LR    @05,I                                               0560
         MH    @05,@CH01230                                        0560
         ALR   @05,II                                              0560
         L     @02,WRKMAPTR                                        0560
         ALR   @02,@05                                             0560
         AL    @02,@CF01670                                        0560
         XI    WRKCUBE-8(@02),X'FF'                                0560
*     END;                          /*                       @Z40LB25*/
         AL    II,@CF00224                                         0561
         C     II,@CF01398                                         0561
         BNH   @DL00559                                            0561
*   END;                            /*                       @Z40LB25*/
*                                                                  0562
         AL    I,@CF00224                                          0562
         C     I,@CF00047                                          0562
         BNH   @DL00558                                            0562
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE FULL CELL BITS ON FOR THE FULL                @Z40LB25*/
*   /* PARAMETER OF CHECK AND READLABEL WITH XRANGE.         @Z40LB25*/
*   /* ON BITS REPRESENT FULL CELLS.                         @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0563
*   DO I=1 TO BLKNUM;               /*                       @Z40LB25*/
         LA    I,1                                                 0563
@DL00563 DS    0H                                                  0564
*     WRKCUBE(I)=WRKCUBE(I)&ORIGCUBE(I);/*                   @Z40LB25*/
         LR    @05,I                                               0564
         MH    @05,@CH01230                                        0564
         L     @01,WRKMAPTR                                        0564
         ALR   @01,@05                                             0564
         AL    @01,@CF01672                                        0564
         L     @15,@PC00001+8                                      0564
         L     @15,BLKPTR(,@15)                                    0564
         ALR   @15,@05                                             0564
         NC    WRKCUBE-8(256,@01),ORIGCUBE-264(@15)                0564
*   END;                            /*                       @Z40LB25*/
         AL    I,@CF00224                                          0565
         C     I,@CF00047                                          0565
         BNH   @DL00563                                            0565
*   RETURN;                         /*                       @Z40LB25*/
         B     @EL00002                                            0566
*   END INITMAP;                    /*                       @Z40LB25*/
         B     @EL00002                                            0567
*                                                                  0568
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - LIMITS                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - SET ANY ON BITS IN THE WORKMAP WHICH       @Z40LB25*/
*   /* ARE OUTSIDE OF THE PHYSICAL MSF SIZE OFF.             @Z40LB25*/
*   /* CALLS PROCXRNG TO PROCESS A REQUEST INVOLVING         @Z40LB25*/
*   /* X RANGE(S) OR CALLS PROCCELL TO PROCESS A             @Z40LB25*/
*   /* REQUEST INVOLVING CELL(S).                            @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /* XYZ1                                                  @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /* LIMITSRC                                              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0568
*LIMITS:                                                           0568
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
LIMITS   ST    @14,@SA00003                                        0568
*   LIMITSRC=LASTCC00;              /* ZERO RETURN CODE      @Z40LB25*/
         SLR   @15,@15                                             0569
         STH   @15,LIMITSRC                                        0569
*   TERMINAT=ON;                    /* ASSUME NO VALID RANGE @Z40LB25
*                                      OR CELL               @Z40LB25*/
*                                                                  0570
         OI    TERMINAT,B'00100000'                                0570
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A USER SPECIFIED CELL(S)                    @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0571
*   IF ADDR(CELL)^=NULLPTR THEN                                    0571
*                                                                  0571
         L     @14,@PC00001+4                                      0571
         C     @15,FDTPTR+40(,@14)                                 0571
         BE    @RF00571                                            0571
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS THE INPUT CELL(S)                           @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0572
*     CALL PROCCELL;                /*                       @Z40LB25*/
*                                                                  0572
         BAL   @14,PROCCELL                                        0572
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A USER SPECIFIED XRANGE(S)                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   IF ADDR(XRNG)^=NULLPTR THEN                                    0573
@RF00571 L     @15,@PC00001+4                                      0573
         L     @15,FDTPTR+28(,@15)                                 0573
         LTR   @15,@15                                             0573
         BZ    @RF00573                                            0573
*     DO;                           /*                       @Z40LB25*/
*                                                                  0574
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO THE PORTION OF WORKMAP WHICH IS NOT APPLICABLE       */
*       /*                                                   @Z40LB25*/
*       /* TO THIS SIZE MSF.                                 @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0575
*       CELLPTR=ADDR(WRKBLK(1));    /* CELL BLOCK PTR        @Z40LB25*/
         L     @01,WRKMAPTR                                        0575
         ST    @01,CELLPTR                                         0575
*       X=XSTART;                   /* 150                   @Z40LB25*/
*                                                                  0576
         MVC   X(2),@CH01256                                       0576
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN THE FIRST THREE BLOCKS ONLY, BECAUSE MUST HAVE       */
*       /*                                                   @Z40LB25*/
*       /* AT LEAST X RANGE 234 TO 247 WHICH INCLUDES THE    @Z40LB25*/
*       /* ENTIRE LAST BLOCK (MODEL 1)                       @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0577
*       DO BLKINDEX=1 TO BLKNUM-1 WHILE LIMITLOX=OFF;/*      @Z40LB25*/
         LA    BLKINDEX,1                                          0577
@DL00577 TM    LIMITLOX,B'00100000'                                0577
         BNZ   @DC00577                                            0577
*         CHUNKPTR=ADDR(WRKCUBE(BLKINDEX));/*                @Z40LB25*/
*                                                                  0578
         LR    @06,BLKINDEX                                        0578
         MH    @06,@CH01230                                        0578
         L     @01,WRKMAPTR                                        0578
         AL    @01,@CF01672                                        0578
         LA    @06,WRKCUBE-8(@06,@01)                              0578
         ST    @06,CHUNKPTR                                        0578
*         /***********************************************************/
*         /*                                                         */
*         /* BLOCKS 1 - 3                                    @Z40LB25*/
*         /* SCAN THE CHUNKS OF EACH OF THE BLOCKS           @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0579
*         DO CHKINDEX=1 TO CHUNKNUM WHILE LIMITLOX=OFF;/*    @Z40LB25*/
         LA    @06,1                                               0579
         STH   @06,CHKINDEX                                        0579
@DL00579 TM    LIMITLOX,B'00100000'                                0579
         BNZ   @DC00579                                            0579
*           CUBEPTR=CHUNKPTR;       /*                       @Z40LB25*/
         L     CUBEPTR,CHUNKPTR                                    0580
*           IF X=>MSFLOWX-XSTART THEN                              0581
         L     @06,MSFLOWX                                         0581
         SL    @06,@CF01256                                        0581
         CH    @06,X                                               0581
         BH    @RF00581                                            0581
*             LIMITLOX=ON;          /*                       @Z40LB25*/
*                                                                  0582
         OI    LIMITLOX,B'00100000'                                0582
*           /*********************************************************/
*           /*                                                       */
*           /* SCAN THE CUBES PER CHUNK                      @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0583
*           DO CUBINDEX=1 TO CUBENUM WHILE LIMITLOX=OFF;/*   @Z40LB25*/
*                                                                  0583
@RF00581 LA    @06,1                                               0583
         STH   @06,CUBINDEX                                        0583
@DL00583 TM    LIMITLOX,B'00100000'                                0583
         BNZ   @DC00583                                            0583
*             /*******************************************************/
*             /*                                                     */
*             /* SCAN EACH BIT PER BYTE                      @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0584
*             DO BYTINDEX=1 TO BYTENUM WHILE LIMITLOX=OFF;/* @Z40LB25*/
         LA    BYTINDEX,1                                          0584
@DL00584 TM    LIMITLOX,B'00100000'                                0584
         BNZ   @DC00584                                            0584
*               TEMPX=''B;          /*                       @Z40LB25*/
         SLR   TEMPX,TEMPX                                         0585
*               IF X+TEMPX<MSFLOWX THEN/*                    @Z40LB25*/
         LR    @06,TEMPX                                           0586
         AH    @06,X                                               0586
         C     @06,MSFLOWX                                         0586
         BNL   @RF00586                                            0586
*                 DO;               /*                       @Z40LB25*/
*                   X0Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/
*                   X0Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/
         LR    @06,CUBEPTR                                         0589
         ALR   @06,BYTINDEX                                        0589
         AL    @06,@CF01674                                        0589
         NI    X0Z0(@06),B'00111111'                               0589
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/
         AL    TEMPX,@CF00224                                      0590
*                 END;              /*                       @Z40LB25*/
*               ELSE                                               0592
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/
         B     @RC00586                                            0592
@RF00586 AL    TEMPX,@CF00224                                      0592
*               IF X+TEMPX<MSFLOWX THEN                            0593
@RC00586 LR    @06,TEMPX                                           0593
         AH    @06,X                                               0593
         C     @06,MSFLOWX                                         0593
         BNL   @RF00593                                            0593
*                 DO;               /*                       @Z40LB25*/
*                   X1Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/
*                   X1Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/
         LR    @06,CUBEPTR                                         0596
         ALR   @06,BYTINDEX                                        0596
         AL    @06,@CF01674                                        0596
         NI    X1Z0(@06),B'11001111'                               0596
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/
         AL    TEMPX,@CF00224                                      0597
*                 END;              /*                       @Z40LB25*/
*               ELSE                                               0599
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/
         B     @RC00593                                            0599
@RF00593 AL    TEMPX,@CF00224                                      0599
*               IF X+TEMPX<MSFLOWX THEN                            0600
@RC00593 LR    @06,TEMPX                                           0600
         AH    @06,X                                               0600
         C     @06,MSFLOWX                                         0600
         BNL   @RF00600                                            0600
*                 DO;               /*                       @Z40LB25*/
*                   X2Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/
*                   X2Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/
         LR    @06,CUBEPTR                                         0603
         ALR   @06,BYTINDEX                                        0603
         AL    @06,@CF01674                                        0603
         NI    X2Z0(@06),B'11110011'                               0603
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/
         AL    TEMPX,@CF00224                                      0604
*                 END;              /*                       @Z40LB25*/
*               ELSE                                               0606
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/
         B     @RC00600                                            0606
@RF00600 AL    TEMPX,@CF00224                                      0606
*               IF X+TEMPX<MSFLOWX THEN                            0607
@RC00600 LR    @06,TEMPX                                           0607
         AH    @06,X                                               0607
         C     @06,MSFLOWX                                         0607
         BNL   @RF00607                                            0607
*                 DO;               /*                       @Z40LB25*/
*                   X3Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/
*                   X3Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/
         LR    @06,CUBEPTR                                         0610
         ALR   @06,BYTINDEX                                        0610
         AL    @06,@CF01674                                        0610
         NI    X3Z0(@06),B'11111100'                               0610
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/
         AL    TEMPX,@CF00224                                      0611
*                 END;              /*                       @Z40LB25*/
*               ELSE                                               0613
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/
         B     @RC00607                                            0613
@RF00607 AL    TEMPX,@CF00224                                      0613
*             END;                  /*                       @Z40LB25*/
@RC00607 AL    BYTINDEX,@CF00224                                   0614
         C     BYTINDEX,@CF00047                                   0614
         BNH   @DL00584                                            0614
@DC00584 DS    0H                                                  0615
*             CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                @Z40LB25*/
         AL    CUBEPTR,@CF00047                                    0615
*           END;                    /*                       @Z40LB25*/
         LA    @06,1                                               0616
         AH    @06,CUBINDEX                                        0616
         STH   @06,CUBINDEX                                        0616
         C     @06,@CF00663                                        0616
         BNH   @DL00583                                            0616
@DC00583 DS    0H                                                  0617
*           CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*               @Z40LB25*/
         LA    @06,32                                              0617
         AL    @06,CHUNKPTR                                        0617
         ST    @06,CHUNKPTR                                        0617
*           X=X+4;                  /*                       @Z40LB25*/
         LA    @06,4                                               0618
         AH    @06,X                                               0618
         STH   @06,X                                               0618
*         END;                      /*                       @Z40LB25*/
         LA    @06,1                                               0619
         AH    @06,CHKINDEX                                        0619
         STH   @06,CHKINDEX                                        0619
         C     @06,@CF00184                                        0619
         BNH   @DL00579                                            0619
@DC00579 DS    0H                                                  0620
*         CELLPTR=CELLPTR+BLKSIZE;  /*                       @Z40LB25*/
         LA    @06,264                                             0620
         AL    @06,CELLPTR                                         0620
         ST    @06,CELLPTR                                         0620
*       END;                        /*                       @Z40LB25*/
*                                                                  0621
         AL    BLKINDEX,@CF00224                                   0621
         C     BLKINDEX,@CF00167                                   0621
         BNH   @DL00577                                            0621
@DC00577 DS    0H                                                  0622
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS THE INPUT X RANGE(S)                      @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0622
*       CALL PROCXRNG;              /*                       @Z40LB25*/
         BAL   @14,PROCXRNG                                        0622
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00003 DS    0H                                                  0624
@EF00003 DS    0H                                                  0624
@ER00003 L     @14,@SA00003                                        0624
         BR    @14                                                 0624
*   END LIMITS;                     /*                       @Z40LB25*/
         B     @EL00003                                            0625
*                                                                  0626
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCXRNG                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - INTERROGATE THE USER SPECIFIED XRANGE(S).  @Z40LB25*/
*   /* IF ALL OR ANY OF THEM ARE INVALID (NOT WITHIN         @Z40LB25*/
*   /* THE MSF) PRINT THE APPROPRIATE MESSAGE AND IF         @Z40LB25*/
*   /* NECESSARY TERMINATE THE REQUEST. SET THE              @Z40LB25*/
*   /* CORRESPONDING BIT(S) IN WORKMAP ON FOR THE USERS      @Z40LB25*/
*   /* REQUESTED XRANGE(S).                                  @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /* LIMITSRC                                              @Z40LB25*/
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/
*   /* IDC21144I - STID 6                                    @Z40LB25*/
*   /* IDC21142I - STID 8                                    @Z40LB25*/
*   /* IDC21141I - STID 10                                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*PROCXRNG:                                                         0626
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
PROCXRNG ST    @14,@SA00004                                        0626
*   DO I=1 TO XRNGCNT;              /*                       @Z40LB25*/
*                                                                  0627
         LA    I,1                                                 0627
         B     @DE00627                                            0627
@DL00627 DS    0H                                                  0628
*     /***************************************************************/
*     /*                                                             */
*     /* GET THE RANGES                                      @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0628
*     VALLOWX=LOWXPTR(I)->LOWXVAL;  /* SAVE LOW X            @Z40LB25*/
*                                                                  0628
         LR    @05,I                                               0628
         SLA   @05,2                                               0628
         L     @15,@PC00001+4                                      0628
         L     @01,FDTPTR+32(,@15)                                 0628
         AL    @01,@CF01675                                        0628
         L     @01,LOWXPTR(@05,@01)                                0628
         L     @14,LOWXVAL(,@01)                                   0628
         STH   @14,VALLOWX                                         0628
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR NO HIGH X SPECIFIED                       @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0629
*     IF HIGHXPTR(I)=NULLPTR THEN   /* ANY HI X?             @Z40LB25*/
         L     @01,FDTPTR+36(,@15)                                 0629
         AL    @01,@CF01675                                        0629
         L     @05,HIGHXPTR(@05,@01)                               0629
         LTR   @05,@05                                             0629
         BNZ   @RF00629                                            0629
*       VALHIGHX=VALLOWX;           /* SINGLE X RANGE        @Z40LB25*/
         STH   @14,VALHIGHX                                        0630
*     ELSE                          /* GET HIGH X            @Z40LB25*/
*       VALHIGHX=HIGHXPTR(I)->HIGHXVAL;/*                    @Z40LB25*/
*                                                                  0631
         B     @RC00629                                            0631
@RF00629 LR    @05,I                                               0631
         SLA   @05,2                                               0631
         L     @15,@PC00001+4                                      0631
         L     @01,FDTPTR+36(,@15)                                 0631
         AL    @01,@CF01675                                        0631
         L     @05,HIGHXPTR(@05,@01)                               0631
         L     @05,HIGHXVAL(,@05)                                  0631
         STH   @05,VALHIGHX                                        0631
*     /***************************************************************/
*     /*                                                             */
*     /* INSURE LOWX AND HIGHX OF RANGE IS WITHIN THE MSF    @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0632
*     IF VALLOWX<MSFLOWX&VALHIGHX<MSFLOWX THEN                     0632
@RC00629 L     @05,MSFLOWX                                         0632
         CH    @05,VALLOWX                                         0632
         BNH   @RF00632                                            0632
         CH    @05,VALHIGHX                                        0632
         BNH   @RF00632                                            0632
*       DO;                         /*                       @Z40LB25*/
*                                                                  0633
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MESSAGE IDC21141I                         @Z40LB25*/
*         /* INDICATE THE XRANGE NOT PROCESSED               @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0634
*         PRINTAB=''B;              /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0634
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/
         L     @05,DDSTRU                                          0635
         MVC   DARGSMOD(3,@05),@CC01440                            0635
*         DARGSENT=MG21141R;        /*                       @Z40LB25*/
         MVI   DARGSENT(@05),X'0A'                                 0636
*         DARGCNT=3;                /*                       @Z40LB25*/
         LA    @15,3                                               0637
         STH   @15,DARGCNT(,@05)                                   0637
*         DARGINS(1)=1;             /*                       @Z40LB25*/
         MVC   DARGINS(2,@05),@CH00224                             0638
*         DARGINL(1)=LENGTH(VALLOWX);/*                      @Z40LB25*/
         LA    @14,2                                               0639
         STH   @14,DARGINL(,@05)                                   0639
*         DARGDTM(1)=ADDR(VALLOWX); /*                       @Z40LB25*/
         LA    @07,VALLOWX                                         0640
         ST    @07,DARGDTM(,@05)                                   0640
*         DARGINS(2)=2;             /*                       @Z40LB25*/
         STH   @14,DARGINS+8(,@05)                                 0641
*         DARGINL(2)=LENGTH(VALHIGHX);/*                     @Z40LB25*/
         STH   @14,DARGINL+8(,@05)                                 0642
*         DARGDTM(2)=ADDR(VALHIGHX);/*                       @Z40LB25*/
         LA    @14,VALHIGHX                                        0643
         ST    @14,DARGDTM+8(,@05)                                 0643
*         DARGINS(3)=3;             /*                       @Z40LB25*/
         STH   @15,DARGINS+16(,@05)                                0644
*         DARGINL(3)=LENGTH(MSFVAL);/*                       @Z40LB25*/
         MVC   DARGINL+16(2,@05),@CH00047                          0645
*         DARGDTM(3)=ADDR(MSFVAL);  /*                       @Z40LB25*/
         L     @15,@PC00001+4                                      0646
         L     @15,FDTPTR+24(,@15)                                 0646
         ST    @15,DARGDTM+16(,@05)                                0646
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/
         L     @05,@PC00001                                        0647
         ST    @05,@AL00001                                        0647
         LA    @15,@CF00120                                        0647
         ST    @15,@AL00001+4                                      0647
         LA    @15,DDSTRU                                          0647
         ST    @15,@AL00001+8                                      0647
         MVI   @AL00001+8,X'80'                                    0647
         L     @15,GDTPRT(,@05)                                    0647
         LA    @01,@AL00001                                        0647
         BALR  @14,@15                                             0647
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/
         MVC   LIMITSRC(2),@CH00184                                0648
*       END;                        /*                       @Z40LB25*/
*                                                                  0649
*     /***************************************************************/
*     /*                                                             */
*     /* INSURE LOWX IS LESS THAN HIGHX                      @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0650
*     IF VALLOWX>VALHIGHX THEN                                     0650
@RF00632 LH    @05,VALLOWX                                         0650
         CH    @05,VALHIGHX                                        0650
         BNH   @RF00650                                            0650
*       DO;                         /*                       @Z40LB25*/
*                                                                  0651
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MESSAGE IDC21144I                         @Z40LB25*/
*         /* INPUT LOW X IS GREATER THAN THE INPUT HIGH X    @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0652
*         PRINTAB=''B;              /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0652
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/
         L     @05,DDSTRU                                          0653
         MVC   DARGSMOD(3,@05),@CC01440                            0653
*         DARGSENT=MG21144R;        /*                       @Z40LB25*/
         MVI   DARGSENT(@05),X'06'                                 0654
*         DARGCNT=2;                /*                       @Z40LB25*/
         LA    @15,2                                               0655
         STH   @15,DARGCNT(,@05)                                   0655
*         DARGINS(1)=1;             /*                       @Z40LB25*/
         MVC   DARGINS(2,@05),@CH00224                             0656
*         DARGINL(1)=LENGTH(VALLOWX);/*                      @Z40LB25*/
         STH   @15,DARGINL(,@05)                                   0657
*         DARGDTM(1)=ADDR(VALLOWX); /*                       @Z40LB25*/
         LA    @14,VALLOWX                                         0658
         ST    @14,DARGDTM(,@05)                                   0658
*         DARGINS(2)=2;             /*                       @Z40LB25*/
         STH   @15,DARGINS+8(,@05)                                 0659
*         DARGINL(2)=LENGTH(VALHIGHX);/*                     @Z40LB25*/
         STH   @15,DARGINL+8(,@05)                                 0660
*         DARGDTM(2)=ADDR(VALHIGHX);/*                       @Z40LB25*/
         LA    @15,VALHIGHX                                        0661
         ST    @15,DARGDTM+8(,@05)                                 0661
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/
         L     @05,@PC00001                                        0662
         ST    @05,@AL00001                                        0662
         LA    @15,@CF00120                                        0662
         ST    @15,@AL00001+4                                      0662
         LA    @15,DDSTRU                                          0662
         ST    @15,@AL00001+8                                      0662
         MVI   @AL00001+8,X'80'                                    0662
         L     @15,GDTPRT(,@05)                                    0662
         LA    @01,@AL00001                                        0662
         BALR  @14,@15                                             0662
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/
         MVC   LIMITSRC(2),@CH00184                                0663
*       END;                        /*                       @Z40LB25*/
*                                                                  0664
*     /***************************************************************/
*     /*                                                             */
*     /* INSURE LOWX IS NOT LESS THAN THE LOWX ALLOWED       @Z40LB25*/
*     /* FOR THIS MSF IF A HIGHX WAS SPECIFIED               @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0665
*     IF VALLOWX<MSFLOWX&VALLOWX^=VALHIGHX&VALHIGHX>=MSFLOWX THEN  0665
@RF00650 LH    @05,VALLOWX                                         0665
         L     @15,MSFLOWX                                         0665
         CR    @05,@15                                             0665
         BNL   @RF00665                                            0665
         LH    @14,VALHIGHX                                        0665
         CR    @05,@14                                             0665
         BE    @RF00665                                            0665
         CR    @14,@15                                             0665
         BL    @RF00665                                            0665
*       DO;                         /*                       @Z40LB25*/
*                                                                  0666
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MESSAGE IDC21141I                         @Z40LB25*/
*         /* X RANGE BETWEEN THE INPUT LOW X AND THE MSF LOW @Z40LB25*/
*         /* IS NOT PROCESSED                                @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0667
*         PRINTAB=''B;              /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0667
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/
         L     @05,DDSTRU                                          0668
         MVC   DARGSMOD(3,@05),@CC01440                            0668
*         DARGSENT=MG21141R;        /*                       @Z40LB25*/
         MVI   DARGSENT(@05),X'0A'                                 0669
*         DARGCNT=3;                /*                       @Z40LB25*/
         LA    @14,3                                               0670
         STH   @14,DARGCNT(,@05)                                   0670
*         DARGINS(1)=1;             /*                       @Z40LB25*/
         MVC   DARGINS(2,@05),@CH00224                             0671
*         DARGINL(1)=LENGTH(VALLOWX);/*                      @Z40LB25*/
         LA    @07,2                                               0672
         STH   @07,DARGINL(,@05)                                   0672
*         DARGDTM(1)=ADDR(VALLOWX); /*                       @Z40LB25*/
         LA    @06,VALLOWX                                         0673
         ST    @06,DARGDTM(,@05)                                   0673
*         DARGINS(2)=2;             /*                       @Z40LB25*/
         STH   @07,DARGINS+8(,@05)                                 0674
*         HIBADX=MSFLOWX-1;         /*                       @Z40LB25*/
         BCTR  @15,0                                               0675
         ST    @15,HIBADX                                          0675
*         DARGINL(2)=LENGTH(HIBADX);/*                       @Z40LB25*/
         LA    @15,4                                               0676
         STH   @15,DARGINL+8(,@05)                                 0676
*         DARGDTM(2)=ADDR(HIBADX);  /*                       @Z40LB25*/
         LA    @07,HIBADX                                          0677
         ST    @07,DARGDTM+8(,@05)                                 0677
*         DARGINS(3)=3;             /*                       @Z40LB25*/
         STH   @14,DARGINS+16(,@05)                                0678
*         DARGINL(3)=LENGTH(MSFVAL);/*                       @Z40LB25*/
         STH   @15,DARGINL+16(,@05)                                0679
*         DARGDTM(3)=ADDR(MSFVAL);  /*                       @Z40LB25*/
         L     @15,@PC00001+4                                      0680
         L     @15,FDTPTR+24(,@15)                                 0680
         ST    @15,DARGDTM+16(,@05)                                0680
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/
         L     @05,@PC00001                                        0681
         ST    @05,@AL00001                                        0681
         LA    @15,@CF00120                                        0681
         ST    @15,@AL00001+4                                      0681
         LA    @15,DDSTRU                                          0681
         ST    @15,@AL00001+8                                      0681
         MVI   @AL00001+8,X'80'                                    0681
         L     @15,GDTPRT(,@05)                                    0681
         LA    @01,@AL00001                                        0681
         BALR  @14,@15                                             0681
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/
         MVC   LIMITSRC(2),@CH00184                                0682
*         VALLOWX=MSFLOWX;          /* RESET INPUT LOW X     @Z40LB25*/
         L     @05,MSFLOWX                                         0683
         STH   @05,VALLOWX                                         0683
*       END;                        /*                       @Z40LB25*/
*                                                                  0684
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF AN X RANGE IS TO BE PROCESSED              @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0685
*     IF(VALLOWX=<VALHIGHX)&((VALLOWX=>MSFLOWX)&(VALHIGHX=>MSFLOWX))
*       THEN                                                       0685
@RF00665 LH    @05,VALLOWX                                         0685
         LH    @15,VALHIGHX                                        0685
         CR    @05,@15                                             0685
         BH    @RF00685                                            0685
         L     @14,MSFLOWX                                         0685
         CR    @05,@14                                             0685
         BL    @RF00685                                            0685
         CR    @15,@14                                             0685
         BL    @RF00685                                            0685
*       DO;                         /*                       @Z40LB25*/
*         PROCHIX=OFF;              /*                       @Z40LB25*/
         NI    PROCHIX,B'11101111'                                 0687
*         TERMINAT=OFF;             /* DON'T PRINT IDC21142I @Z40LB25*/
         NI    TERMINAT,B'11011111'                                0688
*         X=XSTART;                 /* 1ST X (150)           @Z40LB25*/
         MVC   X(2),@CH01256                                       0689
*         CELLPTR=ADDR(XYZ1BLK(1)); /* CELL BLOCK PTR        @Z40LB25*/
*                                                                  0690
         L     @05,XYZ1PTR                                         0690
         ST    @05,CELLPTR                                         0690
*         /***********************************************************/
*         /*                                                         */
*         /* SET BITS IN XYZ1 ON WHICH ARE WITH              @Z40LB25*/
*         /* IN THE X RANGE                                  @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0691
*         DO BLKINDEX=1 TO BLKNUM WHILE PROCHIX=OFF;/*       @Z40LB25*/
         LA    BLKINDEX,1                                          0691
@DL00691 TM    PROCHIX,B'00010000'                                 0691
         BNZ   @DC00691                                            0691
*           CHUNKPTR=ADDR(XYZ1CUBE(BLKINDEX));/*             @Z40LB25*/
*                                                                  0692
         LR    @06,BLKINDEX                                        0692
         MH    @06,@CH01230                                        0692
         L     @05,XYZ1PTR                                         0692
         AL    @05,@CF01672                                        0692
         LA    @06,XYZ1CUBE-8(@06,@05)                             0692
         ST    @06,CHUNKPTR                                        0692
*           /*********************************************************/
*           /*                                                       */
*           /* BLOCKS 1 - 4                                  @Z40LB25*/
*           /* SCAN THE CHUNKS OF EACH OF THE BLOCKS         @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0693
*           DO CHKINDEX=1 TO CHUNKNUM WHILE PROCHIX=OFF;/*   @Z40LB25*/
         LA    @06,1                                               0693
         STH   @06,CHKINDEX                                        0693
@DL00693 TM    PROCHIX,B'00010000'                                 0693
         BNZ   @DC00693                                            0693
*             CUBEPTR=CHUNKPTR;     /*                       @Z40LB25*/
         L     CUBEPTR,CHUNKPTR                                    0694
*             IF X>VALHIGHX THEN                                   0695
         LH    @06,X                                               0695
         CH    @06,VALHIGHX                                        0695
         BNH   @RF00695                                            0695
*               PROCHIX=ON;         /*                       @Z40LB25*/
*                                                                  0696
         OI    PROCHIX,B'00010000'                                 0696
*             /*******************************************************/
*             /*                                                     */
*             /* SCAN THE CUBES PER CHUNK                    @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0697
*             DO CUBINDEX=1 TO CUBENUM WHILE PROCHIX=OFF;/*  @Z40LB25*/
*                                                                  0697
@RF00695 LA    @06,1                                               0697
         STH   @06,CUBINDEX                                        0697
@DL00697 TM    PROCHIX,B'00010000'                                 0697
         BNZ   @DC00697                                            0697
*               /*****************************************************/
*               /*                                                   */
*               /* SCAN EACH BIT PER BYTE                    @Z40LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0698
*               DO BYTINDEX=1 TO BYTENUM WHILE PROCHIX=OFF;/*      0698
*                                                            @Z40LB25*/
         LA    BYTINDEX,1                                          0698
@DL00698 TM    PROCHIX,B'00010000'                                 0698
         BNZ   @DC00698                                            0698
*                 TEMPX=''B;        /*                       @Z40LB25*/
         SLR   TEMPX,TEMPX                                         0699
*                 IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN       0700
         LR    @06,TEMPX                                           0700
         AH    @06,X                                               0700
         CH    @06,VALLOWX                                         0700
         BL    @RF00700                                            0700
         CH    @06,VALHIGHX                                        0700
         BH    @RF00700                                            0700
*                   DO;             /*                       @Z40LB25*/
*                     X0Z0(BYTINDEX)=ON;/*                   @Z40LB25*/
*                     X0Z1(BYTINDEX)=ON;/*                   @Z40LB25*/
         LR    @06,CUBEPTR                                         0703
         ALR   @06,BYTINDEX                                        0703
         AL    @06,@CF01674                                        0703
         OI    X0Z0(@06),B'11000000'                               0703
*                     TEMPX=TEMPX+1;/*                       @Z40LB25*/
         AL    TEMPX,@CF00224                                      0704
*                   END;            /*                       @Z40LB25*/
*                 ELSE                                             0706
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/
         B     @RC00700                                            0706
@RF00700 AL    TEMPX,@CF00224                                      0706
*                 IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN       0707
@RC00700 LR    @06,TEMPX                                           0707
         AH    @06,X                                               0707
         CH    @06,VALLOWX                                         0707
         BL    @RF00707                                            0707
         CH    @06,VALHIGHX                                        0707
         BH    @RF00707                                            0707
*                   DO;             /*                       @Z40LB25*/
*                     X1Z0(BYTINDEX)=ON;/*                   @Z40LB25*/
*                     X1Z1(BYTINDEX)=ON;/*                   @Z40LB25*/
         LR    @06,CUBEPTR                                         0710
         ALR   @06,BYTINDEX                                        0710
         AL    @06,@CF01674                                        0710
         OI    X1Z0(@06),B'00110000'                               0710
*                     TEMPX=TEMPX+1;/*                       @Z40LB25*/
         AL    TEMPX,@CF00224                                      0711
*                   END;            /*                       @Z40LB25*/
*                 ELSE                                             0713
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/
*                                                                  0713
         B     @RC00707                                            0713
@RF00707 AL    TEMPX,@CF00224                                      0713
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK FOR THE LAST BLOCK                @Z40LB25*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0714
*                 IF BLKINDEX^=BLKNUM THEN/* LAST BLOCK      @Z40LB25*/
@RC00707 C     BLKINDEX,@CF00047                                   0714
         BE    @RF00714                                            0714
*                   DO;             /*                       @Z40LB25*/
*                     IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN   0716
         LR    @06,TEMPX                                           0716
         AH    @06,X                                               0716
         CH    @06,VALLOWX                                         0716
         BL    @RF00716                                            0716
         CH    @06,VALHIGHX                                        0716
         BH    @RF00716                                            0716
*                       DO;         /*                       @Z40LB25*/
*                         X2Z0(BYTINDEX)=ON;/*               @Z40LB25*/
*                         X2Z1(BYTINDEX)=ON;/*               @Z40LB25*/
         LR    @06,CUBEPTR                                         0719
         ALR   @06,BYTINDEX                                        0719
         AL    @06,@CF01674                                        0719
         OI    X2Z0(@06),B'00001100'                               0719
*                         TEMPX=TEMPX+1;/*                   @Z40LB25*/
         AL    TEMPX,@CF00224                                      0720
*                       END;        /*                       @Z40LB25*/
*                     ELSE                                         0722
*                       TEMPX=TEMPX+1;/*                     @Z40LB25*/
         B     @RC00716                                            0722
@RF00716 AL    TEMPX,@CF00224                                      0722
*                     IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN   0723
@RC00716 LR    @06,TEMPX                                           0723
         AH    @06,X                                               0723
         CH    @06,VALLOWX                                         0723
         BL    @RF00723                                            0723
         CH    @06,VALHIGHX                                        0723
         BH    @RF00723                                            0723
*                       DO;         /*                       @Z40LB25*/
*                         X3Z0(BYTINDEX)=ON;/*               @Z40LB25*/
*                         X3Z1(BYTINDEX)=ON;/*               @Z40LB25*/
         LR    @06,CUBEPTR                                         0726
         ALR   @06,BYTINDEX                                        0726
         AL    @06,@CF01674                                        0726
         OI    X3Z0(@06),B'00000011'                               0726
*                         TEMPX=TEMPX+1;/*                   @Z40LB25*/
         AL    TEMPX,@CF00224                                      0727
*                       END;        /*                       @Z40LB25*/
*                   END;            /*                       @Z40LB25*/
@RF00723 DS    0H                                                  0730
*               END;                /*                       @Z40LB25*/
@RF00714 AL    BYTINDEX,@CF00224                                   0730
         C     BYTINDEX,@CF00047                                   0730
         BNH   @DL00698                                            0730
@DC00698 DS    0H                                                  0731
*               CUBEPTR=CUBEPTR+LENGTH(CUBE);/*              @Z40LB25*/
         AL    CUBEPTR,@CF00047                                    0731
*             END;                  /*                       @Z40LB25*/
*                                                                  0732
         LA    @06,1                                               0732
         AH    @06,CUBINDEX                                        0732
         STH   @06,CUBINDEX                                        0732
         C     @06,@CF00663                                        0732
         BNH   @DL00697                                            0732
@DC00697 DS    0H                                                  0733
*             /*******************************************************/
*             /*                                                     */
*             /* IF AT THE LAST BLOCK, IT WILL CONTAIN       @Z40LB25*/
*             /* ONLY ONE CHUNK                              @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0733
*             IF BLKINDEX=BLKNUM THEN                              0733
         C     BLKINDEX,@CF00047                                   0733
         BNE   @RF00733                                            0733
*               CHKINDEX=CHUNKNUM;  /*                       @Z40LB25*/
         MVC   CHKINDEX(2),@CH00184                                0734
*             CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*             @Z40LB25*/
@RF00733 LA    @06,32                                              0735
         AL    @06,CHUNKPTR                                        0735
         ST    @06,CHUNKPTR                                        0735
*             X=X+4;                /*                       @Z40LB25*/
         LA    @06,4                                               0736
         AH    @06,X                                               0736
         STH   @06,X                                               0736
*           END;                    /*                       @Z40LB25*/
         LA    @06,1                                               0737
         AH    @06,CHKINDEX                                        0737
         STH   @06,CHKINDEX                                        0737
         C     @06,@CF00184                                        0737
         BNH   @DL00693                                            0737
@DC00693 DS    0H                                                  0738
*           CELLPTR=CELLPTR+BLKSIZE;/*                       @Z40LB25*/
         LA    @06,264                                             0738
         AL    @06,CELLPTR                                         0738
         ST    @06,CELLPTR                                         0738
*         END;                      /*                       @Z40LB25*/
         AL    BLKINDEX,@CF00224                                   0739
         C     BLKINDEX,@CF00047                                   0739
         BNH   @DL00691                                            0739
@DC00691 DS    0H                                                  0740
*       END;                        /*                       @Z40LB25*/
*   END;                            /*                       @Z40LB25*/
*                                                                  0741
@RF00685 AL    I,@CF00224                                          0741
@DE00627 L     @05,@PC00001+4                                      0741
         LA    @05,FDTPTR+28(,@05)                                 0741
         C     I,XRNGCNT(,@05)                                     0741
         BNH   @DL00627                                            0741
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO ALL AREAS OUTSIDE OF THE X RANGE(S)              @Z40LB25*/
*   /* IN WORKMAP                                            @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0742
*   IF TERMINAT=OFF THEN                                           0742
         TM    TERMINAT,B'00100000'                                0742
         BNZ   @RF00742                                            0742
*     DO I=1 TO BLKNUM;             /*                       @Z40LB25*/
         LA    I,1                                                 0743
@DL00743 DS    0H                                                  0744
*       DO II=1 TO LENGTH(WRKCUBE); /*                       @Z40LB25*/
         LA    II,1                                                0744
@DL00744 DS    0H                                                  0745
*         WRKCUBE(I,II)=WRKCUBE(I,II)&XYZ1CUBE(I,II);/*      @Z40LB25*/
         LR    @05,I                                               0745
         MH    @05,@CH01230                                        0745
         ALR   @05,II                                              0745
         L     @02,WRKMAPTR                                        0745
         ALR   @02,@05                                             0745
         AL    @02,@CF01670                                        0745
         L     @01,XYZ1PTR                                         0745
         ALR   @01,@05                                             0745
         AL    @01,@CF01670                                        0745
         NC    WRKCUBE-8(1,@02),XYZ1CUBE-8(@01)                    0745
*       END;                        /*                       @Z40LB25*/
         AL    II,@CF00224                                         0746
         C     II,@CF01398                                         0746
         BNH   @DL00744                                            0746
*     END;                          /*                       @Z40LB25*/
         AL    I,@CF00224                                          0747
         C     I,@CF00047                                          0747
         BNH   @DL00743                                            0747
*   ELSE                                                           0748
*                                                                  0748
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE MSG IDC31142I                                 @Z40LB25*/
*     /* NO VALID XRANGES SPECIFIED                          @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0748
*     DO;                           /*                       @Z40LB25*/
         B     @RC00742                                            0748
@RF00742 DS    0H                                                  0749
*       LIMITSRC=LASTCC12;          /*                       @Z40LB25*/
         MVC   LIMITSRC(2),@CH00571                                0749
*       PRINTAB=''B;                /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0750
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/
         L     @15,DDSTRU                                          0751
         MVC   DARGSMOD(3,@15),@CC01440                            0751
*       DARGSENT=MG21142R;          /*                       @Z40LB25*/
         MVI   DARGSENT(@15),X'08'                                 0752
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/
         L     @15,@PC00001                                        0753
         ST    @15,@AL00001                                        0753
         LA    @14,@CF00120                                        0753
         ST    @14,@AL00001+4                                      0753
         LA    @14,DDSTRU                                          0753
         ST    @14,@AL00001+8                                      0753
         MVI   @AL00001+8,X'80'                                    0753
         L     @15,GDTPRT(,@15)                                    0753
         LA    @01,@AL00001                                        0753
         BALR  @14,@15                                             0753
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00004 DS    0H                                                  0755
@EF00004 DS    0H                                                  0755
@ER00004 L     @14,@SA00004                                        0755
         BR    @14                                                 0755
*   END PROCXRNG;                   /*                       @Z40LB25*/
         B     @EL00004                                            0756
*                                                                  0757
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCCELL                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - INTERROGATE THE USER SPECIFIED CELL(S)     @Z40LB25*/
*   /* IF ALL OR ANY OF THEM ARE INVALID (NOT WITHIN         @Z40LB25*/
*   /* THE MSF) PRINT THE APPROPRIATE MESSAGE AND IF         @Z40LB25*/
*   /* NECESSARY TERMINATE THE REQUEST. SET THE              @Z40LB25*/
*   /* CORRESPONDING BIT(S) IN WORKMAP ON FOR THE USERS      @Z40LB25*/
*   /* REQUESTED CELL(S).                                    @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /* LIMITSRC                                              @Z40LB25*/
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/
*   /* IDC21142I - STID 7                                    @Z40LB25*/
*   /* IDC21141I - STID 9                                    @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0757
*PROCCELL:                                                         0757
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  0757
PROCCELL ST    @14,@SA00005                                        0757
*   /*****************************************************************/
*   /*                                                               */
*   /* FLIP THE BITS IN WORKMAP                              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0758
*   DO I=1 TO BLKNUM;               /* 4 BLOCKS LOOP         @Z40LB25*/
         LA    I,1                                                 0758
@DL00758 DS    0H                                                  0759
*     DO II=1 TO LENGTH(WRKCUBE);   /* 1 BLOCK LOOP          @Z40LB25*/
         LA    II,1                                                0759
@DL00759 DS    0H                                                  0760
*       WRKCUBE(I,II)=WRKCUBE(I,II)&&FLIPBITS;/*             @Z40LB25
*                                      REVERSE BITS          @Z40LB25*/
         LR    @05,I                                               0760
         MH    @05,@CH01230                                        0760
         ALR   @05,II                                              0760
         L     @02,WRKMAPTR                                        0760
         ALR   @02,@05                                             0760
         AL    @02,@CF01670                                        0760
         XI    WRKCUBE-8(@02),X'FF'                                0760
*     END;                          /*                       @Z40LB25*/
         AL    II,@CF00224                                         0761
         C     II,@CF01398                                         0761
         BNH   @DL00759                                            0761
*   END;                            /*                       @Z40LB25*/
*                                                                  0762
         AL    I,@CF00224                                          0762
         C     I,@CF00047                                          0762
         BNH   @DL00758                                            0762
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE USER SUPPLIED X Y Z(S)                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0763
*   DO I=1 TO CELLCNT;              /*                       @Z40LB25*/
*                                                                  0763
         LA    I,1                                                 0763
         B     @DE00763                                            0763
@DL00763 DS    0H                                                  0764
*     /***************************************************************/
*     /*                                                             */
*     /* GET THE X Y Z OF THE CELL                           @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0764
*     X=CELLXPTR(I)->CELLXVAL;      /* USER X                @Z40LB25*/
         LR    @05,I                                               0764
         SLA   @05,2                                               0764
         L     @15,@PC00001+4                                      0764
         L     @01,FDTPTR+44(,@15)                                 0764
         AL    @01,@CF01675                                        0764
         L     @01,CELLXPTR(@05,@01)                               0764
         L     @14,CELLXVAL(,@01)                                  0764
         STH   @14,X                                               0764
*     Y=CELLYPTR(I)->CELLYVAL;      /* USER Y                @Z40LB25*/
         L     @01,FDTPTR+48(,@15)                                 0765
         AL    @01,@CF01675                                        0765
         L     @01,CELLYPTR(@05,@01)                               0765
         L     @07,CELLYVAL(,@01)                                  0765
         ST    @07,Y                                               0765
*     Z=CELLZPTR(I)->CELLZVAL;      /* USER Z                @Z40LB25*/
*                                                                  0766
         L     @01,FDTPTR+52(,@15)                                 0766
         AL    @01,@CF01675                                        0766
         L     @05,CELLZPTR(@05,@01)                               0766
         L     @05,CELLZVAL(,@05)                                  0766
         STH   @05,Z                                               0766
*     /***************************************************************/
*     /*                                                             */
*     /* INSURE X VALUE OF INPUT X Y Z IS WITHIN THE MSF     @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0767
*     IF X<MSFLOWX THEN                                            0767
         C     @14,MSFLOWX                                         0767
         BNL   @RF00767                                            0767
*       DO;                         /*                       @Z40LB25*/
*                                                                  0768
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MESSAGE IDC21141I                         @Z40LB25*/
*         /* INDICATE THE CELL NOT PROCESSED                 @Z40LB25*/
*         /* BECAUSE IT IS LESS THAN THE LOW MSF X           @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0769
*         PRINTAB=''B;              /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0769
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/
         L     @05,DDSTRU                                          0770
         MVC   DARGSMOD(3,@05),@CC01440                            0770
*         DARGSENT=MG21141C;        /*                       @Z40LB25*/
         MVI   DARGSENT(@05),X'09'                                 0771
*         DARGCNT=4;                /*                       @Z40LB25*/
         LA    @14,4                                               0772
         STH   @14,DARGCNT(,@05)                                   0772
*         DARGINS(1)=1;             /*                       @Z40LB25*/
         MVC   DARGINS(2,@05),@CH00224                             0773
*         DARGINL(1)=LENGTH(X);     /*                       @Z40LB25*/
         LA    @07,2                                               0774
         STH   @07,DARGINL(,@05)                                   0774
*         DARGDTM(1)=ADDR(X);       /*                       @Z40LB25*/
         LA    @06,X                                               0775
         ST    @06,DARGDTM(,@05)                                   0775
*         DARGINS(2)=2;             /*                       @Z40LB25*/
         STH   @07,DARGINS+8(,@05)                                 0776
*         DARGINL(2)=LENGTH(Y);     /*                       @Z40LB25*/
         STH   @14,DARGINL+8(,@05)                                 0777
*         DARGDTM(2)=ADDR(Y);       /*                       @Z40LB25*/
         LA    @06,Y                                               0778
         ST    @06,DARGDTM+8(,@05)                                 0778
*         DARGINS(3)=3;             /*                       @Z40LB25*/
         MVC   DARGINS+16(2,@05),@CH00167                          0779
*         DARGINL(3)=LENGTH(Z);     /*                       @Z40LB25*/
         STH   @07,DARGINL+16(,@05)                                0780
*         DARGDTM(3)=ADDR(Z);       /*                       @Z40LB25*/
         LA    @07,Z                                               0781
         ST    @07,DARGDTM+16(,@05)                                0781
*         DARGINS(4)=4;             /*                       @Z40LB25*/
         STH   @14,DARGINS+24(,@05)                                0782
*         DARGINL(4)=LENGTH(MSFVAL);/*                       @Z40LB25*/
         STH   @14,DARGINL+24(,@05)                                0783
*         DARGDTM(4)=ADDR(MSFVAL);  /*                       @Z40LB25*/
         L     @15,FDTPTR+24(,@15)                                 0784
         ST    @15,DARGDTM+24(,@05)                                0784
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/
         L     @05,@PC00001                                        0785
         ST    @05,@AL00001                                        0785
         LA    @15,@CF00120                                        0785
         ST    @15,@AL00001+4                                      0785
         LA    @15,DDSTRU                                          0785
         ST    @15,@AL00001+8                                      0785
         MVI   @AL00001+8,X'80'                                    0785
         L     @15,GDTPRT(,@05)                                    0785
         LA    @01,@AL00001                                        0785
         BALR  @14,@15                                             0785
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/
         MVC   LIMITSRC(2),@CH00184                                0786
*       END;                        /*                       @Z40LB25*/
*                                                                  0787
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF THERE ARE CELLS TO BE PROCESSED            @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0788
*     IF X=>MSFLOWX THEN                                           0788
@RF00767 LH    @05,X                                               0788
         C     @05,MSFLOWX                                         0788
         BL    @RF00788                                            0788
*       DO;                         /*                       @Z40LB25*/
*         TERMINAT=OFF;             /*                       @Z40LB25*/
         NI    TERMINAT,B'11011111'                                0790
*         CHUNKPTR=ADDR(WRKCUBE(1));/* WORKMAP               @Z40LB25*/
         L     @05,WRKMAPTR                                        0791
         LA    @15,WRKCUBE(,@05)                                   0791
         ST    @15,CHUNKPTR                                        0791
*         CELLPTR=ADDR(WRKBLK(1));  /*                       @Z40LB25*/
*                                                                  0792
         ST    @05,CELLPTR                                         0792
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE XYZ LOCATION TO AN ON BIT IN WORKMAP        */
*         /*                                                 @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0793
*         CALL LOCTOBIT;            /*                       @Z40LB25*/
         BAL   @14,LOCTOBIT                                        0793
*       END;                        /*                       @Z40LB25*/
*   END;                            /*                       @Z40LB25*/
*                                                                  0795
@RF00788 AL    I,@CF00224                                          0795
@DE00763 L     @05,@PC00001+4                                      0795
         LA    @05,FDTPTR+40(,@05)                                 0795
         C     I,CELLCNT(,@05)                                     0795
         BNH   @DL00763                                            0795
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO ALL CELLS OTHER THAN THE USER X Y Z(S)           @Z40LB25*/
*   /* IN WORKMAP                                            @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0796
*   IF TERMINAT=OFF THEN                                           0796
         TM    TERMINAT,B'00100000'                                0796
         BNZ   @RF00796                                            0796
*     DO I=1 TO BLKNUM;             /*                       @Z40LB25*/
         LA    I,1                                                 0797
@DL00797 DS    0H                                                  0798
*       DO II=1 TO LENGTH(WRKCUBE); /*                       @Z40LB25*/
         LA    II,1                                                0798
@DL00798 DS    0H                                                  0799
*         WRKCUBE(I,II)=WRKCUBE(I,II)&ORIGCUBE(I,II);/*      @Z40LB25*/
         LR    @05,I                                               0799
         MH    @05,@CH01230                                        0799
         ALR   @05,II                                              0799
         L     @02,WRKMAPTR                                        0799
         ALR   @02,@05                                             0799
         AL    @02,@CF01670                                        0799
         L     @15,@PC00001+8                                      0799
         L     @01,BLKPTR(,@15)                                    0799
         ALR   @01,@05                                             0799
         NC    WRKCUBE-8(1,@02),ORIGCUBE-265(@01)                  0799
*       END;                        /*                       @Z40LB25*/
         AL    II,@CF00224                                         0800
         C     II,@CF01398                                         0800
         BNH   @DL00798                                            0800
*     END;                          /*                       @Z40LB25*/
         AL    I,@CF00224                                          0801
         C     I,@CF00047                                          0801
         BNH   @DL00797                                            0801
*   ELSE                                                           0802
*                                                                  0802
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE MSG IDC31142I                                 @Z40LB25*/
*     /* NO VALID CELLS SPECIFIED                            @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0802
*     DO;                           /*                       @Z40LB25*/
         B     @RC00796                                            0802
@RF00796 DS    0H                                                  0803
*       LIMITSRC=LASTCC12;          /*                       @Z40LB25*/
         MVC   LIMITSRC(2),@CH00571                                0803
*       PRINTAB=''B;                /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0804
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/
         L     @15,DDSTRU                                          0805
         MVC   DARGSMOD(3,@15),@CC01440                            0805
*       DARGSENT=MG21142C;          /*                       @Z40LB25*/
         MVI   DARGSENT(@15),X'07'                                 0806
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/
         L     @15,@PC00001                                        0807
         ST    @15,@AL00001                                        0807
         LA    @14,@CF00120                                        0807
         ST    @14,@AL00001+4                                      0807
         LA    @14,DDSTRU                                          0807
         ST    @14,@AL00001+8                                      0807
         MVI   @AL00001+8,X'80'                                    0807
         L     @15,GDTPRT(,@15)                                    0807
         LA    @01,@AL00001                                        0807
         BALR  @14,@15                                             0807
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00005 DS    0H                                                  0809
@EF00005 DS    0H                                                  0809
@ER00005 L     @14,@SA00005                                        0809
         BR    @14                                                 0809
*   END PROCCELL;                   /*                       @Z40LB25*/
         B     @EL00005                                            0810
*                                                                  0811
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CHECKLIB                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - THIS IS THE CONTROL PROCEDURE              @Z40LB25*/
*   /* FOR GATHERING THE RESULTS OF THE MSC CHECK            @Z40LB25*/
*   /* CELL AND PRINTING THE AUDITMSS CHECK REPORT.          @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* CHECKRC                                               @Z40LB25*/
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/
*   /* IDC21143I - STID 4                                    @Z40LB25*/
*   /* IDC21145I - STID 44                                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0811
*CHECKLIB:                                                         0811
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
CHECKLIB ST    @14,@SA00006                                        0811
*   CHECKRC=LASTCC00;               /* ZERO RETURN CODE      @Z40LB25*/
*                                                                  0812
         SLR   @15,@15                                             0812
         STH   @15,CHECKRC                                         0812
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE USER SPECIFIED CELLS                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0813
*   CALL CKCELL;                    /*                       @Z40LB25*/
*                                                                  0813
         BAL   @14,CKCELL                                          0813
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE CHECK REPORT SUBTITLE                       @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0814
*   IF CHECKRC^=LASTCC12&(PRTXYZ1=ON×PRTXYZ2=ON) THEN              0814
         CLC   CHECKRC(2),@CH00571                                 0814
         BE    @RF00814                                            0814
         TM    PRTXYZ1,B'01100000'                                 0814
         BZ    @RF00814                                            0814
*     DO;                           /*                       @Z40LB25*/
*                                                                  0815
*       /*************************************************************/
*       /*                                                           */
*       /* SELECT THE CORRECT SUBTITLE                       @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0816
*       IF ADDR(CHALL)^=NULLPTR THEN                               0816
         L     @15,@PC00001+4                                      0816
         L     @15,FDTPTR+20(,@15)                                 0816
         LTR   @15,@15                                             0816
         BZ    @RF00816                                            0816
*         HDCKID11=ON;              /*                       @Z40LB25*/
         OI    HDCKID11,B'10000000'                                0817
*       IF ADDR(FULL)^=NULLPTR THEN                                0818
@RF00816 L     @15,@PC00001+4                                      0818
         L     @15,FDTPTR+12(,@15)                                 0818
         LTR   @15,@15                                             0818
         BZ    @RF00818                                            0818
*         HDCKID12=ON;              /*                       @Z40LB25*/
         OI    HDCKID12,B'01000000'                                0819
*       IF ADDR(EMPTY)^=NULLPTR THEN                               0820
@RF00818 L     @15,@PC00001+4                                      0820
         L     @15,FDTPTR+16(,@15)                                 0820
         LTR   @15,@15                                             0820
         BZ    @RF00820                                            0820
*         HDCKID13=ON;              /*                       @Z40LB25*/
         OI    HDCKID13,B'00100000'                                0821
*       CALL HEADSET;               /*                       @Z40LB25*/
*                                                                  0822
@RF00820 BAL   @14,HEADSET                                         0822
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT THE CHECK REPORT                            @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0823
*       CALL PRINTXYZ;              /*                       @Z40LB25*/
         BAL   @14,PRINTXYZ                                        0823
*     END;                          /*                       @Z40LB25*/
*                                                                  0824
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF AN ERROR HAS OCCURRED                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0825
*   IF CHECKRC^=LASTCC00 THEN                                      0825
@RF00814 LH    @15,CHECKRC                                         0825
         LTR   @15,@15                                             0825
         BZ    @RF00825                                            0825
*     DO;                           /*                       @Z40LB25*/
*       PRINTAB=''B;                /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0827
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/
*                                                                  0828
         L     @14,DDSTRU                                          0828
         MVC   DARGSMOD(3,@14),@CC01440                            0828
*       /*************************************************************/
*       /*                                                           */
*       /* MSG IDC21147I                                     @Z40LB25*/
*       /* CHECK FOR AN INCOMPLETE REPORT                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0829
*       IF CHECKRC=LASTCC08&(XYZ1PRTD=ON×XYZ2PRTD=ON) THEN         0829
         C     @15,@CF00184                                        0829
         BNE   @RF00829                                            0829
         TM    XYZ1PRTD,B'00000011'                                0829
         BZ    @RF00829                                            0829
*         DARGSENT=MG21147C;        /*                       @Z40LB25*/
*                                                                  0830
         MVI   DARGSENT(@14),X'04'                                 0830
*       /*************************************************************/
*       /*                                                           */
*       /* MSG IDC31148I                                     @Z40LB25*/
*       /* NO REPORT PRODUCED                                @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0831
*       ELSE                                                       0831
*         DO;                       /*                       @Z40LB25*/
         B     @RC00829                                            0831
@RF00829 DS    0H                                                  0832
*           DARGSENT=MG31148C;      /*                       @Z40LB25*/
         L     @01,DDSTRU                                          0832
         MVI   DARGSENT(@01),X'2C'                                 0832
*           CHECKRC=LASTCC12;       /*                       @Z40LB25*/
         MVC   CHECKRC(2),@CH00571                                 0833
*         END;                      /*                       @Z40LB25*/
*       DARGCNT=2;                  /*                       @Z40LB25*/
@RC00829 LA    @15,2                                               0835
         L     @14,DDSTRU                                          0835
         STH   @15,DARGCNT(,@14)                                   0835
*       DARGINS(1)=1;               /*                       @Z40LB25*/
         LA    @07,1                                               0836
         STH   @07,DARGINS(,@14)                                   0836
*       X=QUXADDR;                  /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         0837
         SLR   @00,@00                                             0837
         IC    @00,QUXADDR(,@01)                                   0837
         STH   @00,X                                               0837
*       DARGINL(1)=LENGTH(X);       /*                       @Z40LB25*/
         STH   @15,DARGINL(,@14)                                   0838
*       DARGDTM(1)=ADDR(X);         /*                       @Z40LB25*/
         LA    @06,X                                               0839
         ST    @06,DARGDTM(,@14)                                   0839
*       DARGINS(2)=2;               /*                       @Z40LB25*/
         STH   @15,DARGINS+8(,@14)                                 0840
*       IF X=246 THEN                                              0841
         C     @00,@CF01567                                        0841
         BNE   @RF00841                                            0841
*         X1=X+1;                   /* 247                   @Z40LB25*/
         ALR   @00,@07                                             0842
         STH   @00,X1                                              0842
*       ELSE                                                       0843
*         X1=X+4;                   /*                       @Z40LB25*/
         B     @RC00841                                            0843
@RF00841 LA    @15,4                                               0843
         AH    @15,X                                               0843
         STH   @15,X1                                              0843
*       DARGINL(2)=LENGTH(X1);      /*                       @Z40LB25*/
@RC00841 L     @15,DDSTRU                                          0844
         MVC   DARGINL+8(2,@15),@CH00158                           0844
*       DARGDTM(2)=ADDR(X1);        /*                       @Z40LB25*/
         LA    @14,X1                                              0845
         ST    @14,DARGDTM+8(,@15)                                 0845
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/
         L     @15,@PC00001                                        0846
         ST    @15,@AL00001                                        0846
         LA    @14,@CF00120                                        0846
         ST    @14,@AL00001+4                                      0846
         LA    @14,DDSTRU                                          0846
         ST    @14,@AL00001+8                                      0846
         MVI   @AL00001+8,X'80'                                    0846
         L     @15,GDTPRT(,@15)                                    0846
         LA    @01,@AL00001                                        0846
         BALR  @14,@15                                             0846
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00006 DS    0H                                                  0848
@EF00006 DS    0H                                                  0848
@ER00006 L     @14,@SA00006                                        0848
         BR    @14                                                 0848
*   END CHECKLIB;                   /*                       @Z40LB25*/
         B     @EL00006                                            0849
*                                                                  0850
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - READLBL                              @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - THIS IS THE CONTROL PROCEDURE              @Z40LB25*/
*   /* FOR GATHERING THE RESULTS OF THE MSC READ LABEL       @Z40LB25*/
*   /* AND PRINTING THE AUDITMSS READ LABEL REPORT.          @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* READRC                                                @Z40LB25*/
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/
*   /* IDC21143I - STID 5                                    @Z40LB25*/
*   /* IDC21145I - STID 45                                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0850
*READLBL:                                                          0850
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
READLBL  ST    @14,@SA00007                                        0850
*   READRC=LASTCC00;                /* ZERO RETURN CODE      @Z40LB25*/
*                                                                  0851
         SLR   @15,@15                                             0851
         STH   @15,READRC                                          0851
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE USER SPECIFIED CARTRIDGES AND PRINT THE      @Z40LB25*/
*   /* THE FIRST PART OF THE READ LABEL REPORT               @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0852
*   CALL READ;                      /*                       @Z40LB25*/
*                                                                  0852
         BAL   @14,READ                                            0852
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE LAST TWO PARTS OF THE READ LABEL REPORT     @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0853
*   IF READRC^=LASTCC12&(PRTXYZ1=ON×PRTXYZ2=ON) THEN               0853
         CLC   READRC(2),@CH00571                                  0853
         BE    @RF00853                                            0853
         TM    PRTXYZ1,B'01100000'                                 0853
         BZ    @RF00853                                            0853
*     CALL PRINTXYZ;                /*                       @Z40LB25*/
*                                                                  0854
         BAL   @14,PRINTXYZ                                        0854
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF AN ERROR HAS OCCURRED                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0855
*   IF READRC^=LASTCC00 THEN                                       0855
@RF00853 LH    @15,READRC                                          0855
         LTR   @15,@15                                             0855
         BZ    @RF00855                                            0855
*     DO;                           /*                       @Z40LB25*/
*       PRINTAB=''B;                /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                0857
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/
*                                                                  0858
         L     @01,DDSTRU                                          0858
         MVC   DARGSMOD(3,@01),@CC01440                            0858
*       /*************************************************************/
*       /*                                                           */
*       /* MSG IDC21143I                                     @Z40LB25*/
*       /* CHECK FOR AN INCOMPLETE REPORT                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0859
*       IF READRC=LASTCC08&(XYZ1PRTD=ON×XYZ2PRTD=ON×RLBLPRTD=ON) THEN
         C     @15,@CF00184                                        0859
         BNE   @RF00859                                            0859
         TM    XYZ1PRTD,B'00000011'                                0859
         BNZ   @RT00859                                            0859
         TM    RLBLPRTD,B'10000000'                                0859
         BNO   @RF00859                                            0859
@RT00859 DS    0H                                                  0860
*         DARGSENT=MG21143R;        /*                       @Z40LB25*/
*                                                                  0860
         L     @01,DDSTRU                                          0860
         MVI   DARGSENT(@01),X'05'                                 0860
*       /*************************************************************/
*       /*                                                           */
*       /* MSG IDC31145I                                     @Z40LB25*/
*       /* NO REPORT PRODUCED                                @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0861
*       ELSE                                                       0861
*         DO;                       /*                       @Z40LB25*/
         B     @RC00859                                            0861
@RF00859 DS    0H                                                  0862
*           DARGSENT=MG31145R;      /*                       @Z40LB25*/
         L     @01,DDSTRU                                          0862
         MVI   DARGSENT(@01),X'2D'                                 0862
*           READRC=LASTCC12;        /*                       @Z40LB25*/
         MVC   READRC(2),@CH00571                                  0863
*         END;                      /*                       @Z40LB25*/
*       DARGCNT=1;                  /*                       @Z40LB25*/
@RC00859 LA    @15,1                                               0865
         L     @14,DDSTRU                                          0865
         STH   @15,DARGCNT(,@14)                                   0865
*       DARGINS(1)=1;               /*                       @Z40LB25*/
         STH   @15,DARGINS(,@14)                                   0866
*       X=READX;                    /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         0867
         SLR   @00,@00                                             0867
         IC    @00,READX(,@01)                                     0867
         STH   @00,X                                               0867
*       DARGINL(1)=LENGTH(X);       /*                       @Z40LB25*/
         MVC   DARGINL(2,@14),@CH00158                             0868
*       DARGDTM(1)=ADDR(X);         /*                       @Z40LB25*/
         LA    @15,X                                               0869
         ST    @15,DARGDTM(,@14)                                   0869
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/
         L     @15,@PC00001                                        0870
         ST    @15,@AL00001                                        0870
         LA    @14,@CF00120                                        0870
         ST    @14,@AL00001+4                                      0870
         LA    @14,DDSTRU                                          0870
         ST    @14,@AL00001+8                                      0870
         MVI   @AL00001+8,X'80'                                    0870
         L     @15,GDTPRT(,@15)                                    0870
         LA    @01,@AL00001                                        0870
         BALR  @14,@15                                             0870
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00007 DS    0H                                                  0872
@EF00007 DS    0H                                                  0872
@ER00007 L     @14,@SA00007                                        0872
         BR    @14                                                 0872
*   END READLBL;                    /*                       @Z40LB25*/
         B     @EL00007                                            0873
*                                                                  0874
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - LOCTOBIT                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - THIS PROCEDURE TAKES AN X Y Z              @Z40LB25*/
*   /* LOCATION AND SETS ITS CORRESPONDING BIT IN            @Z40LB25*/
*   /* EITHER XYZ1 OR XYZ2 OR WORKMAP WORK AREA              @Z40LB25*/
*   /* OR ORIGINAL CELL MAP ON.                              @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* CHUNKPTR - XYZ1, XYZ2, WORKMAP, ORIGMAP               @Z40LB25*/
*   /* CELLPTR - CELL BLOCK                                  @Z40LB25*/
*   /* X - 150 T0 247                                        @Z40LB25*/
*   /* Y - 0 TO 27                                           @Z40LB25*/
*   /* Z - 0 OR 1                                            @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* XYZ1 OR XYZ2 OR ORIGINAL CELL MAP OR                  @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0874
*LOCTOBIT:                                                         0874
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
LOCTOBIT ST    @14,12(,@13)                                        0874
*   SETBIT=OFF;                     /*                       @Z40LB25*/
         NI    SETBIT,B'11101111'                                  0875
*   TEMPX=XSTART;                   /* 150                   @Z40LB25*/
         LA    TEMPX,150                                           0876
*   TEMPY=''B;                      /*                       @Z40LB25*/
         SLR   @07,@07                                             0877
         STH   @07,TEMPY                                           0877
*   XINDEX=''B;                     /*                       @Z40LB25*/
         LR    XINDEX,@07                                          0878
*   DO BLKINDEX=1 TO BLKNUM WHILE SETBIT=OFF;/* BLOCKS 1 - 4 @Z40LB25*/
*                                                                  0879
         LA    BLKINDEX,1                                          0879
@DL00879 TM    SETBIT,B'00010000'                                  0879
         BNZ   @DC00879                                            0879
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN THE CHUNKS OF EACH OF THE BLOCKS               @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0880
*     DO CHKINDEX=1 TO CHUNKNUM WHILE SETBIT=OFF;/*          @Z40LB25*/
         LA    @15,1                                               0880
         STH   @15,CHKINDEX                                        0880
@DL00880 TM    SETBIT,B'00010000'                                  0880
         BNZ   @DC00880                                            0880
*       CUBEPTR=CHUNKPTR;           /*                       @Z40LB25*/
*                                                                  0881
         L     CUBEPTR,CHUNKPTR                                    0881
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN THE CUBES PER CHUNK                          @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0882
*       DO CUBINDEX=1 TO CUBENUM WHILE SETBIT=OFF;/*         @Z40LB25*/
*                                                                  0882
         LA    @03,1                                               0882
         STH   @03,CUBINDEX                                        0882
@DL00882 TM    SETBIT,B'00010000'                                  0882
         BNZ   @DC00882                                            0882
*         /***********************************************************/
*         /*                                                         */
*         /* SCAN EACH BYTE FOR THE CORRECT XYZ              @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0883
*         DO BYTINDEX=1 TO BYTENUM WHILE SETBIT=OFF;/*       @Z40LB25*/
*                                                                  0883
         LA    BYTINDEX,1                                          0883
@DL00883 TM    SETBIT,B'00010000'                                  0883
         BNZ   @DC00883                                            0883
*           /*********************************************************/
*           /*                                                       */
*           /* SCAN FOR EACH X (2 BITS)                      @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0884
*           DO TWOBITX=1 TO 4 WHILE SETBIT=OFF;/*            @Z40LB25*/
         LA    @15,1                                               0884
         STH   @15,TWOBITX                                         0884
@DL00884 TM    SETBIT,B'00010000'                                  0884
         BNZ   @DC00884                                            0884
*             IF TEMPX+XINDEX=X&TEMPY=Y THEN                       0885
         LR    @15,TEMPX                                           0885
         ALR   @15,XINDEX                                          0885
         CH    @15,X                                               0885
         BNE   @RF00885                                            0885
         LH    @15,TEMPY                                           0885
         C     @15,Y                                               0885
         BNE   @RF00885                                            0885
*               DO;                 /*                       @Z40LB25*/
*                 SETBIT=ON;        /*                       @Z40LB25*/
         OI    SETBIT,B'00010000'                                  0887
*                 IF XINDEX=0&Z=0 THEN                             0888
         SLR   @15,@15                                             0888
         CR    XINDEX,@15                                          0888
         BNE   @RF00888                                            0888
         CH    @15,Z                                               0888
         BNE   @RF00888                                            0888
*                   X0Z0(BYTINDEX)=ON;/*                     @Z40LB25*/
         LR    @01,CUBEPTR                                         0889
         ALR   @01,BYTINDEX                                        0889
         AL    @01,@CF01674                                        0889
         OI    X0Z0(@01),B'10000000'                               0889
*                 IF XINDEX=0&Z=1 THEN                             0890
@RF00888 LTR   XINDEX,XINDEX                                       0890
         BNZ   @RF00890                                            0890
         CLC   Z(2),@CH00224                                       0890
         BNE   @RF00890                                            0890
*                   X0Z1(BYTINDEX)=ON;/*                     @Z40LB25*/
         LR    @01,CUBEPTR                                         0891
         ALR   @01,BYTINDEX                                        0891
         AL    @01,@CF01674                                        0891
         OI    X0Z1(@01),B'01000000'                               0891
*                 IF XINDEX=1&Z=0 THEN                             0892
@RF00890 C     XINDEX,@CF00224                                     0892
         BNE   @RF00892                                            0892
         LH    @15,Z                                               0892
         LTR   @15,@15                                             0892
         BNZ   @RF00892                                            0892
*                   X1Z0(BYTINDEX)=ON;/*                     @Z40LB25*/
         LR    @01,CUBEPTR                                         0893
         ALR   @01,BYTINDEX                                        0893
         AL    @01,@CF01674                                        0893
         OI    X1Z0(@01),B'00100000'                               0893
*                 IF XINDEX=1&Z=1 THEN                             0894
@RF00892 LA    @15,1                                               0894
         CR    XINDEX,@15                                          0894
         BNE   @RF00894                                            0894
         CH    @15,Z                                               0894
         BNE   @RF00894                                            0894
*                   X1Z1(BYTINDEX)=ON;/*                     @Z40LB25*/
*                                                                  0895
         LR    @01,CUBEPTR                                         0895
         ALR   @01,BYTINDEX                                        0895
         AL    @01,@CF01674                                        0895
         OI    X1Z1(@01),B'00010000'                               0895
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK FOR LAST BLOCK                    @Z40LB25*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0896
*                 IF BLKINDEX^=BLKNUM THEN                         0896
@RF00894 C     BLKINDEX,@CF00047                                   0896
         BE    @RF00896                                            0896
*                   DO;             /*                       @Z40LB25*/
*                     IF XINDEX=2&Z=0 THEN                         0898
         C     XINDEX,@CF00158                                     0898
         BNE   @RF00898                                            0898
         LH    @15,Z                                               0898
         LTR   @15,@15                                             0898
         BNZ   @RF00898                                            0898
*                       X2Z0(BYTINDEX)=ON;/*                 @Z40LB25*/
         LR    @01,CUBEPTR                                         0899
         ALR   @01,BYTINDEX                                        0899
         AL    @01,@CF01674                                        0899
         OI    X2Z0(@01),B'00001000'                               0899
*                     IF XINDEX=2&Z=1 THEN                         0900
@RF00898 C     XINDEX,@CF00158                                     0900
         BNE   @RF00900                                            0900
         CLC   Z(2),@CH00224                                       0900
         BNE   @RF00900                                            0900
*                       X2Z1(BYTINDEX)=ON;/*                 @Z40LB25*/
         LR    @01,CUBEPTR                                         0901
         ALR   @01,BYTINDEX                                        0901
         AL    @01,@CF01674                                        0901
         OI    X2Z1(@01),B'00000100'                               0901
*                     IF XINDEX=3&Z=0 THEN                         0902
@RF00900 C     XINDEX,@CF00167                                     0902
         BNE   @RF00902                                            0902
         LH    @15,Z                                               0902
         LTR   @15,@15                                             0902
         BNZ   @RF00902                                            0902
*                       X3Z0(BYTINDEX)=ON;/*                 @Z40LB25*/
         LR    @01,CUBEPTR                                         0903
         ALR   @01,BYTINDEX                                        0903
         AL    @01,@CF01674                                        0903
         OI    X3Z0(@01),B'00000010'                               0903
*                     IF XINDEX=3&Z=1 THEN                         0904
@RF00902 C     XINDEX,@CF00167                                     0904
         BNE   @RF00904                                            0904
         CLC   Z(2),@CH00224                                       0904
         BNE   @RF00904                                            0904
*                       X3Z1(BYTINDEX)=ON;/*                 @Z40LB25*/
         LR    @01,CUBEPTR                                         0905
         ALR   @01,BYTINDEX                                        0905
         AL    @01,@CF01674                                        0905
         OI    X3Z1(@01),B'00000001'                               0905
*                   END;            /*                       @Z40LB25*/
*               END;                /*                       @Z40LB25*/
*             ELSE                                                 0908
*               XINDEX=XINDEX+1;    /*                       @Z40LB25*/
         B     @RC00885                                            0908
@RF00885 AL    XINDEX,@CF00224                                     0908
*           END;                    /*                       @Z40LB25*/
@RC00885 LA    @15,1                                               0909
         AH    @15,TWOBITX                                         0909
         STH   @15,TWOBITX                                         0909
         C     @15,@CF00047                                        0909
         BNH   @DL00884                                            0909
@DC00884 DS    0H                                                  0910
*           XINDEX=''B;             /*                       @Z40LB25*/
         SLR   XINDEX,XINDEX                                       0910
*           TEMPY=TEMPY+1;          /*                       @Z40LB25*/
         LA    @15,1                                               0911
         AH    @15,TEMPY                                           0911
         STH   @15,TEMPY                                           0911
*         END;                      /*                       @Z40LB25*/
         AL    BYTINDEX,@CF00224                                   0912
         C     BYTINDEX,@CF00047                                   0912
         BNH   @DL00883                                            0912
@DC00883 DS    0H                                                  0913
*         XINDEX=''B;               /*                       @Z40LB25*/
         SLR   XINDEX,XINDEX                                       0913
*         CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                    @Z40LB25*/
         AL    CUBEPTR,@CF00047                                    0914
*       END;                        /*                       @Z40LB25*/
*                                                                  0915
         LA    @03,1                                               0915
         AH    @03,CUBINDEX                                        0915
         STH   @03,CUBINDEX                                        0915
         C     @03,@CF00663                                        0915
         BNH   @DL00882                                            0915
@DC00882 DS    0H                                                  0916
*       /*************************************************************/
*       /*                                                           */
*       /* IF AT THE LAST BLOCK, IT WILL CONTAIN             @Z40LB25*/
*       /* ONLY ONE CHUNK                                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0916
*       IF BLKINDEX=BLKNUM THEN                                    0916
         C     BLKINDEX,@CF00047                                   0916
         BNE   @RF00916                                            0916
*         CHKINDEX=CHUNKNUM;        /*                       @Z40LB25*/
         MVC   CHKINDEX(2),@CH00184                                0917
*       CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*                   @Z40LB25*/
@RF00916 LA    @15,32                                              0918
         AL    @15,CHUNKPTR                                        0918
         ST    @15,CHUNKPTR                                        0918
*       TEMPY=''B;                  /*                       @Z40LB25*/
         SLR   @15,@15                                             0919
         STH   @15,TEMPY                                           0919
*       TEMPX=TEMPX+4;              /*                       @Z40LB25*/
         AL    TEMPX,@CF00047                                      0920
*       XINDEX=''B;                 /*                       @Z40LB25*/
         LR    XINDEX,@15                                          0921
*     END;                          /*                       @Z40LB25*/
         LA    @15,1                                               0922
         AH    @15,CHKINDEX                                        0922
         STH   @15,CHKINDEX                                        0922
         C     @15,@CF00184                                        0922
         BNH   @DL00880                                            0922
@DC00880 DS    0H                                                  0923
*     CELLPTR=CELLPTR+BLKSIZE;      /*                       @Z40LB25*/
         LA    @15,264                                             0923
         AL    @15,CELLPTR                                         0923
         ST    @15,CELLPTR                                         0923
*     CHUNKPTR=CHUNKPTR+8;          /* SKIP CONTROL INFO     @Z40LB25*/
*                                                                  0924
         LA    @15,8                                               0924
         AL    @15,CHUNKPTR                                        0924
         ST    @15,CHUNKPTR                                        0924
*     /***************************************************************/
*     /*                                                             */
*     /* OF NEXT BLOCK                                       @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0925
*   END;                            /*                       @Z40LB25*/
         AL    BLKINDEX,@CF00224                                   0925
         C     BLKINDEX,@CF00047                                   0925
         BNH   @DL00879                                            0925
@DC00879 DS    0H                                                  0926
*   RETURN;                         /*                       @Z40LB25*/
@EL00008 DS    0H                                                  0926
@EF00008 DS    0H                                                  0926
@ER00008 L     @14,12(,@13)                                        0926
         BR    @14                                                 0926
*   END LOCTOBIT;                   /*                       @Z40LB25*/
*                                                                  0928
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CKCELL                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - BUILDS THE PARAMETER LIST FOR THE          @Z40LB25*/
*   /* EXECUTION OF ICBQUERY (QCEL) USING WORKMAP.           @Z40LB25*/
*   /* PROCESSES ANY HARDWARE ERRORS.                        @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* WORKMAP                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* CHECKRC                                               @Z40LB25*/
*   /* 12 - FAIL ON FIRST CALL TO USSC                       @Z40LB25*/
*   /* 8 - FAIL ON OTHER THAN FIRST USSC CALL                @Z40LB25*/
*   /* DIAGBUF (CELLPARM)                                    @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0928
*CKCELL:                                                           0928
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  0928
CKCELL   ST    @14,@SA00009                                        0928
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE IBCQUERY (QCEL) PARM LIST                  @Z40LB25*/
*   /* MSFVAL IS SET TO ZERO WHEN RDCKLIST IS ZEROED.        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0929
*   IF MSFVAL=MSF1 THEN             /* SET MSF NUM           @Z40LB25*/
         L     @15,@PC00001+4                                      0929
         L     @01,FDTPTR+24(,@15)                                 0929
         L     @15,MSFVAL(,@01)                                    0929
         SLR   @14,@14                                             0929
         IC    @14,MSF1                                            0929
         CR    @15,@14                                             0929
         BNE   @RF00929                                            0929
*     QULIB=ONEMSF;                 /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         0930
         MVC   QULIB(1,@01),ONEMSF                                 0930
*   IF MSFVAL=MSF2 THEN             /* SET MSF NUM           @Z40LB25*/
@RF00929 L     @15,@PC00001+4                                      0931
         L     @01,FDTPTR+24(,@15)                                 0931
         L     @15,MSFVAL(,@01)                                    0931
         SLR   @14,@14                                             0931
         IC    @14,MSF2                                            0931
         CR    @15,@14                                             0931
         BNE   @RF00931                                            0931
*     QULIB=TWOMSF;                 /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         0932
         MVC   QULIB(1,@01),TWOMSF                                 0932
*   IF MSFVAL=MSF3 THEN             /* SET MSF NUM           @Z40LB25*/
@RF00931 L     @15,@PC00001+4                                      0933
         L     @01,FDTPTR+24(,@15)                                 0933
         L     @15,MSFVAL(,@01)                                    0933
         SLR   @14,@14                                             0933
         IC    @14,MSF3                                            0933
         CR    @15,@14                                             0933
         BNE   @RF00933                                            0933
*     QULIB=THREEMSF;               /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         0934
         MVC   QULIB(1,@01),THREEMSF                               0934
*   QUPTR=ADDR(DIAGBUF);            /* RETURN AREA           @Z40LB25*/
@RF00933 L     @02,@PC00001+8                                      0935
         L     @02,BLKPTR(,@02)                                    0935
         LA    @15,DIAGBUF(,@02)                                   0935
         L     @14,RDCKPTR                                         0935
         ST    @15,QUPTR(,@14)                                     0935
*   X2=XSTART;                      /* 150                   @Z40LB25*/
         MVC   X2(2),@CH01256                                      0936
*   YY2=ONEYMASK;                   /*                       @Z40LB25*/
         L     YY2,ONEYMASK                                        0937
*   CELLPTR2=ADDR(WRKBLK(1));       /* CELL BLOCK PTR        @Z40LB25*/
         L     @01,WRKMAPTR                                        0938
         ST    @01,CELLPTR2                                        0938
*   CURCLPTR=ADDR(CELLMAP(1));      /* CELL MAP BLOCK        @Z40LB25*/
*                                                                  0939
         LA    @02,CELLMAP(,@02)                                   0939
         ST    @02,CURCLPTR                                        0939
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN THE FOUR BLOCKS                                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0940
*   DO BLKINDX2=1 TO BLKNUM;        /*                       @Z40LB25*/
         LA    @02,1                                               0940
         STH   @02,BLKINDX2                                        0940
@DL00940 DS    0H                                                  0941
*     CHUNKPT2=ADDR(WRKCUBE(BLKINDX2));/*                    @Z40LB25*/
         MH    @02,@CH01230                                        0941
         L     @01,WRKMAPTR                                        0941
         AL    @01,@CF01672                                        0941
         LA    @15,WRKCUBE-8(@02,@01)                              0941
         ST    @15,CHUNKPT2                                        0941
*     CURCKPTR=ADDR(CELLCUBE(BLKINDX2));/*                   @Z40LB25*/
*                                                                  0942
         L     @15,@PC00001+8                                      0942
         L     @01,BLKPTR(,@15)                                    0942
         LA    @02,CELLCUBE-264(@02,@01)                           0942
         ST    @02,CURCKPTR                                        0942
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN THE CHUNKS OF EACH OF THE BLOCKS               @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0943
*     DO CHKINDX2=1 TO CHUNKNUM;    /*                       @Z40LB25*/
         LA    @02,1                                               0943
         STH   @02,CHKINDX2                                        0943
@DL00943 DS    0H                                                  0944
*       CUBEPTR2=CHUNKPT2;          /*                       @Z40LB25*/
         L     CUBEPTR2,CHUNKPT2                                   0944
*       CURCBPTR=CURCKPTR;          /*                       @Z40LB25*/
*                                                                  0945
         L     CURCBPTR,CURCKPTR                                   0945
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN THE CUBES PER CHUNK                          @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0946
*       DO CUBINDX2=1 TO CUBENUM;   /*                       @Z40LB25*/
*                                                                  0946
         LA    CUBINDX2,1                                          0946
@DL00946 DS    0H                                                  0947
*         /***********************************************************/
*         /*                                                         */
*         /* SCAN EACH BIT PER BYTE                          @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0947
*         DO BYTINDX2=1 TO BYTENUM; /*                       @Z40LB25*/
         LA    BYTINDX2,1                                          0947
@DL00947 DS    0H                                                  0948
*           TEMPX2=''B;             /*                       @Z40LB25*/
*                                                                  0948
         SLR   TEMPX2,TEMPX2                                       0948
*           /*********************************************************/
*           /*                                                       */
*           /* IF NOT ALREADY DONE, SET THE X VALUE          @Z40LB25*/
*           /* THE PARAMETER LIST                            @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0949
*           IF SETX=OFF THEN                                       0949
         TM    SETX,B'10000000'                                    0949
         BNZ   @RF00949                                            0949
*             DO;                   /*                       @Z40LB25*/
*               QUXADDR=X2;         /* START X               @Z40LB25*/
         L     @01,RDCKPTR                                         0951
         MVC   QUXADDR(1,@01),X2+1                                 0951
*               SETX=ON;            /*                       @Z40LB25*/
         OI    SETX,B'10000000'                                    0952
*             END;                  /*                       @Z40LB25*/
*                                                                  0953
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE CELLS TO BE CHECKED INTO QCPARM.      @Z40LB25*/
*           /* FOR EMPTY REMOVE BITS THAT CURRENT CELL MAP   @Z40LB25*/
*           /* INDICATES AS FULL. FOR FULL REMOVE BITS       @Z40LB25*/
*           /* THAT CURRENT CELL MAP INDICATES AS EMPTY.     @Z40LB25*/
*           /* NO CHANGE FOR ALL.                            @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0954
*                                                                  0954
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR X                                   @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0954
*           IF X2+TEMPX2=>MSFLOWX THEN                             0954
@RF00949 LR    @15,TEMPX2                                          0954
         AH    @15,X2                                              0954
         C     @15,MSFLOWX                                         0954
         BL    @RF00954                                            0954
*             DO;                   /*                       @Z40LB25*/
*               IF X0Z02(BYTINDX2)=ON THEN                         0956
         LR    @01,CUBEPTR2                                        0956
         ALR   @01,BYTINDX2                                        0956
         AL    @01,@CF01674                                        0956
         TM    X0Z02(@01),B'10000000'                              0956
         BNO   @RF00956                                            0956
*                 IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&CURX0Z0(
*                     BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&CURX0Z0(BYTINDX2
*                     )=OFF THEN                                   0957
         SLR   @15,@15                                             0957
         L     @14,@PC00001+4                                      0957
         C     @15,FDTPTR+20(,@14)                                 0957
         BNE   @RT00957                                            0957
         C     @15,FDTPTR+16(,@14)                                 0957
         BE    @GL00041                                            0957
         LR    @01,CURCBPTR                                        0957
         ALR   @01,BYTINDX2                                        0957
         AL    @01,@CF01674                                        0957
         TM    CURX0Z0(@01),B'10000000'                            0957
         BO    @RT00957                                            0957
@GL00041 L     @15,@PC00001+4                                      0957
         L     @15,FDTPTR+12(,@15)                                 0957
         LTR   @15,@15                                             0957
         BZ    @RF00957                                            0957
         LR    @01,CURCBPTR                                        0957
         ALR   @01,BYTINDX2                                        0957
         AL    @01,@CF01674                                        0957
         TM    CURX0Z0(@01),B'10000000'                            0957
         BNZ   @RF00957                                            0957
@RT00957 DS    0H                                                  0958
*                   DO;             /*                       @Z40LB25*/
*                     YSQC(1)=YSQC(1)×YY2;/*                 @Z40LB25*/
         L     @15,RDCKPTR                                         0959
         ICM   @14,15,YSQC(@15)                                    0959
         OR    @14,YY2                                             0959
         STCM  @14,15,YSQC(@15)                                    0959
*                     CHECKFLG=ON;  /*                       @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                0960
*                   END;            /*                       @Z40LB25*/
*               IF X0Z12(BYTINDX2)=ON THEN                         0962
@RF00957 DS    0H                                                  0962
@RF00956 LR    @01,CUBEPTR2                                        0962
         ALR   @01,BYTINDX2                                        0962
         AL    @01,@CF01674                                        0962
         TM    X0Z12(@01),B'01000000'                              0962
         BNO   @RF00962                                            0962
*                 IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&CURX0Z1(
*                     BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&CURX0Z1(BYTINDX2
*                     )=OFF THEN                                   0963
         SLR   @15,@15                                             0963
         L     @14,@PC00001+4                                      0963
         C     @15,FDTPTR+20(,@14)                                 0963
         BNE   @RT00963                                            0963
         C     @15,FDTPTR+16(,@14)                                 0963
         BE    @GL00045                                            0963
         LR    @01,CURCBPTR                                        0963
         ALR   @01,BYTINDX2                                        0963
         AL    @01,@CF01674                                        0963
         TM    CURX0Z1(@01),B'01000000'                            0963
         BO    @RT00963                                            0963
@GL00045 L     @15,@PC00001+4                                      0963
         L     @15,FDTPTR+12(,@15)                                 0963
         LTR   @15,@15                                             0963
         BZ    @RF00963                                            0963
         LR    @01,CURCBPTR                                        0963
         ALR   @01,BYTINDX2                                        0963
         AL    @01,@CF01674                                        0963
         TM    CURX0Z1(@01),B'01000000'                            0963
         BNZ   @RF00963                                            0963
@RT00963 DS    0H                                                  0964
*                   DO;             /*                       @Z40LB25*/
*                     YSQC(2)=YSQC(2)×YY2;/*                 @Z40LB25*/
         L     @15,RDCKPTR                                         0965
         ICM   @14,15,YSQC+4(@15)                                  0965
         OR    @14,YY2                                             0965
         STCM  @14,15,YSQC+4(@15)                                  0965
*                     CHECKFLG=ON;  /*                       @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                0966
*                   END;            /*                       @Z40LB25*/
*             END;                  /*                       @Z40LB25*/
@RF00963 DS    0H                                                  0968
@RF00962 DS    0H                                                  0969
*           TEMPX2=TEMPX2+1;        /*                       @Z40LB25*/
*                                                                  0969
@RF00954 AL    TEMPX2,@CF00224                                     0969
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR X+1                                 @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0970
*           IF X2+TEMPX2=>MSFLOWX THEN                             0970
         LR    @15,TEMPX2                                          0970
         AH    @15,X2                                              0970
         C     @15,MSFLOWX                                         0970
         BL    @RF00970                                            0970
*             DO;                   /*                       @Z40LB25*/
*               IF X1Z02(BYTINDX2)=ON THEN                         0972
         LR    @01,CUBEPTR2                                        0972
         ALR   @01,BYTINDX2                                        0972
         AL    @01,@CF01674                                        0972
         TM    X1Z02(@01),B'00100000'                              0972
         BNO   @RF00972                                            0972
*                 IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&CURX1Z0(
*                     BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&CURX1Z0(BYTINDX2
*                     )=OFF THEN                                   0973
         SLR   @15,@15                                             0973
         L     @14,@PC00001+4                                      0973
         C     @15,FDTPTR+20(,@14)                                 0973
         BNE   @RT00973                                            0973
         C     @15,FDTPTR+16(,@14)                                 0973
         BE    @GL00049                                            0973
         LR    @01,CURCBPTR                                        0973
         ALR   @01,BYTINDX2                                        0973
         AL    @01,@CF01674                                        0973
         TM    CURX1Z0(@01),B'00100000'                            0973
         BO    @RT00973                                            0973
@GL00049 L     @15,@PC00001+4                                      0973
         L     @15,FDTPTR+12(,@15)                                 0973
         LTR   @15,@15                                             0973
         BZ    @RF00973                                            0973
         LR    @01,CURCBPTR                                        0973
         ALR   @01,BYTINDX2                                        0973
         AL    @01,@CF01674                                        0973
         TM    CURX1Z0(@01),B'00100000'                            0973
         BNZ   @RF00973                                            0973
@RT00973 DS    0H                                                  0974
*                   DO;             /*                       @Z40LB25*/
*                     YSQC(3)=YSQC(3)×YY2;/*                 @Z40LB25*/
         L     @15,RDCKPTR                                         0975
         ICM   @14,15,YSQC+8(@15)                                  0975
         OR    @14,YY2                                             0975
         STCM  @14,15,YSQC+8(@15)                                  0975
*                     CHECKFLG=ON;  /*                       @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                0976
*                   END;            /*                       @Z40LB25*/
*               IF X1Z12(BYTINDX2)=ON THEN                         0978
@RF00973 DS    0H                                                  0978
@RF00972 LR    @01,CUBEPTR2                                        0978
         ALR   @01,BYTINDX2                                        0978
         AL    @01,@CF01674                                        0978
         TM    X1Z12(@01),B'00010000'                              0978
         BNO   @RF00978                                            0978
*                 IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&CURX1Z1(
*                     BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&CURX1Z1(BYTINDX2
*                     )=OFF THEN                                   0979
         SLR   @15,@15                                             0979
         L     @14,@PC00001+4                                      0979
         C     @15,FDTPTR+20(,@14)                                 0979
         BNE   @RT00979                                            0979
         C     @15,FDTPTR+16(,@14)                                 0979
         BE    @GL00053                                            0979
         LR    @01,CURCBPTR                                        0979
         ALR   @01,BYTINDX2                                        0979
         AL    @01,@CF01674                                        0979
         TM    CURX1Z1(@01),B'00010000'                            0979
         BO    @RT00979                                            0979
@GL00053 L     @15,@PC00001+4                                      0979
         L     @15,FDTPTR+12(,@15)                                 0979
         LTR   @15,@15                                             0979
         BZ    @RF00979                                            0979
         LR    @01,CURCBPTR                                        0979
         ALR   @01,BYTINDX2                                        0979
         AL    @01,@CF01674                                        0979
         TM    CURX1Z1(@01),B'00010000'                            0979
         BNZ   @RF00979                                            0979
@RT00979 DS    0H                                                  0980
*                   DO;             /*                       @Z40LB25*/
*                     YSQC(4)=YSQC(4)×YY2;/*                 @Z40LB25*/
         L     @15,RDCKPTR                                         0981
         ICM   @14,15,YSQC+12(@15)                                 0981
         OR    @14,YY2                                             0981
         STCM  @14,15,YSQC+12(@15)                                 0981
*                     CHECKFLG=ON;  /*                       @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                0982
*                   END;            /*                       @Z40LB25*/
*             END;                  /*                       @Z40LB25*/
@RF00979 DS    0H                                                  0984
@RF00978 DS    0H                                                  0985
*           TEMPX2=TEMPX2+1;        /*                       @Z40LB25*/
*                                                                  0985
@RF00970 AL    TEMPX2,@CF00224                                     0985
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR THE LAST BLOCK                      @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0986
*           IF BLKINDX2^=BLKNUM THEN                               0986
         CLC   BLKINDX2(2),@CH00047                                0986
         BE    @RF00986                                            0986
*             DO;                   /*                       @Z40LB25*/
*                                                                  0987
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK FOR X+2                             @Z40LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0988
*               IF X2+TEMPX2=>MSFLOWX THEN                         0988
         LR    @15,TEMPX2                                          0988
         AH    @15,X2                                              0988
         C     @15,MSFLOWX                                         0988
         BL    @RF00988                                            0988
*                 DO;               /*                       @Z40LB25*/
*                   IF X2Z02(BYTINDX2)=ON THEN                     0990
         LR    @01,CUBEPTR2                                        0990
         ALR   @01,BYTINDX2                                        0990
         AL    @01,@CF01674                                        0990
         TM    X2Z02(@01),B'00001000'                              0990
         BNO   @RF00990                                            0990
*                     IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&
*                         CURX2Z0(BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&
*                         CURX2Z0(BYTINDX2)=OFF THEN               0991
         SLR   @15,@15                                             0991
         L     @14,@PC00001+4                                      0991
         C     @15,FDTPTR+20(,@14)                                 0991
         BNE   @RT00991                                            0991
         C     @15,FDTPTR+16(,@14)                                 0991
         BE    @GL00057                                            0991
         LR    @01,CURCBPTR                                        0991
         ALR   @01,BYTINDX2                                        0991
         AL    @01,@CF01674                                        0991
         TM    CURX2Z0(@01),B'00001000'                            0991
         BO    @RT00991                                            0991
@GL00057 L     @15,@PC00001+4                                      0991
         L     @15,FDTPTR+12(,@15)                                 0991
         LTR   @15,@15                                             0991
         BZ    @RF00991                                            0991
         LR    @01,CURCBPTR                                        0991
         ALR   @01,BYTINDX2                                        0991
         AL    @01,@CF01674                                        0991
         TM    CURX2Z0(@01),B'00001000'                            0991
         BNZ   @RF00991                                            0991
@RT00991 DS    0H                                                  0992
*                       DO;         /*                       @Z40LB25*/
*                         YSQC(5)=YSQC(5)×YY2;/*             @Z40LB25*/
         L     @15,RDCKPTR                                         0993
         ICM   @14,15,YSQC+16(@15)                                 0993
         OR    @14,YY2                                             0993
         STCM  @14,15,YSQC+16(@15)                                 0993
*                         CHECKFLG=ON;/*                     @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                0994
*                       END;        /*                       @Z40LB25*/
*                   IF X2Z12(BYTINDX2)=ON THEN                     0996
@RF00991 DS    0H                                                  0996
@RF00990 LR    @01,CUBEPTR2                                        0996
         ALR   @01,BYTINDX2                                        0996
         AL    @01,@CF01674                                        0996
         TM    X2Z12(@01),B'00000100'                              0996
         BNO   @RF00996                                            0996
*                     IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&
*                         CURX2Z1(BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&
*                         CURX2Z1(BYTINDX2)=OFF THEN               0997
         SLR   @15,@15                                             0997
         L     @14,@PC00001+4                                      0997
         C     @15,FDTPTR+20(,@14)                                 0997
         BNE   @RT00997                                            0997
         C     @15,FDTPTR+16(,@14)                                 0997
         BE    @GL00061                                            0997
         LR    @01,CURCBPTR                                        0997
         ALR   @01,BYTINDX2                                        0997
         AL    @01,@CF01674                                        0997
         TM    CURX2Z1(@01),B'00000100'                            0997
         BO    @RT00997                                            0997
@GL00061 L     @15,@PC00001+4                                      0997
         L     @15,FDTPTR+12(,@15)                                 0997
         LTR   @15,@15                                             0997
         BZ    @RF00997                                            0997
         LR    @01,CURCBPTR                                        0997
         ALR   @01,BYTINDX2                                        0997
         AL    @01,@CF01674                                        0997
         TM    CURX2Z1(@01),B'00000100'                            0997
         BNZ   @RF00997                                            0997
@RT00997 DS    0H                                                  0998
*                       DO;         /*                       @Z40LB25*/
*                         YSQC(6)=YSQC(6)×YY2;/*             @Z40LB25*/
         L     @15,RDCKPTR                                         0999
         ICM   @14,15,YSQC+20(@15)                                 0999
         OR    @14,YY2                                             0999
         STCM  @14,15,YSQC+20(@15)                                 0999
*                         CHECKFLG=ON;/*                     @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                1000
*                       END;        /*                       @Z40LB25*/
*                 END;              /*                       @Z40LB25*/
@RF00997 DS    0H                                                  1002
@RF00996 DS    0H                                                  1003
*               TEMPX2=TEMPX2+1;    /*                       @Z40LB25*/
*                                                                  1003
@RF00988 AL    TEMPX2,@CF00224                                     1003
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK FOR X+3                             @Z40LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1004
*               IF X2+TEMPX2=>MSFLOWX THEN                         1004
         LR    @15,TEMPX2                                          1004
         AH    @15,X2                                              1004
         C     @15,MSFLOWX                                         1004
         BL    @RF01004                                            1004
*                 DO;               /*                       @Z40LB25*/
*                   IF X3Z02(BYTINDX2)=ON THEN                     1006
         LR    @05,CUBEPTR2                                        1006
         ALR   @05,BYTINDX2                                        1006
         AL    @05,@CF01674                                        1006
         TM    X3Z02(@05),B'00000010'                              1006
         BNO   @RF01006                                            1006
*                     IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&
*                         CURX3Z0(BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&
*                         CURX3Z0(BYTINDX2)=OFF THEN               1007
         SLR   @05,@05                                             1007
         L     @15,@PC00001+4                                      1007
         C     @05,FDTPTR+20(,@15)                                 1007
         BNE   @RT01007                                            1007
         C     @05,FDTPTR+16(,@15)                                 1007
         BE    @GL00065                                            1007
         LR    @05,CURCBPTR                                        1007
         ALR   @05,BYTINDX2                                        1007
         AL    @05,@CF01674                                        1007
         TM    CURX3Z0(@05),B'00000010'                            1007
         BO    @RT01007                                            1007
@GL00065 L     @05,@PC00001+4                                      1007
         L     @05,FDTPTR+12(,@05)                                 1007
         LTR   @05,@05                                             1007
         BZ    @RF01007                                            1007
         LR    @05,CURCBPTR                                        1007
         ALR   @05,BYTINDX2                                        1007
         AL    @05,@CF01674                                        1007
         TM    CURX3Z0(@05),B'00000010'                            1007
         BNZ   @RF01007                                            1007
@RT01007 DS    0H                                                  1008
*                       DO;         /*                       @Z40LB25*/
*                         YSQC(7)=YSQC(7)×YY2;/*             @Z40LB25*/
         L     @05,RDCKPTR                                         1009
         ICM   @15,15,YSQC+24(@05)                                 1009
         OR    @15,YY2                                             1009
         STCM  @15,15,YSQC+24(@05)                                 1009
*                         CHECKFLG=ON;/*                     @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                1010
*                       END;        /*                       @Z40LB25*/
*                   IF X3Z12(BYTINDX2)=ON THEN                     1012
@RF01007 DS    0H                                                  1012
@RF01006 LR    @05,CUBEPTR2                                        1012
         ALR   @05,BYTINDX2                                        1012
         AL    @05,@CF01674                                        1012
         TM    X3Z12(@05),B'00000001'                              1012
         BNO   @RF01012                                            1012
*                     IF ADDR(CHALL)^=NULLPTR×ADDR(EMPTY)^=NULLPTR&
*                         CURX3Z1(BYTINDX2)=ON×ADDR(FULL)^=NULLPTR&
*                         CURX3Z1(BYTINDX2)=OFF THEN               1013
         SLR   @05,@05                                             1013
         L     @15,@PC00001+4                                      1013
         C     @05,FDTPTR+20(,@15)                                 1013
         BNE   @RT01013                                            1013
         C     @05,FDTPTR+16(,@15)                                 1013
         BE    @GL00069                                            1013
         LR    @05,CURCBPTR                                        1013
         ALR   @05,BYTINDX2                                        1013
         AL    @05,@CF01674                                        1013
         TM    CURX3Z1(@05),B'00000001'                            1013
         BO    @RT01013                                            1013
@GL00069 L     @05,@PC00001+4                                      1013
         L     @05,FDTPTR+12(,@05)                                 1013
         LTR   @05,@05                                             1013
         BZ    @RF01013                                            1013
         LR    @05,CURCBPTR                                        1013
         ALR   @05,BYTINDX2                                        1013
         AL    @05,@CF01674                                        1013
         TM    CURX3Z1(@05),B'00000001'                            1013
         BNZ   @RF01013                                            1013
@RT01013 DS    0H                                                  1014
*                       DO;         /*                       @Z40LB25*/
*                         YSQC(8)=YSQC(8)×YY2;/*             @Z40LB25*/
         L     @05,RDCKPTR                                         1015
         ICM   @15,15,YSQC+28(@05)                                 1015
         OR    @15,YY2                                             1015
         STCM  @15,15,YSQC+28(@05)                                 1015
*                         CHECKFLG=ON;/*                     @Z40LB25*/
         OI    CHECKFLG,B'00000010'                                1016
*                       END;        /*                       @Z40LB25*/
*                 END;              /*                       @Z40LB25*/
@RF01013 DS    0H                                                  1018
@RF01012 DS    0H                                                  1019
*             END;                  /*                       @Z40LB25*/
@RF01004 DS    0H                                                  1020
*           YY2=YY2/2;              /* SHIFT 1 BIT RIGHT     @Z40LB25*/
@RF00986 SRL   YY2,1                                               1020
*         END;                      /*                       @Z40LB25*/
         AL    BYTINDX2,@CF00224                                   1021
         C     BYTINDX2,@CF00047                                   1021
         BNH   @DL00947                                            1021
*         CUBEPTR2=CUBEPTR2+LENGTH(CUBE2);/*                 @Z40LB25*/
         LA    @05,4                                               1022
         ALR   CUBEPTR2,@05                                        1022
*         CURCBPTR=CURCBPTR+LENGTH(CURCUBE);/*               @Z40LB25*/
         ALR   CURCBPTR,@05                                        1023
*       END;                        /*                       @Z40LB25*/
*                                                                  1024
         AL    CUBINDX2,@CF00224                                   1024
         C     CUBINDX2,@CF00663                                   1024
         BNH   @DL00946                                            1024
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF READY TO EXECUTE QCEL                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1025
*       IF SETX=ON&CHECKFLG=ON THEN                                1025
         TM    SETX,B'10000000'                                    1025
         BNO   @RF01025                                            1025
         TM    CHECKFLG,B'00000010'                                1025
         BNO   @RF01025                                            1025
*         DO;                       /*                       @Z40LB25*/
*           SETX=OFF;               /* ALLOW SET OF NXT X    @Z40LB25*/
*                                                                  1027
         NI    SETX,B'01111111'                                    1027
*           /*********************************************************/
*           /*                                                       */
*           /* REVERSE THE BITS OF EVERY OTHER WORD IN CMAP  @Z40LB25*/
*           /* STARTING WITH THE SECOND WORD. THEY ARE 0 - 27        */
*           /*                                               @Z40LB25*/
*           /* AND SHOULD BE 27 - 0.                         @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1028
*           RESPECIFY                                              1028
*            (REG6,                                                1028
*             REG7) RSTD;           /*                       @Z40LB25*/
*           DO I=2 TO 8 BY 2;       /*                       @Z40LB25*/
         LA    I,2                                                 1029
@DL01029 DS    0H                                                  1030
*             REVRBIT=REVRMASK;     /*                       @Z40LB25*/
         L     REVRBIT,REVRMASK                                    1030
*             REVRESLT=''B;         /*                       @Z40LB25*/
         SLR   REVRESLT,REVRESLT                                   1031
*             REG7=YSQC(I);         /*                       @Z40LB25*/
         LR    @03,I                                               1032
         SLA   @03,2                                               1032
         L     @01,RDCKPTR                                         1032
         ALR   @01,@03                                             1032
         ICM   REG7,15,YSQC-4(@01)                                 1032
*             DO WHILE REVRBIT^=0;  /*                       @Z40LB25*/
         B     @DE01033                                            1033
@DL01033 DS    0H                                                  1034
*               REG6=NULLPTR;       /*                       @Z40LB25*/
         SLR   REG6,REG6                                           1034
*               SLDL(REG6,1);       /*                       @Z40LB25*/
         SLDL  REG6,1                                              1035
*               IF REG6=1 THEN                                     1036
         C     REG6,@CF00224                                       1036
         BNE   @RF01036                                            1036
*                 REVRESLT=REVRESLT×REVRBIT;/*               @Z40LB25*/
         OR    REVRESLT,REVRBIT                                    1037
*               REVRBIT=REVRBIT*2;  /* SHIFT 1 BIT           @Z40LB25*/
@RF01036 ALR   REVRBIT,REVRBIT                                     1038
*             END;                  /*                       @Z40LB25*/
@DE01033 LTR   REVRBIT,REVRBIT                                     1039
         BNZ   @DL01033                                            1039
*             YSQC(I)=REVRESLT;     /*                       @Z40LB25*/
         LR    @15,I                                               1040
         SLA   @15,2                                               1040
         L     @01,RDCKPTR                                         1040
         ALR   @01,@15                                             1040
         STCM  REVRESLT,15,YSQC-4(@01)                             1040
*           END;                    /*                       @Z40LB25*/
         AL    I,@CF00158                                          1041
         C     I,@CF00184                                          1041
         BNH   @DL01029                                            1041
*           RESPECIFY                                              1042
*            (REG6,                                                1042
*             REG7) UNRSTD;         /*                       @Z40LB25*/
*                                                                  1042
*           /*********************************************************/
*           /*                                                       */
*           /* DUMP THE ICBQUERY (QCEL) PARM LIST            @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1043
*           IF GDTDBG=NULLPTR THEN                                 1043
         L     @15,@PC00001                                        1043
         L     @15,GDTDBG(,@15)                                    1043
         LTR   @15,@15                                             1043
         BZ    @RT01043                                            1043
*             ;                                                    1044
*           ELSE                                                   1045
*             DO;                                                  1045
*               DMPINDEX=ADDR(DMPSTG);/*                     @Z40LB25*/
         LA    DMPINDEX,DMPSTG                                     1046
*               DMPITMNM='QURYAREA';                               1047
         MVC   DMPITMNM(8,DMPINDEX),@CC01579                       1047
*               DMPITMPT=ADDR(QURYAREA);                           1048
         LA    @03,QURYAREA                                        1048
         ST    @03,DMPITMPT(,DMPINDEX)                             1048
*               DMPITMLN=LENGTH(QURYAREA);                         1049
         MVC   DMPITMLN(2,DMPINDEX),@CH00813                       1049
*               DMPITMTP='H';                                      1050
         MVI   DMPITMTP(DMPINDEX),C'H'                             1050
*               DMPINDEX=DMPINDEX+DMPELEMT;/*                @Z40LB25*/
         AL    DMPINDEX,@CF00479                                   1051
*               DMPTRM=DMPTRMVL;                                   1052
         MVI   DMPTRM(DMPINDEX),X'FF'                              1052
*             END;                  /*                       @Z40LB25*/
*           IF GDTDBG=NULLPTR THEN                                 1054
@RT01043 L     @15,@PC00001                                        1054
         L     @15,GDTDBG(,@15)                                    1054
         LTR   @15,@15                                             1054
         BZ    @RT01054                                            1054
*             ;                                                    1055
*           ELSE                                                   1056
*             CALL IDCDB010(GDTTBL,'AUCB',ADDR(DMPSTG));/*   @Z40LB25*/
*                                                                  1056
         L     @15,@PC00001                                        1056
         ST    @15,@AL00001                                        1056
         LA    @14,@CC01581                                        1056
         ST    @14,@AL00001+4                                      1056
         LA    @14,DMPSTG                                          1056
         ST    @14,@AFTEMPS                                        1056
         LA    @14,@AFTEMPS                                        1056
         ST    @14,@AL00001+8                                      1056
         MVI   @AL00001+8,X'80'                                    1056
         L     @15,GDTDBG(,@15)                                    1056
         LA    @01,@AL00001                                        1056
         BALR  @14,@15                                             1056
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE USSC TO EXEC QCEL                       @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1057
*           CALL IDCSASS0(GDTTBL,AUDITCEL,RDCKPTR,REASONCD);/*     1057
*                                                            @Z40LB25*/
@RT01054 L     @02,@PC00001                                        1057
         ST    @02,@AL00001                                        1057
         LA    @15,AUDITCEL                                        1057
         ST    @15,@AL00001+4                                      1057
         LA    @15,RDCKPTR                                         1057
         ST    @15,@AL00001+8                                      1057
         LA    @15,REASONCD                                        1057
         ST    @15,@AL00001+12                                     1057
         MVI   @AL00001+12,X'80'                                   1057
         L     @15,GDTSSC(,@02)                                    1057
         LA    @01,@AL00001                                        1057
         BALR  @14,@15                                             1057
*           RESPECIFY                                              1058
*             RTNREG RSTD;                                         1058
*           TESTRC=RTNREG;                                         1059
         LR    TESTRC,RTNREG                                       1059
*           RESPECIFY                                              1060
*             RTNREG UNRSTD;        /*                       @Z40LB25*/
*                                                                  1060
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR HARDWARE ERROR                       @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1061
*           IF TESTRC=4 THEN                                       1061
         C     TESTRC,@CF00047                                     1061
         BNE   @RF01061                                            1061
*             CALL SSCMSG(REASONCD);/*                       @Z40LB25*/
*                                                                  1062
         LA    @02,REASONCD                                        1062
         ST    @02,@AL00001                                        1062
         LA    @01,@AL00001                                        1062
         BAL   @14,SSCMSG                                          1062
*           /*********************************************************/
*           /*                                                       */
*           /* IF ERROR SET CONDITION CODE AND END           @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1063
*           IF TESTRC=4 THEN                                       1063
@RF01061 C     TESTRC,@CF00047                                     1063
         BNE   @RF01063                                            1063
*             DO;                   /*                       @Z40LB25*/
*               IF FRSTUSSC=OFF THEN                               1065
         TM    FRSTUSSC,B'00000001'                                1065
         BNZ   @RF01065                                            1065
*                 CHECKRC=LASTCC12; /*                       @Z40LB25*/
         MVC   CHECKRC(2),@CH00571                                 1066
*               ELSE                                               1067
*                 CHECKRC=LASTCC08; /*                       @Z40LB25*/
         B     @RC01065                                            1067
@RF01065 MVC   CHECKRC(2),@CH00184                                 1067
*               RETURN;             /*                       @Z40LB25*/
@EL00009 DS    0H                                                  1068
@EF00009 DS    0H                                                  1068
@ER00009 L     @14,@SA00009                                        1068
         BR    @14                                                 1068
*             END;                  /*                       @Z40LB25*/
*                                                                  1069
*           /*********************************************************/
*           /*                                                       */
*           /* USSC CALLED ONCE SUCCESSFULLY                 @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1070
*           FRSTUSSC=ON;            /*                       @Z40LB25*/
*                                                                  1070
@RF01063 OI    FRSTUSSC,B'00000001'                                1070
*           /*********************************************************/
*           /*                                                       */
*           /* COMPARE RETURNED CELL STATUS                  @Z40LB25*/
*           /* WITH THE CURRENT MSC CELL MAP                 @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1071
*           CALL CHKXYZ12;          /*                       @Z40LB25*/
         BAL   @14,CHKXYZ12                                        1071
*           QCPARM=''B;             /* ZERO CHECK XYZS       @Z40LB25*/
         L     @01,RDCKPTR                                         1072
         XC    QCPARM(32,@01),QCPARM(@01)                          1072
*         END;                      /*                       @Z40LB25*/
*                                                                  1073
*       /*************************************************************/
*       /*                                                           */
*       /* IF AT THE LAST BLOCK, IT WILL CONTAIN             @Z40LB25*/
*       /* ONLY ONE CHUNK                                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1074
*       IF BLKINDX2=BLKNUM THEN                                    1074
@RF01025 CLC   BLKINDX2(2),@CH00047                                1074
         BNE   @RF01074                                            1074
*         CHKINDX2=CHUNKNUM;        /*                       @Z40LB25*/
         MVC   CHKINDX2(2),@CH00184                                1075
*       CHUNKPT2=CHUNKPT2+LENGTH(CHUNK2);/*                  @Z40LB25*/
@RF01074 LA    @02,32                                              1076
         L     @15,CHUNKPT2                                        1076
         ALR   @15,@02                                             1076
         ST    @15,CHUNKPT2                                        1076
*       CURCKPTR=CURCKPTR+LENGTH(CURCK);/*                   @Z40LB25*/
         AL    @02,CURCKPTR                                        1077
         ST    @02,CURCKPTR                                        1077
*       X2=X2+4;                    /*                       @Z40LB25*/
         LA    @02,4                                               1078
         AH    @02,X2                                              1078
         STH   @02,X2                                              1078
*       YY2=ONEYMASK;               /*                       @Z40LB25*/
         L     YY2,ONEYMASK                                        1079
*       CHECKFLG=OFF;               /*                       @Z40LB25*/
         NI    CHECKFLG,B'11111101'                                1080
*       SETX=OFF;                   /*                       @Z40LB25*/
         NI    SETX,B'01111111'                                    1081
*     END;                          /*                       @Z40LB25*/
         LA    @02,1                                               1082
         AH    @02,CHKINDX2                                        1082
         STH   @02,CHKINDX2                                        1082
         C     @02,@CF00184                                        1082
         BNH   @DL00943                                            1082
*     CELLPTR2=CELLPTR2+BLKSIZE;    /*                       @Z40LB25*/
         LA    @02,264                                             1083
         L     @15,CELLPTR2                                        1083
         ALR   @15,@02                                             1083
         ST    @15,CELLPTR2                                        1083
*     CURCLPTR=CURCLPTR+BLKSIZE;    /*                       @Z40LB25*/
         AL    @02,CURCLPTR                                        1084
         ST    @02,CURCLPTR                                        1084
*   END;                            /*                       @Z40LB25*/
         LA    @02,1                                               1085
         AH    @02,BLKINDX2                                        1085
         STH   @02,BLKINDX2                                        1085
         C     @02,@CF00047                                        1085
         BNH   @DL00940                                            1085
*   RETURN;                         /*                       @Z40LB25*/
         B     @EL00009                                            1086
*   END CKCELL;                     /*                       @Z40LB25*/
         B     @EL00009                                            1087
*                                                                  1088
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CHKXYZ12                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - COMPARES THE CELL STATUS RETURNED BY       @Z40LB25*/
*   /* QCEL WITH WHAT THE MSC CURRENT CELL MAP INDICATES.    @Z40LB25*/
*   /* IF A DESCREPANCY IS FOUND ITS XYZ IS CALCULATED       @Z40LB25*/
*   /* AND THE REPORT TABLE, XYZ1 OR XYZ2, IS UPDATED.       @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* DIAGBUF (CELLPARM)                                    @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* CHUNKPTR                                              @Z40LB25*/
*   /* CELLPTR                                               @Z40LB25*/
*   /* X                                                     @Z40LB25*/
*   /* Y                                                     @Z40LB25*/
*   /* Z                                                     @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1088
*CHKXYZ12:                                                         1088
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  1088
CHKXYZ12 ST    @14,@SA00010                                        1088
*   /*****************************************************************/
*   /*                                                               */
*   /* REVERSE THE BITS IN EVERY OTHER WORD OF QCPARM        @Z40LB25*/
*   /* AND RECDBUF STARTING WITH THE SECOND WORD.            @Z40LB25*/
*   /* THEY ARE 27 - 0 AND SHOULD BE 0 - 27.                 @Z40LB25*/
*   /* CQPARM IS THE INPUT TO ICBQUERY QCEL AND              @Z40LB25*/
*   /* RECDBUF IS THE OUTPUT FROM QCEL.                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1089
*   RESPECIFY                                                      1089
*    (REG6,                                                        1089
*     REG7) RSTD;                   /*                       @Z40LB25*/
*                                                                  1089
*   /*****************************************************************/
*   /*                                                               */
*   /* EIGHT WORD PARM LISTS                                 @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1090
*   DO I=2 TO 8 BY 2;               /*                       @Z40LB25*/
*                                                                  1090
         LA    I,2                                                 1090
@DL01090 DS    0H                                                  1091
*     /***************************************************************/
*     /*                                                             */
*     /* 1 = INPUT TO QCEL AND 2 = OUTPUT FROM QCEL          @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1091
*     DO II=1 TO 2;                 /*                       @Z40LB25*/
         LA    II,1                                                1091
@DL01091 DS    0H                                                  1092
*       IF II=1 THEN                /* CQPARM                @Z40LB25*/
         C     II,@CF00224                                         1092
         BNE   @RF01092                                            1092
*         REG7=YSQC(I);             /* INPUT                 @Z40LB25*/
         LR    @05,I                                               1093
         SLA   @05,2                                               1093
         L     @02,RDCKPTR                                         1093
         ALR   @02,@05                                             1093
         ICM   REG7,15,YSQC-4(@02)                                 1093
*       ELSE                        /* RECDBUF               @Z40LB25*/
*         REG7=CKYS(I);             /* OUTPUT                @Z40LB25*/
         B     @RC01092                                            1094
@RF01092 LR    @05,I                                               1094
         SLA   @05,2                                               1094
         L     @02,@PC00001+8                                      1094
         L     @02,BLKPTR(,@02)                                    1094
         ALR   @02,@05                                             1094
         ICM   REG7,15,CKYS-4(@02)                                 1094
*       REVRBIT=REVRMASK;           /*                       @Z40LB25*/
@RC01092 L     REVRBIT,REVRMASK                                    1095
*       REVRESLT=''B;               /*                       @Z40LB25*/
         SLR   REVRESLT,REVRESLT                                   1096
*       DO WHILE REVRBIT^=0;        /*                       @Z40LB25*/
         B     @DE01097                                            1097
@DL01097 DS    0H                                                  1098
*         REG6=NULLPTR;             /*                       @Z40LB25*/
         SLR   REG6,REG6                                           1098
*         SLDL(REG6,1);             /*                       @Z40LB25*/
         SLDL  REG6,1                                              1099
*         IF REG6=1 THEN                                           1100
         C     REG6,@CF00224                                       1100
         BNE   @RF01100                                            1100
*           REVRESLT=REVRESLT×REVRBIT;/*                     @Z40LB25*/
         OR    REVRESLT,REVRBIT                                    1101
*         REVRBIT=REVRBIT*2;        /* SHIFT 1 BIT           @Z40LB25*/
@RF01100 ALR   REVRBIT,REVRBIT                                     1102
*       END;                        /*                       @Z40LB25*/
@DE01097 LTR   REVRBIT,REVRBIT                                     1103
         BNZ   @DL01097                                            1103
*       IF II=1 THEN                /* CQPARM                @Z40LB25*/
         C     II,@CF00224                                         1104
         BNE   @RF01104                                            1104
*         YSQC(I)=REVRESLT;         /*                       @Z40LB25*/
         LR    @02,I                                               1105
         SLA   @02,2                                               1105
         L     @01,RDCKPTR                                         1105
         ALR   @01,@02                                             1105
         STCM  REVRESLT,15,YSQC-4(@01)                             1105
*       ELSE                        /* RECDBUF               @Z40LB25*/
*         CKYS(I)=REVRESLT;         /*                       @Z40LB25*/
         B     @RC01104                                            1106
@RF01104 LR    @02,I                                               1106
         SLA   @02,2                                               1106
         L     @15,@PC00001+8                                      1106
         L     @01,BLKPTR(,@15)                                    1106
         ALR   @01,@02                                             1106
         STCM  REVRESLT,15,CKYS-4(@01)                             1106
*     END;                          /*                       @Z40LB25*/
@RC01104 AL    II,@CF00224                                         1107
         C     II,@CF00158                                         1107
         BNH   @DL01091                                            1107
*   END;                            /*                       @Z40LB25*/
         AL    I,@CF00158                                          1108
         C     I,@CF00184                                          1108
         BNH   @DL01090                                            1108
*   RESPECIFY                                                      1109
*    (REG6,                                                        1109
*     REG7) UNRSTD;                 /*                       @Z40LB25*/
*                                                                  1109
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD TEMPQCEL TO REFLECT DISCREPANCIES BETWEEN       @Z40LB25*/
*   /* THE QCEL RETURNED INFO AND THE MSC CURRENT CELL MAP   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1110
*   IF ADDR(FULL)^=NULLPTR THEN     /* CHECK FOR FULL        @Z40LB25*/
         L     @15,@PC00001+4                                      1110
         L     @15,FDTPTR+12(,@15)                                 1110
         LTR   @15,@15                                             1110
         BZ    @RF01110                                            1110
*     DO I=1 TO 8;                  /*                       @Z40LB25*/
         LA    I,1                                                 1111
@DL01111 DS    0H                                                  1112
*       TEMPQCEL(I)=CKYS(I)&YSQC(I);/*                       @Z40LB25*/
         LR    @05,I                                               1112
         SLA   @05,2                                               1112
         LA    @01,TEMPQCEL-4(@05)                                 1112
         L     @15,@PC00001+8                                      1112
         L     @15,BLKPTR(,@15)                                    1112
         ALR   @15,@05                                             1112
         MVC   0(4,@01),CKYS-4(@15)                                1112
         L     @15,RDCKPTR                                         1112
         ALR   @15,@05                                             1112
         NC    0(4,@01),YSQC-4(@15)                                1112
*     END;                          /*                       @Z40LB25*/
         AL    I,@CF00224                                          1113
         C     I,@CF00184                                          1113
         BNH   @DL01111                                            1113
*   IF ADDR(EMPTY)^=NULLPTR THEN    /* CHECK FOR EMPTY       @Z40LB25*/
@RF01110 L     @15,@PC00001+4                                      1114
         L     @15,FDTPTR+16(,@15)                                 1114
         LTR   @15,@15                                             1114
         BZ    @RF01114                                            1114
*     DO I=1 TO 8;                  /*                       @Z40LB25*/
         LA    I,1                                                 1115
@DL01115 DS    0H                                                  1116
*       TEMPQCEL(I)=CKYS(I)&&YSQC(I);/*                      @Z40LB25*/
         LR    @05,I                                               1116
         SLA   @05,2                                               1116
         LA    @01,TEMPQCEL-4(@05)                                 1116
         L     @15,@PC00001+8                                      1116
         L     @15,BLKPTR(,@15)                                    1116
         ALR   @15,@05                                             1116
         MVC   0(4,@01),CKYS-4(@15)                                1116
         L     @15,RDCKPTR                                         1116
         ALR   @15,@05                                             1116
         XC    0(4,@01),YSQC-4(@15)                                1116
*     END;                          /*                       @Z40LB25*/
         AL    I,@CF00224                                          1117
         C     I,@CF00184                                          1117
         BNH   @DL01115                                            1117
*   IF ADDR(CHALL)^=NULLPTR THEN    /* CHECK FOR ALL         @Z40LB25*/
@RF01114 L     @15,@PC00001+4                                      1118
         L     @15,FDTPTR+20(,@15)                                 1118
         LTR   @15,@15                                             1118
         BZ    @RF01118                                            1118
*     DO I=1 TO 8;                  /*                       @Z40LB25*/
         LA    I,1                                                 1119
@DL01119 DS    0H                                                  1120
*       TEMPQCEL(I)=YSQC(I);        /*                       @Z40LB25*/
         LR    @05,I                                               1120
         SLA   @05,2                                               1120
         LA    @01,TEMPQCEL-4(@05)                                 1120
         L     @15,RDCKPTR                                         1120
         ALR   @15,@05                                             1120
         MVC   0(4,@01),YSQC-4(@15)                                1120
*     END;                          /*                       @Z40LB25*/
*                                                                  1121
         AL    I,@CF00224                                          1121
         C     I,@CF00184                                          1121
         BNH   @DL01119                                            1121
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPARE QCEL OUTPUT (CKYS) WITH THE CONTENTS          @Z40LB25*/
*   /* OF TEMPQCEL. AN ON BIT IN CKYS WHICH HAS              @Z40LB25*/
*   /* A CORRESPONDING ON BIT IN TEMPQCEL MEANS              @Z40LB25*/
*   /* THE XYZ OF THE BIT IN TEMPQCEL WILL                   @Z40LB25*/
*   /* BE DETERMINED AND THE BIT IN XYZ1 WORK                @Z40LB25*/
*   /* AREA WHICH CORRESPONDS TO THE XYZ IS SET ON.          @Z40LB25*/
*   /* AN OFF BIT IN CKYS WHICH HAS A CORRESPONDING          @Z40LB25*/
*   /* ON BIT IN TEMPQCEL MEANS THE XYZ OF THE ON BIT        @Z40LB25*/
*   /* IN TEMPQCEL WILL BE DETERMINED AND THE BIT            @Z40LB25*/
*   /* IN XYZ2 WORK AREA WHICH CORRESPONDS TO THE            @Z40LB25*/
*   /* XYZ IS SET ON.                                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1122
*   X1=QUXADDR;                     /* SET X                 @Z40LB25*/
*                                                                  1122
@RF01118 L     @01,RDCKPTR                                         1122
         SLR   @00,@00                                             1122
         IC    @00,QUXADDR(,@01)                                   1122
         STH   @00,X1                                              1122
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN THE X WORDS                                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1123
*   DO XWRDINDX=1 TO 8;             /*                       @Z40LB25*/
         LA    @15,1                                               1123
         STH   @15,XWRDINDX                                        1123
@DL01123 DS    0H                                                  1124
*     Y1=0;                         /*                       @Z40LB25*/
         SLR   @14,@14                                             1124
         STH   @14,Y1                                              1124
*     IF(XWRDINDX=1×XWRDINDX=3×XWRDINDX=5×XWRDINDX=7) THEN         1125
         C     @15,@CF00224                                        1125
         BE    @RT01125                                            1125
         C     @15,@CF00167                                        1125
         BE    @RT01125                                            1125
         C     @15,@CF00291                                        1125
         BE    @RT01125                                            1125
         C     @15,@CF00663                                        1125
         BNE   @RF01125                                            1125
@RT01125 DS    0H                                                  1126
*       Z=0;                        /*                       @Z40LB25*/
         SLR   @15,@15                                             1126
         STH   @15,Z                                               1126
*     ELSE                                                         1127
*       Z=1;                        /*                       @Z40LB25*/
         B     @RC01125                                            1127
@RF01125 MVC   Z(2),@CH00224                                       1127
*     IF(XWRDINDX=3×XWRDINDX=5×XWRDINDX=7) THEN                    1128
@RC01125 LH    @15,XWRDINDX                                        1128
         C     @15,@CF00167                                        1128
         BE    @RT01128                                            1128
         C     @15,@CF00291                                        1128
         BE    @RT01128                                            1128
         C     @15,@CF00663                                        1128
         BNE   @RF01128                                            1128
@RT01128 DS    0H                                                  1129
*       X1=X1+1;                    /*                       @Z40LB25*/
*                                                                  1129
         LA    @15,1                                               1129
         AH    @15,X1                                              1129
         STH   @15,X1                                              1129
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN EACH BYTE OF THE X WORD                        @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1130
*     DO BYTEINDX=1 TO 4;           /*                       @Z40LB25*/
@RF01128 LA    @15,1                                               1130
         STH   @15,BYTEINDX                                        1130
@DL01130 DS    0H                                                  1131
*       BITMASK=ONEBIT;             /*                       @Z40LB25*/
*                                                                  1131
         MVC   BITMASK(1),ONEBIT                                   1131
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN THE BITS OF EACH BYTE FOR A Y BIT            @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1132
*       DO YBITINDX=1 TO 8;         /*                       @Z40LB25*/
*                                                                  1132
         LA    @15,1                                               1132
         STH   @15,YBITINDX                                        1132
@DL01132 DS    0H                                                  1133
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF TEMPQCEL HAS AN XYZ FOR XYZ1           @Z40LB25*/
*         /* WORK AREA                                       @Z40LB25*/
*         /* FOR FULL - CELLS FOUND VACANT MSC INDICATES     @Z40LB25*/
*         /* OCCUPIED                                        @Z40LB25*/
*         /* FOR ALL - CELLS FOUND VACANT                    @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1133
*         IF(CKYS(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)=BITMASK&(   1133
*             TEMPQCEL(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)=BITMASK
*           THEN                                                   1133
         SLR   @15,@15                                             1133
         IC    @15,BITMASK                                         1133
         LH    @14,XWRDINDX                                        1133
         SLA   @14,2                                               1133
         AH    @14,BYTEINDX                                        1133
         L     @07,@PC00001+8                                      1133
         L     @01,BLKPTR(,@07)                                    1133
         SLR   @00,@00                                             1133
         IC    @00,CKYS-5(@14,@01)                                 1133
         NR    @00,@15                                             1133
         CR    @00,@15                                             1133
         BNE   @RF01133                                            1133
         SLR   @07,@07                                             1133
         IC    @07,TEMPQCEL-5(@14)                                 1133
         NR    @07,@15                                             1133
         CR    @07,@15                                             1133
         BNE   @RF01133                                            1133
*           DO;                     /*                       @Z40LB25*/
*             CHUNKPTR=ADDR(XYZ1CUBE(1));/*                  @Z40LB25*/
         L     @15,XYZ1PTR                                         1135
         LA    @14,XYZ1CUBE(,@15)                                  1135
         ST    @14,CHUNKPTR                                        1135
*             CELLPTR=ADDR(XYZ1BLK(1));/*                    @Z40LB25*/
         ST    @15,CELLPTR                                         1136
*             X=X1;                 /*                       @Z40LB25*/
         LH    @15,X1                                              1137
         STH   @15,X                                               1137
*             Y=Y1;                 /*                       @Z40LB25*/
*                                                                  1138
         LH    @15,Y1                                              1138
         ST    @15,Y                                               1138
*             /*******************************************************/
*             /*                                                     */
*             /* CONVERT THE LOCATION TO AN ON BIT IN XYZ1   @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1139
*             CALL LOCTOBIT;        /*                       @Z40LB25*/
         BAL   @14,LOCTOBIT                                        1139
*             PRTXYZ1=ON;           /*                       @Z40LB25*/
         OI    PRTXYZ1,B'01000000'                                 1140
*           END;                    /*                       @Z40LB25*/
*                                                                  1141
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF TEMPQCEL HAS AN XYZ FOR XYZ2           @Z40LB25*/
*         /* WORK AREA                                       @Z40LB25*/
*         /* FOR EMPTY - CELLS FOUND OCCUPIED MSC INDICATES  @Z40LB25*/
*         /* VACANT                                          @Z40LB25*/
*         /* FOR ALL - CELLS FOUND OCCUPIED                  @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1142
*         IF(CKYS(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)^=BITMASK&(  1142
*             TEMPQCEL(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)=BITMASK
*           THEN                                                   1142
@RF01133 SLR   @15,@15                                             1142
         IC    @15,BITMASK                                         1142
         LH    @14,XWRDINDX                                        1142
         SLA   @14,2                                               1142
         AH    @14,BYTEINDX                                        1142
         L     @07,@PC00001+8                                      1142
         L     @01,BLKPTR(,@07)                                    1142
         SLR   @00,@00                                             1142
         IC    @00,CKYS-5(@14,@01)                                 1142
         NR    @00,@15                                             1142
         CR    @00,@15                                             1142
         BE    @RF01142                                            1142
         SLR   @07,@07                                             1142
         IC    @07,TEMPQCEL-5(@14)                                 1142
         NR    @07,@15                                             1142
         CR    @07,@15                                             1142
         BNE   @RF01142                                            1142
*           DO;                     /*                       @Z40LB25*/
*             CHUNKPTR=ADDR(XYZ2CUBE(1));/*                  @Z40LB25*/
         L     @15,XYZ2PTR                                         1144
         LA    @14,XYZ2CUBE(,@15)                                  1144
         ST    @14,CHUNKPTR                                        1144
*             CELLPTR=ADDR(XYZ2BLK(1));/*                    @Z40LB25*/
         ST    @15,CELLPTR                                         1145
*             X=X1;                 /*                       @Z40LB25*/
         LH    @15,X1                                              1146
         STH   @15,X                                               1146
*             Y=Y1;                 /*                       @Z40LB25*/
*                                                                  1147
         LH    @15,Y1                                              1147
         ST    @15,Y                                               1147
*             /*******************************************************/
*             /*                                                     */
*             /* CONVERT THE LOCATION TO AN ON BIT IN XYZ2   @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1148
*             CALL LOCTOBIT;        /*                       @Z40LB25*/
         BAL   @14,LOCTOBIT                                        1148
*             PRTXYZ2=ON;           /*                       @Z40LB25*/
         OI    PRTXYZ2,B'00100000'                                 1149
*           END;                    /*                       @Z40LB25*/
*         SRL(BITMASK,1);           /*                       @Z40LB25*/
@RF01142 SLR   @15,@15                                             1151
         IC    @15,BITMASK                                         1151
         SRL   @15,1                                               1151
         STC   @15,BITMASK                                         1151
*         Y1=Y1+1;                  /*                       @Z40LB25*/
*                                                                  1152
         LA    @15,1                                               1152
         AH    @15,Y1                                              1152
         STH   @15,Y1                                              1152
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR Y=28, LAST Y IN THE X WORD            @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1153
*         IF Y1=YMAX THEN                                          1153
         C     @15,@CF01239                                        1153
         BNE   @RF01153                                            1153
*           YBITINDX=8;             /* END THIS X WORD       @Z40LB25*/
         MVC   YBITINDX(2),@CH00184                                1154
*       END;                        /*                       @Z40LB25*/
@RF01153 LA    @15,1                                               1155
         AH    @15,YBITINDX                                        1155
         STH   @15,YBITINDX                                        1155
         C     @15,@CF00184                                        1155
         BNH   @DL01132                                            1155
*     END;                          /*                       @Z40LB25*/
         LA    @15,1                                               1156
         AH    @15,BYTEINDX                                        1156
         STH   @15,BYTEINDX                                        1156
         C     @15,@CF00047                                        1156
         BNH   @DL01130                                            1156
*   END;                            /*                       @Z40LB25*/
*                                                                  1157
         LA    @15,1                                               1157
         AH    @15,XWRDINDX                                        1157
         STH   @15,XWRDINDX                                        1157
         C     @15,@CF00184                                        1157
         BNH   @DL01123                                            1157
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ALL. COMPARE RESULTS OF QCEL WITH           @Z40LB25*/
*   /* THE CURRENT CELL MAP                                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1158
*   IF ADDR(CHALL)^=NULLPTR THEN                                   1158
         L     @15,@PC00001+4                                      1158
         L     @15,FDTPTR+20(,@15)                                 1158
         LTR   @15,@15                                             1158
         BZ    @RF01158                                            1158
*     DO;                           /*                       @Z40LB25*/
*       PRTXYZ1=OFF;                /*                       @Z40LB25*/
*       PRTXYZ2=OFF;                /*                       @Z40LB25*/
         NI    PRTXYZ1,B'10011111'                                 1161
*       DO I=1 TO 2;                /*                       @Z40LB25*/
         LA    I,1                                                 1162
@DL01162 DS    0H                                                  1163
*         IF I=1 THEN               /* XYZ1 WORK AREA        @Z40LB25*/
         C     I,@CF00224                                          1163
         BNE   @RF01163                                            1163
*           DO;                     /*                       @Z40LB25*/
*                                                                  1164
*             /*******************************************************/
*             /*                                                     */
*             /* SET UP FOR CELLS FOUND                      @Z40LB25*/
*             /* VACANT (MSC TABLES INDICATE OCCUPIED)       @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1165
*             CHUNKPTR=ADDR(XYZ1CUBE(1));/*                  @Z40LB25*/
         L     @05,XYZ1PTR                                         1165
         LA    @15,XYZ1CUBE(,@05)                                  1165
         ST    @15,CHUNKPTR                                        1165
*             CELLPTR=ADDR(XYZ1BLK(1));/*                    @Z40LB25*/
         ST    @05,CELLPTR                                         1166
*           END;                    /*                       @Z40LB25*/
*         ELSE                                                     1168
*           DO;                     /*                       @Z40LB25*/
*                                                                  1168
         B     @RC01163                                            1168
@RF01163 DS    0H                                                  1169
*             /*******************************************************/
*             /*                                                     */
*             /* SET UP FOR CELLS FOUND                      @Z40LB25*/
*             /* OCCUPIED (MSC TABLES INDICATE VACANT)       @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1169
*             CHUNKPTR=ADDR(XYZ2CUBE(1));/*                  @Z40LB25*/
         L     @05,XYZ2PTR                                         1169
         LA    @15,XYZ2CUBE(,@05)                                  1169
         ST    @15,CHUNKPTR                                        1169
*             CELLPTR=ADDR(XYZ2BLK(1));/*                    @Z40LB25*/
         ST    @05,CELLPTR                                         1170
*           END;                    /*                       @Z40LB25*/
*         CURCKPTR=ADDR(CELLCUBE(1));/*                      @Z40LB25*/
@RC01163 L     @05,@PC00001+8                                      1172
         L     @05,BLKPTR(,@05)                                    1172
         LA    @15,CELLCUBE(,@05)                                  1172
         ST    @15,CURCKPTR                                        1172
*         CURCLPTR=ADDR(CELLMAP(1));/*                       @Z40LB25*/
         LA    @05,CELLMAP(,@05)                                   1173
         ST    @05,CURCLPTR                                        1173
*         X=XSTART;                 /* 150                   @Z40LB25*/
*                                                                  1174
         MVC   X(2),@CH01256                                       1174
*         /***********************************************************/
*         /*                                                         */
*         /* SCAN THE FOUR BLOCKS                            @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1175
*         DO BLKINDEX=1 TO BLKNUM;  /*                       @Z40LB25*/
*                                                                  1175
         LA    BLKINDEX,1                                          1175
@DL01175 DS    0H                                                  1176
*           /*********************************************************/
*           /*                                                       */
*           /* SCAN THE CHUNKS OF EACH OF THE BLOCKS         @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1176
*           DO CHKINDEX=1 TO CHUNKNUM;/*                     @Z40LB25*/
         LA    @06,1                                               1176
         STH   @06,CHKINDEX                                        1176
@DL01176 DS    0H                                                  1177
*             CUBEPTR=CHUNKPTR;     /*                       @Z40LB25*/
         L     CUBEPTR,CHUNKPTR                                    1177
*             CURCBPTR=CURCKPTR;    /*                       @Z40LB25*/
*                                                                  1178
         L     CURCBPTR,CURCKPTR                                   1178
*             /*******************************************************/
*             /*                                                     */
*             /* SCAN THE CUBES PER CHUNK                    @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1179
*             DO CUBINDEX=1 TO CUBENUM;/*                    @Z40LB25*/
*                                                                  1179
         LA    @05,1                                               1179
         STH   @05,CUBINDEX                                        1179
@DL01179 DS    0H                                                  1180
*               /*****************************************************/
*               /*                                                   */
*               /* SCAN EACH BIT PER BYTE                    @Z40LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1180
*               DO BYTINDEX=1 TO BYTENUM;/*                  @Z40LB25*/
         LA    BYTINDEX,1                                          1180
@DL01180 DS    0H                                                  1181
*                 TEMPX=''B;        /*                       @Z40LB25*/
*                                                                  1181
         SLR   TEMPX,TEMPX                                         1181
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK X                                 @Z40LB25*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1182
*                 IF X+TEMPX=>MSFLOWX THEN                         1182
         LR    @15,TEMPX                                           1182
         AH    @15,X                                               1182
         C     @15,MSFLOWX                                         1182
         BL    @RF01182                                            1182
*                   DO;             /*                       @Z40LB25*/
*                     IF I=1 THEN                                  1184
         C     I,@CF00224                                          1184
         BNE   @RF01184                                            1184
*                       DO;         /*                       @Z40LB25*/
*                         IF X0Z0(BYTINDEX)=ON THEN                1186
         LR    @01,CUBEPTR                                         1186
         ALR   @01,BYTINDEX                                        1186
         AL    @01,@CF01674                                        1186
         TM    X0Z0(@01),B'10000000'                               1186
         BNO   @RF01186                                            1186
*                           IF CURX0Z0(BYTINDEX)=ON THEN           1187
         LR    @01,CURCBPTR                                        1187
         ALR   @01,BYTINDEX                                        1187
         AL    @01,@CF01674                                        1187
         TM    CURX0Z0(@01),B'10000000'                            1187
         BNO   @RF01187                                            1187
*                             X0Z0(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1188
         ALR   @01,BYTINDEX                                        1188
         AL    @01,@CF01674                                        1188
         NI    X0Z0(@01),B'01111111'                               1188
*                           ELSE                                   1189
*                             PRTXYZ1=ON;/*                  @Z40LB25*/
         B     @RC01187                                            1189
@RF01187 OI    PRTXYZ1,B'01000000'                                 1189
*                         IF X0Z1(BYTINDEX)=ON THEN                1190
@RC01187 DS    0H                                                  1190
@RF01186 LR    @01,CUBEPTR                                         1190
         ALR   @01,BYTINDEX                                        1190
         AL    @01,@CF01674                                        1190
         TM    X0Z1(@01),B'01000000'                               1190
         BNO   @RF01190                                            1190
*                           IF CURX0Z1(BYTINDEX)=ON THEN           1191
         LR    @01,CURCBPTR                                        1191
         ALR   @01,BYTINDEX                                        1191
         AL    @01,@CF01674                                        1191
         TM    CURX0Z1(@01),B'01000000'                            1191
         BNO   @RF01191                                            1191
*                             X0Z1(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1192
         ALR   @01,BYTINDEX                                        1192
         AL    @01,@CF01674                                        1192
         NI    X0Z1(@01),B'10111111'                               1192
*                           ELSE                                   1193
*                             PRTXYZ1=ON;/*                  @Z40LB25*/
         B     @RC01191                                            1193
@RF01191 OI    PRTXYZ1,B'01000000'                                 1193
*                       END;        /*                       @Z40LB25*/
*                     ELSE                                         1195
*                       DO;         /*                       @Z40LB25*/
         B     @RC01184                                            1195
@RF01184 DS    0H                                                  1196
*                         IF X0Z0(BYTINDEX)=ON THEN                1196
         LR    @01,CUBEPTR                                         1196
         ALR   @01,BYTINDEX                                        1196
         AL    @01,@CF01674                                        1196
         TM    X0Z0(@01),B'10000000'                               1196
         BNO   @RF01196                                            1196
*                           IF CURX0Z0(BYTINDEX)=OFF THEN          1197
         LR    @01,CURCBPTR                                        1197
         ALR   @01,BYTINDEX                                        1197
         AL    @01,@CF01674                                        1197
         TM    CURX0Z0(@01),B'10000000'                            1197
         BNZ   @RF01197                                            1197
*                             X0Z0(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1198
         ALR   @01,BYTINDEX                                        1198
         AL    @01,@CF01674                                        1198
         NI    X0Z0(@01),B'01111111'                               1198
*                           ELSE                                   1199
*                             PRTXYZ2=ON;/*                  @Z40LB25*/
         B     @RC01197                                            1199
@RF01197 OI    PRTXYZ2,B'00100000'                                 1199
*                         IF X0Z1(BYTINDEX)=ON THEN                1200
@RC01197 DS    0H                                                  1200
@RF01196 LR    @01,CUBEPTR                                         1200
         ALR   @01,BYTINDEX                                        1200
         AL    @01,@CF01674                                        1200
         TM    X0Z1(@01),B'01000000'                               1200
         BNO   @RF01200                                            1200
*                           IF CURX0Z1(BYTINDEX)=OFF THEN          1201
         LR    @01,CURCBPTR                                        1201
         ALR   @01,BYTINDEX                                        1201
         AL    @01,@CF01674                                        1201
         TM    CURX0Z1(@01),B'01000000'                            1201
         BNZ   @RF01201                                            1201
*                             X0Z1(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1202
         ALR   @01,BYTINDEX                                        1202
         AL    @01,@CF01674                                        1202
         NI    X0Z1(@01),B'10111111'                               1202
*                           ELSE                                   1203
*                             PRTXYZ2=ON;/*                  @Z40LB25*/
         B     @RC01201                                            1203
@RF01201 OI    PRTXYZ2,B'00100000'                                 1203
*                       END;        /*                       @Z40LB25*/
@RC01201 DS    0H                                                  1204
@RF01200 DS    0H                                                  1205
*                   END;            /*                       @Z40LB25*/
@RC01184 DS    0H                                                  1206
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/
*                                                                  1206
@RF01182 LA    @15,1                                               1206
         ALR   TEMPX,@15                                           1206
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK X+1                               @Z40LB25*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1207
*                 IF X+TEMPX=>MSFLOWX THEN                         1207
         LR    @14,TEMPX                                           1207
         AH    @14,X                                               1207
         C     @14,MSFLOWX                                         1207
         BL    @RF01207                                            1207
*                   DO;             /*                       @Z40LB25*/
*                     IF I=1 THEN                                  1209
         CR    I,@15                                               1209
         BNE   @RF01209                                            1209
*                       DO;         /*                       @Z40LB25*/
*                         IF X1Z0(BYTINDEX)=ON THEN                1211
         LR    @01,CUBEPTR                                         1211
         ALR   @01,BYTINDEX                                        1211
         AL    @01,@CF01674                                        1211
         TM    X1Z0(@01),B'00100000'                               1211
         BNO   @RF01211                                            1211
*                           IF CURX1Z0(BYTINDEX)=ON THEN           1212
         LR    @01,CURCBPTR                                        1212
         ALR   @01,BYTINDEX                                        1212
         AL    @01,@CF01674                                        1212
         TM    CURX1Z0(@01),B'00100000'                            1212
         BNO   @RF01212                                            1212
*                             X1Z0(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1213
         ALR   @01,BYTINDEX                                        1213
         AL    @01,@CF01674                                        1213
         NI    X1Z0(@01),B'11011111'                               1213
*                           ELSE                                   1214
*                             PRTXYZ1=ON;/*                  @Z40LB25*/
         B     @RC01212                                            1214
@RF01212 OI    PRTXYZ1,B'01000000'                                 1214
*                         IF X1Z1(BYTINDEX)=ON THEN                1215
@RC01212 DS    0H                                                  1215
@RF01211 LR    @01,CUBEPTR                                         1215
         ALR   @01,BYTINDEX                                        1215
         AL    @01,@CF01674                                        1215
         TM    X1Z1(@01),B'00010000'                               1215
         BNO   @RF01215                                            1215
*                           IF CURX1Z1(BYTINDEX)=ON THEN           1216
         LR    @01,CURCBPTR                                        1216
         ALR   @01,BYTINDEX                                        1216
         AL    @01,@CF01674                                        1216
         TM    CURX1Z1(@01),B'00010000'                            1216
         BNO   @RF01216                                            1216
*                             X1Z1(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1217
         ALR   @01,BYTINDEX                                        1217
         AL    @01,@CF01674                                        1217
         NI    X1Z1(@01),B'11101111'                               1217
*                           ELSE                                   1218
*                             PRTXYZ1=ON;/*                  @Z40LB25*/
         B     @RC01216                                            1218
@RF01216 OI    PRTXYZ1,B'01000000'                                 1218
*                       END;        /*                       @Z40LB25*/
*                     ELSE                                         1220
*                       DO;         /*                       @Z40LB25*/
         B     @RC01209                                            1220
@RF01209 DS    0H                                                  1221
*                         IF X1Z0(BYTINDEX)=ON THEN                1221
         LR    @01,CUBEPTR                                         1221
         ALR   @01,BYTINDEX                                        1221
         AL    @01,@CF01674                                        1221
         TM    X1Z0(@01),B'00100000'                               1221
         BNO   @RF01221                                            1221
*                           IF CURX1Z0(BYTINDEX)=OFF THEN          1222
         LR    @01,CURCBPTR                                        1222
         ALR   @01,BYTINDEX                                        1222
         AL    @01,@CF01674                                        1222
         TM    CURX1Z0(@01),B'00100000'                            1222
         BNZ   @RF01222                                            1222
*                             X1Z0(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1223
         ALR   @01,BYTINDEX                                        1223
         AL    @01,@CF01674                                        1223
         NI    X1Z0(@01),B'11011111'                               1223
*                           ELSE                                   1224
*                             PRTXYZ2=ON;/*                  @Z40LB25*/
         B     @RC01222                                            1224
@RF01222 OI    PRTXYZ2,B'00100000'                                 1224
*                         IF X1Z1(BYTINDEX)=ON THEN                1225
@RC01222 DS    0H                                                  1225
@RF01221 LR    @01,CUBEPTR                                         1225
         ALR   @01,BYTINDEX                                        1225
         AL    @01,@CF01674                                        1225
         TM    X1Z1(@01),B'00010000'                               1225
         BNO   @RF01225                                            1225
*                           IF CURX1Z1(BYTINDEX)=OFF THEN          1226
         LR    @01,CURCBPTR                                        1226
         ALR   @01,BYTINDEX                                        1226
         AL    @01,@CF01674                                        1226
         TM    CURX1Z1(@01),B'00010000'                            1226
         BNZ   @RF01226                                            1226
*                             X1Z1(BYTINDEX)=OFF;/*          @Z40LB25*/
         LR    @01,CUBEPTR                                         1227
         ALR   @01,BYTINDEX                                        1227
         AL    @01,@CF01674                                        1227
         NI    X1Z1(@01),B'11101111'                               1227
*                           ELSE                                   1228
*                             PRTXYZ2=ON;/*                  @Z40LB25*/
         B     @RC01226                                            1228
@RF01226 OI    PRTXYZ2,B'00100000'                                 1228
*                       END;        /*                       @Z40LB25*/
@RC01226 DS    0H                                                  1229
@RF01225 DS    0H                                                  1230
*                   END;            /*                       @Z40LB25*/
@RC01209 DS    0H                                                  1231
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/
*                                                                  1231
@RF01207 LA    @15,1                                               1231
         ALR   TEMPX,@15                                           1231
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK FOR THE LAST BLOCK                @Z40LB25*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1232
*                 IF BLKINDEX^=BLKNUM THEN                         1232
         C     BLKINDEX,@CF00047                                   1232
         BE    @RF01232                                            1232
*                   DO;             /*                       @Z40LB25*/
*                                                                  1233
*                     /***********************************************/
*                     /*                                             */
*                     /* CHECK X+2                           @Z40LB25*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1234
*                     IF X+TEMPX=>MSFLOWX THEN                     1234
         LR    @14,TEMPX                                           1234
         AH    @14,X                                               1234
         C     @14,MSFLOWX                                         1234
         BL    @RF01234                                            1234
*                       DO;         /*                       @Z40LB25*/
*                         IF I=1 THEN                              1236
         CR    I,@15                                               1236
         BNE   @RF01236                                            1236
*                           DO;     /*                       @Z40LB25*/
*                             IF X2Z0(BYTINDEX)=ON THEN            1238
         LR    @01,CUBEPTR                                         1238
         ALR   @01,BYTINDEX                                        1238
         AL    @01,@CF01674                                        1238
         TM    X2Z0(@01),B'00001000'                               1238
         BNO   @RF01238                                            1238
*                               IF CURX2Z0(BYTINDEX)=ON THEN       1239
         LR    @01,CURCBPTR                                        1239
         ALR   @01,BYTINDEX                                        1239
         AL    @01,@CF01674                                        1239
         TM    CURX2Z0(@01),B'00001000'                            1239
         BNO   @RF01239                                            1239
*                                 X2Z0(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @01,CUBEPTR                                         1240
         ALR   @01,BYTINDEX                                        1240
         AL    @01,@CF01674                                        1240
         NI    X2Z0(@01),B'11110111'                               1240
*                               ELSE                               1241
*                                 PRTXYZ1=ON;/*              @Z40LB25*/
         B     @RC01239                                            1241
@RF01239 OI    PRTXYZ1,B'01000000'                                 1241
*                             IF X2Z1(BYTINDEX)=ON THEN            1242
@RC01239 DS    0H                                                  1242
@RF01238 LR    @01,CUBEPTR                                         1242
         ALR   @01,BYTINDEX                                        1242
         AL    @01,@CF01674                                        1242
         TM    X2Z1(@01),B'00000100'                               1242
         BNO   @RF01242                                            1242
*                               IF CURX2Z1(BYTINDEX)=ON THEN       1243
         LR    @01,CURCBPTR                                        1243
         ALR   @01,BYTINDEX                                        1243
         AL    @01,@CF01674                                        1243
         TM    CURX2Z1(@01),B'00000100'                            1243
         BNO   @RF01243                                            1243
*                                 X2Z1(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @01,CUBEPTR                                         1244
         ALR   @01,BYTINDEX                                        1244
         AL    @01,@CF01674                                        1244
         NI    X2Z1(@01),B'11111011'                               1244
*                               ELSE                               1245
*                                 PRTXYZ1=ON;/*              @Z40LB25*/
         B     @RC01243                                            1245
@RF01243 OI    PRTXYZ1,B'01000000'                                 1245
*                           END;    /*                       @Z40LB25*/
*                         ELSE                                     1247
*                           DO;     /*                       @Z40LB25*/
         B     @RC01236                                            1247
@RF01236 DS    0H                                                  1248
*                             IF X2Z0(BYTINDEX)=ON THEN            1248
         LR    @01,CUBEPTR                                         1248
         ALR   @01,BYTINDEX                                        1248
         AL    @01,@CF01674                                        1248
         TM    X2Z0(@01),B'00001000'                               1248
         BNO   @RF01248                                            1248
*                               IF CURX2Z0(BYTINDEX)=OFF THEN      1249
         LR    @01,CURCBPTR                                        1249
         ALR   @01,BYTINDEX                                        1249
         AL    @01,@CF01674                                        1249
         TM    CURX2Z0(@01),B'00001000'                            1249
         BNZ   @RF01249                                            1249
*                                 X2Z0(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @01,CUBEPTR                                         1250
         ALR   @01,BYTINDEX                                        1250
         AL    @01,@CF01674                                        1250
         NI    X2Z0(@01),B'11110111'                               1250
*                               ELSE                               1251
*                                 PRTXYZ2=ON;/*              @Z40LB25*/
         B     @RC01249                                            1251
@RF01249 OI    PRTXYZ2,B'00100000'                                 1251
*                             IF X2Z1(BYTINDEX)=ON THEN            1252
@RC01249 DS    0H                                                  1252
@RF01248 LR    @01,CUBEPTR                                         1252
         ALR   @01,BYTINDEX                                        1252
         AL    @01,@CF01674                                        1252
         TM    X2Z1(@01),B'00000100'                               1252
         BNO   @RF01252                                            1252
*                               IF CURX2Z1(BYTINDEX)=OFF THEN      1253
         LR    @01,CURCBPTR                                        1253
         ALR   @01,BYTINDEX                                        1253
         AL    @01,@CF01674                                        1253
         TM    CURX2Z1(@01),B'00000100'                            1253
         BNZ   @RF01253                                            1253
*                                 X2Z1(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @01,CUBEPTR                                         1254
         ALR   @01,BYTINDEX                                        1254
         AL    @01,@CF01674                                        1254
         NI    X2Z1(@01),B'11111011'                               1254
*                               ELSE                               1255
*                                 PRTXYZ2=ON;/*              @Z40LB25*/
         B     @RC01253                                            1255
@RF01253 OI    PRTXYZ2,B'00100000'                                 1255
*                           END;    /*                       @Z40LB25*/
@RC01253 DS    0H                                                  1256
@RF01252 DS    0H                                                  1257
*                       END;        /*                       @Z40LB25*/
@RC01236 DS    0H                                                  1258
*                     TEMPX=TEMPX+1;/*                       @Z40LB25*/
*                                                                  1258
@RF01234 LA    @15,1                                               1258
         ALR   TEMPX,@15                                           1258
*                     /***********************************************/
*                     /*                                             */
*                     /* CHECK X+3                           @Z40LB25*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1259
*                     IF X+TEMPX=>MSFLOWX THEN                     1259
         LR    @14,TEMPX                                           1259
         AH    @14,X                                               1259
         C     @14,MSFLOWX                                         1259
         BL    @RF01259                                            1259
*                       DO;         /*                       @Z40LB25*/
*                         IF I=1 THEN                              1261
         CR    I,@15                                               1261
         BNE   @RF01261                                            1261
*                           DO;     /*                       @Z40LB25*/
*                             IF X3Z0(BYTINDEX)=ON THEN            1263
         LR    @05,CUBEPTR                                         1263
         ALR   @05,BYTINDEX                                        1263
         AL    @05,@CF01674                                        1263
         TM    X3Z0(@05),B'00000010'                               1263
         BNO   @RF01263                                            1263
*                               IF CURX3Z0(BYTINDEX)=ON THEN       1264
         LR    @05,CURCBPTR                                        1264
         ALR   @05,BYTINDEX                                        1264
         AL    @05,@CF01674                                        1264
         TM    CURX3Z0(@05),B'00000010'                            1264
         BNO   @RF01264                                            1264
*                                 X3Z0(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @05,CUBEPTR                                         1265
         ALR   @05,BYTINDEX                                        1265
         AL    @05,@CF01674                                        1265
         NI    X3Z0(@05),B'11111101'                               1265
*                               ELSE                               1266
*                                 PRTXYZ1=ON;/*              @Z40LB25*/
         B     @RC01264                                            1266
@RF01264 OI    PRTXYZ1,B'01000000'                                 1266
*                             IF X3Z1(BYTINDEX)=ON THEN            1267
@RC01264 DS    0H                                                  1267
@RF01263 LR    @05,CUBEPTR                                         1267
         ALR   @05,BYTINDEX                                        1267
         AL    @05,@CF01674                                        1267
         TM    X3Z1(@05),B'00000001'                               1267
         BNO   @RF01267                                            1267
*                               IF CURX3Z1(BYTINDEX)=ON THEN       1268
         LR    @05,CURCBPTR                                        1268
         ALR   @05,BYTINDEX                                        1268
         AL    @05,@CF01674                                        1268
         TM    CURX3Z1(@05),B'00000001'                            1268
         BNO   @RF01268                                            1268
*                                 X3Z1(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @05,CUBEPTR                                         1269
         ALR   @05,BYTINDEX                                        1269
         AL    @05,@CF01674                                        1269
         NI    X3Z1(@05),B'11111110'                               1269
*                               ELSE                               1270
*                                 PRTXYZ1=ON;/*              @Z40LB25*/
         B     @RC01268                                            1270
@RF01268 OI    PRTXYZ1,B'01000000'                                 1270
*                           END;    /*                       @Z40LB25*/
*                         ELSE                                     1272
*                           DO;     /*                       @Z40LB25*/
         B     @RC01261                                            1272
@RF01261 DS    0H                                                  1273
*                             IF X3Z0(BYTINDEX)=ON THEN            1273
         LR    @05,CUBEPTR                                         1273
         ALR   @05,BYTINDEX                                        1273
         AL    @05,@CF01674                                        1273
         TM    X3Z0(@05),B'00000010'                               1273
         BNO   @RF01273                                            1273
*                               IF CURX3Z0(BYTINDEX)=OFF THEN      1274
         LR    @05,CURCBPTR                                        1274
         ALR   @05,BYTINDEX                                        1274
         AL    @05,@CF01674                                        1274
         TM    CURX3Z0(@05),B'00000010'                            1274
         BNZ   @RF01274                                            1274
*                                 X3Z0(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @05,CUBEPTR                                         1275
         ALR   @05,BYTINDEX                                        1275
         AL    @05,@CF01674                                        1275
         NI    X3Z0(@05),B'11111101'                               1275
*                               ELSE                               1276
*                                 PRTXYZ2=ON;/*              @Z40LB25*/
         B     @RC01274                                            1276
@RF01274 OI    PRTXYZ2,B'00100000'                                 1276
*                             IF X3Z1(BYTINDEX)=ON THEN            1277
@RC01274 DS    0H                                                  1277
@RF01273 LR    @05,CUBEPTR                                         1277
         ALR   @05,BYTINDEX                                        1277
         AL    @05,@CF01674                                        1277
         TM    X3Z1(@05),B'00000001'                               1277
         BNO   @RF01277                                            1277
*                               IF CURX3Z1(BYTINDEX)=OFF THEN      1278
         LR    @05,CURCBPTR                                        1278
         ALR   @05,BYTINDEX                                        1278
         AL    @05,@CF01674                                        1278
         TM    CURX3Z1(@05),B'00000001'                            1278
         BNZ   @RF01278                                            1278
*                                 X3Z1(BYTINDEX)=OFF;/*      @Z40LB25*/
         LR    @05,CUBEPTR                                         1279
         ALR   @05,BYTINDEX                                        1279
         AL    @05,@CF01674                                        1279
         NI    X3Z1(@05),B'11111110'                               1279
*                               ELSE                               1280
*                                 PRTXYZ2=ON;/*              @Z40LB25*/
         B     @RC01278                                            1280
@RF01278 OI    PRTXYZ2,B'00100000'                                 1280
*                           END;    /*                       @Z40LB25*/
@RC01278 DS    0H                                                  1281
@RF01277 DS    0H                                                  1282
*                       END;        /*                       @Z40LB25*/
@RC01261 DS    0H                                                  1283
*                   END;            /*                       @Z40LB25*/
@RF01259 DS    0H                                                  1284
*               END;                /*                       @Z40LB25*/
@RF01232 AL    BYTINDEX,@CF00224                                   1284
         C     BYTINDEX,@CF00047                                   1284
         BNH   @DL01180                                            1284
*               CUBEPTR=CUBEPTR+LENGTH(CUBE);/*              @Z40LB25*/
         LA    @05,4                                               1285
         ALR   CUBEPTR,@05                                         1285
*               CURCBPTR=CURCBPTR+LENGTH(CURCUBE);/*         @Z40LB25*/
         ALR   CURCBPTR,@05                                        1286
*             END;                  /*                       @Z40LB25*/
*                                                                  1287
         LA    @05,1                                               1287
         AH    @05,CUBINDEX                                        1287
         STH   @05,CUBINDEX                                        1287
         C     @05,@CF00663                                        1287
         BNH   @DL01179                                            1287
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK FOR THE LAST BLOCK                    @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1288
*             IF BLKINDEX=BLKNUM THEN                              1288
         C     BLKINDEX,@CF00047                                   1288
         BNE   @RF01288                                            1288
*               CHKINDEX=CHUNKNUM;  /*                       @Z40LB25*/
         MVC   CHKINDEX(2),@CH00184                                1289
*             CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*             @Z40LB25*/
@RF01288 LA    @06,32                                              1290
         L     @05,CHUNKPTR                                        1290
         ALR   @05,@06                                             1290
         ST    @05,CHUNKPTR                                        1290
*             CURCKPTR=CURCKPTR+LENGTH(CURCK);/*             @Z40LB25*/
         AL    @06,CURCKPTR                                        1291
         ST    @06,CURCKPTR                                        1291
*             X=X+4;                /*                       @Z40LB25*/
         LA    @06,4                                               1292
         AH    @06,X                                               1292
         STH   @06,X                                               1292
*           END;                    /*                       @Z40LB25*/
         LA    @06,1                                               1293
         AH    @06,CHKINDEX                                        1293
         STH   @06,CHKINDEX                                        1293
         C     @06,@CF00184                                        1293
         BNH   @DL01176                                            1293
*           CELLPTR=CELLPTR+BLKSIZE;/*                       @Z40LB25*/
         LA    @06,264                                             1294
         L     @05,CELLPTR                                         1294
         ALR   @05,@06                                             1294
         ST    @05,CELLPTR                                         1294
*           CURCLPTR=CURCLPTR+BLKSIZE;/*                     @Z40LB25*/
         AL    @06,CURCLPTR                                        1295
         ST    @06,CURCLPTR                                        1295
*           CHUNKPTR=CHUNKPTR+8;    /*                       @Z40LB25*/
         LA    @06,8                                               1296
         L     @05,CHUNKPTR                                        1296
         ALR   @05,@06                                             1296
         ST    @05,CHUNKPTR                                        1296
*           CURCKPTR=CURCKPTR+8;    /*                       @Z40LB25*/
         AL    @06,CURCKPTR                                        1297
         ST    @06,CURCKPTR                                        1297
*         END;                      /*                       @Z40LB25*/
         AL    BLKINDEX,@CF00224                                   1298
         C     BLKINDEX,@CF00047                                   1298
         BNH   @DL01175                                            1298
*       END;                        /*                       @Z40LB25*/
         AL    I,@CF00224                                          1299
         C     I,@CF00158                                          1299
         BNH   @DL01162                                            1299
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00010 DS    0H                                                  1301
@EF00010 DS    0H                                                  1301
@ER00010 L     @14,@SA00010                                        1301
         BR    @14                                                 1301
*   END CHKXYZ12;                   /*                       @Z40LB25*/
         B     @EL00010                                            1302
*                                                                  1303
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - BITTOLOC                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - SEARCH THE WORKMAP OR XYZ1 OR XYZ2         @Z40LB25*/
*   /* WORKAREA FOR AN ON BIT. WHEN ONE IS FOUND             @Z40LB25*/
*   /* TRANSLATE ITS POSITION TO AN X Y Z AND THEN SET       @Z40LB25*/
*   /* THE BIT OFF. WHEN THE END OF THE TABLE IS REACHED     @Z40LB25*/
*   /* SET A FLAG TO INFORM THE CALLER.                      @Z40LB25*/
*   /* XS ARE RETURNED IN ASSENING ORDER. WITHIN             @Z40LB25*/
*   /* EACH X, THEIR YS ARE ALSO RETURNED IN                 @Z40LB25*/
*   /* ASSENDING ORDER. FOR EACH Y, Z0 IS RETURNED           @Z40LB25*/
*   /* BEFORE Z1.                                            @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* CHUNKPTR - XYZ1, XYZ2, WORKMAP                        @Z40LB25*/
*   /* CELLPTR - CELL BLOCK                                  @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* TABLEND                                               @Z40LB25*/
*   /* X                                                     @Z40LB25*/
*   /* Y                                                     @Z40LB25*/
*   /* Z                                                     @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1303
*BITTOLOC:                                                         1303
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  1303
BITTOLOC ST    @14,12(,@13)                                        1303
*   /*****************************************************************/
*   /*                                                               */
*   /* HOUSEKEEP                                             @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1304
*   X=XSTART;                       /* START X LOC 150       @Z40LB25*/
         MVC   X(2),@CH01256                                       1304
*   Z=0;                            /* START Z LOC           @Z40LB25*/
*                                                                  1305
         SLR   @05,@05                                             1305
         STH   @05,Z                                               1305
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR AN ON BIT                                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1306
*   DO BLKINDEX=1 TO BLKNUM;        /*                       @Z40LB25*/
*                                                                  1306
         LA    BLKINDEX,1                                          1306
@DL01306 DS    0H                                                  1307
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN THE CHUNKS OF EACH OF THE BLOCKS               @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1307
*     DO CHKINDEX=1 TO CHUNKNUM;    /*                       @Z40LB25*/
*                                                                  1307
         LA    @06,1                                               1307
         STH   @06,CHKINDEX                                        1307
@DL01307 DS    0H                                                  1308
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN THE XS IN ASCENDING ORDER                    @VS41108*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1308
*       DO XINDEX=1 TO 4;           /*                       @VS41108*/
         LA    XINDEX,1                                            1308
@DL01308 DS    0H                                                  1309
*         CUBEPTR=CHUNKPTR;         /*                       @VS41108*/
         L     CUBEPTR,CHUNKPTR                                    1309
*         Y=''B;                    /* START Y               @VS41108*/
*                                                                  1310
         SLR   @05,@05                                             1310
         ST    @05,Y                                               1310
*         /***********************************************************/
*         /*                                                         */
*         /* SCAN THE CUBES PER CHUNK                        @VS41108*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1311
*         DO CUBINDEX=1 TO CUBENUM; /*                       @VS41108*/
         LA    @05,1                                               1311
         STH   @05,CUBINDEX                                        1311
@DL01311 DS    0H                                                  1312
*           TEMPX=''B;              /*                       @VS41108*/
*                                                                  1312
         SLR   TEMPX,TEMPX                                         1312
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK X                                       @VS41108*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1313
*           IF XINDEX=1&X+TEMPX=>MSFLOWX THEN                      1313
         C     XINDEX,@CF00224                                     1313
         BNE   @RF01313                                            1313
         LR    @15,TEMPX                                           1313
         AH    @15,X                                               1313
         C     @15,MSFLOWX                                         1313
         BL    @RF01313                                            1313
*             DO;                   /*                       @VS41108*/
*                                                                  1314
*               /*****************************************************/
*               /*                                                   */
*               /* X ALREADY SET BY X=XSTART OR X=X+4        @VS41108*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1315
*               IF X0Z0(1)=ON THEN                                 1315
         TM    X0Z0(CUBEPTR),B'10000000'                           1315
         BNO   @RF01315                                            1315
*                 DO;               /*                       @VS41108*/
*                   X0Z0(1)=OFF;    /*                       @VS41108*/
         NI    X0Z0(CUBEPTR),B'01111111'                           1317
*                   RETURN;         /*                       @VS41108*/
@EL00011 DS    0H                                                  1318
@EF00011 DS    0H                                                  1318
@ER00011 L     @14,12(,@13)                                        1318
         BR    @14                                                 1318
*                 END;              /*                       @VS41108*/
*               IF X0Z1(1)=ON THEN                                 1320
@RF01315 TM    X0Z1(CUBEPTR),B'01000000'                           1320
         BNO   @RF01320                                            1320
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1322
*                   X0Z1(1)=OFF;    /*                       @VS41108*/
         NI    X0Z1(CUBEPTR),B'10111111'                           1323
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1324
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01320 LA    @15,1                                               1326
         AL    @15,Y                                               1326
         ST    @15,Y                                               1326
*               IF X0Z0(2)=ON THEN                                 1327
         TM    X0Z0+1(CUBEPTR),B'10000000'                         1327
         BNO   @RF01327                                            1327
*                 DO;               /*                       @VS41108*/
*                   X0Z0(2)=OFF;    /*                       @VS41108*/
         NI    X0Z0+1(CUBEPTR),B'01111111'                         1329
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1330
*                 END;              /*                       @VS41108*/
*               IF X0Z1(2)=ON THEN                                 1332
@RF01327 TM    X0Z1+1(CUBEPTR),B'01000000'                         1332
         BNO   @RF01332                                            1332
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1334
*                   X0Z1(2)=OFF;    /*                       @VS41108*/
         NI    X0Z1+1(CUBEPTR),B'10111111'                         1335
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1336
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01332 LA    @15,1                                               1338
         AL    @15,Y                                               1338
         ST    @15,Y                                               1338
*               IF X0Z0(3)=ON THEN                                 1339
         TM    X0Z0+2(CUBEPTR),B'10000000'                         1339
         BNO   @RF01339                                            1339
*                 DO;               /*                       @VS41108*/
*                   X0Z0(3)=OFF;    /*                       @VS41108*/
         NI    X0Z0+2(CUBEPTR),B'01111111'                         1341
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1342
*                 END;              /*                       @VS41108*/
*               IF X0Z1(3)=ON THEN                                 1344
@RF01339 TM    X0Z1+2(CUBEPTR),B'01000000'                         1344
         BNO   @RF01344                                            1344
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1346
*                   X0Z1(3)=OFF;    /*                       @VS41108*/
         NI    X0Z1+2(CUBEPTR),B'10111111'                         1347
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1348
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01344 LA    @15,1                                               1350
         AL    @15,Y                                               1350
         ST    @15,Y                                               1350
*               IF X0Z0(4)=ON THEN                                 1351
         TM    X0Z0+3(CUBEPTR),B'10000000'                         1351
         BNO   @RF01351                                            1351
*                 DO;               /*                       @VS41108*/
*                   X0Z0(4)=OFF;    /*                       @VS41108*/
         NI    X0Z0+3(CUBEPTR),B'01111111'                         1353
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1354
*                 END;              /*                       @VS41108*/
*               IF X0Z1(4)=ON THEN                                 1356
@RF01351 TM    X0Z1+3(CUBEPTR),B'01000000'                         1356
         BNO   @RF01356                                            1356
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1358
*                   X0Z1(4)=OFF;    /*                       @VS41108*/
         NI    X0Z1+3(CUBEPTR),B'10111111'                         1359
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1360
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01356 LA    @15,1                                               1362
         AL    @15,Y                                               1362
         ST    @15,Y                                               1362
*             END;                  /*                       @VS41108*/
*                                                                  1363
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK X+1                                     @VS41108*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1364
*           TEMPX=TEMPX+1;          /*                       @VS41108*/
@RF01313 LA    @15,1                                               1364
         ALR   TEMPX,@15                                           1364
*           IF XINDEX=2&X+TEMPX=>MSFLOWX THEN                      1365
         C     XINDEX,@CF00158                                     1365
         BNE   @RF01365                                            1365
         LH    @14,X                                               1365
         LR    @01,TEMPX                                           1365
         ALR   @01,@14                                             1365
         C     @01,MSFLOWX                                         1365
         BL    @RF01365                                            1365
*             DO;                   /*                       @VS41108*/
*               IF X1Z0(1)=ON THEN                                 1367
         TM    X1Z0(CUBEPTR),B'00100000'                           1367
         BNO   @RF01367                                            1367
*                 DO;               /*                       @VS41108*/
*                   X1Z0(1)=OFF;    /*                       @VS41108*/
         NI    X1Z0(CUBEPTR),B'11011111'                           1369
*                   X=X+1;          /*                       @VS41108*/
         ALR   @14,@15                                             1370
         STH   @14,X                                               1370
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1371
*                 END;              /*                       @VS41108*/
*               IF X1Z1(1)=ON THEN                                 1373
@RF01367 TM    X1Z1(CUBEPTR),B'00010000'                           1373
         BNO   @RF01373                                            1373
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         LA    @05,1                                               1375
         STH   @05,Z                                               1375
*                   X1Z1(1)=OFF;    /*                       @VS41108*/
         NI    X1Z1(CUBEPTR),B'11101111'                           1376
*                   X=X+1;          /*                       @VS41108*/
         AH    @05,X                                               1377
         STH   @05,X                                               1377
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1378
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01373 LA    @15,1                                               1380
         L     @14,Y                                               1380
         ALR   @14,@15                                             1380
         ST    @14,Y                                               1380
*               IF X1Z0(2)=ON THEN                                 1381
         TM    X1Z0+1(CUBEPTR),B'00100000'                         1381
         BNO   @RF01381                                            1381
*                 DO;               /*                       @VS41108*/
*                   X1Z0(2)=OFF;    /*                       @VS41108*/
         NI    X1Z0+1(CUBEPTR),B'11011111'                         1383
*                   X=X+1;          /*                       @VS41108*/
         AH    @15,X                                               1384
         STH   @15,X                                               1384
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1385
*                 END;              /*                       @VS41108*/
*               IF X1Z1(2)=ON THEN                                 1387
@RF01381 TM    X1Z1+1(CUBEPTR),B'00010000'                         1387
         BNO   @RF01387                                            1387
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         LA    @05,1                                               1389
         STH   @05,Z                                               1389
*                   X1Z1(2)=OFF;    /*                       @VS41108*/
         NI    X1Z1+1(CUBEPTR),B'11101111'                         1390
*                   X=X+1;          /*                       @VS41108*/
         AH    @05,X                                               1391
         STH   @05,X                                               1391
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1392
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01387 LA    @15,1                                               1394
         L     @14,Y                                               1394
         ALR   @14,@15                                             1394
         ST    @14,Y                                               1394
*               IF X1Z0(3)=ON THEN                                 1395
         TM    X1Z0+2(CUBEPTR),B'00100000'                         1395
         BNO   @RF01395                                            1395
*                 DO;               /*                       @VS41108*/
*                   X1Z0(3)=OFF;    /*                       @VS41108*/
         NI    X1Z0+2(CUBEPTR),B'11011111'                         1397
*                   X=X+1;          /*                       @VS41108*/
         AH    @15,X                                               1398
         STH   @15,X                                               1398
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1399
*                 END;              /*                       @VS41108*/
*               IF X1Z1(3)=ON THEN                                 1401
@RF01395 TM    X1Z1+2(CUBEPTR),B'00010000'                         1401
         BNO   @RF01401                                            1401
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         LA    @05,1                                               1403
         STH   @05,Z                                               1403
*                   X1Z1(3)=OFF;    /*                       @VS41108*/
         NI    X1Z1+2(CUBEPTR),B'11101111'                         1404
*                   X=X+1;          /*                       @VS41108*/
         AH    @05,X                                               1405
         STH   @05,X                                               1405
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1406
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01401 LA    @15,1                                               1408
         L     @14,Y                                               1408
         ALR   @14,@15                                             1408
         ST    @14,Y                                               1408
*               IF X1Z0(4)=ON THEN                                 1409
         TM    X1Z0+3(CUBEPTR),B'00100000'                         1409
         BNO   @RF01409                                            1409
*                 DO;               /*                       @VS41108*/
*                   X1Z0(4)=OFF;    /*                       @VS41108*/
         NI    X1Z0+3(CUBEPTR),B'11011111'                         1411
*                   X=X+1;          /*                       @VS41108*/
         AH    @15,X                                               1412
         STH   @15,X                                               1412
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1413
*                 END;              /*                       @VS41108*/
*               IF X1Z1(4)=ON THEN                                 1415
@RF01409 TM    X1Z1+3(CUBEPTR),B'00010000'                         1415
         BNO   @RF01415                                            1415
*                 DO;               /*                       @VS41108*/
*                   Z=1;            /*                       @VS41108*/
         LA    @05,1                                               1417
         STH   @05,Z                                               1417
*                   X1Z1(4)=OFF;    /*                       @VS41108*/
         NI    X1Z1+3(CUBEPTR),B'11101111'                         1418
*                   X=X+1;          /*                       @VS41108*/
         AH    @05,X                                               1419
         STH   @05,X                                               1419
*                   RETURN;         /*                       @VS41108*/
         B     @EL00011                                            1420
*                 END;              /*                       @VS41108*/
*               Y=Y+1;              /*                       @VS41108*/
@RF01415 LA    @15,1                                               1422
         AL    @15,Y                                               1422
         ST    @15,Y                                               1422
*             END;                  /*                       @VS41108*/
*                                                                  1423
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR THE LAST BLOCK                      @VS41108*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1424
*           IF BLKINDEX^=BLKNUM THEN                               1424
@RF01365 C     BLKINDEX,@CF00047                                   1424
         BE    @RF01424                                            1424
*             DO;                   /*                       @VS41108*/
*                                                                  1425
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK X+2                                 @VS41108*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1426
*               TEMPX=TEMPX+1;      /*                       @VS41108*/
         AL    TEMPX,@CF00224                                      1426
*               IF XINDEX=3&X+TEMPX=>MSFLOWX THEN                  1427
         C     XINDEX,@CF00167                                     1427
         BNE   @RF01427                                            1427
         LH    @15,X                                               1427
         LR    @14,TEMPX                                           1427
         ALR   @14,@15                                             1427
         C     @14,MSFLOWX                                         1427
         BL    @RF01427                                            1427
*                 DO;               /*                       @VS41108*/
*                   IF X2Z0(1)=ON THEN                             1429
         TM    X2Z0(CUBEPTR),B'00001000'                           1429
         BNO   @RF01429                                            1429
*                     DO;           /*                       @VS41108*/
*                       X2Z0(1)=OFF;/*                       @VS41108*/
         NI    X2Z0(CUBEPTR),B'11110111'                           1431
*                       X=X+2;      /*                       @VS41108*/
         AL    @15,@CF00158                                        1432
         STH   @15,X                                               1432
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1433
*                     END;          /*                       @VS41108*/
*                   IF X2Z1(1)=ON THEN                             1435
@RF01429 TM    X2Z1(CUBEPTR),B'00000100'                           1435
         BNO   @RF01435                                            1435
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1437
*                       X2Z1(1)=OFF;/*                       @VS41108*/
         NI    X2Z1(CUBEPTR),B'11111011'                           1438
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1439
         AH    @05,X                                               1439
         STH   @05,X                                               1439
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1440
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01435 LA    @15,1                                               1442
         AL    @15,Y                                               1442
         ST    @15,Y                                               1442
*                   IF X2Z0(2)=ON THEN                             1443
         TM    X2Z0+1(CUBEPTR),B'00001000'                         1443
         BNO   @RF01443                                            1443
*                     DO;           /*                       @VS41108*/
*                       X2Z0(2)=OFF;/*                       @VS41108*/
         NI    X2Z0+1(CUBEPTR),B'11110111'                         1445
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1446
         AH    @05,X                                               1446
         STH   @05,X                                               1446
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1447
*                     END;          /*                       @VS41108*/
*                   IF X2Z1(2)=ON THEN                             1449
@RF01443 TM    X2Z1+1(CUBEPTR),B'00000100'                         1449
         BNO   @RF01449                                            1449
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1451
*                       X2Z1(2)=OFF;/*                       @VS41108*/
         NI    X2Z1+1(CUBEPTR),B'11111011'                         1452
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1453
         AH    @05,X                                               1453
         STH   @05,X                                               1453
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1454
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01449 LA    @15,1                                               1456
         AL    @15,Y                                               1456
         ST    @15,Y                                               1456
*                   IF X2Z0(3)=ON THEN                             1457
         TM    X2Z0+2(CUBEPTR),B'00001000'                         1457
         BNO   @RF01457                                            1457
*                     DO;           /*                       @VS41108*/
*                       X2Z0(3)=OFF;/*                       @VS41108*/
         NI    X2Z0+2(CUBEPTR),B'11110111'                         1459
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1460
         AH    @05,X                                               1460
         STH   @05,X                                               1460
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1461
*                     END;          /*                       @VS41108*/
*                   IF X2Z1(3)=ON THEN                             1463
@RF01457 TM    X2Z1+2(CUBEPTR),B'00000100'                         1463
         BNO   @RF01463                                            1463
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1465
*                       X2Z1(3)=OFF;/*                       @VS41108*/
         NI    X2Z1+2(CUBEPTR),B'11111011'                         1466
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1467
         AH    @05,X                                               1467
         STH   @05,X                                               1467
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1468
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01463 LA    @15,1                                               1470
         AL    @15,Y                                               1470
         ST    @15,Y                                               1470
*                   IF X2Z0(4)=ON THEN                             1471
         TM    X2Z0+3(CUBEPTR),B'00001000'                         1471
         BNO   @RF01471                                            1471
*                     DO;           /*                       @VS41108*/
*                       X2Z0(4)=OFF;/*                       @VS41108*/
         NI    X2Z0+3(CUBEPTR),B'11110111'                         1473
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1474
         AH    @05,X                                               1474
         STH   @05,X                                               1474
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1475
*                     END;          /*                       @VS41108*/
*                   IF X2Z1(4)=ON THEN                             1477
@RF01471 TM    X2Z1+3(CUBEPTR),B'00000100'                         1477
         BNO   @RF01477                                            1477
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1479
*                       X2Z1(4)=OFF;/*                       @VS41108*/
         NI    X2Z1+3(CUBEPTR),B'11111011'                         1480
*                       X=X+2;      /*                       @VS41108*/
         LA    @05,2                                               1481
         AH    @05,X                                               1481
         STH   @05,X                                               1481
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1482
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01477 LA    @15,1                                               1484
         AL    @15,Y                                               1484
         ST    @15,Y                                               1484
*                 END;              /*                       @VS41108*/
*                                                                  1485
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK X+3                                 @VS41108*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1486
*               TEMPX=TEMPX+1;      /*                       @VS41108*/
@RF01427 AL    TEMPX,@CF00224                                      1486
*               IF XINDEX=4&X+TEMPX=>MSFLOWX THEN                  1487
         C     XINDEX,@CF00047                                     1487
         BNE   @RF01487                                            1487
         LH    @15,X                                               1487
         LR    @14,TEMPX                                           1487
         ALR   @14,@15                                             1487
         C     @14,MSFLOWX                                         1487
         BL    @RF01487                                            1487
*                 DO;               /*                       @VS41108*/
*                   IF X3Z0(1)=ON THEN                             1489
         TM    X3Z0(CUBEPTR),B'00000010'                           1489
         BNO   @RF01489                                            1489
*                     DO;           /*                       @VS41108*/
*                       X3Z0(1)=OFF;/*                       @VS41108*/
         NI    X3Z0(CUBEPTR),B'11111101'                           1491
*                       X=X+3;      /*                       @VS41108*/
         AL    @15,@CF00167                                        1492
         STH   @15,X                                               1492
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1493
*                     END;          /*                       @VS41108*/
*                   IF X3Z1(1)=ON THEN                             1495
@RF01489 TM    X3Z1(CUBEPTR),B'00000001'                           1495
         BNO   @RF01495                                            1495
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1497
*                       X3Z1(1)=OFF;/*                       @VS41108*/
         NI    X3Z1(CUBEPTR),B'11111110'                           1498
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1499
         AH    @05,X                                               1499
         STH   @05,X                                               1499
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1500
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01495 LA    @05,1                                               1502
         AL    @05,Y                                               1502
         ST    @05,Y                                               1502
*                   IF X3Z0(2)=ON THEN                             1503
         TM    X3Z0+1(CUBEPTR),B'00000010'                         1503
         BNO   @RF01503                                            1503
*                     DO;           /*                       @VS41108*/
*                       X3Z0(2)=OFF;/*                       @VS41108*/
         NI    X3Z0+1(CUBEPTR),B'11111101'                         1505
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1506
         AH    @05,X                                               1506
         STH   @05,X                                               1506
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1507
*                     END;          /*                       @VS41108*/
*                   IF X3Z1(2)=ON THEN                             1509
@RF01503 TM    X3Z1+1(CUBEPTR),B'00000001'                         1509
         BNO   @RF01509                                            1509
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1511
*                       X3Z1(2)=OFF;/*                       @VS41108*/
         NI    X3Z1+1(CUBEPTR),B'11111110'                         1512
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1513
         AH    @05,X                                               1513
         STH   @05,X                                               1513
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1514
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01509 LA    @05,1                                               1516
         AL    @05,Y                                               1516
         ST    @05,Y                                               1516
*                   IF X3Z0(3)=ON THEN                             1517
         TM    X3Z0+2(CUBEPTR),B'00000010'                         1517
         BNO   @RF01517                                            1517
*                     DO;           /*                       @VS41108*/
*                       X3Z0(3)=OFF;/*                       @VS41108*/
         NI    X3Z0+2(CUBEPTR),B'11111101'                         1519
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1520
         AH    @05,X                                               1520
         STH   @05,X                                               1520
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1521
*                     END;          /*                       @VS41108*/
*                   IF X3Z1(3)=ON THEN                             1523
@RF01517 TM    X3Z1+2(CUBEPTR),B'00000001'                         1523
         BNO   @RF01523                                            1523
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1525
*                       X3Z1(3)=OFF;/*                       @VS41108*/
         NI    X3Z1+2(CUBEPTR),B'11111110'                         1526
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1527
         AH    @05,X                                               1527
         STH   @05,X                                               1527
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1528
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01523 LA    @05,1                                               1530
         AL    @05,Y                                               1530
         ST    @05,Y                                               1530
*                   IF X3Z0(4)=ON THEN                             1531
         TM    X3Z0+3(CUBEPTR),B'00000010'                         1531
         BNO   @RF01531                                            1531
*                     DO;           /*                       @VS41108*/
*                       X3Z0(4)=OFF;/*                       @VS41108*/
         NI    X3Z0+3(CUBEPTR),B'11111101'                         1533
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1534
         AH    @05,X                                               1534
         STH   @05,X                                               1534
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1535
*                     END;          /*                       @VS41108*/
*                   IF X3Z1(4)=ON THEN                             1537
@RF01531 TM    X3Z1+3(CUBEPTR),B'00000001'                         1537
         BNO   @RF01537                                            1537
*                     DO;           /*                       @VS41108*/
*                       Z=1;        /*                       @VS41108*/
         MVC   Z(2),@CH00224                                       1539
*                       X3Z1(4)=OFF;/*                       @VS41108*/
         NI    X3Z1+3(CUBEPTR),B'11111110'                         1540
*                       X=X+3;      /*                       @VS41108*/
         LA    @05,3                                               1541
         AH    @05,X                                               1541
         STH   @05,X                                               1541
*                       RETURN;     /*                       @VS41108*/
         B     @EL00011                                            1542
*                     END;          /*                       @VS41108*/
*                   Y=Y+1;          /*                       @VS41108*/
@RF01537 LA    @05,1                                               1544
         AL    @05,Y                                               1544
         ST    @05,Y                                               1544
*                 END;              /*                       @VS41108*/
*             END;                  /*                       @VS41108*/
@RF01487 DS    0H                                                  1547
*           CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                  @Z40LB25*/
@RF01424 AL    CUBEPTR,@CF00047                                    1547
*         END;                      /*                       @Z40LB25*/
         LA    @05,1                                               1548
         AH    @05,CUBINDEX                                        1548
         STH   @05,CUBINDEX                                        1548
         C     @05,@CF00663                                        1548
         BNH   @DL01311                                            1548
*       END;                        /*                       @Z40LB25*/
*                                                                  1549
         AL    XINDEX,@CF00224                                     1549
         C     XINDEX,@CF00047                                     1549
         BNH   @DL01308                                            1549
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR LAST BLOCK                              @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1550
*       IF BLKINDEX=BLKNUM THEN                                    1550
         C     BLKINDEX,@CF00047                                   1550
         BNE   @RF01550                                            1550
*         CHKINDEX=CHUNKNUM;        /*                       @Z40LB25*/
         MVC   CHKINDEX(2),@CH00184                                1551
*       CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*                   @Z40LB25*/
@RF01550 LA    @06,32                                              1552
         AL    @06,CHUNKPTR                                        1552
         ST    @06,CHUNKPTR                                        1552
*       X=X+4;                      /*                       @Z40LB25*/
         LA    @06,4                                               1553
         AH    @06,X                                               1553
         STH   @06,X                                               1553
*     END;                          /*                       @Z40LB25*/
         LA    @06,1                                               1554
         AH    @06,CHKINDEX                                        1554
         STH   @06,CHKINDEX                                        1554
         C     @06,@CF00184                                        1554
         BNH   @DL01307                                            1554
*     CELLPTR=CELLPTR+BLKSIZE;      /*                       @Z40LB25*/
         LA    @06,264                                             1555
         AL    @06,CELLPTR                                         1555
         ST    @06,CELLPTR                                         1555
*     CHUNKPTR=CHUNKPTR+8;          /* SKIP CONTROL INFO     @Z40LB25
*                                      OF NEXT BLOCK         @Z40LB25*/
         LA    @06,8                                               1556
         AL    @06,CHUNKPTR                                        1556
         ST    @06,CHUNKPTR                                        1556
*   END;                            /*                       @Z40LB25*/
*                                                                  1557
         AL    BLKINDEX,@CF00224                                   1557
         C     BLKINDEX,@CF00047                                   1557
         BNH   @DL01306                                            1557
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR END OF XYZ1, XYZ2, OR WORKMAP               @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1558
*   TABLEND=ON;                     /*                       @Z40LB25*/
         OI    TABLEND,B'00010000'                                 1558
*   RETURN;                         /*                       @Z40LB25*/
         B     @EL00011                                            1559
*   END BITTOLOC;                   /*                       @Z40LB25*/
*                                                                  1561
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PRINTXYZ                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - CONTROLS THE PRINTING HEADING FOR THE      @Z40LB25*/
*   /* CHECK AND READ LABEL REPORTS PLUS THE PRINTING        @Z40LB25*/
*   /* OF THE APPROPRIATE XYZ LOCATIONS FROM XYZ1 OR         @Z40LB25*/
*   /* OR XYZ2 WORK AREAS.                                   @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* XYZ1                                                  @Z40LB25*/
*   /* XYZ2                                                  @Z40LB25*/
*   /* PRTXYZ1                                               @Z40LB25*/
*   /* PRTXYZ2                                               @Z40LB25*/
*   /* TABLEND                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* CHECK REPORT HEADERS -                                @Z40LB25*/
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/
*   /* OCCUPIED)                                             @Z40LB25*/
*   /* CELLS FOUND OCCUPIED (MSC TABLES INDICATE             @Z40LB25*/
*   /* VACANT)                                               @Z40LB25*/
*   /* READ LABEL REPORT HEADERS -                           @Z40LB25*/
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/
*   /* OCCUPIED)                                             @Z40LB25*/
*   /* VACANT CELLS                                          @Z40LB25*/
*   /* CARTRIDGES NOT ACCESSED                               @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1561
*PRINTXYZ:                                                         1561
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  1561
PRINTXYZ ST    @14,@SA00012                                        1561
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE CORRECT HEADER FOR XYZ1 INPUT TO            @Z40LB25*/
*   /* TO EITHER THE CHECK OR READ LABEL REPORT              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1562
*   TABLEND=OFF;                    /* NOT AT TABLE END      @Z40LB25*/
         NI    TABLEND,B'11101111'                                 1562
*   IF PRTXYZ1=ON THEN                                             1563
         TM    PRTXYZ1,B'01000000'                                 1563
         BNO   @RF01563                                            1563
*     DO;                           /*                       @Z40LB25*/
*       XYZ1PRTD=ON;                /* XYZ1 PRINTED          @Z40LB25*/
*                                                                  1565
         OI    XYZ1PRTD,B'00000010'                                1565
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK REPORT?                                     @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1566
*       IF ADDR(CHK)^=NULLPTR THEN                                 1566
         L     @15,@PC00001+4                                      1566
         L     @15,FDTPTR+4(,@15)                                  1566
         LTR   @15,@15                                             1566
         BZ    @RF01566                                            1566
*         DO;                       /*                       @Z40LB25*/
*                                                                  1567
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT HEADERS -                               @Z40LB25*/
*           /* CELLS FOUND VACANT (MSC TABLES INDICATE OCCUPIED      */
*           /*                                               @Z40LB25*/
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1568
*           HDCKID14=ON;            /*                       @Z40LB25*/
         OI    HDCKID14,B'10000000'                                1568
*           CALL HEADSET;           /*                       @Z40LB25*/
*                                                                  1569
         BAL   @14,HEADSET                                         1569
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1570
*           CALL FMTXYZRP;          /*                       @Z40LB25*/
         BAL   @14,FMTXYZRP                                        1570
*         END;                      /*                       @Z40LB25*/
*                                                                  1571
*       /*************************************************************/
*       /*                                                           */
*       /* READ LABEL REPORT?                                @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1572
*       IF ADDR(RDLBL)^=NULLPTR THEN                               1572
@RF01566 SLR   @15,@15                                             1572
         L     @14,@PC00001+4                                      1572
         C     @15,FDTPTR+8(,@14)                                  1572
         BE    @RF01572                                            1572
*         DO;                       /*                       @Z40LB25*/
*                                                                  1573
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT HEADERS -                               @Z40LB25*/
*           /* CELLS FOUND VACANT (MSC TABLES INDICATE OCCUPIED      */
*           /*                                               @Z40LB25*/
*           /* VACANT CELLS                                  @Z40LB25*/
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1574
*           IF ADDR(CELL)^=NULLPTR THEN                            1574
         C     @15,FDTPTR+40(,@14)                                 1574
         BE    @RF01574                                            1574
*             HDRDID16=ON;          /*                       @Z40LB25*/
         OI    HDRDID16,B'10000000'                                1575
*           IF ADDR(XRNG)^=NULLPTR THEN                            1576
@RF01574 L     @15,@PC00001+4                                      1576
         L     @15,FDTPTR+28(,@15)                                 1576
         LTR   @15,@15                                             1576
         BZ    @RF01576                                            1576
*             HDRDID14=ON;          /*                       @Z40LB25*/
         OI    HDRDID14,B'10000000'                                1577
*           CALL HEADSET;           /*                       @Z40LB25*/
*                                                                  1578
@RF01576 BAL   @14,HEADSET                                         1578
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1579
*           CALL FMTXYZRP;          /*                       @Z40LB25*/
         BAL   @14,FMTXYZRP                                        1579
*         END;                      /*                       @Z40LB25*/
*                                                                  1580
*       /*************************************************************/
*       /*                                                           */
*       /* END OF THIS TABLE REACHED, RESET FOR NEXT TABLE   @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1581
*       TABLEND=OFF;                /*                       @Z40LB25*/
@RF01572 NI    TABLEND,B'11101111'                                 1581
*     END;                          /*                       @Z40LB25*/
*                                                                  1582
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE CORRECT HEADER FOR XYZ2 INPUT TO            @Z40LB25*/
*   /* TO EITHER THE CHECK OR READ LABEL REPORT              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1583
*   IF PRTXYZ2=ON THEN                                             1583
@RF01563 TM    PRTXYZ2,B'00100000'                                 1583
         BNO   @RF01583                                            1583
*     DO;                           /*                       @Z40LB25*/
*       XYZ2PRTD=ON;                /* XYZ2 PRINTED          @Z40LB25*/
*                                                                  1585
         OI    XYZ2PRTD,B'00000001'                                1585
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK REPORT?                                     @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1586
*       IF ADDR(CHK)^=NULLPTR THEN                                 1586
         L     @15,@PC00001+4                                      1586
         L     @15,FDTPTR+4(,@15)                                  1586
         LTR   @15,@15                                             1586
         BZ    @RF01586                                            1586
*         DO;                       /*                       @Z40LB25*/
*                                                                  1587
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT HEADERS -                               @Z40LB25*/
*           /* CELLS FOUND OCCUPIED (MSC TABLES INDICATE VACANT)     */
*           /*                                               @Z40LB25*/
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1588
*           HDCKID15=ON;            /*                       @Z40LB25*/
         OI    HDCKID15,B'10000000'                                1588
*           CALL HEADSET;           /*                       @Z40LB25*/
*                                                                  1589
         BAL   @14,HEADSET                                         1589
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1590
*           CALL FMTXYZRP;          /*                       @Z40LB25*/
         BAL   @14,FMTXYZRP                                        1590
*         END;                      /*                       @Z40LB25*/
*                                                                  1591
*       /*************************************************************/
*       /*                                                           */
*       /* READ LABEL REPORT?                                @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1592
*       IF ADDR(RDLBL)^=NULLPTR THEN                               1592
@RF01586 L     @15,@PC00001+4                                      1592
         L     @15,FDTPTR+8(,@15)                                  1592
         LTR   @15,@15                                             1592
         BZ    @RF01592                                            1592
*         DO;                       /*                       @Z40LB25*/
*                                                                  1593
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT HEADERS                                 @Z40LB25*/
*           /* CARTRIDGES NOT ACCESSED                       @Z40LB25*/
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1594
*           HDRDID37=ON;            /*                       @Z40LB25*/
         OI    HDRDID37,B'10000000'                                1594
*           CALL HEADSET;           /*                       @Z40LB25*/
*                                                                  1595
         BAL   @14,HEADSET                                         1595
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1596
*           CALL FMTXYZRP;          /*                       @Z40LB25*/
         BAL   @14,FMTXYZRP                                        1596
*         END;                      /*                       @Z40LB25*/
*                                                                  1597
*       /*************************************************************/
*       /*                                                           */
*       /* END OF THIS TABLE REACHED, RESET FOR NEXT TABLE   @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1598
*       TABLEND=OFF;                /*                       @Z40LB25*/
@RF01592 NI    TABLEND,B'11101111'                                 1598
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00012 DS    0H                                                  1600
@EF00012 DS    0H                                                  1600
@ER00012 L     @14,@SA00012                                        1600
         BR    @14                                                 1600
*   END PRINTXYZ;                   /*                       @Z40LB25*/
         B     @EL00012                                            1601
*                                                                  1602
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - FMTXYZRP                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - HAS XYZ1 AND/OR XYZ2 WORK AREA(S) SCAN-    @Z40LB25*/
*   /* NED FOR AN ON BIT. WHEN SIX ON BITS HAVE BEEN         @Z40LB25*/
*   /* TRANSLATED INTO XYZ LOCATIONS OR THE END              @Z40LB25*/
*   /* OF THE XYZ1 OR XYZ2 WORK AREA IS REACHED, THEN        @Z40LB25*/
*   /* THE TRANSLATED LOCATIONS ARE PRINTED. XYZ1            @Z40LB25*/
*   /* WORK AREA IS USED FOR CELLS FOUND VACANT (MSC         @Z40LB25*/
*   /* INDICATES OCCUPIED) FOR EITHER THE CHECK OR           @Z40LB25*/
*   /* READ LABEL REPORT. ALSO, FOR THE READ LABEL           @Z40LB25*/
*   /* REPORT XYZ1 IS USED FOR VACANT CELLS. XYZ2            @Z40LB25*/
*   /* WORK AREA IS USED FOR CELLS FOUND OCCUPIED            @Z40LB25*/
*   /* (MSC INDICATES VACANT) FOR THE CHECK REPORT AND       @Z40LB25*/
*   /* CARTRIDGES NOT ACCESSED FOR THE READ LABEL            @Z40LB25*/
*   /* REPORT.                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* XYZ1                                                  @Z40LB25*/
*   /* XYZ2                                                  @Z40LB25*/
*   /* PRTXYZ1                                               @Z40LB25*/
*   /* PRTXYZ2                                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* PRTXYZ1                                               @Z40LB25*/
*   /* PRTXYZ2                                               @Z40LB25*/
*   /* CHUNKPTR                                              @Z40LB25*/
*   /* CELLPTR                                               @Z40LB25*/
*   /* TABLEND                                               @Z40LB25*/
*   /* CHECK REPORT XYZ LOCATIONS FOR -                      @Z40LB25*/
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/
*   /* OCCUPIED)                                             @Z40LB25*/
*   /* CELLS FOUND OCCUPIED (MSC TABLES INDICATE             @Z40LB25*/
*   /* VACANT)                                               @Z40LB25*/
*   /* READ LABEL REPORT XYZ LOCATIONS FOR -                 @Z40LB25*/
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/
*   /* OCCUPIED) OR VACANT CELLS                             @Z40LB25*/
*   /* CARTRIDGES NOT ACCESSED                               @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1602
*FMTXYZRP:                                                         1602
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  1602
FMTXYZRP ST    @14,@SA00013                                        1602
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE CORRECT WORK AREA                       @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1603
*   IF PRTXYZ1=ON THEN              /* XYZ1?                 @Z40LB25*/
         TM    PRTXYZ1,B'01000000'                                 1603
         BNO   @RF01603                                            1603
*     DO;                           /*                       @Z40LB25*/
*       PRTXYZ1=OFF;                /*                       @Z40LB25*/
         NI    PRTXYZ1,B'10111111'                                 1605
*       XYZ1PTRS=ON;                /* SET XYZ1 PTRS         @Z40LB25*/
*       XYZ2PTRS=OFF;               /*                       @Z40LB25*/
         OI    XYZ1PTRS,B'00001000'                                1607
         NI    XYZ2PTRS,B'11111011'                                1607
*     END;                          /*                       @Z40LB25*/
*   ELSE                                                           1609
*     IF PRTXYZ2=ON THEN            /* XYZ2?                 @Z40LB25*/
         B     @RC01603                                            1609
@RF01603 TM    PRTXYZ2,B'00100000'                                 1609
         BNO   @RF01609                                            1609
*       DO;                         /*                       @Z40LB25*/
*         PRTXYZ2=OFF;              /*                       @Z40LB25*/
         NI    PRTXYZ2,B'11011111'                                 1611
*         XYZ2PTRS=ON;              /* SET XYZ2 PTRS         @Z40LB25*/
*         XYZ1PTRS=OFF;             /*                       @Z40LB25*/
         OI    XYZ2PTRS,B'00000100'                                1613
         NI    XYZ1PTRS,B'11110111'                                1613
*       END;                        /*                       @Z40LB25*/
*                                                                  1614
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE LOCATIONS                                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1615
*   DO WHILE TABLEND=OFF;           /*                       @Z40LB25*/
@RF01609 DS    0H                                                  1615
@RC01603 B     @DE01615                                            1615
@DL01615 DS    0H                                                  1616
*     PRINTAB=''B;                  /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                1616
*     DARGSMOD=AUDMSG;              /*                       @Z40LB25*/
         L     @02,DDSTRU                                          1617
         MVC   DARGSMOD(3,@02),@CC01440                            1617
*     DARGSENT=XYZLOCS;             /*                       @Z40LB25*/
         MVI   DARGSENT(@02),X'2F'                                 1618
*     II=1;                         /*                       @Z40LB25*/
         LA    @15,1                                               1619
         LR    II,@15                                              1619
*     DO I=1 TO 6 WHILE TABLEND=OFF;/* PRT UP TO 6 XYZS      @Z40LB25*/
*                                                                  1620
         LR    I,@15                                               1620
@DL01620 TM    TABLEND,B'00010000'                                 1620
         BNZ   @DC01620                                            1620
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SET XYZ1 POINTERS                        @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1621
*       IF XYZ1PTRS=ON THEN                                        1621
         TM    XYZ1PTRS,B'00001000'                                1621
         BNO   @RF01621                                            1621
*         DO;                       /*                       @Z40LB25*/
*           CHUNKPTR=ADDR(XYZ1CUBE(1));/*                    @Z40LB25*/
         L     @05,XYZ1PTR                                         1623
         LA    @02,XYZ1CUBE(,@05)                                  1623
         ST    @02,CHUNKPTR                                        1623
*           CELLPTR=ADDR(XYZ1BLK(1));/*                      @Z40LB25*/
         ST    @05,CELLPTR                                         1624
*         END;                      /*                       @Z40LB25*/
*                                                                  1625
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SET XYZ2 POINTERS                        @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1626
*       IF XYZ2PTRS=ON THEN                                        1626
@RF01621 TM    XYZ2PTRS,B'00000100'                                1626
         BNO   @RF01626                                            1626
*         DO;                       /*                       @Z40LB25*/
*           CHUNKPTR=ADDR(XYZ2CUBE(1));/*                    @Z40LB25*/
         L     @05,XYZ2PTR                                         1628
         LA    @02,XYZ2CUBE(,@05)                                  1628
         ST    @02,CHUNKPTR                                        1628
*           CELLPTR=ADDR(XYZ2BLK(1));/*                      @Z40LB25*/
         ST    @05,CELLPTR                                         1629
*         END;                      /*                       @Z40LB25*/
*                                                                  1630
*       /*************************************************************/
*       /*                                                           */
*       /* CONVERT AN ON BIT IN EITHER XYZ1 OR               @Z40LB25*/
*       /* XYZ2 TO AN XYZ LOCATION                           @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1631
*       CALL BITTOLOC;              /*                       @Z40LB25*/
*                                                                  1631
@RF01626 BAL   @14,BITTOLOC                                        1631
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR TABLE END WITH NOTHING TO PRINT         @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1632
*       IF TABLEND=ON&I=1 THEN                                     1632
         TM    TABLEND,B'00010000'                                 1632
         BNO   @RF01632                                            1632
         C     I,@CF00224                                          1632
         BE    @RT01632                                            1632
*         RETURN;                   /*                       @Z40LB25*/
*                                                                  1633
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR TABLE END                               @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1634
*       IF TABLEND=OFF THEN                                        1634
@RF01632 TM    TABLEND,B'00010000'                                 1634
         BNZ   @RF01634                                            1634
*         DO;                       /*                       @Z40LB25*/
*                                                                  1635
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE ARGUMENT COUNT                        @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1636
*           DARGCNT=I*3;            /*                       @Z40LB25*/
*                                                                  1636
         L     @05,DDSTRU                                          1636
         LA    @02,3                                               1636
         LR    @01,I                                               1636
         MR    @00,@02                                             1636
         STH   @01,DARGCNT(,@05)                                   1636
*           /*********************************************************/
*           /*                                                       */
*           /* SET X                                         @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1637
*           DARGINS(II)=II;         /*                       @Z40LB25*/
         LR    @15,II                                              1637
         SLA   @15,3                                               1637
         STH   II,DARGINS-8(@15,@05)                               1637
*           PRTX(I)=X;              /* RELATIVE X            @Z40LB25*/
         LR    @14,I                                               1638
         SLA   @14,3                                               1638
         LH    @07,X                                               1638
         LA    @06,PRTX-8(@14)                                     1638
         STCM  @07,3,0(@06)                                        1638
*           DARGINL(II)=LENGTH(PRTX(I));/*                   @Z40LB25*/
         LA    @07,2                                               1639
         STH   @07,DARGINL-8(@15,@05)                              1639
*           DARGDTM(II)=ADDR(PRTX(I));/*                     @Z40LB25*/
*                                                                  1640
         LA    @06,PRTX-8(@14)                                     1640
         ST    @06,DARGDTM-8(@15,@05)                              1640
*           /*********************************************************/
*           /*                                                       */
*           /* SET Y                                         @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1641
*           DARGINS(II+1)=II+1;     /*                       @Z40LB25*/
         LA    @06,1                                               1641
         ALR   @06,II                                              1641
         STH   @06,DARGINS(@15,@05)                                1641
*           PRTY(I)=Y;              /* Y LOCATION            @Z40LB25*/
         L     @06,Y                                               1642
         LA    @01,PRTY-8(@14)                                     1642
         STCM  @06,15,0(@01)                                       1642
*           DARGINL(II+1)=LENGTH(PRTY(I));/*                 @Z40LB25*/
         LA    @06,4                                               1643
         STH   @06,DARGINL(@15,@05)                                1643
*           DARGDTM(II+1)=ADDR(PRTY(I));/*                   @Z40LB25*/
*                                                                  1644
         LA    @06,PRTY-8(@14)                                     1644
         ST    @06,DARGDTM(@15,@05)                                1644
*           /*********************************************************/
*           /*                                                       */
*           /* SET Z                                         @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1645
*           DARGINS(II+2)=II+2;     /*                       @Z40LB25*/
         LR    @06,II                                              1645
         ALR   @06,@07                                             1645
         STH   @06,DARGINS+8(@15,@05)                              1645
*           PRTZ(I)=Z;              /* Z LOCATION            @Z40LB25*/
         LH    @06,Z                                               1646
         LA    @01,PRTZ-8(@14)                                     1646
         STCM  @06,3,0(@01)                                        1646
*           DARGINL(II+2)=LENGTH(PRTZ(I));/*                 @Z40LB25*/
         STH   @07,DARGINL+8(@15,@05)                              1647
*           DARGDTM(II+2)=ADDR(PRTZ(I));/*                   @Z40LB25*/
         LA    @14,PRTZ-8(@14)                                     1648
         ST    @14,DARGDTM+8(@15,@05)                              1648
*           II=II+3;                /* NEXT ARG NUMBER       @Z40LB25*/
         ALR   II,@02                                              1649
*         END;                      /*                       @Z40LB25*/
*     END;                          /*                       @Z40LB25*/
@RF01634 AL    I,@CF00224                                          1651
         C     I,@CF00161                                          1651
         BNH   @DL01620                                            1651
@DC01620 DS    0H                                                  1652
*     CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                @Z40LB25*/
         L     @15,@PC00001                                        1652
         ST    @15,@AL00001                                        1652
         L     @14,@PC00001+12                                     1652
         ST    @14,@AL00001+4                                      1652
         LA    @14,DDSTRU                                          1652
         ST    @14,@AL00001+8                                      1652
         MVI   @AL00001+8,X'80'                                    1652
         L     @15,GDTPRT(,@15)                                    1652
         LA    @01,@AL00001                                        1652
         BALR  @14,@15                                             1652
*   END;                            /*                       @Z40LB25*/
@DE01615 TM    TABLEND,B'00010000'                                 1653
         BZ    @DL01615                                            1653
*   RETURN;                         /*                       @Z40LB25*/
@EL00013 DS    0H                                                  1654
@EF00013 DS    0H                                                  1654
@ER00013 L     @14,@SA00013                                        1654
         BR    @14                                                 1654
*   END FMTXYZRP;                   /*                       @Z40LB25*/
         B     @EL00013                                            1655
*                                                                  1656
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - READ                                 @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* FUNCTION - IT IS CALLED BY READLBL TO                 @Z40LB25*/
*   /* HAVE PRINTED A LINE OF DATA FOR OCCUPIED CELLS        @Z40LB22*/
*   /* OF THE READLABEL REPORT. THIS IS ACCOMPLISHED BY      @Z40LB22*/
*   /* THE BITTOLOC ROUTINE INTERROGATING WORKMAP IN A       @Z40LB22*/
*   /* SEARCH FOR ANY ON BITS. IF THERE ARE NO ON BITS       @Z40LB22*/
*   /* FOUND, THE READ PROCEDURE RETURNS TO READLBL.         @Z40LB22*/
*   /* HOWEVER, IF AN ON BIT IS FOUND THEN PROCESSING        @Z40LB22*/
*   /* CONTINUES IN THE FOLLOWING MANNER -                   @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* A PARAMETER LIST IS BUILT IN PREPARATION TO           @Z40LB22*/
*   /* INVOKE THE MSSC MACRO ICBQUERY. IF A VALID            @Z40LB22*/
*   /* ERROR OCCURS, THEN THE CONDITION CODE                 @Z40LB22*/
*   /* IS INTERROGATED AND SAVED, AND THE LOOP               @Z40LB22*/
*   /* CONTINUES. IF THE CONDITION CODE IS NOT OF            @Z40LB22*/
*   /* THE TYPE THE READ PROCEDURE EXPECTS, A CALL           @Z40LB22*/
*   /* IS MADE TO THE AMS MACRO SSCMSG.                      @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* HOWEVER, IF THERE ARE NO ERRORS A CALL IS             @Z40LB22*/
*   /* MADE TO THE ROUTINE PRINTRDL TO FORMAT AND            @Z40LB22*/
*   /* PRINT THE LABEL, AND THE LOOP CONTINUES.              @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* THIS IS AN INFINITE LOOP AND THE ONLY WAY             @Z40LB22*/
*   /* TO GET OUT OF IT IS TO SEARCH EVERY BIT IN            @Z40LB22*/
*   /* WORKMAP AND REACH THE END OF SAME, OR HAVE            @Z40LB22*/
*   /* A RETURN CODE OF 8 (PARTIAL REPORT TO BE              @Z40LB22*/
*   /* PRINTED) OR A RETURN CODE OF 12 (NO REPORT            @Z40LB22*/
*   /* TO BE PRINTED). IN EITHER CASE A RETURN               @Z40LB22*/
*   /* IS MADE TO THE CALLER (READLBL).                      @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* INPUT -                                               @Z40LB22*/
*   /* GDTTBL                                                @Z40LB22*/
*   /* FDTTBL                                                @Z40LB22*/
*   /* WORKMAP                                               @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* OUTPUT -                                              @Z40LB22*/
*   /* READRC                                                @Z40LB22*/
*   /* 12 - FAIL ON FIRST CALL TO USSC                       @Z40LB25*/
*   /* 8 - FAIL ON OTHER THAN FIRST USSC CALL                @Z40LB25*/
*   /* DIAGBUF (CARTLAB)                                     @Z40LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1656
*READ:                                                             1656
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB22*/
*                                                                  1656
READ     ST    @14,@SA00014                                        1656
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATIONS FOR READ                              @Z40LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1657
*   READL=''B;                      /* MSF 0                 @Z40LB25*/
         L     @15,RDCKPTR                                         1657
         NI    READL(@15),B'00111111'                              1657
*   IF MSFVAL=1 THEN                                               1658
         L     @14,@PC00001+4                                      1658
         L     @01,FDTPTR+24(,@14)                                 1658
         CLC   MSFVAL(4,@01),@CF00224                              1658
         BNE   @RF01658                                            1658
*     READL2=ON;                    /* MSF 1                 @Z40LB25*/
         OI    READL2(@15),B'01000000'                             1659
*   IF MSFVAL=2 THEN                                               1660
@RF01658 L     @15,@PC00001+4                                      1660
         L     @01,FDTPTR+24(,@15)                                 1660
         CLC   MSFVAL(4,@01),@CF00158                              1660
         BNE   @RF01660                                            1660
*     READL1=ON;                    /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         1661
         OI    READL1(@01),B'10000000'                             1661
*   IF MSFVAL=3 THEN                                               1662
@RF01660 L     @15,@PC00001+4                                      1662
         L     @01,FDTPTR+24(,@15)                                 1662
         CLC   MSFVAL(4,@01),@CF00167                              1662
         BNE   @RF01662                                            1662
*     DO;                           /*                       @Z40LB25*/
*       READL1=ON;                  /*                       @Z40LB25*/
*       READL2=ON;                  /*                       @Z40LB25*/
         L     @01,RDCKPTR                                         1665
         OI    READL1(@01),B'11000000'                             1665
*     END;                          /*                       @Z40LB25*/
*                                                                  1666
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR ICBQUERY (QCEL)                                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1667
*   QUPTR=ADDR(DIAGBUF);            /* ADDR OF RETURN BUF    @Z40LB22*/
@RF01662 L     @15,@PC00001+8                                      1667
         L     @01,BLKPTR(,@15)                                    1667
         LA    @15,DIAGBUF(,@01)                                   1667
         L     @14,RDCKPTR                                         1667
         ST    @15,QUPTR(,@14)                                     1667
*   TERMINAT=OFF;                   /* LAST BIT IN WORK MAP  @Z40LB22*/
         NI    TERMINAT,B'11011111'                                1668
*                                                                  1669
*   /*****************************************************************/
*   /*                                                               */
*   /* PERFORM LOOP IN THE WORK MAP TO FIND ALL (IF ANY)     @Z40LB22*/
*   /* PRINTABLE X Y Z LOCATIONS                             @Z40LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1669
*   DO WHILE TERMINAT=OFF;          /* LOOP CONTROL          @Z40LB22*/
         B     @DE01669                                            1669
@DL01669 DS    0H                                                  1670
*     CHUNKPTR=ADDR(WRKCUBE(1));    /* ADDR OF WORK AREA     @Z40LB22*/
         L     @15,WRKMAPTR                                        1670
         LA    @14,WRKCUBE(,@15)                                   1670
         ST    @14,CHUNKPTR                                        1670
*     CELLPTR=ADDR(WRKBLK(1));      /* CELL BLOCK PTR        @Z40LB25*/
*                                                                  1671
         ST    @15,CELLPTR                                         1671
*     /***************************************************************/
*     /*                                                             */
*     /* FIND AN XYZ LOCATION                                @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1672
*     CALL BITTOLOC;                /* SEARCH WORK MAP       @Z40LB22*/
         BAL   @14,BITTOLOC                                        1672
*     IF TABLEND=ON THEN            /* END OF WORK MAP       @Z40LB22*/
         TM    TABLEND,B'00010000'                                 1673
         BO    @RT01673                                            1673
*       RETURN;                     /*                       @Z40LB25*/
*                                                                  1674
*     /***************************************************************/
*     /*                                                             */
*     /* CHANGE ANY ON BIT LOCATION TO A PRINTABLE XYZ LOC.  @Z40LB22*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1675
*     IF Z=0 THEN                   /* Z LOCATION            @Z40LB25*/
         LH    @15,Z                                               1675
         LTR   @15,@15                                             1675
         BNZ   @RF01675                                            1675
*       READZ=OFF;                  /* Z 0                   @Z40LB25*/
         L     @01,RDCKPTR                                         1676
         NI    READZ(@01),B'11011111'                              1676
*     ELSE                                                         1677
*       READZ=ON;                   /* Z 1                   @Z40LB25*/
         B     @RC01675                                            1677
@RF01675 L     @01,RDCKPTR                                         1677
         OI    READZ(@01),B'00100000'                              1677
*     READLZYX(1)=READLZYX(1)&YMASK;/* CLEAR Y LOC           @Z40LB25*/
@RC01675 L     @15,RDCKPTR                                         1678
         NC    READLZYX(1,@15),YMASK                               1678
*     READLZYX(1)=READLZYX(1)×YCHAR;/* Y LOCATION            @Z40LB22*/
         OC    READLZYX(1,@15),YCHAR                               1679
*     READX=X;                      /* X LOCATION            @Z40LB22*/
*                                                                  1680
         MVC   READX(1,@15),X+1                                    1680
*     /***************************************************************/
*     /*                                                             */
*     /* DUMP THE ICBQUERY (QCEL) PARM LIST                  @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1681
*     IF GDTDBG=NULLPTR THEN                                       1681
         L     @15,@PC00001                                        1681
         L     @15,GDTDBG(,@15)                                    1681
         LTR   @15,@15                                             1681
         BZ    @RT01681                                            1681
*       ;                                                          1682
*     ELSE                                                         1683
*       DO;                                                        1683
*         DMPINDEX=ADDR(DMPSTG);    /*                       @Z40LB25*/
         LA    DMPINDEX,DMPSTG                                     1684
*         DMPITMNM='QURYAREA';                                     1685
         MVC   DMPITMNM(8,DMPINDEX),@CC01579                       1685
*         DMPITMPT=ADDR(QURYAREA);                                 1686
         LA    @03,QURYAREA                                        1686
         ST    @03,DMPITMPT(,DMPINDEX)                             1686
*         DMPITMLN=LENGTH(QURYAREA);                               1687
         MVC   DMPITMLN(2,DMPINDEX),@CH00813                       1687
*         DMPITMTP='H';                                            1688
         MVI   DMPITMTP(DMPINDEX),C'H'                             1688
*         DMPINDEX=DMPINDEX+DMPELEMT;/*                      @Z40LB25*/
         AL    DMPINDEX,@CF00479                                   1689
*         DMPTRM=DMPTRMVL;                                         1690
         MVI   DMPTRM(DMPINDEX),X'FF'                              1690
*       END;                        /*                       @Z40LB25*/
*     IF GDTDBG=NULLPTR THEN                                       1692
@RT01681 L     @15,@PC00001                                        1692
         L     @15,GDTDBG(,@15)                                    1692
         LTR   @15,@15                                             1692
         BZ    @RT01692                                            1692
*       ;                                                          1693
*     ELSE                                                         1694
*       CALL IDCDB010(GDTTBL,'AUCC',ADDR(DMPSTG));/*         @Z40LB25*/
*                                                                  1694
         L     @15,@PC00001                                        1694
         ST    @15,@AL00001                                        1694
         LA    @14,@CC01602                                        1694
         ST    @14,@AL00001+4                                      1694
         LA    @14,DMPSTG                                          1694
         ST    @14,@AFTEMPS+4                                      1694
         LA    @14,@AFTEMPS+4                                      1694
         ST    @14,@AL00001+8                                      1694
         MVI   @AL00001+8,X'80'                                    1694
         L     @15,GDTDBG(,@15)                                    1694
         LA    @01,@AL00001                                        1694
         BALR  @14,@15                                             1694
*     /***************************************************************/
*     /*                                                             */
*     /* INVOKE THE EXECUTE FORM OF THE ICBQUERY MACRO       @Z40LB22*/
*     /* WITH TYPE = QLAB                                    @Z40LB22*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1695
*     CALL IDCSASS0(GDTTBL,RDCARTLB,RDCKPTR,REASONCD);/*     @Z40LB22*/
@RT01692 L     @02,@PC00001                                        1695
         ST    @02,@AL00001                                        1695
         LA    @15,RDCARTLB                                        1695
         ST    @15,@AL00001+4                                      1695
         LA    @15,RDCKPTR                                         1695
         ST    @15,@AL00001+8                                      1695
         LA    @15,REASONCD                                        1695
         ST    @15,@AL00001+12                                     1695
         MVI   @AL00001+12,X'80'                                   1695
         L     @15,GDTSSC(,@02)                                    1695
         LA    @01,@AL00001                                        1695
         BALR  @14,@15                                             1695
*     RESPECIFY                                                    1696
*       RTNREG RSTD;                                               1696
*     TESTRC=RTNREG;                                               1697
         LR    TESTRC,RTNREG                                       1697
*     RESPECIFY                                                    1698
*       RTNREG UNRSTD;              /*                       @Z40LB22*/
*     IF TESTRC=0 THEN                                             1699
         LTR   TESTRC,TESTRC                                       1699
         BNZ   @RF01699                                            1699
*       DO;                         /* ARE THERE ANY ERRORS? @Z40LB22*/
*                                                                  1700
*         /***********************************************************/
*         /*                                                         */
*         /* PRINT THE CARTRIDGE LABEL                       @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1701
*         CALL PRINTRDL;            /* FORMAT AND PRINT LABEL      1701
*                                                            @Z40LB22*/
         BAL   @14,PRINTRDL                                        1701
*         FRSTUSSC=ON;              /* QLAB EXECUTED ONCE    @Z40LB22*/
         OI    FRSTUSSC,B'00000001'                                1702
*         LABELRD=ON;               /* LABEL WAS READ        @Z40LB25
*                                      PUT TO LABEL D.S.     @Z40LB25*/
         OI    LABELRD,B'01000000'                                 1703
*       END;                        /*                       @Z40LB22*/
*                                                                  1704
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR REASON CODE HEX 55 FROM THE MSC           @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1705
*     IF REASONCD=VACTCELL THEN                                    1705
@RF01699 L     @02,REASONCD                                        1705
         SLR   @15,@15                                             1705
         IC    @15,VACTCELL                                        1705
         CR    @02,@15                                             1705
         BNE   @RF01705                                            1705
*       DO;                         /* VACANT CELL?          @Z40LB22*/
*         CHUNKPTR=ADDR(XYZ1CUBE(1));/* AN ERROR FOR XZY1    @Z40LB22*/
         L     @15,XYZ1PTR                                         1707
         LA    @14,XYZ1CUBE(,@15)                                  1707
         ST    @14,CHUNKPTR                                        1707
*         CELLPTR=ADDR(XYZ1BLK(1)); /*                       @Z40LB25*/
*                                                                  1708
         ST    @15,CELLPTR                                         1708
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE LOCATION TO AN ON BIT IN XYZ1       @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1709
*         CALL LOCTOBIT;            /* PUT THE RESULTS INTO  @Z40LB22
*                                      A WORK AREA           @Z40LB22*/
         BAL   @14,LOCTOBIT                                        1709
*         TESTRC=0;                 /* RESET THE REASON CODE @Z40LB22*/
         SLR   @15,@15                                             1710
         LR    TESTRC,@15                                          1710
*         REASONCD=0;               /*                       @Z40LB25*/
         ST    @15,REASONCD                                        1711
*         PRTXYZ1=ON;               /* RESET THE XYZ1 FLAG   @Z40LB22*/
*                                                                  1712
         OI    PRTXYZ1,B'01000000'                                 1712
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF SUBTITLE TO BE PRINTED                 @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1713
*         IF RDTITLE=OFF THEN                                      1713
         TM    RDTITLE,B'00001000'                                 1713
         BNZ   @RF01713                                            1713
*           DO;                     /*                       @Z40LB25*/
*             IF ADDR(NLIST)^=NULLPTR THEN                         1715
         L     @02,@PC00001+4                                      1715
         C     @15,FDTPTR+68(,@02)                                 1715
         BE    @RF01715                                            1715
*               DO;                 /*                       @Z40LB25*/
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1717
         C     @15,FDTPTR+28(,@02)                                 1717
         BE    @RF01717                                            1717
*                   HDRDID17=ON;    /*                       @Z40LB25*/
         OI    HDRDID17,B'10000000'                                1718
*                 IF ADDR(CELL)^=NULLPTR THEN                      1719
@RF01717 L     @02,@PC00001+4                                      1719
         L     @02,FDTPTR+40(,@02)                                 1719
         LTR   @02,@02                                             1719
         BZ    @RF01719                                            1719
*                   HDRDID19=ON;    /*                       @Z40LB25*/
         OI    HDRDID19,B'00100000'                                1720
*               END;                /*                       @Z40LB25*/
@RF01719 DS    0H                                                  1722
*             IF ADDR(LIST)^=NULLPTR THEN                          1722
@RF01715 SLR   @02,@02                                             1722
         L     @15,@PC00001+4                                      1722
         C     @02,FDTPTR+64(,@15)                                 1722
         BE    @RF01722                                            1722
*               DO;                 /*                       @Z40LB25*/
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1724
         C     @02,FDTPTR+28(,@15)                                 1724
         BE    @RF01724                                            1724
*                   HDRDID18=ON;    /*                       @Z40LB25*/
         OI    HDRDID18,B'01000000'                                1725
*                 IF ADDR(CELL)^=NULLPTR THEN                      1726
@RF01724 L     @02,@PC00001+4                                      1726
         L     @02,FDTPTR+40(,@02)                                 1726
         LTR   @02,@02                                             1726
         BZ    @RF01726                                            1726
*                   HDRDID35=ON;    /*                       @Z40LB25*/
         OI    HDRDID35,B'00010000'                                1727
*               END;                /*                       @Z40LB25*/
@RF01726 DS    0H                                                  1729
*             RDTITLE=ON;           /*                       @Z40LB25*/
@RF01722 OI    RDTITLE,B'00001000'                                 1729
*           END;                    /*                       @Z40LB25*/
*         FRSTUSSC=ON;              /* QLAB EXECUTED ONCE    @Z40LB22*/
@RF01713 OI    FRSTUSSC,B'00000001'                                1731
*       END;                        /*                       @Z40LB22*/
*                                                                  1732
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR REASON CODE HEX 5E FROM THE MSC           @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1733
*     IF REASONCD=NOACCRT THEN                                     1733
@RF01705 L     @02,REASONCD                                        1733
         SLR   @15,@15                                             1733
         IC    @15,NOACCRT                                         1733
         CR    @02,@15                                             1733
         BNE   @RF01733                                            1733
*       DO;                         /* CART NOT ACCESSED?    @Z40LB22*/
*         CHUNKPTR=ADDR(XYZ2CUBE(1));/* AN ERROR FOR XZY2    @Z40LB22*/
         L     @15,XYZ2PTR                                         1735
         LA    @14,XYZ2CUBE(,@15)                                  1735
         ST    @14,CHUNKPTR                                        1735
*         CELLPTR=ADDR(XYZ2BLK(1)); /*                       @Z40LB25*/
*                                                                  1736
         ST    @15,CELLPTR                                         1736
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE LOCATION TO AN ON BIT IN XYZ2       @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1737
*         CALL LOCTOBIT;            /* PUT THE RESULTS INTO  @Z40LB22
*                                      A WORK AREA           @Z40LB22*/
         BAL   @14,LOCTOBIT                                        1737
*         TESTRC=0;                 /* RESET THE REASON CODE @Z40LB22*/
         SLR   @15,@15                                             1738
         LR    TESTRC,@15                                          1738
*         REASONCD=0;               /*                       @Z40LB25*/
         ST    @15,REASONCD                                        1739
*         PRTXYZ2=ON;               /* RESET THE XYZ2 FLAG   @Z40LB22*/
*                                                                  1740
         OI    PRTXYZ2,B'00100000'                                 1740
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF SUBTITLE TO BE PRINTED                 @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1741
*         IF RDTITLE=OFF THEN                                      1741
         TM    RDTITLE,B'00001000'                                 1741
         BNZ   @RF01741                                            1741
*           DO;                     /*                       @Z40LB25*/
*             IF ADDR(NLIST)^=NULLPTR THEN                         1743
         L     @02,@PC00001+4                                      1743
         C     @15,FDTPTR+68(,@02)                                 1743
         BE    @RF01743                                            1743
*               DO;                 /*                       @Z40LB25*/
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1745
         C     @15,FDTPTR+28(,@02)                                 1745
         BE    @RF01745                                            1745
*                   HDRDID17=ON;    /*                       @Z40LB25*/
         OI    HDRDID17,B'10000000'                                1746
*                 IF ADDR(CELL)^=NULLPTR THEN                      1747
@RF01745 L     @02,@PC00001+4                                      1747
         L     @02,FDTPTR+40(,@02)                                 1747
         LTR   @02,@02                                             1747
         BZ    @RF01747                                            1747
*                   HDRDID19=ON;    /*                       @Z40LB25*/
         OI    HDRDID19,B'00100000'                                1748
*               END;                /*                       @Z40LB25*/
@RF01747 DS    0H                                                  1750
*             IF ADDR(LIST)^=NULLPTR THEN                          1750
@RF01743 SLR   @02,@02                                             1750
         L     @15,@PC00001+4                                      1750
         C     @02,FDTPTR+64(,@15)                                 1750
         BE    @RF01750                                            1750
*               DO;                 /*                       @Z40LB25*/
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1752
         C     @02,FDTPTR+28(,@15)                                 1752
         BE    @RF01752                                            1752
*                   HDRDID18=ON;    /*                       @Z40LB25*/
         OI    HDRDID18,B'01000000'                                1753
*                 IF ADDR(CELL)^=NULLPTR THEN                      1754
@RF01752 L     @02,@PC00001+4                                      1754
         L     @02,FDTPTR+40(,@02)                                 1754
         LTR   @02,@02                                             1754
         BZ    @RF01754                                            1754
*                   HDRDID35=ON;    /*                       @Z40LB25*/
         OI    HDRDID35,B'00010000'                                1755
*               END;                /*                       @Z40LB25*/
@RF01754 DS    0H                                                  1757
*             RDTITLE=ON;           /*                       @Z40LB25*/
@RF01750 OI    RDTITLE,B'00001000'                                 1757
*           END;                    /*                       @Z40LB25*/
*         FRSTUSSC=ON;              /* QLAB EXECUTED ONCE    @Z40LB25*/
@RF01741 OI    FRSTUSSC,B'00000001'                                1759
*       END;                        /*                       @Z40LB22*/
*                                                                  1760
*     /***************************************************************/
*     /*                                                             */
*     /* IF ERRORS ARE NOT FOR XYZ1 OR XYZ2 WORKAREAS,       @Z40LB22*/
*     /* THEN CALL SSCMSG AND PASS THE REASON CODE           @Z40LB22*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1761
*     IF TESTRC=4 THEN                                             1761
@RF01733 C     TESTRC,@CF00047                                     1761
         BNE   @RF01761                                            1761
*       CALL SSCMSG(REASONCD);      /* A REAL HDWR ERROR     @Z40LB22*/
         LA    @02,REASONCD                                        1762
         ST    @02,@AL00001                                        1762
         LA    @01,@AL00001                                        1762
         BAL   @14,SSCMSG                                          1762
*     IF TESTRC=4 THEN                                             1763
@RF01761 C     TESTRC,@CF00047                                     1763
         BNE   @RF01763                                            1763
*       DO;                         /* CHECK FOR OTHER ERRORS      1764
*                                                            @Z40LB22*/
*         IF FRSTUSSC=OFF THEN                                     1765
         TM    FRSTUSSC,B'00000001'                                1765
         BNZ   @RF01765                                            1765
*           READRC=LASTCC12;        /* NO REPORTS TO BE PRINTED    1766
*                                                            @Z40LB22*/
         MVC   READRC(2),@CH00571                                  1766
*         ELSE                                                     1767
*           READRC=LASTCC08;        /* SOME REPORTS TO BE    @Z40LB22
*                                      PRINTED               @Z40LB22*/
         B     @RC01765                                            1767
@RF01765 MVC   READRC(2),@CH00184                                  1767
*         RETURN;                   /*                       @Z40LB25*/
@EL00014 DS    0H                                                  1768
@EF00014 DS    0H                                                  1768
@ER00014 L     @14,@SA00014                                        1768
         BR    @14                                                 1768
*       END;                        /*                       @Z40LB22*/
*                                                                  1769
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR A LABEL DATA SET                          @Z40LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1770
*     IF LABDSPTR^=NULLPTR&LABELRD=ON THEN                         1770
@RF01763 L     @15,@PC00001+16                                     1770
         L     @14,LABDSPTR(,@15)                                  1770
         LTR   @14,@14                                             1770
         BZ    @RF01770                                            1770
         TM    LABELRD,B'01000000'                                 1770
         BNO   @RF01770                                            1770
*       DO;                         /*                       @Z40LB22*/
*         IOCSPTR=LABDSPTR;         /* LABEL DATA SET        @Z40LB25*/
         LR    IOCSPTR,@14                                         1772
*         IOCDAD=ADDR(RECDBUF);     /* ADDR OF RECORD BUFFER @Z40LB22*/
         L     @14,@PC00001+8                                      1773
         L     @01,BLKPTR(,@14)                                    1773
         LA    @14,RECDBUF(,@01)                                   1773
         ST    @14,IOCDAD(,IOCSPTR)                                1773
*         IOCDLN=LENGTH(RECDBUF);   /* LENGTH OF BUFFER      @Z40LB22*/
*                                                                  1774
         MVC   IOCDLN(4,IOCSPTR),@CF01398                          1774
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE THE AMS UPUT MACRO TO PRINT THE LABEL     @Z40LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1775
*         CALL IDCIOPT0(GDTTBL,LABDSPTR);/*                  @Z40LB22*/
         L     @02,@PC00001                                        1775
         ST    @02,@AL00001                                        1775
         ST    @15,@AL00001+4                                      1775
         MVI   @AL00001+4,X'80'                                    1775
         L     @15,GDTPUT(,@02)                                    1775
         LA    @01,@AL00001                                        1775
         BALR  @14,@15                                             1775
*         RESPECIFY                                                1776
*           RTNREG RSTD;                                           1776
*         TESTRC=RTNREG;                                           1777
         LR    TESTRC,RTNREG                                       1777
*         RESPECIFY                                                1778
*           RTNREG UNRSTD;          /*                       @Z40LB22*/
*                                                                  1778
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK THE RETURN CODE, IF A NON-ZERO, THEN ZERO @Z40LB22*/
*         /* THE LABEL DATA SET POINTER AND RETURN           @Z40LB22*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1779
*         IF TESTRC^=0 THEN                                        1779
         SLR   @02,@02                                             1779
         CR    TESTRC,@02                                          1779
         BE    @RF01779                                            1779
*           LABDSPTR=NULLPTR;       /*                       @Z40LB22*/
         L     @03,@PC00001+16                                     1780
         ST    @02,LABDSPTR(,@03)                                  1780
*         LABELRD=OFF;              /* OFF FOR NEXT RD       @Z40LB25*/
@RF01779 NI    LABELRD,B'10111111'                                 1781
*       END;                        /*                       @Z40LB22*/
*   END;                            /*                       @Z40LB22*/
@RF01770 DS    0H                                                  1783
@DE01669 TM    TERMINAT,B'00100000'                                1783
         BZ    @DL01669                                            1783
*   END READ;                       /*                       @Z40LB22*/
         B     @EL00014                                            1784
*                                                                  1785
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PRINTRDL                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - HAS THE SUBTITLE AND HEADER PRINTED FOR    @Z40LB25*/
*   /* THE CARTRIDGE LABEL INFORMATION PART OF THE           @Z40LB25*/
*   /* READ LABEL REPORT. DEPENDING ON WHETHER LIST OR       @Z40LB25*/
*   /* NOLIST IS SPECIFIED, THE APPROPRIATE LABEL            @Z40LB25*/
*   /* INFORMATION IS PRINTED.                               @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* RECDBUF (CARTLAB)                                     @Z40LB25*/
*   /* X                                                     @Z40LB25*/
*   /* Y                                                     @Z40LB25*/
*   /* Z                                                     @Z40LB25*/
*   /* MSFVAL                                                @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* A READ LABEL REPORT SUBTITLE                          @Z40LB25*/
*   /* READ LABEL REPORT HEADERS                             @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1785
*PRINTRDL:                                                         1785
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
*                                                                  1785
PRINTRDL ST    @14,@SA00015                                        1785
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP CTOC INFORMATION FOR PRINTING                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1786
*   LABELL=0;                       /* MSF 0                 @Z40LB25*/
         MVI   LABELL,X'00'                                        1786
*   IF CARL1=OFF&CARL2=ON THEN                                     1787
         L     @02,@PC00001+8                                      1787
         L     @02,BLKPTR(,@02)                                    1787
         TM    CARL2(@02),B'01000000'                              1787
         BNO   @RF01787                                            1787
         TM    CARL1(@02),B'10000000'                              1787
         BNZ   @RF01787                                            1787
*     LABELL=1;                     /* MSF 1                 @Z40LB25*/
         MVI   LABELL,X'01'                                        1788
*   IF CARL1=ON&CARL2=OFF THEN                                     1789
@RF01787 L     @02,@PC00001+8                                      1789
         L     @02,BLKPTR(,@02)                                    1789
         TM    CARL1(@02),B'10000000'                              1789
         BNO   @RF01789                                            1789
         TM    CARL2(@02),B'01000000'                              1789
         BNZ   @RF01789                                            1789
*     LABELL=2;                     /*                       @Z40LB25*/
         MVI   LABELL,X'02'                                        1790
*   IF CARL1=ON&CARL2=ON THEN                                      1791
@RF01789 L     @02,@PC00001+8                                      1791
         L     @02,BLKPTR(,@02)                                    1791
         TM    CARL1(@02),B'11000000'                              1791
         BNO   @RF01791                                            1791
*     LABELL=3;                     /*                       @Z40LB25*/
         MVI   LABELL,X'03'                                        1792
*   LABELZ=0;                       /* Z LOC = 0             @Z40LB25*/
@RF01791 MVI   LABELZ,X'00'                                        1793
*   IF CARADDRZ=ON THEN                                            1794
         L     @02,@PC00001+8                                      1794
         L     @02,BLKPTR(,@02)                                    1794
         TM    CARADDRZ(@02),B'00100000'                           1794
         BNO   @RF01794                                            1794
*     LABELZ=1;                     /* Z LOC = 1             @Z40LB25*/
         MVI   LABELZ,X'01'                                        1795
*   LABELY=ANDY&CARADDR(1:8);       /* Y LOC                 @Z40LB25*/
@RF01794 L     @02,@PC00001+8                                      1796
         L     @02,BLKPTR(,@02)                                    1796
         SLR   @15,@15                                             1796
         IC    @15,ANDY                                            1796
         SLR   @14,@14                                             1796
         IC    @14,CARADDR(,@02)                                   1796
         NR    @15,@14                                             1796
         STC   @15,LABELY                                          1796
*   LABELX=CARADDRX;                /* X LOC                 @Z40LB25*/
*                                                                  1797
         SLR   @14,@14                                             1797
         IC    @14,CARADDRX(,@02)                                  1797
         STC   @14,LABELX                                          1797
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR NOLIST WITH A DESCREPANCY                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1798
*   IF ADDR(NLIST)^=NULLPTR&(LABELL^=MSFVAL×LABELZ^=Z×LABELY^=Y×LABELX
*       ^=X) THEN                                                  1798
         L     @02,@PC00001+4                                      1798
         L     @07,FDTPTR+68(,@02)                                 1798
         LTR   @07,@07                                             1798
         BZ    @RF01798                                            1798
         L     @02,FDTPTR+24(,@02)                                 1798
         SLR   @07,@07                                             1798
         IC    @07,LABELL                                          1798
         C     @07,MSFVAL(,@02)                                    1798
         BNE   @RT01798                                            1798
         SLR   @02,@02                                             1798
         IC    @02,LABELZ                                          1798
         CH    @02,Z                                               1798
         BNE   @RT01798                                            1798
         C     @15,Y                                               1798
         BNE   @RT01798                                            1798
         CH    @14,X                                               1798
         BE    @RF01798                                            1798
@RT01798 DS    0H                                                  1799
*     DO;                           /*                       @Z40LB25*/
*                                                                  1799
*       /*************************************************************/
*       /*                                                           */
*       /* NEED TO PRINT SUBTITLE AND HEADERS?               @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1800
*       IF RDTITLE=OFF THEN                                        1800
         TM    RDTITLE,B'00001000'                                 1800
         BNZ   @RF01800                                            1800
*         DO;                       /*                       @Z40LB25*/
*           IF ADDR(XRNG)^=NULLPTR THEN                            1802
         L     @02,@PC00001+4                                      1802
         L     @02,FDTPTR+28(,@02)                                 1802
         LTR   @02,@02                                             1802
         BZ    @RF01802                                            1802
*             HDRDID17=ON;          /*                       @Z40LB25*/
         OI    HDRDID17,B'10000000'                                1803
*           IF ADDR(CELL)^=NULLPTR THEN                            1804
@RF01802 L     @02,@PC00001+4                                      1804
         L     @02,FDTPTR+40(,@02)                                 1804
         LTR   @02,@02                                             1804
         BZ    @RF01804                                            1804
*             HDRDID19=ON;          /*                       @Z40LB25*/
*                                                                  1805
         OI    HDRDID19,B'00100000'                                1805
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE SUBTITLE                            @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1806
*           CALL HEADSET;           /*                       @Z40LB25*/
@RF01804 BAL   @14,HEADSET                                         1806
*           RDTITLE=ON;             /*                       @Z40LB25*/
         OI    RDTITLE,B'00001000'                                 1807
*         END;                      /*                       @Z40LB25*/
*                                                                  1808
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF HEADERS TO BE PRINTED                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1809
*       IF RDHEAD=OFF THEN                                         1809
@RF01800 TM    RDHEAD,B'00000100'                                  1809
         BNZ   @RF01809                                            1809
*         DO;                       /*                       @Z40LB25*/
*           HDRDID38=ON;            /*                       @Z40LB25*/
*                                                                  1811
         OI    HDRDID38,B'10000000'                                1811
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT HEADERS                                 @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1812
*           CALL HEADSET;           /*                       @Z40LB25*/
         BAL   @14,HEADSET                                         1812
*           RDHEAD=ON;              /*                       @Z40LB25*/
         OI    RDHEAD,B'00000100'                                  1813
*           RLBLPRTD=ON;            /* LABEL WAS PRINTED     @Z40LB25*/
         OI    RLBLPRTD,B'10000000'                                1814
*         END;                      /*                       @Z40LB25*/
*                                                                  1815
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT THE LABEL                                   @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1816
*       CALL PRTLABEL;              /*                       @Z40LB25*/
@RF01809 BAL   @14,PRTLABEL                                        1816
*     END;                          /*                       @Z40LB25*/
*                                                                  1817
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR LIST                                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1818
*   IF ADDR(LIST)^=NULLPTR THEN                                    1818
@RF01798 SLR   @02,@02                                             1818
         L     @15,@PC00001+4                                      1818
         C     @02,FDTPTR+64(,@15)                                 1818
         BE    @RF01818                                            1818
*     DO;                           /*                       @Z40LB25*/
*                                                                  1819
*       /*************************************************************/
*       /*                                                           */
*       /* NEED TO PRINT SUBTITLE AND HEADERS?               @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1820
*       IF RDTITLE=OFF THEN                                        1820
         TM    RDTITLE,B'00001000'                                 1820
         BNZ   @RF01820                                            1820
*         DO;                       /*                       @Z40LB25*/
*           IF ADDR(XRNG)^=NULLPTR THEN                            1822
         C     @02,FDTPTR+28(,@15)                                 1822
         BE    @RF01822                                            1822
*             HDRDID18=ON;          /*                       @Z40LB25*/
         OI    HDRDID18,B'01000000'                                1823
*           IF ADDR(CELL)^=NULLPTR THEN                            1824
@RF01822 L     @02,@PC00001+4                                      1824
         L     @02,FDTPTR+40(,@02)                                 1824
         LTR   @02,@02                                             1824
         BZ    @RF01824                                            1824
*             HDRDID35=ON;          /*                       @Z40LB25*/
*                                                                  1825
         OI    HDRDID35,B'00010000'                                1825
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE SUBTITLE                            @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1826
*           CALL HEADSET;           /*                       @Z40LB25*/
@RF01824 BAL   @14,HEADSET                                         1826
*           RDTITLE=ON;             /*                       @Z40LB25*/
         OI    RDTITLE,B'00001000'                                 1827
*         END;                      /*                       @Z40LB25*/
*                                                                  1828
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF HEADERS TO BE PRINTED                    @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1829
*       IF RDHEAD=OFF THEN                                         1829
@RF01820 TM    RDHEAD,B'00000100'                                  1829
         BNZ   @RF01829                                            1829
*         DO;                       /*                       @Z40LB25*/
*           HDRDID39=ON;            /*                       @Z40LB25*/
*                                                                  1831
         OI    HDRDID39,B'10000000'                                1831
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT HEADERS                                 @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1832
*           CALL HEADSET;           /*                       @Z40LB25*/
         BAL   @14,HEADSET                                         1832
*           RDHEAD=ON;              /*                       @Z40LB25*/
         OI    RDHEAD,B'00000100'                                  1833
*           RLBLPRTD=ON;            /* LABEL WAS PRINTED     @Z40LB25*/
         OI    RLBLPRTD,B'10000000'                                1834
*         END;                      /*                       @Z40LB25*/
*                                                                  1835
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT THE LABEL                                   @Z40LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1836
*       CALL PRTLABEL;              /*                       @Z40LB25*/
@RF01829 BAL   @14,PRTLABEL                                        1836
*     END;                          /*                       @Z40LB25*/
*   RETURN;                         /*                       @Z40LB25*/
@EL00015 DS    0H                                                  1838
@EF00015 DS    0H                                                  1838
@ER00015 L     @14,@SA00015                                        1838
         BR    @14                                                 1838
*   END PRINTRDL;                   /*                       @Z40LB25*/
         B     @EL00015                                            1839
*                                                                  1840
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PRTLABEL                             @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* FUNCTION - FORMATS AND PRINTS THE CARTRIDGE LABEL     @Z40LB25*/
*   /* FOR OCCUPIED CELLS OR CARTRIDGE LABELS                @Z40LB25*/
*   /* CONTAINING INCORRECT CELL LOCATIONS.                  @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* INPUT -                                               @Z40LB25*/
*   /* GDT                                                   @Z40LB25*/
*   /* FDT                                                   @Z40LB25*/
*   /* RECDBUF (CARTLAB)                                     @Z40LB25*/
*   /* X                                                     @Z40LB25*/
*   /* Y                                                     @Z40LB25*/
*   /* Z                                                     @Z40LB25*/
*   /*                                                       @Z40LB25*/
*   /* OUTPUT -                                              @Z40LB25*/
*   /* A READ LABEL REPORT ENTRY FOR SECTION -               @Z40LB25*/
*   /* OCCUPIED CELLS OR                                     @Z40LB25*/
*   /* CARTRIDGE LABELS CONTAINING INCORRECT                 @Z40LB25*/
*   /* CELL LOCATIONS                                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1840
*PRTLABEL:                                                         1840
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/
PRTLABEL ST    @14,@SA00016                                        1840
*   PRINTAB=''B;                    /*                       @Z40LB25*/
         XC    PRINTAB(164),PRINTAB                                1841
*   DARGCNT=13;                     /*                       @Z40LB25*/
         L     @02,DDSTRU                                          1842
         MVC   DARGCNT(2,@02),@CH01099                             1842
*   DARGSMOD=AUDMSG;                /*                       @Z40LB25*/
         MVC   DARGSMOD(3,@02),@CC01440                            1843
*   DARGSENT=LABELS;                /*                       @Z40LB25*/
*                                                                  1844
         MVI   DARGSENT(@02),X'30'                                 1844
*   /*****************************************************************/
*   /*                                                               */
*   /* USER REQUESTED X                                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1845
*   DARGINS(1)=1;                   /*                       @Z40LB25*/
         LA    @15,1                                               1845
         STH   @15,DARGINS(,@02)                                   1845
*   DARGINL(1)=LENGTH(X);           /*                       @Z40LB25*/
         LA    @14,2                                               1846
         STH   @14,DARGINL(,@02)                                   1846
*   DARGDTM(1)=ADDR(X);             /*                       @Z40LB25*/
*                                                                  1847
         LA    @07,X                                               1847
         ST    @07,DARGDTM(,@02)                                   1847
*   /*****************************************************************/
*   /*                                                               */
*   /* USER REQUESTED Y                                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1848
*   DARGINS(2)=2;                   /*                       @Z40LB25*/
         STH   @14,DARGINS+8(,@02)                                 1848
*   DARGINL(2)=LENGTH(Y);           /*                       @Z40LB25*/
         LA    @07,4                                               1849
         STH   @07,DARGINL+8(,@02)                                 1849
*   DARGDTM(2)=ADDR(Y);             /*                       @Z40LB25*/
*                                                                  1850
         LA    @06,Y                                               1850
         ST    @06,DARGDTM+8(,@02)                                 1850
*   /*****************************************************************/
*   /*                                                               */
*   /* USER REQUESTED Z                                      @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1851
*   DARGINS(3)=3;                   /*                       @Z40LB25*/
         MVC   DARGINS+16(2,@02),@CH00167                          1851
*   DARGINL(3)=LENGTH(Z);           /*                       @Z40LB25*/
         STH   @14,DARGINL+16(,@02)                                1852
*   DARGDTM(3)=ADDR(Z);             /*                       @Z40LB25*/
*                                                                  1853
         LA    @14,Z                                               1853
         ST    @14,DARGDTM+16(,@02)                                1853
*   /*****************************************************************/
*   /*                                                               */
*   /* MISMATCH?                                             @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1854
*   DARGINS(4)=4;                   /*                       @Z40LB25*/
         STH   @07,DARGINS+24(,@02)                                1854
*   DARGINL(4)=LENGTH(ASTERIC);     /*                       @Z40LB25*/
         STH   @15,DARGINL+24(,@02)                                1855
*   IF ADDR(LIST)^=NULLPTR&(LABELL^=MSFVAL×LABELZ^=Z×LABELY^=Y×LABELX^=
*       X) THEN                                                    1856
         L     @02,@PC00001+4                                      1856
         L     @15,FDTPTR+64(,@02)                                 1856
         LTR   @15,@15                                             1856
         BZ    @RF01856                                            1856
         L     @02,FDTPTR+24(,@02)                                 1856
         SLR   @15,@15                                             1856
         IC    @15,LABELL                                          1856
         C     @15,MSFVAL(,@02)                                    1856
         BNE   @RT01856                                            1856
         SLR   @02,@02                                             1856
         IC    @02,LABELZ                                          1856
         CH    @02,Z                                               1856
         BNE   @RT01856                                            1856
         SLR   @02,@02                                             1856
         IC    @02,LABELY                                          1856
         C     @02,Y                                               1856
         BNE   @RT01856                                            1856
         SLR   @02,@02                                             1856
         IC    @02,LABELX                                          1856
         CH    @02,X                                               1856
         BE    @RF01856                                            1856
@RT01856 DS    0H                                                  1857
*     DARGDTM(4)=ADDR(ASTERIC);     /*                       @Z40LB25*/
         LA    @02,ASTERIC                                         1857
         L     @01,DDSTRU                                          1857
         ST    @02,DARGDTM+24(,@01)                                1857
*   ELSE                                                           1858
*     DARGDTM(4)=ADDR(BLANK);       /*                       @Z40LB25*/
*                                                                  1858
         B     @RC01856                                            1858
@RF01856 LA    @02,BLANK                                           1858
         L     @01,DDSTRU                                          1858
         ST    @02,DARGDTM+24(,@01)                                1858
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC X                                                @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1859
*   DARGINS(5)=5;                   /*                       @Z40LB25*/
@RC01856 L     @02,DDSTRU                                          1859
         MVC   DARGINS+32(2,@02),@CH00291                          1859
*   DARGINL(5)=LENGTH(LABELX);      /*                       @Z40LB25*/
         LA    @15,1                                               1860
         STH   @15,DARGINL+32(,@02)                                1860
*   DARGDTM(5)=ADDR(LABELX);        /*                       @Z40LB25*/
*                                                                  1861
         LA    @14,LABELX                                          1861
         ST    @14,DARGDTM+32(,@02)                                1861
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC Y                                                @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1862
*   DARGINS(6)=6;                   /*                       @Z40LB25*/
         MVC   DARGINS+40(2,@02),@CH00161                          1862
*   DARGINL(6)=LENGTH(LABELY);      /*                       @Z40LB25*/
         STH   @15,DARGINL+40(,@02)                                1863
*   DARGDTM(6)=ADDR(LABELY);        /*                       @Z40LB25*/
*                                                                  1864
         LA    @14,LABELY                                          1864
         ST    @14,DARGDTM+40(,@02)                                1864
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC Z                                                @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1865
*   DARGINS(7)=7;                   /*                       @Z40LB25*/
         MVC   DARGINS+48(2,@02),@CH00663                          1865
*   DARGINL(7)=LENGTH(LABELZ);      /*                       @Z40LB25*/
         STH   @15,DARGINL+48(,@02)                                1866
*   DARGDTM(7)=ADDR(LABELZ);        /*                       @Z40LB25*/
*                                                                  1867
         LA    @14,LABELZ                                          1867
         ST    @14,DARGDTM+48(,@02)                                1867
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC MSF                                              @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1868
*   DARGINS(8)=8;                   /*                       @Z40LB25*/
         MVC   DARGINS+56(2,@02),@CH00184                          1868
*   DARGINL(8)=LENGTH(LABELL);      /*                       @Z40LB25*/
         STH   @15,DARGINL+56(,@02)                                1869
*   DARGDTM(8)=ADDR(LABELL);        /*                       @Z40LB25*/
*                                                                  1870
         LA    @15,LABELL                                          1870
         ST    @15,DARGDTM+56(,@02)                                1870
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC CSN1                                             @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1871
*   DARGINS(9)=9;                   /*                       @Z40LB25*/
         MVC   DARGINS+64(2,@02),@CH01086                          1871
*   DARGINL(9)=LENGTH(CARCSN1);     /*                       @Z40LB25*/
         LA    @15,12                                              1872
         STH   @15,DARGINL+64(,@02)                                1872
*   DARGDTM(9)=ADDR(CARCSN1);       /*                       @Z40LB25*/
*                                                                  1873
         L     @14,@PC00001+8                                      1873
         L     @14,BLKPTR(,@14)                                    1873
         LA    @07,CARCSN1(,@14)                                   1873
         ST    @07,DARGDTM+64(,@02)                                1873
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC CSN2, IF VALID                                   @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1874
*   DARGINS(10)=10;                 /*                       @Z40LB25*/
         MVC   DARGINS+72(2,@02),@CH00449                          1874
*   DARGINL(10)=LENGTH(CARCSN2);    /*                       @Z40LB25*/
         STH   @15,DARGINL+72(,@02)                                1875
*   IF CARSEQ='2'×CARTSCRC=ON×CARTCE=ON THEN                       1876
         CLI   CARSEQ(@14),C'2'                                    1876
         BE    @RT01876                                            1876
         TM    CARTSCRC(@14),B'10001000'                           1876
         BZ    @RF01876                                            1876
@RT01876 DS    0H                                                  1877
*     DARGDTM(10)=ADDR(BLANK12);    /*                       @Z40LB25*/
         LA    @02,BLANK12                                         1877
         L     @01,DDSTRU                                          1877
         ST    @02,DARGDTM+72(,@01)                                1877
*   ELSE                                                           1878
*     DARGDTM(10)=ADDR(CARCSN2);    /*                       @Z40LB25*/
*                                                                  1878
         B     @RC01876                                            1878
@RF01876 L     @02,@PC00001+8                                      1878
         L     @02,BLKPTR(,@02)                                    1878
         LA    @02,CARCSN2(,@02)                                   1878
         L     @01,DDSTRU                                          1878
         ST    @02,DARGDTM+72(,@01)                                1878
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC SEQUENCE NUMBER                                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1879
*   DARGINS(11)=11;                 /*                       @Z40LB25*/
@RC01876 L     @02,DDSTRU                                          1879
         MVC   DARGINS+80(2,@02),@CH01093                          1879
*   DARGINL(11)=LENGTH(CARSEQ);     /*                       @Z40LB25*/
         MVC   DARGINL+80(2,@02),@CH00224                          1880
*   IF CARTSCRC=ON×CARTCE=ON THEN                                  1881
         L     @15,@PC00001+8                                      1881
         L     @01,BLKPTR(,@15)                                    1881
         TM    CARTSCRC(@01),B'10001000'                           1881
         BZ    @RF01881                                            1881
*     DARGDTM(11)=ADDR(BLANK);      /*                       @Z40LB25*/
         LA    @15,BLANK                                           1882
         ST    @15,DARGDTM+80(,@02)                                1882
*   ELSE                                                           1883
*     DARGDTM(11)=ADDR(CARSEQ);     /*                       @Z40LB25*/
*                                                                  1883
         B     @RC01881                                            1883
@RF01881 L     @02,@PC00001+8                                      1883
         L     @02,BLKPTR(,@02)                                    1883
         LA    @02,CARSEQ(,@02)                                    1883
         L     @01,DDSTRU                                          1883
         ST    @02,DARGDTM+80(,@01)                                1883
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC VOLID, IF VALID                                  @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1884
*   DARGINS(12)=12;                 /*                       @Z40LB25*/
@RC01881 L     @02,DDSTRU                                          1884
         MVC   DARGINS+88(2,@02),@CH00571                          1884
*   DARGINL(12)=LENGTH(CARVOLID);   /*                       @Z40LB25*/
         MVC   DARGINL+88(2,@02),@CH00161                          1885
*   IF CARTSCRC=ON THEN                                            1886
         L     @15,@PC00001+8                                      1886
         L     @01,BLKPTR(,@15)                                    1886
         TM    CARTSCRC(@01),B'00001000'                           1886
         BNO   @RF01886                                            1886
*     DARGDTM(12)=ADDR(BLANK6);     /*                       @Z40LB25*/
         LA    @15,BLANK6                                          1887
         ST    @15,DARGDTM+88(,@02)                                1887
*   ELSE                                                           1888
*     DARGDTM(12)=ADDR(CARVOLID);   /*                       @Z40LB25*/
*                                                                  1888
         B     @RC01886                                            1888
@RF01886 L     @02,@PC00001+8                                      1888
         L     @02,BLKPTR(,@02)                                    1888
         LA    @02,CARVOLID(,@02)                                  1888
         L     @01,DDSTRU                                          1888
         ST    @02,DARGDTM+88(,@01)                                1888
*   /*****************************************************************/
*   /*                                                               */
*   /* CTOC VOLUME TYPE, IF NECESSARY                        @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1889
*   DARGINS(13)=13;                 /*                       @Z40LB25*/
@RC01886 L     @02,DDSTRU                                          1889
         MVC   DARGINS+96(2,@02),@CH01099                          1889
*   DARGINL(13)=LENGTH(SCRCART);    /*                       @Z40LB25*/
         MVC   DARGINL+96(2,@02),@CH00047                          1890
*   DARGDTM(13)=ADDR(BLANK4);       /*                       @Z40LB25*/
         LA    @15,BLANK4                                          1891
         ST    @15,DARGDTM+96(,@02)                                1891
*   IF CARTSCRC=ON THEN                                            1892
         L     @15,@PC00001+8                                      1892
         L     @01,BLKPTR(,@15)                                    1892
         TM    CARTSCRC(@01),B'00001000'                           1892
         BNO   @RF01892                                            1892
*     DARGDTM(13)=ADDR(SCRCART);    /*                       @Z40LB25*/
         LA    @15,SCRCART                                         1893
         ST    @15,DARGDTM+96(,@02)                                1893
*   IF CARTCE=ON THEN                                              1894
@RF01892 L     @02,@PC00001+8                                      1894
         L     @02,BLKPTR(,@02)                                    1894
         TM    CARTCE(@02),B'10000000'                             1894
         BNO   @RF01894                                            1894
*     DARGDTM(13)=ADDR(CECART);     /*                       @Z40LB25*/
*                                                                  1895
         LA    @02,CECART                                          1895
         L     @01,DDSTRU                                          1895
         ST    @02,DARGDTM+96(,@01)                                1895
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE LABEL INFORMATION                           @Z40LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1896
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Z40LB25*/
@RF01894 L     @02,@PC00001                                        1896
         ST    @02,@AL00001                                        1896
         L     @15,@PC00001+12                                     1896
         ST    @15,@AL00001+4                                      1896
         LA    @15,DDSTRU                                          1896
         ST    @15,@AL00001+8                                      1896
         MVI   @AL00001+8,X'80'                                    1896
         L     @15,GDTPRT(,@02)                                    1896
         LA    @01,@AL00001                                        1896
         BALR  @14,@15                                             1896
*   RETURN;                         /*                       @Z40LB25*/
@EL00016 DS    0H                                                  1897
@EF00016 DS    0H                                                  1897
@ER00016 L     @14,@SA00016                                        1897
         BR    @14                                                 1897
*   END PRTLABEL;                   /*                       @Z40LB25*/
*                                                                  1899
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - HEADSET                              @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* FUNCTION - THIS ROUTINE ESTABLISHES THE SUB-          @Z40LB22*/
*   /* TITLE AND HEADER LINES REQUIRED                       @Z40LB22*/
*   /* FOR THE CHECK OR READ LABEL REPORT                    @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* INPUT - A PARAMETER LIST, IDENTIFING THE              @Z40LB22*/
*   /* TYPE OF REPORT DESIRED AND THE SUB-                   @Z40LB22*/
*   /* TITLE AND HEADER LINES REQUIRED.                      @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* NOTE 1. TO GET A CHECK REPORT, HDCKPTR (A             @Z40LB22*/
*   /* POINTER) MUST BE INITIALIZED                          @Z40LB22*/
*   /* (HDCKPTR=ADDR(HDSETCK)).                              @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* NOTE 2. TO GET A READ LABEL REPORT,                   @Z40LB22*/
*   /* HDRDPTR (A POINTER) MUST BE                           @Z40LB22*/
*   /* INITIALIZED (HDRDPTR=ADDR                             @Z40LB22*/
*   /* (HDSETRD)).                                           @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* OUTPUT - A HEXADECIMAL PRINT OF STATIC TEXT           @Z40LB22*/
*   /* MESSAGES IDENTIFIED BY THE INPUT                      @Z40LB22*/
*   /* PARAMETER LIST.                                       @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* NOTE 1. THE APPLICABLE STIDS LOCATED IN               @Z40LB22*/
*   /* IDCTSAU0 ARE AS FOLLOWS -                             @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* A. FOR THE CHECK REPORT -                             @Z40LB22*/
*   /* TXT11, TXT12, TXT13, TXT14, TXT15                     @Z40LB22*/
*   /*                                                       @Z40LB22*/
*   /* B. FOR THE READLABEL REPORT -                         @Z40LB22*/
*   /* TXT16, TXT17, TXT18, TXT19, TXT35                     @Z40LB22*/
*   /* TXT36, TXT37, TXT38, TXT39                            @Z40LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1899
*HEADSET:                                                          1899
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB22*/
*                                                                  1899
HEADSET  ST    @14,@SA00017                                        1899
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR THE CALLER SPECIFIED READ LABEL REPORT       @Z40LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1900
*   IF HDRDPTR^=NULLPTR THEN                                       1900
         L     @02,HDRDPTR                                         1900
         LTR   @02,@02                                             1900
         BZ    @RF01900                                            1900
*     DO;                           /*                       @Z40LB22*/
*       IF HDSRDSTL^=STMASK THEN    /* CHECK FOR SUBTITLE    @Z40LB22*/
         CLI   HDSRDSTL,X'00'                                      1902
         BE    @RF01902                                            1902
*         DO;                       /*                       @Z40LB22*/
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1904
*           PCARG=''B;              /*                       @Z40LB25*/
         XC    PCARG(33),PCARG                                     1905
*           SUBTITBF=' ';           /*                       @Z40LB25*/
         MVI   SUBTITBF+1,C' '                                     1906
         MVC   SUBTITBF+2(119),SUBTITBF+1                          1906
         MVI   SUBTITBF,C' '                                       1906
*           DARGRETP=ADDR(SUBTITBF);/*                       @Z40LB25*/
         L     @02,DDSTRU                                          1907
         LA    @15,SUBTITBF                                        1907
         ST    @15,DARGRETP(,@02)                                  1907
*           DARGRETL=LENGTH(SUBTITBF);/*                     @Z40LB25*/
         MVC   DARGRETL(2,@02),@CH01335                            1908
*           IF HDRDID17=ON THEN     /* STID17 REQUESTED?     @Z40LB22*/
         TM    HDRDID17,B'10000000'                                1909
         BNO   @RF01909                                            1909
*             DARGSENT=AUDRDS17;    /* YES, MOVE IT IN       @Z40LB22*/
         MVI   DARGSENT(@02),X'11'                                 1910
*           IF HDRDID18=ON THEN     /* STID18 REQUESTED?     @Z40LB22*/
@RF01909 TM    HDRDID18,B'01000000'                                1911
         BNO   @RF01911                                            1911
*             DARGSENT=AUDRDS18;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1912
         MVI   DARGSENT(@02),X'12'                                 1912
*           IF HDRDID19=ON THEN     /* STID19 REQUESTED?     @Z40LB22*/
@RF01911 TM    HDRDID19,B'00100000'                                1913
         BNO   @RF01913                                            1913
*             DARGSENT=AUDRDS19;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1914
         MVI   DARGSENT(@02),X'13'                                 1914
*           IF HDRDID35=ON THEN     /* STID35 REQUESTED?     @Z40LB22*/
@RF01913 TM    HDRDID35,B'00010000'                                1915
         BNO   @RF01915                                            1915
*             DARGSENT=AUDRDS35;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1916
         MVI   DARGSENT(@02),X'23'                                 1916
*           DARGSMOD=AUDMSG;        /* SET TEXT MOD          @Z40LB22*/
@RF01915 L     @02,DDSTRU                                          1917
         MVC   DARGSMOD(3,@02),@CC01440                            1917
*           DARGCNT=1;              /* SET 1 INSERT          @Z40LB22*/
         LA    @15,1                                               1918
         STH   @15,DARGCNT(,@02)                                   1918
*           DARGINS(1)=1;           /* SET INSERT NO.        @Z40LB22*/
         STH   @15,DARGINS(,@02)                                   1919
*           DARGINL(1)=LENGTH(MSFVAL);/*                     @Z40LB22
*                                      SET INSERT SIZE       @Z40LB22*/
         MVC   DARGINL(2,@02),@CH00047                             1920
*           DARGDTM(1)=ADDR(MSFVAL);/* INSERT ADDR           @Z40LB22*/
*                                                                  1921
         L     @15,@PC00001+4                                      1921
         L     @15,FDTPTR+24(,@15)                                 1921
         ST    @15,DARGDTM(,@02)                                   1921
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE SUBTITLE                              @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1922
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB22*/
         L     @02,@PC00001                                        1922
         ST    @02,@AL00001                                        1922
         LA    @15,@CF00120                                        1922
         ST    @15,@AL00001+4                                      1922
         LA    @15,DDSTRU                                          1922
         ST    @15,@AL00001+8                                      1922
         MVI   @AL00001+8,X'80'                                    1922
         L     @15,GDTPRT(,@02)                                    1922
         LA    @01,@AL00001                                        1922
         BALR  @14,@15                                             1922
*           PCSTLC=1;               /*                       @Z40LB25*/
         MVC   PCSTLC(2),@CH00224                                  1923
*           PCSTLP=ADDR(SUBTITBF);  /*                       @Z40LB25*/
*                                                                  1924
         LA    @02,SUBTITBF                                        1924
         ST    @02,PCSTLP                                          1924
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE SUBTITLE                            @Z40LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1925
*           CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*           @Z40LB25*/
         L     @02,@PC00001                                        1925
         ST    @02,@AL00001                                        1925
         L     @15,@PC00001+12                                     1925
         ST    @15,@AL00001+4                                      1925
         LA    @15,PCARG                                           1925
         ST    @15,@AL00001+8                                      1925
         L     @15,GDTESA(,@02)                                    1925
         LA    @01,@AL00001                                        1925
         BALR  @14,@15                                             1925
*         END;                      /* END OF SUBTITLE SEARCH      1926
*                                                            @Z40LB22*/
*                                                                  1927
*       /*************************************************************/
*       /*                                                           */
*       /* BEGIN SEARCH FOR THE HEADER                       @Z40LB22*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1927
*       IF HDSHDRE^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/
@RF01902 CLI   HDSHDRE,X'00'                                       1927
         BE    @RF01927                                            1927
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1929
*           IF HDRDID38=ON THEN     /* STID38 REQUIRED?      @Z40LB22*/
         TM    HDRDID38,B'10000000'                                1930
         BNO   @RF01930                                            1930
*             DARGSENT=AUDRDH38;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1931
         MVI   DARGSENT(@02),X'26'                                 1931
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/
@RF01930 L     @02,DDSTRU                                          1932
         MVC   DARGSMOD(3,@02),@CC01440                            1932
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/
         L     @02,@PC00001                                        1933
         ST    @02,@AL00001                                        1933
         L     @15,@PC00001+12                                     1933
         ST    @15,@AL00001+4                                      1933
         LA    @15,DDSTRU                                          1933
         ST    @15,@AL00001+8                                      1933
         MVI   @AL00001+8,X'80'                                    1933
         L     @15,GDTPRT(,@02)                                    1933
         LA    @01,@AL00001                                        1933
         BALR  @14,@15                                             1933
*         END;                      /*                       @Z40LB22*/
*       IF HDSHDRF^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/
@RF01927 CLI   HDSHDRF,X'00'                                       1935
         BE    @RF01935                                            1935
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1937
*           IF HDRDID16=ON THEN     /* STID16 REQUIRED?      @Z40LB22*/
         TM    HDRDID16,B'10000000'                                1938
         BNO   @RF01938                                            1938
*             DARGSENT=AUDRDH16;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1939
         MVI   DARGSENT(@02),X'10'                                 1939
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/
@RF01938 L     @02,DDSTRU                                          1940
         MVC   DARGSMOD(3,@02),@CC01440                            1940
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/
         L     @02,@PC00001                                        1941
         ST    @02,@AL00001                                        1941
         L     @15,@PC00001+12                                     1941
         ST    @15,@AL00001+4                                      1941
         LA    @15,DDSTRU                                          1941
         ST    @15,@AL00001+8                                      1941
         MVI   @AL00001+8,X'80'                                    1941
         L     @15,GDTPRT(,@02)                                    1941
         LA    @01,@AL00001                                        1941
         BALR  @14,@15                                             1941
*         END;                      /*                       @Z40LB22*/
*       IF HDSHDRG^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/
@RF01935 CLI   HDSHDRG,X'00'                                       1943
         BE    @RF01943                                            1943
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1945
*           IF HDRDID39=ON THEN     /* STID39 REQUIRED?      @Z40LB22*/
         TM    HDRDID39,B'10000000'                                1946
         BNO   @RF01946                                            1946
*             DARGSENT=AUDRDH39;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1947
         MVI   DARGSENT(@02),X'27'                                 1947
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/
@RF01946 L     @02,DDSTRU                                          1948
         MVC   DARGSMOD(3,@02),@CC01440                            1948
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/
         L     @02,@PC00001                                        1949
         ST    @02,@AL00001                                        1949
         L     @15,@PC00001+12                                     1949
         ST    @15,@AL00001+4                                      1949
         LA    @15,DDSTRU                                          1949
         ST    @15,@AL00001+8                                      1949
         MVI   @AL00001+8,X'80'                                    1949
         L     @15,GDTPRT(,@02)                                    1949
         LA    @01,@AL00001                                        1949
         BALR  @14,@15                                             1949
*         END;                      /*                       @Z40LB22*/
*       IF HDSHDRH^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/
@RF01943 CLI   HDSHDRH,X'00'                                       1951
         BE    @RF01951                                            1951
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1953
*           IF HDRDID14=ON THEN     /* STID14 REQUIRED?      @Z40LB22*/
         TM    HDRDID14,B'10000000'                                1954
         BNO   @RF01954                                            1954
*             DARGSENT=AUDRDH14;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1955
         MVI   DARGSENT(@02),X'0E'                                 1955
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/
@RF01954 L     @02,DDSTRU                                          1956
         MVC   DARGSMOD(3,@02),@CC01440                            1956
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/
         L     @02,@PC00001                                        1957
         ST    @02,@AL00001                                        1957
         L     @15,@PC00001+12                                     1957
         ST    @15,@AL00001+4                                      1957
         LA    @15,DDSTRU                                          1957
         ST    @15,@AL00001+8                                      1957
         MVI   @AL00001+8,X'80'                                    1957
         L     @15,GDTPRT(,@02)                                    1957
         LA    @01,@AL00001                                        1957
         BALR  @14,@15                                             1957
*         END;                      /*                       @Z40LB22*/
*       IF HDSHDRI^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/
@RF01951 CLI   HDSHDRI,X'00'                                       1959
         BE    @RF01959                                            1959
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1961
*           IF HDRDID37=ON THEN     /* STID37 REQUIRED?      @Z40LB22*/
         TM    HDRDID37,B'10000000'                                1962
         BNO   @RF01962                                            1962
*             DARGSENT=AUDRDH37;    /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1963
         MVI   DARGSENT(@02),X'25'                                 1963
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/
@RF01962 L     @02,DDSTRU                                          1964
         MVC   DARGSMOD(3,@02),@CC01440                            1964
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/
         L     @02,@PC00001                                        1965
         ST    @02,@AL00001                                        1965
         L     @15,@PC00001+12                                     1965
         ST    @15,@AL00001+4                                      1965
         LA    @15,DDSTRU                                          1965
         ST    @15,@AL00001+8                                      1965
         MVI   @AL00001+8,X'80'                                    1965
         L     @15,GDTPRT(,@02)                                    1965
         LA    @01,@AL00001                                        1965
         BALR  @14,@15                                             1965
*         END;                      /*                       @Z40LB22*/
*       HDSETRD=''B;                /* CLEAR READ PARM LIST  @Z40LB22*/
@RF01959 XC    HDSETRD(8),HDSETRD                                  1967
*     END;                          /* END OF SUBTITLE SEARCH      1968
*                                                            @Z40LB22*/
*   ELSE                                                           1969
*                                                                  1969
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR CHECK REPORT REQUEST                      @Z40LB22*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1969
*     IF HDCKPTR^=NULLPTR THEN      /*                       @Z40LB22*/
         B     @RC01900                                            1969
@RF01900 L     @02,HDCKPTR                                         1969
         LTR   @02,@02                                             1969
         BZ    @RF01969                                            1969
*       DO;                         /*                       @Z40LB22*/
*         IF HDSCKSTL^=STMASK THEN  /* CHECK FOR SUBTITLE    @Z40LB22*/
         CLI   HDSCKSTL,X'00'                                      1971
         BE    @RF01971                                            1971
*           DO;                     /*                       @Z40LB22*/
*             PRINTAB=''B;          /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1973
*             PCARG=''B;            /*                       @Z40LB25*/
         XC    PCARG(33),PCARG                                     1974
*             SUBTITBF=' ';         /*                       @Z40LB25*/
         MVI   SUBTITBF+1,C' '                                     1975
         MVC   SUBTITBF+2(119),SUBTITBF+1                          1975
         MVI   SUBTITBF,C' '                                       1975
*             DARGRETP=ADDR(SUBTITBF);/*                     @Z40LB25*/
         L     @02,DDSTRU                                          1976
         LA    @15,SUBTITBF                                        1976
         ST    @15,DARGRETP(,@02)                                  1976
*             DARGRETL=LENGTH(SUBTITBF);/*                   @Z40LB25*/
         MVC   DARGRETL(2,@02),@CH01335                            1977
*             IF HDCKID11=ON THEN   /* STID11 REQUESTED?     @Z40LB22*/
         TM    HDCKID11,B'10000000'                                1978
         BNO   @RF01978                                            1978
*               DARGSENT=AUDCKS11;  /* YES, MOVE IT IN       @Z40LB22*/
         MVI   DARGSENT(@02),X'0B'                                 1979
*             IF HDCKID12=ON THEN   /* STID12 REQUESTED?     @Z40LB22*/
@RF01978 TM    HDCKID12,B'01000000'                                1980
         BNO   @RF01980                                            1980
*               DARGSENT=AUDCKS12;  /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1981
         MVI   DARGSENT(@02),X'0C'                                 1981
*             IF HDCKID13=ON THEN   /* STID13 REQUESTED?     @Z40LB22*/
@RF01980 TM    HDCKID13,B'00100000'                                1982
         BNO   @RF01982                                            1982
*               DARGSENT=AUDCKS13;  /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1983
         MVI   DARGSENT(@02),X'0D'                                 1983
*             DARGSMOD=AUDMSG;      /* SET TEXT MOD          @Z40LB22*/
@RF01982 L     @02,DDSTRU                                          1984
         MVC   DARGSMOD(3,@02),@CC01440                            1984
*             DARGCNT=1;            /* SET 1 INSERT          @Z40LB22*/
         LA    @15,1                                               1985
         STH   @15,DARGCNT(,@02)                                   1985
*             DARGINS(1)=1;         /* SET INSERT NO.        @Z40LB22*/
         STH   @15,DARGINS(,@02)                                   1986
*             DARGINL(1)=LENGTH(MSFVAL);/*                   @Z40LB22
*                                      SET INSERT SIZE       @Z40LB22*/
         MVC   DARGINL(2,@02),@CH00047                             1987
*             DARGDTM(1)=ADDR(MSFVAL);/* INSERT ADDR         @Z40LB22*/
*                                                                  1988
         L     @15,@PC00001+4                                      1988
         L     @15,FDTPTR+24(,@15)                                 1988
         ST    @15,DARGDTM(,@02)                                   1988
*             /*******************************************************/
*             /*                                                     */
*             /* GET THE SUBTITLE                            @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1989
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB22*/
         L     @02,@PC00001                                        1989
         ST    @02,@AL00001                                        1989
         LA    @15,@CF00120                                        1989
         ST    @15,@AL00001+4                                      1989
         LA    @15,DDSTRU                                          1989
         ST    @15,@AL00001+8                                      1989
         MVI   @AL00001+8,X'80'                                    1989
         L     @15,GDTPRT(,@02)                                    1989
         LA    @01,@AL00001                                        1989
         BALR  @14,@15                                             1989
*             PCSTLC=1;             /*                       @Z40LB25*/
         MVC   PCSTLC(2),@CH00224                                  1990
*             PCSTLP=ADDR(SUBTITBF);/*                       @Z40LB25*/
*                                                                  1991
         LA    @02,SUBTITBF                                        1991
         ST    @02,PCSTLP                                          1991
*             /*******************************************************/
*             /*                                                     */
*             /* PRINT THE SUBTITLE                          @Z40LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1992
*             CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*         @Z40LB25*/
         L     @02,@PC00001                                        1992
         ST    @02,@AL00001                                        1992
         L     @15,@PC00001+12                                     1992
         ST    @15,@AL00001+4                                      1992
         LA    @15,PCARG                                           1992
         ST    @15,@AL00001+8                                      1992
         L     @15,GDTESA(,@02)                                    1992
         LA    @01,@AL00001                                        1992
         BALR  @14,@15                                             1992
*           END;                    /* END OF SUBTITLE SEARCH      1993
*                                                            @Z40LB22*/
*                                                                  1994
*         /***********************************************************/
*         /*                                                         */
*         /* BEGIN SEARCH FOR THE HEADER                     @Z40LB22*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1994
*         IF HDSHDRA^=HDMASK THEN   /* IS HEADER REQUIRED    @Z40LB22*/
@RF01971 CLI   HDSHDRA,X'00'                                       1994
         BE    @RF01994                                            1994
*           DO;                     /*                       @Z40LB22*/
*             PRINTAB=''B;          /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                1996
*             IF HDCKID14=ON THEN   /* STID14 REQUIRED?      @Z40LB22*/
         TM    HDCKID14,B'10000000'                                1997
         BNO   @RF01997                                            1997
*               DARGSENT=AUDCKH14;  /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          1998
         MVI   DARGSENT(@02),X'0E'                                 1998
*             DARGSMOD=AUDMSG;      /* SET MOD ID            @Z40LB22*/
@RF01997 L     @02,DDSTRU                                          1999
         MVC   DARGSMOD(3,@02),@CC01440                            1999
*             CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*        @Z40LB22*/
         L     @02,@PC00001                                        2000
         ST    @02,@AL00001                                        2000
         L     @15,@PC00001+12                                     2000
         ST    @15,@AL00001+4                                      2000
         LA    @15,DDSTRU                                          2000
         ST    @15,@AL00001+8                                      2000
         MVI   @AL00001+8,X'80'                                    2000
         L     @15,GDTPRT(,@02)                                    2000
         LA    @01,@AL00001                                        2000
         BALR  @14,@15                                             2000
*           END;                    /* END OF HEADER SEARCH  @Z40LB22*/
*         IF HDSHDRB^=HDMASK THEN   /* IS HEADER REQUIRED    @Z40LB22*/
@RF01994 CLI   HDSHDRB,X'00'                                       2002
         BE    @RF02002                                            2002
*           DO;                     /*                       @Z40LB22*/
*             PRINTAB=''B;          /* CLEAR ARG LIST        @Z40LB22*/
         XC    PRINTAB(164),PRINTAB                                2004
*             IF HDCKID15=ON THEN   /* STID15 REQUIRED?      @Z40LB22*/
         TM    HDCKID15,B'10000000'                                2005
         BNO   @RF02005                                            2005
*               DARGSENT=AUDCKH15;  /* YES, MOVE IT IN       @Z40LB22*/
         L     @02,DDSTRU                                          2006
         MVI   DARGSENT(@02),X'0F'                                 2006
*             DARGSMOD=AUDMSG;      /* SET MOD ID            @Z40LB22*/
@RF02005 L     @02,DDSTRU                                          2007
         MVC   DARGSMOD(3,@02),@CC01440                            2007
*             CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*        @Z40LB22*/
         L     @02,@PC00001                                        2008
         ST    @02,@AL00001                                        2008
         L     @15,@PC00001+12                                     2008
         ST    @15,@AL00001+4                                      2008
         LA    @15,DDSTRU                                          2008
         ST    @15,@AL00001+8                                      2008
         MVI   @AL00001+8,X'80'                                    2008
         L     @15,GDTPRT(,@02)                                    2008
         LA    @01,@AL00001                                        2008
         BALR  @14,@15                                             2008
*           END;                    /* END OF HEADER SEARCH  @Z40LB22*/
*         HDSETCK=''B;              /* CLEAR CHECK PARM LIST @Z40LB22*/
@RF02002 XC    HDSETCK(4),HDSETCK                                  2010
*       END;                        /* END OF SUBTITLE SEARCH      2011
*                                                            @Z40LB22*/
*   RETURN;                         /*                       @Z40LB22*/
@EL00017 DS    0H                                                  2012
@EF00017 DS    0H                                                  2012
@ER00017 L     @14,@SA00017                                        2012
         BR    @14                                                 2012
*   END HEADSET;                    /*                       @Z40LB22*/
         B     @EL00017                                            2013
*                                                                  2014
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  2014
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           2014
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00018                                    2014
         MVC   @PC00018(8),0(@01)                                  2014
*                                   /*                       @Y30LB39*/
*                                                                  2015
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2015
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2015
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2015
*                                   /*                       @Y30LB39*/
*   DCL                                                            2015
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            2016
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2016
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2017
*                                   /*                       @Y30LB39*/
*   DCL                                                            2017
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            2018
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2018
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2019
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        2019
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2019
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2020
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        2020
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2020
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2021
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        2021
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2021
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2022
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        2022
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2022
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2023
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        2023
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  2024
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2024
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             2024
         L     @15,@PC00001                                        2024
         L     @14,GDTTR2(,@15)                                    2024
         MVC   @TS00001(95),NEWERID2(@14)                          2024
         MVC   OLDERID2(95,@14),@TS00001                           2024
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2025
         MVC   NEWID2(4,@14),@CC01636                              2025
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2026
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2026
         LA    @14,SSDRGLT                                         2026
         ST    @14,SSDLPTR                                         2026
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2027
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              2027
         L     @07,@PC00018                                        2027
         L     @07,SSRCODE(,@07)                                   2027
         LTR   @07,@07                                             2027
         BNP   @RF02027                                            2027
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2028
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2029
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 2029
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        2030
         ST    @03,DARGRETP(,@14)                                  2030
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            2031
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 2032
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2033
         MVC   DARGRETL(2,@14),@CH01649                            2033
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2034
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2034
         ST    @15,@AL00001                                        2034
         LA    @03,@CF00120                                        2034
         ST    @03,@AL00001+4                                      2034
         LA    @03,SSDLPTR                                         2034
         ST    @03,@AL00001+8                                      2034
         MVI   @AL00001+8,X'80'                                    2034
         L     @15,GDTPRT(,@15)                                    2034
         LA    @01,@AL00001                                        2034
         BALR  @14,@15                                             2034
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2035
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          2035
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   2036
@DL02036 DS    0H                                                  2037
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00224                                   2037
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2038
@DE02036 L     @03,@PC00018                                        2038
         LR    @15,ENTRYNUM                                        2038
         ALR   @15,@15                                             2038
         LH    @15,SSARRAY-2(@15)                                  2038
         CH    @15,SSRHALF(,@03)                                   2038
         BE    @DC02036                                            2038
         SLR   @14,@14                                             2038
         CR    @15,@14                                             2038
         BNE   @DL02036                                            2038
@DC02036 DS    0H                                                  2039
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2039
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 2039
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @07,SSDLPTR                                         2040
         MVC   DARGSMOD(3,@07),SSMODSS0                            2040
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@07)                             2041
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             2042
         BNE   @RF02042                                            2042
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@07)                                   2044
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@07),@CH00047                             2045
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  2048
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2048
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC02027                                            2048
@RF02027 DS    0H                                                  2049
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 2049
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         2050
         MVC   DARGSMOD(3,@15),SSMODCM0                            2050
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            2051
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00018+4                                      2052
         ST    @14,DARGDBP(,@15)                                   2052
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00224                             2053
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2054
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2055
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  2055
@RC02027 L     @15,@PC00001                                        2055
         ST    @15,@AL00001                                        2055
         LA    @14,@CF00120                                        2055
         ST    @14,@AL00001+4                                      2055
         LA    @14,SSDLPTR                                         2055
         ST    @14,@AL00001+8                                      2055
         MVI   @AL00001+8,X'80'                                    2055
         L     @15,GDTPRT(,@15)                                    2055
         LA    @01,@AL00001                                        2055
         BALR  @14,@15                                             2055
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2056
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             2056
         L     @14,@SA00018                                        2056
         LM    @00,@12,@SA00018+8                                  2056
         BR    @14                                                 2056
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCAU03                     /*                       @Z40LB25*/
*                                                                  2058
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSAU )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  2058
*       ;                                                          2058
@DATA    DS    0H
@CH01086 DC    H'9'
@CH00449 DC    H'10'
@CH01093 DC    H'11'
@CH00571 DC    H'12'
@CH01099 DC    H'13'
@CH00813 DC    H'44'
@CH01649 DC    H'120'
@CH01335 DC    H'121'
@CH01541 DC    H'247'
@CH01230 DC    H'264'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    5F
@SA00003 DS    1F
@SA00006 DS    1F
@SA00007 DS    1F
@SA00005 DS    1F
@SA00004 DS    1F
@SA00009 DS    1F
@SA00017 DS    1F
@SA00012 DS    1F
@SA00014 DS    1F
@SA00018 DS    15F
@PC00018 DS    2F
@SA00010 DS    1F
@SA00013 DS    1F
@SA00015 DS    1F
@SA00016 DS    1F
@AL00001 DS    4A
@TF00001 DS    F
@AFTEMPS DS    2F
IDCAU03  CSECT
         DS    0F
@CF00120 DC    F'0'
@CF00224 DC    F'1'
@CH00224 EQU   @CF00224+2
@CF00158 DC    F'2'
@CH00158 EQU   @CF00158+2
@CF00167 DC    F'3'
@CH00167 EQU   @CF00167+2
@CF00047 DC    F'4'
@CH00047 EQU   @CF00047+2
@CF00291 DC    F'5'
@CH00291 EQU   @CF00291+2
@CF00161 DC    F'6'
@CH00161 EQU   @CF00161+2
@CF00663 DC    F'7'
@CH00663 EQU   @CF00663+2
@CF00184 DC    F'8'
@CH00184 EQU   @CF00184+2
@CF00479 DC    F'16'
@CF01239 DC    F'28'
@CF01241 DC    F'98'
@CF01256 DC    F'150'
@CH01256 EQU   @CF01256+2
@CF01567 DC    F'246'
@CF01398 DC    F'256'
@CF01638 DC    F'3168'
@CF01670 DC    F'-257'
@CF01672 DC    F'-256'
@CF01675 DC    F'-4'
@CF01674 DC    F'-1'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RDCKPTR  DS    A
MSFLOWX  DS    F
HIBADX   DS    F
Y        DS    FL4
         ORG   Y
@NM00092 DS    CL4
         ORG   @NM00092
@NM00093 DS    CL3
YCHAR    DS    CL1
         ORG   Y+4
CORESIZE DS    F
REASONCD DS    F
HDRDPTR  DS    A
HDCKPTR  DS    A
WRKMAPTR DS    A
XYZ1PTR  DS    A
XYZ2PTR  DS    A
CELLPTR  DS    A
CELLPTR2 DS    A
CHUNKPTR DS    A
CHUNKPT2 DS    A
CURCKPTR DS    A
CURCLPTR DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
X        DS    H
X1       DS    H
X2       DS    H
Y1       DS    H
Z        DS    H
BLKINDX2 DS    H
CHKINDEX DS    H
CHKINDX2 DS    H
CUBINDEX DS    H
BYTEINDX DS    H
TWOBITX  DS    H
LASTCOND DS    H
LIMITSRC DS    H
CHECKRC  DS    H
READRC   DS    H
XWRDINDX DS    H
YBITINDX DS    H
TEMPY    DS    H
VALHIGHX DS    H
VALLOWX  DS    H
SETRC    DS    H
LABELL   DS    FL1
LABELX   DS    FL1
LABELY   DS    FL1
LABELZ   DS    FL1
BITMASK  DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL1
QURYAREA DS    CL44
PRINTAB  DS    CL164
SUBTITBF DS    CL121
         DS    CL3
PCARG    DS    CL33
         ORG   PCARG
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    AL1
         ORG   PCARG+33
FLAGS    DS    BL3
         ORG   FLAGS
GOTCORE  DS    BL1
LOXFOUND EQU   FLAGS+0
TERMINAT EQU   FLAGS+0
SETBIT   EQU   FLAGS+0
XYZ1RPT  EQU   FLAGS+0
XYZ2RPT  EQU   FLAGS+0
CHECKFLG EQU   FLAGS+0
FRSTUSSC EQU   FLAGS+0
SETX     DS    BL1
PRTXYZ1  EQU   FLAGS+1
PRTXYZ2  EQU   FLAGS+1
TABLEND  EQU   FLAGS+1
RDTITLE  EQU   FLAGS+1
RDHEAD   EQU   FLAGS+1
XYZ1PRTD EQU   FLAGS+1
XYZ2PRTD EQU   FLAGS+1
RLBLPRTD DS    BL1
LABELRD  EQU   FLAGS+2
LIMITLOX EQU   FLAGS+2
PROCHIX  EQU   FLAGS+2
XYZ1PTRS EQU   FLAGS+2
XYZ2PTRS EQU   FLAGS+2
CELFOUND EQU   FLAGS+2
@NM00095 EQU   FLAGS+2
         ORG   FLAGS+3
DMPSTG   DS    CL17
HDSETCK  DS    CL4
         ORG   HDSETCK
HDSCKSTL DS    CL1
         ORG   HDSCKSTL
HDCKID11 DS    BL1
HDCKID12 EQU   HDSCKSTL+0
HDCKID13 EQU   HDSCKSTL+0
@NM00105 EQU   HDSCKSTL+0
         ORG   HDSETCK+1
HDSHDRA  DS    CL1
         ORG   HDSHDRA
HDCKID14 DS    BL1
@NM00106 EQU   HDSHDRA+0
         ORG   HDSETCK+2
HDSHDRB  DS    CL1
         ORG   HDSHDRB
HDCKID15 DS    BL1
@NM00107 EQU   HDSHDRB+0
         ORG   HDSETCK+3
HDCKRES1 DS    CL1
         ORG   HDSETCK+4
HDSETRD  DS    CL8
         ORG   HDSETRD
HDSRDSTL DS    CL1
         ORG   HDSRDSTL
HDRDID17 DS    BL1
HDRDID18 EQU   HDSRDSTL+0
HDRDID19 EQU   HDSRDSTL+0
HDRDID35 EQU   HDSRDSTL+0
@NM00108 EQU   HDSRDSTL+0
         ORG   HDSETRD+1
HDSHDRE  DS    CL1
         ORG   HDSHDRE
HDRDID38 DS    BL1
@NM00109 EQU   HDSHDRE+0
         ORG   HDSETRD+2
HDSHDRF  DS    CL1
         ORG   HDSHDRF
HDRDID16 DS    BL1
@NM00110 EQU   HDSHDRF+0
         ORG   HDSETRD+3
HDSHDRG  DS    CL1
         ORG   HDSHDRG
HDRDID39 DS    BL1
@NM00111 EQU   HDSHDRG+0
         ORG   HDSETRD+4
HDSHDRH  DS    CL1
         ORG   HDSHDRH
HDRDID14 DS    BL1
@NM00112 EQU   HDSHDRH+0
         ORG   HDSETRD+5
HDSHDRI  DS    CL1
         ORG   HDSHDRI
HDRDID37 DS    BL1
@NM00113 EQU   HDSHDRI+0
         ORG   HDSETRD+6
HDRDRES1 DS    CL2
         ORG   HDSETRD+8
SSDRGLT  DS    CL20
         DS    CL3
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
PRTXYZS  DS    CL8
         ORG   PRTXYZS+0
PRTX     DS    CL2
PRTY     DS    CL4
PRTZ     DS    CL2
         ORG   PRTXYZS+48
TEMPQCEL DS    8CL4
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCAU03  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ONEYMASK DC    XL4'80000000'
REVRMASK DC    XL4'00000010'
ONEBIT   DC    XL1'80'
SSMSGNUM DC    AL1(56)
@CC01579 DC    C'QURYAREA'
@CC01538 DC    C'AUCA'
@CC01546 DC    C'AUCZ'
@CC01581 DC    C'AUCB'
@CC01602 DC    C'AUCC'
@CC01636 DC    C'SSAA'
@CC01438 DC    C'UV0'
@CC01440 DC    C'AU0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
ANDY     DC    X'1F'
LASTCUBE DC    X'FF'
CELLSET  DC    X'00'
MSF1     DC    X'F1'
ONEMSF   DC    X'01'
MSF2     DC    X'F2'
TWOMSF   DC    X'10'
MSF3     DC    X'F3'
THREEMSF DC    X'11'
VACTCELL DC    X'55'
NOACCRT  DC    X'5E'
YMASK    DC    X'E0'
BLANK12  DC    CL12'            '
BLANK6   DC    CL6'      '
BLANK    DC    CL1' '
ASTERIC  DC    CL1'*'
BLANK4   DC    CL4'    '
SCRCART  DC    CL4'SCRC'
CECART   DC    CL4'CE  '
         DS    CL1
FIXAREA  DS    CL550
         ORG   FIXAREA
@NM00094 DC    550X'00'
         ORG   FIXAREA+550
MODID    DC    CL4'AU02'
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
CURCBPTR EQU   @06
CUBEPTR2 EQU   @04
CUBEPTR  EQU   @02
REVRESLT EQU   @05
REVRBIT  EQU   @02
XINDEX   EQU   @06
TEMPX2   EQU   @05
TEMPX    EQU   @05
II       EQU   @03
I        EQU   @04
BYTINDX2 EQU   @02
BYTINDEX EQU   @03
CUBINDX2 EQU   @07
BLKINDEX EQU   @07
YY2      EQU   @03
DMPINDEX EQU   @02
IOCSPTR  EQU   @02
TESTRC   EQU   @03
REG12    EQU   @12
REG11    EQU   @11
REG10    EQU   @10
REG9     EQU   @09
RTNREG   EQU   @15
REG6     EQU   @06
REG7     EQU   @07
REG14    EQU   @14
QUERR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG8     EQU   @08
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSASS0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOPT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
AMSTP044 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00072 EQU   SV82LIST+4
SV82DCBP EQU   @NM00072
@NM00073 EQU   SV82LIST+12
SV82WRKP EQU   @NM00073
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
CHK      EQU   0
RDLBL    EQU   0
FULL     EQU   0
EMPTY    EQU   0
CHALL    EQU   0
MSF      EQU   0
MSFVAL   EQU   MSF
XRNG     EQU   0
XRNGCNT  EQU   0
LOWXPTR  EQU   0
LOWX     EQU   0
LOWXVAL  EQU   LOWX
HIGHXPTR EQU   0
HIGHX    EQU   0
HIGHXVAL EQU   HIGHX
CELL     EQU   0
CELLCNT  EQU   0
CELLXPTR EQU   0
CELLX    EQU   0
CELLXVAL EQU   CELLX
CELLYPTR EQU   0
CELLY    EQU   0
CELLYVAL EQU   CELLY
CELLZPTR EQU   0
CELLZ    EQU   0
CELLZVAL EQU   CELLZ
OFILE    EQU   0
ODS      EQU   0
ODSFLG   EQU   ODS+10
LIST     EQU   0
NLIST    EQU   0
LFILE    EQU   0
LDS      EQU   0
LDSFLG   EQU   LDS+10
RDCKLIST EQU   0
QUCODE   EQU   RDCKLIST+6
QULIB    EQU   QUCODE
QUSECT   EQU   RDCKLIST+7
QUXADDR  EQU   QUSECT
QUFLAG   EQU   QUXADDR
QUPARM   EQU   RDCKLIST+8
QUPTR    EQU   RDCKLIST+40
BLKBUF   EQU   0
HDRBLK   EQU   BLKBUF
CUBEADDR EQU   HDRBLK+30
CELLMAP  EQU   BLKBUF+264
CELLCUBE EQU   CELLMAP+8
ORIGMAP  EQU   BLKBUF+1320
ORIGCUBE EQU   ORIGMAP+8
DIAGBUF  EQU   BLKBUF+2376
RECDBUF  EQU   DIAGBUF+256
WORKMAP  EQU   0
WRKBLK   EQU   WORKMAP
WRKCUBE  EQU   WRKBLK+8
XYZ1     EQU   0
XYZ1BLK  EQU   XYZ1
XYZ1CUBE EQU   XYZ1BLK+8
XYZ2     EQU   0
XYZ2BLK  EQU   XYZ2
XYZ2CUBE EQU   XYZ2BLK+8
CHUNK    EQU   0
CUBE     EQU   0
CUBEBYTE EQU   0
X0Z0     EQU   CUBEBYTE
X0Z1     EQU   CUBEBYTE
X1Z0     EQU   CUBEBYTE
X1Z1     EQU   CUBEBYTE
X2Z0     EQU   CUBEBYTE
X2Z1     EQU   CUBEBYTE
X3Z0     EQU   CUBEBYTE
X3Z1     EQU   CUBEBYTE
CURCK    EQU   0
CURCUBE  EQU   0
CURCBYTE EQU   0
CURX0Z0  EQU   CURCBYTE
CURX0Z1  EQU   CURCBYTE
CURX1Z0  EQU   CURCBYTE
CURX1Z1  EQU   CURCBYTE
CURX2Z0  EQU   CURCBYTE
CURX2Z1  EQU   CURCBYTE
CURX3Z0  EQU   CURCBYTE
CURX3Z1  EQU   CURCBYTE
CHUNK2   EQU   0
CUBE2    EQU   0
CUBEBYT2 EQU   0
X0Z02    EQU   CUBEBYT2
X0Z12    EQU   CUBEBYT2
X1Z02    EQU   CUBEBYT2
X1Z12    EQU   CUBEBYT2
X2Z02    EQU   CUBEBYT2
X2Z12    EQU   CUBEBYT2
X3Z02    EQU   CUBEBYT2
X3Z12    EQU   CUBEBYT2
AMSTP041 EQU   0
AMSTP043 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
MAP      EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
BLKPTR   EQU   0
PRINTME  EQU   0
LABDSPTR EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
QWPARM   EQU   QUPARM
QWRES1   EQU   QWPARM
QWFLAG   EQU   QWPARM+2
QTPARM   EQU   QUPARM
QTID     EQU   QTPARM
QLPARM   EQU   QUPARM
QLZYX    EQU   QLPARM
QCPARM   EQU   QUPARM
PARMQU   EQU   QUPARM
YSQC     EQU   PARMQU
READLZYX EQU   QLZYX
READL    EQU   READLZYX
READL1   EQU   READL
READL2   EQU   READL
READZ    EQU   READLZYX
READX    EQU   READLZYX+1
CELLPARM EQU   DIAGBUF
CKYS     EQU   CELLPARM
CARTLAB  EQU   RECDBUF
CARVOLID EQU   CARTLAB+4
CARADDR  EQU   CARTLAB+88
CARADDRL EQU   CARADDR
CARL1    EQU   CARADDRL
CARL2    EQU   CARADDRL
CARADDRZ EQU   CARADDR
CARADDRX EQU   CARADDR+1
CARTYPE  EQU   CARTLAB+92
CARTCE   EQU   CARTYPE
CARTSCRC EQU   CARTYPE
CARSEQ   EQU   CARTLAB+95
CARCSN1  EQU   CARTLAB+224
CARCSN2  EQU   CARTLAB+236
*                                      START UNREFERENCED COMPONENTS
CARES5   EQU   CARTLAB+248
CARES4   EQU   CARTLAB+96
CARES3   EQU   CARTLAB+93
CARTRESB EQU   CARTYPE
CARTRESA EQU   CARTYPE
CARES2   EQU   CARTLAB+90
CARADDRY EQU   CARADDR
CARES1   EQU   CARTLAB+10
CARVOL   EQU   CARTLAB
@NM00101 EQU   CELLPARM+32
READY    EQU   READLZYX
QCMAD3Z1 EQU   QCPARM+28
QCMAD3Z0 EQU   QCPARM+24
QCMAD2Z1 EQU   QCPARM+20
QCMAD2Z0 EQU   QCPARM+16
QCMAD1Z1 EQU   QCPARM+12
QCMAD1Z0 EQU   QCPARM+8
QCMAD0Z1 EQU   QCPARM+4
QCMAD0Z0 EQU   QCPARM
QLRES    EQU   QLPARM+2
QTRES    EQU   QTPARM+24
QTDASCHR EQU   QTPARM+20
QTDATA   EQU   QTPARM+2
QTFLAG   EQU   QTPARM+1
QTTABID  EQU   QTID
QWRES2   EQU   QWPARM+3
@NM00091 EQU   QWFLAG
QWMEM    EQU   QWFLAG
QWSSID   EQU   QWRES1
@NM00114 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00104 EQU   XYZ2BLK
@NM00103 EQU   XYZ1BLK
@NM00102 EQU   WRKBLK
@NM00100 EQU   DIAGBUF+248
@NM00099 EQU   DIAGBUF
@NM00098 EQU   ORIGMAP
@NM00097 EQU   CELLMAP
BITMAP   EQU   HDRBLK+8
@NM00096 EQU   HDRBLK
QURES1   EQU   QUFLAG
QURES    EQU   RDCKLIST+5
QUORD    EQU   RDCKLIST+4
QULEN    EQU   RDCKLIST
LDSVAL   EQU   LDS+21
LDSLEN   EQU   LDS+20
LDSMEM   EQU   LDS+12
LDSMLN   EQU   LDS+11
LDSFUQ   EQU   LDSFLG
LDSPOS   EQU   LDS+9
LDSPAS   EQU   LDS+1
LDSPLN   EQU   LDS
LFILEVAL EQU   LFILE+1
LFILELEN EQU   LFILE
ODSVAL   EQU   ODS+21
ODSLEN   EQU   ODS+20
ODSMEM   EQU   ODS+12
ODSMLN   EQU   ODS+11
ODSFUQ   EQU   ODSFLG
ODSPOS   EQU   ODS+9
ODSPAS   EQU   ODS+1
ODSPLN   EQU   ODS
OFILEVAL EQU   OFILE+1
OFILELEN EQU   OFILE
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00090 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00089 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00088 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00087 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00086 EQU   VSDSCR+5
@NM00085 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00084 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00083 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00082 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00081 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00080 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00079 EQU   VSDVTOC
@NM00078 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00077 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00076 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00075 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00074 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00071 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00070 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00069 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00068 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00067 EQU   RCTAGL+10
@NM00066 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00065 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00064 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00063 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00062 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00061 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00060 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00059 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00058 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00057 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00056 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00055 EQU   EXSPACE+8
@NM00054 EQU   EXSPACE+6
@NM00053 EQU   EXSPACE+4
@NM00052 EQU   EXSPACE+1
@NM00051 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00050 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RF00510 EQU   @RC00497
@RF00529 EQU   @RC00416
@RT00556 EQU   @EL00002
@RF00573 EQU   @EL00003
@RC00742 EQU   @EL00004
@RC00796 EQU   @EL00005
@RF00825 EQU   @EL00006
@RF00855 EQU   @EL00007
@RF00896 EQU   @RC00885
@RF00904 EQU   @RC00885
@RC01065 EQU   @EL00009
@RC01191 EQU   @RC01184
@RF01190 EQU   @RC01184
@RC01216 EQU   @RC01209
@RF01215 EQU   @RC01209
@RC01243 EQU   @RC01236
@RF01242 EQU   @RC01236
@RC01268 EQU   @RC01261
@RF01267 EQU   @RC01261
@RF01158 EQU   @EL00010
@RF01583 EQU   @EL00012
@RT01632 EQU   @EL00013
@RT01673 EQU   @EL00014
@RC01765 EQU   @EL00014
@RF01818 EQU   @EL00015
@RF01969 EQU   @EL00017
@RC01900 EQU   @EL00017
@RF02042 EQU   @RC02027
@PB00018 EQU   @EL00001
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCAU03,(C'PLS1655',0603,76356)

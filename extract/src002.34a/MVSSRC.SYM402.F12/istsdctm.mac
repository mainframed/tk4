         TITLE 'TERM MACRO HNDLR-ISTSDCTM                              *
                        '
ISTSDCTM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISTSDCTM  78.100'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @12,4095(,@10)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@12                                    0001
*   RNCSAV1(2)=GPR13;               /* BACKWARD POINT                */
         ST    GPR13,RNCSAV1+4(,RNCAREG)                           0199
*   GPR13=ADDR(RNCSAV1);            /* SET UP OUR SAVE REG           */
         LA    GPR13,RNCSAV1(,RNCAREG)                             0200
*   MLCSAV3(3)=GPR13;               /* FORWARD POINT                 */
         ST    GPR13,MLCSAV3+8(,MLCAREG)                           0201
*   DATDREG=ADDR(RNCDAT1);          /* SET UP OUR DATA REG           */
         LA    DATDREG,RNCDAT1(,RNCAREG)                           0202
*   GENERATE;                                                      0203
*                                                                  0203
           USING @DATD,11                 ADDRESSABILITY FOR DATA
*/********************************************************************/
*/* DIAL SUPPORT                                                     */
*/********************************************************************/
*                                                                  0204
*   IF MLCMACRO='VTERM   '          /* IF DIAL SUPPORT MACR0 (VTERM) */
*       &RNCGCTRM='0'B THEN         /* WAS CTERM SPECIFIED ON      0204
*                                      PREVIOUS TERM MACRO           */
         CLC   MLCMACRO(8,MLCAREG),@CC01290                        0204
         BNE   @RF00204                                            0204
         TM    RNCGCTRM(RNCAREG),B'00000100'                       0204
         BNZ   @RF00204                                            0204
*     DO;                           /* NO. ERROR CONDITION           */
*/* ERRFMT    LEVEL(MACRO)  ERROR(SEQ)  ACTION(KILLBLD)              */
*                                                                  0206
*       DO;                                                        0206
*         DCL                                                      0207
*           1 CMZP0004 STATIC LOCAL,/* PARAMETER LIST PASSED TO ERROR
*                                      FORMAT ROUTINE                */
*            2 CMZL0004 FIXED(8) INIT(3),/* LEVEL PARAMETER (CLEV)   */
*            2 CMZE0004 FIXED(8) INIT(5),/* ERROR PARAMETER (CERR)   */
*            2 CMZA0004 CHAR(1) INIT('6'),/* ACTION PARAMETER (CACT) */
*            2 CMZS0004 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM   */
*         DCL                                                      0208
*           CMZR0004 REGISTER(1);   /* ESTABLISH PARAMeter           */
*         RESPECIFY                                                0209
*           CMZR0004 RSTD;          /* REGISTER FOR                  */
*         CMZR0004=ADDR(CMZP0004);  /* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0004,CMZP0004                                   0210
*         CALL ISTSDCC2;            /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0211
         BALR  @14,@15                                             0211
*         RESPECIFY                                                0212
*           CMZR0004 UNRSTD;                                       0212
*       END;                                                       0213
*       RC=4;                       /* SET ERROR RETURN              */
         MVC   RC(2),@CH00052                                      0214
*     END;                                                         0215
*   ELSE                                                           0216
*     DO;                           /* PROPER ORDER OR NOT VTERM     */
         B     @RC00204                                            0216
@RF00204 DS    0H                                                  0217
*/********************************************************************/
*/* WHILE THE RETURN CODE = 0, THIS CODE PREPARES THE PHR PARAMETERS */
*/* AND CALLS PHR.  UPON RETURN FROM PHR, THE RETURN CODE AND THE @  */
*/* OF THE NEXT MACRO KEYWORD ARE SAVED.                             */
*/********************************************************************/
*                                                                  0217
*       RC=0;                                                      0217
*                                                                  0217
         SLR   @07,@07                                             0217
         STH   @07,RC                                              0217
*       /*************************************************************/
*       /*                                                           */
*       /* SEGMENT(TRMCOMP)REQUEST                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0218
*       DO;                                                        0218
*         GOTO TRMCOMP;                                            0219
         B     TRMCOMP                                             0219
*TRMCOMP#:                                                         0220
*       END;                        /* PREPARE TO CALL SIFTDEF     0220
*                                      (ISTSDCRS) FOR COMP. MACRO OR
*                                      ANY OTHER.                    */
TRMCOMP# DS    0H                                                  0221
*       IF RC=0 THEN                /* CONTINUE PROCESSING ?         */
         LH    @07,RC                                              0221
         LTR   @07,@07                                             0221
         BNZ   @RF00221                                            0221
*         DO;                       /* YES. NOTE: GPR1 HAS @ OF TERM
*                                      OR COMP SIFT MODEL            */
*CALLRS:                                                           0223
*           CALL ISTSDCRS;          /* CALL SIFTDEF                  */
CALLRS   L     @15,@CV01253                                        0223
         BALR  @14,@15                                             0223
*           GPR1=MLCKWD;            /* FOR PHR IN FIRST PASS THRU  0224
*                                      DOWHILE                       */
         L     GPR1,MLCKWD(,MLCAREG)                               0224
*/********************************************************************/
*/* DIAL SUPPORT                                                     */
*/********************************************************************/
*                                                                  0225
*           IF MLCMACRO='VTERM   ' THEN                            0225
         CLC   MLCMACRO(8,MLCAREG),@CC01290                        0225
         BNE   @RF00225                                            0225
*             DO;                                                  0226
*               KWTBLAD=ADDR(VTRKWTBL);/* SET UP 'VTERM' K.W. TABLE  */
         LA    @07,VTRKWTBL                                        0227
         ST    @07,KWTBLAD                                         0227
*               RTRVTERM=ON;        /* FLAG ENTRY AS VTERM           */
         L     @07,MLCPTR3(,MLCAREG)                               0228
         OI    RTRVTERM(@07),B'00000100'                           0228
*             END;                                                 0229
*           ELSE                                                   0230
*             DO;                                                  0230
         B     @RC00225                                            0230
@RF00225 DS    0H                                                  0231
*               KWTBLAD=ADDR(TRMKWTBL);/* SAME K.W. TABLE FOR 'TERM'
*                                      AND 'COMP'                    */
         LA    @07,TRMKWTBL                                        0231
         ST    @07,KWTBLAD                                         0231
*             END;                  /* 'TERM' OR COMP                */
*/********************************************************************/
*/* RC IS STILL ZERO FROM RETURN FROM 'TERMCOMP'                     */
*/********************************************************************/
*                                                                  0233
*           DO WHILE(RC=0);         /* SCAN THE MACRO AND HANDLE     */
@RC00225 B     @DE00233                                            0233
@DL00233 DS    0H                                                  0234
*             CALL DOWHILE;         /* EACH KEYWORD IN TURN          */
         BAL   @14,DOWHILE                                         0234
*DOLOOP:                                                           0235
*             ;                                                    0235
*                                                                  0235
DOLOOP   DS    0H                                                  0236
*/********************************************************************/
*/* AT THIS POINT A RETURN CODE OF 0 MEANS CONTINUE THE DO WHILE     */
*/* LOOP.  OTHERWISE, THE LOOP IS DISCONTINUED WITH A RETURN CODE OF */
*/* 8 (NORMAL END OF STRING) OR 4 (SIGNIFICANT ERROR).               */
*/********************************************************************/
*                                                                  0236
*           END;                                                   0236
@DE00233 LH    @07,RC                                              0236
         LTR   @07,@07                                             0236
         BZ    @DL00233                                            0236
*         END;                      /* END DO IF RC = 0 FROM TRMCOMP */
*       ELSE                                                       0238
*         ;                         /* RETURN CODE FROM TRMCOMP NOT
*                                      EQ 0 (ITS 4-KILL THE BUILD    */
@RF00221 DS    0H                                                  0239
*     END;                          /* END ELSE FOR NO CTERM BEFORE
*                                      VTERM ERROR CONDITION         */
*/********************************************************************/
*/* AT THIS POINT IF RC=8, INDICATING END OF STRING, WE CALL AREA    */
*/* HANDLER TO MOVE THE MODEL AREA INTO THE BUILD AREA.  UPON RETURN */
*/* WE UPDATE THE CURRENT ENTRY POINTER TO THIS ENTRY. ALSO, ANY     */
*/* COUNTS THAT NEED BE UPDATED, ARE DONE AT THIS POINT.             */
*/********************************************************************/
*                                                                  0240
*MAINRC:                                                           0240
*   IF RC=8 THEN                                                   0240
@RC00204 DS    0H                                                  0240
MAINRC   CLC   RC(2),@CH00036                                      0240
         BNE   @RF00240                                            0240
*     DO;                                                          0241
*                                                                  0241
*       /*************************************************************/
*       /*                                                           */
*       /* SEGMENT(POLDEVT)REQUEST                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0242
*       DO;                                                        0242
*         GOTO POLDEVT;                                            0243
         B     POLDEVT                                             0243
*POLDEVT#:                                                         0244
*       END;                        /* CHECK POLIMIT & DEVICE        */
POLDEVT# DS    0H                                                  0245
*       IF RC=8 THEN                                               0245
         CLC   RC(2),@CH00036                                      0245
         BNE   @RF00245                                            0245
*         DO;                       /* COMBINATION OK. CONTINUE      */
*/********************************************************************/
*/* DIAL                                                             */
*/********************************************************************/
*                                                                  0247
*           CALL CTRMUTRM;          /* CALL SUB TO CALL AREA HANDLER
*                                      (ISTSDCC1)                    */
         BAL   @14,CTRMUTRM                                        0247
*TRMRET1:                                                          0248
*           ;                       /* ****NOTE THIS LABEL USED AS A
*                                      RETURN POINT BY CTRMUTRM      */
TRMRET1  DS    0H                                                  0249
*           RC=GPR15;                                              0249
*                                                                  0249
         STH   GPR15,RC                                            0249
*/********************************************************************/
*/* AT THIS TIME THE VALID RETURN CODE HAS CHANGED FROM 8 TO ZERO    */
*/********************************************************************/
*                                                                  0250
*           IF RC=0 THEN                                           0250
         LH    @07,RC                                              0250
         LTR   @07,@07                                             0250
         BNZ   @RF00250                                            0250
*             DO;                   /* CONTINUE THE BUILD            */
*/********************************************************************/
*/* CTRMUTRM GOT AN ENTRY IN ALL CASES EXCEPT 'CTERM' NO 'UTERM'.    */
*/* IF ENTRY WAS GOTTEN (GETSW=ON) MODEL WAS MOVED INTO BUILD AREA:  */
*/* PROCESS IT.  IN NO ENTRY (GETSW=OFF) NOTHING TO PROCESS.         */
*/********************************************************************/
*                                                                  0252
*               IF GETSW='0'B THEN                                 0252
         TM    GETSW,B'01000000'                                   0252
         BZ    @RT00252                                            0252
*                 ;                                                0253
*               ELSE                                               0254
*                 DO;                                              0254
*                   CALL RESETYPE;  /* SET TERMINAL CHARACTERISTICS
*                                      IN DEVCHCK                    */
         BAL   @14,RESETYPE                                        0255
*RESRET01:                                                         0256
*                   ;                                              0256
RESRET01 DS    0H                                                  0257
*                   IF DEVTCODE=DEV2980/* SPECIAL FOR 2980           */
*                     THEN                                         0257
         L     @07,MLCPTR4(,MLCAREG)                               0257
         CLI   DEVTCODE(@07),X'18'                                 0257
         BNE   @RF00257                                            0257
*                     DO;                                          0258
*                                                                  0258
*                       /*********************************************/
*                       /*                                           */
*                       /* SEGMENT(T2980)REQUEST                     */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0259
*                       DO;                                        0259
*                         GOTO T2980;                              0260
         B     T2980                                               0260
*T2980#:                                                           0261
*                       END;                                       0261
*                                                                  0261
T2980#   DS    0H                                                  0262
*/*  BUILD SECOND ENTRY                                              */
*                                                                  0262
*                     END;                                         0262
*                   ELSE                                           0263
*                     ;             /* NOT 2980                      */
@RF00257 DS    0H                                                  0264
*                   IF RC=0 THEN                                   0264
         LH    @07,RC                                              0264
         LTR   @07,@07                                             0264
         BNZ   @RF00264                                            0264
*                     DO;           /* IF GOOD RETURN FROM T2980     */
*/********************************************************************/
*/* UPDATE APPROPRIATE COUNTS FOR TERMINAL                           */
*/********************************************************************/
*                                                                  0266
*                       /*********************************************/
*                       /*                                           */
*                       /* SEGMENT(COUNTS)REQUEST                    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0266
*                       DO;                                        0266
*                         GOTO COUNTS;                             0267
         B     COUNTS                                              0267
*COUNTS#:                                                          0268
*                       END;                                       0268
COUNTS#  DS    0H                                                  0269
*                     END;          /* END VALID RETURN FROM T2980   */
*                   ELSE                                           0270
*                     ;                                            0270
@RF00264 DS    0H                                                  0271
*                 END;              /* IF GETSW ^= 0                 */
*             END;                  /* END VALID RETURN FROM CTRMUTRM*/
*           ELSE                                                   0273
*             ;                     /* INVALID RETURN FROM CTRMUTRM  */
@RF00250 DS    0H                                                  0274
*         END;                      /* END VALID RETURN FROM POLDEVT */
*       ELSE                                                       0275
*         ;                         /* INVALID RETURN FROM POLDEVT   */
@RF00245 DS    0H                                                  0276
*     END;                          /* END VALID RETURN FROM DOWHILE */
*   ELSE                                                           0277
*     ;                             /* INVALID RETURN FROM DOWHILE   */
@RF00240 DS    0H                                                  0278
*   GPR13=RNCSAV1(2);               /* RESTORE CALLERS REGS          */
@RC00240 L     GPR13,RNCSAV1+4(,RNCAREG)                           0278
*/********************************************************************/
*/* AT THIS POINT RC CONTAINS EITHER A 0 OR A 4 INDICATING A GOOD    */
*/* RETURN CODE OR AN ERROR RETURN CODE WHICH WILL KILL THE BUILD.   */
*/********************************************************************/
*                                                                  0279
*MAINRET:                                                          0279
*   RETURN CODE(RC);                /* RETURN TO CALLER              */
MAINRET  LH    @15,RC                                              0279
         L     @14,12(,@13)                                        0279
         LM    @00,@12,20(@13)                                     0279
         BR    @14                                                 0279
*DOWHILE:                                                          0280
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0280
DOWHILE  DS    0H                                                  0281
*   GPR0=KWTBLAD;                   /* @ OF APPROPRIATE K.W. TABLE   */
         L     GPR0,KWTBLAD                                        0281
*   PHR1REG=ADDR(RNCPHR1);          /* @ PHR OUTPUT AREA             */
         LA    PHR1REG,RNCPHR1(,RNCAREG)                           0282
*CALLPHR:                                                          0283
*   CALL ISTINCPH;                  /* CALL PHR TO LOCATE KEYWORD    */
CALLPHR  L     @15,@CV01248                                        0283
         BALR  @14,@15                                             0283
*   RC=GPR15;                                                      0284
         STH   GPR15,RC                                            0284
*   KWDPTR=GPR1;                    /* SAVE PTR TO NEXT KEYWORD      */
         ST    GPR1,KWDPTR                                         0285
*   IF RC=0                         /* WAS KEYWORD FOUND ?           */
*     THEN                                                         0286
         LH    @07,RC                                              0286
         LTR   @07,@07                                             0286
         BNZ   @RF00286                                            0286
*     DO;                                                          0287
*                                                                  0287
*/********************************************************************/
*/* IF THE RETURN CODE FROM PHR = 0, CALL THE PARAMETER HANDLER      */
*/* WHOSE ADDRESS WAS RETURNED IN GPR0 BY PHR.                       */
*/* NOTE: THE EXTERNAL PARAMETER HANDLERS WILL RETURN TO THIS        */
*/*       ROUTINE VIA A RETURN.  ALL INTERNAL PARAMETER HANDLERS     */
*/*       WILL RETURN TO THIS ROUTINE VIA A GOTO 'MAINSUB'.          */
*/* NOTE: ALL PARAMETER HANDLERS MUST HAVE A 0 OR 4 RETURN CODE IN   */
*/*       GPR15 TO INDICATE CONTINUE PROCESSING OR KILL THE BUILD.   */
*/********************************************************************/
*                                                                  0288
*       GPR15=GPR0;                                                0288
         LR    GPR15,GPR0                                          0288
*CALLPARM:                                                         0289
*       CALL PARMHDLR;                                             0289
CALLPARM BALR  @14,@15                                             0289
*MAINSUB:                                                          0290
*       ;                                                          0290
MAINSUB  DS    0H                                                  0291
*       RC=GPR15;                                                  0291
         STH   GPR15,RC                                            0291
*     END;                                                         0292
*   ELSE                                                           0293
*     DO;                                                          0293
*                                                                  0293
         B     @RC00286                                            0293
@RF00286 DS    0H                                                  0294
*/********************************************************************/
*/* IF THE RETURN CODE FROM PHR = 4 INDICATING THE KEYWORD WAS NOT   */
*/* FOUND IN THE PARAMETER TABLE, WRITE THE APPROPRIATE ERROR        */
*/* MESSAGE, SET THE RETURN CODE = 0 AND CONTINUE THE DO WHILE LOOP. */
*/********************************************************************/
*                                                                  0294
*       IF RC=4 THEN                                               0294
         CLC   RC(2),@CH00052                                      0294
         BNE   @RF00294                                            0294
*         DO;                                                      0295
*ERR03:                                                            0296
*                                                                  0296
*/* ERRFMT    LEVEL(PARM)  ERROR(INVAL)  ACTION(IGNORE)              */
*                                                                  0296
*           DO;                                                    0296
ERR03    DS    0H                                                  0297
*             DCL                                                  0297
*               1 CMZP0009 STATIC LOCAL,/* PARAMETER LIST PASSED TO
*                                      ERROR FORMAT ROUTINE          */
*                2 CMZL0009 FIXED(8) INIT(4),/* LEVEL PARAMETER    0297
*                                      (CLEV)                        */
*                2 CMZE0009 FIXED(8) INIT(4),/* ERROR PARAMETER    0297
*                                      (CERR)                        */
*                2 CMZA0009 CHAR(1) INIT('1'),/* ACTION PARAMETER  0297
*                                      (CACT)                        */
*                2 CMZS0009 FIXED(8) INIT(0);/* LENGTH OF STRING   0297
*                                      PARAM                         */
*             DCL                                                  0298
*               CMZR0009 REGISTER(1);/* ESTABLISH PARAMeter          */
*             RESPECIFY                                            0299
*               CMZR0009 RSTD;      /* REGISTER FOR                  */
*             CMZR0009=ADDR(CMZP0009);/* ADDRESS OF PARAMETER LIST   */
         LA    CMZR0009,CMZP0009                                   0300
*             CALL ISTSDCC2;        /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0301
         BALR  @14,@15                                             0301
*             RESPECIFY                                            0302
*               CMZR0009 UNRSTD;                                   0302
*           END;                                                   0303
*           RC=0;                                                  0304
         SLR   @07,@07                                             0304
         STH   @07,RC                                              0304
*         END;                                                     0305
*       ELSE                                                       0306
*         DO;                                                      0306
*                                                                  0306
         B     @RC00294                                            0306
@RF00294 DS    0H                                                  0307
*/********************************************************************/
*/* IF THE RETURN CODE FROM PHR = 8, 12, OR 16 INDICATING AN END OF  */
*/* STRING OR SYNTAX OR OTHER ERROR, THE FOLLOWING ROUTINE IS        */
*/* EXECUTED. FOR AN ERROR CONDITION, IT PUTS OUT AN ERROR MSG WITH  */
*/* A RETURN CODE.  FOR THE END OF STRING CONDITION, DEVICE          */
*/* DEPENDENT (MOSTLY) BITS ARE SET IN THE LINE ENTRY.               */
*/********************************************************************/
*                                                                  0307
*CALLRC4:                                                          0307
*           CALL CTMRCGT4;                                         0307
CALLRC4  BAL   @14,CTMRCGT4                                        0307
*CTMRET01:                                                         0308
*           ;                                                      0308
CTMRET01 DS    0H                                                  0309
*         END;                                                     0309
*     END;                                                         0310
@RC00294 DS    0H                                                  0311
*   GPR1=KWDPTR;                    /* RESTORE PTR TO NEXT KEYWORD   */
@RC00286 L     GPR1,KWDPTR                                         0311
*   MLCKWD=GPR1;                    /* IT IS NOW CURRENT K.W.        */
         ST    GPR1,MLCKWD(,MLCAREG)                               0312
*   GPR14=ADDR(DOLOOP);                                            0313
         LA    GPR14,DOLOOP                                        0313
*CTMRCGT4:                                                         0314
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0314
         B     @PB00003                                            0314
CTMRCGT4 DS    0H                                                  0315
*   IF RC=8                         /* PARM STRING EXHAUSTED         */
*     THEN                                                         0315
         CLC   RC(2),@CH00036                                      0315
         BNE   @RF00315                                            0315
*     DO;                                                          0316
*                                                                  0316
*/********************************************************************/
*/* DIAL                                                             */
*/********************************************************************/
*                                                                  0317
*       IF MLCMACRO='VTERM   ' THEN                                0317
         CLC   MLCMACRO(8,MLCAREG),@CC01290                        0317
         BNE   @RF00317                                            0317
*         DEVTCODE=DEVMTA;          /* ALL VTERMS ARE MTA    @DM12891*/
         L     @07,MLCPTR4(,MLCAREG)                               0318
         MVI   DEVTCODE(@07),X'28'                                 0318
*       ELSE                                                       0319
*         DO;                       /* IF TERM, COMP, UTERM, ETC.    */
         B     @RC00317                                            0319
@RF00317 DS    0H                                                  0320
*/********************************************************************/
*/* ALL START/STOP LINES HAVE THE SAME LINE CONTROL DICIPLINE FOR    */
*/* ALL DEVICES. CHECK DEVICES FOR START/STOP TYPE AND SET LC        */
*/* DICIPLINE AS INDICATED.                                          */
*/********************************************************************/
*                                                                  0320
*           IF DEVTCODE=DEV3284×DEVTCODE=DEV3286 THEN              0320
         L     @07,MLCPTR4(,MLCAREG)                               0320
         CLI   DEVTCODE(@07),X'1A'                                 0320
         BE    @RT00320                                            0320
         CLI   DEVTCODE(@07),X'1B'                                 0320
         BNE   @RF00320                                            0320
@RT00320 DS    0H                                                  0321
*             DO;                                                  0321
*               DEVINPUT=OFF;       /* OUTPUT ONLY DEVICES   @XA07960*/
*               DEVOTPUT=ON;        /* OUTPUT DEVICE                 */
*               DEVSPS=ON;          /* START PRINT SENSITIVE @DM09025*/
         L     @07,MLCPTR4(,MLCAREG)                               0324
         OI    DEVOTPUT(@07),B'01001000'                           0324
         NI    DEVINPUT(@07),B'01111111'                           0324
*             END;                                                 0325
*           ELSE                                                   0326
*             ;                                                    0326
@RF00320 DS    0H                                                  0327
*         END;                      /* END ELSE FOR MLCMACRO ^ VTERM */
*     END;                          /* END IF RC = 8                 */
*   ELSE                                                           0329
*     DO;                                                          0329
         B     @RC00315                                            0329
@RF00315 DS    0H                                                  0330
*       IF RC=12                    /* SYNTAX ERROR                  */
*         THEN                                                     0330
         CLC   RC(2),@CH00033                                      0330
         BNE   @RF00330                                            0330
*ERR04:                                                            0331
*                                                                  0331
*/* ERRFMT    LEVEL(PARM)  ERROR(SYN)  ACTION(KILLBLD)               */
*                                                                  0331
*         DO;                                                      0331
ERR04    DS    0H                                                  0332
*           DCL                                                    0332
*             1 CMZP0010 STATIC LOCAL,/* PARAMETER LIST PASSED TO  0332
*                                      ERROR FORMAT ROUTINE          */
*              2 CMZL0010 FIXED(8) INIT(4),/* LEVEL PARAMETER (CLEV) */
*              2 CMZE0010 FIXED(8) INIT(6),/* ERROR PARAMETER (CERR) */
*              2 CMZA0010 CHAR(1) INIT('6'),/* ACTION PARAMETER    0332
*                                      (CACT)                        */
*              2 CMZS0010 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM */
*           DCL                                                    0333
*             CMZR0010 REGISTER(1); /* ESTABLISH PARAMeter           */
*           RESPECIFY                                              0334
*             CMZR0010 RSTD;        /* REGISTER FOR                  */
*           CMZR0010=ADDR(CMZP0010);/* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0010,CMZP0010                                   0335
*           CALL ISTSDCC2;          /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0336
         BALR  @14,@15                                             0336
*           RESPECIFY                                              0337
*             CMZR0010 UNRSTD;                                     0337
*         END;                                                     0338
*       ELSE                                                       0339
*ERR05:                                                            0339
*                                                                  0339
*/* ERRFMT    LEVEL(PARM)  ERROR(INVAL)  ACTION(KILLBLD)             */
*                                                                  0339
*         DO;                                                      0339
         B     @RC00330                                            0339
@RF00330 DS    0H                                                  0339
ERR05    DS    0H                                                  0340
*           DCL                                                    0340
*             1 CMZP0011 STATIC LOCAL,/* PARAMETER LIST PASSED TO  0340
*                                      ERROR FORMAT ROUTINE          */
*              2 CMZL0011 FIXED(8) INIT(4),/* LEVEL PARAMETER (CLEV) */
*              2 CMZE0011 FIXED(8) INIT(4),/* ERROR PARAMETER (CERR) */
*              2 CMZA0011 CHAR(1) INIT('6'),/* ACTION PARAMETER    0340
*                                      (CACT)                        */
*              2 CMZS0011 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM */
*           DCL                                                    0341
*             CMZR0011 REGISTER(1); /* ESTABLISH PARAMeter           */
*           RESPECIFY                                              0342
*             CMZR0011 RSTD;        /* REGISTER FOR                  */
*           CMZR0011=ADDR(CMZP0011);/* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0011,CMZP0011                                   0343
*           CALL ISTSDCC2;          /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0344
         BALR  @14,@15                                             0344
*           RESPECIFY                                              0345
*             CMZR0011 UNRSTD;                                     0345
*         END;                                                     0346
*       RC=4;                                                      0347
@RC00330 MVC   RC(2),@CH00052                                      0347
*     END;                                                         0348
*   GPR14=ADDR(CTMRET01);                                          0349
@RC00315 LA    GPR14,CTMRET01                                      0349
*   END CTMRCGT4;                                                  0350
@EL00003 DS    0H                                                  0350
@EF00003 DS    0H                                                  0350
@ER00003 BR    @14                                                 0350
*                                                                  0351
*/********************************************************************/
*/*           ADDR PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0351
*TRMADDR:                                                          0351
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0351
*                                                                  0351
TRMADDR  DS    0H                                                  0352
*/********************************************************************/
*/* THIS ROUTINE WILL TAKE THE COMPONENT ADDRESS IN HEXIDECIMAL FORM */
*/* AND MOVE IT TO THE TERMINAL  ENTRY IN THE RDT.                   */
*/********************************************************************/
*                                                                  0352
*   GPR0=PHRF5SL(1);                /* LENGTH OF ADDR IN EBCDIC      */
         LH    GPR0,PHRF5SL(,PHR1REG)                              0352
*   GPR1=PHRF5SPT(1);               /* PTR TO SUBPARM (EBCDIC ADDR)  */
         L     GPR1,PHRF5SPT(,PHR1REG)                             0353
*   CALL ISTSDCC4;                  /* EBCHEX TO CONVERT TO HEX      */
         L     @15,@CV01252                                        0354
         BALR  @14,@15                                             0354
*   RTRCTADR=GPR0;                  /* GET LENGTH FOR @ING CHARACTERS*/
         L     @07,MLCPTR3(,MLCAREG)                               0355
         STH   GPR0,RTRCTADR(,@07)                                 0355
*   RTRCADDR(1:RTRCTADR)=ADDRCHAR(1:RTRCTADR);/* MOVE CHARS          */
         L     @04,MLCPTR3(,MLCAREG)                               0356
         LH    @04,RTRCTADR(,@04)                                  0356
         BCTR  @04,0                                               0356
         L     @03,PHRF5SPT(,PHR1REG)                              0356
         EX    @04,@SM01896                                        0356
*   LCLFADDR=ON;                    /* SET ADDRESS FOOTPRINT @DM08373*/
         OI    LCLFADDR,B'10000000'                                0357
*   IF PHRF5NSP>1                   /* ARE THERE MORE                */
*     THEN                                                         0358
         L     @07,PHRF5NSP(,PHR1REG)                              0358
         C     @07,@CF00039                                        0358
         BNH   @RF00358                                            0358
*     DO;                           /* IF THERE ARE                  */
*       GPR0=PHRF5SL(2);            /* SET UP PARMS FOR ISTSDCC4     */
         LH    GPR0,PHRF5SL+8(,PHR1REG)                            0360
*       GPR1=PHRF5SPT(2);                                          0361
         L     GPR1,PHRF5SPT+8(,PHR1REG)                           0361
*       CALL ISTSDCC4;              /* EBCHEX                        */
         L     @15,@CV01252                                        0362
         BALR  @14,@15                                             0362
*       T2980CT=GPR0;               /* PICK UP LENGTH                */
         STH   GPR0,T2980CT                                        0363
*/********************************************************************/
*/* THE NEXT 2 INTERNAL FIELDS ARE USED LATER BY SEGMENT T2980.      */
*/********************************************************************/
*                                                                  0364
*       T2980AD(1:T2980CT)=ADDRCHA2(1:T2980CT);                    0364
         LH    @07,T2980CT                                         0364
         BCTR  @07,0                                               0364
         L     @04,PHRF5SPT+8(,PHR1REG)                            0364
         EX    @07,@SM01899                                        0364
*     END;                                                         0365
*   GPR15=0;                        /* SET RTN CODE = 0              */
@RF00358 SLR   GPR15,GPR15                                         0366
*   GPR14=ADDR(MAINSUB);                                           0367
         LA    GPR14,MAINSUB                                       0367
*   END TRMADDR;                                                   0368
@EL00004 DS    0H                                                  0368
@EF00004 DS    0H                                                  0368
@ER00004 BR    @14                                                 0368
*                                                                  0369
*/********************************************************************/
*/*          BHSET PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0369
*TRMBHSET:                                                         0369
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0369
*                                                                  0369
TRMBHSET DS    0H                                                  0370
*/********************************************************************/
*/* THIS ROUTINE WILL PROCESS THE BHSET PARAMETER OF THE TERM MACRO. */
*/* IF 'NONE' OR 'DYNAMIC' HAS BEEN SPECIFIED THE APPROPRIATE FLAG   */
*/* IS SET IN THE RDT. IF A SET NAME WAS SPECIFIED IT IS MOVED TO    */
*/* THE RDT. IF A VALIDITY OR INVALID COMBINATION ERROR OCCURS,      */
*/* ERRFMT IS ISSUED AND THE PARAMETER IS IGNORED.                   */
*/********************************************************************/
*                                                                  0370
*   IF PHRF34SP(1,1:8)='NONE    '×PHRF34SP(1)=BLANK8 THEN          0370
         CLC   PHRF34SP(8,PHR1REG),@CC01377                        0370
         BE    @RT00370                                            0370
         CLC   PHRF34SP(8,PHR1REG),@CC01247                        0370
         BNE   @RF00370                                            0370
@RT00370 DS    0H                                                  0371
*     DO;                           /* IF 'NONE' SPECIFIED           */
*       RTRRDBHN=ON;                /* TURN ON 'NONE' FLG IN RDT     */
*       RTRRDBHD=OFF;                                              0373
         L     @07,MLCPTR3(,MLCAREG)                               0373
         OI    RTRRDBHN(@07),B'10000000'                           0373
         NI    RTRRDBHD(@07),B'10111111'                           0373
*     END;                                                         0374
*   ELSE                                                           0375
*     DO;                                                          0375
         B     @RC00370                                            0375
@RF00370 DS    0H                                                  0376
*       IF PHRF34SP(1,1:8)='DYNAMIC ' THEN                         0376
         CLC   PHRF34SP(8,PHR1REG),@CC01378                        0376
         BNE   @RF00376                                            0376
*         DO;                                                      0377
*                                                                  0377
*/********************************************************************/
*/* IF DYNAMIC IS SPECIFIED THE SYSCNTRL MACRO MUST HAVE HAD THE     */
*/* MODIFY BLOCK HANDLER SET ASSOCIATION (BHSASSC) SUBPARM LISTED    */
*/* AS AN OPTION ENTRY.                                              */
*/********************************************************************/
*                                                                  0378
*           IF RRNCAMBH=ON          /* IF BHSASSC SET BY SYSCNTRL    */
*             THEN                                                 0378
         L     @07,RNCRN(,RNCAREG)                                 0378
         TM    RRNCAMBH(@07),B'00001000'                           0378
         BNO   @RF00378                                            0378
*             DO;                                                  0379
*               RTRRDBHD=ON;        /* SET 'DYNAMIC' FLG IN RDT      */
*               RTRRDBHN=OFF;       /* AND TURN OFF 'NONE' FLAG      */
         L     @07,MLCPTR3(,MLCAREG)                               0381
         OI    RTRRDBHD(@07),B'01000000'                           0381
         NI    RTRRDBHN(@07),B'01111111'                           0381
*             END;                                                 0382
*           ELSE                                                   0383
*             DO;                                                  0383
*                                                                  0383
         B     @RC00378                                            0383
@RF00378 DS    0H                                                  0384
*/* ERRFMT    LEVEL(PARM)  ERROR(COMB)  ACTION(IGNORE)               */
*                                                                  0384
*               DO;                                                0384
*                 DCL                                              0385
*                   1 CMZP0012 STATIC LOCAL,/* PARAMETER LIST PASSED
*                                      TO ERROR FORMAT ROUTINE       */
*                    2 CMZL0012 FIXED(8) INIT(4),/* LEVEL PARAMETER
*                                      (CLEV)                        */
*                    2 CMZE0012 FIXED(8) INIT(1),/* ERROR PARAMETER
*                                      (CERR)                        */
*                    2 CMZA0012 CHAR(1) INIT('1'),/* ACTION PARAMETER
*                                      (CACT)                        */
*                    2 CMZS0012 FIXED(8) INIT(0);/* LENGTH OF STRING
*                                      PARAM                         */
*                 DCL                                              0386
*                   CMZR0012 REGISTER(1);/* ESTABLISH PARAMeter      */
*                 RESPECIFY                                        0387
*                   CMZR0012 RSTD;  /* REGISTER FOR                  */
*                 CMZR0012=ADDR(CMZP0012);/* ADDRESS OF PARAMETER  0388
*                                      LIST                          */
         LA    CMZR0012,CMZP0012                                   0388
*                 CALL ISTSDCC2;    /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0389
         BALR  @14,@15                                             0389
*                 RESPECIFY                                        0390
*                   CMZR0012 UNRSTD;                               0390
*               END;                                               0391
*               RTRRDBHD=OFF;       /* TURN OFF 'DYNAMIC' FLG IN     */
*               RTRRDBHN=ON;        /* RDT AND SET THE 'NONE' ON     */
         L     @07,MLCPTR3(,MLCAREG)                               0393
         OI    RTRRDBHN(@07),B'10000000'                           0393
         NI    RTRRDBHD(@07),B'10111111'                           0393
*             END;                                                 0394
*         END;                      /* END IF 'DYNAMIC'              */
*       ELSE                                                       0396
*         DO;                       /* ^ DYNAMIC & ^ NONE, THUS IT IS
*                                      A                             */
*                                                                  0396
         B     @RC00376                                            0396
@RF00376 DS    0H                                                  0397
*           /*********************************************************/
*           /*                                                       */
*           /* NAME                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0397
*           RTRBHSN1=PHRF34SP(1);   /* MOVE SET NAME TO              */
         L     @07,MLCPTR3(,MLCAREG)                               0397
         MVC   RTRBHSN1(8,@07),PHRF34SP(PHR1REG)                   0397
*           RTRRDBHN=OFF;           /* RDT AND TURN OFF 'NONE' FLG   */
*           RTRRDBHD=OFF;           /* 'DYNAMIC' FLAGS               */
         NI    RTRRDBHN(@07),B'00111111'                           0399
*         END;                                                     0400
*     END;                          /* END ELSE IF NOT 'NONE'        */
@RC00376 DS    0H                                                  0402
*   GPR15=0;                                                       0402
@RC00370 SLR   GPR15,GPR15                                         0402
*   GPR14=ADDR(MAINSUB);                                           0403
         LA    GPR14,MAINSUB                                       0403
*   END TRMBHSET;                                                  0404
@EL00005 DS    0H                                                  0404
@EF00005 DS    0H                                                  0404
@ER00005 BR    @14                                                 0404
*                                                                  0405
*/********************************************************************/
*/*          DILNO PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0405
*TRMDILNO:                                                         0405
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0405
TRMDILNO DS    0H                                                  0406
*   IF RNCLN->RLNRACAN='1'B         /*                       @XM10801*/
*     THEN                                                         0406
         L     @07,RNCLN(,RNCAREG)                                 0406
         TM    RLNRACAN(@07),B'01000000'                           0406
         BNO   @RF00406                                            0406
*     DO;                           /*                       @XM10801*/
*       DIALOUT='1'B;               /* INITIALIZE FOR DIALOUT SUPPORT
*                                      TESTED LATER BY 'COUNTS'      */
         OI    DIALOUT,B'00100000'                                 0408
*       GPR0=PHRF5SL(1);            /* SIZE OF RDT EXTENTION NEEDED  */
         LH    GPR0,PHRF5SL(,PHR1REG)                              0409
*       GPR1=0;                                                    0410
         SLR   @07,@07                                             0410
         LR    GPR1,@07                                            0410
*       IF GPR0>0 THEN                                             0411
         CR    GPR0,@07                                            0411
         BNH   @RF00411                                            0411
*         DO;                                                      0412
*           CALL ISTSDCC1;          /* CALL AREA HANDLER TO GET RDT
*                                      EXTENTION FOR DIAL CHARACTERS */
         L     @15,@CV01249                                        0413
         BALR  @14,@15                                             0413
*           IF GPR15=0 THEN                                        0414
         LTR   GPR15,GPR15                                         0414
         BNZ   @RF00414                                            0414
*             DO;                                                  0415
*               RTRDIAA=GPR0;       /* SAVE RELATIVE OFFSET TO DIAL
*                                      CHARACTERS                    */
         L     @07,MLCPTR3(,MLCAREG)                               0416
         ST    GPR0,RTRDIAA(,@07)                                  0416
*               RTRCTDIA=PHRF5SL(1);/* COUNT OF CHARS. IN DIAL NO.   */
         LH    @04,PHRF5SL(,PHR1REG)                               0417
         STH   @04,RTRCTDIA(,@07)                                  0417
*               DIALXTSN(1:PHRF5SL(1))=DIALCHAR(1:PHRF5SL(1));/* FILL
*                                      IN DIAL EXTENTION             */
         BCTR  @04,0                                               0418
         L     @07,PHRF5SPT(,PHR1REG)                              0418
         EX    @04,@SM01902                                        0418
*             END;                                                 0419
*           ELSE                                                   0420
*             GPR15=4;              /* IF NO SPACE, MSG BY AREA    0420
*                                      HANDLER. KILL THE BUILD       */
         B     @RC00414                                            0420
@RF00414 LA    GPR15,4                                             0420
*         END;                                                     0421
*       ELSE                                                       0422
*         GPR15=0;                                                 0422
         B     @RC00411                                            0422
@RF00411 SLR   GPR15,GPR15                                         0422
*     END;                          /*                       @XM10801*/
*   ELSE                                                           0424
*     GPR15=0;                      /*                       @XM10801*/
         B     @RC00406                                            0424
@RF00406 SLR   GPR15,GPR15                                         0424
*   GPR14=ADDR(MAINSUB);                                           0425
@RC00406 LA    GPR14,MAINSUB                                       0425
*   END TRMDILNO;                                                  0426
@EL00006 DS    0H                                                  0426
@EF00006 DS    0H                                                  0426
@ER00006 BR    @14                                                 0426
*                                                                  0427
*/********************************************************************/
*/*                                                                  */
*/*            DIRECTN PARAMETER SUBROUTINE                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0427
*TRMDRCTN:                                                         0427
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0427
TRMDRCTN DS    0H                                                  0428
*   IF PHRF2VAL(1)=DRCTNIN          /* INPUT ONLY DEVICE ?           */
*     THEN                                                         0428
         CLC   PHRF2VAL(4,PHR1REG),@CF00039                        0428
         BNE   @RF00428                                            0428
*     DO;                                                          0429
*       DEVINPUT=ON;                /* DEVICE FLAGS FOR              */
*       DEVOTPUT=OFF;               /* INPUT BUT NOT OUTPUT          */
         L     @07,MLCPTR4(,MLCAREG)                               0431
         OI    DEVINPUT(@07),B'10000000'                           0431
         NI    DEVOTPUT(@07),B'10111111'                           0431
*     END;                                                         0432
*   ELSE                                                           0433
*     IF PHRF2VAL(1)=DRCTNOUT       /* OUTPUT ONLY DEVICE ?          */
*       THEN                                                       0433
         B     @RC00428                                            0433
@RF00428 CLC   PHRF2VAL(4,PHR1REG),@CF00180                        0433
         BNE   @RF00433                                            0433
*       DO;                                                        0434
*         DEVINPUT=OFF;             /* DEVICE FLAGS FOR              */
*         DEVOTPUT=ON;              /* OUTPUT BUT NOT INPUT          */
         L     @07,MLCPTR4(,MLCAREG)                               0436
         OI    DEVOTPUT(@07),B'01000000'                           0436
         NI    DEVINPUT(@07),B'01111111'                           0436
*       END;                                                       0437
*     ELSE                                                         0438
*       DO;                         /* MUST BE INPUT AND OUTPUT      */
         B     @RC00433                                            0438
@RF00433 DS    0H                                                  0439
*         DEVINPUT=ON;              /* SET DEVICE FLAGS FOR BOTH     */
*         DEVOTPUT=ON;                                             0440
         L     @07,MLCPTR4(,MLCAREG)                               0440
         OI    DEVINPUT(@07),B'11000000'                           0440
*       END;                                                       0441
*   GPR14=ADDR(MAINSUB);                                           0442
@RC00433 DS    0H                                                  0442
@RC00428 LA    GPR14,MAINSUB                                       0442
*   GPR15=0;                        /* RETURN CODE                   */
         SLR   GPR15,GPR15                                         0443
*   END TRMDRCTN;                                                  0444
@EL00007 DS    0H                                                  0444
@EF00007 DS    0H                                                  0444
@ER00007 BR    @14                                                 0444
*                                                                  0445
*/********************************************************************/
*/*        ITBMODE PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0445
*TRMITBMD:                                                         0445
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0445
*                                                                  0445
TRMITBMD DS    0H                                                  0446
*/********************************************************************/
*/* THIS ROUTINE WILL PROCESS THE ITBMODE PARAMETER OF THE TERMINAL  */
*/* MACRO. IF EITHER SUBPARM IS INVALID AN ERROR MSG IS PUT OUT AND  */
*/* THE DEFAULT IS TAKEN. IF THE SUBPARMS ARE VALID THE APPROPRIATE  */
*/* BITS ARE TURNED ON IN THE TERMINAL  MODEL IF OTHER THAN THE      */
*/* DEFAULT VALUE IS SPECIFIED.                                      */
*/********************************************************************/
*                                                                  0446
*   RTRRCIT1=OFF;                   /* DEFAULT OF NO EIB CHARACTER   */
*   RTRRCIT2=OFF;                   /* AFTER ITB                     */
         L     @07,MLCPTR3(,MLCAREG)                               0447
         NI    RTRRCIT1(@07),B'00111111'                           0447
*   IF PHRF2VAL(1)=1                /* IF 1ST SUBPARM OK AND WAS     */
*     THEN                          /* 'YES' SET RECEIVE FLAG IN     */
         CLC   PHRF2VAL(4,PHR1REG),@CF00039                        0448
         BNE   @RF00448                                            0448
*     RTRRCIT1=ON;                  /* TERM ENTRY. IF 'NO'           */
         OI    RTRRCIT1(@07),B'10000000'                           0449
*   ELSE                                                           0450
*     ;                             /* LEAVE FLAG OFF                */
@RF00448 DS    0H                                                  0451
*   IF PHRF2NVL>1                   /* MORE THAN ONE PARM            */
*     THEN                          /* PROCESS SECOND                */
         LA    @07,1                                               0451
         C     @07,PHRF2NVL(,PHR1REG)                              0451
         BNL   @RF00451                                            0451
*     IF PHRF2VAL(2)=1              /* IF 2ND SUBPARM OK AND WAS     */
*       THEN                        /* 'YES' SET SEND FLAG IN TERM   */
         C     @07,PHRF2VAL+4(,PHR1REG)                            0452
         BNE   @RF00452                                            0452
*       RTRRCIT2=ON;                /* ENTRY. IF 'NO' LEAVE FLAG     */
         L     @07,MLCPTR3(,MLCAREG)                               0453
         OI    RTRRCIT2(@07),B'01000000'                           0453
*     ELSE                                                         0454
*       ;                           /* OFF.                          */
@RF00452 DS    0H                                                  0455
*   ELSE                                                           0455
*     ;                             /* ONLY ONE PARM SPECIFIED       */
@RF00451 DS    0H                                                  0456
*   GPR15=0;                        /* SET RTN CODE TO 0             */
         SLR   GPR15,GPR15                                         0456
*   GPR14=ADDR(MAINSUB);                                           0457
         LA    GPR14,MAINSUB                                       0457
*   END TRMITBMD;                                                  0458
@EL00008 DS    0H                                                  0458
@EF00008 DS    0H                                                  0458
@ER00008 BR    @14                                                 0458
*                                                                  0459
*/********************************************************************/
*/*          BUFLIM PARAMETER SUBROUTINE                             */
*/********************************************************************/
*                                                                  0459
*TRMBFLIM:                                                         0459
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0459
TRMBFLIM DS    0H                                                  0460
*   IF PHRF7NSP=0                   /* IF NO PARMS SPECIFIED         */
*     THEN                                                         0460
         L     @07,PHRF7NSP(,PHR1REG)                              0460
         LTR   @07,@07                                             0460
         BZ    @RT00460                                            0460
*     ;                                                            0461
*   ELSE                                                           0462
*     DO;                                                          0462
*       IF PHRF7NUM(1)=0            /* BUFFER LIMIT OF 0 ?           */
*         THEN                                                     0463
*                                                                  0463
         CLI   PHRF7NUM(PHR1REG),0                                 0463
         BNE   @RF00463                                            0463
*/* ERRFMT    LEVEL(VALUE)  ERROR(INVAL)  ACTION(TAKEDEF)            */
*                                                                  0464
*         DO;                                                      0464
*           DCL                                                    0465
*             1 CMZP0013 STATIC LOCAL,/* PARAMETER LIST PASSED TO  0465
*                                      ERROR FORMAT ROUTINE          */
*              2 CMZL0013 FIXED(8) INIT(5),/* LEVEL PARAMETER (CLEV) */
*              2 CMZE0013 FIXED(8) INIT(4),/* ERROR PARAMETER (CERR) */
*              2 CMZA0013 CHAR(1) INIT('2'),/* ACTION PARAMETER    0465
*                                      (CACT)                        */
*              2 CMZS0013 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM */
*           DCL                                                    0466
*             CMZR0013 REGISTER(1); /* ESTABLISH PARAMeter           */
*           RESPECIFY                                              0467
*             CMZR0013 RSTD;        /* REGISTER FOR                  */
*           CMZR0013=ADDR(CMZP0013);/* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0013,CMZP0013                                   0468
*           CALL ISTSDCC2;          /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0469
         BALR  @14,@15                                             0469
*           RESPECIFY                                              0470
*             CMZR0013 UNRSTD;                                     0470
*         END;                      /* YES                           */
*       ELSE                                                       0472
*         RCPBFLIM=PHRF7NUM(1);     /* NO. USE VALID VALUE           */
         B     @RC00463                                            0472
@RF00463 L     @07,MLCPTR3(,MLCAREG)                               0472
         MVC   RCPBFLIM(1,@07),PHRF7NUM(PHR1REG)                   0472
*       IF PHRF7NSP>1               /* ONLY ONE BUFFER LIMIT ALLOWED */
*         THEN                                                     0473
*                                                                  0473
@RC00463 L     @07,PHRF7NSP(,PHR1REG)                              0473
         C     @07,@CF00039                                        0473
         BNH   @RF00473                                            0473
*/* ERRFMT    LEVEL(VALUE)  ERROR(EXTRA)  ACTION(IGNORE)             */
*                                                                  0474
*         DO;                                                      0474
*           DCL                                                    0475
*             1 CMZP0014 STATIC LOCAL,/* PARAMETER LIST PASSED TO  0475
*                                      ERROR FORMAT ROUTINE          */
*              2 CMZL0014 FIXED(8) INIT(5),/* LEVEL PARAMETER (CLEV) */
*              2 CMZE0014 FIXED(8) INIT(7),/* ERROR PARAMETER (CERR) */
*              2 CMZA0014 CHAR(1) INIT('1'),/* ACTION PARAMETER    0475
*                                      (CACT)                        */
*              2 CMZS0014 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM */
*           DCL                                                    0476
*             CMZR0014 REGISTER(1); /* ESTABLISH PARAMeter           */
*           RESPECIFY                                              0477
*             CMZR0014 RSTD;        /* REGISTER FOR                  */
*           CMZR0014=ADDR(CMZP0014);/* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0014,CMZP0014                                   0478
*           CALL ISTSDCC2;          /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0479
         BALR  @14,@15                                             0479
*           RESPECIFY                                              0480
*             CMZR0014 UNRSTD;                                     0480
*         END;                                                     0481
*       ELSE                                                       0482
*         ;                                                        0482
@RF00473 DS    0H                                                  0483
*     END;                                                         0483
*   GPR15=0;                                                       0484
@RT00460 SLR   GPR15,GPR15                                         0484
*   GPR14=ADDR(MAINSUB);                                           0485
         LA    GPR14,MAINSUB                                       0485
*   END TRMBFLIM;                                                  0486
@EL00009 DS    0H                                                  0486
@EF00009 DS    0H                                                  0486
@ER00009 BR    @14                                                 0486
*                                                                  0487
*/********************************************************************/
*/*          LGAPL PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0487
*TRMLGAPL:                                                         0487
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0487
TRMLGAPL DS    0H                                                  0488
*   IF PHRF34VF(1)=PHRVFAOK         /* IF PARM VALID                 */
*     THEN                          /* SAVE APPLIC NAME              */
         CLI   PHRF34VF(PHR1REG),X'00'                             0488
         BNE   @RF00488                                            0488
*     RCPLGNAP=PHRF34SP(1);         /* APPL FOR SIM LOGON            */
         L     @07,MLCPTR3(,MLCAREG)                               0489
         MVC   RCPLGNAP(8,@07),PHRF34SP(PHR1REG)                   0489
*   ELSE                                                           0490
*     DO;                           /* INVAL. TAKE DEFAULT           */
         B     @RC00488                                            0490
@RF00488 DS    0H                                                  0491
*/* ERRFMT    LEVEL(PARM)  ERROR(INVAL)  ACTION(IGNORE)              */
*                                                                  0491
*       DO;                                                        0491
*         DCL                                                      0492
*           1 CMZP0015 STATIC LOCAL,/* PARAMETER LIST PASSED TO ERROR
*                                      FORMAT ROUTINE                */
*            2 CMZL0015 FIXED(8) INIT(4),/* LEVEL PARAMETER (CLEV)   */
*            2 CMZE0015 FIXED(8) INIT(4),/* ERROR PARAMETER (CERR)   */
*            2 CMZA0015 CHAR(1) INIT('1'),/* ACTION PARAMETER (CACT) */
*            2 CMZS0015 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM   */
*         DCL                                                      0493
*           CMZR0015 REGISTER(1);   /* ESTABLISH PARAMeter           */
*         RESPECIFY                                                0494
*           CMZR0015 RSTD;          /* REGISTER FOR                  */
*         CMZR0015=ADDR(CMZP0015);  /* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0015,CMZP0015                                   0495
*         CALL ISTSDCC2;            /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0496
         BALR  @14,@15                                             0496
*         RESPECIFY                                                0497
*           CMZR0015 UNRSTD;                                       0497
*       END;                                                       0498
*       RCPLGNAP=BLANK8;                                           0499
         L     @07,MLCPTR3(,MLCAREG)                               0499
         MVC   RCPLGNAP(8,@07),@CC01247                            0499
*     END;                                                         0500
*   GPR15=0;                                                       0501
@RC00488 SLR   GPR15,GPR15                                         0501
*   GPR14=ADDR(MAINSUB);                                           0502
         LA    GPR14,MAINSUB                                       0502
*   END TRMLGAPL;                                                  0503
@EL00010 DS    0H                                                  0503
@EF00010 DS    0H                                                  0503
@ER00010 BR    @14                                                 0503
*                                                                  0504
*/********************************************************************/
*/*          LGTAB PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0504
*TRMLGTAB:                                                         0504
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0504
TRMLGTAB DS    0H                                                  0505
*   IF PHRF34VF(1)=PHRVFAOK         /* IF PARM VALID                 */
*     THEN                          /* SAVE LOGON CHAR TABL NAME     */
         CLI   PHRF34VF(PHR1REG),X'00'                             0505
         BNE   @RF00505                                            0505
*     RCPLGNCT=PHRF34SP(1);                                        0506
         L     @07,MLCPTR3(,MLCAREG)                               0506
         MVC   RCPLGNCT(8,@07),PHRF34SP(PHR1REG)                   0506
*   ELSE                                                           0507
*     DO;                           /* INVAL. TAKE DEFAULT           */
         B     @RC00505                                            0507
@RF00505 DS    0H                                                  0508
*/* ERRFMT    LEVEL(PARM)  ERROR(INVAL)  ACTION(IGNORE)              */
*                                                                  0508
*       DO;                                                        0508
*         DCL                                                      0509
*           1 CMZP0016 STATIC LOCAL,/* PARAMETER LIST PASSED TO ERROR
*                                      FORMAT ROUTINE                */
*            2 CMZL0016 FIXED(8) INIT(4),/* LEVEL PARAMETER (CLEV)   */
*            2 CMZE0016 FIXED(8) INIT(4),/* ERROR PARAMETER (CERR)   */
*            2 CMZA0016 CHAR(1) INIT('1'),/* ACTION PARAMETER (CACT) */
*            2 CMZS0016 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM   */
*         DCL                                                      0510
*           CMZR0016 REGISTER(1);   /* ESTABLISH PARAMeter           */
*         RESPECIFY                                                0511
*           CMZR0016 RSTD;          /* REGISTER FOR                  */
*         CMZR0016=ADDR(CMZP0016);  /* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0016,CMZP0016                                   0512
*         CALL ISTSDCC2;            /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0513
         BALR  @14,@15                                             0513
*         RESPECIFY                                                0514
*           CMZR0016 UNRSTD;                                       0514
*       END;                                                       0515
*       RCPLGNCT=BLANK8;                                           0516
         L     @07,MLCPTR3(,MLCAREG)                               0516
         MVC   RCPLGNCT(8,@07),@CC01247                            0516
*     END;                                                         0517
*   GPR15=0;                                                       0518
@RC00505 SLR   GPR15,GPR15                                         0518
*   GPR14=ADDR(MAINSUB);                                           0519
         LA    GPR14,MAINSUB                                       0519
*   END TRMLGTAB;                                                  0520
@EL00011 DS    0H                                                  0520
@EF00011 DS    0H                                                  0520
@ER00011 BR    @14                                                 0520
*                                                                  0521
*/********************************************************************/
*/*           POLL PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0521
*TRMPOLL:                                                          0521
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0521
*                                                                  0521
TRMPOLL  DS    0H                                                  0522
*/********************************************************************/
*/* THIS ROUTINE WILL MOVE THE POLLING CHARACTERS TO THE RDT         */
*/* EXTENSION AREA. THE LENGTH AND POINTER TO THESE CHARACTERS ARE   */
*/* FOUND IN THE VTAM PARAMETER HANDLER FUNCTION ONE OUTPUT AREA     */
*/********************************************************************/
*                                                                  0522
*   GPR0=PHRF1SLN;                  /* SET UP PARMS FOR CONVERSION 0522
*                                      RTN                           */
         L     GPR0,PHRF1SLN(,PHR1REG)                             0522
*   GPR1=PHRF1SAD;                  /* GPR0=LENGTH OF STRING - GPR1 =
*                                      PTR                           */
         L     GPR1,PHRF1SAD(,PHR1REG)                             0523
*   CALL ISTSDCC4;                  /* TO STRING.                    */
         L     @15,@CV01252                                        0524
         BALR  @14,@15                                             0524
*   GPR1=0;                         /* SET UP PARMS FOR AREA HANDLER
*                                      RTN.                          */
         SLR   GPR1,GPR1                                           0525
*   GPR0=PHRF1SLN/2;                /* HEX SIZE IS EBCDIC/2          */
         L     @08,PHRF1SLN(,PHR1REG)                              0526
         SRDA  @08,32                                              0526
         D     @08,@CF00180                                        0526
         LR    GPR0,@09                                            0526
*   RTRCTPOL=GPR0;                  /* NUMB OF CHARS IN POLL STRING  */
         L     @07,MLCPTR3(,MLCAREG)                               0527
         STH   GPR0,RTRCTPOL(,@07)                                 0527
*   CALL ISTSDCC1;                  /* CHARS IN BYTES.               */
         L     @15,@CV01249                                        0528
         BALR  @14,@15                                             0528
*   IF GPR15=0                      /* IF STORAGE WAS AVAIL. FOR   0529
*                                      POLLING                       */
*     THEN                                                         0529
         SLR   @07,@07                                             0529
         CR    GPR15,@07                                           0529
         BNE   @RF00529                                            0529
*     DO;                           /* CHARS MOVE THEM TO THE RDT  0530
*                                      EXT.                          */
*       POLLEXT(1:RTRCTPOL)=POLLCHAR(1:RTRCTPOL);                  0531
         L     @04,MLCPTR3(,MLCAREG)                               0531
         LH    @03,RTRCTPOL(,@04)                                  0531
         BCTR  @03,0                                               0531
         L     @09,PHRF1SAD(,PHR1REG)                              0531
         EX    @03,@SM01905                                        0531
*       RTRPOLA=GPR0;               /* SAVE RELATIVE OFFSET OF POLL
*                                      CHARS                         */
         ST    GPR0,RTRPOLA(,@04)                                  0532
*       LCLFPOLL=ON;                /* SET POLL FOOTPRINT    @DM08373*/
         OI    LCLFPOLL,B'00001000'                                0533
*       GPR15=0;                                                   0534
         LR    GPR15,@07                                           0534
*     END;                                                         0535
*   ELSE                                                           0536
*     DO;                                                          0536
         B     @RC00529                                            0536
@RF00529 DS    0H                                                  0537
*       GPR15=4;                    /* MSG ALREADY PUT OUT BY AREA 0537
*                                      HANDLER                       */
         LA    GPR15,4                                             0537
*     END;                                                         0538
*   GPR14=ADDR(MAINSUB);                                           0539
@RC00529 LA    GPR14,MAINSUB                                       0539
*   END TRMPOLL;                                                   0540
@EL00012 DS    0H                                                  0540
@EF00012 DS    0H                                                  0540
@ER00012 BR    @14                                                 0540
*                                                                  0541
*/********************************************************************/
*/*        XMITLIM PARAMETER SUBROUTINE                              */
*/********************************************************************/
*                                                                  0541
*TRMXMTLM:                                                         0541
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0541
*                                                                  0541
TRMXMTLM DS    0H                                                  0542
*/********************************************************************/
*/* THIS ROUTINE WILL MOVE IF SPECIFIED, THE NUMBER OF TRANSMISSIONS */
*/* THE NCP WILL RECEIVE FROM OR SEND TO THIS STATION OR BOTH. IF NO */
*/* NUMBER IS SPECIFIED A CHECK IS MADE TO SEE IF 'NO' WAS THE PARM. */
*/* IF SO THERE IS NO LIMIT ON TRANSMISSIONS. IF NEITHER A COUNT OR  */
*                                                                  0542
*   IF PHRF34SP(1)='000000NO'×PHRF34SL(1)=0 THEN/* TO SEE IF PARM WAS
*                                      'NO'                          */
         CLC   PHRF34SP(8,PHR1REG),@CC01436                        0542
         BE    @RT00542                                            0542
         LH    @07,PHRF34SL(,PHR1REG)                              0542
         LTR   @07,@07                                             0542
         BNZ   @RF00542                                            0542
@RT00542 DS    0H                                                  0543
*     RTRTRMAX=0;                   /* IF 'NO' SET XMISSION CNT=0    */
         L     @07,MLCPTR3(,MLCAREG)                               0543
         MVI   RTRTRMAX(@07),X'00'                                 0543
*   ELSE                                                           0544
*     DO;                           /* A NUM WAS SPECIFIED           */
         B     @RC00542                                            0544
@RF00542 DS    0H                                                  0545
*       PACK(PHRF34SP(1),PHRF34SP(1));/* CONVERT IT TO BINARY        */
         PACK  PHRF34SP(8,PHR1REG),PHRF34SP(8,PHR1REG)             0545
*       CVB(CVBNUM,PHRF34SP(1));    /* AND CK FOR VALID              */
         CVB   @07,PHRF34SP(,PHR1REG)                              0546
         ST    @07,CVBNUM                                          0546
*       RTRTRMAX=CVBNUM2;           /* IF OK - STORE IT IN           */
         L     @07,MLCPTR3(,MLCAREG)                               0547
         MVC   RTRTRMAX(1,@07),CVBNUM2                             0547
*     END;                                                         0548
*   GPR15=0;                        /* SET RTN CODE TO 0             */
@RC00542 SLR   GPR15,GPR15                                         0549
*   GPR14=ADDR(MAINSUB);                                           0550
         LA    GPR14,MAINSUB                                       0550
*   END TRMXMTLM;                                                  0551
@EL00013 DS    0H                                                  0551
@EF00013 DS    0H                                                  0551
@ER00013 BR    @14                                                 0551
*TRMFEATR:                                                         0552
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0552
*                                                                  0552
TRMFEATR DS    0H                                                  0553
*/********************************************************************/
*/* TURN OFF PREVIOUSLY NCP SPECIFIED FEATURES BEFORE SETTING TRM    */
*/* INDICATED NCP FEATURES.                                          */
*/********************************************************************/
*                                                                  0553
*   RTRREACR='0'B;                  /* ACCELERATED CARRIAGE RETURN   */
*   RTRREATT='0'B;                  /* TERMINAL INTERRUPT (ATTENTION)*/
*   RTRREBRK='0'B;                  /* TRANSMIT INTERRUPT (REVRSE  0555
*                                      BREAK)                        */
*   RTRRECHK='0'B;                  /* CHECKING                      */
*   RTRRESCT='0'B;                  /* STATION CONTROL               */
*   RTRRESUP='0'B;                  /* TIME OUT SUPPRESSION          */
         L     @07,MLCPTR3(,MLCAREG)                               0558
         NI    RTRREACR(@07),B'01000001'                           0558
*   RTRRFXCT='0'B;                  /* TRANSMIT CONTROL              */
         NI    RTRRFXCT(@07),B'01111111'                           0559
*   CALL ISTSDCC5;                  /* SET TRM SPECIFIED NCP FEATURES*/
         L     @15,@CV01442                                        0560
         BALR  @14,@15                                             0560
*   GPR14=ADDR(MAINSUB);                                           0561
         LA    GPR14,MAINSUB                                       0561
*   END TRMFEATR;                                                  0562
@EL00014 DS    0H                                                  0562
@EF00014 DS    0H                                                  0562
@ER00014 BR    @14                                                 0562
*TRMFEAT2:                                                         0563
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0563
*                                                                  0563
TRMFEAT2 DS    0H                                                  0564
*/********************************************************************/
*/* TURN OFF PREVIOUSLY VTAM SPECIFIED FEATURES BEFORE SETTING TRM   */
*/* INDICATED VTAM FEATURES.                                         */
*/********************************************************************/
*                                                                  0564
*   RFY                                                            0564
*     ISTDEVCH BASED(MLCPTR4);                                     0564
*   RTRRFANK='0'B;                  /* ALPHA-NUMERIC KEYBOARD        */
*   RTRRFDEK='0'B;                  /* DATA ENTRY KEYBOARD           */
*   RTRRFPFK='0'B;                  /* PROGRAM FUNCTION KEYBOARD     */
*   RTRRFPEN='0'B;                  /* LIGHT PEN                     */
         L     @07,MLCPTR3(,MLCAREG)                               0568
         NI    RTRRFANK(@07),B'10000111'                           0568
*   DEVSPS='0'B;                    /* START PRINT SENSITIVE         */
         L     @07,MLCPTR4(,MLCAREG)                               0569
         NI    DEVSPS(@07),B'11110111'                             0569
*   CALL ISTSDCC5;                  /* SET TERM SPECIFIED VTAM     0570
*                                      FEATURES                      */
         L     @15,@CV01442                                        0570
         BALR  @14,@15                                             0570
*   GPR14=ADDR(MAINSUB);                                           0571
         LA    GPR14,MAINSUB                                       0571
*   END TRMFEAT2;                                                  0572
@EL00015 DS    0H                                                  0572
@EF00015 DS    0H                                                  0572
@ER00015 BR    @14                                                 0572
*TRMDEVIC:                                                         0573
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0573
TRMDEVIC DS    0H                                                  0574
*   IF PHRF2VAL(1)='FFFFFFFF'X THEN                                0574
*                                                                  0574
         CLC   PHRF2VAL(4,PHR1REG),@CF01450                        0574
         BNE   @RF00574                                            0574
*/* ERRFMT    LEVEL(VALUE)  ERROR(INVAL)  ACTION(TAKEDEF)            */
*                                                                  0575
*     DO;                                                          0575
*       DCL                                                        0576
*         1 CMZP0017 STATIC LOCAL,  /* PARAMETER LIST PASSED TO ERROR
*                                      FORMAT ROUTINE                */
*          2 CMZL0017 FIXED(8) INIT(5),/* LEVEL PARAMETER (CLEV)     */
*          2 CMZE0017 FIXED(8) INIT(4),/* ERROR PARAMETER (CERR)     */
*          2 CMZA0017 CHAR(1) INIT('2'),/* ACTION PARAMETER (CACT)   */
*          2 CMZS0017 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM     */
*       DCL                                                        0577
*         CMZR0017 REGISTER(1);     /* ESTABLISH PARAMeter           */
*       RESPECIFY                                                  0578
*         CMZR0017 RSTD;            /* REGISTER FOR                  */
*       CMZR0017=ADDR(CMZP0017);    /* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0017,CMZP0017                                   0579
*       CALL ISTSDCC2;              /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0580
         BALR  @14,@15                                             0580
*       RESPECIFY                                                  0581
*         CMZR0017 UNRSTD;                                         0581
*     END;                                                         0582
*   ELSE                                                           0583
*     DO;                                                          0583
         B     @RC00574                                            0583
@RF00574 DS    0H                                                  0584
*       IF MLCMACRO='COMP    ' THEN                                0584
         CLC   MLCMACRO(8,MLCAREG),@CC01457                        0584
         BNE   @RF00584                                            0584
*         DEVTCODE=PHRF2MSK(1);     /* DEVICE TYPE CODE IN DEVCH     */
         L     @07,MLCPTR4(,MLCAREG)                               0585
         MVC   DEVTCODE(1,@07),PHRF2MSK(PHR1REG)                   0585
*       ELSE                                                       0586
*         RNCDTYPE=PHRF2MSK(1);     /* SAVE DEVICE TYPE CODE FOR   0586
*                                      POSSIBLE LATER USE WHEN 'COMP'
*                                      IS DETECTED FOR THIS 'TERM'   */
         B     @RC00584                                            0586
@RF00584 MVC   RNCDTYPE(1,RNCAREG),PHRF2MSK(PHR1REG)               0586
*     END;                                                         0587
@RC00584 DS    0H                                                  0588
*   GPR15=0;                                                       0588
@RC00574 SLR   GPR15,GPR15                                         0588
*   GPR14=ADDR(MAINSUB);                                           0589
         LA    GPR14,MAINSUB                                       0589
*   END TRMDEVIC;                                                  0590
@EL00016 DS    0H                                                  0590
@EF00016 DS    0H                                                  0590
@ER00016 BR    @14                                                 0590
*TRMCTERM:                                                         0591
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0591
*                                                                  0591
TRMCTERM DS    0H                                                  0592
*/********************************************************************/
*/* THIS ROUTINE WILL PROCESS THE CTERM PARAMETER OF THE TERM MACRO  */
*/********************************************************************/
*                                                                  0592
*   IF PHRF2VAL(1)=1 THEN           /* IS CTERM=YES ?                */
         CLC   PHRF2VAL(4,PHR1REG),@CF00039                        0592
         BNE   @RF00592                                            0592
*     DO;                                                          0593
*       IF RLNPORT='1'B THEN        /* IS LINE A PORT ?              */
         L     @07,RNCLN(,RNCAREG)                                 0594
         TM    RLNPORT(@07),B'00010000'                            0594
         BNO   @RF00594                                            0594
*         DO;                                                      0595
*           RPTCTNM=MLCNAME;        /* NAME ON CTERM USED AS PORT    */
*                                                                  0596
         MVC   RPTCTNM(8,@07),MLCNAME(MLCAREG)                     0596
*           /*********************************************************/
*           /*                                                       */
*           /* ENTRY NAME                                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0597
*           IF RNCGCTRM='1'B THEN   /* 2ND CTERM ON MACRO ?          */
         TM    RNCGCTRM(RNCAREG),B'00000100'                       0597
         BNO   @RF00597                                            0597
*             DO;                                                  0598
*                                                                  0598
*/* ERRFMT    LEVEL(PARM)  ERROR(DUP)  ACTION(KILLBLD)               */
*                                                                  0599
*               DO;                                                0599
*                 DCL                                              0600
*                   1 CMZP0018 STATIC LOCAL,/* PARAMETER LIST PASSED
*                                      TO ERROR FORMAT ROUTINE       */
*                    2 CMZL0018 FIXED(8) INIT(4),/* LEVEL PARAMETER
*                                      (CLEV)                        */
*                    2 CMZE0018 FIXED(8) INIT(3),/* ERROR PARAMETER
*                                      (CERR)                        */
*                    2 CMZA0018 CHAR(1) INIT('6'),/* ACTION PARAMETER
*                                      (CACT)                        */
*                    2 CMZS0018 FIXED(8) INIT(0);/* LENGTH OF STRING
*                                      PARAM                         */
*                 DCL                                              0601
*                   CMZR0018 REGISTER(1);/* ESTABLISH PARAMeter      */
*                 RESPECIFY                                        0602
*                   CMZR0018 RSTD;  /* REGISTER FOR                  */
*                 CMZR0018=ADDR(CMZP0018);/* ADDRESS OF PARAMETER  0603
*                                      LIST                          */
         LA    CMZR0018,CMZP0018                                   0603
*                 CALL ISTSDCC2;    /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0604
         BALR  @14,@15                                             0604
*                 RESPECIFY                                        0605
*                   CMZR0018 UNRSTD;                               0605
*               END;                                               0606
*               GPR15=4;                                           0607
         LA    GPR15,4                                             0607
*             END;                                                 0608
*           ELSE                    /* FIRST CTERM ENCOUNTERED       */
*             DO;                                                  0609
         B     @RC00597                                            0609
@RF00597 DS    0H                                                  0610
*               RNCGCTRM='1'B;      /* SET GLOBAL F.P. TO BE CHECKED
*                                      WHEN VTERM IS HANDLED LATER   */
         OI    RNCGCTRM(RNCAREG),B'00000100'                       0610
*               CTERMSW='1'B;       /* SET LOCAL F.P.                */
         OI    CTERMSW,B'10000000'                                 0611
*               GPR15=0;                                           0612
         SLR   GPR15,GPR15                                         0612
*             END;                                                 0613
*         END;                      /* END IF LINE IS A PORT         */
*       ELSE                                                       0615
*         DO;                                                      0615
*                                                                  0615
         B     @RC00594                                            0615
@RF00594 DS    0H                                                  0616
*/* ERRFMT    LEVEL(PARM)  ERROR(INVAL)  ACTION(KILLBLD)             */
*                                                                  0616
*           DO;                                                    0616
*             DCL                                                  0617
*               1 CMZP0019 STATIC LOCAL,/* PARAMETER LIST PASSED TO
*                                      ERROR FORMAT ROUTINE          */
*                2 CMZL0019 FIXED(8) INIT(4),/* LEVEL PARAMETER    0617
*                                      (CLEV)                        */
*                2 CMZE0019 FIXED(8) INIT(4),/* ERROR PARAMETER    0617
*                                      (CERR)                        */
*                2 CMZA0019 CHAR(1) INIT('6'),/* ACTION PARAMETER  0617
*                                      (CACT)                        */
*                2 CMZS0019 FIXED(8) INIT(0);/* LENGTH OF STRING   0617
*                                      PARAM                         */
*             DCL                                                  0618
*               CMZR0019 REGISTER(1);/* ESTABLISH PARAMeter          */
*             RESPECIFY                                            0619
*               CMZR0019 RSTD;      /* REGISTER FOR                  */
*             CMZR0019=ADDR(CMZP0019);/* ADDRESS OF PARAMETER LIST   */
         LA    CMZR0019,CMZP0019                                   0620
*             CALL ISTSDCC2;        /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0621
         BALR  @14,@15                                             0621
*             RESPECIFY                                            0622
*               CMZR0019 UNRSTD;                                   0622
*           END;                                                   0623
*           GPR15=4;                                               0624
         LA    GPR15,4                                             0624
*         END;                                                     0625
*     END;                          /* END IF CTERM = YES            */
*   ELSE                                                           0627
*     GPR15=0;                      /* IF CTERM = NO                 */
         B     @RC00592                                            0627
@RF00592 SLR   GPR15,GPR15                                         0627
*   GPR14=ADDR(MAINSUB);            /* RETURN ADDR                   */
@RC00592 LA    GPR14,MAINSUB                                       0628
*   END TRMCTERM;                                                  0629
@EL00017 DS    0H                                                  0629
@EF00017 DS    0H                                                  0629
@ER00017 BR    @14                                                 0629
*                                                                  0630
*/********************************************************************/
*/* THIS ROUTINE WILL PROCESS THE UTERM PARAMETER OF THE TERM MACRO  */
*/********************************************************************/
*                                                                  0630
*TRMUTERM:                                                         0630
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0630
TRMUTERM DS    0H                                                  0631
*   IF RLNPORT='1'B                 /* IS LINE A PORT ?              */
*       &PHRF34VF(1)=PHRVFAOK THEN  /* PARAMETER O.K. ?              */
         L     @07,RNCLN(,RNCAREG)                                 0631
         TM    RLNPORT(@07),B'00010000'                            0631
         BNO   @RF00631                                            0631
         CLI   PHRF34VF(PHR1REG),X'00'                             0631
         BNE   @RF00631                                            0631
*     DO;                                                          0632
*       RPRNAME=PHRF34SP(1);        /* UTERM NAME                    */
         L     @07,MLCPTR3(,MLCAREG)                               0633
         MVC   RPRNAME(8,@07),PHRF34SP(PHR1REG)                    0633
*       RPRENTRY=RPRENTUT;          /* UTERM ENTRY FLAGS             */
         MVI   RPRENTRY(@07),X'75'                                 0634
*       GPR15=0;                                                   0635
         SLR   GPR15,GPR15                                         0635
*     END;                                                         0636
*   ELSE                            /* PARAMETER INVALID OR NOT A    */
*     DO;                           /* PORT. CAN'T HANDLE UTERM      */
         B     @RC00631                                            0637
@RF00631 DS    0H                                                  0638
*/* ERRFMT    LEVEL(PARM)  ERROR(INVAL)  ACTION(KILLBLD)             */
*                                                                  0638
*       DO;                                                        0638
*         DCL                                                      0639
*           1 CMZP0020 STATIC LOCAL,/* PARAMETER LIST PASSED TO ERROR
*                                      FORMAT ROUTINE                */
*            2 CMZL0020 FIXED(8) INIT(4),/* LEVEL PARAMETER (CLEV)   */
*            2 CMZE0020 FIXED(8) INIT(4),/* ERROR PARAMETER (CERR)   */
*            2 CMZA0020 CHAR(1) INIT('6'),/* ACTION PARAMETER (CACT) */
*            2 CMZS0020 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM   */
*         DCL                                                      0640
*           CMZR0020 REGISTER(1);   /* ESTABLISH PARAMeter           */
*         RESPECIFY                                                0641
*           CMZR0020 RSTD;          /* REGISTER FOR                  */
*         CMZR0020=ADDR(CMZP0020);  /* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0020,CMZP0020                                   0642
*         CALL ISTSDCC2;            /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0643
         BALR  @14,@15                                             0643
*         RESPECIFY                                                0644
*           CMZR0020 UNRSTD;                                       0644
*       END;                                                       0645
*       GPR15=4;                                                   0646
         LA    GPR15,4                                             0646
*     END;                                                         0647
*   GPR14=ADDR(MAINSUB);            /* RETURN ADDRESS                */
@RC00631 LA    GPR14,MAINSUB                                       0648
*   END TRMUTERM;                                                  0649
@EL00018 DS    0H                                                  0649
@EF00018 DS    0H                                                  0649
@ER00018 BR    @14                                                 0649
*   END DOWHILE;                                                   0650
@EL00002 DS    0H                                                  0650
@EF00002 DS    0H                                                  0650
@ER00002 BR    @14                                                 0650
*RESETYPE:                                                         0651
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0651
RESETYPE DS    0H                                                  0652
*   DEVCCTL=ON;                     /* NEEDED BY OPEN/CLOSE          */
         L     @07,MLCPTR4(,MLCAREG)                               0652
         OI    DEVCCTL(@07),B'00000010'                            0652
*   IF RGPABSC=ON                   /* IS LINE IN BISYNCH GROUP      */
*     THEN                                                         0653
         L     @04,RNCGP(,RNCAREG)                                 0653
         TM    RGPABSC(@04),B'00100000'                            0653
         BNO   @RF00653                                            0653
*     DEVCBSC=ON;                   /* YES. DEVICE IS BISYNCH        */
         OI    DEVCBSC(@07),B'10000000'                            0654
*   ELSE                                                           0655
*     DO;                                                          0655
         B     @RC00653                                            0655
@RF00653 DS    0H                                                  0656
*       IF RGPASS=ON                /* IS LINE IN START/STOP GROUP ? */
*         THEN                                                     0656
         L     @07,RNCGP(,RNCAREG)                                 0656
         TM    RGPASS(@07),B'01000000'                             0656
         BNO   @RF00656                                            0656
*         DEVCSSL=ON;               /* YES. DEVICE IS START/STOP     */
         L     @07,MLCPTR4(,MLCAREG)                               0657
         OI    DEVCSSL(@07),B'01000000'                            0657
*       ELSE                                                       0658
*         ;                                                        0658
@RF00656 DS    0H                                                  0659
*     END;                                                         0659
*   DEVCRVB=OFF;                                                   0660
@RC00653 L     @07,MLCPTR4(,MLCAREG)                               0660
         NI    DEVCRVB(@07),B'11011111'                            0660
*   IF RTRREBRK=ON                  /* TRANSMIT INTERRUPT ?          */
*     THEN                                                         0661
         L     @04,MLCPTR3(,MLCAREG)                               0661
         TM    RTRREBRK(@04),B'10000000'                           0661
         BNO   @RF00661                                            0661
*     DEVCRVB=ON;                   /* REVERSE BREAK                 */
         OI    DEVCRVB(@07),B'00100000'                            0662
*   ELSE                                                           0663
*     ;                                                            0663
@RF00661 DS    0H                                                  0664
*   IF RGPADIL=ON                   /* SWITCHED GROUP ?              */
*     THEN                                                         0664
         L     @07,RNCGP(,RNCAREG)                                 0664
         TM    RGPADIL(@07),B'10000000'                            0664
         BNO   @RF00664                                            0664
*     DEVCSWL='1'B;                 /* SWITCHED                      */
         L     @07,MLCPTR4(,MLCAREG)                               0665
         OI    DEVCSWL(@07),B'00010000'                            0665
*   ELSE                                                           0666
*     DEVCSWL='0'B;                 /* LEASED CONNECTION             */
         B     @RC00664                                            0666
@RF00664 L     @07,MLCPTR4(,MLCAREG)                               0666
         NI    DEVCSWL(@07),B'11101111'                            0666
*   DEVPHYSA=RTRCADDR(RTRCTADR:RTRCTADR);/* PHYSICAL DEVICE          */
*                                                                  0667
@RC00664 L     @07,MLCPTR4(,MLCAREG)                               0667
         L     @04,MLCPTR3(,MLCAREG)                               0667
         LH    @03,RTRCTADR(,@04)                                  0667
         ALR   @03,@04                                             0667
         MVC   DEVPHYSA(1,@07),RTRCADDR-1(@03)                     0667
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDR FROM @ING CHARACTERS                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0668
*   IF RTRREATT=ON                  /* ATTENTION INTERRUPT           */
*     THEN                                                         0668
         TM    RTRREATT(@04),B'00001000'                           0668
         BNO   @RF00668                                            0668
*     DEVCATTN='1'B;                                               0669
         OI    DEVCATTN(@07),B'00001000'                           0669
*   ELSE                                                           0670
*     DEVCATTN='0'B;                                               0670
         B     @RC00668                                            0670
@RF00668 L     @07,MLCPTR4(,MLCAREG)                               0670
         NI    DEVCATTN(@07),B'11110111'                           0670
*   IF RTRRECHK=ON                  /* CHECKING FEATURE              */
*     THEN                                                         0671
@RC00668 L     @07,MLCPTR3(,MLCAREG)                               0671
         TM    RTRRECHK(@07),B'00010000'                           0671
         BNO   @RF00671                                            0671
*     DEVCCHEK='1'B;                                               0672
         L     @07,MLCPTR4(,MLCAREG)                               0672
         OI    DEVCCHEK(@07),B'00000100'                           0672
*   ELSE                                                           0673
*     DEVCCHEK='0'B;                                               0673
         B     @RC00671                                            0673
@RF00671 L     @07,MLCPTR4(,MLCAREG)                               0673
         NI    DEVCCHEK(@07),B'11111011'                           0673
*   IF RTRRESCT=ON                  /* STATION CONTROL               */
*     THEN                                                         0674
@RC00671 L     @07,MLCPTR3(,MLCAREG)                               0674
         TM    RTRRESCT(@07),B'00000010'                           0674
         BNO   @RF00674                                            0674
*     DEVCSTCL='1'B;                                               0675
         L     @07,MLCPTR4(,MLCAREG)                               0675
         OI    DEVCSTCL(@07),B'00000010'                           0675
*   ELSE                                                           0676
*     DEVCSTCL='0'B;                                               0676
         B     @RC00674                                            0676
@RF00674 L     @07,MLCPTR4(,MLCAREG)                               0676
         NI    DEVCSTCL(@07),B'11111101'                           0676
*   IF RTRRFPEN=ON                  /* SELECTOR PEN FEATURE          */
*     THEN                                                         0677
@RC00674 L     @07,MLCPTR3(,MLCAREG)                               0677
         TM    RTRRFPEN(@07),B'01000000'                           0677
         BNO   @RF00677                                            0677
*     DEVCSLPN='1'B;                                               0678
         L     @07,MLCPTR4(,MLCAREG)                               0678
         OI    DEVCSLPN(@07),B'00000001'                           0678
*   ELSE                                                           0679
*     DEVCSLPN='0'B;                                               0679
         B     @RC00677                                            0679
@RF00677 L     @07,MLCPTR4(,MLCAREG)                               0679
         NI    DEVCSLPN(@07),B'11111110'                           0679
*   GPR14=ADDR(RESRET01);                                          0680
@RC00677 LA    GPR14,RESRET01                                      0680
*   END RESETYPE;                                                  0681
@EL00019 DS    0H                                                  0681
@EF00019 DS    0H                                                  0681
@ER00019 BR    @14                                                 0681
*CTRMUTRM:                                                         0682
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0682
*                                                                  0682
CTRMUTRM DS    0H                                                  0683
*/********************************************************************/
*/* MOVE MODEL TO BUILD IF LAST MINUTE ERROR IS NOT DETECTED         */
*/********************************************************************/
*                                                                  0683
*   IF CTERMSW='1'B THEN            /* CTERM PARAMETER ALREADY     0683
*                                      PROCESSED                     */
         TM    CTERMSW,B'10000000'                                 0683
         BNO   @RF00683                                            0683
*     DO;                                                          0684
*       IF DEVTCODE=DEVTWX          /* RESET LINE TO BI-SYNC FOR TWX
*                                                            @XA06939*/
*         THEN                                                     0685
         L     @07,MLCPTR4(,MLCAREG)                               0685
         CLI   DEVTCODE(@07),X'04'                                 0685
         BNE   @RF00685                                            0685
*         DO;                       /*                       @XA06939*/
*           ADDR(RNCLN->RPRDEVCH)->DEVCBSC='1'B;/*           @XA06939*/
*           ADDR(RNCLN->RPRDEVCH)->DEVCSSL='0'B;/*           @XA06939*/
         L     @07,RNCLN(,RNCAREG)                                 0688
         OI    DEVCBSC+44(@07),B'10000000'                         0688
         NI    DEVCSSL+44(@07),B'10111111'                         0688
*         END;                      /*                       @XA06939*/
*       ELSE                                                       0690
*         ;                         /*                       @XA06939*/
@RF00685 DS    0H                                                  0691
*/********************************************************************/
*/* IF BHSET = DYNAMIC SET FOR THE CTERM THEN TURN ON THE BHSET      */
*/* DYNAMIC FLAG IN THE PRECEDEING PORT ENTRY FOR TPIOS      @XA07951*/
*/********************************************************************/
*                                                                  0691
*       IF RTRRDBHD='1'B            /*                       @XA07951*/
*         THEN                                                     0691
         L     @07,MLCPTR3(,MLCAREG)                               0691
         TM    RTRRDBHD(@07),B'01000000'                           0691
         BNO   @RF00691                                            0691
*         RPTDYNAM='1'B;            /*                       @XA07951*/
         L     @07,RNCLN(,RNCAREG)                                 0692
         OI    RPTDYNAM(@07),B'00000010'                           0692
*       ELSE                                                       0693
*         ;                         /*                       @XA07951*/
@RF00691 DS    0H                                                  0694
*       IF RTRRBISA='1'B THEN       /* ISTATUS ON FOR THIS TERM ?  0694
*                                                            @ZA30446*/
         L     @07,MLCPTR3(,MLCAREG)                               0694
         TM    RTRRBISA(@07),B'01000000'                           0694
         BNO   @RF00694                                            0694
*         RPTISTAT='1'B;            /* ISTATUS ACTIVE        @ZA30446*/
         L     @07,RNCLN(,RNCAREG)                                 0695
         OI    RPTISTAT(@07),B'00000001'                           0695
*       ELSE                        /*                       @ZA30446*/
*         RPTISTAT='0'B;            /* ISTATUS INACTIVE      @ZA30446*/
         B     @RC00694                                            0696
@RF00694 L     @07,RNCLN(,RNCAREG)                                 0696
         NI    RPTISTAT(@07),B'11111110'                           0696
*       IF RPRENTRY=RPRENTUT THEN   /* IS ENTRY UTERM                */
@RC00694 L     @07,MLCPTR3(,MLCAREG)                               0697
         CLI   RPRENTRY(@07),X'75'                                 0697
         BNE   @RF00697                                            0697
*         DO;                                                      0698
*           GETSW='1'B;             /* SET SWITCH TO GET UTERM ENTRY
*                                      MODEL                         */
         OI    GETSW,B'01000000'                                   0699
*         END;                                                     0700
*       ELSE                        /* NOT UTERM ENTRY               */
*         DO;                                                      0701
         B     @RC00697                                            0701
@RF00697 DS    0H                                                  0702
*           GETSW='0'B;             /* DON'T GET ENTRY MODEL         */
         NI    GETSW,B'10111111'                                   0702
*           GPR15=0;                /* THIS IS NOT AN ERROR          */
         SLR   GPR15,GPR15                                         0703
*         END;                                                     0704
*     END;                          /* END IF CTERM ALREADY PROCESSED*/
*   ELSE                            /* CTERM NOT FOUND YET           */
*     DO;                                                          0706
         B     @RC00683                                            0706
@RF00683 DS    0H                                                  0707
*       IF RPRENTRY=RPRENTUT THEN   /* UTERM ? (ITS NOT VALID)       */
         L     @07,MLCPTR3(,MLCAREG)                               0707
         CLI   RPRENTRY(@07),X'75'                                 0707
         BNE   @RF00707                                            0707
*         DO;                                                      0708
*                                                                  0708
*/* ERRFMT    LEVEL(PARM)  ERROR(CONF)  ACTION(KILLBLD)  STRING('UTERM'
*                                                                    */
*                                                                  0709
*           DO;                                                    0709
*             DCL                                                  0710
*               1 CMZP0021 STATIC LOCAL,/* PARAMETER LIST PASSED TO
*                                      ERROR FORMAT ROUTINE          */
*                2 CMZL0021 FIXED(8) INIT(4),/* LEVEL PARAMETER    0710
*                                      (CLEV)                        */
*                2 CMZE0021 FIXED(8) INIT(2),/* ERROR PARAMETER    0710
*                                      (CERR)                        */
*                2 CMZA0021 CHAR(1) INIT('6'),/* ACTION PARAMETER  0710
*                                      (CACT)                        */
*                2 CMZS0021 FIXED(8) INIT(5),/* LENGTH OF STRING   0710
*                                      PARAM                         */
*                2 CMZM0021 CHAR(5) INIT('UTERM');/* PARAMETER STRING*/
*             DCL                                                  0711
*               CMZR0021 REGISTER(1);/* ESTABLISH PARAMeter          */
*             RESPECIFY                                            0712
*               CMZR0021 RSTD;      /* REGISTER FOR                  */
*             CMZR0021=ADDR(CMZP0021);/* ADDRESS OF PARAMETER LIST   */
         LA    CMZR0021,CMZP0021                                   0713
*             CALL ISTSDCC2;        /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0714
         BALR  @14,@15                                             0714
*             RESPECIFY                                            0715
*               CMZR0021 UNRSTD;                                   0715
*           END;                                                   0716
*           GPR15=4;                /* SET ERROR RETURN CODE         */
         LA    GPR15,4                                             0717
*           GETSW='0'B;             /* SET SWITCH                    */
         NI    GETSW,B'10111111'                                   0718
*         END;                                                     0719
*       ELSE                                                       0720
*         GETSW='1'B;               /* GET NON-UTERM ENTRY           */
         B     @RC00707                                            0720
@RF00707 OI    GETSW,B'01000000'                                   0720
*     END;                          /* END CTERM NOT FOUND YET       */
@RC00707 DS    0H                                                  0722
*   IF GETSW='1'B THEN              /* NEED TO GET AN ENTRY ?        */
@RC00683 TM    GETSW,B'01000000'                                   0722
         BNO   @RF00722                                            0722
*     DO;                           /* ENTRY IS EITHER UTERM OR CTERM*/
*                                                                  0723
*       /*************************************************************/
*       /*                                                           */
*       /* WAS SPECIFIED                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0724
*       GPR0=0;                                                    0724
         SLR   GPR0,GPR0                                           0724
*       GPR1=MLCPTR3;               /* PICK UP ADDR OF ENTRY MODEL   */
         L     GPR1,MLCPTR3(,MLCAREG)                              0725
*       CALL ISTSDCC1;              /* CALL AREAHDLER TO PUT MODEL IN
*                                      BUILD AREA                    */
         L     @15,@CV01249                                        0726
         BALR  @14,@15                                             0726
*       IF GPR15=0                  /* ENTRY MODEL STORAGE AVAILABLE */
*         THEN                                                     0727
         LTR   GPR15,GPR15                                         0727
         BNZ   @RF00727                                            0727
*         DO;                                                      0728
*           MLCPTR3=GPR1;                                          0729
         ST    GPR1,MLCPTR3(,MLCAREG)                              0729
*           MLCPTR4=ADDR(RPRDEVCH);                                0730
         L     @07,MLCPTR3(,MLCAREG)                               0730
         LA    @07,RPRDEVCH(,@07)                                  0730
         ST    @07,MLCPTR4(,MLCAREG)                               0730
*         END;                                                     0731
*       ELSE                                                       0732
*         DO;                                                      0732
         B     @RC00727                                            0732
@RF00727 DS    0H                                                  0733
*           GPR15=4;                /* SET ERROR RETURN CODE         */
         LA    GPR15,4                                             0733
*         END;                                                     0734
*     END;                          /* END IF GETSW = '1'            */
@RC00727 DS    0H                                                  0736
*   GPR14=ADDR(TRMRET1);            /* GET ADDR TO RETURN TO         */
@RF00722 LA    GPR14,TRMRET1                                       0736
*   END CTRMUTRM;                                                  0737
@EL00020 DS    0H                                                  0737
@EF00020 DS    0H                                                  0737
@ER00020 BR    @14                                                 0737
*                                                                  0738
*/* SEGMENT(TRMCOMP)START                                            */
*                                                                  0738
*   DO;                                                            0738
*     GOTO TRMCOMP@;                                               0739
*TRMCOMP:                                                          0740
*   END;                                                           0740
*                                                                  0740
TRMCOMP  DS    0H                                                  0741
*/********************************************************************/
*/*         THIS ROUTINE DETERMINES WHETHER THE PROCESSING IS FOR    */
*/*         COMPONENT OR TERMINAL. THE FIRST TERMINAL ENTRY WILL     */
*/*         BE A DUMMY TO REFLECT THE TERMINAL CONTROL UNIT. ITS CID */
*/* AND NAME  WILL BE MADE UP BY SYS/DEF. IT MAY BE DISTINGUISHED    */
*/* FROM NORMAL TERMINAL ENTRIES BY DEVSUBNO=1 AND RPRAOPN=0.        */
*/* IN ADDITION THE ISTATUS ACTIVE BIT WILL BE ON (RTRRBISA).        */
*/* THE SUBSEQUENT TERMINAL ENTRIES WILL HAVE RPRENTRY = RPRENTCM.   */
*/* THEIR NAMES AND CID'S WILL BE REAL. THE FIRST TERMC ENTRY WILL   */
*/* REFLECT THE NAME AND CID ASSOCIATED WITH THE TERMINAL MACRO. IT  */
*/* WILL ALSO CONTAIN FEATURE AND ISTATUS INFORMATION AS SPECIFIED   */
*/* ON THE TERMINAL MACRO                                            */
*/********************************************************************/
*                                                                  0741
*   IF MLCMACRO='COMP    ' THEN                                    0741
         CLC   MLCMACRO(8,MLCAREG),@CC01457                        0741
         BNE   @RF00741                                            0741
*     IF RGPADIL='0'B THEN          /* COMPS CAN NOT BE DIALED     0742
*                                                            @XA06939*/
         L     @07,RNCGP(,RNCAREG)                                 0742
         TM    RGPADIL(@07),B'10000000'                            0742
         BNZ   @RF00742                                            0742
*       DO;                                                        0743
*         IF RNCGCOMP='0'B THEN     /* IS THIS THE FIRST COMP        */
         TM    RNCGCOMP(RNCAREG),B'00010000'                       0744
         BNZ   @RF00744                                            0744
*           DO;                     /* MAKE DUMMY TERM AND COMP ENTRY
*                                      OUT OF LAST TERM ENTRY BUILT  */
*             GPR1=RNCTR;           /* PTR TO RNCA TERM ENTRY        */
         L     GPR1,RNCTR(,RNCAREG)                                0746
*             GPR0=0;                                              0747
         SLR   GPR0,GPR0                                           0747
*             CALL ISTSDCC1;        /* COPY LAST ENTRY               */
         L     @15,@CV01249                                        0748
         BALR  @14,@15                                             0748
*             IF GPR15=0 THEN       /* WAS ENTRY GOTTEN ?            */
         LTR   GPR15,GPR15                                         0749
         BNZ   @RF00749                                            0749
*               DO;                                                0750
*                 RNCCM=GPR1;       /* UPDATE PTR TO LAST RNCA COMP
*                                      ENTRY                         */
         ST    GPR1,RNCCM(,RNCAREG)                                0751
*                 RNCCM->RPRENTRY=RPRENTCM;/* FLAG BUILD MODEL AS  0752
*                                      COMPONENT                     */
         L     @07,RNCCM(,RNCAREG)                                 0752
         MVI   RPRENTRY(@07),X'90'                                 0752
*                 IF RNCDTYPE='00'X /* WAS DEVICE TYPE SAVE AREA   0753
*                                      FILLED IN BY TRMDEVIC"        */
*                   THEN                                           0753
         CLI   RNCDTYPE(RNCAREG),X'00'                             0753
         BE    @RT00753                                            0753
*                   ;                                              0754
*                 ELSE                                             0755
*                   DO;                                            0755
*                     TRMTEMP=ADDR(RNCCM->RPRDEVCH);               0756
         L     @07,RNCCM(,RNCAREG)                                 0756
         LA    @07,RPRDEVCH(,@07)                                  0756
         ST    @07,TRMTEMP                                         0756
*                     TRMTEMP->DEVTCODE=RNCDTYPE;/* COPY DEVICE TYPE
*                                      SAVE AREA                     */
         MVC   DEVTCODE(1,@07),RNCDTYPE(RNCAREG)                   0757
*                   END;                                           0758
*                 RNCTR->RTRRBISA='1'B;/* ACTVE STATUS               */
@RT00753 L     @07,RNCTR(,RNCAREG)                                 0759
         OI    RTRRBISA(@07),B'01000000'                           0759
*                 TRMTEMP=ADDR(RNCTR->RPRDEVCH);                   0760
         LA    @04,RPRDEVCH(,@07)                                  0760
         ST    @04,TRMTEMP                                         0760
*                 TRMTEMP->DEVSUBND='1'B;/* DEVICE HAS SUBNODES      */
         OI    DEVSUBND(@04),B'00010000'                           0761
*                 RNCTR->RPRAOPN='0'B;/* DUMMY TERMINAL CAN'T OPENED
*                                      BY APPL                       */
         NI    RPRAOPN(@07),B'11011111'                            0762
*                 RNCTR->RTRCTECM=1;/* FIRST COMPONENT ENTRY         */
         LA    @04,1                                               0763
         STH   @04,RTRCTECM(,@07)                                  0763
*                 RRNCTECM=RRNCTECM+1;/* UPDATE TOTAL COUNT OF     0764
*                                      COMPONENT ENTRIES FOR RN      */
         L     @07,RNCRN(,RNCAREG)                                 0764
         LH    @03,RRNCTECM(,@07)                                  0764
         ALR   @03,@04                                             0764
         STH   @03,RRNCTECM(,@07)                                  0764
*                 RGPCTECM=RGPCTECM+1;/* UPDATE TOTAL COUNT OF     0765
*                                      COMPONENT ENTRIES FOR GROUP   */
         L     @07,RNCGP(,RNCAREG)                                 0765
         LH    @03,RGPCTECM(,@07)                                  0765
         ALR   @03,@04                                             0765
         STH   @03,RGPCTECM(,@07)                                  0765
*                 RLNCTECM=RLNCTECM+1;/* UPDATE TOTAL COUNT OF     0766
*                                      COMPONENT ENTRIES FOR LINE    */
         L     @07,RNCLN(,RNCAREG)                                 0766
         AH    @04,RLNCTECM(,@07)                                  0766
         STH   @04,RLNCTECM(,@07)                                  0766
*                 GPR1=RPRENTCM;    /* ASK SIFT/DEF FOR COMP         */
         LA    GPR1,144                                            0767
*               END;                /* END OF GPR15=0 FROM C1        */
*             ELSE                                                 0769
*               RC=4;               /* AREAHANDLER ALREADY PUT OUT 0769
*                                      ERROR MESSAGE                 */
         B     @RC00749                                            0769
@RF00749 MVC   RC(2),@CH00052                                      0769
*           END;                    /* END FIRST COMPONENT           */
*         ELSE                                                     0771
*           GPR1=RPRENTCM;          /* ASK SIFT/DEF FOR COMP         */
         B     @RC00744                                            0771
@RF00744 LA    GPR1,144                                            0771
*       END;                        /* IF NOT 'COMP' MACRO           */
*     ELSE                                                         0773
*       DO;                         /* DIALED COMP           @XA06939*/
         B     @RC00742                                            0773
@RF00742 DS    0H                                                  0774
*/* ERRFMT    LEVEL(MACRO)  ERROR(CONF)  ACTION(KILLBLD)             */
*                                                                  0774
*         DO;                                                      0774
*           DCL                                                    0775
*             1 CMZP0023 STATIC LOCAL,/* PARAMETER LIST PASSED TO  0775
*                                      ERROR FORMAT ROUTINE          */
*              2 CMZL0023 FIXED(8) INIT(3),/* LEVEL PARAMETER (CLEV) */
*              2 CMZE0023 FIXED(8) INIT(2),/* ERROR PARAMETER (CERR) */
*              2 CMZA0023 CHAR(1) INIT('6'),/* ACTION PARAMETER    0775
*                                      (CACT)                        */
*              2 CMZS0023 FIXED(8) INIT(0);/* LENGTH OF STRING PARAM */
*           DCL                                                    0776
*             CMZR0023 REGISTER(1); /* ESTABLISH PARAMeter           */
*           RESPECIFY                                              0777
*             CMZR0023 RSTD;        /* REGISTER FOR                  */
*           CMZR0023=ADDR(CMZP0023);/* ADDRESS OF PARAMETER LIST     */
         LA    CMZR0023,CMZP0023                                   0778
*           CALL ISTSDCC2;          /* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0779
         BALR  @14,@15                                             0779
*           RESPECIFY                                              0780
*             CMZR0023 UNRSTD;                                     0780
*         END;                      /*                       @XA06939*/
*         RC=4;                     /*                       @XA06939*/
         MVC   RC(2),@CH00052                                      0782
*       END;                        /*                       @XA06939*/
*   ELSE                                                           0784
*     DO;                                                          0784
         B     @RC00741                                            0784
@RF00741 DS    0H                                                  0785
*       RNCDTYPE='00'X;             /* NOT COMP                      */
         MVI   RNCDTYPE(RNCAREG),X'00'                             0785
*       GPR1=RPRENTTR;              /* ASK FOR TERM MOD              */
         LA    GPR1,128                                            0786
*     END;                                                         0787
*                                                                  0787
*/* SEGMENT(TRMCOMP)FINISH                                           */
*                                                                  0788
*   DO;                                                            0788
@RC00741 DS    0H                                                  0789
*     GOTO TRMCOMP#;                                               0789
         B     TRMCOMP#                                            0789
*TRMCOMP@:                                                         0790
*   END;                                                           0790
TRMCOMP@ DS    0H                                                  0791
*                                                                  0791
*/* SEGMENT(COUNTS)START                                             */
*                                                                  0791
*   DO;                                                            0791
*     GOTO COUNTS@;                                                0792
         B     COUNTS@                                             0792
*COUNTS:                                                           0793
*   END;                                                           0793
*                                                                  0793
COUNTS   DS    0H                                                  0794
*/********************************************************************/
*/* INCREMENT THE COUNT FOR ENTRIES HIGHER THAN THE PRESENT ONE      */
*/* WHETHER THE ENTRY IS A COMP OR A TERMINAL                        */
*/********************************************************************/
*                                                                  0794
*   IF MLCMACRO='COMP    ' THEN     /* TERM OR COMP ENTRY            */
         CLC   MLCMACRO(8,MLCAREG),@CC01457                        0794
         BNE   @RF00794                                            0794
*     DO;                                                          0795
*       RNCGCOMP='1'B;              /* GLOBAL COMP FOOTPRINT         */
         OI    RNCGCOMP(RNCAREG),B'00010000'                       0796
*       RNCCM=GPR1;                 /* RNCA'S PTR TO PREVIOUS COMP   */
         ST    GPR1,RNCCM(,RNCAREG)                                0797
*       RRNCTECM=RRNCTECM+1;        /* INCREMENT COMP COUNTS         */
         L     @07,RNCRN(,RNCAREG)                                 0798
         LA    @04,1                                               0798
         LH    @03,RRNCTECM(,@07)                                  0798
         ALR   @03,@04                                             0798
         STH   @03,RRNCTECM(,@07)                                  0798
*       RGPCTECM=RGPCTECM+1;        /* IN RN, GP, LN, & TRM          */
         L     @07,RNCGP(,RNCAREG)                                 0799
         LH    @03,RGPCTECM(,@07)                                  0799
         ALR   @03,@04                                             0799
         STH   @03,RGPCTECM(,@07)                                  0799
*       RLNCTECM=RLNCTECM+1;        /* NOTE-NO CLUSTER TERMINALS     */
         L     @07,RNCLN(,RNCAREG)                                 0800
         LH    @03,RLNCTECM(,@07)                                  0800
         ALR   @03,@04                                             0800
         STH   @03,RLNCTECM(,@07)                                  0800
*       RNCTR->RTRCTECM=RTRCTECM+1; /* HAVE COMPONENTS               */
         L     @07,RNCTR(,RNCAREG)                                 0801
         L     @03,MLCPTR3(,MLCAREG)                               0801
         AH    @04,RTRCTECM(,@03)                                  0801
         STH   @04,RTRCTECM(,@07)                                  0801
*     END;                                                         0802
*   ELSE                                                           0803
*     DO;                           /* ENTRY IS A TERM               */
         B     @RC00794                                            0803
@RF00794 DS    0H                                                  0804
*       RNCGTERM='1'B;              /* TERM GLOBAL FOOTPRINT         */
         OI    RNCGTERM(RNCAREG),B'01000000'                       0804
*       RNCTR=GPR1;                 /* PTR TO PREVIOUS TERM          */
         ST    GPR1,RNCTR(,RNCAREG)                                0805
*       IF DIALOUT='1'B             /* LCDO ASSOC. WITH TERM ENTRY?  */
*         THEN                                                     0806
         TM    DIALOUT,B'00100000'                                 0806
         BNO   @RF00806                                            0806
*         DO;                                                      0807
*           RDSCTTRM=RDSCTTRM+1;    /* UPDATE LCDO TERMINAL ENTRY  0808
*                                      COUNT                         */
         L     @07,MLCPTR3(,MLCAREG)                               0808
         L     @04,RPRNSNEA(,@07)                                  0808
         LA    @03,1                                               0808
         AH    @03,RDSCTTRM(,@04)                                  0808
         STH   @03,RDSCTTRM(,@04)                                  0808
*           RPRNSNEA=RPRNSNEA->RPRCOMID;/* LCDO OFFSET               */
         L     @04,RPRCOMID(,@04)                                  0809
         ST    @04,RPRNSNEA(,@07)                                  0809
*         END;                      /* END ASSOCIATED LCDO           */
*       ELSE                                                       0811
*         RPRNSNEA=0;                                              0811
         B     @RC00806                                            0811
@RF00806 L     @07,MLCPTR3(,MLCAREG)                               0811
         SLR   @04,@04                                             0811
         ST    @04,RPRNSNEA(,@07)                                  0811
*       RRNCTETR=RRNCTETR+1;        /* INCREMENT TERM COUNTS IN RN,  */
@RC00806 L     @07,RNCRN(,RNCAREG)                                 0812
         LA    @04,1                                               0812
         LH    @03,RRNCTETR(,@07)                                  0812
         ALR   @03,@04                                             0812
         STH   @03,RRNCTETR(,@07)                                  0812
*       RGPCTETR=RGPCTETR+1;        /* GP, AND LN                    */
         L     @07,RNCGP(,RNCAREG)                                 0813
         LH    @03,RGPCTETR(,@07)                                  0813
         ALR   @03,@04                                             0813
         STH   @03,RGPCTETR(,@07)                                  0813
*       RLNCTETR=RLNCTETR+1;                                       0814
         L     @07,RNCLN(,RNCAREG)                                 0814
         LH    @03,RLNCTETR(,@07)                                  0814
         ALR   @03,@04                                             0814
         STH   @03,RLNCTETR(,@07)                                  0814
*       IF RNCGCLUS='1'B            /* IS THIS CLUSTER ENTRY         */
*         THEN                                                     0815
         TM    RNCGCLUS(RNCAREG),B'00000010'                       0815
         BNO   @RF00815                                            0815
*         RCLCTETR=RCLCTETR+1;      /* INCREMENT CLUSTER COUNT IN TM */
         L     @07,RNCCL(,RNCAREG)                                 0816
         AH    @04,RCLCTETR(,@07)                                  0816
         STH   @04,RCLCTETR(,@07)                                  0816
*       ELSE                                                       0817
*         ;                                                        0817
@RF00815 DS    0H                                                  0818
*     END;                                                         0818
*                                                                  0818
*/* SEGMENT(COUNTS)FINISH                                            */
*                                                                  0819
*   DO;                                                            0819
@RC00794 DS    0H                                                  0820
*     GOTO COUNTS#;                                                0820
         B     COUNTS#                                             0820
*COUNTS@:                                                          0821
*   END;                                                           0821
COUNTS@  DS    0H                                                  0822
*                                                                  0822
*/*  SEGMENT(T2980)START                                             */
*                                                                  0822
*   DO;                                                            0822
*     GOTO T2980@;                                                 0823
         B     T2980@                                              0823
*T2980:                                                            0824
*   END;                                                           0824
*                                                                  0824
T2980    DS    0H                                                  0825
*/********************************************************************/
*/* DUPLICATE TERMINAL ENTRY BY CALLING AREAHDLR TWICE FOR THE       */
*/* SAME MODEL. SET ADDR AND COUNT FIELDS IN SECOND ENTRY            */
*/********************************************************************/
*                                                                  0825
*   IF T2980CT>0                    /* CAN'T BE SET BY PREVIOUS MACRO*/
*                                                                  0825
*   /*****************************************************************/
*   /*                                                               */
*   /* BECAUSE RN ZEROES OUT MACRO HANDLER DATA AREA                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0825
*     THEN                                                         0825
         SLR   @07,@07                                             0825
         CH    @07,T2980CT                                         0825
         BNL   @RF00825                                            0825
*     DO;                           /* T2980 CT AND T2980AD ARE SET
*                                      IN THE                        */
*                                                                  0826
*       /*************************************************************/
*       /*                                                           */
*       /* ADDR PARM HANDLER IF ALTERNATE ADDR CHARACTERS ARE        */
*       /* SPECIFIED. THEY NEED NOT BE INITIALIZED TO 0 SINCE RNBLD  */
*       /* CLEARS THE DATA AREA                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0827
*       GPR1=MLCENT;                /* SET UP TO COPY TERM ENTRY     */
         L     GPR1,MLCENT(,MLCAREG)                               0827
*       GPR0=0;                                                    0828
         LR    GPR0,@07                                            0828
*       CALL ISTSDCC1;              /* AREAHANDLER TO COPY TERM ENTRY*/
         L     @15,@CV01249                                        0829
         BALR  @14,@15                                             0829
*       IF GPR15=0 THEN                                            0830
         LTR   GPR15,GPR15                                         0830
         BNZ   @RF00830                                            0830
*         DO;                       /* COPY O.K.                     */
*           RTRCADDR(1:2)=T2980AD(1:2);/* COUNT OF COMP @ING CHARS   */
         L     @07,MLCPTR3(,MLCAREG)                               0832
         MVC   RTRCADDR(2,@07),T2980AD                             0832
*           RTRCTADR=T2980CT;       /* COUNT OF TERM @ING CHARS      */
         LH    @04,T2980CT                                         0833
         STH   @04,RTRCTADR(,@07)                                  0833
*           RRNCTETR=RRNCTETR+1;    /* UPDATE TERM COUNTS            */
         L     @07,RNCRN(,RNCAREG)                                 0834
         LA    @04,1                                               0834
         LH    @03,RRNCTETR(,@07)                                  0834
         ALR   @03,@04                                             0834
         STH   @03,RRNCTETR(,@07)                                  0834
*           RGPCTETR=RGPCTETR+1;    /* IN RN, AP, AND LN             */
         L     @07,RNCGP(,RNCAREG)                                 0835
         LH    @03,RGPCTETR(,@07)                                  0835
         ALR   @03,@04                                             0835
         STH   @03,RGPCTETR(,@07)                                  0835
*           RLNCTETR=RLNCTETR+1;                                   0836
         L     @07,RNCLN(,RNCAREG)                                 0836
         LH    @03,RLNCTETR(,@07)                                  0836
         ALR   @03,@04                                             0836
         STH   @03,RLNCTETR(,@07)                                  0836
*           IF RNCGCLUS='1'B        /* IS THIS A CLUSTER ENTRY       */
*             THEN                                                 0837
         TM    RNCGCLUS(RNCAREG),B'00000010'                       0837
         BNO   @RF00837                                            0837
*             RCLCTETR=RCLCTETR+1;  /* UPDATE COUNT IN CLUSTER       */
         L     @07,RNCCL(,RNCAREG)                                 0838
         AH    @04,RCLCTETR(,@07)                                  0838
         STH   @04,RCLCTETR(,@07)                                  0838
*           ELSE                                                   0839
*             ;                                                    0839
@RF00837 DS    0H                                                  0840
*         END;                                                     0840
*       ELSE                                                       0841
*         RC=4;                     /* AREAHDLER HAD AN ERROR & PUT
*                                      OUT A MSG                     */
         B     @RC00830                                            0841
@RF00830 MVC   RC(2),@CH00052                                      0841
*     END;                                                         0842
*   ELSE                                                           0843
*     ;                                                            0843
*                                                                  0843
@RF00825 DS    0H                                                  0844
*   /*****************************************************************/
*   /*                                                               */
*   /* SEGMENT(T2980)FINISH                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*   DO;                                                            0844
@RC00825 DS    0H                                                  0845
*     GOTO T2980#;                                                 0845
         B     T2980#                                              0845
*T2980@:                                                           0846
*   END;                                                           0846
T2980@   DS    0H                                                  0847
*                                                                  0847
*   /*****************************************************************/
*   /*                                                               */
*   /* SEGMENT(POLDEVT)START                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0847
*   DO;                                                            0847
*     GOTO POLDEVT@;                                               0848
         B     POLDEVT@                                            0848
*POLDEVT:                                                          0849
*   END;                                                           0849
*                                                                  0849
POLDEVT  DS    0H                                                  0850
*/********************************************************************/
*/* IF ENTRY IS A COMPONENT, IT IS OUTPUT IF ADDRESS WAS SPECIFIED,  */
*/* INPUT IF POLL WAS SPECIFIED. IF NEITHER, THEN CHARACTERISTICS    */
*/* SIFTED FROM THE DIRECTION PARAMETER ON THE TERMINAL ARE KEPT.    */
*/********************************************************************/
*                                                                  0850
*   IF RPRENTRY=RPRENTCM&(LCLFPOLL=ON×LCLFADDR=ON) THEN/*    @DM08373*/
         L     @07,MLCPTR3(,MLCAREG)                               0850
         CLI   RPRENTRY(@07),X'90'                                 0850
         BNE   @RF00850                                            0850
         TM    LCLFPOLL,B'10001000'                                0850
         BZ    @RF00850                                            0850
*     DO;                           /*                       @DM08373*/
*       DEVINPUT=OFF;               /*                       @DM08373*/
*       DEVOTPUT=OFF;               /*                       @DM08373*/
         L     @07,MLCPTR4(,MLCAREG)                               0853
         NI    DEVINPUT(@07),B'00111111'                           0853
*       IF LCLFPOLL=ON THEN         /*                       @DM08373*/
         TM    LCLFPOLL,B'00001000'                                0854
         BNO   @RF00854                                            0854
*         DEVINPUT=ON;              /*                       @DM09630*/
         OI    DEVINPUT(@07),B'10000000'                           0855
*       IF LCLFADDR=ON THEN         /*                       @DM08373*/
@RF00854 TM    LCLFADDR,B'10000000'                                0856
         BNO   @RF00856                                            0856
*         DEVOTPUT=ON;              /*                       @DM09630*/
         L     @07,MLCPTR4(,MLCAREG)                               0857
         OI    DEVOTPUT(@07),B'01000000'                           0857
*     END;                          /*                       @DM08373*/
*   ELSE                                                           0859
*     ;                             /*                       @DM08373*/
@RF00850 DS    0H                                                  0860
*/********************************************************************/
*/* KILL THE BUILD IF AN IMPROPER COMBINATION OF POLLING PARAMETERS  */
*/* ARE USED FOR THE TERMINAL DEVICE TYPE.  THE VALID CONDITIONS ARE */
*/* AS FOLLOWS:                                                      */
*/*        LINE POLLED                 LINE POLLED                   */
*/*        GROUP NOT SWITCHED          GROUP NOT SWITCHED            */
*/*        QUEUED POLIMIT              NOWAIT POLIMIT                */
*/*        NOT 3735 TERMINAL           3735 TERMINAL                 */
*/********************************************************************/
*                                                                  0860
*   IF RGPADIL^='1'B THEN           /* GROUP SWITCHED?               */
@RC00850 L     @07,RNCGP(,RNCAREG)                                 0860
         TM    RGPADIL(@07),B'10000000'                            0860
         BO    @RF00860                                            0860
*GNOTSW:                                                           0861
*     DO;                           /* NO, IS LINE                   */
GNOTSW   DS    0H                                                  0862
*       IF RLNMULTP='1'B THEN       /* POLLED?                       */
         L     @07,RNCLN(,RNCAREG)                                 0862
         TM    RLNMULTP(@07),B'00000001'                           0862
         BNO   @RF00862                                            0862
*LPOL:                                                             0863
*         DO;                       /* YES, IS DEVICE A              */
LPOL     DS    0H                                                  0864
*           IF DEVTCODE^=DEV3735 THEN/* 3735?                        */
         L     @07,MLCPTR4(,MLCAREG)                               0864
         CLI   DEVTCODE(@07),X'0B'                                 0864
         BE    @RF00864                                            0864
*DOTHER:                                                           0865
*             DO;                   /* NO, POLIMIT OF                */
DOTHER   DS    0H                                                  0866
*               IF RNCLQUE^='1'B THEN/* 'QUEUE'?                     */
         TM    RNCLQUE(RNCAREG),B'01000000'                        0866
         BO    @RF00866                                            0866
*NOTQ:                                                             0867
*                 DO;               /* NO. ERR CONDITION             */
NOTQ     DS    0H                                                  0868
*/* ERRFMT    LEVEL(VALUE)  ERROR(CONF)  ACTION(KILLBLD)  STRING('POLIM
*T')                                                                 */
*                                                                  0868
*                   DO;                                            0868
*                     DCL                                          0869
*                       1 CMZP0030 STATIC LOCAL,/* PARAMETER LIST  0869
*                                      PASSED TO ERROR FORMAT ROUTINE*/
*                        2 CMZL0030 FIXED(8) INIT(5),/* LEVEL      0869
*                                      PARAMETER (CLEV)              */
*                        2 CMZE0030 FIXED(8) INIT(2),/* ERROR      0869
*                                      PARAMETER (CERR)              */
*                        2 CMZA0030 CHAR(1) INIT('6'),/* ACTION    0869
*                                      PARAMETER (CACT)              */
*                        2 CMZS0030 FIXED(8) INIT(7),/* LENGTH OF  0869
*                                      STRING PARAM                  */
*                        2 CMZM0030 CHAR(7) INIT('POLIMIT');/*     0869
*                                      PARAMETER STRING              */
*                     DCL                                          0870
*                       CMZR0030 REGISTER(1);/* ESTABLISH PARAMeter  */
*                     RESPECIFY                                    0871
*                       CMZR0030 RSTD;/* REGISTER FOR                */
*                     CMZR0030=ADDR(CMZP0030);/* ADDRESS OF PARAMETER
*                                      LIST                          */
         LA    CMZR0030,CMZP0030                                   0872
*                     CALL ISTSDCC2;/* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0873
         BALR  @14,@15                                             0873
*                     RESPECIFY                                    0874
*                       CMZR0030 UNRSTD;                           0874
*                   END;                                           0875
*                   RC=4;           /* KILL THE BUILD                */
         MVC   RC(2),@CH00052                                      0876
*                 END NOTQ;                                        0877
*             END DOTHER;                                          0878
*           ELSE                    /* DEVICE IS 3735                */
*D3735:                                                            0879
*             DO;                   /* POLIMIT OF                    */
         B     @RC00864                                            0879
@RF00864 DS    0H                                                  0879
D3735    DS    0H                                                  0880
*               IF RNCLNOW^='1'B THEN/* 'NO WAIT'            @ZA25997*/
         TM    RNCLNOW(RNCAREG),B'00010000'                        0880
         BO    @RF00880                                            0880
*NOTW:                                                             0881
*                 DO;               /* YES. ERR CONDITION            */
NOTW     DS    0H                                                  0882
*/* ERRFMT    LEVEL(VALUE)  ERROR(CONF)  ACTION(KILLBLD)  STRING('POLIM
*T')                                                                 */
*                                                                  0882
*                   DO;                                            0882
*                     DCL                                          0883
*                       1 CMZP0031 STATIC LOCAL,/* PARAMETER LIST  0883
*                                      PASSED TO ERROR FORMAT ROUTINE*/
*                        2 CMZL0031 FIXED(8) INIT(5),/* LEVEL      0883
*                                      PARAMETER (CLEV)              */
*                        2 CMZE0031 FIXED(8) INIT(2),/* ERROR      0883
*                                      PARAMETER (CERR)              */
*                        2 CMZA0031 CHAR(1) INIT('6'),/* ACTION    0883
*                                      PARAMETER (CACT)              */
*                        2 CMZS0031 FIXED(8) INIT(7),/* LENGTH OF  0883
*                                      STRING PARAM                  */
*                        2 CMZM0031 CHAR(7) INIT('POLIMIT');/*     0883
*                                      PARAMETER STRING              */
*                     DCL                                          0884
*                       CMZR0031 REGISTER(1);/* ESTABLISH PARAMeter  */
*                     RESPECIFY                                    0885
*                       CMZR0031 RSTD;/* REGISTER FOR                */
*                     CMZR0031=ADDR(CMZP0031);/* ADDRESS OF PARAMETER
*                                      LIST                          */
         LA    CMZR0031,CMZP0031                                   0886
*                     CALL ISTSDCC2;/* CALL ERROR FORMAT ROUTINE     */
         L     @15,@CV01299                                        0887
         BALR  @14,@15                                             0887
*                     RESPECIFY                                    0888
*                       CMZR0031 UNRSTD;                           0888
*                   END;                                           0889
*                   RC=4;           /* KILL THE BUILD                */
         MVC   RC(2),@CH00052                                      0890
*                 END NOTW;                                        0891
*             END D3735;                                           0892
@RF00880 DS    0H                                                  0893
*         END LPOL;                                                0893
@RC00864 DS    0H                                                  0894
*     END GNOTSW;                                                  0894
*                                                                  0894
@RF00862 DS    0H                                                  0895
*   /*****************************************************************/
*   /*                                                               */
*   /* SEGMENT(POLDEVT)FINISH                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0895
*   DO;                                                            0895
@RF00860 DS    0H                                                  0896
*     GOTO POLDEVT#;                                               0896
         B     POLDEVT#                                            0896
*POLDEVT@:                                                         0897
*   END;                                                           0897
POLDEVT@ DS    0H                                                  0898
*   DCL                                                            0898
*     ISTSDCI4 EXT ENTRY NONLOCAL;  /* EXTERNAL REF TO TERM PARM   0898
*                                      HNDLR                         */
*/********************************************************************/
*/*                   KEYWORD TABLE                                  */
*/********************************************************************/
*                                                                  0899
*   DCL                                                            0899
*    (ISTSDCC5,                                                    0899
*     ISTSDCC6,                                                    0899
*     ISTSDCR1) EXT ENTRY NONLOCAL;                                0899
*   DCL                                                            0900
*     1 TRMKWTBL BDY(WORD) STATIC LOCAL,                           0900
*      2 * FIXED(15) INIT(38),                                     0900
*      2 * FIXED(15) INIT(13),      /*                       @XA19636*/
*      2 * CHAR(8) INIT('ADDR'),                                   0900
*      2 * FIXED(8) INIT('05'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMADDR)) BDY(BYTE),                  0900
*      2 * CHAR(8) INIT('ATTN'),                                   0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMATN)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('BFRDLAY'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('BHEXEC'),                                 0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('BHSET'),                                  0900
*      2 * FIXED(8) INIT('33'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMBHSET)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('BUFLIM'),                                 0900
*      2 * FIXED(8) INIT('07'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMBFLIM)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('CDATA'),                                  0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMCDT)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('CONV'),                                   0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMCNV)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('CRDLAY'),                                 0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('CRITSIT'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('CTERM'),                                  0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMCTR)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('CUIDLEN'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('DEVICE'),                                 0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMDEV)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('DIALNO'),                                 0900
*      2 * FIXED(8) INIT('05'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMDILNO)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('DIALSET'),                                0900
*      2 * FIXED(8) INIT('33'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCP5)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('DIRECTN'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMDIR)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('DLOGMOD'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('EXEC'),                                   0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMEXC)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('ENDTRNS'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMETR)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('FANOUT'),                                 0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('FEATURE'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMFEA)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('FEATUR2'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMFT2)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('IDSEQ'),                                  0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('INHIBIT'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('ISTATUS'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMIST)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('ITBMODE'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMITB)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('LCST'),                                   0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('LGRAPHS'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('LOGAPPL'),                                0900
*      2 * FIXED(8) INIT('33'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMLGAPL)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('LOGTAB'),                                 0900
*      2 * FIXED(8) INIT('33'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMLGTAB)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('MODETAB'),                                0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('POLL'),                                   0900
*      2 * FIXED(8) INIT('01'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMPOLL)) BDY(BYTE),                  0900
*      2 * CHAR(8) INIT('PT3EXEC'),                                0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMPT3)) BDY(BYTE),                   0900
*      2 * CHAR(8) INIT('SPAN'),                                   0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('TERM'),                                   0900
*      2 * FIXED(8) INIT('02'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCI4)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('USSTAB'),                                 0900
*      2 * FIXED(8) INIT('06'X),                                   0900
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('UTERM'),                                  0900
*      2 * FIXED(8) INIT('33'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMUTERM)) BDY(BYTE),                 0900
*      2 * CHAR(8) INIT('XMITLIM'),                                0900
*      2 * FIXED(8) INIT('44'X),                                   0900
*      2 * PTR(31) INIT(ADDR(TRMXMTLM)) BDY(BYTE);                 0900
*                                                                  0901
*/********************************************************************/
*/* KEYWORD TABLE TWO                                                */
*/********************************************************************/
*                                                                  0901
*   DCL                                                            0901
*     1 VTRKWTBL BDY(WORD) STATIC LOCAL,                           0901
*      2 * FIXED(15) INIT(5),                                      0901
*      2 * FIXED(15) INIT(13),      /*                       @XA19636*/
*      2 * CHAR(8) INIT('BUFLIM'),                                 0901
*      2 * FIXED(8) INIT('07'X),                                   0901
*      2 * PTR(31) INIT(ADDR(TRMBFLIM)) BDY(BYTE),                 0901
*      2 * CHAR(8) INIT('LCST'),                                   0901
*      2 * FIXED(8) INIT('33'X),                                   0901
*      2 * PTR(31) INIT(ADDR(ISTSDCP2)) BDY(BYTE),                 0901
*      2 * CHAR(8) INIT('LOGAPPL'),                                0901
*      2 * FIXED(8) INIT('33'X),                                   0901
*      2 * PTR(31) INIT(ADDR(TRMLGAPL)) BDY(BYTE),                 0901
*      2 * CHAR(8) INIT('LOGTAB'),                                 0901
*      2 * FIXED(8) INIT('33'X),                                   0901
*      2 * PTR(31) INIT(ADDR(TRMLGTAB)) BDY(BYTE),                 0901
*      2 * CHAR(8) INIT('SPAN'),                                   0901
*      2 * FIXED(8) INIT('06'X),                                   0901
*      2 * PTR(31) INIT(ADDR(ISTSDCR1)) BDY(BYTE);                 0901
*                                                                  0902
*/********************************************************************/
*/*          INTERMEDIATE POINTER BLOCK                              */
*/********************************************************************/
*                                                                  0902
*   DCL                                                            0902
*     1 TRMIPB BDY(WORD) STATIC LOCAL,                             0902
*      2 * FIXED(15) INIT(13),                                     0902
*      2 * FIXED(15) INIT(8),       /*                       @D31KKMX*/
*      2 TRMATN PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(ATNSUB)),                             0902
*      2 TRMCDT PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(CDTSUB)),                             0902
*      2 TRMCNV PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(CNVSUB)),                             0902
*      2 TRMCTR PTR(31) INIT(ADDR(TRMCTERM)),                      0902
*      2 * PTR(31) INIT(ADDR(CTRSUB)),                             0902
*      2 TRMDEV PTR(31) INIT(ADDR(TRMDEVIC)),                      0902
*      2 * PTR(31) INIT(ADDR(DEVSUB)),                             0902
*      2 TRMDIR PTR(31) INIT(ADDR(TRMDRCTN)),                      0902
*      2 * PTR(31) INIT(ADDR(DIRSUB)),                             0902
*      2 TRMETR PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(ETRSUB)),                             0902
*      2 TRMEXC PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(EXCSUB)),                             0902
*      2 TRMFEA PTR(31) INIT(ADDR(TRMFEATR)),                      0902
*      2 * PTR(31) INIT(ADDR(FEASUB)),                             0902
*      2 TRMFT2 PTR(31) INIT(ADDR(TRMFEAT2)),                      0902
*      2 * PTR(31) INIT(ADDR(FT2SUB)),                             0902
*      2 TRMIST PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(ISTSUB)),                             0902
*      2 TRMITB PTR(31) INIT(ADDR(TRMITBMD)),                      0902
*      2 * PTR(31) INIT(ADDR(ITBSUB)),                             0902
*      2 TRMPT3 PTR(31) INIT(ADDR(ISTSDCC5)),                      0902
*      2 * PTR(31) INIT(ADDR(PT3SUB));                             0902
*                                                                  0903
*/********************************************************************/
*/*                   SUB - TABLES                                   */
*/********************************************************************/
*                                                                  0903
*   DCL                                                            0903
*     DRCTNIN CONSTANT(1) FIXED(31);/* DRCTN TABLE ONLY              */
*   DCL                                                            0904
*     DRCTNOUT CONSTANT(2) FIXED(31);                              0904
*   DCL                                                            0905
*     DRCTNIO CONSTANT(0) FIXED(31);                               0905
*   DCL                                                            0906
*     1 DIRSUB BDY(WORD) STATIC LOCAL,                             0906
*      2 * FIXED(15) INIT(3),                                      0906
*      2 * FIXED(15) INIT(12),                                     0906
*      2 * CHAR(8) INIT('IN'),                                     0906
*      2 * FIXED(31) INIT(DRCTNIN),                                0906
*      2 * CHAR(8) INIT('OUT'),                                    0906
*      2 * FIXED(31) INIT(DRCTNOUT),                               0906
*      2 * CHAR(8) INIT('INOUT'),                                  0906
*      2 * FIXED(31) INIT(DRCTNIO);                                0906
*   DCL                                                            0907
*     1 ITBSUB BDY(WORD) STATIC LOCAL,                             0907
*      2 * FIXED(15) INIT(2),                                      0907
*      2 * FIXED(15) INIT(12),                                     0907
*      2 * CHAR(8) INIT('YES'),                                    0907
*      2 * FIXED(31) INIT(1),                                      0907
*      2 * CHAR(8) INIT('NO'),                                     0907
*      2 * FIXED(31) INIT(0);                                      0907
*   DCL                                                            0908
*     1 CTRSUB BDY(WORD) STATIC LOCAL,                             0908
*      2 * FIXED(15) INIT(2),                                      0908
*      2 * FIXED(15) INIT(12),                                     0908
*      2 * CHAR(8) INIT('YES'),                                    0908
*      2 * FIXED(31) INIT(1),                                      0908
*      2 * CHAR(8) INIT('NO'),                                     0908
*      2 * FIXED(31) INIT(0);                                      0908
*   DCL                                                            0909
*     1 DEVSUB BDY(WORD) STATIC LOCAL,                             0909
*      2 * FIXED(15) INIT(19),                                     0909
*      2 * FIXED(15) INIT(12),                                     0909
*      2 * CHAR(8) INIT('1052'),                                   0909
*      2 * FIXED(31) INIT(DEV1052),                                0909
*      2 * CHAR(8) INIT('1053'),                                   0909
*      2 * FIXED(31) INIT(DEV1053),                                0909
*      2 * CHAR(8) INIT('1054'),                                   0909
*      2 * FIXED(31) INIT(DEV1054),                                0909
*      2 * CHAR(8) INIT('1055'),                                   0909
*      2 * FIXED(31) INIT(DEV1055),                                0909
*      2 * CHAR(8) INIT('1056'),                                   0909
*      2 * FIXED(31) INIT(DEV1056),                                0909
*      2 * CHAR(8) INIT('1057'),                                   0909
*      2 * FIXED(31) INIT(DEV1057),                                0909
*      2 * CHAR(8) INIT('1058'),                                   0909
*      2 * FIXED(31) INIT(DEV1058),                                0909
*      2 * CHAR(8) INIT('1092'),                                   0909
*      2 * FIXED(31) INIT(DEV1092),                                0909
*      2 * CHAR(8) INIT('1093'),                                   0909
*      2 * FIXED(31) INIT(DEV1093),                                0909
*      2 * CHAR(8) INIT('545'),                                    0909
*      2 * FIXED(31) INIT(DEV545),                                 0909
*      2 * CHAR(8) INIT('1017'),                                   0909
*      2 * FIXED(31) INIT(DEV1017),                                0909
*      2 * CHAR(8) INIT('1018'),                                   0909
*      2 * FIXED(31) INIT(DEV1018),                                0909
*      2 * CHAR(8) INIT('2203'),                                   0909
*      2 * FIXED(31) INIT(DEV2203),                                0909
*      2 * CHAR(8) INIT('2213'),                                   0909
*      2 * FIXED(31) INIT(DEV2213),                                0909
*      2 * CHAR(8) INIT('2265'),                                   0909
*      2 * FIXED(31) INIT(DEV2265),                                0909
*      2 * CHAR(8) INIT('2502'),                                   0909
*      2 * FIXED(31) INIT(DEV2502),                                0909
*      2 * CHAR(8) INIT('50'),                                     0909
*      2 * FIXED(31) INIT(DEV50),                                  0909
*      2 * CHAR(8) INIT('1255'),                                   0909
*      2 * FIXED(31) INIT(DEV1255),                                0909
*      2 * CHAR(8) INIT('5496'),                                   0909
*      2 * FIXED(31) INIT(DEV5496);                                0909
*                                                                  0909
*/* ATBUILD (ISTRDT)                                                 */
*/* END OF ATBUILD                                                   */
*                                                                  0910
*   RFY                                                            0910
*    (ISTRAP,                                                      0910
*     ISTRGP,                                                      0910
*     ISTRLC,                                                      0910
*     ISTRRN) BASED(CMZ00122);                                     0910
*   RFY                                                            0911
*     ISTRLN BASED(CMZ10122);                                      0911
*   RFY                                                            0912
*     ISTRCL BASED(CMZ20122);                                      0912
*   RFY                                                            0913
*     ISTRTR BASED(CMZ30122);                                      0913
*   RFY                                                            0914
*     ISTDEVCH BASED(CMZ40122);                                    0914
*   RFY                                                            0915
*     ISTRCC BASED(CMZ50122);                                      0915
*   RFY                                                            0916
*     ISTRLU BASED(CMZ60122);                                      0916
*   DCL                                                            0917
*    (CMZ00122 REG(6),              /* MLCPTR0                       */
*     CMZ10122 REG(7),              /* MLCPTR1                       */
*     CMZ20122 REG(8),              /* MLCPTR2                       */
*     CMZ30122 REG(9),              /* MLCPTR3                       */
*     CMZ40122 REG(10),             /* MLCPTR4                       */
*     CMZ50122 REG(11),             /* MLCPTR5                       */
*     CMZ60122 REG(12)) PTR;        /* MLCPTR6                       */
*   RFY                                                            0918
*    (CMZ00122,                                                    0918
*     CMZ10122,                                                    0918
*     CMZ20122,                                                    0918
*     CMZ30122,                                                    0918
*     CMZ40122,                                                    0918
*     CMZ50122,                                                    0918
*     CMZ60122) RSTD;                                              0918
*   DCL                                                            0919
*     CMZ22ON BIT(8) CONSTANT('11111111'B);                        0919
*   DCL                                                            0920
*     CMZ22OFF BIT(8) CONSTANT('00000000'B);                       0920
*ATNSUB:                                                           0921
*   GEN CODE NOREFS NODEFS(DC H'2');                               0921
ATNSUB   DC H'2'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0922
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'ENABLED');                       0923
         DC CL8'ENABLED'
*   RTRRAATN=CMZ22ON;                                              0924
         OI    RTRRAATN(CMZ30122),B'10000000'                      0924
*   GEN CODE NODEFS NOREFS(DC CL8'DISABLED');                      0925
         DC CL8'DISABLED'
*   RTRRAATN=CMZ22OFF;                                             0926
         NI    RTRRAATN(CMZ30122),B'01111111'                      0926
*CDTSUB:                                                           0927
*   GEN CODE NOREFS NODEFS(DC H'2');                               0927
CDTSUB   DC H'2'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0928
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'YES');                           0929
         DC CL8'YES'
*   RTRRACDT=CMZ22ON;                                              0930
         OI    RTRRACDT(CMZ30122),B'00001000'                      0930
*   GEN CODE NODEFS NOREFS(DC CL8'NO');                            0931
         DC CL8'NO'
*   RTRRACDT=CMZ22OFF;                                             0932
         NI    RTRRACDT(CMZ30122),B'11110111'                      0932
*CNVSUB:                                                           0933
*   GEN CODE NOREFS NODEFS(DC H'2');                               0933
CNVSUB   DC H'2'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0934
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'YES');                           0935
         DC CL8'YES'
*   DEVCONVR=CMZ22ON;                                              0936
         OI    DEVCONVR(CMZ40122),B'00100000'                      0936
*   GEN CODE NODEFS NOREFS(DC CL8'NO');                            0937
         DC CL8'NO'
*   DEVCONVR=CMZ22OFF;                                             0938
         NI    DEVCONVR(CMZ40122),B'11011111'                      0938
*ETRSUB:                                                           0939
*   GEN CODE NOREFS NODEFS(DC H'2');                               0939
ETRSUB   DC H'2'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0940
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'EOT');                           0941
         DC CL8'EOT'
*   RTRRBEND=CMZ22OFF;                                             0942
         NI    RTRRBEND(CMZ30122),B'10111111'                      0942
*   GEN CODE NODEFS NOREFS(DC CL8'EOB');                           0943
         DC CL8'EOB'
*   RTRRBEND=CMZ22ON;                                              0944
         OI    RTRRBEND(CMZ30122),B'01000000'                      0944
*EXCSUB:                                                           0945
*   GEN CODE NOREFS NODEFS(DC H'2');                               0945
EXCSUB   DC H'2'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0946
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'YES');                           0947
         DC CL8'YES'
*   RTRRDBHI=CMZ22ON;                                              0948
         OI    RTRRDBHI(CMZ30122),B'00100000'                      0948
*   GEN CODE NODEFS NOREFS(DC CL8'NO');                            0949
         DC CL8'NO'
*   RTRRDBHI=CMZ22OFF;                                             0950
         NI    RTRRDBHI(CMZ30122),B'11011111'                      0950
*FEASUB:                                                           0951
*   GEN CODE NOREFS NODEFS(DC H'14');                              0951
FEASUB   DC H'14'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0952
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'ACR');                           0953
         DC CL8'ACR'
*   RTRREACR=CMZ22ON;                                              0954
         OI    RTRREACR(CMZ30122),B'00100000'                      0954
*   GEN CODE NODEFS NOREFS(DC CL8'NOACR');                         0955
         DC CL8'NOACR'
*   RTRREACR=CMZ22OFF;                                             0956
         NI    RTRREACR(CMZ30122),B'11011111'                      0956
*   GEN CODE NODEFS NOREFS(DC CL8'ATTN');                          0957
         DC CL8'ATTN'
*   RTRREATT=CMZ22ON;                                              0958
         OI    RTRREATT(CMZ30122),B'00001000'                      0958
*   GEN CODE NODEFS NOREFS(DC CL8'NOATTN');                        0959
         DC CL8'NOATTN'
*   RTRREATT=CMZ22OFF;                                             0960
         NI    RTRREATT(CMZ30122),B'11110111'                      0960
*   GEN CODE NODEFS NOREFS(DC CL8'BREAK');                         0961
         DC CL8'BREAK'
*   RTRREBRK=CMZ22ON;                                              0962
         OI    RTRREBRK(CMZ30122),B'10000000'                      0962
*   GEN CODE NODEFS NOREFS(DC CL8'NOBREAK');                       0963
         DC CL8'NOBREAK'
*   RTRREBRK=CMZ22OFF;                                             0964
         NI    RTRREBRK(CMZ30122),B'01111111'                      0964
*   GEN CODE NODEFS NOREFS(DC CL8'CHECK');                         0965
         DC CL8'CHECK'
*   RTRRECHK=CMZ22ON;                                              0966
         OI    RTRRECHK(CMZ30122),B'00010000'                      0966
*   GEN CODE NODEFS NOREFS(DC CL8'NOCHECK');                       0967
         DC CL8'NOCHECK'
*   RTRRECHK=CMZ22OFF;                                             0968
         NI    RTRRECHK(CMZ30122),B'11101111'                      0968
*   GEN CODE NODEFS NOREFS(DC CL8'SCTL');                          0969
         DC CL8'SCTL'
*   RTRRESCT=CMZ22ON;                                              0970
         OI    RTRRESCT(CMZ30122),B'00000010'                      0970
*   GEN CODE NODEFS NOREFS(DC CL8'NOSCTL');                        0971
         DC CL8'NOSCTL'
*   RTRRESCT=CMZ22OFF;                                             0972
         NI    RTRRESCT(CMZ30122),B'11111101'                      0972
*   GEN CODE NODEFS NOREFS(DC CL8'TOSUPPR');                       0973
         DC CL8'TOSUPPR'
*   RTRRESUP=CMZ22ON;                                              0974
         OI    RTRRESUP(CMZ30122),B'00000100'                      0974
*   GEN CODE NODEFS NOREFS(DC CL8'NOTOSUP');                       0975
         DC CL8'NOTOSUP'
*   RTRRESUP=CMZ22OFF;                                             0976
         NI    RTRRESUP(CMZ30122),B'11111011'                      0976
*   GEN CODE NODEFS NOREFS(DC CL8'XCTL');                          0977
         DC CL8'XCTL'
*   RTRRFXCT=CMZ22ON;                                              0978
         OI    RTRRFXCT(CMZ30122),B'10000000'                      0978
*   GEN CODE NODEFS NOREFS(DC CL8'NOXCTL');                        0979
         DC CL8'NOXCTL'
*   RTRRFXCT=CMZ22OFF;                                             0980
         NI    RTRRFXCT(CMZ30122),B'01111111'                      0980
*FT2SUB:                                                           0981
*   GEN CODE NOREFS NODEFS(DC H'12');                              0981
FT2SUB   DC H'12'
*   GEN CODE NOREFS NODEFS(DC H'12');                              0982
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'SELPEN');                        0983
         DC CL8'SELPEN'
*   RTRRFPEN=CMZ22ON;                                              0984
         OI    RTRRFPEN(CMZ30122),B'01000000'                      0984
*   GEN CODE NODEFS NOREFS(DC CL8'NOSELPEN');                      0985
         DC CL8'NOSELPEN'
*   RTRRFPEN=CMZ22OFF;                                             0986
         NI    RTRRFPEN(CMZ30122),B'10111111'                      0986
*   GEN CODE NODEFS NOREFS(DC CL8'PFK');                           0987
         DC CL8'PFK'
*   RTRRFPFK=CMZ22ON;                                              0988
         OI    RTRRFPFK(CMZ30122),B'00100000'                      0988
*   GEN CODE NODEFS NOREFS(DC CL8'NOPFK');                         0989
         DC CL8'NOPFK'
*   RTRRFPFK=CMZ22OFF;                                             0990
         NI    RTRRFPFK(CMZ30122),B'11011111'                      0990
*   GEN CODE NODEFS NOREFS(DC CL8'ANKEY');                         0991
         DC CL8'ANKEY'
*   RTRRFANK=CMZ22ON;                                              0992
         OI    RTRRFANK(CMZ30122),B'00010000'                      0992
*   GEN CODE NODEFS NOREFS(DC CL8'NOANKEY');                       0993
         DC CL8'NOANKEY'
*   RTRRFANK=CMZ22OFF;                                             0994
         NI    RTRRFANK(CMZ30122),B'11101111'                      0994
*   GEN CODE NODEFS NOREFS(DC CL8'DEKEY');                         0995
         DC CL8'DEKEY'
*   RTRRFDEK=CMZ22ON;                                              0996
         OI    RTRRFDEK(CMZ30122),B'00001000'                      0996
*   GEN CODE NODEFS NOREFS(DC CL8'NODEKEY');                       0997
         DC CL8'NODEKEY'
*   RTRRFDEK=CMZ22OFF;                                             0998
         NI    RTRRFDEK(CMZ30122),B'11110111'                      0998
*   GEN CODE NODEFS NOREFS(DC CL8'PRINTR');                        0999
         DC CL8'PRINTR'
*   DEVSPS=CMZ22ON;                                                1000
         OI    DEVSPS(CMZ40122),B'00001000'                        1000
*   GEN CODE NODEFS NOREFS(DC CL8'NOPRINTR');                      1001
         DC CL8'NOPRINTR'
*   DEVSPS=CMZ22OFF;                                               1002
         NI    DEVSPS(CMZ40122),B'11110111'                        1002
*   GEN CODE NODEFS NOREFS(DC CL8'MODEL1');                        1003
         DC CL8'MODEL1'
*   DEVMCODE=DEVMOD1;                                              1004
         MVI   DEVMCODE(CMZ40122),X'00'                            1004
*   GEN CODE NODEFS NOREFS(DC CL8'MODEL2');                        1005
         DC CL8'MODEL2'
*   DEVMCODE=DEVMOD2;                                              1006
         MVI   DEVMCODE(CMZ40122),X'01'                            1006
*ISTSUB:                                                           1007
*   GEN CODE NOREFS NODEFS(DC H'3');                               1007
ISTSUB   DC H'3'
*   GEN CODE NOREFS NODEFS(DC H'12');                              1008
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'ACTIVE');                        1009
         DC CL8'ACTIVE'
*   RTRRBISA=CMZ22ON;                                              1010
         OI    RTRRBISA(CMZ30122),B'01000000'                      1010
*   GEN CODE NODEFS NOREFS(DC CL8'INACTIVE');                      1011
         DC CL8'INACTIVE'
*   RTRRBISA=CMZ22OFF;                                             1012
         NI    RTRRBISA(CMZ30122),B'10111111'                      1012
*   GEN CODE NODEFS NOREFS(DC CL8'WAIT');                          1013
         DC CL8'WAIT'
*   GEN CODE NODEFS NOREFS(DC XL4'0');                             1014
         DC XL4'0'
*PT3SUB:                                                           1015
*   GEN CODE NOREFS NODEFS(DC H'2');                               1015
PT3SUB   DC H'2'
*   GEN CODE NOREFS NODEFS(DC H'12');                              1016
         DC H'12'
*   GEN CODE NODEFS NOREFS(DC CL8'YES');                           1017
         DC CL8'YES'
*   RTRRCPT3=CMZ22ON;                                              1018
         OI    RTRRCPT3(CMZ30122),B'00100000'                      1018
*   GEN CODE NODEFS NOREFS(DC CL8'NO');                            1019
         DC CL8'NO'
*   RTRRCPT3=CMZ22OFF;                                             1020
*                                                                  1020
         NI    RTRRCPT3(CMZ30122),B'11011111'                      1020
*/* TPEPILOG                                                         */
*                                                                  1021
*   GEN(PRINT OFF);                                                1021
         PRINT OFF
*   GEN(PRINT ON);                                                 1022
*                                                                  1022
         PRINT ON
*/* END OF TPEPILOG                                                  */
*                                                                  1023
*   END ISTSDCTM;                                                  1023
@EL00001 DS    0H                                                  1023
@EF00001 DS    0H                                                  1023
@ER00001 LM    @14,@12,12(@13)                                     1023
         BR    @14                                                 1023
@DATA    DS    0H
@CH00052 DC    H'4'
@CH00036 DC    H'8'
@CH00033 DC    H'12'
@SM01896 MVC   RTRCADDR(0,@07),ADDRCHAR(@03)
@SM01899 MVC   T2980AD(0),ADDRCHA2(@04)
@SM01902 MVC   DIALXTSN(0,GPR1),DIALCHAR(@07)
@SM01905 MVC   POLLEXT(0,GPR1),POLLCHAR(@09)
@DATD    DSECT
         DS    0F
ISTSDCTM CSECT
         DS    0F
@CF00039 DC    F'1'
@CF00180 DC    F'2'
@CF01450 DC    XL4'FFFFFFFF'
@DATD    DSECT
         DS    0D
KWDPTR   DS    A
TRMTEMP  DS    A
KWTBLAD  DS    A
CVBNUM   DS    FL4
         ORG   CVBNUM
@NM00017 DS    CL3
CVBNUM2  DS    AL1
         ORG   CVBNUM+4
RC       DS    H
T2980CT  DS    H
TERMSW   DS    CL1
         ORG   TERMSW
CTERMSW  DS    BL1
GETSW    EQU   TERMSW+0
TMID2    EQU   TERMSW+0
@NM00016 EQU   TERMSW+0
         ORG   TERMSW+1
LCLFPRNT DS    BL1
         ORG   LCLFPRNT
LCLFADDR DS    BL1
LCLFBHST EQU   LCLFPRNT+0
DIALOUT  EQU   LCLFPRNT+0
LCLFNODE EQU   LCLFPRNT+0
LCLFPOLL EQU   LCLFPRNT+0
TMID     EQU   LCLFPRNT+0
         ORG   LCLFPRNT+1
T2980AD  DS    CL2
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISTSDCTM CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01248 DC    V(ISTINCPH)
@CV01249 DC    V(ISTSDCC1)
@CV01250 DC    V(ISTSDCP2)
@CV01251 DC    V(ISTSDCP5)
@CV01252 DC    V(ISTSDCC4)
@CV01253 DC    V(ISTSDCRS)
@CV01299 DC    V(ISTSDCC2)
@CV01442 DC    V(ISTSDCC5)
@CV01541 DC    V(ISTSDCI4)
@CV01543 DC    V(ISTSDCR1)
@CV01542 DC    V(ISTSDCC6)
         DS    0D
@CC01247 DC    C'        '
@CC01290 DC    C'VTERM   '
@CC01377 DC    C'NONE    '
@CC01378 DC    C'DYNAMIC '
@CC01436 DC    C'000000NO'
@CC01457 DC    C'COMP    '
CMZP0004 DS    CL4
         ORG   CMZP0004
CMZL0004 DC    AL1(3)
CMZE0004 DC    AL1(5)
CMZA0004 DC    CL1'6'
CMZS0004 DC    AL1(0)
         ORG   CMZP0004+4
VTRKWTBL DS    CL69
         ORG   VTRKWTBL
@NM00134 DC    H'5'
@NM00135 DC    H'13'
@NM00136 DC    CL8'BUFLIM'
@NM00137 DC    XL1'07'
@NM00138 DC    AL4(TRMBFLIM)
@NM00139 DC    CL8'LCST'
@NM00140 DC    XL1'33'
@NM00141 DC    VL4(ISTSDCP2)
@NM00142 DC    CL8'LOGAPPL'
@NM00143 DC    XL1'33'
@NM00144 DC    AL4(TRMLGAPL)
@NM00145 DC    CL8'LOGTAB'
@NM00146 DC    XL1'33'
@NM00147 DC    AL4(TRMLGTAB)
@NM00148 DC    CL8'SPAN'
@NM00149 DC    XL1'06'
@NM00150 DC    VL4(ISTSDCR1)
         ORG   VTRKWTBL+69
         DS    CL3
TRMKWTBL DS    CL498
         ORG   TRMKWTBL
@NM00018 DC    H'38'
@NM00019 DC    H'13'
@NM00020 DC    CL8'ADDR'
@NM00021 DC    XL1'05'
@NM00022 DC    AL4(TRMADDR)
@NM00023 DC    CL8'ATTN'
@NM00024 DC    XL1'02'
@NM00025 DC    AL4(TRMATN)
@NM00026 DC    CL8'BFRDLAY'
@NM00027 DC    XL1'06'
@NM00028 DC    VL4(ISTSDCR1)
@NM00029 DC    CL8'BHEXEC'
@NM00030 DC    XL1'06'
@NM00031 DC    VL4(ISTSDCR1)
@NM00032 DC    CL8'BHSET'
@NM00033 DC    XL1'33'
@NM00034 DC    AL4(TRMBHSET)
@NM00035 DC    CL8'BUFLIM'
@NM00036 DC    XL1'07'
@NM00037 DC    AL4(TRMBFLIM)
@NM00038 DC    CL8'CDATA'
@NM00039 DC    XL1'02'
@NM00040 DC    AL4(TRMCDT)
@NM00041 DC    CL8'CONV'
@NM00042 DC    XL1'02'
@NM00043 DC    AL4(TRMCNV)
@NM00044 DC    CL8'CRDLAY'
@NM00045 DC    XL1'06'
@NM00046 DC    VL4(ISTSDCR1)
@NM00047 DC    CL8'CRITSIT'
@NM00048 DC    XL1'06'
@NM00049 DC    VL4(ISTSDCR1)
@NM00050 DC    CL8'CTERM'
@NM00051 DC    XL1'02'
@NM00052 DC    AL4(TRMCTR)
@NM00053 DC    CL8'CUIDLEN'
@NM00054 DC    XL1'06'
@NM00055 DC    VL4(ISTSDCR1)
@NM00056 DC    CL8'DEVICE'
@NM00057 DC    XL1'02'
@NM00058 DC    AL4(TRMDEV)
@NM00059 DC    CL8'DIALNO'
@NM00060 DC    XL1'05'
@NM00061 DC    AL4(TRMDILNO)
@NM00062 DC    CL8'DIALSET'
@NM00063 DC    XL1'33'
@NM00064 DC    VL4(ISTSDCP5)
@NM00065 DC    CL8'DIRECTN'
@NM00066 DC    XL1'02'
@NM00067 DC    AL4(TRMDIR)
@NM00068 DC    CL8'DLOGMOD'
@NM00069 DC    XL1'06'
@NM00070 DC    VL4(ISTSDCR1)
@NM00071 DC    CL8'EXEC'
@NM00072 DC    XL1'02'
@NM00073 DC    AL4(TRMEXC)
@NM00074 DC    CL8'ENDTRNS'
@NM00075 DC    XL1'02'
@NM00076 DC    AL4(TRMETR)
@NM00077 DC    CL8'FANOUT'
@NM00078 DC    XL1'06'
@NM00079 DC    VL4(ISTSDCR1)
@NM00080 DC    CL8'FEATURE'
@NM00081 DC    XL1'02'
@NM00082 DC    AL4(TRMFEA)
@NM00083 DC    CL8'FEATUR2'
@NM00084 DC    XL1'02'
@NM00085 DC    AL4(TRMFT2)
@NM00086 DC    CL8'IDSEQ'
@NM00087 DC    XL1'06'
@NM00088 DC    VL4(ISTSDCR1)
@NM00089 DC    CL8'INHIBIT'
@NM00090 DC    XL1'06'
@NM00091 DC    VL4(ISTSDCR1)
@NM00092 DC    CL8'ISTATUS'
@NM00093 DC    XL1'02'
@NM00094 DC    AL4(TRMIST)
@NM00095 DC    CL8'ITBMODE'
@NM00096 DC    XL1'02'
@NM00097 DC    AL4(TRMITB)
@NM00098 DC    CL8'LCST'
@NM00099 DC    XL1'06'
@NM00100 DC    VL4(ISTSDCR1)
@NM00101 DC    CL8'LGRAPHS'
@NM00102 DC    XL1'06'
@NM00103 DC    VL4(ISTSDCR1)
@NM00104 DC    CL8'LOGAPPL'
@NM00105 DC    XL1'33'
@NM00106 DC    AL4(TRMLGAPL)
@NM00107 DC    CL8'LOGTAB'
@NM00108 DC    XL1'33'
@NM00109 DC    AL4(TRMLGTAB)
@NM00110 DC    CL8'MODETAB'
@NM00111 DC    XL1'06'
@NM00112 DC    VL4(ISTSDCR1)
@NM00113 DC    CL8'POLL'
@NM00114 DC    XL1'01'
@NM00115 DC    AL4(TRMPOLL)
@NM00116 DC    CL8'PT3EXEC'
@NM00117 DC    XL1'02'
@NM00118 DC    AL4(TRMPT3)
@NM00119 DC    CL8'SPAN'
@NM00120 DC    XL1'06'
@NM00121 DC    VL4(ISTSDCR1)
@NM00122 DC    CL8'TERM'
@NM00123 DC    XL1'02'
@NM00124 DC    VL4(ISTSDCI4)
@NM00125 DC    CL8'USSTAB'
@NM00126 DC    XL1'06'
@NM00127 DC    VL4(ISTSDCR1)
@NM00128 DC    CL8'UTERM'
@NM00129 DC    XL1'33'
@NM00130 DC    AL4(TRMUTERM)
@NM00131 DC    CL8'XMITLIM'
@NM00132 DC    XL1'44'
@NM00133 DC    AL4(TRMXMTLM)
         ORG   TRMKWTBL+498
CMZP0009 DS    CL4
         ORG   CMZP0009
CMZL0009 DC    AL1(4)
CMZE0009 DC    AL1(4)
CMZA0009 DC    CL1'1'
CMZS0009 DC    AL1(0)
         ORG   CMZP0009+4
CMZP0010 DS    CL4
         ORG   CMZP0010
CMZL0010 DC    AL1(4)
CMZE0010 DC    AL1(6)
CMZA0010 DC    CL1'6'
CMZS0010 DC    AL1(0)
         ORG   CMZP0010+4
CMZP0011 DS    CL4
         ORG   CMZP0011
CMZL0011 DC    AL1(4)
CMZE0011 DC    AL1(4)
CMZA0011 DC    CL1'6'
CMZS0011 DC    AL1(0)
         ORG   CMZP0011+4
CMZP0012 DS    CL4
         ORG   CMZP0012
CMZL0012 DC    AL1(4)
CMZE0012 DC    AL1(1)
CMZA0012 DC    CL1'1'
CMZS0012 DC    AL1(0)
         ORG   CMZP0012+4
CMZP0013 DS    CL4
         ORG   CMZP0013
CMZL0013 DC    AL1(5)
CMZE0013 DC    AL1(4)
CMZA0013 DC    CL1'2'
CMZS0013 DC    AL1(0)
         ORG   CMZP0013+4
CMZP0014 DS    CL4
         ORG   CMZP0014
CMZL0014 DC    AL1(5)
CMZE0014 DC    AL1(7)
CMZA0014 DC    CL1'1'
CMZS0014 DC    AL1(0)
         ORG   CMZP0014+4
CMZP0015 DS    CL4
         ORG   CMZP0015
CMZL0015 DC    AL1(4)
CMZE0015 DC    AL1(4)
CMZA0015 DC    CL1'1'
CMZS0015 DC    AL1(0)
         ORG   CMZP0015+4
CMZP0016 DS    CL4
         ORG   CMZP0016
CMZL0016 DC    AL1(4)
CMZE0016 DC    AL1(4)
CMZA0016 DC    CL1'1'
CMZS0016 DC    AL1(0)
         ORG   CMZP0016+4
CMZP0017 DS    CL4
         ORG   CMZP0017
CMZL0017 DC    AL1(5)
CMZE0017 DC    AL1(4)
CMZA0017 DC    CL1'2'
CMZS0017 DC    AL1(0)
         ORG   CMZP0017+4
CMZP0018 DS    CL4
         ORG   CMZP0018
CMZL0018 DC    AL1(4)
CMZE0018 DC    AL1(3)
CMZA0018 DC    CL1'6'
CMZS0018 DC    AL1(0)
         ORG   CMZP0018+4
CMZP0019 DS    CL4
         ORG   CMZP0019
CMZL0019 DC    AL1(4)
CMZE0019 DC    AL1(4)
CMZA0019 DC    CL1'6'
CMZS0019 DC    AL1(0)
         ORG   CMZP0019+4
CMZP0020 DS    CL4
         ORG   CMZP0020
CMZL0020 DC    AL1(4)
CMZE0020 DC    AL1(4)
CMZA0020 DC    CL1'6'
CMZS0020 DC    AL1(0)
         ORG   CMZP0020+4
CMZP0021 DS    CL9
         ORG   CMZP0021
CMZL0021 DC    AL1(4)
CMZE0021 DC    AL1(2)
CMZA0021 DC    CL1'6'
CMZS0021 DC    AL1(5)
CMZM0021 DC    CL5'UTERM'
         ORG   CMZP0021+9
CMZP0023 DS    CL4
         ORG   CMZP0023
CMZL0023 DC    AL1(3)
CMZE0023 DC    AL1(2)
CMZA0023 DC    CL1'6'
CMZS0023 DC    AL1(0)
         ORG   CMZP0023+4
CMZP0030 DS    CL11
         ORG   CMZP0030
CMZL0030 DC    AL1(5)
CMZE0030 DC    AL1(2)
CMZA0030 DC    CL1'6'
CMZS0030 DC    AL1(7)
CMZM0030 DC    CL7'POLIMIT'
         ORG   CMZP0030+11
CMZP0031 DS    CL11
         ORG   CMZP0031
CMZL0031 DC    AL1(5)
CMZE0031 DC    AL1(2)
CMZA0031 DC    CL1'6'
CMZS0031 DC    AL1(7)
CMZM0031 DC    CL7'POLIMIT'
         ORG   CMZP0031+11
         DS    CL3
TRMIPB   DS    CL108
         ORG   TRMIPB
@NM00151 DC    H'13'
@NM00152 DC    H'8'
TRMATN   DC    VL4(ISTSDCC5)
@NM00153 DC    AL4(ATNSUB)
TRMCDT   DC    VL4(ISTSDCC5)
@NM00154 DC    AL4(CDTSUB)
TRMCNV   DC    VL4(ISTSDCC5)
@NM00155 DC    AL4(CNVSUB)
TRMCTR   DC    AL4(TRMCTERM)
@NM00156 DC    AL4(CTRSUB)
TRMDEV   DC    AL4(TRMDEVIC)
@NM00157 DC    AL4(DEVSUB)
TRMDIR   DC    AL4(TRMDRCTN)
@NM00158 DC    AL4(DIRSUB)
TRMETR   DC    VL4(ISTSDCC5)
@NM00159 DC    AL4(ETRSUB)
TRMEXC   DC    VL4(ISTSDCC5)
@NM00160 DC    AL4(EXCSUB)
TRMFEA   DC    AL4(TRMFEATR)
@NM00161 DC    AL4(FEASUB)
TRMFT2   DC    AL4(TRMFEAT2)
@NM00162 DC    AL4(FT2SUB)
TRMIST   DC    VL4(ISTSDCC5)
@NM00163 DC    AL4(ISTSUB)
TRMITB   DC    AL4(TRMITBMD)
@NM00164 DC    AL4(ITBSUB)
TRMPT3   DC    VL4(ISTSDCC5)
@NM00165 DC    AL4(PT3SUB)
         ORG   TRMIPB+108
CTRSUB   DS    CL28
         ORG   CTRSUB
@NM00180 DC    H'2'
@NM00181 DC    H'12'
@NM00182 DC    CL8'YES'
@NM00183 DC    F'1'
@NM00184 DC    CL8'NO'
@NM00185 DC    F'0'
         ORG   CTRSUB+28
DEVSUB   DS    CL232
         ORG   DEVSUB
@NM00186 DC    H'19'
@NM00187 DC    H'12'
@NM00188 DC    CL8'1052'
@NM00189 DC    XL4'64'
@NM00190 DC    CL8'1053'
@NM00191 DC    XL4'65'
@NM00192 DC    CL8'1054'
@NM00193 DC    XL4'66'
@NM00194 DC    CL8'1055'
@NM00195 DC    XL4'67'
@NM00196 DC    CL8'1056'
@NM00197 DC    XL4'68'
@NM00198 DC    CL8'1057'
@NM00199 DC    XL4'69'
@NM00200 DC    CL8'1058'
@NM00201 DC    XL4'6A'
@NM00202 DC    CL8'1092'
@NM00203 DC    XL4'6B'
@NM00204 DC    CL8'1093'
@NM00205 DC    XL4'6C'
@NM00206 DC    CL8'545'
@NM00207 DC    XL4'78'
@NM00208 DC    CL8'1017'
@NM00209 DC    XL4'79'
@NM00210 DC    CL8'1018'
@NM00211 DC    XL4'7A'
@NM00212 DC    CL8'2203'
@NM00213 DC    XL4'7B'
@NM00214 DC    CL8'2213'
@NM00215 DC    XL4'7C'
@NM00216 DC    CL8'2265'
@NM00217 DC    XL4'7D'
@NM00218 DC    CL8'2502'
@NM00219 DC    XL4'7E'
@NM00220 DC    CL8'50'
@NM00221 DC    XL4'7F'
@NM00222 DC    CL8'1255'
@NM00223 DC    XL4'80'
@NM00224 DC    CL8'5496'
@NM00225 DC    XL4'81'
         ORG   DEVSUB+232
DIRSUB   DS    CL40
         ORG   DIRSUB
@NM00166 DC    H'3'
@NM00167 DC    H'12'
@NM00168 DC    CL8'IN'
@NM00169 DC    F'1'
@NM00170 DC    CL8'OUT'
@NM00171 DC    F'2'
@NM00172 DC    CL8'INOUT'
@NM00173 DC    F'0'
         ORG   DIRSUB+40
ITBSUB   DS    CL28
         ORG   ITBSUB
@NM00174 DC    H'2'
@NM00175 DC    H'12'
@NM00176 DC    CL8'YES'
@NM00177 DC    F'1'
@NM00178 DC    CL8'NO'
@NM00179 DC    F'0'
         ORG   ITBSUB+28
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GPR0     EQU   @00
GPR1     EQU   @01
PHR1REG  EQU   @02
MLCAREG  EQU   @05
RNCAREG  EQU   @06
DATDREG  EQU   @11
GPR13    EQU   @13
GPR14    EQU   @14
GPR15    EQU   @15
CMZR0004 EQU   @01
CMZR0009 EQU   @01
CMZR0010 EQU   @01
CMZR0011 EQU   @01
CMZR0012 EQU   @01
CMZR0013 EQU   @01
CMZR0014 EQU   @01
CMZR0015 EQU   @01
CMZR0016 EQU   @01
CMZR0017 EQU   @01
CMZR0018 EQU   @01
CMZR0019 EQU   @01
CMZR0020 EQU   @01
CMZR0021 EQU   @01
CMZR0023 EQU   @01
CMZR0030 EQU   @01
CMZR0031 EQU   @01
CMZ00122 EQU   @06
CMZ10122 EQU   @07
CMZ20122 EQU   @08
CMZ30122 EQU   @09
CMZ40122 EQU   @10
CMZ50122 EQU   @11
CMZ60122 EQU   @12
POLLSTRL EQU   @03
ISTDEVCH EQU   0
DEVSHCH  EQU   ISTDEVCH
DEVCHAR  EQU   DEVSHCH
DEVINPUT EQU   DEVCHAR
DEVOTPUT EQU   DEVCHAR
DEVCONVR EQU   DEVCHAR
DEVSUBND EQU   DEVCHAR
DEVSPS   EQU   DEVCHAR
DEVCCTL  EQU   DEVCHAR
DEVTCODE EQU   ISTDEVCH+1
DEVMCODE EQU   ISTDEVCH+2
DEVFLAGS EQU   ISTDEVCH+3
DEVFCCTL EQU   DEVFLAGS
DEVCBSC  EQU   DEVFCCTL
DEVCSSL  EQU   DEVFCCTL
DEVCRVB  EQU   DEVFCCTL
DEVCSWL  EQU   DEVFCCTL
DEVCHAR3 EQU   DEVFLAGS
DEVCATTN EQU   DEVCHAR3
DEVCCHEK EQU   DEVCHAR3
DEVCSTCL EQU   DEVCHAR3
DEVCSLPN EQU   DEVCHAR3
DEVPHYSA EQU   ISTDEVCH+4
ISTLOK   EQU   0
LOKCHN   EQU   ISTLOK+1
LOKCHNG  EQU   LOKCHN
@NM00002 EQU   LOKCHNG+2
ISTRPRE  EQU   0
RPRNAME  EQU   ISTRPRE
RPRCOMID EQU   ISTRPRE+8
RPRENTRY EQU   ISTRPRE+20
RPRFLAGA EQU   ISTRPRE+21
RPRFLAGB EQU   ISTRPRE+22
RPRAOPN  EQU   RPRFLAGB
RPRCAUSE EQU   ISTRPRE+23
RPRNSNEA EQU   ISTRPRE+36
RPRDEVCH EQU   ISTRPRE+44
RPRFLAGD EQU   ISTRPRE+61
RPRFLAGC EQU   ISTRPRE+62
ISTRCPRE EQU   0
RCPBFLIM EQU   ISTRCPRE+90
RCPPMODE EQU   ISTRCPRE+91
RCPLGNIN EQU   ISTRCPRE+92
RCPLGNAP EQU   RCPLGNIN
RCPLGNCT EQU   RCPLGNIN+8
ISTRDT   EQU   0
RDTPLEN  EQU   ISTRDT+72
RDTPRIOR EQU   RDTPLEN
RDTFLAGB EQU   ISTRDT+91
RDTVYRPH EQU   ISTRDT+108
RDTSTCNT EQU   ISTRDT+112
ISTRAP   EQU   0
RAPFLG   EQU   ISTRAP+108
RAPFLGB  EQU   ISTRAP+109
RAPFLGC  EQU   ISTRAP+110
ISTRLC   EQU   0
RLCADR   EQU   ISTRLC+72
RLCFLAG  EQU   RLCADR
ISTRRN   EQU   0
RRNADR   EQU   ISTRRN+136
RRNFLAG  EQU   RRNADR
RRNUCBAD EQU   RRNADR+1
RRNCTETR EQU   ISTRRN+164
RRNCTECM EQU   ISTRRN+168
RRNRDF   EQU   ISTRRN+172
RRNRDFA  EQU   RRNRDF
RRNRDFB  EQU   RRNRDF+1
RRNCMF   EQU   ISTRRN+176
RRNCMFA  EQU   RRNCMF
RRNCAMBH EQU   RRNCMFA
RRNCMFB  EQU   RRNCMF+1
RRNCMFC  EQU   RRNCMF+2
RRNCMFD  EQU   RRNCMF+3
RRNNMDPD EQU   ISTRRN+192
RRNHPRE  EQU   ISTRRN+216
ISTRGP   EQU   0
RGPFLG   EQU   ISTRGP+72
RGPADIL  EQU   RGPFLG
RGPASS   EQU   RGPFLG
RGPABSC  EQU   RGPFLG
RGPCTETR EQU   ISTRGP+78
RGPCTECM EQU   ISTRGP+82
ISTRLN   EQU   0
RLNADR   EQU   ISTRLN+72
RLNFLAG  EQU   RLNADR
RLNUCBAD EQU   RLNADR+1
RLNCTETR EQU   ISTRLN+78
RLNCTECM EQU   ISTRLN+82
RLNSTAT1 EQU   ISTRLN+86
RLNSTAT2 EQU   ISTRLN+87
RLNRDF   EQU   ISTRLN+88
RLNRDFA  EQU   RLNRDF
RLNRACNT EQU   RLNRDFA
RLNRACAN EQU   RLNRACNT
RLNPORT  EQU   RLNRDFA
RLNRDFB  EQU   RLNRDF+1
RLNMULTP EQU   RLNRDFB
RLNCRFLG EQU   ISTRLN+102
RLNLSCMD EQU   RLNCRFLG
ISTRPT   EQU   0
RPTLNCID EQU   ISTRPT+116
RPTCTNM  EQU   ISTRPT+120
RPTDITT  EQU   ISTRPT+128
RPTFLAG1 EQU   ISTRPT+140
RPTDYNAM EQU   RPTFLAG1
RPTISTAT EQU   RPTFLAG1
ISTRCL   EQU   0
RCLADR   EQU   ISTRCL+72
RCLFLAG  EQU   RCLADR
RCLCTETR EQU   ISTRCL+76
ISTRTR   EQU   0
RTRADR   EQU   ISTRTR+124
RTRFLAG  EQU   RTRADR
RTRRBISA EQU   RTRFLAG
RTRVTERM EQU   RTRFLAG
RTRCTECM EQU   ISTRTR+128
RTRRDFA  EQU   ISTRTR+136
RTRRAATN EQU   RTRRDFA
RTRRAALL EQU   RTRRDFA
RTRRACDT EQU   RTRRDFA
RTRRDFB  EQU   ISTRTR+137
RTRRBEND EQU   RTRRDFB
RTRRDFC  EQU   ISTRTR+138
RTRRCIT1 EQU   RTRRDFC
RTRRCIT2 EQU   RTRRDFC
RTRRCPT3 EQU   RTRRDFC
RTRRDFD  EQU   ISTRTR+139
RTRRDBHN EQU   RTRRDFD
RTRRDBHD EQU   RTRRDFD
RTRRDBHI EQU   RTRRDFD
RTRRDFE  EQU   ISTRTR+140
RTRREBRK EQU   RTRRDFE
RTRREACR EQU   RTRRDFE
RTRRECHK EQU   RTRRDFE
RTRREATT EQU   RTRRDFE
RTRRESUP EQU   RTRRDFE
RTRRESCT EQU   RTRRDFE
RTRRDFF  EQU   ISTRTR+141
RTRRFXCT EQU   RTRRDFF
RTRRFPEN EQU   RTRRDFF
RTRRFPFK EQU   RTRRDFF
RTRRFANK EQU   RTRRDFF
RTRRFDEK EQU   RTRRDFF
RTRTRMAX EQU   ISTRTR+142
RTRCRFLG EQU   ISTRTR+143
RTRLSCMD EQU   RTRCRFLG
RTRBHSN1 EQU   ISTRTR+144
RTRCTDIA EQU   ISTRTR+158
RTRCTPOL EQU   ISTRTR+160
RTRCTADR EQU   ISTRTR+162
RTRCADDR EQU   ISTRTR+164
RTRPOLA  EQU   ISTRTR+172
RTRDIAA  EQU   ISTRTR+176
RTRBSCID EQU   ISTRTR+188
ISTRIN   EQU   0
RINDFD   EQU   ISTRIN+124
RINREMPO EQU   RINDFD
RINNODEF EQU   RINDFD
RINLDISC EQU   RINDFD
RINNODID EQU   ISTRIN+125
RINRLDAF EQU   ISTRIN+126
RINREMOT EQU   ISTRIN+128
RINVPAB  EQU   ISTRIN+132
RINRPHCN EQU   ISTRIN+136
RINNCSPL EQU   ISTRIN+140
RINCNCNT EQU   ISTRIN+144
ISTRDS   EQU   0
RDSCTTRM EQU   ISTRDS+72
ISTDOT   EQU   0
ISTRCC   EQU   0
RCCFLAG  EQU   ISTRCC+73
RCCFLAGB EQU   ISTRCC+74
RCCSTAID EQU   ISTRCC+78
RCCID48  EQU   RCCSTAID+2
RCCCRFLG EQU   ISTRCC+108
ISTRLU   EQU   0
RLUFLAG  EQU   ISTRLU+125
RLUCRFLG EQU   ISTRLU+126
RLUPACE  EQU   ISTRLU+132
RLUNCPPC EQU   ISTRLU+134
RLUUSSTB EQU   ISTRLU+140
RLUMODET EQU   ISTRLU+152
ISTRPX   EQU   0
ISTRLX   EQU   0
RLXFLAGA EQU   ISTRLX+76
ISTRSW   EQU   0
ISTRDA   EQU   0
RDAADR   EQU   ISTRDA+72
RDAFLAG  EQU   RDAADR
RDAUCBAD EQU   RDAADR+1
ISTRLS   EQU   0
ISTDNT   EQU   0
ISTGNT   EQU   0
ISTPAT   EQU   0
PATFLAGA EQU   ISTPAT+7
ISTPHROA EQU   0
PHROADTA EQU   ISTPHROA+4
ISTMLCA  EQU   0
MLCFLAGS EQU   ISTMLCA+16
MLCENT   EQU   ISTMLCA+20
MLCKWD   EQU   ISTMLCA+24
MLCERBF  EQU   ISTMLCA+28
MLCERBF1 EQU   MLCERBF
MLCERBF2 EQU   MLCERBF+8
MLCNAME  EQU   MLCERBF2
MLCMACRO EQU   MLCERBF2+8
MLCERBF3 EQU   MLCERBF+32
MLCPTRS  EQU   ISTMLCA+96
MLCPTR3  EQU   MLCPTRS+12
MLCPTR4  EQU   MLCPTRS+16
MLCSAV3  EQU   ISTMLCA+396
MLCADSAV EQU   ISTMLCA+652
MLCADDAT EQU   ISTMLCA+724
MLCWRK1  EQU   ISTMLCA+964
MLCWRK2  EQU   ISTMLCA+1220
MLCOCPRM EQU   MLCWRK2
MLCWRK3  EQU   ISTMLCA+1284
MLCRDPRM EQU   MLCWRK3
MLCWRK4  EQU   ISTMLCA+1348
MLCTPMSG EQU   MLCWRK4
MLCDECB2 EQU   MLCTPMSG+32
ISTRNCA  EQU   0
RNCRN    EQU   ISTRNCA
RNCGP    EQU   ISTRNCA+16
RNCLN    EQU   ISTRNCA+20
RNCCL    EQU   ISTRNCA+24
RNCTR    EQU   ISTRNCA+32
RNCCM    EQU   ISTRNCA+44
RNCGCLUS EQU   ISTRNCA+122
RNCGTERM EQU   ISTRNCA+123
RNCGCOMP EQU   ISTRNCA+123
RNCGCTRM EQU   ISTRNCA+123
RNCDTYPE EQU   ISTRNCA+124
RNCLQUE  EQU   ISTRNCA+125
RNCLNOW  EQU   ISTRNCA+125
RNCRNMDL EQU   ISTRNCA+2984
RNCTRMDL EQU   RNCRNMDL
RNCLUMDL EQU   RNCTRMDL
RNCLNMDL EQU   RNCLUMDL
RNCSWMDL EQU   RNCLNMDL
RNCLSMDL EQU   RNCSWMDL
RNCCLMDL EQU   RNCLSMDL
RNCDAMDL EQU   RNCCLMDL
RNCCMMDL EQU   ISTRNCA+3240
RNCINMDL EQU   RNCCMMDL
RNCCCMDL EQU   RNCINMDL
RNCGPMDL EQU   RNCCCMDL
RNCPXMDL EQU   RNCGPMDL
RNCSAV1  EQU   ISTRNCA+3460
RNCDAT1  EQU   ISTRNCA+3532
RNCWORK1 EQU   ISTRNCA+3844
RNCPHR1  EQU   RNCWORK1
RNCWORK2 EQU   ISTRNCA+5892
RNCPHR2  EQU   RNCWORK2
RNCWORK3 EQU   ISTRNCA+7940
ISTLCST  EQU   0
LCSTTYPE EQU   ISTLCST+12
LCSTACR  EQU   ISTLCST+18
ISTDITHD EQU   0
ISTDHDVI EQU   0
DHDDIVTH EQU   ISTDHDVI+12
ISTDDTVI EQU   0
ISTRNCDT EQU   0
ISTRNCGT EQU   0
ISTRNCPT EQU   0
PARMHDLR EQU   0
POLLEXT  EQU   0
POLLCHAR EQU   0
DIALXTSN EQU   0
DIALCHAR EQU   0
ADDRCHAR EQU   0
ADDRCHA2 EQU   0
PHRFN1OA EQU   PHROADTA
PHRF1SAD EQU   PHRFN1OA
PHRF1SLN EQU   PHRFN1OA+4
PHRFN2OA EQU   PHROADTA
PHRF2NVL EQU   PHRFN2OA
PHRF2VAL EQU   PHRFN2OA+4
PHRF2FLG EQU   PHRF2VAL+2
PHRF2MSK EQU   PHRF2VAL+3
PHRF34OA EQU   PHROADTA
PHRF34EN EQU   PHRF34OA+4
PHRF34VF EQU   PHRF34EN
PHRF34SL EQU   PHRF34EN+2
PHRF34SP EQU   PHRF34EN+4
PHRFN5OA EQU   PHROADTA
PHRF5NSP EQU   PHRFN5OA
PHRF5ENT EQU   PHRFN5OA+4
PHRF5SL  EQU   PHRF5ENT+2
PHRF5SPT EQU   PHRF5ENT+4
PHRFN7OA EQU   PHROADTA
PHRF7NSP EQU   PHRFN7OA
PHRF7NUM EQU   PHRFN7OA+4
PHRFN8OA EQU   PHROADTA
PHRF8ENT EQU   PHRFN8OA+4
PHRF8FLG EQU   PHRF8ENT
RTRDNCBA EQU   ISTRTR+40
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PHRF8NUM EQU   PHRF8ENT+1
@NM00013 EQU   PHRF8FLG
PHRF8DFT EQU   PHRF8FLG
PHRF8NSP EQU   PHRFN8OA
@NM00012 EQU   PHRF5ENT+1
PHRF5VF  EQU   PHRF5ENT
@NM00011 EQU   PHRF34EN+1
PHRF34NS EQU   PHRF34OA
PHRF2MV  EQU   PHRF2FLG
PHRF2OFF EQU   PHRF2FLG
PHRF2ON  EQU   PHRF2FLG
@NM00010 EQU   PHRF2FLG
PHRF2TR  EQU   PHRF2FLG
PHRF2CL  EQU   PHRF2FLG
PHRF2LN  EQU   PHRF2FLG
PHRF2GP  EQU   PHRF2FLG
PHRF2OFS EQU   PHRF2VAL
RNCPT    EQU   ISTRNCPT+4
RNCPTLN  EQU   ISTRNCPT
RNCGT    EQU   ISTRNCGT+4
RNCGTLN  EQU   ISTRNCGT
RNCDT    EQU   ISTRNCDT+4
RNCDTLN  EQU   ISTRNCDT
DDTASSOC EQU   ISTDDTVI+40
DDTRDTPT EQU   ISTDDTVI+36
DDTTRNM  EQU   ISTDDTVI+28
DDTBSCLN EQU   ISTDDTVI+27
DDTBSCID EQU   ISTDDTVI+4
DDTFWPTR EQU   ISTDDTVI
DHDGPPTR EQU   ISTDHDVI+32
DHDDVOFF EQU   ISTDHDVI+28
DHDDTPTR EQU   ISTDHDVI+24
DHDDHPTR EQU   ISTDHDVI+20
DHDRSVD  EQU   DHDDIVTH+6
DHDIDLEN EQU   DHDDIVTH+4
DHDNUMFE EQU   DHDDIVTH+2
DHDNUME  EQU   DHDDIVTH
DHDHNAME EQU   ISTDHDVI+4
DHDFWPTR EQU   ISTDHDVI
DITDITT  EQU   ISTDITHD+16
DITLEN   EQU   ISTDITHD+15
DITUNUSD EQU   ISTDITHD+12
DITLSTNM EQU   ISTDITHD+4
DITFWDPT EQU   ISTDITHD
LCSTCODE EQU   ISTLCST+19
LCSTACR3 EQU   LCSTACR
LCSTACR2 EQU   LCSTACR
LCSTACR1 EQU   LCSTACR
LCSTACR0 EQU   LCSTACR
LCSTLCCD EQU   LCSTTYPE+5
LCSTLCTP EQU   LCSTTYPE
LCSTNAME EQU   ISTLCST+4
LCSTFWDP EQU   ISTLCST
RNCWORD5 EQU   ISTRNCA+8084
RNCWORD4 EQU   ISTRNCA+8080
RNCWORD3 EQU   ISTRNCA+8076
RNCWORD2 EQU   ISTRNCA+8072
RNCWORD1 EQU   ISTRNCA+8068
RNCWORK4 EQU   ISTRNCA+8004
RNCLDPRM EQU   RNCWORK3
RNCOCPRM EQU   RNCPHR2
RNCLMDCB EQU   RNCPHR1
RNCDAT3  EQU   ISTRNCA+3788
RNCSAV3  EQU   ISTRNCA+3716
RNCDAT2  EQU   ISTRNCA+3660
RNCSAV2  EQU   ISTRNCA+3588
@NM00015 EQU   ISTRNCA+3456
RNCLXMDL EQU   RNCPXMDL
RNCDSMDL EQU   RNCDAMDL
RNCCCLU  EQU   ISTRNCA+2808
RNCCLTR  EQU   ISTRNCA+2596
RNCLNLU  EQU   ISTRNCA+2420
RNCLNTR  EQU   ISTRNCA+2208
RNCLNPX  EQU   ISTRNCA+2124
RNCLNCC  EQU   ISTRNCA+1976
RNCLNCL  EQU   ISTRNCA+1880
RNCGPLU  EQU   ISTRNCA+1704
RNCGPTR  EQU   ISTRNCA+1492
RNCGPPX  EQU   ISTRNCA+1408
RNCGPCC  EQU   ISTRNCA+1260
RNCGPCL  EQU   ISTRNCA+1164
RNCGPLN  EQU   ISTRNCA+1004
RNCLUDEF EQU   ISTRNCA+828
RNCTRDEF EQU   ISTRNCA+616
RNCPXDEF EQU   ISTRNCA+532
RNCCCDEF EQU   ISTRNCA+384
RNCCLDEF EQU   ISTRNCA+288
RNCLNDEF EQU   ISTRNCA+128
RNCRSV01 EQU   ISTRNCA+127
RNCTBFR  EQU   ISTRNCA+127
RNCGPUIN EQU   ISTRNCA+127
RNCGVB   EQU   ISTRNCA+127
RNCGLSBD EQU   ISTRNCA+126
RNCGSWBD EQU   ISTRNCA+126
RNCGRNBD EQU   ISTRNCA+126
RNCGCLPU EQU   ISTRNCA+126
RNCGANS  EQU   ISTRNCA+126
RNCGINOD EQU   ISTRNCA+126
RNCGCUA  EQU   ISTRNCA+126
RNCGRNAM EQU   ISTRNCA+126
RNCGDLLN EQU   ISTRNCA+125
RNCGRGAP EQU   ISTRNCA+125
RNCLNID  EQU   ISTRNCA+125
RNCGPID  EQU   ISTRNCA+125
RNCGNOW  EQU   ISTRNCA+125
RNCGQUE  EQU   ISTRNCA+125
RNCGVSEQ EQU   ISTRNCA+123
RNCGTWX  EQU   ISTRNCA+123
RNCGSTBH EQU   ISTRNCA+123
RNCGLU   EQU   ISTRNCA+123
RNCGPA   EQU   ISTRNCA+123
RNCGPU   EQU   ISTRNCA+122
RNCGLINE EQU   ISTRNCA+122
RNCGGRP  EQU   ISTRNCA+122
RNCGHOST EQU   ISTRNCA+122
RNCGSYSC EQU   ISTRNCA+122
RNCGBLD  EQU   ISTRNCA+122
RNCGPCCU EQU   ISTRNCA+122
RNCLPCT  EQU   ISTRNCA+120
RNCLPNM  EQU   ISTRNCA+112
RNCDIVT  EQU   ISTRNCA+108
RNCDITT  EQU   ISTRNCA+104
RNCLCST  EQU   ISTRNCA+100
RNCLWS   EQU   ISTRNCA+96
RNCFWS   EQU   ISTRNCA+92
RNCOFFS2 EQU   ISTRNCA+88
RNCOFFST EQU   ISTRNCA+84
RNCLTBLS EQU   ISTRNCA+80
RNCFTBLS EQU   ISTRNCA+76
RNCLENT  EQU   ISTRNCA+72
RNCFENT  EQU   ISTRNCA+68
RNCLRNLL EQU   ISTRNCA+64
RNCFRNLL EQU   ISTRNCA+60
RNCPX    EQU   ISTRNCA+56
RNCDA    EQU   ISTRNCA+52
RNCLLN   EQU   ISTRNCA+48
RNCIN    EQU   ISTRNCA+40
RNCLU    EQU   ISTRNCA+36
RNCCC    EQU   ISTRNCA+28
RNCDS    EQU   ISTRNCA+12
RNCRSV07 EQU   ISTRNCA+8
RNCSWLS  EQU   ISTRNCA+4
MLCSTOWL EQU   MLCDECB2
MLCDECB1 EQU   MLCTPMSG
MLCLDPRM EQU   MLCRDPRM
MLCACPRM EQU   MLCOCPRM
MLCDCB   EQU   MLCWRK1
MLCMHDAT EQU   ISTMLCA+908
MLCERDAT EQU   ISTMLCA+852
MLCERSAV EQU   ISTMLCA+780
MLCARDAT EQU   MLCADDAT
MLCARSAV EQU   MLCADSAV
MLCDAT4  EQU   ISTMLCA+596
MLCSAV4  EQU   ISTMLCA+524
MLCDAT3  EQU   ISTMLCA+468
MLCDAT2  EQU   ISTMLCA+340
MLCSAV2  EQU   ISTMLCA+268
MLCDAT1  EQU   ISTMLCA+212
MLCSAV1  EQU   ISTMLCA+140
@NM00014 EQU   ISTMLCA+136
MLCNCSPL EQU   MLCPTRS+36
MLCLENT  EQU   MLCPTRS+32
MLCPTR7  EQU   MLCPTRS+28
MLCPTR6  EQU   MLCPTRS+24
MLCPTR5  EQU   MLCPTRS+20
MLCPTR2  EQU   MLCPTRS+8
MLCPTR1  EQU   MLCPTRS+4
MLCPTR0  EQU   MLCPTRS
MLCGETSZ EQU   ISTMLCA+92
MLCFIII  EQU   MLCERBF3+8
MLCCNFG2 EQU   MLCERBF3
MLCFII   EQU   MLCERBF2+16
MLCCONFG EQU   MLCERBF1
MLCINT   EQU   MLCFLAGS
MLCSKDCB EQU   ISTMLCA+12
MLCSKEL  EQU   ISTMLCA+8
MLCRPH   EQU   ISTMLCA+4
MLCSECCA EQU   ISTMLCA
PHROALEN EQU   ISTPHROA
PATRSV01 EQU   PATFLAGA
PATUSEFG EQU   PATFLAGA
PATRDCNT EQU   ISTPAT+6
PATGRPID EQU   ISTPAT+5
PATPTHID EQU   ISTPAT+4
PATDINDX EQU   ISTPAT+2
PATGINDX EQU   ISTPAT
GNTGRPNM EQU   ISTGNT
DNTTELNO EQU   ISTDNT+1
DNTCTDIG EQU   ISTDNT
RLSRSV02 EQU   ISTRLS+140
RLSRSV01 EQU   ISTRLS+138
RLSCTELU EQU   ISTRLS+136
RLSPRE   EQU   ISTRLS
RDARSVPT EQU   ISTRDA+84
RDAPUBI  EQU   ISTRDA+83
RDADFCUA EQU   ISTRDA+80
RDACTPCC EQU   ISTRDA+79
RDADACUA EQU   ISTRDA+76
RDALUBA  EQU   RDAUCBAD+1
RDACHQI  EQU   RDAUCBAD
RDARSV01 EQU   RDAFLAG
RDARBISA EQU   RDAFLAG
RDAPRE   EQU   ISTRDA
RSWRSV01 EQU   ISTRSW+152
RSWRSV02 EQU   ISTRSW+150
RSWCTELU EQU   ISTRSW+148
RSWGRUPZ EQU   ISTRSW+146
RSWDIALZ EQU   ISTRSW+144
RSWGRUPT EQU   ISTRSW+140
RSWDIALT EQU   ISTRSW+136
RSWPRE   EQU   ISTRSW
RLXRSV03 EQU   ISTRLX+80
RLXRSV02 EQU   ISTRLX+77
RLXRSV01 EQU   RLXFLAGA
RLXINUSE EQU   RLXFLAGA
RLXNLUX  EQU   ISTRLX+72
RLXPRE   EQU   ISTRLX
RPXRSV01 EQU   ISTRPX+80
RPXRSV02 EQU   ISTRPX+77
RPXMAXLU EQU   ISTRPX+76
RPXFLUX  EQU   ISTRPX+72
RPXPRE   EQU   ISTRPX
RLURSV02 EQU   ISTRLU+172
RLULGMOD EQU   ISTRLU+164
RLUMODEP EQU   RLUMODET+8
RLUMODEN EQU   RLUMODET
RLUUSSPT EQU   RLUUSSTB+8
RLUUSSNM EQU   RLUUSSTB
RLURSV01 EQU   ISTRLU+137
RLULOCAD EQU   ISTRLU+136
RLUNCPPM EQU   RLUNCPPC+1
RLUNCPPN EQU   RLUNCPPC
RLUPACEM EQU   RLUPACE+1
RLUPACEN EQU   RLUPACE
RLUINTA  EQU   ISTRLU+128
RLUSSCFM EQU   ISTRLU+127
RLUCRRSV EQU   RLUCRFLG
RLUACTLU EQU   RLUCRFLG
RLURSV00 EQU   RLUFLAG
RLUNDSES EQU   RLUFLAG
RLUGSTAT EQU   RLUFLAG
RLUBATCH EQU   RLUFLAG
RLURBISA EQU   RLUFLAG
RLUTYPE  EQU   ISTRLU+124
RLUCRPR  EQU   ISTRLU
RCCRVPT2 EQU   ISTRCC+144
RCCXTOSW EQU   ISTRCC+140
RCCSWTOX EQU   ISTRCC+136
RCCRSPT2 EQU   ISTRCC+133
RCCADDR  EQU   ISTRCC+132
RCCPASSL EQU   ISTRCC+131
RCCMXOUT EQU   ISTRCC+130
RCCMXDAT EQU   ISTRCC+128
RCCINDEX EQU   ISTRCC+126
RCCPATHZ EQU   ISTRCC+124
RCCPATHT EQU   ISTRCC+120
RCCDPQ   EQU   ISTRCC+116
RCCTPAB  EQU   ISTRCC+112
RCCRSV02 EQU   ISTRCC+109
RCCCRRSV EQU   RCCCRFLG
RCCCTCFL EQU   RCCCRFLG
RCCACTPU EQU   RCCCRFLG
RCCNCSPL EQU   ISTRCC+104
RCCRPHCN EQU   ISTRCC+100
RCCEPAB  EQU   ISTRCC+96
RCCDPAB  EQU   ISTRCC+92
RCCVPAB  EQU   ISTRCC+88
@NM00009 EQU   ISTRCC+87
RCCSESCT EQU   ISTRCC+86
RCCIDNUM EQU   RCCID48+3
RCCIDBLK EQU   RCCID48+2
RCCIDPA2 EQU   RCCID48+1
RCCIDPUT EQU   RCCID48
RCCIDPA1 EQU   RCCSTAID
RCCCTELU EQU   ISTRCC+76
RCCCNCNT EQU   ISTRCC+75
RCCRTGOH EQU   RCCFLAGB
RCCBRKCN EQU   RCCFLAGB
RCCRESET EQU   RCCFLAGB
RCCFINAL EQU   RCCFLAGB
RCCBNNSP EQU   RCCFLAGB
RCCIRETR EQU   RCCFLAGB
RCCDIALP EQU   RCCFLAGB
RCCDSTCT EQU   RCCFLAGB
RCCCTPGD EQU   RCCFLAG
RCCPRGDN EQU   RCCFLAG
RCCOUERP EQU   RCCFLAG
RCCOHIMM EQU   RCCFLAG
RCCLDISC EQU   RCCFLAG
RCCERPIP EQU   RCCFLAG
RCCCUDIE EQU   RCCFLAG
RCCRBISA EQU   RCCFLAG
RCCTYPE  EQU   ISTRCC+72
RCCPRE   EQU   ISTRCC
DOTADTRM EQU   ISTDOT
RDSADDOT EQU   ISTRDS+76
RDSCTATR EQU   ISTRDS+74
RDSPRE   EQU   ISTRDS
RINRSV05 EQU   ISTRIN+156
RINRSV04 EQU   ISTRIN+152
RINLOCRN EQU   ISTRIN+148
RINRSV02 EQU   ISTRIN+145
RTRCNCNT EQU   RINCNCNT
RTRNCSPL EQU   RINNCSPL
RTRRPHCN EQU   RINRPHCN
RTRVPAB  EQU   RINVPAB
RTRREMOT EQU   RINREMOT
RTRRLDAF EQU   RINRLDAF
RTRNODID EQU   RINNODID
RINRSV01 EQU   RINDFD
RTRLDISC EQU   RINLDISC
RTRNODEF EQU   RINNODEF
RTRREMPO EQU   RINREMPO
RINCRPRE EQU   ISTRIN
RTRRSV04 EQU   ISTRTR+210
RTRLCTI  EQU   ISTRTR+209
RTRIDCAS EQU   RTRBSCID+1
RTRIDLEN EQU   RTRBSCID
RTRRSVDD EQU   ISTRTR+181
RTRRDFG  EQU   ISTRTR+180
RTRRSV03 EQU   ISTRTR+156
RTRRVPT1 EQU   ISTRTR+152
RTRCRSV2 EQU   RTRCRFLG
RTRDTRLM EQU   RTRLSCMD
RTRCRSV1 EQU   RTRCRFLG
RTRRSV24 EQU   RTRRDFF
RTRRSV0A EQU   RTRRDFE
RTRRSV11 EQU   RTRRDFD
RTRRSV10 EQU   RTRRDFD
RTRRSV23 EQU   RTRRDFC
RTRRCXMS EQU   RTRRDFC
RTRRCMSG EQU   RTRRDFC
RTRRCBLK EQU   RTRRDFC
RTRRSV32 EQU   RTRRDFB
RTRRBECT EQU   RTRRDFB
RTRRSV02 EQU   RTRRDFA
RTRRACTR EQU   RTRRDFA
RTRRSV60 EQU   RTRRDFA
RTRRAPT3 EQU   RTRRAALL
RTRRAPT2 EQU   RTRRAALL
RTRRAPT1 EQU   RTRRAALL
RTRRSV45 EQU   ISTRTR+132
RTRRSV01 EQU   ISTRTR+130
RTRADRPT EQU   RTRADR+1
RTRRSV22 EQU   RTRFLAG
RTRRSV51 EQU   RTRFLAG
RTRRSV21 EQU   RTRFLAG
RTRCRPR  EQU   ISTRTR
RCLRVPT2 EQU   ISTRCL+92
RCLRVPT1 EQU   ISTRCL+88
RCLGPOLA EQU   ISTRCL+84
RCLCTNGP EQU   ISTRCL+82
RCLRSV01 EQU   ISTRCL+80
RCLCTECM EQU   ISTRCL+78
RCLGPADR EQU   RCLADR+1
RCLRSV33 EQU   RCLFLAG
RCLBATCH EQU   RCLFLAG
RCLRBISA EQU   RCLFLAG
RCLRSV22 EQU   RCLFLAG
RCLPRE   EQU   ISTRCL
RPTRSV03 EQU   ISTRPT+156
RPTRSV02 EQU   ISTRPT+152
RPTNSNSV EQU   ISTRPT+148
RPTPTHCT EQU   ISTRPT+146
RPTPEPCT EQU   ISTRPT+144
RPTDAFSV EQU   ISTRPT+142
RPTRSV01 EQU   ISTRPT+141
RPTVYIMM EQU   RPTFLAG1
RPTVIODN EQU   RPTFLAG1
RPTONLIN EQU   RPTFLAG1
RPTHLVPD EQU   RPTFLAG1
RPTVRYPD EQU   RPTFLAG1
RPTASLEP EQU   RPTFLAG1
RPTUTERM EQU   ISTRPT+136
RPTATERM EQU   ISTRPT+132
RPTDIVT  EQU   RPTDITT
RPTLNDAF EQU   RPTLNCID+2
RPTLNSAF EQU   RPTLNCID
RPTLN    EQU   ISTRPT
RLNRVPT2 EQU   ISTRLN+112
RLNNCSPL EQU   ISTRLN+108
RLNX2SW  EQU   ISTRLN+104
@NM00008 EQU   ISTRLN+103
RLNCRRSV EQU   RLNCRFLG
RLNSWEP  EQU   RLNCRFLG
RLNSVSKP EQU   RLNLSCMD
RLNSESLM EQU   RLNLSCMD
RLNNPRLM EQU   RLNLSCMD
RLNSWNCP EQU   RLNCRFLG
RLNACTLN EQU   RLNCRFLG
RLNPAUSE EQU   ISTRLN+101
RLNPOLMT EQU   ISTRLN+100
RLNACTSN EQU   ISTRLN+98
RLNRESV1 EQU   ISTRLN+97
RLNACTRM EQU   ISTRLN+96
RLNCTSES EQU   ISTRLN+95
RLNRDSLM EQU   ISTRLN+94
RLNAUTOA EQU   ISTRLN+92
RLNRDFD  EQU   RLNRDF+3
RLNRDFC  EQU   RLNRDF+2
RLNRATRN EQU   RLNRDFB
RLNRAPOL EQU   RLNRDFB
RLNTTV   EQU   RLNRDFB
RLNRSV0B EQU   RLNRDFB
RLNAUTOD EQU   RLNRDFB
RLNANSWR EQU   RLNRDFB
RLNRBUSE EQU   RLNRDFB
RLNRAPEP EQU   RLNRDFA
RLNRANCP EQU   RLNRDFA
RLNRAEP  EQU   RLNRDFA
RLNIDV   EQU   RLNRDFA
RLNGANSW EQU   RLNRDFA
RLNRACAT EQU   RLNRACNT
RLNRSV04 EQU   RLNSTAT2
RLNINUSE EQU   RLNSTAT2
RLNOHIN  EQU   RLNSTAT2
RLNRSV03 EQU   RLNSTAT1
RLNVD    EQU   RLNSTAT1
RLNINOPP EQU   RLNSTAT1
RLNINOPL EQU   RLNSTAT1
RLNLRST  EQU   RLNSTAT1
RLNTRAP  EQU   RLNSTAT1
RLNACTCT EQU   ISTRLN+84
RLNCTEIN EQU   ISTRLN+80
RLNCTECL EQU   ISTRLN+76
RLNCUA   EQU   RLNUCBAD
RLNRSV01 EQU   RLNFLAG
RLNRBISA EQU   RLNFLAG
RLNEAM   EQU   RLNFLAG
RLNPRE   EQU   ISTRLN
RGPRVPT2 EQU   ISTRGP+88
RGPRVPT1 EQU   ISTRGP+84
RGPCTEIN EQU   ISTRGP+80
RGPCTECL EQU   ISTRGP+76
RGPCTELN EQU   ISTRGP+74
RGPRSV03 EQU   ISTRGP+73
RGPRSV02 EQU   RGPFLG
RGPASDLC EQU   RGPFLG
RGPPRE   EQU   ISTRGP
RRNRINNM EQU   ISTRRN+248
@NM00007 EQU   ISTRRN+247
RRNRDCUA EQU   ISTRRN+244
RRNLASTE EQU   ISTRRN+240
RRNNCSPL EQU   ISTRRN+236
RRNRPLPT EQU   ISTRRN+232
RRNMSIZE EQU   ISTRRN+228
RRNNCPNM EQU   ISTRRN+221
RRNCTPCC EQU   ISTRRN+220
RRNHBUFS EQU   ISTRRN+218
RRNHLENT EQU   RRNHPRE+1
RRNHLENH EQU   RRNHPRE
RRNNMNCP EQU   ISTRRN+208
RRNDELAY EQU   ISTRRN+206
RRNRSV04 EQU   ISTRRN+200
RRNRSV88 EQU   RRNNMDPD+7
RRNPUBI  EQU   RRNNMDPD+6
RRNDPLUB EQU   RRNNMDPD
RRNEPADR EQU   ISTRRN+190
RRNCPLUB EQU   ISTRRN+184
RRNFLUX  EQU   ISTRRN+180
RRNRSV05 EQU   RRNCMFD
RRNREMPO EQU   RRNCMFD
RRNCDREC EQU   RRNCMFD
RRNCDDSI EQU   RRNCMFD
RRNCDBCK EQU   RRNCMFD
RRNCDDTL EQU   RRNCMFD
RRNCDSTD EQU   RRNCMFD
RRNCDCSP EQU   RRNCMFD
RRNCCCSL EQU   RRNCMFC
RRNCCSIM EQU   RRNCMFC
RRNCCRCM EQU   RRNCMFC
RRNCCRIM EQU   RRNCMFC
RRNCCCRC EQU   RRNCMFC
RRNCCRST EQU   RRNCMFC
RRNCCRDQ EQU   RRNCMFC
RRNCCRCN EQU   RRNCMFC
RRNCBALT EQU   RRNCMFB
RRNCBMOD EQU   RRNCMFB
RRNCBNPL EQU   RRNCMFB
RRNCBRLS EQU   RRNCMFB
RRNCBRDS EQU   RRNCMFB
RRNCBDLR EQU   RRNCMFB
RRNCBDLH EQU   RRNCMFB
RRNCBDLO EQU   RRNCMFB
RRNCADGO EQU   RRNCMFA
RRNCADTD EQU   RRNCMFA
RRNCACDT EQU   RRNCMFA
RRNCAATI EQU   RRNCMFA
RRNCAATG EQU   RRNCMFA
RRNCAATD EQU   RRNCMFA
RRNCAALL EQU   RRNCMFA
RRNRSV55 EQU   RRNRDF+3
RRNPTASL EQU   RRNRDFB+1
RRNRSV01 EQU   RRNRDFB+1
RRNVYDON EQU   RRNRDFB+1
RRNRBBUP EQU   RRNRDFB+1
RRNRSV03 EQU   RRNRDFB
RRNRBCT2 EQU   RRNRDFB
RRNRBCT1 EQU   RRNRDFB
RRNRBSEC EQU   RRNRDFB
RRNRBCCT EQU   RRNRDFB
RRNRBCCL EQU   RRNRDFB
RRNRSV02 EQU   RRNRDFB
RRNRBMDL EQU   RRNRDFB
RRNRAPEP EQU   RRNRDFA
RRNRANCP EQU   RRNRDFA
RRNRBREM EQU   RRNRDFA
RRNRAOLT EQU   RRNRDFA
RRNRASYN EQU   RRNRDFA
RRNRADMP EQU   RRNRDFA
RRNRAIPL EQU   RRNRDFA
RRNRASHT EQU   RRNRDFA
RRNCTENT EQU   ISTRRN+170
RRNCTEIN EQU   ISTRRN+166
RRNCTECL EQU   ISTRRN+162
RRNCTELI EQU   ISTRRN+160
RRNCTEGP EQU   ISTRRN+158
RRNCTBHS EQU   ISTRRN+156
RRNBHSET EQU   ISTRRN+152
RRNTRENT EQU   ISTRRN+148
RRNRLDIP EQU   ISTRRN+147
RRNRNCUA EQU   ISTRRN+144
RRNGRPA  EQU   ISTRRN+140
RRNLUBA  EQU   RRNUCBAD+1
RRNCHQI  EQU   RRNUCBAD
RRNRSV11 EQU   RRNFLAG
RRNDSTCT EQU   RRNFLAG
RRNERPIP EQU   RRNFLAG
RRNLCDIP EQU   RRNFLAG
RRNLCDIE EQU   RRNFLAG
RRNLCSIP EQU   RRNFLAG
RRNRBISA EQU   RRNFLAG
RRNRSV89 EQU   RRNFLAG
RRNPRE   EQU   ISTRRN
RLCRVPT2 EQU   ISTRLC+80
RLCRVPT1 EQU   ISTRLC+79
RLCLCCUA EQU   ISTRLC+76
RLCUCBAD EQU   RLCADR+1
RLCRSVDE EQU   RLCFLAG
RLCACNT  EQU   RLCFLAG
RLCRSV14 EQU   RLCFLAG
RLCRBISA EQU   RLCFLAG
RLCRSV22 EQU   RLCFLAG
RLCPRE   EQU   ISTRLC
RAPRVPT2 EQU   ISTRAP+116
RAPRVPT1 EQU   ISTRAP+112
RAPBFACT EQU   ISTRAP+111
RAPRSV17 EQU   RAPFLGC
RAPRSV16 EQU   RAPFLGC
RAPRSV15 EQU   RAPFLGC
RAPRSV14 EQU   RAPFLGC
RAPRSV13 EQU   RAPFLGC
RAPRSV12 EQU   RAPFLGC
RAPRSV11 EQU   RAPFLGC
RAPRSV10 EQU   RAPFLGC
RAPANVPC EQU   RAPFLGB
RAPASPO  EQU   RAPFLGB
RAPAPPO  EQU   RAPFLGB
RAPAACQ  EQU   RAPFLGB
RAPAPRMT EQU   RAPFLGB
RAPAPASS EQU   RAPFLGB
RAPABLCK EQU   RAPFLGB
RAPALLF  EQU   RAPFLGB
RAPRSV06 EQU   RAPFLG
RAPRSV05 EQU   RAPFLG
RAPRSV04 EQU   RAPFLG
RAPRSV03 EQU   RAPFLG
RAPATLGN EQU   RAPFLG
RAPASLGI EQU   RAPFLG
RAPAQUI  EQU   RAPFLG
RAPABLGN EQU   RAPFLG
RAPACEQD EQU   ISTRAP+106
RAPTRPRE EQU   ISTRAP+104
RAPACEAP EQU   ISTRAP+100
RAPICEAQ EQU   ISTRAP+96
RAPICEAC EQU   ISTRAP+92
RAPICELG EQU   ISTRAP+88
RAPAPPWD EQU   ISTRAP+80
RAPACDEB EQU   ISTRAP+76
RAPACBA  EQU   ISTRAP+72
RAPPRE   EQU   ISTRAP
RDTVSRPL EQU   ISTRDT+132
RDTCRSPW EQU   ISTRDT+124
RDTCRSDS EQU   ISTRDT+116
@NM00006 EQU   ISTRDT+113
RRNSTCNT EQU   RDTSTCNT
RRNVYRPH EQU   RDTVYRPH
RDTTPAB  EQU   ISTRDT+104
RDTDPAB  EQU   ISTRDT+100
RDTEPAB  EQU   ISTRDT+96
RDTVPAB  EQU   ISTRDT+92
RDTRSV01 EQU   RDTFLAGB
RDTBHSET EQU   RDTFLAGB
RDTCTCFL EQU   RDTFLAGB
RDTCTPGD EQU   RDTFLAGB
RDTPRGDN EQU   RDTFLAGB
RDTOUERP EQU   RDTFLAGB
RDTLGCT  EQU   ISTRDT+90
RDTNODID EQU   ISTRDT+89
RDTMAXID EQU   ISTRDT+88
RDTCTSNT EQU   ISTRDT+86
RDTFLAGS EQU   ISTRDT+84
RDTBACK  EQU   ISTRDT+80
RDTFORW  EQU   ISTRDT+76
RDTLEN   EQU   RDTPLEN+1
RDTPRILS EQU   RDTPRIOR
RDTPRISW EQU   RDTPRIOR
RDTPRIRN EQU   RDTPRIOR
RDTPRILC EQU   RDTPRIOR
RDTPRIAP EQU   RDTPRIOR
@NM00005 EQU   RDTPRIOR
RDTPRE   EQU   ISTRDT
RCPRSV05 EQU   ISTRCPRE+120
RCPRSV04 EQU   ISTRCPRE+116
RCPRSV03 EQU   ISTRCPRE+112
RCPINTA  EQU   RCPLGNIN+16
@NM00004 EQU   RCPPMODE
RCPRRECD EQU   RCPPMODE
RCPRBASC EQU   RCPPMODE
RCPBHSI2 EQU   ISTRCPRE+89
RCPBHSI1 EQU   ISTRCPRE+88
RCPACETR EQU   ISTRCPRE+84
RCPICEAQ EQU   ISTRCPRE+80
RCPLNAPA EQU   ISTRCPRE+76
RCPICELN EQU   ISTRCPRE+72
RCPPRE   EQU   ISTRCPRE
RPRCONID EQU   ISTRPRE+63
RPRCLVPD EQU   RPRFLAGC
RPRINIMM EQU   RPRFLAGD
RPRRSV05 EQU   RPRFLAGD
RPRCONP  EQU   RPRFLAGD
RPRACTP  EQU   RPRFLAGD
RPRRSON  EQU   RPRFLAGD
RPRCONCT EQU   RPRFLAGD
RPRLTASN EQU   RPRFLAGD
RPRPTHCT EQU   ISTRPRE+60
RPRSWDAF EQU   ISTRPRE+58
RPRSTPCT EQU   ISTRPRE+56
RPRRVPT1 EQU   ISTRPRE+52
RPRNCBA  EQU   ISTRPRE+40
RPRLGONB EQU   ISTRPRE+32
RPRLGONF EQU   ISTRPRE+28
RPRHDTYP EQU   ISTRPRE+27
RPRTIOCT EQU   ISTRPRE+26
RPRPEPCT EQU   ISTRPRE+24
RPRRSV03 EQU   RPRCAUSE
RPRRSYNC EQU   RPRCAUSE
RPRCRCPT EQU   RPRCAUSE
RPRNOSRT EQU   RPRCAUSE
RPRINTST EQU   RPRFLAGB
RPRVYIMM EQU   RPRFLAGB
RPRHLVPD EQU   RPRFLAGB
RPRONLIN EQU   RPRFLAGB
RPRVIODN EQU   RPRFLAGB
RPRENTVT EQU   RPRFLAGB
RPRENTVH EQU   RPRFLAGB
RPRLIVE  EQU   RPRFLAGA
RPRVRYPD EQU   RPRFLAGA
RPRENTED EQU   RPRFLAGA
RPRENTIO EQU   RPRFLAGA
RPRENTBF EQU   RPRFLAGA
RPRTIED  EQU   RPRFLAGA
RPRINV   EQU   RPRFLAGA
RPRACT   EQU   RPRFLAGA
RPRPELEN EQU   ISTRPRE+18
RPRELEN  EQU   ISTRPRE+16
RPRRLOCK EQU   ISTRPRE+12
RPRDAF   EQU   RPRCOMID+2
RPRSAF   EQU   RPRCOMID
LOKXCL   EQU   @NM00002
LOKPRY   EQU   @NM00002
@NM00003 EQU   @NM00002
@NM00001 EQU   LOKCHNG
LOKCT    EQU   ISTLOK
DEVRSV03 EQU   ISTDEVCH+5
DEVCHAR2 EQU   DEVTCODE
DEVRSV01 EQU   DEVCHAR
DEVNNSPT EQU   DEVCHAR
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00245 EQU   @RC00240
@RC00317 EQU   @RC00315
@RC00378 EQU   @RC00376
@RC00411 EQU   @RC00406
@RC00594 EQU   @RC00592
@PB00018 EQU   @EL00002
@RC00697 EQU   @RC00683
@RC00742 EQU   @RC00741
@RC00830 EQU   @RC00825
@RF00856 EQU   @RC00850
@RF00866 EQU   @RC00864
@RC00250 EQU   @RC00245
@RC00414 EQU   @RC00411
@RC00597 EQU   @RC00594
@PB00017 EQU   @PB00018
@RC00744 EQU   @RC00742
@RT00252 EQU   @RC00250
@PB00016 EQU   @PB00017
@RC00749 EQU   @RC00744
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@ENDDATA EQU   *
         END   ISTSDCTM,(C'PLS2221',0603,78100)

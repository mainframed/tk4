         TITLE 'IGG0CLA0 - SHOW CATALOG                                *
                        '
IGG0CLA0 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IGG0CLA0  75.012'                                 0001
         DROP  @15
@PROLOG  DS    0H                                                  0002
         USING @MAINENT,R15
         USING @DATD-(SHWTEMPS-SHWORKA),R11
         STM   R14,R12,SHWREGS-SHWSAVEA(R13)
         BALR  R12,R0
         USING *,R12
*   R6=R1;                          /* SET INPUT PARM LIST ADDR      */
*                                                                  0049
         LR    R6,R1                                               0049
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THAT NO LESS THAN MINIMUM WORK AREA LENGTH SPECIFIED SO */
*   /* THAT A GETMAIN PARM LIST CAN BE BUILT IN IT                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0050
*   IF SHWLEN1>=MINWALN THEN        /* NO ERR IF SUFFICIENT W.A.     */
         L     @14,SHWAREA(,R6)                                    0050
         LH    @10,SHWLEN1(,@14)                                   0050
         C     @10,@CF00067                                        0050
         BL    @RF00050                                            0050
*     DO;                           /* OBTAIN SHOWCAT WORK AREA      */
*       SHWMAIN=SHWMAIN&&SHWMAIN;   /* CLEAR GETMAIN PARM LIST       */
         AL    @14,@CF00076                                        0052
         XC    SHWMAIN(16,@14),SHWMAIN(@14)                        0052
*       SHWMNLEN=LENGTH(SHWORKA);   /* SHOW CAT WORK AREA LENGTH     */
         MVC   SHWMNLEN(4,@14),@CF00542                            0053
*       SHWMNPTR=ADDR(SHWMNADR);    /* PTR TO PTR OF GETMAIN WA      */
         LA    @10,SHWMNADR(,@14)                                  0054
         ST    @10,SHWMNPTR(,@14)                                  0054
*       SHWMNSPL=SHWSPL;            /* SUBPOOL ZERO                  */
         MVI   SHWMNSPL(@14),X'00'                                 0055
*       R1=ADDR(SHWMAIN);           /* GETMAIN PARM LIST             */
         LR    R1,@14                                              0056
*       GEN(GETMAIN EC,MF=(E,(1))); /* ISSUE GETMAIN                 */
         GETMAIN EC,MF=(E,(1))
*       IF R15^=0 THEN              /* IF ERROR                      */
         SLR   @14,@14                                             0058
         CR    R15,@14                                             0058
         BE    @RF00058                                            0058
*         DO;                       /* ERROR PROCESSING              */
*           R11=0;                  /* INDICATE NO WORK AREA         */
         LR    R11,@14                                             0060
*           R2=RCORE;               /* SET ERROR CODE                */
         LA    R2,8                                                0061
*         END;                      /* END ERROR PROCESSING          */
*       ELSE                        /* NO ERROR                      */
*         DO;                       /* NO GETMAIN ERR PROCESS        */
         B     @RC00058                                            0063
@RF00058 DS    0H                                                  0064
*           R11=SHWMNADR;           /* INITLZ SHOW WORK AREA BASE REG*/
         L     @14,SHWAREA(,R6)                                    0064
         L     R11,SHWMNADR+4(,@14)                                0064
*           RFY                                                    0065
*            (R0,                                                  0065
*             R1,                                                  0065
*             R15) UNRSTD;          /* FREE GETMAIN REGS             */
*                                                                  0065
*           /*********************************************************/
*           /*                                                       */
*           /* CLEAR SHOW CATALOG WORK AREA                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0066
*           R2=R11;                 /* START ADDR OF WORK AREA       */
         LR    R2,R11                                              0066
*           R3=LENGTH(SHWORKA);     /* LENGTH OF WORK AREA           */
         LA    R3,303                                              0067
*           R5=0;                   /* PAD CHARACTER                 */
         SLR   R5,R5                                               0068
*           GEN(MVCL R2,R4);        /* CLEAR WORK AREA               */
*                                                                  0069
         MVCL R2,R4
*           /*********************************************************/
*           /*                                                       */
*           /* CHAIN SAVE AREAS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0070
*           ADDR(SHWSAREA)->SHWSPSA=R13;/* BACK SAVE AREA POINTER    */
         ST    R13,SHWSPSA+204(,R11)                               0070
*           SHWSNSA=ADDR(SHWSAREA); /* FORWARD SAVE AREA PTR         */
         LA    @10,SHWSAREA(,R11)                                  0071
         ST    @10,SHWSNSA(,R13)                                   0071
*           R13=ADDR(SHWSAREA);     /* INITLZ FOR SHOW CAT'S SAVE  0072
*                                      AREA ADDR                     */
         LR    R13,@10                                             0072
*         END;                      /* END NO GETMAIN ERR            */
*     END;                          /* END OBTAIN SHOWCAT N.A.       */
*   ELSE                            /* INSUFFICIENT W.A.             */
*     DO;                           /* ERROR PROCESSING              */
         B     @RC00050                                            0075
@RF00050 DS    0H                                                  0076
*       R11=0;                      /* INDICATE NO WORK AREA         */
         SLR   R11,R11                                             0076
*       R2=RWASZ;                   /* SET ERROR CODE                */
         LA    @10,4                                               0077
         LR    R2,@10                                              0077
*       IF SHWLEN1>=LENGTH(SHWLEN1)+LENGTH(SHWLEN2) THEN/* IF REQD 0078
*                                      WORK AREA LEN MUST BE SET     */
         L     @07,SHWAREA(,R6)                                    0078
         CH    @10,SHWLEN1(,@07)                                   0078
         BH    @RF00078                                            0078
*         SHWLEN2=MINWALN;          /* SET MIN REQD LENGTH           */
         MVC   SHWLEN2(2,@07),@CH00067                             0079
*       ELSE                                                       0080
*         ;                         /* NO NEED FOR SET               */
@RF00078 DS    0H                                                  0081
*     END;                          /* END ERROR PROCESSING          */
*   IF R11=0 THEN                   /* IF UNABLE TO GET WORK AREA, 0082
*                                      DISCONTINUE PROCESS           */
@RC00050 LTR   R11,R11                                             0082
         BNZ   @RF00082                                            0082
*     DO;                           /* ERROR EXIT PROCESSING         */
*       RFY                                                        0084
*        (R14,                                                     0084
*         R15) RSTD;                /* USE THESE REGS                */
*       R15=R2;                     /* SET ERROR CODE                */
         LR    R15,R2                                              0085
*       R14=SHWRE;                  /* RESTORE REG 14                */
         L     R14,SHWRE(,R13)                                     0086
*       GEN REFS(SHWR1C);                                          0087
*                                       /* RETURN TO CALLER  */
         LM    R1,R12,SHWR1C(R13)       RESTORE REGS 1 THROUGH 12
         BR    R14                      EXIT
*       RFY                                                        0088
*        (R14,                                                     0088
*         R15) UNRSTD;              /* FREE REGS                     */
*     END;                          /* END ERROR EXIT                */
*   ELSE                                                           0090
*     ;                             /* NO WORK AREA ERROR            */
*                                                                  0090
@RF00082 DS    0H                                                  0091
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE VSAM CATALOG FIELD MANAGEMENT INTERFACE            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0091
*   RFY                                                            0091
*     CTGPL BASED(ADDR(SHWCPL));    /* MAP CPL AREA                  */
*   CTGBYPSS=ON;                    /* NO SECURITY ON LOCATE         */
         LA    @10,8                                               0092
         ALR   @10,R11                                             0092
         OI    CTGBYPSS(@10),B'10000000'                           0092
*   IF SHWNAME=ON THEN              /* IF 44-BYTE NAME               */
         TM    SHWNAME(R6),B'10000000'                             0093
         BNO   @RF00093                                            0093
*     CTGNAME=ON;                   /* INDICATE SO IN CPL            */
         OI    CTGNAME(@10),B'00000100'                            0094
*   ELSE                                                           0095
*     ;                             /* CI NUMBER- FLAG WAS INITIALLY
*                                      SET OFF                       */
@RF00093 DS    0H                                                  0096
*   IF SHWACB^=0 THEN               /* IF ACB ADDRESS GIVEN          */
         L     @10,SHWACB(,R6)                                     0096
         LTR   @10,@10                                             0096
         BZ    @RF00096                                            0096
*     CTGCAT=ADDR(SHWACB);          /* SET ADDR INTO CPL             */
         LA    @10,SHWACB(,R6)                                     0097
         ST    @10,CTGCAT+8(,R11)                                  0097
*   ELSE                            /* NO ACB ADDRESS                */
*     CTGCNAME=ON;                  /* SET CATALOG NAME FLAG         */
         B     @RC00096                                            0098
@RF00096 OI    CTGCNAME+8(R11),B'00000010'                         0098
*   CTGFUNC=CTGLOC;                 /* INDICATE LOCATE FUNCTION      */
@RC00096 LA    @10,8                                               0099
         ALR   @10,R11                                             0099
         NI    CTGFUNC(@10),B'00111111'                            0099
         OI    CTGFUNC(@10),B'00100000'                            0099
*   CTGNUM=ON;                      /* SEARCH ONLY VSAM CATALOG      */
*   CTGAM0=ON;                      /* VSAM CATALOG REQUEST          */
         OI    CTGNUM(@10),B'00000011'                             0101
*   CTGENT=SHWENT;                  /* SET ENTRY ADDR                */
         L     @07,SHWENT(,R6)                                     0102
         ST    @07,CTGENT(,@10)                                    0102
*   CTGWKA=SHWAREA;                 /* SET CALLER RETURN AREA ADDRESS*/
         L     @07,SHWAREA(,R6)                                    0103
         ST    @07,CTGWKA(,@10)                                    0103
*   CTGNOFLD=DIM(SHWFPL);           /* NUMBER FPL'S                  */
         MVI   CTGNOFLD(@10),X'06'                                 0104
*   CTGFIELD(FPL1)=ADDR(SHWFPL(FPL1));/* FIRST FPL ADDRESS           */
         LA    @07,SHWFPL(,R11)                                    0105
         ST    @07,CTGFIELD(,@10)                                  0105
*   CTGFIELD(FPL1)->CTGFLDNM=       /* POINT TO ACB ADDR FIELD       */
*       ADDR(CATACB);               /* NAME                          */
         LA    @15,@CC00037                                        0106
         ST    @15,CTGFLDNM(,@07)                                  0106
*   CTGFIELD(FPL2)=ADDR(SHWFPL(FPL2));/* SECOND FPL ADDR             */
         LA    @07,SHWFPL+24(,R11)                                 0107
         ST    @07,CTGFIELD+4(,@10)                                0107
*   CTGFIELD(FPL2)->CTGFLDNM=       /* POINT TO ENTRY TYPE FIELD     */
*       ADDR(ENTYPE);               /* NAME                          */
         LA    @15,@CC00039                                        0108
         ST    @15,CTGFLDNM(,@07)                                  0108
*   CTGFIELD(FPL3)=ADDR(SHWFPL(FPL3));/* THIRD FPL ADDR              */
         LA    @07,SHWFPL+48(,R11)                                 0109
         ST    @07,CTGFIELD+8(,@10)                                0109
*   CTGFIELD(FPL3)->CTGFLDNM=       /* POINT TO PATH/AIX             */
*       ADDR(RGATTR);               /* ATTRIBUTES FIELD              */
         LA    @15,@CC00041                                        0110
         ST    @15,CTGFLDNM(,@07)                                  0110
*   CTGFIELD(FPL4)=ADDR(SHWFPL(FPL4));/* FOURTH FPL ADDR             */
         LA    @07,SHWFPL+72(,R11)                                 0111
         ST    @07,CTGFIELD+12(,@10)                               0111
*   CTGFIELD(FPL4)->CTGFLDNM=       /* POINT TO AMDSB FIELD          */
*       ADDR(AMDSBSC);              /* NAME                          */
         LA    @15,@CC00043                                        0112
         ST    @15,CTGFLDNM(,@07)                                  0112
*   CTGFIELD(FPL5)=ADDR(SHWFPL(FPL5));/* FIFTH FPL ADDR              */
         LA    @07,SHWFPL+96(,R11)                                 0113
         ST    @07,CTGFIELD+16(,@10)                               0113
*   CTGFIELD(FPL5)->CTGFLDNM=       /* POINT TO ATTRIBUTE            */
*       ADDR(DSATTR);               /* FIELD NAME                    */
         LA    @15,@CC00047                                        0114
         ST    @15,CTGFLDNM(,@07)                                  0114
*   CTGFIELD(FPL6)=ADDR(SHWFPL(FPL6));/* SIXTH FPL ADDR              */
         LA    @07,SHWFPL+120(,R11)                                0115
         ST    @07,CTGFIELD+20(,@10)                               0115
*   CTGFIELD(FPL6)->CTGFLDNM=       /* POINT TO UPGRADE              */
*       ADDR(ASSOCSC);              /* FIELD NAME                    */
         LA    @10,@CC00045                                        0116
         ST    @10,CTGFLDNM(,@07)                                  0116
*   RFY                                                            0117
*    (R1,                                                          0117
*     R15) RSTD;                    /* USE THESE REGS IN SVC CALL    */
*                                                                  0117
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE THE VSAM CATALOG TO OBTAIN THE REQUIRED VSAM CATALOG   */
*   /* INFORMATION.                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0118
*   R1=ADDR(SHWCPL);                /* POINT TO LOCATE CPL           */
         LA    R1,SHWCPL(,R11)                                     0118
*   GEN(SVC 26);                    /* CALL VSAM CATALOG TO LOCATE 0119
*                                      SHOWCAT INFO                  */
*                                                                  0119
         SVC 26
*   /*****************************************************************/
*   /*                                                               */
*   /* TRANSLATE VSAM CATALOG RETURN CODES                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0120
*   IF R15=RCS THEN                 /* IF COMPLETED SUCCESSFULLY     */
         LTR   R15,R15                                             0120
         BNZ   @RF00120                                            0120
*     SHWRC=RS;                     /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'00'                                    0121
*   ELSE                            /* OTHER CODE                    */
*     IF R15=RCVLSZ THEN            /* IF WORK AREA TOO SMALL        */
         B     @RC00120                                            0122
@RF00120 C     R15,@CF00098                                        0122
         BNE   @RF00122                                            0122
*       SHWRC=RWASZ;                /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'04'                                    0123
*     ELSE                          /* OTHER CODE                    */
*       IF R15=RCINSSWA THEN        /* IF INSUFFICIENT CORE          */
         B     @RC00122                                            0124
@RF00122 C     R15,@CF00191                                        0124
         BNE   @RF00124                                            0124
*         SHWRC=RCORE;              /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'08'                                    0125
*       ELSE                        /* OTHER CODE                    */
*         IF R15=RCCAT THEN         /* IF CATALOG NOT OPEN/EXIST     */
         B     @RC00124                                            0126
@RF00124 C     R15,@CF00076                                        0126
         BNE   @RF00126                                            0126
*           SHWRC=RMCAT;            /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'0C'                                    0127
*         ELSE                      /* OTHER CODE                    */
*           IF R15=RCBLKVCK THEN    /* IF ADDR VALIDITY CHECK        */
         B     @RC00126                                            0128
@RF00126 C     R15,@CF00173                                        0128
         BNE   @RF00128                                            0128
*             SHWRC=RAVCK;          /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'10'                                    0129
*           ELSE                    /* OTHER CODE                    */
*             IF R15=RCENT THEN     /* IF OBJECT NOT EXIST           */
         B     @RC00128                                            0130
@RF00128 C     R15,@CF00036                                        0130
         BNE   @RF00130                                            0130
*               SHWRC=RENT;         /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'14'                                    0131
*             ELSE                  /* OTHER CODE                    */
*               IF R15=RCIOL THEN   /* IF I/D ERROR                  */
         B     @RC00130                                            0132
@RF00130 C     R15,@CF00091                                        0132
         BNE   @RF00132                                            0132
*                 SHWRC=RIO;        /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'18'                                    0133
*               ELSE                /* OTHER CODE                    */
*                 IF R15=RCINCI THEN/* IF INVALID CI NUMBER          */
         B     @RC00132                                            0134
@RF00132 C     R15,@CF00171                                        0134
         BNE   @RF00134                                            0134
*                   SHWRC=RINCI;    /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'1C'                                    0135
*                 ELSE              /* OTHER CODE                    */
*                   IF R15=RCINENT THEN/* IF INVALID ENTRY TYPE      */
         B     @RC00134                                            0136
@RF00134 C     R15,@CF00134                                        0136
         BNE   @RF00136                                            0136
*                     SHWRC=RINTYPE;/* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'20'                                    0137
*                   ELSE            /* UNEXPECTED RETURN CODE        */
*                     SHWRC=RWHAT;  /* SET SHOWCAT CODE              */
         B     @RC00136                                            0138
@RF00136 MVI   SHWRC(R11),X'28'                                    0138
*   RFY                                                            0139
*    (R1,                                                          0139
*     R15) UNRSTD;                  /* FREE REGS                     */
@RC00136 DS    0H                                                  0139
@RC00134 DS    0H                                                  0139
@RC00132 DS    0H                                                  0139
@RC00130 DS    0H                                                  0139
@RC00128 DS    0H                                                  0139
@RC00126 DS    0H                                                  0139
@RC00124 DS    0H                                                  0139
@RC00122 DS    0H                                                  0139
@RC00120 DS    0H                                                  0140
*   IF(SHWRC=RS×SHWRC=RWASZ)        /* IF SHOW CAT SUCCESSFUL        */
*       &CTGFIELD(FPL2)^=0 THEN     /* AND FIELD DATA BACK           */
         CLI   SHWRC(R11),0                                        0140
         BE    @GL00001                                            0140
         CLI   SHWRC(R11),4                                        0140
         BNE   @RF00140                                            0140
@GL00001 L     @10,CTGFIELD+12(,R11)                               0140
         LTR   @10,@10                                             0140
         BZ    @RF00140                                            0140
*     IF SHWTYPE=CLS×SHWTYPE=AIX×   /* IF ACCEPTABLE TYPE OF         */
*         SHWTYPE=PTH×SHWTYPE=DTA×  /* CLUSTER, AIX, PATH, DATA,     */
*         SHWTYPE=IDX×SHWTYPE=UPG THEN                             0141
         L     @10,SHWAREA(,R6)                                    0141
         CLI   SHWTYPE(@10),C'C'                                   0141
         BE    @RT00141                                            0141
         CLI   SHWTYPE(@10),C'G'                                   0141
         BE    @RT00141                                            0141
         CLI   SHWTYPE(@10),C'R'                                   0141
         BE    @RT00141                                            0141
         CLI   SHWTYPE(@10),C'D'                                   0141
         BE    @RT00141                                            0141
         CLI   SHWTYPE(@10),C'I'                                   0141
         BE    @RT00141                                            0141
         CLI   SHWTYPE(@10),C'Y'                                   0141
         BE    @RT00141                                            0141
*       ;                           /* INDEX, UPGRADE, NO ERR        */
*     ELSE                          /* BAD ENTRY TYPE                */
*       SHWRC=RINTYPE;              /* SET SHOWCAT CODE              */
         MVI   SHWRC(R11),X'20'                                    0143
*   ELSE                                                           0144
*     ;                             /* SHOWCAT NOT SUCCESSFUL        */
@RF00140 DS    0H                                                  0145
*   DO R2=1 TO DIM(SHWFPL) WHILE(SHWRC=RS/* INSURE FIELD DATA WAS    */
*         ×SHWRC=RWASZ);            /* RETURNED                      */
@RC00140 LA    R2,1                                                0145
@DL00145 CLI   SHWRC(R11),0                                        0145
         BE    @DB00145                                            0145
         CLI   SHWRC(R11),4                                        0145
         BNE   @DC00145                                            0145
@DB00145 DS    0H                                                  0146
*     IF CTGFIELD(R2)->CTGFLPT(1)=0&/* IF NO DATA WAS RETURNED       */
*         ((R2=FPL4&(SHWTYPE=DTA×SHWTYPE=IDX))×/* FROM THE VSAM      */
*         R2<=FPL3×R2=FPL5×         /* CATALOG                       */
*         ((R2=FPL6&(SHWTYPE^=UPG)))) THEN/* FOR THIS ENTRY          */
         LR    @10,R2                                              0146
         SLA   @10,2                                               0146
         L     @10,CTGFIELD+4(@10,R11)                             0146
         L     @10,CTGFLPT(,@10)                                   0146
         LTR   @10,@10                                             0146
         BNZ   @RF00146                                            0146
         C     R2,@CF00076                                         0146
         BNE   @GL00012                                            0146
         L     @10,SHWAREA(,R6)                                    0146
         CLI   SHWTYPE(@10),C'D'                                   0146
         BE    @RT00146                                            0146
         CLI   SHWTYPE(@10),C'I'                                   0146
         BE    @RT00146                                            0146
@GL00012 C     R2,@CF00074                                         0146
         BNH   @RT00146                                            0146
         C     R2,@CF00078                                         0146
         BE    @RT00146                                            0146
         C     R2,@CF00080                                         0146
         BNE   @RF00146                                            0146
         L     @10,SHWAREA(,R6)                                    0146
         CLI   SHWTYPE(@10),C'Y'                                   0146
         BE    @RF00146                                            0146
@RT00146 DS    0H                                                  0147
*       SHWRC=RCBAL;                /* SET SHOWCAT RETURN CODE       */
         MVI   SHWRC(R11),X'24'                                    0147
*     ELSE                                                         0148
*       ;                           /* DATA RETURNED                 */
@RF00146 DS    0H                                                  0149
*   END;                            /* END INSURE                    */
         AL    R2,@CF00033                                         0149
         C     R2,@CF00080                                         0149
         BNH   @DL00145                                            0149
@DC00145 DS    0H                                                  0150
*   IF SHWRC=RWASZ&SHWTYPE^=UPG THEN/* IF EXPECTED ERROR CODE        */
         CLI   SHWRC(R11),4                                        0150
         BNE   @RF00150                                            0150
         L     @10,SHWAREA(,R6)                                    0150
         CLI   SHWTYPE(@10),C'Y'                                   0150
         BE    @RF00150                                            0150
*     SHWRC=RS;                     /* ZEROR ERROR CODE              */
         MVI   SHWRC(R11),X'00'                                    0151
*   ELSE                                                           0152
*     ;                             /* NOT EXPECTED ERROR            */
@RF00150 DS    0H                                                  0153
*   IF SHWLEN2<MINWALN THEN         /* IF WORK AREA SIZE BELOW MIN 0153
*                                      ACCEPTABLE                    */
         LA    @10,64                                              0153
         L     @07,SHWAREA(,R6)                                    0153
         CH    @10,SHWLEN2(,@07)                                   0153
         BNH   @RF00153                                            0153
*     SHWLEN2=MINWALN;              /* SET MIN                       */
         STH   @10,SHWLEN2(,@07)                                   0154
*   ELSE                                                           0155
*     ;                             /* WORK AREA SIZE OK             */
@RF00153 DS    0H                                                  0156
*   IF SHWRC=RS×SHWRC=RWASZ THEN    /* IF NO ERRORS SO FAR           */
         CLI   SHWRC(R11),0                                        0156
         BE    @RT00156                                            0156
         CLI   SHWRC(R11),4                                        0156
         BNE   @RF00156                                            0156
@RT00156 DS    0H                                                  0157
*     DO;                           /* TRANSFORM VSAM CATALOG DATA   */
*       IF SHWTYPE=PTH×SHWTYPE=AIX THEN                            0158
         L     @10,SHWAREA(,R6)                                    0158
         CLI   SHWTYPE(@10),C'R'                                   0158
         BE    @RT00158                                            0158
         CLI   SHWTYPE(@10),C'G'                                   0158
         BE    @RT00158                                            0158
*         ;                         /* IF PATH OR AIX THEN ATTRIBUTES
*                                      OK                            */
*       ELSE                        /* ATTRIBUTES ARE RESERVED       */
*         SHWATTR=0;                /* ZERO ATTRIBUTES               */
         L     @10,SHWAREA(,R6)                                    0160
         MVI   SHWATTR(@10),X'00'                                  0160
*       IF SHWTYPE=DTA×SHWTYPE=IDX THEN/* IF DATA OR INDEX, THEN   0161
*                                      AMDSB FIELDS PRESENT          */
@RT00158 L     @10,SHWAREA(,R6)                                    0161
         CLI   SHWTYPE(@10),C'D'                                   0161
         BE    @RT00161                                            0161
         CLI   SHWTYPE(@10),C'I'                                   0161
         BNE   @RF00161                                            0161
@RT00161 DS    0H                                                  0162
*         R2=ADDR(SHWASS);          /* POINT BEGIN OF ASSOC          */
         L     R2,SHWAREA(,R6)                                     0162
         LA    R2,SHWASS(,R2)                                      0162
*       ELSE                        /* NOT DATA OR INDEX             */
*         R2=ADDR(SHWASS0);         /* POINT BEGIN OF ASSOC          */
         B     @RC00161                                            0163
@RF00161 L     R2,SHWAREA(,R6)                                     0163
         LA    R2,SHWASS0(,R2)                                     0163
*       RFY                                                        0164
*         SHWASSOC BASED(R2);       /* MAP ASSOCIATIONS              */
@RC00161 DS    0H                                                  0165
*       SHWACT=CTGFIELD(FPL6)->CTGFLNG(1)/LENGTH(SHWASS1);/* SET   0165
*                                      COUNT OF ASSOCIATIONS         */
         L     @10,CTGFIELD+28(,R11)                               0165
         L     @00,CTGFLNG(,@10)                                   0165
         SRDA  @00,32                                              0165
         D     @00,@CF00076                                        0165
         STH   @01,SHWACT(,R2)                                     0165
*       IF SHWTYPE=UPG THEN                                        0166
         L     @10,SHWAREA(,R6)                                    0166
         CLI   SHWTYPE(@10),C'Y'                                   0166
         BE    @RT00166                                            0166
*         ;                         /* IF UPGRADE ENTRY, NO        0167
*                                      ASSOCIATION TRANSFORM       0167
*                                      NECESSARY                     */
*       ELSE                        /* TRANSFORM DOUBLE ASSOC        */
*         DO;                       /* PERFORM TRANSFORM             */
*           SHWACT=SHWACT/TWO;      /* SET CORRECT COUNT OF SINGLETON
*                                      ASSOCIATIONS                  */
         LH    @00,SHWACT(,R2)                                     0169
         SRDA  @00,32                                              0169
         D     @00,@CF00070                                        0169
         STH   @01,SHWACT(,R2)                                     0169
*           RFY                                                    0170
*             SHWUPGDA BASED(R2);   /* MAP DOUBLE ASSOCIATIONS       */
*           DO R3=1 TO SHWACT;      /* TRANSFORM DOUBLE ASSOC TO   0171
*                                      SINGLETONS                    */
         LA    R3,1                                                0171
         B     @DE00171                                            0171
@DL00171 DS    0H                                                  0172
*             SHWASSSA=SHWASS1(R3); /* SAVE ASSOCIATION              */
         LR    @10,R3                                              0172
         SLA   @10,3                                               0172
         ST    @10,@TF00001                                        0172
         ALR   @10,R2                                              0172
         AL    @10,@CF00549                                        0172
         MVC   SHWASSSA(4,R11),SHWASS1-2(@10)                      0172
*             SHWAUPG(R3)=SHWAUPG(R3)&&SHWAUPG(R3);/* ZERO DOUBLE  0173
*                                      ASSOCIATION AREA              */
         LR    @10,R2                                              0173
         AL    @10,@TF00001                                        0173
         AL    @10,@CF00549                                        0173
         XC    SHWAUPG-2(8,@10),SHWAUPG-2(@10)                     0173
*             SHWASSN(R3)=SHWASSSA; /* STORE ASSOCIATION             */
         LR    @10,R3                                              0174
         SLA   @10,2                                               0174
         ALR   @10,R2                                              0174
         AL    @10,@CF00550                                        0174
         MVC   SHWASSN-2(4,@10),SHWASSSA(R11)                      0174
*           END;                    /* END TRANSFORM                 */
         AL    R3,@CF00033                                         0175
@DE00171 CH    R3,SHWACT(,R2)                                      0175
         BNH   @DL00171                                            0175
*         END;                      /* END PERFORM                   */
*     END;                          /* END TRANSFORM                 */
*   ELSE                                                           0178
*     ;                             /* ERROR                         */
@RF00156 DS    0H                                                  0179
*   RFY                                                            0179
*    (R0,                                                          0179
*     R1,                                                          0179
*     R14,                                                         0179
*     R15) RSTD;                    /* USE THESE REGS                */
@RC00156 DS    0H                                                  0180
*   R13=SHWSPSA;                    /* CALLER'S SAVE AREA            */
         L     R13,SHWSPSA(,R13)                                   0180
*   R2=SHWRC;                       /* SAVE SHOW CAT RET CODE ACROSS
*                                      FREEMAIN                      */
         SLR   R2,R2                                               0181
         IC    R2,SHWRC(,R11)                                      0181
*   R0=LENGTH(SHWORKA)+SHWSPLN;     /* SET LENGTH AND SUBPOOL OF SHOW
*                                      CAT WORK AREA                 */
         LA    R0,303                                              0182
*   R1=R11;                         /* SET ADDR OF SHOW CAT WORK AREA*/
         LR    R1,R11                                              0183
*   GEN(FREEMAIN R,LV=(0),A=(1));   /* FREE SHOW CAT WORK AREA       */
         FREEMAIN R,LV=(0),A=(1)
*   R14=SHWRE;                      /* RETURN ADDRESS                */
         L     R14,SHWRE(,R13)                                     0185
*   R15=R2;                         /* SET RETURN CODE               */
         LR    R15,R2                                              0186
*   GEN REFS(SHWR1C);                                              0187
*                                     /* EXIT                      */
         LM    R1,R12,SHWR1C(R13)       RESTORE CALLERS REGS
         BR    R14                      RETURN
*   RFY                                                            0188
*    (R0,                                                          0188
*     R1,                                                          0188
*     R14,                                                         0188
*     R15) UNRSTD;                  /* FREE REGS                     */
*PATCH:                                                            0189
*   GEN(DC    25F'0');              /* PATCH AREA                    */
PATCH    DC    25F'0'
*   END                             /* END IGG0CLA0                  */
*                                                                  0190
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IGGMCTRC)                                       */
*/*%INCLUDE SYSLIB  (IGGSHWPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */
*                                                                  0190
*       ;                                                          0190
@EL00001 DS    0H                                                  0190
@EF00001 DS    0H                                                  0190
@ER00001 BR    @14                                                 0190
@DATA    DS    0H
@DATD    DSECT
         DS    0F
@TF00001 DS    F
IGG0CLA0 CSECT
         DS    0F
@CF00033 DC    F'1'
@CF00070 DC    F'2'
@CF00074 DC    F'3'
@CF00076 DC    F'4'
@CF00078 DC    F'5'
@CF00080 DC    F'6'
@CF00036 DC    F'8'
@CF00091 DC    F'24'
@CF00098 DC    F'40'
@CF00134 DC    F'60'
@CF00067 DC    F'64'
@CH00067 EQU   @CF00067+2
@CF00171 DC    F'124'
@CF00173 DC    F'128'
@CF00191 DC    F'164'
@CF00542 DC    F'303'
@CF00549 DC    F'-6'
@CF00550 DC    F'-2'
@DATD    DSECT
         DS    0D
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IGG0CLA0 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00037 DC    C'CATACB  '
@CC00039 DC    C'ENTYPE  '
@CC00041 DC    C'RGATTR  '
@CC00043 DC    C'AMDSBSC '
@CC00045 DC    C'ASSOCSC '
@CC00047 DC    C'DSATTR  '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
R10      EQU   @10
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
SHWORKA  EQU   0
SHWRC    EQU   SHWORKA
SHWASSSA EQU   SHWORKA+4
SHWFMWA  EQU   SHWORKA+8
SHWCPL   EQU   SHWFMWA
SHWFPL   EQU   SHWFMWA+52
SHWSAREA EQU   SHWORKA+204
SHWTEMPS EQU   SHWORKA+276
SHWSAVEA EQU   0
SHWSPSA  EQU   SHWSAVEA+4
SHWSNSA  EQU   SHWSAVEA+8
SHWREGS  EQU   SHWSAVEA+12
SHWRE    EQU   SHWREGS
SHWR1C   EQU   SHWREGS+12
SHWUPGDA EQU   0
SHWAUPG  EQU   SHWUPGDA+2
SHWASS1  EQU   SHWAUPG
SHWMAIN  EQU   0
SHWMNLEN EQU   SHWMAIN
SHWMNPTR EQU   SHWMAIN+4
SHWMNSPL EQU   SHWMAIN+9
SHWMNADR EQU   SHWMAIN+12
SHWPL    EQU   0
SHWFLGS  EQU   SHWPL
SHWNAME  EQU   SHWFLGS
SHWENT   EQU   SHWPL+4
SHWACB   EQU   SHWPL+8
SHWAREA  EQU   SHWPL+12
SHWOUT   EQU   0
SHWLEN1  EQU   SHWOUT
SHWLEN2  EQU   SHWOUT+2
SHWACBP  EQU   SHWOUT+4
SHWTYPE  EQU   SHWOUT+8
SHWATTR  EQU   SHWOUT+9
SHWASS0  EQU   SHWOUT+10
SHWDSB   EQU   SHWASS0
SHWASS   EQU   SHWOUT+22
SHWASSOC EQU   0
SHWACT   EQU   SHWASSOC
SHWASSN  EQU   SHWASSOC+2
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGBYPSS EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
@NM00011 EQU   CTGDDNM
CTGPROB  EQU   @NM00011
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00012 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
CTGFLDNO EQU   CTGFL
CTGPSWD  EQU   CTGJSCB
@NM00010 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00009 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00008 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00007 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
SHWACI   EQU   SHWASSN+1
SHWATYPE EQU   SHWASSN
SHWMREC  EQU   SHWDSB+8
SHWCISZ  EQU   SHWDSB+4
SHWKEYLN EQU   SHWDSB+2
SHWRKP   EQU   SHWDSB
@NM00006 EQU   SHWATTR
SHWUP    EQU   SHWATTR
@NM00005 EQU   SHWPL+1
@NM00004 EQU   SHWFLGS
@NM00003 EQU   SHWMAIN+10
@NM00002 EQU   SHWMAIN+8
SHWASS2  EQU   SHWAUPG+4
SHWACNT  EQU   SHWUPGDA
SHWRF0   EQU   SHWREGS+4
SHWSWD1  EQU   SHWSAVEA
@NM00001 EQU   SHWORKA+1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00058 EQU   @RC00050
@RT00141 EQU   @RC00140
@RT00166 EQU   @RC00156
@ENDDATA EQU   *
         END   IGG0CLA0,(C'PLS0102',0602,75012)

         TITLE '*********  IDCRI04: READER/INTERPRETER - TSO MODULE   **
               *********'
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCRI04  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRI04   76.335'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(24),0(@01)                                 0002
*        GDTPTR=ADDR(GDTTBLX);                             /*@YL026UL*/
*                                                                  0244
         L     GDTPTR,@PC00001                                     0244
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SET UP TO PROCESS THE INPUT COMMAND, UNLESS THE  @YL026UL*/
*        /* COMMAND HAS ALREADY BEEN PROCESSED.              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        SETRC=0;                                          /*@YL026UL*/
         SLR   @05,@05                                             0245
         STH   @05,SETRC                                           0245
*        IF GDTRIH = NULLPTR                                       0246
*          THEN                                                    0246
*                                                                  0246
         C     @05,GDTRIH(,GDTPTR)                                 0246
         BNE   @RF00246                                            0246
*            CALL RISETUP;                                 /*@YL026UL*/
*                                                                  0247
         BAL   @14,RISETUP                                         0247
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF PROCESSING SET-UP WAS SUCCESSFUL, PROCESS     @YL026UL*/
*        /* ALL COMMAND PARAMETERS EXCEPT THOSE CODED IN     @YL026UL*/
*        /* REPEATED SUBPARAMETER LISTS.                     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF LASTCC=0 & GDTRIH=NULLPTR & MAXID>0                    0248
*          THEN                                                    0248
*                                                                  0248
@RF00246 SLR   @05,@05                                             0248
         L     @02,@PC00001+16                                     0248
         CH    @05,LASTCC(,@02)                                    0248
         BNE   @RF00248                                            0248
         C     @05,GDTRIH(,GDTPTR)                                 0248
         BNE   @RF00248                                            0248
         L     @02,DESCPTR                                         0248
         CH    @05,MAXID(,@02)                                     0248
         BNL   @RF00248                                            0248
*            CALL MAINSCAN;                                /*@YL026UL*/
*                                                                  0249
         BAL   @14,MAINSCAN                                        0249
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF PROCESSING IS OKAY TO THIS POINT, THEN        @YL026UL*/
*        /* PROCESS PARAMETERS CODED IN REPEATED SUBPARM     @YL026UL*/
*        /* LISTS IF ANY EXIST.  HOWEVER, DON'T PROCESS A    @YL026UL*/
*        /* SUBLIST OF A PARAMETER WHICH HAS SINCE BEEN      @YL026UL*/
*        /* REQUESTED BY THE USER TO BE IGNORED.             @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF LASTCC=0 & GDTRIH=NULLPTR & MAXID > 0                  0250
*          THEN                                                    0250
@RF00248 SLR   @05,@05                                             0250
         L     @02,@PC00001+16                                     0250
         CH    @05,LASTCC(,@02)                                    0250
         BNE   @RF00250                                            0250
         C     @05,GDTRIH(,GDTPTR)                                 0250
         BNE   @RF00250                                            0250
         L     @02,DESCPTR                                         0250
         CH    @05,MAXID(,@02)                                     0250
         BNL   @RF00250                                            0250
*            DO REPINDEX=1 TO RSICOUNT WHILE(LASTCC=0);    /*@YL026UL*/
         LA    @05,1                                               0251
         B     @DE00251                                            0251
@DL00251 L     @02,@PC00001+16                                     0251
         LH    @02,LASTCC(,@02)                                    0251
         LTR   @02,@02                                             0251
         BNZ   @DC00251                                            0251
*              IF SBLSTIN(REPINDEX)=YES                            0252
*                THEN                                              0252
*                                                                  0252
         MH    @05,@CH00038                                        0252
         L     @02,RSIPTR                                          0252
         ALR   @02,@05                                             0252
         AL    @02,@CF01813                                        0252
         TM    SBLSTIN-9(@02),B'10000000'                          0252
         BNO   @RF00252                                            0252
*                  CALL SUBSCAN;                           /*@YL026UL*/
*                                                                  0253
         BAL   @14,SUBSCAN                                         0253
*            END;                                          /*@YL026UL*/
*                                                                  0254
@RF00252 LA    @05,1                                               0254
         AH    @05,REPINDEX                                        0254
@DE00251 STH   @05,REPINDEX                                        0254
         CH    @05,RSICOUNT                                        0254
         BNH   @DL00251                                            0254
@DC00251 DS    0H                                                  0255
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* PERFORM TERMINATION FUNCTIONS.                   @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        CALL RITERM;                                      /*@YL026UL*/
*                                                                  0255
@RF00250 BAL   @14,RITERM                                          0255
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0256
         ST    GDTPTR,@AL00001                                     0256
         LA    @07,MODID                                           0256
         ST    @07,@AL00001+4                                      0256
         LA    @07,SETRC                                           0256
         ST    @07,@AL00001+8                                      0256
         MVI   @AL00001+8,X'80'                                    0256
         L     @15,GDTEPL(,GDTPTR)                                 0256
         LA    @01,@AL00001                                        0256
         BALR  @14,@15                                             0256
*        /*@YL026UL*/                                              0257
*                                                                  0257
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - RISETUP                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE PREPARES FOR PROCESSING OF      @YL026UL*/
*/*             THE INPUT COMMAND.  THE COMMAND DESCRIPTOR   @YL026UL*/
*/*             LOAD MODULE NAME TABLE IS LOADED AND USED    @YL026UL*/
*/*             TO OBTAIN THE COMMAND DESCRIPTOR FOR THE     @YL026UL*/
*/*             CURRENT INPUT COMMAND.  USING THE DESCRIPTOR @YL026UL*/
*/*             THE 'PARMINFO' TABLE IS BUILT, AND SPACE IS  @YL026UL*/
*/*             ALLOCATED AND INITIALIZED FOR THE REPEATED   @YL026UL*/
*/*             SUBLIST INDEX (RSI), AND FOR THE INITIAL     @YL026UL*/
*/*             FDT SECTION(S).  ALSO, THE STATIC PARTS OF   @YL026UL*/
*/*             THE UPRINT DATA ARGUMENT LIST AND 'PARSE'    @YL026UL*/
*/*             PARAMETER LIST ARE INITIALLY SET UP.         @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            IDCRILT -  DESCRIPTOR LOAD MODULE NAME TABLE. @YL026UL*/
*/*            ECTPCMD -  COMMAND VERB NAME.                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            SPACEID -  SUBPOOL ID USED WHEN OBTAINING     @YL026UL*/
*/*                       SPACE FOR THE FDT.                 @YL026UL*/
*/*            GDTUPT -   PTR TO TSO USER PROFILE TABLE      @YL026UL*/
*/*            GDTECT -   PTR TO TSO ENVIR. CONTROL TABLE    @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            DARGLIST - INITIALIZED UPRINT DATA ARGUMENT   @YL026UL*/
*/*                       LIST                               @YL026UL*/
*/*            PARMINFO - PARAMETER INFORMATION TABLE        @YL026UL*/
*/*            FDTADDR -  ADDRESS OF FDT                     @YL026UL*/
*/*            FUNCTION DATA TABLE - INITIALIZED             @YL026UL*/
*/*            PPL -  PARSE PARAMETER LIST - INITIALIZED     @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*RISETUP:PROCEDURE;                                        /*@YL026UL*/
@EL00001 L     @13,4(,@13)                                         0257
@EF00001 L     @00,@SIZDATD                                        0257
         LR    @01,@08                                             0257
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0257
         BR    @14                                                 0257
RISETUP  STM   @14,@03,@SA00002                                    0257
         STM   @05,@12,@SA00002+24                                 0257
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** RISETUP **  DATA DEFINITIONS                 @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0258
*        /*COMMAND DESCRIPTOR LOAD MODULE NAME TABLE         @ZA07563*/
*        DCL 1 RILT BASED(SETUPPTR) BDY(WORD),                     0258
*              2 * (*) BDY(WORD),                         /* @ZA07563*/
*                3 TBLVERB  CHAR(8),   /*VERB NAME           @ZA07563*/
*                3 TBLLNAME CHAR(8);   /*CORRESPONDING CMD.  @ZA07563*/
*                                      /*DESCRIPTOR LOAD     @YL026UL*/
*                                      /*MODULE NAME         @YL026UL*/
*                                                                  0259
*        /* LOAD MODULE NAME TABLE TERMINATOR                @ZA07563*/
*        DCL TBLEND CHAR(8) CONSTANT('FFFFFFFF');         /* @ZA07563*/
*                                                                  0259
*        DCL SETUPPTR PTR(31);         /*WORK PTR USED FOR   @YL026UL*/
*                                      /*PROCESSING SET-UP   @YL026UL*/
*                                                                  0261
*        DCL LTBLNAME CHAR(8)          /*NAME OF DESCRIPTOR  @YL026UL*/
*                CONSTANT('IDCRILT '); /*LOAD NAME TABLE     @YL026UL*/
*        DCL BADPARMS FIXED(15)        /*MSG ID INDICATING   @YL026UL*/
*                     CONSTANT(16);    /*UNNEEDED PARMS      @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** RISETUP **  PREPARE TO PROCESS COMMAND       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0263
         L     @07,GDTTR2(,GDTPTR)                                 0263
         MVC   @TS00001(95),NEWERID2(@07)                          0263
         MVC   OLDERID2(95,@07),@TS00001                           0263
*        NEWID2='RI10';                                    /*@YL026UL*/
*                                                                  0264
         MVC   NEWID2(4,@07),@CC01529                              0264
*        BLKLEFT=0;                    /*INITIALLY, NO FDT   @YL026UL*/
         SLR   @07,@07                                             0265
         ST    @07,BLKLEFT                                         0265
*                                      /*DATA SPACE HAS      @YL026UL*/
*                                      /*BEEN ALLOCATED      @YL026UL*/
*                                                                  0266
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* INITIALIZE THE UPRINT DATA ARGUMENT LIST         @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DDSTRU=ADDR(PRNTAREA);                            /*@YL026UL*/
         LA    @07,PRNTAREA                                        0266
         ST    @07,DDSTRU                                          0266
*        PRNTAREA=''B;                                     /*@YL026UL*/
         XC    PRNTAREA(20),PRNTAREA                               0267
*        DARGSMOD=RISTID;                                  /*@YL026UL*/
*                                                                  0268
         MVC   DARGSMOD(3,@07),@CC01472                            0268
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* LOAD THE DESCRIPTOR LOAD NAME TABLE AND SEARCH   @YL026UL*/
*        /* IT FOR A VERB MATCHING THE EXTRACTED VERB NAME.  @YL026UL*/
*        /* WHEN A MATCH IS FOUND, LOAD THE CORRESPONDING    @YL026UL*/
*        /* COMMAND DESCRIPTOR.                              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0269
*        CALL IDCSALD0(GDTTBL,LTBLNAME,SETUPPTR);          /*@YL026UL*/
*                                                                  0269
         ST    GDTPTR,@AL00001                                     0269
         LA    @07,@CC01527                                        0269
         ST    @07,@AL00001+4                                      0269
         LA    @07,SETUPPTR                                        0269
         ST    @07,@AL00001+8                                      0269
         L     @15,GDTLOD(,GDTPTR)                                 0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*        FOUND=NO;                                         /*@YL026UL*/
         NI    FOUND,B'11111101'                                   0270
*        DO INDEX2=1 BY 1                                  /*@ZA07563*/
*           WHILE(FOUND=NO & TBLVERB(INDEX2)^=TBLEND);     /*@ZA07563*/
         LA    INDEX2,1                                            0271
         B     @DE00271                                            0271
@DL00271 DS    0H                                                  0272
*          IF TBLVERB(INDEX2) = ECTPCMD                            0272
*            THEN                                                  0272
         L     @07,SETUPPTR                                        0272
         LR    @05,INDEX2                                          0272
         SLA   @05,4                                               0272
         L     @03,ECTPTR(,GDTPTR)                                 0272
         ST    @05,@TF00001                                        0272
         ALR   @05,@07                                             0272
         AL    @05,@CF01815                                        0272
         CLC   TBLVERB(8,@05),ECTPCMD(@03)                         0272
         BNE   @RF00272                                            0272
*              DO;                                         /*@YL026UL*/
*              FOUND=YES;                                  /*@YL026UL*/
*                                                                  0274
         OI    FOUND,B'00000010'                                   0274
*              CALL IDCSALD0(GDTTBL,TBLLNAME(INDEX2),DESCPTR);/*   0275
*                                                            @YL026UL*/
*                                                                  0275
         ST    GDTPTR,@AL00001                                     0275
         L     @05,@TF00001                                        0275
         AL    @07,@CF01817                                        0275
         LA    @07,TBLLNAME-8(@05,@07)                             0275
         ST    @07,@AL00001+4                                      0275
         LA    @07,DESCPTR                                         0275
         ST    @07,@AL00001+8                                      0275
         L     @15,GDTLOD(,GDTPTR)                                 0275
         LA    @01,@AL00001                                        0275
         BALR  @14,@15                                             0275
*              END;                                        /*@YL026UL*/
*        END;                                              /*@YL026UL*/
@RF00272 AL    INDEX2,@CF00227                                     0277
@DE00271 TM    FOUND,B'00000010'                                   0277
         BNZ   @DC00271                                            0277
         LR    @07,INDEX2                                          0277
         SLA   @07,4                                               0277
         L     @05,SETUPPTR                                        0277
         ALR   @05,@07                                             0277
         AL    @05,@CF01815                                        0277
         CLC   TBLVERB(8,@05),@CC01525                             0277
         BNE   @DL00271                                            0277
@DC00271 DS    0H                                                  0278
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CREATE AND SET UP THE 'PARMINFO' TABLE IF THIS   @YL026UL*/
*        /* COMMAND IS DEFINED TO HAVE PARAMETERS.  ALSO GET @YL026UL*/
*        /* SPACE FOR THE 'RSI'.  IF INSUFFICIENT SPACE IS   @YL026UL*/
*        /* AVAILABLE, DISCONTINUE PROCESSING.               @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF MAXID > 0                                              0278
*          THEN                                                    0278
         L     @07,DESCPTR                                         0278
         LH    @07,MAXID(,@07)                                     0278
         LTR   @07,@07                                             0278
         BNP   @RF00278                                            0278
*DOGRP5:     DO;                                           /*@YL026UL*/
DOGRP5   DS    0H                                                  0280
*            AMTTOGET=MAXID*LENGTH(PARMINFO)+                      0280
*                     INITALLO*LENGTH(RSI);                /*@YL026UL*/
*                                                                  0280
         L     @07,DESCPTR                                         0280
         LH    @07,MAXID(,@07)                                     0280
         MH    @07,@CH00038                                        0280
         AL    @07,@CF01802                                        0280
         ST    @07,AMTTOGET                                        0280
*            CALL IDCSAGP0(GDTTBL,AMTTOGET,PINFOPTR,RIPOOLID,      0281
*                   SETZERO);                              /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     0281
         LA    @07,AMTTOGET                                        0281
         ST    @07,@AL00001+4                                      0281
         LA    @07,PINFOPTR                                        0281
         ST    @07,@AL00001+8                                      0281
         LA    @07,MODID                                           0281
         ST    @07,@AL00001+12                                     0281
         LA    @07,SETZERO                                         0281
         ST    @07,@AL00001+16                                     0281
         MVI   @AL00001+16,X'80'                                   0281
         L     @15,GDTGPL(,GDTPTR)                                 0281
         LA    @01,@AL00001                                        0281
         BALR  @14,@15                                             0281
*            RESPECIFY RTNREG RSTD;                                0282
*            TESTRC = RTNREG;                                      0283
         LR    TESTRC,RTNREG                                       0283
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UL*/
*                                                                  0284
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF CORE COULD NOT BE OBTAINED, CALL         @Y30SSFR*/
*            /*  FAILSPAC TO HANDLE THE ERROR.               @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            IF TESTRC^=0                                          0285
*              THEN                                                0285
         LTR   TESTRC,TESTRC                                       0285
         BZ    @RF00285                                            0285
*                DO;                                       /*@YL026UL*/
*                                                                  0286
*                CALL FAILSPAC;                            /*@YL026UL*/
*                                                                  0287
         BAL   @14,FAILSPAC                                        0287
*                RETURN;                                   /*@YL026UL*/
@EL00002 DS    0H                                                  0288
@EF00002 DS    0H                                                  0288
@ER00002 LM    @14,@03,@SA00002                                    0288
         LM    @05,@12,@SA00002+24                                 0288
         BR    @14                                                 0288
*                END;                                      /*@YL026UL*/
*                                                                  0289
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* EXAMINE THE LIST OF PARM ID#S ASSOCIATED     @YL026UL*/
*            /* WITH EACH 'PARMDATA' DESCRIPTOR SECTION.     @YL026UL*/
*            /* FOR EACH ID#=N, SET 'PARMPTR(N)' TO POINT    @YL026UL*/
*            /* TO THE 'PARMDATA' SECTION CONTAINING ID# N.  @YL026UL*/
*            /*  SINCE THE READER/INTERPRETER USES THE       @Y30SSFR*/
*            /*  CONVENTION THAT LENGTHS ARE STORED AS       @Y30SSFR*/
*            /*  NUMBERS OF HALF WORDS, ALL LENGTHS FROM     @Y30SSFR*/
*            /*  THE COMMAND DESCRIPTOR MUST BE DOUBLED.     @Y30SSFR*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*            SETUPPTR=DESCPTR+2*VDATALEN;                  /*@YL026UL*/
@RF00285 L     @07,DESCPTR                                         0290
         LH    @05,VDATALEN(,@07)                                  0290
         ALR   @05,@05                                             0290
         ALR   @07,@05                                             0290
         ST    @07,SETUPPTR                                        0290
*            RESPECIFY(PARMDATA) BASED(SETUPPTR);          /*@YL026UL*/
*            DO INDEX2=1 TO PARMCNT;                       /*@YL026UL*/
         LA    INDEX2,1                                            0292
         B     @DE00292                                            0292
@DL00292 DS    0H                                                  0293
*              DO INDEX3=1 TO (SETUPPTR+2*IDDSPL)->IDCOUNT;/*@YL026UL*/
         LA    INDEX3,1                                            0293
         B     @DE00293                                            0293
@DL00293 DS    0H                                                  0294
*                PARMPTR((SETUPPTR+2*IDDSPL)->IDNUM(INDEX3))=      0294
*                                      SETUPPTR;           /*@YL026UL*/
         L     @07,SETUPPTR                                        0294
         LR    @05,INDEX3                                          0294
         SLA   @05,2                                               0294
         SLR   @15,@15                                             0294
         IC    @15,IDDSPL(,@07)                                    0294
         ALR   @15,@15                                             0294
         ALR   @15,@07                                             0294
         BCTR  @15,0                                               0294
         BCTR  @15,0                                               0294
         LH    @05,IDNUM-2(@05,@15)                                0294
         MH    @05,@CH00038                                        0294
         L     @01,PINFOPTR                                        0294
         AL    @01,@CF01818                                        0294
         ST    @07,PARMPTR(@05,@01)                                0294
*              END;                                        /*@YL026UL*/
         AL    INDEX3,@CF00227                                     0295
@DE00293 L     @07,SETUPPTR                                        0295
         SLR   @05,@05                                             0295
         IC    @05,IDDSPL(,@07)                                    0295
         ALR   @05,@05                                             0295
         AL    @05,SETUPPTR                                        0295
         CH    INDEX3,IDCOUNT(,@05)                                0295
         BNH   @DL00293                                            0295
*              SETUPPTR=SETUPPTR+2*PDEFLEN;                /*@YL026UL*/
         L     @07,SETUPPTR                                        0296
         SLR   @05,@05                                             0296
         IC    @05,PDEFLEN(,@07)                                   0296
         ALR   @05,@05                                             0296
         ALR   @07,@05                                             0296
         ST    @07,SETUPPTR                                        0296
*            END;                                          /*@YL026UL*/
         AL    INDEX2,@CF00227                                     0297
@DE00292 L     @07,DESCPTR                                         0297
         CH    INDEX2,PARMCNT(,@07)                                0297
         BNH   @DL00292                                            0297
*            RESPECIFY(PARMDATA) BASED(PARMPTR(PARMID));   /*@YL026UL*/
*                                                                  0298
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* DETERMINE THE ID# OF EACH PARM'S SUPERPARM   @YL026UL*/
*            /* BY EXAMINING ALL THE SUBPARM LISTS IN THE    @YL026UL*/
*            /* COMMAND DESCRIPTOR.  STORE EACH SUPERPARM    @YL026UL*/
*            /* IN THE 'PARMINFO' TABLE.                     @YL026UL*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*            DO PARMID=1 TO MAXID;                         /*@YL026UL*/
         LA    @07,1                                               0299
         B     @DE00299                                            0299
@DL00299 DS    0H                                                  0300
*              IF PARMPTR(PARMID) ^= NULLPTR & SUBLIST=YES         0300
*                THEN                                              0300
         MH    @07,@CH00038                                        0300
         L     @05,PINFOPTR                                        0300
         AL    @05,@CF01818                                        0300
         L     @07,PARMPTR(@07,@05)                                0300
         LTR   @07,@07                                             0300
         BZ    @RF00300                                            0300
         TM    SUBLIST(@07),B'00000010'                            0300
         BNO   @RF00300                                            0300
*                  DO INDEX2=1 TO SUBCOUNT;                /*@YL026UL*/
         LA    INDEX2,1                                            0301
         B     @DE00301                                            0301
@DL00301 DS    0H                                                  0302
*                    SUPRPARM(SUBID(INDEX2))=PARMID;       /*@YL026UL*/
         LH    @07,PARMID                                          0302
         L     @05,PINFOPTR                                        0302
         LA    @03,12                                              0302
         LR    @15,INDEX2                                          0302
         SLA   @15,2                                               0302
         LR    @01,@07                                             0302
         MR    @00,@03                                             0302
         AL    @01,@CF01818                                        0302
         L     @14,PARMPTR(@01,@05)                                0302
         LR    @01,@14                                             0302
         ALR   @01,@03                                             0302
         SLR   @00,@00                                             0302
         IC    @00,SUBDSPL(,@01)                                   0302
         ALR   @00,@00                                             0302
         ALR   @14,@00                                             0302
         MH    @03,SUBID-4(@15,@14)                                0302
         AL    @05,@CF01819                                        0302
         STH   @07,SUPRPARM-8(@03,@05)                             0302
*                  END;                                    /*@YL026UL*/
         AL    INDEX2,@CF00227                                     0303
@DE00301 LH    @07,PARMID                                          0303
         MH    @07,@CH00038                                        0303
         LH    @05,PARMID                                          0303
         MH    @05,@CH00038                                        0303
         L     @03,PINFOPTR                                        0303
         AL    @03,@CF01818                                        0303
         L     @05,PARMPTR(@05,@03)                                0303
         SLR   @03,@03                                             0303
         IC    @03,SUBDSPL+12(,@05)                                0303
         ALR   @03,@03                                             0303
         L     @05,PINFOPTR                                        0303
         AL    @05,@CF01818                                        0303
         AL    @03,PARMPTR(@07,@05)                                0303
         CH    INDEX2,SUBCOUNT(,@03)                               0303
         BNH   @DL00301                                            0303
*            END;                                          /*@YL026UL*/
*                                                                  0304
@RF00300 LA    @07,1                                               0304
         AH    @07,PARMID                                          0304
@DE00299 STH   @07,PARMID                                          0304
         L     @05,DESCPTR                                         0304
         CH    @07,MAXID(,@05)                                     0304
         BNH   @DL00299                                            0304
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* CHECK TO SEE WHICH PARAMETER ID#S APPEAR IN  @YL026UL*/
*            /* 'NOT GROUP' SUBLISTS                         @YL026UL*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*            IF NTGRPDSP > 0                                       0305
*              THEN                                                0305
         L     @07,DESCPTR                                         0305
         CLI   NTGRPDSP(@07),0                                     0305
         BNH   @RF00305                                            0305
*DOGRP10:        DO;                                       /*@YL026UL*/
DOGRP10  DS    0H                                                  0307
*                  GRPPTR=ADDR(NTGRPTOT)+LENGTH(NTGRPTOT); /*@YL026UL*/
         L     @07,DESCPTR                                         0307
         SLR   GRPPTR,GRPPTR                                       0307
         IC    GRPPTR,NTGRPDSP(,@07)                               0307
         ALR   GRPPTR,GRPPTR                                       0307
         ALR   @07,GRPPTR                                          0307
         AL    @07,@CF00161                                        0307
         LR    GRPPTR,@07                                          0307
*                  DO INDEX2=1 TO NTGRPTOT;                /*@YL026UL*/
*                                                                  0308
         LA    INDEX2,1                                            0308
         B     @DE00308                                            0308
@DL00308 DS    0H                                                  0309
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* FOR EACH ID# IN A 'NOT GROUP'        @YL026UL*/
*                    /* SUBLIST, SAVE THE ADDRESS OF THE     @YL026UL*/
*                    /* SUBLIST IN THE 'PARMINFO' TABLE      @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    DO INDEX3=1 TO NTGRPCNT;              /*@YL026UL*/
         LA    INDEX3,1                                            0309
         B     @DE00309                                            0309
@DL00309 DS    0H                                                  0310
*                      NTGRPPTR(NTGRPID(INDEX3))=GRPPTR;   /*@YL026UL*/
         LR    @07,INDEX3                                          0310
         ALR   @07,@07                                             0310
         LH    @07,NTGRPID-2(@07,GRPPTR)                           0310
         MH    @07,@CH00038                                        0310
         L     @05,PINFOPTR                                        0310
         AL    @05,@CF01817                                        0310
         ST    GRPPTR,NTGRPPTR-4(@07,@05)                          0310
*                    END;                                  /*@YL026UL*/
         AL    INDEX3,@CF00227                                     0311
@DE00309 CH    INDEX3,NTGRPCNT(,GRPPTR)                            0311
         BNH   @DL00309                                            0311
*                    GRPPTR=GRPPTR+LENGTH(NTGRPCNT)+               0312
*                           NTGRPCNT*LENGTH(NTGRPID);      /*@YL026UL*/
         LA    @07,2                                               0312
         ALR   @07,GRPPTR                                          0312
         LH    @05,NTGRPCNT(,GRPPTR)                               0312
         ALR   @05,@05                                             0312
         ALR   @07,@05                                             0312
         LR    GRPPTR,@07                                          0312
*                  END;                                    /*@YL026UL*/
         AL    INDEX2,@CF00227                                     0313
@DE00308 L     @07,DESCPTR                                         0313
         SLR   @05,@05                                             0313
         IC    @05,NTGRPDSP(,@07)                                  0313
         ALR   @05,@05                                             0313
         AL    @05,DESCPTR                                         0313
         CH    INDEX2,NTGRPTOT(,@05)                               0313
         BNH   @DL00308                                            0313
*                END DOGRP10;                              /*@YL026UL*/
*                                                                  0314
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* SET UP THE REPEATED SUBLIST INDEX (RSI)      @YL026UL*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*            RSIPTR=PINFOPTR+MAXID*LENGTH(PARMINFO);       /*@YL026UL*/
@RF00305 L     @07,DESCPTR                                         0315
         LH    @07,MAXID(,@07)                                     0315
         MH    @07,@CH00038                                        0315
         AL    @07,PINFOPTR                                        0315
         ST    @07,RSIPTR                                          0315
*            RSICOUNT=0;                                   /*@YL026UL*/
*                                                                  0316
         SLR   @07,@07                                             0316
         STH   @07,RSICOUNT                                        0316
*            END DOGRP5;                                   /*@YL026UL*/
*                                                                  0317
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* NO PARAMETERS MAY APPEAR WITH THIS COMMAND.    @YL026UL*/
*          /* IF ANY WERE CODED, IGNORE THEM AND PRINT A     @YL026UL*/
*          /* WARNING MESSAGE.                               @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          ELSE                                                    0318
*            IF ECTNOPD=NO                                         0318
*              THEN                                                0318
         B     @RC00278                                            0318
@RF00278 L     @07,ECTPTR(,GDTPTR)                                 0318
         TM    ECTNOPD(@07),B'10000000'                            0318
         BNZ   @RF00318                                            0318
*                DO;                                       /*@YL026UL*/
*                DARGSENT=BADPARMS;                        /*@YL026UL*/
*                                                                  0320
         L     @07,DDSTRU                                          0320
         MVI   DARGSENT(@07),X'10'                                 0320
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@YL026UL*/
*                                                                  0321
         ST    GDTPTR,@AL00001                                     0321
         LA    @07,@CF00123                                        0321
         ST    @07,@AL00001+4                                      0321
         LA    @07,DDSTRU                                          0321
         ST    @07,@AL00001+8                                      0321
         MVI   @AL00001+8,X'80'                                    0321
         L     @15,GDTPRT(,GDTPTR)                                 0321
         LA    @01,@AL00001                                        0321
         BALR  @14,@15                                             0321
*                END;                                      /*@YL026UL*/
*                                                                  0322
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* ALLOCATE AND INITIALIZE SPACE FOR THE PRIMARY    @YL026UL*/
*        /* FDT POINTER VECTOR (PRIMARY DATA POINTERS AND    @YL026UL*/
*        /* VERB NAME).  IF INSUFFICIENT SPACE IS            @YL026UL*/
*        /* AVAILABLE, DISCONTINUE PROCESSING.               @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        AMTTOGET=MAXID*PTRLNGTH+LENGTH(FDTVERB);          /*@YL026UL*/
*                                                                  0323
@RF00318 DS    0H                                                  0323
@RC00278 L     @07,DESCPTR                                         0323
         LH    @07,MAXID(,@07)                                     0323
         SLA   @07,2                                               0323
         AL    @07,@CF00187                                        0323
         ST    @07,AMTTOGET                                        0323
*        CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTADDR,SPACEID,            0324
*               SETZERO);                                  /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     0324
         LA    @07,AMTTOGET                                        0324
         ST    @07,@AL00001+4                                      0324
         L     @07,@PC00001+4                                      0324
         ST    @07,@AL00001+8                                      0324
         L     @07,@PC00001+8                                      0324
         ST    @07,@AL00001+12                                     0324
         LA    @07,SETZERO                                         0324
         ST    @07,@AL00001+16                                     0324
         MVI   @AL00001+16,X'80'                                   0324
         L     @15,GDTGPL(,GDTPTR)                                 0324
         LA    @01,@AL00001                                        0324
         BALR  @14,@15                                             0324
*        RESPECIFY RTNREG RSTD;                                    0325
*        TESTRC = RTNREG;                                          0326
         LR    TESTRC,RTNREG                                       0326
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  0327
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF STORAGE COULD NOT BE OBTAINED, CALL          @Y30SSFR*/
*        /*  FAILSPAC TO HANDLE THE ERROR.                   @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        IF TESTRC ^= 0                                            0328
*          THEN                                                    0328
         LTR   TESTRC,TESTRC                                       0328
         BZ    @RF00328                                            0328
*            DO;                                           /*@YL026UL*/
*                                                                  0329
*            CALL FAILSPAC;                                /*@YL026UL*/
*                                                                  0330
         BAL   @14,FAILSPAC                                        0330
*            RETURN;                                       /*@YL026UL*/
         B     @EL00002                                            0331
*            END;                                          /*@YL026UL*/
*        FDTVERB=ECTPCMD;                                  /*@YL026UL*/
*                                                                  0333
@RF00328 L     @07,@PC00001+4                                      0333
         L     @07,FDTADDR(,@07)                                   0333
         L     @05,ECTPTR(,GDTPTR)                                 0333
         MVC   FDTVERB(8,@07),ECTPCMD(@05)                         0333
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* ALLOCATE AND INITIALIZE SPACE FOR REPEATED LIST  @YL026UL*/
*        /* FDT COUNT VECTORS.  A REPEATED PARAMETER WITH A  @YL026UL*/
*        /* REPEATED SUBLIST HAS SUCH A COUNT VECTOR.        @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*DOLOOP3:DO PARMID=1 TO MAXID;                             /*@YL026UL*/
DOLOOP3  LA    @07,1                                               0334
         B     @DE00334                                            0334
@DL00334 DS    0H                                                  0335
*          IF PARMPTR(PARMID)^=0 &                                 0335
*             REPEATED=YES & OCCURNUM > 1                          0335
*            THEN                                                  0335
         LR    @05,@07                                             0335
         MH    @05,@CH00038                                        0335
         L     @01,PINFOPTR                                        0335
         AL    @01,@CF01818                                        0335
         L     @05,PARMPTR(@05,@01)                                0335
         LTR   @05,@05                                             0335
         BZ    @RF00335                                            0335
         TM    REPEATED(@05),B'00100000'                           0335
         BNO   @RF00335                                            0335
         L     @05,OCCURNUM-1(,@05)                                0335
         LA    @05,0(,@05)                                         0335
         C     @05,@CF00227                                        0335
         BNH   @RF00335                                            0335
*              DO;                                         /*@YL026UL*/
         ST    @05,@TF00001                                        0336
*              AMTTOGET=OCCURNUM*PTRLNGTH;                 /*@YL026UL*/
*                                                                  0337
         L     @15,@TF00001                                        0337
         SLA   @15,2                                               0337
         ST    @15,AMTTOGET                                        0337
*              CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTPTR(PARMID),       0338
*                     SPACEID,SETZERO);                    /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     0338
         LA    @15,AMTTOGET                                        0338
         ST    @15,@AL00001+4                                      0338
         SLA   @07,2                                               0338
         L     @15,@PC00001+4                                      0338
         L     @01,FDTADDR(,@15)                                   0338
         LA    @07,FDTPTR-4(@07,@01)                               0338
         ST    @07,@AL00001+8                                      0338
         L     @07,@PC00001+8                                      0338
         ST    @07,@AL00001+12                                     0338
         LA    @07,SETZERO                                         0338
         ST    @07,@AL00001+16                                     0338
         MVI   @AL00001+16,X'80'                                   0338
         L     @15,GDTGPL(,GDTPTR)                                 0338
         LA    @01,@AL00001                                        0338
         BALR  @14,@15                                             0338
*              RESPECIFY RTNREG RSTD;                              0339
*              TESTRC = RTNREG;                                    0340
         LR    TESTRC,RTNREG                                       0340
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UL*/
*                                                                  0341
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  IF STORAGE COULD NOT BE OBTAINED, CALL    @Y30SSFR*/
*              /*  FAILSPAC TO HANDLE THE ERROR.             @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*              IF TESTRC ^= 0                                      0342
*                THEN                                              0342
         LTR   TESTRC,TESTRC                                       0342
         BZ    @RF00342                                            0342
*                  DO;                                     /*#YL026UL*/
*                                                                  0343
*                  CALL FAILSPAC;                          /*#YL026UL*/
*                                                                  0344
         BAL   @14,FAILSPAC                                        0344
*                  RETURN;                                 /*#YL026UL*/
         B     @EL00002                                            0345
*                  END;                                    /*#YL026UL*/
*                                                                  0346
*              END;                                        /*#YL026UL*/
@RF00342 DS    0H                                                  0348
*        END DOLOOP3;                                      /*#YL026UL*/
*                                                                  0348
@RF00335 LA    @07,1                                               0348
         AH    @07,PARMID                                          0348
@DE00334 STH   @07,PARMID                                          0348
         L     @05,DESCPTR                                         0348
         CH    @07,MAXID(,@05)                                     0348
         BNH   @DL00334                                            0348
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* BUILD THE STATIC PART OF THE PARSE PARAMETER     @YL026UL*/
*        /* LIST                                             @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PPLPTR=ADDR(PPLAREA);                             /*@YL026UL*/
         LA    @07,PPLAREA                                         0349
         ST    @07,PPLPTR                                          0349
*        PPLUPT=GDTUPT;                                    /*@YL026UL*/
         L     @05,GDTUPT(,GDTPTR)                                 0350
         ST    @05,PPLUPT(,@07)                                    0350
*        PPLECT=GDTECT;                                    /*@YL026UL*/
         L     @05,GDTECT(,GDTPTR)                                 0351
         ST    @05,PPLECT(,@07)                                    0351
*        PPLECB=ADDR(PARSECB);                             /*@YL026UL*/
         LA    @05,PARSECB                                         0352
         ST    @05,PPLECB(,@07)                                    0352
*        PPLANS=ADDR(PDLPTR);                              /*@YL026UL*/
         LA    @05,PDLPTR                                          0353
         ST    @05,PPLANS(,@07)                                    0353
*        PPLUWA=NULLPTR;                                   /*@YL026UL*/
*                                                                  0354
*                                                                  0354
         SLR   @05,@05                                             0354
         ST    @05,PPLUWA(,@07)                                    0354
*        END RISETUP;                                      /*@YL026UL*/
*                                                                  0355
         B     @EL00002                                            0355
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - MAINSCAN                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE CONTROLS THE PROCESSING OF ALL  @YL026UL*/
*/*             COMMAND PARAMETERS NOT APPEARING WITHIN      @YL026UL*/
*/*             REPEATED SUBPARAMETER LISTS.  CONTROL IS     @YL026UL*/
*/*             GIVEN TO ROUTINES WHICH PARSE THE PARMS,     @YL026UL*/
*/*             TRANSLATE THE ENCODED PARMS FROM PDL FORM    @YL026UL*/
*/*             INTO FDT FORM, AND CHECK FOR SEMANTIC ERRORS @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            GDTCMD - POINTER TO INPUT COMMAND.            @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            FDT -    ENCODED DATA FOR PARAMETERS NOT      @YL026UL*/
*/*                     APPEARING WITHIN REPEATED SUBPARM    @YL026UL*/
*/*                     LISTS                                @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/
*/*                      ZERO VALUE IF PROCESSING OF THE     @YL026UL*/
*/*                      COMMAND CANNOT CONTINUE.            @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*MAINSCAN:PROCEDURE;                                       /*@YL026UL*/
MAINSCAN STM   @14,@02,@SA00003                                    0356
         STM   @05,@06,@SA00003+20                                 0356
         STM   @08,@12,@SA00003+28                                 0356
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** MAINSCAN **  PROCESS MAIN SET OF PARAMETERS  @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0357
         L     @05,GDTTR2(,GDTPTR)                                 0357
         MVC   @TS00001(95),NEWERID2(@05)                          0357
         MVC   OLDERID2(95,@05),@TS00001                           0357
*        NEWID2='RI12';                                    /*@YL026UL*/
*                                                                  0358
         MVC   NEWID2(4,@05),@CC01544                              0358
*        PRMSETID=0;                                       /*@YL026UL*/
         SLR   @05,@05                                             0359
         STH   @05,PRMSETID                                        0359
*        SUPERID=0;                                        /*@YL026UL*/
*                                                                  0360
         STH   @05,SUPERID                                         0360
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SET UP THE PARSE PARAMETER LIST IN PREPARATION   @YL026UL*/
*        /* FOR PARSING ALL COMMAND PARAMETERS NOT WITHIN    @YL026UL*/
*        /* REPEATED SUBLISTS.  THEN CALL THE TSO 'PARSE'    @YL026UL*/
*        /* SERVICE ROUTINE TO ENCODE THE COMMAND INTO A PDL @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PPLPCL=DESCPTR+PCLDSPL1;                          /*@YL026UL*/
         L     @02,PPLPTR                                          0361
         L     @15,DESCPTR                                         0361
         LH    @14,PCLDSPL1(,@15)                                  0361
         ALR   @14,@15                                             0361
         ST    @14,PPLPCL(,@02)                                    0361
*        PPLCBUF=GDTCMB;                                   /*@YL026UL*/
         L     @15,GDTCMB(,GDTPTR)                                 0362
         ST    @15,PPLCBUF(,@02)                                   0362
*        PARSECB=0;                                        /*@YL026UL*/
*                                                                  0363
         ST    @05,PARSECB                                         0363
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     0364
*          RESPECIFY GPR01P RSTD;                                  0365
*          GPR01P = ADDR(PPL);                                     0366
         LR    GPR01P,@02                                          0366
*          IF CVTPARS = 0                                          0367
*            THEN                                                  0367
         L     @02,CVTPTR                                          0367
         C     @05,CVTPARS(,@02)                                   0367
         BNE   @RF00367                                            0367
*              GEN(LINK EP=IKJPARS);                               0368
         LINK EP=IKJPARS
*            ELSE                                                  0369
*              CALL CVTPARS;                                       0369
         B     @RC00367                                            0369
@RF00367 L     @05,CVTPTR                                          0369
         L     @15,CVTPARS(,@05)                                   0369
         BALR  @14,@15                                             0369
*          RESPECIFY GPR01P UNRSTD;                                0370
@RC00367 DS    0H                                                  0371
*        END;                  /* @Z40GSJG*/                       0371
*                                                                  0371
*        RESPECIFY RTNREG RSTD;                                    0372
*        TESTRC = RTNREG;                                          0373
         LR    TESTRC,RTNREG                                       0373
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  0374
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CHECK THE RETURN CODE FROM 'PARSE'.  IF PARSING  @YL026UL*/
*        /* WAS NOT SUCCESSFUL, DISCONTINUE PROCESSING.      @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF TESTRC^=0                                              0375
*          THEN                                                    0375
         LTR   TESTRC,TESTRC                                       0375
         BZ    @RF00375                                            0375
*            DO;                                           /*@YL026UL*/
*            IF TESTRC=BADSPACE                                    0377
*              THEN                                                0377
*                                                                  0377
         C     TESTRC,@CF00487                                     0377
         BNE   @RF00377                                            0377
*                CALL FAILSPAC;                            /*@YL026UL*/
*                                                                  0378
         BAL   @14,FAILSPAC                                        0378
*              ELSE                                                0379
*                LASTCC=LASTCC12;                          /*@YL026UL*/
         B     @RC00377                                            0379
@RF00377 L     @05,@PC00001+16                                     0379
         MVC   LASTCC(2,@05),@CH00038                              0379
*            RETURN;                                       /*@YL026UL*/
@EL00003 DS    0H                                                  0380
@EF00003 DS    0H                                                  0380
@ER00003 LM    @14,@02,@SA00003                                    0380
         LM    @05,@06,@SA00003+20                                 0380
         LM    @08,@12,@SA00003+28                                 0380
         BR    @14                                                 0380
*            END;                                          /*@YL026UL*/
*                                                                  0381
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* TRANSLATE THE ENCODED PARAMETERS FROM PDL FORM   @YL026UL*/
*        /* INTO FDT FORM, CHECKING FOR SEMANTIC ERRORS THAT @YL026UL*/
*        /* MAY EXIST IN CONSTANTS THAT WERE CODED           @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PROMPT=NO;                                        /*@YL026UL*/
@RF00375 DS    0H                                                  0383
*        SINGLPRM=NO;                                      /*@YL026UL*/
*                                                                  0383
         NI    PROMPT,B'00111111'                                  0383
*        CALL TRNSLATE;                                    /*@YL026UL*/
*                                                                  0384
         BAL   @14,TRNSLATE                                        0384
*        IF LASTCC^=0                                              0385
*          THEN                                                    0385
         L     @05,@PC00001+16                                     0385
         LH    @05,LASTCC(,@05)                                    0385
         LTR   @05,@05                                             0385
         BNZ   @RT00385                                            0385
*            RETURN;                                       /*@YL026UL*/
*                                                                  0386
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CHECK FOR CONFLICTING PARAMETERS, APPLY DEFAULT  @YL026UL*/
*        /* PARAMETERS, AND PROMPT FOR MISSING PARAMETERS.   @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        GOODCMD=NO;                                       /*@YL026UL*/
         NI    GOODCMD,B'11101111'                                 0387
*        DO WHILE(GOODCMD=NO & LASTCC=0);                  /*@YL026UL*/
*                                                                  0388
         B     @DE00388                                            0388
@DL00388 DS    0H                                                  0389
*          CALL NOTPARMS;                                  /*@YL026UL*/
*                                                                  0389
         BAL   @14,NOTPARMS                                        0389
*          IF LASTCC=0                                             0390
*            THEN                                                  0390
*                                                                  0390
         L     @05,@PC00001+16                                     0390
         LH    @05,LASTCC(,@05)                                    0390
         LTR   @05,@05                                             0390
         BNZ   @RF00390                                            0390
*              CALL DEFAULTS;                              /*@YL026UL*/
*                                                                  0391
         BAL   @14,DEFAULTS                                        0391
*          IF LASTCC=0                                             0392
*            THEN                                                  0392
*                                                                  0392
@RF00390 L     @05,@PC00001+16                                     0392
         LH    @05,LASTCC(,@05)                                    0392
         LTR   @05,@05                                             0392
         BNZ   @RF00392                                            0392
*              CALL NEEDPRMS;                              /*@YL026UL*/
*                                                                  0393
         BAL   @14,NEEDPRMS                                        0393
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  RETURN TO THE TOPLEVEL OF RI04 IF A LOWER   @Y30SSFR*/
*            /*  LEVEL PROCEDURE HAS FOUND AN ERROR.         @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            ELSE                                                  0394
*              RETURN;                                     /*@YL026UL*/
*                                                                  0394
*        END;                                              /*@YL026UL*/
*                                                                  0395
*                                                                  0395
@DE00388 TM    GOODCMD,B'00010000'                                 0395
         BNZ   @DC00388                                            0395
         L     @05,@PC00001+16                                     0395
         LH    @05,LASTCC(,@05)                                    0395
         LTR   @05,@05                                             0395
         BZ    @DL00388                                            0395
@DC00388 DS    0H                                                  0396
*        END MAINSCAN;                                     /*@YL026UL*/
*                                                                  0396
         B     @EL00003                                            0396
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - SUBSCAN                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE CONTROLS THE PROCESSING OF ALL  @YL026UL*/
*/*             COMMAND PARAMETERS APPEARING WITHIN A SINGLE @YL026UL*/
*/*             REPEATED SUBPARAMETER LIST.  CONTROL IS      @YL026UL*/
*/*             GIVEN TO ROUTINES WHICH PARSE THE PARMS,     @YL026UL*/
*/*             TRANSLATE THE ENCODED PARMS FROM PDL FORM    @YL026UL*/
*/*             INTO FDT FORM, AND CHECK FOR SEMANTIC ERRORS @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            RSI -     REPEATED SUBLIST INDEX.             @YL026UL*/
*/*            REPINDEX- INDEX POINTING TO THE RSI ENTRY     @YL026UL*/
*/*                      DESCRIBING THE SUBLIST TO BE        @YL026UL*/
*/*                      PROCESSED.                          @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            FDT -     ENCODED DATA FOR PARAMETERS THAT    @YL026UL*/
*/*                      WERE CODED WITHIN A REPETITION OF   @YL026UL*/
*/*                      A REPEATED SUBPARAMETER LIST.       @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/
*/*                      ZERO VALUE IF PROCESSING OF THE     @YL026UL*/
*/*                      COMMAND CANNOT CONTINUE.            @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*SUBSCAN:PROCEDURE;                                        /*@YL026UL*/
SUBSCAN  STM   @14,@02,@SA00004                                    0397
         STM   @05,@06,@SA00004+20                                 0397
         STM   @08,@12,@SA00004+28                                 0397
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** SUBSCAN **  PROCESS REP'D SUBLIST PARAMETERS @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0398
         L     @02,GDTTR2(,GDTPTR)                                 0398
         MVC   @TS00001(95),NEWERID2(@02)                          0398
         MVC   OLDERID2(95,@02),@TS00001                           0398
*        NEWID2='RI14';                                    /*@YL026UL*/
*                                                                  0399
         MVC   NEWID2(4,@02),@CC01552                              0399
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* OBTAIN THE ID# OF THE PARAMETER WHOSE REPEATED   @YL026UL*/
*        /* SUBLIST REPETITION IS TO BE PROCESSED NEXT.      @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PRMSETID=SBLSTID(REPINDEX);                       /*@YL026UL*/
         L     @02,RSIPTR                                          0400
         LA    @15,12                                              0400
         LR    @14,@15                                             0400
         MH    @14,REPINDEX                                        0400
         LA    @01,0(@14,@02)                                      0400
         AL    @01,@CF01821                                        0400
         LH    @01,SBLSTID-6(,@01)                                 0400
         STH   @01,PRMSETID                                        0400
*        SUPERID=PRMSETID;                                 /*@YL026UL*/
         STH   @01,SUPERID                                         0401
*        PARMID=SUPERID;                                   /*@YL026UL*/
*                                                                  0402
         STH   @01,PARMID                                          0402
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SET UP THE PARSE PARM LIST IN PREPARATION FOR    @YL026UL*/
*        /* PROCESSING THE PARMS OF THE SUBLIST REPETITION.  @YL026UL*/
*        /* OBTAIN SPACE FOR A COMMAND BUFFER IN WHICH TO    @YL026UL*/
*        /* PUT THE SUBPARAMETERS TO BE PARSED.              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PPLPCL=DESCPTR+PCLDSPL2;                          /*@YL026UL*/
         MR    @00,@15                                             0403
         L     @02,PINFOPTR                                        0403
         AL    @02,@CF01818                                        0403
         AL    @15,PARMPTR(@01,@02)                                0403
         LH    @02,PCLDSPL2(,@15)                                  0403
         N     @02,@CF01822                                        0403
         AL    @02,DESCPTR                                         0403
         L     @01,PPLPTR                                          0403
         ST    @02,PPLPCL(,@01)                                    0403
*        PARSECB=0;                                        /*@YL026UL*/
         SLR   @02,@02                                             0404
         ST    @02,PARSECB                                         0404
*        AMTTOGET=SBLSTLEN(REPINDEX)+2*LENGTH(PSETLEN)+1;  /*@YL026UL*/
*                                                                  0405
         L     @02,RSIPTR                                          0405
         LA    @15,5                                               0405
         AL    @02,@CF01817                                        0405
         AH    @15,SBLSTLEN-4(@14,@02)                             0405
         ST    @15,AMTTOGET                                        0405
*        CALL IDCSAGP0(GDTTBL,AMTTOGET,BUFFPTR ,                   0406
*               SPACEID,SETZERO);                          /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     0406
         LA    @02,AMTTOGET                                        0406
         ST    @02,@AL00001+4                                      0406
         LA    @02,BUFFPTR                                         0406
         ST    @02,@AL00001+8                                      0406
         L     @02,@PC00001+8                                      0406
         ST    @02,@AL00001+12                                     0406
         LA    @02,SETZERO                                         0406
         ST    @02,@AL00001+16                                     0406
         MVI   @AL00001+16,X'80'                                   0406
         L     @15,GDTGPL(,GDTPTR)                                 0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*        RESPECIFY RTNREG RSTD;                                    0407
*        TESTRC = RTNREG;                                          0408
         LR    TESTRC,RTNREG                                       0408
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  0409
*        IF TESTRC^=0                                              0410
*          THEN                                                    0410
         LTR   TESTRC,TESTRC                                       0410
         BZ    @RF00410                                            0410
*            DO;                                           /*@YL026UL*/
*                                                                  0411
*            CALL FAILSPAC;                                /*@YL026UL*/
*                                                                  0412
         BAL   @14,FAILSPAC                                        0412
*            RETURN;                                       /*@YL026UL*/
@EL00004 DS    0H                                                  0413
@EF00004 DS    0H                                                  0413
@ER00004 LM    @14,@02,@SA00004                                    0413
         LM    @05,@06,@SA00004+20                                 0413
         LM    @08,@12,@SA00004+28                                 0413
         BR    @14                                                 0413
*            END;                                          /*@YL026UL*/
*                                                                  0414
*          ELSE                                                    0415
*            PPLCBUF=BUFFPTR ;                             /*@YL026UL*/
*                                                                  0415
@RF00410 L     @05,BUFFPTR                                         0415
         L     @02,PPLPTR                                          0415
         ST    @05,PPLCBUF(,@02)                                   0415
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* MOVE THE PARAMETERS OF THE SUBLIST REPETITION    @YL026UL*/
*        /* FROM THE ORIGINAL COMMAND OR PROMPT RESPONSE     @YL026UL*/
*        /* BUFFER INTO THE PARSE BUFFER.  IF EACH REP IS    @YL026UL*/
*        /* DEFINED TO BE JUST A SIMPLE LIST OF CONSTANTS,   @YL026UL*/
*        /* INSERT A LEFT PARENTHESIS PRECEDING THE PARM SET @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF SUBCOUNT=1 & PARMTYPE(1)='P ' &                        0416
*           PARMPTR(SUBID(1))->LIST=YES                            0416
*          THEN                                                    0416
         LA    @02,1                                               0416
         L     @15,PINFOPTR                                        0416
         LA    @14,12                                              0416
         LR    @01,@14                                             0416
         MH    @01,PARMID                                          0416
         AL    @01,@CF01818                                        0416
         L     @01,PARMPTR(@01,@15)                                0416
         LR    @00,@01                                             0416
         ALR   @00,@14                                             0416
         LR    @05,@00                                             0416
         SLR   @00,@00                                             0416
         IC    @00,SUBDSPL(,@05)                                   0416
         ALR   @00,@00                                             0416
         ALR   @01,@00                                             0416
         CH    @02,SUBCOUNT(,@01)                                  0416
         BNE   @RF00416                                            0416
         CLC   PARMTYPE(2,@01),@CC01553                            0416
         BNE   @RF00416                                            0416
         LR    @05,@14                                             0416
         MH    @05,SUBID(,@01)                                     0416
         AL    @15,@CF01818                                        0416
         L     @05,PARMPTR(@05,@15)                                0416
         TM    LIST(@05),B'00001000'                               0416
         BNO   @RF00416                                            0416
*            DO;                                           /*@YL026UL*/
*            PSETLEN=SBLSTLEN(REPINDEX)+1;                 /*@YL026UL*/
         L     @05,BUFFPTR                                         0418
         L     @15,RSIPTR                                          0418
         MH    @14,REPINDEX                                        0418
         LA    @01,0(@14,@15)                                      0418
         AL    @01,@CF01817                                        0418
         AH    @02,SBLSTLEN-4(,@01)                                0418
         STH   @02,PSETLEN(,@05)                                   0418
*            PARMSET(1)=PAREN;                             /*@YL026UL*/
         MVI   PARMSET(@05),C'('                                   0419
*            PARMSET(2:PSETLEN)=SBLSTPTR(REPINDEX)->               0420
*                               DATABLK(1:PSETLEN-1);      /*@YL026UL*/
         BCTR  @02,0                                               0420
         BCTR  @02,0                                               0420
         AL    @15,@CF01818                                        0420
         L     @01,SBLSTPTR(@14,@15)                               0420
         EX    @02,@SM01823                                        0420
*            END;                                          /*@YL026UL*/
*          ELSE                                                    0422
*            DO;                                           /*@YL026UL*/
         B     @RC00416                                            0422
@RF00416 DS    0H                                                  0423
*            PSETLEN=SBLSTLEN(REPINDEX);                   /*@YL026UL*/
         L     @05,BUFFPTR                                         0423
         L     @02,RSIPTR                                          0423
         LH    @15,REPINDEX                                        0423
         MH    @15,@CH00038                                        0423
         LA    @01,0(@15,@02)                                      0423
         AL    @01,@CF01817                                        0423
         LH    @14,SBLSTLEN-4(,@01)                                0423
         STH   @14,PSETLEN(,@05)                                   0423
*            PARMSET(1:PSETLEN)=SBLSTPTR(REPINDEX)->               0424
*                               DATABLK(1:PSETLEN);        /*@YL026UL*/
         BCTR  @14,0                                               0424
         AL    @02,@CF01818                                        0424
         L     @02,SBLSTPTR(@15,@02)                               0424
         EX    @14,@SM01825                                        0424
*            END;                                          /*@YL026UL*/
*        PSETLEN=PSETLEN+LENGTH(CBUFF);                    /*@YL026UL*/
*                                                                  0426
@RC00416 L     @05,BUFFPTR                                         0426
         LA    @02,4                                               0426
         AH    @02,PSETLEN(,@05)                                   0426
         STH   @02,PSETLEN(,@05)                                   0426
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CALL 'PARSE' TO ENCODE THE PARAMETERS.  IF       @YL026UL*/
*        /* 'PARSE' IS UNSUCCESSFUL, DISCONTINUE PROCESSING. @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0427
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     0427
*          RESPECIFY GPR01P RSTD;                                  0428
*          GPR01P = ADDR(PPL);                                     0429
         L     GPR01P,PPLPTR                                       0429
*          IF CVTPARS = 0                                          0430
*            THEN                                                  0430
         L     @05,CVTPTR                                          0430
         L     @05,CVTPARS(,@05)                                   0430
         LTR   @05,@05                                             0430
         BNZ   @RF00430                                            0430
*              GEN(LINK EP=IKJPARS);                               0431
         LINK EP=IKJPARS
*            ELSE                                                  0432
*              CALL CVTPARS;                                       0432
         B     @RC00430                                            0432
@RF00430 L     @05,CVTPTR                                          0432
         L     @15,CVTPARS(,@05)                                   0432
         BALR  @14,@15                                             0432
*          RESPECIFY GPR01P UNRSTD;                                0433
@RC00430 DS    0H                                                  0434
*        END;                   /*@Z40GSJG*/                       0434
*                                                                  0434
*        RESPECIFY RTNREG RSTD;                                    0435
*        TESTRC = RTNREG;                                          0436
         LR    TESTRC,RTNREG                                       0436
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  0437
*        IF TESTRC^=0                                              0438
*          THEN                                                    0438
         LTR   TESTRC,TESTRC                                       0438
         BZ    @RF00438                                            0438
*            DO;                                           /*@YL026UL*/
*            IF TESTRC=BADSPACE                                    0440
*              THEN                                                0440
*                                                                  0440
         C     TESTRC,@CF00487                                     0440
         BNE   @RF00440                                            0440
*                CALL FAILSPAC;                            /*@YL026UL*/
*                                                                  0441
         BAL   @14,FAILSPAC                                        0441
*              ELSE                                                0442
*                LASTCC=LASTCC12;                          /*@YL026UL*/
         B     @RC00440                                            0442
@RF00440 L     @05,@PC00001+16                                     0442
         MVC   LASTCC(2,@05),@CH00038                              0442
*            RETURN;                                       /*@YL026UL*/
         B     @EL00004                                            0443
*            END;                                          /*@YL026UL*/
*                                                                  0444
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* RESET THE PARAMETER OCCURRENCE FLAGS TO ZEROS.   @YL026UL*/
*        /* THEN TRANSLATE THE ENCODED PARAMETERS FROM PDL   @YL026UL*/
*        /* FORM INTO FDT FORM, CHECKING FOR SEMANTIC ERRORS @YL026UL*/
*        /* THAT MAY EXIST IN THE CONSTANTS THAT WERE CODED  @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DO INDEX2=1 TO MAXID;                             /*@YL026UL*/
@RF00438 LA    INDEX2,1                                            0445
         B     @DE00445                                            0445
@DL00445 DS    0H                                                  0446
*          PARMFLAG(INDEX2)=0;                             /*@YL026UL*/
         LR    @05,INDEX2                                          0446
         MH    @05,@CH00038                                        0446
         SLR   @15,@15                                             0446
         L     @14,PINFOPTR                                        0446
         BCTR  @14,0                                               0446
         BCTR  @14,0                                               0446
         STC   @15,PARMFLAG-10(@05,@14)                            0446
*        END;                                              /*@YL026UL*/
         AL    INDEX2,@CF00227                                     0447
@DE00445 L     @05,DESCPTR                                         0447
         CH    INDEX2,MAXID(,@05)                                  0447
         BNH   @DL00445                                            0447
*        PROMPT=NO;                                        /*@YL026UL*/
*        SINGLPRM=NO;                                      /*@YL026UL*/
*                                                                  0449
         NI    PROMPT,B'00111111'                                  0449
*        CALL TRNSLATE;                                    /*@YL026UL*/
*                                                                  0450
         BAL   @14,TRNSLATE                                        0450
*        IF LASTCC^=0                                              0451
*          THEN                                                    0451
         L     @05,@PC00001+16                                     0451
         LH    @05,LASTCC(,@05)                                    0451
         LTR   @05,@05                                             0451
         BNZ   @RT00451                                            0451
*            RETURN;                                       /*@YL026UL*/
*                                                                  0452
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CHECK FOR CONFLICTING PARAMETERS, APPLY DEFAULT  @YL026UL*/
*        /* PARAMETERS, AND PROMPT FOR MISSING PARAMETERS.   @YL026UL*/
*        /* PERFORM THESE FUNCTIONS ONLY UPON PARMS DEFINED  @YL026UL*/
*        /* AS PART OF THE CURRENT REPEATED SUBLIST PARM SET @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        GOODCMD=NO;                                       /*@YL026UL*/
         NI    GOODCMD,B'11101111'                                 0453
*        DO WHILE(GOODCMD=NO & LASTCC=0);                  /*@YL026UL*/
*                                                                  0454
         B     @DE00454                                            0454
@DL00454 DS    0H                                                  0455
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  CALL NOTPARMS TO CHECK FOR ANY CONFLICTING    @Y30SSFR*/
*          /*  PARAMTETERS.                                  @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*          CALL NOTPARMS;                                  /*@YL026UL*/
*                                                                  0455
         BAL   @14,NOTPARMS                                        0455
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF NOTPARMS COMPLETES SUCCESSFULLY, CALL      @Y30SSFR*/
*          /*  DEFAULTS TO SET UP THE DEFAULTED PARAMETERS.  @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*          IF LASTCC=0                                             0456
*            THEN                                                  0456
*                                                                  0456
         L     @05,@PC00001+16                                     0456
         LH    @05,LASTCC(,@05)                                    0456
         LTR   @05,@05                                             0456
         BNZ   @RF00456                                            0456
*              CALL DEFAULTS;                              /*@YL026UL*/
*                                                                  0457
         BAL   @14,DEFAULTS                                        0457
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF DEFAULTS COMPLETES SUCCESSFULLY, CALL      @Y30SSFR*/
*          /*  NEEDPARMS TO PROMPT FOR ANY MISSING, BUT      @Y30SSFR*/
*          /*  REQUIRED PARAMETERS.                          @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*          IF LASTCC=0                                             0458
*            THEN                                                  0458
*                                                                  0458
@RF00456 L     @05,@PC00001+16                                     0458
         LH    @05,LASTCC(,@05)                                    0458
         LTR   @05,@05                                             0458
         BNZ   @RF00458                                            0458
*              CALL NEEDPRMS;                              /*@YL026UL*/
*                                                                  0459
         BAL   @14,NEEDPRMS                                        0459
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  ONE OF NOTPARMS, DEFAULTS, OR NEEDPARMS     @Y30SSFR*/
*            /*  HAS FAILED.  RETURN TO THE CALLER OF        @Y30SSFR*/
*            /*  SUBSCAN.                                    @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            ELSE                                                  0460
*              RETURN;                                     /*#YL026UL*/
*        END;                                              /*@YL026UL*/
*                                                                  0461
*                                                                  0461
@DE00454 TM    GOODCMD,B'00010000'                                 0461
         BNZ   @DC00454                                            0461
         L     @05,@PC00001+16                                     0461
         LH    @05,LASTCC(,@05)                                    0461
         LTR   @05,@05                                             0461
         BZ    @DL00454                                            0461
@DC00454 DS    0H                                                  0462
*        END SUBSCAN;                                      /*@YL026UL*/
*                                                                  0462
         B     @EL00004                                            0462
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - TRNSLATE                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE CONTROLS THE TRANSLATION OF ALL @YL026UL*/
*/*             INPUT PARAMETERS FROM THE ENCODED PDL FORM   @YL026UL*/
*/*             INTO THE ENCODED FDT FORM.  'TRNSLATE' USES  @YL026UL*/
*/*             THE ID# OF THE 'CURRENT' SUPERPARAMETER TO   @YL026UL*/
*/*             DETERMINE THE SET OF PARAMETERS WHICH MAY BE @YL026UL*/
*/*             ENCODED IN THE PDL TO BE TRANSLATED DURING   @YL026UL*/
*/*             THE CURRENT INVOCATION.  PARAMETERS FOUND TO @YL026UL*/
*/*             BE INPUT AND ENCODED IN THE PDL ARE CHECKED  @YL026UL*/
*/*             TO SEE IF THEY HAVE A REPEATED SUBLIST--IF   @YL026UL*/
*/*             SO, SUBLIST INFORMATION IS SAVED IN ORDER TO @YL026UL*/
*/*             LATER PROCESS THE SUBLIST.  IF NOT A SUBLIST @YL026UL*/
*/*             THEN THE DATA IS ENCODED INTO THE FDT.       @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            SINGLPRM- FLAG SET 'ON' WHEN JUST A SINGLE    @YL026UL*/
*/*                      PARM IS TO BE TRANSLATED FROM PDL   @YL026UL*/
*/*                      FORM INTO FDT FORM.                 @YL026UL*/
*/*            PDLPTR -  POINTER TO THE PDL CONTAINING THE   @YL026UL*/
*/*                      PARSE-ENCODED DATA TO BE TRANSLATED @YL026UL*/
*/*                      INTO FDT FORM.                      @YL026UL*/
*/*            PARMPTR - POINTER TO DESCRIPTOR SECTION THAT  @YL026UL*/
*/*                      DESCRIBES THE PARM CURRENTLY BEING  @YL026UL*/
*/*                      TRANSLATED (FROM 'PARMINFO')        @YL026UL*/
*/*            SUPRPARM- PARM ID# OF THE SUPERPARAMETER OF   @YL026UL*/
*/*                      THE PARM CURRENTLY BEING EXAMINED   @YL026UL*/
*/*                      (FROM 'PARMINFO')                   @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            PARMFLAG- CODE INDICATING IF A PARAMETER MAY  @YL026UL*/
*/*                      BE INPUT OR ACTUALLY IS INPUT       @YL026UL*/
*/*                      (FROM 'PARMINFO')                   @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/
*/*                      ZERO VALUE IF PROCESSING OF THE     @YL026UL*/
*/*                      COMMAND CANNOT CONTINUE.            @YL026UL*/
*/*            FDT -     FUNCTION DATA TABLE ENTRIES FOR     @YL026UL*/
*/*                      KEYWORDS WHICH HAVE BEEN INPUT AND  @YL026UL*/
*/*                      WHICH HAVE NO SUBFIELDS.            @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*TRNSLATE:PROCEDURE;                                       /*@YL026UL*/
TRNSLATE STM   @14,@02,@SA00005                                    0463
         STM   @04,@06,@SA00005+20                                 0463
         STM   @08,@12,@SA00005+32                                 0463
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** TRNSLATE **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0464
*        DCL PDEPTR   PTR(31);         /*PTR TO THE PDE NOW  @YL026UL*/
*                                      /*BEING EXAMINED      @YL026UL*/
*                                                                  0465
*        /*PDE FORMAT FOR A NUMERIC CONSTANT OR FOR A        @YL026UL*/
*        /*STRING CONSTANT WITHOUT PASSWORD                  @YL026UL*/
*        DCL 1 PDE1 BDY(WORD) BASED(PDEPTR),                       0465
*              2 CONSTPTR PTR(31),     /*PTR TO THE CONSTANT @YL026UL*/
*              2 CONSTLEN FIXED(15),   /*LENGTH OF CONSTANT  @YL026UL*/
*              2 CONSTIN  BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/
*                                      /*CONSTANT WAS INPUT  @YL026UL*/
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/
*              2 NXTCPDE  PTR(31);     /*PTR TO NEXT PDE IF  @YL026UL*/
*                                      /*THE CURRENT PARM IS @YL026UL*/
*                                      /*A LIST OF CONSTANTS @YL026UL*/
*                                                                  0466
*        /*PDE FORMAT FOR A DATA SET NAME CONSTANT OR FOR A  @YL026UL*/
*        /*STRING CONSTANT WITH OPTIONAL PASSWORD            @YL026UL*/
*        DCL 1 PDE2 BDY(WORD) BASED(PDEPTR),                       0466
*              2 DSNPTR   PTR(31),     /*PTR TO THE NAME     @YL026UL*/
*              2 DSNLEN   FIXED(15),   /*LENGTH OF NAME      @YL026UL*/
*              2 DSNIN    BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/
*                                      /*NAME WAS INPUT      @YL026UL*/
*              2 DSNQUOTE BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/
*                                      /*INPUT NAME WAS      @YL026UL*/
*                                      /*CODED WITHIN QUOTES @YL026UL*/
*              2 *        BIT(6),      /*RESERVED            @YL026UL*/
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/
*              2 MEMPTR   PTR(31),     /*PTR TO MEMBER NAME  @YL026UL*/
*              2 MEMLEN   FIXED(15),   /*MEMBER NAME LENGTH  @YL026UL*/
*              2 MEMIN    BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/
*                                      /*THE DSNAME HAS A    @YL026UL*/
*                                      /*MEMBER NAME         @YL026UL*/
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/
*              2 PWDPTR   PTR(31),     /*PTR TO PASSWORD     @YL026UL*/
*              2 PWDLEN   FIXED(15),   /*LENGTH OF PASSWORD  @YL026UL*/
*              2 PWDIN    BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/
*                                      /*PASSWORD WAS GIVEN  @YL026UL*/
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/
*              2 NXTDPDE  PTR(31);     /*PTR TO NEXT PDE IF  @YL026UL*/
*                                      /*CURRENT PARM IS A   @YL026UL*/
*                                      /*LIST OF NAMES       @YL026UL*/
*                                                                  0467
*        /*PDE FORMAT FOR A KEYWORD                          @YL026UL*/
*        DCL KWDID    FIXED(15) BASED(PDEPTR);             /*@YL026UL*/
*                                                                  0467
*        DCL PDENUMBR FIXED(31)        /*INPUT NUMBER        @YL026UL*/
*                     BASED(CONSTPTR);                     /*@YL026UL*/
*        DCL PDESTRNG CHAR(*)          /*INPUT STRING        @YL026UL*/
*                     BASED(CONSTPTR);                     /*@YL026UL*/
*        DCL PDEDSN   CHAR(*)          /*INPUT DSNAME OR     @YL026UL*/
*                     BASED(DSNPTR);   /*STRING W/ OPTIONAL  @YL026UL*/
*                                      /*PASSWORD            @YL026UL*/
*        DCL PDEMEM   CHAR(*)          /*INPUT MEMBER NAME   @YL026UL*/
*                     BASED(MEMPTR);                       /*@YL026UL*/
*        DCL PDEPWD   CHAR(*)          /*INPUT PASSWORD      @YL026UL*/
*                     BASED(PWDPTR);                       /*@YL026UL*/
*        DCL CODED    BIT(1)           /*PDE FLAG SET 'ON'   @YL026UL*/
*                     BASED(PDEPTR+6); /*IF PRIMARY CONSTANT @YL026UL*/
*                                      /*IS INPUT.           @YL026UL*/
*                                                                  0474
*        DCL REPCOUNT FIXED(15);       /*COUNT OF SUBLIST    @YL026UL*/
*                                      /*REPETITIONS.        @YL026UL*/
*        DCL LISTTOTL FIXED(15);       /*COUNT OF CONSTANTS  @YL026UL*/
*                                      /*IN DATA LIST        @YL026UL*/
*        DCL BASEPTR  PTR(31);         /*PTR FOR TEMPORARILY @YL026UL*/
*                                      /*SAVING AN ADDRESS   @YL026UL*/
*        DCL MOVELEN  FIXED(15);       /*AMT OF DATA AREA TO @YL026UL*/
*                                      /*BE MOVED            @YL026UL*/
*        DCL PDLHDR   FIXED(15)        /*PDL HEADER LENGTH   @YL026UL*/
*                     CONSTANT(8);                         /*@YL026UL*/
*                                                                  0478
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** TRNSLATE **  TRANSLATE FROM PDL TO FDT       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0479
         L     @02,GDTTR2(,GDTPTR)                                 0479
         MVC   @TS00001(95),NEWERID2(@02)                          0479
         MVC   OLDERID2(95,@02),@TS00001                           0479
*        NEWID2='RI16';                                    /*@YL026UL*/
*                                                                  0480
         MVC   NEWID2(4,@02),@CC01595                              0480
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF 'TRNSLATE' HAS BEEN INVOKED TO TRANSLATE JUST @YL026UL*/
*        /* A SINGLE PARAMETER, THEN THE PARM'S ID# IS KNOWN @YL026UL*/
*        /* UPON ENTRY.  THE FACT THAT IT IS INPUT IS NOTED  @YL026UL*/
*        /* IN THE PARM OCCURRENCE TABLE AND THE PDE WITH    @YL026UL*/
*        /* THE ENCODED VALUE(S) IS POINTED TO.              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF SINGLPRM=YES                                           0481
*          THEN                                                    0481
         TM    SINGLPRM,B'01000000'                                0481
         BNO   @RF00481                                            0481
*DOGRP20:    DO;                                           /*@YL026UL*/
DOGRP20  DS    0H                                                  0483
*            PARMFLAG(PARMID)=INPUT;                       /*@YL026UL*/
         L     @02,PINFOPTR                                        0483
         LH    @15,PARMID                                          0483
         MH    @15,@CH00038                                        0483
         LA    @14,2                                               0483
         LA    @01,0(@15,@02)                                      0483
         BCTR  @01,0                                               0483
         BCTR  @01,0                                               0483
         STC   @14,PARMFLAG-10(,@01)                               0483
*            PDEPTR=PDLPTR+PDLHDR;                         /*@YL026UL*/
*                                                                  0484
         LA    PDEPTR,8                                            0484
         AL    PDEPTR,PDLPTR                                       0484
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* IF THE 'VALUE' OF THE PARM IS A REPETITION   @YL026UL*/
*            /* OF A REPEATED SUBPARAMETER LIST, THEN SAVE   @YL026UL*/
*            /* INFORMATION ABOUT THE REPETITION FOR LATER   @YL026UL*/
*            /* PROCESSING.  IF NOT A SUBLIST REP., MOVE THE @YL026UL*/
*            /* ITEM INTO THE FDT.                           @YL026UL*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*            IF REPEATED=YES                                       0485
*              THEN                                                0485
*                                                                  0485
         AL    @02,@CF01818                                        0485
         L     @02,PARMPTR(@15,@02)                                0485
         TM    REPEATED(@02),B'00100000'                           0485
         BNO   @RF00485                                            0485
*                CALL REPLIST;                             /*@YL026UL*/
*                                                                  0486
         BAL   @14,REPLIST                                         0486
*              ELSE                                                0487
*                                                                  0487
*                CALL BUILDFDT;                            /*@YL026UL*/
*                                                                  0487
         B     @RC00485                                            0487
@RF00485 BAL   @14,BUILDFDT                                        0487
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF EITHER REPLIST OR BUILDFDT HAS FAILED,   @Y30SSFR*/
*            /*  RETURN TO THE CALLER OF TRNSLATE.           @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            IF LASTCC^=0                                          0488
*              THEN                                                0488
@RC00485 L     @02,@PC00001+16                                     0488
         LH    @02,LASTCC(,@02)                                    0488
         LTR   @02,@02                                             0488
         BNZ   @RT00488                                            0488
*                RETURN;                                   /*@YL026UL*/
*            END DOGRP20;                                  /*@YL026UL*/
*                                                                  0490
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* IF A SET OF PARAMETERS IS TO BE TRANSLATED,    @YL026UL*/
*          /* THEN EVERY PARAMETER DEFINED IN THE COMMAND    @YL026UL*/
*          /* DESCRIPTOR IS CHECKED TO SEE IF IT IS PART     @YL026UL*/
*          /* OF THAT SET AND IF IT WAS ACTUALLY INPUT.      @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          ELSE                                                    0491
*DOLOOP5:    DO PARMID=1 TO MAXID WHILE(LASTCC=0);         /*@YL026UL*/
         B     @RC00481                                            0491
@RF00481 DS    0H                                                  0491
DOLOOP5  LA    @02,1                                               0491
         B     @DE00491                                            0491
@DL00491 SLR   @15,@15                                             0491
         L     @14,@PC00001+16                                     0491
         CH    @15,LASTCC(,@14)                                    0491
         BNE   @DC00491                                            0491
*              IF PARMPTR(PARMID)^=NULLPTR                         0492
*                THEN                                              0492
*                                                                  0492
         MH    @02,@CH00038                                        0492
         L     @01,PINFOPTR                                        0492
         AL    @01,@CF01818                                        0492
         C     @15,PARMPTR(@02,@01)                                0492
         BE    @RF00492                                            0492
*                  /**************************************************/
*                  /*                                        @YL026UL*/
*                  /* UPON ENTRY, 'SUPERID' IDENTIFIES THE   @YL026UL*/
*                  /* PARM WHOSE SUBPARMS ARE CURRENTLY      @YL026UL*/
*                  /* BEING PROCESSED.  THESE SUBPARMS,      @YL026UL*/
*                  /* EXCEPT FOR THOSE IN NESTED REPEATED    @YL026UL*/
*                  /* SUBLISTS, CONSTITUTE THE SET OF PARMS  @YL026UL*/
*                  /* ELIGIBLE TO BE ENCODED IN THE PDL.     @YL026UL*/
*                  /*                                        @YL026UL*/
*                  /**************************************************/
*DOGRP25:          DO;                                     /*@YL026UL*/
DOGRP25  DS    0H                                                  0494
*                    FOUND=NO;                             /*@YL026UL*/
         NI    FOUND,B'11111101'                                   0494
*                    TESTID=PARMID;                        /*@YL026UL*/
         LH    TESTID,PARMID                                       0495
*                    DO WHILE(TESTID^=0 & FOUND=NO);       /*@YL026UL*/
         B     @DE00496                                            0496
@DL00496 DS    0H                                                  0497
*                      IF SUPRPARM(TESTID)=SUPERID                 0497
*                        THEN                                      0497
         LR    @15,TESTID                                          0497
         MH    @15,@CH00038                                        0497
         L     @01,PINFOPTR                                        0497
         AL    @01,@CF01819                                        0497
         LH    @15,SUPRPARM-8(@15,@01)                             0497
         CH    @15,SUPERID                                         0497
         BNE   @RF00497                                            0497
*                          FOUND=YES;                      /*@YL026UL*/
         OI    FOUND,B'00000010'                                   0498
*                        ELSE                                      0499
*                          DO;                             /*@YL026UL*/
         B     @RC00497                                            0499
@RF00497 DS    0H                                                  0500
*                          TESTID=SUPRPARM(TESTID);        /*@YL026UL*/
         L     @15,PINFOPTR                                        0500
         LA    @14,12                                              0500
         LR    @01,TESTID                                          0500
         MR    @00,@14                                             0500
         AL    @01,@CF01819                                        0500
         LH    @05,SUPRPARM-8(@01,@15)                             0500
         LR    TESTID,@05                                          0500
*                          IF PARMPTR(TESTID)->REPEATED=YES        0501
*                            THEN                                  0501
         LR    @01,@14                                             0501
         MR    @00,TESTID                                          0501
         AL    @15,@CF01818                                        0501
         L     @01,PARMPTR(@01,@15)                                0501
         TM    REPEATED(@01),B'00100000'                           0501
         BNO   @RF00501                                            0501
*                              TESTID=0;                   /*@YL026UL*/
         SLR   TESTID,TESTID                                       0502
*                          END;                            /*@YL026UL*/
@RF00501 DS    0H                                                  0504
*                    END;                                  /*@YL026UL*/
@RC00497 DS    0H                                                  0504
@DE00496 LTR   TESTID,TESTID                                       0504
         BZ    @DC00496                                            0504
         TM    FOUND,B'00000010'                                   0504
         BZ    @DL00496                                            0504
@DC00496 DS    0H                                                  0505
*                    IF FOUND=YES                                  0505
*                      THEN                                        0505
*                                                                  0505
         TM    FOUND,B'00000010'                                   0505
         BNO   @RF00505                                            0505
*                        /********************************************/
*                        /*                                  @YL026UL*/
*                        /* WHEN AN 'ELIGIBLE' PARM IS FOUND @YL026UL*/
*                        /* ITS PDE IS FOUND AND EXAMINED TO @YL026UL*/
*                        /* SEE IF THE PARM WAS CODED.       @YL026UL*/
*                        /*                                  @YL026UL*/
*                        /********************************************/
*DOGRP30:                DO;                               /*@YL026UL*/
DOGRP30  DS    0H                                                  0507
*                        PARMFLAG(PARMID)=PARTOSET;        /*@YL026UL*/
*                                                                  0507
         LH    @02,PARMID                                          0507
         MH    @02,@CH00038                                        0507
         LA    @15,1                                               0507
         L     @14,PINFOPTR                                        0507
         BCTR  @14,0                                               0507
         BCTR  @14,0                                               0507
         STC   @15,PARMFLAG-10(@02,@14)                            0507
*                        CALL FINDPDE;                     /*@YL026UL*/
*                                                                  0508
         BAL   @14,FINDPDE                                         0508
*                        /********************************************/
*                        /*                                  @YL026UL*/
*                        /* IF THE PARM WAS CODED, THE VALUE @YL026UL*/
*                        /* TYPE IS CHECKED.  IF THE PARM    @YL026UL*/
*                        /* HAS CONSTANT(S), THEY ARE THEN   @YL026UL*/
*                        /* TRANSLATED TO FDT FORM--IF THE   @YL026UL*/
*                        /* PARM HAS REPEATED SUBLISTS, THE  @YL026UL*/
*                        /* SUBLIST INFO IS SAVED.           @YL026UL*/
*                        /*                                  @YL026UL*/
*                        /********************************************/
*                        IF SCLRDATA=YES  REPEATED=YES            0509
*                          THEN                                    0509
         LA    @02,12                                              0509
         LR    @15,@02                                             0509
         MH    @15,PARMID                                          0509
         L     @01,PINFOPTR                                        0509
         AL    @01,@CF01818                                        0509
         L     @15,PARMPTR(@15,@01)                                0509
         TM    SCLRDATA(@15),B'10100000'                           0509
         BZ    @RF00509                                            0509
*                            IF CODED=YES                         0510
*                               (ANYSTRNG=YES & PWORDOPT=YES      0510
*                                DSNAM=YES) & MEMIN=YES            0510
*                              THEN                                0510
         TM    CODED+6(PDEPTR),B'10000000'                         0510
         BO    @RT00510                                            0510
         ALR   @15,@02                                             0510
         TM    ANYSTRNG(@15),B'01000010'                           0510
         BO    @GL00015                                            0510
         TM    DSNAM(@15),B'00100000'                              0510
         BNO   @RF00510                                            0510
@GL00015 TM    MEMIN(PDEPTR),B'10000000'                           0510
         BNO   @RF00510                                            0510
@RT00510 DS    0H                                                  0511
*                                DO;                       /*@YL026UL*/
*                                PARMFLAG(PARMID)=INPUT;   /*@YL026UL*/
         L     @02,PINFOPTR                                        0512
         LH    @15,PARMID                                          0512
         MH    @15,@CH00038                                        0512
         LA    @14,2                                               0512
         LA    @01,0(@15,@02)                                      0512
         BCTR  @01,0                                               0512
         BCTR  @01,0                                               0512
         STC   @14,PARMFLAG-10(,@01)                               0512
*                                IF REPEATED=YES                   0513
*                                  THEN                            0513
*                                                                  0513
         AL    @02,@CF01818                                        0513
         L     @02,PARMPTR(@15,@02)                                0513
         TM    REPEATED(@02),B'00100000'                           0513
         BNO   @RF00513                                            0513
*                                    CALL REPLIST;         /*@YL026UL*/
*                                                                  0514
         BAL   @14,REPLIST                                         0514
*                                  ELSE                            0515
*                                                                  0515
*                                    CALL BUILDFDT;        /*@YL026UL*/
*                                                                  0515
         B     @RC00513                                            0515
@RF00513 BAL   @14,BUILDFDT                                        0515
*                                /************************************/
*                                /*                          @Y30SSFR*/
*                                /*  IF EITHER REPLIST OR    @Y30SSFR*/
*                                /*  BUILDFDT HAS FAILED,    @Y30SSFR*/
*                                /*  RETURN TO THE CALLER    @Y30SSFR*/
*                                /*  OF TRNSLATE.            @Y30SSFR*/
*                                /*                          @Y30SSFR*/
*                                /************************************/
*                                IF LASTCC^=0                      0516
*                                  THEN                            0516
@RC00513 L     @02,@PC00001+16                                     0516
         LH    @02,LASTCC(,@02)                                    0516
         LTR   @02,@02                                             0516
         BNZ   @RT00516                                            0516
*                                    RETURN;               /*#YL026UL*/
*                                END;                      /*#YL026UL*/
*                              ELSE;                       /*@YL026UL*/
@RF00510 DS    0H                                                  0520
*                          ELSE                                    0520
*                                                                  0520
*                            /****************************************/
*                            /*                              @YL026UL*/
*                            /* IF THE PARM IS A KEYWORD NOT @YL026UL*/
*                            /* HAVING A CONSTANT ASSOCIATED @YL026UL*/
*                            /* WITH IT, THE PDE IS CHECKED  @YL026UL*/
*                            /* TO SEE IF THE KEYWORD WAS    @YL026UL*/
*                            /* ACTUALLY INPUT.  IF SO, ITS  @YL026UL*/
*                            /* PRESENCE IS NOTED IN THE     @YL026UL*/
*                            /* OCCURRENCE FLAG TABLE AND IN @YL026UL*/
*                            /* THE FDT.                     @YL026UL*/
*                            /*                              @YL026UL*/
*                            /****************************************/
*                            IF KWDGRPID=KWDID                     0520
*                              THEN                                0520
         B     @RC00509                                            0520
@RF00509 L     @02,PINFOPTR                                        0520
         LH    @15,PARMID                                          0520
         LA    @14,12                                              0520
         LR    @01,@15                                             0520
         MR    @00,@14                                             0520
         LA    @05,0(@01,@02)                                      0520
         AL    @05,@CF01818                                        0520
         L     @05,PARMPTR(,@05)                                   0520
         SLR   @04,@04                                             0520
         IC    @04,KWDGRPID(,@05)                                  0520
         CH    @04,KWDID(,PDEPTR)                                  0520
         BNE   @RF00520                                            0520
*                                DO;                       /*@YL026UL*/
*                                PARMFLAG(PARMID)=INPUT;   /*@YL026UL*/
         LA    @00,2                                               0522
         LA    @05,0(@01,@02)                                      0522
         BCTR  @05,0                                               0522
         BCTR  @05,0                                               0522
         STC   @00,PARMFLAG-10(,@05)                               0522
*                                IF OCCURNUM > 1                   0523
*                                  THEN                            0523
         AL    @02,@CF01818                                        0523
         L     @02,PARMPTR(@01,@02)                                0523
         CLC   OCCURNUM(3,@02),@CF00227+1                          0523
         BNH   @RF00523                                            0523
*                                    VECTRVAL=                     0524
*                                          ADDR(VECTRVAL); /*@YL026UL*/
         SLA   @15,2                                               0524
         L     @02,@PC00001+4                                      0524
         L     @02,FDTADDR(,@02)                                   0524
         MH    @14,REPINDEX                                        0524
         L     @01,RSIPTR                                          0524
         BCTR  @01,0                                               0524
         BCTR  @01,0                                               0524
         LH    @14,VECTRDSP-10(@14,@01)                            0524
         AL    @14,FDTPTR-4(@15,@02)                               0524
         ST    @14,VECTRVAL(,@14)                                  0524
*                                  ELSE                            0525
*                                    FDTPTR(PARMID)=               0525
*                                     ADDR(FDTPTR(PARMID));/*@YL026UL*/
         B     @RC00523                                            0525
@RF00523 LH    @02,PARMID                                          0525
         SLA   @02,2                                               0525
         L     @15,@PC00001+4                                      0525
         L     @15,FDTADDR(,@15)                                   0525
         LA    @14,FDTPTR-4(@02,@15)                               0525
         ST    @14,FDTPTR-4(@02,@15)                               0525
*                                END;                      /*@YL026UL*/
@RC00523 DS    0H                                                  0527
*                        END DOGRP30;                      /*@YL026UL*/
@RF00520 DS    0H                                                  0527
@RC00509 DS    0H                                                  0528
*                  END DOGRP25;                            /*@YL026UL*/
@RF00505 DS    0H                                                  0529
*            END DOLOOP5;                                  /*@YL026UL*/
*                                                                  0529
@RF00492 LA    @02,1                                               0529
         AH    @02,PARMID                                          0529
@DE00491 STH   @02,PARMID                                          0529
         L     @01,DESCPTR                                         0529
         CH    @02,MAXID(,@01)                                     0529
         BNH   @DL00491                                            0529
@DC00491 DS    0H                                                  0530
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - FINDPDE                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SEARCHES THE DESCRIPTOR SECTION @YL026UL*/
*/*             FOR THE CURRENT PARAMETER TO FIND THE PDE    @YL026UL*/
*/*             OFFSET WHICH PERTAINS TO THE PDL GENERATED   @YL026UL*/
*/*             FOR THE SET OF PARMS NOW BEING PROCESSED.    @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            PARMID -  PARAMETER ID# OF THE PARAMETER      @YL026UL*/
*/*                      WHOSE PDE LOCATION IS BEING SOUGHT  @YL026UL*/
*/*            PROMPT -  FLAG SET 'ON' WHEN THE PDL THAT     @YL026UL*/
*/*                      CONTAINS THE PDE OF INTEREST IS THE @YL026UL*/
*/*                      RESULT OF A RESPONSE TO A PROMPT.   @YL026UL*/
*/*            SUPERID - ID# OF THE PARAMETER WITHIN WHOSE   @YL026UL*/
*/*                      SUBPARAMETER LIST THE CURRENT PARM  @YL026UL*/
*/*                      OF INTEREST WAS CODED.              @YL026UL*/
*/*            PDLPTR -  POINTER TO THE PDL CONTAINING THE   @YL026UL*/
*/*                      PDE BEING SOUGHT.                   @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            PDEPTR -  POINTER TO THE PDE FOR THE PARM     @YL026UL*/
*/*                      CURRENTLY BEING PROCESSED.          @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*FINDPDE:PROCEDURE;                                        /*@YL026UL*/
         B     @PB00006                                            0530
FINDPDE  STM   @14,@02,12(@13)                                     0530
         STM   @04,@12,36(@13)                                     0530
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** FINDPDE **  FIND PDE OFFSET FOR CURRENT PARM @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0531
         L     @07,GDTTR2(,GDTPTR)                                 0531
         MVC   @TS00001(95),NEWERID2(@07)                          0531
         MVC   OLDERID2(95,@07),@TS00001                           0531
*        NEWID2='RI18';                                    /*@YL026UL*/
*                                                                  0532
         MVC   NEWID2(4,@07),@CC01610                              0532
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE PDL IS NOT THE RESULT OF A PROMPT, USE    @YL026UL*/
*        /* THE MAIN PDE OFFSET GIVEN IN THE PARAMETER'S     @YL026UL*/
*        /* DESCRIPTOR SECTION.  OTHERWISE, SEARCH FOR THE   @YL026UL*/
*        /* PDE OFFSET ASSOCIATED WITH THE PARAMETER WHOSE   @YL026UL*/
*        /* SUBPARMS ARE BEING PROMPTED FOR.                 @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF PROMPT=NO                                              0533
*          THEN                                                    0533
         TM    PROMPT,B'10000000'                                  0533
         BNZ   @RF00533                                            0533
*            DO INDEX4=1 TO IDCOUNT;                       /*@YL026UL*/
         LA    INDEX4,1                                            0534
         B     @DE00534                                            0534
@DL00534 DS    0H                                                  0535
*              IF IDNUM(INDEX4)=PARMID                             0535
*                THEN                                              0535
         LH    @07,PARMID                                          0535
         LR    @15,INDEX4                                          0535
         SLA   @15,2                                               0535
         LR    @14,@07                                             0535
         MH    @14,@CH00038                                        0535
         L     @01,PINFOPTR                                        0535
         AL    @01,@CF01818                                        0535
         L     @14,PARMPTR(@14,@01)                                0535
         SLR   @05,@05                                             0535
         IC    @05,IDDSPL(,@14)                                    0535
         ALR   @05,@05                                             0535
         ALR   @14,@05                                             0535
         LA    @01,0(@15,@14)                                      0535
         BCTR  @01,0                                               0535
         BCTR  @01,0                                               0535
         CH    @07,IDNUM-2(,@01)                                   0535
         BNE   @RF00535                                            0535
*                  PDEPTR=PDLPTR+PDEOFST1(INDEX4);         /*@YL026UL*/
         LH    PDEPTR,PDEOFST1-4(@15,@14)                          0536
         AL    PDEPTR,PDLPTR                                       0536
*            END;                                          /*@YL026UL*/
@RF00535 AL    INDEX4,@CF00227                                     0537
@DE00534 LH    @07,PARMID                                          0537
         MH    @07,@CH00038                                        0537
         LH    @15,PARMID                                          0537
         MH    @15,@CH00038                                        0537
         L     @01,PINFOPTR                                        0537
         AL    @01,@CF01818                                        0537
         L     @01,PARMPTR(@15,@01)                                0537
         SLR   @15,@15                                             0537
         IC    @15,IDDSPL(,@01)                                    0537
         ALR   @15,@15                                             0537
         L     @14,PINFOPTR                                        0537
         AL    @14,@CF01818                                        0537
         AL    @15,PARMPTR(@07,@14)                                0537
         CH    INDEX4,IDCOUNT(,@15)                                0537
         BNH   @DL00534                                            0537
*          ELSE                                                    0538
*            DO;                                           /*@YL026UL*/
         B     @RC00533                                            0538
@RF00533 DS    0H                                                  0539
*              FOUND=NO;                                   /*@YL026UL*/
         NI    FOUND,B'11111101'                                   0539
*              DO INDEX4=1 TO PDECNT WHILE(FOUND=NO);      /*@YL026UL*/
         LA    INDEX4,1                                            0540
         B     @DE00540                                            0540
@DL00540 TM    FOUND,B'00000010'                                   0540
         BNZ   @DC00540                                            0540
*                IF PDEPRMID(INDEX4)=PARMID &                      0541
*                   PDEPCLID(INDEX4)=SUPERID                       0541
*                  THEN                                            0541
         LH    @07,PARMID                                          0541
         LR    @15,INDEX4                                          0541
         MH    @15,@CH00164                                        0541
         LR    @14,@07                                             0541
         MH    @14,@CH00038                                        0541
         L     @01,PINFOPTR                                        0541
         AL    @01,@CF01818                                        0541
         L     @14,PARMPTR(@14,@01)                                0541
         SLR   @05,@05                                             0541
         IC    @05,PDEDSPL(,@14)                                   0541
         ALR   @05,@05                                             0541
         ALR   @14,@05                                             0541
         LA    @01,0(@15,@14)                                      0541
         AL    @01,@CF01819                                        0541
         CH    @07,PDEPRMID-2(,@01)                                0541
         BNE   @RF00541                                            0541
         LA    @07,0(@15,@14)                                      0541
         BCTR  @07,0                                               0541
         BCTR  @07,0                                               0541
         LH    @07,PDEPCLID-4(,@07)                                0541
         CH    @07,SUPERID                                         0541
         BNE   @RF00541                                            0541
*                    DO;                                   /*@YL026UL*/
*                    PDEPTR=PDLPTR+PDEOFST2(INDEX4);       /*@YL026UL*/
         LH    PDEPTR,PDEOFST2-6(@15,@14)                          0543
         AL    PDEPTR,PDLPTR                                       0543
*                    FOUND=YES;                            /*@YL026UL*/
         OI    FOUND,B'00000010'                                   0544
*                    END;                                  /*@YL026UL*/
*              END;                                        /*@YL026UL*/
@RF00541 AL    INDEX4,@CF00227                                     0546
@DE00540 LH    @07,PARMID                                          0546
         MH    @07,@CH00038                                        0546
         LH    @15,PARMID                                          0546
         MH    @15,@CH00038                                        0546
         L     @01,PINFOPTR                                        0546
         AL    @01,@CF01818                                        0546
         L     @01,PARMPTR(@15,@01)                                0546
         SLR   @15,@15                                             0546
         IC    @15,PDEDSPL(,@01)                                   0546
         ALR   @15,@15                                             0546
         L     @14,PINFOPTR                                        0546
         AL    @14,@CF01818                                        0546
         AL    @15,PARMPTR(@07,@14)                                0546
         CH    INDEX4,PDECNT(,@15)                                 0546
         BNH   @DL00540                                            0546
@DC00540 DS    0H                                                  0547
*            END;                                          /*@YL026UL*/
*                                                                  0547
*        END FINDPDE;                                      /*@YL026UL*/
*                                                                  0548
@EL00006 DS    0H                                                  0548
@EF00006 DS    0H                                                  0548
@ER00006 LM    @14,@02,12(@13)                                     0548
         LM    @04,@12,36(@13)                                     0548
         BR    @14                                                 0548
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - REPLIST                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE HANDLES REPEATED SUBPARAMETER   @YL026UL*/
*/*             LISTS WHOSE PARAMETERS ARE YET TO BE PARSED. @YL026UL*/
*/*             FIRST, THE NUMBER OF SUBLIST REPETITIONS IS  @YL026UL*/
*/*             COUNTED AND STORED IN THE FDT, AND THEN THE  @YL026UL*/
*/*             SECONDARY POINTER VECTOR OFFSET IS FIGURED   @YL026UL*/
*/*             FOR PARAMETERS APPEARING WITHIN THE SUBLIST. @YL026UL*/
*/*             AN ENTRY IS ADDED TO THE REPEATED SUBLIST    @YL026UL*/
*/*             INDEX (RSI) FOR EACH SUBLIST REPETITION TO   @YL026UL*/
*/*             PROVIDE REFERENCE TO IT FOR LATER PROCESSING @YL026UL*/
*/*             OF ITS PARAMETERS.  FINALLY, SECONDARY PTR   @YL026UL*/
*/*             VECTORS ARE ALLOCATED AND INITIALIZED FOR    @YL026UL*/
*/*             PARAMETERS DEFINED WITHIN THE REPEATED       @YL026UL*/
*/*             SUBPARAMETER LIST.                           @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            PDEPTR -  POINTER TO THE PDE CONTAINING THE   @YL026UL*/
*/*                      UNPARSED SUBLIST REPETITIONS.       @YL026UL*/
*/*            PARMID -  PARAMETER ID# OF THE PARM WHOSE     @YL026UL*/
*/*                      SUBLIST REPS ARE BEING SAVED.       @YL026UL*/
*/*            SINGLPRM- FLAG SET 'ON' IF THE PDE CONTAINS   @YL026UL*/
*/*                      JUST A SINGLE SUBLIST REPETITION    @YL026UL*/
*/*                      ENTERED AS A RESULT OF A PROMPT     @YL026UL*/
*/*            RSI -     REPEATED SUBLIST INDEX ENTRY FOR    @YL026UL*/
*/*                      PARAMETER WHOSE REPEATED SUBLISTS   @YL026UL*/
*/*                      ARE BEING SAVED IN THE RSI (THIS IS @YL026UL*/
*/*                      FOR NESTED REPEATED SUBLISTS ONLY)  @YL026UL*/
*/*            PARMINFO- PARAMETER INFO TABLE.               @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            REPCOUNT- NUMBER OF SUBLISTS IN THIS          @YL026UL*/
*/*                      REPEATED LIST.                      @YL026UL*/
*/*            FDT -     DATA ENTRY FOR SUBLIST COUNT.       @YL026UL*/
*/*            RSICOUNT- COUNT OF RSI ENTRIES                @YL026UL*/
*/*            RSI -     REPEATED SUBLIST INDEX ENTRIES FOR  @YL026UL*/
*/*                      EACH OF THE SUBLISTS IN THE LISTS   @YL026UL*/
*/*            FDT -     INITIALIZED SECONDARY PTR VECTORS   @YL026UL*/
*/*                      FOR PARAMETERS WHICH MAY APPEAR     @YL026UL*/
*/*                      WITHIN THE SUBLISTS JUST SAVED.     @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/
*/*                      ZERO VALUE IF PROCESSING CANNOT     @YL026UL*/
*/*                      BE CONTINUED                        @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*REPLIST:PROCEDURE;                                        /*@YL026UL*/
REPLIST  STM   @14,@02,@SA00007                                    0549
         STM   @04,@12,@SA00007+20                                 0549
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** REPLIST  **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0550
*        DCL VECTROFF FIXED(15);       /*OFFSET INTO SECOND. @YL026UL*/
*                                      /*PTR VECTOR APPLYING @YL026UL*/
*                                      /*TO PARMS APPEARING  @YL026UL*/
*                                      /*IN CURRENT SUBLIST  @YL026UL*/
*                                      /*REPETITION.         @YL026UL*/
*        DCL OLDPTR   PTR(31);         /*PTR TO OLD RSI AREA @YL026UL*/
*        DCL NEWPTR   PTR(31);         /*PTR TO NEW RSI AREA @YL026UL*/
*        DCL MOVEAMT  FIXED(15);       /*AMOUNT OF RSI TO BE @YL026UL*/
*                                      /*MOVED               @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** REPLIST **  HANDLE REPEATED SUBPARM LISTS    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0554
         L     @07,GDTTR2(,GDTPTR)                                 0554
         MVC   @TS00001(95),NEWERID2(@07)                          0554
         MVC   OLDERID2(95,@07),@TS00001                           0554
*        NEWID2='RI20';                                    /*@YL026UL*/
*                                                                  0555
         MVC   NEWID2(4,@07),@CC01618                              0555
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* COUNT THE NUMBER OF SUBLIST REPETITIONS (NUMBER  @YL026UL*/
*        /* OF PDE STRUCTURES CHAINED TOGETHER).  IF TOO     @YL026UL*/
*        /* MANY REPS HAVE BEEN CODED, IGNORE EXCESS IF USER @YL026UL*/
*        /* AGREES; OTHERWISE, DISCONTINUE PROCESSING.       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        BASEPTR=PDEPTR;                                   /*@YL026UL*/
         LR    BASEPTR,PDEPTR                                      0556
*        REPCOUNT=1;                                       /*@YL026UL*/
         MVC   REPCOUNT(2),@CH00227                                0557
*        IF SINGLPRM=YES                                           0558
*          THEN                                                    0558
         TM    SINGLPRM,B'01000000'                                0558
         BNO   @RF00558                                            0558
*            CNTDONE=YES;                                  /*@YL026UL*/
         OI    CNTDONE,B'00000100'                                 0559
*          ELSE                                                    0560
*            CNTDONE=NO;                                   /*@YL026UL*/
         B     @RC00558                                            0560
@RF00558 NI    CNTDONE,B'11111011'                                 0560
*        DO WHILE(CNTDONE=NO & NXTCPDE^=CHAINEND);         /*@YL026UL*/
@RC00558 B     @DE00561                                            0561
@DL00561 DS    0H                                                  0562
*          REPCOUNT=REPCOUNT+1;                            /*@YL026UL*/
         LA    @07,1                                               0562
         AH    @07,REPCOUNT                                        0562
         STH   @07,REPCOUNT                                        0562
*          IF REPCOUNT > REPMAX                                    0563
*            THEN                                                  0563
         LA    @05,12                                              0563
         LR    @02,@05                                             0563
         MH    @02,PARMID                                          0563
         L     @01,PINFOPTR                                        0563
         AL    @01,@CF01818                                        0563
         AL    @05,PARMPTR(@02,@01)                                0563
         SLR   @02,@02                                             0563
         IC    @02,REPMAX(,@05)                                    0563
         CR    @07,@02                                             0563
         BNH   @RF00563                                            0563
*              DO;                                         /*@YL026UL*/
*              PDEPTR=NXTCPDE;                             /*@YL026UL*/
         L     PDEPTR,NXTCPDE(,PDEPTR)                             0565
*              CNTDONE=YES;                                /*@YL026UL*/
*                                                                  0566
         OI    CNTDONE,B'00000100'                                 0566
*              CALL TOOMANY;                               /*@YL026UL*/
*                                                                  0567
         BAL   @14,TOOMANY                                         0567
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  IF THE CALL TO TOOMANY HAS FAILED OR IF   @Y30SSFR*/
*              /*  THE USER WILL NOT ACCEPT THE DISCARD OF   @Y30SSFR*/
*              /*  THE EXCESS PARAMETERS, RETURN TO THE      @Y30SSFR*/
*              /*  CALLLER.                                  @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*              IF LASTCC ^= 0                                      0568
*                THEN                                              0568
         L     @07,@PC00001+16                                     0568
         LH    @07,LASTCC(,@07)                                    0568
         LTR   @07,@07                                             0568
         BNZ   @RT00568                                            0568
*                  RETURN;                                 /*#YL026UL*/
*              END;                                        /*#YL026UL*/
*            ELSE                                                  0571
*              PDEPTR=NXTCPDE;                             /*#YL026UL*/
         B     @RC00563                                            0571
@RF00563 L     PDEPTR,NXTCPDE(,PDEPTR)                             0571
*        END;                                              /*#YL026UL*/
@RC00563 DS    0H                                                  0572
@DE00561 TM    CNTDONE,B'00000100'                                 0572
         BNZ   @DC00561                                            0572
         CLC   NXTCPDE(4,PDEPTR),CHAINEND                          0572
         BNE   @DL00561                                            0572
@DC00561 DS    0H                                                  0573
*        PDEPTR=BASEPTR;                                   /*#YL026UL*/
*                                                                  0573
         LR    PDEPTR,BASEPTR                                      0573
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* STORE THE COUNT OF SUBLIST REPETITIONS IN THE    @YL026UL*/
*        /* FDT AND COMPUTE THE SECONDARY POINTER VECTOR     @YL026UL*/
*        /* OFFSET APPLYING TO PARAMETERS THAT APPEAR WITHIN @YL026UL*/
*        /* THE FIRST SUBLIST REPETITION.                    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF OCCURNUM=1                                             0574
*          THEN                                                    0574
         LH    @07,PARMID                                          0574
         LR    @02,@07                                             0574
         MH    @02,@CH00038                                        0574
         L     @01,PINFOPTR                                        0574
         AL    @01,@CF01818                                        0574
         L     @02,PARMPTR(@02,@01)                                0574
         CLC   OCCURNUM(3,@02),@CF00227+1                          0574
         BNE   @RF00574                                            0574
*            DO;                                           /*@YL026UL*/
*            FDTPTR(PARMID)=REPCOUNT;                      /*@YL026UL*/
         SLA   @07,2                                               0576
         L     @02,@PC00001+4                                      0576
         L     @02,FDTADDR(,@02)                                   0576
         LH    @15,REPCOUNT                                        0576
         ST    @15,FDTPTR-4(@07,@02)                               0576
*            VECTROFF=0;                                   /*@YL026UL*/
         SLR   @07,@07                                             0577
         STH   @07,VECTROFF                                        0577
*            END;                                          /*@YL026UL*/
*          ELSE                                                    0579
*            DO;                                           /*@YL026UL*/
         B     @RC00574                                            0579
@RF00574 DS    0H                                                  0580
*            VECTRVAL=REPCOUNT;                            /*@YL026UL*/
         LH    @07,PARMID                                          0580
         LR    @02,@07                                             0580
         SLA   @02,2                                               0580
         L     @15,@PC00001+4                                      0580
         L     @01,FDTADDR(,@15)                                   0580
         L     @15,RSIPTR                                          0580
         LA    @14,12                                              0580
         LR    @05,@14                                             0580
         MH    @05,REPINDEX                                        0580
         LA    @04,0(@05,@15)                                      0580
         BCTR  @04,0                                               0580
         BCTR  @04,0                                               0580
         LH    @04,VECTRDSP-10(,@04)                               0580
         L     @02,FDTPTR-4(@02,@01)                               0580
         ALR   @02,@04                                             0580
         LH    @01,REPCOUNT                                        0580
         ST    @01,VECTRVAL(,@02)                                  0580
*            VECTROFF=VECTRDSP(REPINDEX)+                  /*@YL026UL*/
*                 4*(SBLSTNUM(REPINDEX)-1)*(REPMAX-1);     /*@YL026UL*/
         AL    @15,@CF01819                                        0581
         SLR   @01,@01                                             0581
         IC    @01,SBLSTNUM-8(@05,@15)                             0581
         BCTR  @01,0                                               0581
         SLA   @01,2                                               0581
         LR    @05,@07                                             0581
         ST    @04,@TF00001                                        0581
         MR    @04,@14                                             0581
         L     @07,PINFOPTR                                        0581
         AL    @07,@CF01818                                        0581
         AL    @14,PARMPTR(@05,@07)                                0581
         SLR   @07,@07                                             0581
         IC    @07,REPMAX(,@14)                                    0581
         BCTR  @07,0                                               0581
         MR    @00,@07                                             0581
         AL    @01,@TF00001                                        0581
         STH   @01,VECTROFF                                        0581
*            END;                                          /*@YL026UL*/
*                                                                  0582
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* FOR EACH SUBLIST REPETITION, ADD AN ENTRY TO THE @YL026UL*/
*        /* RSI (OBTAIN MORE RSI SPACE IF NECESSARY)         @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*DOLOOP10:DO INDEX5=1 TO REPCOUNT;                         /*@YL026UL*/
@RC00574 DS    0H                                                  0583
DOLOOP10 LA    @07,1                                               0583
         B     @DE00583                                            0583
@DL00583 DS    0H                                                  0584
*          RSICOUNT=RSICOUNT+1;                            /*@YL026UL*/
         LA    @07,1                                               0584
         LH    @02,RSICOUNT                                        0584
         ALR   @02,@07                                             0584
         STH   @02,RSICOUNT                                        0584
*          IF RSICOUNT//INITALLO = 1  &                            0585
*             RSICOUNT ^= 1                                        0585
*            THEN                                                  0585
*                                                                  0585
         LR    @00,@02                                             0585
         SRDA  @00,32                                              0585
         D     @00,@CF01449                                        0585
         CR    @00,@07                                             0585
         BNE   @RF00585                                            0585
         CR    @02,@07                                             0585
         BE    @RF00585                                            0585
*              /******************************************************/
*              /*                                            @YL026UL*/
*              /* WHEN THE CURRENT RSI IS TOO SMALL, OBTAIN  @YL026UL*/
*              /* A LARGER AREA AND MOVE THE CURRENT RSI     @YL026UL*/
*              /* INTO THE FIRST PART OF THE NEW AREA.       @YL026UL*/
*              /*                                            @YL026UL*/
*              /******************************************************/
*DOGRP35:      DO;                                         /*@YL026UL*/
DOGRP35  DS    0H                                                  0587
*              MOVELEN=(RSICOUNT-1)*LENGTH(RSI);           /*@YL026UL*/
         LH    MOVELEN,RSICOUNT                                    0587
         BCTR  MOVELEN,0                                           0587
         MH    MOVELEN,@CH00038                                    0587
*              AMTTOGET=MOVELEN+LENGTH(RSI)*INITALLO;      /*@YL026UL*/
         LA    @02,240                                             0588
         ALR   @02,MOVELEN                                         0588
         ST    @02,AMTTOGET                                        0588
*              OLDPTR=RSIPTR;                              /*@YL026UL*/
*                                                                  0589
         L     OLDPTR,RSIPTR                                       0589
*              CALL IDCSAGP0(GDTTBL,AMTTOGET,RSIPTR,               0590
*                     RIPOOLID,SETZERO);                   /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     0590
         LA    @02,AMTTOGET                                        0590
         ST    @02,@AL00001+4                                      0590
         LA    @02,RSIPTR                                          0590
         ST    @02,@AL00001+8                                      0590
         LA    @02,MODID                                           0590
         ST    @02,@AL00001+12                                     0590
         LA    @02,SETZERO                                         0590
         ST    @02,@AL00001+16                                     0590
         MVI   @AL00001+16,X'80'                                   0590
         L     @15,GDTGPL(,GDTPTR)                                 0590
         LA    @01,@AL00001                                        0590
         BALR  @14,@15                                             0590
*              RESPECIFY RTNREG RSTD;                              0591
*              TESTRC = RTNREG;                                    0592
         LR    TESTRC,RTNREG                                       0592
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UL*/
*                                                                  0593
*              IF TESTRC ^= 0                                      0594
*                THEN                                              0594
         LTR   TESTRC,TESTRC                                       0594
         BZ    @RF00594                                            0594
*                  DO;                                     /*@YL026UL*/
*                                                                  0595
*                  CALL FAILSPAC;                          /*@YL026UL*/
*                                                                  0596
         BAL   @14,FAILSPAC                                        0596
*                  RETURN;                                 /*@YL026UL*/
@EL00007 DS    0H                                                  0597
@EF00007 DS    0H                                                  0597
@ER00007 LM    @14,@02,@SA00007                                    0597
         LM    @04,@12,@SA00007+20                                 0597
         BR    @14                                                 0597
*                  END;                                    /*@YL026UL*/
*                                                                  0598
*              NEWPTR=RSIPTR;                              /*@YL026UL*/
@RF00594 L     NEWPTR,RSIPTR                                       0599
*              DO WHILE(MOVELEN > 0);                      /*@YL026UL*/
         B     @DE00600                                            0600
@DL00600 DS    0H                                                  0601
*                MOVEAMT=MIN(256,MOVELEN);                 /*@YL026UL*/
         LA    MOVEAMT,256                                         0601
         CR    MOVEAMT,MOVELEN                                     0601
         BNH   *+6
         LR    MOVEAMT,MOVELEN                                     0601
*                NEWPTR->DATABLK(1:MOVEAMT)=                       0602
*                      OLDPTR->DATABLK(1:MOVEAMT);         /*@YL026UL*/
         LR    @15,MOVEAMT                                         0602
         BCTR  @15,0                                               0602
         EX    @15,@SM01829                                        0602
*                NEWPTR=NEWPTR+MOVEAMT;                    /*@YL026UL*/
         ALR   NEWPTR,MOVEAMT                                      0603
*                OLDPTR=OLDPTR+MOVEAMT;                    /*@YL026UL*/
         ALR   OLDPTR,MOVEAMT                                      0604
*                MOVELEN=MOVELEN-MOVEAMT;                  /*@YL026UL*/
         SLR   MOVELEN,MOVEAMT                                     0605
*              END;                                        /*@YL026UL*/
*                                                                  0606
@DE00600 LTR   MOVELEN,MOVELEN                                     0606
         BP    @DL00600                                            0606
*              END DOGRP35;                                /*@YL026UL*/
*                                                                  0607
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* BE SURE THAT A NULL SUBLIST HAS NOT BEEN CODED @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          NAMEPDE=NO;                                     /*@YL026UL*/
@RF00585 NI    NAMEPDE,B'11110111'                                 0608
*          DO WHILE(CONSTLEN=0);                           /*@YL026UL*/
*                                                                  0609
         B     @DE00609                                            0609
@DL00609 DS    0H                                                  0610
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CALL NEWPARM TO PROMPT FOR THE MISSING      @Y30SSFR*/
*            /*  SUBPARAMETER LIST.                          @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            CALL NEWPARM(BADLEN,ADDR(REPPCL));            /*#YL026UL*/
*                                                                  0610
         LA    @07,@CH00170                                        0610
         ST    @07,@AL00001                                        0610
         L     @07,@CV01509                                        0610
         ST    @07,@AFTEMPS                                        0610
         LA    @07,@AFTEMPS                                        0610
         ST    @07,@AL00001+4                                      0610
         LA    @01,@AL00001                                        0610
         BAL   @14,NEWPARM                                         0610
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THE PROMPT FAILS, RETURN TO THE CALLER   @Y30SSFR*/
*            /*  OF REPLIST.                                 @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            IF LASTCC^=0                                          0611
*              THEN                                                0611
         L     @07,@PC00001+16                                     0611
         LH    @07,LASTCC(,@07)                                    0611
         LTR   @07,@07                                             0611
         BNZ   @RT00611                                            0611
*                RETURN;                                   /*#YL026UL*/
*          END;                                            /*#YL026UL*/
*                                                                  0613
@DE00609 LH    @07,CONSTLEN(,PDEPTR)                               0613
         LTR   @07,@07                                             0613
         BZ    @DL00609                                            0613
*          /**********************************************************/
*          /*                                                #YL026UL*/
*          /* STORE INTO THE RSI THE LENGTH OF THE CURRENT   #YL026UL*/
*          /* REPETITION, THE PTR TO THE REP, THE ID# OF THE @YL026UL*/
*          /* PARM WHOSE SUBLIST THIS IS, AND CURRENT REP'S  @YL026UL*/
*          /* POSITION IN THE LIST OF SUBLISTS.  ALSO STORE  @YL026UL*/
*          /* THE POINTER VECTOR OFFSET APPLYING TO          @YL026UL*/
*          /* SUBPARAMETERS WITHIN THIS REPETITION (THE      @YL026UL*/
*          /* OFFSET IS ONE PTR FURTHER FOR EACH SUCCESSIVE  @YL026UL*/
*          /* SUBLIST REPETITION).                           @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          SBLSTIN(RSICOUNT)=YES;                          /*@YL026UL*/
         L     @02,RSIPTR                                          0614
         LH    @15,RSICOUNT                                        0614
         MH    @15,@CH00038                                        0614
         ST    @15,@TF00001                                        0614
         ALR   @15,@02                                             0614
         AL    @15,@CF01813                                        0614
         OI    SBLSTIN-9(@15),B'10000000'                          0614
*          SBLSTLEN(RSICOUNT)=CONSTLEN;                    /*@YL026UL*/
         L     @01,@TF00001                                        0615
         AL    @01,@CF01817                                        0615
         STH   @07,SBLSTLEN-4(@01,@02)                             0615
*          SBLSTPTR(RSICOUNT)=CONSTPTR;                    /*@YL026UL*/
         L     @07,CONSTPTR(,PDEPTR)                               0616
         L     @01,@TF00001                                        0616
         AL    @01,@CF01818                                        0616
         ST    @07,SBLSTPTR(@01,@02)                               0616
*          SBLSTID(RSICOUNT)=PARMID;                       /*@YL026UL*/
         LH    @07,PARMID                                          0617
         L     @01,@TF00001                                        0617
         AL    @01,@CF01821                                        0617
         STH   @07,SBLSTID-6(@01,@02)                              0617
*          SBLSTNUM(RSICOUNT)=INDEX5;                      /*@YL026UL*/
         LH    @07,INDEX5                                          0618
         L     @01,@TF00001                                        0618
         AL    @01,@CF01819                                        0618
         STC   @07,SBLSTNUM-8(@01,@02)                             0618
*          VECTRDSP(RSICOUNT)=VECTROFF+                            0619
*                             PTRLNGTH*(INDEX5-1);         /*@YL026UL*/
*                                                                  0619
         LR    @15,@07                                             0619
         BCTR  @15,0                                               0619
         SLA   @15,2                                               0619
         AH    @15,VECTROFF                                        0619
         L     @14,@TF00001                                        0619
         BCTR  @02,0                                               0619
         BCTR  @02,0                                               0619
         STH   @15,VECTRDSP-10(@14,@02)                            0619
*          /*POINT TO THE NEXT SUBLIST                       @YL026UL*/
*          PDEPTR=NXTCPDE;                                 /*@YL026UL*/
*                                                                  0620
         L     PDEPTR,NXTCPDE(,PDEPTR)                             0620
*        END DOLOOP10;                                     /*@YL026UL*/
*                                                                  0621
         AL    @07,@CF00227                                        0621
@DE00583 STH   @07,INDEX5                                          0621
         CH    @07,REPCOUNT                                        0621
         BNH   @DL00583                                            0621
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CALCULATE THE AMOUNT OF SPACE NEEDED FOR THE     @YL026UL*/
*        /* SECONDARY POINTER VECTORS FOR PARAMETERS DEFINED @YL026UL*/
*        /* TO BE WITHIN THIS REPEATED SUBLIST.              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF OCCURNUM=1                                             0622
*          THEN                                                    0622
         LH    @07,PARMID                                          0622
         MH    @07,@CH00038                                        0622
         L     @02,PINFOPTR                                        0622
         AL    @02,@CF01818                                        0622
         L     @07,PARMPTR(@07,@02)                                0622
         CLC   OCCURNUM(3,@07),@CF00227+1                          0622
         BNE   @RF00622                                            0622
*            AMTTOGET=PTRLNGTH*REPCOUNT;                   /*@YL026UL*/
         LH    @07,REPCOUNT                                        0623
         SLA   @07,2                                               0623
         ST    @07,AMTTOGET                                        0623
*          ELSE                                                    0624
*            AMTTOGET=PTRLNGTH*OCCURNUM*REPMAX;            /*@YL026UL*/
*                                                                  0624
         B     @RC00622                                            0624
@RF00622 LA    @07,12                                              0624
         LR    @02,@07                                             0624
         MH    @02,PARMID                                          0624
         L     @01,PINFOPTR                                        0624
         AL    @01,@CF01818                                        0624
         L     @02,PARMPTR(@02,@01)                                0624
         L     @01,OCCURNUM-1(,@02)                                0624
         LA    @01,0(,@01)                                         0624
         SLA   @01,2                                               0624
         ALR   @02,@07                                             0624
         SLR   @07,@07                                             0624
         IC    @07,REPMAX(,@02)                                    0624
         MR    @00,@07                                             0624
         ST    @01,AMTTOGET                                        0624
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* EXAMINE THE COMMAND DESCRIPTOR TO FIND ALL PARMS @YL026UL*/
*        /* WHICH ARE DEFINED AS BEING PART OF THE CURRENT   @YL026UL*/
*        /* REPEATED SUBPARM LIST SET.  FOR EACH SUCH PARM,  @YL026UL*/
*        /* ALLOCATE THE SECONDARY FDT POINTER VECTOR.       @YL026UL*/
*        /* DISCONTINUE PROCESSING IF SPACE ISN'T AVAILABLE  @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*DOLOOP15:DO INDEX6=1 TO MAXID;                            /*@YL026UL*/
*                                                                  0625
@RC00622 DS    0H                                                  0625
DOLOOP15 LA    INDEX6,1                                            0625
         B     @DE00625                                            0625
@DL00625 DS    0H                                                  0626
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* A PARAMETER IS PART OF THE CURRENT REPEATED    @YL026UL*/
*          /* SUBPARAMETER LIST IF IT IS SUBORDINATE TO THE  @YL026UL*/
*          /* PARAMETER WHOSE SUBLIST IS REPEATED. HOWEVER   @YL026UL*/
*          /* SUCH A PARM MUST NOT HAVE REPEATED SUBLISTS    @YL026UL*/
*          /* ITSELF AND MUST NOT BE NESTED WITHIN A SUBLIST @YL026UL*/
*          /* THAT IS REPEATED WITHIN THE CURRENT SUBLIST.   @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          IF PARMPTR(INDEX6)^=0 &                                 0626
*             PARMPTR(INDEX6)->REPEATED=NO                         0626
*            THEN                                                  0626
         LR    @07,INDEX6                                          0626
         MH    @07,@CH00038                                        0626
         L     @05,PINFOPTR                                        0626
         AL    @05,@CF01818                                        0626
         L     @07,PARMPTR(@07,@05)                                0626
         LTR   @07,@07                                             0626
         BZ    @RF00626                                            0626
         TM    REPEATED(@07),B'00100000'                           0626
         BNZ   @RF00626                                            0626
*DOGRP40:      DO;                                         /*@YL026UL*/
DOGRP40  DS    0H                                                  0628
*                TESTID=INDEX6;                            /*@YL026UL*/
         LR    TESTID,INDEX6                                       0628
*                DO WHILE(TESTID^=0);                      /*@YL026UL*/
         B     @DE00629                                            0629
@DL00629 DS    0H                                                  0630
*                  IF SUPRPARM(TESTID)=PARMID                      0630
*                    THEN                                          0630
         LR    @07,TESTID                                          0630
         MH    @07,@CH00038                                        0630
         L     @05,PINFOPTR                                        0630
         AL    @05,@CF01819                                        0630
         LH    @07,SUPRPARM-8(@07,@05)                             0630
         CH    @07,PARMID                                          0630
         BNE   @RF00630                                            0630
*                      DO;                                 /*@YL026UL*/
*                                                                  0631
*                      CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTPTR(INDEX6),
*                             SPACEID,SETZERO);            /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     0632
         LA    @07,AMTTOGET                                        0632
         ST    @07,@AL00001+4                                      0632
         LR    @07,INDEX6                                          0632
         SLA   @07,2                                               0632
         L     @02,@PC00001+4                                      0632
         L     @02,FDTADDR(,@02)                                   0632
         LA    @07,FDTPTR-4(@07,@02)                               0632
         ST    @07,@AL00001+8                                      0632
         L     @07,@PC00001+8                                      0632
         ST    @07,@AL00001+12                                     0632
         LA    @07,SETZERO                                         0632
         ST    @07,@AL00001+16                                     0632
         MVI   @AL00001+16,X'80'                                   0632
         L     @15,GDTGPL(,GDTPTR)                                 0632
         LA    @01,@AL00001                                        0632
         BALR  @14,@15                                             0632
*                      RESPECIFY RTNREG RSTD;                      0633
*                      TESTRC = RTNREG;                            0634
         LR    TESTRC,RTNREG                                       0634
*                      RESPECIFY RTNREG UNRSTD;            /*@YL026UL*/
*                                                                  0635
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  IF THE RETURN CODE FROM UGPOOL IS @Y30SSFR*/
*                      /*  NON-ZERO, CALL FAILSPAC TO HANDLE @Y30SSFR*/
*                      /*  THE ERROR AND THEN RETURN.        @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                      IF TESTRC^=0                                0636
*                        THEN                                      0636
         LTR   TESTRC,TESTRC                                       0636
         BZ    @RF00636                                            0636
*                          DO;                             /*@YL026UL*/
*                                                                  0637
*                          CALL FAILSPAC;                  /*@YL026UL*/
*                                                                  0638
         BAL   @14,FAILSPAC                                        0638
*                          RETURN;                         /*@YL026UL*/
         B     @EL00007                                            0639
*                          END;                            /*@YL026UL*/
*                                                                  0640
*                      TESTID=0;                           /*@YL026UL*/
@RF00636 SLR   TESTID,TESTID                                       0641
*                      END;                                /*@YL026UL*/
*                    ELSE                                          0643
*                      DO;                                 /*@YL026UL*/
*                                                                  0643
         B     @RC00630                                            0643
@RF00630 DS    0H                                                  0644
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  IF THE SUPERPARAMETER HAS THE     @Y30SSFR*/
*                      /*  REPEATED BIT ON, EXIT FROM THE    @Y30SSFR*/
*                      /*  LOOP BY SETTING TESTID TO ZERO.   @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/
         L     @07,PINFOPTR                                        0644
         LA    @05,12                                              0644
         LR    @01,TESTID                                          0644
         MR    @00,@05                                             0644
         AL    @01,@CF01819                                        0644
         LH    @15,SUPRPARM-8(@01,@07)                             0644
         LR    TESTID,@15                                          0644
*                      IF PARMPTR(TESTID)->REPEATED=YES            0645
*                        THEN                                      0645
         LR    @01,@05                                             0645
         MR    @00,TESTID                                          0645
         AL    @07,@CF01818                                        0645
         L     @07,PARMPTR(@01,@07)                                0645
         TM    REPEATED(@07),B'00100000'                           0645
         BNO   @RF00645                                            0645
*                          TESTID=0;                       /*@YL026UL*/
         SLR   TESTID,TESTID                                       0646
*                      END;                                /*@YL026UL*/
@RF00645 DS    0H                                                  0648
*                END;                                      /*@YL026UL*/
@RC00630 DS    0H                                                  0648
@DE00629 LTR   TESTID,TESTID                                       0648
         BNZ   @DL00629                                            0648
*              END DOGRP40;                                /*@YL026UL*/
*        END DOLOOP15;                                     /*@YL026UL*/
*                                                                  0650
*                                                                  0650
@RF00626 AL    INDEX6,@CF00227                                     0650
@DE00625 L     @07,DESCPTR                                         0650
         CH    INDEX6,MAXID(,@07)                                  0650
         BNH   @DL00625                                            0650
*        END REPLIST;                                      /*@YL026UL*/
         B     @EL00007                                            0651
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - BUILDFDT                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE BUILDS FDT DATA SUBSTRUCTURES   @YL026UL*/
*/*             BY MOVING DATA FROM THE PDE FOR THE PARM     @YL026UL*/
*/*             CURRENTLY BEING PROCESSED INTO SPACE JUST    @YL026UL*/
*/*             ALLOCATED FOR THE FDT.  'BUILDFDT' IS CALLED @YL026UL*/
*/*             ONCE FOR EACH PARAMETER, EVEN IF THE PARM    @YL026UL*/
*/*             CONSISTS OF A LIST OF ITEMS.  THE DATA ITEMS @YL026UL*/
*/*             ARE CHECKED FOR SEMANTIC CORRECTNESS BEFORE  @YL026UL*/
*/*             BEING PLACED IN THE FDT--IF AN ITEM IS NOT   @YL026UL*/
*/*             CORRECT, A REPLACEMENT VALUE IS PROMPTED FOR @YL026UL*/
*/*             AND THEN IT IS CHECKED FOR CORRECTNESS.  THE @YL026UL*/
*/*             SEMANTIC REQUIREMENTS AND DATA SUBSTRUCTURE  @YL026UL*/
*/*             FORMAT FOR A PARTICULAR PARAMETER ARE FOUND  @YL026UL*/
*/*             BY EXAMINING THE COMMAND DESCRIPTOR ENTRY.   @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR SECTION FOR CURRENT PARM.  @YL026UL*/
*/*            PDE -     PARM DESCRIPTOR ENTRY CONTAINING    @YL026UL*/
*/*                      PARSE-ENCODED DATA FOR CURRENT PARM @YL026UL*/
*/*            NAMEPDE - FLAG SET SO AS TO IDENTIFY THE      @YL026UL*/
*/*                      FORMAT OF THE PDE.                  @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            FDT -     DATA SUBSTRUCTURE ENTRY (AND PTR    @YL026UL*/
*/*                      TO IT) FOR CURRENT PARAMETER        @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/
*/*                      ZERO VALUE IF PROCESSING CANNOT     @YL026UL*/
*/*                      BE CONTINUED.                       @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*BUILDFDT:PROCEDURE;                                       /*@YL026UL*/
BUILDFDT STM   @14,@02,@SA00008                                    0652
         STM   @04,@06,@SA00008+20                                 0652
         STM   @08,@12,@SA00008+32                                 0652
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** BUILDFDT **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0653
*        DCL BLKPTR   PTR(31);         /*PTR TO STORAGE AREA @YL026UL*/
*                                      /*FROM WHICH FDT DATA @YL026UL*/
*                                      /*STRUCTURES ARE TO   @YL026UL*/
*                                      /*BE ALLOCATED        @YL026UL*/
*        DCL DATAPTR  PTR(31);         /*PTR TO FDT DATA     @YL026UL*/
*                                      /*AREA CURRENTLY      @YL026UL*/
*                                      /*BEING BUILT.        @YL026UL*/
*                                                                  0655
*        DCL NUMBRCNT FIXED(31)        /*COUNT FOR LIST OF   @YL026UL*/
*                     BASED(DATAPTR);  /*NUMERIC CONSTANTS   @YL026UL*/
*        DCL STRNGCNT FIXED(15)        /*COUNT FOR LIST OF   @YL026UL*/
*                     BASED(DATAPTR);  /*STRING OR DSNAME    @YL026UL*/
*                                      /*CONSTANTS           @YL026UL*/
*                                                                  0657
*        /*FDT FORMAT FOR NUMERIC CONSTANT                   @YL026UL*/
*        DCL FULLWORD FIXED(31) BASED(DATAPTR);            /*@YL026UL*/
*                                                                  0657
*        /*FDT FORMAT FOR STRING CONSTANT                    @YL026UL*/
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        0658
*              2 STRNG1LN FIXED(8),    /*STRING LENGTH       @YL026UL*/
*              2 STRNG1   CHAR(*);     /*STRING CONSTANT     @YL026UL*/
*                                                                  0658
*        /*FDT FORMAT FOR STRING CONSTANT WITH PASSWORD      @YL026UL*/
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        0659
*              2 STRPWLEN FIXED(8),    /*PASSWORD LENGTH     @YL026UL*/
*              2 STRPWORD CHAR(8),     /*PASSWORD CONSTANT   @YL026UL*/
*              2 STRNG2LN FIXED(8),    /*STRING LENGTH       @YL026UL*/
*              2 STRNG2   CHAR(*);     /*STRING CONSTANT     @YL026UL*/
*                                                                  0659
*        /*FDT FORMAT FOR DATA SET NAME                      @YL026UL*/
*        DCL 1 DSNSTRCT BASED(DATAPTR) BDY(HWORD),                 0660
*              2 PWORDLEN FIXED(8),    /*PASSWORD LENGTH     @YL026UL*/
*              2 PWORD    CHAR(8),     /*PASSWORD CONSTANT   @YL026UL*/
*              2 STARPOS  FIXED(8),    /*ASTERISK POSITION   @YL026UL*/
*              2 UNQUOTED BIT(1),      /*'UNQUOTED' FLAG     @YL026UL*/
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/
*              2 MEMBRLEN FIXED(8),    /*MEMBER NAME LENGTH  @YL026UL*/
*              2 MEMBR    CHAR(8),     /*MEMBER NAME         @YL026UL*/
*              2 DSNAMELN FIXED(8),    /*DSNAME LENGTH       @YL026UL*/
*              2 DSNAME   CHAR(44);    /*DATA SET NAME       @YL026UL*/
*                                                                  0660
*        DCL STARCNT  FIXED(15);       /*NUMBER OF ASTERISKS @YL026UL*/
*                                      /*FOUND IN A DSNAME   @YL026UL*/
*        DCL WORKPTR1 PTR(31);         /*PTR WORK VARIABLE   @YL026UL*/
*                                                                  0662
*        DCL STAR     CHAR(1)          /*ASTERISK CHARACTER  @YL026UL*/
*                     CONSTANT('*');                       /*@YL026UL*/
*                                                                  0663
*        /*ERROR MESSAGE ID NUMBERS                          @YL026UL*/
*        DCL OUTARANG FIXED(15)        /*NUMBER IS OUT OF    @YL026UL*/
*                     CONSTANT(1);     /*ALLOWED VALUE RANGE @YL026UL*/
*        DCL BADNAME  FIXED(15)        /*NAME DOESN'T ADHERE @YL026UL*/
*                     CONSTANT(2);     /*NAMING RESTRICTIONS @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** BUILDFDT **  BUILD FDT DATA SUBSTRUCTURE     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0666
         L     @02,GDTTR2(,GDTPTR)                                 0666
         MVC   @TS00001(95),NEWERID2(@02)                          0666
         MVC   OLDERID2(95,@02),@TS00001                           0666
*        NEWID2='RI22';                                    /*@YL026UL*/
*                                                                  0667
         MVC   NEWID2(4,@02),@CC01663                              0667
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*DETERMINE THE PDE FORMAT FOR THE CURRENT PARM     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF NUMBER=YES  (ANYSTRNG=YES & PWORDOPT=NO)              0668
*          THEN                                                    0668
         LA    @02,12                                              0668
         LR    @15,@02                                             0668
         MH    @15,PARMID                                          0668
         L     @01,PINFOPTR                                        0668
         AL    @01,@CF01818                                        0668
         AL    @02,PARMPTR(@15,@01)                                0668
         TM    NUMBER(@02),B'10000000'                             0668
         BO    @RT00668                                            0668
         TM    ANYSTRNG(@02),B'01000000'                           0668
         BNO   @RF00668                                            0668
         TM    PWORDOPT(@02),B'00000010'                           0668
         BNZ   @RF00668                                            0668
@RT00668 DS    0H                                                  0669
*            NAMEPDE=NO;                                   /*@YL026UL*/
         NI    NAMEPDE,B'11110111'                                 0669
*          ELSE                                                    0670
*            NAMEPDE=YES;                                  /*@YL026UL*/
*                                                                  0670
         B     @RC00668                                            0670
@RF00668 OI    NAMEPDE,B'00001000'                                 0670
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* OBTAIN SPACE FOR THE FDT SUBSTRUCTURE FOR THIS   @YL026UL*/
*        /* PARAMETER.  COUNT THE NUMBER OF LIST ELEMENTS IF @YL026UL*/
*        /* THIS PARAMETER IS A LIST, STORING THE COUNT INTO @YL026UL*/
*        /* THE FDT SUBSTRUCTURE.                            @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0671
*        CALL GETSPACE;                                    /*@YL026UL*/
*                                                                  0671
@RC00668 BAL   @14,GETSPACE                                        0671
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF GETSPACE FAILS TO OBTAIN THE STORAGE NEEDED, @Y30SSFR*/
*        /*  RETURN TO THE CALLER OF BUILDFDT.               @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        IF LASTCC^=0                                              0672
*          THEN                                                    0672
         L     @02,@PC00001+16                                     0672
         LH    @02,LASTCC(,@02)                                    0672
         LTR   @02,@02                                             0672
         BNZ   @RT00672                                            0672
*            RETURN;                                       /*#YL026UL*/
*                                                                  0673
*        IF LIST=YES                                               0674
*          THEN                                                    0674
         LA    @02,12                                              0674
         LR    @15,@02                                             0674
         MH    @15,PARMID                                          0674
         L     @01,PINFOPTR                                        0674
         AL    @01,@CF01818                                        0674
         L     @15,PARMPTR(@15,@01)                                0674
         TM    LIST(@15),B'00001000'                               0674
         BNO   @RF00674                                            0674
*            IF NUMBER=YES                                         0675
*              THEN                                                0675
         ALR   @15,@02                                             0675
         TM    NUMBER(@15),B'10000000'                             0675
         BNO   @RF00675                                            0675
*                DO;                                       /*#YL026UL*/
*                NUMBRCNT=LISTTOTL;                        /*#YL026UL*/
         LH    @02,LISTTOTL                                        0677
         ST    @02,NUMBRCNT(,DATAPTR)                              0677
*                DATAPTR=DATAPTR+LENGTH(NUMBRCNT);         /*#YL026UL*/
         AL    DATAPTR,@CF00050                                    0678
*                END;                                      /*#YL026UL*/
*              ELSE                                                0680
*                DO;                                       /*#YL026UL*/
         B     @RC00675                                            0680
@RF00675 DS    0H                                                  0681
*                STRNGCNT=LISTTOTL;                        /*#YL026UL*/
         LH    @02,LISTTOTL                                        0681
         STH   @02,STRNGCNT(,DATAPTR)                              0681
*                DATAPTR=DATAPTR+LENGTH(STRNGCNT);         /*#YL026UL*/
         AL    DATAPTR,@CF00161                                    0682
*                END;                                      /*#YL026UL*/
*                                                                  0683
*        /************************************************************/
*        /*                                                  #YL026UL*/
*        /* FOR EACH ELEMENT OF THE PDE (ONLY ONE IF NOT A   #YL026UL*/
*        /* LIST), CHECK FOR SEMANTIC ERRORS AND MOVE THE    #YL026UL*/
*        /* DATA ITEM(S) INTO THE FDT SUBSTRUCTURE.          #YL026UL*/
*        /*                                                  #YL026UL*/
*        /************************************************************/
*DOLOOP20:DO INDEX7=1 TO LISTTOTL;                         /*#YL026UL*/
@RC00675 DS    0H                                                  0684
@RF00674 DS    0H                                                  0684
DOLOOP20 LA    INDEX7,1                                            0684
         B     @DE00684                                            0684
@DL00684 DS    0H                                                  0685
*          ALLOK=NO;                                       /*#YL026UL*/
*                                                                  0685
         NI    ALLOK,B'11011111'                                   0685
*          /**********************************************************/
*          /*                                                #YL026UL*/
*          /* IF THE PARAMETER IS NUMERIC, CHECK THAT THE    #YL026UL*/
*          /* VALUE IS WITHIN THE ALLOWABLE VALUE LIMITS.    #YL026UL*/
*          /* PROMPT FOR A REPLACEMENT VALUE IF NECESSARY.   #YL026UL*/
*          /* STORE THE NUMBER INTO THE FDT.                 #YL026UL*/
*          /*                                                #YL026UL*/
*          /**********************************************************/
*          IF NUMBER=YES                                           0686
*            THEN                                                  0686
         LA    @04,12                                              0686
         LR    @02,@04                                             0686
         MH    @02,PARMID                                          0686
         L     @01,PINFOPTR                                        0686
         AL    @01,@CF01818                                        0686
         AL    @04,PARMPTR(@02,@01)                                0686
         TM    NUMBER(@04),B'10000000'                             0686
         BNO   @RF00686                                            0686
*              DO WHILE(ALLOK=NO);                         /*#YL026UL*/
         B     @DE00687                                            0687
@DL00687 DS    0H                                                  0688
*                IF PDENUMBR > HIVALUE    PDENUMBR < LOWVALUE     0688
*                  THEN                                            0688
*                                                                  0688
         L     @04,CONSTPTR(,PDEPTR)                               0688
         L     @04,PDENUMBR(,@04)                                  0688
         LA    @02,12                                              0688
         LR    @15,@02                                             0688
         MH    @15,PARMID                                          0688
         L     @01,PINFOPTR                                        0688
         AL    @01,@CF01818                                        0688
         AL    @02,PARMPTR(@15,@01)                                0688
         C     @04,HIVALUE(,@02)                                   0688
         BH    @RT00688                                            0688
         C     @04,LOWVALUE(,@02)                                  0688
         BNL   @RF00688                                            0688
@RT00688 DS    0H                                                  0689
*                    CALL NEWPARM(OUTARANG,ADDR(NUMPCL));  /*#YL026UL*/
*                                                                  0689
         LA    @04,@CH00227                                        0689
         ST    @04,@AL00001                                        0689
         L     @04,@CV01498                                        0689
         ST    @04,@AFTEMPS+4                                      0689
         LA    @04,@AFTEMPS+4                                      0689
         ST    @04,@AL00001+4                                      0689
         LA    @01,@AL00001                                        0689
         BAL   @14,NEWPARM                                         0689
*                  ELSE                                            0690
*                    DO;                                   /*#YL026UL*/
         B     @RC00688                                            0690
@RF00688 DS    0H                                                  0691
*                    ALLOK=YES;                            /*#YL026UL*/
         OI    ALLOK,B'00100000'                                   0691
*                    FULLWORD=PDENUMBR;                    /*#YL026UL*/
         L     @04,CONSTPTR(,PDEPTR)                               0692
         L     @04,PDENUMBR(,@04)                                  0692
         ST    @04,FULLWORD(,DATAPTR)                              0692
*                    END;                                  /*#YL026UL*/
*                                                                  0693
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  IF THE PROMPTING FOR A REPLACEMENT      @Y30SSFR*/
*                /*  PARAMETER HAS FAILED, RETURN TO THE     @Y30SSFR*/
*                /*  CALLER OF BUILDFDT.                     @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                IF LASTCC^=0                                      0694
*                  THEN                                            0694
@RC00688 L     @04,@PC00001+16                                     0694
         LH    @04,LASTCC(,@04)                                    0694
         LTR   @04,@04                                             0694
         BNZ   @RT00694                                            0694
*                    RETURN;                               /*#YL026UL*/
*              END;                                        /*#YL026UL*/
@DE00687 TM    ALLOK,B'00100000'                                   0696
         BZ    @DL00687                                            0696
*            ELSE                                                  0697
*              IF ANYSTRNG=YES                                     0697
*                THEN                                              0697
         B     @RC00686                                            0697
@RF00686 LA    @04,12                                              0697
         LR    @02,@04                                             0697
         MH    @02,PARMID                                          0697
         L     @01,PINFOPTR                                        0697
         AL    @01,@CF01818                                        0697
         AL    @04,PARMPTR(@02,@01)                                0697
         TM    ANYSTRNG(@04),B'01000000'                           0697
         BNO   @RF00697                                            0697
*DOLOOP25:         DO WHILE(ALLOK=NO);                     /*#YL026UL*/
*                                                                  0698
DOLOOP25 B     @DE00698                                            0698
@DL00698 DS    0H                                                  0699
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* IF THE PARM IS A STRING CONSTANT     @YL026UL*/
*                    /* WITH A POSSIBLE PASSWORD, IT HAS     @YL026UL*/
*                    /* BEEN DEFINED TO 'PARSE' AS A DSNAME. @YL026UL*/
*                    /* CHECK THAT NO 'MEMBER NAME' WAS      @YL026UL*/
*                    /* CODED WITHIN THE STRING AND          @YL026UL*/
*                    /* THAT THE LENGTH LIMIT HASN'T BEEN    @YL026UL*/
*                    /* EXCEEDED.  PROMPT FOR REPLACEMENT    @YL026UL*/
*                    /* VALUE IF THE CURRENT ONE IS BAD;     @YL026UL*/
*                    /* OTHERWISE, STORE THE CONSTANT INTO   @YL026UL*/
*                    /* THE FDT.                             @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    IF PWORDOPT=YES                               0699
*                      THEN                                        0699
         LA    @04,12                                              0699
         LR    @02,@04                                             0699
         MH    @02,PARMID                                          0699
         L     @01,PINFOPTR                                        0699
         AL    @01,@CF01818                                        0699
         AL    @04,PARMPTR(@02,@01)                                0699
         TM    PWORDOPT(@04),B'00000010'                           0699
         BNO   @RF00699                                            0699
*                        IF MEMIN=YES                             0700
*                           DSNLEN > MAXLNGTH    DSNLEN = 0       0700
*                          THEN                                    0700
*                                                                  0700
         TM    MEMIN(PDEPTR),B'10000000'                           0700
         BO    @RT00700                                            0700
         LH    @02,DSNLEN(,PDEPTR)                                 0700
         SLR   @15,@15                                             0700
         IC    @15,MAXLNGTH(,@04)                                  0700
         CR    @02,@15                                             0700
         BH    @RT00700                                            0700
         LTR   @02,@02                                             0700
         BNZ   @RF00700                                            0700
@RT00700 DS    0H                                                  0701
*                            CALL NEWPARM(BADNAME,                 0701
*                                         ADDR(DDNPCL));   /*@YL026UL*/
*                                                                  0701
         LA    @04,@CH00161                                        0701
         ST    @04,@AL00001                                        0701
         L     @04,@CV01500                                        0701
         ST    @04,@AFTEMPS+4                                      0701
         LA    @04,@AFTEMPS+4                                      0701
         ST    @04,@AL00001+4                                      0701
         LA    @01,@AL00001                                        0701
         BAL   @14,NEWPARM                                         0701
*                          ELSE                                    0702
*DOGRP45:                    DO;                           /*@YL026UL*/
         B     @RC00700                                            0702
@RF00700 DS    0H                                                  0702
DOGRP45  DS    0H                                                  0703
*                            ALLOK=YES;                    /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   0703
*                            STRNG2LN=DSNLEN;              /*@YL026UL*/
         LH    @04,DSNLEN(,PDEPTR)                                 0704
         STC   @04,STRNG2LN(,DATAPTR)                              0704
*                            WORKPTR1=ADDR(STRNG2);        /*@YL026UL*/
         LA    @02,STRNG2(,DATAPTR)                                0705
         ST    @02,WORKPTR1                                        0705
*                            RESPECIFY (DATABLK)                   0706
*                                 BASED(WORKPTR1);         /*@YL026UL*/
*                            STRNG2(1)=' ';                /*@YL026UL*/
         MVI   STRNG2(DATAPTR),C' '                                0707
*                            STRNG2(2:MAXLNGTH)=                   0708
*                                 DATABLK(1:MAXLNGTH-1);   /*@YL026UL*/
         LA    @15,12                                              0708
         LR    @14,@15                                             0708
         MH    @14,PARMID                                          0708
         L     @01,PINFOPTR                                        0708
         AL    @01,@CF01818                                        0708
         AL    @15,PARMPTR(@14,@01)                                0708
         SLR   @14,@14                                             0708
         IC    @14,MAXLNGTH(,@15)                                  0708
         BCTR  @14,0                                               0708
         BCTR  @14,0                                               0708
         EX    @14,@SM01836                                        0708
*                            STRNG2(1:DSNLEN)=                     0709
*                                 PDEDSN(1:DSNLEN);        /*@YL026UL*/
*                                                                  0709
         BCTR  @04,0                                               0709
         L     @02,DSNPTR(,PDEPTR)                                 0709
         EX    @04,@SM01838                                        0709
*                            /****************************************/
*                            /*                              @YL026UL*/
*                            /* IF THE STRING HAS A PASSWORD @YL026UL*/
*                            /* STORE IT INTO THE FDT.       @YL026UL*/
*                            /*                              @YL026UL*/
*                            /****************************************/
*                            IF PWDLEN > 0                         0710
*                              THEN                                0710
         LH    @04,PWDLEN(,PDEPTR)                                 0710
         LTR   @04,@04                                             0710
         BNP   @RF00710                                            0710
*                                DO;                       /*@YL026UL*/
*                                STRPWLEN=PWDLEN;          /*@YL026UL*/
         STC   @04,STRPWLEN(,DATAPTR)                              0712
*                                STRPWORD=                         0713
*                                    PDEPWD(1:PWDLEN);     /*@YL026UL*/
         MVI   STRPWORD+1(DATAPTR),C' '                            0713
         MVC   STRPWORD+2(6,DATAPTR),STRPWORD+1(DATAPTR)           0713
         BCTR  @04,0                                               0713
         L     @02,PWDPTR(,PDEPTR)                                 0713
         EX    @04,@SM01840                                        0713
*                                END;                      /*@YL026UL*/
*                            END DOGRP45;                  /*@YL026UL*/
*                      ELSE                                        0716
*                                                                  0716
*                        /********************************************/
*                        /*                                  @YL026UL*/
*                        /* IF THE PARM IS A STRING CONSTANT @YL026UL*/
*                        /* CHECK THAT THE LENGTH LIMIT HAS  @YL026UL*/
*                        /* NOT BEEN EXCEEDED--PROMPT FOR A  @YL026UL*/
*                        /* REPLACEMENT VALUE IF NECESSARY.  @YL026UL*/
*                        /* STORE THE CONSTANT INTO THE FDT. @YL026UL*/
*                        /*                                  @YL026UL*/
*                        /********************************************/
*                        IF CONSTLEN > MAXLNGTH    CONSTLEN = 0   0716
*                          THEN                                    0716
*                                                                  0716
         B     @RC00699                                            0716
@RF00699 LH    @04,CONSTLEN(,PDEPTR)                               0716
         LA    @02,12                                              0716
         LR    @15,@02                                             0716
         MH    @15,PARMID                                          0716
         L     @01,PINFOPTR                                        0716
         AL    @01,@CF01818                                        0716
         AL    @02,PARMPTR(@15,@01)                                0716
         SLR   @15,@15                                             0716
         IC    @15,MAXLNGTH(,@02)                                  0716
         CR    @04,@15                                             0716
         BH    @RT00716                                            0716
         LTR   @04,@04                                             0716
         BNZ   @RF00716                                            0716
@RT00716 DS    0H                                                  0717
*                            CALL NEWPARM(BADLEN,                  0717
*                                         ADDR(STRPCL));   /*@YL026UL*/
*                                                                  0717
         LA    @04,@CH00170                                        0717
         ST    @04,@AL00001                                        0717
         L     @04,@CV01499                                        0717
         ST    @04,@AFTEMPS+4                                      0717
         LA    @04,@AFTEMPS+4                                      0717
         ST    @04,@AL00001+4                                      0717
         LA    @01,@AL00001                                        0717
         BAL   @14,NEWPARM                                         0717
*                          ELSE                                    0718
*                            DO;                           /*@YL026UL*/
         B     @RC00716                                            0718
@RF00716 DS    0H                                                  0719
*                            ALLOK=YES;                    /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   0719
*                            STRNG1LN=CONSTLEN;            /*@YL026UL*/
         LH    @04,CONSTLEN(,PDEPTR)                               0720
         STC   @04,STRNG1LN(,DATAPTR)                              0720
*                            WORKPTR1=ADDR(STRNG1);        /*@YL026UL*/
         LA    @02,STRNG1(,DATAPTR)                                0721
         ST    @02,WORKPTR1                                        0721
*                            RESPECIFY (DATABLK)                   0722
*                                   BASED(WORKPTR1);       /*@YL026UL*/
*                            STRNG1(1)=' ';                /*@YL026UL*/
         MVI   STRNG1(DATAPTR),C' '                                0723
*                            STRNG1(2:MAXLNGTH)=                   0724
*                                   DATABLK(1:MAXLNGTH-1); /*@YL026UL*/
         LA    @15,12                                              0724
         LR    @14,@15                                             0724
         MH    @14,PARMID                                          0724
         L     @01,PINFOPTR                                        0724
         AL    @01,@CF01818                                        0724
         AL    @15,PARMPTR(@14,@01)                                0724
         SLR   @14,@14                                             0724
         IC    @14,MAXLNGTH(,@15)                                  0724
         BCTR  @14,0                                               0724
         BCTR  @14,0                                               0724
         EX    @14,@SM01842                                        0724
*                            STRNG1(1:STRNG1LN)=                   0725
*                                   PDESTRNG(1:STRNG1LN);  /*@YL026UL*/
         BCTR  @04,0                                               0725
         L     @02,CONSTPTR(,PDEPTR)                               0725
         EX    @04,@SM01844                                        0725
*                            END;                          /*@YL026UL*/
*                                                                  0726
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF THE PROMPTING FOR A REPLACEMENT  @Y30SSFR*/
*                    /*  PARAMETER HAS FAILED, RETURN TO THE @Y30SSFR*/
*                    /*  CALLER OF BUILDFDT.                 @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF LASTCC^=0                                  0727
*                      THEN                                        0727
@RC00716 DS    0H                                                  0727
@RC00699 L     @04,@PC00001+16                                     0727
         LH    @04,LASTCC(,@04)                                    0727
         LTR   @04,@04                                             0727
         BNZ   @RT00727                                            0727
*                        RETURN;                           /*@YL026UL*/
*                  END DOLOOP25;                           /*@YL026UL*/
@DE00698 TM    ALLOK,B'00100000'                                   0729
         BZ    @DL00698                                            0729
*                ELSE                                              0730
*                                                                  0730
*                  /**************************************************/
*                  /*                                        @YL026UL*/
*                  /* IF THE PARAMETER IS A DSNAME, CHECK    @YL026UL*/
*                  /* THAT A NULL DSNAME WASN'T CODED.  IF   @YL026UL*/
*                  /* THE NAME MAY BE GENERIC, CHECK THAT    @YL026UL*/
*                  /* JUST A SINGLE ASTERISK WAS CODED AND   @YL026UL*/
*                  /* THAT IT WASN'T CODED AS THE 1ST CHAR.  @YL026UL*/
*                  /* PROMPT FOR A REPLACEMENT NAME IF THE   @YL026UL*/
*                  /* CURRENT ONE IS INVALID.                @YL026UL*/
*                  /*                                        @YL026UL*/
*                  /**************************************************/
*DOLOOP30:         DO WHILE(ALLOK=NO);                     /*@YL026UL*/
         B     @RC00697                                            0730
@RF00697 DS    0H                                                  0730
DOLOOP30 B     @DE00730                                            0730
@DL00730 DS    0H                                                  0731
*                    STARPOS=0;                            /*@YL026UL*/
         MVI   STARPOS(DATAPTR),X'00'                              0731
*                    STARCNT=0;                            /*@YL026UL*/
         SLR   STARCNT,STARCNT                                     0732
*                    IF GENERIC=YES                                0733
*                      THEN                                        0733
         LA    @04,12                                              0733
         LR    @15,@04                                             0733
         MH    @15,PARMID                                          0733
         L     @01,PINFOPTR                                        0733
         AL    @01,@CF01818                                        0733
         AL    @04,PARMPTR(@15,@01)                                0733
         TM    GENERIC(@04),B'00010000'                            0733
         BNO   @RF00733                                            0733
*                        DO INDEX8=1 TO DSNLEN;            /*@YL026UL*/
         LA    INDEX8,1                                            0734
         B     @DE00734                                            0734
@DL00734 DS    0H                                                  0735
*                          IF PDEDSN(INDEX8)=STAR                  0735
*                            THEN                                  0735
         L     @01,DSNPTR(,PDEPTR)                                 0735
         ALR   @01,INDEX8                                          0735
         BCTR  @01,0                                               0735
         CLI   PDEDSN(@01),C'*'                                    0735
         BNE   @RF00735                                            0735
*                              DO;                         /*@YL026UL*/
*                              STARPOS=INDEX8;             /*@YL026UL*/
         STC   INDEX8,STARPOS(,DATAPTR)                            0737
*                              STARCNT=STARCNT+1;          /*@YL026UL*/
         AL    STARCNT,@CF00227                                    0738
*                              END;                        /*@YL026UL*/
*                        END;                              /*@YL026UL*/
*                                                                  0740
@RF00735 AL    INDEX8,@CF00227                                     0740
@DE00734 CH    INDEX8,DSNLEN(,PDEPTR)                              0740
         BNH   @DL00734                                            0740
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* IF THE NAME IS INVALID, SELECT A     @YL026UL*/
*                    /* 'STANDARD' PCL BASED UPON THE DATA   @YL026UL*/
*                    /* TYPE OF THE NAME AND PROMPT FOR A    @YL026UL*/
*                    /* NEW VALUE.                           @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    IF STARCNT>1  STARPOS=1  DSNIN=NO  DSNLEN=0
*                      THEN                                        0741
@RF00733 C     STARCNT,@CF00227                                    0741
         BH    @RT00741                                            0741
         CLI   STARPOS(DATAPTR),1                                  0741
         BE    @RT00741                                            0741
         TM    DSNIN(PDEPTR),B'10000000'                           0741
         BZ    @RT00741                                            0741
         LH    @04,DSNLEN(,PDEPTR)                                 0741
         LTR   @04,@04                                             0741
         BNZ   @RF00741                                            0741
@RT00741 DS    0H                                                  0742
*                        DO;                               /*@YL026UL*/
*                                                                  0742
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  IF WE ARE LOOKING FOR A VOLSER, @Y30SSFR*/
*                        /*  USE THE GENERIC PROMPT IF       @Y30SSFR*/
*                        /*  ACCEPTABLE, AND OTHERWISE, USE  @Y30SSFR*/
*                        /*  THE NON-GENERIC PROMPT.         @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                        IF VOLID=YES                              0743
*                          THEN                                    0743
         LA    @04,12                                              0743
         LR    @02,@04                                             0743
         MH    @02,PARMID                                          0743
         L     @01,PINFOPTR                                        0743
         AL    @01,@CF01818                                        0743
         AL    @04,PARMPTR(@02,@01)                                0743
         TM    VOLID(@04),B'00001000'                              0743
         BNO   @RF00743                                            0743
*                            IF GENERIC=YES                        0744
*                              THEN                                0744
         TM    GENERIC(@04),B'00010000'                            0744
         BNO   @RF00744                                            0744
*                                WORKPTR1=ADDR(DSGVPCL);   /*@YL026UL*/
         L     @04,@CV01504                                        0745
         ST    @04,WORKPTR1                                        0745
*                              ELSE                                0746
*                                WORKPTR1=ADDR(DSVPCL);    /*@YL026UL*/
*                                                                  0746
         B     @RC00744                                            0746
@RF00744 L     @04,@CV01502                                        0746
         ST    @04,WORKPTR1                                        0746
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  PROMPT FOR A DATA SET NAME.   @Y30SSFR*/
*                          /*  USE THE GENERIC PROMPT IF     @Y30SSFR*/
*                          /*  POSSIBLE.                     @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                          ELSE                                    0747
*                            IF GENERIC=YES                        0747
*                              THEN                                0747
         B     @RC00743                                            0747
@RF00743 LA    @04,12                                              0747
         LR    @02,@04                                             0747
         MH    @02,PARMID                                          0747
         L     @01,PINFOPTR                                        0747
         AL    @01,@CF01818                                        0747
         AL    @04,PARMPTR(@02,@01)                                0747
         TM    GENERIC(@04),B'00010000'                            0747
         BNO   @RF00747                                            0747
*                                WORKPTR1=ADDR(DSGPCL);    /*@YL026UL*/
         L     @04,@CV01503                                        0748
         ST    @04,WORKPTR1                                        0748
*                              ELSE                                0749
*                                WORKPTR1=ADDR(DSNPCL);    /*@YL026UL*/
*                                                                  0749
         B     @RC00747                                            0749
@RF00747 L     @04,@CV01501                                        0749
         ST    @04,WORKPTR1                                        0749
*                        /********************************************/
*                        /*                                  @YL026UL*/
*                        /* IF THE NAME IS NOT TO BE         @YL026UL*/
*                        /* PREFIXED, POINT TO THE PCL THAT  @YL026UL*/
*                        /* THAT IS IDENTICAL EXCEPT FOR     @YL026UL*/
*                        /* THE PREFIXING REQUEST.           @YL026UL*/
*                        /*                                  @YL026UL*/
*                        /********************************************/
*                        IF USERID=NO                              0750
*                          THEN                                    0750
@RC00747 DS    0H                                                  0750
@RC00743 LA    @04,12                                              0750
         LR    @02,@04                                             0750
         MH    @02,PARMID                                          0750
         L     @01,PINFOPTR                                        0750
         AL    @01,@CF01818                                        0750
         AL    @04,PARMPTR(@02,@01)                                0750
         TM    USERID(@04),B'00000100'                             0750
         BNZ   @RF00750                                            0750
*                            WORKPTR1=WORKPTR1 +                   0751
*                              ADDR(DSNPCL2)-ADDR(DSNPCL); /*@YL026UL*/
*                                                                  0751
         L     @04,@CV01505                                        0751
         AL    @04,WORKPTR1                                        0751
         L     @02,@CV01501                                        0751
         SLR   @04,@02                                             0751
         ST    @04,WORKPTR1                                        0751
*                        CALL NEWPARM(BADNAME,WORKPTR1);   /*@YL026UL*/
*                                                                  0752
@RF00750 LA    @04,@CH00161                                        0752
         ST    @04,@AL00001                                        0752
         LA    @04,WORKPTR1                                        0752
         ST    @04,@AL00001+4                                      0752
         LA    @01,@AL00001                                        0752
         BAL   @14,NEWPARM                                         0752
*                        END;                              /*@YL026UL*/
*                                                                  0753
*                      /**********************************************/
*                      /*                                    @YL026UL*/
*                      /* IF THE DSNAME IS VALID, MOVE THE   @YL026UL*/
*                      /* INPUT CONSTANT(S) AND LENGTH(S)    @YL026UL*/
*                      /* INTO THE FDT.  IF THE DSNAME WAS   @YL026UL*/
*                      /* NOT ENTERED IN QUOTES, SET THE     @YL026UL*/
*                      /* 'UNQUOTED' FLAG OF THE FDT 'ON'    @YL026UL*/
*                      /*                                    @YL026UL*/
*                      /**********************************************/
*                      ELSE                                        0754
*DOGRP55:                DO;                               /*@YL026UL*/
         B     @RC00741                                            0754
@RF00741 DS    0H                                                  0754
DOGRP55  DS    0H                                                  0755
*                        ALLOK=YES;                        /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   0755
*                        IF PWDIN=YES                              0756
*                          THEN                                    0756
         TM    PWDIN(PDEPTR),B'10000000'                           0756
         BNO   @RF00756                                            0756
*                            DO;                           /*@YL026UL*/
*                            PWORDLEN=PWDLEN;              /*@YL026UL*/
         LH    @04,PWDLEN(,PDEPTR)                                 0758
         STC   @04,PWORDLEN(,DATAPTR)                              0758
*                            PWORD=PDEPWD(1:PWDLEN);       /*@YL026UL*/
         MVI   PWORD+1(DATAPTR),C' '                               0759
         MVC   PWORD+2(6,DATAPTR),PWORD+1(DATAPTR)                 0759
         BCTR  @04,0                                               0759
         L     @01,PWDPTR(,PDEPTR)                                 0759
         EX    @04,@SM01846                                        0759
*                            END;                          /*@YL026UL*/
*                        IF MEMIN=YES                              0761
*                          THEN                                    0761
@RF00756 TM    MEMIN(PDEPTR),B'10000000'                           0761
         BNO   @RF00761                                            0761
*                            DO;                           /*@YL026UL*/
*                            MEMBRLEN=MEMLEN;              /*@YL026UL*/
         LH    @04,MEMLEN(,PDEPTR)                                 0763
         STC   @04,MEMBRLEN(,DATAPTR)                              0763
*                            MEMBR=PDEMEM(1:MEMLEN);       /*@YL026UL*/
         MVI   MEMBR+1(DATAPTR),C' '                               0764
         MVC   MEMBR+2(6,DATAPTR),MEMBR+1(DATAPTR)                 0764
         BCTR  @04,0                                               0764
         L     @01,MEMPTR(,PDEPTR)                                 0764
         EX    @04,@SM01848                                        0764
*                            END;                          /*@YL026UL*/
*                        DSNAMELN=DSNLEN;                  /*@YL026UL*/
@RF00761 LH    @04,DSNLEN(,PDEPTR)                                 0766
         STC   @04,DSNAMELN(,DATAPTR)                              0766
*                        DSNAME=PDEDSN(1:DSNLEN);          /*@YL026UL*/
         MVI   DSNAME+1(DATAPTR),C' '                              0767
         MVC   DSNAME+2(42,DATAPTR),DSNAME+1(DATAPTR)              0767
         BCTR  @04,0                                               0767
         L     @01,DSNPTR(,PDEPTR)                                 0767
         EX    @04,@SM01850                                        0767
*                        IF DSNQUOTE=NO & STARCNT=0                0768
*                          THEN                                    0768
         TM    DSNQUOTE(PDEPTR),B'01000000'                        0768
         BNZ   @RF00768                                            0768
         LTR   STARCNT,STARCNT                                     0768
         BNZ   @RF00768                                            0768
*                            UNQUOTED=YES;                 /*@YL026UL*/
         OI    UNQUOTED(DATAPTR),B'10000000'                       0769
*                        END DOGRP55;                      /*@YL026UL*/
*                                                                  0770
@RF00768 DS    0H                                                  0771
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF A PROMPT FOR A REPLACEMENT       @Y30SSFR*/
*                    /*  PARAMETER FAILED, RETURN TO THE     @Y30SSFR*/
*                    /*  CALLER.                             @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF LASTCC^=0                                  0771
*                      THEN                                        0771
@RC00741 L     @04,@PC00001+16                                     0771
         LH    @04,LASTCC(,@04)                                    0771
         LTR   @04,@04                                             0771
         BNZ   @RT00771                                            0771
*                        RETURN;                           /*#YL026UL*/
*                  END DOLOOP30;                           /*#YL026UL*/
*                                                                  0773
@DE00730 TM    ALLOK,B'00100000'                                   0773
         BZ    @DL00730                                            0773
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* PREPARE MOVE THE NEXT LIST ELEMENT (IN CASE    @YL026UL*/
*          /* THERE IS ONE) FROM THE PDE INTO THE FDT.       @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          IF LIST=YES                                             0774
*            THEN                                                  0774
@RC00697 DS    0H                                                  0774
@RC00686 LH    @04,PARMID                                          0774
         MH    @04,@CH00038                                        0774
         L     @02,PINFOPTR                                        0774
         AL    @02,@CF01818                                        0774
         L     @04,PARMPTR(@04,@02)                                0774
         TM    LIST(@04),B'00001000'                               0774
         BNO   @RF00774                                            0774
*              DO;                                         /*@YL026UL*/
*              DATAPTR=DATAPTR+SPACEAMT;                   /*@YL026UL*/
         AL    DATAPTR,SPACEAMT                                    0776
*              IF NAMEPDE=NO                                       0777
*                THEN                                              0777
         TM    NAMEPDE,B'00001000'                                 0777
         BNZ   @RF00777                                            0777
*                  PDEPTR=NXTCPDE;                         /*@YL026UL*/
         L     PDEPTR,NXTCPDE(,PDEPTR)                             0778
*                ELSE                                              0779
*                  PDEPTR=NXTDPDE;                         /*@YL026UL*/
         B     @RC00777                                            0779
@RF00777 L     PDEPTR,NXTDPDE(,PDEPTR)                             0779
*              END;                                        /*@YL026UL*/
*                                                                  0780
@RC00777 DS    0H                                                  0781
*        END DOLOOP20;                                     /*@YL026UL*/
*                                                                  0781
@RF00774 AL    INDEX7,@CF00227                                     0781
@DE00684 CH    INDEX7,LISTTOTL                                     0781
         BNH   @DL00684                                            0781
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - GETSPACE                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE ALLOCATES STORAGE SPACE FOR FDT @YL026UL*/
*/*             DATA SUBSTRUCTURES, BASED UPON THE TYPE OF   @YL026UL*/
*/*             PARAMETER CURRENTLY BEING TRANSLATED TO FDT  @YL026UL*/
*/*             FORM.  IF THE PARAMETER IS A LIST, THEN THE  @YL026UL*/
*/*             NUMBER OF ELEMENTS IN THE LIST IS COUNTED    @YL026UL*/
*/*             AND SPACE ENOUGH IS ALLOCATED FOR THEM ALL.  @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR ENTRY FOR CURRENT PARM.    @YL026UL*/
*/*            SINGLPRM- FLAG SET 'ON' IF THE INPUT PARM     @YL026UL*/
*/*                      HAS JUST A SINGLE ITEM OF DATA.     @YL026UL*/
*/*            PDEPTR -  POINTER TO PDE FOR CURRENT PARM.    @YL026UL*/
*/*            NAMEPDE - FLAG SET SO AS TO IDENTIFY THE      @YL026UL*/
*/*                      FORMAT OF THE PDE.                  @YL026UL*/
*/*            BLKLEFT - AMOUNT OF SPACE REMAINING IN DATA   @YL026UL*/
*/*                      BLOCK FROM WHICH FDT SUBSTRUCTURE   @YL026UL*/
*/*                      SPACE IS TO BE ALLOCATED.           @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            SPACEAMT- AMOUNT OF SPACE REQUIRED FOR A      @YL026UL*/
*/*                      SINGLE DATA ITEM (AND ITS ASSOC'D   @YL026UL*/
*/*                      LENGTHS, FLAGS, ETC.) OF THE DATA   @YL026UL*/
*/*                      TYPE OF THE CURRENT PARAMETER.      @YL026UL*/
*/*            LISTTOTL- NUMBER OF INPUT LIST ELEMENTS IF    @YL026UL*/
*/*                      CURRENT PARM MAY BE A LIST.         @YL026UL*/
*/*            BLKPTR -  POINTER TO NEXT AVAILABLE LOCATION  @YL026UL*/
*/*                      FROM WHICH SPACE MAY BE ALLOCATED   @YL026UL*/
*/*                      FOR FDT DATA SUBSTRUCTURES.         @YL026UL*/
*/*            BLKLEFT - AMOUNT OF SPACE AVAILABLE IN DATA   @YL026UL*/
*/*                      BLOCK AFTER CURRENT ALLOCATION IS   @YL026UL*/
*/*                      DONE.                               @YL026UL*/
*/*            DATAPTR - POINTER TO SPACE ALLOCATED FOR      @YL026UL*/
*/*                      CURRENT DATA SUBSTRUCTURE.          @YL026UL*/
*/*            FDT -     FDT POINTER TO DATA SUBSTRUCTURE.   @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*GETSPACE:PROCEDURE;                                       /*@YL026UL*/
         B     @PB00009                                            0782
GETSPACE STM   @14,@02,@SA00009                                    0782
         STM   @04,@06,@SA00009+20                                 0782
         STM   @08,@12,@SA00009+32                                 0782
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** GETSPACE **  DATA DECLARATIONS               @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0783
*        DCL NEXTPDE  PTR(31);         /*PTR TO NEXT PDE IN  @YL026UL*/
*                                      /*A PDE CHAIN         @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** GETSPACE **  GET SPACE FOR FDT SUBSTRUCTURES @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0784
         L     @02,GDTTR2(,GDTPTR)                                 0784
         MVC   @TS00001(95),NEWERID2(@02)                          0784
         MVC   OLDERID2(95,@02),@TS00001                           0784
*        NEWID2='RI24';                                    /*@YL026UL*/
*                                                                  0785
         MVC   NEWID2(4,@02),@CC01681                              0785
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* USE THE CURRENT PARAMETER'S DATA TYPE TO FIGURE  @YL026UL*/
*        /* THE AMOUNT OF SPACE THE DATA SUBSTRUCTURE WILL   @YL026UL*/
*        /* REQUIRE FOR A SINGLE ITEM OF THAT DATA TYPE.     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF NUMBER=YES                                             0786
*          THEN                                                    0786
         LA    @02,12                                              0786
         LR    @15,@02                                             0786
         MH    @15,PARMID                                          0786
         L     @01,PINFOPTR                                        0786
         AL    @01,@CF01818                                        0786
         AL    @02,PARMPTR(@15,@01)                                0786
         TM    NUMBER(@02),B'10000000'                             0786
         BNO   @RF00786                                            0786
*            SPACEAMT=LENGTH(FULLWORD);                    /*@YL026UL*/
         MVC   SPACEAMT(4),@CF00050                                0787
*          ELSE                                                    0788
*            IF DSNAM=YES                                          0788
*              THEN                                                0788
         B     @RC00786                                            0788
@RF00786 LA    @02,12                                              0788
         LR    @15,@02                                             0788
         MH    @15,PARMID                                          0788
         L     @01,PINFOPTR                                        0788
         AL    @01,@CF01818                                        0788
         AL    @02,PARMPTR(@15,@01)                                0788
         TM    DSNAM(@02),B'00100000'                              0788
         BNO   @RF00788                                            0788
*                SPACEAMT=LENGTH(DSNSTRCT);                /*@YL026UL*/
         MVC   SPACEAMT(4),@CF01803                                0789
*              ELSE                                                0790
*                IF ANYSTRNG=YES                                   0790
*                  THEN                                            0790
         B     @RC00788                                            0790
@RF00788 LA    @02,12                                              0790
         LR    @15,@02                                             0790
         MH    @15,PARMID                                          0790
         L     @01,PINFOPTR                                        0790
         AL    @01,@CF01818                                        0790
         AL    @02,PARMPTR(@15,@01)                                0790
         TM    ANYSTRNG(@02),B'01000000'                           0790
         BNO   @RF00790                                            0790
*                    DO;                                   /*@YL026UL*/
*                    SPACEAMT=LENGTH(STRNG1LN)+MAXLNGTH;   /*@YL026UL*/
         LA    @15,1                                               0792
         SLR   @14,@14                                             0792
         IC    @14,MAXLNGTH(,@02)                                  0792
         ALR   @15,@14                                             0792
         ST    @15,SPACEAMT                                        0792
*                    IF PWORDOPT=YES                               0793
*                      THEN                                        0793
         TM    PWORDOPT(@02),B'00000010'                           0793
         BNO   @RF00793                                            0793
*                        SPACEAMT=SPACEAMT+LENGTH(PWORD)+          0794
*                             LENGTH(STRPWLEN);            /*@YL026UL*/
         AL    @15,@CF00041                                        0794
         ST    @15,SPACEAMT                                        0794
*                    END;                                  /*@YL026UL*/
@RF00793 DS    0H                                                  0796
*        SPACEAMT=SPACEAMT+SPACEAMT//2;                    /*@YL026UL*/
*                                                                  0796
@RF00790 DS    0H                                                  0796
@RC00788 DS    0H                                                  0796
@RC00786 L     @02,SPACEAMT                                        0796
         LR    @00,@02                                             0796
         SRDA  @00,32                                              0796
         D     @00,@CF00161                                        0796
         ALR   @02,@00                                             0796
         ST    @02,SPACEAMT                                        0796
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE PARAMETER MAY BE A LIST OF ITEMS, COUNT   @YL026UL*/
*        /* THE NUMBER OF ITEMS IN THE LIST AND ALLOCATE     @YL026UL*/
*        /* SPACE ENOUGH FOR ALL OF THEM.  COUNT THEM BY     @YL026UL*/
*        /* STEPPING THROUGH THE PDE CHAIN UNTIL THE CHAIN-  @YL026UL*/
*        /* END POINTER IS FOUND.  IF NO LIST IS INPUT, THE  @YL026UL*/
*        /* COUNT IS 1.                                      @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        LISTTOTL=1;                                       /*@YL026UL*/
         MVC   LISTTOTL(2),@CH00227                                0797
*        IF LIST=NO  (LIST=YES & SINGLPRM=YES)                    0798
*          THEN                                                    0798
         LH    @02,PARMID                                          0798
         MH    @02,@CH00038                                        0798
         L     @01,PINFOPTR                                        0798
         AL    @01,@CF01818                                        0798
         L     @02,PARMPTR(@02,@01)                                0798
         TM    LIST(@02),B'00001000'                               0798
         BZ    @RT00798                                            0798
         TM    LIST(@02),B'00001000'                               0798
         BNO   @RF00798                                            0798
         TM    SINGLPRM,B'01000000'                                0798
         BNO   @RF00798                                            0798
@RT00798 DS    0H                                                  0799
*            AMTTOGET=SPACEAMT+LENGTH(NUMBRCNT);           /*@YL026UL*/
         LA    @02,4                                               0799
         AL    @02,SPACEAMT                                        0799
         ST    @02,AMTTOGET                                        0799
*          ELSE                                                    0800
*            DO;                                           /*@YL026UL*/
         B     @RC00798                                            0800
@RF00798 DS    0H                                                  0801
*              BASEPTR=PDEPTR;                             /*@YL026UL*/
         LR    BASEPTR,PDEPTR                                      0801
*              IF NAMEPDE=NO                                       0802
*                THEN                                              0802
         TM    NAMEPDE,B'00001000'                                 0802
         BNZ   @RF00802                                            0802
*                  NEXTPDE=NXTCPDE;                        /*@YL026UL*/
         L     NEXTPDE,NXTCPDE(,PDEPTR)                            0803
*                ELSE                                              0804
*                  NEXTPDE=NXTDPDE;                        /*@YL026UL*/
*                                                                  0804
         B     @RC00802                                            0804
@RF00802 L     NEXTPDE,NXTDPDE(,PDEPTR)                            0804
*              CNTDONE=NO;                                 /*@YL026UL*/
@RC00802 NI    CNTDONE,B'11111011'                                 0805
*DOLOOP32:     DO WHILE(CNTDONE=NO & NEXTPDE^=CHAINEND);   /*@YL026UL*/
DOLOOP32 B     @DE00806                                            0806
@DL00806 DS    0H                                                  0807
*                LISTTOTL=LISTTOTL+1;                      /*@YL026UL*/
*                                                                  0807
         LA    @05,1                                               0807
         AH    @05,LISTTOTL                                        0807
         STH   @05,LISTTOTL                                        0807
*                /****************************************************/
*                /*                                          @YL026UL*/
*                /* IF THE LIST HAS MORE ELEMENTS THAN THIS  @YL026UL*/
*                /* PARAMETER ALLOWS, IGNORE THE EXCESS IF   @YL026UL*/
*                /* THE USER SO INDICATES; OTHERWISE,        @YL026UL*/
*                /* DISCONTINUE PROCESSING.                  @YL026UL*/
*                /*                                          @YL026UL*/
*                /****************************************************/
*                IF LISTTOTL > LISTMAX                             0808
*                  THEN                                            0808
         LA    @03,12                                              0808
         LR    @15,@03                                             0808
         MH    @15,PARMID                                          0808
         L     @01,PINFOPTR                                        0808
         AL    @01,@CF01818                                        0808
         AL    @03,PARMPTR(@15,@01)                                0808
         SLR   @15,@15                                             0808
         IC    @15,LISTMAX(,@03)                                   0808
         CR    @05,@15                                             0808
         BNH   @RF00808                                            0808
*                    DO;                                   /*@YL026UL*/
*                    PDEPTR=NEXTPDE;                       /*@YL026UL*/
         LR    PDEPTR,NEXTPDE                                      0810
*                    CNTDONE=YES;                          /*@YL026UL*/
*                                                                  0811
         OI    CNTDONE,B'00000100'                                 0811
*                    CALL TOOMANY;                         /*@YL026UL*/
*                                                                  0812
         BAL   @14,TOOMANY                                         0812
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  THE USER WILL NOT PERMIT THE        @Y30SSFR*/
*                    /*  DISCARD OF EXCESS OF EXCESS         @Y30SSFR*/
*                    /*  PARAMETERS.  RETURN TO THE CALLER.  @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF LASTCC ^= 0                                0813
*                      THEN                                        0813
         L     @05,@PC00001+16                                     0813
         LH    @05,LASTCC(,@05)                                    0813
         LTR   @05,@05                                             0813
         BNZ   @RT00813                                            0813
*                        RETURN;                           /*#YL026UL*/
*                    END;                                  /*#YL026UL*/
*                                                                  0815
*                  /**************************************************/
*                  /*                                        #YL026UL*/
*                  /* POINT TO THE NEXT PDE OF THE CHAIN     #YL026UL*/
*                  /*                                        #YL026UL*/
*                  /**************************************************/
*                  ELSE                                            0816
*                    DO;                                   /*#YL026UL*/
         B     @RC00808                                            0816
@RF00808 DS    0H                                                  0817
*                    PDEPTR=NEXTPDE;                       /*#YL026UL*/
         LR    PDEPTR,NEXTPDE                                      0817
*                    IF NAMEPDE=NO                                 0818
*                      THEN                                        0818
         TM    NAMEPDE,B'00001000'                                 0818
         BNZ   @RF00818                                            0818
*                        NEXTPDE=NXTCPDE;                  /*#YL026UL*/
         L     NEXTPDE,NXTCPDE(,PDEPTR)                            0819
*                      ELSE                                        0820
*                        NEXTPDE=NXTDPDE;                  /*#YL026UL*/
         B     @RC00818                                            0820
@RF00818 L     NEXTPDE,NXTDPDE(,PDEPTR)                            0820
*                    END;                                  /*#YL026UL*/
*                                                                  0821
@RC00818 DS    0H                                                  0822
*              END DOLOOP32;                               /*#YL026UL*/
@RC00808 DS    0H                                                  0822
@DE00806 TM    CNTDONE,B'00000100'                                 0822
         BNZ   @DC00806                                            0822
         CL    NEXTPDE,CHAINEND                                    0822
         BNE   @DL00806                                            0822
@DC00806 DS    0H                                                  0823
*              PDEPTR=BASEPTR;                             /*#YL026UL*/
         LR    PDEPTR,BASEPTR                                      0823
*              AMTTOGET=SPACEAMT*LISTTOTL+LENGTH(NUMBRCNT);/*#YL026UL*/
         L     @02,SPACEAMT                                        0824
         MH    @02,LISTTOTL                                        0824
         AL    @02,@CF00050                                        0824
         ST    @02,AMTTOGET                                        0824
*            END;                                          /*@YL026UL*/
*                                                                  0825
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* ALLOCATE THE SPACE FROM THE MAIN BLOCK OF CORE   @YL026UL*/
*        /* PREVIOUSLY ALLOCATED.  IF INSUFFICIENT SPACE     @YL026UL*/
*        /* REMAINS IN THIS BLOCK OF STORAGE, ALLOCATE       @YL026UL*/
*        /* ANOTHER ONE.                                     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF BLKLEFT-AMTTOGET < 0                                   0826
*          THEN                                                    0826
@RC00798 L     @02,AMTTOGET                                        0826
         L     @15,BLKLEFT                                         0826
         SLR   @15,@02                                             0826
         LTR   @15,@15                                             0826
         BNM   @RF00826                                            0826
*            DO;                                           /*@YL026UL*/
*              IF AMTTOGET >'400'X THEN /* NEED GT 1024      @ZA15054*/
         C     @02,@CF01684                                        0828
         BNH   @RF00828                                            0828
*                BLKLEFT=AMTTOGET;      /* YES,GET EXACT AMT @ZA15054*/
         ST    @02,BLKLEFT                                         0829
*              ELSE                     /* NO, GET 1024      @ZA15054*/
*            BLKLEFT='400'X;                               /*@YL026UL*/
*                                                                  0830
         B     @RC00828                                            0830
@RF00828 LA    @02,1024                                            0830
         ST    @02,BLKLEFT                                         0830
*            CALL IDCSAGP0(GDTTBL,BLKLEFT,BLKPTR,                  0831
*                   SPACEID,SETZERO);                      /*@YL026UL*/
@RC00828 ST    GDTPTR,@AL00001                                     0831
         LA    @04,BLKLEFT                                         0831
         ST    @04,@AL00001+4                                      0831
         LA    @04,BLKPTR                                          0831
         ST    @04,@AL00001+8                                      0831
         L     @04,@PC00001+8                                      0831
         ST    @04,@AL00001+12                                     0831
         LA    @04,SETZERO                                         0831
         ST    @04,@AL00001+16                                     0831
         MVI   @AL00001+16,X'80'                                   0831
         L     @15,GDTGPL(,GDTPTR)                                 0831
         LA    @01,@AL00001                                        0831
         BALR  @14,@15                                             0831
*            RESPECIFY RTNREG RSTD;                                0832
*            TESTRC = RTNREG;                                      0833
         LR    TESTRC,RTNREG                                       0833
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UL*/
*                                                                  0834
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF UGPOOL WAS NOT ABLE TO OBTAIN THE        @Y30SSFR*/
*            /*  NECESSARY STORAGE, CALL FAILSPAC TO         @Y30SSFR*/
*            /*  HANDLE THE ERROR, AND RETURN TO THE CALLER. @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            IF TESTRC^=0                                          0835
*              THEN                                                0835
         LTR   TESTRC,TESTRC                                       0835
         BZ    @RF00835                                            0835
*                DO;                                       /*@YL026UL*/
*                                                                  0836
*                CALL FAILSPAC;                            /*@YL026UL*/
*                                                                  0837
         BAL   @14,FAILSPAC                                        0837
*                RETURN;                                   /*@YL026UL*/
@EL00009 DS    0H                                                  0838
@EF00009 DS    0H                                                  0838
@ER00009 LM    @14,@02,@SA00009                                    0838
         LM    @04,@06,@SA00009+20                                 0838
         LM    @08,@12,@SA00009+32                                 0838
         BR    @14                                                 0838
*                END;                                      /*@YL026UL*/
*                                                                  0839
*            END;                                          /*@YL026UL*/
@RF00835 DS    0H                                                  0841
*        DATAPTR=BLKPTR;                                   /*@YL026UL*/
@RF00826 L     @02,BLKPTR                                          0841
         LR    DATAPTR,@02                                         0841
*        BLKPTR=BLKPTR+AMTTOGET+(4-AMTTOGET//4);           /*@YL026UL*/
         L     @15,AMTTOGET                                        0842
         ALR   @02,@15                                             0842
         LR    @00,@15                                             0842
         SRDA  @00,32                                              0842
         D     @00,@CF00050                                        0842
         LCR   @00,@00                                             0842
         AL    @00,@CF00050                                        0842
         ALR   @02,@00                                             0842
         ST    @02,BLKPTR                                          0842
*        BLKLEFT=BLKLEFT-(BLKPTR-DATAPTR);                 /*@YL026UL*/
*                                                                  0843
         LCR   @02,@02                                             0843
         ALR   @02,DATAPTR                                         0843
         AL    @02,BLKLEFT                                         0843
         ST    @02,BLKLEFT                                         0843
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* PLACE THE POINTER TO THE FDT DATA SUBSTRUCTURE   @YL026UL*/
*        /* JUST ALLOCATED INTO THE PRIMARY OR SECONDARY FDT @YL026UL*/
*        /* POINTER LOCATION FOR THE CURRENT PARAMETER.      @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF OCCURNUM > 1                                           0844
*          THEN                                                    0844
         LH    @02,PARMID                                          0844
         LA    @15,12                                              0844
         LR    @01,@02                                             0844
         MR    @00,@15                                             0844
         L     @14,PINFOPTR                                        0844
         AL    @14,@CF01818                                        0844
         L     @01,PARMPTR(@01,@14)                                0844
         CLC   OCCURNUM(3,@01),@CF00227+1                          0844
         BNH   @RF00844                                            0844
*            VECTRVAL=DATAPTR;                             /*@YL026UL*/
         SLA   @02,2                                               0845
         L     @14,@PC00001+4                                      0845
         L     @01,FDTADDR(,@14)                                   0845
         MH    @15,REPINDEX                                        0845
         L     @14,RSIPTR                                          0845
         BCTR  @14,0                                               0845
         BCTR  @14,0                                               0845
         LH    @15,VECTRDSP-10(@15,@14)                            0845
         AL    @15,FDTPTR-4(@02,@01)                               0845
         ST    DATAPTR,VECTRVAL(,@15)                              0845
*          ELSE                                                    0846
*            FDTPTR(PARMID)=DATAPTR;                       /*@YL026UL*/
*                                                                  0846
         B     @RC00844                                            0846
@RF00844 LH    @02,PARMID                                          0846
         SLA   @02,2                                               0846
         L     @15,@PC00001+4                                      0846
         L     @01,FDTADDR(,@15)                                   0846
         ST    DATAPTR,FDTPTR-4(@02,@01)                           0846
*        END GETSPACE;                                     /*@YL026UL*/
*                                                                  0847
*                                                                  0847
         B     @EL00009                                            0847
*        END BUILDFDT;                                     /*@YL026UL*/
@EL00008 DS    0H                                                  0848
@EF00008 DS    0H                                                  0848
@ER00008 LM    @14,@02,@SA00008                                    0848
         LM    @04,@06,@SA00008+20                                 0848
         LM    @08,@12,@SA00008+32                                 0848
         BR    @14                                                 0848
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - NEWPARM                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE PROMPTS FOR A NEW CONSTANT OR   @YL026UL*/
*/*             REPEATED SUBPARAMETER LIST REPETITION TO     @YL026UL*/
*/*             REPLACE ONE THAT HAS BEEN FOUND TO BE        @YL026UL*/
*/*             SEMANTICALLY INVALID.                        @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR ENTRY FOR CURRENT PARM.    @YL026UL*/
*/*            PDE -     ENTRY CONTAINING INVALID DATA.      @YL026UL*/
*/*            NAMEPDE - FLAG SET TO INDICATE THE FORMAT     @YL026UL*/
*/*                      OF THE PDE FOR THE CURRENT PARM.    @YL026UL*/
*/*            PARMID -  PARM ID# OF PARM WITH INVALID DATA  @YL026UL*/
*/*            ERRORID - TEXT ID# FOR ERROR MSG PERTAINING   @YL026UL*/
*/*                      TO CURRENT INVALID DATA.            @YL026UL*/
*/*            ERRORPCL- PTR TO PCL DESCRIBING A SINGLE ITEM @YL026UL*/
*/*                      OF THE DATA TYPE WHICH IS IN ERROR. @YL026UL*/
*/*            PDLPTR -  PTR TO PDL CONTAINING BAD DATA ITEM @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            PDE -     NEW PDE SECTION CONTAINING NEW DATA @YL026UL*/
*/*                      ITEM REPLACING THE INVALID DATA.    @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*NEWPARM:PROCEDURE(ERRORID,ERRORPCL);                      /*@YL026UL*/
NEWPARM  STM   @14,@12,@SA00010                                    0849
         MVC   @PC00010(8),0(@01)                                  0849
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** NEWPARM  **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0850
*        DCL ERRORID  FIXED(15);       /*ID# OF THE PARM     @YL026UL*/
*                                      /*HAVING THE IMPROPER @YL026UL*/
*                                      /*VALUE               @YL026UL*/
*        DCL ERRORPCL PTR(31);         /*PTR TO THE PROPER   @YL026UL*/
*                                      /*'STANDARD' PCL TO   @YL026UL*/
*                                      /*BE PASSED TO PARSE  @YL026UL*/
*                                      /*WITH THE NEW VALUE  @YL026UL*/
*        DCL ORIGPDL  PTR(31);         /*PTR TO THE PDL THAT @YL026UL*/
*                                      /*CONTAINED THE OLD,  @YL026UL*/
*                                      /*INVALID VALUE       @YL026UL*/
*        DCL NAMEPOS  FIXED(15);       /*INDEX USED FOR      @YL026UL*/
*                                      /*RECONSTRUCTING A    @YL026UL*/
*                                      /*DSNAME FROM A PDE.  @YL026UL*/
*        DCL PROMPT1  FIXED(15)        /*MSG ID OF PROMPT    @YL026UL*/
*                     CONSTANT(9);     /*FOR NEW DATA ITEM   @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** NEWPARM **  OBTAIN REPLACEMENT PARM VALUE    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0855
         L     @07,GDTTR2(,GDTPTR)                                 0855
         MVC   @TS00001(95),NEWERID2(@07)                          0855
         MVC   OLDERID2(95,@07),@TS00001                           0855
*        NEWID2='RI26';                                    /*@YL026UL*/
*                                                                  0856
         MVC   NEWID2(4,@07),@CC01695                              0856
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE INVALID PARAMETER APPEARS WITHIN A        @YL026UL*/
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/
*        /* WHICH REPETITION CONTAINS THE ERROR.             @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF OCCURNUM > 1                                           0857
*          THEN                                                    0857
         LA    @07,12                                              0857
         LR    @02,@07                                             0857
         MH    @02,PARMID                                          0857
         L     @01,PINFOPTR                                        0857
         AL    @01,@CF01818                                        0857
         L     @02,PARMPTR(@02,@01)                                0857
         CLC   OCCURNUM(3,@02),@CF00227+1                          0857
         BNH   @RF00857                                            0857
*            DO;                                           /*@YL026UL*/
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/
         MH    @07,REPINDEX                                        0859
         L     @02,RSIPTR                                          0859
         AL    @02,@CF01819                                        0859
         SLR   @15,@15                                             0859
         IC    @15,SBLSTNUM-8(@07,@02)                             0859
         ST    @15,EFIELD3                                         0859
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/
         L     @07,DDSTRU                                          0860
         LA    @02,EFIELD3                                         0860
         ST    @02,DARGDBP(,@07)                                   0860
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/
         MVC   DARGILP(2,@07),@CH00050                             0861
*            DARGSENT=INREP;                               /*@YL026UL*/
*                                                                  0862
         MVI   DARGSENT(@07),X'0F'                                 0862
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/
*                                                                  0863
         ST    GDTPTR,@AL00001                                     0863
         LA    @07,@CF00123                                        0863
         ST    @07,@AL00001+4                                      0863
         LA    @07,DDSTRU                                          0863
         ST    @07,@AL00001+8                                      0863
         MVI   @AL00001+8,X'80'                                    0863
         L     @15,GDTPRT(,GDTPTR)                                 0863
         LA    @01,@AL00001                                        0863
         BALR  @14,@15                                             0863
*            END;                                          /*@YL026UL*/
*                                                                  0864
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* MOVE THE INVALID CONSTANT FROM THE PDE INTO      @YL026UL*/
*        /* THE SECOND MESSAGE INSERT FIELD.                 @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        EFIELD2=BLANK;                                    /*@YL026UL*/
*                                                                  0865
@RF00857 MVI   EFIELD2+1,C' '                                      0865
         MVC   EFIELD2+2(62),EFIELD2+1                             0865
         MVI   EFIELD2,C' '                                        0865
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF THE INVALID CONSTANT IS A NUMBER, PUT THE    @Y30SSFR*/
*        /*  NUMBER INTO THE MESSAGE.                        @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        IF NUMBER=YES                                             0866
*          THEN                                                    0866
         LA    @07,12                                              0866
         LR    @02,@07                                             0866
         MH    @02,PARMID                                          0866
         L     @01,PINFOPTR                                        0866
         AL    @01,@CF01818                                        0866
         AL    @07,PARMPTR(@02,@01)                                0866
         TM    NUMBER(@07),B'10000000'                             0866
         BNO   @RF00866                                            0866
*            EFIELD3=PDENUMBR;                             /*@YL026UL*/
         L     @07,CONSTPTR(,PDEPTR)                               0867
         L     @07,PDENUMBR(,@07)                                  0867
         ST    @07,EFIELD3                                         0867
*          ELSE                                                    0868
*                                                                  0868
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THE INVALID CONSTANT IS NOT A DATA SET   @Y30SSFR*/
*            /*  NAME AND HAS A LENGTH GREATER THAN 0,       @Y30SSFR*/
*            /*  PUT THE CONSTANT STRING INTO THE MESSAGE.   @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            IF NAMEPDE=NO                                         0868
*              THEN                                                0868
         B     @RC00866                                            0868
@RF00866 TM    NAMEPDE,B'00001000'                                 0868
         BNZ   @RF00868                                            0868
*                IF CONSTLEN > 0                                   0869
*                  THEN                                            0869
         LH    @07,CONSTLEN(,PDEPTR)                               0869
         LTR   @07,@07                                             0869
         BNP   @RF00869                                            0869
*                    EFIELD2=PDESTRNG(1:                           0870
*                          MIN(LENGTH(EFIELD2),CONSTLEN)); /*@YL026UL*/
         MVI   EFIELD2+1,C' '                                      0870
         MVC   EFIELD2+2(62),EFIELD2+1                             0870
         LA    @02,64                                              0870
         CR    @07,@02                                             0870
         BNH   *+6
         LR    @07,@02                                             0870
         BCTR  @07,0                                               0870
         L     @02,CONSTPTR(,PDEPTR)                               0870
         EX    @07,@SM01852                                        0870
*                  ELSE                                    /*@YL026UL*/
*                                                                  0871
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF LENGTH OF THE CONSTANT IS ZERO,  @Y30SSFR*/
*                    /*  PROMPT WITH QUOTES FOR A            @Y30SSFR*/
*                    /*  NON-REPEATED OBJECT WITH QUOTES,    @Y30SSFR*/
*                    /*  AND FOR A REPEATED ONE WITH PARENS. @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF REPEATED=NO                                0871
*                      THEN                                        0871
         B     @RC00869                                            0871
@RF00869 LH    @07,PARMID                                          0871
         MH    @07,@CH00038                                        0871
         L     @02,PINFOPTR                                        0871
         AL    @02,@CF01818                                        0871
         L     @07,PARMPTR(@07,@02)                                0871
         TM    REPEATED(@07),B'00100000'                           0871
         BNZ   @RF00871                                            0871
*                        DO;                               /*#YL026UL*/
*                        EFIELD2(1)=QUOTE;                 /*#YL026UL*/
         MVI   EFIELD2,C''''                                       0873
*                        EFIELD2(2)=QUOTE;                 /*#YL026UL*/
         MVI   EFIELD2+1,C''''                                     0874
*                        END;                              /*#YL026UL*/
*                      ELSE                                        0876
*                        DO;                               /*#YL026UL*/
         B     @RC00871                                            0876
@RF00871 DS    0H                                                  0877
*                        EFIELD2(1)=PAREN;                 /*#YL026UL*/
         MVI   EFIELD2,C'('                                        0877
*                        EFIELD2(2)=PAREN2;                /*#YL026UL*/
         MVI   EFIELD2+1,C')'                                      0878
*                        END;                              /*#YL026UL*/
*              ELSE                                                0880
*                                                                  0880
*                /****************************************************/
*                /*                                          #YL026UL*/
*                /* IF THE INVALID CONSTANT IS A DSNAME,     #YL026UL*/
*                /* RECONSTRUCT IT -- THAT IS, APPEND THE    #YL026UL*/
*                /* MEMBER NAME AND PASSWORD IF THEY WERE    #YL026UL*/
*                /* CODED.                                   #YL026UL*/
*                /*                                          #YL026UL*/
*                /****************************************************/
*                DO;                                       /*#YL026UL*/
         B     @RC00868                                            0880
@RF00868 DS    0H                                                  0881
*                NAMEPOS=1;                                /*#YL026UL*/
         LA    NAMEPOS,1                                           0881
*                IF DSNLEN > 0                                     0882
*                  THEN                                            0882
         LH    @07,DSNLEN(,PDEPTR)                                 0882
         LTR   @07,@07                                             0882
         BNP   @RF00882                                            0882
*                    DO;                                   /*#YL026UL*/
*                    EFIELD2=PDEDSN(1:DSNLEN);             /*#YL026UL*/
         MVI   EFIELD2+1,C' '                                      0884
         MVC   EFIELD2+2(62),EFIELD2+1                             0884
         LR    @15,@07                                             0884
         BCTR  @15,0                                               0884
         L     @01,DSNPTR(,PDEPTR)                                 0884
         EX    @15,@SM01854                                        0884
*                    NAMEPOS=NAMEPOS+DSNLEN;               /*#YL026UL*/
         ALR   NAMEPOS,@07                                         0885
*                    END;                                  /*#YL026UL*/
*                IF MEMIN=YES                                      0887
*                  THEN                                            0887
@RF00882 TM    MEMIN(PDEPTR),B'10000000'                           0887
         BNO   @RF00887                                            0887
*                    DO;                                   /*#YL026UL*/
*                    EFIELD2(NAMEPOS)=PAREN;               /*#YL026UL*/
         LA    @07,EFIELD2-1(NAMEPOS)                              0889
         MVI   0(@07),C'('                                         0889
*                    EFIELD2(NAMEPOS+1:NAMEPOS+MEMLEN)=            0890
*                                       PDEMEM(1:MEMLEN);  /*#YL026UL*/
         LA    @07,EFIELD2(NAMEPOS)                                0890
         LH    @15,MEMLEN(,PDEPTR)                                 0890
         LR    @14,@15                                             0890
         BCTR  @14,0                                               0890
         L     @01,MEMPTR(,PDEPTR)                                 0890
         EX    @14,@SM01856                                        0890
*                    EFIELD2(NAMEPOS+MEMLEN+1)=PAREN2;     /*#YL026UL*/
         ALR   @15,NAMEPOS                                         0891
         LA    @07,EFIELD2(@15)                                    0891
         MVI   0(@07),C')'                                         0891
*                    NAMEPOS=NAMEPOS+MEMLEN+2;             /*#YL026UL*/
         AL    @15,@CF00161                                        0892
         LR    NAMEPOS,@15                                         0892
*                    END;                                  /*#YL026UL*/
*                EFIELD2(NAMEPOS)=QUOTE;                   /*#YL026UL*/
@RF00887 LA    @07,EFIELD2-1(NAMEPOS)                              0894
         MVI   0(@07),C''''                                        0894
*                NAMEPOS=NAMEPOS+1;                        /*#YL026UL*/
         AL    NAMEPOS,@CF00227                                    0895
*                IF PWDIN=YES                                      0896
*                  THEN                                            0896
         TM    PWDIN(PDEPTR),B'10000000'                           0896
         BNO   @RF00896                                            0896
*                    DO;                                   /*#YL026UL*/
*                    EFIELD2(NAMEPOS)=SLASH;               /*#YL026UL*/
         LA    @07,EFIELD2-1(NAMEPOS)                              0898
         MVI   0(@07),C'/'                                         0898
*                    EFIELD2(NAMEPOS+1:NAMEPOS+PWDLEN)=            0899
*                                       PDEPWD(1:PWDLEN);  /*#YL026UL*/
         LA    @07,EFIELD2(NAMEPOS)                                0899
         LH    @15,PWDLEN(,PDEPTR)                                 0899
         BCTR  @15,0                                               0899
         L     @01,PWDPTR(,PDEPTR)                                 0899
         EX    @15,@SM01858                                        0899
*                    END;                                  /*#YL026UL*/
*                END;                                      /*#YL026UL*/
*                                                                  0901
@RF00896 DS    0H                                                  0902
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* MOVE THE KEYWORD MOST CLOSELY ASSOCIATED WITH    @YL026UL*/
*        /* THE BAD CONSTANT INTO THE FIRST INSERT FIELD.    @YL026UL*/
*        /* THEN PRINT THE ERROR MESSAGE IDENTIFYING THE     @YL026UL*/
*        /* BAD CONSTANT.                                    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        EFIELD1=BLANK;                                    /*@YL026UL*/
*                                                                  0902
@RC00868 DS    0H                                                  0902
@RC00866 MVI   EFIELD1+1,C' '                                      0902
         MVC   EFIELD1+2(18),EFIELD1+1                             0902
         MVI   EFIELD1,C' '                                        0902
*        CALL MSGKWD(PARMID,ADDR(EFIELD1));                /*@YL026UL*/
*                                                                  0903
         LA    @07,PARMID                                          0903
         ST    @07,@AL00001                                        0903
         LA    @07,EFIELD1                                         0903
         ST    @07,@AFTEMPS+8                                      0903
         LA    @07,@AFTEMPS+8                                      0903
         ST    @07,@AL00001+4                                      0903
         LA    @01,@AL00001                                        0903
         BAL   @14,MSGKWD                                          0903
*        DARGDBP=ADDR(EFIELD);                             /*@YL026UL*/
         L     @07,DDSTRU                                          0904
         LA    @04,EFIELD                                          0904
         ST    @04,DARGDBP(,@07)                                   0904
*        DARGILP=LENGTH(EFIELD);                           /*@YL026UL*/
         MVC   DARGILP(2,@07),@CH01804                             0905
*        DARGSENT=ERRORID;                                 /*@YL026UL*/
*                                                                  0906
         L     @04,@PC00010                                        0906
         LH    @04,ERRORID(,@04)                                   0906
         STC   @04,DARGSENT(,@07)                                  0906
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  0907
         ST    GDTPTR,@AL00001                                     0907
         LA    @07,@CF00123                                        0907
         ST    @07,@AL00001+4                                      0907
         LA    @07,DDSTRU                                          0907
         ST    @07,@AL00001+8                                      0907
         MVI   @AL00001+8,X'80'                                    0907
         L     @15,GDTPRT(,GDTPTR)                                 0907
         LA    @01,@AL00001                                        0907
         BALR  @14,@15                                             0907
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* OBTAIN FORMATTED PROMPT MESSAGE FROM THE TEXT    @YL026UL*/
*        /* PROCESSOR AND SEND THE MESSAGE TO THE USER,      @YL026UL*/
*        /* PROMPTING FOR A REPLACEMENT VALUE.               @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DARGSENT=PROMPT1;                                 /*@YL026UL*/
         L     @07,DDSTRU                                          0908
         MVI   DARGSENT(@07),X'09'                                 0908
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/
         LA    @04,MSGBUFF                                         0909
         ST    @04,DARGRETP(,@07)                                  0909
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/
*                                                                  0910
         MVC   DARGRETL(2,@07),@CH01454                            0910
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  0911
         ST    GDTPTR,@AL00001                                     0911
         LA    @07,@CF00123                                        0911
         ST    @07,@AL00001+4                                      0911
         LA    @07,DDSTRU                                          0911
         ST    @07,@AL00001+8                                      0911
         MVI   @AL00001+8,X'80'                                    0911
         L     @15,GDTPRT(,GDTPTR)                                 0911
         LA    @01,@AL00001                                        0911
         BALR  @14,@15                                             0911
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/
         L     @07,DDSTRU                                          0912
         L     @04,DARGRETP(,@07)                                  0912
         ST    @04,PMSGPTR                                         0912
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/
         LH    @04,DARGRETL(,@07)                                  0913
         STH   @04,PMSGLEN                                         0913
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/
         SLR   @04,@04                                             0914
         ST    @04,DARGRETP(,@07)                                  0914
*        DARGRETL=0;                                       /*@YL026UL*/
*                                                                  0915
         STH   @04,DARGRETL(,@07)                                  0915
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ISSUE A UPROMPT TO PROMPT THE USER FOR          @Y30SSFR*/
*        /*  ADDITIONAL INFORMATION.  IF THE UPROMPT FAILS   @Y30SSFR*/
*        /*  SET A LASTCC OF 12, AND RETURN TO THE CALLER.   @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*  0916
*                                                            #YL026UL*/
         ST    GDTPTR,@AL00001                                     0916
         LA    @07,PMSGPTR                                         0916
         ST    @07,@AL00001+4                                      0916
         LA    @07,PMSGLEN                                         0916
         ST    @07,@AL00001+8                                      0916
         LA    @07,RPLYPTR                                         0916
         ST    @07,@AL00001+12                                     0916
         LA    @07,RPLYLEN                                         0916
         ST    @07,@AL00001+16                                     0916
         MVI   @AL00001+16,X'80'                                   0916
         L     @15,GDTPMT(,GDTPTR)                                 0916
         LA    @01,@AL00001                                        0916
         BALR  @14,@15                                             0916
*        RESPECIFY RTNREG RSTD;                                    0917
*        TESTRC = RTNREG;                                          0918
         LR    TESTRC,RTNREG                                       0918
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UL*/
*                                                                  0919
*        IF TESTRC^=0                                              0920
*          THEN                                                    0920
         LTR   TESTRC,TESTRC                                       0920
         BZ    @RF00920                                            0920
*            DO;                                           /*@YL026UL*/
*            LASTCC=LASTCC12;                              /*@YL026UL*/
         L     @07,@PC00001+16                                     0922
         MVC   LASTCC(2,@07),@CH00038                              0922
*            RETURN;                                       /*@YL026UL*/
@EL00010 DS    0H                                                  0923
@EF00010 DS    0H                                                  0923
@ER00010 LM    @14,@12,@SA00010                                    0923
         BR    @14                                                 0923
*            END;                                          /*@YL026UL*/
*                                                                  0924
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE USER GIVES A NULL REPLY AND A DEFAULT     @YL026UL*/
*        /* VALUE EXISTS, THEN ALLOW THE DEFAULT TO BE USED  @YL026UL*/
*        /* INSTEAD OF RE-PROMPTING FOR A REPLACEMENT VALUE. @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF RPLYLEN=0 & SUBLIST=NO & DEFAULT=YES                   0925
*          THEN                                                    0925
@RF00920 LH    @07,RPLYLEN                                         0925
         LTR   @07,@07                                             0925
         BNZ   @RF00925                                            0925
         L     @07,PINFOPTR                                        0925
         LH    @02,PARMID                                          0925
         MH    @02,@CH00038                                        0925
         LA    @01,0(@02,@07)                                      0925
         AL    @01,@CF01818                                        0925
         L     @01,PARMPTR(,@01)                                   0925
         TM    DEFAULT(@01),B'00000100'                            0925
         BNO   @RF00925                                            0925
         TM    SUBLIST(@01),B'00000010'                            0925
         BNZ   @RF00925                                            0925
*            DO;                                           /*@YL026UL*/
*            PARMFLAG(PARMID)=PARTOSET;                    /*@YL026UL*/
         LA    @15,1                                               0927
         BCTR  @07,0                                               0927
         BCTR  @07,0                                               0927
         STC   @15,PARMFLAG-10(@02,@07)                            0927
*            ALLOK=YES;                                    /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   0928
*            RETURN;                                       /*@YL026UL*/
         B     @EL00010                                            0929
*            END;                                          /*@YL026UL*/
*                                                                  0930
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SEND THE USER'S REPLY TO 'PARSE' TOGETHER WITH   @YL026UL*/
*        /* A 'STANDARD' PCL DESCRIBING JUST THE SINGLE      @YL026UL*/
*        /* REPLACEMENT CONSTANT.                            @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PPLCBUF=RPLYPTR;                                  /*@YL026UL*/
@RF00925 L     @02,PPLPTR                                          0931
         L     @15,RPLYPTR                                         0931
         ST    @15,PPLCBUF(,@02)                                   0931
*        ORIGPDL=PDLPTR;                                   /*@YL026UL*/
         L     ORIGPDL,PDLPTR                                      0932
*        PPLPCL=ERRORPCL;                                  /*@YL026UL*/
         L     @15,@PC00010+4                                      0933
         L     @15,ERRORPCL(,@15)                                  0933
         ST    @15,PPLPCL(,@02)                                    0933
*        PARSECB=0;                                        /*@YL026UL*/
*                                                                  0934
         SLR   @15,@15                                             0934
         ST    @15,PARSECB                                         0934
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     0935
*          RESPECIFY GPR01P RSTD;                                  0936
*          GPR01P = ADDR(PPL);                                     0937
         LR    GPR01P,@02                                          0937
*          IF CVTPARS = 0                                          0938
*            THEN                                                  0938
         L     @02,CVTPTR                                          0938
         C     @15,CVTPARS(,@02)                                   0938
         BNE   @RF00938                                            0938
*              GEN(LINK EP=IKJPARS);                               0939
         LINK EP=IKJPARS
*            ELSE                                                  0940
*              CALL CVTPARS;                                       0940
         B     @RC00938                                            0940
@RF00938 L     @02,CVTPTR                                          0940
         L     @15,CVTPARS(,@02)                                   0940
         BALR  @14,@15                                             0940
*          RESPECIFY GPR01P UNRSTD;                                0941
@RC00938 DS    0H                                                  0942
*        END;                   /*@Z40GSJG*/                       0942
*                                                                  0942
*        RESPECIFY RTNREG RSTD;                                    0943
*        TESTRC = RTNREG;                                          0944
         LR    TESTRC,RTNREG                                       0944
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  0945
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF 'PARSE' IS UNSUCESSFUL, DISCONTINUE AMS       @YL026UL*/
*        /* PROCESSING.  PRINT AN ERROR MESSAGE IF LACK OF   @YL026UL*/
*        /* WORK SPACE CAUSED THE PROBLEM.                   @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF TESTRC^=0                                              0946
*          THEN                                                    0946
         LTR   TESTRC,TESTRC                                       0946
         BZ    @RF00946                                            0946
*            DO;                                           /*@YL026UL*/
*            IF TESTRC=BADSPACE                                    0948
*              THEN                                                0948
*                                                                  0948
         C     TESTRC,@CF00487                                     0948
         BNE   @RF00948                                            0948
*                CALL FAILSPAC;                            /*@YL026UL*/
*                                                                  0949
         BAL   @14,FAILSPAC                                        0949
*              ELSE                                                0950
*                LASTCC=LASTCC12;                          /*@YL026UL*/
         B     @RC00948                                            0950
@RF00948 L     @07,@PC00001+16                                     0950
         MVC   LASTCC(2,@07),@CH00038                              0950
*            RETURN;                                       /*@YL026UL*/
         B     @EL00010                                            0951
*            END;                                          /*@YL026UL*/
*                                                                  0952
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* MOVE THE ENCODED INFORMATION FROM THE PDE THAT   @YL026UL*/
*        /* RESULTED FROM THE PROMPT INTO THE PDE FOR THE    @YL026UL*/
*        /* OLD VALUE.                                       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF NAMEPDE=NO                                             0953
*          THEN                                                    0953
@RF00946 TM    NAMEPDE,B'00001000'                                 0953
         BNZ   @RF00953                                            0953
*            MOVELEN=LENGTH(PDE1)-PTRLNGTH;                /*@YL026UL*/
         LA    MOVELEN,8                                           0954
*          ELSE                                                    0955
*            MOVELEN=LENGTH(PDE2)-PTRLNGTH;                /*@YL026UL*/
         B     @RC00953                                            0955
@RF00953 LA    MOVELEN,24                                          0955
*        PDEPTR->DATABLK(1:MOVELEN)=                               0956
*                    (PDLPTR+PDLHDR)->DATABLK(1:MOVELEN);  /*@YL026UL*/
@RC00953 LR    @05,MOVELEN                                         0956
         BCTR  @05,0                                               0956
         L     @02,PDLPTR                                          0956
         EX    @05,@SM01860                                        0956
*        PDLPTR=ORIGPDL;                                   /*@YL026UL*/
*                                                                  0957
         ST    ORIGPDL,PDLPTR                                      0957
*        END NEWPARM;                                      /*@YL026UL*/
         B     @EL00010                                            0958
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - TOOMANY                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SENDS A MESSAGE TO THE TERMINAL @YL026UL*/
*/*             IDENTIFYING A LIST WHICH CONTAINS TOO MANY   @YL026UL*/
*/*             ELEMENTS.  THE USER IS THEN PROMPTED FOR A   @YL026UL*/
*/*             REPLY INDICATING WHETHER OR NOT HE WISHES TO @YL026UL*/
*/*             CONTINUE WITH THE EXCESS ELEMENTS BEING      @YL026UL*/
*/*             IGNORED.                                     @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            PARMID -  ID# OF PARM WHOSE LIST IS TOO LONG  @YL026UL*/
*/*            PDE -     ENCODED LIST ELEMENTS               @YL026UL*/
*/*            COMMAND DESCRIPTOR ENTRY FOR THIS PARM.       @YL026UL*/
*/*            NAMEPDE - FLAG SET TO INDICATE THE FORMAT OF  @YL026UL*/
*/*                      THIS PARM'S PDE.                    @YL026UL*/
*/*            LISTTOTL- ELEMENT NUMBER AT WHICH DATA LIST   @YL026UL*/
*/*                      BECOMES TOO LONG.                   @YL026UL*/
*/*            REPCOUNT- ELEMENT NUMBER AT WHICH LIST OF     @YL026UL*/
*/*                      SUBPARM LISTS BECOMES TOO LONG.     @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/
*/*                      ZERO VALUE IF PROCESSING CANNOT     @YL026UL*/
*/*                      BE CONTINUED.                       @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*TOOMANY:PROCEDURE;                                        /*@YL026UL*/
TOOMANY  STM   @14,@12,@SA00011                                    0959
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** TOOMANY  **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  0960
*        DCL FOLDMASK BIT(16)          /*BIT MASK USED TO    @YL026UL*/
*            CONSTANT('4040'X);        /*FOLD ALPHABETICS    @YL026UL*/
*                                      /*FROM LOWER TO UPPER @YL026UL*/
*                                      /*CASE                @YL026UL*/
*        DCL LISTRPLY CHAR(4)          /*REPLY INDICATING    @YL026UL*/
*                     INIT('''OK''');  /*THAT EXCESS LIST    @YL026UL*/
*                                      /*ELEMENTS ARE TO     @YL026UL*/
*                                      /*BE IGNORED          @YL026UL*/
*        DCL TRUNCATE BIT(1);          /*FLAG SET 'ON' IF    @YL026UL*/
*                                      /*USER SAYS HE WANTS  @YL026UL*/
*                                      /*TO HAVE EXCESS LIST @YL026UL*/
*                                      /*ELEMENTS IGNORED    @YL026UL*/
*                                                                  0963
*        /*TEXT STRUCTURE ERROR MESSAGE ID NUMBERS           @YL026UL*/
*        DCL BADLIST1 FIXED(15)        /*TOO LONG A LIST     @YL026UL*/
*                     CONSTANT(4);     /*OF STRING ITEMS     @YL026UL*/
*        DCL BADLIST2 FIXED(15)        /*TOO LONG A LIST     @YL026UL*/
*                     CONSTANT(7);     /*OF NUMERIC ITEMS    @YL026UL*/
*        DCL PROMPT3  FIXED(15)        /*PROMPT TO ASK IF    @YL026UL*/
*                     CONSTANT(10);    /*EXCESS LIST ITEMS   @YL026UL*/
*                                      /*MAY BE IGNORED      @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** TOOMANY **  HANDLE 'TOO LONG A LIST' ERROR   @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0966
         L     @07,GDTTR2(,GDTPTR)                                 0966
         MVC   @TS00001(95),NEWERID2(@07)                          0966
         MVC   OLDERID2(95,@07),@TS00001                           0966
*        NEWID2='RI28';                                    /*@YL026UL*/
*                                                                  0967
         MVC   NEWID2(4,@07),@CC01708                              0967
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE INVALID PARAMETER APPEARS WITHIN A        @YL026UL*/
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/
*        /* WHICH REPETITION CONTAINS THE ERROR.             @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF OCCURNUM > 1                                           0968
*          THEN                                                    0968
         LA    @07,12                                              0968
         LR    @02,@07                                             0968
         MH    @02,PARMID                                          0968
         L     @01,PINFOPTR                                        0968
         AL    @01,@CF01818                                        0968
         L     @02,PARMPTR(@02,@01)                                0968
         CLC   OCCURNUM(3,@02),@CF00227+1                          0968
         BNH   @RF00968                                            0968
*            DO;                                           /*@YL026UL*/
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/
         MH    @07,REPINDEX                                        0970
         L     @02,RSIPTR                                          0970
         AL    @02,@CF01819                                        0970
         SLR   @15,@15                                             0970
         IC    @15,SBLSTNUM-8(@07,@02)                             0970
         ST    @15,EFIELD3                                         0970
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/
         L     @07,DDSTRU                                          0971
         LA    @02,EFIELD3                                         0971
         ST    @02,DARGDBP(,@07)                                   0971
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/
         MVC   DARGILP(2,@07),@CH00050                             0972
*            DARGSENT=INREP;                               /*@YL026UL*/
*                                                                  0973
         MVI   DARGSENT(@07),X'0F'                                 0973
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/
*                                                                  0974
         ST    GDTPTR,@AL00001                                     0974
         LA    @07,@CF00123                                        0974
         ST    @07,@AL00001+4                                      0974
         LA    @07,DDSTRU                                          0974
         ST    @07,@AL00001+8                                      0974
         MVI   @AL00001+8,X'80'                                    0974
         L     @15,GDTPRT(,GDTPTR)                                 0974
         LA    @01,@AL00001                                        0974
         BALR  @14,@15                                             0974
*            END;                                          /*@YL026UL*/
*                                                                  0975
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* BUILD A MESSAGE IDENTIFYING THE LIST IN ERROR    @YL026UL*/
*        /* AND SEND IT TO THE TERMINAL USER.                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DARGDBP=ADDR(EFIELD);                             /*@YL026UL*/
@RF00968 L     @07,DDSTRU                                          0976
         LA    @02,EFIELD                                          0976
         ST    @02,DARGDBP(,@07)                                   0976
*        DARGILP=LENGTH(EFIELD);                           /*@YL026UL*/
         MVC   DARGILP(2,@07),@CH01804                             0977
*        EFIELD1=BLANK;                                    /*@YL026UL*/
*                                                                  0978
         MVI   EFIELD1+1,C' '                                      0978
         MVC   EFIELD1+2(18),EFIELD1+1                             0978
         MVI   EFIELD1,C' '                                        0978
*        CALL MSGKWD(PARMID,ADDR(EFIELD1));                /*@YL026UL*/
*                                                                  0979
         LA    @07,PARMID                                          0979
         ST    @07,@AL00001                                        0979
         LA    @07,EFIELD1                                         0979
         ST    @07,@AFTEMPS+12                                     0979
         LA    @07,@AFTEMPS+12                                     0979
         ST    @07,@AL00001+4                                      0979
         LA    @01,@AL00001                                        0979
         BAL   @14,MSGKWD                                          0979
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SUPPLY TO THE MESSAGE THE LIST ELEMENT AT WHICH  @YL026UL*/
*        /* THE LIST BECOMES TOO LONG.  USE THE DATA TYPE    @YL026UL*/
*        /* TO DETERMINE THE FORMAT OF THE PDE FROM WHICH    @YL026UL*/
*        /* TO EXTRACT THE ITEM.  PRINT THE ERROR MESSAGE.   @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        EFIELD2=BLANK;                                    /*@YL026UL*/
         MVI   EFIELD2+1,C' '                                      0980
         MVC   EFIELD2+2(62),EFIELD2+1                             0980
         MVI   EFIELD2,C' '                                        0980
*        IF NUMBER=YES                                             0981
*          THEN                                                    0981
         LA    @07,12                                              0981
         LR    @02,@07                                             0981
         MH    @02,PARMID                                          0981
         L     @01,PINFOPTR                                        0981
         AL    @01,@CF01818                                        0981
         AL    @07,PARMPTR(@02,@01)                                0981
         TM    NUMBER(@07),B'10000000'                             0981
         BNO   @RF00981                                            0981
*            DO;                                           /*@YL026UL*/
*            DARGSENT=BADLIST2;                            /*@YL026UL*/
         L     @07,DDSTRU                                          0983
         MVI   DARGSENT(@07),X'07'                                 0983
*            EFIELD3=PDENUMBR;                             /*@YL026UL*/
         L     @07,CONSTPTR(,PDEPTR)                               0984
         L     @07,PDENUMBR(,@07)                                  0984
         ST    @07,EFIELD3                                         0984
*            END;                                          /*@YL026UL*/
*          ELSE                                                    0986
*            DO;                                           /*@YL026UL*/
         B     @RC00981                                            0986
@RF00981 DS    0H                                                  0987
*            DARGSENT=BADLIST1;                            /*@YL026UL*/
*                                                                  0987
         L     @07,DDSTRU                                          0987
         MVI   DARGSENT(@07),X'04'                                 0987
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* MOVE INTO THE ERROR MESSAGE THE LIST ELEMENT @YL026UL*/
*            /* AT WHICH THE LIST BECAME TOO LONG.  IF THE   @YL026UL*/
*            /* LIST IS A LIST OF PARAMETER SETS (PSTRINGS), @YL026UL*/
*            /* PLACE A LEADING LEFT PAREN AHEAD OF THE      @YL026UL*/
*            /* LIST ELEMENT.                                @YL026UL*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*            IF REPEATED=YES                                       0988
*              THEN                                                0988
         LH    @07,PARMID                                          0988
         MH    @07,@CH00038                                        0988
         L     @02,PINFOPTR                                        0988
         AL    @02,@CF01818                                        0988
         L     @07,PARMPTR(@07,@02)                                0988
         TM    REPEATED(@07),B'00100000'                           0988
         BNO   @RF00988                                            0988
*                DO;                                       /*@YL026UL*/
*                EFIELD2(1)=PAREN;                         /*@YL026UL*/
         MVI   EFIELD2,C'('                                        0990
*                MOVELEN=MIN(LENGTH(EFIELD2)-1,CONSTLEN);  /*@YL026UL*/
         LH    MOVELEN,CONSTLEN(,PDEPTR)                           0991
         LA    @07,63                                              0991
         CR    MOVELEN,@07                                         0991
         BNH   *+6
         LR    MOVELEN,@07                                         0991
*                IF MOVELEN > 0                                    0992
*                  THEN                                            0992
         LTR   MOVELEN,MOVELEN                                     0992
         BNP   @RF00992                                            0992
*                    EFIELD2(2:MOVELEN+1)=                         0993
*                            PDESTRNG(1:MOVELEN);          /*@YL026UL*/
         LR    @07,MOVELEN                                         0993
         BCTR  @07,0                                               0993
         L     @05,CONSTPTR(,PDEPTR)                               0993
         EX    @07,@SM01862                                        0993
*                  ELSE                                            0994
*                    EFIELD2(2)=PAREN2;                    /*@YL026UL*/
         B     @RC00992                                            0994
@RF00992 MVI   EFIELD2+1,C')'                                      0994
*                END;                                      /*@YL026UL*/
*              ELSE                                                0996
*                IF NAMEPDE=NO                                     0996
*                  THEN                                            0996
         B     @RC00988                                            0996
@RF00988 TM    NAMEPDE,B'00001000'                                 0996
         BNZ   @RF00996                                            0996
*                    IF CONSTLEN > 0                               0997
*                      THEN                                        0997
         LH    @07,CONSTLEN(,PDEPTR)                               0997
         LTR   @07,@07                                             0997
         BNP   @RF00997                                            0997
*                        EFIELD2=PDESTRNG(1:MIN(                   0998
*                             LENGTH(EFIELD2),CONSTLEN));  /*@YL026UL*/
         MVI   EFIELD2+1,C' '                                      0998
         MVC   EFIELD2+2(62),EFIELD2+1                             0998
         LA    @02,64                                              0998
         CR    @07,@02                                             0998
         BNH   *+6
         LR    @07,@02                                             0998
         BCTR  @07,0                                               0998
         L     @02,CONSTPTR(,PDEPTR)                               0998
         EX    @07,@SM01852                                        0998
*                      ELSE                                /*@YL026UL*/
*                        DO;                               /*@YL026UL*/
         B     @RC00997                                            0999
@RF00997 DS    0H                                                  1000
*                        EFIELD2(1)=QUOTE;                 /*@YL026UL*/
         MVI   EFIELD2,C''''                                       1000
*                        EFIELD2(2)=QUOTE;                 /*@YL026UL*/
         MVI   EFIELD2+1,C''''                                     1001
*                        END;                              /*@YL026UL*/
*                  ELSE                                            1003
*                    IF DSNLEN > 0                                 1003
*                      THEN                                        1003
         B     @RC00996                                            1003
@RF00996 LH    @07,DSNLEN(,PDEPTR)                                 1003
         LTR   @07,@07                                             1003
         BNP   @RF01003                                            1003
*                        EFIELD2=PDEDSN(1:MIN(                     1004
*                             LENGTH(EFIELD2),DSNLEN));    /*@YL026UL*/
         MVI   EFIELD2+1,C' '                                      1004
         MVC   EFIELD2+2(62),EFIELD2+1                             1004
         LA    @02,64                                              1004
         CR    @07,@02                                             1004
         BNH   *+6
         LR    @07,@02                                             1004
         BCTR  @07,0                                               1004
         L     @02,DSNPTR(,PDEPTR)                                 1004
         EX    @07,@SM01864                                        1004
*                      ELSE                                        1005
*                        EFIELD2(1)=PAREN;                 /*@YL026UL*/
         B     @RC01003                                            1005
@RF01003 MVI   EFIELD2,C'('                                        1005
*            END;                                          /*@YL026UL*/
*                                                                  1006
@RC01003 DS    0H                                                  1006
@RC00996 DS    0H                                                  1006
@RC00988 DS    0H                                                  1007
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1007
@RC00981 ST    GDTPTR,@AL00001                                     1007
         LA    @07,@CF00123                                        1007
         ST    @07,@AL00001+4                                      1007
         LA    @07,DDSTRU                                          1007
         ST    @07,@AL00001+8                                      1007
         MVI   @AL00001+8,X'80'                                    1007
         L     @15,GDTPRT(,GDTPTR)                                 1007
         LA    @01,@AL00001                                        1007
         BALR  @14,@15                                             1007
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* OBTAIN A FORMATTED, STATIC TEXT MESSAGE TO       @YL026UL*/
*        /* PROMPT THE USER FOR A REPLY INDICATING WHETHER   @YL026UL*/
*        /* OR NOT PROCESSING SHOULD BE CONTINUED WITH THE   @YL026UL*/
*        /* THE EXCESS LIST ITEMS BEING IGNORED.             @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1008
*        DARGSENT=PROMPT3;                                 /*@YL026UL*/
         L     @07,DDSTRU                                          1008
         MVI   DARGSENT(@07),X'0A'                                 1008
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/
         LA    @04,MSGBUFF                                         1009
         ST    @04,DARGRETP(,@07)                                  1009
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/
*                                                                  1010
         MVC   DARGRETL(2,@07),@CH01454                            1010
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1011
         ST    GDTPTR,@AL00001                                     1011
         LA    @07,@CF00123                                        1011
         ST    @07,@AL00001+4                                      1011
         LA    @07,DDSTRU                                          1011
         ST    @07,@AL00001+8                                      1011
         MVI   @AL00001+8,X'80'                                    1011
         L     @15,GDTPRT(,GDTPTR)                                 1011
         LA    @01,@AL00001                                        1011
         BALR  @14,@15                                             1011
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/
         L     @07,DDSTRU                                          1012
         L     @04,DARGRETP(,@07)                                  1012
         ST    @04,PMSGPTR                                         1012
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/
         LH    @04,DARGRETL(,@07)                                  1013
         STH   @04,PMSGLEN                                         1013
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/
         SLR   @04,@04                                             1014
         ST    @04,DARGRETP(,@07)                                  1014
*        DARGRETL=0;                                       /*@YL026UL*/
*                                                                  1015
         STH   @04,DARGRETL(,@07)                                  1015
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ISSSUE A UPROMPT TO PROMPT THE USER FOR         @Y30SSFR*/
*        /*  ADDITIONAL INFORMATION.  IF THE UPROMPT FAILS   @Y30SSFR*/
*        /*  SET A LASTCC OF 12, AND RETURN TO THE CALLER.   @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*  1016
*                                                            #YL026UL*/
         ST    GDTPTR,@AL00001                                     1016
         LA    @07,PMSGPTR                                         1016
         ST    @07,@AL00001+4                                      1016
         LA    @07,PMSGLEN                                         1016
         ST    @07,@AL00001+8                                      1016
         LA    @07,RPLYPTR                                         1016
         ST    @07,@AL00001+12                                     1016
         LA    @07,RPLYLEN                                         1016
         ST    @07,@AL00001+16                                     1016
         MVI   @AL00001+16,X'80'                                   1016
         L     @15,GDTPMT(,GDTPTR)                                 1016
         LA    @01,@AL00001                                        1016
         BALR  @14,@15                                             1016
*        RESPECIFY RTNREG RSTD;                                    1017
*        TESTRC = RTNREG;                                          1018
         LR    TESTRC,RTNREG                                       1018
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UL*/
*                                                                  1019
*        IF TESTRC^=0                                              1020
*          THEN                                                    1020
         LTR   TESTRC,TESTRC                                       1020
         BZ    @RF01020                                            1020
*            DO;                                           /*#YL026UL*/
*            LASTCC=LASTCC12;                              /*#YL026UL*/
         L     @07,@PC00001+16                                     1022
         MVC   LASTCC(2,@07),@CH00038                              1022
*            RETURN;                                       /*#YL026UL*/
@EL00011 DS    0H                                                  1023
@EF00011 DS    0H                                                  1023
@ER00011 LM    @14,@12,@SA00011                                    1023
         BR    @14                                                 1023
*            END;                                          /*#YL026UL*/
*                                                                  1024
*        /************************************************************/
*        /*                                                  #YL026UL*/
*        /* CHECK FOR A VALID REPLY INDICATING THAT THE USER #YL026UL*/
*        /* WISHES THE EXCESS LIST ELEMENTS TO BE IGNORED.   #YL026UL*/
*        /*                                                  #YL026UL*/
*        /************************************************************/
*        RESPECIFY(DATABLK) BASED(RPLYPTR+4);              /*#YL026UL*/
@RF01020 DS    0H                                                  1026
*        TRUNCATE=NO;                                      /*#YL026UL*/
         NI    TRUNCATE,B'01111111'                                1026
*        IF RPLYLEN=2                                              1027
*          THEN                                                    1027
         CLC   RPLYLEN(2),@CH00161                                 1027
         BNE   @RF01027                                            1027
*            DO;                                           /*#YL026UL*/
*            DATABLK(1:2)=DATABLK(1:2)  FOLDMASK;         /*#YL026UL*/
         LA    @07,4                                               1029
         AL    @07,RPLYPTR                                         1029
         OC    DATABLK(2,@07),@CB01701                             1029
*            IF DATABLK(1:2)=LISTRPLY(2:3)                         1030
*              THEN                                                1030
         CLC   DATABLK(2,@07),LISTRPLY+1                           1030
         BNE   @RF01030                                            1030
*                TRUNCATE=YES;                             /*#YL026UL*/
         OI    TRUNCATE,B'10000000'                                1031
*            END;                                          /*#YL026UL*/
*          ELSE                                                    1033
*            IF RPLYLEN=4                                          1033
*              THEN                                                1033
         B     @RC01027                                            1033
@RF01027 LA    @07,4                                               1033
         CH    @07,RPLYLEN                                         1033
         BNE   @RF01033                                            1033
*                DO;                                       /*#YL026UL*/
*                DATABLK(2:3)=DATABLK(2:3)  FOLDMASK;     /*#YL026UL*/
         AL    @07,RPLYPTR                                         1035
         OC    DATABLK+1(2,@07),@CB01701                           1035
*                IF DATABLK(1:4)=LISTRPLY                          1036
*                  THEN                                            1036
         CLC   DATABLK(4,@07),LISTRPLY                             1036
         BNE   @RF01036                                            1036
*                    TRUNCATE=YES;                         /*#YL026UL*/
         OI    TRUNCATE,B'10000000'                                1037
*                END;                                      /*#YL026UL*/
*                                                                  1038
@RF01036 DS    0H                                                  1039
*        /************************************************************/
*        /*                                                  #YL026UL*/
*        /* IF THE USER REQUESTS CONTINUED PROCESSING THEN   #YL026UL*/
*        /* RESET THE LIST COUNT SO THAT THE EXCESS LIST     #YL026UL*/
*        /* ITEMS WILL BE IGNORED                            #YL026UL*/
*        /*                                                  #YL026UL*/
*        /************************************************************/
*        IF TRUNCATE=YES                                           1039
*          THEN                                                    1039
@RF01033 DS    0H                                                  1039
@RC01027 TM    TRUNCATE,B'10000000'                                1039
         BNO   @RF01039                                            1039
*            IF REPEATED=NO                                        1040
*              THEN                                                1040
         LH    @07,PARMID                                          1040
         MH    @07,@CH00038                                        1040
         L     @02,PINFOPTR                                        1040
         AL    @02,@CF01818                                        1040
         L     @07,PARMPTR(@07,@02)                                1040
         TM    REPEATED(@07),B'00100000'                           1040
         BNZ   @RF01040                                            1040
*                LISTTOTL=LISTTOTL-1;                      /*#YL026UL*/
         LH    @07,LISTTOTL                                        1041
         BCTR  @07,0                                               1041
         STH   @07,LISTTOTL                                        1041
*              ELSE                                                1042
*                REPCOUNT=REPCOUNT-1;                      /*#YL026UL*/
         B     @RC01040                                            1042
@RF01040 LH    @07,REPCOUNT                                        1042
         BCTR  @07,0                                               1042
         STH   @07,REPCOUNT                                        1042
*          ELSE                                                    1043
*            LASTCC=LASTCC12;                              /*#YL026UL*/
*                                                                  1043
         B     @RC01039                                            1043
@RF01039 L     @07,@PC00001+16                                     1043
         MVC   LASTCC(2,@07),@CH00038                              1043
*        END TOOMANY;                                      /*#YL026UL*/
*                                                                  1044
*                                                                  1044
         B     @EL00011                                            1044
*        END TRNSLATE;                                     /*@YL026UL*/
@EL00005 DS    0H                                                  1045
@EF00005 DS    0H                                                  1045
@ER00005 LM    @14,@02,@SA00005                                    1045
         LM    @04,@06,@SA00005+20                                 1045
         LM    @08,@12,@SA00005+32                                 1045
         BR    @14                                                 1045
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - NOTPARMS                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE CHECKS FOR CONFLICTS AMONG A    @YL026UL*/
*/*             SET OF PARAMETERS.  THE SET IS EITHER THE    @YL026UL*/
*/*             MAIN SET OF PARAMETERS, OR THE PARAMETERS    @YL026UL*/
*/*             OF A REPEATED SUBLIST REPETITION.  WHEN TWO  @YL026UL*/
*/*             PARMS ARE FOUND TO BE IN CONFLICT, THE USER  @YL026UL*/
*/*             IS PROMPTED TO SPECIFY WHICH PARM HE WISHES  @YL026UL*/
*/*             TO RETAIN; THE OTHER PARM (AND ITS SUBPARMS) @YL026UL*/
*/*             ARE THEN NULLIFIED.                          @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            PARMFLAG- ADJUSTED FLAGS REFLECTING CHANGES   @YL026UL*/
*/*                      MADE TO FDT TO RESOLVE CONFLICTS.   @YL026UL*/
*/*            SBLSTIN - RSI FLAG(S) SET TO NOTE IF CERTAIN  @YL026UL*/
*/*                      SUBLISTS SHOULD NOT BE PROCESSED    @YL026UL*/
*/*                      SINCE THEIR SUPERPARM(S) WERE IN    @YL026UL*/
*/*                      CONFLICT.                           @YL026UL*/
*/*            FDT -     ADJUSTED TO RESOLVE CONFLICTS.      @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*NOTPARMS:PROCEDURE;                                       /*@YL026UL*/
NOTPARMS STM   @14,@12,@SA00012                                    1046
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** NOTPARMS **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1047
*        DCL ERASEID  FIXED(15);       /*ID# OF PARM TO BE   @YL026UL*/
*                                      /*NULLIFIED           @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** NOTPARMS **  CHECK FOR CONFLICTING PARMS     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1048
         L     @07,GDTTR2(,GDTPTR)                                 1048
         MVC   @TS00001(95),NEWERID2(@07)                          1048
         MVC   OLDERID2(95,@07),@TS00001                           1048
*        NEWID2='RI30';                                    /*@YL026UL*/
*                                                                  1049
         MVC   NEWID2(4,@07),@CC01715                              1049
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CHECK EVERY PARAMETER OF THE COMMAND TO SEE IF   @YL026UL*/
*        /* THAT PARM WAS INPUT AS PART OF THE CURRENT SET   @YL026UL*/
*        /* OF PARMS BEING PROCESSED.                        @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*DOLOOP35:DO PARMID=1 TO MAXID;                            /*@YL026UL*/
DOLOOP35 LA    @07,1                                               1050
         B     @DE01050                                            1050
@DL01050 DS    0H                                                  1051
*          IF PARMFLAG(PARMID)=INPUT                               1051
*            THEN                                                  1051
*                                                                  1051
         L     @15,PINFOPTR                                        1051
         MH    @07,@CH00038                                        1051
         LA    @01,0(@07,@15)                                      1051
         BCTR  @01,0                                               1051
         BCTR  @01,0                                               1051
         SLR   @00,@00                                             1051
         IC    @00,PARMFLAG-10(,@01)                               1051
         C     @00,@CF00161                                        1051
         BNE   @RF01051                                            1051
*              /******************************************************/
*              /*                                            @YL026UL*/
*              /* IF A PARAMETER HAS A LIST OF 'NOTPARMS',   @YL026UL*/
*              /* CHECK THAT NONE OF THESE CONFLICTING PARMS @YL026UL*/
*              /* HAVE BEEN CODED.  IF A CONFLICT EXISTS,    @YL026UL*/
*              /* PROMPT THE USER TO INDICATE WHICH PARM     @YL026UL*/
*              /* IS TO BE IGNORED.                          @YL026UL*/
*              /*                                            @YL026UL*/
*              /******************************************************/
*              IF NOTDSPL^=0                                       1052
*                THEN                                              1052
         AL    @15,@CF01818                                        1052
         L     @07,PARMPTR(@07,@15)                                1052
         CLI   NOTDSPL(@07),0                                      1052
         BE    @RF01052                                            1052
*                  DO INDEX9=1 TO NOTCOUNT                 /*@YL026UL*/
*                            WHILE(PARMFLAG(PARMID)=INPUT);/*@YL026UL*/
         LA    @07,1                                               1053
         B     @DE01053                                            1053
@DL01053 LA    @15,2                                               1053
         L     @14,PINFOPTR                                        1053
         LA    @05,12                                              1053
         LR    @04,@05                                             1053
         MH    @04,PARMID                                          1053
         LA    @01,0(@04,@14)                                      1053
         BCTR  @01,0                                               1053
         BCTR  @01,0                                               1053
         SLR   @00,@00                                             1053
         IC    @00,PARMFLAG-10(,@01)                               1053
         CR    @15,@00                                             1053
         BNE   @DC01053                                            1053
*                    IF PARMFLAG(NOTID(INDEX9))=INPUT              1054
*                      THEN                                        1054
         ALR   @07,@07                                             1054
         AL    @04,@CF01818                                        1054
         L     @04,PARMPTR(@04,@14)                                1054
         SLR   @03,@03                                             1054
         IC    @03,NOTDSPL(,@04)                                   1054
         ALR   @03,@03                                             1054
         ALR   @04,@03                                             1054
         MH    @05,NOTID-2(@07,@04)                                1054
         BCTR  @14,0                                               1054
         BCTR  @14,0                                               1054
         SLR   @03,@03                                             1054
         IC    @03,PARMFLAG-10(@05,@14)                            1054
         CR    @15,@03                                             1054
         BNE   @RF01054                                            1054
*                        DO;                               /*@YL026UL*/
*                                                                  1055
*                        CALL RESOLVE(PARMID,                      1056
*                                     NOTID(INDEX9));      /*@YL026UL*/
*                                                                  1056
         LA    @05,PARMID                                          1056
         ST    @05,@AL00001                                        1056
         LA    @07,NOTID-2(@07,@04)                                1056
         ST    @07,@AL00001+4                                      1056
         LA    @01,@AL00001                                        1056
         BAL   @14,RESOLVE                                         1056
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  IF THE PROMPT WAS NOT ABLE TO   @Y30SSFR*/
*                        /*  RESOLVE THE CONFLICTS, RETURN   @Y30SSFR*/
*                        /*  TO THE CALLER.                  @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                        IF LASTCC^=0                              1057
*                          THEN                                    1057
         L     @07,@PC00001+16                                     1057
         LH    @07,LASTCC(,@07)                                    1057
         LTR   @07,@07                                             1057
         BNZ   @RT01057                                            1057
*                            RETURN;                       /*@YL026UL*/
*                        END;                              /*@YL026UL*/
*                  END;                                    /*@YL026UL*/
*                                                                  1060
@RF01054 LA    @07,1                                               1060
         AH    @07,INDEX9                                          1060
@DE01053 STH   @07,INDEX9                                          1060
         LH    @15,PARMID                                          1060
         MH    @15,@CH00038                                        1060
         LH    @14,PARMID                                          1060
         MH    @14,@CH00038                                        1060
         L     @01,PINFOPTR                                        1060
         AL    @01,@CF01818                                        1060
         L     @01,PARMPTR(@14,@01)                                1060
         SLR   @14,@14                                             1060
         IC    @14,NOTDSPL(,@01)                                   1060
         ALR   @14,@14                                             1060
         L     @01,PINFOPTR                                        1060
         AL    @01,@CF01818                                        1060
         AL    @14,PARMPTR(@15,@01)                                1060
         CH    @07,NOTCOUNT(,@14)                                  1060
         BNH   @DL01053                                            1060
@DC01053 DS    0H                                                  1061
*        END DOLOOP35;                                     /*@YL026UL*/
*                                                                  1061
@RF01052 DS    0H                                                  1061
@RF01051 LA    @07,1                                               1061
         AH    @07,PARMID                                          1061
@DE01050 STH   @07,PARMID                                          1061
         L     @01,DESCPTR                                         1061
         CH    @07,MAXID(,@01)                                     1061
         BNH   @DL01050                                            1061
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* FOR PARAMETERS TO BE IGNORED, MAKE SURE THAT   @YL026UL*/
*          /* UNSCANNED, REPEATED SUBLISTS SUBORDINATE TO    @YL026UL*/
*          /* THEM ARE ALSO IGNORED.                         @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          DO INDEX9=1 TO RSICOUNT;                        /*@YL026UL*/
         LA    @07,1                                               1062
         B     @DE01062                                            1062
@DL01062 DS    0H                                                  1063
*            IF PARMFLAG(SBLSTID(INDEX9))=PARTOSET                 1063
*              THEN                                                1063
         LA    @15,12                                              1063
         L     @14,RSIPTR                                          1063
         LR    @01,@07                                             1063
         MR    @00,@15                                             1063
         LA    @07,0(@01,@14)                                      1063
         AL    @07,@CF01821                                        1063
         MH    @15,SBLSTID-6(,@07)                                 1063
         L     @07,PINFOPTR                                        1063
         BCTR  @07,0                                               1063
         BCTR  @07,0                                               1063
         SLR   @00,@00                                             1063
         IC    @00,PARMFLAG-10(@15,@07)                            1063
         C     @00,@CF00227                                        1063
         BNE   @RF01063                                            1063
*                SBLSTIN(INDEX9)=NO;                       /*@YL026UL*/
         ALR   @14,@01                                             1064
         AL    @14,@CF01813                                        1064
         NI    SBLSTIN-9(@14),B'01111111'                          1064
*          END;                                            /*@YL026UL*/
*                                                                  1065
@RF01063 LA    @07,1                                               1065
         AH    @07,INDEX9                                          1065
@DE01062 STH   @07,INDEX9                                          1065
         CH    @07,RSICOUNT                                        1065
         BNH   @DL01062                                            1065
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - RESOLVE                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SENDS A MESSAGE TO THE TSO USER @YL026UL*/
*/*             IDENTIFYING THE TWO PARAMETERS IN CONFLICT   @YL026UL*/
*/*             AND REQUESTING THAT THE PARM TO BE RETAINED  @YL026UL*/
*/*             BE SPECIFIED (USING A CODE DESCRIBED IN THE  @YL026UL*/
*/*             MESSAGE).  THE PARAMETER NOT CHOSEN (AND ALL @YL026UL*/
*/*             ITS SUBPARAMETERS) ARE THEN NULLIFIED BY     @YL026UL*/
*/*             ALTERING THEIR PRESENCE FROM THE FDT AND     @YL026UL*/
*/*             FROM THE PARAMETER OCCURRENCE TABLE.         @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            ID1 -     PARM ID# OF FIRST OF THE TWO PARMS  @YL026UL*/
*/*                      IN CONFLICT.                        @YL026UL*/
*/*            ID2 -     PARM ID# OF SECOND OF THE TWO       @YL026UL*/
*/*                      PARMS IN CONFLICT.                  @YL026UL*/
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/
*/*            SUPRPARM- 'PARMINFO' FIELD INDICATING EACH    @YL026UL*/
*/*                      PARAMETER'S SUPERPARM ID#.          @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            FDT -     ADJUST TO RESOLVE CONFLICTS.        @YL026UL*/
*/*            PARMFLAG- ADJUSTED FLAGS REFLECTING CHANGES   @YL026UL*/
*/*                      MADE TO FDT.                        @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*RESOLVE:PROCEDURE(ID1,ID2);                               /*@YL026UL*/
         B     @PB00013                                            1066
RESOLVE  STM   @14,@12,@SA00013                                    1066
         MVC   @PC00013(8),0(@01)                                  1066
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** RESOLVE  **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1067
*        DCL ID1      FIXED(15);       /*ID# OF THE 1ST PARM @YL026UL*/
*                                      /*OF THE CONFLICT     @YL026UL*/
*        DCL ID2      FIXED(15);       /*ID# OF THE 2ND PARM @YL026UL*/
*                                      /*IN CONFLICT         @YL026UL*/
*        DCL KEEP1ST  BIT(1);          /*SET 'ON' WHEN THE   @YL026UL*/
*                                      /*1ST PARM IS CHOSEN  @YL026UL*/
*                                      /*TO BE RETAINED      @YL026UL*/
*        DCL RETAIN1  CHAR(3)          /*REPLY INDICATING    @YL026UL*/
*                     INIT('''1''');   /*THAT THE 1ST PARM   @YL026UL*/
*                                      /*IS TO BE RETAINED   @YL026UL*/
*        DCL RETAIN2  CHAR(3)          /*REPLY INDICATING    @YL026UL*/
*                     INIT('''2''');   /*THAT THE 2ND PARM   @YL026UL*/
*                                      /*IS TO BE RETAINED   @YL026UL*/
*                                                                  1072
*        /*TEXT STRUCTURE ERROR MESSAGE ID NUMBERS           @YL026UL*/
*        DCL CONFLICT FIXED(15)        /*MSG ID (PART 1) FOR @YL026UL*/
*                     CONSTANT(5);     /*CONFLICTING PARMS   @YL026UL*/
*        DCL CNFLCT2  FIXED(15)        /*MSG ID (PART 2) FOR @YL026UL*/
*                     CONSTANT(11);    /*CONFLICTING PARMS   @YL026UL*/
*        DCL PROMPT2  FIXED(15)        /*MSG ID OF PROMPT    @YL026UL*/
*                     CONSTANT(8);     /*ASKING FOR CHOICE   @YL026UL*/
*                                      /*BETWEEN PARMS       @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** RESOLVE **  RESOLVE THE CONFLICT OF PARMS    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1075
         L     @07,GDTTR2(,GDTPTR)                                 1075
         MVC   @TS00001(95),NEWERID2(@07)                          1075
         MVC   OLDERID2(95,@07),@TS00001                           1075
*        NEWID2='RI32';                                    /*@YL026UL*/
*                                                                  1076
         MVC   NEWID2(4,@07),@CC01734                              1076
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE INVALID PARAMETERS APPEAR WITHIN A        @YL026UL*/
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/
*        /* WHICH REPETITION CONTAINS THE ERROR.             @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF PARMPTR(ID1)->OCCURNUM > 1                             1077
*          THEN                                                    1077
         LA    @07,12                                              1077
         L     @15,@PC00013                                        1077
         LR    @14,@07                                             1077
         MH    @14,ID1(,@15)                                       1077
         L     @01,PINFOPTR                                        1077
         AL    @01,@CF01818                                        1077
         L     @01,PARMPTR(@14,@01)                                1077
         CLC   OCCURNUM(3,@01),@CF00227+1                          1077
         BNH   @RF01077                                            1077
*            DO;                                           /*@YL026UL*/
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/
         MH    @07,REPINDEX                                        1079
         L     @01,RSIPTR                                          1079
         AL    @01,@CF01819                                        1079
         SLR   @00,@00                                             1079
         IC    @00,SBLSTNUM-8(@07,@01)                             1079
         ST    @00,EFIELD3                                         1079
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/
         L     @07,DDSTRU                                          1080
         LA    @15,EFIELD3                                         1080
         ST    @15,DARGDBP(,@07)                                   1080
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/
         MVC   DARGILP(2,@07),@CH00050                             1081
*            DARGSENT=INREP;                               /*@YL026UL*/
*                                                                  1082
         MVI   DARGSENT(@07),X'0F'                                 1082
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/
*                                                                  1083
         ST    GDTPTR,@AL00001                                     1083
         LA    @07,@CF00123                                        1083
         ST    @07,@AL00001+4                                      1083
         LA    @07,DDSTRU                                          1083
         ST    @07,@AL00001+8                                      1083
         MVI   @AL00001+8,X'80'                                    1083
         L     @15,GDTPRT(,GDTPTR)                                 1083
         LA    @01,@AL00001                                        1083
         BALR  @14,@15                                             1083
*            END;                                          /*@YL026UL*/
*                                                                  1084
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SEND MESSAGES TO THE TERMINAL USER IDENTIFYING   @YL026UL*/
*        /* THE TWO PARAMETERS IN CONFLICT.                  @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        EFIELD1=BLANK;                                    /*@YL026UL*/
@RF01077 MVI   EFIELD1+1,C' '                                      1085
         MVC   EFIELD1+2(18),EFIELD1+1                             1085
         MVI   EFIELD1,C' '                                        1085
*        DARGDBP=ADDR(EFIELD1);                            /*@YL026UL*/
         L     @07,DDSTRU                                          1086
         LA    @15,EFIELD1                                         1086
         ST    @15,DARGDBP(,@07)                                   1086
*        DARGILP=LENGTH(EFIELD1);                          /*@YL026UL*/
*                                                                  1087
         MVC   DARGILP(2,@07),@CH01449                             1087
*        CALL MSGKWD(ID1,ADDR(EFIELD1));                   /*@YL026UL*/
*                                                                  1088
         L     @07,@PC00013                                        1088
         ST    @07,@AL00001                                        1088
         ST    @15,@AFTEMPS+16                                     1088
         LA    @07,@AFTEMPS+16                                     1088
         ST    @07,@AL00001+4                                      1088
         LA    @01,@AL00001                                        1088
         BAL   @14,MSGKWD                                          1088
*        DARGSENT=CONFLICT;                                /*@YL026UL*/
*                                                                  1089
         L     @07,DDSTRU                                          1089
         MVI   DARGSENT(@07),X'05'                                 1089
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1090
         ST    GDTPTR,@AL00001                                     1090
         LA    @07,@CF00123                                        1090
         ST    @07,@AL00001+4                                      1090
         LA    @07,DDSTRU                                          1090
         ST    @07,@AL00001+8                                      1090
         MVI   @AL00001+8,X'80'                                    1090
         L     @15,GDTPRT(,GDTPTR)                                 1090
         LA    @01,@AL00001                                        1090
         BALR  @14,@15                                             1090
*        CALL MSGKWD(ID2,ADDR(EFIELD1));                   /*@YL026UL*/
*                                                                  1091
         L     @07,@PC00013+4                                      1091
         ST    @07,@AL00001                                        1091
         LA    @07,EFIELD1                                         1091
         ST    @07,@AFTEMPS+16                                     1091
         LA    @07,@AFTEMPS+16                                     1091
         ST    @07,@AL00001+4                                      1091
         LA    @01,@AL00001                                        1091
         BAL   @14,MSGKWD                                          1091
*        DARGSENT=CNFLCT2;                                 /*@YL026UL*/
*                                                                  1092
         L     @07,DDSTRU                                          1092
         MVI   DARGSENT(@07),X'0B'                                 1092
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1093
         ST    GDTPTR,@AL00001                                     1093
         LA    @07,@CF00123                                        1093
         ST    @07,@AL00001+4                                      1093
         LA    @07,DDSTRU                                          1093
         ST    @07,@AL00001+8                                      1093
         MVI   @AL00001+8,X'80'                                    1093
         L     @15,GDTPRT(,GDTPTR)                                 1093
         LA    @01,@AL00001                                        1093
         BALR  @14,@15                                             1093
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* OBTAIN AND SEND A MESSAGE TO THE USER ASKING     @YL026UL*/
*        /* THAT HE SPECIFY (USING A CODE AS DESCRIBED IN    @YL026UL*/
*        /* ABOVE ERROR MESSAGE) WHICH PARAMETER SHOULD BE   @YL026UL*/
*        /* RETAINED.                                        @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DARGSENT=PROMPT2;                                 /*@YL026UL*/
         L     @07,DDSTRU                                          1094
         MVI   DARGSENT(@07),X'08'                                 1094
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/
         LA    @15,MSGBUFF                                         1095
         ST    @15,DARGRETP(,@07)                                  1095
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/
*                                                                  1096
         MVC   DARGRETL(2,@07),@CH01454                            1096
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1097
         ST    GDTPTR,@AL00001                                     1097
         LA    @07,@CF00123                                        1097
         ST    @07,@AL00001+4                                      1097
         LA    @07,DDSTRU                                          1097
         ST    @07,@AL00001+8                                      1097
         MVI   @AL00001+8,X'80'                                    1097
         L     @15,GDTPRT(,GDTPTR)                                 1097
         LA    @01,@AL00001                                        1097
         BALR  @14,@15                                             1097
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/
         L     @07,DDSTRU                                          1098
         L     @15,DARGRETP(,@07)                                  1098
         ST    @15,PMSGPTR                                         1098
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/
         LH    @15,DARGRETL(,@07)                                  1099
         STH   @15,PMSGLEN                                         1099
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/
         SLR   @15,@15                                             1100
         ST    @15,DARGRETP(,@07)                                  1100
*        DARGRETL=0;                                       /*@YL026UL*/
*                                                                  1101
         STH   @15,DARGRETL(,@07)                                  1101
*        ALLOK=NO;                                         /*@YL026UL*/
*                                                                  1102
         NI    ALLOK,B'11011111'                                   1102
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* PROMPT UNTIL THE USER HAS RESPONDED WITH A       @YL026UL*/
*        /* PROPER CODE.                                     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*DOLOOP40:DO WHILE(ALLOK=NO);                              /*@YL026UL*/
DOLOOP40 B     @DE01103                                            1103
@DL01103 DS    0H                                                  1104
*          KEEP1ST=NO;                                     /*@YL026UL*/
*                                                                  1104
         NI    KEEP1ST,B'01111111'                                 1104
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  ISSUE A UPROMPT AND TEST THE RETURN CODE.     @Y30SSFR*/
*          /*  IF THE UPROMPT FAILED, SET LASTCC TO 12, AND  @Y30SSFR*/
*          /*  RETURN.                                       @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*          CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*
*                                                            @YL026UL*/
         ST    GDTPTR,@AL00001                                     1105
         LA    @07,PMSGPTR                                         1105
         ST    @07,@AL00001+4                                      1105
         LA    @07,PMSGLEN                                         1105
         ST    @07,@AL00001+8                                      1105
         LA    @07,RPLYPTR                                         1105
         ST    @07,@AL00001+12                                     1105
         LA    @07,RPLYLEN                                         1105
         ST    @07,@AL00001+16                                     1105
         MVI   @AL00001+16,X'80'                                   1105
         L     @15,GDTPMT(,GDTPTR)                                 1105
         LA    @01,@AL00001                                        1105
         BALR  @14,@15                                             1105
*          RESPECIFY RTNREG RSTD;                                  1106
*          TESTRC = RTNREG;                                        1107
         LR    TESTRC,RTNREG                                       1107
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UL*/
*                                                                  1108
*          IF TESTRC^=0                                            1109
*            THEN                                                  1109
         LTR   TESTRC,TESTRC                                       1109
         BZ    @RF01109                                            1109
*              DO;                                         /*@YL026UL*/
*              LASTCC=LASTCC12;                            /*@YL026UL*/
         L     @07,@PC00001+16                                     1111
         MVC   LASTCC(2,@07),@CH00038                              1111
*              RETURN;                                     /*@YL026UL*/
@EL00013 DS    0H                                                  1112
@EF00013 DS    0H                                                  1112
@ER00013 LM    @14,@12,@SA00013                                    1112
         BR    @14                                                 1112
*              END;                                        /*@YL026UL*/
*                                                                  1113
*          RESPECIFY (DATABLK) BASED(RPLYPTR+4);           /*@YL026UL*/
*                                                                  1114
@RF01109 DS    0H                                                  1115
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF THE REPLY LENGTH IS 1, DETERMINE WHICH     @Y30SSFR*/
*          /*  PARAMETER TO KEEP ON THE BASIS OF THE USER'S  @Y30SSFR*/
*          /*  RESPONSE TO THE PROMPT.                       @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*          IF RPLYLEN=1                                            1115
*            THEN                                                  1115
         CLC   RPLYLEN(2),@CH00227                                 1115
         BNE   @RF01115                                            1115
*              IF DATABLK(1)=RETAIN1(2)                            1116
*                THEN                                              1116
         L     @07,RPLYPTR                                         1116
         CLC   DATABLK+4(1,@07),RETAIN1+1                          1116
         BNE   @RF01116                                            1116
*                  DO;                                     /*@YL026UL*/
*                                                                  1117
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  RETAIN THE FIRST PARAMETER.           @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                  KEEP1ST=YES;                            /*@YL026UL*/
         OI    KEEP1ST,B'10000000'                                 1118
*                  ALLOK=YES;                              /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   1119
*                  END;                                    /*@YL026UL*/
*                ELSE                                              1121
*                                                                  1121
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  IF THE REPLY IS 2, KEEP THE SECOND    @Y30SSFR*/
*                  /*  PARAMETER.                            @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                  IF DATABLK(1)=RETAIN2(2)                        1121
*                    THEN                                          1121
         B     @RC01116                                            1121
@RF01116 L     @07,RPLYPTR                                         1121
         CLC   DATABLK+4(1,@07),RETAIN2+1                          1121
         BNE   @RF01121                                            1121
*                      ALLOK=YES;                          /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   1122
*                    ELSE;                                 /*@YL026UL*/
*                                                                  1123
@RF01121 DS    0H                                                  1124
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THE USER'S RESPONSE HAS LENGTH 3,        @Y30SSFR*/
*            /*  DETERMINE WHICH PARAMETER TO KEEP ON THE    @Y30SSFR*/
*            /*  BASIS OF THAT RESPONSE.                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            ELSE                                                  1124
*              IF RPLYLEN=3                                        1124
*                THEN                                              1124
*                                                                  1124
         B     @RC01115                                            1124
@RF01115 CLC   RPLYLEN(2),@CH00170                                 1124
         BNE   @RF01124                                            1124
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  IF THE REPLY IS 1, RETAIN THE FIRST   @Y30SSFR*/
*                  /*  PARAMETER.  OTHERWISE, IF THE REPLY   @Y30SSFR*/
*                  /*  IS 2, RETAIN THE SECOND.              @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                  IF DATABLK(1:3)=RETAIN1                         1125
*                    THEN                                          1125
         L     @07,RPLYPTR                                         1125
         CLC   DATABLK+4(3,@07),RETAIN1                            1125
         BNE   @RF01125                                            1125
*                      DO;                                 /*@YL026UL*/
*                      KEEP1ST=YES;                        /*@YL026UL*/
         OI    KEEP1ST,B'10000000'                                 1127
*                      ALLOK=YES;                          /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   1128
*                      END;                                /*@YL026UL*/
*                    ELSE                                          1130
*                      IF DATABLK(1:3)=RETAIN2                     1130
*                        THEN                                      1130
         B     @RC01125                                            1130
@RF01125 L     @07,RPLYPTR                                         1130
         CLC   DATABLK+4(3,@07),RETAIN2                            1130
         BNE   @RF01130                                            1130
*                          ALLOK=YES;                      /*@YL026UL*/
         OI    ALLOK,B'00100000'                                   1131
*        END DOLOOP40;                                     /*@YL026UL*/
*                                                                  1132
@RF01130 DS    0H                                                  1132
@RC01125 DS    0H                                                  1132
@RF01124 DS    0H                                                  1132
@RC01115 DS    0H                                                  1132
@DE01103 TM    ALLOK,B'00100000'                                   1132
         BZ    @DL01103                                            1132
*        IF KEEP1ST=NO                                             1133
*          THEN                                                    1133
         TM    KEEP1ST,B'10000000'                                 1133
         BNZ   @RF01133                                            1133
*            ERASEID=ID1;                                  /*@YL026UL*/
         L     @07,@PC00013                                        1134
         LH    ERASEID,ID1(,@07)                                   1134
*          ELSE                                                    1135
*            ERASEID=ID2;                                  /*@YL026UL*/
*                                                                  1135
         B     @RC01133                                            1135
@RF01133 L     @07,@PC00013+4                                      1135
         LH    ERASEID,ID2(,@07)                                   1135
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* FOR THE PARAMETER NOT CHOSEN, ELIMINATE ALL      @YL026UL*/
*        /* PRESENCE OF IT AND ITS SUBPARMS FROM THE FDT     @YL026UL*/
*        /* AND FROM THE PARM OCCURRENCE TABLE.              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        INDEX10=PARMID;                                   /*@YL026UL*/
@RC01133 LH    @07,PARMID                                          1136
         STH   @07,INDEX10                                         1136
*DOLOOP45:DO PARMID=1 TO MAXID;                            /*@YL026UL*/
DOLOOP45 LA    @07,1                                               1137
         B     @DE01137                                            1137
@DL01137 DS    0H                                                  1138
*          TESTID=PARMID;                                  /*@YL026UL*/
         LR    TESTID,@07                                          1138
*          DO WHILE(PARMFLAG(PARMID)=INPUT & TESTID^=0);   /*@YL026UL*/
         B     @DE01139                                            1139
@DL01139 DS    0H                                                  1140
*            IF TESTID=ERASEID                                     1140
*              THEN                                                1140
         CR    TESTID,ERASEID                                      1140
         BNE   @RF01140                                            1140
*                DO;                                       /*@YL026UL*/
*                PARMFLAG(PARMID)=PARTOSET;                /*@YL026UL*/
         L     @07,PINFOPTR                                        1142
         LH    @15,PARMID                                          1142
         LR    @14,@15                                             1142
         MH    @14,@CH00038                                        1142
         LA    @05,1                                               1142
         LA    @04,0(@14,@07)                                      1142
         BCTR  @04,0                                               1142
         BCTR  @04,0                                               1142
         STC   @05,PARMFLAG-10(,@04)                               1142
*                IF OCCURNUM=1                                     1143
*                  THEN                                            1143
         AL    @07,@CF01818                                        1143
         L     @07,PARMPTR(@14,@07)                                1143
         CLC   OCCURNUM(3,@07),@CF00227+1                          1143
         BNE   @RF01143                                            1143
*                    FDTPTR(PARMID)=0;                     /*@YL026UL*/
         SLA   @15,2                                               1144
         L     @07,@PC00001+4                                      1144
         L     @07,FDTADDR(,@07)                                   1144
         SLR   @14,@14                                             1144
         ST    @14,FDTPTR-4(@15,@07)                               1144
*                  ELSE                                            1145
*                    VECTRVAL=0;                           /*@YL026UL*/
         B     @RC01143                                            1145
@RF01143 LH    @07,PARMID                                          1145
         SLA   @07,2                                               1145
         L     @15,@PC00001+4                                      1145
         L     @01,FDTADDR(,@15)                                   1145
         LH    @15,REPINDEX                                        1145
         MH    @15,@CH00038                                        1145
         L     @14,RSIPTR                                          1145
         BCTR  @14,0                                               1145
         BCTR  @14,0                                               1145
         LH    @15,VECTRDSP-10(@15,@14)                            1145
         AL    @15,FDTPTR-4(@07,@01)                               1145
         SLR   @07,@07                                             1145
         ST    @07,VECTRVAL(,@15)                                  1145
*                END;                                      /*@YL026UL*/
*              ELSE                                                1147
*                TESTID=SUPRPARM(TESTID);                  /*@YL026UL*/
         B     @RC01140                                            1147
@RF01140 LR    @07,TESTID                                          1147
         MH    @07,@CH00038                                        1147
         L     @01,PINFOPTR                                        1147
         AL    @01,@CF01819                                        1147
         LH    @07,SUPRPARM-8(@07,@01)                             1147
         LR    TESTID,@07                                          1147
*          END;                                            /*@YL026UL*/
@RC01140 DS    0H                                                  1148
@DE01139 LH    @07,PARMID                                          1148
         MH    @07,@CH00038                                        1148
         L     @01,PINFOPTR                                        1148
         BCTR  @01,0                                               1148
         BCTR  @01,0                                               1148
         SLR   @00,@00                                             1148
         IC    @00,PARMFLAG-10(@07,@01)                            1148
         C     @00,@CF00161                                        1148
         BNE   @DC01139                                            1148
         LTR   TESTID,TESTID                                       1148
         BNZ   @DL01139                                            1148
@DC01139 DS    0H                                                  1149
*        END DOLOOP45;                                     /*@YL026UL*/
         LA    @07,1                                               1149
         AH    @07,PARMID                                          1149
@DE01137 STH   @07,PARMID                                          1149
         L     @02,DESCPTR                                         1149
         CH    @07,MAXID(,@02)                                     1149
         BNH   @DL01137                                            1149
*        PARMID=INDEX10;                                   /*@YL026UL*/
*                                                                  1150
         LH    @07,INDEX10                                         1150
         STH   @07,PARMID                                          1150
*        END RESOLVE;                                      /*@YL026UL*/
*                                                                  1151
*                                                                  1151
         B     @EL00013                                            1151
*        END NOTPARMS;                                     /*@YL026UL*/
@EL00012 DS    0H                                                  1152
@EF00012 DS    0H                                                  1152
@ER00012 LM    @14,@12,@SA00012                                    1152
         BR    @14                                                 1152
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - DEFAULTS                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SELECTS UNCODED PARAMETERS FROM @YL026UL*/
*/*             THE PARAMETER SET CURRENTLY BEING PROCESSED  @YL026UL*/
*/*             WHICH ARE ELIGIBLE TO BE DEFAULTED.  A SUB-  @YL026UL*/
*/*             ROUTINE IS THEN CALLED WHICH ACTUALLY        @YL026UL*/
*/*             ADDS THE DEFAULTS TO THE FDT.                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/
*/*                      WHICH PARMS MIGHT BE INPUT AND      @YL026UL*/
*/*                      WHICH ONES ARE ACTUALLY INPUT.      @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            FDT -     DEFAULT PARMS ARE ADDED TO THOSE    @YL026UL*/
*/*                      EXPLICITLY CODED.                   @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*DEFAULTS:PROCEDURE;                                       /*@YL026UL*/
DEFAULTS STM   @14,@02,@SA00014                                    1153
         STM   @05,@06,@SA00014+20                                 1153
         STM   @08,@12,@SA00014+28                                 1153
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** DEFAULTS **  APPLY DEFAULT PARAMETERS        @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1154
         L     @05,GDTTR2(,GDTPTR)                                 1154
         MVC   @TS00001(95),NEWERID2(@05)                          1154
         MVC   OLDERID2(95,@05),@TS00001                           1154
*        NEWID2='RI34';                                    /*@YL026UL*/
*                                                                  1155
         MVC   NEWID2(4,@05),@CC01744                              1155
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF 'DEFAULT' GROUPS ARE SPECIFIED, FIND THE      @YL026UL*/
*        /* GROUP(S) WHICH PERTAIN TO THE PARAMETER SET      @YL026UL*/
*        /* CURRENTLY BEING PROCESSED.  (IF THE 1ST PARM IN  @YL026UL*/
*        /* A GROUP PERTAINS, THEN THE WHOLE GROUP DOES).    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF DGRPDSPL^=0                                            1156
*          THEN                                                    1156
         L     @05,DESCPTR                                         1156
         CLI   DGRPDSPL(@05),0                                     1156
         BE    @RF01156                                            1156
*DOGRP65:    DO;                                           /*@YL026UL*/
DOGRP65  DS    0H                                                  1158
*            GRPPTR=ADDR(DGRPTOT)+LENGTH(DGRPTOT);         /*@YL026UL*/
         L     @02,DESCPTR                                         1158
         SLR   GRPPTR,GRPPTR                                       1158
         IC    GRPPTR,DGRPDSPL(,@02)                               1158
         ALR   GRPPTR,GRPPTR                                       1158
         ALR   @02,GRPPTR                                          1158
         AL    @02,@CF00161                                        1158
         LR    GRPPTR,@02                                          1158
*DOLOOP50:   DO INDEX10=1 TO DGRPTOT;                      /*@YL026UL*/
DOLOOP50 LA    @05,1                                               1159
         B     @DE01159                                            1159
@DL01159 DS    0H                                                  1160
*              IF PARMFLAG(DGRPID(1))=PARTOSET                     1160
*                THEN                                              1160
*                                                                  1160
         LA    @05,1                                               1160
         LH    @02,DGRPID(,GRPPTR)                                 1160
         MH    @02,@CH00038                                        1160
         L     @01,PINFOPTR                                        1160
         BCTR  @01,0                                               1160
         BCTR  @01,0                                               1160
         SLR   @00,@00                                             1160
         IC    @00,PARMFLAG-10(@02,@01)                            1160
         CR    @05,@00                                             1160
         BNE   @RF01160                                            1160
*                  /**************************************************/
*                  /*                                        @YL026UL*/
*                  /* IF NONE OF THE PARMS OF A GROUP WERE   @YL026UL*/
*                  /* CODED, DEFAULT THE 1ST PARM IDENTIFIED @YL026UL*/
*                  /* IN THE SUBLIST OF ID#S                 @YL026UL*/
*                  /*                                        @YL026UL*/
*                  /**************************************************/
*                  DO;                                     /*@YL026UL*/
*                    FOUND=NO;                             /*@YL026UL*/
         NI    FOUND,B'11111101'                                   1162
*                    DO INDEX9=1 TO DGRPCNT;               /*@YL026UL*/
         B     @DE01163                                            1163
@DL01163 DS    0H                                                  1164
*                      IF PARMFLAG(DGRPID(INDEX9))=INPUT           1164
*                        THEN                                      1164
         ALR   @05,@05                                             1164
         LH    @05,DGRPID-2(@05,GRPPTR)                            1164
         MH    @05,@CH00038                                        1164
         L     @02,PINFOPTR                                        1164
         BCTR  @02,0                                               1164
         BCTR  @02,0                                               1164
         SLR   @15,@15                                             1164
         IC    @15,PARMFLAG-10(@05,@02)                            1164
         C     @15,@CF00161                                        1164
         BNE   @RF01164                                            1164
*                          FOUND=YES;                      /*@YL026UL*/
         OI    FOUND,B'00000010'                                   1165
*                    END;                                  /*@YL026UL*/
@RF01164 LA    @05,1                                               1166
         AH    @05,INDEX9                                          1166
@DE01163 STH   @05,INDEX9                                          1166
         CH    @05,DGRPCNT(,GRPPTR)                                1166
         BNH   @DL01163                                            1166
*                    IF FOUND=NO                                   1167
*                      THEN                                        1167
         TM    FOUND,B'00000010'                                   1167
         BNZ   @RF01167                                            1167
*                        DO;                               /*@YL026UL*/
*                                                                  1168
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  CALL SETDFLT TO SET UP THE      @Y30SSFR*/
*                        /*  DEFAULT VALUES FOR THIS GROUP   @Y30SSFR*/
*                        /*  OF PARAMETERS.                  @Y30SSFR*/
*                        /*  IF SETDFLT FAILS, RETURN TO     @Y30SSFR*/
*                        /*  THE CALLER.                     @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                        CALL SETDFLT(DGRPID(1));          /*@YL026UL*/
*                                                                  1169
         LA    @05,DGRPID(,GRPPTR)                                 1169
         ST    @05,@AL00001                                        1169
         LA    @01,@AL00001                                        1169
         BAL   @14,SETDFLT                                         1169
*                        IF LASTCC^=0                              1170
*                          THEN                                    1170
         L     @05,@PC00001+16                                     1170
         LH    @05,LASTCC(,@05)                                    1170
         LTR   @05,@05                                             1170
         BNZ   @RT01170                                            1170
*                            RETURN;                       /*@YL026UL*/
*                        END;                              /*@YL026UL*/
*                  END;                                    /*@YL026UL*/
@RF01167 DS    0H                                                  1174
*              GRPPTR=GRPPTR+LENGTH(DGRPCNT)+                      1174
*                     DGRPCNT*LENGTH(DGRPID);              /*@YL026UL*/
@RF01160 LA    @05,2                                               1174
         ALR   @05,GRPPTR                                          1174
         LH    @02,DGRPCNT(,GRPPTR)                                1174
         ALR   @02,@02                                             1174
         ALR   @05,@02                                             1174
         LR    GRPPTR,@05                                          1174
*            END DOLOOP50;                                 /*@YL026UL*/
         LA    @05,1                                               1175
         AH    @05,INDEX10                                         1175
@DE01159 STH   @05,INDEX10                                         1175
         L     @02,DESCPTR                                         1175
         SLR   @15,@15                                             1175
         IC    @15,DGRPDSPL(,@02)                                  1175
         ALR   @15,@15                                             1175
         AL    @15,DESCPTR                                         1175
         CH    @05,DGRPTOT(,@15)                                   1175
         BNH   @DL01159                                            1175
*            END DOGRP65;                                  /*@YL026UL*/
*                                                                  1176
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* EXAMINE EACH PARAMETER DEFINED AS PART OF THE    @YL026UL*/
*        /* CURRENT PARM SET TO SEE IF A DEFAULT CONSTANT    @YL026UL*/
*        /* IS PROVIDED FOR IT.  IF A CONSTANT IS PRESENT    @YL026UL*/
*        /* AND THE PARM IS NOT ALREADY CODED, THEN IT IS    @YL026UL*/
*        /* ELIGIBLE TO BE DEFAULTED.                        @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DO INDEX9=1 TO MAXID;                             /*@YL026UL*/
@RF01156 LA    @05,1                                               1177
         B     @DE01177                                            1177
@DL01177 DS    0H                                                  1178
*          IF PARMFLAG(INDEX9)=PARTOSET &                          1178
*             PARMPTR(INDEX9)->DEFAULT=YES                         1178
*            THEN                                                  1178
         L     @02,PINFOPTR                                        1178
         MH    @05,@CH00038                                        1178
         LA    @01,0(@05,@02)                                      1178
         BCTR  @01,0                                               1178
         BCTR  @01,0                                               1178
         SLR   @00,@00                                             1178
         IC    @00,PARMFLAG-10(,@01)                               1178
         C     @00,@CF00227                                        1178
         BNE   @RF01178                                            1178
         AL    @02,@CF01818                                        1178
         L     @05,PARMPTR(@05,@02)                                1178
         TM    DEFAULT(@05),B'00000100'                            1178
         BNO   @RF01178                                            1178
*              DO;                                         /*@YL026UL*/
*                                                                  1179
*              CALL SETDFLT(INDEX9);                       /*@YL026UL*/
*                                                                  1180
         LA    @05,INDEX9                                          1180
         ST    @05,@AL00001                                        1180
         LA    @01,@AL00001                                        1180
         BAL   @14,SETDFLT                                         1180
*              IF LASTCC^=0                                        1181
*                THEN                                              1181
         L     @05,@PC00001+16                                     1181
         LH    @05,LASTCC(,@05)                                    1181
         LTR   @05,@05                                             1181
         BNZ   @RT01181                                            1181
*                  RETURN;                                 /*@YL026UL*/
*              END;                                        /*@YL026UL*/
*        END;                                              /*@YL026UL*/
*                                                                  1184
@RF01178 LA    @05,1                                               1184
         AH    @05,INDEX9                                          1184
@DE01177 STH   @05,INDEX9                                          1184
         L     @02,DESCPTR                                         1184
         CH    @05,MAXID(,@02)                                     1184
         BNH   @DL01177                                            1184
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - SETDFLT                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE CHECKS A PARAMETER WHICH IS     @YL026UL*/
*/*             ELIGIBLE TO BE DEFAULTED TO SEE IF THE       @YL026UL*/
*/*             DEFAULT WILL CAUSE ANY CONFLICT WITH AN      @YL026UL*/
*/*             EXISTING INPUT PARAMETER.  IF NOT, THE PARM  @YL026UL*/
*/*             IS ADDED TO THE FDT (VIA THE 'TRNSLATE' AND  @YL026UL*/
*/*             'PARSE' ROUTINES IF A DEFAULT CONSTANT IS    @YL026UL*/
*/*             PROVIDED).                                   @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            DFLTPARM- PARM ID# OF PARM WHICH IS ELIGIBLE  @YL026UL*/
*/*                      TO BE DEFAULTED.                    @YL026UL*/
*/*            PARMINFO- PARM INFORMATION TABLE.             @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            PARMFLAG- FLAG(S) IN 'PARMINFO' SET TO NOTE   @YL026UL*/
*/*                      THE NEW PARMS WHICH WERE DEFAULTED  @YL026UL*/
*/*            FDT -     POINTER VECTOR AND DATA STRUCTURE   @YL026UL*/
*/*                      ENTRIES FOR THE DEFAULT PARM(S).    @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*SETDFLT:PROCEDURE(DFLTPARM);                              /*@YL026UL*/
         B     @PB00015                                            1185
SETDFLT  STM   @14,@02,@SA00015                                    1185
         STM   @05,@06,@SA00015+20                                 1185
         STM   @08,@12,@SA00015+28                                 1185
         MVC   @PC00015(4),0(@01)                                  1185
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** SETDFLT  **  DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1186
*        DCL DFLTPARM FIXED(15);       /*ID# OF PARM TO BE   @YL026UL*/
*                                      /*DEFAULTED           @YL026UL*/
*        DCL DFLTOK   BIT(1);          /*SET 'ON' IF PARM    @YL026UL*/
*                                      /*MAY BE DEFAULTED    @YL026UL*/
*        DCL WORKPTR2 PTR(31);         /*VARIABLE TO SAVE A  @YL026UL*/
*                                      /*PTR TEMPORARILY     @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** SETDFLT **  ADD DEFAULTS TO THE FDT          @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1189
         L     @05,GDTTR2(,GDTPTR)                                 1189
         MVC   @TS00001(95),NEWERID2(@05)                          1189
         MVC   OLDERID2(95,@05),@TS00001                           1189
*        NEWID2='RI36';                                    /*@YL026UL*/
*                                                                  1190
         MVC   NEWID2(4,@05),@CC01757                              1190
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* THE PARAMETER TO BE DEFAULTED IS CHECKED TO      @YL026UL*/
*        /* INSURE THAT ITS PRESENCE WILL NOT CREATE A       @YL026UL*/
*        /* CONFLICT WITH AN EXISTING INPUT PARAMETER.       @YL026UL*/
*        /* SINCE KEYWORD SUPERPARM(S) OF THE DEFAULT PARM   @YL026UL*/
*        /* ARE TO BE DEFAULTED (AS NECESSARY) ALONG WITH    @YL026UL*/
*        /* IT, THESE SUPERPARM(S) ARE ALSO CHECKED FOR      @YL026UL*/
*        /* POTENTIAL CONFLICTS                              @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PARMID=DFLTPARM;                                  /*@YL026UL*/
         L     @05,@PC00015                                        1191
         LH    @05,DFLTPARM(,@05)                                  1191
         STH   @05,PARMID                                          1191
*        DFLTOK=YES;                                       /*@YL026UL*/
         OI    DFLTOK,B'10000000'                                  1192
*DOLOOP55:DO WHILE(DFLTOK=YES & PARMID^=0 &                        1193
*                  PARMFLAG(PARMID)=PARTOSET);             /*@YL026UL*/
*                                                                  1193
DOLOOP55 B     @DE01193                                            1193
@DL01193 DS    0H                                                  1194
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* FIRST, CHECK FOR A LIST OF CONFLICTING PARMS   @YL026UL*/
*          /* SPECIFICALLY ASSOCIATED WITH THE DEFAULT PARM, @YL026UL*/
*          /* AND BE SURE THAT NO CONFLICTS WOULD EXIST.     @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          IF NOTDSPL > 0                                          1194
*            THEN                                                  1194
         LH    @05,PARMID                                          1194
         MH    @05,@CH00038                                        1194
         L     @02,PINFOPTR                                        1194
         AL    @02,@CF01818                                        1194
         L     @05,PARMPTR(@05,@02)                                1194
         CLI   NOTDSPL(@05),0                                      1194
         BNH   @RF01194                                            1194
*              DO INDEX11=1 TO NOTCOUNT;                   /*@YL026UL*/
         LA    INDEX11,1                                           1195
         B     @DE01195                                            1195
@DL01195 DS    0H                                                  1196
*                IF PARMFLAG(NOTID(INDEX11))=INPUT                 1196
*                  THEN                                            1196
         L     @05,PINFOPTR                                        1196
         LA    @15,12                                              1196
         LR    @14,INDEX11                                         1196
         ALR   @14,@14                                             1196
         LR    @01,@15                                             1196
         MH    @01,PARMID                                          1196
         AL    @01,@CF01818                                        1196
         L     @01,PARMPTR(@01,@05)                                1196
         SLR   @00,@00                                             1196
         IC    @00,NOTDSPL(,@01)                                   1196
         ALR   @00,@00                                             1196
         ALR   @01,@00                                             1196
         MH    @15,NOTID-2(@14,@01)                                1196
         BCTR  @05,0                                               1196
         BCTR  @05,0                                               1196
         SLR   @14,@14                                             1196
         IC    @14,PARMFLAG-10(@15,@05)                            1196
         C     @14,@CF00161                                        1196
         BNE   @RF01196                                            1196
*                    DFLTOK=NO;                            /*@YL026UL*/
         NI    DFLTOK,B'01111111'                                  1197
*              END;                                        /*@YL026UL*/
*                                                                  1198
@RF01196 AL    INDEX11,@CF00227                                    1198
@DE01195 LH    @05,PARMID                                          1198
         MH    @05,@CH00038                                        1198
         LH    @15,PARMID                                          1198
         MH    @15,@CH00038                                        1198
         L     @01,PINFOPTR                                        1198
         AL    @01,@CF01818                                        1198
         L     @01,PARMPTR(@15,@01)                                1198
         SLR   @15,@15                                             1198
         IC    @15,NOTDSPL(,@01)                                   1198
         ALR   @15,@15                                             1198
         L     @14,PINFOPTR                                        1198
         AL    @14,@CF01818                                        1198
         AL    @15,PARMPTR(@05,@14)                                1198
         CH    INDEX11,NOTCOUNT(,@15)                              1198
         BNH   @DL01195                                            1198
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* THEN CHECK FOR THE OCCURRENCE OF THIS DEFAULT  @YL026UL*/
*          /* PARAMETER IN A 'NOT GROUP' (A SET OF MUTUALLY  @YL026UL*/
*          /* EXCLUSIVE PARMS), AND BE SURE THAT NO OTHER    @YL026UL*/
*          /* PARAMETER IN THE GROUP IS INPUT                @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          IF DFLTOK=YES & NTGRPPTR(PARMID)^=NULLPTR               1199
*            THEN                                                  1199
@RF01194 TM    DFLTOK,B'10000000'                                  1199
         BNO   @RF01199                                            1199
         LH    @05,PARMID                                          1199
         MH    @05,@CH00038                                        1199
         L     @02,PINFOPTR                                        1199
         AL    @02,@CF01817                                        1199
         L     @05,NTGRPPTR-4(@05,@02)                             1199
         LTR   @05,@05                                             1199
         BZ    @RF01199                                            1199
*              DO;                                         /*@YL026UL*/
         ST    @05,@TF00001                                        1200
*                WORKPTR2=GRPPTR;                          /*@YL026UL*/
         LR    WORKPTR2,GRPPTR                                     1201
*                GRPPTR=NTGRPPTR(PARMID);                  /*@YL026UL*/
         L     GRPPTR,@TF00001                                     1202
*                DO INDEX11=1 TO NTGRPCNT;                 /*@YL026UL*/
         LA    INDEX11,1                                           1203
         B     @DE01203                                            1203
@DL01203 DS    0H                                                  1204
*                  IF PARMFLAG(NTGRPID(INDEX11))=INPUT &           1204
*                     NTGRPID(INDEX11)^=PARMID                     1204
*                    THEN                                          1204
         LR    @15,INDEX11                                         1204
         ALR   @15,@15                                             1204
         LH    @15,NTGRPID-2(@15,GRPPTR)                           1204
         LR    @14,@15                                             1204
         MH    @14,@CH00038                                        1204
         L     @01,PINFOPTR                                        1204
         BCTR  @01,0                                               1204
         BCTR  @01,0                                               1204
         SLR   @00,@00                                             1204
         IC    @00,PARMFLAG-10(@14,@01)                            1204
         C     @00,@CF00161                                        1204
         BNE   @RF01204                                            1204
         CH    @15,PARMID                                          1204
         BE    @RF01204                                            1204
*                      DFLTOK=NO;                          /*@YL026UL*/
         NI    DFLTOK,B'01111111'                                  1205
*                END;                                      /*@YL026UL*/
@RF01204 AL    INDEX11,@CF00227                                    1206
@DE01203 CH    INDEX11,NTGRPCNT(,GRPPTR)                           1206
         BNH   @DL01203                                            1206
*                GRPPTR=WORKPTR2;                          /*@YL026UL*/
         LR    GRPPTR,WORKPTR2                                     1207
*              END;                                        /*@YL026UL*/
*          PARMID=SUPRPARM(PARMID);                        /*@YL026UL*/
@RF01199 LH    @05,PARMID                                          1209
         MH    @05,@CH00038                                        1209
         L     @02,PINFOPTR                                        1209
         AL    @02,@CF01819                                        1209
         LH    @05,SUPRPARM-8(@05,@02)                             1209
         STH   @05,PARMID                                          1209
*        END DOLOOP55;                                     /*@YL026UL*/
*                                                                  1210
@DE01193 TM    DFLTOK,B'10000000'                                  1210
         BNO   @DC01193                                            1210
         LH    @05,PARMID                                          1210
         LTR   @05,@05                                             1210
         BZ    @DC01193                                            1210
         MH    @05,@CH00038                                        1210
         L     @02,PINFOPTR                                        1210
         BCTR  @02,0                                               1210
         BCTR  @02,0                                               1210
         SLR   @15,@15                                             1210
         IC    @15,PARMFLAG-10(@05,@02)                            1210
         C     @15,@CF00227                                        1210
         BE    @DL01193                                            1210
@DC01193 DS    0H                                                  1211
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF NO CONFLICTS WILL OCCUR BY DEFAULTING THIS    @YL026UL*/
*        /* PARAMETER, NOTE THE PARM'S (AND SUPERPARM'S)     @YL026UL*/
*        /* OCCURRENCE IN THE PARMFLAG TABLE AND IN THE FDT. @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF DFLTOK=YES                                             1211
*          THEN                                                    1211
         TM    DFLTOK,B'10000000'                                  1211
         BNO   @RF01211                                            1211
*DOGRP70:    DO;                                           /*@YL026UL*/
DOGRP70  DS    0H                                                  1213
*              PARMID=DFLTPARM;                            /*@YL026UL*/
         L     @05,@PC00015                                        1213
         LH    @05,DFLTPARM(,@05)                                  1213
         STH   @05,PARMID                                          1213
*DOLOOP60:     DO WHILE(PARMID^=0 &                                1214
*                       PARMFLAG(PARMID)=PARTOSET);        /*@YL026UL*/
DOLOOP60 B     @DE01214                                            1214
@DL01214 DS    0H                                                  1215
*                PARMFLAG(PARMID)=INPUT;                   /*@YL026UL*/
*                                                                  1215
         L     @05,PINFOPTR                                        1215
         LH    @02,PARMID                                          1215
         LR    @15,@02                                             1215
         MH    @15,@CH00038                                        1215
         LA    @14,2                                               1215
         LA    @01,0(@15,@05)                                      1215
         BCTR  @01,0                                               1215
         BCTR  @01,0                                               1215
         STC   @14,PARMFLAG-10(,@01)                               1215
*                /****************************************************/
*                /*                                          @YL026UL*/
*                /* IF NO DEFAULT CONSTANT IS PROVIDED, NOTE @YL026UL*/
*                /* IN THE FDT THAT THE PARM IS INPUT BY     @YL026UL*/
*                /* SETTING THE FDT PTR TO POINT TO ITSELF.  @YL026UL*/
*                /*                                          @YL026UL*/
*                /****************************************************/
*                IF DEFAULT=NO                                     1216
*                  THEN                                            1216
         AL    @05,@CF01818                                        1216
         L     @05,PARMPTR(@15,@05)                                1216
         TM    DEFAULT(@05),B'00000100'                            1216
         BNZ   @RF01216                                            1216
*                    IF OCCURNUM=1                                 1217
*                      THEN                                        1217
         CLC   OCCURNUM(3,@05),@CF00227+1                          1217
         BNE   @RF01217                                            1217
*                        FDTPTR(PARMID)=                           1218
*                                ADDR(FDTPTR(PARMID));     /*@YL026UL*/
         SLA   @02,2                                               1218
         L     @05,@PC00001+4                                      1218
         L     @05,FDTADDR(,@05)                                   1218
         LA    @15,FDTPTR-4(@02,@05)                               1218
         ST    @15,FDTPTR-4(@02,@05)                               1218
*                      ELSE                                        1219
*                        VECTRVAL=ADDR(VECTRVAL);          /*@YL026UL*/
         B     @RC01217                                            1219
@RF01217 LH    @05,PARMID                                          1219
         SLA   @05,2                                               1219
         L     @02,@PC00001+4                                      1219
         L     @02,FDTADDR(,@02)                                   1219
         LH    @15,REPINDEX                                        1219
         MH    @15,@CH00038                                        1219
         L     @01,RSIPTR                                          1219
         BCTR  @01,0                                               1219
         BCTR  @01,0                                               1219
         LH    @15,VECTRDSP-10(@15,@01)                            1219
         AL    @15,FDTPTR-4(@05,@02)                               1219
         ST    @15,VECTRVAL(,@15)                                  1219
*                  ELSE                                            1220
*                                                                  1220
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* IF A DEFAULT CONSTANT IS PROVIDED TO @YL026UL*/
*                    /* BE ADDED TO THE FDT, THEN FIRST MOVE @YL026UL*/
*                    /* IT INTO A COMMAND BUFFER IN PREP.    @YL026UL*/
*                    /* FOR PARSING AND TRANSLATING IT.      @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*DOGRP75:            DO;                                   /*@YL026UL*/
         B     @RC01216                                            1220
@RF01216 DS    0H                                                  1220
DOGRP75  DS    0H                                                  1221
*                    AMTTOGET=DEFLTLEN+2*LENGTH(PSETLEN)+1;/*@YL026UL*/
*                                                                  1221
         LH    @02,PARMID                                          1221
         MH    @02,@CH00038                                        1221
         L     @01,PINFOPTR                                        1221
         AL    @01,@CF01818                                        1221
         L     @02,PARMPTR(@02,@01)                                1221
         LA    @15,5                                               1221
         SLR   @14,@14                                             1221
         IC    @14,DEFLTLEN+24(,@02)                               1221
         ALR   @15,@14                                             1221
         ST    @15,AMTTOGET                                        1221
*                    CALL IDCSAGP0(GDTTBL,AMTTOGET,BUFFPTR,        1222
*                           SPACEID,SETZERO);              /*@YL026UL*/
         ST    GDTPTR,@AL00001                                     1222
         LA    @02,AMTTOGET                                        1222
         ST    @02,@AL00001+4                                      1222
         LA    @02,BUFFPTR                                         1222
         ST    @02,@AL00001+8                                      1222
         L     @02,@PC00001+8                                      1222
         ST    @02,@AL00001+12                                     1222
         LA    @02,SETZERO                                         1222
         ST    @02,@AL00001+16                                     1222
         MVI   @AL00001+16,X'80'                                   1222
         L     @15,GDTGPL(,GDTPTR)                                 1222
         LA    @01,@AL00001                                        1222
         BALR  @14,@15                                             1222
*                    RESPECIFY RTNREG RSTD;                        1223
*                    TESTRC = RTNREG;                              1224
         LR    TESTRC,RTNREG                                       1224
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UL*/
*                                                                  1225
*                    IF TESTRC^=0                                  1226
*                      THEN                                        1226
         LTR   TESTRC,TESTRC                                       1226
         BZ    @RF01226                                            1226
*                        DO;                               /*@YL026UL*/
*                                                                  1227
*                        CALL FAILSPAC;                    /*@YL026UL*/
*                                                                  1228
         BAL   @14,FAILSPAC                                        1228
*                        RETURN;                           /*@YL026UL*/
@EL00015 DS    0H                                                  1229
@EF00015 DS    0H                                                  1229
@ER00015 LM    @14,@02,@SA00015                                    1229
         LM    @05,@06,@SA00015+20                                 1229
         LM    @08,@12,@SA00015+28                                 1229
         BR    @14                                                 1229
*                        END;                              /*@YL026UL*/
*                                                                  1230
*                      ELSE                                        1231
*                        PPLCBUF=BUFFPTR ;                 /*@YL026UL*/
@RF01226 L     @05,BUFFPTR                                         1231
         L     @02,PPLPTR                                          1231
         ST    @05,PPLCBUF(,@02)                                   1231
*                    PSETLEN=DEFLTLEN+LENGTH(CBUFF);       /*@YL026UL*/
         LA    @15,12                                              1232
         LR    @14,@15                                             1232
         MH    @14,PARMID                                          1232
         L     @01,PINFOPTR                                        1232
         AL    @01,@CF01818                                        1232
         L     @14,PARMPTR(@14,@01)                                1232
         LA    @01,24                                              1232
         ALR   @01,@14                                             1232
         SLR   @00,@00                                             1232
         IC    @00,DEFLTLEN(,@01)                                  1232
         LA    @02,4                                               1232
         ALR   @02,@00                                             1232
         STH   @02,PSETLEN(,@05)                                   1232
*                    PARMSET(1:DEFLTLEN)=                          1233
*                               DEFLTVAL(1:DEFLTLEN);      /*@YL026UL*/
*                                                                  1233
         BCTR  @00,0                                               1233
         LR    @02,@00                                             1233
         EX    @02,@SM01867                                        1233
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* USE THE DATA TYPE OF THE DEFAULT     @YL026UL*/
*                    /* CONSTANT TO SELECT A 'STANDARD' PCL  @YL026UL*/
*                    /* DESCRIBING A CONSTANT OF THAT TYPE.  @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    IF NUMBER=YES                                 1234
*                      THEN                                        1234
         ALR   @14,@15                                             1234
         TM    NUMBER(@14),B'10000000'                             1234
         BNO   @RF01234                                            1234
*                        PPLPCL=ADDR(NUMPCL);              /*@YL026UL*/
         L     @05,PPLPTR                                          1235
         L     @02,@CV01498                                        1235
         ST    @02,PPLPCL(,@05)                                    1235
*                      ELSE                                        1236
*                        IF ANYSTRNG=YES                           1236
*                          THEN                                    1236
         B     @RC01234                                            1236
@RF01234 LA    @05,12                                              1236
         LR    @02,@05                                             1236
         MH    @02,PARMID                                          1236
         L     @01,PINFOPTR                                        1236
         AL    @01,@CF01818                                        1236
         AL    @05,PARMPTR(@02,@01)                                1236
         TM    ANYSTRNG(@05),B'01000000'                           1236
         BNO   @RF01236                                            1236
*                            IF PWORDOPT=YES                       1237
*                              THEN                                1237
         TM    PWORDOPT(@05),B'00000010'                           1237
         BNO   @RF01237                                            1237
*                                PPLPCL=ADDR(DDNPCL);      /*@YL026UL*/
         L     @05,@CV01500                                        1238
         L     @02,PPLPTR                                          1238
         ST    @05,PPLPCL(,@02)                                    1238
*                              ELSE                                1239
*                                PPLPCL=ADDR(STRPCL);      /*@YL026UL*/
*                                                                  1239
         B     @RC01237                                            1239
@RF01237 L     @05,@CV01499                                        1239
         L     @02,PPLPTR                                          1239
         ST    @05,PPLPCL(,@02)                                    1239
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* PASS THE CONSTANT TO 'PARSE' TO BE   @YL026UL*/
*                    /* ENCODED.  IF PARSING IS UNSUCCESSFUL @YL026UL*/
*                    /* THEN DISCONTINUE PROCESSING.         @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    PARSECB=0;                            /*@YL026UL*/
*                                                                  1240
@RC01237 DS    0H                                                  1240
@RF01236 DS    0H                                                  1240
@RC01234 SLR   @05,@05                                             1240
         ST    @05,PARSECB                                         1240
*                    DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/         1241
*                      RESPECIFY GPR01P RSTD;                      1242
*                      GPR01P = ADDR(PPL);                         1243
         L     GPR01P,PPLPTR                                       1243
*                      IF CVTPARS = 0                              1244
*                        THEN                                      1244
         L     @02,CVTPTR                                          1244
         C     @05,CVTPARS(,@02)                                   1244
         BNE   @RF01244                                            1244
*                          GEN(LINK EP=IKJPARS);                   1245
         LINK EP=IKJPARS
*                        ELSE                                      1246
*                          CALL CVTPARS;                           1246
         B     @RC01244                                            1246
@RF01244 L     @05,CVTPTR                                          1246
         L     @15,CVTPARS(,@05)                                   1246
         BALR  @14,@15                                             1246
*                      RESPECIFY GPR01P UNRSTD;                    1247
@RC01244 DS    0H                                                  1248
*                    END;       /*@Z40GSJG*/                       1248
*                                                                  1248
*                    RESPECIFY RTNREG RSTD;                        1249
*                    TESTRC = RTNREG;                              1250
         LR    TESTRC,RTNREG                                       1250
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UL*/
*                                                                  1251
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF THE RETURN CODE FROM IKJPARS IS  @Z40GSJG*/
*                    /*  NON-ZERO, WE WERE UNABLE TO PARSE   @Z40GSJG*/
*                    /*  THE DEFAULT.  IF THE RETURN CODE    @Z40GSJG*/
*                    /*  INDICATES THAT THERE WAS NOT ENOUGH @Y30SSFR*/
*                    /*  STORAGE, CALL FAILSPACE TO HANDLE   @Y30SSFR*/
*                    /*  THE ERROR.  OTHERWISE, SET LASTCC   @Y30SSFR*/
*                    /*  TO 12.  RETURN TO THE CALLER.       @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF TESTRC^=0                                  1252
*                      THEN                                        1252
         LTR   TESTRC,TESTRC                                       1252
         BZ    @RF01252                                            1252
*                        DO;                               /*@YL026UL*/
*                        IF TESTRC=BADSPACE                        1254
*                          THEN                                    1254
*                                                                  1254
         C     TESTRC,@CF00487                                     1254
         BNE   @RF01254                                            1254
*                            CALL FAILSPAC;                /*@YL026UL*/
*                                                                  1255
         BAL   @14,FAILSPAC                                        1255
*                          ELSE                                    1256
*                            LASTCC=LASTCC12;              /*@YL026UL*/
         B     @RC01254                                            1256
@RF01254 L     @05,@PC00001+16                                     1256
         MVC   LASTCC(2,@05),@CH00038                              1256
*                        RETURN;                           /*@YL026UL*/
         B     @EL00015                                            1257
*                        END;                              /*@YL026UL*/
*                                                                  1258
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* TRANSLATE THE ENCODED DEFAULT VALUE  @YL026UL*/
*                    /* INTO AN FDT ENTRY.                   @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    SINGLPRM=YES;                         /*@YL026UL*/
*                                                                  1259
@RF01252 OI    SINGLPRM,B'01000000'                                1259
*                    CALL TRNSLATE;                        /*@YL026UL*/
*                                                                  1260
         BAL   @14,TRNSLATE                                        1260
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF TRNSLATE FAILS FOR SOME REASON,  @Y30SSFR*/
*                    /*  RETURN TO THE CALLER.               @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF LASTCC^=0                                  1261
*                      THEN                                        1261
         L     @05,@PC00001+16                                     1261
         LH    @05,LASTCC(,@05)                                    1261
         LTR   @05,@05                                             1261
         BNZ   @RT01261                                            1261
*                        RETURN;                           /*@YL026UL*/
*                    END DOGRP75;                          /*@YL026UL*/
*                                                                  1263
*                PARMID=SUPRPARM(PARMID);                  /*@YL026UL*/
@RC01216 LH    @05,PARMID                                          1264
         MH    @05,@CH00038                                        1264
         L     @02,PINFOPTR                                        1264
         AL    @02,@CF01819                                        1264
         LH    @05,SUPRPARM-8(@05,@02)                             1264
         STH   @05,PARMID                                          1264
*              END DOLOOP60;                               /*@YL026UL*/
@DE01214 LH    @05,PARMID                                          1265
         LTR   @05,@05                                             1265
         BZ    @DC01214                                            1265
         MH    @05,@CH00038                                        1265
         L     @02,PINFOPTR                                        1265
         BCTR  @02,0                                               1265
         BCTR  @02,0                                               1265
         SLR   @15,@15                                             1265
         IC    @15,PARMFLAG-10(@05,@02)                            1265
         C     @15,@CF00227                                        1265
         BE    @DL01214                                            1265
@DC01214 DS    0H                                                  1266
*            END DOGRP70;                                  /*@YL026UL*/
*                                                                  1266
*        END SETDFLT;                                      /*@YL026UL*/
*                                                                  1267
*                                                                  1267
         B     @EL00015                                            1267
*        END DEFAULTS;                                     /*@YL026UL*/
@EL00014 DS    0H                                                  1268
@EF00014 DS    0H                                                  1268
@ER00014 LM    @14,@02,@SA00014                                    1268
         LM    @05,@06,@SA00014+20                                 1268
         LM    @08,@12,@SA00014+28                                 1268
         BR    @14                                                 1268
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - NEEDPRMS                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE CHECKS FOR PARAMETERS WHICH ARE @YL026UL*/
*/*             REQUIRED FOR THE CURRENT SET OF PARAMETERS   @YL026UL*/
*/*             BEING PROCESSED, BUT WHICH ARE MISSING.  IF  @YL026UL*/
*/*             A PARM IS MISSING, THE USER IS SENT A MSG    @YL026UL*/
*/*             IDENTIFYING THE PARM AND REQUESTING THAT ITS @YL026UL*/
*/*             SUBFIELD BE ENTERED.  THE USER'S RESPONSE    @YL026UL*/
*/*             IS THEN PARSED AND TRANSLATED INTO FDT FORM  @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            PRMSETID- PARM ID# INDICATING WHETHER THE     @YL026UL*/
*/*                      MAIN SET OF PARMS OR A SUBLIST OF   @YL026UL*/
*/*                      PARMS ARE BEING PROCESSED.          @YL026UL*/
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            FDT -     NEW POINTER VECTOR AND DATA         @YL026UL*/
*/*                      SUBSTRUCTURE ENTRIES FOR THE NEW    @YL026UL*/
*/*                      DATA BEING ENTERED.                 @YL026UL*/
*/*            GOODCMD - FLAG INDICATING WHETHER OR NOT NEW  @YL026UL*/
*/*                      PARMS HAVE BEEN INPUT.              @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*NEEDPRMS:PROCEDURE;                                       /*@YL026UL*/
NEEDPRMS STM   @14,@02,@SA00016                                    1269
         STM   @05,@06,@SA00016+20                                 1269
         STM   @08,@12,@SA00016+28                                 1269
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** NEEDPRMS **  CHECK FOR MISSING PARAMETERS    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1270
         L     @05,GDTTR2(,GDTPTR)                                 1270
         MVC   @TS00001(95),NEWERID2(@05)                          1270
         MVC   OLDERID2(95,@05),@TS00001                           1270
*        NEWID2='RI38';                                    /*@YL026UL*/
*                                                                  1271
         MVC   NEWID2(4,@05),@CC01769                              1271
*        GOODCMD=YES;                                      /*@YL026UL*/
         OI    GOODCMD,B'00010000'                                 1272
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF CURRENTLY CHECKING THE MAIN SET OF PARMS,     @YL026UL*/
*        /* CHECK FOR MISSING PARAMETERS WHICH MUST BE CODED @YL026UL*/
*        /* WHENEVER THE COMMAND IS CODED.  REQUIRED PARMS   @YL026UL*/
*        /* ARE DESCRIBED IN A GROUP; AT LEAST ONE PARM IN   @YL026UL*/
*        /* EACH GROUP MUST BE CODED (A GROUP MAY CONSIST OF @YL026UL*/
*        /* JUST A SINGLE PARAMETER ID#).                    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF PRMSETID=0 & VNGRPDSP^=0                               1273
*          THEN                                                    1273
         LH    @05,PRMSETID                                        1273
         LTR   @05,@05                                             1273
         BNZ   @RF01273                                            1273
         L     @05,DESCPTR                                         1273
         CLI   VNGRPDSP(@05),0                                     1273
         BE    @RF01273                                            1273
*DOGRP80:    DO;                                           /*@YL026UL*/
DOGRP80  DS    0H                                                  1275
*              GRPPTR=ADDR(VNGRPTOT)+LENGTH(VNGRPTOT);     /*@YL026UL*/
         L     @02,DESCPTR                                         1275
         SLR   GRPPTR,GRPPTR                                       1275
         IC    GRPPTR,VNGRPDSP(,@02)                               1275
         ALR   GRPPTR,GRPPTR                                       1275
         ALR   @02,GRPPTR                                          1275
         AL    @02,@CF00161                                        1275
         LR    GRPPTR,@02                                          1275
*              DO INDEX9=1 TO VNGRPTOT;                    /*@YL026UL*/
         LA    @05,1                                               1276
         B     @DE01276                                            1276
@DL01276 DS    0H                                                  1277
*                FOUND=NO;                                 /*@YL026UL*/
         NI    FOUND,B'11111101'                                   1277
*                DO INDEX10=1 TO VNGRPCNT;                 /*@YL026UL*/
         LA    @05,1                                               1278
         B     @DE01278                                            1278
@DL01278 DS    0H                                                  1279
*                  IF PARMFLAG(VNGRPID(INDEX10))=INPUT             1279
*                    THEN                                          1279
         ALR   @05,@05                                             1279
         LH    @05,VNGRPID-2(@05,GRPPTR)                           1279
         MH    @05,@CH00038                                        1279
         L     @02,PINFOPTR                                        1279
         BCTR  @02,0                                               1279
         BCTR  @02,0                                               1279
         SLR   @15,@15                                             1279
         IC    @15,PARMFLAG-10(@05,@02)                            1279
         C     @15,@CF00161                                        1279
         BNE   @RF01279                                            1279
*                      FOUND=YES;                          /*@YL026UL*/
         OI    FOUND,B'00000010'                                   1280
*                END;                                      /*@YL026UL*/
*                                                                  1281
@RF01279 LA    @05,1                                               1281
         AH    @05,INDEX10                                         1281
@DE01278 STH   @05,INDEX10                                         1281
         CH    @05,VNGRPCNT(,GRPPTR)                               1281
         BNH   @DL01278                                            1281
*                /****************************************************/
*                /*                                          @YL026UL*/
*                /* IF NO PARMS IN A GROUP HAVE BEEN CODED,  @YL026UL*/
*                /* PROMPT FOR THE SUBFIELD OF THE 1ST PARM  @YL026UL*/
*                /* IDENTIFIED IN THE GROUP.                 @YL026UL*/
*                /*                                          @YL026UL*/
*                /****************************************************/
*                IF FOUND=NO                                       1282
*                  THEN                                            1282
         TM    FOUND,B'00000010'                                   1282
         BNZ   @RF01282                                            1282
*                    DO;                                   /*@YL026UL*/
*                    SUPERID=VNGRPID(1);                   /*@YL026UL*/
*                                                                  1284
         LH    @05,VNGRPID(,GRPPTR)                                1284
         STH   @05,SUPERID                                         1284
*                    CALL ADDPARM;                         /*@YL026UL*/
*                                                                  1285
         BAL   @14,ADDPARM                                         1285
*                    IF LASTCC^=0                                  1286
*                      THEN                                        1286
         L     @05,@PC00001+16                                     1286
         LH    @05,LASTCC(,@05)                                    1286
         LTR   @05,@05                                             1286
         BNZ   @RT01286                                            1286
*                        RETURN;                           /*@YL026UL*/
*                    END;                                  /*@YL026UL*/
*                GRPPTR=GRPPTR+LENGTH(VNGRPCNT)+                   1289
*                     VNGRPCNT*LENGTH(VNGRPID);            /*@YL026UL*/
@RF01282 LA    @05,2                                               1289
         ALR   @05,GRPPTR                                          1289
         LH    @02,VNGRPCNT(,GRPPTR)                               1289
         ALR   @02,@02                                             1289
         ALR   @05,@02                                             1289
         LR    GRPPTR,@05                                          1289
*              END;                                        /*@YL026UL*/
*                                                                  1290
         LA    @05,1                                               1290
         AH    @05,INDEX9                                          1290
@DE01276 STH   @05,INDEX9                                          1290
         L     @02,DESCPTR                                         1290
         SLR   @15,@15                                             1290
         IC    @15,VNGRPDSP(,@02)                                  1290
         ALR   @15,@15                                             1290
         AL    @15,DESCPTR                                         1290
         CH    @05,VNGRPTOT(,@15)                                  1290
         BNH   @DL01276                                            1290
*            END DOGRP80;                                  /*@YL026UL*/
*                                                                  1291
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* CHECK EACH PARAMETER THAT WAS CODED FOR THE      @YL026UL*/
*        /* CURRENT SET OF PARMS BEING PROCESSED.  IF A      @YL026UL*/
*        /* PARAMETER HAS OTHER PARMS WHICH IT REQUIRES      @YL026UL*/
*        /* WHENEVER IT'S CODED, THEN CHECK THAT AT LEAST    @YL026UL*/
*        /* ONE PARM IN EACH 'NEED GROUP' HAS BEEN INPUT.    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DO PARMID=1 TO MAXID;                             /*@YL026UL*/
@RF01273 LA    @05,1                                               1292
         B     @DE01292                                            1292
@DL01292 DS    0H                                                  1293
*          IF PARMFLAG(PARMID)=INPUT & NGRPDSPL^=0                 1293
*            THEN                                                  1293
         L     @02,PINFOPTR                                        1293
         MH    @05,@CH00038                                        1293
         LA    @01,0(@05,@02)                                      1293
         BCTR  @01,0                                               1293
         BCTR  @01,0                                               1293
         SLR   @00,@00                                             1293
         IC    @00,PARMFLAG-10(,@01)                               1293
         C     @00,@CF00161                                        1293
         BNE   @RF01293                                            1293
         AL    @02,@CF01818                                        1293
         L     @05,PARMPTR(@05,@02)                                1293
         CLI   NGRPDSPL(@05),0                                     1293
         BE    @RF01293                                            1293
*DOGRP85:      DO;                                         /*@YL026UL*/
DOGRP85  DS    0H                                                  1295
*                GRPPTR=ADDR(NGRPTOT)+LENGTH(NGRPTOT);     /*@YL026UL*/
         LH    @02,PARMID                                          1295
         MH    @02,@CH00038                                        1295
         L     @01,PINFOPTR                                        1295
         AL    @01,@CF01818                                        1295
         L     @02,PARMPTR(@02,@01)                                1295
         SLR   GRPPTR,GRPPTR                                       1295
         IC    GRPPTR,NGRPDSPL(,@02)                               1295
         ALR   GRPPTR,GRPPTR                                       1295
         ALR   @02,GRPPTR                                          1295
         AL    @02,@CF00161                                        1295
         LR    GRPPTR,@02                                          1295
*                DO INDEX9=1 TO NGRPTOT;                   /*@YL026UL*/
         LA    @05,1                                               1296
         B     @DE01296                                            1296
@DL01296 DS    0H                                                  1297
*                  FOUND=NO;                               /*@YL026UL*/
         NI    FOUND,B'11111101'                                   1297
*                  DO INDEX10=1 TO NGRPCNT;                /*@YL026UL*/
         LA    @05,1                                               1298
         B     @DE01298                                            1298
@DL01298 DS    0H                                                  1299
*                    IF PARMFLAG(NGRPID(INDEX10))=INPUT            1299
*                      THEN                                        1299
         ALR   @05,@05                                             1299
         LH    @05,NGRPID-2(@05,GRPPTR)                            1299
         MH    @05,@CH00038                                        1299
         L     @02,PINFOPTR                                        1299
         BCTR  @02,0                                               1299
         BCTR  @02,0                                               1299
         SLR   @15,@15                                             1299
         IC    @15,PARMFLAG-10(@05,@02)                            1299
         C     @15,@CF00161                                        1299
         BNE   @RF01299                                            1299
*                        FOUND=YES;                        /*@YL026UL*/
         OI    FOUND,B'00000010'                                   1300
*                  END;                                    /*@YL026UL*/
*                                                                  1301
@RF01299 LA    @05,1                                               1301
         AH    @05,INDEX10                                         1301
@DE01298 STH   @05,INDEX10                                         1301
         CH    @05,NGRPCNT(,GRPPTR)                                1301
         BNH   @DL01298                                            1301
*                  /**************************************************/
*                  /*                                        @YL026UL*/
*                  /* IF NO PARMS IN A GROUP HAVE BEEN       @YL026UL*/
*                  /* CODED, PROMPT FOR THE SUBFIELD OF THE  @YL026UL*/
*                  /* 1ST PARM IDENTIFIED IN THE GROUP.      @YL026UL*/
*                  /*                                        @YL026UL*/
*                  /**************************************************/
*                  IF FOUND=NO                                     1302
*                    THEN                                          1302
         TM    FOUND,B'00000010'                                   1302
         BNZ   @RF01302                                            1302
*                      DO;                                 /*@YL026UL*/
*                      SUPERID=NGRPID(1);                  /*@YL026UL*/
*                                                                  1304
         LH    @05,NGRPID(,GRPPTR)                                 1304
         STH   @05,SUPERID                                         1304
*                      CALL ADDPARM;                       /*@YL026UL*/
*                                                                  1305
         BAL   @14,ADDPARM                                         1305
*                      IF LASTCC^=0                                1306
*                        THEN                                      1306
         L     @05,@PC00001+16                                     1306
         LH    @05,LASTCC(,@05)                                    1306
         LTR   @05,@05                                             1306
         BNZ   @RT01306                                            1306
*                          RETURN;                         /*@YL026UL*/
*                      END;                                /*@YL026UL*/
*                  GRPPTR=GRPPTR+LENGTH(NGRPCNT)+                  1309
*                      NGRPCNT*LENGTH(NGRPID);             /*@YL026UL*/
@RF01302 LA    @05,2                                               1309
         ALR   @05,GRPPTR                                          1309
         LH    @02,NGRPCNT(,GRPPTR)                                1309
         ALR   @02,@02                                             1309
         ALR   @05,@02                                             1309
         LR    GRPPTR,@05                                          1309
*                END;                                      /*@YL026UL*/
         LA    @05,1                                               1310
         AH    @05,INDEX9                                          1310
@DE01296 STH   @05,INDEX9                                          1310
         LH    @02,PARMID                                          1310
         MH    @02,@CH00038                                        1310
         LH    @15,PARMID                                          1310
         MH    @15,@CH00038                                        1310
         L     @01,PINFOPTR                                        1310
         AL    @01,@CF01818                                        1310
         L     @01,PARMPTR(@15,@01)                                1310
         SLR   @15,@15                                             1310
         IC    @15,NGRPDSPL(,@01)                                  1310
         ALR   @15,@15                                             1310
         L     @14,PINFOPTR                                        1310
         AL    @14,@CF01818                                        1310
         AL    @15,PARMPTR(@02,@14)                                1310
         CH    @05,NGRPTOT(,@15)                                   1310
         BNH   @DL01296                                            1310
*              END DOGRP85;                                /*@YL026UL*/
*        END;                                              /*@YL026UL*/
*                                                                  1312
@RF01293 LA    @05,1                                               1312
         AH    @05,PARMID                                          1312
@DE01292 STH   @05,PARMID                                          1312
         L     @02,DESCPTR                                         1312
         CH    @05,MAXID(,@02)                                     1312
         BNH   @DL01292                                            1312
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - ADDPARM                                @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SENDS A MESSAGE TO THE TERMINAL @YL026UL*/
*/*             USER TELLING HIM THAT A PARM IS MISSING      @YL026UL*/
*/*             BUT IS REQUIRED.  THE USER IS THEN PROMPTED  @YL026UL*/
*/*             TO ENTER THE SUBFIELD OF THE MISSING PARM.   @YL026UL*/
*/*             A PCL IS OBTAINED (FROM THE DESCRIPTOR OR    @YL026UL*/
*/*             FROM THE SET OF 'STANDARD' PCLS) DESCRIBING  @YL026UL*/
*/*             JUST THE SET OF SUBPARMS THAT WERE PROMPTED  @YL026UL*/
*/*             FOR, AND THIS IS SENT TO 'PARSE' TOGETHER    @YL026UL*/
*/*             WITH THE USER'S REPLY.  THE ENCODED SET OF   @YL026UL*/
*/*             PARMS IS THEN ADDED TO THE FDT.              @YL026UL*/
*/*             IF THE MISSING PARM HAS NO SUBFIELD, IT IS   @YL026UL*/
*/*             SIMPLY ADDED TO THE FDT AS IF IT WERE INPUT. @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            SUPERID - ID# OF THE MISSING PARAMETER.       @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/
*/*            GOODCMD - FLAG SET 'OFF' TO NOTE THAT NEW     @YL026UL*/
*/*                      PARAMETERS ARE BEING ADDED.         @YL026UL*/
*/*            FDT -     ENCODED DATA ENTRIES FOR THE PARMS  @YL026UL*/
*/*                      BEING ADDED.                        @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*ADDPARM:PROCEDURE;                                        /*@YL026UL*/
         B     @PB00017                                            1313
ADDPARM  STM   @14,@02,@SA00017                                    1313
         STM   @04,@06,@SA00017+20                                 1313
         STM   @08,@12,@SA00017+32                                 1313
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** ADDPARM **  DATA DEFINITIONS                 @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1314
*        DCL MISSING  FIXED(15)        /*ERROR MSG ID FOR A  @YL026UL*/
*                     CONSTANT(6);     /*MISSING PARM        @YL026UL*/
*        DCL NOPMISS FIXED(15) CONSTANT(17);               /*@Y30SSFR*/
*                                      /*MSG ID FOR MISSING  @Y30SSFR*/
*                                      /*PARM IN NOPROMPT    @Y30SSFR*/
*                                      /*CASE                @Y30SSFR*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** ADDPARM **  PROMPT FOR A MISSING PARAMETER   @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1316
         L     @02,GDTTR2(,GDTPTR)                                 1316
         MVC   @TS00001(95),NEWERID2(@02)                          1316
         MVC   OLDERID2(95,@02),@TS00001                           1316
*        NEWID2='RI40';                                    /*@YL026UL*/
*                                                                  1317
         MVC   NEWID2(4,@02),@CC01781                              1317
*        GOODCMD=NO;                                       /*@YL026UL*/
         NI    GOODCMD,B'11101111'                                 1318
*        INDEX10=PARMID;                                   /*@YL026UL*/
         LH    @02,PARMID                                          1319
         STH   @02,INDEX10                                         1319
*        PARMID=SUPERID;                                   /*@YL026UL*/
*                                                                  1320
         LH    @02,SUPERID                                         1320
         STH   @02,PARMID                                          1320
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE REQUIRED MISSING PARAMETER IS A KEYWORD   @YL026UL*/
*        /* WITH NO SUBFIELD, JUST ADD THE PARAMETER TO THE  @YL026UL*/
*        /* FDT AS IF IT HAD BEEN CODED.                     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF SUBLIST=NO & SCLRDATA=NO                               1321
*          THEN                                                    1321
         L     @15,PINFOPTR                                        1321
         LR    @14,@02                                             1321
         MH    @14,@CH00038                                        1321
         LA    @01,0(@14,@15)                                      1321
         AL    @01,@CF01818                                        1321
         L     @01,PARMPTR(,@01)                                   1321
         TM    SUBLIST(@01),B'10000010'                            1321
         BNZ   @RF01321                                            1321
*            DO;                                           /*@YL026UL*/
*            PARMFLAG(PARMID)=INPUT;                       /*@YL026UL*/
         LA    @05,2                                               1323
         LA    @04,0(@14,@15)                                      1323
         BCTR  @04,0                                               1323
         BCTR  @04,0                                               1323
         STC   @05,PARMFLAG-10(,@04)                               1323
*            IF OCCURNUM=1                                         1324
*              THEN                                                1324
         AL    @15,@CF01818                                        1324
         L     @01,PARMPTR(@14,@15)                                1324
         CLC   OCCURNUM(3,@01),@CF00227+1                          1324
         BNE   @RF01324                                            1324
*                FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));      /*@YL026UL*/
         SLA   @02,2                                               1325
         L     @15,@PC00001+4                                      1325
         L     @15,FDTADDR(,@15)                                   1325
         LA    @14,FDTPTR-4(@02,@15)                               1325
         ST    @14,FDTPTR-4(@02,@15)                               1325
*              ELSE                                                1326
*                VECTRVAL=ADDR(VECTRVAL);                  /*@YL026UL*/
         B     @RC01324                                            1326
@RF01324 LH    @02,PARMID                                          1326
         SLA   @02,2                                               1326
         L     @15,@PC00001+4                                      1326
         L     @01,FDTADDR(,@15)                                   1326
         LH    @15,REPINDEX                                        1326
         MH    @15,@CH00038                                        1326
         L     @14,RSIPTR                                          1326
         BCTR  @14,0                                               1326
         BCTR  @14,0                                               1326
         LH    @15,VECTRDSP-10(@15,@14)                            1326
         AL    @15,FDTPTR-4(@02,@01)                               1326
         ST    @15,VECTRVAL(,@15)                                  1326
*            PARMID=INDEX10;                               /*@YL026UL*/
@RC01324 LH    @02,INDEX10                                         1327
         STH   @02,PARMID                                          1327
*            RETURN;                                       /*@YL026UL*/
@EL00017 DS    0H                                                  1328
@EF00017 DS    0H                                                  1328
@ER00017 LM    @14,@02,@SA00017                                    1328
         LM    @04,@06,@SA00017+20                                 1328
         LM    @08,@12,@SA00017+32                                 1328
         BR    @14                                                 1328
*            END;                                          /*@YL026UL*/
*                                                                  1329
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE MISSING PARAMETER IS DEFINED WITHIN A     @YL026UL*/
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/
*        /* WHICH REPETITION NEEDS THE PARAMETER.            @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF OCCURNUM > 1                                           1330
*          THEN                                                    1330
@RF01321 LA    @02,12                                              1330
         LR    @15,@02                                             1330
         MH    @15,PARMID                                          1330
         L     @01,PINFOPTR                                        1330
         AL    @01,@CF01818                                        1330
         L     @01,PARMPTR(@15,@01)                                1330
         CLC   OCCURNUM(3,@01),@CF00227+1                          1330
         BNH   @RF01330                                            1330
*            DO;                                           /*@YL026UL*/
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/
         MH    @02,REPINDEX                                        1332
         L     @01,RSIPTR                                          1332
         AL    @01,@CF01819                                        1332
         SLR   @00,@00                                             1332
         IC    @00,SBLSTNUM-8(@02,@01)                             1332
         ST    @00,EFIELD3                                         1332
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/
         L     @02,DDSTRU                                          1333
         LA    @15,EFIELD3                                         1333
         ST    @15,DARGDBP(,@02)                                   1333
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/
         MVC   DARGILP(2,@02),@CH00050                             1334
*            DARGSENT=INREP;                               /*@YL026UL*/
*                                                                  1335
         MVI   DARGSENT(@02),X'0F'                                 1335
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/
*                                                                  1336
         ST    GDTPTR,@AL00001                                     1336
         LA    @02,@CF00123                                        1336
         ST    @02,@AL00001+4                                      1336
         LA    @02,DDSTRU                                          1336
         ST    @02,@AL00001+8                                      1336
         MVI   @AL00001+8,X'80'                                    1336
         L     @15,GDTPRT(,GDTPTR)                                 1336
         LA    @01,@AL00001                                        1336
         BALR  @14,@15                                             1336
*            END;                                          /*@YL026UL*/
*                                                                  1337
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* OBTAIN A FORMATTED, STATIC TEXT MESSAGE WHICH    @YL026UL*/
*        /* IDENTIFIES THE MISSING REQUIRED PARAMETER AND    @YL026UL*/
*        /* USE IT TO PROMPT FOR THE PARM'S SUBFIELD.        @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        EFIELD1=BLANK;                                    /*@YL026UL*/
*                                                                  1338
@RF01330 MVI   EFIELD1+1,C' '                                      1338
         MVC   EFIELD1+2(18),EFIELD1+1                             1338
         MVI   EFIELD1,C' '                                        1338
*        CALL MSGKWD(SUPERID,ADDR(EFIELD1));               /*@YL026UL*/
*                                                                  1339
         LA    @02,SUPERID                                         1339
         ST    @02,@AL00001                                        1339
         LA    @02,EFIELD1                                         1339
         ST    @02,@AFTEMPS+20                                     1339
         LA    @02,@AFTEMPS+20                                     1339
         ST    @02,@AL00001+4                                      1339
         LA    @01,@AL00001                                        1339
         BAL   @14,MSGKWD                                          1339
*        DARGDBP=ADDR(EFIELD);                             /*@YL026UL*/
         L     @04,DDSTRU                                          1340
         LA    @02,EFIELD                                          1340
         ST    @02,DARGDBP(,@04)                                   1340
*        DARGILP=LENGTH(EFIELD1);                          /*@YL026UL*/
         MVC   DARGILP(2,@04),@CH01449                             1341
*        DARGSENT=MISSING;                                 /*@YL026UL*/
         MVI   DARGSENT(@04),X'06'                                 1342
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/
         LA    @02,MSGBUFF                                         1343
         ST    @02,DARGRETP(,@04)                                  1343
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/
*                                                                  1344
         MVC   DARGRETL(2,@04),@CH01454                            1344
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1345
         ST    GDTPTR,@AL00001                                     1345
         LA    @04,@CF00123                                        1345
         ST    @04,@AL00001+4                                      1345
         LA    @04,DDSTRU                                          1345
         ST    @04,@AL00001+8                                      1345
         MVI   @AL00001+8,X'80'                                    1345
         L     @15,GDTPRT(,GDTPTR)                                 1345
         LA    @01,@AL00001                                        1345
         BALR  @14,@15                                             1345
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/
         L     @04,DDSTRU                                          1346
         L     @02,DARGRETP(,@04)                                  1346
         ST    @02,PMSGPTR                                         1346
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/
         LH    @02,DARGRETL(,@04)                                  1347
         STH   @02,PMSGLEN                                         1347
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/
         SLR   @02,@02                                             1348
         ST    @02,DARGRETP(,@04)                                  1348
*        DARGRETL=0;                                       /*@YL026UL*/
*                                                                  1349
         STH   @02,DARGRETL(,@04)                                  1349
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ISSUE A UPROMPT TO PROMPT FOR THE MISSING       @Y30SSFR*/
*        /*  PARAMETER.  IF THE RETURN CODE FROM UPROMPT IS  @Y30SSFR*/
*        /*  NON-ZERO, THEN ISSUE A SPECIAL MESSAGE TO THE   @Y30SSFR*/
*        /*  USER IF PROFILE(NOPROMPT) HAS BEEN SPECIFIED.   @Y30SSFR*/
*        /*  SET LASTCC TO 12 AND RETURN TO THE CALLER.      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*  1350
*                                                            #YL026UL*/
         ST    GDTPTR,@AL00001                                     1350
         LA    @04,PMSGPTR                                         1350
         ST    @04,@AL00001+4                                      1350
         LA    @04,PMSGLEN                                         1350
         ST    @04,@AL00001+8                                      1350
         LA    @04,RPLYPTR                                         1350
         ST    @04,@AL00001+12                                     1350
         LA    @04,RPLYLEN                                         1350
         ST    @04,@AL00001+16                                     1350
         MVI   @AL00001+16,X'80'                                   1350
         L     @15,GDTPMT(,GDTPTR)                                 1350
         LA    @01,@AL00001                                        1350
         BALR  @14,@15                                             1350
*        RESPECIFY RTNREG RSTD;                                    1351
*        TESTRC = RTNREG;                                          1352
         LR    TESTRC,RTNREG                                       1352
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  1353
*        IF TESTRC=LASTCC08                                /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         C     TESTRC,@CF00187                                     1354
         BNE   @RF01354                                            1354
*            DO;                                           /*@Y30SSFR*/
*                                                                  1355
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  THE NOPROMPT OPTION IS IN EFFECT.  PRINT    @Y30SSFR*/
*            /*  A MESSAGE INDICATING THAT A KEYWORD IS      @Y30SSFR*/
*            /*  MISSING, AND RETURN.                        @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1356
*            DARGSENT=NOPMISS;                             /*@Y30SSFR*/
         L     @02,DDSTRU                                          1356
         MVI   DARGSENT(@02),X'11'                                 1356
*            DARGILP=LENGTH(EFIELD1);                      /*@Y30SSFR*/
         MVC   DARGILP(2,@02),@CH01449                             1357
*            DARGDBP=ADDR(EFIELD);                         /*@Y30SSFR*/
*                                                                  1358
         LA    @15,EFIELD                                          1358
         ST    @15,DARGDBP(,@02)                                   1358
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@Y30SSFR*/
*                                                                  1359
         ST    GDTPTR,@AL00001                                     1359
         LA    @02,@CF00123                                        1359
         ST    @02,@AL00001+4                                      1359
         LA    @02,DDSTRU                                          1359
         ST    @02,@AL00001+8                                      1359
         MVI   @AL00001+8,X'80'                                    1359
         L     @15,GDTPRT(,GDTPTR)                                 1359
         LA    @01,@AL00001                                        1359
         BALR  @14,@15                                             1359
*            LASTCC=LASTCC12;                              /*@Y30SSFR*/
         L     @02,@PC00001+16                                     1360
         MVC   LASTCC(2,@02),@CH00038                              1360
*            RETURN;                                       /*@Y30SSFR*/
         B     @EL00017                                            1361
*            END;                                          /*@Y30SSFR*/
*          ELSE                                            /*@Y30SSFR*/
*            IF TESTRC^=0                                  /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
@RF01354 LTR   TESTRC,TESTRC                                       1363
         BZ    @RF01363                                            1363
*                DO;                                       /*@Y30SSFR*/
*                LASTCC=LASTCC12;                          /*@Y30SSFR*/
         L     @02,@PC00001+16                                     1365
         MVC   LASTCC(2,@02),@CH00038                              1365
*                RETURN;                                   /*@Y30SSFR*/
         B     @EL00017                                            1366
*                END;                                      /*@Y30SSFR*/
*                                                                  1367
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SET UP THE PARSE PARM LIST.  SELECT A PCL THAT   @YL026UL*/
*        /* DESCRIBES JUST THE PARMS WHICH WERE PROMPTED     @YL026UL*/
*        /* FOR.  IF THE SUBFIELD IS A SUBPARM LIST, A PCL   @YL026UL*/
*        /* IS PROVIDED IN THE DESCRIPTOR; OTHERWISE, USE A  @YL026UL*/
*        /* 'STANDARD' PCL SELECTED ON THE BASIS OF THE      @YL026UL*/
*        /* DATA TYPE OF THE SUBFIELD.                       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PPLCBUF=RPLYPTR;                                  /*@YL026UL*/
@RF01363 L     @02,RPLYPTR                                         1368
         L     @01,PPLPTR                                          1368
         ST    @02,PPLCBUF(,@01)                                   1368
*        PARSECB=0;                                        /*@YL026UL*/
         SLR   @02,@02                                             1369
         ST    @02,PARSECB                                         1369
*        SINGLPRM=YES;                                     /*@YL026UL*/
         OI    SINGLPRM,B'01000000'                                1370
*        IF SUBLIST=YES                                            1371
*          THEN                                                    1371
         L     @02,PINFOPTR                                        1371
         LH    @15,PARMID                                          1371
         LR    @14,@15                                             1371
         MH    @14,@CH00038                                        1371
         LA    @01,0(@14,@02)                                      1371
         AL    @01,@CF01818                                        1371
         L     @05,PARMPTR(,@01)                                   1371
         TM    SUBLIST(@05),B'00000010'                            1371
         BNO   @RF01371                                            1371
*            IF REPEATED=NO                                        1372
*              THEN                                                1372
         TM    REPEATED(@05),B'00100000'                           1372
         BNZ   @RF01372                                            1372
*                /****************************************************/
*                /*                                          @YL026UL*/
*                /* IF THE MISSING PARM HAS A SUBPARM LIST,  @YL026UL*/
*                /* THEN FIRST ADD THE PARM ITSELF TO THE    @YL026UL*/
*                /* FDT AND PARM OCCURRENCE TABLE.           @YL026UL*/
*                /*                                          @YL026UL*/
*                /****************************************************/
*                DO;                                       /*@YL026UL*/
*                PARMFLAG(PARMID)=INPUT;                   /*@YL026UL*/
         LA    @05,2                                               1374
         LA    @04,0(@14,@02)                                      1374
         BCTR  @04,0                                               1374
         BCTR  @04,0                                               1374
         STC   @05,PARMFLAG-10(,@04)                               1374
*                IF OCCURNUM=1                                     1375
*                  THEN                                            1375
         AL    @02,@CF01818                                        1375
         L     @02,PARMPTR(@14,@02)                                1375
         CLC   OCCURNUM(3,@02),@CF00227+1                          1375
         BNE   @RF01375                                            1375
*                    FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));  /*@YL026UL*/
         SLA   @15,2                                               1376
         L     @02,@PC00001+4                                      1376
         L     @02,FDTADDR(,@02)                                   1376
         LA    @14,FDTPTR-4(@15,@02)                               1376
         ST    @14,FDTPTR-4(@15,@02)                               1376
*                  ELSE                                            1377
*                    VECTRVAL=ADDR(VECTRVAL);              /*@YL026UL*/
         B     @RC01375                                            1377
@RF01375 LH    @02,PARMID                                          1377
         SLA   @02,2                                               1377
         L     @15,@PC00001+4                                      1377
         L     @01,FDTADDR(,@15)                                   1377
         LH    @15,REPINDEX                                        1377
         MH    @15,@CH00038                                        1377
         L     @14,RSIPTR                                          1377
         BCTR  @14,0                                               1377
         BCTR  @14,0                                               1377
         LH    @15,VECTRDSP-10(@15,@14)                            1377
         AL    @15,FDTPTR-4(@02,@01)                               1377
         ST    @15,VECTRVAL(,@15)                                  1377
*                SINGLPRM=NO;                              /*@YL026UL*/
@RC01375 NI    SINGLPRM,B'10111111'                                1378
*                PPLPCL=DESCPTR+PCLDSPL2;                  /*@YL026UL*/
         LA    @02,12                                              1379
         LR    @15,@02                                             1379
         MH    @15,PARMID                                          1379
         L     @01,PINFOPTR                                        1379
         AL    @01,@CF01818                                        1379
         AL    @02,PARMPTR(@15,@01)                                1379
         LH    @02,PCLDSPL2(,@02)                                  1379
         N     @02,@CF01822                                        1379
         AL    @02,DESCPTR                                         1379
         L     @01,PPLPTR                                          1379
         ST    @02,PPLPCL(,@01)                                    1379
*                END;                                      /*@YL026UL*/
*              ELSE                                                1381
*                PPLPCL=ADDR(REPPCL);                      /*@YL026UL*/
         B     @RC01372                                            1381
@RF01372 L     @02,@CV01509                                        1381
         L     @01,PPLPTR                                          1381
         ST    @02,PPLPCL(,@01)                                    1381
*          ELSE                                                    1382
*                                                                  1382
*            /********************************************************/
*            /*                                              @YL026UL*/
*            /* IF THE SUBFIELD IS A SINGLE CONSTANT, SELECT @YL026UL*/
*            /* A 'STANDARD' PCL BASED UPON THE DATA TYPE    @YL026UL*/
*            /* OF THAT CONSTANT.                            @YL026UL*/
*            /*                                              @YL026UL*/
*            /********************************************************/
*                                                                  1382
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THE PARAMETER TO BE OBTAINED IS A        @Y30SSFR*/
*            /*  NUMBER, PROMPT FOR A NUMBER.                @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            IF NUMBER=YES                                         1382
*              THEN                                                1382
         B     @RC01371                                            1382
@RF01371 LA    @02,12                                              1382
         LR    @15,@02                                             1382
         MH    @15,PARMID                                          1382
         L     @01,PINFOPTR                                        1382
         AL    @01,@CF01818                                        1382
         AL    @02,PARMPTR(@15,@01)                                1382
         TM    NUMBER(@02),B'10000000'                             1382
         BNO   @RF01382                                            1382
*                PPLPCL=ADDR(NUMPCL);                      /*@YL026UL*/
         L     @02,@CV01498                                        1383
         L     @01,PPLPTR                                          1383
         ST    @02,PPLPCL(,@01)                                    1383
*              ELSE                                                1384
*                                                                  1384
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  IF THE DESIRED PARAMETER IS ANYTHING    @Y30SSFR*/
*                /*  OTHER THAN A DATA SET NAME, THEN        @Y30SSFR*/
*                /*  PROMPT FOR IT AS A DDNAME IF A PASS-    @Y30SSFR*/
*                /*  WORD CAN BE SPECIFIED AND AS A GENERAL  @Y30SSFR*/
*                /*  STRING OTHERWISE.                       @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                IF ANYSTRNG=YES                                   1384
*                  THEN                                            1384
         B     @RC01382                                            1384
@RF01382 LA    @02,12                                              1384
         LR    @15,@02                                             1384
         MH    @15,PARMID                                          1384
         L     @01,PINFOPTR                                        1384
         AL    @01,@CF01818                                        1384
         AL    @02,PARMPTR(@15,@01)                                1384
         TM    ANYSTRNG(@02),B'01000000'                           1384
         BNO   @RF01384                                            1384
*                    IF PWORDOPT=YES                               1385
*                      THEN                                        1385
         TM    PWORDOPT(@02),B'00000010'                           1385
         BNO   @RF01385                                            1385
*                        PPLPCL=ADDR(DDNPCL );             /*@YL026UL*/
         L     @02,@CV01500                                        1386
         L     @01,PPLPTR                                          1386
         ST    @02,PPLPCL(,@01)                                    1386
*                      ELSE                                        1387
*                        PPLPCL=ADDR(STRPCL );             /*@YL026UL*/
*                                                                  1387
         B     @RC01385                                            1387
@RF01385 L     @02,@CV01499                                        1387
         L     @01,PPLPTR                                          1387
         ST    @02,PPLPCL(,@01)                                    1387
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  PROMPT FOR A DATA SET NAME.           @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                  ELSE                                            1388
*                    DO;                                   /*@YL026UL*/
*                                                                  1388
         B     @RC01384                                            1388
@RF01384 DS    0H                                                  1389
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF GENERIC NAMES ARE ALLOWED PROMPT @Y30SSFR*/
*                    /*  FOR ONE.  CHOOSE THE PROPER PCL ON  @Y30SSFR*/
*                    /*  THE BASIS OF WHETHER VOLSERS ARE    @Y30SSFR*/
*                    /*  ACCEPTABLE.                         @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF GENERIC=YES                                1389
*                      THEN                                        1389
         LA    @02,12                                              1389
         LR    @15,@02                                             1389
         MH    @15,PARMID                                          1389
         L     @01,PINFOPTR                                        1389
         AL    @01,@CF01818                                        1389
         AL    @02,PARMPTR(@15,@01)                                1389
         TM    GENERIC(@02),B'00010000'                            1389
         BNO   @RF01389                                            1389
*                        IF VOLID=YES                              1390
*                          THEN                                    1390
         TM    VOLID(@02),B'00001000'                              1390
         BNO   @RF01390                                            1390
*                            PPLPCL=ADDR(DSGVPCL );        /*@YL026UL*/
         L     @02,@CV01504                                        1391
         L     @01,PPLPTR                                          1391
         ST    @02,PPLPCL(,@01)                                    1391
*                          ELSE                                    1392
*                            PPLPCL=ADDR(DSGPCL );         /*@YL026UL*/
         B     @RC01390                                            1392
@RF01390 L     @02,@CV01503                                        1392
         L     @01,PPLPTR                                          1392
         ST    @02,PPLPCL(,@01)                                    1392
*                      ELSE                                        1393
*                                                                  1393
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  GENERIC NAMES ARE NOT ALLOWED.    @Y30SSFR*/
*                      /*  CHOOSE THE PCL ON THE BASIS OF    @Y30SSFR*/
*                      /*  THE ACCEPTABILITY OF VOLSERS.     @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                        IF VOLID=YES                              1393
*                          THEN                                    1393
         B     @RC01389                                            1393
@RF01389 LA    @02,12                                              1393
         LR    @15,@02                                             1393
         MH    @15,PARMID                                          1393
         L     @01,PINFOPTR                                        1393
         AL    @01,@CF01818                                        1393
         AL    @02,PARMPTR(@15,@01)                                1393
         TM    VOLID(@02),B'00001000'                              1393
         BNO   @RF01393                                            1393
*                            PPLPCL=ADDR(DSVPCL );         /*@YL026UL*/
         L     @02,@CV01502                                        1394
         L     @01,PPLPTR                                          1394
         ST    @02,PPLPCL(,@01)                                    1394
*                          ELSE                                    1395
*                            PPLPCL=ADDR(DSNPCL );         /*@YL026UL*/
*                                                                  1395
         B     @RC01393                                            1395
@RF01393 L     @02,@CV01501                                        1395
         L     @01,PPLPTR                                          1395
         ST    @02,PPLPCL(,@01)                                    1395
*                    /************************************************/
*                    /*                                      @YL026UL*/
*                    /* IF THE NAME IS NOT TO BE PREFIXED,   @YL026UL*/
*                    /* POINT TO THE PCL THAT IS IDENTICAL   @YL026UL*/
*                    /* EXCEPT FOR THE PREFIXING REQUEST.    @YL026UL*/
*                    /*                                      @YL026UL*/
*                    /************************************************/
*                    IF USERID=NO                                  1396
*                      THEN                                        1396
@RC01393 DS    0H                                                  1396
@RC01389 LA    @02,12                                              1396
         LR    @15,@02                                             1396
         MH    @15,PARMID                                          1396
         L     @01,PINFOPTR                                        1396
         AL    @01,@CF01818                                        1396
         AL    @02,PARMPTR(@15,@01)                                1396
         TM    USERID(@02),B'00000100'                             1396
         BNZ   @RF01396                                            1396
*                        PPLPCL=PPLPCL+                            1397
*                               ADDR(DSNPCL2)-ADDR(DSNPCL);/*@YL026UL*/
         L     @02,PPLPTR                                          1397
         L     @15,@CV01505                                        1397
         AL    @15,PPLPCL(,@02)                                    1397
         L     @14,@CV01501                                        1397
         SLR   @15,@14                                             1397
         ST    @15,PPLPCL(,@02)                                    1397
*                    END;                                  /*@YL026UL*/
*                                                                  1398
@RF01396 DS    0H                                                  1399
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SEND THE USER'S RESPONSE TO 'PARSE', TOGETHER    @YL026UL*/
*        /* WITH THE PCL.  IF 'PARSE' IS NOT SUCCESSFUL,     @YL026UL*/
*        /* DISCONTINUE PROCESSING.                          @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1399
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     1399
@RC01384 DS    0H                                                  1399
@RC01382 DS    0H                                                  1399
@RC01371 DS    0H                                                  1400
*          RESPECIFY GPR01P RSTD;                                  1400
*          GPR01P = ADDR(PPL);                                     1401
         L     GPR01P,PPLPTR                                       1401
*          IF CVTPARS = 0                                          1402
*            THEN                                                  1402
         L     @02,CVTPTR                                          1402
         L     @02,CVTPARS(,@02)                                   1402
         LTR   @02,@02                                             1402
         BNZ   @RF01402                                            1402
*              GEN(LINK EP=IKJPARS);                               1403
         LINK EP=IKJPARS
*            ELSE                                                  1404
*              CALL CVTPARS;                                       1404
         B     @RC01402                                            1404
@RF01402 L     @02,CVTPTR                                          1404
         L     @15,CVTPARS(,@02)                                   1404
         BALR  @14,@15                                             1404
*          RESPECIFY GPR01P UNRSTD;                                1405
@RC01402 DS    0H                                                  1406
*        END;                   /*@Z40GSJG*/                       1406
*        RESPECIFY RTNREG RSTD;                                    1407
*        TESTRC = RTNREG;                                          1408
         LR    TESTRC,RTNREG                                       1408
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/
*                                                                  1409
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF THE IKJPARS FAILS DUE TO INSUFFICIENT MAIN   @Z40GSJG*/
*        /*  STORAGE, CALL FAILSPAC TO HANDLE THE ERROR.     @Y30SSFR*/
*        /*  OTHERWISE, SET LASTCC TO 12.  RETURN TO THE     @Y30SSFR*/
*        /*  CALLER.                                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        IF TESTRC^=0                                              1410
*          THEN                                                    1410
         LTR   TESTRC,TESTRC                                       1410
         BZ    @RF01410                                            1410
*            DO;                                           /*@YL026UL*/
*            IF TESTRC=BADSPACE                                    1412
*              THEN                                                1412
*                                                                  1412
         C     TESTRC,@CF00487                                     1412
         BNE   @RF01412                                            1412
*                CALL FAILSPAC;                            /*@YL026UL*/
*                                                                  1413
         BAL   @14,FAILSPAC                                        1413
*              ELSE                                                1414
*                LASTCC=LASTCC12;                          /*@YL026UL*/
         B     @RC01412                                            1414
@RF01412 L     @02,@PC00001+16                                     1414
         MVC   LASTCC(2,@02),@CH00038                              1414
*            RETURN;                                       /*@YL026UL*/
         B     @EL00017                                            1415
*            END;                                          /*@YL026UL*/
*                                                                  1416
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* TRANSLATE THE SUBFIELD PARAMETER(S) INTO FDT     @YL026UL*/
*        /* ENTRIE(S).                                       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        PROMPT=YES;                                       /*@YL026UL*/
*                                                                  1417
@RF01410 OI    PROMPT,B'10000000'                                  1417
*        CALL TRNSLATE;                                    /*@YL026UL*/
*                                                                  1418
         BAL   @14,TRNSLATE                                        1418
*        PARMID=INDEX10;                                   /*@YL026UL*/
*                                                                  1419
         LH    @02,INDEX10                                         1419
         STH   @02,PARMID                                          1419
*        END ADDPARM;                                      /*@YL026UL*/
*                                                                  1420
*                                                                  1420
         B     @EL00017                                            1420
*        END NEEDPRMS;                                     /*@YL026UL*/
@EL00016 DS    0H                                                  1421
@EF00016 DS    0H                                                  1421
@ER00016 LM    @14,@02,@SA00016                                    1421
         LM    @05,@06,@SA00016+20                                 1421
         LM    @08,@12,@SA00016+28                                 1421
         BR    @14                                                 1421
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - MSGKWD                                 @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SEARCHES THE DESCRIPTOR TO FIND @YL026UL*/
*/*             THE KEYWORD MOST CLOSELY ASSOCIATED WITH A   @YL026UL*/
*/*             GIVEN PARAMETER ID#.                         @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            ERRKWDID- ID# OF THE PARAMETER FOR WHICH THE  @YL026UL*/
*/*                      'NEAREST' KEYWORD IS TO BE FOUND.   @YL026UL*/
*/*            PARMINFO- PARAMETER INFO TABLE.               @YL026UL*/
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/
*/*            FDTVERB - CURRENT COMMAND'S VERB NAME.        @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            ERRFIELD- KEYWORD MOST CLOSELY ASSOCIATED     @YL026UL*/
*/*                      WITH THE INPUT PARAMETER.           @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*MSGKWD: PROCEDURE(ERRKWDID,FLDPTR);                       /*@YL026UL*/
MSGKWD   STM   @14,@12,12(@13)                                     1422
         MVC   @PC00018(8),0(@01)                                  1422
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** MSGKWD **    DATA DEFINITIONS                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*                                                                  1423
*        DCL ERRKWDID FIXED(15);       /*ID# OF PARM FOR     @YL026UL*/
*                                      /*WHICH A KEYWORD IS  @YL026UL*/
*                                      /*TO BE FOUND         @YL026UL*/
*        DCL FLDPTR   PTR(31);         /*PTR TO FIELD INTO   @YL026UL*/
*                                      /*WHICH KEYWORD IS TO @YL026UL*/
*                                      /*BE PLACED           @YL026UL*/
*        DCL ERRFIELD CHAR(20)         /*FIELD TO PUT KWD IN @YL026UL*/
*                     BASED(FLDPTR);                       /*@YL026UL*/
*        DCL NOKWD    CHAR(12)         /*DUMMY INSERT WHEN   @YL026UL*/
*            INIT('''POSITIONAL''');   /*NO KEYWORD EXISTS   @YL026UL*/
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** MSGKWD **  FIND KEYWORD FOR ERROR MESSAGE    @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1427
         L     @07,GDTTR2(,GDTPTR)                                 1427
         MVC   @TS00001(95),NEWERID2(@07)                          1427
         MVC   OLDERID2(95,@07),@TS00001                           1427
*        NEWID2='RI42';                                    /*@YL026UL*/
*                                                                  1428
         MVC   NEWID2(4,@07),@CC01793                              1428
*        TESTID=PARMID;                                    /*@YL026UL*/
         LH    TESTID,PARMID                                       1429
*        PARMID=ERRKWDID;                                  /*@YL026UL*/
         L     @07,@PC00018                                        1430
         LH    @07,ERRKWDID(,@07)                                  1430
         STH   @07,PARMID                                          1430
*        FOUND=NO;                                         /*@YL026UL*/
*                                                                  1431
         NI    FOUND,B'11111101'                                   1431
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* SEARCH THE DESCRIPTOR TO FIND THE KEYWORD THAT   @YL026UL*/
*        /* IS MOST CLOSELY ASSOCIATED WITH THE INPUT PARM.  @YL026UL*/
*        /* THIS WOULD BE THE PARM'S OWN KEYWORD OR ELSE A   @YL026UL*/
*        /* SUPERPARM'S KEYWORD.  IF THE PARM IS A FIRST-    @YL026UL*/
*        /* LEVEL POSITIONAL, THEN RETURN THE VERB NAME.     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        DO WHILE(PARMID^=0);                              /*@YL026UL*/
         B     @DE01432                                            1432
@DL01432 DS    0H                                                  1433
*          IF KWDDSPL^=0                                           1433
*            THEN                                                  1433
         LH    @07,PARMID                                          1433
         MH    @07,@CH00038                                        1433
         L     @03,PINFOPTR                                        1433
         AL    @03,@CF01818                                        1433
         L     @07,PARMPTR(@07,@03)                                1433
         CLI   KWDDSPL(@07),0                                      1433
         BE    @RF01433                                            1433
*              DO;                                         /*@YL026UL*/
*              KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);     /*@YL026UL*/
         SLR   KWDPTR,KWDPTR                                       1435
         IC    KWDPTR,KWDDSPL(,@07)                                1435
         ALR   KWDPTR,KWDPTR                                       1435
         ALR   @07,KWDPTR                                          1435
         AL    @07,@CF00227                                        1435
         LR    KWDPTR,@07                                          1435
*              ERRFIELD=KWDITEM(1:KWDLEN);                 /*@YL026UL*/
         L     @07,@PC00018+4                                      1436
         L     @07,FLDPTR(,@07)                                    1436
         MVI   ERRFIELD+1(@07),C' '                                1436
         MVC   ERRFIELD+2(18,@07),ERRFIELD+1(@07)                  1436
         SLR   @15,@15                                             1436
         IC    @15,KWDLEN(,KWDPTR)                                 1436
         BCTR  @15,0                                               1436
         EX    @15,@SM01872                                        1436
*              FOUND=YES;                                  /*@YL026UL*/
         OI    FOUND,B'00000010'                                   1437
*              PARMID=0;                                   /*@YL026UL*/
         SLR   @07,@07                                             1438
         STH   @07,PARMID                                          1438
*              END;                                        /*@YL026UL*/
*            ELSE                                                  1440
*              PARMID=SUPRPARM(PARMID);                    /*@YL026UL*/
         B     @RC01433                                            1440
@RF01433 LH    @07,PARMID                                          1440
         MH    @07,@CH00038                                        1440
         L     @03,PINFOPTR                                        1440
         AL    @03,@CF01819                                        1440
         LH    @07,SUPRPARM-8(@07,@03)                             1440
         STH   @07,PARMID                                          1440
*        END;                                              /*@YL026UL*/
*                                                                  1441
@RC01433 DS    0H                                                  1441
@DE01432 LH    @07,PARMID                                          1441
         LTR   @07,@07                                             1441
         BNZ   @DL01432                                            1441
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF NO KEYWORD CAN BE FOUND, SET THE KEYWORD     @Y30SSFR*/
*        /*  FIELD TO A DUMMY VALUE.                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*        IF FOUND=NO                                               1442
*          THEN                                                    1442
         TM    FOUND,B'00000010'                                   1442
         BNZ   @RF01442                                            1442
*            ERRFIELD=NOKWD;                               /*@YL026UL*/
         L     @07,@PC00018+4                                      1443
         L     @07,FLDPTR(,@07)                                    1443
         MVI   ERRFIELD+12(@07),C' '                               1443
         MVC   ERRFIELD+13(7,@07),ERRFIELD+12(@07)                 1443
         MVC   ERRFIELD(12,@07),NOKWD                              1443
*        PARMID=TESTID;                                    /*@YL026UL*/
*                                                                  1444
@RF01442 STH   TESTID,PARMID                                       1444
*        END MSGKWD;                                       /*@YL026UL*/
@EL00018 DS    0H                                                  1445
@EF00018 DS    0H                                                  1445
@ER00018 LM    @14,@12,12(@13)                                     1445
         BR    @14                                                 1445
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - FAILSPAC                               @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE SETS UP AND ISSUES AN ERROR     @YL026UL*/
*/*             MESSAGE TO THE TERMINAL USER TELLING HIM     @YL026UL*/
*/*             THAT INSUFFICIENT SPACE IS AVAILABLE TO      @YL026UL*/
*/*             CONTINUE PROCESSING OF THE CURRENT AMS       @YL026UL*/
*/*             COMMAND.                                     @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT - NONE                                            @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            LASTCC - AMS CONDITION CODE.                  @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*FAILSPAC:PROCEDURE;                                       /*@YL026UL*/
FAILSPAC STM   @14,@12,@SA00019                                    1446
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** FAILSPAC **  PRINT 'NO SPACE' ERROR MESSAGE  @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1447
         L     @07,GDTTR2(,GDTPTR)                                 1447
         MVC   @TS00001(95),NEWERID2(@07)                          1447
         MVC   OLDERID2(95,@07),@TS00001                           1447
*        NEWID2='RI44';                                    /*@YL026UL*/
*                                                                  1448
         MVC   NEWID2(4,@07),@CC01797                              1448
*        LASTCC=LASTCC12;                                  /*@YL026UL*/
         L     @07,@PC00001+16                                     1449
         MVC   LASTCC(2,@07),@CH00038                              1449
*        DARGSTID=NOSPACE;                                 /*@YL026UL*/
*                                                                  1450
         L     @07,NOSPACE                                         1450
         L     @01,DDSTRU                                          1450
         ST    @07,DARGSTID(,@01)                                  1450
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/
*                                                                  1451
         ST    GDTPTR,@AL00001                                     1451
         LA    @07,@CF00123                                        1451
         ST    @07,@AL00001+4                                      1451
         LA    @07,DDSTRU                                          1451
         ST    @07,@AL00001+8                                      1451
         MVI   @AL00001+8,X'80'                                    1451
         L     @15,GDTPRT(,GDTPTR)                                 1451
         LA    @01,@AL00001                                        1451
         BALR  @14,@15                                             1451
*        END FAILSPAC;                                     /*@YL026UL*/
*                                                                  1452
@EL00019 DS    0H                                                  1452
@EF00019 DS    0H                                                  1452
@ER00019 LM    @14,@12,@SA00019                                    1452
         BR    @14                                                 1452
*/********************************************************************/
*/*                                                          @YL026UL*/
*/*  PROCEDURE NAME - RITERM                                 @YL026UL*/
*/*                                                          @YL026UL*/
*/*  FUNCTION - THIS ROUTINE PERFORMS EITHER COMMAND         @YL026UL*/
*/*             TERMINATION OR AMS TERMINATION FUNCTIONS.    @YL026UL*/
*/*             PREPARATION IS MADE TO RETURN TO THE AMS     @YL026UL*/
*/*             EXECUTIVE AND WORK SPACE IS FREED.           @YL026UL*/
*/*                                                          @YL026UL*/
*/*  INPUT -                                                 @YL026UL*/
*/*            GDTRIH -  POINTER USED TO INDICATE WHETHER    @YL026UL*/
*/*                      AN FDT IS READY TO BE PASSED TO AN  @YL026UL*/
*/*                      FSR FOR EXECUTION OR WHETHER THAT   @YL026UL*/
*/*                      HAS BEEN DONE PREVIOUSLY.           @YL026UL*/
*/*            LASTCC -  AMS CONDITION CODE FOR CURRENT      @YL026UL*/
*/*                      COMMAND.                            @YL026UL*/
*/*            RIPOOLID- STORAGE SPACE ID FOR R/I WORK AREA  @YL026UL*/
*/*            SPACEID - STORAGE SPACE ID FOR STORAGE        @YL026UL*/
*/*                      ALLOCATED TO BUILD FDT.             @YL026UL*/
*/*            LOADNAME- LOAD MODULE NAME OF FSR TO BE       @YL026UL*/
*/*                      INVOKED BY THE EXECUTIVE AND PASSED @YL026UL*/
*/*                      THE COMPLETED FDT.                  @YL026UL*/
*/*                                                          @YL026UL*/
*/*  OUTPUT -                                                @YL026UL*/
*/*            SETRC -   RETURN CODE INDICATING WHETHER OR   @YL026UL*/
*/*                      NOT THE R/I SHOULD BE CALLED AGAIN. @YL026UL*/
*/*            MAXCC -   MAXIMUM AMS SYSTEM CONDITION CODE.  @YL026UL*/
*/*            GDTRIH -  SEE 'INPUT'                         @YL026UL*/
*/*            FSRNAME - SAME AS 'LOADNAME' ABOVE.           @YL026UL*/
*/*                                                          @YL026UL*/
*/********************************************************************/
*RITERM: PROCEDURE;                                        /*@YL026UL*/
RITERM   STM   @14,@12,@SA00020                                    1453
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /*  ** RITERM **  PERFORM TERMINATION FUNCTIONS     @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1454
         L     @07,GDTTR2(,GDTPTR)                                 1454
         MVC   @TS00001(95),NEWERID2(@07)                          1454
         MVC   OLDERID2(95,@07),@TS00001                           1454
*        NEWID2='RI46';                                    /*@YL026UL*/
*                                                                  1455
         MVC   NEWID2(4,@07),@CC01801                              1455
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE AMS SYSTEM IS TO BE TERMINATED DUE TO AN  @YL026UL*/
*        /* ERROR OR BECAUSE THE COMMAND HAS BEEN EXECUTED,  @YL026UL*/
*        /* SET A RETURN CODE SIGNALLING TO THE EXECUTIVE    @YL026UL*/
*        /* THAT NO MORE PROCESSING SHOULD BE DONE.          @YL026UL*/
*        /* ANY REMAINING WORK SPACE IS ALSO RELEASED.       @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF GDTRIH^=NULLPTR  LASTCC^=0                            1456
*          THEN                                                    1456
         SLR   @07,@07                                             1456
         C     @07,GDTRIH(,GDTPTR)                                 1456
         BNE   @RT01456                                            1456
         L     @15,@PC00001+16                                     1456
         CH    @07,LASTCC(,@15)                                    1456
         BE    @RF01456                                            1456
@RT01456 DS    0H                                                  1457
*            DO;                                           /*@YL026UL*/
*            SETRC=4;                                      /*@YL026UL*/
         MVC   SETRC(2),@CH00050                                   1458
*            MAXCC=LASTCC;                                 /*@YL026UL*/
*                                                                  1459
         L     @07,@PC00001+12                                     1459
         L     @15,@PC00001+16                                     1459
         LH    @14,LASTCC(,@15)                                    1459
         STH   @14,MAXCC(,@07)                                     1459
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THE READER/INTERPRETER DETECTED AN ERROR @Y30SSFR*/
*            /*  SET UP AND PRINT THE LASTCC MESSAGE.        @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1460
*            IF (GDTRIH=NULLPTR) & (LASTCC^=0)                     1460
*              THEN                                                1460
         SLR   @07,@07                                             1460
         C     @07,GDTRIH(,GDTPTR)                                 1460
         BNE   @RF01460                                            1460
         CR    @14,@07                                             1460
         BE    @RF01460                                            1460
*                DO;                                       /*@Y30SSFR*/
*                DARGSTID=TSOFAIL;                         /*@Y30SSFR*/
         L     @07,DDSTRU                                          1462
         L     @14,TSOFAIL                                         1462
         ST    @14,DARGSTID(,@07)                                  1462
*                DARGILP=2;                                /*@Y30SSFR*/
         MVC   DARGILP(2,@07),@CH00161                             1463
*                DARGDBP=ADDR(LASTCC);                     /*@Y30SSFR*/
*                                                                  1464
         ST    @15,DARGDBP(,@07)                                   1464
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Y30SSFR*/
*                                                                  1465
         ST    GDTPTR,@AL00001                                     1465
         LA    @07,@CF00123                                        1465
         ST    @07,@AL00001+4                                      1465
         LA    @07,DDSTRU                                          1465
         ST    @07,@AL00001+8                                      1465
         MVI   @AL00001+8,X'80'                                    1465
         L     @15,GDTPRT(,GDTPTR)                                 1465
         LA    @01,@AL00001                                        1465
         BALR  @14,@15                                             1465
*                END;                                      /*@Y30SSFR*/
*                                                                  1466
*            CALL IDCSAFP0(GDTTBL,RIPOOLID);               /*#YL026UL*/
@RF01460 ST    GDTPTR,@AL00001                                     1467
         LA    @07,MODID                                           1467
         ST    @07,@AL00001+4                                      1467
         MVI   @AL00001+4,X'80'                                    1467
         L     @15,GDTFPL(,GDTPTR)                                 1467
         LA    @01,@AL00001                                        1467
         BALR  @14,@15                                             1467
*            CALL IDCSAFP0(GDTTBL,SPACEID);                /*#YL026UL*/
*                                                                  1468
         ST    GDTPTR,@AL00001                                     1468
         L     @07,@PC00001+8                                      1468
         ST    @07,@AL00001+4                                      1468
         MVI   @AL00001+4,X'80'                                    1468
         L     @15,GDTFPL(,GDTPTR)                                 1468
         LA    @01,@AL00001                                        1468
         BALR  @14,@15                                             1468
*            END;                                          /*#YL026UL*/
*          /**********************************************************/
*          /*                                                #YL026UL*/
*          /* IF AT COMMAND TERMINATION, FREE UP WORK SPACE, #YL026UL*/
*          /* SET 'GDTRIH' TO A NONZERO VALUE TO SIGNAL THAT #YL026UL*/
*          /* TERMINATION HAS BEEN PERFORMED, AND OBTAIN THE #YL026UL*/
*          /* NAME OF THE FSR MODULE TO BE PASSED THE FDT.   #YL026UL*/
*          /*                                                #YL026UL*/
*          /**********************************************************/
*          ELSE                                                    1470
*            DO;                                           /*@YL026UL*/
         B     @RC01456                                            1470
@RF01456 DS    0H                                                  1471
*            GDTRIH=ADDR(GDTRIH);                          /*@YL026UL*/
         LA    @07,GDTRIH(,GDTPTR)                                 1471
         ST    @07,GDTRIH(,GDTPTR)                                 1471
*            FSRNAME=LOADNAME;                             /*@YL026UL*/
*                                                                  1472
         L     @07,@PC00001+20                                     1472
         L     @01,DESCPTR                                         1472
         MVC   FSRNAME(8,@07),LOADNAME(@01)                        1472
*            CALL IDCSAFP0(GDTTBL,RIPOOLID);               /*@YL026UL*/
*                                                                  1473
         ST    GDTPTR,@AL00001                                     1473
         LA    @07,MODID                                           1473
         ST    @07,@AL00001+4                                      1473
         MVI   @AL00001+4,X'80'                                    1473
         L     @15,GDTFPL(,GDTPTR)                                 1473
         LA    @01,@AL00001                                        1473
         BALR  @14,@15                                             1473
*            END;                                          /*@YL026UL*/
*                                                                  1474
*        END RITERM;                                       /*@YL026UL*/
*                                                                  1475
*                                                                  1475
@EL00020 DS    0H                                                  1475
@EF00020 DS    0H                                                  1475
@ER00020 LM    @14,@12,@SA00020                                    1475
         BR    @14                                                 1475
*        END IDCRI04                                       /*@YL026UL*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (AMSDF26 )                                        *
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        *
*/*%INCLUDE SYSLIB  (IKJECT  )                                        *
*;                                                                 1476
@DATA    DS    0H
@CH00170 DC    H'3'
@CH00164 DC    H'6'
@CH00038 DC    H'12'
@CH01454 DC    H'72'
@CH01804 DC    H'84'
@SM01823 MVC   PARMSET+1(0,@05),DATABLK(@01)
@SM01825 MVC   PARMSET(0,@05),DATABLK(@02)
@SM01829 MVC   DATABLK(0,NEWPTR),DATABLK(OLDPTR)
@SM01836 MVC   STRNG2+1(0,DATAPTR),DATABLK(@02)
@SM01838 MVC   STRNG2(0,DATAPTR),PDEDSN(@02)
@SM01840 MVC   STRPWORD(0,DATAPTR),PDEPWD(@02)
@SM01842 MVC   STRNG1+1(0,DATAPTR),DATABLK(@02)
@SM01844 MVC   STRNG1(0,DATAPTR),PDESTRNG(@02)
@SM01846 MVC   PWORD(0,DATAPTR),PDEPWD(@01)
@SM01848 MVC   MEMBR(0,DATAPTR),PDEMEM(@01)
@SM01850 MVC   DSNAME(0,DATAPTR),PDEDSN(@01)
@SM01852 MVC   EFIELD2(0),PDESTRNG(@02)
@SM01854 MVC   EFIELD2(0),PDEDSN(@01)
@SM01856 MVC   0(0,@07),PDEMEM(@01)
@SM01858 MVC   0(0,@07),PDEPWD(@01)
@SM01860 MVC   DATABLK(0,PDEPTR),DATABLK+8(@02)
@SM01862 MVC   EFIELD2+1(0),PDESTRNG(@05)
@SM01864 MVC   EFIELD2(0),PDEDSN(@02)
@SM01867 MVC   PARMSET(0,@05),DEFLTVAL(@01)
@SM01872 MVC   ERRFIELD(0,@07),KWDITEM(KWDPTR)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    6F
@SA00002 DS    14F
@SA00003 DS    12F
@SA00004 DS    12F
@SA00020 DS    15F
@SA00019 DS    15F
@SA00005 DS    13F
@SA00012 DS    15F
@SA00014 DS    12F
@SA00016 DS    12F
@SA00007 DS    14F
@SA00008 DS    13F
@SA00011 DS    15F
@SA00010 DS    15F
@PC00010 DS    2F
@SA00009 DS    13F
@PC00018 DS    2F
@SA00013 DS    15F
@PC00013 DS    2F
@SA00015 DS    12F
@PC00015 DS    1F
@SA00017 DS    13F
@AL00001 DS    5A
@TF00001 DS    F
@AFTEMPS DS    6F
IDCRI04  CSECT
         DS    0F
@CF00123 DC    F'0'
@CF00227 DC    F'1'
@CH00227 EQU   @CF00227+2
@CF00161 DC    F'2'
@CH00161 EQU   @CF00161+2
@CF00050 DC    F'4'
@CH00050 EQU   @CF00050+2
@CF00187 DC    F'8'
@CF00041 DC    F'9'
@CF00487 DC    F'16'
@CF01449 DC    F'20'
@CH01449 EQU   @CF01449+2
@CF01803 DC    F'65'
@CF01802 DC    F'240'
@CF01815 DC    F'-16'
@CF01818 DC    F'-12'
@CF01817 DC    F'-8'
@CF01821 DC    F'-6'
@CF01819 DC    F'-4'
@CF01813 DC    F'-3'
@CF01822 DC    XL4'0000FFFF'
@CF01684 DC    XL4'400'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
DESCPTR  DS    A
PINFOPTR DS    A
RSIPTR   DS    A
PPLPTR   DS    A
PDLPTR   DS    A
PARSECB  DS    F
BUFFPTR  DS    A
SPACEAMT DS    F
AMTTOGET DS    F
BLKLEFT  DS    F
PMSGPTR  DS    A
RPLYPTR  DS    A
SETUPPTR DS    A
BLKPTR   DS    A
WORKPTR1 DS    A
LISTPTR  DS    A
SETRC    DS    H
PARMID   DS    H
RSICOUNT DS    H
REPINDEX DS    H
SUPERID  DS    H
PRMSETID DS    H
INDEX5   DS    H
INDEX9   DS    H
INDEX10  DS    H
PMSGLEN  DS    H
RPLYLEN  DS    H
REPCOUNT DS    H
LISTTOTL DS    H
VECTROFF DS    H
INDEX1   DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
PPLAREA  DS    CL28
PRNTAREA DS    BL20
EFIELD   DS    CL84
         ORG   EFIELD
EFIELD1  DS    CL20
EFIELD2  DS    CL64
         ORG   EFIELD2
EFIELD3  DS    FL4
         ORG   EFIELD+84
MSGBUFF  DS    CL72
MISCFLGS DS    CL1
         ORG   MISCFLGS
PROMPT   DS    BL1
SINGLPRM EQU   MISCFLGS+0
ALLOK    EQU   MISCFLGS+0
GOODCMD  EQU   MISCFLGS+0
NAMEPDE  EQU   MISCFLGS+0
CNTDONE  EQU   MISCFLGS+0
FOUND    EQU   MISCFLGS+0
         ORG   MISCFLGS+1
TRUNCATE DS    BL1
KEEP1ST  DS    BL1
DFLTOK   DS    BL1
IDCRI04  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01498 DC    V(NUMPCL)
@CV01499 DC    V(STRPCL)
@CV01500 DC    V(DDNPCL)
@CV01501 DC    V(DSNPCL)
@CV01502 DC    V(DSVPCL)
@CV01503 DC    V(DSGPCL)
@CV01504 DC    V(DSGVPCL)
@CV01505 DC    V(DSNPCL2)
@CV01509 DC    V(REPPCL)
@CV01507 DC    V(DSGPCL2)
@CV01508 DC    V(DSGVPCL2)
@CV01506 DC    V(DSVPCL2)
         DS    0D
CHAINEND DC    XL4'FF000000'
NOSPACE  DS    FL4
         ORG   NOSPACE
@NM00059 DC    CL3'UV0'
@NM00060 DC    AL1(4)
         ORG   NOSPACE+4
TSOFAIL  DS    FL4
         ORG   TSOFAIL
@NM00061 DC    CL3'UV0'
@NM00062 DC    AL1(15)
         ORG   TSOFAIL+4
@CC01525 DC    C'FFFFFFFF'
@CC01527 DC    C'IDCRILT '
@CC01529 DC    C'RI10'
@CC01544 DC    C'RI12'
@CC01552 DC    C'RI14'
@CC01595 DC    C'RI16'
@CC01610 DC    C'RI18'
@CC01618 DC    C'RI20'
@CC01663 DC    C'RI22'
@CC01681 DC    C'RI24'
@CC01695 DC    C'RI26'
@CC01708 DC    C'RI28'
@CC01715 DC    C'RI30'
@CC01734 DC    C'RI32'
@CC01744 DC    C'RI34'
@CC01757 DC    C'RI36'
@CC01769 DC    C'RI38'
@CC01781 DC    C'RI40'
@CC01793 DC    C'RI42'
@CC01797 DC    C'RI44'
@CC01801 DC    C'RI46'
@CC01472 EQU   @CC01529
@CC01553 DC    C'P '
@CB01701 DC    X'4040'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'RI04'
FIXAREA  DS    CL256
         ORG   FIXAREA
@NM00063 DC    256X'00'
         ORG   FIXAREA+256
LISTRPLY DC    CL4'''OK'''
RETAIN1  DC    CL3'''1'''
RETAIN2  DC    CL3'''2'''
NOKWD    DC    CL12'''POSITIONAL'''
@DATD    DSECT
IDCRI04  CSECT
*
*  PCL DESCRIBING A NUMERIC CONSTANT
NUMPCL   IKJPARM DSECT=STDPCL1
NUM      IKJIDENT 'NUMERIC CONSTANT',INTEG,                            *
               PROMPT='REQUESTED NUMERIC CONSTANT'
         IKJENDP
*
*  PCL DESCRIBING A STRING CONSTANT
STRPCL   IKJPARM DSECT=STDPCL2
STR      IKJIDENT 'STRING CONSTANT',HEX,                               *
               PROMPT='REQUESTED STRING CONSTANT'
         IKJENDP
*
*  PCL DESCRIBING A STRING CONSTANT WITH PASSWORD
DDNPCL   IKJPARM DSECT=STDPCL3
DDN      IKJPOSIT DSNAME,PROMPT='REQUESTED STRING CONSTANT'
         IKJENDP
*
*  PCL DESCRIBING STANDARD DATA SET NAME WITH PREFIX
DSNPCL   IKJPARM DSECT=STDPCL4
DSN      IKJPOSIT DSNAME,USID,                                         *
               PROMPT='REQUESTED DATA SET NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD DATA SET NAME WITH PREFIX OR VOLID
DSVPCL   IKJPARM DSECT=STDPCL5
DSV      IKJPOSIT DSNAME,USID,VOLSER,                                  *
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD OR GENERIC DATA SET NAME WITH PREFIX
DSGPCL   IKJPARM DSECT=STDPCL6
DSG      IKJPOSIT DSTHING,USID,                                        *
               PROMPT='REQUESTED DATA SET NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD OR GENERIC DSNAME WITH PREFIX OR VOLID
DSGVPCL  IKJPARM DSECT=STDPCL7
DSGV     IKJPOSIT DSTHING,USID,VOLSER,                                 *
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD DATA SET NAME WITHOUT PREFIX
DSNPCL2  IKJPARM DSECT=STDPCL8
DSN2     IKJPOSIT DSNAME,                                              *
               PROMPT='REQUESTED DATA SET NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD DATA SET NAME WITHOUT PREFIX OR VOLID
DSVPCL2  IKJPARM DSECT=STDPCL9
DSV2     IKJPOSIT DSNAME,VOLSER,                                       *
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD OR GENERIC DATA SET NAME WITHOUT PREFIX
DSGPCL2  IKJPARM DSECT=STDPCL10
DSG2     IKJPOSIT DSTHING,                                             *
               PROMPT='REQUESTED DATA SET NAME'
         IKJENDP
*
*  PCL DESCRIBING STANDARD OR GENERIC DSNAME WITHOUT PREFIX OR VOLID
DSGVPCL2 IKJPARM DSECT=STDPCL11
DSGV2    IKJPOSIT DSTHING,VOLSER,                                      *
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'
         IKJENDP
*
*  PCL DESCRIBING A PSTRING (REPEATED SUBLIST)
REPPCL   IKJPARM DSECT=STDPCL12
REP      IKJPOSIT PSTRING,PROMPT='PARENTHESIZED SUBPARAMETER LIST'
         IKJENDP
@DATAD   DSECT
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRI04  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WORKPTR2 EQU   @05
ERASEID  EQU   @03
NAMEPOS  EQU   @02
ORIGPDL  EQU   @07
NEXTPDE  EQU   @02
STARCNT  EQU   @02
DATAPTR  EQU   @07
MOVEAMT  EQU   @02
NEWPTR   EQU   @05
OLDPTR   EQU   @07
MOVELEN  EQU   @04
BASEPTR  EQU   @04
PDEPTR   EQU   @03
INDEX11  EQU   @02
INDEX8   EQU   @04
INDEX7   EQU   @05
INDEX6   EQU   @04
INDEX4   EQU   @02
INDEX3   EQU   @03
INDEX2   EQU   @02
TESTID   EQU   @02
KWDPTR   EQU   @03
GRPPTR   EQU   @04
TESTRC   EQU   @05
RTNREG   EQU   @15
GPR01P   EQU   @01
GDTPTR   EQU   @06
GPR00F   EQU   @00
GPR00P   EQU   @00
GPR01F   EQU   @01
GPR14F   EQU   @14
GPR14P   EQU   @14
GPR15F   EQU   @15
GPR15P   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
CVTPTR   EQU   16
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTRIH   EQU   GDTTBL+24
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTCMB   EQU   GDTTBL+176
GDTUPT   EQU   GDTTBL+180
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSALD0 EQU   0
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSAPT0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
DMPITM   EQU   0
DMPARY   EQU   0
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
VERBDATA EQU   0
PCLDSPL1 EQU   VERBDATA+4
VDATALEN EQU   VERBDATA+6
PARMCNT  EQU   VERBDATA+8
MAXID    EQU   VERBDATA+10
LOADNAME EQU   VERBDATA+12
POSDSPL  EQU   VERBDATA+20
DGRPDSPL EQU   VERBDATA+21
VNGRPDSP EQU   VERBDATA+22
NTGRPDSP EQU   VERBDATA+23
@NM00034 EQU   0
DGRPTOT  EQU   0
@NM00035 EQU   0
DGRPCNT  EQU   @NM00035
DGRPID   EQU   @NM00035+2
VNGRPTOT EQU   0
@NM00036 EQU   0
VNGRPCNT EQU   @NM00036
VNGRPID  EQU   @NM00036+2
NTGRPTOT EQU   0
@NM00037 EQU   0
NTGRPCNT EQU   @NM00037
NTGRPID  EQU   @NM00037+2
PARMDATA EQU   0
PDEFLEN  EQU   PARMDATA
OCCURNUM EQU   PARMDATA+1
IDDSPL   EQU   PARMDATA+4
KWDDSPL  EQU   PARMDATA+5
NOTDSPL  EQU   PARMDATA+6
NGRPDSPL EQU   PARMDATA+7
PDEDSPL  EQU   PARMDATA+8
KWDGRPID EQU   PARMDATA+9
SCLRDATA EQU   PARMDATA+11
REPEATED EQU   PARMDATA+11
LIST     EQU   PARMDATA+11
DEFAULT  EQU   PARMDATA+11
SUBLIST  EQU   PARMDATA+11
DSCRPTR1 EQU   0
PCLDSPL2 EQU   DSCRPTR1
SUBDSPL  EQU   DSCRPTR1+2
REPMAX   EQU   DSCRPTR1+3
DSCRPTR2 EQU   0
HIVALUE  EQU   DSCRPTR2
LOWVALUE EQU   DSCRPTR2+4
MAXLNGTH EQU   DSCRPTR2+8
LISTMAX  EQU   DSCRPTR2+9
NUMBER   EQU   DSCRPTR2+11
ANYSTRNG EQU   DSCRPTR2+11
DSNAM    EQU   DSCRPTR2+11
GENERIC  EQU   DSCRPTR2+11
VOLID    EQU   DSCRPTR2+11
USERID   EQU   DSCRPTR2+11
PWORDOPT EQU   DSCRPTR2+11
DEFLT    EQU   0
DEFLTLEN EQU   DEFLT
DEFLTVAL EQU   DEFLT+1
@NM00042 EQU   0
IDCOUNT  EQU   @NM00042
@NM00043 EQU   @NM00042+2
IDNUM    EQU   @NM00043
PDEOFST1 EQU   @NM00043+2
KWDCOUNT EQU   0
@NM00044 EQU   0
KWDLEN   EQU   @NM00044
KWDITEM  EQU   @NM00044+1
@NM00045 EQU   0
SUBCOUNT EQU   @NM00045
@NM00046 EQU   @NM00045+2
PARMTYPE EQU   @NM00046
SUBID    EQU   @NM00046+2
NGRPTOT  EQU   0
@NM00047 EQU   0
NGRPCNT  EQU   @NM00047
NGRPID   EQU   @NM00047+2
@NM00048 EQU   0
NOTCOUNT EQU   @NM00048
NOTID    EQU   @NM00048+2
@NM00049 EQU   0
PDECNT   EQU   @NM00049
@NM00050 EQU   @NM00049+2
PDEPRMID EQU   @NM00050
PDEPCLID EQU   @NM00050+2
PDEOFST2 EQU   @NM00050+4
FDTTBL   EQU   0
FDTVERB  EQU   FDTTBL
FDTPTR   EQU   FDTTBL+8
PARMINFO EQU   0
PARMPTR  EQU   PARMINFO
NTGRPPTR EQU   PARMINFO+4
SUPRPARM EQU   PARMINFO+8
PARMFLAG EQU   PARMINFO+10
RSI      EQU   0
SBLSTPTR EQU   RSI
SBLSTLEN EQU   RSI+4
SBLSTID  EQU   RSI+6
SBLSTNUM EQU   RSI+8
SBLSTIN  EQU   RSI+9
VECTRDSP EQU   RSI+10
VECTRVAL EQU   0
PPL      EQU   0
PPLUPT   EQU   PPL
PPLECT   EQU   PPL+4
PPLECB   EQU   PPL+8
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
ECT      EQU   0
ECTPCMD  EQU   ECT+12
ECTSWS   EQU   ECT+28
ECTNOPD  EQU   ECTSWS
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
CBUFF    EQU   0
PSETLEN  EQU   CBUFF
PARMSET  EQU   CBUFF+4
DATABLK  EQU   0
RIPOOLID EQU   0
RILT     EQU   0
@NM00064 EQU   RILT
TBLVERB  EQU   @NM00064
TBLLNAME EQU   @NM00064+8
PDE1     EQU   0
CONSTPTR EQU   PDE1
CONSTLEN EQU   PDE1+4
NXTCPDE  EQU   PDE1+8
PDE2     EQU   0
DSNPTR   EQU   PDE2
DSNLEN   EQU   PDE2+4
DSNIN    EQU   PDE2+6
DSNQUOTE EQU   PDE2+6
MEMPTR   EQU   PDE2+8
MEMLEN   EQU   PDE2+12
MEMIN    EQU   PDE2+14
PWDPTR   EQU   PDE2+16
PWDLEN   EQU   PDE2+20
PWDIN    EQU   PDE2+22
NXTDPDE  EQU   PDE2+24
KWDID    EQU   0
PDENUMBR EQU   0
PDESTRNG EQU   0
PDEDSN   EQU   0
PDEMEM   EQU   0
PDEPWD   EQU   0
CODED    EQU   0
NUMBRCNT EQU   0
STRNGCNT EQU   0
FULLWORD EQU   0
@NM00073 EQU   0
STRNG1LN EQU   @NM00073
STRNG1   EQU   @NM00073+1
@NM00074 EQU   0
STRPWLEN EQU   @NM00074
STRPWORD EQU   @NM00074+1
STRNG2LN EQU   @NM00074+9
STRNG2   EQU   @NM00074+10
DSNSTRCT EQU   0
PWORDLEN EQU   DSNSTRCT
PWORD    EQU   DSNSTRCT+1
STARPOS  EQU   DSNSTRCT+9
UNQUOTED EQU   DSNSTRCT+10
MEMBRLEN EQU   DSNSTRCT+11
MEMBR    EQU   DSNSTRCT+12
DSNAMELN EQU   DSNSTRCT+20
DSNAME   EQU   DSNSTRCT+21
ERRFIELD EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCDB010 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBLX  EQU   0
FDTADDR  EQU   0
SPACEID  EQU   0
MAXCC    EQU   0
LASTCC   EQU   0
FSRNAME  EQU   0
ERRORID  EQU   0
ERRORPCL EQU   0
ID1      EQU   0
ID2      EQU   0
DFLTPARM EQU   0
ERRKWDID EQU   0
FLDPTR   EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTPARS  EQU   CVTS01+176
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
ECTPTR   EQU   GDTECT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00075 EQU   DSNSTRCT+10
@NM00072 EQU   PDE2+23
@NM00071 EQU   PDE2+22
@NM00070 EQU   PDE2+15
@NM00069 EQU   PDE2+14
@NM00068 EQU   PDE2+7
@NM00067 EQU   PDE2+6
@NM00066 EQU   PDE1+7
@NM00065 EQU   PDE1+6
CONSTIN  EQU   PDE1+6
POFFSET  EQU   CBUFF+2
@NM00058 EQU   ECT+52
@NM00057 EQU   ECT+48
@NM00056 EQU   ECT+44
@NM00055 EQU   ECTSWS2+1
@NM00054 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00053 EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
@NM00052 EQU   RSI+9
@NM00051 EQU   PARMINFO+11
@NM00041 EQU   DSCRPTR2+11
@NM00040 EQU   DSCRPTR2+10
@NM00039 EQU   PARMDATA+11
SCALAR   EQU   PARMDATA+11
LEVEL1   EQU   PARMDATA+11
@NM00038 EQU   PARMDATA+10
VPOSID   EQU   @NM00034+2
VPOSCNT  EQU   @NM00034
DESCID   EQU   VERBDATA
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00033 EQU   CVTFIX+248
@NM00032 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGCNT  EQU   DARGLIST+14
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTPSB   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00377 EQU   @EL00003
@RT00385 EQU   @EL00003
@RF00392 EQU   @EL00003
@RC00440 EQU   @EL00004
@RT00451 EQU   @EL00004
@RF00458 EQU   @EL00004
@RT00488 EQU   @EL00005
@RT00516 EQU   @EL00005
@RC00533 EQU   @EL00006
@RT00568 EQU   @EL00007
@RT00611 EQU   @EL00007
@RT00672 EQU   @EL00008
@RT00694 EQU   @EL00008
@RC00700 EQU   @RC00699
@RF00710 EQU   @RC00699
@RT00727 EQU   @EL00008
@RC00744 EQU   @RC00743
@RT00771 EQU   @EL00008
@RT00813 EQU   @EL00009
@RC00844 EQU   @EL00009
@PB00009 EQU   @EL00008
@RC00871 EQU   @RC00868
@RC00869 EQU   @RC00868
@RC00948 EQU   @EL00010
@RC00992 EQU   @RC00988
@RC00997 EQU   @RC00996
@RF01030 EQU   @RC01027
@RC01039 EQU   @EL00011
@PB00011 EQU   @EL00005
@RT01057 EQU   @EL00012
@RC01116 EQU   @RC01115
@RC01143 EQU   @RC01140
@PB00013 EQU   @EL00012
@RT01170 EQU   @EL00014
@RT01181 EQU   @EL00014
@RC01217 EQU   @RC01216
@RC01254 EQU   @EL00015
@RT01261 EQU   @EL00015
@RF01211 EQU   @EL00015
@PB00015 EQU   @EL00014
@RT01286 EQU   @EL00016
@RT01306 EQU   @EL00016
@RC01372 EQU   @RC01371
@RC01385 EQU   @RC01384
@RC01390 EQU   @RC01389
@RC01412 EQU   @EL00017
@PB00017 EQU   @EL00016
@RC01456 EQU   @EL00020
@PB00020 EQU   @EL00001
@PB00010 EQU   @PB00011
@RC01040 EQU   @RC01039
@PB00019 EQU   @PB00020
@PB00008 EQU   @PB00010
@PB00018 EQU   @PB00019
@PB00007 EQU   @PB00008
@PB00016 EQU   @PB00018
@PB00006 EQU   @PB00007
@PB00014 EQU   @PB00016
@RC00481 EQU   @PB00006
@PB00012 EQU   @PB00014
@PB00005 EQU   @PB00012
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCRI04,(C'PLS0626',0701,76335)

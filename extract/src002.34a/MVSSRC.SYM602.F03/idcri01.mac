         TITLE '*********  IDCRI01:  READER/INTERPRETER MAIN MODULE   **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRI01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRI01   76.310'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         LA    @08,4095(,@09)                                      0002
         LA    @07,4095(,@08)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         USING @PSTART+16380,@08                                   0002
         USING @PSTART+20475,@07                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @06,@01                                             0002
         USING @DATD,@06                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @06,8(,@13)                                         0002
         LR    @13,@06                                             0002
         MVC   @PC00001(24),0(@01)                                 0002
*        GDTPTR=ADDR(GDTTBLX);                                     0275
*                                                                  0275
         L     GDTPTR,@PC00001                                     0275
*        IF GDTDBG = NULLPTR                                       0276
*          THEN;                                                   0276
         ICM   @05,15,GDTDBG(GDTPTR)                               0276
         BZ    @RT00276                                            0276
*          ELSE                                                    0278
*            CALL IDCDB010(GDTTBL,'RIEX');                         0278
         ST    GDTPTR,@AL00001                                     0278
         LA    @05,@CC00901                                        0278
         ST    @05,@AL00001+4                                      0278
         MVI   @AL00001+4,X'80'                                    0278
         L     @15,GDTDBG(,GDTPTR)                                 0278
         LA    @01,@AL00001                                        0278
         BALR  @14,@15                                             0278
*        RISTATUS=0;                                               0279
@RT00276 SLR   @02,@02                                             0279
         STH   @02,RISTATUS                                        0279
*        VERBNAME=BLANK;                                           0280
         MVI   VERBNAME+1,C' '                                     0280
         MVC   VERBNAME+2(6),VERBNAME+1                            0280
         MVI   VERBNAME,C' '                                       0280
*        OPTSFLAG=OFF;                                             0281
         NI    OPTSFLAG,B'11011111'                                0281
*        UNITINDX=0;                                       /*@YL026UL*/
         SLR   UNITINDX,UNITINDX                                   0282
*        CHAR1=BLANK;                                              0283
         MVI   CHAR1,C' '                                          0283
*        CONTNEXT=NO;                                              0284
         NI    CONTNEXT,B'11110111'                                0284
*        VLISTID1='RI';                                            0285
*                                                                  0285
         MVC   VLISTID1(2),@CC00902                                0285
*        DDSTRU=ADDR(PRNTAREA);                                    0286
         LA    @15,PRNTAREA                                        0286
         ST    @15,DDSTRU                                          0286
*        PRNTAREA=''B;                                             0287
*                                                                  0287
         XC    PRNTAREA(20),PRNTAREA                               0287
*        /************************************************************/
*        /*                                                          */
*        /* STORE INPUT PARAMETER DATA INTO R/I'S OWN DATA AREA      */
*        /*                                                          */
*        /************************************************************/
*        POOLID=SPACEID;                                           0288
         L     @15,@PC00001+8                                      0288
         MVC   POOLID(4),SPACEID(@15)                              0288
*        MAXCC=AMSMAX;                                     /*@YL026UL*/
         L     @15,@PC00001+12                                     0289
         MVC   MAXCC(2),AMSMAX(@15)                                0289
*        LASTCC=AMSLAST;                                   /*@YL026UL*/
*                                                                  0290
         L     @15,@PC00001+16                                     0290
         MVC   LASTCC(2),AMSLAST(@15)                              0290
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO SEE IF R/I INITIALIZATION NEEDS TO BE DONE     */
*        /*  AND TERMINATE IF INITIALIZATION WAS NOT COMPLETED OKAY  */
*        /*                                                          */
*        /************************************************************/
*        IF GDTRIH = NULLPTR                                       0291
*          THEN                                                    0291
         C     @02,GDTRIH(,GDTPTR)                                 0291
         BNE   @RF00291                                            0291
*            DO;                                                   0292
*                                                                  0292
*            CALL RIINIT;                                          0293
*                                                                  0293
         BAL   @14,RIINIT                                          0293
*            IF RISTATUS^=0                                        0294
*              THEN                                                0294
*                                                                  0294
         ICM   @02,3,RISTATUS                                      0294
         BZ    @RF00294                                            0294
*                CALL IDCRI03(GDTTBL,COMMAREA);            /*@YL026UL*/
*                                                                  0295
         ST    GDTPTR,@AL00001                                     0295
         LA    @02,COMMAREA                                        0295
         ST    @02,@AL00001+4                                      0295
         L     @15,@CV00622                                        0295
         LA    @01,@AL00001                                        0295
         BALR  @14,@15                                             0295
*            END;                                                  0296
*                                                                  0296
@RF00294 DS    0H                                                  0297
*        /************************************************************/
*        /*                                                          */
*        /* SCAN AND INTERPRET INPUT FUNCTION AND MODAL COMMANDS     */
*        /* UNTIL A FUNCTION COMMAND TO BE EXECUTED IS FOUND.  THEN  */
*        /* ENCODE THIS COMMAND INTO THE FUNCTION DATA TABLE (FDT).  */
*        /*                                                          */
*        /************************************************************/
*        GOODCMD=NO;                                               0297
@RF00291 NI    GOODCMD,B'01111111'                                 0297
*        DO WHILE(RISTATUS=0 & GOODCMD=NO);                        0298
*                                                                  0298
         B     @DE00298                                            0298
@DL00298 DS    0H                                                  0299
*          CALL SCANCMD;                                           0299
*                                                                  0299
         BAL   @14,SCANCMD                                         0299
*          CALL IDCRI03(GDTTBL,COMMAREA);                  /*@YL026UL*/
*                                                                  0300
         ST    GDTPTR,@AL00001                                     0300
         LA    @02,COMMAREA                                        0300
         ST    @02,@AL00001+4                                      0300
         L     @15,@CV00622                                        0300
         LA    @01,@AL00001                                        0300
         BALR  @14,@15                                             0300
*        END;                                                      0301
*                                                                  0301
@DE00298 ICM   @02,3,RISTATUS                                      0301
         BNZ   @DC00298                                            0301
         TM    GOODCMD,B'10000000'                                 0301
         BZ    @DL00298                                            0301
@DC00298 DS    0H                                                  0302
*        /************************************************************/
*        /*                                                          */
*        /* UPDATE PARAMETER DATA, PREPARING TO RETURN TO EXECUTIVE  */
*        /*                                                          */
*        /************************************************************/
*        FDTLOC=FDTADDR;                                           0302
         L     @02,@PC00001+4                                      0302
         MVC   FDTLOC(4,@02),FDTADDR                               0302
*        FUNCNAME=FSRLNAME;                                        0303
         L     @02,@PC00001+20                                     0303
         MVC   FUNCNAME(8,@02),FSRLNAME                            0303
*        AMSMAX=MAXCC;                                     /*@YL026UL*/
         L     @02,@PC00001+12                                     0304
         MVC   AMSMAX(2,@02),MAXCC                                 0304
*        AMSLAST=LASTCC;                                   /*@YL026UL*/
*                                                                  0305
         L     @02,@PC00001+16                                     0305
         MVC   AMSLAST(2,@02),LASTCC                               0305
*        CALL IDCSAEP0(GDTTBL,MODID,RISTATUS);                     0306
*                                                                  0306
         ST    GDTPTR,@AL00001                                     0306
         LA    @02,MODID                                           0306
         ST    @02,@AL00001+4                                      0306
         LA    @02,RISTATUS                                        0306
         ST    @02,@AL00001+8                                      0306
         MVI   @AL00001+8,X'80'                                    0306
         L     @15,GDTEPL(,GDTPTR)                                 0306
         LA    @01,@AL00001                                        0306
         BALR  @14,@15                                             0306
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - RIINIT                                         */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE OBTAINS AND INITIALIZES SPACE FOR THE */
*/*             READER/INTERPRETER HISTORICAL DATA AREA (R/I HDA),   */
*/*             OBTAINS SPACE FOR AND SETS UP REFERENCE TO THE UPRINT*/
*/*             ARGUMENT STRUCTURE, AND LOADS THE DESCRIPTOR LOAD    */
*/*             MODULE NAME TABLE.  FINALLY, IT SETS UP PARAMETER    */
*/*             OPTION INPUT IF IT EXISTS.                           */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          OPTSPTR - POINTER TO PARAMETER OPTIONS STRING           */
*/*          OPTSLEN - LENGTH OF PARAMETER OPTIONS STRING            */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FIRSTCHR- SIGNALS THAT THE LOCATION AND LENGTH OF THE   */
*/*                    INPUT CHARACTERS TO BE SCANNED ARE NOT TO BE  */
*/*                    FOUND IN THE R/I HDA.                         */
*/*          GDTRIH -  POINTER TO R/I HDA.                           */
*/*          LEFTMGN - LEFT COMMAND STREAM SOURCE MARGIN TO BE USED  */
*/*          RIGHTMGN- RIGHT COMMAND STREAM SOURCE MARGIN TO BE USED */
*/*          OPNIOC -  OPEN FLAGS AND POINTERS SET WHEN OPENING THE  */
*/*          OPNPTR    COMMAND INPUT STREAM FOR INPUT.               */
*/*          OPNAGL                                                  */
*/*          OPNTYPSI                                                */
*/*          OPTSFLAG- FLAG NOTING THAT PARAMETER OPTIONS ARE        */
*/*                    BEING SCANNED.                                */
*/*          RECRDPTR- POINTER TO CHARACTER STRING TO BE SCANNED     */
*/*          SCNLIMIT- POSITION OF LAST CHARACTER OF THE STRING TO   */
*/*                    BE SCANNED.                                   */
*/*          CHAR1 -   FIRST CHARACTER OF PARAMETER OPTIONS STRING   */
*/*          SCANINDX- POSITION WITHIN CHARACTER STRING BEING        */
*/*                    SCANNED AT WHICH TO BEGIN THE SCANNING.       */
*/*          VERBNAME- VERB NAME GENERATED WHEN PARAMETER OPTIONS    */
*/*                    ARE BEING SCANNED.                            */
*/*          LASTCC -  LAST AMS SYSTEM CONDITION CODE                */
*/*          RISTATUS- R/I INTERNAL STATUS CODE                      */
*/*          LOADTPTR- POINTER TO DESCRIPTOR LOAD MODULE NAME TABLE  */
*/*          KWTBLPTR- POINTER TO MODAL COMMAND KEYWORD AND VERB     */
*/*                    SYMBOL TABLE                                  */
*/*          FINALCHR- SIGNALS THAT EOF HAS NOT BEEN FOUND YET       */
*/*                                                                  */
*/********************************************************************/
*RIINIT: PROCEDURE;                                                0307
@EL00001 L     @13,4(,@13)                                         0307
@EF00001 L     @00,@SIZDATD                                        0307
         LR    @01,@06                                             0307
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0307
         BR    @14                                                 0307
RIINIT   STM   @14,@12,@SA00002                                    0307
*        /************************************************************/
*        /*                                                          */
*        /* READER/INTERPRETER INITIALIZATION DATA DEFINITIONS       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0308
*        DCL OPTSPTR PTR(31)           /*POINTER TO PARAMETER OPTIONS*/
*                    BASED(GDTPRM);                                0308
*                                                                  0308
*        /*PARAMETER OPTIONS CHARACTER STRING                        */
*        DCL 1 PARMOPTS CHAR(*) BASED(OPTSPTR) BDY(HWORD),         0309
*              2 OPTSLEN FIXED(15);    /*LENGTH OF OPTIONS STRING    */
*                                                                  0309
*        DCL LMGNDFLT FIXED(15)        /*LEFT COMMAND MARGIN DEFAULT */
*                     CONSTANT(2);                                 0310
*        DCL RMGNDFLT FIXED(15)        /*RIGHT COMMAND MARGIN DEFAULT*/
*                     CONSTANT(72);                                0311
*        DCL LTBLNAME CHAR(8)          /*LOAD NAME OF THE DESCRIPTOR */
*                     INIT('IDCRILT ');/* LOAD MODULE NAME TABLE     */
*        DCL KTBLNAME CHAR(8)          /*LOAD NAME OF TABLE OF       */
*                     INIT('IDCRIKT ');/* MODAL KEYWORDS             */
*        /************************************************************/
*        /*                                                          */
*        /*  ** RIINIT **  READER/INTERPRETER INITIALIZATION ROUTINE */
*        /*                                                          */
*        /************************************************************/
*                                                                  0314
*        /************************************************************/
*        /*                                                          */
*        /*  OBTAIN SPACE FOR THE R/I HISTORICAL DATA AREA AND FOR   */
*        /*  THE UPRINT ARGUMENT STRUCTURE , INITIALIZING THE SPACE  */
*        /*  TO ZEROES.                                              */
*        /*                                                          */
*        /************************************************************/
*        AMTTOGET=HDASIZE;                                         0314
*                                                                  0314
         MVC   AMTTOGET(4),@CF00794                                0314
*        CALL IDCSAGS0(GDTTBL,AMTTOGET,GDTRIH,SETZERO);            0315
         ST    GDTPTR,@AL00001                                     0315
         LA    @02,AMTTOGET                                        0315
         ST    @02,@AL00001+4                                      0315
         LA    @02,GDTRIH(,GDTPTR)                                 0315
         ST    @02,@AL00001+8                                      0315
         LA    @02,SETZERO                                         0315
         ST    @02,@AL00001+12                                     0315
         MVI   @AL00001+12,X'80'                                   0315
         L     @15,GDTGSP(,GDTPTR)                                 0315
         LA    @01,@AL00001                                        0315
         BALR  @14,@15                                             0315
*        RESPECIFY RTNREG RSTD;                                    0316
*        TESTRC = RTNREG;                                          0317
         STH   RTNREG,TESTRC                                       0317
*        RESPECIFY RTNREG UNRSTD;                                  0318
*                                                                  0318
*        IF TESTRC^=0                                              0319
*          THEN                                                    0319
         LH    @02,TESTRC                                          0319
         LTR   @02,@02                                             0319
         BZ    @RF00319                                            0319
*            DO;                                                   0320
*            LASTCC=TERMERR;                                       0321
         MVC   LASTCC(2),@CH00482                                  0321
*            RISTATUS=NOSPACE;                                     0322
         MVC   RISTATUS(2),@CH00811                                0322
*            END;                                                  0323
*                                                                  0323
*          /**********************************************************/
*          /*                                                        */
*          /* OBTAIN DESCRIPTOR LOAD MODULE NAME TABLE , OBTAIN THE  */
*          /* MODAL COMMAND KEYWORD TABLE (CONTAINS THE KEYWORDS TO  */
*          /* BE USED FOR MODAL COMMANDS - MAY BE IN ANY LANGUAGE),  */
*          /* INITIALIZE COMMAND SOURCE MARGINS, AND OPEN SYSIN FILE.*/
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    0324
*            DO;                                                   0324
*                                                                  0324
         B     @RC00319                                            0324
@RF00319 DS    0H                                                  0325
*              CALL IDCSALD0(GDTTBL,LTBLNAME,LOADTPTR);            0325
         ST    GDTPTR,@AL00001                                     0325
         LA    @15,LTBLNAME                                        0325
         ST    @15,@AL00001+4                                      0325
         L     @01,GDTRIH(,GDTPTR)                                 0325
         LA    @15,LOADTPTR(,@01)                                  0325
         ST    @15,@AL00001+8                                      0325
         L     @15,GDTLOD(,GDTPTR)                                 0325
         LA    @01,@AL00001                                        0325
         BALR  @14,@15                                             0325
*              CALL IDCSALD0(GDTTBL,KTBLNAME,KWTBLPTR);            0326
*                                                                  0326
         ST    GDTPTR,@AL00001                                     0326
         LA    @15,KTBLNAME                                        0326
         ST    @15,@AL00001+4                                      0326
         L     @01,GDTRIH(,GDTPTR)                                 0326
         LA    @15,KWTBLPTR(,@01)                                  0326
         ST    @15,@AL00001+8                                      0326
         L     @15,GDTLOD(,GDTPTR)                                 0326
         LA    @01,@AL00001                                        0326
         BALR  @14,@15                                             0326
*              LEFTMGN=LMGNDFLT;                                   0327
         L     @15,GDTRIH(,GDTPTR)                                 0327
         MVC   LEFTMGN(2,@15),@CH00163                             0327
*              RIGHTMGN=RMGNDFLT;                                  0328
*                                                                  0328
         MVC   RIGHTMGN(2,@15),@CH00914                            0328
*              OPNPTR=ADDR(OPENAREA);                              0329
         LA    OPNPTR,OPENAREA                                     0329
*              OPNAGL=''B;                                         0330
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0330
*              OPNTYPSI=ON;                                        0331
         OI    OPNTYPSI(OPNPTR),B'10000000'                        0331
*              OPNIOC=ADDR(ADDRIOCS);                              0332
*                                                                  0332
         LA    @15,ADDRIOCS(,@15)                                  0332
         ST    @15,OPNIOC(,OPNPTR)                                 0332
*              CALL IDCIOOP0(GDTTBL,OPNAGL);                       0333
         ST    GDTPTR,@AL00001                                     0333
         ST    OPNPTR,@AL00001+4                                   0333
         MVI   @AL00001+4,X'80'                                    0333
         L     @15,GDTOPN(,GDTPTR)                                 0333
         LA    @01,@AL00001                                        0333
         BALR  @14,@15                                             0333
*              RESPECIFY RTNREG RSTD;                              0334
*              TESTRC = RTNREG;                                    0335
         STH   RTNREG,TESTRC                                       0335
*              RESPECIFY RTNREG UNRSTD;                            0336
*                                                                  0336
*              IF TESTRC ^= 0                                      0337
*                THEN                                              0337
         LH    @02,TESTRC                                          0337
         LTR   @02,@02                                             0337
         BZ    @RF00337                                            0337
*                  DO;                                             0338
*                  LASTCC=TERMERR;                                 0339
         MVC   LASTCC(2),@CH00482                                  0339
*                  RISTATUS=SKIPREST;                              0340
         MVC   RISTATUS(2),@CH00042                                0340
*                  END;                                            0341
*                ELSE                                              0342
*                                                                  0342
*                  /**************************************************/
*                  /*                                                */
*                  /*  IF A PARAMETER OPTIONS STRING EXISTS THEN SET */
*                  /*  IT UP AS IF IT WERE THE PARAMETER SET OF A    */
*                  /*  'PARM' COMMAND. ALSO PRINT THE OPTIONS.       */
*                  /*                                                */
*                  /**************************************************/
*                  IF GDTPRM^=0 & OPTSPTR^=0 & OPTSLEN^=0          0342
*                    THEN                                          0342
         B     @RC00337                                            0342
@RF00337 SLR   @02,@02                                             0342
         L     @15,GDTPRM(,GDTPTR)                                 0342
         CR    @15,@02                                             0342
         BE    @RF00342                                            0342
         L     @15,OPTSPTR(,@15)                                   0342
         CR    @15,@02                                             0342
         BE    @RF00342                                            0342
         LH    @14,OPTSLEN(,@15)                                   0342
         CR    @14,@02                                             0342
         BE    @RF00342                                            0342
*                      DO;                                         0343
*                      OPTSFLAG=ON;                                0344
         OI    OPTSFLAG,B'00100000'                                0344
*                      MORTOCOM=NO;                                0345
*                      FIRSTCHR=NO;                                0346
         NI    MORTOCOM,B'11101011'                                0346
*                      RECRDPTR=OPTSPTR+2;                         0347
         AH    @15,@CH00163                                        0347
         ST    @15,RECRDPTR                                        0347
*                      SCNLIMIT=OPTSLEN+1;                         0348
         LA    @02,1                                               0348
         LR    @05,@14                                             0348
         ALR   @05,@02                                             0348
         STH   @05,SCNLIMIT                                        0348
*                      CHAR1=INREC(1);                             0349
         MVC   CHAR1(1),INREC(@15)                                 0349
*                      CHAR2=INREC(2);                             0350
         MVC   CHAR2(1),INREC+1(@15)                               0350
*                      SCANINDX=1;                                 0351
         STH   @02,SCANINDX                                        0351
*                      VERBNAME=PARMSYM;                           0352
*                                                                  0352
         L     @02,GDTRIH(,GDTPTR)                                 0352
         L     @02,KWTBLPTR(,@02)                                  0352
         MVC   VERBNAME(8),PARMSYM(@02)                            0352
*                      DARGDBP=RECRDPTR;                           0353
         L     @02,DDSTRU                                          0353
         ST    @15,DARGDBP(,@02)                                   0353
*                      DARGILP=OPTSLEN;                            0354
         STH   @14,DARGILP(,@02)                                   0354
*                      DARGSMOD=RISTID;                            0355
         MVC   DARGSMOD(3,@02),RISTID                              0355
*                      DARGSENT=INRECID;                           0356
*                                                                  0356
         MVI   DARGSENT(@02),X'27'                                 0356
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       0357
*                                                                  0357
         ST    GDTPTR,@AL00001                                     0357
         LA    @02,@CF00125                                        0357
         ST    @02,@AL00001+4                                      0357
         LA    @02,DDSTRU                                          0357
         ST    @02,@AL00001+8                                      0357
         MVI   @AL00001+8,X'80'                                    0357
         L     @15,GDTPRT(,GDTPTR)                                 0357
         LA    @01,@AL00001                                        0357
         BALR  @14,@15                                             0357
*                      END;                                        0358
*                                                                  0358
*            END;                                                  0359
*                                                                  0359
*        END RIINIT;                                               0360
@EL00002 DS    0H                                                  0360
@EF00002 DS    0H                                                  0360
@ER00002 LM    @14,@12,@SA00002                                    0360
         BR    @14                                                 0360
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SCANCMD                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS THE INPUT COMMAND, USING THE      */
*/*             COMMAND DESCRIPTOR AS A BASIS FOR SCANNING.  KEYWORDS*/
*/*             ARE INTERPRETED AND SCALAR DATA IS EXTRACTED AND     */
*/*             USED TO BUILD A FUNCTION DATA TABLE.  SYNTAX AND     */
*/*             SEMANTIC CHECKING AND FDT BUILDING ARE DONE BASED    */
*/*             UPON COMMAND DESCRIPTOR INFORMATION.                 */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          OPTSFLAG- FLAG INDICATING WHETHER OR NOT A PARAMETER    */
*/*                    OPTIONS STRING IS BEING CURRENTLY SCANNED     */
*/*          RISTATUS- INTERNAL R/I STATUS CODE INDICATING WHETHER   */
*/*                    OR NOT AN ERROR HAS OCCURRED.                 */
*/*          CHAR1 -   MOST RECENT INPUT CHARACTER EXTRACTED         */
*/*          COMMAND DESCRIPTOR - DATA STRUCTURE CONTAINING DATA     */
*/*                               THAT DESCRIBES THE CURRENT COMMAND */
*/*                               BEING SCANNED.                     */
*/*          SUPERID - PUSHDOWN STACK OF PARAMETER ID#S OF           */
*/*                    SUPERPARAMETERS OF SUBPARAMETER LISTS         */
*/*                    CURRENTLY BEING SCANNED.                      */
*/*          REPDEPTH- LEVEL OF "REPEATEDNESS" NESTING OF PARAMETER  */
*/*                    LIST CURRENTLY BEING SCANNED.                 */
*/*          PARMLVL - LEVEL OF SUBPARAMETER NESTING OF PARAMETER    */
*/*                    LIST CURRENTLY BEING SCANNED.                 */
*/*          SCANONLY- FLAG INDICATING WHETHER OR NOT THE CURRENT    */
*/*                    COMMAND IS TO HAVE AN FDT BUILT OR IF IT IS   */
*/*                    JUST BEING SCANNED FOR SYNTAX ERRORS.         */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*          SUBSYET - INDICATES WHETHER OR NOT ANY SUBPARAMETERS    */
*/*                    HAVE BEEN FOUND YET IN CURRENT SUBPARM. LIST  */
*/*          PPARMCNT- ARRAY OF COUNTS OF POSITIONAL SUBPARAMETERS   */
*/*                    FOUND SO FAR IN CURRENT SUBPARM. LISTS        */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE                                     */
*/*          FINALCHR- FLAG INDICATING THAT THE LAST INPUT CHAR.     */
*/*                    HAS JUST BEEN EXTRACTED.                      */
*/*          INQUOTED- FLAG INDICATING THAT THE R/I IS CURRENTLY     */
*/*                    SCANNING WITHIN A QUOTED STRING.              */
*/*          PARMLVL - (SEE 'INPUT')                                 */
*/*          PPARMCNT- PUSHDOWN STACK OF COUNTS, EACH INDICATING     */
*/*                    HOW MANY POSITIONAL PARAMETERS HAVE BEEN      */
*/*                    FOUND AT A LEVEL OF PARAMETER LIST NESTING.   */
*/*          SUPERID - (SEE 'INPUT')                                 */
*/*          REPDEPTH- (SEE 'INPUT')                                 */
*/*          SKIPPAST- INDICATES THAT INITIALLY NO COMMAND HAS JUST  */
*/*                    BEEN BYPASSED DUE TO AN ERROR IN IT.          */
*/*          EOFOK -   FLAG INDICATING WHETHER OR NOT THE SCAN IS    */
*/*                    CURRENTLY AT A POINT WHERE THE OCCURRENCE OF  */
*/*                    INPUT END-OF-FILE WOULD NOT BE AN ERROR.      */
*/*          BLKLEFT - NUMBER OF BYTES OF SPACE REMAINING TO BE      */
*/*                    ALLOCATED FOR FDT SCALAR DATA STRUCTURES.     */
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING EXAMINED     */
*/*          FDTPTR -  PRIMARY FDT VECTOR OF POINTERS.               */
*/*          ARRYPTR - POINTER TO AN INTERMEDIATE FDT POINTER VECTOR */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*          SUBSYET - SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*SCANCMD:PROCEDURE;                                                0361
SCANCMD  STM   @14,@03,@SA00003                                    0361
         STM   @06,@12,@SA00003+24                                 0361
*        /************************************************************/
*        /*                                                          */
*        /* SCANCMD PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL STMTEND  BIT(1);          /*SIGNALS THAT THE END OF THE
*                                        COMMAND HAS BEEN FOUND      */
*        DCL PRMFOUND BIT(1);          /*SIGNALS THAT NEXT PARAMETER
*                                        IS TO BE EXTRACTED          */
*        DCL WORKPTR2 PTR(31);         /*VARIABLE TO CONTAIN       0364
*                                        A TEMPORARY POINTER VALUE   */
*        DCL WORKPTR3 PTR(31);         /*VARIABLE TO CONTAIN       0365
*                                        A TEMPORARY POINTER VALUE   */
*        DCL SETUPERR FIXED(31);       /*ERROR CODE FOR ERROR FOUND
*                                        DURING DESCRIPTOR SET-UP    */
*                                                                  0366
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADPOS   FIXED(31)        /*TOO MANY POSITIONAL PARM'S  */
*                     CONSTANT(1);                                 0367
*        DCL TOOMANY  FIXED(31)        /*TOO MANY RIGHT PARENTHESES  */
*                     CONSTANT(34);    /* AT COMMAND TERMINATION     */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SCANCMD **  SCAN INPUT COMMAND & BUILD FDT           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0369
*        IF GDTDBG = NULLPTR                                       0369
*          THEN;                                                   0369
         ICM   @02,15,GDTDBG(GDTPTR)                               0369
         BZ    @RT00369                                            0369
*          ELSE                                                    0371
*            CALL IDCDB010(GDTTBL,'RISC');                         0371
*                                                                  0371
         ST    GDTPTR,@AL00001                                     0371
         LA    @02,@CC00930                                        0371
         ST    @02,@AL00001+4                                      0371
         MVI   @AL00001+4,X'80'                                    0371
         L     @15,GDTDBG(,GDTPTR)                                 0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*        STMTEND=NO;                                               0372
@RT00369 NI    STMTEND,B'01111111'                                 0372
*        FINALCHR=NO;                                              0373
         NI    FINALCHR,B'11111101'                                0373
*        PARMLVL=1;                                                0374
         LA    @02,1                                               0374
         STH   @02,PARMLVL                                         0374
*        PPARMCNT(1)=1;                                            0375
         STH   @02,PPARMCNT                                        0375
*        SUPERID(1)=0;                                             0376
         SLR   @02,@02                                             0376
         STH   @02,SUPERID                                         0376
*        REPDEPTH=0;                                               0377
         STH   @02,REPDEPTH                                        0377
*        SKIPPAST=NO;                                              0378
*        EOFOK=YES;                                                0379
         OI    EOFOK,B'01000000'                                   0379
         NI    SKIPPAST,B'11110111'                                0379
*        BLKLEFT=0;                                                0380
         ST    @02,BLKLEFT                                         0380
*        SCANONLY=NO;                                              0381
*                                                                  0381
         NI    SCANONLY,B'11101111'                                0381
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE COMMAND VERB (UNLESS NOW SCANNING PARAMETER  */
*        /* OPTIONS) AND CALL 'IDCRI02' TO SET UP THE APPROPRIATE    */
*        /* COMMAND DESCRIPTOR AND TO PREPARE FOR COMMAND SCANNING.  */
*        /* IF AN ERROR IS ENCOUNTERED DOING THIS, BYPASS THE        */
*        /* COMMAND.                                                 */
*        /*                                                          */
*        /************************************************************/
*        IF OPTSFLAG=OFF                                           0382
*          THEN                                                    0382
*                                                                  0382
         TM    OPTSFLAG,B'00100000'                                0382
         BNZ   @RF00382                                            0382
*            CALL GETNEXT;                                         0383
*                                                                  0383
         BAL   @14,GETNEXT                                         0383
*          ELSE                                                    0384
*                                                                  0384
*            CALL SCANSEP(NO);                                     0384
*                                                                  0384
         B     @RC00382                                            0384
@RF00382 LA    @01,@AL00384                                        0384
         BAL   @14,SCANSEP                                         0384
*        IF RISTATUS=0                                             0385
*          THEN                                                    0385
@RC00382 ICM   @02,3,RISTATUS                                      0385
         BNZ   @RF00385                                            0385
*            DO;                                                   0386
*                                                                  0386
*            CALL IDCRI02(GDTTBL,COMMAREA);                /*@YL026UL*/
*                                                                  0387
         ST    GDTPTR,@AL00001                                     0387
         LA    @02,COMMAREA                                        0387
         ST    @02,@AL00001+4                                      0387
         L     @15,@CV00621                                        0387
         LA    @01,@AL00001                                        0387
         BALR  @14,@15                                             0387
*            IF RISTATUS^=0                                        0388
*              THEN                                                0388
         LH    @02,RISTATUS                                        0388
         LTR   @02,@02                                             0388
         BZ    @RF00388                                            0388
*                DO;                                               0389
*                SETUPERR=RISTATUS;                                0390
         ST    @02,SETUPERR                                        0390
*                IF SETUPERR=NOSPACE                               0391
*                  THEN                                            0391
*                                                                  0391
         CH    @02,@CH00811                                        0391
         BNE   @RF00391                                            0391
*                    CALL ERROR1(SETUPERR);                        0392
*                                                                  0392
         LA    @02,SETUPERR                                        0392
         ST    @02,@AL00001                                        0392
         LA    @01,@AL00001                                        0392
         BAL   @14,ERROR1                                          0392
*                  ELSE                                            0393
*                                                                  0393
*                    CALL ERROR2(SETUPERR,LENGTH(ERRFIELD),        0393
*                                ADDR(ERRFIELD));                  0393
*                                                                  0393
         B     @RC00391                                            0393
@RF00391 LA    @02,SETUPERR                                        0393
         ST    @02,@AL00001                                        0393
         LA    @02,@CF00786                                        0393
         ST    @02,@AL00001+4                                      0393
         LA    @02,ERRFIELD                                        0393
         ST    @02,@AFTEMPS+12                                     0393
         LA    @02,@AFTEMPS+12                                     0393
         ST    @02,@AL00001+8                                      0393
         LA    @01,@AL00001                                        0393
         BAL   @14,ERROR2                                          0393
*                END;                                              0394
@RC00391 DS    0H                                                  0395
*            END;                                                  0395
*                                                                  0395
@RF00388 DS    0H                                                  0396
*        /************************************************************/
*        /*                                                          */
*        /* SCAN THE PARAMETER SET, EXTRACTING ONE PARAMETER AT A    */
*        /* TIME UNTIL THE STATEMENT END IS FOUND OR AN ERROR OCCURS.*/
*        /*                                                          */
*        /************************************************************/
*DOLOOP5:DO WHILE(STMTEND=NO & RISTATUS=0);                        0396
@RF00385 DS    0H                                                  0396
DOLOOP5  B     @DE00396                                            0396
@DL00396 DS    0H                                                  0397
*          OLDERID2 = NEWERID2;                                    0397
         L     @02,GDTTR2(,GDTPTR)                                 0397
         MVC   @TS00001(95),NEWERID2(@02)                          0397
         MVC   OLDERID2(95,@02),@TS00001                           0397
*          NEWID2='RI01';                                          0398
         MVC   NEWID2(4,@02),@CC00820                              0398
*          IF CHAR1=ENDDELIM                                       0399
*            THEN                                                  0399
         CLI   CHAR1,C';'                                          0399
         BNE   @RF00399                                            0399
*DOGRP5:       DO;                                                 0400
DOGRP5   DS    0H                                                  0401
*                STMTEND=YES;                                      0401
*                                                                  0401
         OI    STMTEND,B'10000000'                                 0401
*                /****************************************************/
*                /*                                                  */
*                /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING AT  */
*                /* COMMAND TERMINATION.  ISSUE A WARNING IF TOO FEW */
*                /* PARENTHESES APPEAR AT COMMAND END.               */
*                /*                                                  */
*                /****************************************************/
*                IF PARMLVL > 1                                    0402
*                  THEN                                            0402
         LH    @02,PARMLVL                                         0402
         CH    @02,@CH00228                                        0402
         BNH   @RF00402                                            0402
*                    DO;                                           0403
*                    DARGSMOD=RISTID;                              0404
         L     @02,DDSTRU                                          0404
         MVC   DARGSMOD(3,@02),RISTID                              0404
*                    DARGSENT=TOOFEW;                              0405
*                                                                  0405
         MVI   DARGSENT(@02),X'23'                                 0405
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         0406
*                                                                  0406
         ST    GDTPTR,@AL00001                                     0406
         LA    @02,@CF00125                                        0406
         ST    @02,@AL00001+4                                      0406
         LA    @02,DDSTRU                                          0406
         ST    @02,@AL00001+8                                      0406
         MVI   @AL00001+8,X'80'                                    0406
         L     @15,GDTPRT(,GDTPTR)                                 0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*                    END;                                          0407
*                                                                  0407
*                DO WHILE(PARMLVL>0);                              0408
@RF00402 B     @DE00408                                            0408
@DL00408 DS    0H                                                  0409
*                  PARMID=SUPERID(PARMLVL);                        0409
         LH    @02,PARMLVL                                         0409
         ALR   @02,@02                                             0409
         LH    @02,SUPERID-2(@02)                                  0409
         STH   @02,PARMID                                          0409
*                  IF PARMID=0                                     0410
*                    THEN                                          0410
         LTR   @02,@02                                             0410
         BNZ   @RF00410                                            0410
*                      DO;                                         0411
*                                                                  0411
*                      CALL DEFAULTS;                              0412
         BAL   @14,DEFAULTS                                        0412
*                      CALL NEEDNOTS;                              0413
*                                                                  0413
         BAL   @14,NEEDNOTS                                        0413
*                      END;                                        0414
*                    ELSE                                          0415
*                      IF REPEATED=YES                             0415
*                        THEN                                      0415
         B     @RC00410                                            0415
@RF00410 LH    @02,PARMID                                          0415
         MH    @02,@CH00038                                        0415
         L     @01,WORKPTR                                         0415
         AL    @01,@CF01440                                        0415
         L     @02,PARMPTR(@02,@01)                                0415
         TM    REPEATED(@02),B'00100000'                           0415
         BNO   @RF00415                                            0415
*                          DO;                                     0416
*                                                                  0416
*                          CALL DEFAULTS;                          0417
         BAL   @14,DEFAULTS                                        0417
*                          CALL NEEDNOTS;                          0418
*                                                                  0418
         BAL   @14,NEEDNOTS                                        0418
*                          REPDEPTH=REPDEPTH-1;                    0419
         LH    @02,REPDEPTH                                        0419
         BCTR  @02,0                                               0419
         STH   @02,REPDEPTH                                        0419
*                          END;                                    0420
*                  PARMLVL=PARMLVL-1;                              0421
@RF00415 DS    0H                                                  0421
@RC00410 LH    @02,PARMLVL                                         0421
         BCTR  @02,0                                               0421
         STH   @02,PARMLVL                                         0421
*                END;                                              0422
*                                                                  0422
@DE00408 SLR   @02,@02                                             0422
         CH    @02,PARMLVL                                         0422
         BL    @DL00408                                            0422
*                /****************************************************/
*                /*                                                  */
*                /* IF FDT BUILDING HAS COMPLETED OKAY, THEN CHECK   */
*                /* FOR PARAMETERS WITHIN THE FIRST LEVEL OF REPEATED*/
*                /* SUBLIST NESTING.  THE POINTERS WHICH POINT TO THE*/
*                /* SCALAR DATA OF THESE PARAMETERS ARE CURRENTLY IN */
*                /* THE FORM OF LISTS OF POINTER VECTOR BLOCKS.      */
*                /* REASSEMBLE EACH LIST INTO A SINGLE VECTOR OF PTRS*/
*                /*                                                  */
*                /****************************************************/
*                IF RISTATUS=0 & SCANONLY=NO                       0423
*                  THEN                                            0423
         CH    @02,RISTATUS                                        0423
         BNE   @RF00423                                            0423
         TM    SCANONLY,B'00010000'                                0423
         BNZ   @RF00423                                            0423
*DOLOOP7:            DO PARMID=1 TO MAXID WHILE(RISTATUS=0);       0424
DOLOOP7  LA    @02,1                                               0424
         B     @DE00424                                            0424
@DL00424 SLR   @15,@15                                             0424
         CH    @15,RISTATUS                                        0424
         BNE   @DC00424                                            0424
*                      IF PARMPTR(PARMID)^=NULLPTR & OCCURNUM > 1  0425
*                        THEN                                      0425
*                                                                  0425
         MH    @02,@CH00038                                        0425
         L     @01,WORKPTR                                         0425
         AL    @01,@CF01440                                        0425
         L     @02,PARMPTR(@02,@01)                                0425
         CR    @02,@15                                             0425
         BE    @RF00425                                            0425
         CLC   OCCURNUM(3,@02),@CF00228+1                          0425
         BNH   @RF00425                                            0425
*                          /******************************************/
*                          /*                                        */
*                          /* CHECK ALL PARAMETERS WITHIN REPEATED   */
*                          /* SUBLISTS TO SEE IF THEY ARE AT THE 1ST */
*                          /* LEVEL OF REPEAT NESTING.               */
*                          /*                                        */
*                          /******************************************/
*DOGRP6:                   DO;                                     0426
DOGRP6   DS    0H                                                  0427
*                          REPNEST=0;                              0427
         SLR   REPNEST,REPNEST                                     0427
*                          VLISTID=PARMID;                         0428
         LH    @15,PARMID                                          0428
         STH   @15,VLISTID                                         0428
*                          PARMID=SUPRPARM(PARMID);                0429
         MH    @15,@CH00038                                        0429
         L     @01,WORKPTR                                         0429
         AL    @01,@CF01441                                        0429
         LH    @15,SUPRPARM-8(@15,@01)                             0429
         STH   @15,PARMID                                          0429
*                          DO WHILE(PARMID^=0);                    0430
         B     @DE00430                                            0430
@DL00430 DS    0H                                                  0431
*                            IF REPEATED=YES                       0431
*                              THEN                                0431
         LH    @15,PARMID                                          0431
         MH    @15,@CH00038                                        0431
         L     @01,WORKPTR                                         0431
         AL    @01,@CF01440                                        0431
         L     @01,PARMPTR(@15,@01)                                0431
         TM    REPEATED(@01),B'00100000'                           0431
         BNO   @RF00431                                            0431
*                                REPNEST=REPNEST+1;                0432
         AL    REPNEST,@CF00228                                    0432
*                            PARMID=SUPRPARM(PARMID);              0433
@RF00431 LH    @15,PARMID                                          0433
         MH    @15,@CH00038                                        0433
         L     @01,WORKPTR                                         0433
         AL    @01,@CF01441                                        0433
         LH    @15,SUPRPARM-8(@15,@01)                             0433
         STH   @15,PARMID                                          0433
*                          END;                                    0434
@DE00430 ICM   @15,3,PARMID                                        0434
         BNZ   @DL00430                                            0434
*                          PARMID=VLISTID;                         0435
         MVC   PARMID(2),VLISTID                                   0435
*                          IF REPNEST=1                            0436
*                            THEN                                  0436
*                                                                  0436
         CH    REPNEST,@CH00228                                    0436
         BNE   @RF00436                                            0436
*                              /**************************************/
*                              /*                                    */
*                              /* FOR PARAMETERS HAVING THE LISTS OF */
*                              /* POINTER BLOCKS, ALLOCATE ENOUGH    */
*                              /* SPACE FOR A SINGLE PTR BLOCK AND   */
*                              /* MOVE THE POINTERS FROM THE LIST    */
*                              /* INTO THE SINGLE VECTOR OF POINTERS.*/
*                              /* THEN FREE UP THE 'LIST' SPACE.     */
*                              /*                                    */
*                              /**************************************/
*DOGRP7:                       DO;                                 0437
DOGRP7   DS    0H                                                  0438
*                              VECTRNUM=1;                         0438
         MVC   VECTRNUM(2),@CH00228                                0438
*                              ARRYPTR=FDTPTR(PARMID);             0439
         LH    @15,PARMID                                          0439
         SLA   @15,2                                               0439
         L     @01,FDTADDR                                         0439
         L     ARRYPTR,FDTPTR-4(@15,@01)                           0439
*                              DO WHILE(VECTRPTR^=0);              0440
         B     @DE00440                                            0440
@DL00440 DS    0H                                                  0441
*                                VECTRNUM=VECTRNUM+1;              0441
         LH    @01,VECTRNUM                                        0441
         LA    @01,1(,@01)                                         0441
         STH   @01,VECTRNUM                                        0441
*                                ARRYPTR=VECTRPTR;                 0442
         LR    @15,ARRYPTR                                         0442
         AH    @15,VECTRLEN                                        0442
         L     @15,VECTRPTR(,@15)                                  0442
         LR    ARRYPTR,@15                                         0442
*                              END;                                0443
@DE00440 LH    @15,VECTRLEN                                        0443
         LR    @14,ARRYPTR                                         0443
         ALR   @14,@15                                             0443
         ICM   @01,15,VECTRPTR(@14)                                0443
         BNZ   @DL00440                                            0443
*                              AMTTOGET=VECTRNUM*VECTRLEN;         0444
         MH    @15,VECTRNUM                                        0444
         ST    @15,AMTTOGET                                        0444
*                              WORKPTR2=FDTPTR(PARMID);            0445
*                                                                  0445
         L     @02,FDTADDR                                         0445
         LH    @15,PARMID                                          0445
         SLA   @15,2                                               0445
         L     @14,FDTPTR-4(@15,@02)                               0445
         ST    @14,WORKPTR2                                        0445
*                              CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTPTR(PAR
*ID),                                                              0446
*                                     POOLID,SETZERO);             0446
         ST    GDTPTR,@AL00001                                     0446
         LA    @14,AMTTOGET                                        0446
         ST    @14,@AL00001+4                                      0446
         LA    @02,FDTPTR-4(@15,@02)                               0446
         ST    @02,@AL00001+8                                      0446
         LA    @02,POOLID                                          0446
         ST    @02,@AL00001+12                                     0446
         LA    @02,SETZERO                                         0446
         ST    @02,@AL00001+16                                     0446
         MVI   @AL00001+16,X'80'                                   0446
         L     @15,GDTGPL(,GDTPTR)                                 0446
         LA    @01,@AL00001                                        0446
         BALR  @14,@15                                             0446
*                              RESPECIFY RTNREG RSTD;              0447
*                              TESTRC = RTNREG;                    0448
         STH   RTNREG,TESTRC                                       0448
*                              RESPECIFY RTNREG UNRSTD;            0449
*                                                                  0449
*                              WORKPTR3=FDTPTR(PARMID);            0450
         LH    @02,PARMID                                          0450
         SLA   @02,2                                               0450
         L     @01,FDTADDR                                         0450
         L     @02,FDTPTR-4(@02,@01)                               0450
         ST    @02,WORKPTR3                                        0450
*                              IF TESTRC=0                         0451
*                                THEN                              0451
         LH    @02,TESTRC                                          0451
         LTR   @02,@02                                             0451
         BNZ   @RF00451                                            0451
*                                  DO INDEX=1 TO VECTRNUM;         0452
         LA    @02,1                                               0452
         B     @DE00452                                            0452
@DL00452 DS    0H                                                  0453
*                                    WORKPTR3->DATABLK(1:VECTRLEN)=
*                                      WORKPTR2->DATABLK(1:VECTRLEN);
         L     @15,WORKPTR3                                        0453
         LH    @14,VECTRLEN                                        0453
         LR    @01,@14                                             0453
         BCTR  @01,0                                               0453
         L     @00,WORKPTR2                                        0453
         LR    @02,@00                                             0453
         EX    @01,@SM01442                                        0453
*                                    WORKPTR3=WORKPTR3+VECTRLEN;   0454
         ALR   @15,@14                                             0454
         ST    @15,WORKPTR3                                        0454
*                                    WORKPTR2=                     0455
*                                      (WORKPTR2+VECTRLEN)->VECTRPTR;
         ALR   @00,@14                                             0455
         LR    @02,@00                                             0455
         L     @02,VECTRPTR(,@02)                                  0455
         ST    @02,WORKPTR2                                        0455
*                                  END;                            0456
         LH    @15,INDEX                                           0456
         AL    @15,@CF00228                                        0456
         LR    @02,@15                                             0456
@DE00452 STH   @02,INDEX                                           0456
         CH    @02,VECTRNUM                                        0456
         BNH   @DL00452                                            0456
*                                ELSE                              0457
*                                                                  0457
*                                  CALL ERROR1(NOSPACE);           0457
*                                                                  0457
         B     @RC00451                                            0457
@RF00451 LA    @01,@AL00457                                        0457
         BAL   @14,ERROR1                                          0457
*                              CALL IDCSAFP0(GDTTBL,RIPOOLID);     0458
*                                                                  0458
@RC00451 ST    GDTPTR,@AL00001                                     0458
         LA    @02,RIPOOLID                                        0458
         ST    @02,@AL00001+4                                      0458
         MVI   @AL00001+4,X'80'                                    0458
         L     @15,GDTFPL(,GDTPTR)                                 0458
         LA    @01,@AL00001                                        0458
         BALR  @14,@15                                             0458
*                              END DOGRP7;                         0459
*                          END DOGRP6;                             0460
@RF00436 DS    0H                                                  0461
*                    END DOLOOP7;                                  0461
*                                                                  0461
@RF00425 LA    @02,1                                               0461
         AH    @02,PARMID                                          0461
@DE00424 STH   @02,PARMID                                          0461
         L     @01,DESCPTR                                         0461
         CH    @02,MAXID(,@01)                                     0461
         BNH   @DL00424                                            0461
@DC00424 DS    0H                                                  0462
*                /****************************************************/
*                /*                                                  */
*                /* IN PREPARATION FOR PICKING UP THE NEXT COMMAND,  */
*                /* BYPASS ALL CHARACTERS ASSOCIATED WITH THE CURRENT*/
*                /* COMMAND.                                         */
*                /*                                                  */
*                /****************************************************/
*                DO WHILE(MORTOCOM=YES & RISTATUS=0);              0462
*                                                                  0462
@RF00423 B     @DE00462                                            0462
@DL00462 DS    0H                                                  0463
*                  CALL NEXTCHAR;                                  0463
         BAL   @14,NEXTCHAR                                        0463
*                  CALL SKIPCMD;                                   0464
*                                                                  0464
         BAL   @14,SKIPCMD                                         0464
*                END;                                              0465
@DE00462 TM    MORTOCOM,B'00010000'                                0465
         BNO   @DC00462                                            0465
         ICM   @02,3,RISTATUS                                      0465
         BZ    @DL00462                                            0465
@DC00462 DS    0H                                                  0466
*              END DOGRP5;                                         0466
*                                                                  0466
*            /********************************************************/
*            /*                                                      */
*            /* THE END OF THE CURRENT COMMAND HAS NOT BEEN REACHED  */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  0467
*              IF SUPERID(PARMLVL)=0                               0467
*                  THEN                                            0467
*                                                                  0467
         B     @RC00399                                            0467
@RF00399 LH    @02,PARMLVL                                         0467
         ALR   @02,@02                                             0467
         LH    @02,SUPERID-2(@02)                                  0467
         LTR   @02,@02                                             0467
         BNZ   @RF00467                                            0467
*                    /************************************************/
*                    /*                                              */
*                    /* IF FIRST-LEVEL PARAMETERS ARE BEING SCANNED  */
*                    /* AND THE SCAN CURRENTLY POINTS TO A CLOSING   */
*                    /* PARENTHESIS, THEN TOO MANY PARENTHESES HAVE  */
*                    /* BEEN CODED AND WILL THEREFORE BE IGNORED.    */
*                    /* A WARNING MESSAGE IS ISSUED.                 */
*                    /*                                              */
*                    /************************************************/
*DOGRP10:            DO;                                           0468
DOGRP10  DS    0H                                                  0469
*                    OLDERID2 = NEWERID2;                          0469
         L     @02,GDTTR2(,GDTPTR)                                 0469
         MVC   @TS00001(95),NEWERID2(@02)                          0469
         MVC   OLDERID2(95,@02),@TS00001                           0469
*                    NEWID2='RI02';                                0470
         MVC   NEWID2(4,@02),@CC00951                              0470
*                    IF CHAR1 = CLOSING                            0471
*                      THEN                                        0471
         CLI   CHAR1,C')'                                          0471
         BNE   @RF00471                                            0471
*                        DO WHILE(RISTATUS=0 & CHAR1=CLOSING);     0472
         B     @DE00472                                            0472
@DL00472 DS    0H                                                  0473
*                          DARGSMOD=RISTID;                        0473
         L     @02,DDSTRU                                          0473
         MVC   DARGSMOD(3,@02),RISTID                              0473
*                          DARGSENT=TOOMANY;                       0474
*                                                                  0474
         MVI   DARGSENT(@02),X'22'                                 0474
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   0475
*                                                                  0475
         ST    GDTPTR,@AL00001                                     0475
         LA    @02,@CF00125                                        0475
         ST    @02,@AL00001+4                                      0475
         LA    @02,DDSTRU                                          0475
         ST    @02,@AL00001+8                                      0475
         MVI   @AL00001+8,X'80'                                    0475
         L     @15,GDTPRT(,GDTPTR)                                 0475
         LA    @01,@AL00001                                        0475
         BALR  @14,@15                                             0475
*                          CALL NEXTCHAR;                          0476
         BAL   @14,NEXTCHAR                                        0476
*                          CALL SCANSEP(YES);                      0477
*                                                                  0477
         LA    @01,@AL00477                                        0477
         BAL   @14,SCANSEP                                         0477
*                        END;                                      0478
*                                                                  0478
@DE00472 ICM   @02,3,RISTATUS                                      0478
         BNZ   @DC00472                                            0478
         CLI   CHAR1,C')'                                          0478
         BE    @DL00472                                            0478
@DC00472 DS    0H                                                  0479
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /* IF COMMAND END HAS NOT BEEN FOUND, THEN      */
*                    /* EXTRACT A FIRST-LEVEL PARAMETER, AFTER       */
*                    /* CHECKING THE DESCRIPTOR LIST TO SEE IF IT    */
*                    /* IS TO BE A POSITIONAL OR KEYWORD PARAMETER.  */
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                    IF RISTATUS^=0  CHAR1=ENDDELIM               0479
*                      THEN;                                       0479
@RF00471 ICM   @02,3,RISTATUS                                      0479
         BNZ   @RT00479                                            0479
         CLI   CHAR1,C';'                                          0479
         BE    @RT00479                                            0479
*                      ELSE                                        0481
*                                                                  0481
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* IF NO LIST OF POSITIONAL PARAMETERS IS   */
*                        /* SPECIFIED IN THE DESCRIPTOR, THEN ALL    */
*                        /* FIRST-LEVEL PARM'S ARE KEYWORD PARM'S.   */
*                        /* ALSO, IF ALL FIRST-LEVEL POSITIONALS     */
*                        /* HAVE BEEN EXTRACTED, EXPECT A KEYWORD.   */
*                        /* IF NEITHER OF THE ABOVE, EXPECT A        */
*                        /* POSITIONAL PARAMETER.            @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                        IF POSDSPL=0                             0481
*                           PPARMCNT(PARMLVL) > VPOSCNT            0481
*                          THEN                                    0481
*                                                                  0481
         L     @02,DESCPTR                                         0481
         CLI   POSDSPL(@02),0                                      0481
         BE    @RT00481                                            0481
         LH    @15,PARMLVL                                         0481
         ALR   @15,@15                                             0481
         SLR   @14,@14                                             0481
         IC    @14,POSDSPL(,@02)                                   0481
         ALR   @14,@14                                             0481
         ALR   @02,@14                                             0481
         LH    @15,PPARMCNT-2(@15)                                 0481
         CH    @15,VPOSCNT(,@02)                                   0481
         BNH   @RF00481                                            0481
@RT00481 DS    0H                                                  0482
*                            CALL KWDPARM;                 /*@YL026UL*/
*                                                                  0482
         BAL   @14,KWDPARM                                         0482
*                          ELSE                                    0483
*                            DO;                                   0483
         B     @RC00481                                            0483
@RF00481 DS    0H                                                  0484
*                            PARMID=                               0484
*                                VPOSID(PPARMCNT(PARMLVL));/*@YL026UL*/
*                                                                  0484
         LH    @02,PARMLVL                                         0484
         ALR   @02,@02                                             0484
         LH    @02,PPARMCNT-2(@02)                                 0484
         ALR   @02,@02                                             0484
         L     @15,DESCPTR                                         0484
         SLR   @14,@14                                             0484
         IC    @14,POSDSPL(,@15)                                   0484
         ALR   @14,@14                                             0484
         ALR   @15,@14                                             0484
         LH    @02,VPOSID-2(@02,@15)                               0484
         STH   @02,PARMID                                          0484
*                            CALL POSPARM;                         0485
*                                                                  0485
         BAL   @14,POSPARM                                         0485
*                            END;                                  0486
*                    END DOGRP10;                                  0487
*                  ELSE                                            0488
*                                                                  0488
*                    /************************************************/
*                    /*                                              */
*                    /* IF A SUBPARAMETER LIST IS BEING SCANNED AND  */
*                    /* THE SCAN CURRENTLY POINTS TO A CLOSING       */
*                    /* PARENTHESIS, THEN THE CURRENT SUBPARAMETER   */
*                    /* LIST SCAN IS FINISHED.  MAKE SURE THAT SOME  */
*                    /* SUBPARAMETERS WERE FOUND.                    */
*                    /*                                              */
*                    /************************************************/
*                    IF CHAR1=CLOSING                              0488
*                      THEN                                        0488
         B     @RC00467                                            0488
@RF00467 CLI   CHAR1,C')'                                          0488
         BNE   @RF00488                                            0488
*                        IF SUBSYET=NO                             0489
*                          THEN                                    0489
*                                                                  0489
         TM    SUBSYET,B'00010000'                                 0489
         BNZ   @RF00489                                            0489
*                            CALL ERROR2(BADELIM1,LENGTH(CHAR1),   0490
*                                        ADDR(CHAR1));             0490
*                                                                  0490
         MVC   @AL00001(8),@AL00490                                0490
         LA    @02,CHAR1                                           0490
         ST    @02,@AFTEMPS+12                                     0490
         LA    @02,@AFTEMPS+12                                     0490
         ST    @02,@AL00001+8                                      0490
         LA    @01,@AL00001                                        0490
         BAL   @14,ERROR2                                          0490
*                          ELSE                                    0491
*                            DO;                                   0491
         B     @RC00489                                            0491
@RF00489 DS    0H                                                  0492
*                              PARMID=SUPERID(PARMLVL);            0492
*                                                                  0492
         LH    @02,PARMLVL                                         0492
         ALR   @02,@02                                             0492
         LH    @02,SUPERID-2(@02)                                  0492
         STH   @02,PARMID                                          0492
*                              CALL NEXTCHAR;                      0493
*                                                                  0493
         BAL   @14,NEXTCHAR                                        0493
*                              IF RISTATUS=0                       0494
*                                THEN                              0494
         ICM   @02,3,RISTATUS                                      0494
         BNZ   @RF00494                                            0494
*                                  IF REPEATED=NO                  0495
*                                    THEN                          0495
         LH    @02,PARMID                                          0495
         MH    @02,@CH00038                                        0495
         L     @01,WORKPTR                                         0495
         AL    @01,@CF01440                                        0495
         L     @02,PARMPTR(@02,@01)                                0495
         TM    REPEATED(@02),B'00100000'                           0495
         BNZ   @RF00495                                            0495
*                                      DO;                         0496
*                                                                  0496
*                                      CALL SCANSEP(YES);          0497
*                                                                  0497
         LA    @01,@AL00497                                        0497
         BAL   @14,SCANSEP                                         0497
*                                      PARMLVL=PARMLVL-1;          0498
         LH    @02,PARMLVL                                         0498
         BCTR  @02,0                                               0498
         STH   @02,PARMLVL                                         0498
*                                      END;                        0499
*                                                                  0499
*                                    /********************************/
*                                    /*                              */
*                                    /* WHEN CURRENTLY SCANNING      */
*                                    /* WITHIN A REPEATED SUBPARM.   */
*                                    /* LIST, TREAT EACH SUBLIST     */
*                                    /* SEPARATELY, APPLYING DEFAULTS*/
*                                    /* AND PERFORMING SEMANTIC      */
*                                    /* CHECKING.                    */
*                                    /*                              */
*                                    /********************************/
*                                    ELSE                          0500
*                                                                  0500
*                                      CALL INREPEAT;              0500
*                                                                  0500
         B     @RC00495                                            0500
@RF00495 BAL   @14,INREPEAT                                        0500
*                            END;                                  0501
*                                                                  0501
*                      /**********************************************/
*                      /*                                            */
*                      /* A SUBPARAMETER LIST HAS ADDITIONAL         */
*                      /* SUBPARAMETERS TO BE SCANNED.               */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        0502
*                                                                  0502
*                        /********************************************/
*                        /*                                          */
*                        /* EXAMINE THE DESCRIPTOR SUBPARM LIST FOR  */
*                        /* THIS PARAMETER TO SEE IF A POSITIONAL    */
*                        /* PARM. REMAINS TO BE EXTRACTED OR IF A    */
*                        /* KEYWORD PARAMETER SHOULD BE PICKED UP.   */
*                        /*                                          */
*                        /********************************************/
*DOGRP15:                DO;                                       0502
         B     @RC00488                                            0502
@RF00488 DS    0H                                                  0502
DOGRP15  DS    0H                                                  0503
*                          SUBSYET=YES;                            0503
         OI    SUBSYET,B'00010000'                                 0503
*                          PARMID=SUPERID(PARMLVL);                0504
         LH    @02,PARMLVL                                         0504
         ALR   @02,@02                                             0504
         LH    @15,SUPERID-2(@02)                                  0504
         STH   @15,PARMID                                          0504
*                          IF PPARMCNT(PARMLVL) <= SUBCOUNT        0505
*                            THEN                                  0505
         LH    @02,PPARMCNT-2(@02)                                 0505
         LA    @14,12                                              0505
         MR    @14,@14                                             0505
         L     @01,WORKPTR                                         0505
         AL    @01,@CF01440                                        0505
         L     @15,PARMPTR(@15,@01)                                0505
         LA    @14,12                                              0505
         ALR   @14,@15                                             0505
         SLR   @01,@01                                             0505
         IC    @01,SUBDSPL(,@14)                                   0505
         ALR   @01,@01                                             0505
         ALR   @15,@01                                             0505
         CH    @02,SUBCOUNT(,@15)                                  0505
         BH    @RF00505                                            0505
*                              DO;                                 0506
*                              OLDERID2 = NEWERID2;                0507
         L     @14,GDTTR2(,GDTPTR)                                 0507
         MVC   @TS00001(95),NEWERID2(@14)                          0507
         MVC   OLDERID2(95,@14),@TS00001                           0507
*                              NEWID2='RI03';                      0508
         MVC   NEWID2(4,@14),@CC00957                              0508
*                              IF PARMTYPE(PPARMCNT(PARMLVL)) = 'K'
*                                THEN                              0509
*                                                                  0509
         SLA   @02,2                                               0509
         ALR   @15,@02                                             0509
         BCTR  @15,0                                               0509
         BCTR  @15,0                                               0509
         CLI   PARMTYPE-2(@15),C'K'                                0509
         BNE   @RF00509                                            0509
*                                  CALL KWDPARM;                   0510
*                                                                  0510
         BAL   @14,KWDPARM                                         0510
*                                ELSE                              0511
*                                  DO;                             0511
         B     @RC00509                                            0511
@RF00509 DS    0H                                                  0512
*                                  PARMID=SUBID(PPARMCNT(PARMLVL));
*                                                                  0512
         LH    @02,PARMLVL                                         0512
         ALR   @02,@02                                             0512
         LH    @02,PPARMCNT-2(@02)                                 0512
         SLA   @02,2                                               0512
         LA    @15,12                                              0512
         LR    @14,@15                                             0512
         MH    @14,PARMID                                          0512
         L     @01,WORKPTR                                         0512
         AL    @01,@CF01440                                        0512
         L     @14,PARMPTR(@14,@01)                                0512
         ALR   @15,@14                                             0512
         SLR   @01,@01                                             0512
         IC    @01,SUBDSPL(,@15)                                   0512
         ALR   @01,@01                                             0512
         ALR   @14,@01                                             0512
         LH    @02,SUBID-4(@02,@14)                                0512
         STH   @02,PARMID                                          0512
*                                  CALL POSPARM;                   0513
*                                                                  0513
         BAL   @14,POSPARM                                         0513
*                                  END;                            0514
*                              END;                                0515
*                                                                  0515
*                            /****************************************/
*                            /*                                      */
*                            /* IF NO SUBPARAMETERS OF THE CURRENT   */
*                            /* SUPERPARAMETER REMAIN TO BE EXTRACTED*/
*                            /* A SYNTAX ERROR HAS BEEN FOUND.       */
*                            /*                                      */
*                            /****************************************/
*                            ELSE                                  0516
*                                                                  0516
*                              CALL ERROR2(BADPOS,LENGTH(ERRFIELD),
*                                          ADDR(ERRFIELD));        0516
*                                                                  0516
         B     @RC00505                                            0516
@RF00505 MVC   @AL00001(8),@AL00516                                0516
         LA    @02,ERRFIELD                                        0516
         ST    @02,@AFTEMPS+12                                     0516
         LA    @02,@AFTEMPS+12                                     0516
         ST    @02,@AL00001+8                                      0516
         LA    @01,@AL00001                                        0516
         BAL   @14,ERROR2                                          0516
*                        END DOGRP15;                              0517
@RC00505 DS    0H                                                  0518
*        END DOLOOP5;                                              0518
@RC00488 DS    0H                                                  0518
@RC00467 DS    0H                                                  0518
@RC00399 DS    0H                                                  0518
@DE00396 TM    STMTEND,B'10000000'                                 0518
         BNZ   @DC00396                                            0518
         ICM   @02,3,RISTATUS                                      0518
         BZ    @DL00396                                            0518
@DC00396 DS    0H                                                  0519
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETNEXT                                        */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE OBTAINS THE VERB NAME AND POINTER TO  */
*/*             THE PARAMETER SET OF THE NEXT FUNCTION COMMAND.      */
*/*             MODAL COMMANDS ARE INTERPRETED TO DETERMINE OF THE   */
*/*             NEXT FUNCTION COMMAND FOUND IS TO BE RETURNED IN     */
*/*             ENCODED FORM TO THE AMS EXECUTIVE FOR EXECUTION.     */
*/*             FUNCTION COMMANDS WHICH ARE NOT TO BE ENCODED OR     */
*/*             RETURNED WILL SIMPLY BE EXAMINED FOR CORRECT SYNTAX  */
*/*             AND THEN BYPASSED.  WHEN REQUIRED, A NEW INPUT RECORD*/
*/*             IS READ IN ORDER TO OBTAIN THE NEXT FUNCTION OR MODAL*/
*/*             COMMAND SYNTACTIC UNIT.                              */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          SCANONLY - FLAG INDICATING WHETHER OR NOT THE CURRENT   */
*/*                     COMMAND IS TO BE ENCODED INTO AN FDT OR JUST */
*/*                     SCANNED FOR SYNTAX CHECKING.                 */
*/*          RISTATUS - INTERNAL R/I CODE SET TO NON-ZERO CODE WHEN  */
*/*                     AN ERROR HAS BEEN FOUND DURING R/I SCANNING. */
*/*          LASTCC -   LAST SYSTEM CONDITION CODE                   */
*/*          MAXCC -    MAXIMUM SYSTEM CONDITION CODE SO FAR         */
*/*          SYNUNIT -  MOST RECENTLY EXTRACTED SYNTACTIC UNIT       */
*/*          NESTLVL -  CURRENT 'IF' COMMAND NESTING LEVEL           */
*/*          SINGLCMD - FLAG INDICATING THAT A SINGLE COMMAND (NOT A */
*/*                     DO-GROUP) FOLLOWS AN 'IF' OR 'ELSE' COMMAND  */
*/*          IFNEXT -   FLAG INDICATING THAT AN 'IF' COMMAND FOLLOWS */
*/*                     AN 'IF' OR 'ELSE' COMMAND                    */
*/*          NULLDO -   NUMBER OF NULL 'DO' COMMANDS FOUND AT CURRENT*/
*/*                     'IF' NESTING LEVEL (A NULLDO COUNT EXISTS FOR*/
*/*                     EACH LEVEL OF 'IF' NESTING)                  */
*/*          DOFLAG -   INDICATES WHETHER OR NOT A DO-GROUP IS BEING */
*/*                     SCANNED AT CURRENT 'IF' NESTING LEVEL        */
*/*          THENFLAG - INDICATES WHETHER OR NOT THE 'THEN' PATH     */
*/*                     COMMANDS ARE CURRENTLY BEING SCANNED AT      */
*/*                     CURRENT LEVEL OF 'IF' NESTING.               */
*/*          ELSEFLAG - FLAG INDICATING WHETHER OR NOT THE 'ELSE'    */
*/*                     PATH COMMANDS ARE CURRENTLY BEING SCANNED    */
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */
*/*          SKIPFLAG - INDICATES WHETHER OR NOT COMMANDS AT CURRENT */
*/*                     LEVEL OF 'IF' NESTING ARE TO BE EXECUTED.    */
*/*          UNITINDX - LENGTH OF MOST RECENTLY EXTRACTED SYNTACTIC  */
*/*                     UNIT.                                        */
*/*          GETVERB -  FLAG INDICATING WHETHER OR NOT THE NEXT      */
*/*                     INPUT COMMAND VERB HAS BEEN EXTRACTED.       */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          VERBNAME - NAME OF FUNCTION COMMAND VERB WHOSE PARAMETER*/
*/*                     PARAMETER SET WILL NEXT BE SCANNED.          */
*/*          SCANONLY - FLAG NOTING WHETHER OR NOT NEXT FUNCTION     */
*/*                     COMMAND IS TO BE EXECUTED.                   */
*/*          IFNEXT -   FLAG SET 'ON' WHEN COMMAND FOLLOWING A 'THEN'*/
*/*                     OR 'ELSE' IS AN 'IF' MODAL COMMAND.          */
*/*          SINGLCMD - FLAG SET 'ON' WHEN A SINGLE COMMAND (NOT A   */
*/*                     DO-GROUP) FOLLOWS THE 'THEN' OR 'ELSE' JUST  */
*/*                     SCANNED.                                     */
*/*          MAXCC -    MAX. SYSTEM CONDITION CODE; RESET BASED UPON */
*/*                     EVALUATION OF 'IF' MODAL COMMANDS            */
*/*          LASTCC -   LAST SYSTEM CONDITION CODE; SET BASED UPON   */
*/*                     EVALUATION OF 'IF' COMMANDS AND UPON MODAL   */
*/*                     COMMAND ERRORS FOUND.                        */
*/*          EOFOK -    FLAG SET 'ON' WHEN SCANNING BETWEEN COMMANDS */
*/*                     TO SIGNAL THAT EOF MAY BE PROPERLY FOUND.    */
*/*          GETVERB -  FLAG SET 'ON' WHEN THE NEXT COMMAND VERB HAS */
*/*                     ALREADY BEEN EXTRACTED FOLLOWING A 'THEN' OR */
*/*                     'ELSE'.                                      */
*/*          RISTATUS - R/I INTERNAL STATUS CODE; SET TO A NON-ZERO  */
*/*                     CODE WHEN ANY ERROR IS FOUND.                */
*/*          NESTLVL -  LEVEL OF 'IF' NESTING AT WHICH SCANNING IS   */
*/*                     CURRENTLY TAKING PLACE.                      */
*/*          NULLDO -   NULL DO COMMANDS ENCOUNTERED WHILE SCANNING  */
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */
*/*          DOFLAG -   FLAG SET 'ON' WHEN SCANNING WITHIN A DO-GROUP*/
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */
*/*                                                                  */
*/********************************************************************/
*GETNEXT:PROCEDURE;                                                0519
         B     @PB00004                                            0519
GETNEXT  STM   @14,@03,@SA00004                                    0519
         STM   @06,@12,@SA00004+24                                 0519
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR OBTAINING NEXT FUNCTION COMMAND     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0520
*        DCL RELATION CHAR(32);        /*FIELD TO CONTAIN EXTRACTED
*                                        'IF' COMMAND RELATIONAL   0520
*                                        EXPRESSION OR 'SET' COMMAND
*                                        ASSIGNMENT EXPRESSION.      */
*        DCL RELSIZE  FIXED(15);       /*NUMBER OF EXTRACTED CHAR'S IN
*                                        ABOVE EXPRESSION.           */
*        DCL PART1LEN FIXED(15);       /*LENGTH OF EITHER 'MAXCC' OR
*                                        'LASTCC' CONSTANT           */
*                                                                  0522
*        DCL EQSIGN1  CHAR(1)          /*EQUAL SIGN                  */
*                     CONSTANT('=');                               0523
*        DCL EQSIGN2  CHAR(2)          /*EQUAL SIGN                  */
*                     CONSTANT('EQ');                              0524
*                                                                  0524
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADELSE  FIXED(15)        /*IMPROPER 'ELSE' COMMAND     */
*                     CONSTANT(28);                                0525
*        DCL BADDOEND FIXED(15)        /*IMPROPER 'DO' OR 'END'      */
*                     CONSTANT(29);                                0526
*        DCL BADEXPR1 FIXED(15)        /*BAD EXPRESSION IN 'IF' CMD. */
*                     CONSTANT(30);                                0527
*        DCL BADEXPR2 FIXED(15)        /*BAD EXPRESSION IN 'SET' CMD.*/
*                     CONSTANT(31);                                0528
*        DCL NOTHEN   FIXED(15)        /*MISSING 'THEN' KEYWORD      */
*                     CONSTANT(33);                                0529
*        DCL BADIFNST FIXED(15)        /*TOO MUCH 'IF' NESTING       */
*                     CONSTANT(38);                                0530
*                                                                  0530
*        DCL 1 *,                                                  0531
*              2 NONMODAL BIT(1),      /*SIGNALS THAT A NON-MODAL  0531
*                                        COMMAND VERB HAS BEEN FOUND */
*              2 REDOLVL0 BIT(1),      /*'IF' NESTING HAS RETURNED TO
*                                        A LEVEL OF ZERO FOLLOWING AN
*                                        'IF-THEN' MODAL COMMAND     */
*              2 EXPREND  BIT(1),      /*SIGNALS THAT ALL OF THE   0531
*                                        RELATIONAL EXPRESSION HAS 0531
*                                        BEEN EXTRACTED.             */
*              2 SINGLCMD BIT(1),      /*SIGNALS THAT A SINGLE COMMAND
*                                        (A NON-MODAL OR A 'SET' MODAL
*                                        COMMAND) FOLLOWS THE 'THEN'
*                                        OR 'ELSE' JUST SCANNED.     */
*              2 IFNEXT   BIT(1),      /*AN 'IF' COMMAND FOLLOWS THE
*                                        THE CURRENT 'THEN' OR 'ELSE'*/
*              2 GETVERB  BIT(1);      /*EXTRACT THE NEXT COMMAND VERB
*                                        BEFORE RESUMING SEARCH FOR
*                                        FUNCTION COMMAND.           */
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETNEXT ** GET NEXT FUNCTION COMMAND                 */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0532
*          THEN;                                                   0532
         ICM   @05,15,GDTDBG(GDTPTR)                               0532
         BZ    @RT00532                                            0532
*          ELSE                                                    0534
*            CALL IDCDB010(GDTTBL,'RIGN');                         0534
*                                                                  0534
         ST    GDTPTR,@AL00001                                     0534
         LA    @05,@CC00987                                        0534
         ST    @05,@AL00001+4                                      0534
         MVI   @AL00001+4,X'80'                                    0534
         L     @15,GDTDBG(,GDTPTR)                                 0534
         LA    @01,@AL00001                                        0534
         BALR  @14,@15                                             0534
*        /************************************************************/
*        /*                                                          */
*        /* PICK UP THE FIRST COMMAND VERB ENCOUNTERED, BYPASSING    */
*        /* DELIMITING SEPARATOR CHARACTERS WHICH SURROUND IT.       */
*        /*                                                          */
*        /************************************************************/
*        NULLCMD=NO;                                               0535
@RT00532 NI    NULLCMD,B'10111111'                                 0535
*        COMMENT=NO;                                               0536
*        FIRSTCHR=YES;                                             0537
         OI    FIRSTCHR,B'00000100'                                0537
         NI    COMMENT,B'10111111'                                 0537
*        CHAR1=BLANK;                                              0538
*                                                                  0538
         MVI   CHAR1,C' '                                          0538
*        CALL SCANSEP(NO);                                         0539
         LA    @01,@AL00539                                        0539
         BAL   @14,SCANSEP                                         0539
*        CALL NXTFIELD(VERBFLD);                                   0540
         LA    @01,@AL00540                                        0540
         BAL   @14,NXTFIELD                                        0540
*        CALL SCANSEP(NO);                                         0541
*                                                                  0541
         LA    @01,@AL00541                                        0541
         BAL   @14,SCANSEP                                         0541
*        /************************************************************/
*        /*                                                          */
*        /* SCAN AND INTERPRET INPUT COMMANDS UNTIL A NON-MODAL      */
*        /* (FUNCTION) COMMAND IS FOUND.  EACH PASS OF THE FOLLOWING */
*        /* SECTION OF CODE BEGINS BY COMPUTING THE CURRENT MAXIMUM  */
*        /* SYSTEM CONDITION CODE AND EXAMINING A VERB NAME JUST     */
*        /* EXTRACTED.  APPROPRIATE FLAGS ARE SET BASED UPON THE     */
*        /* MODAL STATEMENTS ENCOUNTERED.                            */
*        /*                                                          */
*        /************************************************************/
*        NONMODAL=NO;                                              0542
*        IFNEXT=NO;                                                0543
*        SINGLCMD=NO;                                              0544
         NI    NONMODAL,B'01100111'                                0544
*DOLOOP10:DO WHILE(NONMODAL=NO & RISTATUS=0);                      0545
DOLOOP10 B     @DE00545                                            0545
@DL00545 DS    0H                                                  0546
*          EOFOK=NO;                                               0546
         NI    EOFOK,B'10111111'                                   0546
*          GETVERB=YES;                                            0547
*          REDOLVL0=NO;                                            0548
*                                                                  0548
         OI    GETVERB,B'00000100'                                 0548
         NI    REDOLVL0,B'10111111'                                0548
*          /**********************************************************/
*          /*                                                        */
*          /* IF CURRENTLY NO 'IF' MODAL COMMAND NESTING, CHECK      */
*          /* THE EXTRACTED VERB NAME TO SEE IF IT IS A MODAL COMMAND*/
*          /* VERB.  IF SO, INTERPRET THAT MODAL COMMAND, SETTING    */
*          /* CONTROL FLAGS; IF NOT A MODAL, 'GETNEXT' IS FINISHED.  */
*          /*                                                        */
*          /**********************************************************/
*          IF NESTLVL=0                                            0549
*            THEN                                                  0549
         L     @02,GDTRIH(,GDTPTR)                                 0549
         CLI   NESTLVL(@02),0                                      0549
         BNE   @RF00549                                            0549
*              IF SYNUNIT=IFSYM                                    0550
*                THEN                                              0550
*                                                                  0550
         L     @02,KWTBLPTR(,@02)                                  0550
         CLC   SYNUNIT(9),IFSYM(@02)                               0550
         BNE   @RF00550                                            0550
*                  CALL MODALIF;                                   0551
*                                                                  0551
         BAL   @14,MODALIF                                         0551
*                ELSE                                              0552
*                  IF SYNUNIT=SETSYM                               0552
*                    THEN                                          0552
*                                                                  0552
         B     @RC00550                                            0552
@RF00550 L     @02,GDTRIH(,GDTPTR)                                 0552
         L     @02,KWTBLPTR(,@02)                                  0552
         CLC   SYNUNIT(9),SETSYM(@02)                              0552
         BNE   @RF00552                                            0552
*                      CALL MODALSET;                              0553
*                                                                  0553
         BAL   @14,MODALSET                                        0553
*                    ELSE                                          0554
*                      IF SYNUNIT=DOSYM  SYNUNIT=ENDSYM           0554
*                        THEN                                      0554
*                                                                  0554
         B     @RC00552                                            0554
@RF00552 L     @02,GDTRIH(,GDTPTR)                                 0554
         L     @02,KWTBLPTR(,@02)                                  0554
         CLC   SYNUNIT(9),DOSYM(@02)                               0554
         BE    @RT00554                                            0554
         CLC   SYNUNIT(9),ENDSYM(@02)                              0554
         BNE   @RF00554                                            0554
@RT00554 DS    0H                                                  0555
*                          /******************************************/
*                          /*                                        */
*                          /* 'DO' AND 'END' COMMANDS ARE SIMPLY     */
*                          /* IGNORED AT THIS LEVEL.                 */
*                          /*                                        */
*                          /******************************************/
*                                                                  0555
*                          CALL BYPASTRM;                          0555
*                                                                  0555
         BAL   @14,BYPASTRM                                        0555
*                        ELSE                                      0556
*                          IF SYNUNIT=ELSESYM                      0556
*                            THEN                                  0556
*                                                                  0556
         B     @RC00554                                            0556
@RF00554 L     @02,GDTRIH(,GDTPTR)                                 0556
         L     @02,KWTBLPTR(,@02)                                  0556
         CLC   SYNUNIT(9),ELSESYM(@02)                             0556
         BNE   @RF00556                                            0556
*                              /**************************************/
*                              /*                                    */
*                              /* AN 'ELSE' STATEMENT IS IN ERROR IF */
*                              /* IT APPEARS AT THIS LEVEL.          */
*                              /*                                    */
*                              /**************************************/
*                              DO;                                 0557
*                              LASTCC=TERMERR;                     0558
         MVC   LASTCC(2),@CH00482                                  0558
*                              RISTATUS=BADELSE;                   0559
         MVC   RISTATUS(2),@CH00970                                0559
*                              END;                                0560
*                            ELSE                                  0561
*                              NONMODAL=YES;                       0561
*                                                                  0561
         B     @RC00556                                            0561
@RF00556 OI    NONMODAL,B'10000000'                                0561
*          /********************************************************/
*          /*                                                      */
*          /* WHEN WITHIN SOME LEVEL OF 'IF' COMMAND NESTING,      */
*          /* MODAL COMMANDS ARE CHECKED TO BE SURE THAT THEY OCCUR*/
*          /* PROPERLY IN THE MODAL COMMAND STRUCTURE.  IF OKAY,   */
*          /* THE COMMAND IS INTERPRETED AND CONTROL FLAGS ARE SET.*/
*          /* IF NOT A MODAL COMMAND, 'GETNEXT' IS FINISHED.       */
*          /*                                                      */
*          /********************************************************/
*          ELSE                                                    0562
*                                                                  0562
*            /******************************************************/
*            /*                                                    */
*            /* AN 'ELSE' COMMAND MUST HAVE A MATCHING 'IF-THEN'   */
*            /* MODAL COMMAND OR IT IS AN ERROR.                   */
*            /*                                                    */
*            /******************************************************/
*            IF SYNUNIT=ELSESYM                                    0562
*              THEN                                                0562
         B     @RC00549                                            0562
@RF00549 L     @02,GDTRIH(,GDTPTR)                                 0562
         L     @01,KWTBLPTR(,@02)                                  0562
         CLC   SYNUNIT(9),ELSESYM(@01)                             0562
         BNE   @RF00562                                            0562
*                IF THENFLAG(NESTLVL)=ON & DOFLAG(NESTLVL)=OFF     0563
*                  THEN                                            0563
*                                                                  0563
         SLR   @15,@15                                             0563
         IC    @15,NESTLVL(,@02)                                   0563
         ALR   @15,@15                                             0563
         ALR   @02,@15                                             0563
         TM    THENFLAG-2(@02),B'01000000'                         0563
         BNO   @RF00563                                            0563
         TM    DOFLAG-2(@02),B'10000000'                           0563
         BNZ   @RF00563                                            0563
*                    CALL MODLELSE;                                0564
*                                                                  0564
         BAL   @14,MODLELSE                                        0564
*                  ELSE                                            0565
*                    DO;                                           0565
         B     @RC00563                                            0565
@RF00563 DS    0H                                                  0566
*                    LASTCC=TERMERR;                               0566
         MVC   LASTCC(2),@CH00482                                  0566
*                    RISTATUS=BADELSE;                             0567
         MVC   RISTATUS(2),@CH00970                                0567
*                    END;                                          0568
*              ELSE                                                0569
*DOGRP20:        DO;                                               0569
         B     @RC00562                                            0569
@RF00562 DS    0H                                                  0569
DOGRP20  DS    0H                                                  0570
*                OLDERID2 = NEWERID2;                              0570
         L     @02,GDTTR2(,GDTPTR)                                 0570
         MVC   @TS00001(95),NEWERID2(@02)                          0570
         MVC   OLDERID2(95,@02),@TS00001                           0570
*                NEWID2='RI04';                                    0571
*                                                                  0571
         MVC   NEWID2(4,@02),@CC00997                              0571
*                /****************************************************/
*                /*                                                  */
*                /* IF THERE IS NO MATCHING 'ELSE' FOR ONE OR MORE   */
*                /* 'THEN' KEYWORDS, THEN ADJUST THE 'IF' NESTING    */
*                /* LEVEL ONE LESS DEEP FOR EACH NONMATCH            */
*                /*                                                  */
*                /****************************************************/
*                DO WHILE(NESTLVL>0 & SINGLCMD=NO & IFNEXT=NO &    0572
*                         DOFLAG(NESTLVL)=OFF);                    0572
         B     @DE00572                                            0572
@DL00572 DS    0H                                                  0573
*                  NESTLVL=NESTLVL-1;                              0573
         L     @02,GDTRIH(,GDTPTR)                                 0573
         SLR   @15,@15                                             0573
         IC    @15,NESTLVL(,@02)                                   0573
         BCTR  @15,0                                               0573
         STC   @15,NESTLVL(,@02)                                   0573
*                END;                                              0574
@DE00572 L     @02,GDTRIH(,GDTPTR)                                 0574
         CLI   NESTLVL(@02),0                                      0574
         BNH   @DC00572                                            0574
         TM    SINGLCMD,B'00011000'                                0574
         BNZ   @DC00572                                            0574
         SLR   @15,@15                                             0574
         IC    @15,NESTLVL(,@02)                                   0574
         ALR   @15,@15                                             0574
         ALR   @02,@15                                             0574
         TM    DOFLAG-2(@02),B'10000000'                           0574
         BZ    @DL00572                                            0574
@DC00572 DS    0H                                                  0575
*                IF NESTLVL=0                                      0575
*                  THEN                                            0575
         L     @02,GDTRIH(,GDTPTR)                                 0575
         CLI   NESTLVL(@02),0                                      0575
         BNE   @RF00575                                            0575
*                    REDOLVL0=YES;                                 0576
         OI    REDOLVL0,B'01000000'                                0576
*                  ELSE                                            0577
*                    IF SYNUNIT=IFSYM                              0577
*                      THEN                                        0577
*                                                                  0577
         B     @RC00575                                            0577
@RF00575 L     @02,GDTRIH(,GDTPTR)                                 0577
         L     @02,KWTBLPTR(,@02)                                  0577
         CLC   SYNUNIT(9),IFSYM(@02)                               0577
         BNE   @RF00577                                            0577
*                        CALL MODALIF;                             0578
*                                                                  0578
         BAL   @14,MODALIF                                         0578
*                      ELSE                                        0579
*                                                                  0579
*                        /********************************************/
*                        /*                                          */
*                        /* AN 'END' COMMAND NULLIFIES A MATCHING    */
*                        /* 'DO' COMMAND. HOWEVER, IT IS AN ERROR IF */
*                        /* NO MATCHING 'DO' EXISTS.  IF ALL IS OKAY,*/
*                        /* THE 'END' IS BYPASSED & SCANNING RESUMES */
*                        /*                                          */
*                        /********************************************/
*                        IF SYNUNIT=ENDSYM                         0579
*                          THEN                                    0579
         B     @RC00577                                            0579
@RF00577 L     @02,GDTRIH(,GDTPTR)                                 0579
         L     @01,KWTBLPTR(,@02)                                  0579
         CLC   SYNUNIT(9),ENDSYM(@01)                              0579
         BNE   @RF00579                                            0579
*                            DO;                                   0580
*                            IF NULLDO(NESTLVL)=0                  0581
*                              THEN                                0581
         SLR   @15,@15                                             0581
         IC    @15,NESTLVL(,@02)                                   0581
         LR    @14,@15                                             0581
         ALR   @14,@14                                             0581
         SLR   @01,@01                                             0581
         IC    @01,NULLDO-2(@14,@02)                               0581
         CH    @01,@CH00125                                        0581
         BNE   @RF00581                                            0581
*                                IF DOFLAG(NESTLVL)=ON             0582
*                                  THEN                            0582
         ST    @14,@TF00001                                        0582
         ALR   @14,@02                                             0582
         TM    DOFLAG-2(@14),B'10000000'                           0582
         BNO   @RF00582                                            0582
*                                    DO;                           0583
*                                    DOFLAG(NESTLVL)=OFF;          0584
         LR    @01,@02                                             0584
         AL    @01,@TF00001                                        0584
         NI    DOFLAG-2(@01),B'01111111'                           0584
*                                    IF ELSEFLAG(NESTLVL)=ON       0585
*                                      THEN                        0585
         LR    @01,@02                                             0585
         AL    @01,@TF00001                                        0585
         TM    ELSEFLAG-2(@01),B'00100000'                         0585
         BNO   @RF00585                                            0585
*                                        NESTLVL=NESTLVL-1;        0586
         BCTR  @15,0                                               0586
         STC   @15,NESTLVL(,@02)                                   0586
*                                    END;                          0587
*                                  ELSE                            0588
*                                    DO;                           0588
         B     @RC00582                                            0588
@RF00582 DS    0H                                                  0589
*                                    LASTCC=TERMERR;               0589
         MVC   LASTCC(2),@CH00482                                  0589
*                                    RISTATUS=BADDOEND;            0590
         MVC   RISTATUS(2),@CH00972                                0590
*                                    END;                          0591
*                              ELSE                                0592
*                                NULLDO(NESTLVL)=NULLDO(NESTLVL)-1;
         B     @RC00581                                            0592
@RF00581 L     @02,GDTRIH(,GDTPTR)                                 0592
         SLR   @15,@15                                             0592
         IC    @15,NESTLVL(,@02)                                   0592
         ALR   @15,@15                                             0592
         SLR   @14,@14                                             0592
         IC    @14,NULLDO-2(@15,@02)                               0592
         BCTR  @14,0                                               0592
         STC   @14,NULLDO-2(@15,@02)                               0592
*                            IF SINGLCMD=YES                       0593
*                              THEN                                0593
@RC00581 TM    SINGLCMD,B'00010000'                                0593
         BNO   @RF00593                                            0593
*                                DO;                               0594
*                                LASTCC=TERMERR;                   0595
         MVC   LASTCC(2),@CH00482                                  0595
*                                RISTATUS=BADDOEND;                0596
         MVC   RISTATUS(2),@CH00972                                0596
*                                END;                              0597
*                              ELSE                                0598
*                                                                  0598
*                                CALL BYPASTRM;                    0598
*                                                                  0598
         B     @RC00593                                            0598
@RF00593 BAL   @14,BYPASTRM                                        0598
*                            END;                                  0599
*                          ELSE                                    0600
*                            IF SYNUNIT=SETSYM                     0600
*                              THEN                                0600
*                                                                  0600
         B     @RC00579                                            0600
@RF00579 L     @02,GDTRIH(,GDTPTR)                                 0600
         L     @02,KWTBLPTR(,@02)                                  0600
         CLC   SYNUNIT(9),SETSYM(@02)                              0600
         BNE   @RF00600                                            0600
*                                CALL MODALSET;                    0601
*                                                                  0601
         BAL   @14,MODALSET                                        0601
*                              ELSE                                0602
*                                                                  0602
*                                /************************************/
*                                /*                                  */
*                                /* A 'DO' COMMAND NOT FOLLOWING AN  */
*                                /* 'IF' OR AN 'ELSE' COMMAND IS JUST*/
*                                /* BYPASSED AFTER NOTING THAT THE   */
*                                /* 'END' WILL BE BYPASSED TOO       */
*                                /*                                  */
*                                /************************************/
*                                IF SYNUNIT=DOSYM                  0602
*                                  THEN                            0602
         B     @RC00600                                            0602
@RF00600 L     @02,GDTRIH(,GDTPTR)                                 0602
         L     @01,KWTBLPTR(,@02)                                  0602
         CLC   SYNUNIT(9),DOSYM(@01)                               0602
         BNE   @RF00602                                            0602
*                                    DO;                           0603
*                                    NULLDO(NESTLVL)=NULLDO(NESTLVL)+1;
*                                                                  0604
         SLR   @15,@15                                             0604
         IC    @15,NESTLVL(,@02)                                   0604
         ALR   @15,@15                                             0604
         LA    @14,1                                               0604
         SLR   @01,@01                                             0604
         IC    @01,NULLDO-2(@15,@02)                               0604
         ALR   @14,@01                                             0604
         STC   @14,NULLDO-2(@15,@02)                               0604
*                                    CALL BYPASTRM;                0605
*                                                                  0605
         BAL   @14,BYPASTRM                                        0605
*                                    END;                          0606
*                                  ELSE                            0607
*                                                                  0607
*                                    /********************************/
*                                    /*                              */
*                                    /* IF NOT A MODAL COMMAND, CHECK*/
*                                    /* WHETHER THE CURRENT GROUP OF */
*                                    /* FUNCTION COMMANDS ARE JUST   */
*                                    /* BEING SCANNED OR NOT. ALSO,  */
*                                    /* MOVE ONE 'IF' NESTING LEVEL  */
*                                    /* LESS DEEP IF THIS NON-MODAL  */
*                                    /* IS A SINGLE COMMAND FOLLOWING*/
*                                    /* AN 'ELSE' COMMAND.           */
*                                    /*                              */
*                                    /********************************/
*                                    DO;                           0607
         B     @RC00602                                            0607
@RF00602 DS    0H                                                  0608
*                                    IF SKIPFLAG(NESTLVL)=ON       0608
*                                      THEN                        0608
         L     @02,GDTRIH(,GDTPTR)                                 0608
         SLR   @15,@15                                             0608
         IC    @15,NESTLVL(,@02)                                   0608
         ALR   @15,@15                                             0608
         ALR   @02,@15                                             0608
         TM    SKIPFLAG-2(@02),B'00010000'                         0608
         BNO   @RF00608                                            0608
*                                        SCANONLY=YES;             0609
         OI    SCANONLY,B'00010000'                                0609
*                                    NONMODAL=YES;                 0610
@RF00608 OI    NONMODAL,B'10000000'                                0610
*                                    IF SINGLCMD=YES               0611
*                                      THEN                        0611
         TM    SINGLCMD,B'00010000'                                0611
         BNO   @RF00611                                            0611
*                                        DO;                       0612
*                                        SINGLCMD=NO;              0613
         NI    SINGLCMD,B'11101111'                                0613
*                                        IF ELSEFLAG(NESTLVL)=ON   0614
*                                          THEN                    0614
         L     @02,GDTRIH(,GDTPTR)                                 0614
         SLR   @15,@15                                             0614
         IC    @15,NESTLVL(,@02)                                   0614
         LR    @14,@15                                             0614
         ALR   @14,@14                                             0614
         ALR   @14,@02                                             0614
         TM    ELSEFLAG-2(@14),B'00100000'                         0614
         BNO   @RF00614                                            0614
*                                            NESTLVL=NESTLVL-1;    0615
         BCTR  @15,0                                               0615
         STC   @15,NESTLVL(,@02)                                   0615
*                                        END;                      0616
@RF00614 DS    0H                                                  0617
*                                    END;                          0617
@RF00611 DS    0H                                                  0618
*                END DOGRP20;                                      0618
*                                                                  0618
@RC00602 DS    0H                                                  0618
@RC00600 DS    0H                                                  0618
@RC00579 DS    0H                                                  0618
@RC00577 DS    0H                                                  0618
@RC00575 DS    0H                                                  0619
*          IF RISTATUS=0 & REDOLVL0=NO                             0619
*            THEN                                                  0619
@RC00562 DS    0H                                                  0619
@RC00549 ICM   @02,3,RISTATUS                                      0619
         BNZ   @RF00619                                            0619
         TM    REDOLVL0,B'01000000'                                0619
         BNZ   @RF00619                                            0619
*DOGRP25:      DO;                                                 0620
DOGRP25  DS    0H                                                  0621
*              OLDERID2 = NEWERID2;                                0621
         L     @02,GDTTR2(,GDTPTR)                                 0621
         MVC   @TS00001(95),NEWERID2(@02)                          0621
         MVC   OLDERID2(95,@02),@TS00001                           0621
*              NEWID2='RI05';                                      0622
*                                                                  0622
         MVC   NEWID2(4,@02),@CC01000                              0622
*              /******************************************************/
*              /*                                                    */
*              /* IF THE LENGTH OF THE EXTRACTED COMMAND VERB NAME IS*/
*              /* ZERO, THEN IT IS A NULL COMMAND.  IT IS THEN SIMPLY*/
*              /* BYPASSED AND SCANNING RESUMES IN SEARCH OF THE     */
*              /* NEXT FUNCTION COMMAND TO BE SCANNED.               */
*              /*                                                    */
*              /******************************************************/
*              IF UNITINDX=0 & NONMODAL=YES                        0623
*                THEN                                              0623
         LTR   UNITINDX,UNITINDX                                   0623
         BNZ   @RF00623                                            0623
         TM    NONMODAL,B'10000000'                                0623
         BNO   @RF00623                                            0623
*                  DO;                                             0624
*                  NULLCMD=YES;                                    0625
         OI    NULLCMD,B'01000000'                                 0625
*                  NONMODAL=NO;                                    0626
*                                                                  0626
         NI    NONMODAL,B'01111111'                                0626
*                  CALL BYPASTRM;                                  0627
*                                                                  0627
         BAL   @14,BYPASTRM                                        0627
*                  SCANONLY=NO;                                    0628
         NI    SCANONLY,B'11101111'                                0628
*                  END;                                            0629
*                                                                  0629
*              /******************************************************/
*              /*                                                    */
*              /* IF A GOOD FUNCTION COMMAND HAS NOT BEEN FOUND YET, */
*              /* GET THE NEXT COMMAND VERB AND RESUME THE SCAN LOOP.*/
*              /*                                                    */
*              /******************************************************/
*              IF NONMODAL=NO  & GETVERB=YES                       0630
*                THEN                                              0630
@RF00623 TM    GETVERB,B'00000100'                                 0630
         BNO   @RF00630                                            0630
         TM    NONMODAL,B'10000000'                                0630
         BNZ   @RF00630                                            0630
*                  DO;                                             0631
*                                                                  0631
*                  CALL SCANSEP(YES);                              0632
         LA    @01,@AL00632                                        0632
         BAL   @14,SCANSEP                                         0632
*                  CALL NXTFIELD(VERBFLD);                         0633
         LA    @01,@AL00633                                        0633
         BAL   @14,NXTFIELD                                        0633
*                  CALL SCANSEP(NO);                               0634
*                                                                  0634
         LA    @01,@AL00634                                        0634
         BAL   @14,SCANSEP                                         0634
*                  END;                                            0635
*                ELSE                                              0636
*                                                                  0636
*                  /**************************************************/
*                  /*                                                */
*                  /* IF A NON-MODAL, NON-NULL COMMAND HAS BEEN FOUND*/
*                  /* THEN PICK IT UP AS THE FUNCTION COMMAND VERB   */
*                  /* NAME IF IT DOESN'T EXCEED MAX. VERB NAME LENGTH*/
*                  /*                                                */
*                  /**************************************************/
*                  IF UNITINDX <= VERBMAX                          0636
*                    THEN                                          0636
         B     @RC00630                                            0636
@RF00630 CH    UNITINDX,@CH00042                                   0636
         BH    @RF00636                                            0636
*                      VERBNAME=SYNUNIT;                           0637
         MVC   VERBNAME(8),SYNUNIT                                 0637
*                    ELSE                                          0638
*                                                                  0638
*                      CALL ERROR2(BADVERB2,LENGTH(ERRFIELD),      0638
*                                  ADDR(ERRFIELD));                0638
*                                                                  0638
*                                                                  0638
         B     @RC00636                                            0638
@RF00636 MVC   @AL00001(8),@AL00638                                0638
         LA    @02,ERRFIELD                                        0638
         ST    @02,@AFTEMPS                                        0638
         LA    @02,@AFTEMPS                                        0638
         ST    @02,@AL00001+8                                      0638
         LA    @01,@AL00001                                        0638
         BAL   @14,ERROR2                                          0638
*              END DOGRP25;                                        0639
@RC00636 DS    0H                                                  0639
@RC00630 DS    0H                                                  0640
*        END DOLOOP10;                                             0640
@RF00619 DS    0H                                                  0640
@DE00545 TM    NONMODAL,B'10000000'                                0640
         BNZ   @DC00545                                            0640
         ICM   @02,3,RISTATUS                                      0640
         BZ    @DL00545                                            0640
@DC00545 DS    0H                                                  0641
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MODALSET                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */
*/*             MODAL 'SET' COMMAND WHICH FOLLOWS THE VERB NAME      */
*/*             'SET'.  IF THE SYNTAX IS OKAY, THE PROVIDED NUMBER   */
*/*             IS ASSIGNED AS THE VALUE OF THE CONDITION CODE.      */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */
*/*                    CURRENTLY TAKING PLACE                        */
*/*          ELSEFLAG- FLAG SET 'ON' WHILE SCANNING ELSE-PATH        */
*/*                    COMMANDS AT CURRENT 'IF' NESTING LEVEL        */
*/*          SKIPFLAG- FLAG SET 'ON' WHILE SCANNING COMMAND(S) WHICH */
*/*                    IS NOT TO BE ENCODED INTO AN FDT & EXECUTED.  */
*/*          RISTATUS- STATUS CODE SET TO A NON-ZERO CODE WHEN ANY   */
*/*                    ERROR IS ENCOUNTERED.                         */
*/*          LASTCC -  LAST SYSTEM COND. CODE; MAY BE RESET BY 'SET' */
*/*                    COMMAND OR BY OCCURRENCE OF AN ERROR.         */
*/*          MAXCC -   MAXIMUM SYSTEM COND. CODE; MAY BE RESET BY    */
*/*                    'SET' COMMAND.                                */
*/*          SYNUNIT - ALL OR PART OF 'SET' COMMAND ASSIGNMENT       */
*/*                    EXPRESSION.                                   */
*/*          UNITINDX- LENGTH OF ABOVE SEGMENT OF ASSIGNMENT EXPR.   */
*/*          CNVRTWRD- CONVERTED DECIMAL NUMBER IN BINARY FORM FROM  */
*/*                    'SET' COMMAND ASSIGNMENT EXPRESSION.          */
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND FOLLOWS A */
*/*                    'THEN' OR 'ELSE'                              */
*/*          CHAR1 -   INPUT CHARACTER MOST RECENTLY EXTRACTED.      */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SINGLCMD- SEE 'INPUT'                                   */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING WILL  */
*/*                    BE DONE FOLLOWING THIS 'SET' COMMAND.         */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*          SYNUNIT - DECIMAL NUMBER FROM 'SET' COMMAND TO BE       */
*/*                    CONVERTED AND ASSIGNED AS THE COND. CODE VALUE*/
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER (EBCDIC FORM)        */
*/*          LASTCC -  SEE 'INPUT'                                   */
*/*          MAXCC -   SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*MODALSET:PROCEDURE;                                               0641
         B     @PB00005                                            0641
MODALSET STM   @14,@03,@SA00005                                    0641
         STM   @06,@12,@SA00005+24                                 0641
*        /************************************************************/
*        /*                                                          */
*        /*  ** MODALSET **  INTERPRET MODAL 'SET' COMMAND           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0642
*          THEN;                                                   0642
         ICM   @02,15,GDTDBG(GDTPTR)                               0642
         BZ    @RT00642                                            0642
*          ELSE                                                    0644
*            CALL IDCDB010(GDTTBL,'RIMS');                         0644
*                                                                  0644
         ST    GDTPTR,@AL00001                                     0644
         LA    @02,@CC01004                                        0644
         ST    @02,@AL00001+4                                      0644
         MVI   @AL00001+4,X'80'                                    0644
         L     @15,GDTDBG(,GDTPTR)                                 0644
         LA    @01,@AL00001                                        0644
         BALR  @14,@15                                             0644
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE ELEMENTS OF THE ASSIGNMENT EXPRESSION (THERE */
*        /* MAY OR MAY NOT BE DELIMITERS TO BE IGNORED SURROUNDING   */
*        /* THE EQUAL SIGN), CHECKING TO BE SURE THAT THE MAXIMUM    */
*        /* POSSIBLE LENGTH FOR SUCH AN EXPRESSION IS NOT EXCEEDED.  */
*        /*                                                          */
*        /************************************************************/
*        RELATION=BLANK;                                           0645
@RT00642 MVI   RELATION+1,C' '                                     0645
         MVC   RELATION+2(30),RELATION+1                           0645
         MVI   RELATION,C' '                                       0645
*        RELSIZE=0;                                                0646
         SLR   RELSIZE,RELSIZE                                     0646
*        EXPREND=NO;                                               0647
         NI    EXPREND,B'11011111'                                 0647
*        DO WHILE(EXPREND=NO);                                     0648
*                                                                  0648
         B     @DE00648                                            0648
@DL00648 DS    0H                                                  0649
*          CALL NXTFIELD(VERBFLD);                                 0649
         LA    @01,@AL00649                                        0649
         BAL   @14,NXTFIELD                                        0649
*          CALL SCANSEP(NO);                                       0650
*                                                                  0650
         LA    @01,@AL00650                                        0650
         BAL   @14,SCANSEP                                         0650
*          IF RELSIZE+UNITINDX = 0                                0651
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM
*            THEN                                                  0651
         LR    @15,RELSIZE                                         0651
         ALR   @15,UNITINDX                                        0651
         LTR   @15,@15                                             0651
         BZ    @RT00651                                            0651
         L     @01,GDTRIH(,GDTPTR)                                 0651
         L     @14,KWTBLPTR(,@01)                                  0651
         SLR   @01,@01                                             0651
         IC    @01,MAXCCLN(,@14)                                   0651
         SLR   @00,@00                                             0651
         IC    @00,LSTCCLN(,@14)                                   0651
         CR    @01,@00                                             0651
         BNL   *+6
         LR    @01,@00                                             0651
         AH    @01,@CH00038                                        0651
         CR    @15,@01                                             0651
         BNH   @RF00651                                            0651
@RT00651 DS    0H                                                  0652
*              RISTATUS=BADEXPR2;                                  0652
         MVC   RISTATUS(2),@CH00054                                0652
*            ELSE                                                  0653
*              DO;                                                 0653
         B     @RC00651                                            0653
@RF00651 DS    0H                                                  0654
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0654
         LA    @01,RELATION(RELSIZE)                               0654
         LR    @15,UNITINDX                                        0654
         BCTR  @15,0                                               0654
         EX    @15,@SM01447                                        0654
*              RELSIZE=RELSIZE+UNITINDX;                           0655
         ALR   RELSIZE,UNITINDX                                    0655
*              END;                                                0656
*          IF RISTATUS^=0  CHAR1=ENDDELIM                         0657
*            THEN                                                  0657
@RC00651 ICM   @15,3,RISTATUS                                      0657
         BNZ   @RT00657                                            0657
         CLI   CHAR1,C';'                                          0657
         BNE   @RF00657                                            0657
@RT00657 DS    0H                                                  0658
*              EXPREND=YES;                                        0658
         OI    EXPREND,B'00100000'                                 0658
*        END;                                                      0659
*                                                                  0659
@RF00657 DS    0H                                                  0659
@DE00648 TM    EXPREND,B'00100000'                                 0659
         BZ    @DL00648                                            0659
*        IF RISTATUS=0                                             0660
*          THEN                                                    0660
*                                                                  0660
         ICM   @15,3,RISTATUS                                      0660
         BNZ   @RF00660                                            0660
*            /********************************************************/
*            /*                                                      */
*            /* INTERPRET THE ASSIGNMENT EXPRESSION AND ASSIGN THE   */
*            /* PROVIDED NUMBER AS THE VALUE OF THE LAST OR MAXIMUM  */
*            /* SYSTEM CONDITION CODE (WHICHEVER IS SPECIFIED IN THE */
*            /* ASSIGNMENT EXPRESSION.                               */
*            /*                                                      */
*            /********************************************************/
*DOGRP27:    DO;                                                   0661
DOGRP27  DS    0H                                                  0662
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0662
*              THEN                                                0662
         L     @01,GDTRIH(,GDTPTR)                                 0662
         L     @15,KWTBLPTR(,@01)                                  0662
         SLR   @14,@14                                             0662
         IC    @14,MAXCCLN(,@15)                                   0662
         LR    @01,@14                                             0662
         BCTR  @01,0                                               0662
         EX    @01,@SC01449                                        0662
         BNE   @RF00662                                            0662
*                PART1LEN=MAXCCLN;                                 0663
         LR    PART1LEN,@14                                        0663
*              ELSE                                                0664
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0664
*                  THEN                                            0664
         B     @RC00662                                            0664
@RF00662 L     @01,GDTRIH(,GDTPTR)                                 0664
         L     @15,KWTBLPTR(,@01)                                  0664
         SLR   @14,@14                                             0664
         IC    @14,LSTCCLN(,@15)                                   0664
         LR    @01,@14                                             0664
         BCTR  @01,0                                               0664
         EX    @01,@SC01451                                        0664
         BNE   @RF00664                                            0664
*                    PART1LEN=LSTCCLN;                             0665
         LR    PART1LEN,@14                                        0665
*                  ELSE                                            0666
*                    RISTATUS=BADEXPR2;                            0666
         B     @RC00664                                            0666
@RF00664 MVC   RISTATUS(2),@CH00054                                0666
*            IF RELATION(PART1LEN+1)=EQSIGN1                       0667
*              THEN                                                0667
@RC00664 DS    0H                                                  0667
@RC00662 LA    @01,RELATION(PART1LEN)                              0667
         CLI   0(@01),C'='                                         0667
         BNE   @RF00667                                            0667
*                PART1LEN=PART1LEN+1;                              0668
         AL    PART1LEN,@CF00228                                   0668
*              ELSE                                                0669
*                IF RELATION(PART1LEN+1:PART1LEN+2)=EQSIGN2        0669
*                  THEN                                            0669
         B     @RC00667                                            0669
@RF00667 LA    @01,RELATION(PART1LEN)                              0669
         CLC   0(2,@01),@CC00968                                   0669
         BNE   @RF00669                                            0669
*                    PART1LEN=PART1LEN+2;                          0670
         AH    PART1LEN,@CH00163                                   0670
*                  ELSE                                            0671
*                    RISTATUS=BADEXPR2;                            0671
         B     @RC00669                                            0671
@RF00669 MVC   RISTATUS(2),@CH00054                                0671
*            IF RISTATUS=0                                         0672
*              THEN                                                0672
*                                                                  0672
@RC00669 DS    0H                                                  0672
@RC00667 ICM   @15,3,RISTATUS                                      0672
         BNZ   @RF00672                                            0672
*                /****************************************************/
*                /*                                                  */
*                /* IF A NUMBER HAS BEEN PROPERLY CODED, THEN        */
*                /* PLACE THE NUMBER INTO SYNUNIT IN PREPARATION FOR */
*                /* CONVERSION AND CONVERT THE NUMBER.               */
*                /*                                                  */
*                /****************************************************/
*                IF PART1LEN < RELSIZE                             0673
*                  THEN                                            0673
         CR    PART1LEN,RELSIZE                                    0673
         BNL   @RF00673                                            0673
*                    DO;                                           0674
*                    UNITINDX=RELSIZE-PART1LEN;                    0675
         LR    @15,RELSIZE                                         0675
         SLR   @15,PART1LEN                                        0675
         LR    UNITINDX,@15                                        0675
*                    SYNUNIT=RELATION(PART1LEN+1:RELSIZE);         0676
*                                                                  0676
         MVI   SYNUNIT+1,C' '                                      0676
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0676
         BCTR  @15,0                                               0676
         LA    @01,RELATION(PART1LEN)                              0676
         EX    @15,@SM01453                                        0676
*                    CALL PACKCVB;                                 0677
*                                                                  0677
         BAL   @14,PACKCVB                                         0677
*                    IF RISTATUS^=0                                0678
*                      THEN                                        0678
         ICM   @02,3,RISTATUS                                      0678
         BZ    @RF00678                                            0678
*                        RISTATUS=SKIPREST;                        0679
         MVC   RISTATUS(2),@CH00042                                0679
*                    END;                                          0680
*                  ELSE                                            0681
*                    RISTATUS=BADEXPR2;                            0681
         B     @RC00673                                            0681
@RF00673 MVC   RISTATUS(2),@CH00054                                0681
*            END DOGRP27;                                          0682
*                                                                  0682
@RC00673 DS    0H                                                  0682
@RF00672 DS    0H                                                  0683
*        /************************************************************/
*        /*                                                          */
*        /* IF NO ERROR HAS OCCURRED, ASSIGN THE PROVIDED VALUE AS   */
*        /* THE NEW VALUE OF THE SPECIFIED CONDITION CODE.           */
*        /* (HOWEVER, NEVER ASSIGN A VALUE HIGHER THAN 16).  IF THE  */
*        /* 'SET' COMMAND HAS UPDATED 'LASTCC', THEN 'MAXCC' MAY     */
*        /* ALSO HAVE TO BE UPDATED.                                 */
*        /*                                                          */
*        /************************************************************/
*        IF RISTATUS ^= 0                                          0683
*          THEN                                                    0683
@RF00660 ICM   @02,3,RISTATUS                                      0683
         BZ    @RF00683                                            0683
*            LASTCC=TERMERR;                                       0684
         MVC   LASTCC(2),@CH00482                                  0684
*          ELSE                                                    0685
*            DO;                                                   0685
         B     @RC00683                                            0685
@RF00683 DS    0H                                                  0686
*            IF SKIPFLAG(NESTLVL)=OFF                              0686
*              THEN                                                0686
         L     @02,GDTRIH(,GDTPTR)                                 0686
         SLR   @15,@15                                             0686
         IC    @15,NESTLVL(,@02)                                   0686
         ALR   @15,@15                                             0686
         ALR   @15,@02                                             0686
         TM    SKIPFLAG-2(@15),B'00010000'                         0686
         BNZ   @RF00686                                            0686
*                IF RELATION(1:MAXCCLN)=MAXCCSYM                   0687
*                  THEN                                            0687
         L     @02,KWTBLPTR(,@02)                                  0687
         SLR   @15,@15                                             0687
         IC    @15,MAXCCLN(,@02)                                   0687
         BCTR  @15,0                                               0687
         EX    @15,@SC01455                                        0687
         BNE   @RF00687                                            0687
*                    MAXCC=MIN(TERMERR,CNVRTWRD);                  0688
         L     @02,CNVRTWRD                                        0688
         LA    @15,16                                              0688
         CR    @02,@15                                             0688
         BNH   *+6
         LR    @02,@15                                             0688
         STH   @02,MAXCC                                           0688
*                  ELSE                                            0689
*                    DO;                                           0689
         B     @RC00687                                            0689
@RF00687 DS    0H                                                  0690
*                    LASTCC=MIN(TERMERR,CNVRTWRD);                 0690
         L     @02,CNVRTWRD                                        0690
         LA    @15,16                                              0690
         CR    @02,@15                                             0690
         BNH   *+6
         LR    @02,@15                                             0690
         STH   @02,LASTCC                                          0690
*                    MAXCC=MAX(MAXCC,LASTCC);                      0691
         LH    @15,MAXCC                                           0691
         CR    @15,@02                                             0691
         BNL   *+6
         LR    @15,@02                                             0691
         STH   @15,MAXCC                                           0691
*                    END;                                          0692
*            IF MAXCC >= TERMERR                                   0693
*              THEN                                                0693
@RC00687 DS    0H                                                  0693
@RF00686 LH    @02,MAXCC                                           0693
         CH    @02,@CH00482                                        0693
         BL    @RF00693                                            0693
*                RISTATUS=SKIPREST;                                0694
         MVC   RISTATUS(2),@CH00042                                0694
*              ELSE                                                0695
*                                                                  0695
*                CALL BYPASTRM;                                    0695
*                                                                  0695
         B     @RC00693                                            0695
@RF00693 BAL   @14,BYPASTRM                                        0695
*            END;                                                  0696
*                                                                  0696
@RC00693 DS    0H                                                  0697
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS 'SET' COMMAND IS A SINGLE COMMAND FOLLOWING AN   */
*        /* 'ELSE' COMMAND, THEN ADJUST THE 'IF' NESTING LEVEL ONE   */
*        /* LEVEL LESS DEEP.                                         */
*        /*                                                          */
*        /************************************************************/
*        IF SINGLCMD=YES                                           0697
*          THEN                                                    0697
@RC00683 TM    SINGLCMD,B'00010000'                                0697
         BNO   @RF00697                                            0697
*            DO;                                                   0698
*            SINGLCMD=NO;                                          0699
         NI    SINGLCMD,B'11101111'                                0699
*            IF ELSEFLAG(NESTLVL)=ON                               0700
*              THEN                                                0700
         L     @02,GDTRIH(,GDTPTR)                                 0700
         SLR   @15,@15                                             0700
         IC    @15,NESTLVL(,@02)                                   0700
         LR    @14,@15                                             0700
         ALR   @14,@14                                             0700
         ALR   @14,@02                                             0700
         TM    ELSEFLAG-2(@14),B'00100000'                         0700
         BNO   @RF00700                                            0700
*                NESTLVL=NESTLVL-1;                                0701
         BCTR  @15,0                                               0701
         STC   @15,NESTLVL(,@02)                                   0701
*            END;                                                  0702
*                                                                  0702
*        END MODALSET;                                             0703
@EL00005 DS    0H                                                  0703
@EF00005 DS    0H                                                  0703
@ER00005 LM    @14,@03,@SA00005                                    0703
         LM    @06,@12,@SA00005+24                                 0703
         BR    @14                                                 0703
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MODALIF                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */
*/*             MODAL 'IF' COMMAND WHICH FOLLOWS THE VERB NAME 'IF'. */
*/*             IF THE SYNTAX OF THE RELATIONAL EXPRESSION TO BE     */
*/*             EVALUATED IS OKAY, THEN THE EVALUATION IS DONE TO    */
*/*             DETERMINE IF THE EXPRESSION IS TRUE OR FALSE. FLAGS  */
*/*             TO CONTROL SELECTION OF FUNCTION COMMANDS TO BE      */
*/*             EXECUTED ARE SET BASED UPON THE RESULT.  A CHECK IS  */
*/*             ALSO MADE TO SEE IF A DO-GROUP OR A NESTING 'IF'     */
*/*             COMMAND FOLLOWS THE 'THEN' KEYWORD.                  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING HAS   */
*/*                    TAKING PLACE PREVIOUS TO THIS 'IF' COMMAND    */
*/*          SKIPFLAG- FLAG SET 'ON' IF COMMANDS AT CURRENT LEVEL    */
*/*                    OF 'IF' NESTING ARE JUST BEING SCANNED FOR    */
*/*                    SYNTAX CHECKING.                              */
*/*          RISTATUS- INTERNAL STATUS CODE; SET TO NON-ZERO CODE    */
*/*                    WHEN ANY ERROR IS FOUND.                      */
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND EXPRESSION.       */
*/*          UNITINDX- LENGTH OF ABOVE 'IF' COMMAND SEGMENT.         */
*/*          LASTCC -  CURRENT VALUE OF LAST SYSTEM COND. CODE       */
*/*          MAXCC -   CURRENT VALUE OF MAXIMUM SYSTEM COND. CODE    */
*/*          CNVRTWRD- VALUE (CONVERTED TO BINARY FORM) TAKEN FROM   */
*/*                    'IF' COMMAND RELATIONAL EXPRESSION TO BE      */
*/*                    COMPARTED TO THE CONDITION CODE VALUE         */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED FROM COMMAND.  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */
*/*                    TAKING PLACE AFTER THIS 'IF' COMMAND.         */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*          LASTCC -  SEE 'INPUT'                                   */
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */
*/*                    THE CURRENT 'IF' NESTING LEVEL                */
*/*          THENFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE BEING  */
*/*                    SCANNED AT CURRENT 'IF' NESTING LEVEL         */
*/*          SKIPFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE ONLY TO*/
*/*                    BE SCANNED FOR CORRECT SYNTAX.                */
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMAND FOLLOWS    */
*/*                    THE 'THEN' KEYWORD OF THE CURRENT 'IF' COMMAND*/
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND RELATIONAL EXPR.  */
*/*          UNITINDX- LENGTH OF RELATIONAL EXPRESSION SEGMENT       */
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */
*/*                    YET TO BE EXTRACTED.                          */
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND RATHER    */
*/*                    THAN A DO-GROUP FOLLOWS THE 'THEN' KEYWORD.   */
*/*                                                                  */
*/********************************************************************/
*MODALIF:PROCEDURE;                                                0704
MODALIF  STM   @14,@03,@SA00006                                    0704
         STM   @06,@12,@SA00006+24                                 0704
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR INTERPRETING MODAL 'IF' COMMAND     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0705
*        DCL CCVALUE  FIXED(15);       /*SYSTEM CONDITION CODE VALUE */
*        DCL DIGITPOS FIXED(15);       /*POSITION WITHIN RELATIONAL
*                                        EXPRESSION WHERE NUMBER TO BE
*                                        COMPARED WITH THE CC APPEARS*/
*        DCL RELOPER  CHAR(2);         /*EXTRACTED RELATIONAL      0707
*                                        OPERATOR                    */
*                                                                  0707
*        DCL GTSIGN1  CHAR(1)          /*GREATER-THAN SIGN           */
*                     CONSTANT('>');                               0708
*        DCL GTSIGN2  CHAR(2)          /*GREATER-THAN SIGN           */
*                     CONSTANT('GT');                              0709
*        DCL LTSIGN1  CHAR(1)          /*LESS-THAN SIGN              */
*                     CONSTANT('<');                               0710
*        DCL LTSIGN2  CHAR(2)          /*LESS-THAN SIGN              */
*                     CONSTANT('LT');                              0711
*        DCL NESIGN1  CHAR(2)          /*NOT-EQUAL SIGN              */
*                     CONSTANT('^=');                              0712
*        DCL NESIGN2  CHAR(2)          /*NOT-EQUAL SIGN              */
*                     CONSTANT('NE');                              0713
*        DCL GESIGN1  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */
*                     CONSTANT('>=');                              0714
*        DCL GESIGN2  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */
*                     CONSTANT('GE');                              0715
*        DCL LESIGN1  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */
*                     CONSTANT('<=');                              0716
*        DCL LESIGN2  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */
*                     CONSTANT('LE');                              0717
*        /************************************************************/
*        /*                                                          */
*        /*  ** MODALIF **  INTERPRET THE MODAL 'IF' COMMAND         */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0718
*          THEN;                                                   0718
         ICM   @02,15,GDTDBG(GDTPTR)                               0718
         BZ    @RT00718                                            0718
*          ELSE                                                    0720
*            CALL IDCDB010(GDTTBL,'RIMI');                         0720
*                                                                  0720
         ST    GDTPTR,@AL00001                                     0720
         LA    @02,@CC01036                                        0720
         ST    @02,@AL00001+4                                      0720
         MVI   @AL00001+4,X'80'                                    0720
         L     @15,GDTDBG(,GDTPTR)                                 0720
         LA    @01,@AL00001                                        0720
         BALR  @14,@15                                             0720
*        /************************************************************/
*        /*                                                          */
*        /* NOTE THAT THIS 'IF' COMMAND MEANS ONE LEVEL DEEPER OF    */
*        /* 'IF' NESTING.                                            */
*        /*                                                          */
*        /************************************************************/
*        NESTLVL=NESTLVL+1;                                        0721
@RT00718 L     @02,GDTRIH(,GDTPTR)                                 0721
         LA    @15,1                                               0721
         SLR   @14,@14                                             0721
         IC    @14,NESTLVL(,@02)                                   0721
         ALR   @15,@14                                             0721
         STC   @15,NESTLVL(,@02)                                   0721
*        IF NESTLVL > IFNSTMX                                      0722
*          THEN                                                    0722
         CLI   NESTLVL(@02),10                                     0722
         BNH   @RF00722                                            0722
*            DO;                                                   0723
*            RISTATUS=BADIFNST;                                    0724
         MVC   RISTATUS(2),@CH00979                                0724
*            LASTCC=TERMERR;                                       0725
         MVC   LASTCC(2),@CH00482                                  0725
*            RETURN;                                               0726
@EL00006 DS    0H                                                  0726
@EF00006 DS    0H                                                  0726
@ER00006 LM    @14,@03,@SA00006                                    0726
         LM    @06,@12,@SA00006+24                                 0726
         BR    @14                                                 0726
*            END;                                                  0727
*        MODLFLGS(NESTLVL)=''B;                                    0728
@RF00722 L     @15,GDTRIH(,GDTPTR)                                 0728
         SLR   @14,@14                                             0728
         IC    @14,NESTLVL(,@15)                                   0728
         ALR   @14,@14                                             0728
         ST    @14,@TF00001                                        0728
         ALR   @14,@15                                             0728
         XC    MODLFLGS-2(2,@14),MODLFLGS-2(@14)                   0728
*        THENFLAG(NESTLVL)=ON;                                     0729
         AL    @15,@TF00001                                        0729
         OI    THENFLAG-2(@15),B'01000000'                         0729
*        IFNEXT=NO;                                                0730
*                                                                  0730
         NI    IFNEXT,B'11110111'                                  0730
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE ELEMENTS OF THE RELATIONAL EXPRESSION THAT   */
*        /* FOLLOWS THE 'IF' VERB (THERE MAY OR MAY NOT BE DELIMITERS*/
*        /* SURROUNDING THE COMPARISON SIGN), CHECKING TO BE SURE    */
*        /* THAT THE MAXIMUM POSSIBLE LENGTH FOR SUCH AN EXPRESSION  */
*        /* IS NOT EXCEEDED.                                         */
*        /*                                                          */
*        /************************************************************/
*        RELATION=BLANK;                                           0731
         MVI   RELATION+1,C' '                                     0731
         MVC   RELATION+2(30),RELATION+1                           0731
         MVI   RELATION,C' '                                       0731
*        RELSIZE=0;                                                0732
         SLR   RELSIZE,RELSIZE                                     0732
*        EXPREND=NO;                                               0733
         NI    EXPREND,B'11011111'                                 0733
*        DO WHILE(EXPREND=NO & RISTATUS=0);                        0734
*                                                                  0734
         B     @DE00734                                            0734
@DL00734 DS    0H                                                  0735
*          CALL NXTFIELD(VERBFLD);                                 0735
         LA    @01,@AL00735                                        0735
         BAL   @14,NXTFIELD                                        0735
*          CALL SCANSEP(NO);                                       0736
*                                                                  0736
         LA    @01,@AL00736                                        0736
         BAL   @14,SCANSEP                                         0736
*          IF RELSIZE+UNITINDX = 0                                0737
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM
*            THEN                                                  0737
         LR    @15,RELSIZE                                         0737
         ALR   @15,UNITINDX                                        0737
         LTR   @15,@15                                             0737
         BZ    @RT00737                                            0737
         L     @01,GDTRIH(,GDTPTR)                                 0737
         L     @14,KWTBLPTR(,@01)                                  0737
         SLR   @01,@01                                             0737
         IC    @01,MAXCCLN(,@14)                                   0737
         SLR   @00,@00                                             0737
         IC    @00,LSTCCLN(,@14)                                   0737
         CR    @01,@00                                             0737
         BNL   *+6
         LR    @01,@00                                             0737
         AH    @01,@CH00038                                        0737
         CR    @15,@01                                             0737
         BNH   @RF00737                                            0737
@RT00737 DS    0H                                                  0738
*              RISTATUS=BADEXPR1;                                  0738
         MVC   RISTATUS(2),@CH00974                                0738
*            ELSE                                                  0739
*              DO;                                                 0739
         B     @RC00737                                            0739
@RF00737 DS    0H                                                  0740
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0740
         LA    @01,RELATION(RELSIZE)                               0740
         LR    @15,UNITINDX                                        0740
         BCTR  @15,0                                               0740
         EX    @15,@SM01447                                        0740
*              RELSIZE=RELSIZE+UNITINDX;                           0741
*                                                                  0741
         ALR   RELSIZE,UNITINDX                                    0741
*              /******************************************************/
*              /*                                                    */
*              /* THE FINAL CHARACTER IN THE LAST EXPRESSION ELEMENT */
*              /* SHOULD ALWAYS BE A DECIMAL DIGIT; OTHERWISE, THE   */
*              /* RELATIONAL EXPRESSION IS IN ERROR.                 */
*              /*                                                    */
*              /******************************************************/
*              IF SYNUNIT(UNITINDX) >= '0' & SYNUNIT(UNITINDX) <= '9' 
*                 CHAR1=ENDDELIM                                   0742
*                THEN                                              0742
         LA    @01,SYNUNIT-1(UNITINDX)                             0742
         CLI   0(@01),C'0'                                         0742
         BL    @GL00020                                            0742
         LA    @01,SYNUNIT-1(UNITINDX)                             0742
         CLI   0(@01),C'9'                                         0742
         BNH   @RT00742                                            0742
@GL00020 CLI   CHAR1,C';'                                          0742
         BNE   @RF00742                                            0742
@RT00742 DS    0H                                                  0743
*                  EXPREND=YES;                                    0743
         OI    EXPREND,B'00100000'                                 0743
*              END;                                                0744
@RF00742 DS    0H                                                  0745
*        END;                                                      0745
@RC00737 DS    0H                                                  0745
@DE00734 TM    EXPREND,B'00100000'                                 0745
         BNZ   @DC00734                                            0745
         ICM   @15,3,RISTATUS                                      0745
         BZ    @DL00734                                            0745
@DC00734 DS    0H                                                  0746
*        IF RISTATUS=0                                             0746
*          THEN                                                    0746
*                                                                  0746
         ICM   @15,3,RISTATUS                                      0746
         BNZ   @RF00746                                            0746
*            /********************************************************/
*            /*                                                      */
*            /* DEPENDING UPON WHETHER THE EXPRESSION INVOLVES MAXCC */
*            /* OR LASTCC, OBTAIN THE CURRENT CONDITION CODE TO BE   */
*            /* USED IN THE COMPARISON.                              */
*            /*                                                      */
*            /********************************************************/
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0747
*              THEN                                                0747
         L     @01,GDTRIH(,GDTPTR)                                 0747
         L     @15,KWTBLPTR(,@01)                                  0747
         SLR   @14,@14                                             0747
         IC    @14,MAXCCLN(,@15)                                   0747
         LR    @01,@14                                             0747
         BCTR  @01,0                                               0747
         EX    @01,@SC01449                                        0747
         BNE   @RF00747                                            0747
*                DO;                                               0748
*                CCVALUE=MAXCC;                                    0749
         MVC   CCVALUE(2),MAXCC                                    0749
*                PART1LEN=MAXCCLN;                                 0750
         LR    PART1LEN,@14                                        0750
*                END;                                              0751
*              ELSE                                                0752
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0752
*                  THEN                                            0752
         B     @RC00747                                            0752
@RF00747 L     @01,GDTRIH(,GDTPTR)                                 0752
         L     @15,KWTBLPTR(,@01)                                  0752
         SLR   @14,@14                                             0752
         IC    @14,LSTCCLN(,@15)                                   0752
         LR    @01,@14                                             0752
         BCTR  @01,0                                               0752
         EX    @01,@SC01451                                        0752
         BNE   @RF00752                                            0752
*                    DO;                                           0753
*                    CCVALUE=LASTCC;                               0754
         MVC   CCVALUE(2),LASTCC                                   0754
*                    PART1LEN=LSTCCLN;                             0755
         LR    PART1LEN,@14                                        0755
*                    END;                                          0756
*                  ELSE                                            0757
*                    RISTATUS=BADEXPR1;                            0757
         B     @RC00752                                            0757
@RF00752 MVC   RISTATUS(2),@CH00974                                0757
*        IF RISTATUS=0                                             0758
*          THEN                                                    0758
@RC00752 DS    0H                                                  0758
@RC00747 DS    0H                                                  0758
@RF00746 ICM   @15,3,RISTATUS                                      0758
         BNZ   @RF00758                                            0758
*DOGRP30:    DO;                                                   0759
*                                                                  0759
DOGRP30  DS    0H                                                  0760
*            /********************************************************/
*            /*                                                      */
*            /* SKIP PAST THE OPERATOR OF THE RELATIONAL EXPRESSION  */
*            /* AND CONVERT THE NUMBER TO WHICH THE CONDITION CODE   */
*            /* VALUE IS TO BE COMPARED.                             */
*            /*                                                      */
*            /********************************************************/
*            IF RELATION(PART1LEN+2) >= '0' &                      0760
*               RELATION(PART1LEN+2) <= '9'                        0760
*              THEN                                                0760
         LA    @01,RELATION+1(PART1LEN)                            0760
         CLI   0(@01),C'0'                                         0760
         BL    @RF00760                                            0760
         LA    @01,RELATION+1(PART1LEN)                            0760
         CLI   0(@01),C'9'                                         0760
         BH    @RF00760                                            0760
*                DIGITPOS=PART1LEN+2;                              0761
         LA    @01,2(,PART1LEN)                                    0761
         STH   @01,DIGITPOS                                        0761
*              ELSE                                                0762
*                DIGITPOS=PART1LEN+3;                              0762
         B     @RC00760                                            0762
@RF00760 LA    @01,3(,PART1LEN)                                    0762
         STH   @01,DIGITPOS                                        0762
*            IF DIGITPOS <= RELSIZE                                0763
*              THEN                                                0763
@RC00760 LH    @15,DIGITPOS                                        0763
         CR    @15,RELSIZE                                         0763
         BH    @RF00763                                            0763
*                DO;                                               0764
*                UNITINDX=RELSIZE-DIGITPOS+1;                      0765
         LR    @14,RELSIZE                                         0765
         SLR   @14,@15                                             0765
         LA    UNITINDX,1                                          0765
         ALR   UNITINDX,@14                                        0765
*                SYNUNIT=RELATION(DIGITPOS:RELSIZE);               0766
*                                                                  0766
         MVI   SYNUNIT+1,C' '                                      0766
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0766
         LA    @01,RELATION-1(@15)                                 0766
         EX    @14,@SM01453                                        0766
*                CALL PACKCVB;                                     0767
*                                                                  0767
         BAL   @14,PACKCVB                                         0767
*                IF RISTATUS^=0                                    0768
*                  THEN                                            0768
         ICM   @02,3,RISTATUS                                      0768
         BZ    @RF00768                                            0768
*                    RISTATUS=SKIPREST;                            0769
         MVC   RISTATUS(2),@CH00042                                0769
*                END;                                              0770
*              ELSE                                                0771
*                RISTATUS=BADEXPR1;                                0771
*                                                                  0771
         B     @RC00763                                            0771
@RF00763 MVC   RISTATUS(2),@CH00974                                0771
*            /********************************************************/
*            /*                                                      */
*            /* MATCH THE EXPRESSION'S OPERATOR WITH ONE OF THE      */
*            /* OPERATORS ALLOWED; THEN PERFORM THE INDICATED        */
*            /* COMPARISON BETWEEN THE CONDITION CODE & THE PROVIDED */
*            /* VALUE.  IF A MATCHING OPERATOR IS NOT FOUND, IT IS   */
*            /* AN ERROR.  IF THE COMPARISON IS FALSE, A FLAG IS SET */
*            /* TO SIGNAL THAT COMMANDS ASSOCIATED WITH THE 'THEN    */
*            /* PATH' ARE SIMPLY TO BE SCANNED FOR CORRECT SYNTAX.   */
*            /*                                                      */
*            /********************************************************/
*            RELOPER=RELATION(PART1LEN+1:DIGITPOS-1);              0772
@RC00763 MVI   RELOPER+1,C' '                                      0772
         LH    @02,DIGITPOS                                        0772
         SLR   @02,PART1LEN                                        0772
         BCTR  @02,0                                               0772
         BCTR  @02,0                                               0772
         LA    @01,RELATION(PART1LEN)                              0772
         EX    @02,@SM01457                                        0772
*            IF RELOPER=GESIGN1  RELOPER=GESIGN2                  0773
*              THEN                                                0773
         CLC   RELOPER(2),@CC01029                                 0773
         BE    @RT00773                                            0773
         CLC   RELOPER(2),@CC01031                                 0773
         BNE   @RF00773                                            0773
@RT00773 DS    0H                                                  0774
*                IF CCVALUE < CNVRTWRD                             0774
*                  THEN                                            0774
         LH    @02,CCVALUE                                         0774
         C     @02,CNVRTWRD                                        0774
         BNL   @RF00774                                            0774
*                    SKIPFLAG(NESTLVL)=ON;                         0775
         L     @02,GDTRIH(,GDTPTR)                                 0775
         SLR   @15,@15                                             0775
         IC    @15,NESTLVL(,@02)                                   0775
         ALR   @15,@15                                             0775
         ALR   @02,@15                                             0775
         OI    SKIPFLAG-2(@02),B'00010000'                         0775
*                  ELSE;                                           0776
@RF00774 DS    0H                                                  0777
*              ELSE                                                0777
*                IF RELOPER=LESIGN1  RELOPER=LESIGN2              0777
*                  THEN                                            0777
         B     @RC00773                                            0777
@RF00773 CLC   RELOPER(2),@CC01033                                 0777
         BE    @RT00777                                            0777
         CLC   RELOPER(2),@CC01035                                 0777
         BNE   @RF00777                                            0777
@RT00777 DS    0H                                                  0778
*                    IF CCVALUE > CNVRTWRD                         0778
*                      THEN                                        0778
         LH    @02,CCVALUE                                         0778
         C     @02,CNVRTWRD                                        0778
         BNH   @RF00778                                            0778
*                        SKIPFLAG(NESTLVL)=ON;                     0779
         L     @02,GDTRIH(,GDTPTR)                                 0779
         SLR   @15,@15                                             0779
         IC    @15,NESTLVL(,@02)                                   0779
         ALR   @15,@15                                             0779
         ALR   @02,@15                                             0779
         OI    SKIPFLAG-2(@02),B'00010000'                         0779
*                      ELSE;                                       0780
@RF00778 DS    0H                                                  0781
*                  ELSE                                            0781
*                    IF RELOPER=NESIGN1  RELOPER=NESIGN2          0781
*                      THEN                                        0781
         B     @RC00777                                            0781
@RF00777 CLC   RELOPER(2),@CC01025                                 0781
         BE    @RT00781                                            0781
         CLC   RELOPER(2),@CC01027                                 0781
         BNE   @RF00781                                            0781
@RT00781 DS    0H                                                  0782
*                        IF CCVALUE=CNVRTWRD                       0782
*                          THEN                                    0782
         LH    @02,CCVALUE                                         0782
         C     @02,CNVRTWRD                                        0782
         BNE   @RF00782                                            0782
*                            SKIPFLAG(NESTLVL)=ON;                 0783
         L     @02,GDTRIH(,GDTPTR)                                 0783
         SLR   @15,@15                                             0783
         IC    @15,NESTLVL(,@02)                                   0783
         ALR   @15,@15                                             0783
         ALR   @02,@15                                             0783
         OI    SKIPFLAG-2(@02),B'00010000'                         0783
*                          ELSE;                                   0784
@RF00782 DS    0H                                                  0785
*                      ELSE                                        0785
*                        IF RELOPER=GTSIGN1  RELOPER=GTSIGN2      0785
*                          THEN                                    0785
         B     @RC00781                                            0785
@RF00781 CLI   RELOPER,C'>'                                        0785
         BE    @RT00785                                            0785
         CLC   RELOPER(2),@CC01019                                 0785
         BNE   @RF00785                                            0785
@RT00785 DS    0H                                                  0786
*                            IF CCVALUE <= CNVRTWRD                0786
*                              THEN                                0786
         LH    @02,CCVALUE                                         0786
         C     @02,CNVRTWRD                                        0786
         BH    @RF00786                                            0786
*                                SKIPFLAG(NESTLVL)=ON;             0787
         L     @02,GDTRIH(,GDTPTR)                                 0787
         SLR   @15,@15                                             0787
         IC    @15,NESTLVL(,@02)                                   0787
         ALR   @15,@15                                             0787
         ALR   @02,@15                                             0787
         OI    SKIPFLAG-2(@02),B'00010000'                         0787
*                              ELSE;                               0788
@RF00786 DS    0H                                                  0789
*                          ELSE                                    0789
*                            IF RELOPER=LTSIGN1  RELOPER=LTSIGN2  0789
*                              THEN                                0789
         B     @RC00785                                            0789
@RF00785 CLI   RELOPER,C'<'                                        0789
         BE    @RT00789                                            0789
         CLC   RELOPER(2),@CC01023                                 0789
         BNE   @RF00789                                            0789
@RT00789 DS    0H                                                  0790
*                                IF CCVALUE >= CNVRTWRD            0790
*                                  THEN                            0790
         LH    @02,CCVALUE                                         0790
         C     @02,CNVRTWRD                                        0790
         BL    @RF00790                                            0790
*                                    SKIPFLAG(NESTLVL)=ON;         0791
         L     @02,GDTRIH(,GDTPTR)                                 0791
         SLR   @15,@15                                             0791
         IC    @15,NESTLVL(,@02)                                   0791
         ALR   @15,@15                                             0791
         ALR   @02,@15                                             0791
         OI    SKIPFLAG-2(@02),B'00010000'                         0791
*                                  ELSE;                           0792
@RF00790 DS    0H                                                  0793
*                              ELSE                                0793
*                                IF RELOPER=EQSIGN1  RELOPER=EQSIGN2
*                                  THEN                            0793
         B     @RC00789                                            0793
@RF00789 CLI   RELOPER,C'='                                        0793
         BE    @RT00793                                            0793
         CLC   RELOPER(2),@CC00968                                 0793
         BNE   @RF00793                                            0793
@RT00793 DS    0H                                                  0794
*                                    IF CCVALUE ^= CNVRTWRD        0794
*                                      THEN                        0794
         LH    @02,CCVALUE                                         0794
         C     @02,CNVRTWRD                                        0794
         BE    @RF00794                                            0794
*                                        SKIPFLAG(NESTLVL)=ON;     0795
         L     @02,GDTRIH(,GDTPTR)                                 0795
         SLR   @15,@15                                             0795
         IC    @15,NESTLVL(,@02)                                   0795
         ALR   @15,@15                                             0795
         ALR   @02,@15                                             0795
         OI    SKIPFLAG-2(@02),B'00010000'                         0795
*                                      ELSE;                       0796
@RF00794 DS    0H                                                  0797
*                                  ELSE                            0797
*                                    RISTATUS=BADEXPR1;            0797
*                                                                  0797
         B     @RC00793                                            0797
@RF00793 MVC   RISTATUS(2),@CH00974                                0797
*            /********************************************************/
*            /*                                                      */
*            /* IF THIS 'IF' COMMAND IS JUST BEING SCANNED FOR SYNTAX*/
*            /* CHECKING, THEN OVERRIDE THE RESULT OF THE RELATIONAL */
*            /* EXPRESSION EVALUATION AND NOTE THAT ALL COMMANDS AT  */
*            /* THIS DEEPER LEVEL ARE ALSO JUST TO BE SCANNED.       */
*            /*                                                      */
*            /********************************************************/
*            IF NESTLVL>1 & SKIPFLAG(NESTLVL-1)=ON                 0798
*              THEN                                                0798
@RC00793 DS    0H                                                  0798
@RC00789 DS    0H                                                  0798
@RC00785 DS    0H                                                  0798
@RC00781 DS    0H                                                  0798
@RC00777 DS    0H                                                  0798
@RC00773 L     @02,GDTRIH(,GDTPTR)                                 0798
         CLI   NESTLVL(@02),1                                      0798
         BNH   @RF00798                                            0798
         SLR   @15,@15                                             0798
         IC    @15,NESTLVL(,@02)                                   0798
         ALR   @15,@15                                             0798
         ST    @15,@TF00001                                        0798
         ALR   @15,@02                                             0798
         TM    SKIPFLAG-4(@15),B'00010000'                         0798
         BNO   @RF00798                                            0798
*                SKIPFLAG(NESTLVL)=ON;                             0799
*                                                                  0799
         AL    @02,@TF00001                                        0799
         OI    SKIPFLAG-2(@02),B'00010000'                         0799
*            END DOGRP30;                                          0800
@RF00798 DS    0H                                                  0801
*        IF RISTATUS=0                                             0801
*          THEN                                                    0801
@RF00758 ICM   @02,3,RISTATUS                                      0801
         BNZ   @RF00801                                            0801
*DOGRP35:    DO;                                                   0802
*                                                                  0802
DOGRP35  DS    0H                                                  0803
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE FIELD WHICH FOLLOWS THE RELATIONAL       */
*            /* EXPRESSION AND MAKE SURE IT IS THE 'THEN' KEYWORD;   */
*            /* OTHERWISE, A SYNTAX ERROR HAS BEEN FOUND.            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0803
*            CALL NXTFIELD(VERBFLD);                               0803
         LA    @01,@AL00803                                        0803
         BAL   @14,NXTFIELD                                        0803
*            CALL SCANSEP(NO);                                     0804
*                                                                  0804
         LA    @01,@AL00804                                        0804
         BAL   @14,SCANSEP                                         0804
*            IF RISTATUS=0 & SYNUNIT=THENSYM                       0805
*              THEN                                                0805
*                                                                  0805
         ICM   @02,3,RISTATUS                                      0805
         BNZ   @RF00805                                            0805
         L     @02,GDTRIH(,GDTPTR)                                 0805
         L     @02,KWTBLPTR(,@02)                                  0805
         CLC   SYNUNIT(9),THENSYM(@02)                             0805
         BNE   @RF00805                                            0805
*                /****************************************************/
*                /*                                                  */
*                /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS */
*                /* THE 'THEN' KEYWORD, THE 'THEN PATH' JUST CONSISTS*/
*                /* OF A NULL COMMAND.  THE DELIMITER IS SIMPLY      */
*                /* BYPASSED AND SCANNING CONTINUES.                 */
*                /*                                                  */
*                /****************************************************/
*                IF CHAR1=ENDDELIM                                 0806
*                  THEN                                            0806
*                                                                  0806
         CLI   CHAR1,C';'                                          0806
         BNE   @RF00806                                            0806
*                    CALL BYPASTRM;                                0807
*                                                                  0807
         BAL   @14,BYPASTRM                                        0807
*                  ELSE                                            0808
*                                                                  0808
*                    /************************************************/
*                    /*                                              */
*                    /* EXTRACT THE VERB NAME OF THE COMMAND WHICH   */
*                    /* FOLLOWS THE 'THEN' KEYWORD. IF IT IS A 'DO'  */
*                    /* COMMAND, SET THE FLAG THAT INDICATES THAT A  */
*                    /* 'DO GROUP' FOLLOWS AND SCAN UP TO THE NEXT   */
*                    /* COMMAND VERB NAME.  IF NOT A 'DO', NOTE THAT */
*                    /* THE NEXT COMMAND VERB NAME HAS ALREADY BEEN  */
*                    /* EXTRACTED.  IF THAT VERB NAME IS NOT 'IF',   */
*                    /* THEN A SINGLE COMMAND FOLLOWS THE 'THEN' AT  */
*                    /* THIS NESTING LEVEL.                          */
*                    /*                                              */
*                    /************************************************/
*                    DO;                                           0808
*                                                                  0808
         B     @RC00806                                            0808
@RF00806 DS    0H                                                  0809
*                    CALL NXTFIELD(VERBFLD);                       0809
         LA    @01,@AL00809                                        0809
         BAL   @14,NXTFIELD                                        0809
*                    CALL SCANSEP(NO);                             0810
*                                                                  0810
         LA    @01,@AL00810                                        0810
         BAL   @14,SCANSEP                                         0810
*                    IF RISTATUS=0 & SYNUNIT=DOSYM                 0811
*                      THEN                                        0811
         ICM   @02,3,RISTATUS                                      0811
         BNZ   @RF00811                                            0811
         L     @02,GDTRIH(,GDTPTR)                                 0811
         L     @02,KWTBLPTR(,@02)                                  0811
         CLC   SYNUNIT(9),DOSYM(@02)                               0811
         BNE   @RF00811                                            0811
*                        DO;                                       0812
*                                                                  0812
*                        CALL BYPASTRM;                            0813
*                                                                  0813
         BAL   @14,BYPASTRM                                        0813
*                        DOFLAG(NESTLVL)=ON;                       0814
         L     @02,GDTRIH(,GDTPTR)                                 0814
         SLR   @15,@15                                             0814
         IC    @15,NESTLVL(,@02)                                   0814
         ALR   @15,@15                                             0814
         ALR   @02,@15                                             0814
         OI    DOFLAG-2(@02),B'10000000'                           0814
*                        END;                                      0815
*                      ELSE                                        0816
*                        DO;                                       0816
         B     @RC00811                                            0816
@RF00811 DS    0H                                                  0817
*                        GETVERB=NO;                               0817
         NI    GETVERB,B'11111011'                                 0817
*                        IF SYNUNIT ^= IFSYM                       0818
*                          THEN                                    0818
         L     @02,GDTRIH(,GDTPTR)                                 0818
         L     @02,KWTBLPTR(,@02)                                  0818
         CLC   SYNUNIT(9),IFSYM(@02)                               0818
         BE    @RF00818                                            0818
*                            SINGLCMD=YES;                         0819
         OI    SINGLCMD,B'00010000'                                0819
*                          ELSE                                    0820
*                            IFNEXT=YES;                           0820
         B     @RC00818                                            0820
@RF00818 OI    IFNEXT,B'00001000'                                  0820
*                        END;                                      0821
*                    END;                                          0822
*                                                                  0822
*              /******************************************************/
*              /*                                                    */
*              /* THE KEYWORD 'THEN' IS MISSING FROM 'IF' COMMAND    */
*              /* OR SOME OTHER ERROR HAS ALREADY OCCURRED.          */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0823
*                IF RISTATUS=0                                     0823
*                  THEN                                            0823
         B     @RC00805                                            0823
@RF00805 ICM   @02,3,RISTATUS                                      0823
         BNZ   @RF00823                                            0823
*                    DO;                                           0824
*                    LASTCC=TERMERR;                               0825
         MVC   LASTCC(2),@CH00482                                  0825
*                    RISTATUS=NOTHEN;                              0826
         MVC   RISTATUS(2),@CH00977                                0826
*                    END;                                          0827
*            END DOGRP35;                                          0828
@RF00823 DS    0H                                                  0828
@RC00805 DS    0H                                                  0829
*        IF RISTATUS ^= 0                                          0829
*          THEN                                                    0829
@RF00801 LH    @02,RISTATUS                                        0829
         LTR   @02,@02                                             0829
         BZ    @RF00829                                            0829
*            IF RISTATUS=EOFILE & EOFOK=YES                        0830
*              THEN;                                               0830
         CH    @02,@CH00157                                        0830
         BNE   @RF00830                                            0830
         TM    EOFOK,B'01000000'                                   0830
         BO    @RT00830                                            0830
*              ELSE                                                0832
*                LASTCC=TERMERR;                                   0832
*                                                                  0832
@RF00830 MVC   LASTCC(2),@CH00482                                  0832
*        END MODALIF;                                              0833
         B     @EL00006                                            0833
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MODLELSE                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SETS UP TO SCAN AND INTERPRET WHAT      */
*/*             FOLLOWS THE 'ELSE' COMMAND.  APPROPRIATE CONTROL     */
*/*             FLAGS ARE SET AND A CHECK IS MADE TO SEE IF AN 'IF'  */
*/*             COMMAND OR A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.    */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          SKIPFLAG- FLAG SET 'ON' WHEN COMMANDS ARE (HAVE BEEN)   */
*/*                    GETTING SCANNED FOR SYNTAX CHECKING ONLY.     */
*/*          NESTLVL - LEVEL OF 'IF' COMMAND NESTING AT WHICH        */
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */
*/*          CHAR1 -   CHARACTER MOST RECENTLY EXTRACTED.            */
*/*          SYNUNIT - SYNTACTIC UNIT MOST RECENTLY EXTRACTED.       */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */
*/*                    CURRENT 'IF' NESTING LEVEL                    */
*/*          THENFLAG- SET 'ON' WHEN SCANNING 'THEN-PATH' COMMANDS   */
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */
*/*          ELSEFLAG- SET 'ON' WHEN SCANNING 'ELSE-PATH' COMMANDS   */
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */
*/*          SKIPFLAG- SEE 'INPUT'                                   */
*/*          NESTLVL - CURRENT LEVEL OF 'IF' COMMAND NESTING         */
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMANDS FOLLOWS   */
*/*                    THE 'ELSE' COMMAND VERB                       */
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */
*/*                    YET TO BE EXTRACTED AFTER THE 'ELSE' COMMAND. */
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND AS OPPOSED*/
*/*                    TO A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.     */
*/*          LASTCC -  VALUE OF LAST SYSTEM CONDITION CODE; MAY BE   */
*/*                    RESET IF SYNTAX ERROR IS FOUND IN 'ELSE' CMD. */
*/*                                                                  */
*/********************************************************************/
*MODLELSE:PROCEDURE;                                               0834
MODLELSE STM   @14,@04,@SA00007                                    0834
         STM   @06,@12,@SA00007+28                                 0834
*        /************************************************************/
*        /*                                                          */
*        /*  ** MODLELSE **  INTERPRET THE MODAL 'ELSE' COMMAND      */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0835
*          THEN;                                                   0835
         ICM   @04,15,GDTDBG(GDTPTR)                               0835
         BZ    @RT00835                                            0835
*          ELSE                                                    0837
*            CALL IDCDB010(GDTTBL,'RIME');                         0837
*                                                                  0837
         ST    GDTPTR,@AL00001                                     0837
         LA    @04,@CC01046                                        0837
         ST    @04,@AL00001+4                                      0837
         MVI   @AL00001+4,X'80'                                    0837
         L     @15,GDTDBG(,GDTPTR)                                 0837
         LA    @01,@AL00001                                        0837
         BALR  @14,@15                                             0837
*        THENFLAG(NESTLVL)=OFF;                                    0838
@RT00835 DS    0H                                                  0839
*        ELSEFLAG(NESTLVL)=ON;                                     0839
*                                                                  0839
         L     @04,GDTRIH(,GDTPTR)                                 0839
         SLR   @02,@02                                             0839
         IC    @02,NESTLVL(,@04)                                   0839
         ALR   @02,@02                                             0839
         ST    @02,@TF00001                                        0839
         ALR   @02,@04                                             0839
         OI    ELSEFLAG-2(@02),B'00100000'                         0839
         NI    THENFLAG-2(@02),B'10111111'                         0839
*        /************************************************************/
*        /*                                                          */
*        /* IF WHAT FOLLOWED THE MATCHING 'THEN' FOR THIS 'ELSE' WAS */
*        /* SCANNED ONLY (BECAUSE OF THE RESULT OF AN 'IF'           */
*        /* EXPRESSION), THEN SET THE FLAG TO INDICATE THAT A        */
*        /* FUNCTION COMMAND ASSOCIATED WITH THIS 'ELSE' MAY BE      */
*        /* ACCEPTED FOR EXECUTION.                                  */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPFLAG(NESTLVL)=OFF                                  0840
*          THEN                                                    0840
         LR    @02,@04                                             0840
         AL    @02,@TF00001                                        0840
         TM    SKIPFLAG-2(@02),B'00010000'                         0840
         BNZ   @RF00840                                            0840
*            SKIPFLAG(NESTLVL)=ON;                                 0841
         AL    @04,@TF00001                                        0841
         OI    SKIPFLAG-2(@04),B'00010000'                         0841
*          ELSE                                                    0842
*            IF NESTLVL<=1  SKIPFLAG(NESTLVL-1)=OFF               0842
*              THEN                                                0842
         B     @RC00840                                            0842
@RF00840 L     @04,GDTRIH(,GDTPTR)                                 0842
         CLI   NESTLVL(@04),1                                      0842
         BNH   @RT00842                                            0842
         SLR   @02,@02                                             0842
         IC    @02,NESTLVL(,@04)                                   0842
         ALR   @02,@02                                             0842
         ALR   @04,@02                                             0842
         TM    SKIPFLAG-4(@04),B'00010000'                         0842
         BNZ   @RF00842                                            0842
@RT00842 DS    0H                                                  0843
*                SKIPFLAG(NESTLVL)=OFF;                            0843
*                                                                  0843
         L     @04,GDTRIH(,GDTPTR)                                 0843
         SLR   @02,@02                                             0843
         IC    @02,NESTLVL(,@04)                                   0843
         ALR   @02,@02                                             0843
         ALR   @04,@02                                             0843
         NI    SKIPFLAG-2(@04),B'11101111'                         0843
*        /************************************************************/
*        /*                                                          */
*        /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS THE     */
*        /* 'ELSE' KEYWORD, THE 'ELSE PATH' CONSISTS ONLY OF A NULL  */
*        /* COMMAND.  THE COMMAND-END DELIMITER IS THEN BYPASSED AND */
*        /* SCANNING CONTINUES.                                      */
*        /*                                                          */
*        /************************************************************/
*        IF CHAR1=ENDDELIM                                         0844
*          THEN                                                    0844
@RF00842 DS    0H                                                  0844
@RC00840 CLI   CHAR1,C';'                                          0844
         BNE   @RF00844                                            0844
*            DO;                                                   0845
*            NESTLVL=NESTLVL-1;                                    0846
*                                                                  0846
         L     @04,GDTRIH(,GDTPTR)                                 0846
         SLR   @02,@02                                             0846
         IC    @02,NESTLVL(,@04)                                   0846
         BCTR  @02,0                                               0846
         STC   @02,NESTLVL(,@04)                                   0846
*            CALL BYPASTRM;                                        0847
*                                                                  0847
         BAL   @14,BYPASTRM                                        0847
*            END;                                                  0848
*          ELSE                                                    0849
*                                                                  0849
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE VERB NAME OF THE COMMAND WHICH FOLLOWS   */
*            /* THE 'ELSE'.  IF IT IS A 'DO' COMMAND, SET THE FLAG   */
*            /* THAT INDICATES THAT A 'DO GROUP' FOLLOWS AND SCAN UP */
*            /* TO THE NEXT COMMAND VERB NAME.  IF NOT A 'DO', NOTE  */
*            /* THAT THE NEXT COMMAND VERB NAME HAS ALREADY BEEN     */
*            /* EXTRACTED.                                           */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0849
*                                                                  0849
         B     @RC00844                                            0849
@RF00844 DS    0H                                                  0850
*            CALL NXTFIELD(VERBFLD);                               0850
         LA    @01,@AL00850                                        0850
         BAL   @14,NXTFIELD                                        0850
*            CALL SCANSEP(NO);                                     0851
*                                                                  0851
         LA    @01,@AL00851                                        0851
         BAL   @14,SCANSEP                                         0851
*            IF SYNUNIT=DOSYM                                      0852
*              THEN                                                0852
         L     @04,GDTRIH(,GDTPTR)                                 0852
         L     @04,KWTBLPTR(,@04)                                  0852
         CLC   SYNUNIT(9),DOSYM(@04)                               0852
         BNE   @RF00852                                            0852
*                DO;                                               0853
*                                                                  0853
*                CALL BYPASTRM;                                    0854
*                                                                  0854
         BAL   @14,BYPASTRM                                        0854
*                DOFLAG(NESTLVL)=ON;                               0855
         L     @04,GDTRIH(,GDTPTR)                                 0855
         SLR   @02,@02                                             0855
         IC    @02,NESTLVL(,@04)                                   0855
         ALR   @02,@02                                             0855
         ALR   @04,@02                                             0855
         OI    DOFLAG-2(@04),B'10000000'                           0855
*                END;                                              0856
*              ELSE                                                0857
*                DO;                                               0857
         B     @RC00852                                            0857
@RF00852 DS    0H                                                  0858
*                GETVERB=NO;                                       0858
         NI    GETVERB,B'11111011'                                 0858
*                IF SYNUNIT^=IFSYM                                 0859
*                  THEN                                            0859
         L     @04,GDTRIH(,GDTPTR)                                 0859
         L     @04,KWTBLPTR(,@04)                                  0859
         CLC   SYNUNIT(9),IFSYM(@04)                               0859
         BE    @RF00859                                            0859
*                    SINGLCMD=YES;                                 0860
         OI    SINGLCMD,B'00010000'                                0860
*                  ELSE                                            0861
*                    IFNEXT=YES;                                   0861
         B     @RC00859                                            0861
@RF00859 OI    IFNEXT,B'00001000'                                  0861
*                END;                                              0862
@RC00859 DS    0H                                                  0863
*            END;                                                  0863
*                                                                  0863
@RC00852 DS    0H                                                  0864
*        IF RISTATUS ^= 0                                          0864
*          THEN                                                    0864
@RC00844 LH    @04,RISTATUS                                        0864
         LTR   @04,@04                                             0864
         BZ    @RF00864                                            0864
*            IF RISTATUS=EOFILE & EOFOK=YES                        0865
*              THEN;                                               0865
         CH    @04,@CH00157                                        0865
         BNE   @RF00865                                            0865
         TM    EOFOK,B'01000000'                                   0865
         BO    @RT00865                                            0865
*              ELSE                                                0867
*                LASTCC=TERMERR;                                   0867
*                                                                  0867
@RF00865 MVC   LASTCC(2),@CH00482                                  0867
*        END MODLELSE;                                             0868
@EL00007 DS    0H                                                  0868
@EF00007 DS    0H                                                  0868
@ER00007 LM    @14,@04,@SA00007                                    0868
         LM    @06,@12,@SA00007+28                                 0868
         BR    @14                                                 0868
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - BYPASTRM                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE BYPASSES THE COMMAND-END DELIMITER THAT */
*/*             FOLLOWS A MODAL COMMAND OR INDICATES A NULL COMMAND  */
*/*             AND ALSO SCANS PAST RECORDS WHICH FOLLOW THIS RECORD */
*/*             IF CONTINUATION DELIMITERS ARE FOUND.  UPON EXIT FROM*/
*/*             BYPASTRM, THE SCAN POINTS TO THE FIRST CHARACTER OF  */
*/*             THE NEXT COMMAND VERB NAME.                          */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER FROM THE    */
*/*                    INPUT STREAM (SHOULD BE A SEMICOLON)          */
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE CURRENT RECORD IS      */
*/*                    CONTINUED ON TO THE NEXT RECORD.              */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          EOFOK -   FLAG SET 'ON' WHEN END-OF-FILE MAY CORRECTLY  */
*/*                    ENCOUNTERED ON THE COMMAND INPUT STREAM.      */
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE FIRST CHARACTER OF A   */
*/*                    NEW RECORD IS TO BE OBTAINED NEXT.            */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE IF END-OF-FILE IS FOUND WHILE SCANNING   */
*/*                    UP TO THE NEXT COMMAND'S VERB NAME.           */
*/*                                                                  */
*/********************************************************************/
*BYPASTRM:PROCEDURE;                                               0869
BYPASTRM STM   @14,@12,@SA00008                                    0869
*        /************************************************************/
*        /*                                                          */
*        /*  ** BYPASTRM **  BYPASS COMMAND-ENDING DELIMITER         */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0870
*          THEN;                                                   0870
         ICM   @02,15,GDTDBG(GDTPTR)                               0870
         BZ    @RT00870                                            0870
*          ELSE                                                    0872
*            CALL IDCDB010(GDTTBL,'RIBT');                         0872
*                                                                  0872
         ST    GDTPTR,@AL00001                                     0872
         LA    @02,@CC01050                                        0872
         ST    @02,@AL00001+4                                      0872
         MVI   @AL00001+4,X'80'                                    0872
         L     @15,GDTDBG(,GDTPTR)                                 0872
         LA    @01,@AL00001                                        0872
         BALR  @14,@15                                             0872
*        DO WHILE(MORTOCOM=YES & RISTATUS=0);                      0873
*                                                                  0873
@RT00870 B     @DE00873                                            0873
@DL00873 DS    0H                                                  0874
*          CALL NEXTCHAR;                                          0874
         BAL   @14,NEXTCHAR                                        0874
*          CALL SKIPCMD;                                           0875
*                                                                  0875
         BAL   @14,SKIPCMD                                         0875
*        END;                                                      0876
@DE00873 TM    MORTOCOM,B'00010000'                                0876
         BNO   @DC00873                                            0876
         ICM   @02,3,RISTATUS                                      0876
         BZ    @DL00873                                            0876
@DC00873 DS    0H                                                  0877
*        IF RISTATUS=0                                             0877
*          THEN                                                    0877
         ICM   @02,3,RISTATUS                                      0877
         BNZ   @RF00877                                            0877
*            DO;                                                   0878
*            EOFOK=YES;                                            0879
         OI    EOFOK,B'01000000'                                   0879
*            FIRSTCHR=YES;                                         0880
         OI    FIRSTCHR,B'00000100'                                0880
*            CHAR1=BLANK;                                          0881
*                                                                  0881
         MVI   CHAR1,C' '                                          0881
*            CALL SCANSEP(NO);                                     0882
*                                                                  0882
         LA    @01,@AL00882                                        0882
         BAL   @14,SCANSEP                                         0882
*            END;                                                  0883
*        END BYPASTRM;                                             0884
*                                                                  0884
*                                                                  0884
@EL00008 DS    0H                                                  0884
@EF00008 DS    0H                                                  0884
@ER00008 LM    @14,@12,@SA00008                                    0884
         BR    @14                                                 0884
*        END GETNEXT;                                              0885
@EL00004 DS    0H                                                  0885
@EF00004 DS    0H                                                  0885
@ER00004 LM    @14,@03,@SA00004                                    0885
         LM    @06,@12,@SA00004+24                                 0885
         BR    @14                                                 0885
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - KWDPARM                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS A KEYWORD AND THEN SEARCHES THE*/
*/*             COMMAND DESCRIPTOR FOR A MATCH.  THEN, USING THE     */
*/*             PARAMETER DESCRIPTION, THE ROUTINE SETS UP TO EXTRACT*/
*/*             THIS PARAMETER'S SUBPARAMETERS OR DATA IF EITHER     */
*/*             EXISTS.                                              */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR FUNCTION COMMAND BEING SCANNED.  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR HAS OCCURRED.             */
*/*          SUPERID - PARAMETER ID# OF PARAMETER WHOSE SUBPARAMETER */
*/*                    LIST IS CURRENTLY BEING SCANNED (ID#=0 IF     */
*/*                    FIRST-LEVEL PARM'S. ARE NOW BEING SCANNED).   */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*          SYNUNIT - CONTAINS THE KEYWORD JUST EXTRACTED           */
*/*          UNITINDX- LENGTH OF KEYWORD JUST EXTRACTED.             */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARAMETER LIST NESTING   */
*/*                    AT WHICH SCANNING IS CURRENTLY TAKING PLACE.  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */
*/*                    HAS BEEN CODED FOR A PARAMETER                */
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING WILL TAKE PLACE AFTER THIS KEYWORD.  */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */
*/*                    CURRENT SUBPARAMETER LIST.                    */
*/*          SUPERID - SEE 'INPUT'                                   */
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */
*/*                    KEYWORD.                                      */
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */
*/*                    REPEATED SUBLIST LEVEL.                       */
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */
*/*                    AT CURRENT LEVEL.                             */
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */
*/*                    KEYWORD PARAMETER                             */
*/*                                                                  */
*/********************************************************************/
*KWDPARM:PROCEDURE;                                                0886
KWDPARM  STM   @14,@04,@SA00009                                    0886
         STM   @06,@12,@SA00009+28                                 0886
*        /************************************************************/
*        /*                                                          */
*        /* KWDPARM PROCEDURE DATA DECLARATIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL SUBTOTAL FIXED(15);       /*COUNT OF SUBPARAMETERS OF 0887
*                                        CURRENT PARAMETER           */
*        DCL WORKVAR1 FIXED(15);       /*VARIABLE TO CONTAIN @YL026UL*/
*                                      /*A TEMPORARY VALUE   @YL026UL*/
*        DCL KWDMATCH BIT(1);          /*SIGNALS THAT A MATCHING   0889
*                                        KEYWORD HAS BEEN FOUND      */
*                                                                  0889
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADELIM2 FIXED(31)        /*LEFT PARENTHESIS MISSING    */
*                     CONSTANT(9);                                 0890
*        /************************************************************/
*        /*                                                          */
*        /*  ** KWDPARM **  EXTRACT A KEYWORD PARAMETER              */
*        /*                                                          */
*        /************************************************************/
*        KWDMATCH=NO;                                              0891
         NI    KWDMATCH,B'01111111'                                0891
*        JUSTONE=NO;                                               0892
         NI    JUSTONE,B'11111110'                                 0892
*        ENDPAREN=YES;                                             0893
*                                                                  0893
         OI    ENDPAREN,B'10000000'                                0893
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE KEYWORD, CHECKING THAT IT DOESN'T EXCEED     */
*        /* KEYWORD LENGTH LIMIT.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0894
*        CALL NXTFIELD(KEYWORD);                                   0894
*                                                                  0894
         LA    @01,@AL00894                                        0894
         BAL   @14,NXTFIELD                                        0894
*        IF RISTATUS=0                                             0895
*          THEN                                                    0895
*                                                                  0895
         ICM   @04,3,RISTATUS                                      0895
         BNZ   @RF00895                                            0895
*            /********************************************************/
*            /*                                                      */
*            /* SCAN KEYWORD DESCRIPTIONS IN THE COMMAND DESCRIPTOR, */
*            /* SEARCHING FOR A MATCH WITH THE EXTRACTED KEYWORD     */
*            /*                                                      */
*            /********************************************************/
*DOGRP40:    DO;                                                   0896
DOGRP40  DS    0H                                                  0897
*            IF SUPERID(PARMLVL)=0                                 0897
*              THEN                                                0897
*                                                                  0897
         LH    @04,PARMLVL                                         0897
         ALR   @04,@04                                             0897
         LH    @04,SUPERID-2(@04)                                  0897
         LTR   @04,@04                                             0897
         BNZ   @RF00897                                            0897
*                /****************************************************/
*                /*                                                  */
*                /* WHEN CURRENTLY SCANNING FIRST-LEVEL PARAMETERS,  */
*                /* CHECK DESCRIPTION OF EVERY FIRST-LEVEL PARAMETER */
*                /* FOR A KEYWORD NAME MATCH.                        */
*                /*                                                  */
*                /****************************************************/
*                DO INDEX=1 TO MAXID WHILE(KWDMATCH=NO);           0898
         LA    @04,1                                               0898
         B     @DE00898                                            0898
@DL00898 TM    KWDMATCH,B'10000000'                                0898
         BNZ   @DC00898                                            0898
*                  IF PARMPTR(INDEX)^=0                            0899
*                    THEN                                          0899
         L     @02,WORKPTR                                         0899
         LA    @15,12                                              0899
         LR    @01,@04                                             0899
         MR    @00,@15                                             0899
         AL    @01,@CF01440                                        0899
         L     @14,PARMPTR(@01,@02)                                0899
         LTR   @14,@14                                             0899
         BZ    @RF00899                                            0899
*                      DO;                                         0900
*                      PARMID=INDEX;                               0901
         STH   @04,PARMID                                          0901
*                      IF LEVEL1=YES & KWDDSPL^=0                  0902
*                        THEN                                      0902
         LR    @01,@04                                             0902
         MR    @00,@15                                             0902
         AL    @02,@CF01440                                        0902
         L     @04,PARMPTR(@01,@02)                                0902
         TM    LEVEL1(@04),B'01000000'                             0902
         BNO   @RF00902                                            0902
         CLI   KWDDSPL(@04),0                                      0902
         BE    @RF00902                                            0902
*                          DO;                                     0903
*                            KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);
         LA    @15,1                                               0904
         SLR   KWDPTR,KWDPTR                                       0904
         IC    KWDPTR,KWDDSPL(,@04)                                0904
         ALR   KWDPTR,KWDPTR                                       0904
         ALR   @04,KWDPTR                                          0904
         ALR   @04,@15                                             0904
         LR    KWDPTR,@04                                          0904
*                            DO LISTINDX=1 TO KWDCOUNT             0905
*                                      WHILE(KWDMATCH=NO);         0905
         B     @DE00905                                            0905
@DL00905 TM    KWDMATCH,B'10000000'                                0905
         BNZ   @DC00905                                            0905
*                              IF UNITINDX=KWDLEN &                0906
*                                 KWDITEM(1:KWDLEN) = SYNUNIT(1:KWDLEN)
*                                THEN                              0906
         SLR   @04,@04                                             0906
         IC    @04,KWDLEN(,KWDPTR)                                 0906
         CR    UNITINDX,@04                                        0906
         BNE   @RF00906                                            0906
         BCTR  @04,0                                               0906
         EX    @04,@SC01463                                        0906
         BNE   @RF00906                                            0906
*                                  KWDMATCH=YES;                   0907
         OI    KWDMATCH,B'10000000'                                0907
*                                ELSE                              0908
*                                  KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN);
         B     @RC00906                                            0908
@RF00906 LR    @04,KWDPTR                                          0908
         SLR   @15,@15                                             0908
         IC    @15,KWDLEN(,KWDPTR)                                 0908
         ALR   @04,@15                                             0908
         AL    @04,@CF00228                                        0908
         LR    KWDPTR,@04                                          0908
*                            END;                                  0909
@RC00906 LA    @15,1                                               0909
         AH    @15,LISTINDX                                        0909
@DE00905 STH   @15,LISTINDX                                        0909
         LH    @04,PARMID                                          0909
         MH    @04,@CH00038                                        0909
         LH    @14,PARMID                                          0909
         MH    @14,@CH00038                                        0909
         L     @01,WORKPTR                                         0909
         AL    @01,@CF01440                                        0909
         L     @14,PARMPTR(@14,@01)                                0909
         SLR   @01,@01                                             0909
         IC    @01,KWDDSPL(,@14)                                   0909
         ALR   @01,@01                                             0909
         L     @14,WORKPTR                                         0909
         AL    @14,@CF01440                                        0909
         AL    @01,PARMPTR(@04,@14)                                0909
         SLR   @04,@04                                             0909
         IC    @04,KWDCOUNT(,@01)                                  0909
         CR    @15,@04                                             0909
         BNH   @DL00905                                            0909
@DC00905 DS    0H                                                  0910
*                          END;                                    0910
*                      END;                                        0911
@RF00902 DS    0H                                                  0912
*                END;                                              0912
@RF00899 LA    @04,1                                               0912
         AH    @04,INDEX                                           0912
@DE00898 STH   @04,INDEX                                           0912
         L     @02,DESCPTR                                         0912
         CH    @04,MAXID(,@02)                                     0912
         BNH   @DL00898                                            0912
@DC00898 DS    0H                                                  0913
*              ELSE                                                0913
*                                                                  0913
*                /****************************************************/
*                /*                                                  */
*                /*  WHEN SCANNING A SUBPARAMETER LIST, CHECK FOR A  */
*                /*  KEYWORD MATCH AMONG THE POSSIBLE SUBPARAMETERS  */
*                /*  OF THE CURRENT SUPERPARAMETER.                  */
*                /*                                                  */
*                /****************************************************/
*                DO;                                               0913
         B     @RC00897                                            0913
@RF00897 DS    0H                                                  0914
*                  OLDERID2 = NEWERID2;                            0914
         L     @04,GDTTR2(,GDTPTR)                                 0914
         MVC   @TS00001(95),NEWERID2(@04)                          0914
         MVC   OLDERID2(95,@04),@TS00001                           0914
*                  NEWID2='RI09';                                  0915
         MVC   NEWID2(4,@04),@CC01060                              0915
*                  SUBTOTAL=SUBCOUNT;                              0916
         LA    @04,12                                              0916
         LR    @02,@04                                             0916
         MH    @02,PARMID                                          0916
         L     @01,WORKPTR                                         0916
         AL    @01,@CF01440                                        0916
         L     @02,PARMPTR(@02,@01)                                0916
         ALR   @04,@02                                             0916
         SLR   @15,@15                                             0916
         IC    @15,SUBDSPL(,@04)                                   0916
         ALR   @15,@15                                             0916
         ALR   @02,@15                                             0916
         MVC   SUBTOTAL(2),SUBCOUNT(@02)                           0916
*                  DO INDEX=1 TO SUBTOTAL WHILE(KWDMATCH=NO);      0917
         LA    @04,1                                               0917
         B     @DE00917                                            0917
@DL00917 TM    KWDMATCH,B'10000000'                                0917
         BNZ   @DC00917                                            0917
*                    PARMID=SUBID(INDEX);                          0918
         SLA   @04,2                                               0918
         L     @02,WORKPTR                                         0918
         LA    @15,12                                              0918
         LR    @14,@15                                             0918
         MH    @14,PARMID                                          0918
         AL    @14,@CF01440                                        0918
         L     @14,PARMPTR(@14,@02)                                0918
         LR    @01,@14                                             0918
         ALR   @01,@15                                             0918
         SLR   @00,@00                                             0918
         IC    @00,SUBDSPL(,@01)                                   0918
         ALR   @00,@00                                             0918
         ALR   @14,@00                                             0918
         LH    @04,SUBID-4(@04,@14)                                0918
         STH   @04,PARMID                                          0918
*                    IF KWDDSPL ^= 0                               0919
*                      THEN                                        0919
         LR    @01,@04                                             0919
         MR    @00,@15                                             0919
         AL    @02,@CF01440                                        0919
         L     @04,PARMPTR(@01,@02)                                0919
         CLI   KWDDSPL(@04),0                                      0919
         BE    @RF00919                                            0919
*                        DO;                                       0920
         ST    @04,@TF00001                                        0920
*                          KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT); 0921
         LA    @15,1                                               0921
         L     @01,@TF00001                                        0921
         SLR   KWDPTR,KWDPTR                                       0921
         IC    KWDPTR,KWDDSPL(,@01)                                0921
         ALR   KWDPTR,KWDPTR                                       0921
         AL    KWDPTR,@TF00001                                     0921
         LR    @14,KWDPTR                                          0921
         ALR   @14,@15                                             0921
         ST    KWDPTR,@TF00001                                     0921
         LR    KWDPTR,@14                                          0921
*                          WORKVAR1=KWDCOUNT;              /*@YL026UL*/
         L     @01,@TF00001                                        0922
         SLR   WORKVAR1,WORKVAR1                                   0922
         IC    WORKVAR1,KWDCOUNT(,@01)                             0922
*                          DO LISTINDX=1 TO WORKVAR1               0923
*                                      WHILE(KWDMATCH=NO); /*@YL026UL*/
         B     @DE00923                                            0923
@DL00923 TM    KWDMATCH,B'10000000'                                0923
         BNZ   @DC00923                                            0923
*                            IF UNITINDX=KWDLEN &                  0924
*                               KWDITEM(1:KWDLEN)=SYNUNIT(1:KWDLEN)
*                              THEN                                0924
         SLR   @15,@15                                             0924
         IC    @15,KWDLEN(,KWDPTR)                                 0924
         CR    UNITINDX,@15                                        0924
         BNE   @RF00924                                            0924
         BCTR  @15,0                                               0924
         EX    @15,@SC01463                                        0924
         BNE   @RF00924                                            0924
*                                KWDMATCH=YES;                     0925
         OI    KWDMATCH,B'10000000'                                0925
*                              ELSE                                0926
*                                KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN);
         B     @RC00924                                            0926
@RF00924 LR    @15,KWDPTR                                          0926
         SLR   @14,@14                                             0926
         IC    @14,KWDLEN(,KWDPTR)                                 0926
         ALR   @15,@14                                             0926
         AL    @15,@CF00228                                        0926
         LR    KWDPTR,@15                                          0926
*                          END;                                    0927
@RC00924 LA    @15,1                                               0927
         AH    @15,LISTINDX                                        0927
@DE00923 STH   @15,LISTINDX                                        0927
         CR    @15,WORKVAR1                                        0927
         BNH   @DL00923                                            0927
@DC00923 DS    0H                                                  0928
*                        END;                                      0928
*                    IF KWDMATCH=NO                                0929
*                      THEN                                        0929
@RF00919 TM    KWDMATCH,B'10000000'                                0929
         BNZ   @RF00929                                            0929
*                        PARMID=SUPERID(PARMLVL);                  0930
         LH    @04,PARMLVL                                         0930
         ALR   @04,@04                                             0930
         LH    @04,SUPERID-2(@04)                                  0930
         STH   @04,PARMID                                          0930
*                  END;                                            0931
@RF00929 LA    @04,1                                               0931
         AH    @04,INDEX                                           0931
@DE00917 STH   @04,INDEX                                           0931
         CH    @04,SUBTOTAL                                        0931
         BNH   @DL00917                                            0931
@DC00917 DS    0H                                                  0932
*                END;                                              0932
*                                                                  0932
*            /********************************************************/
*            /*                                                      */
*            /* IF A MATCHING KEYWORD WAS FOUND, SET A FLAG NOTING   */
*            /* THIS KEYWORD PARAMETER ID#, AND THEN USE THE KEYWORD */
*            /* DESCRIPTOR DATA TO CONTROL SCANNING OF THE REMAINDER */
*            /* OF THE PARAMETER                                     */
*            /*                                                      */
*            /********************************************************/
*            IF KWDMATCH=YES                                       0933
*              THEN                                                0933
@RC00897 TM    KWDMATCH,B'10000000'                                0933
         BNO   @RF00933                                            0933
*DOGRP45:        DO;                                               0934
*                                                                  0934
DOGRP45  DS    0H                                                  0935
*                CALL SETFLAG;                                     0935
*                                                                  0935
         BAL   @14,SETFLAG                                         0935
*                IF RISTATUS ^= 0                                  0936
*                  THEN                                            0936
         ICM   @04,3,RISTATUS                                      0936
         BNZ   @RT00936                                            0936
*                    RETURN;                                       0937
*                                                                  0937
*                /****************************************************/
*                /*                                                  */
*                /* SCAN PAST THE OPENING PARENTHESIS FOLLOWING THE  */
*                /* KEYWORD, UNLESS IT IS A 'VALUE' KEYWORD          */
*                /*                                                  */
*                /****************************************************/
*                IF SUBLIST=YES  SCLRDATA=YES                     0938
*                  THEN                                            0938
         LH    @04,PARMID                                          0938
         MH    @04,@CH00038                                        0938
         L     @02,WORKPTR                                         0938
         AL    @02,@CF01440                                        0938
         L     @04,PARMPTR(@04,@02)                                0938
         TM    SUBLIST(@04),B'10000010'                            0938
         BZ    @RF00938                                            0938
*DOGRP47:            DO;                                   /*@YL026UL*/
*                                                                  0939
DOGRP47  DS    0H                                                  0940
*                    CALL SCANSEP(NO);                             0940
*                                                                  0940
         LA    @01,@AL00940                                        0940
         BAL   @14,SCANSEP                                         0940
*                    IF CHAR1 ^= OPENING                           0941
*                      THEN                                        0941
*                                                                  0941
         CLI   CHAR1,C'('                                          0941
         BE    @RF00941                                            0941
*                        CALL ERROR2(BADELIM2,LENGTH(ERRFIELD),    0942
*                                    ADDR(ERRFIELD));              0942
*                                                                  0942
         MVC   @AL00001(8),@AL00942                                0942
         LA    @04,ERRFIELD                                        0942
         ST    @04,@AFTEMPS+4                                      0942
         LA    @04,@AFTEMPS+4                                      0942
         ST    @04,@AL00001+8                                      0942
         LA    @01,@AL00001                                        0942
         BAL   @14,ERROR2                                          0942
*                      ELSE                                        0943
*DOGRP50:                DO;                                       0943
*                                                                  0943
         B     @RC00941                                            0943
@RF00941 DS    0H                                                  0943
DOGRP50  DS    0H                                                  0944
*                        CALL NEXTCHAR;                            0944
         BAL   @14,NEXTCHAR                                        0944
*                        CALL SCANSEP(NO);                         0945
*                                                                  0945
         LA    @01,@AL00945                                        0945
         BAL   @14,SCANSEP                                         0945
*                        IF RISTATUS=0                             0946
*                          THEN                                    0946
*                                                                  0946
         ICM   @04,3,RISTATUS                                      0946
         BNZ   @RF00946                                            0946
*                            /****************************************/
*                            /*                                      */
*                            /* IF SCALAR DATA IS TO BE EXTRACTED    */
*                            /* FOLLOWING THE KEYWORD, THEN EXTRACT  */
*                            /* DATA.  IF SUBPARAMETERS FOLLOW THE   */
*                            /* KEYWORD, SET UP TO SCAN THEM         */
*                            /*                                      */
*                            /****************************************/
*                            IF SCLRDATA=YES                       0947
*                              THEN                                0947
         LH    @04,PARMID                                          0947
         MH    @04,@CH00038                                        0947
         L     @02,WORKPTR                                         0947
         AL    @02,@CF01440                                        0947
         L     @04,PARMPTR(@04,@02)                                0947
         TM    SCLRDATA(@04),B'10000000'                           0947
         BNO   @RF00947                                            0947
*                                DO;                               0948
*                                                                  0948
*                                CALL GETDATA;                     0949
*                                                                  0949
         BAL   @14,GETDATA                                         0949
*                                IF RISTATUS=0                     0950
*                                  THEN                            0950
*                                                                  0950
         ICM   @04,3,RISTATUS                                      0950
         BNZ   @RF00950                                            0950
*                                    /********************************/
*                                    /*                              */
*                                    /* IF IT EXISTS, BYPASS THE     */
*                                    /* CLOSING PAREN FOLLOWING THE  */
*                                    /* DATA.  THE PAREN IS REQUIRED */
*                                    /* EXCEPT AT COMMAND END.       */
*                                    /*                              */
*                                    /********************************/
*                                    IF CHAR1 ^= CLOSING           0951
*                                      THEN                        0951
         CLI   CHAR1,C')'                                          0951
         BE    @RF00951                                            0951
*                                        IF CHAR1=ENDDELIM         0952
*                                          THEN                    0952
         CLI   CHAR1,C';'                                          0952
         BNE   @RF00952                                            0952
*                                            ENDPAREN=NO;          0953
         NI    ENDPAREN,B'01111111'                                0953
*                                          ELSE                    0954
*                                                                  0954
*                                            CALL ERROR2(BADELIM3, 0954
*                                                    LENGTH(ERRFIELD),
*                                                    ADDR(ERRFIELD));
*                                                                  0954
         B     @RC00952                                            0954
@RF00952 MVC   @AL00001(8),@AL00954                                0954
         LA    @04,ERRFIELD                                        0954
         ST    @04,@AFTEMPS+4                                      0954
         LA    @04,@AFTEMPS+4                                      0954
         ST    @04,@AL00001+8                                      0954
         LA    @01,@AL00001                                        0954
         BAL   @14,ERROR2                                          0954
*                                      ELSE                        0955
*                                        DO;                       0955
*                                                                  0955
         B     @RC00951                                            0955
@RF00951 DS    0H                                                  0956
*                                        CALL NEXTCHAR;            0956
         BAL   @14,NEXTCHAR                                        0956
*                                        CALL SCANSEP(YES);        0957
*                                                                  0957
         LA    @01,@AL00957                                        0957
         BAL   @14,SCANSEP                                         0957
*                                        END;                      0958
*                                END;                              0959
*                                                                  0959
*                              /**************************************/
*                              /*                                    */
*                              /* THE 'VALUE' OF THIS PARAMETER IS A */
*                              /* SUBPARAMETER LIST RATHER THAN A    */
*                              /* SCALAR OR LIST OF SCALARS.         */
*                              /*                                    */
*                              /**************************************/
*                              ELSE                                0960
*DOGRP55:                        DO;                               0960
         B     @RC00947                                            0960
@RF00947 DS    0H                                                  0960
DOGRP55  DS    0H                                                  0961
*                                PARMLVL=PARMLVL+1;                0961
         LA    @04,1                                               0961
         LH    @02,PARMLVL                                         0961
         ALR   @02,@04                                             0961
         STH   @02,PARMLVL                                         0961
*                                PPARMCNT(PARMLVL)=1;              0962
         ALR   @02,@02                                             0962
         STH   @04,PPARMCNT-2(@02)                                 0962
*                                SUPERID(PARMLVL)=PARMID;          0963
         LH    @15,PARMID                                          0963
         STH   @15,SUPERID-2(@02)                                  0963
*                                SUBSYET=NO;                       0964
*                                                                  0964
         NI    SUBSYET,B'11101111'                                 0964
*                                /**********************************/
*                                /*                                */
*                                /* IF THE SUBPARAMETER LIST MAY BE*/
*                                /* REPEATED, BYPASS DELIMITER(S)  */
*                                /* AND SET INDEXES AND COUNTS TO  */
*                                /* NOTE START OF REPEATED LISTS.  */
*                                /*                                */
*                                /**********************************/
*                                IF REPEATED=YES                   0965
*                                  THEN                            0965
         MH    @15,@CH00038                                        0965
         L     @02,WORKPTR                                         0965
         AL    @02,@CF01440                                        0965
         L     @02,PARMPTR(@15,@02)                                0965
         TM    REPEATED(@02),B'00100000'                           0965
         BNO   @RF00965                                            0965
*                                    DO;                           0966
*                                    REPDEPTH=REPDEPTH+1;          0967
         AH    @04,REPDEPTH                                        0967
         STH   @04,REPDEPTH                                        0967
*                                    IF CHAR1=OPENING              0968
*                                      THEN                        0968
         CLI   CHAR1,C'('                                          0968
         BNE   @RF00968                                            0968
*                                        DO;                       0969
*                                                                  0969
*                                        CALL NEXTCHAR;            0970
         BAL   @14,NEXTCHAR                                        0970
*                                        CALL SCANSEP(NO);         0971
*                                                                  0971
         LA    @01,@AL00971                                        0971
         BAL   @14,SCANSEP                                         0971
*                                        ONEREP(REPDEPTH)=NO;      0972
         LH    @04,REPDEPTH                                        0972
         LA    @02,ONEREP-1(@04)                                   0972
         NI    0(@02),B'01111111'                                  0972
*                                        END;                      0973
*                                      ELSE                        0974
*                                        ONEREP(REPDEPTH)=YES;     0974
         B     @RC00968                                            0974
@RF00968 LH    @04,REPDEPTH                                        0974
         LA    @02,ONEREP-1(@04)                                   0974
         OI    0(@02),B'10000000'                                  0974
*                                    REPCOUNT(REPDEPTH)=1;         0975
@RC00968 LH    @15,REPDEPTH                                        0975
         LR    @14,@15                                             0975
         ALR   @14,@14                                             0975
         LA    @01,1                                               0975
         STH   @01,REPCOUNT-2(@14)                                 0975
*                                    REPLIMIT(REPDEPTH)=REPMAX;    0976
         LA    @01,12                                              0976
         LR    @00,@01                                             0976
         MH    @00,PARMID                                          0976
         L     @15,WORKPTR                                         0976
         ST    @14,@TF00001                                        0976
         LR    @14,@00                                             0976
         AL    @15,@CF01440                                        0976
         AL    @01,PARMPTR(@14,@15)                                0976
         SLR   @00,@00                                             0976
         IC    @00,REPMAX(,@01)                                    0976
         L     @01,@TF00001                                        0976
         STH   @00,REPLIMIT-2(@01)                                 0976
*                                    ARRYPTR=                      0977
*                                        FDTPTR(SUPERID(PARMLVL)); 0977
         LH    @15,PARMLVL                                         0977
         ALR   @15,@15                                             0977
         LH    @15,SUPERID-2(@15)                                  0977
         SLA   @15,2                                               0977
         L     @01,FDTADDR                                         0977
         L     ARRYPTR,FDTPTR-4(@15,@01)                           0977
*                                    HWORDARG=REPDEPTH-1;          0978
*                                                                  0978
         LH    @15,REPDEPTH                                        0978
         BCTR  @15,0                                               0978
         STH   @15,HWORDARG                                        0978
*                                    CALL DSPLCALC(HWORDARG);      0979
*                                                                  0979
         LA    @15,HWORDARG                                        0979
         ST    @15,@AL00001                                        0979
         LA    @01,@AL00001                                        0979
         BAL   @14,DSPLCALC                                        0979
*                                    REPTOTAL=1;                   0980
         LR    @15,ARRYPTR                                         0980
         ALR   @15,ARRYDSPL                                        0980
         MVC   REPTOTAL(4,@15),@CF00228                            0980
*                                    END;                          0981
*                                                                  0981
*                                END DOGRP55;                      0982
*                        END DOGRP50;                              0983
*                    END DOGRP47;                                  0984
*                                                                  0984
*                  /**************************************************/
*                  /*                                                */
*                  /* WHEN A VALUE KEYWORD IS EXTRACTED, SCAN TO     */
*                  /* THE NEXT SYNTACTIC UNIT                        */
*                  /*                                                */
*                  /**************************************************/
*                  ELSE                                            0985
*                                                                  0985
*                    CALL SCANSEP(YES);                            0985
*                                                                  0985
         B     @RC00938                                            0985
@RF00938 LA    @01,@AL00985                                        0985
         BAL   @14,SCANSEP                                         0985
*                END DOGRP45;                                      0986
*                                                                  0986
*              /******************************************************/
*              /*                                                    */
*              /* IF NO MATCHING KEYWORD WAS FOUND, IT IS AN ERROR   */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0987
*                                                                  0987
*                CALL ERROR2(BADKWD2,LENGTH(ERRFIELD),ADDR(ERRFIELD));
*                                                                  0987
         B     @RC00933                                            0987
@RF00933 MVC   @AL00001(8),@AL00987                                0987
         LA    @04,ERRFIELD                                        0987
         ST    @04,@AFTEMPS+4                                      0987
         LA    @04,@AFTEMPS+4                                      0987
         ST    @04,@AL00001+8                                      0987
         LA    @01,@AL00001                                        0987
         BAL   @14,ERROR2                                          0987
*            END DOGRP40;                                          0988
*                                                                  0988
*        END KWDPARM;                                              0989
@EL00009 DS    0H                                                  0989
@EF00009 DS    0H                                                  0989
@ER00009 LM    @14,@04,@SA00009                                    0989
         LM    @06,@12,@SA00009+28                                 0989
         BR    @14                                                 0989
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - POSPARM                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT SCALAR DATA          */
*/*             ASSOCIATED WITH THE POSITIONAL PARAMETER OR PREPARES */
*/*             TO SCAN A POSITIONAL PARAMETER'S SUBPARAMETER LIST.  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND SO FAR  */
*/*                    IN CURRENT SUBPARAMETER LIST.                 */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */
*/*          RISTATUS- R/I STATUS CODE; SET TO NON-ZERO VALUE WHEN   */
*/*                    AN ERROR IS FOUND.                            */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */
*/*                    WHICH SCANNING IS CURRENTLY TAKING PLACE.     */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */
*/*                    HAS BEEN CODED FOR A PARAMETER                */
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING WILL TAKE PLACE AFTER THIS PARAMETER */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */
*/*                    CURRENT SUBPARAMETER LIST.                    */
*/*          SUPERID - ID# OF PARAMETER WHOSE SUBPARAMETER LIST IS   */
*/*                    CURRENTLY BEING SCANNED                       */
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */
*/*                    POSITIONAL PARAMETER                          */
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */
*/*                    REPEATED SUBLIST LEVEL.                       */
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */
*/*                    AT CURRENT LEVEL.                             */
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */
*/*                    POSITIONAL PARAMETER                          */
*/*                                                                  */
*/********************************************************************/
*POSPARM:PROCEDURE;                                                0990
POSPARM  STM   @14,@04,@SA00010                                    0990
         STM   @06,@12,@SA00010+28                                 0990
*        /************************************************************/
*        /*                                                          */
*        /*  ** POSPARM **  GET POSITIONAL PARAMETER VALUE           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0991
*          THEN;                                                   0991
         ICM   @04,15,GDTDBG(GDTPTR)                               0991
         BZ    @RT00991                                            0991
*          ELSE                                                    0993
*            CALL IDCDB010(GDTTBL,'RIPP');                         0993
*                                                                  0993
         ST    GDTPTR,@AL00001                                     0993
         LA    @04,@CC01075                                        0993
         ST    @04,@AL00001+4                                      0993
         MVI   @AL00001+4,X'80'                                    0993
         L     @15,GDTDBG(,GDTPTR)                                 0993
         LA    @01,@AL00001                                        0993
         BALR  @14,@15                                             0993
*        JUSTONE=NO;                                               0994
*                                                                  0994
@RT00991 NI    JUSTONE,B'11111110'                                 0994
*        /************************************************************/
*        /*                                                          */
*        /* SET A FLAG NOTING THAT THIS PARAMETER HAS BEEN FOUND     */
*        /* AND INCREMENT COUNT OF POSITIONAL PARAMETERS.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0995
*        CALL SETFLAG;                                             0995
*                                                                  0995
         BAL   @14,SETFLAG                                         0995
*        PPARMCNT(PARMLVL)=PPARMCNT(PARMLVL)+1;                    0996
*                                                                  0996
         LH    @04,PARMLVL                                         0996
         ALR   @04,@04                                             0996
         LA    @02,1                                               0996
         AH    @02,PPARMCNT-2(@04)                                 0996
         STH   @02,PPARMCNT-2(@04)                                 0996
*        /************************************************************/
*        /*                                                          */
*        /* IF THE VALUE OF THE POSITIONAL PARAMETER IS A LIST, THEN */
*        /* EITHER EXTRACT A LIST OF SCALARS OR SET UP TO SCAN A     */
*        /* LIST OF SUBPARAMETERS.                                   */
*        /*                                                          */
*        /************************************************************/
*        IF CHAR1 = OPENING                                        0997
*          THEN                                                    0997
         CLI   CHAR1,C'('                                          0997
         BNE   @RF00997                                            0997
*DOGRP60:    DO;                                                   0998
*                                                                  0998
DOGRP60  DS    0H                                                  0999
*              CALL NEXTCHAR;                                      0999
         BAL   @14,NEXTCHAR                                        0999
*              CALL SCANSEP(NO);                                   1000
*                                                                  1000
         LA    @01,@AL01000                                        1000
         BAL   @14,SCANSEP                                         1000
*              IF RISTATUS^=0                                      1001
*                THEN                                              1001
         ICM   @04,3,RISTATUS                                      1001
         BNZ   @RT01001                                            1001
*                  RETURN;                                         1002
*                                                                  1002
*              /******************************************************/
*              /*                                                    */
*              /* EXTRACT THE LIST OF SCALAR DATA ITEMS AND          */
*              /* CHECK FOR PROPER PARENTHESES IF THE POSITIONAL     */
*              /* PARAMETER IS A SCALAR LIST.                        */
*              /*                                                    */
*              /******************************************************/
*              IF LIST=YES                                         1003
*                THEN                                              1003
         LH    @04,PARMID                                          1003
         MH    @04,@CH00038                                        1003
         L     @02,WORKPTR                                         1003
         AL    @02,@CF01440                                        1003
         L     @04,PARMPTR(@04,@02)                                1003
         TM    LIST(@04),B'00001000'                               1003
         BNO   @RF01003                                            1003
*                  DO;                                             1004
*                                                                  1004
*                  CALL GETDATA;                                   1005
*                                                                  1005
         BAL   @14,GETDATA                                         1005
*                  IF RISTATUS=0                                   1006
*                    THEN                                          1006
*                                                                  1006
         ICM   @04,3,RISTATUS                                      1006
         BNZ   @RF01006                                            1006
*                      /**********************************************/
*                      /*                                            */
*                      /* IF IT EXISTS, BYPASS THE CLOSING PAREN     */
*                      /* FOLLOWING THE DATA.  EXCEPT AT COMMAND     */
*                      /* END, THE CLOSING PAREN IN REQUIRED.        */
*                      /*                                            */
*                      /**********************************************/
*                      IF CHAR1^=CLOSING                           1007
*                        THEN                                      1007
         CLI   CHAR1,C')'                                          1007
         BE    @RF01007                                            1007
*                          IF CHAR1=ENDDELIM                       1008
*                            THEN                                  1008
         CLI   CHAR1,C';'                                          1008
         BNE   @RF01008                                            1008
*                              ENDPAREN=NO;                        1009
         NI    ENDPAREN,B'01111111'                                1009
*                            ELSE                                  1010
*                                                                  1010
*                              CALL ERROR2(BADELIM3,LENGTH(ERRFIELD),
*                                          ADDR(ERRFIELD));        1010
*                                                                  1010
         B     @RC01008                                            1010
@RF01008 MVC   @AL00001(8),@AL01010                                1010
         LA    @04,ERRFIELD                                        1010
         ST    @04,@AFTEMPS+8                                      1010
         LA    @04,@AFTEMPS+8                                      1010
         ST    @04,@AL00001+8                                      1010
         LA    @01,@AL00001                                        1010
         BAL   @14,ERROR2                                          1010
*                        ELSE                                      1011
*                          DO;                                     1011
*                                                                  1011
         B     @RC01007                                            1011
@RF01007 DS    0H                                                  1012
*                          CALL NEXTCHAR;                          1012
         BAL   @14,NEXTCHAR                                        1012
*                          CALL SCANSEP(YES);                      1013
*                                                                  1013
         LA    @01,@AL01013                                        1013
         BAL   @14,SCANSEP                                         1013
*                          END;                                    1014
*                  END;                                            1015
*                ELSE                                              1016
*                                                                  1016
*                  CALL ERROR2(BADELIM5,LENGTH(ERRFIELD),          1016
*                              ADDR(ERRFIELD));            /*@YL026UL*/
*                                                                  1016
         B     @RC01003                                            1016
@RF01003 MVC   @AL00001(8),@AL01016                                1016
         LA    @04,ERRFIELD                                        1016
         ST    @04,@AFTEMPS+8                                      1016
         LA    @04,@AFTEMPS+8                                      1016
         ST    @04,@AL00001+8                                      1016
         LA    @01,@AL00001                                        1016
         BAL   @14,ERROR2                                          1016
*            END DOGRP60;                                          1017
*          ELSE                                                    1018
*                                                                  1018
*            /********************************************************/
*            /*                                                      */
*            /* IF THERE IS NO LEFT PARENTHESIS TO DELIMIT A SCALAR  */
*            /* LIST, THEN THE LIST MUST BE JUST ONE SCALAR LONG.    */
*            /* AN EXCEPTION IS WHEN A LIST OF LISTS IS INVOLVED, IN */
*            /* WHICH CASE THE PARENTHESES FOR THE REPEATED LISTS    */
*            /* MAY SERVE TO DELIMIT THE SCALAR LISTS.               */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1018
         B     @RC00997                                            1018
@RF00997 DS    0H                                                  1019
*            IF LIST=YES                                           1019
*              THEN                                                1019
         L     @04,WORKPTR                                         1019
         LH    @02,PARMID                                          1019
         LA    @15,12                                              1019
         LR    @01,@02                                             1019
         MR    @00,@15                                             1019
         LA    @14,0(@01,@04)                                      1019
         AL    @14,@CF01440                                        1019
         L     @14,PARMPTR(,@14)                                   1019
         TM    LIST(@14),B'00001000'                               1019
         BNO   @RF01019                                            1019
*                DO;                                               1020
*                TESTID=PARMID;                                    1021
         LR    TESTID,@02                                          1021
*                PARMID=SUPRPARM(PARMID);                          1022
         L     @02,WORKPTR                                         1022
         AL    @01,@CF01441                                        1022
         LH    @14,SUPRPARM-8(@01,@02)                             1022
         STH   @14,PARMID                                          1022
*                IF PARMID^=0 & REPEATED=YES & SUBCOUNT=1          1023
*                  THEN;                                           1023
         LTR   @14,@14                                             1023
         BZ    @RF01023                                            1023
         LR    @01,@14                                             1023
         MR    @00,@15                                             1023
         AL    @02,@CF01440                                        1023
         L     @02,PARMPTR(@01,@02)                                1023
         TM    REPEATED(@02),B'00100000'                           1023
         BNO   @RF01023                                            1023
         ALR   @15,@02                                             1023
         SLR   @14,@14                                             1023
         IC    @14,SUBDSPL(,@15)                                   1023
         ALR   @14,@14                                             1023
         ALR   @02,@14                                             1023
         CLC   SUBCOUNT(2,@02),@CH00228                            1023
         BE    @RT01023                                            1023
*                  ELSE                                            1025
*                    JUSTONE=YES;                                  1025
@RF01023 OI    JUSTONE,B'00000001'                                 1025
*                PARMID=TESTID;                                    1026
@RT01023 STH   TESTID,PARMID                                       1026
*                END;                                              1027
*                                                                  1027
*            CALL GETDATA;                                         1028
*                                                                  1028
@RF01019 BAL   @14,GETDATA                                         1028
*            END;                                                  1029
*                                                                  1029
*        END POSPARM;                                              1030
*                                                                  1030
*                                                                  1030
@EL00010 DS    0H                                                  1030
@EF00010 DS    0H                                                  1030
@ER00010 LM    @14,@04,@SA00010                                    1030
         LM    @06,@12,@SA00010+28                                 1030
         BR    @14                                                 1030
*        END SCANCMD;                                      /*@YL026UL*/
@EL00003 DS    0H                                                  1031
@EF00003 DS    0H                                                  1031
@ER00003 LM    @14,@03,@SA00003                                    1031
         LM    @06,@12,@SA00003+24                                 1031
         BR    @14                                                 1031
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETDATA                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT THE SCALAR VALUE OR  */
*/*             VALUES ASSOCIATED WITH A PARAMETER.                  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */
*/*          CHAR2 -   CHARACTER WHICH IS TO BE EXTRACTED NEXT       */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */
*/*          PWORD -   SWITCH SET TO INDICATE WHETHER A PASSWORD     */
*/*                    SCALAR IS CURRENTLY BEING EXTRACTED, IS NOT   */
*/*                    BEING EXTRACTED, OR WILL BE EXTRACTED NEXT.   */
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT COMMAND IS BEING   */
*/*                    SCANNED FOR SYNTAX CHECKING ONLY.             */
*/*          JUSTONE - FLAG SET 'ON' WHEN NO PARENTHESES HAVE BEEN   */
*/*                    CODED TO DELIMIT A SCALAR LIST SINCE ONLY ONE */
*/*                    LIST ELEMENT EXISTS.                          */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE DATA ENTRIES                        */
*/*          SCLRCNT - COUNT OF SCALARS FOUND IN A SCALAR LIST       */
*/*          PWORD -   SEE 'INPUT'                                   */
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD ITEM MAY FOLLOW */
*/*                    THE PRIMARY SCALAR VALUE                      */
*/*          ORGSIGN - CONTAINS A CHARACTER CODE INDICATING THE FORM */
*/*                    IN WHICH A CONSTANT WAS SPECIFIED             */
*/*                                                                  */
*/********************************************************************/
*GETDATA:PROCEDURE;                                                1032
GETDATA  STM   @14,@04,@SA00011                                    1032
         STM   @06,@12,@SA00011+28                                 1032
*        /************************************************************/
*        /*                                                          */
*        /* GETDATA PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL ENDVALUE BIT(1);          /*SIGNALS THAT ALL THE SCALAR
*                                        DATA HAS BEEN EXTRACTED     */
*                                                                  1033
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADNUM   FIXED(31)        /*IMPROPER NUMERICAL VALUE    */
*                     CONSTANT(15);                                1034
*        DCL BADPWD   FIXED(31)        /*PASSWORD APPEARS IMPROPERLY */
*                     CONSTANT(18);                                1035
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETDATA **  EXTRACT SCALAR VALUE OR VALUES           */
*        /*                                                          */
*        /************************************************************/
*        SCLRCNT=0;                                                1036
         SLR   @04,@04                                             1036
         STH   @04,SCLRCNT                                         1036
*        PWORD=NONE;                                               1037
         SLR   PWORD,PWORD                                         1037
*        ENDVALUE=NO;                                              1038
         NI    ENDVALUE,B'01111111'                                1038
*        PWORDSW=OFF;                                              1039
         NI    PWORDSW,B'01111111'                                 1039
*        OLDERID2 = NEWERID2;                                      1040
         L     @04,GDTTR2(,GDTPTR)                                 1040
         MVC   @TS00001(95),NEWERID2(@04)                          1040
         MVC   OLDERID2(95,@04),@TS00001                           1040
*        NEWID2='RI11';                                            1041
*                                                                  1041
         MVC   NEWID2(4,@04),@CC01084                              1041
*        /************************************************************/
*        /*                                                          */
*        /*  EXTRACT DATA UNTIL THE ENTIRE SCALAR OR LIST OF         */
*        /*  SCALARS HAS BEEN PICKED UP                              */
*        /*                                                          */
*        /************************************************************/
*        DO WHILE(ENDVALUE=NO );                                   1042
*                                                                  1042
         B     @DE01042                                            1042
@DL01042 DS    0H                                                  1043
*          /**********************************************************/
*          /*                                                @YL026UL*/
*          /* NOTE WHETHER OR NOT A PASSWORD IS ALLOWED WITH @YL026UL*/
*          /* THE CURRENT PARAMETER.  THEN USE THE PARAMETER @YL026UL*/
*          /* DATA FORMAT TO EXTRACT THE CONSTANT.           @YL026UL*/
*          /*                                                @YL026UL*/
*          /**********************************************************/
*          IF PWORDOPT=YES & PWORD=NONE                            1043
*            THEN                                                  1043
         LA    @04,12                                              1043
         LR    @15,@04                                             1043
         MH    @15,PARMID                                          1043
         L     @01,WORKPTR                                         1043
         AL    @01,@CF01440                                        1043
         AL    @04,PARMPTR(@15,@01)                                1043
         TM    PWORDOPT(@04),B'00000010'                           1043
         BNO   @RF01043                                            1043
         LTR   PWORD,PWORD                                         1043
         BNZ   @RF01043                                            1043
*              PWORDSW=ON;                                 /*@YL026UL*/
         OI    PWORDSW,B'10000000'                                 1044
*            ELSE                                                  1045
*              PWORDSW=OFF;                                /*@YL026UL*/
*                                                                  1045
         B     @RC01043                                            1045
@RF01043 NI    PWORDSW,B'01111111'                                 1045
*          ORGSIGN=BLANK;                                          1046
@RC01043 MVI   ORGSIGN,C' '                                        1046
*          IF NUMBER=YES                                          1047
*             (ANYSTRNG=YES & (CHAR1=HEXSIGN  CHAR1=BINSIGN) &    1047
*              CHAR2=QUOTE & PWORD^=NEXT)                  /*@YL026UL*/
*                                                                  1047
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT A NUMBER IN DECIMAL FORM OR EXTRACT A NUMBER */
*            /* OR STRING WHICH IS SPECIFIED IN BINARY OR HEX FORM.  */
*            /*                                                      */
*            /********************************************************/
*            THEN                                                  1047
         LA    @04,12                                              1047
         LR    @15,@04                                             1047
         MH    @15,PARMID                                          1047
         L     @01,WORKPTR                                         1047
         AL    @01,@CF01440                                        1047
         AL    @04,PARMPTR(@15,@01)                                1047
         TM    NUMBER(@04),B'10000000'                             1047
         BO    @RT01047                                            1047
         TM    ANYSTRNG(@04),B'01000000'                           1047
         BNO   @RF01047                                            1047
         CLI   CHAR1,C'X'                                          1047
         BE    @GL00045                                            1047
         CLI   CHAR1,C'B'                                          1047
         BNE   @RF01047                                            1047
@GL00045 CLI   CHAR2,C''''                                         1047
         BNE   @RF01047                                            1047
         CH    PWORD,@CH00228                                      1047
         BE    @RF01047                                            1047
@RT01047 DS    0H                                                  1048
*              IF CHAR1=HEXSIGN  CHAR1=BINSIGN                    1048
*                THEN                                              1048
         CLI   CHAR1,C'X'                                          1048
         BE    @RT01048                                            1048
         CLI   CHAR1,C'B'                                          1048
         BNE   @RF01048                                            1048
@RT01048 DS    0H                                                  1049
*                  DO;                                             1049
*                  ORGSIGN=CHAR1;                                  1050
*                                                                  1050
         MVC   ORGSIGN(1),CHAR1                                    1050
*                  CALL NEXTCHAR;                                  1051
*                                                                  1051
         BAL   @14,NEXTCHAR                                        1051
*                  IF RISTATUS=0                                   1052
*                    THEN                                          1052
         ICM   @04,3,RISTATUS                                      1052
         BNZ   @RF01052                                            1052
*                      IF CHAR1=QUOTE                              1053
*                        THEN                                      1053
*                                                                  1053
         CLI   CHAR1,C''''                                         1053
         BNE   @RF01053                                            1053
*                          CALL GETQUOTD;                          1054
*                                                                  1054
         BAL   @14,GETQUOTD                                        1054
*                        ELSE                                      1055
*                                                                  1055
*                          CALL ERROR1(BADNUM);                    1055
*                                                                  1055
         B     @RC01053                                            1055
@RF01053 LA    @01,@AL01055                                        1055
         BAL   @14,ERROR1                                          1055
*                  END;                                            1056
*                ELSE                                              1057
*                                                                  1057
*                  CALL GETSIMPL;                                  1057
*                                                                  1057
         B     @RC01048                                            1057
@RF01048 BAL   @14,GETSIMPL                                        1057
*            /********************************************************/
*            /*                                                      */
*            /*  WHEN THE CONSTANT IS NOT A NUMBER, A HEX    @YL026UL*/
*            /*  STRING, OR A BIT STRING, EXTRACT IT AS A    @YL026UL*/
*            /*  CHARACTER STRING, CHECKING TO SEE IF IT IS WITHIN   */
*            /*  APOSTROPHES.  ALSO CHECK TO SEE IF THE SCALAR IS    */
*            /*  A PASSWORD.                                         */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  1058
*              DO;                                                 1058
         B     @RC01047                                            1058
@RF01047 DS    0H                                                  1059
*              OLDERID2 = NEWERID2;                                1059
         L     @15,GDTTR2(,GDTPTR)                                 1059
         MVC   @TS00001(95),NEWERID2(@15)                          1059
         MVC   OLDERID2(95,@15),@TS00001                           1059
*              NEWID2='RI12';                                      1060
         MVC   NEWID2(4,@15),@CC01087                              1060
*              IF PWORD=NEXT                                       1061
*                THEN                                              1061
         CH    PWORD,@CH00228                                      1061
         BNE   @RF01061                                            1061
*                  PWORD=NOW;                                      1062
         LA    PWORD,3                                             1062
*              IF CHAR1=QUOTE                                      1063
*                THEN                                              1063
*                                                                  1063
@RF01061 CLI   CHAR1,C''''                                         1063
         BNE   @RF01063                                            1063
*                  CALL GETQUOTD;                                  1064
*                                                                  1064
         BAL   @14,GETQUOTD                                        1064
*                ELSE                                              1065
*                                                                  1065
*                  CALL GETSIMPL;                                  1065
*                                                                  1065
         B     @RC01063                                            1065
@RF01063 BAL   @14,GETSIMPL                                        1065
*              END;                                                1066
*                                                                  1066
@RC01063 DS    0H                                                  1067
*          /**********************************************************/
*          /*                                                        */
*          /*  ADD THE EXTRACTED SCALAR TO THE FDT AND CHECK TO SEE  */
*          /*  IF THE SCALAR VALUE OR VALUES HAVE BEEN COMPLETELY    */
*          /*  EXTRACTED.                                            */
*          /*                                                        */
*          /**********************************************************/
*          IF RISTATUS=0 & SCANONLY=NO                             1067
*            THEN                                                  1067
*                                                                  1067
@RC01047 ICM   @04,3,RISTATUS                                      1067
         BNZ   @RF01067                                            1067
         TM    SCANONLY,B'00010000'                                1067
         BNZ   @RF01067                                            1067
*              CALL BUILDFDT;                                      1068
         BAL   @14,BUILDFDT                                        1068
*            ELSE                                                  1069
*              IF PWORD=NOW                                        1069
*                THEN                                              1069
         B     @RC01067                                            1069
@RF01067 CH    PWORD,@CH00172                                      1069
         BNE   @RF01069                                            1069
*                  PWORD=NONE;                                     1070
*                                                                  1070
         SLR   PWORD,PWORD                                         1070
*          IF (SCALAR=YES & PWORD=NONE)  (JUSTONE=YES & PWORD=NONE) 
*             CHAR1=CLOSING  CHAR1=ENDDELIM  RISTATUS ^= 0       1071
*            THEN                                                  1071
@RF01069 DS    0H                                                  1071
@RC01067 LH    @04,PARMID                                          1071
         MH    @04,@CH00038                                        1071
         L     @01,WORKPTR                                         1071
         AL    @01,@CF01440                                        1071
         L     @04,PARMPTR(@04,@01)                                1071
         TM    SCALAR(@04),B'00010000'                             1071
         BNO   @GL00053                                            1071
         LTR   PWORD,PWORD                                         1071
         BZ    @RT01071                                            1071
@GL00053 TM    JUSTONE,B'00000001'                                 1071
         BNO   @GL00052                                            1071
         LTR   PWORD,PWORD                                         1071
         BZ    @RT01071                                            1071
@GL00052 CLI   CHAR1,C')'                                          1071
         BE    @RT01071                                            1071
         CLI   CHAR1,C';'                                          1071
         BE    @RT01071                                            1071
         ICM   @04,3,RISTATUS                                      1071
         BZ    @RF01071                                            1071
@RT01071 DS    0H                                                  1072
*              ENDVALUE=YES;                                       1072
         OI    ENDVALUE,B'10000000'                                1072
*        END;                                                      1073
@RF01071 DS    0H                                                  1073
@DE01042 TM    ENDVALUE,B'10000000'                                1073
         BZ    @DL01042                                            1073
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME -  GETSIMPL                                      */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR NOT ENCLOSED WITHIN   */
*/*             APOSTROPHES AND CHECKS TO SEE IF A PASSWORD ITEM     */
*/*             FOLLOWS THE PRIMARY SCALAR.                          */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS TO BE */
*/*                    EXTRACTED NEXT, NOW, OR NOT AT ALL            */
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */
*/*                    LEGITIMATELY                                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          EXTRACTED SCALAR ITEM.                                  */
*/*          PWORD -   SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*GETSIMPL:PROCEDURE;                                               1074
         B     @PB00012                                            1074
GETSIMPL STM   @14,@01,@SA00012                                    1074
         STM   @03,@04,@SA00012+16                                 1074
         STM   @06,@12,@SA00012+24                                 1074
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETSIMPL **  EXTRACT AN UNQUOTED SCALAR              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1075
*        /************************************************************/
*        /*                                                          */
*        /* PICK UP THE UNQUOTED SCALAR                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1075
*        CALL NXTFIELD(SIMPSCLR);                                  1075
         LA    @01,@AL01075                                        1075
         BAL   @14,NXTFIELD                                        1075
*        CALL SCANSEP(YES);                                        1076
*                                                                  1076
         LA    @01,@AL01076                                        1076
         BAL   @14,SCANSEP                                         1076
*        IF RISTATUS=0                                             1077
*          THEN                                                    1077
         ICM   @04,3,RISTATUS                                      1077
         BNZ   @RF01077                                            1077
*            IF CHAR1=PWDDELIM                                     1078
*                                                                  1078
*              /******************************************************/
*              /*                                                    */
*              /*  WHEN THE ENDING DELIMITER OF THE SCALAR IS THE    */
*              /*  DELIMITER INDICATING A FOLLOWING PASSWORD, NOTE   */
*              /*  THAT THE PASSWORD IS TO BE EXTRACTED LATER.  ALSO */
*              /*  CHECK TO SEE IF THE OCCURRENCE OR LACK OF         */
*              /*  OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.   */
*              /*                                                    */
*              /******************************************************/
*              THEN                                                1078
         CLI   CHAR1,C'/'                                          1078
         BNE   @RF01078                                            1078
*                IF PWORDSW=ON                                     1079
*                  THEN                                            1079
         TM    PWORDSW,B'10000000'                                 1079
         BNO   @RF01079                                            1079
*                    DO;                                           1080
*                                                                  1080
*                    CALL NEXTCHAR;                                1081
         BAL   @14,NEXTCHAR                                        1081
*                    CALL SCANSEP(YES);                            1082
*                                                                  1082
         LA    @01,@AL01082                                        1082
         BAL   @14,SCANSEP                                         1082
*                    PWORD=NEXT;                                   1083
         LA    PWORD,1                                             1083
*                    END;                                          1084
*                  ELSE                                            1085
*                                                                  1085
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1085
*                                ADDR(ERRFIELD));                  1085
*                                                                  1085
         B     @RC01079                                            1085
@RF01079 MVC   @AL00001(8),@AL01085                                1085
         LA    @04,ERRFIELD                                        1085
         ST    @04,@AFTEMPS+16                                     1085
         LA    @04,@AFTEMPS+16                                     1085
         ST    @04,@AL00001+8                                      1085
         LA    @01,@AL00001                                        1085
         BAL   @14,ERROR2                                          1085
*        END GETSIMPL;                                             1086
@EL00012 DS    0H                                                  1086
@EF00012 DS    0H                                                  1086
@ER00012 LM    @14,@01,@SA00012                                    1086
         LM    @03,@04,@SA00012+16                                 1086
         LM    @06,@12,@SA00012+24                                 1086
         BR    @14                                                 1086
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETQUOTD                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR THAT IS WITHIN        */
*/*             APOSTROPHES AND CHECKS FOR A FOLLOWING PASSWORD.     */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */
*/*                    LEGITIMATELY                                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          EXTRACTED SCALAR ITEM.                                  */
*/*          PWORD -   SWITCH INDICATING WHEN A PASSWORD IS TO BE    */
*/*                    EXTRACTED NEXT                                */
*/*                                                                  */
*/********************************************************************/
*GETQUOTD:PROCEDURE;                                               1087
GETQUOTD STM   @14,@01,@SA00013                                    1087
         STM   @03,@04,@SA00013+16                                 1087
         STM   @06,@12,@SA00013+24                                 1087
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETQUOTD **  EXTRACT SCALAR WITHIN APOSTROPHES       */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1088
*          THEN;                                                   1088
         ICM   @15,15,GDTDBG(GDTPTR)                               1088
         BZ    @RT01088                                            1088
*          ELSE                                                    1090
*            CALL IDCDB010(GDTTBL,'RIGQ');                         1090
*                                                                  1090
         ST    GDTPTR,@AL00001                                     1090
         LA    @15,@CC01095                                        1090
         ST    @15,@AL00001+4                                      1090
         MVI   @AL00001+4,X'80'                                    1090
         L     @15,GDTDBG(,GDTPTR)                                 1090
         LA    @01,@AL00001                                        1090
         BALR  @14,@15                                             1090
*        /************************************************************/
*        /*                                                          */
*        /* BYPASS THE LEADING APOSTROPHE AND EXTRACT THE SCALAR     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1091
*        CALL NEXTCHAR;                                            1091
@RT01088 BAL   @14,NEXTCHAR                                        1091
*        CALL NXTFIELD(QUOTSCLR);                                  1092
         LA    @01,@AL01092                                        1092
         BAL   @14,NXTFIELD                                        1092
*        CALL SCANSEP(YES);                                        1093
*                                                                  1093
         LA    @01,@AL01093                                        1093
         BAL   @14,SCANSEP                                         1093
*        IF RISTATUS=0                                             1094
*          THEN                                                    1094
*                                                                  1094
         ICM   @04,3,RISTATUS                                      1094
         BNZ   @RF01094                                            1094
*            /********************************************************/
*            /*                                                      */
*            /* WHEN A DELIMITER INDICATING A FOLLOWING PASSWORD IS  */
*            /* FOUND, NOTE THAT THE PASSWORD IS TO BE EXTRACTED     */
*            /* LATER.  ALSO CHECK WHETHER THE OCCURRENCE OR LACK OF */
*            /* OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.      */
*            /*                                                      */
*            /********************************************************/
*            IF CHAR1=PWDDELIM                                     1095
*              THEN                                                1095
         CLI   CHAR1,C'/'                                          1095
         BNE   @RF01095                                            1095
*                IF PWORDSW=ON                                     1096
*                  THEN                                            1096
         TM    PWORDSW,B'10000000'                                 1096
         BNO   @RF01096                                            1096
*                    DO;                                           1097
*                                                                  1097
*                    CALL NEXTCHAR;                                1098
         BAL   @14,NEXTCHAR                                        1098
*                    CALL SCANSEP(YES);                            1099
*                                                                  1099
         LA    @01,@AL01099                                        1099
         BAL   @14,SCANSEP                                         1099
*                    PWORD=NEXT;                                   1100
         LA    PWORD,1                                             1100
*                    END;                                          1101
*                  ELSE                                            1102
*                                                                  1102
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1102
*                                ADDR(ERRFIELD));                  1102
*                                                                  1102
         B     @RC01096                                            1102
@RF01096 MVC   @AL00001(8),@AL01102                                1102
         LA    @04,ERRFIELD                                        1102
         ST    @04,@AFTEMPS+20                                     1102
         LA    @04,@AFTEMPS+20                                     1102
         ST    @04,@AL00001+8                                      1102
         LA    @01,@AL00001                                        1102
         BAL   @14,ERROR2                                          1102
*        END GETQUOTD;                                             1103
*                                                                  1103
*                                                                  1103
@EL00013 DS    0H                                                  1103
@EF00013 DS    0H                                                  1103
@ER00013 LM    @14,@01,@SA00013                                    1103
         LM    @03,@04,@SA00013+16                                 1103
         LM    @06,@12,@SA00013+24                                 1103
         BR    @14                                                 1103
*        END GETDATA;                                              1104
@EL00011 DS    0H                                                  1104
@EF00011 DS    0H                                                  1104
@ER00011 LM    @14,@04,@SA00011                                    1104
         LM    @06,@12,@SA00011+28                                 1104
         BR    @14                                                 1104
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - BUILDFDT                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE PLACES EXTRACTED SCALARS INTO THE       */
*/*             FUNCTION DATA TABLE (FDT), AFTER CONVERTING THEM IF  */
*/*             NECESSARY.  THE ROUTINE IS PERFORMED ONCE FOR EACH   */
*/*             SCALAR.  SPACE IS OBTAINED AS NECESSARY IN ORDER TO  */
*/*             STORE THE SCALARS.  SEMANTIC CHECKING IS PERFORMED   */
*/*             ON THE SCALAR ITEMS USING THE COMMAND DESCRIPTOR.    */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS NOW   */
*/*                    BEING PLACED INTO THE FDT.                    */
*/*          SYNUNIT - CONTAINS SCALAR ITEM TO BE PLACED INTO THE FDT*/
*/*          UNITINDX- LENGTH OF SCALAR TO BE PLACED INTO THE FDT    */
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */
*/*                    SCALAR WAS INPUT (HEX OR BINARY CONSTANT OR   */
*/*                    NEITHER)                                      */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR IS DETECTED               */
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED UP UNTIL*/
*/*                    NOW                                           */
*/*          DATAPTR - POINTER TO SCALAR DATA STRUCTURE FOR CURRENT  */
*/*                    PARAMETER                                     */
*/*          SPACELFT- SPACE REMAINING FROM THAT ALLOCATED FOR A     */
*/*                    SCALAR LIST DATA STRUCTURE                    */
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH SCALAR ITEM */
*/*                    IN THE SCALAR LIST DATA STRUCTURE             */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE (FDT) DATA ENTRIES                  */
*/*          PWORD -   SEE 'INPUT'                                   */
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED         */
*/*          SPACELFT- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*BUILDFDT:PROCEDURE;                                               1105
BUILDFDT STM   @14,@01,@SA00014                                    1105
         STM   @03,@04,@SA00014+16                                 1105
         STM   @06,@12,@SA00014+24                                 1105
*        /************************************************************/
*        /*                                                          */
*        /* BUILDFDT PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1106
*        /*FULLWORD BINARY CONSTANT DATA FORM                @YL026UL*/
*                                                                  1106
*        DCL FULLWORD FIXED(31) BASED(DATAPTR);                    1106
*                                                                  1106
*        /*STRING CONSTANT DATA FORM                         @YL026UL*/
*                                                                  1107
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1107
*              2 STRINGLN FIXED(8),    /*LENGTH OF STRING    @YL026UL*/
*              2 STRING   CHAR(*);     /*THE STRING ITEM ITSELF      */
*                                                                  1107
*        /*CHARACTER STRING (W/ PASSWORD) CONSTANT DATA FORM @YL026UL*/
*                                                                  1108
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1108
*              2 PASSWDLN FIXED(8),    /*LENGTH OF PASSWORD  @YL026UL*/
*              2 PASSWORD CHAR(8),     /*THE PASSWORD ITSELF         */
*              2 CHARLN   FIXED(8),    /*CHAR. STRING LENGTH @YL026UL*/
*              2 CHARS    CHAR(*);     /*THE CHARACTER STRING ITSELF */
*                                                                  1108
*        /*DATA SET NAME CONSTANT DATA FORM                  @YL026UL*/
*                                                                  1109
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1109
*              2 DSPWDLN  FIXED(8),    /*LENGTH OF PASSWORD  @YL026UL*/
*              2 DSPWORD  CHAR(8),     /*PASSWORD                    */
*              2 STARPOS  FIXED(8),    /*ASTERISK POSITION   @YL026UL*/
*                                      /* IN GENERIC DSNAME  @YL026UL*/
*              2 UNQTFLG  BIT(1),      /*SET 'ON' IF DSNAME  @YL026UL*/
*                                      /* WAS INPUT WITHIN   @YL026UL*/
*                                      /* QUOTES IN THE TSO  @YL026UL*/
*                                      /* ENVIRONMENT        @YL026UL*/
*              2 MEMNAMLN FIXED(8),    /*MEMBER NAME LENGTH  @YL026UL*/
*              2 MEMNAME  CHAR(8),     /*MEMBER NAME                 */
*              2 DSNAMELN FIXED(8),    /*LENGTH OF MAIN PART @YL026UL*/
*                                      /* OF THE DSNAME      @YL026UL*/
*              2 DSNAME   CHAR(44);    /*MAIN PART OF DATA SET NAME  */
*                                                                  1109
*        /*BINARY FULLWORD CONSTANT LIST DATA FORM           @YL026UL*/
*                                                                  1110
*        DCL 1 * BASED(DATAPTR) BDY(WORD),                         1110
*              2 FULLWDCT FIXED(31),   /*NO. OF FULLWORDS IN THE LIST*/
*              2 LFULLWD(*) FIXED(31); /*LIST OF FULLWORDS   @YL026UL*/
*                                                                  1110
*        /*STRING CONSTANT LIST DATA FORM                    @YL026UL*/
*                                                                  1111
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1111
*              2 STRINGCT FIXED(15),   /*# OF STRINGS LISTED @YL026UL*/
*              2 LSTRINGL FIXED(8),    /*LENGTH OF STRING    @YL026UL*/
*              2 LSTRING  CHAR(*);     /*SCALAR ITEM                 */
*                                                                  1111
*        /*STRING (W/ PASSWORD) CONSTANT LIST DATA FORM      @YL026UL*/
*                                                                  1112
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1112
*              2 CHARCT   FIXED(15),   /*# OF STRING SCALARS IN LIST */
*              2 LCHRPWDL FIXED(8),    /*LENGTH OF PASSWORD  @YL026UL*/
*              2 LCHRPWD  CHAR(8),     /*PASSWORD AT END OF STRING   */
*              2 LCHARLN  FIXED(8),    /*LENGTH OF STRING    @YL026UL*/
*              2 LCHAR    CHAR(*);     /*CHARACTER STRING ITEM       */
*                                                                  1112
*        /*DATA SET NAME CONSTANT LIST DATA FORM             @YL026UL*/
*                                                                  1113
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1113
*              2 DSNAMECT FIXED(15),   /*# OF DSNAMES IN LIST        */
*              2 * (*) BDY(HWORD),     /*ARRAY (LIST) OF DATA        */
*                3 LDSNPWDL FIXED(8),  /*PASSWORD LENGTH     @YL026UL*/
*                3 LDSNPWD  CHAR(8),   /*PASSWORD AT END OF STRING   */
*                3 LSTARPOS FIXED(8),  /*ASTERISK POSITION   @YL026UL*/
*                                      /* IN GENERIC DSNAME  @YL026UL*/
*                3 LUNQTFLG BIT(1),    /*SET 'ON' IF DSNAME  @YL026UL*/
*                                      /* WAS INPUT WITHIN   @YL026UL*/
*                                      /* QUOTES IN THE TSO  @YL026UL*/
*                                      /* ENVIRONMENT        @YL026UL*/
*                3 LMEMNAML FIXED(8),  /*MEMBER NAME LENGTH  @YL026UL*/
*                3 LMEMNAME CHAR(8),   /*MEMBER NAME (IF ANY)        */
*                3 LDSNAMEL FIXED(8),  /*LENGTH OF DSNAME    @YL026UL*/
*                3 LDSNAME  CHAR(44);  /*MAIN PART OF DATA SET NAME  */
*                                                                  1113
*        /*STATIC ERROR MESSAGE CODES                                */
*                                                                  1114
*        DCL BADLIST  FIXED(31)        /*TOO MANY SCALARS IN LIST    */
*                     CONSTANT(24);                                1114
*                                                                  1114
*        /*OTHER VARIABLES                                           */
*                                                                  1115
*        DCL ELTPTR   PTR(31);         /*PTR TO FDT STORAGE AREA FOR
*                                        SCALAR LIST ELEMENT         */
*        DCL DATALEN  FIXED(15);       /*AMOUNT OF EXTRACTED DATA TO
*                                        MOVE INTO AN FDT SLOT       */
*        DCL CHSTRING BIT(1);          /*SET 'ON' IF INPUT   @YL026UL*/
*                                      /* CONSTANT IS NOT A  @YL026UL*/
*                                      /* DECIMAL, HEX, OR   @YL026UL*/
*                                      /* BINARY CONSTANT    @YL026UL*/
*        /************************************************************/
*        /*                                                          */
*        /*  ** BUILDFDT **  PLACE SCALAR INTO FUNCTION DATA TABLE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1118
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* DETERMINE THE BASIC FORMAT OF THE CONSTANT.      @YL026UL*/
*        /* CONSTANTS ALLOWING PASSWORDS CANNOT BE CODED     @YL026UL*/
*        /* IN HEXADECIMAL FORMAT.                           @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF ANYSTRNG=YES                                           1118
*          THEN                                                    1118
         LA    @04,12                                              1118
         LR    @15,@04                                             1118
         MH    @15,PARMID                                          1118
         L     @01,WORKPTR                                         1118
         AL    @01,@CF01440                                        1118
         AL    @04,PARMPTR(@15,@01)                                1118
         TM    ANYSTRNG(@04),B'01000000'                           1118
         BNO   @RF01118                                            1118
*            IF ORGSIGN=BLANK                                      1119
*              THEN                                                1119
         CLI   ORGSIGN,C' '                                        1119
         BNE   @RF01119                                            1119
*                CHSTRING=YES;                             /*@YL026UL*/
         OI    CHSTRING,B'10000000'                                1120
*              ELSE                                                1121
*                IF PWORDOPT=YES                                   1121
*                  THEN                                            1121
         B     @RC01119                                            1121
@RF01119 LA    @04,12                                              1121
         LR    @15,@04                                             1121
         MH    @15,PARMID                                          1121
         L     @01,WORKPTR                                         1121
         AL    @01,@CF01440                                        1121
         AL    @04,PARMPTR(@15,@01)                                1121
         TM    PWORDOPT(@04),B'00000010'                           1121
         BNO   @RF01121                                            1121
*                    DO;                                   /*@YL026UL*/
*                                                                  1122
*                    CALL ERROR2(BADITEM,LENGTH(ERRFIELD),         1123
*                                ADDR(ERRFIELD));          /*@YL026UL*/
*                                                                  1123
         MVC   @AL00001(8),@AL01123                                1123
         LA    @04,ERRFIELD                                        1123
         ST    @04,@AFTEMPS+32                                     1123
         LA    @04,@AFTEMPS+32                                     1123
         ST    @04,@AL00001+8                                      1123
         LA    @01,@AL00001                                        1123
         BAL   @14,ERROR2                                          1123
*                    RETURN;                               /*@YL026UL*/
@EL00014 DS    0H                                                  1124
@EF00014 DS    0H                                                  1124
@ER00014 LM    @14,@01,@SA00014                                    1124
         LM    @03,@04,@SA00014+16                                 1124
         LM    @06,@12,@SA00014+24                                 1124
         BR    @14                                                 1124
*                    END;                                  /*@YL026UL*/
*                  ELSE                                            1126
*                    CHSTRING=NO;                          /*@YL026UL*/
@RF01121 NI    CHSTRING,B'01111111'                                1126
*          ELSE                                                    1127
*            CHSTRING=NO;                                  /*@YL026UL*/
*                                                                  1127
         B     @RC01118                                            1127
@RF01118 NI    CHSTRING,B'01111111'                                1127
*        IF SCALAR=YES                                             1128
*                                                                  1128
*          /**********************************************************/
*          /*                                                        */
*          /* WHEN A SINGLE SCALAR (AS OPPOSED TO A SCALAR LIST)     */
*          /* IS BEING PROCESSED, GET NECESSARY SPACE, CHECK TO SEE  */
*          /* WHAT KIND OF SCALAR IT IS, AND STORE THE SCALAR AND    */
*          /* ASSOCIATED DATA.                                       */
*          /*                                                        */
*          /**********************************************************/
*          THEN                                                    1128
@RC01118 LH    @04,PARMID                                          1128
         MH    @04,@CH00038                                        1128
         L     @01,WORKPTR                                         1128
         AL    @01,@CF01440                                        1128
         L     @04,PARMPTR(@04,@01)                                1128
         TM    SCALAR(@04),B'00010000'                             1128
         BNO   @RF01128                                            1128
*            IF PWORD=NOW                                          1129
*                                                                  1129
*              /******************************************************/
*              /*                                                    */
*              /*  WHEN THE SCALAR IS A PASSWORD, STORE IT IN THE    */
*              /*  ALREADY EXISTING DATA STRUCTURE (EITHER A CHAR.   */
*              /*  STRING OR DATA SET NAME DATA STRUCTURE), FIRST    */
*              /*  CHECKING THAT IT DOESN'T EXCEED THE LENGTH LIMIT. */
*              /*  ALSO STORE THE LENGTH OF THE PASSWORD.            */
*              /*                                                    */
*              /******************************************************/
*              THEN                                                1129
         CH    PWORD,@CH00172                                      1129
         BNE   @RF01129                                            1129
*                IF UNITINDX > LENGTH(PASSWORD)                    1130
*                  THEN                                            1130
*                                                                  1130
         CH    UNITINDX,@CH00042                                   1130
         BNH   @RF01130                                            1130
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1131
*                                ADDR(ERRFIELD));                  1131
*                                                                  1131
         MVC   @AL00001(8),@AL01131                                1131
         LA    @04,ERRFIELD                                        1131
         ST    @04,@AFTEMPS+32                                     1131
         LA    @04,@AFTEMPS+32                                     1131
         ST    @04,@AL00001+8                                      1131
         LA    @01,@AL00001                                        1131
         BAL   @14,ERROR2                                          1131
*                  ELSE                                            1132
*                    IF ANYSTRNG=YES                               1132
*                      THEN                                        1132
         B     @RC01130                                            1132
@RF01130 LA    @04,12                                              1132
         LR    @15,@04                                             1132
         MH    @15,PARMID                                          1132
         L     @01,WORKPTR                                         1132
         AL    @01,@CF01440                                        1132
         AL    @04,PARMPTR(@15,@01)                                1132
         TM    ANYSTRNG(@04),B'01000000'                           1132
         BNO   @RF01132                                            1132
*                        DO;                               /*@YL026UL*/
*                        PWORD=NONE;                               1134
         SLR   PWORD,PWORD                                         1134
*                        PASSWDLN=UNITINDX;                        1135
         L     @04,DATAPTR                                         1135
         STC   UNITINDX,PASSWDLN(,@04)                             1135
*                        PASSWORD=SYNUNIT;                         1136
         MVC   PASSWORD(8,@04),SYNUNIT                             1136
*                        END;                                      1137
*                      ELSE                                        1138
*                        DO;                                       1138
         B     @RC01132                                            1138
@RF01132 DS    0H                                                  1139
*                        PWORD=NONE;                               1139
         SLR   PWORD,PWORD                                         1139
*                        DSPWDLN=UNITINDX;                         1140
         L     @04,DATAPTR                                         1140
         STC   UNITINDX,DSPWDLN(,@04)                              1140
*                        DSPWORD=SYNUNIT;                          1141
         MVC   DSPWORD(8,@04),SYNUNIT                              1141
*                        END;                                      1142
*                                                                  1142
*              /******************************************************/
*              /*                                                    */
*              /*  IF NOT A PASSWORD, ALLOCATE SPACE FOR THE SCALAR  */
*              /*  AND ITS ASSOCIATED DATA.  THEN STORE THE SCALAR   */
*              /*  AND ITS LENGTH INTO THIS DATA AREA BASED UPON     */
*              /*  THE TYPE OF SCALAR THAT IT IS, CHECKING THAT THE  */
*              /*  SCALAR LENGTH LIMIT IS NOT EXCEEDED.              */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1143
*DOGRP70:        DO;                                               1143
*                                                                  1143
         B     @RC01129                                            1143
@RF01129 DS    0H                                                  1143
DOGRP70  DS    0H                                                  1144
*                CALL GETSPACE;                                    1144
*                                                                  1144
         BAL   @14,GETSPACE                                        1144
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1145
*                  THEN                                            1145
*                                                                  1145
         TM    CHSTRING,B'10000000'                                1145
         BNO   @RF01145                                            1145
         LA    @04,12                                              1145
         LR    @15,@04                                             1145
         MH    @15,PARMID                                          1145
         L     @01,WORKPTR                                         1145
         AL    @01,@CF01440                                        1145
         AL    @04,PARMPTR(@15,@01)                                1145
         SLR   @15,@15                                             1145
         IC    @15,MAXLNGTH(,@04)                                  1145
         CR    UNITINDX,@15                                        1145
         BNH   @RF01145                                            1145
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1146
*                               ADDR(ERRFIELD));           /*@YL026UL*/
*                                                                  1146
         MVC   @AL00001(8),@AL01146                                1146
         LA    @04,ERRFIELD                                        1146
         ST    @04,@AFTEMPS+32                                     1146
         LA    @04,@AFTEMPS+32                                     1146
         ST    @04,@AL00001+8                                      1146
         LA    @01,@AL00001                                        1146
         BAL   @14,ERROR2                                          1146
*                IF RISTATUS=0                                     1147
*                  THEN                                            1147
@RF01145 ICM   @04,3,RISTATUS                                      1147
         BNZ   @RF01147                                            1147
*DOGRP75:            DO;                                           1148
DOGRP75  DS    0H                                                  1149
*                    IF CHSTRING=YES                               1149
*                                                                  1149
*                      /**********************************************/
*                      /*                                            */
*                      /*  WHEN THE SCALAR IS A CHARACTER STRING,    */
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */
*                      /*                                            */
*                      /**********************************************/
*                      THEN                                        1149
         TM    CHSTRING,B'10000000'                                1149
         BNO   @RF01149                                            1149
*                        DO;                               /*@YL026UL*/
*                        IF PWORDOPT=YES                           1151
*                          THEN                                    1151
         LA    @04,12                                              1151
         LR    @03,@04                                             1151
         MH    @03,PARMID                                          1151
         L     @01,WORKPTR                                         1151
         AL    @01,@CF01440                                        1151
         AL    @04,PARMPTR(@03,@01)                                1151
         TM    PWORDOPT(@04),B'00000010'                           1151
         BNO   @RF01151                                            1151
*                            DO;                           /*@YL026UL*/
*                            CHARLN=UNITINDX;                      1153
         L     @03,DATAPTR                                         1153
         STC   UNITINDX,CHARLN(,@03)                               1153
*                            CHARS(1:MAXLNGTH)=SYNUNIT;    /*@YL026UL*/
         SLR   @15,@15                                             1154
         IC    @15,MAXLNGTH(,@04)                                  1154
         BCTR  @15,0                                               1154
         EX    @15,@SM01466                                        1154
*                            END;                                  1155
*                          ELSE                                    1156
*                            DO;                                   1156
         B     @RC01151                                            1156
@RF01151 DS    0H                                                  1157
*                            STRINGLN=UNITINDX;                    1157
         L     @04,DATAPTR                                         1157
         STC   UNITINDX,STRINGLN(,@04)                             1157
*                            STRING(1:MAXLNGTH)=SYNUNIT;   /*@YL026UL*/
         LA    @03,12                                              1158
         LR    @15,@03                                             1158
         MH    @15,PARMID                                          1158
         L     @01,WORKPTR                                         1158
         AL    @01,@CF01440                                        1158
         AL    @03,PARMPTR(@15,@01)                                1158
         SLR   @15,@15                                             1158
         IC    @15,MAXLNGTH(,@03)                                  1158
         BCTR  @15,0                                               1158
         EX    @15,@SM01468                                        1158
*                            END;                                  1159
*                        END;                                      1160
*                                                                  1160
*                      /**********************************************/
*                      /*                                            */
*                      /*  WHEN THE CONSTANT IS HEX, BINARY, @YL026UL*/
*                      /*  OR DECIMAL, THEN PERFORM          @YL026UL*/
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */
*                      /*  INTO THE FDT.                             */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        1161
*                        IF NUMBER=YES  ANYSTRNG=YES              1161
*                          THEN                                    1161
*                                                                  1161
         B     @RC01149                                            1161
@RF01149 LA    @04,12                                              1161
         LR    @15,@04                                             1161
         MH    @15,PARMID                                          1161
         L     @01,WORKPTR                                         1161
         AL    @01,@CF01440                                        1161
         AL    @04,PARMPTR(@15,@01)                                1161
         TM    NUMBER(@04),B'11000000'                             1161
         BZ    @RF01161                                            1161
*                            CALL CONVERT;                         1162
*                                                                  1162
         BAL   @14,CONVERT                                         1162
*                          /******************************************/
*                          /*                                        */
*                          /* WHEN NONE OF THE ABOVE DATA TYPES, THE */
*                          /* SCALAR MUST BE A DATA SET IDENTIFIER.  */
*                          /* IT IS STORED IN DSNAME FORM AFTER      */
*                          /* CHECKING DSNAME RESTRICTIONS.          */
*                          /*                                        */
*                          /******************************************/
*                          ELSE                                    1163
*                                                                  1163
*                            CALL DSIDCHK;                         1163
*                                                                  1163
         B     @RC01161                                            1163
@RF01161 BAL   @14,DSIDCHK                                         1163
*                    END DOGRP75;                                  1164
*                END DOGRP70;                                      1165
*                                                                  1165
*          /**********************************************************/
*          /*                                                        */
*          /* WHEN THE SCALAR BEING HANDLED IS PART OF A SCALAR LIST,*/
*          /* CHECK THAT THE LIST ELEMENT LIMIT IS NOT EXCEEDED,     */
*          /* ALLOCATE SPACE FOR THE LIST DATA (IF NOT ALREADY DONE),*/
*          /* CHECK TO SEE WHAT KIND OF SCALAR DATA IT IS, AND STORE */
*          /* THE DATA INTO THE APPROPRIATE NEW OR EXISTING FDT AREA */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    1166
*            IF PWORD^=NOW                                         1166
*              THEN                                                1166
*                                                                  1166
         B     @RC01128                                            1166
@RF01128 CH    PWORD,@CH00172                                      1166
         BE    @RF01166                                            1166
*                /****************************************************/
*                /*                                                  */
*                /*  THE SCALAR IS NOT A PASSWORD.  IF THIS IS       */
*                /*  FIRST SCALAR ENCOUNTERED IN THE LIST, OBTAIN    */
*                /*  INITIAL FDT SPACE FOR STORING THE SCALARS AND   */
*                /*  THEIR ASSOCIATED DATA.  IF NOT THE FIRST SCALAR,*/
*                /*  ADDITIONAL SPACE MAY HAVE TO BE ALLOCATED.      */
*                /*  ALSO, CHECK THAT THE SCALAR DOES NOT EXCEED ITS */
*                /*  LENGTH LIMIT AND THAT TOO MANY SCALARS HAVE     */
*                /*  BEEN CODED IN THIS CURRENT LIST.                */
*                /*                                                  */
*                /****************************************************/
*DOGRP80:        DO;                                               1167
DOGRP80  DS    0H                                                  1168
*                SCLRCNT=SCLRCNT+1;                                1168
         LA    @04,1                                               1168
         AH    @04,SCLRCNT                                         1168
         STH   @04,SCLRCNT                                         1168
*                IF SCLRCNT > LISTMAX                              1169
*                  THEN                                            1169
*                                                                  1169
         LA    @15,12                                              1169
         LR    @14,@15                                             1169
         MH    @14,PARMID                                          1169
         L     @01,WORKPTR                                         1169
         AL    @01,@CF01440                                        1169
         AL    @15,PARMPTR(@14,@01)                                1169
         SLR   @14,@14                                             1169
         IC    @14,LISTMAX(,@15)                                   1169
         CR    @04,@14                                             1169
         BNH   @RF01169                                            1169
*                    CALL ERROR2(BADLIST,LENGTH(ERRFIELD),         1170
*                                ADDR(ERRFIELD));                  1170
*                                                                  1170
         MVC   @AL00001(8),@AL01170                                1170
         LA    @04,ERRFIELD                                        1170
         ST    @04,@AFTEMPS+32                                     1170
         LA    @04,@AFTEMPS+32                                     1170
         ST    @04,@AL00001+8                                      1170
         LA    @01,@AL00001                                        1170
         BAL   @14,ERROR2                                          1170
*                  ELSE                                            1171
*                    IF SCLRCNT=1                                  1171
*                      THEN                                        1171
         B     @RC01169                                            1171
@RF01169 CLC   SCLRCNT(2),@CH00228                                 1171
         BNE   @RF01171                                            1171
*                        DO;                                       1172
*                                                                  1172
*                        CALL GETSPACE;                            1173
*                                                                  1173
         BAL   @14,GETSPACE                                        1173
*                        ELTPTR=DATAPTR;                           1174
         MVC   ELTPTR(4),DATAPTR                                   1174
*                        END;                                      1175
*                      ELSE                                        1176
*                        DO;                                       1176
         B     @RC01171                                            1176
@RF01171 DS    0H                                                  1177
*                        SPACELFT=SPACELFT-SPACEAMT;               1177
         LH    @04,SPACELFT                                        1177
         SH    @04,SPACEAMT                                        1177
         STH   @04,SPACELFT                                        1177
*                        IF SPACELFT < 0                           1178
*                          THEN                                    1178
         LTR   @04,@04                                             1178
         BNM   @RF01178                                            1178
*                            DO;                                   1179
*                            ELTPTR=ELTPTR-DATAPTR;                1180
*                                                                  1180
         L     @04,ELTPTR                                          1180
         SL    @04,DATAPTR                                         1180
         ST    @04,ELTPTR                                          1180
*                            CALL MORSPACE;                        1181
*                                                                  1181
         BAL   @14,MORSPACE                                        1181
*                            ELTPTR=ELTPTR+DATAPTR;                1182
         L     @04,ELTPTR                                          1182
         AL    @04,DATAPTR                                         1182
         ST    @04,ELTPTR                                          1182
*                            END;                                  1183
*                        END;                                      1184
@RF01178 DS    0H                                                  1185
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1185
*                  THEN                                            1185
*                                                                  1185
@RC01171 DS    0H                                                  1185
@RC01169 TM    CHSTRING,B'10000000'                                1185
         BNO   @RF01185                                            1185
         LA    @04,12                                              1185
         LR    @15,@04                                             1185
         MH    @15,PARMID                                          1185
         L     @01,WORKPTR                                         1185
         AL    @01,@CF01440                                        1185
         AL    @04,PARMPTR(@15,@01)                                1185
         SLR   @15,@15                                             1185
         IC    @15,MAXLNGTH(,@04)                                  1185
         CR    UNITINDX,@15                                        1185
         BNH   @RF01185                                            1185
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1186
*                                ADDR(ERRFIELD));          /*@YL026UL*/
*                                                                  1186
         MVC   @AL00001(8),@AL01186                                1186
         LA    @04,ERRFIELD                                        1186
         ST    @04,@AFTEMPS+32                                     1186
         LA    @04,@AFTEMPS+32                                     1186
         ST    @04,@AL00001+8                                      1186
         LA    @01,@AL00001                                        1186
         BAL   @14,ERROR2                                          1186
*                IF RISTATUS=0                                     1187
*                                                                  1187
*                  /**************************************************/
*                  /*                                                */
*                  /* STORE THE SCALAR INTO THE PROPER DATA STRUCTURE*/
*                  /* TOGETHER WITH THE OTHER SCALARS OF THE LIST.   */
*                  /*                                                */
*                  /**************************************************/
*                  THEN                                            1187
@RF01185 ICM   @04,3,RISTATUS                                      1187
         BNZ   @RF01187                                            1187
*                    IF CHSTRING=YES                               1188
*                                                                  1188
*                      /**********************************************/
*                      /*                                            */
*                      /* WHEN THE SCALAR IS IN CHARACTER STRING FORM*/
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */
*                      /*                                            */
*                      /**********************************************/
*                      THEN                                        1188
         TM    CHSTRING,B'10000000'                                1188
         BNO   @RF01188                                            1188
*DOGRP85:                DO;                               /*@YL026UL*/
DOGRP85  DS    0H                                                  1190
*                        IF PWORDOPT=YES                           1190
*                          THEN                                    1190
         LA    @04,12                                              1190
         LR    @03,@04                                             1190
         MH    @03,PARMID                                          1190
         L     @01,WORKPTR                                         1190
         AL    @01,@CF01440                                        1190
         AL    @04,PARMPTR(@03,@01)                                1190
         TM    PWORDOPT(@04),B'00000010'                           1190
         BNO   @RF01190                                            1190
*                            DO;                           /*@YL026UL*/
*                            CHARCT=SCLRCNT;                       1192
         L     @03,DATAPTR                                         1192
         MVC   CHARCT(2,@03),SCLRCNT                               1192
*                            ELTPTR->LCHARLN=UNITINDX;             1193
         L     @03,ELTPTR                                          1193
         STC   UNITINDX,LCHARLN(,@03)                              1193
*                            ELTPTR->LCHAR(1:MAXLNGTH)=            1194
*                                                 SYNUNIT; /*@YL026UL*/
         SLR   @15,@15                                             1194
         IC    @15,MAXLNGTH(,@04)                                  1194
         BCTR  @15,0                                               1194
         EX    @15,@SM01470                                        1194
*                            END;                                  1195
*                          ELSE                                    1196
*                            DO;                                   1196
         B     @RC01190                                            1196
@RF01190 DS    0H                                                  1197
*                            STRINGCT=SCLRCNT;                     1197
         L     @04,DATAPTR                                         1197
         MVC   STRINGCT(2,@04),SCLRCNT                             1197
*                            ELTPTR->LSTRINGL=UNITINDX;            1198
         L     @04,ELTPTR                                          1198
         STC   UNITINDX,LSTRINGL(,@04)                             1198
*                            ELTPTR->LSTRING(1:MAXLNGTH)=          1199
*                                                 SYNUNIT; /*@YL026UL*/
         LA    @03,12                                              1199
         LR    @15,@03                                             1199
         MH    @15,PARMID                                          1199
         L     @01,WORKPTR                                         1199
         AL    @01,@CF01440                                        1199
         AL    @03,PARMPTR(@15,@01)                                1199
         SLR   @15,@15                                             1199
         IC    @15,MAXLNGTH(,@03)                                  1199
         BCTR  @15,0                                               1199
         EX    @15,@SM01472                                        1199
*                            END;                                  1200
*                        /********************************************/
*                        /*                                          */
*                        /* IF NO PASSWORD FOLLOWS THIS SCALAR, THEN */
*                        /* POINT TO WHERE THE NEXT SCALAR LIST      */
*                        /* ELEMENT WILL BE PLACED IN THE FDT.       */
*                        /*                                          */
*                        /********************************************/
*                        IF PWORD ^= NEXT                          1201
*                          THEN                                    1201
@RC01190 CH    PWORD,@CH00228                                      1201
         BE    @RF01201                                            1201
*                            ELTPTR=ELTPTR+SPACEAMT;               1202
         LH    @04,SPACEAMT                                        1202
         AL    @04,ELTPTR                                          1202
         ST    @04,ELTPTR                                          1202
*                        END DOGRP85;                              1203
*                                                                  1203
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF THE SCALAR IS A DECIMAL, HEXADECIMAL,  */
*                      /*  OR BINARY CONSTANT, THEN PERFORM THE      */
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */
*                      /*  INTO THE FDT.                             */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        1204
*                        IF NUMBER=YES  ANYSTRNG=YES              1204
*                          THEN                                    1204
*                                                                  1204
         B     @RC01188                                            1204
@RF01188 LA    @04,12                                              1204
         LR    @15,@04                                             1204
         MH    @15,PARMID                                          1204
         L     @01,WORKPTR                                         1204
         AL    @01,@CF01440                                        1204
         AL    @04,PARMPTR(@15,@01)                                1204
         TM    NUMBER(@04),B'11000000'                             1204
         BZ    @RF01204                                            1204
*                            CALL CONVERT;                         1205
*                                                                  1205
         BAL   @14,CONVERT                                         1205
*                          /******************************************/
*                          /*                                        */
*                          /*  WHEN NONE OF THE ABOVE, THE SCALAR IS */
*                          /*  A DATA SET NAME AND IS STORED IN      */
*                          /*  DSID FORM IN THE FDT.  THE NAME MUST  */
*                          /*  CONFORM TO DSNAME RESTRICTIONS.       */
*                          /*                                        */
*                          /******************************************/
*                          ELSE                                    1206
*                                                                  1206
*                            CALL DSIDCHK;                         1206
*                                                                  1206
         B     @RC01204                                            1206
@RF01204 BAL   @14,DSIDCHK                                         1206
*                END DOGRP80;                                      1207
*                                                                  1207
*              /******************************************************/
*              /*                                                    */
*              /*  WHEN THE EXTRACTED SCALAR IS A PASSWORD ATTACHED  */
*              /*  TO A SCALAR LIST ELEMENT, STORE IT IN THE DATA    */
*              /*  AREA OF THE APPROPRIATE CHAR. STRING OR DSNAME    */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1208
*                DO;                                               1208
         B     @RC01166                                            1208
@RF01166 DS    0H                                                  1209
*                PWORD=NONE;                                       1209
         SLR   PWORD,PWORD                                         1209
*                IF UNITINDX > LENGTH(PASSWORD)                    1210
*                  THEN                                            1210
*                                                                  1210
         CH    UNITINDX,@CH00042                                   1210
         BNH   @RF01210                                            1210
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1211
*                                ADDR(ERRFIELD));                  1211
*                                                                  1211
         MVC   @AL00001(8),@AL01211                                1211
         LA    @04,ERRFIELD                                        1211
         ST    @04,@AFTEMPS+32                                     1211
         LA    @04,@AFTEMPS+32                                     1211
         ST    @04,@AL00001+8                                      1211
         LA    @01,@AL00001                                        1211
         BAL   @14,ERROR2                                          1211
*                  ELSE                                            1212
*                    IF ANYSTRNG=YES                               1212
*                      THEN                                        1212
         B     @RC01210                                            1212
@RF01210 LA    @04,12                                              1212
         LR    @03,@04                                             1212
         MH    @03,PARMID                                          1212
         L     @01,WORKPTR                                         1212
         AL    @01,@CF01440                                        1212
         AL    @04,PARMPTR(@03,@01)                                1212
         TM    ANYSTRNG(@04),B'01000000'                           1212
         BNO   @RF01212                                            1212
*                        DO;                               /*@YL026UL*/
*                        ELTPTR->LCHRPWDL=UNITINDX;                1214
         L     @04,ELTPTR                                          1214
         STC   UNITINDX,LCHRPWDL(,@04)                             1214
*                        ELTPTR->LCHRPWD=SYNUNIT;                  1215
         MVC   LCHRPWD(8,@04),SYNUNIT                              1215
*                        ELTPTR=ELTPTR+SPACEAMT;                   1216
         AH    @04,SPACEAMT                                        1216
         ST    @04,ELTPTR                                          1216
*                        END;                                      1217
*                      ELSE                                        1218
*                        DO;                                       1218
         B     @RC01212                                            1218
@RF01212 DS    0H                                                  1219
*                        LDSNPWDL(SCLRCNT)=UNITINDX;               1219
         L     @04,DATAPTR                                         1219
         LH    @03,SCLRCNT                                         1219
         MH    @03,@CH01419                                        1219
         LA    @01,0(@03,@04)                                      1219
         AL    @01,@CF01474                                        1219
         STC   UNITINDX,LDSNPWDL-2(,@01)                           1219
*                        LDSNPWD(SCLRCNT)=SYNUNIT;                 1220
         ALR   @04,@03                                             1220
         AL    @04,@CF01475                                        1220
         MVC   LDSNPWD-3(8,@04),SYNUNIT                            1220
*                        END;                                      1221
*                END;                                              1222
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - CONVERT                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL, BINARY, OR HEXADECIMAL*/
*/*             CONSTANTS FROM EBCDIC FORM INTO THE PROPER INTERNAL  */
*/*             FORM (FULLWORD BINARY OR HEXIDECIMAL DIGIT STRING,   */
*/*             BASED UPON THE COMMAND DESCRIPTOR SPECIFICATION).    */
*/*             THE CONSTANTS ARE CHECKED TO INSURE THAT THEY ARE    */
*/*             SYNTACTICALLY AND SEMANTICALLY CORRECT AND ARE THEN  */
*/*             PLACED INTO THE FDT IN CONVERTED FORM.               */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SYNUNIT - CONTAINS THE CONSTANT IN EBCDIC FORM WHICH IS */
*/*                    TO BE CONVERTED.                              */
*/*          UNITINDX- LENGTH OF EBCDIC CONSTANT                     */
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */
*/*                    SCALAR WAS INPUT (AS A HEX, BINARY OR DECIMAL */
*/*                    CONSTANT).                                    */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR HAS BEEN DETECTED         */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE DATA ENTRIES.                       */
*/*          SYNUNIT - CONSTANT IN CONVERTED FORM                    */
*/*          CNVRTFLD- CONSTANT IN BINARY FULLWORD CONVERTED FORM    */
*/*                                                                  */
*/********************************************************************/
*CONVERT:PROCEDURE;                                                1223
         B     @PB00015                                            1223
CONVERT  STM   @14,@12,@SA00015                                    1223
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR CONVERT ROUTINE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1224
*        DCL HEXTABLE(16) CHAR(1)      /*HEX DIGITS IN EBCDIC FORM   */
*                         INIT('0','1','2','3','4','5','6','7',    1224
*                              '8','9','A','B','C','D','E','F');   1224
*        DCL WORKVAL  FIXED(31);       /*FULLWORD WORK AREA USED   1225
*                                        DURING CONVERSION           */
*        DCL TWOPOWER FIXED(15);       /*COMPUTED POWER OF 2         */
*        DCL CNVRTVAL FIXED(8);        /*1-BYTE WORK AREA USED     1227
*                                        DURING CONVERSION           */
*        DCL DIGTINDX FIXED(15);       /*INDEX INDICATING CURRENT  1228
*                                        LENGTH OF CONVERTED PORTION
*                                        OF CONSTANT BEING CONVERTED */
*                                                                  1228
*        DCL ZEROHALF BIT(8)           /*BIT MASK USED TO SET UPPER  */
*                CONSTANT('00001111'B);/* HALF OF A BYTE TO ZEROES   */
*        /************************************************************/
*        /*                                                          */
*        /*  ** CONVERT **  CONVERT DIGIT STRINGS TO INTERNAL FORM   */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1230
*          THEN;                                                   1230
         ICM   @04,15,GDTDBG(GDTPTR)                               1230
         BZ    @RT01230                                            1230
*          ELSE                                                    1232
*            CALL IDCDB010(GDTTBL,'RICV');                         1232
*                                                                  1232
         ST    GDTPTR,@AL00001                                     1232
         LA    @04,@CC01181                                        1232
         ST    @04,@AL00001+4                                      1232
         MVI   @AL00001+4,X'80'                                    1232
         L     @15,GDTDBG(,GDTPTR)                                 1232
         LA    @01,@AL00001                                        1232
         BALR  @14,@15                                             1232
*        /************************************************************/
*        /*                                                          */
*        /* IF THE INPUT DIGIT STRING IS A DECIMAL NUMBER, CONVERT   */
*        /* IT TO A BINARY FULLWORD.                                 */
*        /*                                                          */
*        /************************************************************/
*        IF ORGSIGN=BLANK                                          1233
*          THEN                                                    1233
*                                                                  1233
@RT01230 CLI   ORGSIGN,C' '                                        1233
         BNE   @RF01233                                            1233
*            CALL PACKCVB;                                         1234
*                                                                  1234
         BAL   @14,PACKCVB                                         1234
*          ELSE                                                    1235
*DOGRP90:    DO;                                                   1235
*                                                                  1235
         B     @RC01233                                            1235
@RF01233 DS    0H                                                  1235
DOGRP90  DS    0H                                                  1236
*            /********************************************************/
*            /*                                                      */
*            /* IF THE DIGIT STRING IS A BINARY CONSTANT, CONVERT IT */
*            /* INTO A STRING OF HEXADECIMAL DIGITS (NO LONGER IN    */
*            /* EBCDIC FORM).  BEFORE CONVERSION, CHECK ALL THE      */
*            /* DIGITS IN THE CONSTANT TO BE SURE THEY ARE BINARY    */
*            /* DIGITS, AND IF THE STRING IS A BINARY NUMBER, THEN   */
*            /* CHECK THAT IT DOESN'T EXCEED THE BINARY FULLWORD     */
*            /* SIZE LIMIT.                                          */
*            /*                                                      */
*            /********************************************************/
*            IF ORGSIGN=BINSIGN                                    1236
*              THEN                                                1236
         CLI   ORGSIGN,C'B'                                        1236
         BNE   @RF01236                                            1236
*                IF NUMBER=YES & UNITINDX > 32                     1237
*                  THEN                                            1237
*                                                                  1237
         LA    @04,12                                              1237
         LR    @02,@04                                             1237
         MH    @02,PARMID                                          1237
         L     @01,WORKPTR                                         1237
         AL    @01,@CF01440                                        1237
         AL    @04,PARMPTR(@02,@01)                                1237
         TM    NUMBER(@04),B'10000000'                             1237
         BNO   @RF01237                                            1237
         CH    UNITINDX,@CH00230                                   1237
         BNH   @RF01237                                            1237
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1238
*                                ADDR(ERRFIELD));                  1238
*                                                                  1238
         MVC   @AL00001(8),@AL01238                                1238
         LA    @04,ERRFIELD                                        1238
         ST    @04,@AFTEMPS+24                                     1238
         LA    @04,@AFTEMPS+24                                     1238
         ST    @04,@AL00001+8                                      1238
         LA    @01,@AL00001                                        1238
         BAL   @14,ERROR2                                          1238
*                  ELSE                                            1239
*DOGRP95:            DO;                                           1239
         B     @RC01237                                            1239
@RF01237 DS    0H                                                  1239
DOGRP95  DS    0H                                                  1240
*                      OLDERID2 = NEWERID2;                        1240
         L     @04,GDTTR2(,GDTPTR)                                 1240
         MVC   @TS00001(95),NEWERID2(@04)                          1240
         MVC   OLDERID2(95,@04),@TS00001                           1240
*                      NEWID2='RI24';                              1241
*                                                                  1241
         MVC   NEWID2(4,@04),@CC01186                              1241
*                      /**********************************************/
*                      /*                                            */
*                      /* CHECK THE DIGITS ONE AT A TIME; IF A DIGIT */
*                      /* IS A 1 OR 0 (X'F1' OR X'F0' IN EBCDIC) THEN*/
*                      /* SET THE HIGHER ORDER 4 BITS TO ZEROES.     */
*                      /*                                            */
*                      /**********************************************/
*                      DO INDEX=1 TO UNITINDX WHILE(RISTATUS=0);   1242
         LA    @04,1                                               1242
         B     @DE01242                                            1242
@DL01242 ICM   @02,3,RISTATUS                                      1242
         BNZ   @DC01242                                            1242
*                        IF SYNUNIT(INDEX) ^= '1'  &               1243
*                           SYNUNIT(INDEX) ^= '0'                  1243
*                          THEN                                    1243
*                                                                  1243
         LA    @02,SYNUNIT-1(@04)                                  1243
         CLI   0(@02),C'1'                                         1243
         BE    @RF01243                                            1243
         LA    @02,SYNUNIT-1(@04)                                  1243
         CLI   0(@02),C'0'                                         1243
         BE    @RF01243                                            1243
*                            CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),
*                                        ADDR(ERRFIELD));          1244
*                                                                  1244
         MVC   @AL00001(8),@AL01244                                1244
         LA    @04,ERRFIELD                                        1244
         ST    @04,@AFTEMPS+24                                     1244
         LA    @04,@AFTEMPS+24                                     1244
         ST    @04,@AL00001+8                                      1244
         LA    @01,@AL00001                                        1244
         BAL   @14,ERROR2                                          1244
*                          ELSE                                    1245
*                            SYNUNIT(INDEX)=SYNUNIT(INDEX) & ZEROHALF;
         B     @RC01243                                            1245
@RF01243 LH    @04,INDEX                                           1245
         LA    @02,SYNUNIT-1(@04)                                  1245
         NI    0(@02),B'00001111'                                  1245
*                      END;                                        1246
@RC01243 LA    @04,1                                               1246
         AH    @04,INDEX                                           1246
@DE01242 STH   @04,INDEX                                           1246
         CR    @04,UNITINDX                                        1246
         BNH   @DL01242                                            1246
@DC01242 DS    0H                                                  1247
*                    IF RISTATUS=0                                 1247
*                      THEN                                        1247
*                                                                  1247
         ICM   @04,3,RISTATUS                                      1247
         BNZ   @RF01247                                            1247
*                        /********************************************/
*                        /*                                          */
*                        /* CONVERT THE MODIFIED STRING INTO A HEX   */
*                        /* DIGIT STRING INTERNALLY BY CONVERTING A  */
*                        /* EACH BYTE'S WORTH OF BINARY DIGITS INTO A*/
*                        /* VALUE BETWEEN 0 AND 255 (MULTIPLY THE    */
*                        /* BINARY DIGITS BY POWERS OF 2 INCREASING  */
*                        /* LOW ORDER TO HIGH ORDER).  STORE THE     */
*                        /* STRING OF 1-BYTE VALUES BACK INTO THE    */
*                        /* SAME WORK AREA THAT CONTAINS THE MODIFIED*/
*                        /* DIGIT STRING.                            */
*                        /*                                          */
*                        /********************************************/
*DOGRP100:               DO;                                       1248
DOGRP100 DS    0H                                                  1249
*                        WORKVAL=UNITINDX//8;                      1249
         LR    @00,UNITINDX                                        1249
         SRDA  @00,32                                              1249
         D     @00,@CF00042                                        1249
         LR    WORKVAL,@00                                         1249
*                        DIGTINDX=0;                               1250
*                                                                  1250
         SLR   @02,@02                                             1250
         STH   @02,DIGTINDX                                        1250
*                        /********************************************/
*                        /*                                          */
*                        /* IF THE NUMBER OF DIGITS IN THE STRING IS */
*                        /* NOT A MULTIPLE OF 8, FIRST CONVERT JUST  */
*                        /* THE ODD NUMBER OF DIGITS INTO A VALUE    */
*                        /* BETWEEN 0 AND 255.                       */
*                        /*                                          */
*                        /********************************************/
*                        IF WORKVAL ^= 0                           1251
*                          THEN                                    1251
         CR    WORKVAL,@02                                         1251
         BE    @RF01251                                            1251
*                            DO;                                   1252
*                              CNVRTVAL=0;                         1253
         MVI   CNVRTVAL,X'00'                                      1253
*                              TWOPOWER=1;                         1254
         LA    TWOPOWER,1                                          1254
*                              DO INDEX2=WORKVAL TO 1 BY -1;       1255
         LR    @15,WORKVAL                                         1255
         STH   @15,INDEX2                                          1255
         B     @DE01255                                            1255
@DL01255 DS    0H                                                  1256
*                                CNVRTVAL=CNVRTVAL+                1256
*                                         DIGITVAL(INDEX2)*TWOPOWER;
         LR    @01,TWOPOWER                                        1256
         SLR   @14,@14                                             1256
         IC    @14,DIGITVAL-1(@15)                                 1256
         MR    @00,@14                                             1256
         SLR   @00,@00                                             1256
         IC    @00,CNVRTVAL                                        1256
         ALR   @01,@00                                             1256
         STC   @01,CNVRTVAL                                        1256
*                                TWOPOWER=TWOPOWER*2;              1257
         ALR   TWOPOWER,TWOPOWER                                   1257
*                              END;                                1258
         BCTR  @15,0                                               1258
         STH   @15,INDEX2                                          1258
@DE01255 LTR   @15,@15                                             1258
         BP    @DL01255                                            1258
*                              DIGITVAL(1)=CNVRTVAL;               1259
         MVC   DIGITVAL(1),CNVRTVAL                                1259
*                              DIGTINDX=1;                         1260
         MVC   DIGTINDX(2),@CH00228                                1260
*                            END;                                  1261
*                                                                  1261
*                        /********************************************/
*                        /*                                          */
*                        /* CONVERT EACH GROUP OF 8 BINARY DIGITS    */
*                        /* INTO A ONE-BYTE VALUE, CREATING A STRING */
*                        /* OF THESE VALUES.                         */
*                        /*                                          */
*                        /********************************************/
*                        DO INDEX=WORKVAL+1 TO UNITINDX BY 8;      1262
@RF01251 LA    @02,1                                               1262
         ALR   @02,WORKVAL                                         1262
         STH   @02,INDEX                                           1262
         B     @DE01262                                            1262
@DL01262 DS    0H                                                  1263
*                          CNVRTVAL=0;                             1263
         MVI   CNVRTVAL,X'00'                                      1263
*                          TWOPOWER=1;                             1264
         LA    TWOPOWER,1                                          1264
*                          DO INDEX2=INDEX+7 TO INDEX BY -1;       1265
         LH    @15,INDEX                                           1265
         AH    @15,@CH00043                                        1265
         STH   @15,INDEX2                                          1265
         B     @DE01265                                            1265
@DL01265 DS    0H                                                  1266
*                            CNVRTVAL=CNVRTVAL+                    1266
*                                     DIGITVAL(INDEX2)*TWOPOWER;   1266
         LR    @01,TWOPOWER                                        1266
         SLR   @14,@14                                             1266
         IC    @14,DIGITVAL-1(@15)                                 1266
         MR    @00,@14                                             1266
         SLR   @00,@00                                             1266
         IC    @00,CNVRTVAL                                        1266
         ALR   @01,@00                                             1266
         STC   @01,CNVRTVAL                                        1266
*                            TWOPOWER=TWOPOWER*2;                  1267
         ALR   TWOPOWER,TWOPOWER                                   1267
*                          END;                                    1268
         BCTR  @15,0                                               1268
         STH   @15,INDEX2                                          1268
@DE01265 CH    @15,INDEX                                           1268
         BNL   @DL01265                                            1268
*                          DIGTINDX=DIGTINDX+1;                    1269
         LA    @02,1                                               1269
         AH    @02,DIGTINDX                                        1269
         STH   @02,DIGTINDX                                        1269
*                          DIGITVAL(DIGTINDX)=CNVRTVAL;            1270
         SLR   @15,@15                                             1270
         IC    @15,CNVRTVAL                                        1270
         STC   @15,DIGITVAL-1(@02)                                 1270
*                        END;                                      1271
         LA    @02,8                                               1271
         AH    @02,INDEX                                           1271
         STH   @02,INDEX                                           1271
@DE01262 CR    @02,UNITINDX                                        1271
         BNH   @DL01262                                            1271
*                        END DOGRP100;                             1272
*                    END DOGRP95;                                  1273
*                                                                  1273
*                /****************************************************/
*                /*                                                  */
*                /* IF THE INPUT IS NOT A DECIMAL OR BINARY CONSTANT */
*                /* THEN IT MUST BE A HEXADECIMAL CONSTANT.          */
*                /*                                                  */
*                /****************************************************/
*                ELSE                                              1274
*                                                                  1274
*                  /**************************************************/
*                  /*                                                */
*                  /* IF THE HEXADECIMAL CONSTANT IS A HEXADECIMAL   */
*                  /* NUMBER, AND IT EXCEEDS THE SIZE THAT WOULD     */
*                  /* FIT INTO A BINARY FULLWORD AFTER CONVERSION,   */
*                  /* THEN IT IS AN ERROR.  OTHERWISE, TAKE THE HEX  */
*                  /* DIGITS (IN EBCDIC FORM) TWO AT A TIME AND      */
*                  /* CONVERT EACH INTO A ONE-BYTE VALUE BETWEEN 0   */
*                  /* AND 255 USING A CONVERSION TABLE.  CREATE A    */
*                  /* STRING OF THESE 1-BYTE VALUES, WHICH WILL THEN */
*                  /* BE A REPRESENTATION OF THE INPUT VALUE, STORING*/
*                  /* THIS STRING BACK WHERE THE EBCDIC DIGITS WERE. */
*                  /*                                                */
*                  /**************************************************/
*                  IF NUMBER=YES & UNITINDX > 8                    1274
*                    THEN                                          1274
*                                                                  1274
         B     @RC01236                                            1274
@RF01236 LA    @04,12                                              1274
         LR    @02,@04                                             1274
         MH    @02,PARMID                                          1274
         L     @01,WORKPTR                                         1274
         AL    @01,@CF01440                                        1274
         AL    @04,PARMPTR(@02,@01)                                1274
         TM    NUMBER(@04),B'10000000'                             1274
         BNO   @RF01274                                            1274
         CH    UNITINDX,@CH00042                                   1274
         BNH   @RF01274                                            1274
*                      CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),      1275
*                                  ADDR(ERRFIELD));                1275
*                                                                  1275
         MVC   @AL00001(8),@AL01275                                1275
         LA    @04,ERRFIELD                                        1275
         ST    @04,@AFTEMPS+24                                     1275
         LA    @04,@AFTEMPS+24                                     1275
         ST    @04,@AL00001+8                                      1275
         LA    @01,@AL00001                                        1275
         BAL   @14,ERROR2                                          1275
*                    ELSE                                          1276
*DOGRP105:             DO;                                         1276
         B     @RC01274                                            1276
@RF01274 DS    0H                                                  1276
DOGRP105 DS    0H                                                  1277
*                        OLDERID2 = NEWERID2;                      1277
         L     @04,GDTTR2(,GDTPTR)                                 1277
         MVC   @TS00001(95),NEWERID2(@04)                          1277
         MVC   OLDERID2(95,@04),@TS00001                           1277
*                        NEWID2='RI27';                            1278
         MVC   NEWID2(4,@04),@CC01192                              1278
*                        DIGTINDX=0;                               1279
*                                                                  1279
         SLR   @04,@04                                             1279
         STH   @04,DIGTINDX                                        1279
*                        /********************************************/
*                        /*                                          */
*                        /* IF THERE ARE AN ODD NUMBER OF HEX DIGITS */
*                        /* IN THE HEX CONSTANT, FIRST CONVERT JUST  */
*                        /* THE SINGLE, HIGH-ORDER DIGIT INTO A ONE- */
*                        /* BYTE VALUE.                              */
*                        /*                                          */
*                        /********************************************/
*                        IF UNITINDX//2 ^= 0                       1280
*                          THEN                                    1280
         LR    @00,UNITINDX                                        1280
         SRDA  @00,32                                              1280
         D     @00,@CF00163                                        1280
         CR    @00,@04                                             1280
         BE    @RF01280                                            1280
*                            DO;                                   1281
*                              FOUND=NO;                           1282
*                                                                  1282
         NI    FOUND,B'11011111'                                   1282
*                              /**************************************/
*                              /*                                    */
*                              /* MATCH THE HEX DIGIT AGAINST THE    */
*                              /* CONVERSION TABLE TO OBTAIN THE     */
*                              /* VALUE OF THE DIGIT.  IF NO MATCH   */
*                              /* IS FOUND, AN INVALID HEX DIGIT HAS */
*                              /* BEEN FOUND.                        */
*                              /*                                    */
*                              /**************************************/
*                              DO LISTINDX=1 TO 16 WHILE(FOUND=NO);
         LA    @04,1                                               1283
         STH   @04,LISTINDX                                        1283
@DL01283 TM    FOUND,B'00100000'                                   1283
         BNZ   @DC01283                                            1283
*                                IF SYNUNIT(1)=HEXTABLE(LISTINDX)  1284
*                                  THEN                            1284
         LA    @02,HEXTABLE-1(@04)                                 1284
         CLC   SYNUNIT(1),0(@02)                                   1284
         BNE   @RF01284                                            1284
*                                    DO;                           1285
*                                    FOUND=YES;                    1286
         OI    FOUND,B'00100000'                                   1286
*                                    DIGTINDX=1;                   1287
         MVC   DIGTINDX(2),@CH00228                                1287
*                                    DIGITVAL(1)=LISTINDX-1;       1288
         BCTR  @04,0                                               1288
         STC   @04,DIGITVAL                                        1288
*                                    END;                          1289
*                              END;                                1290
@RF01284 LA    @04,1                                               1290
         AH    @04,LISTINDX                                        1290
         STH   @04,LISTINDX                                        1290
         CH    @04,@CH00482                                        1290
         BNH   @DL01283                                            1290
@DC01283 DS    0H                                                  1291
*                              IF FOUND=NO                         1291
*                                THEN                              1291
*                                                                  1291
         TM    FOUND,B'00100000'                                   1291
         BNZ   @RF01291                                            1291
*                                  CALL ERROR2(BADDIGIT,           1292
*                                              LENGTH(ERRFIELD),   1292
*                                              ADDR(ERRFIELD));    1292
*                                                                  1292
         MVC   @AL00001(8),@AL01292                                1292
         LA    @04,ERRFIELD                                        1292
         ST    @04,@AFTEMPS+24                                     1292
         LA    @04,@AFTEMPS+24                                     1292
         ST    @04,@AL00001+8                                      1292
         LA    @01,@AL00001                                        1292
         BAL   @14,ERROR2                                          1292
*                            END;                                  1293
*                                                                  1293
@RF01291 DS    0H                                                  1294
*                        /********************************************/
*                        /*                                          */
*                        /* TAKE THE REMAINING STRING OF HEX DIGITS  */
*                        /* TWO AT A TIME, MATCHING EACH DIGIT OF A  */
*                        /* PAIR AGAINST THE CONVERSION TABLE TO GET */
*                        /* THE VALUE OF THE HEX DIGIT.  MULTIPLY THE*/
*                        /* VALUE OF THE HIGHER ORDER DIGIT OF EACH  */
*                        /* PAIR BY 16 AND ADD THIS TO THE VALUE OF  */
*                        /* THE LOWER ORDER DIGIT TO OBTAIN THE ONE- */
*                        /* BYTE VALUE BETWEEN 0 AND 255.            */
*                        /*                                          */
*                        /********************************************/
*DOLOOP15:               DO INDEX=DIGTINDX+1 TO UNITINDX BY 2      1294
*                           WHILE(RISTATUS=0);                     1294
@RF01280 DS    0H                                                  1294
DOLOOP15 LA    @04,1                                               1294
         AH    @04,DIGTINDX                                        1294
         STH   @04,INDEX                                           1294
         B     @DE01294                                            1294
@DL01294 ICM   @04,3,RISTATUS                                      1294
         BNZ   @DC01294                                            1294
*                          FOUND=NO;                               1295
         NI    FOUND,B'11011111'                                   1295
*                          DO LISTINDX=1 TO 16 WHILE(FOUND=NO);    1296
         LA    @04,1                                               1296
         STH   @04,LISTINDX                                        1296
@DL01296 TM    FOUND,B'00100000'                                   1296
         BNZ   @DC01296                                            1296
*                            IF SYNUNIT(INDEX)=HEXTABLE(LISTINDX)  1297
*                              THEN                                1297
         LH    @02,INDEX                                           1297
         LA    @01,SYNUNIT-1(@02)                                  1297
         LA    @02,HEXTABLE-1(@04)                                 1297
         CLC   0(1,@01),0(@02)                                     1297
         BNE   @RF01297                                            1297
*                                DO;                               1298
*                                FOUND=YES;                        1299
         OI    FOUND,B'00100000'                                   1299
*                                CNVRTVAL=16*(LISTINDX-1);         1300
         BCTR  @04,0                                               1300
         SLA   @04,4                                               1300
         STC   @04,CNVRTVAL                                        1300
*                                END;                              1301
*                          END;                                    1302
@RF01297 LA    @04,1                                               1302
         AH    @04,LISTINDX                                        1302
         STH   @04,LISTINDX                                        1302
         CH    @04,@CH00482                                        1302
         BNH   @DL01296                                            1302
@DC01296 DS    0H                                                  1303
*                          IF FOUND=NO                             1303
*                            THEN                                  1303
*                                                                  1303
         TM    FOUND,B'00100000'                                   1303
         BNZ   @RF01303                                            1303
*                              CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),
*                                          ADDR(ERRFIELD));        1304
*                                                                  1304
         MVC   @AL00001(8),@AL01304                                1304
         LA    @04,ERRFIELD                                        1304
         ST    @04,@AFTEMPS+24                                     1304
         LA    @04,@AFTEMPS+24                                     1304
         ST    @04,@AL00001+8                                      1304
         LA    @01,@AL00001                                        1304
         BAL   @14,ERROR2                                          1304
*                            ELSE                                  1305
*                                                                  1305
*                              /**************************************/
*                              /*                                    */
*                              /* IF THE HIGHER ORDER DIGIT OF THE   */
*                              /* PAIR WAS CONVERTED OKAY, THEN      */
*                              /* CONVERT THE LOWER ORDER DIGIT AND  */
*                              /* COMBINE THE TWO INTO A VALUE.      */
*                              /*                                    */
*                              /**************************************/
*                              DO;                                 1305
         B     @RC01303                                            1305
@RF01303 DS    0H                                                  1306
*                                FOUND=NO;                         1306
         NI    FOUND,B'11011111'                                   1306
*                                DO LISTINDX=1 TO 16 WHILE(FOUND=NO);
         LA    @04,1                                               1307
         STH   @04,LISTINDX                                        1307
@DL01307 TM    FOUND,B'00100000'                                   1307
         BNZ   @DC01307                                            1307
*                                  IF SYNUNIT(INDEX+1)=            1308
*                                      HEXTABLE(LISTINDX)          1308
*                                    THEN                          1308
         LH    @02,INDEX                                           1308
         LA    @01,SYNUNIT(@02)                                    1308
         LA    @02,HEXTABLE-1(@04)                                 1308
         CLC   0(1,@01),0(@02)                                     1308
         BNE   @RF01308                                            1308
*                                      DO;                         1309
*                                      FOUND=YES;                  1310
         OI    FOUND,B'00100000'                                   1310
*                                      DIGTINDX=DIGTINDX+1;        1311
         LA    @02,1                                               1311
         AH    @02,DIGTINDX                                        1311
         STH   @02,DIGTINDX                                        1311
*                                      DIGITVAL(DIGTINDX)=         1312
*                                        CNVRTVAL+LISTINDX-1;      1312
         SLR   @15,@15                                             1312
         IC    @15,CNVRTVAL                                        1312
         ALR   @04,@15                                             1312
         BCTR  @04,0                                               1312
         STC   @04,DIGITVAL-1(@02)                                 1312
*                                      END;                        1313
*                                END;                              1314
@RF01308 LA    @04,1                                               1314
         AH    @04,LISTINDX                                        1314
         STH   @04,LISTINDX                                        1314
         CH    @04,@CH00482                                        1314
         BNH   @DL01307                                            1314
@DC01307 DS    0H                                                  1315
*                                IF FOUND=NO                       1315
*                                  THEN                            1315
*                                                                  1315
         TM    FOUND,B'00100000'                                   1315
         BNZ   @RF01315                                            1315
*                                    CALL ERROR2(BADDIGIT,         1316
*                                                LENGTH(ERRFIELD), 1316
*                                                ADDR(ERRFIELD));  1316
*                                                                  1316
         MVC   @AL00001(8),@AL01316                                1316
         LA    @04,ERRFIELD                                        1316
         ST    @04,@AFTEMPS+24                                     1316
         LA    @04,@AFTEMPS+24                                     1316
         ST    @04,@AL00001+8                                      1316
         LA    @01,@AL00001                                        1316
         BAL   @14,ERROR2                                          1316
*                              END;                                1317
@RF01315 DS    0H                                                  1318
*                        END DOLOOP15;                             1318
@RC01303 LA    @04,2                                               1318
         AH    @04,INDEX                                           1318
         STH   @04,INDEX                                           1318
@DE01294 CR    @04,UNITINDX                                        1318
         BNH   @DL01294                                            1318
@DC01294 DS    0H                                                  1319
*                      END DOGRP105;                               1319
*              IF RISTATUS=0                                       1320
*                THEN                                              1320
*                                                                  1320
@RC01274 DS    0H                                                  1320
@RC01236 ICM   @04,3,RISTATUS                                      1320
         BNZ   @RF01320                                            1320
*                  /**************************************************/
*                  /*                                                */
*                  /* IF THE BINARY OR HEX CONSTANT JUST CONVERTED   */
*                  /* IS A NUMBER, MOVE THE CONVERTED NUMBER (STRING */
*                  /* OF 1-BYTE VALUES) INTO A BINARY FULLWORD.      */
*                  /*                                                */
*                  /**************************************************/
*                  IF NUMBER=YES                                   1321
*                    THEN                                          1321
         LA    @04,12                                              1321
         LR    @02,@04                                             1321
         MH    @02,PARMID                                          1321
         L     @01,WORKPTR                                         1321
         AL    @01,@CF01440                                        1321
         AL    @04,PARMPTR(@02,@01)                                1321
         TM    NUMBER(@04),B'10000000'                             1321
         BNO   @RF01321                                            1321
*                      DO;                                         1322
*                      OLDERID2 = NEWERID2;                        1323
         L     @04,GDTTR2(,GDTPTR)                                 1323
         MVC   @TS00001(95),NEWERID2(@04)                          1323
         MVC   OLDERID2(95,@04),@TS00001                           1323
*                      NEWID2='RI30';                              1324
         MVC   NEWID2(4,@04),@CC01195                              1324
*                      CNVRTFLD=SYNUNIT(1:DIGTINDX);               1325
         MVI   CNVRTFLD+1,C' '                                     1325
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1325
         LH    @04,DIGTINDX                                        1325
         LR    @02,@04                                             1325
         BCTR  @02,0                                               1325
         EX    @02,@SM01476                                        1325
*                      CNVRTWRD=''B;                               1326
         SLR   @02,@02                                             1326
         ST    @02,CNVRTWRD                                        1326
*                      SYNUNIT(LENGTH(CNVRTWRD)+1-DIGTINDX:        1327
*                              LENGTH(CNVRTWRD))=CNVRTFLD;         1327
         LCR   @04,@04                                             1327
         AH    @04,@CH00295                                        1327
         LA    @02,SYNUNIT-1(@04)                                  1327
         LCR   @04,@04                                             1327
         AL    @04,@CF00052                                        1327
         EX    @04,@SM01478                                        1327
*                      END;                                        1328
*            END DOGRP90;                                          1329
*                                                                  1329
@RF01321 DS    0H                                                  1329
@RF01320 DS    0H                                                  1330
*        /************************************************************/
*        /*                                                          */
*        /* IF CONVERSION HAS PROCEEDED OKAY TO THIS POINT, THEN     */
*        /* PERFORM FINAL SEMANTIC CHECKING OF THE VALUES AND MOVE   */
*        /* THEM INTO THE FUNCTION DATA TABLE.                       */
*        /*                                                          */
*        /************************************************************/
*        IF RISTATUS=0                                             1330
*          THEN                                                    1330
*                                                                  1330
@RC01233 ICM   @04,3,RISTATUS                                      1330
         BNZ   @RF01330                                            1330
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THAT THE CONVERTED NUMBER DOES NOT EXCEED THE  */
*            /* DESIGNATED VALUE LIMITS FOR THIS PARAMETER.          */
*            /*                                                      */
*            /********************************************************/
*            IF NUMBER=YES                                         1331
*              THEN                                                1331
         LA    @04,12                                              1331
         LR    @02,@04                                             1331
         MH    @02,PARMID                                          1331
         L     @01,WORKPTR                                         1331
         AL    @01,@CF01440                                        1331
         AL    @04,PARMPTR(@02,@01)                                1331
         TM    NUMBER(@04),B'10000000'                             1331
         BNO   @RF01331                                            1331
*                IF CNVRTWRD > HIVALUE    CNVRTWRD < LOWVALUE     1332
*                  THEN                                            1332
*                                                                  1332
         L     @02,CNVRTWRD                                        1332
         C     @02,HIVALUE(,@04)                                   1332
         BH    @RT01332                                            1332
         C     @02,LOWVALUE(,@04)                                  1332
         BNL   @RF01332                                            1332
@RT01332 DS    0H                                                  1333
*                    CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),        1333
*                                ADDR(ERRFIELD));                  1333
*                                                                  1333
         MVC   @AL00001(8),@AL01333                                1333
         LA    @04,ERRFIELD                                        1333
         ST    @04,@AFTEMPS+24                                     1333
         LA    @04,@AFTEMPS+24                                     1333
         ST    @04,@AL00001+8                                      1333
         LA    @01,@AL00001                                        1333
         BAL   @14,ERROR2                                          1333
*                  ELSE                                            1334
*                    IF SCALAR=YES                                 1334
*                      THEN                                        1334
         B     @RC01332                                            1334
@RF01332 LH    @04,PARMID                                          1334
         MH    @04,@CH00038                                        1334
         L     @01,WORKPTR                                         1334
         AL    @01,@CF01440                                        1334
         L     @04,PARMPTR(@04,@01)                                1334
         TM    SCALAR(@04),B'00010000'                             1334
         BNO   @RF01334                                            1334
*                        FULLWORD=CNVRTWRD;                        1335
         L     @04,DATAPTR                                         1335
         MVC   FULLWORD(4,@04),CNVRTWRD                            1335
*                      ELSE                                        1336
*                        DO;                                       1336
         B     @RC01334                                            1336
@RF01334 DS    0H                                                  1337
*                        FULLWDCT=SCLRCNT;                         1337
         LH    @04,SCLRCNT                                         1337
         L     @15,DATAPTR                                         1337
         ST    @04,FULLWDCT(,@15)                                  1337
*                        LFULLWD(SCLRCNT)=CNVRTWRD;                1338
         SLA   @04,2                                               1338
         L     @14,CNVRTWRD                                        1338
         ST    @14,LFULLWD-4(@04,@15)                              1338
*                        END;                                      1339
*                                                                  1339
*              /******************************************************/
*              /*                                                    */
*              /* IF THE CONSTANT CONVERTED WAS A BIT STRING OR HEX  */
*              /* STRING, CHECK THAT THE CONVERTED HEXADECIMAL DIGIT */
*              /* STRING DOES NOT EXCEED THE MAXIMUM SCALAR LENGTH   */
*              /* ALLOWED FOR THIS PARAMETER.  THEN PLACE THE STRING */
*              /* INTO THE FDT.                                      */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1340
*                IF DIGTINDX > MAXLNGTH                            1340
*                  THEN                                            1340
*                                                                  1340
         B     @RC01331                                            1340
@RF01331 LA    @04,12                                              1340
         LR    @02,@04                                             1340
         MH    @02,PARMID                                          1340
         L     @01,WORKPTR                                         1340
         AL    @01,@CF01440                                        1340
         AL    @04,PARMPTR(@02,@01)                                1340
         LH    @02,DIGTINDX                                        1340
         SLR   @15,@15                                             1340
         IC    @15,MAXLNGTH(,@04)                                  1340
         CR    @02,@15                                             1340
         BNH   @RF01340                                            1340
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1341
*                                ADDR(ERRFIELD));                  1341
*                                                                  1341
         MVC   @AL00001(8),@AL01341                                1341
         LA    @04,ERRFIELD                                        1341
         ST    @04,@AFTEMPS+24                                     1341
         LA    @04,@AFTEMPS+24                                     1341
         ST    @04,@AL00001+8                                      1341
         LA    @01,@AL00001                                        1341
         BAL   @14,ERROR2                                          1341
*                  ELSE                                            1342
*                    IF SCALAR=YES                                 1342
*                      THEN                                        1342
         B     @RC01340                                            1342
@RF01340 LA    @04,12                                              1342
         LR    @15,@04                                             1342
         MH    @15,PARMID                                          1342
         L     @01,WORKPTR                                         1342
         AL    @01,@CF01440                                        1342
         L     @15,PARMPTR(@15,@01)                                1342
         TM    SCALAR(@15),B'00010000'                             1342
         BNO   @RF01342                                            1342
*                        DO;                                       1343
*                        STRINGLN=DIGTINDX;                        1344
         L     @14,DATAPTR                                         1344
         MVC   STRINGLN(1,@14),DIGTINDX+1                          1344
*                        WORKPTR3=ADDR(STRING);            /*@YL026UL*/
         LA    @03,STRING(,@14)                                    1345
         ST    @03,WORKPTR3                                        1345
*                        RFY(DATABLK) BASED(WORKPTR3);     /*@YL026UL*/
*                        STRING(1)=BLANK;                  /*@YL026UL*/
         MVI   STRING(@14),C' '                                    1347
*                        IF MAXLNGTH > 1                   /*@ZA14582*/
*                          THEN                            /*@ZA14582*/
         ALR   @15,@04                                             1348
         CLI   MAXLNGTH(@15),1                                     1348
         BNH   @RF01348                                            1348
*                            STRING(2:MAXLNGTH)=                   1349
*                               DATABLK(1:MAXLNGTH-1);     /*@YL026UL*/
         SLR   @04,@04                                             1349
         IC    @04,MAXLNGTH(,@15)                                  1349
         BCTR  @04,0                                               1349
         BCTR  @04,0                                               1349
         EX    @04,@SM01480                                        1349
*                        STRING(1:DIGTINDX)=                       1350
*                                SYNUNIT(1:DIGTINDX);      /*@YL026UL*/
@RF01348 L     @04,DATAPTR                                         1350
         LH    @15,DIGTINDX                                        1350
         BCTR  @15,0                                               1350
         EX    @15,@SM01468                                        1350
*                        END;                                      1351
*                      ELSE                                        1352
*                        DO;                                       1352
         B     @RC01342                                            1352
@RF01342 DS    0H                                                  1353
*                        STRINGCT=SCLRCNT;                         1353
         L     @04,DATAPTR                                         1353
         MVC   STRINGCT(2,@04),SCLRCNT                             1353
*                        WORKPTR3=ADDR(ELTPTR->LSTRING);   /*@YL026UL*/
         L     @04,ELTPTR                                          1354
         LA    @15,LSTRING(,@04)                                   1354
         ST    @15,WORKPTR3                                        1354
*                        ELTPTR->LSTRINGL=DIGTINDX;                1355
         MVC   LSTRINGL(1,@04),DIGTINDX+1                          1355
*                        ELTPTR->LSTRING(1)=BLANK;         /*@YL026UL*/
         MVI   LSTRING(@04),C' '                                   1356
*                        IF MAXLNGTH > 1                   /*@ZA14582*/
*                          THEN                            /*@ZA14582*/
         LA    @14,12                                              1357
         LR    @03,@14                                             1357
         MH    @03,PARMID                                          1357
         L     @01,WORKPTR                                         1357
         AL    @01,@CF01440                                        1357
         AL    @14,PARMPTR(@03,@01)                                1357
         CLI   MAXLNGTH(@14),1                                     1357
         BNH   @RF01357                                            1357
*                            ELTPTR->LSTRING(2:MAXLNGTH)=          1358
*                          WORKPTR3->DATABLK(1:MAXLNGTH-1);/*@YL026UL*/
         SLR   @03,@03                                             1358
         IC    @03,MAXLNGTH(,@14)                                  1358
         BCTR  @03,0                                               1358
         BCTR  @03,0                                               1358
         EX    @03,@SM01482                                        1358
*                        ELTPTR->LSTRING(1:DIGTINDX)=              1359
*                              SYNUNIT(1:DIGTINDX);        /*@YL026UL*/
@RF01357 L     @04,ELTPTR                                          1359
         LH    @15,DIGTINDX                                        1359
         BCTR  @15,0                                               1359
         EX    @15,@SM01472                                        1359
*                        ELTPTR=ELTPTR+SPACEAMT;                   1360
         AH    @04,SPACEAMT                                        1360
         ST    @04,ELTPTR                                          1360
*                        END;                                      1361
*                                                                  1361
*        END CONVERT;                                              1362
@EL00015 DS    0H                                                  1362
@EF00015 DS    0H                                                  1362
@ER00015 LM    @14,@12,@SA00015                                    1362
         BR    @14                                                 1362
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DSIDCHK                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS DSNAME SYNTAX RESTRICTIONS ON    */
*/*             AN EXTRACTED DSNAME ITEM, PARSES OUT THE     @YL026UL*/
*/*             MEMBER NAME (IF PRESENT), AND STORES THE     @YL026UL*/
*/*             NAME(S) INTO THE FDT.                        @YL026UL*/
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR IS DETECTED               */
*/*          SYNUNIT - CONTAINS THE DSNAME TO BE EXAMINED AND STORED */
*/*                    INTO THE FDT.                                 */
*/*          UNITINDX- LENGTH OF THE DSNAME TO BE CHECKED            */
*/*          SCLRCNT - COUNT OF ITEMS FOUND SO FAR IN A SCALAR LIST  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE ENTRY.                              */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*DSIDCHK:PROCEDURE;                                                1363
DSIDCHK  STM   @14,@04,@SA00016                                    1363
         STM   @06,@12,@SA00016+28                                 1363
*        /************************************************************/
*        /*                                                          */
*        /* DSIDCHK DATA DEFINITIONS                                 */
*        /*                                                          */
*        /************************************************************/
*        DCL NATCHAR1 CHAR(1)          /*NATIONAL CHARACTER          */
*                     CONSTANT('@');                               1364
*        DCL NATCHAR2 CHAR(1)          /*NATIONAL CHARACTER          */
*                     CONSTANT('#');                               1365
*        DCL NATCHAR3 CHAR(1)          /*NATIONAL CHARACTER          */
*                     CONSTANT('$');                               1366
*        DCL HYPHEN   CHAR(1)          /*HYPHEN CHARACTER            */
*                     CONSTANT('-');                               1367
*        DCL 1 TWLVZERO CHAR(1) STATIC,/*12-0 PUNCH CODE             */
*              2 * FIXED(8) INIT('C0'X);                           1368
*        DCL PERIOD   CHAR(1)          /*PERIOD CHARACTER            */
*                     CONSTANT('.');                               1369
*        DCL STAR     CHAR(1)          /*ASTERISK CHARACTER  @YL026UL*/
*                     CONSTANT('*');                       /*@YL026UL*/
*                                                                  1370
*        DCL SEGSTART FIXED(15);       /*STARTING POSITION OF A DATA
*                                        SET NAME SEGMENT            */
*        DCL SEGEND   FIXED(15);       /*ENDING POSITION OF A DATA 1372
*                                        SET NAME SEGMENT            */
*        DCL SEGLEN   FIXED(15);       /*LENGTH OF DSNAME    @YL026UL*/
*                                      /* SEGMENT            @YL026UL*/
*        DCL STARLOC  FIXED(8);        /*ASTERISK LOCATION   @YL026UL*/
*                                      /* IN GENERIC DSNAME  @YL026UL*/
*        DCL MEMBIT   BIT(1);          /*SET 'ON' WHEN A     @YL026UL*/
*                                      /* MEMBER NAME IS     @YL026UL*/
*                                      /* BEING CHECKED      @YL026UL*/
*        DCL ONESTAR  BIT(1);          /*SET 'ON' WHEN AN    @YL026UL*/
*                                      /* ASTERISK HAS BEEN  @YL026UL*/
*                                      /* FOUND IN A DSNAME  @YL026UL*/
*        DCL WITHMEM  BIT(1);          /*SET 'ON' WHEN       @YL026UL*/
*                                      /*CHECKING ANY PART   @YL026UL*/
*                                      /*OF A DSNAME THAT    @YL026UL*/
*                                      /*HAS A MEMBER NAME   @YL026UL*/
*        /************************************************************/
*        /*                                                          */
*        /*  ** DSIDCHK **  CHECK DSNAME SYNTAX RESTRICTIONS         */
*        /*                                                          */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1378
         L     @04,GDTTR2(,GDTPTR)                                 1378
         MVC   @TS00001(95),NEWERID2(@04)                          1378
         MVC   OLDERID2(95,@04),@TS00001                           1378
*        NEWID2='RIID';                                            1379
*                                                                  1379
         MVC   NEWID2(4,@04),@CC01221                              1379
*        /************************************************************/
*        /*                                                          */
*        /* IF AN INPUT DSNAME HAS A MEMBER NAME IN PARENS,  @YL026UL*/
*        /* FIRST EXTRACT THE MEMBER NAME, CHECK FOR CORRECT @YL026UL*/
*        /* SYNTAX, AND STORE IT IN THE FDT.                 @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        WITHMEM=NO;                                       /*@YL026UL*/
         NI    WITHMEM,B'01111111'                                 1380
*        MEMBIT=NO;                                        /*@YL026UL*/
         NI    MEMBIT,B'01111111'                                  1381
*        IF UNITINDX > 3  &  SYNUNIT(UNITINDX) = CLOSING           1382
*          THEN                                                    1382
         CH    UNITINDX,@CH00172                                   1382
         BNH   @RF01382                                            1382
         LA    @04,SYNUNIT-1(UNITINDX)                             1382
         CLI   0(@04),C')'                                         1382
         BNE   @RF01382                                            1382
*            DO INDEX2=1 TO UNITINDX WHILE(MEMBIT=NO);     /*@YL026UL*/
*                                                                  1383
         LA    @04,1                                               1383
         B     @DE01383                                            1383
@DL01383 TM    MEMBIT,B'10000000'                                  1383
         BNZ   @DC01383                                            1383
*              IF SYNUNIT(INDEX2)=OPENING                          1384
*                THEN                                              1384
*                                                                  1384
         LA    @02,SYNUNIT-1(@04)                                  1384
         CLI   0(@02),C'('                                         1384
         BNE   @RF01384                                            1384
*                  /**************************************************/
*                  /*                                                */
*                  /* UPON FINDING THE OPENING PARENTHESIS   @YL026UL*/
*                  /* DELIMITING THE MEMBER NAME, THE NAME   @YL026UL*/
*                  /* IS EXTRACTED.                          @YL026UL*/
*                  /*                                                */
*                  /**************************************************/
*DOGRP106:         DO;                                     /*@YL026UL*/
DOGRP106 DS    0H                                                  1386
*                  SEGSTART=INDEX2+1;                      /*@YL026UL*/
         LA    @15,1                                               1386
         LH    SEGSTART,INDEX2                                     1386
         ALR   SEGSTART,@15                                        1386
*                  SEGEND=UNITINDX-1;                      /*@YL026UL*/
         LR    SEGEND,UNITINDX                                     1387
         BCTR  SEGEND,0                                            1387
*                  SEGLEN=SEGEND-SEGSTART+1;               /*@YL026UL*/
         LR    @14,SEGEND                                          1388
         SLR   @14,SEGSTART                                        1388
         ALR   @14,@15                                             1388
         STH   @14,SEGLEN                                          1388
*                  MEMBIT=YES;                             /*@YL026UL*/
         OI    MEMBIT,B'10000000'                                  1389
*                  WITHMEM=YES;                            /*@YL026UL*/
*                                                                  1390
         OI    WITHMEM,B'10000000'                                 1390
*                  CALL NAMESCAN;                          /*@YL026UL*/
*                                                                  1391
         BAL   @14,NAMESCAN                                        1391
*                  /**************************************************/
*                  /*                                                */
*                  /* IF THE MEMBER NAME HAS NO SYNTAX       @YL026UL*/
*                  /* ERROR, STORE IT IN THE FDT.            @YL026UL*/
*                  /*                                                */
*                  /**************************************************/
*                  IF RISTATUS=0                                   1392
*                    THEN                                          1392
         ICM   @05,3,RISTATUS                                      1392
         BNZ   @RF01392                                            1392
*                      IF LIST=YES                                 1393
*                        THEN                                      1393
         LH    @05,PARMID                                          1393
         MH    @05,@CH00038                                        1393
         L     @01,WORKPTR                                         1393
         AL    @01,@CF01440                                        1393
         L     @05,PARMPTR(@05,@01)                                1393
         TM    LIST(@05),B'00001000'                               1393
         BNO   @RF01393                                            1393
*                          DO;                             /*@YL026UL*/
*                          DSNAMECT=SCLRCNT;               /*@YL026UL*/
         LH    @05,SCLRCNT                                         1395
         L     @15,DATAPTR                                         1395
         STH   @05,DSNAMECT(,@15)                                  1395
*                          LMEMNAML(SCLRCNT)=SEGLEN;       /*@YL026UL*/
         MH    @05,@CH01419                                        1396
         LH    @14,SEGLEN                                          1396
         LA    @01,0(@05,@15)                                      1396
         AL    @01,@CF01484                                        1396
         STC   @14,LMEMNAML-13(,@01)                               1396
*                          LMEMNAME(SCLRCNT)=                      1397
*                                SYNUNIT(SEGSTART:SEGEND); /*@YL026UL*/
         ALR   @15,@05                                             1397
         AL    @15,@CF01485                                        1397
         MVI   LMEMNAME-13(@15),C' '                               1397
         MVC   LMEMNAME-12(6,@15),LMEMNAME-13(@15)                 1397
         LR    @05,SEGEND                                          1397
         SLR   @05,SEGSTART                                        1397
         LA    @14,SYNUNIT-1(SEGSTART)                             1397
         EX    @05,@SM01486                                        1397
*                          END;                            /*@YL026UL*/
*                        ELSE                                      1399
*                          DO;                             /*@YL026UL*/
         B     @RC01393                                            1399
@RF01393 DS    0H                                                  1400
*                          MEMNAMLN=SEGLEN;                /*@YL026UL*/
         L     @05,DATAPTR                                         1400
         MVC   MEMNAMLN(1,@05),SEGLEN+1                            1400
*                          MEMNAME=                                1401
*                               SYNUNIT(SEGSTART:SEGEND);  /*@YL026UL*/
         MVI   MEMNAME+1(@05),C' '                                 1401
         MVC   MEMNAME+2(6,@05),MEMNAME+1(@05)                     1401
         LR    @15,SEGEND                                          1401
         SLR   @15,SEGSTART                                        1401
         LA    @01,SYNUNIT-1(SEGSTART)                             1401
         EX    @15,@SM01488                                        1401
*                          END;                            /*@YL026UL*/
*                  UNITINDX=SEGSTART-2;                    /*@YL026UL*/
@RC01393 DS    0H                                                  1403
@RF01392 LR    UNITINDX,SEGSTART                                   1403
         BCTR  UNITINDX,0                                          1403
         BCTR  UNITINDX,0                                          1403
*                  END DOGRP106;                           /*@YL026UL*/
*            END;                                          /*@YL026UL*/
*                                                                  1405
@RF01384 LA    @04,1                                               1405
         AH    @04,INDEX2                                          1405
@DE01383 STH   @04,INDEX2                                          1405
         CR    @04,UNITINDX                                        1405
         BNH   @DL01383                                            1405
@DC01383 DS    0H                                                  1406
*        /************************************************************/
*        /*                                                          */
*        /* THE DSNAME, EXCLUDING THE MEMBER NAME, MUST      @YL026UL*/
*        /* ADHERE TO DSNAME LENGTH LIMITATIONS.             @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF UNITINDX > MAXLNGTH    UNITINDX < 1                   1406
*          THEN                                                    1406
@RF01382 LA    @04,12                                              1406
         LR    @02,@04                                             1406
         MH    @02,PARMID                                          1406
         L     @01,WORKPTR                                         1406
         AL    @01,@CF01440                                        1406
         AL    @04,PARMPTR(@02,@01)                                1406
         SLR   @02,@02                                             1406
         IC    @02,MAXLNGTH(,@04)                                  1406
         CR    UNITINDX,@02                                        1406
         BH    @RT01406                                            1406
         LTR   UNITINDX,UNITINDX                                   1406
         BP    @RF01406                                            1406
@RT01406 DS    0H                                                  1407
*            RISTATUS=BADITEM;                             /*@YL026UL*/
*                                                                  1407
         MVC   RISTATUS(2),@CH00052                                1407
*        /************************************************************/
*        /*                                                          */
*        /* A DSNAME MAY CONSIST OF 1 TO 8-CHAR SEGMENTS,    @YL026UL*/
*        /* SEPARATED BY PERIODS.  EACH SEGMENT IS CHECKED   @YL026UL*/
*        /* FOR SYNTAX ERRORS AFTER THE PERIODS HAVE BEEN    @YL026UL*/
*        /* FOUND WHICH DELIMIT THE SEGMENT.                 @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        STARLOC=0;                                        /*@YL026UL*/
@RF01406 MVI   STARLOC,X'00'                                       1408
*        ONESTAR=NO;                                       /*@YL026UL*/
         NI    ONESTAR,B'01111111'                                 1409
*        SEGEND=-1;                                                1410
         SLR   SEGEND,SEGEND                                       1410
         BCTR  SEGEND,0                                            1410
*        MEMBIT=NO;                                        /*@YL026UL*/
*                                                                  1411
         NI    MEMBIT,B'01111111'                                  1411
*DOLOOP16:DO WHILE(RISTATUS=0 & SEGEND<UNITINDX);                  1412
DOLOOP16 B     @DE01412                                            1412
@DL01412 DS    0H                                                  1413
*          SEGSTART=SEGEND+2;                                      1413
         LA    SEGSTART,2                                          1413
         ALR   SEGSTART,SEGEND                                     1413
*          DO SEGEND=SEGSTART TO UNITINDX                          1414
*                               WHILE(SYNUNIT(SEGEND)^=PERIOD);    1414
         LR    SEGEND,SEGSTART                                     1414
         B     @DE01414                                            1414
@DL01414 LA    @01,SYNUNIT-1(SEGEND)                               1414
         CLI   0(@01),C'.'                                         1414
         BE    @DC01414                                            1414
*          END;                                                    1415
         AL    SEGEND,@CF00228                                     1415
@DE01414 CR    SEGEND,UNITINDX                                     1415
         BNH   @DL01414                                            1415
@DC01414 DS    0H                                                  1416
*          SEGEND=SEGEND-1;                                        1416
         BCTR  SEGEND,0                                            1416
*          SEGLEN=SEGEND-SEGSTART+1;                       /*@YL026UL*/
*                                                                  1417
         LA    @15,1                                               1417
         LR    @14,SEGEND                                          1417
         SLR   @14,SEGSTART                                        1417
         ALR   @14,@15                                             1417
         STH   @14,SEGLEN                                          1417
*          /**********************************************************/
*          /*                                                        */
*          /* IF THIS MAY BE A GENERIC DSNAME, CHECK FOR AN  @YL026UL*/
*          /* ASTERISK, BUT ALLOW JUST ONE OF THEM, IN PLACE @YL026UL*/
*          /* OF A SINGLE DSNAME LEVEL.                      @YL026UL*/
*          /*                                                        */
*          /**********************************************************/
*          IF SYNUNIT(SEGSTART)=STAR                               1418
*            THEN                                                  1418
         LA    @01,SYNUNIT-1(SEGSTART)                             1418
         CLI   0(@01),C'*'                                         1418
         BNE   @RF01418                                            1418
*              IF ONESTAR=NO & GENERIC=YES & SEGLEN=1 & SEGSTART^=1
*                THEN                                              1419
         TM    ONESTAR,B'10000000'                                 1419
         BNZ   @RF01419                                            1419
         LA    @01,12                                              1419
         LR    @00,@01                                             1419
         MH    @00,PARMID                                          1419
         L     @15,WORKPTR                                         1419
         LR    @14,@00                                             1419
         AL    @15,@CF01440                                        1419
         AL    @01,PARMPTR(@14,@15)                                1419
         TM    GENERIC(@01),B'00010000'                            1419
         BNO   @RF01419                                            1419
         LH    @15,SEGLEN                                          1419
         LA    @14,1                                               1419
         CR    @15,@14                                             1419
         BNE   @RF01419                                            1419
         CR    SEGSTART,@14                                        1419
         BE    @RF01419                                            1419
*                  DO;                                     /*@YL026UL*/
*                  ONESTAR=YES;                            /*@YL026UL*/
         OI    ONESTAR,B'10000000'                                 1421
*                  STARLOC=SEGSTART;                       /*@YL026UL*/
         STC   SEGSTART,STARLOC                                    1422
*                  END;                                    /*@YL026UL*/
*                ELSE                                              1424
*                  RISTATUS=BADITEM;                       /*@YL026UL*/
         B     @RC01419                                            1424
@RF01419 MVC   RISTATUS(2),@CH00052                                1424
*            ELSE                                                  1425
*                                                                  1425
*              CALL NAMESCAN;                              /*@YL026UL*/
*                                                                  1425
         B     @RC01418                                            1425
@RF01418 BAL   @14,NAMESCAN                                        1425
*        END DOLOOP16;                                     /*@YL026UL*/
*                                                                  1426
@RC01418 DS    0H                                                  1426
@DE01412 ICM   @02,3,RISTATUS                                      1426
         BNZ   @DC01412                                            1426
         CR    SEGEND,UNITINDX                                     1426
         BL    @DL01412                                            1426
@DC01412 DS    0H                                                  1427
*        /************************************************************/
*        /*                                                          */
*        /* IF THE DSNAME IS SYNTACTICALLY PROPER, STORE IT IN THE   */
*        /* FDT--OTHERWISE, PRINT AN ERROR MESSAGE.                  */
*        /*                                                          */
*        /************************************************************/
*        IF RISTATUS=0                                             1427
*          THEN                                                    1427
         ICM   @04,3,RISTATUS                                      1427
         BNZ   @RF01427                                            1427
*            IF LIST=YES                                           1428
*              THEN                                                1428
         LH    @04,PARMID                                          1428
         MH    @04,@CH00038                                        1428
         L     @01,WORKPTR                                         1428
         AL    @01,@CF01440                                        1428
         L     @04,PARMPTR(@04,@01)                                1428
         TM    LIST(@04),B'00001000'                               1428
         BNO   @RF01428                                            1428
*                DO;                                       /*@YL026UL*/
*                DSNAMECT=SCLRCNT;                         /*@YL026UL*/
         LH    @04,SCLRCNT                                         1430
         L     @15,DATAPTR                                         1430
         STH   @04,DSNAMECT(,@15)                                  1430
*                LSTARPOS(SCLRCNT)=STARLOC;                /*@YL026UL*/
         MH    @04,@CH01419                                        1431
         SLR   @14,@14                                             1431
         IC    @14,STARLOC                                         1431
         LA    @01,0(@04,@15)                                      1431
         AL    @01,@CF01490                                        1431
         STC   @14,LSTARPOS-11(,@01)                               1431
*                LDSNAMEL(SCLRCNT)=UNITINDX;               /*@YL026UL*/
         LA    @01,0(@04,@15)                                      1432
         AL    @01,@CF01491                                        1432
         STC   UNITINDX,LDSNAMEL-22(,@01)                          1432
*                LDSNAME(SCLRCNT)=SYNUNIT(1:UNITINDX);     /*@YL026UL*/
         ALR   @15,@04                                             1433
         AL    @15,@CF01492                                        1433
         MVI   LDSNAME-22(@15),C' '                                1433
         MVC   LDSNAME-21(42,@15),LDSNAME-22(@15)                  1433
         LR    @04,UNITINDX                                        1433
         BCTR  @04,0                                               1433
         EX    @04,@SM01493                                        1433
*                END;                                      /*@YL026UL*/
*              ELSE                                                1435
*                DO;                                       /*@YL026UL*/
         B     @RC01428                                            1435
@RF01428 DS    0H                                                  1436
*                DSNAMELN=UNITINDX;                        /*@YL026UL*/
         L     @04,DATAPTR                                         1436
         STC   UNITINDX,DSNAMELN(,@04)                             1436
*                STARPOS=STARLOC;                          /*@YL026UL*/
         MVC   STARPOS(1,@04),STARLOC                              1437
*                DSNAME=SYNUNIT(1:UNITINDX);               /*@YL026UL*/
         MVI   DSNAME+1(@04),C' '                                  1438
         MVC   DSNAME+2(42,@04),DSNAME+1(@04)                      1438
         LR    @15,UNITINDX                                        1438
         BCTR  @15,0                                               1438
         EX    @15,@SM01495                                        1438
*                END;                                      /*@YL026UL*/
*          ELSE                                                    1440
*                                                                  1440
*            CALL ERROR2(BADITEM,LENGTH(ERRFIELD),                 1440
*                                    ADDR(ERRFIELD));      /*@YL026UL*/
         B     @RC01427                                            1440
@RF01427 MVC   @AL00001(8),@AL01440                                1440
         LA    @04,ERRFIELD                                        1440
         ST    @04,@AFTEMPS+28                                     1440
         LA    @04,@AFTEMPS+28                                     1440
         ST    @04,@AL00001+8                                      1440
         LA    @01,@AL00001                                        1440
         BAL   @14,ERROR2                                          1440
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NAMESCAN                               @YL026UL*/
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS THAT DSNAME SEGMENTS AND @YL026UL*/
*/*             MEMBER NAMES ADHERE TO RESTRICTIONS UPON     @YL026UL*/
*/*             LENGTH AND VALID CHARACTERS.                 @YL026UL*/
*/*                                                                  */
*/*  INPUT -                                                 @YL026UL*/
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND          @YL026UL*/
*/*          SYNUNIT  - CONTAINS THE SEGMENT OF CHARACTERS   @YL026UL*/
*/*                     TO BE CHECKED FOR VALIDITY           @YL026UL*/
*/*          SEGSTART - THE POSITION OF THE 1ST SEGMENT CHAR @YL026UL*/
*/*          SEGEND -   THE POSITION OF THE 2ND SEGMENT CHAR @YL026UL*/
*/*          SEGLEN -   LENGTH OF SEGMENT TO BE CHECKED      @YL026UL*/
*/*          MEMBIT -   SET 'ON' IF A MEMBER NAME IS BEING   @YL026UL*/
*/*                     CHECKED.                             @YL026UL*/
*/*                                                                  */
*/*  OUTPUT -                                                @YL026UL*/
*/*          RISTATUS - SET TO A NON-ZERO ERROR ID IF NAME   @YL026UL*/
*/*                     DOES NOT MEET SYNTAX REQUIREMENTS    @YL026UL*/
*/*                                                                  */
*/********************************************************************/
*NAMESCAN:PROCEDURE;                                       /*@YL026UL*/
         B     @PB00017                                            1441
NAMESCAN STM   @14,@12,@SA00017                                    1441
*        /************************************************************/
*        /*                                                          */
*        /*  ** NAMESCAN **  CHECK NAME SEGMENT SYNTAX       @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1442
*          THEN;                                                   1442
         ICM   @15,15,GDTDBG(GDTPTR)                               1442
         BZ    @RT01442                                            1442
*          ELSE                                                    1444
*            CALL IDCDB010(GDTTBL,'RINS');                         1444
         ST    GDTPTR,@AL00001                                     1444
         LA    @15,@CC01230                                        1444
         ST    @15,@AL00001+4                                      1444
         MVI   @AL00001+4,X'80'                                    1444
         L     @15,GDTDBG(,GDTPTR)                                 1444
         LA    @01,@AL00001                                        1444
         BALR  @14,@15                                             1444
*                                                          /*@YL026UL*/
*                                                                  1445
*        /************************************************************/
*        /*                                                          */
*        /* IF THE SETMENT IS LESS THAN 1 OR GREATER THAN    @YL026UL*/
*        /* 8 CHARACTERS LONG OR IF THE BEGINNING CHARACTER  @YL026UL*/
*        /* OR THE SEGMENT IS NOT AN ALPHABETIC OR NATIONAL  @YL026UL*/
*        /* CHARACTER (OR NOT A DECIMAL DIGIT IF THIS 'NAME' @YL026UL*/
*        /* MAY ACTUALLY BE A VOLUME SERIAL NUMBER), THEN    @YL026UL*/
*        /* THE DSNAME IS IN ERROR.                          @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF SEGLEN >= 1  &  SEGLEN <= 8  &                         1445
*           (SYNUNIT(SEGSTART)>='A' & SYNUNIT(SEGSTART)<='Z'      1445
*            SYNUNIT(SEGSTART)=NATCHAR1                           1445
*            SYNUNIT(SEGSTART)=NATCHAR2                           1445
*            SYNUNIT(SEGSTART)=NATCHAR3)                           1445
*          THEN                                                    1445
*                                                                  1445
@RT01442 LH    @15,SEGLEN                                          1445
         CH    @15,@CH00228                                        1445
         BL    @RF01445                                            1445
         CH    @15,@CH00042                                        1445
         BH    @RF01445                                            1445
         LA    @01,SYNUNIT-1(SEGSTART)                             1445
         CLI   0(@01),C'A'                                         1445
         BL    @GL00072                                            1445
         LA    @01,SYNUNIT-1(SEGSTART)                             1445
         CLI   0(@01),C'Z'                                         1445
         BNH   @RT01445                                            1445
@GL00072 LA    @01,SYNUNIT-1(SEGSTART)                             1445
         CLI   0(@01),C'@'                                         1445
         BE    @RT01445                                            1445
         LA    @01,SYNUNIT-1(SEGSTART)                             1445
         CLI   0(@01),C'#'                                         1445
         BE    @RT01445                                            1445
         LA    @01,SYNUNIT-1(SEGSTART)                             1445
         CLI   0(@01),C'$'                                         1445
         BNE   @RF01445                                            1445
@RT01445 DS    0H                                                  1446
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THAT THE REMAINING CHARACTERS IN THE   @YL026UL*/
*            /* SEGMENT ARE ALPHABETIC OR NATIONAL CHAR'S    @YL026UL*/
*            /* (OR HYPHEN OR TWELVE-ZERO CODE IF THE        @YL026UL*/
*            /* SEGMENT IS NOT A MEMBER NAME).               @YL026UL*/
*            /*                                                      */
*            /********************************************************/
*            DO INDEX2=SEGSTART+1 TO SEGEND;               /*@YL026UL*/
         LA    @15,1                                               1446
         ALR   @15,SEGSTART                                        1446
         B     @DE01446                                            1446
@DL01446 DS    0H                                                  1447
*              IF SYNUNIT(INDEX2) >= 'A'  &  SYNUNIT(INDEX2) <= 'Z'  
*                 SYNUNIT(INDEX2) >= '0'  &  SYNUNIT(INDEX2) <= '9'  
*                 SYNUNIT(INDEX2)=NATCHAR1                        1447
*                 SYNUNIT(INDEX2)=NATCHAR2                        1447
*                 SYNUNIT(INDEX2)=NATCHAR3                        1447
*                 MEMBIT=NO & (SYNUNIT(INDEX2)=HYPHEN             1447
*                              SYNUNIT(INDEX2)=TWLVZERO)           1447
*                THEN;                                     /*@YL026UL*/
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'A'                                         1447
         BL    @GL00078                                            1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'Z'                                         1447
         BNH   @RT01447                                            1447
@GL00078 LH    @15,INDEX2                                          1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'0'                                         1447
         BL    @GL00077                                            1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'9'                                         1447
         BNH   @RT01447                                            1447
@GL00077 LH    @15,INDEX2                                          1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'@'                                         1447
         BE    @RT01447                                            1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'#'                                         1447
         BE    @RT01447                                            1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'$'                                         1447
         BE    @RT01447                                            1447
         TM    MEMBIT,B'10000000'                                  1447
         BNZ   @RF01447                                            1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLI   0(@14),C'-'                                         1447
         BE    @RT01447                                            1447
         LA    @14,SYNUNIT-1(@15)                                  1447
         CLC   0(1,@14),TWLVZERO                                   1447
         BE    @RT01447                                            1447
*                ELSE                                              1449
*                  RISTATUS=BADITEM;                       /*@YL026UL*/
@RF01447 MVC   RISTATUS(2),@CH00052                                1449
*            END;                                          /*@YL026UL*/
@RT01447 LA    @15,1                                               1450
         AH    @15,INDEX2                                          1450
@DE01446 STH   @15,INDEX2                                          1450
         CR    @15,SEGEND                                          1450
         BNH   @DL01446                                            1450
*          ELSE                                                    1451
*            RISTATUS=BADITEM;                             /*@YL026UL*/
*                                                                  1451
         B     @RC01445                                            1451
@RF01445 MVC   RISTATUS(2),@CH00052                                1451
*        /************************************************************/
*        /*                                                  @YL026UL*/
*        /* IF THE NAME MAY BE A VOLUME SERIAL NUMBER, THEN  @YL026UL*/
*        /* ALLOW ANY CHARACTERS IN THE NAME.                @YL026UL*/
*        /*                                                  @YL026UL*/
*        /************************************************************/
*        IF VOLID=YES  &  UNITINDX <= 6  &  WITHMEM=NO             1452
*          THEN                                                    1452
@RC01445 LA    @15,12                                              1452
         LR    @14,@15                                             1452
         MH    @14,PARMID                                          1452
         L     @01,WORKPTR                                         1452
         AL    @01,@CF01440                                        1452
         AL    @15,PARMPTR(@14,@01)                                1452
         TM    VOLID(@15),B'00001000'                              1452
         BNO   @RF01452                                            1452
         CH    UNITINDX,@CH00166                                   1452
         BH    @RF01452                                            1452
         TM    WITHMEM,B'10000000'                                 1452
         BNZ   @RF01452                                            1452
*            RISTATUS=0;                                   /*@YL026UL*/
*                                                                  1453
         SLR   @15,@15                                             1453
         STH   @15,RISTATUS                                        1453
*        END NAMESCAN;                                     /*@YL026UL*/
*                                                                  1454
*                                                                  1454
@EL00017 DS    0H                                                  1454
@EF00017 DS    0H                                                  1454
@ER00017 LM    @14,@12,@SA00017                                    1454
         BR    @14                                                 1454
*        END DSIDCHK;                                              1455
@EL00016 DS    0H                                                  1455
@EF00016 DS    0H                                                  1455
@ER00016 LM    @14,@04,@SA00016                                    1455
         LM    @06,@12,@SA00016+28                                 1455
         BR    @14                                                 1455
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETSPACE                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE ALLOCATES SPACE FOR FUNCTION DATA       */
*/*             TABLE (FDT) SCALAR DATA STRUCTURES, BASED UPON THE   */
*/*             DATA TYPE AND DATA LIMITS SPECIFIED FOR THE PARAMETER*/
*/*             BEING HANDLED.  THESE VALUES ARE TAKEN FROM THE      */
*/*             COMMAND DESCRIPTOR.                                  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          PARMID -  PARAMETER ID# OF CURRENT PARAMETER            */
*/*          BLKLEFT - AMOUNT OF SPACE REMAINING IN LARGE BLOCK OF   */
*/*                    STORAGE FROM WHICH SPACE FOR SCALAR DATA      */
*/*                    STRUCTURES ARE ALLOCATED.                     */
*/*          BLKPTR -  POINTER TO NEXT UNUSED AREA WHICH MAY BE      */
*/*                    ALLOCATED FROM LARGE STORAGE AREA.            */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */
*/*          SPACEAMT- AMOUNT OF STORAGE SPACE REQUIRED FOR STORAGE  */
*/*                    OF A SINGLE SCALAR ITEM (AND ASSOCIATED ITEMS */
*/*                    LIKE PASSWORD, LENGTH FIELDS, ETC)            */
*/*          AMTTOGET- AMOUNT OF SPACE TO ALLOCATE FOR THE ENTIRE    */
*/*                    SCALAR DATA STRUCTURE                         */
*/*          BLKLEFT - SEE 'INPUT'                                   */
*/*          DATAPTR - POINTER TO CURRENT SCALAR DATA STRUCTURE      */
*/*          BLKPTR -  SEE 'INPUT'                                   */
*/*          FDTPTR -  POINTER IN FDT USED FOR INDEXING TO THE SCALAR*/
*/*                    DATA IN THE STRUCTURES BEING BUILT.           */
*/*          ARRYPTR - POINTER TO INTERMEDIATE PTR VECTOR WHICH THEN */
*/*                    POINTS TO THE SCALAR DATA STRUCTURE           */
*/*          PTRLOC -  LOCATION OF FDT POINTER WHICH POINTS TO THE   */
*/*                    SCALAR DATA STRUCTURE FOR A SCALAR LIST       */
*/*                                                                  */
*/********************************************************************/
*GETSPACE:PROCEDURE;                                               1456
GETSPACE STM   @14,@12,@SA00018                                    1456
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETSPACE **  ALLOCATE SPACE FOR FDT DATA ELEMENTS    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1457
*        /************************************************************/
*        /*                                                          */
*        /* COMPUTE THE SPACE REQUIRED FOR EACH SCALAR AND ITS       */
*        /* ASSOCIATED DATA ITEMS (COUNT, LENGTH, ETC.)              */
*        /*                                                          */
*        /************************************************************/
*        IF NUMBER=YES                                             1457
*          THEN                                                    1457
         LA    @02,12                                              1457
         LR    @15,@02                                             1457
         MH    @15,PARMID                                          1457
         L     @01,WORKPTR                                         1457
         AL    @01,@CF01440                                        1457
         AL    @02,PARMPTR(@15,@01)                                1457
         TM    NUMBER(@02),B'10000000'                             1457
         BNO   @RF01457                                            1457
*            SPACEAMT=0;                                           1458
         SLR   @02,@02                                             1458
         STH   @02,SPACEAMT                                        1458
*          ELSE                                                    1459
*            IF DSNAM=YES                                          1459
*              THEN                                                1459
         B     @RC01457                                            1459
@RF01457 LA    @02,12                                              1459
         LR    @15,@02                                             1459
         MH    @15,PARMID                                          1459
         L     @01,WORKPTR                                         1459
         AL    @01,@CF01440                                        1459
         AL    @02,PARMPTR(@15,@01)                                1459
         TM    DSNAM(@02),B'00100000'                              1459
         BNO   @RF01459                                            1459
*                SPACEAMT=LENGTH(PASSWORD)+LENGTH(MEMNAME)+        1460
*                         5*LENGTH(DSNAMELN);              /*@YL026UL*/
         MVC   SPACEAMT(2),@CH00813                                1460
*              ELSE                                                1461
*                DO;                                               1461
         B     @RC01459                                            1461
@RF01459 DS    0H                                                  1462
*                SPACEAMT=LENGTH(CHARLN);                          1462
         LA    @02,1                                               1462
         STH   @02,SPACEAMT                                        1462
*                IF PWORDOPT=YES                           /*@YL026UL*/
*                  THEN                                            1463
         LA    @15,12                                              1463
         LR    @14,@15                                             1463
         MH    @14,PARMID                                          1463
         L     @01,WORKPTR                                         1463
         AL    @01,@CF01440                                        1463
         AL    @15,PARMPTR(@14,@01)                                1463
         TM    PWORDOPT(@15),B'00000010'                           1463
         BNO   @RF01463                                            1463
*                    SPACEAMT=SPACEAMT+LENGTH(PASSWORD)+LENGTH(CHARLN);
         LA    @02,9(,@02)                                         1464
         STH   @02,SPACEAMT                                        1464
*                END;                                              1465
@RF01463 DS    0H                                                  1466
*        SPACEAMT=SPACEAMT+MAXLNGTH;                               1466
@RC01459 DS    0H                                                  1466
@RC01457 LA    @02,12                                              1466
         LR    @15,@02                                             1466
         MH    @15,PARMID                                          1466
         L     @01,WORKPTR                                         1466
         AL    @01,@CF01440                                        1466
         L     @15,PARMPTR(@15,@01)                                1466
         ALR   @02,@15                                             1466
         SLR   @14,@14                                             1466
         IC    @14,MAXLNGTH(,@02)                                  1466
         AH    @14,SPACEAMT                                        1466
         STH   @14,SPACEAMT                                        1466
*        IF LIST=YES                                               1467
*          THEN                                                    1467
         TM    LIST(@15),B'00001000'                               1467
         BNO   @RF01467                                            1467
*            DO;                                                   1468
*            IF SPACEAMT//2 ^= 0                                   1469
*              THEN                                                1469
         LR    @00,@14                                             1469
         SRDA  @00,32                                              1469
         D     @00,@CF00163                                        1469
         LTR   @00,@00                                             1469
         BZ    @RF01469                                            1469
*                SPACEAMT=SPACEAMT+1;                              1470
         LA    @14,1(,@14)                                         1470
         STH   @14,SPACEAMT                                        1470
*            AMTTOGET=SPACEAMT*MIN(4,LISTMAX)+FULLNGTH;            1471
*                                                                  1471
@RF01469 LA    @02,4                                               1471
         LA    @15,12                                              1471
         LR    @14,@15                                             1471
         MH    @14,PARMID                                          1471
         L     @01,WORKPTR                                         1471
         AL    @01,@CF01440                                        1471
         AL    @15,PARMPTR(@14,@01)                                1471
         SLR   @01,@01                                             1471
         IC    @01,LISTMAX(,@15)                                   1471
         CR    @01,@02                                             1471
         BNH   *+6
         LR    @01,@02                                             1471
         MH    @01,SPACEAMT                                        1471
         ALR   @01,@02                                             1471
         ST    @01,AMTTOGET                                        1471
*            /********************************************************/
*            /*                                                      */
*            /* REQUEST SPACE FOR THE SCALAR LIST DATA STRUCTURE.    */
*            /* SPACE IS OBTAINED EACH TIME A SCALAR LIST IS THE     */
*            /* VALUE OF THE PARAMETER BEING SCANNED.                */
*            /*                                                      */
*            /********************************************************/
*            CALL IDCSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);
         ST    GDTPTR,@AL00001                                     1472
         LA    @02,AMTTOGET                                        1472
         ST    @02,@AL00001+4                                      1472
         LA    @02,DATAPTR                                         1472
         ST    @02,@AL00001+8                                      1472
         LA    @02,POOLID                                          1472
         ST    @02,@AL00001+12                                     1472
         LA    @02,SETZERO                                         1472
         ST    @02,@AL00001+16                                     1472
         MVI   @AL00001+16,X'80'                                   1472
         L     @15,GDTGPL(,GDTPTR)                                 1472
         LA    @01,@AL00001                                        1472
         BALR  @14,@15                                             1472
*            RESPECIFY RTNREG RSTD;                                1473
*            TESTRC = RTNREG;                                      1474
         STH   RTNREG,TESTRC                                       1474
*            RESPECIFY RTNREG UNRSTD;                              1475
*                                                                  1475
*            END;                                                  1476
*                                                                  1476
*          /**********************************************************/
*          /*                                                        */
*          /* SPACE FOR SCALAR (NOT SCALAR LIST) DATA STRUCTURES IS  */
*          /* ALLOCATED FROM A LARGE BLOCK OF SPACE ALREADY OBTAINED,*/
*          /* RATHER THAN ISSUING A 'GET SPACE' REQUEST FOR EACH     */
*          /* STRUCTURE.  IF SPACE IN THE BLOCK HAS ALL BEEN USED,   */
*          /* ANOTHER LARGE BLOCK IS OBTAINED.                       */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    1477
*            DO;                                                   1477
         B     @RC01467                                            1477
@RF01467 DS    0H                                                  1478
*            IF BLKLEFT-SPACEAMT < 0                               1478
*              THEN                                                1478
         L     @02,BLKLEFT                                         1478
         SH    @02,SPACEAMT                                        1478
         LTR   @02,@02                                             1478
         BNM   @RF01478                                            1478
*                DO;                                               1479
*                BLKLEFT='400'X;                                   1480
*                                                                  1480
         LA    @02,1024                                            1480
         ST    @02,BLKLEFT                                         1480
*                CALL IDCSAGP0(GDTTBL,BLKLEFT,BLKPTR,POOLID,SETZERO);
         ST    GDTPTR,@AL00001                                     1481
         LA    @02,BLKLEFT                                         1481
         ST    @02,@AL00001+4                                      1481
         LA    @02,BLKPTR                                          1481
         ST    @02,@AL00001+8                                      1481
         LA    @02,POOLID                                          1481
         ST    @02,@AL00001+12                                     1481
         LA    @02,SETZERO                                         1481
         ST    @02,@AL00001+16                                     1481
         MVI   @AL00001+16,X'80'                                   1481
         L     @15,GDTGPL(,GDTPTR)                                 1481
         LA    @01,@AL00001                                        1481
         BALR  @14,@15                                             1481
*                RESPECIFY RTNREG RSTD;                            1482
*                TESTRC = RTNREG;                                  1483
         STH   RTNREG,TESTRC                                       1483
*                RESPECIFY RTNREG UNRSTD;                          1484
*                                                                  1484
*                END;                                              1485
*              ELSE                                                1486
*                TESTRC=0;                                         1486
         B     @RC01478                                            1486
@RF01478 SLR   @02,@02                                             1486
         STH   @02,TESTRC                                          1486
*            DATAPTR=BLKPTR;                                       1487
@RC01478 L     @02,BLKPTR                                          1487
         ST    @02,DATAPTR                                         1487
*            BLKPTR=BLKPTR+SPACEAMT+(FULLNGTH-SPACEAMT//FULLNGTH); 1488
         LH    @15,SPACEAMT                                        1488
         LR    @14,@02                                             1488
         ALR   @14,@15                                             1488
         LR    @00,@15                                             1488
         SRDA  @00,32                                              1488
         D     @00,@CF00052                                        1488
         LCR   @00,@00                                             1488
         AL    @00,@CF00052                                        1488
         ALR   @14,@00                                             1488
         ST    @14,BLKPTR                                          1488
*            BLKLEFT=BLKLEFT-(BLKPTR-DATAPTR);                     1489
         SLR   @02,@14                                             1489
         AL    @02,BLKLEFT                                         1489
         ST    @02,BLKLEFT                                         1489
*            END;                                                  1490
*                                                                  1490
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THAT THE SPACE WAS ALLOCATED PROPERLY, THEN STORE  */
*        /* THE AREA PTR IN THE FDT.  IF THE SCALAR IS ASSOCIATED    */
*        /* WITH A PARAMETER IN A REPEATED LIST, CALCULATE THE FDT   */
*        /* LOCATION OF THE POINTER WHERE THE SPACE ADDRESS IS TO BE */
*        /* STORED.                                                  */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC ^= 0                                            1491
*          THEN                                                    1491
*                                                                  1491
@RC01467 ICM   @02,3,TESTRC                                        1491
         BZ    @RF01491                                            1491
*            CALL ERROR1(NOSPACE);                                 1492
*                                                                  1492
         LA    @01,@AL01492                                        1492
         BAL   @14,ERROR1                                          1492
*          ELSE                                                    1493
*            IF OCCURNUM < 2                                       1493
*              THEN                                                1493
         B     @RC01491                                            1493
@RF01491 LH    @02,PARMID                                          1493
         LR    @15,@02                                             1493
         MH    @15,@CH00038                                        1493
         L     @01,WORKPTR                                         1493
         AL    @01,@CF01440                                        1493
         L     @01,PARMPTR(@15,@01)                                1493
         CLC   OCCURNUM(3,@01),@CF00163+1                          1493
         BNL   @RF01493                                            1493
*                FDTPTR(PARMID)=DATAPTR;                           1494
         SLA   @02,2                                               1494
         L     @15,DATAPTR                                         1494
         L     @14,FDTADDR                                         1494
         ST    @15,FDTPTR-4(@02,@14)                               1494
*              ELSE                                                1495
*                DO;                                               1495
         B     @RC01493                                            1495
@RF01493 DS    0H                                                  1496
*                ARRYPTR=FDTPTR(PARMID);                           1496
*                                                                  1496
         LH    @05,PARMID                                          1496
         SLA   @05,2                                               1496
         L     @01,FDTADDR                                         1496
         L     ARRYPTR,FDTPTR-4(@05,@01)                           1496
*                CALL DSPLCALC(REPDEPTH);                          1497
*                                                                  1497
         LA    @05,REPDEPTH                                        1497
         ST    @05,@AL00001                                        1497
         LA    @01,@AL00001                                        1497
         BAL   @14,DSPLCALC                                        1497
*                REPPTR=DATAPTR;                                   1498
         LR    @05,ARRYPTR                                         1498
         ALR   @05,ARRYDSPL                                        1498
         MVC   REPPTR(4,@05),DATAPTR                               1498
*                IF LIST=YES                                       1499
*                  THEN                                            1499
         LH    @15,PARMID                                          1499
         MH    @15,@CH00038                                        1499
         L     @01,WORKPTR                                         1499
         AL    @01,@CF01440                                        1499
         L     @01,PARMPTR(@15,@01)                                1499
         TM    LIST(@01),B'00001000'                               1499
         BNO   @RF01499                                            1499
*                    PTRLOC=ADDR(REPPTR);                          1500
         ST    @05,PTRLOC                                          1500
*                END;                                              1501
@RF01499 DS    0H                                                  1502
*        SPACELFT=AMTTOGET-FULLNGTH-SPACEAMT;                      1502
*                                                                  1502
@RC01493 DS    0H                                                  1502
@RC01491 L     @02,AMTTOGET                                        1502
         SL    @02,@CF00052                                        1502
         SH    @02,SPACEAMT                                        1502
         STH   @02,SPACELFT                                        1502
*        END GETSPACE;                                             1503
@EL00018 DS    0H                                                  1503
@EF00018 DS    0H                                                  1503
@ER00018 LM    @14,@12,@SA00018                                    1503
         BR    @14                                                 1503
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MORSPACE                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE ALLOCATES ADDITIONAL SPACE FOR AN FDT   */
*/*             SCALAR LIST DATA STRUCTURE.                          */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          AMTTOGET- AMOUNT OF SPACE LAST ALLOCATED FOR THIS       */
*/*                    SCALAR LIST DATA STRUCTURE                    */
*/*          SPACELFT- UNUSED SPACE REMAINING FROM LAST ALLOCATION   */
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH LIST ELEMENT*/
*/*                    IN THE DATA STRUCTURE                         */
*/*          DATAPTR - POINTER TO CURRENT DATA STRUCTURE LOCATION    */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */
*/*          AMTTOGET- NEW AMOUNT OF SPACE TO BE ALLOCATED, WHICH    */
*/*                    ALLOWS FOR LARGER SCALAR LIST DATA STRUCTURE  */
*/*          LISTADDR- LOCATION OF NEW BLOCK OF SPACE                */
*/*          SPACELFT- AMOUNT OF SPACE REMAINING IN NEW STORAGE BLOCK*/
*/*                                                                  */
*/********************************************************************/
*MORSPACE:PROCEDURE;                                               1504
MORSPACE STM   @14,@12,@SA00019                                    1504
*        /************************************************************/
*        /*                                                          */
*        /* 'MORSPACE' ROUTINE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1505
*        DCL OLDPTR   PTR(31);         /*PTR TO DATA TO BE MOVED FROM
*                                        DATA BLK THAT WAS TOO SMALL */
*        DCL FREEPTR  PTR(31);         /*PTR TO OLD BLOCK OF SPACE 1506
*                                        TO BE FREED UP AFTER ITS  1506
*                                        DATA HAS BEEN COPIED.       */
*        DCL NEWPTR   PTR(31);         /*PTR TO NEWLY ALLOCATED,   1507
*                                        LARGER DATA BLOCK           */
*        DCL MOVELEN  FIXED(15);       /*AMOUNT OF DATA TO BE MOVED
*                                        IN A SINGLE DATA MOVE       */
*        DCL AMTUSED  FIXED(15);       /*AMOUNT OF OLD DATA BLOCK THAT
*                                        WAS 'STORED INTO' BEFORE  1509
*                                        SPACE RAN OUT.              */
*        /************************************************************/
*        /*                                                          */
*        /*  ** MORSPACE **  ALLOCATE MORE SPACE FOR FDT DATA        */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1510
*          THEN;                                                   1510
         ICM   @02,15,GDTDBG(GDTPTR)                               1510
         BZ    @RT01510                                            1510
*          ELSE                                                    1512
*            CALL IDCDB010(GDTTBL,'RIMC');                         1512
*                                                                  1512
         ST    GDTPTR,@AL00001                                     1512
         LA    @02,@CC01244                                        1512
         ST    @02,@AL00001+4                                      1512
         MVI   @AL00001+4,X'80'                                    1512
         L     @15,GDTDBG(,GDTPTR)                                 1512
         LA    @01,@AL00001                                        1512
         BALR  @14,@15                                             1512
*        /************************************************************/
*        /*                                                          */
*        /* COMPUTE AMOUNT OF SPACE USED IN OLD DATA BLOCK AND SIZE  */
*        /* OF THE NEW, LARGER BLOCK TO BE OBTAINED.                 */
*        /*                                                          */
*        /************************************************************/
*        AMTUSED=AMTTOGET-SPACELFT-SPACEAMT;                       1513
@RT01510 LH    @02,SPACEAMT                                        1513
         L     @15,AMTTOGET                                        1513
         LR    AMTUSED,@15                                         1513
         SH    AMTUSED,SPACELFT                                    1513
         SLR   AMTUSED,@02                                         1513
*        OLDPTR=DATAPTR;                                           1514
         L     @05,DATAPTR                                         1514
         ST    @05,OLDPTR                                          1514
*        FREEPTR=DATAPTR;                                          1515
         ST    @05,FREEPTR                                         1515
*        AMTTOGET=AMTTOGET+SPACEAMT*2;                             1516
*                                                                  1516
         ALR   @02,@02                                             1516
         ALR   @15,@02                                             1516
         ST    @15,AMTTOGET                                        1516
*        /************************************************************/
*        /*                                                          */
*        /* REQUEST THE DESIRED SPACE.  IF OBTAINED OKAY, SET UP     */
*        /* POINTER TO THE AREA.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1517
*        CALL IDCSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);    1517
         ST    GDTPTR,@AL00001                                     1517
         LA    @05,AMTTOGET                                        1517
         ST    @05,@AL00001+4                                      1517
         LA    @05,DATAPTR                                         1517
         ST    @05,@AL00001+8                                      1517
         LA    @05,POOLID                                          1517
         ST    @05,@AL00001+12                                     1517
         LA    @05,SETZERO                                         1517
         ST    @05,@AL00001+16                                     1517
         MVI   @AL00001+16,X'80'                                   1517
         L     @15,GDTGPL(,GDTPTR)                                 1517
         LA    @01,@AL00001                                        1517
         BALR  @14,@15                                             1517
*        RESPECIFY RTNREG RSTD;                                    1518
*        TESTRC = RTNREG;                                          1519
         STH   RTNREG,TESTRC                                       1519
*        RESPECIFY RTNREG UNRSTD;                                  1520
*                                                                  1520
*        IF TESTRC ^= 0                                            1521
*          THEN                                                    1521
*                                                                  1521
         LH    @05,TESTRC                                          1521
         LTR   @05,@05                                             1521
         BZ    @RF01521                                            1521
*            CALL ERROR1(NOSPACE);                                 1522
*                                                                  1522
         LA    @01,@AL01522                                        1522
         BAL   @14,ERROR1                                          1522
*          ELSE                                                    1523
*DOGRP107:   DO;                                                   1523
         B     @RC01521                                            1523
@RF01521 DS    0H                                                  1523
DOGRP107 DS    0H                                                  1524
*            IF OCCURNUM < 2                                       1524
*              THEN                                                1524
         LH    @05,PARMID                                          1524
         LR    @02,@05                                             1524
         MH    @02,@CH00038                                        1524
         L     @01,WORKPTR                                         1524
         AL    @01,@CF01440                                        1524
         L     @02,PARMPTR(@02,@01)                                1524
         CLC   OCCURNUM(3,@02),@CF00163+1                          1524
         BNL   @RF01524                                            1524
*                FDTPTR(PARMID)=DATAPTR;                           1525
         SLA   @05,2                                               1525
         L     @02,DATAPTR                                         1525
         L     @01,FDTADDR                                         1525
         ST    @02,FDTPTR-4(@05,@01)                               1525
*              ELSE                                                1526
*                LISTADDR=DATAPTR;                                 1526
         B     @RC01524                                            1526
@RF01524 L     @05,PTRLOC                                          1526
         MVC   LISTADDR(4,@05),DATAPTR                             1526
*            SPACELFT=AMTTOGET-AMTUSED-SPACEAMT;                   1527
*                                                                  1527
@RC01524 L     @02,AMTTOGET                                        1527
         SLR   @02,AMTUSED                                         1527
         SH    @02,SPACEAMT                                        1527
         STH   @02,SPACELFT                                        1527
*            /********************************************************/
*            /*                                                      */
*            /* MOVE DATA FROM THE OLD, SMALLER DATA BLOCK INTO THE  */
*            /* NEW DATA BLOCK.  THEN FREE THE OLD DATA BLOCK.       */
*            /*                                                      */
*            /********************************************************/
*            NEWPTR=DATAPTR;                                       1528
         L     NEWPTR,DATAPTR                                      1528
*            DO WHILE(AMTUSED > 0);                        /*@YL026UL*/
         B     @DE01529                                            1529
@DL01529 DS    0H                                                  1530
*              MOVELEN=MIN(256,AMTUSED);                   /*@YL026UL*/
         LA    MOVELEN,256                                         1530
         CR    MOVELEN,AMTUSED                                     1530
         BNH   *+6
         LR    MOVELEN,AMTUSED                                     1530
*              NEWPTR->DATABLK(1:MOVELEN)=                         1531
*                OLDPTR->DATABLK(1:MOVELEN);               /*@YL026UL*/
         LR    @15,MOVELEN                                         1531
         BCTR  @15,0                                               1531
         L     @14,OLDPTR                                          1531
         EX    @15,@SM01497                                        1531
*              NEWPTR=NEWPTR+MOVELEN;                      /*@YL026UL*/
         ALR   NEWPTR,MOVELEN                                      1532
*              OLDPTR=OLDPTR+MOVELEN;                      /*@YL026UL*/
         ALR   @14,MOVELEN                                         1533
         ST    @14,OLDPTR                                          1533
*              AMTUSED=AMTUSED-MOVELEN;                    /*@YL026UL*/
         SLR   AMTUSED,MOVELEN                                     1534
*            END;                                          /*@YL026UL*/
*                                                                  1535
@DE01529 LTR   AMTUSED,AMTUSED                                     1535
         BP    @DL01529                                            1535
*            CALL IDCSAFS0(GDTTBL,FREEPTR);                        1536
*                                                                  1536
         ST    GDTPTR,@AL00001                                     1536
         LA    @02,FREEPTR                                         1536
         ST    @02,@AL00001+4                                      1536
         L     @15,GDTFSP(,GDTPTR)                                 1536
         LA    @01,@AL00001                                        1536
         BALR  @14,@15                                             1536
*            END DOGRP107;                                         1537
*                                                                  1537
*        END MORSPACE;                                             1538
*                                                                  1538
*                                                                  1538
@EL00019 DS    0H                                                  1538
@EF00019 DS    0H                                                  1538
@ER00019 LM    @14,@12,@SA00019                                    1538
         BR    @14                                                 1538
*        END BUILDFDT;                                     /*@YL026UL*/
         B     @EL00014                                            1539
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - INREPEAT                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE IS INVOKED WHEN THE END OF ONE OF THE   */
*/*             SUBLISTS OF A REPEATED SUBPARAMETER LIST HAS BEEN    */
*/*             REACHED.  DEFAULTS ARE APPLIED TO THE SUBLIST JUST   */
*/*             COMPLETED, AND SEMANTIC CHECKING IS PERFORMED ON IT. */
*/*             CHECKING IS THEN DONE TO SEE WHETHER ANOTHER SUBLIST */
*/*             FOLLOWS OR WHETHER THIS WAS THE LAST OF THE SUBLISTS */
*/*             AT THIS LEVEL OF REPEATED SUBLIST NESTING.  COUNTS   */
*/*             INDICATING CURRENT SCAN POSITION AND THE SUBLIST     */
*/*             OCCURRENCE TOTAL ARE ALSO UPDATED AT THIS TIME.      */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SUPERID - PARAMETER ID# OF THE PARAMETER WHOSE REPEATED */
*/*                    SUBLISTS ARE BEING SCANNED                    */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND.                  */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */
*/*          REPCOUNT- NUMBER OF REPETITIONS OF THIS PARAMETER'S     */
*/*                    SUBLIST FOUND THUS FAR                        */
*/*          REPLIMIT- MAXIMUM REPETITIONS ALLOWED OF THIS PARM'S    */
*/*                    SUBPARAMETER LIST                             */
*/*          REPDEPTH- LEVEL OF REPEATED SUBLIST NESTING AT WHICH    */
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PARMID -  PARAMETER ID# OF PARAMETER WHOSE REPEATED     */
*/*                    SUBLISTS ARE BEING SCANNED.                   */
*/*          PARMFLAG- FLAGS IN 'PARMINFO'; PARMFLAG(N) IS   @YL026UL*/
*/*                    SET 'ON' WHEN THE PARM WHOSE ID#=N    @YL026UL*/
*/*                    IS INPUT.                             @YL026UL*/
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST 1 SUBPARAMETER    */
*/*                    HAS BEEN FOUND IN CURRENT SUBPARM. LIST       */
*/*          REPCOUNT- SEE 'INPUT'                                   */
*/*          ARRYPTR - POINTER TO FDT POINTER VECTOR                 */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */
*/*                    CURRENT SUBPARAMETER LIST.                    */
*/*          PARMLVL - SEE 'INPUT'                                   */
*/*          FUNCTION DATA TABLE DATA ENTRY                          */
*/*                                                                  */
*/********************************************************************/
*INREPEAT:PROCEDURE;                                               1540
INREPEAT STM   @14,@04,@SA00020                                    1540
         STM   @06,@12,@SA00020+28                                 1540
*        /************************************************************/
*        /*                                                          */
*        /* INREPEAT PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1541
*        /* STATIC ERROR MESSAGE CODES                               */
*        DCL REPERR   FIXED(31)        /*TOO MANY REPEATED SUBLISTS  */
*                     CONSTANT(19);                                1541
*                                                                  1541
*        DCL SUBOCCUR FIXED(31);       /*NUMBER OF TIMES A PARAMETER
*                                        IN A REPEATED SUBLIST MAY 1542
*                                        APPEAR.                     */
*          /**********************************************************/
*          /*                                                        */
*          /*  ** INREPEAT **  HANDLE REPEATED SUBLIST END           */
*          /*                                                        */
*          /**********************************************************/
*          IF GDTDBG = NULLPTR                                     1543
*            THEN;                                                 1543
         ICM   @04,15,GDTDBG(GDTPTR)                               1543
         BZ    @RT01543                                            1543
*            ELSE                                                  1545
*              CALL IDCDB010(GDTTBL,'RIIR');                       1545
*                                                                  1545
         ST    GDTPTR,@AL00001                                     1545
         LA    @04,@CC01253                                        1545
         ST    @04,@AL00001+4                                      1545
         MVI   @AL00001+4,X'80'                                    1545
         L     @15,GDTDBG(,GDTPTR)                                 1545
         LA    @01,@AL00001                                        1545
         BALR  @14,@15                                             1545
*          /**********************************************************/
*          /*                                                        */
*          /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING ON THE    */
*          /* REPEATED SUBLIST JUST FINISHED.                        */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1546
*          CALL DEFAULTS;                                          1546
@RT01543 BAL   @14,DEFAULTS                                        1546
*          CALL NEEDNOTS;                                          1547
         BAL   @14,NEEDNOTS                                        1547
*          CALL SCANSEP(YES);                                      1548
*                                                                  1548
         LA    @01,@AL01548                                        1548
         BAL   @14,SCANSEP                                         1548
*          IF RISTATUS^=0  ONEREP(REPDEPTH)=YES                   1549
*            THEN                                                  1549
         ICM   @04,3,RISTATUS                                      1549
         BNZ   @RT01549                                            1549
         LH    @04,REPDEPTH                                        1549
         LA    @02,ONEREP-1(@04)                                   1549
         TM    0(@02),B'10000000'                                  1549
         BNO   @RF01549                                            1549
@RT01549 DS    0H                                                  1550
*              DO;                                                 1550
*              REPDEPTH=REPDEPTH-1;                                1551
         LH    @04,REPDEPTH                                        1551
         BCTR  @04,0                                               1551
         STH   @04,REPDEPTH                                        1551
*              PARMLVL=PARMLVL-1;                                  1552
         LH    @04,PARMLVL                                         1552
         BCTR  @04,0                                               1552
         STH   @04,PARMLVL                                         1552
*              RETURN;                                             1553
@EL00020 DS    0H                                                  1553
@EF00020 DS    0H                                                  1553
@ER00020 LM    @14,@04,@SA00020                                    1553
         LM    @06,@12,@SA00020+28                                 1553
         BR    @14                                                 1553
*              END;                                                1554
*                                                                  1554
*          PARMID=SUPERID(PARMLVL);                                1555
*                                                                  1555
@RF01549 LH    @04,PARMLVL                                         1555
         ALR   @04,@04                                             1555
         LH    @04,SUPERID-2(@04)                                  1555
         STH   @04,PARMID                                          1555
*          /**********************************************************/
*          /*                                                        */
*          /* RESET PARAMETER OCCURRENCE FLAGS FOR PARAMETERS IN THE */
*          /* SUBLIST JUST COMPLETED.                                */
*          /*                                                        */
*          /**********************************************************/
*          DO LISTINDX=1 TO MAXID;                                 1556
         LA    @04,1                                               1556
         B     @DE01556                                            1556
@DL01556 DS    0H                                                  1557
*            IF PARMPTR(LISTINDX) ^= NULLPTR                       1557
*              THEN                                                1557
         LR    @02,@04                                             1557
         MH    @02,@CH00038                                        1557
         L     @01,WORKPTR                                         1557
         AL    @01,@CF01440                                        1557
         L     @02,PARMPTR(@02,@01)                                1557
         LTR   @02,@02                                             1557
         BZ    @RF01557                                            1557
*                DO;                                               1558
*                  OLDERID2 = NEWERID2;                            1559
         L     @02,GDTTR2(,GDTPTR)                                 1559
         MVC   @TS00001(95),NEWERID2(@02)                          1559
         MVC   OLDERID2(95,@02),@TS00001                           1559
*                  NEWID2='RI35';                                  1560
         MVC   NEWID2(4,@02),@CC01254                              1560
*                  TESTID=LISTINDX;                                1561
         LH    @02,LISTINDX                                        1561
         LR    TESTID,@02                                          1561
*                  DO WHILE(TESTID^=0);                            1562
         B     @DE01562                                            1562
@DL01562 DS    0H                                                  1563
*                    IF SUPRPARM(TESTID)=PARMID                    1563
*                      THEN                                        1563
         L     @02,WORKPTR                                         1563
         LA    @15,12                                              1563
         LR    @01,TESTID                                          1563
         MR    @00,@15                                             1563
         AL    @01,@CF01441                                        1563
         LH    @14,SUPRPARM-8(@01,@02)                             1563
         CH    @14,PARMID                                          1563
         BNE   @RF01563                                            1563
*                        PARMFLAG(LISTINDX)=0;                     1564
         MH    @15,LISTINDX                                        1564
         SLR   @14,@14                                             1564
         BCTR  @02,0                                               1564
         BCTR  @02,0                                               1564
         STC   @14,PARMFLAG-10(@15,@02)                            1564
*                    TESTID=SUPRPARM(TESTID);                      1565
@RF01563 LR    @02,TESTID                                          1565
         MH    @02,@CH00038                                        1565
         L     @01,WORKPTR                                         1565
         AL    @01,@CF01441                                        1565
         LH    @02,SUPRPARM-8(@02,@01)                             1565
         LR    TESTID,@02                                          1565
*                  END;                                            1566
@DE01562 LTR   TESTID,TESTID                                       1566
         BNZ   @DL01562                                            1566
*                END;                                              1567
*          END;                                                    1568
*                                                                  1568
@RF01557 LA    @04,1                                               1568
         AH    @04,LISTINDX                                        1568
@DE01556 STH   @04,LISTINDX                                        1568
         L     @02,DESCPTR                                         1568
         CH    @04,MAXID(,@02)                                     1568
         BNH   @DL01556                                            1568
*          /**********************************************************/
*          /*                                                        */
*          /* IF ANOTHER SUBLIST FOLLOWS, BYPASS DELIMITERS PREPARING*/
*          /* TO SCAN NEW SUBLIST AND UPDATE LIST OCCURRENCE COUNTS. */
*          /* ALSO CHECK TO BE SURE THAT TOO MANY SUBLISTS HAVE NOT  */
*          /* BEEN INPUT.                                            */
*          /*                                                        */
*          /**********************************************************/
*          IF CHAR1=OPENING                                        1569
*            THEN                                                  1569
         CLI   CHAR1,C'('                                          1569
         BNE   @RF01569                                            1569
*DOGRP108:     DO;                                                 1570
*                                                                  1570
DOGRP108 DS    0H                                                  1571
*                CALL NEXTCHAR;                                    1571
         BAL   @14,NEXTCHAR                                        1571
*                CALL SCANSEP(NO);                                 1572
*                                                                  1572
         LA    @01,@AL01572                                        1572
         BAL   @14,SCANSEP                                         1572
*                SUBSYET=NO;                                       1573
         NI    SUBSYET,B'11101111'                                 1573
*                REPCOUNT(REPDEPTH)=REPCOUNT(REPDEPTH)+1;          1574
         LH    @04,REPDEPTH                                        1574
         ALR   @04,@04                                             1574
         LA    @02,1                                               1574
         AH    @02,REPCOUNT-2(@04)                                 1574
         STH   @02,REPCOUNT-2(@04)                                 1574
*                IF REPCOUNT(REPDEPTH) > REPLIMIT(REPDEPTH)        1575
*                  THEN                                            1575
*                                                                  1575
         CH    @02,REPLIMIT-2(@04)                                 1575
         BNH   @RF01575                                            1575
*                    CALL ERROR1(REPERR);                          1576
*                                                                  1576
         LA    @01,@AL01576                                        1576
         BAL   @14,ERROR1                                          1576
*                  ELSE                                            1577
*DOGRP109:           DO;                                           1577
*                                                                  1577
         B     @RC01575                                            1577
@RF01575 DS    0H                                                  1577
DOGRP109 DS    0H                                                  1578
*                    /************************************************/
*                    /*                                              */
*                    /* IF THE CURRENT REPEATED LIST IS NOT NESTED   */
*                    /* WITHIN ANY OTHER REPEATED SUBLIST, THEN A    */
*                    /* LIST OF POINTER BLOCKS IS BEING MAINTAINED   */
*                    /* TO POINT TO SCALAR DATA OF PARAMETERS WITHIN */
*                    /* THIS REPEATED SUBLIST.  ALLOCATE ANOTHER     */
*                    /* BLOCK OF POINTERS FOR EACH SUBPARM IN THE    */
*                    /* SUBLIST IF ENOUGH REPETITIONS OF THE SUBLIST */
*                    /* HAVE OCCURRED TO REQUIRE THIS.               */
*                    /*                                              */
*                    /************************************************/
*                    SUBOCCUR=REPMAX;                              1578
         LA    @04,12                                              1578
         LR    @02,@04                                             1578
         MH    @02,PARMID                                          1578
         L     @01,WORKPTR                                         1578
         AL    @01,@CF01440                                        1578
         AL    @04,PARMPTR(@02,@01)                                1578
         SLR   @02,@02                                             1578
         IC    @02,REPMAX(,@04)                                    1578
         ST    @02,SUBOCCUR                                        1578
*                    IF REPDEPTH=1 &                               1579
*                       REPCOUNT(REPDEPTH)//(VECTRSIZ-1)=1         1579
*                      THEN                                        1579
         LH    @04,REPDEPTH                                        1579
         LA    @02,1                                               1579
         CR    @04,@02                                             1579
         BNE   @RF01579                                            1579
         ALR   @04,@04                                             1579
         LH    @00,REPCOUNT-2(@04)                                 1579
         SRDA  @00,32                                              1579
         D     @00,@CF00042                                        1579
         CR    @00,@02                                             1579
         BNE   @RF01579                                            1579
*DOLOOP17:               DO VLISTID=1 TO MAXID WHILE(RISTATUS=0);  1580
DOLOOP17 LA    @04,1                                               1580
         B     @DE01580                                            1580
@DL01580 SLR   @02,@02                                             1580
         CH    @02,RISTATUS                                        1580
         BNE   @DC01580                                            1580
*                          IF PARMPTR(VLISTID) ^= NULLPTR &        1581
*                             PARMPTR(VLISTID)->OCCURNUM = SUBOCCUR
*                            THEN                                  1581
         MH    @04,@CH00038                                        1581
         L     @01,WORKPTR                                         1581
         AL    @01,@CF01440                                        1581
         L     @04,PARMPTR(@04,@01)                                1581
         CR    @04,@02                                             1581
         BE    @RF01581                                            1581
         SLR   @02,@02                                             1581
         ICM   @02,7,OCCURNUM(@04)                                 1581
         C     @02,SUBOCCUR                                        1581
         BNE   @RF01581                                            1581
*DOGRP111:                     DO;                                 1582
DOGRP111 DS    0H                                                  1583
*                                TESTID=VLISTID;                   1583
*                                                                  1583
         LH    TESTID,VLISTID                                      1583
*                                /************************************/
*                                /*                                  */
*                                /* DETERMINE WHETHER THIS PARAMETER */
*                                /* IS ONE OF THE PARM'S NEEDING MORE*/
*                                /* DATA POINTERS & IF SO ADD ANOTHER*/
*                                /* BLOCK OF POINTERS TO THE LIST.   */
*                                /*                                  */
*                                /************************************/
*DOLOOP18:                       DO WHILE(TESTID^=0 & RISTATUS=0); 1584
DOLOOP18 B     @DE01584                                            1584
@DL01584 DS    0H                                                  1585
*                                  IF SUPRPARM(TESTID) = PARMID    1585
*                                    THEN                          1585
         LR    @02,TESTID                                          1585
         MH    @02,@CH00038                                        1585
         L     @01,WORKPTR                                         1585
         AL    @01,@CF01441                                        1585
         LH    @02,SUPRPARM-8(@02,@01)                             1585
         CH    @02,PARMID                                          1585
         BNE   @RF01585                                            1585
*                                      DO;                         1586
*                                        ARRYPTR=FDTPTR(VLISTID);  1587
         LH    @15,VLISTID                                         1587
         SLA   @15,2                                               1587
         L     @01,FDTADDR                                         1587
         L     ARRYPTR,FDTPTR-4(@15,@01)                           1587
*                                        DO WHILE(VECTRPTR ^= 0);  1588
         B     @DE01588                                            1588
@DL01588 DS    0H                                                  1589
*                                          ARRYPTR=VECTRPTR;       1589
         LR    @15,ARRYPTR                                         1589
         AH    @15,VECTRLEN                                        1589
         L     @15,VECTRPTR(,@15)                                  1589
         LR    ARRYPTR,@15                                         1589
*                                        END;                      1590
@DE01588 LR    @15,ARRYPTR                                         1590
         AH    @15,VECTRLEN                                        1590
         ICM   @14,15,VECTRPTR(@15)                                1590
         BNZ   @DL01588                                            1590
*                                        AMTTOGET=VECTRSIZ*PTRLNGTH;
*                                                                  1591
         MVC   AMTTOGET(4),@CF01420                                1591
*                                        CALL IDCSAGP0(GDTTBL,AMTTOGET,
*                                               VECTRPTR,RIPOOLID, 1592
*                                               SETZERO);          1592
         ST    GDTPTR,@AL00001                                     1592
         LA    @14,AMTTOGET                                        1592
         ST    @14,@AL00001+4                                      1592
         ST    @15,@AL00001+8                                      1592
         LA    @15,RIPOOLID                                        1592
         ST    @15,@AL00001+12                                     1592
         LA    @15,SETZERO                                         1592
         ST    @15,@AL00001+16                                     1592
         MVI   @AL00001+16,X'80'                                   1592
         L     @15,GDTGPL(,GDTPTR)                                 1592
         LA    @01,@AL00001                                        1592
         BALR  @14,@15                                             1592
*                                        RESPECIFY RTNREG RSTD;    1593
*                                        TESTRC = RTNREG;          1594
         STH   RTNREG,TESTRC                                       1594
*                                        RESPECIFY RTNREG UNRSTD;  1595
*                                                                  1595
*                                        IF TESTRC^=0              1596
*                                          THEN                    1596
*                                                                  1596
         LH    @02,TESTRC                                          1596
         LTR   @02,@02                                             1596
         BZ    @RF01596                                            1596
*                                            CALL ERROR1(NOSPACE); 1597
*                                                                  1597
         LA    @01,@AL01597                                        1597
         BAL   @14,ERROR1                                          1597
*                                          ELSE                    1598
*                                            TESTID=0;             1598
         B     @RC01596                                            1598
@RF01596 SLR   TESTID,TESTID                                       1598
*                                      END;                        1599
*                                    ELSE                          1600
*                                      TESTID=SUPRPARM(TESTID);    1600
         B     @RC01585                                            1600
@RF01585 LR    @02,TESTID                                          1600
         MH    @02,@CH00038                                        1600
         L     @01,WORKPTR                                         1600
         AL    @01,@CF01441                                        1600
         LH    @02,SUPRPARM-8(@02,@01)                             1600
         LR    TESTID,@02                                          1600
*                                END DOLOOP18;                     1601
@RC01585 DS    0H                                                  1601
@DE01584 SLR   @02,@02                                             1601
         CR    TESTID,@02                                          1601
         BE    @DC01584                                            1601
         CH    @02,RISTATUS                                        1601
         BE    @DL01584                                            1601
@DC01584 DS    0H                                                  1602
*                              END DOGRP111;                       1602
*                        END DOLOOP17;                             1603
*                                                                  1603
@RF01581 LA    @04,1                                               1603
         AH    @04,VLISTID                                         1603
@DE01580 STH   @04,VLISTID                                         1603
         L     @02,DESCPTR                                         1603
         CH    @04,MAXID(,@02)                                     1603
         BNH   @DL01580                                            1603
@DC01580 DS    0H                                                  1604
*                    /************************************************/
*                    /*                                              */
*                    /* INCREMENT THE COUNTER VALUE IN THE FDT THAT  */
*                    /* PERTAINS TO THE NUMBER OF REPEATED SUBLIST   */
*                    /* REPETITIONS.                                 */
*                    /*                                              */
*                    /************************************************/
*                    ARRYPTR=FDTPTR(SUPERID(PARMLVL));             1604
@RF01579 LH    @15,PARMLVL                                         1604
         ALR   @15,@15                                             1604
         LH    @15,SUPERID-2(@15)                                  1604
         SLA   @15,2                                               1604
         L     @01,FDTADDR                                         1604
         L     ARRYPTR,FDTPTR-4(@15,@01)                           1604
*                    HWORDARG=REPDEPTH-1;                          1605
*                                                                  1605
         LH    @15,REPDEPTH                                        1605
         BCTR  @15,0                                               1605
         STH   @15,HWORDARG                                        1605
*                    CALL DSPLCALC(HWORDARG);                      1606
*                                                                  1606
         LA    @15,HWORDARG                                        1606
         ST    @15,@AL00001                                        1606
         LA    @01,@AL00001                                        1606
         BAL   @14,DSPLCALC                                        1606
*                    REPTOTAL=REPTOTAL+1;                          1607
         LR    @15,ARRYPTR                                         1607
         ALR   @15,ARRYDSPL                                        1607
         LA    @14,1                                               1607
         L     @01,REPTOTAL(,@15)                                  1607
         ALR   @01,@14                                             1607
         ST    @01,REPTOTAL(,@15)                                  1607
*                    PPARMCNT(PARMLVL)=1;                          1608
         LH    @04,PARMLVL                                         1608
         ALR   @04,@04                                             1608
         STH   @14,PPARMCNT-2(@04)                                 1608
*                  END DOGRP109;                                   1609
*              END DOGRP108;                                       1610
*            ELSE                                                  1611
*                                                                  1611
*              /******************************************************/
*              /*                                                    */
*              /* IF THE CURRENT SUBLIST IS THE LAST REPEATED LIST   */
*              /* AT THIS LEVEL, RESET INDEXES AND COUNTS TO CONTINUE*/
*              /* SCANNING PARAMETERS AT NEXT HIGHER LEVEL.          */
*              /*                                                    */
*              /******************************************************/
*              IF CHAR1=CLOSING                                    1611
*                THEN                                              1611
         B     @RC01569                                            1611
@RF01569 CLI   CHAR1,C')'                                          1611
         BNE   @RF01611                                            1611
*                  DO;                                             1612
*                    OLDERID2 = NEWERID2;                          1613
         L     @04,GDTTR2(,GDTPTR)                                 1613
         MVC   @TS00001(95),NEWERID2(@04)                          1613
         MVC   OLDERID2(95,@04),@TS00001                           1613
*                    NEWID2='RI36';                                1614
         MVC   NEWID2(4,@04),@CC01265                              1614
*                    REPDEPTH=REPDEPTH-1;                          1615
*                                                                  1615
         LH    @04,REPDEPTH                                        1615
         BCTR  @04,0                                               1615
         STH   @04,REPDEPTH                                        1615
*                    CALL NEXTCHAR;                                1616
         BAL   @14,NEXTCHAR                                        1616
*                    CALL SCANSEP(YES);                            1617
*                                                                  1617
         LA    @01,@AL01617                                        1617
         BAL   @14,SCANSEP                                         1617
*                    PARMLVL=PARMLVL-1;                            1618
         LH    @04,PARMLVL                                         1618
         BCTR  @04,0                                               1618
         STH   @04,PARMLVL                                         1618
*                  END;                                            1619
*                ELSE                                              1620
*                                                                  1620
*                  /**************************************************/
*                  /*                                                */
*                  /* IF STATEMENT END HAS BEEN REACHED (EVEN THOUGH */
*                  /* SOME CLOSING PARENTHESES ARE MISSING), APPLY   */
*                  /* DEFAULTS FOR EACH LEVEL NOT EXPLICITLY CLOSED. */
*                  /* ISSUE A WARNING MESSAGE ABOUT THE PARENTHESES. */
*                  /*                                                */
*                  /**************************************************/
*                  IF CHAR1=ENDDELIM                               1620
*                    THEN                                          1620
         B     @RC01611                                            1620
@RF01611 CLI   CHAR1,C';'                                          1620
         BNE   @RF01620                                            1620
*                      DO;                                         1621
*                      PARMLVL=PARMLVL-1;                          1622
         LH    @04,PARMLVL                                         1622
         BCTR  @04,0                                               1622
         STH   @04,PARMLVL                                         1622
*                      REPDEPTH=REPDEPTH-1;                        1623
         LH    @02,REPDEPTH                                        1623
         BCTR  @02,0                                               1623
         STH   @02,REPDEPTH                                        1623
*                      IF PARMLVL=1                                1624
*                        THEN                                      1624
         CH    @04,@CH00228                                        1624
         BNE   @RF01624                                            1624
*                          DO;                                     1625
*                          DARGSMOD=RISTID;                        1626
         L     @04,DDSTRU                                          1626
         MVC   DARGSMOD(3,@04),RISTID                              1626
*                          DARGSENT=TOOFEW;                        1627
*                                                                  1627
         MVI   DARGSENT(@04),X'23'                                 1627
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   1628
*                                                                  1628
         ST    GDTPTR,@AL00001                                     1628
         LA    @04,@CF00125                                        1628
         ST    @04,@AL00001+4                                      1628
         LA    @04,DDSTRU                                          1628
         ST    @04,@AL00001+8                                      1628
         MVI   @AL00001+8,X'80'                                    1628
         L     @15,GDTPRT(,GDTPTR)                                 1628
         LA    @01,@AL00001                                        1628
         BALR  @14,@15                                             1628
*                          END;                                    1629
*                      END;                                        1630
*                    ELSE                                          1631
*                                                                  1631
*                      CALL ERROR1(BADELIM4);                      1631
*                                                                  1631
         B     @RC01620                                            1631
@RF01620 LA    @01,@AL01631                                        1631
         BAL   @14,ERROR1                                          1631
*        END INREPEAT;                                             1632
         B     @EL00020                                            1632
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DEFAULTS                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE DETERMINES DEFAULT PARMS IN     @YL026UL*/
*/*             ADDITION TO THE PARAMETERS WHICH HAVE ACTUALLY BEEN  */
*/*             CODED AS INPUT ON A COMMAND.  THE REQUIRED DEFAULT   */
*/*             INFORMATION FOR A COMMAND IS CONTAINED IN THE COMMAND*/
*/*             DESCRIPTOR.  A DEFAULT IS APPLIED AS LONG AS THERE   */
*/*             IS NO SEMANTIC REQUIREMENT PROHIBITING IT DUE TO A   */
*/*             PARAMETER WHICH HAS ALREADY BEEN INPUT.  DEFAULTS    */
*/*             ARE APPLIED AT COMMAND END AND AT THE END OF EACH    */
*/*             REPETITION OF A REPEATED SUBPARAMETER LIST (IN THE   */
*/*             LATTER CASE, ONLY DEFAULTS APPLYING TO THAT SUBLIST  */
*/*             ARE APPLIED).                                        */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          SUPERID - SUPERPARAMETER ID# OF PARAMETER WHOSE SUBLIST */
*/*                    IS RECEIVING DEFAULTS (ID#=0 IF APPLYING      */
*/*                    DEFAULTS FOR ENTIRE COMMAND).                 */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS DETECTED.               */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PARAMETER ID# OF A PARAMETER TO BE DEFAULTED    @YL026UL*/
*/*                                                                  */
*/********************************************************************/
*DEFAULTS:PROCEDURE;                                               1633
DEFAULTS STM   @14,@04,@SA00021                                    1633
         STM   @06,@12,@SA00021+28                                 1633
*        /************************************************************/
*        /*                                                          */
*        /*  ** DEFAULTS **  APPLY DEFAULT PARAMETERS                */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1634
*          THEN;                                                   1634
         ICM   @04,15,GDTDBG(GDTPTR)                               1634
         BZ    @RT01634                                            1634
*          ELSE                                                    1636
*            CALL IDCDB010(GDTTBL,'RIDF');                         1636
*                                                                  1636
         ST    GDTPTR,@AL00001                                     1636
         LA    @04,@CC01269                                        1636
         ST    @04,@AL00001+4                                      1636
         MVI   @AL00001+4,X'80'                                    1636
         L     @15,GDTDBG(,GDTPTR)                                 1636
         LA    @01,@AL00001                                        1636
         BALR  @14,@15                                             1636
*        /************************************************************/
*        /*                                                          */
*        /* UPON ENTRY TO THIS ROUTINE, THE CURRENT SUPERPARAMETER   */
*        /* ID NUMBER WILL BE ZERO IF STATEMENT END HAS BEEN REACHED.*/
*        /* OTHERWISE, THE ID# WILL BE THAT OF THE PARAMETER WHICH   */
*        /* HAS THE REPEATED SUBPARAMETER LIST.                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1637
*        /************************************************************/
*        /*                                                          */
*        /* IF 'DEFAULT GROUPS' ARE SPECIFIED, FIND THE      @YL026UL*/
*        /* GROUP(S) WHICH PERTAIN TO THE CURRENT SET OF     @YL026UL*/
*        /* PARAMETERS, AND SELECT DEFAULTS IF APPLICABLE.   @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF DGRPDSPL > 0                                           1637
*          THEN                                                    1637
@RT01634 L     @04,DESCPTR                                         1637
         CLI   DGRPDSPL(@04),0                                     1637
         BNH   @RF01637                                            1637
*DOGRP110:   DO;                                           /*@YL026UL*/
DOGRP110 DS    0H                                                  1639
*              GRPPTR=ADDR(DGRPTOT)+LENGTH(DGRPTOT);       /*@YL026UL*/
*                                                                  1639
         L     @04,DESCPTR                                         1639
         SLR   @02,@02                                             1639
         IC    @02,DGRPDSPL(,@04)                                  1639
         ALR   @02,@02                                             1639
         ALR   @04,@02                                             1639
         AL    @04,@CF00163                                        1639
         ST    @04,GRPPTR                                          1639
*              /******************************************************/
*              /*                                                    */
*              /* EXAMINE EACH 'DEFAULT GROUP' SUBLIST,      @YL026UL*/
*              /* CHECKING TO SEE IF THE PARAMETER ELIGIBLE  @YL026UL*/
*              /* TO BE DEFAULTED IS PART OF THE SET OF      @YL026UL*/
*              /* PARAMETERS NOW BEING HANDLED.              @YL026UL*/
*              /*                                                    */
*              /******************************************************/
*DOLOOP19:     DO LISTINDX=1 TO DGRPTOT;                   /*@YL026UL*/
DOLOOP19 LA    @04,1                                               1640
         B     @DE01640                                            1640
@DL01640 DS    0H                                                  1641
*                FOUND=NO;                                 /*@YL026UL*/
         NI    FOUND,B'11011111'                                   1641
*                TESTID=DGRPID(1);                         /*@YL026UL*/
         L     @02,GRPPTR                                          1642
         LH    TESTID,DGRPID(,@02)                                 1642
*                DO WHILE(TESTID^=0 & FOUND=NO);           /*@YL026UL*/
         B     @DE01643                                            1643
@DL01643 DS    0H                                                  1644
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1644
*                    THEN                                          1644
         LR    @02,TESTID                                          1644
         MH    @02,@CH00038                                        1644
         LH    @15,PARMLVL                                         1644
         ALR   @15,@15                                             1644
         L     @01,WORKPTR                                         1644
         AL    @01,@CF01441                                        1644
         LH    @02,SUPRPARM-8(@02,@01)                             1644
         CH    @02,SUPERID-2(@15)                                  1644
         BNE   @RF01644                                            1644
*                      FOUND=YES;                          /*@YL026UL*/
         OI    FOUND,B'00100000'                                   1645
*                    ELSE                                          1646
*                      DO;                                 /*@YL026UL*/
         B     @RC01644                                            1646
@RF01644 DS    0H                                                  1647
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/
         L     @02,WORKPTR                                         1647
         LA    @15,12                                              1647
         LR    @01,TESTID                                          1647
         MR    @00,@15                                             1647
         AL    @01,@CF01441                                        1647
         LH    @14,SUPRPARM-8(@01,@02)                             1647
         LR    TESTID,@14                                          1647
*                      IF PARMPTR(TESTID)->REPEATED=YES            1648
*                        THEN                                      1648
         MR    @14,TESTID                                          1648
         AL    @02,@CF01440                                        1648
         L     @02,PARMPTR(@15,@02)                                1648
         TM    REPEATED(@02),B'00100000'                           1648
         BNO   @RF01648                                            1648
*                          TESTID=0;                       /*@YL026UL*/
         SLR   TESTID,TESTID                                       1649
*                      END;                                /*@YL026UL*/
@RF01648 DS    0H                                                  1651
*                END;                                      /*@YL026UL*/
*                                                                  1651
@RC01644 DS    0H                                                  1651
@DE01643 LTR   TESTID,TESTID                                       1651
         BZ    @DC01643                                            1651
         TM    FOUND,B'00100000'                                   1651
         BZ    @DL01643                                            1651
@DC01643 DS    0H                                                  1652
*                /****************************************************/
*                /*                                                  */
*                /* IF THE ELIGIBLE PARAMETER IS PART OF THE @YL026UL*/
*                /* CURRENT PARAMETER SET, TEST TO SEE IF    @YL026UL*/
*                /* ALL THE PARAMETERS IN THE GROUP WERE NOT @YL026UL*/
*                /* CODED.  IF NONE WERE INPUT, DEFAULT THE  @YL026UL*/
*                /* FIRST PARAMETER IN THE SUBLIST.          @YL026UL*/
*                /*                                                  */
*                /****************************************************/
*                IF FOUND=YES                                      1652
*                  THEN                                            1652
         TM    FOUND,B'00100000'                                   1652
         BNO   @RF01652                                            1652
*DOGRP113:           DO;                                   /*@YL026UL*/
DOGRP113 DS    0H                                                  1654
*                      FOUND=NO;                           /*@YL026UL*/
         NI    FOUND,B'11011111'                                   1654
*                      DO INDEX3=1 TO DGRPCNT;             /*@YL026UL*/
         LA    @04,1                                               1655
         B     @DE01655                                            1655
@DL01655 DS    0H                                                  1656
*                        IF PARMFLAG(DGRPID(INDEX3))^=0            1656
*                          THEN                                    1656
         ALR   @04,@04                                             1656
         L     @02,GRPPTR                                          1656
         LH    @04,DGRPID-2(@04,@02)                               1656
         MH    @04,@CH00038                                        1656
         L     @02,WORKPTR                                         1656
         BCTR  @02,0                                               1656
         BCTR  @02,0                                               1656
         SLR   @15,@15                                             1656
         IC    @15,PARMFLAG-10(@04,@02)                            1656
         CH    @15,@CH00125                                        1656
         BE    @RF01656                                            1656
*                            FOUND=YES;                    /*@YL026UL*/
         OI    FOUND,B'00100000'                                   1657
*                      END;                                /*@YL026UL*/
@RF01656 LA    @04,1                                               1658
         AH    @04,INDEX3                                          1658
@DE01655 STH   @04,INDEX3                                          1658
         L     @02,GRPPTR                                          1658
         CH    @04,DGRPCNT(,@02)                                   1658
         BNH   @DL01655                                            1658
*                      IF FOUND=NO                                 1659
*                        THEN                                      1659
*                                                                  1659
         TM    FOUND,B'00100000'                                   1659
         BNZ   @RF01659                                            1659
*                          CALL SETDFLT(DGRPID(1));        /*@YL026UL*/
*                                                                  1660
         L     @04,GRPPTR                                          1660
         LA    @04,DGRPID(,@04)                                    1660
         ST    @04,@AL00001                                        1660
         LA    @01,@AL00001                                        1660
         BAL   @14,SETDFLT                                         1660
*                    END DOGRP113;                         /*@YL026UL*/
@RF01659 DS    0H                                                  1662
*                GRPPTR=GRPPTR+LENGTH(DGRPCNT)+                    1662
*                        DGRPCNT*LENGTH(DGRPID(1));        /*@YL026UL*/
@RF01652 L     @04,GRPPTR                                          1662
         LA    @02,2                                               1662
         ALR   @02,@04                                             1662
         LH    @04,DGRPCNT(,@04)                                   1662
         ALR   @04,@04                                             1662
         ALR   @02,@04                                             1662
         ST    @02,GRPPTR                                          1662
*              END DOLOOP19;                               /*@YL026UL*/
         LA    @04,1                                               1663
         AH    @04,LISTINDX                                        1663
@DE01640 STH   @04,LISTINDX                                        1663
         L     @02,DESCPTR                                         1663
         SLR   @15,@15                                             1663
         IC    @15,DGRPDSPL(,@02)                                  1663
         ALR   @15,@15                                             1663
         AL    @15,DESCPTR                                         1663
         CH    @04,DGRPTOT(,@15)                                   1663
         BNH   @DL01640                                            1663
*            END DOGRP110;                                 /*@YL026UL*/
*                                                                  1664
*        /************************************************************/
*        /*                                                          */
*        /* EXAMINE EACH PARAMETER TO SEE IF A DEFAULT       @YL026UL*/
*        /* CONSTANT IS PROVIDED FOR IT.  IF A DEFAULT IS    @YL026UL*/
*        /* PRESENT AND THE PARAMETER IS NOT ALREADY INPUT,  @YL026UL*/
*        /* THE PARM IS ELIGIBLE TO BE DEFAULTED.            @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*DOLOOP20:DO INDEX3=1 TO MAXID;                            /*@YL026UL*/
@RF01637 DS    0H                                                  1665
DOLOOP20 LA    @04,1                                               1665
         B     @DE01665                                            1665
@DL01665 DS    0H                                                  1666
*          IF PARMPTR(INDEX3)^=0 & PARMFLAG(INDEX3)=0 &            1666
*             PARMPTR(INDEX3)->DEFAULT=YES                         1666
*            THEN                                                  1666
         SLR   @02,@02                                             1666
         L     @15,WORKPTR                                         1666
         MH    @04,@CH00038                                        1666
         LA    @01,0(@04,@15)                                      1666
         AL    @01,@CF01440                                        1666
         L     @14,PARMPTR(,@01)                                   1666
         CR    @14,@02                                             1666
         BE    @RF01666                                            1666
         BCTR  @15,0                                               1666
         BCTR  @15,0                                               1666
         SLR   @01,@01                                             1666
         IC    @01,PARMFLAG-10(@04,@15)                            1666
         CR    @02,@01                                             1666
         BNE   @RF01666                                            1666
         TM    DEFAULT(@14),B'00000100'                            1666
         BNO   @RF01666                                            1666
*DOGRP115:     DO;                                         /*@YL026UL*/
DOGRP115 DS    0H                                                  1668
*                TESTID=INDEX3;                            /*@YL026UL*/
*                                                                  1668
         LH    TESTID,INDEX3                                       1668
*                /****************************************************/
*                /*                                                  */
*                /* BE SURE THAT THE PARAMETER TO BE DEFAULTED IS    */
*                /* PART OF THE SET OF PARAMETERS CURRENTLY BEING    */
*                /* HANDLED.  IF SO, THEN SET THE DEFAULT.           */
*                /*                                                  */
*                /****************************************************/
*DOLOOP22:       DO WHILE(TESTID^=0);                      /*@YL026UL*/
DOLOOP22 B     @DE01669                                            1669
@DL01669 DS    0H                                                  1670
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1670
*                    THEN                                          1670
         LR    @02,TESTID                                          1670
         MH    @02,@CH00038                                        1670
         LH    @15,PARMLVL                                         1670
         ALR   @15,@15                                             1670
         L     @01,WORKPTR                                         1670
         AL    @01,@CF01441                                        1670
         LH    @02,SUPRPARM-8(@02,@01)                             1670
         CH    @02,SUPERID-2(@15)                                  1670
         BNE   @RF01670                                            1670
*                      DO;                                 /*@YL026UL*/
*                      TESTID=0;                           /*@YL026UL*/
*                                                                  1672
         SLR   TESTID,TESTID                                       1672
*                      CALL SETDFLT(INDEX3);               /*@YL026UL*/
*                                                                  1673
         LA    @02,INDEX3                                          1673
         ST    @02,@AL00001                                        1673
         LA    @01,@AL00001                                        1673
         BAL   @14,SETDFLT                                         1673
*                      END;                                /*@YL026UL*/
*                    ELSE                                          1675
*                      DO;                                 /*@YL026UL*/
         B     @RC01670                                            1675
@RF01670 DS    0H                                                  1676
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/
         L     @02,WORKPTR                                         1676
         LA    @15,12                                              1676
         LR    @01,TESTID                                          1676
         MR    @00,@15                                             1676
         AL    @01,@CF01441                                        1676
         LH    @14,SUPRPARM-8(@01,@02)                             1676
         LR    TESTID,@14                                          1676
*                      IF PARMPTR(TESTID)->REPEATED=YES            1677
*                        THEN                                      1677
         MR    @14,TESTID                                          1677
         AL    @02,@CF01440                                        1677
         L     @02,PARMPTR(@15,@02)                                1677
         TM    REPEATED(@02),B'00100000'                           1677
         BNO   @RF01677                                            1677
*                          TESTID=0;                       /*@YL026UL*/
         SLR   TESTID,TESTID                                       1678
*                      END;                                /*@YL026UL*/
@RF01677 DS    0H                                                  1680
*                END DOLOOP22;                             /*@YL026UL*/
@RC01670 DS    0H                                                  1680
@DE01669 LTR   TESTID,TESTID                                       1680
         BNZ   @DL01669                                            1680
*              END DOGRP115;                               /*@YL026UL*/
*        END DOLOOP20;                                     /*@YL026UL*/
@RF01666 LA    @04,1                                               1682
         AH    @04,INDEX3                                          1682
@DE01665 STH   @04,INDEX3                                          1682
         L     @02,DESCPTR                                         1682
         CH    @04,MAXID(,@02)                                     1682
         BNH   @DL01665                                            1682
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SETDFLT                                @YL026UL*/
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS A PARM THAT IS ELIGIBLE  @YL026UL*/
*/*             TO BE DEFAULTED TO SEE IF THE DEFAULT WILL   @YL026UL*/
*/*             CAUSE ANY CONFLICT WITH AN EXISTING INPUT    @YL026UL*/
*/*             PARAMETER.  IF NOT, THE DEFAULT PARAMETER    @YL026UL*/
*/*             IS ADDED TO THE FDT.                         @YL026UL*/
*/*                                                                  */
*/*  INPUT -                                                 @YL026UL*/
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.         @YL026UL*/
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*          DFLTPARM - THE ID# OF THE PARAMETER TO BE DEFAULTED     */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          ORGSIGN - FORM OF THE CONSTANT (HEX, BINARY     @YL026UL*/
*/*                    OR NEITHER) TO BE DEFAULTED.          @YL026UL*/
*/*          PWORD -   SET 'OFF' TO SIGNAL THAT THE ITEM     @YL026UL*/
*/*                    BEING DEFAULTED IS NOT A PASSWORD.    @YL026UL*/
*/*          SYNUNIT - CONTAINS THE ITEM TO BE DEFAULTED.    @YL026UL*/
*/*          UNITINDX- LENGTH OF THE ITEM TO BE DEFAULTED.   @YL026UL*/
*/*                                                                  */
*/********************************************************************/
*SETDFLT:PROCEDURE(DFLTPARM);                              /*@YL026UL*/
         B     @PB00022                                            1683
SETDFLT  STM   @14,@04,@SA00022                                    1683
         STM   @06,@12,@SA00022+28                                 1683
         MVC   @PC00022(4),0(@01)                                  1683
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR SETDFLT ROUTINE             @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1684
*        DCL DFLTPARM FIXED(15);       /*ID# OF PARM TO BE   @YL026UL*/
*                                      /* DEFAULTED.         @YL026UL*/
*        DCL WORKVAR2 FIXED(15);       /*VARIABLE TO CONTAIN @YL026UL*/
*                                      /*A TEMPORARY VALUE   @YL026UL*/
*        DCL DEFLTPTR PTR(31);         /*VARIABLE TO CONTAIN @YL026UL*/
*                                      /*PTR TO DEFAULT INFO @YL026UL*/
*                                      /*IN THE DESCRIPTOR.  @YL026UL*/
*        DCL DFLTOK   BIT(1);          /*SIGNALS THAT PARM   @YL026UL*/
*                                      /* IDENTIFIED IN THE  @YL026UL*/
*                                      /* ABOVE LIST IS OK   @YL026UL*/
*                                      /* TO BE DEFAULTED.   @YL026UL*/
*        /************************************************************/
*        /*                                                          */
*        /*  ** SETDFLT **  APPLY DEFAULT PARAMETERS         @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1688
*          THEN;                                                   1688
         ICM   @04,15,GDTDBG(GDTPTR)                               1688
         BZ    @RT01688                                            1688
*          ELSE                                                    1690
*            CALL IDCDB010(GDTTBL,'RIST');                         1690
         ST    GDTPTR,@AL00001                                     1690
         LA    @04,@CC01291                                        1690
         ST    @04,@AL00001+4                                      1690
         MVI   @AL00001+4,X'80'                                    1690
         L     @15,GDTDBG(,GDTPTR)                                 1690
         LA    @01,@AL00001                                        1690
         BALR  @14,@15                                             1690
*                                                          /*@YL026UL*/
*                                                                  1691
*        /************************************************************/
*        /*                                                          */
*        /* THE PARAMETER TO BE DEFAULTED IS CHECKED TO      @YL026UL*/
*        /* INSURE THAT ITS PRESENCE WILL NOT CREATE A       @YL026UL*/
*        /* CONFLICT WITH AN EXISTING INPUT PARAMETER.       @YL026UL*/
*        /* SINCE KEYWORD SUPERPARM(S) OF THE DEFAULT PARM   @YL026UL*/
*        /* ARE TO BE DEFAULTED (AS NECESSARY) ALONG WITH    @YL026UL*/
*        /* IT, THESE SUPERPARM(S) ARE ALSO CHECKED FOR      @YL026UL*/
*        /* POTENTIAL CONFLICTS                              @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        PARMID=DFLTPARM;                                  /*@YL026UL*/
@RT01688 L     @04,@PC00022                                        1691
         MVC   PARMID(2),DFLTPARM(@04)                             1691
*        DFLTOK=YES;                                       /*@YL026UL*/
         OI    DFLTOK,B'10000000'                                  1692
*        DO WHILE(DFLTOK=YES &                                     1693
*                   PARMID^=0 & PARMFLAG(PARMID)=0);       /*@YL026UL*/
*                                                                  1693
         B     @DE01693                                            1693
@DL01693 DS    0H                                                  1694
*          /**********************************************************/
*          /*                                                        */
*          /* FIRST, CHECK FOR A LIST OF CONFLICTING PARMS   @YL026UL*/
*          /* SPECIFICALLY ASSOCIATED WITH THE DEFAULT PARM, @YL026UL*/
*          /* AND BE SURE THAT NO CONFLICTS WOULD EXIST.     @YL026UL*/
*          /*                                                        */
*          /**********************************************************/
*          IF NOTDSPL > 0                                          1694
*            THEN                                                  1694
         LH    @04,PARMID                                          1694
         MH    @04,@CH00038                                        1694
         L     @02,WORKPTR                                         1694
         AL    @02,@CF01440                                        1694
         L     @04,PARMPTR(@04,@02)                                1694
         CLI   NOTDSPL(@04),0                                      1694
         BNH   @RF01694                                            1694
*              DO;                                         /*@YL026UL*/
*                WORKVAR2=NOTCOUNT;                        /*@YL026UL*/
         SLR   @15,@15                                             1696
         IC    @15,NOTDSPL(,@04)                                   1696
         ALR   @15,@15                                             1696
         ALR   @04,@15                                             1696
         LH    WORKVAR2,NOTCOUNT(,@04)                             1696
*                DO INDEX2=1 TO WORKVAR2;                 /*@YL026UL*/
         LA    @04,1                                               1697
         B     @DE01697                                            1697
@DL01697 DS    0H                                                  1698
*                  IF PARMFLAG(NOTID(INDEX2)) ^= 0                 1698
*                    THEN                                          1698
         L     @15,WORKPTR                                         1698
         LA    @14,12                                              1698
         ALR   @04,@04                                             1698
         LR    @01,@14                                             1698
         MH    @01,PARMID                                          1698
         AL    @01,@CF01440                                        1698
         L     @01,PARMPTR(@01,@15)                                1698
         SLR   @00,@00                                             1698
         IC    @00,NOTDSPL(,@01)                                   1698
         ALR   @00,@00                                             1698
         ALR   @01,@00                                             1698
         MH    @14,NOTID-2(@04,@01)                                1698
         BCTR  @15,0                                               1698
         BCTR  @15,0                                               1698
         SLR   @04,@04                                             1698
         IC    @04,PARMFLAG-10(@14,@15)                            1698
         CH    @04,@CH00125                                        1698
         BE    @RF01698                                            1698
*                      DFLTOK=NO;                          /*@YL026UL*/
         NI    DFLTOK,B'01111111'                                  1699
*                END;                                      /*@YL026UL*/
@RF01698 LA    @04,1                                               1700
         AH    @04,INDEX2                                          1700
@DE01697 STH   @04,INDEX2                                          1700
         CR    @04,WORKVAR2                                        1700
         BNH   @DL01697                                            1700
*              END;                                        /*@YL026UL*/
*                                                                  1701
*          /**********************************************************/
*          /*                                                        */
*          /* THEN CHECK FOR THE OCCURRENCE OF THIS DEFAULT  @YL026UL*/
*          /* PARAMETER IN A 'NOT GROUP' (A SET OF MUTUALLY  @YL026UL*/
*          /* EXCLUSIVE PARMS), AND BE SURE THAT NO OTHER    @YL026UL*/
*          /* PARAMETER IN THE GROUP IS INPUT                @YL026UL*/
*          /*                                                        */
*          /**********************************************************/
*          IF DFLTOK=YES & NTGRPPTR(PARMID)^=NULLPTR               1702
*            THEN                                                  1702
@RF01694 TM    DFLTOK,B'10000000'                                  1702
         BNO   @RF01702                                            1702
         LH    @04,PARMID                                          1702
         MH    @04,@CH00038                                        1702
         L     @02,WORKPTR                                         1702
         AL    @02,@CF01499                                        1702
         L     @04,NTGRPPTR-4(@04,@02)                             1702
         LTR   @04,@04                                             1702
         BZ    @RF01702                                            1702
*              DO;                                         /*@YL026UL*/
*                WORKPTR2=GRPPTR;                          /*@YL026UL*/
         MVC   WORKPTR2(4),GRPPTR                                  1704
*                GRPPTR=NTGRPPTR(PARMID);                  /*@YL026UL*/
         ST    @04,GRPPTR                                          1705
*                DO INDEX2=1 TO NTGRPCNT;                  /*@YL026UL*/
         LA    @04,1                                               1706
         B     @DE01706                                            1706
@DL01706 DS    0H                                                  1707
*                  IF PARMFLAG(NTGRPID(INDEX2))^=0 &               1707
*                     NTGRPID(INDEX2)^=PARMID                      1707
*                    THEN                                          1707
         ALR   @04,@04                                             1707
         L     @02,GRPPTR                                          1707
         LH    @04,NTGRPID-2(@04,@02)                              1707
         LR    @02,@04                                             1707
         MH    @02,@CH00038                                        1707
         L     @01,WORKPTR                                         1707
         BCTR  @01,0                                               1707
         BCTR  @01,0                                               1707
         SLR   @00,@00                                             1707
         IC    @00,PARMFLAG-10(@02,@01)                            1707
         CH    @00,@CH00125                                        1707
         BE    @RF01707                                            1707
         CH    @04,PARMID                                          1707
         BE    @RF01707                                            1707
*                      DFLTOK=NO;                          /*@YL026UL*/
         NI    DFLTOK,B'01111111'                                  1708
*                END;                                      /*@YL026UL*/
@RF01707 LA    @04,1                                               1709
         AH    @04,INDEX2                                          1709
@DE01706 STH   @04,INDEX2                                          1709
         L     @02,GRPPTR                                          1709
         CH    @04,NTGRPCNT(,@02)                                  1709
         BNH   @DL01706                                            1709
*                GRPPTR=WORKPTR2;                          /*@YL026UL*/
         MVC   GRPPTR(4),WORKPTR2                                  1710
*              END;                                        /*@YL026UL*/
*          PARMID=SUPRPARM(PARMID);                        /*@YL026UL*/
@RF01702 LH    @04,PARMID                                          1712
         MH    @04,@CH00038                                        1712
         L     @02,WORKPTR                                         1712
         AL    @02,@CF01441                                        1712
         LH    @04,SUPRPARM-8(@04,@02)                             1712
         STH   @04,PARMID                                          1712
*        END;                                              /*@YL026UL*/
*                                                                  1713
@DE01693 TM    DFLTOK,B'10000000'                                  1713
         BNO   @DC01693                                            1713
         LH    @04,PARMID                                          1713
         SLR   @02,@02                                             1713
         CR    @04,@02                                             1713
         BE    @DC01693                                            1713
         MH    @04,@CH00038                                        1713
         L     @01,WORKPTR                                         1713
         BCTR  @01,0                                               1713
         BCTR  @01,0                                               1713
         SLR   @00,@00                                             1713
         IC    @00,PARMFLAG-10(@04,@01)                            1713
         CR    @02,@00                                             1713
         BE    @DL01693                                            1713
@DC01693 DS    0H                                                  1714
*        /************************************************************/
*        /*                                                          */
*        /* IF NO CONFLICTS WILL OCCUR BY DEFAULTING THIS    @YL026UL*/
*        /* PARAMETER, NOTE THE PARM'S (AND SUPERPARM'S)     @YL026UL*/
*        /* OCCURRENCE IN THE PARMFLAG TABLE AND IN THE FDT. @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF DFLTOK=YES                                             1714
*          THEN                                                    1714
         TM    DFLTOK,B'10000000'                                  1714
         BNO   @RF01714                                            1714
*DOGRP145:   DO;                                           /*@YL026UL*/
DOGRP145 DS    0H                                                  1716
*            OLDERID2 = NEWERID2;                                  1716
         L     @04,GDTTR2(,GDTPTR)                                 1716
         MVC   @TS00001(95),NEWERID2(@04)                          1716
         MVC   OLDERID2(95,@04),@TS00001                           1716
*            NEWID2='RI44';                                /*@YL026UL*/
         MVC   NEWID2(4,@04),@CC01294                              1717
*            PARMID=DFLTPARM;                              /*@YL026UL*/
         L     @04,@PC00022                                        1718
         MVC   PARMID(2),DFLTPARM(@04)                             1718
*            DO WHILE(PARMID^=0 & PARMFLAG(PARMID)=0);     /*@YL026UL*/
*                                                                  1719
         B     @DE01719                                            1719
@DL01719 DS    0H                                                  1720
*              CALL SETFLAG;                               /*@YL026UL*/
*                                                                  1720
         BAL   @14,SETFLAG                                         1720
*              PARMID=SUPRPARM(PARMID);                    /*@YL026UL*/
         LH    @04,PARMID                                          1721
         MH    @04,@CH00038                                        1721
         L     @02,WORKPTR                                         1721
         AL    @02,@CF01441                                        1721
         LH    @04,SUPRPARM-8(@04,@02)                             1721
         STH   @04,PARMID                                          1721
*            END;                                          /*@YL026UL*/
@DE01719 LH    @04,PARMID                                          1722
         SLR   @02,@02                                             1722
         CR    @04,@02                                             1722
         BE    @DC01719                                            1722
         MH    @04,@CH00038                                        1722
         L     @01,WORKPTR                                         1722
         BCTR  @01,0                                               1722
         BCTR  @01,0                                               1722
         SLR   @00,@00                                             1722
         IC    @00,PARMFLAG-10(@04,@01)                            1722
         CR    @02,@00                                             1722
         BE    @DL01719                                            1722
@DC01719 DS    0H                                                  1723
*            PARMID=DFLTPARM;                              /*@YL026UL*/
*                                                                  1723
         L     @04,@PC00022                                        1723
         LH    @04,DFLTPARM(,@04)                                  1723
         STH   @04,PARMID                                          1723
*            /********************************************************/
*            /*                                                      */
*            /* IF A DEFAULT CONSTANT IS PROVIDED, PERFORM   @YL026UL*/
*            /* NECESSARY CONVERSION AND PLACE IT IN THE FDT @YL026UL*/
*            /*                                                      */
*            /********************************************************/
*            IF DEFAULT=YES & SCANONLY=NO                          1724
*              THEN                                                1724
         MH    @04,@CH00038                                        1724
         L     @02,WORKPTR                                         1724
         AL    @02,@CF01440                                        1724
         L     @04,PARMPTR(@04,@02)                                1724
         TM    DEFAULT(@04),B'00000100'                            1724
         BNO   @RF01724                                            1724
         TM    SCANONLY,B'00010000'                                1724
         BNZ   @RF01724                                            1724
*DOGRP150:       DO;                                       /*@YL026UL*/
DOGRP150 DS    0H                                                  1726
*                SCLRCNT=0;                                /*@YL026UL*/
         SLR   @05,@05                                             1726
         STH   @05,SCLRCNT                                         1726
*                ORGSIGN=BLANK;                            /*@YL026UL*/
         MVI   ORGSIGN,C' '                                        1727
*                PWORD=NONE;                               /*@YL026UL*/
*                                                                  1728
         SLR   PWORD,PWORD                                         1728
*                /****************************************************/
*                /*                                                  */
*                /* IF THE CONSTANT IS A HEX OR BINARY       @YL026UL*/
*                /* CONSTANT, EXTRACT THE BINARY OR HEX      @YL026UL*/
*                /* DESIGNATION CHAR. AND REMOVE DELIMITING  @YL026UL*/
*                /* APOSTROPHES BEFORE PLACING THE VALUE IN  @YL026UL*/
*                /* THE FDT.  OTHERWISE, PLACE THE CONSTANT  @YL026UL*/
*                /* INTO THE FDT IN ITS PROVIDED FORM.       @YL026UL*/
*                /*                                                  */
*                /****************************************************/
*                DEFLTPTR=PARMPTR(PARMID)+LENGTH(PARMDATA)+        1729
*                          LENGTH(DSCRPTR2);               /*@YL026UL*/
         LA    @15,12                                              1729
         LR    @14,@15                                             1729
         MH    @14,PARMID                                          1729
         L     @01,WORKPTR                                         1729
         AL    @01,@CF01440                                        1729
         L     @14,PARMPTR(@14,@01)                                1729
         LA    DEFLTPTR,24                                         1729
         ALR   DEFLTPTR,@14                                        1729
*                RESPECIFY(DEFLT) BASED(DEFLTPTR);         /*@YL026UL*/
*                IF (NUMBER=YES  ANYSTRNG=YES) & DEFLTLEN > 3 &   1731
*                   (DEFLTVAL(1)=BINSIGN  DEFLTVAL(1)=HEXSIGN) &  1731
*                   DEFLTVAL(2)=QUOTE & DEFLTVAL(DEFLTLEN)=QUOTE   1731
*                  THEN                                            1731
         ALR   @14,@15                                             1731
         TM    NUMBER(@14),B'11000000'                             1731
         BZ    @RF01731                                            1731
         CLI   DEFLTLEN(DEFLTPTR),3                                1731
         BNH   @RF01731                                            1731
         CLI   DEFLTVAL(DEFLTPTR),C'B'                             1731
         BE    @GL00099                                            1731
         CLI   DEFLTVAL(DEFLTPTR),C'X'                             1731
         BNE   @RF01731                                            1731
@GL00099 CLI   DEFLTVAL+1(DEFLTPTR),C''''                          1731
         BNE   @RF01731                                            1731
         SLR   @05,@05                                             1731
         IC    @05,DEFLTLEN(,DEFLTPTR)                             1731
         ALR   @05,DEFLTPTR                                        1731
         CLI   DEFLTVAL-1(@05),C''''                               1731
         BNE   @RF01731                                            1731
*                    DO;                                   /*@YL026UL*/
*                    ORGSIGN=DEFLTVAL(1);                  /*@YL026UL*/
         MVC   ORGSIGN(1),DEFLTVAL(DEFLTPTR)                       1733
*                    SYNUNIT=DEFLTVAL(3:DEFLTLEN-1);       /*@YL026UL*/
         MVI   SYNUNIT+1,C' '                                      1734
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1734
         SLR   @15,@15                                             1734
         IC    @15,DEFLTLEN(,DEFLTPTR)                             1734
         LR    @14,@15                                             1734
         SL    @14,@CF00052                                        1734
         EX    @14,@SM01500                                        1734
*                    UNITINDX=DEFLTLEN-3;                  /*@YL026UL*/
         SL    @15,@CF00172                                        1735
         LR    UNITINDX,@15                                        1735
*                    END;                                  /*@YL026UL*/
*                  ELSE                                            1737
*                    DO;                                   /*@YL026UL*/
         B     @RC01731                                            1737
@RF01731 DS    0H                                                  1738
*                    OLDERID2 = NEWERID2;                          1738
         L     @15,GDTTR2(,GDTPTR)                                 1738
         MVC   @TS00001(95),NEWERID2(@15)                          1738
         MVC   OLDERID2(95,@15),@TS00001                           1738
*                    NEWID2='RI45';                        /*@YL026UL*/
         MVC   NEWID2(4,@15),@CC01298                              1739
*                    SYNUNIT=DEFLTVAL(1:DEFLTLEN);         /*@YL026UL*/
         MVI   SYNUNIT+1,C' '                                      1740
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1740
         SLR   @15,@15                                             1740
         IC    @15,DEFLTLEN(,DEFLTPTR)                             1740
         LR    @14,@15                                             1740
         BCTR  @14,0                                               1740
         EX    @14,@SM01502                                        1740
*                    UNITINDX=DEFLTLEN;                    /*@YL026UL*/
         LR    UNITINDX,@15                                        1741
*                    END;                                          1742
*                                                                  1742
*                CALL BUILDFDT;                            /*@YL026UL*/
*                                                                  1743
@RC01731 BAL   @14,BUILDFDT                                        1743
*                END DOGRP150;                             /*@YL026UL*/
*            END DOGRP145;                                 /*@YL026UL*/
*                                                                  1745
*        END SETDFLT;                                      /*@YL026UL*/
*                                                                  1746
*                                                                  1746
@EL00022 DS    0H                                                  1746
@EF00022 DS    0H                                                  1746
@ER00022 LM    @14,@04,@SA00022                                    1746
         LM    @06,@12,@SA00022+28                                 1746
         BR    @14                                                 1746
*        END DEFAULTS;                                     /*@YL026UL*/
@EL00021 DS    0H                                                  1747
@EF00021 DS    0H                                                  1747
@ER00021 LM    @14,@04,@SA00021                                    1747
         LM    @06,@12,@SA00021+28                                 1747
         BR    @14                                                 1747
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NEEDNOTS                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS PARAMETERS TO INSURE THAT CERTAIN*/
*/*             SEMANTIC REQUIREMENTS HAVE NOT BEEN VIOLATED.  EACH  */
*/*             INPUT PARAMETER IS EXAMINED, CHECKING THAT OTHER     */
*/*             PARAMETERS HAVE BEEN INPUT WHICH MUST BE PRESENT WHEN*/
*/*             THIS PARAMETER IS PRESENT, AND CHECKING THAT CERTAIN */
*/*             PARAMETERS ARE NOT INPUT WHICH MUST NOT BE PRESENT   */
*/*             WHEN THIS PARAMETER IS PRESENT.  THIS ROUTINE IS     */
*/*             CALLED WHEN SCANNING OF A REPEATED SUBPARAMETER LIST */
*/*             REPETITION HAS JUST BEEN COMPLETED (ONLY REQUIREMENTS*/
*/*             WITHIN THE SUBLIST ARE CHECKED) AND THE ROUTINE IS   */
*/*             CALLED AT COMMAND TERMINATION (AT WHICH TIME ALL THE */
*/*             PARAMETER RELATIONSHIPS ARE CHECKED EXCEPT THOSE     */
*/*             INVOLVING PARAMETERS WITHIN A REPEATED SUBLIST).     */
*/*             'NEED' AND 'NOT' RELATIONSHIPS ARE NOT ALLOWED       */
*/*             BETWEEN A PARAMETER WITHIN A REPEATED SUBLIST AND A  */
*/*             PARAMETER NOT WITHIN THAT SAME SUBLIST. THE SEMANTIC */
*/*             REQUIREMENTS ARE CHECKED AFTER DEFAULTS ARE APPLIED. */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SUPERID - ID# OF THE PARAMETER WHOSE SUBLIST IS BEING   */
*/*                    CHECKED FOR SEMANTIC CORRECTNESS; ID#=0 IF    */
*/*                    CHECKING THE COMMAND AS A WHOLE               */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*                                                                  */
*/*  OUTPUT -  NONE                                                  */
*/*                                                                  */
*/********************************************************************/
*NEEDNOTS:PROCEDURE;                                               1748
NEEDNOTS STM   @14,@12,@SA00023                                    1748
*        /************************************************************/
*        /*                                                          */
*        /* NEEDNOTS PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1749
*        /* STATIC ERROR MESSAGE CODES                               */
*        DCL MISSPARM FIXED(31)        /*REQUIRED PARM IS MISSING    */
*                     CONSTANT(26);                                1749
*        DCL BADPARM  FIXED(31)        /*PARAMETER IS PRESENT WHICH  */
*                     CONSTANT(27);    /* IS NOT ALLOWED             */
*                                                                  1750
*        DCL WORKVAR3 FIXED(15);       /*VARIABLE TO CONTAIN @YL026UL*/
*                                      /*A TEMPORARY VALUE   @YL026UL*/
*        DCL FOUNDONE BIT(1);          /*FLAG SET TO AVOID PRINTING
*                                        THE SAME ERROR MSG TWICE    */
*        /************************************************************/
*        /*                                                          */
*        /*  ** NEEDNOTS **  CHECK 'NEED' AND 'NOT' REQUIREMENTS     */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1753
*          THEN;                                                   1753
         ICM   @02,15,GDTDBG(GDTPTR)                               1753
         BZ    @RT01753                                            1753
*          ELSE                                                    1755
*            CALL IDCDB010(GDTTBL,'RINN');                         1755
*                                                                  1755
         ST    GDTPTR,@AL00001                                     1755
         LA    @02,@CC01308                                        1755
         ST    @02,@AL00001+4                                      1755
         MVI   @AL00001+4,X'80'                                    1755
         L     @15,GDTDBG(,GDTPTR)                                 1755
         LA    @01,@AL00001                                        1755
         BALR  @14,@15                                             1755
*        /************************************************************/
*        /*                                                          */
*        /* IF AT COMMAND END, CHECK VERB LEVEL 'NEED        @YL026UL*/
*        /* GROUPS'.  THAT IS, CHECK FOR GROUPS OF PARMS     @YL026UL*/
*        /* (WHICH DON'T APPEAR WITHIN REPEATED SUBLISTS)    @YL026UL*/
*        /* ONE OF WHICH MUST BE INPUT.                      @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*        IF SUPERID(PARMLVL)=0 & VNGRPDSP>0                        1756
*          THEN                                                    1756
@RT01753 LH    @02,PARMLVL                                         1756
         ALR   @02,@02                                             1756
         LH    @02,SUPERID-2(@02)                                  1756
         LTR   @02,@02                                             1756
         BNZ   @RF01756                                            1756
         L     @02,DESCPTR                                         1756
         CLI   VNGRPDSP(@02),0                                     1756
         BNH   @RF01756                                            1756
*DOGRP155:   DO;                                           /*@YL026UL*/
DOGRP155 DS    0H                                                  1758
*              GRPPTR=ADDR(VNGRPTOT)+LENGTH(VNGRPTOT);     /*@YL026UL*/
         L     @02,DESCPTR                                         1758
         SLR   @15,@15                                             1758
         IC    @15,VNGRPDSP(,@02)                                  1758
         ALR   @15,@15                                             1758
         ALR   @02,@15                                             1758
         AL    @02,@CF00163                                        1758
         ST    @02,GRPPTR                                          1758
*DOLOOP35:     DO LISTINDX=1 TO VNGRPTOT;                  /*@YL026UL*/
DOLOOP35 LA    @02,1                                               1759
         B     @DE01759                                            1759
@DL01759 DS    0H                                                  1760
*                FOUNDONE=NO;                              /*@YL026UL*/
*                                                                  1760
         NI    FOUNDONE,B'01111111'                                1760
*                /****************************************************/
*                /*                                                  */
*                /* CHECK EACH 'NEED GROUP' SUBLIST TO BE    @YL026UL*/
*                /* SURE AT LEAST ONE OF THE PARAMETERS OF   @YL026UL*/
*                /* IDENTIFIED IN THE SUBLIST IS INPUT.      @YL026UL*/
*                /*                                                  */
*                /****************************************************/
*                DO INDEX2=1 TO VNGRPCNT;                  /*@YL026UL*/
         LA    @02,1                                               1761
         B     @DE01761                                            1761
@DL01761 DS    0H                                                  1762
*                  IF PARMFLAG(VNGRPID(INDEX2))^=0                 1762
*                    THEN                                          1762
         ALR   @02,@02                                             1762
         L     @01,GRPPTR                                          1762
         LH    @02,VNGRPID-2(@02,@01)                              1762
         MH    @02,@CH00038                                        1762
         L     @01,WORKPTR                                         1762
         BCTR  @01,0                                               1762
         BCTR  @01,0                                               1762
         SLR   @00,@00                                             1762
         IC    @00,PARMFLAG-10(@02,@01)                            1762
         CH    @00,@CH00125                                        1762
         BE    @RF01762                                            1762
*                      FOUNDONE=YES;                       /*@YL026UL*/
         OI    FOUNDONE,B'10000000'                                1763
*                END;                                      /*@YL026UL*/
@RF01762 LA    @02,1                                               1764
         AH    @02,INDEX2                                          1764
@DE01761 STH   @02,INDEX2                                          1764
         L     @01,GRPPTR                                          1764
         CH    @02,VNGRPCNT(,@01)                                  1764
         BNH   @DL01761                                            1764
*                IF FOUNDONE=NO                                    1765
*                  THEN                                            1765
*                                                                  1765
         TM    FOUNDONE,B'10000000'                                1765
         BNZ   @RF01765                                            1765
*                    CALL ERRSETUP(MISSPARM,VNGRPID(1));   /*@YL026UL*/
*                                                                  1766
         LA    @02,@CF01303                                        1766
         ST    @02,@AL00001                                        1766
         L     @02,GRPPTR                                          1766
         LA    @02,VNGRPID(,@02)                                   1766
         ST    @02,@AL00001+4                                      1766
         LA    @01,@AL00001                                        1766
         BAL   @14,ERRSETUP                                        1766
*                GRPPTR=GRPPTR+LENGTH(VNGRPCNT)+                   1767
*                            VNGRPCNT*LENGTH(VNGRPID(1));  /*@YL026UL*/
@RF01765 L     @02,GRPPTR                                          1767
         LA    @15,2                                               1767
         ALR   @15,@02                                             1767
         LH    @02,VNGRPCNT(,@02)                                  1767
         ALR   @02,@02                                             1767
         ALR   @15,@02                                             1767
         ST    @15,GRPPTR                                          1767
*              END DOLOOP35;                               /*@YL026UL*/
         LA    @02,1                                               1768
         AH    @02,LISTINDX                                        1768
@DE01759 STH   @02,LISTINDX                                        1768
         L     @01,DESCPTR                                         1768
         SLR   @15,@15                                             1768
         IC    @15,VNGRPDSP(,@01)                                  1768
         ALR   @15,@15                                             1768
         AL    @15,DESCPTR                                         1768
         CH    @02,VNGRPTOT(,@15)                                  1768
         BNH   @DL01759                                            1768
*            END DOGRP155;                                 /*@YL026UL*/
*                                                                  1769
*        /************************************************************/
*        /*                                                          */
*        /* CHECK EACH PARAMETER TO SEE IF IT IS PART OF THE @YL026UL*/
*        /* SET OF PARAMETERS CURRENTLY BEING HANDLED.  IF   @YL026UL*/
*        /* SO, CHECK THE LIST(S) OF REQUIRED PARAMETERS     @YL026UL*/
*        /* AND CONFLICTING PARAMETERS ASSOCIATED WITH EACH  @YL026UL*/
*        /* PARAMETER TO SEE IF ANY ERRORS EXIST.            @YL026UL*/
*        /*                                                          */
*        /************************************************************/
*DOLOOP40:DO PARMID=1 TO MAXID;                            /*@YL026UL*/
@RF01756 DS    0H                                                  1770
DOLOOP40 LA    @02,1                                               1770
         B     @DE01770                                            1770
@DL01770 DS    0H                                                  1771
*          IF PARMFLAG(PARMID)^=0                                  1771
*            THEN                                                  1771
         MH    @02,@CH00038                                        1771
         L     @01,WORKPTR                                         1771
         BCTR  @01,0                                               1771
         BCTR  @01,0                                               1771
         SLR   @00,@00                                             1771
         IC    @00,PARMFLAG-10(@02,@01)                            1771
         CH    @00,@CH00125                                        1771
         BE    @RF01771                                            1771
*DOGRP170:     DO;                                         /*@YL026UL*/
DOGRP170 DS    0H                                                  1773
*                FOUND=NO;                                 /*@YL026UL*/
         NI    FOUND,B'11011111'                                   1773
*                TESTID=PARMID;                            /*@YL026UL*/
         LH    TESTID,PARMID                                       1774
*                DO WHILE(TESTID^=0 & FOUND=NO);           /*@YL026UL*/
         B     @DE01775                                            1775
@DL01775 DS    0H                                                  1776
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1776
*                    THEN                                          1776
         LR    @05,TESTID                                          1776
         MH    @05,@CH00038                                        1776
         LH    @02,PARMLVL                                         1776
         ALR   @02,@02                                             1776
         L     @01,WORKPTR                                         1776
         AL    @01,@CF01441                                        1776
         LH    @05,SUPRPARM-8(@05,@01)                             1776
         CH    @05,SUPERID-2(@02)                                  1776
         BNE   @RF01776                                            1776
*                      FOUND=YES;                          /*@YL026UL*/
         OI    FOUND,B'00100000'                                   1777
*                    ELSE                                          1778
*                      DO;                                 /*@YL026UL*/
         B     @RC01776                                            1778
@RF01776 DS    0H                                                  1779
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/
         L     @05,WORKPTR                                         1779
         LA    @02,12                                              1779
         LR    @01,TESTID                                          1779
         MR    @00,@02                                             1779
         AL    @01,@CF01441                                        1779
         LH    @15,SUPRPARM-8(@01,@05)                             1779
         LR    TESTID,@15                                          1779
*                      IF PARMPTR(TESTID)->REPEATED=YES            1780
*                        THEN                                      1780
         LR    @01,@02                                             1780
         MR    @00,TESTID                                          1780
         AL    @05,@CF01440                                        1780
         L     @05,PARMPTR(@01,@05)                                1780
         TM    REPEATED(@05),B'00100000'                           1780
         BNO   @RF01780                                            1780
*                          TESTID=0;                       /*@YL026UL*/
         SLR   TESTID,TESTID                                       1781
*                      END;                                /*@YL026UL*/
@RF01780 DS    0H                                                  1783
*                END;                                      /*@YL026UL*/
*                                                                  1783
@RC01776 DS    0H                                                  1783
@DE01775 LTR   TESTID,TESTID                                       1783
         BZ    @DC01775                                            1783
         TM    FOUND,B'00100000'                                   1783
         BZ    @DL01775                                            1783
@DC01775 DS    0H                                                  1784
*                IF FOUND=YES                                      1784
*                  THEN                                            1784
         TM    FOUND,B'00100000'                                   1784
         BNO   @RF01784                                            1784
*DOGRP160:           DO;                                   /*@YL026UL*/
*                                                                  1785
DOGRP160 DS    0H                                                  1786
*                    /************************************************/
*                    /*                                              */
*                    /* IF 'NEED GROUPS' EXIST FOR THIS      @YL026UL*/
*                    /* PARAMETER, CHECK TO INSURE THAT AT   @YL026UL*/
*                    /* LEAST ONE PARAMETER IN EACH GROUP    @YL026UL*/
*                    /* IS INPUT (A 'GROUP' MAY BE JUST A    @YL026UL*/
*                    /* SINGLE PARAMETER THAT IS ALWAYS      @YL026UL*/
*                    /* REQUIRED).                           @YL026UL*/
*                    /*                                              */
*                    /************************************************/
*                    IF NGRPDSPL > 0                               1786
*                      THEN                                        1786
         LH    @02,PARMID                                          1786
         MH    @02,@CH00038                                        1786
         L     @01,WORKPTR                                         1786
         AL    @01,@CF01440                                        1786
         L     @02,PARMPTR(@02,@01)                                1786
         CLI   NGRPDSPL(@02),0                                     1786
         BNH   @RF01786                                            1786
*DOGRP165:               DO;                               /*@YL026UL*/
DOGRP165 DS    0H                                                  1788
*                          GRPPTR=ADDR(NGRPTOT)+                   1788
*                                          LENGTH(NGRPTOT);/*@YL026UL*/
         LH    @15,PARMID                                          1788
         MH    @15,@CH00038                                        1788
         L     @01,WORKPTR                                         1788
         AL    @01,@CF01440                                        1788
         L     @15,PARMPTR(@15,@01)                                1788
         SLR   @14,@14                                             1788
         IC    @14,NGRPDSPL(,@15)                                  1788
         ALR   @14,@14                                             1788
         ALR   @15,@14                                             1788
         LA    @14,2                                               1788
         ALR   @14,@15                                             1788
         ST    @14,GRPPTR                                          1788
*                          WORKVAR3=NGRPTOT;               /*@YL026UL*/
         LH    WORKVAR3,NGRPTOT(,@15)                              1789
*DOLOOP42:                 DO LISTINDX=1 TO WORKVAR3;      /*@YL026UL*/
DOLOOP42 LA    @15,1                                               1790
         B     @DE01790                                            1790
@DL01790 DS    0H                                                  1791
*                            FOUNDONE=NO;                  /*@YL026UL*/
         NI    FOUNDONE,B'01111111'                                1791
*                            DO INDEX2=1 TO NGRPCNT;       /*@YL026UL*/
         LA    @15,1                                               1792
         B     @DE01792                                            1792
@DL01792 DS    0H                                                  1793
*                              IF PARMFLAG(NGRPID(INDEX2))^=0      1793
*                                THEN                              1793
         ALR   @15,@15                                             1793
         L     @01,GRPPTR                                          1793
         LH    @15,NGRPID-2(@15,@01)                               1793
         MH    @15,@CH00038                                        1793
         L     @01,WORKPTR                                         1793
         BCTR  @01,0                                               1793
         BCTR  @01,0                                               1793
         SLR   @14,@14                                             1793
         IC    @14,PARMFLAG-10(@15,@01)                            1793
         CH    @14,@CH00125                                        1793
         BE    @RF01793                                            1793
*                                  FOUNDONE=YES;           /*@YL026UL*/
         OI    FOUNDONE,B'10000000'                                1794
*                            END;                          /*@YL026UL*/
@RF01793 LA    @15,1                                               1795
         AH    @15,INDEX2                                          1795
@DE01792 STH   @15,INDEX2                                          1795
         L     @14,GRPPTR                                          1795
         CH    @15,NGRPCNT(,@14)                                   1795
         BNH   @DL01792                                            1795
*                            IF FOUNDONE=NO                        1796
*                              THEN                                1796
*                                                                  1796
         TM    FOUNDONE,B'10000000'                                1796
         BNZ   @RF01796                                            1796
*                                CALL ERRSETUP(MISSPARM,           1797
*                                              NGRPID(1)); /*@YL026UL*/
*                                                                  1797
         LA    @15,@CF01303                                        1797
         ST    @15,@AL00001                                        1797
         L     @01,GRPPTR                                          1797
         LA    @15,NGRPID(,@01)                                    1797
         ST    @15,@AL00001+4                                      1797
         LA    @01,@AL00001                                        1797
         BAL   @14,ERRSETUP                                        1797
*                            GRPPTR=GRPPTR+LENGTH(NGRPCNT)+        1798
*                               NGRPCNT*LENGTH(NGRPID(1)); /*@YL026UL*/
@RF01796 L     @15,GRPPTR                                          1798
         LA    @14,2                                               1798
         ALR   @14,@15                                             1798
         LH    @15,NGRPCNT(,@15)                                   1798
         ALR   @15,@15                                             1798
         ALR   @14,@15                                             1798
         ST    @14,GRPPTR                                          1798
*                          END DOLOOP42;                   /*@YL026UL*/
         LA    @15,1                                               1799
         AH    @15,LISTINDX                                        1799
@DE01790 STH   @15,LISTINDX                                        1799
         CR    @15,WORKVAR3                                        1799
         BNH   @DL01790                                            1799
*                        END DOGRP165;                     /*@YL026UL*/
*                                                                  1800
*                    /************************************************/
*                    /*                                              */
*                    /* IF A LIST OF PARAMETERS EXISTS       @YL026UL*/
*                    /* NOTING PARAMETERS WHICH CONFLICT     @YL026UL*/
*                    /* WITH THIS PARTICULAR PARAMETER,      @YL026UL*/
*                    /* CHECK THAT NONE OF THEM WERE INPUT   @YL026UL*/
*                    /*                                              */
*                    /************************************************/
*                    FOUNDONE=NO;                          /*@YL026UL*/
@RF01786 NI    FOUNDONE,B'01111111'                                1801
*                    IF NOTDSPL > 0                                1802
*                      THEN                                        1802
         LH    @02,PARMID                                          1802
         MH    @02,@CH00038                                        1802
         L     @01,WORKPTR                                         1802
         AL    @01,@CF01440                                        1802
         L     @02,PARMPTR(@02,@01)                                1802
         CLI   NOTDSPL(@02),0                                      1802
         BNH   @RF01802                                            1802
*                        DO;                               /*@YL026UL*/
         ST    @02,@TF00001                                        1803
*                          WORKVAR3=NOTCOUNT;              /*@YL026UL*/
         L     @01,@TF00001                                        1804
         SLR   @15,@15                                             1804
         IC    @15,NOTDSPL(,@01)                                   1804
         ALR   @15,@15                                             1804
         AL    @15,@TF00001                                        1804
         LH    WORKVAR3,NOTCOUNT(,@15)                             1804
*                          DO LISTINDX=1 TO WORKVAR3               1805
*                                      WHILE(FOUNDONE=NO); /*@YL026UL*/
         LA    @15,1                                               1805
         B     @DE01805                                            1805
@DL01805 TM    FOUNDONE,B'10000000'                                1805
         BNZ   @DC01805                                            1805
*                            IF PARMFLAG(NOTID(LISTINDX)) ^= 0     1806
*                              THEN                                1806
*                                                                  1806
         L     @14,WORKPTR                                         1806
         LA    @05,12                                              1806
         ALR   @15,@15                                             1806
         LR    @04,@05                                             1806
         MH    @04,PARMID                                          1806
         AL    @04,@CF01440                                        1806
         L     @04,PARMPTR(@04,@14)                                1806
         SLR   @01,@01                                             1806
         IC    @01,NOTDSPL(,@04)                                   1806
         ALR   @01,@01                                             1806
         ALR   @04,@01                                             1806
         MH    @05,NOTID-2(@15,@04)                                1806
         BCTR  @14,0                                               1806
         BCTR  @14,0                                               1806
         SLR   @15,@15                                             1806
         IC    @15,PARMFLAG-10(@05,@14)                            1806
         CH    @15,@CH00125                                        1806
         BE    @RF01806                                            1806
*                                CALL ERRSETUP(BADPARM,            1807
*                                              PARMID);    /*@YL026UL*/
*                                                                  1807
         LA    @15,@CF01305                                        1807
         ST    @15,@AL00001                                        1807
         LA    @15,PARMID                                          1807
         ST    @15,@AL00001+4                                      1807
         LA    @01,@AL00001                                        1807
         BAL   @14,ERRSETUP                                        1807
*                          END;                            /*@YL026UL*/
@RF01806 LA    @15,1                                               1808
         AH    @15,LISTINDX                                        1808
@DE01805 STH   @15,LISTINDX                                        1808
         CR    @15,WORKVAR3                                        1808
         BNH   @DL01805                                            1808
@DC01805 DS    0H                                                  1809
*                        END;                              /*@YL026UL*/
*                                                                  1809
*                    /************************************************/
*                    /*                                              */
*                    /* IF THE CURRENT PARAMETER IS ONE OF   @YL026UL*/
*                    /* THE PARMS IDENTIFIED IN A 'NOT       @YL026UL*/
*                    /* GROUPS' SUBLIST (A SET OF MUTUALLY   @YL026UL*/
*                    /* EXCLUSIVE PARAMETERS), THEN CHECK TO @YL026UL*/
*                    /* BE SURE NONE OF THE OTHER PARAMETERS @YL026UL*/
*                    /* IDENTIFIED IN THE SUBLIST WERE INPUT @YL026UL*/
*                    /*                                              */
*                    /************************************************/
*                    IF NTGRPPTR(PARMID) ^= 0                      1810
*                      THEN                                        1810
@RF01802 LH    @02,PARMID                                          1810
         MH    @02,@CH00038                                        1810
         L     @01,WORKPTR                                         1810
         AL    @01,@CF01499                                        1810
         L     @02,NTGRPPTR-4(@02,@01)                             1810
         LTR   @02,@02                                             1810
         BZ    @RF01810                                            1810
*                        DO;                               /*@YL026UL*/
*                          GRPPTR=NTGRPPTR(PARMID);        /*@YL026UL*/
         ST    @02,GRPPTR                                          1812
*                          DO LISTINDX=1 TO NTGRPCNT               1813
*                                      WHILE(FOUNDONE=NO); /*@YL026UL*/
         LA    @02,1                                               1813
         B     @DE01813                                            1813
@DL01813 TM    FOUNDONE,B'10000000'                                1813
         BNZ   @DC01813                                            1813
*                            IF PARMFLAG(NTGRPID(LISTINDX)) ^= 0  &
*                               NTGRPID(LISTINDX) ^= PARMID        1814
*                              THEN                                1814
*                                                                  1814
         ALR   @02,@02                                             1814
         L     @01,GRPPTR                                          1814
         LH    @02,NTGRPID-2(@02,@01)                              1814
         LR    @15,@02                                             1814
         MH    @15,@CH00038                                        1814
         L     @01,WORKPTR                                         1814
         BCTR  @01,0                                               1814
         BCTR  @01,0                                               1814
         SLR   @14,@14                                             1814
         IC    @14,PARMFLAG-10(@15,@01)                            1814
         CH    @14,@CH00125                                        1814
         BE    @RF01814                                            1814
         CH    @02,PARMID                                          1814
         BE    @RF01814                                            1814
*                                CALL ERRSETUP(BADPARM,            1815
*                                               PARMID);   /*@YL026UL*/
*                                                                  1815
         LA    @02,@CF01305                                        1815
         ST    @02,@AL00001                                        1815
         LA    @02,PARMID                                          1815
         ST    @02,@AL00001+4                                      1815
         LA    @01,@AL00001                                        1815
         BAL   @14,ERRSETUP                                        1815
*                          END;                            /*@YL026UL*/
@RF01814 LA    @02,1                                               1816
         AH    @02,LISTINDX                                        1816
@DE01813 STH   @02,LISTINDX                                        1816
         L     @01,GRPPTR                                          1816
         CH    @02,NTGRPCNT(,@01)                                  1816
         BNH   @DL01813                                            1816
@DC01813 DS    0H                                                  1817
*                        END;                              /*@YL026UL*/
*                    END DOGRP160;                         /*@YL026UL*/
@RF01810 DS    0H                                                  1819
*              END DOGRP170;                               /*@YL026UL*/
@RF01784 DS    0H                                                  1820
*        END DOLOOP40;                                     /*@YL026UL*/
@RF01771 LA    @02,1                                               1820
         AH    @02,PARMID                                          1820
@DE01770 STH   @02,PARMID                                          1820
         L     @01,DESCPTR                                         1820
         CH    @02,MAXID(,@01)                                     1820
         BNH   @DL01770                                            1820
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - ERRSETUP                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SEARCHES FOR A KEYWORD TO BE INSERTED   */
*/*             INTO AN ERROR MESSAGE CONCERNING REQUIRED PARAMETERS */
*/*             WHICH ARE MISSING OR INVALID COMBINATIONS OF PARM'S. */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          ERRPRMID- PARAMETER ID# OF PARAMETER WHICH IS IN ERROR  */
*/*          ERRMSGID- MESSAGE ID# OF MESSAGE INTO WHICH THE KEYWORD */
*/*                    IS TO BE INSERTED                             */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          ERRMSGID- SEE 'INPUT'                                   */
*/*          ERRFIELD- CONTAINS THE KEYWORD TO BE INSERTED INTO THE  */
*/*                    ERROR MESSAGE                                 */
*/*                                                                  */
*/********************************************************************/
*ERRSETUP:PROCEDURE(ERRMSGID,          /*STATIC ERROR MESSAGE CODE   */
*                   ERRPRMID);         /*PARM ID# OF INVALID PARM.   */
         B     @PB00024                                            1821
ERRSETUP STM   @14,@12,@SA00024                                    1821
         MVC   @PC00024(8),0(@01)                                  1821
*        /************************************************************/
*        /*                                                          */
*        /* ERRSETUP ROUTINE DATA DEFINITIONS                        */
*        /*                                                          */
*        /************************************************************/
*        DCL ERRMSGID FIXED(31);       /*STATIC ERROR MESSAGE CODE   */
*        DCL ERRPRMID FIXED(15);       /*PARAMETER ID# OR MISSING OR
*                                        INCONSISTENT PARAMETER      */
*        /************************************************************/
*        /*                                                          */
*        /*  ** ERRSETUP **  SET UP KEYWORD NAME FOR ERROR MESSAGE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1824
*        FOUNDONE=YES;                                             1824
         OI    FOUNDONE,B'10000000'                                1824
*        TESTID=PARMID;                                            1825
         LH    TESTID,PARMID                                       1825
*        PARMID=ERRPRMID;                                          1826
         L     @05,@PC00024+4                                      1826
         MVC   PARMID(2),ERRPRMID(@05)                             1826
*        DO WHILE(PARMID ^= 0);                                    1827
         B     @DE01827                                            1827
@DL01827 DS    0H                                                  1828
*          IF KWDDSPL ^= 0                                         1828
*            THEN                                                  1828
         LH    @05,PARMID                                          1828
         MH    @05,@CH00038                                        1828
         L     @02,WORKPTR                                         1828
         AL    @02,@CF01440                                        1828
         L     @05,PARMPTR(@05,@02)                                1828
         CLI   KWDDSPL(@05),0                                      1828
         BE    @RF01828                                            1828
*              DO;                                                 1829
*              KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);             1830
         SLR   KWDPTR,KWDPTR                                       1830
         IC    KWDPTR,KWDDSPL(,@05)                                1830
         ALR   KWDPTR,KWDPTR                                       1830
         ALR   @05,KWDPTR                                          1830
         AL    @05,@CF00228                                        1830
         LR    KWDPTR,@05                                          1830
*              ERRFIELD=BLANK;                                     1831
         MVI   ERRFIELD+1,C' '                                     1831
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1831
         MVI   ERRFIELD,C' '                                       1831
*              ERRFIELD=KWDITEM(1:KWDLEN);                         1832
         MVI   ERRFIELD+1,C' '                                     1832
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1832
         SLR   @05,@05                                             1832
         IC    @05,KWDLEN(,KWDPTR)                                 1832
         BCTR  @05,0                                               1832
         EX    @05,@SM01504                                        1832
*              PARMID=0;                                           1833
         SLR   @05,@05                                             1833
         STH   @05,PARMID                                          1833
*              END;                                                1834
*            ELSE                                                  1835
*              PARMID=SUPRPARM(PARMID);                            1835
         B     @RC01828                                            1835
@RF01828 LH    @05,PARMID                                          1835
         MH    @05,@CH00038                                        1835
         L     @02,WORKPTR                                         1835
         AL    @02,@CF01441                                        1835
         LH    @05,SUPRPARM-8(@05,@02)                             1835
         STH   @05,PARMID                                          1835
*        END;                                                      1836
*                                                                  1836
@RC01828 DS    0H                                                  1836
@DE01827 ICM   @05,3,PARMID                                        1836
         BNZ   @DL01827                                            1836
*        CALL ERROR2(ERRMSGID,LENGTH(ERRFIELD),ADDR(ERRFIELD));    1837
*                                                                  1837
         L     @05,@PC00024                                        1837
         ST    @05,@AL00001                                        1837
         LA    @05,@CF00786                                        1837
         ST    @05,@AL00001+4                                      1837
         LA    @05,ERRFIELD                                        1837
         ST    @05,@AFTEMPS+36                                     1837
         LA    @05,@AFTEMPS+36                                     1837
         ST    @05,@AL00001+8                                      1837
         LA    @01,@AL00001                                        1837
         BAL   @14,ERROR2                                          1837
*        PARMID=TESTID;                                            1838
*                                                                  1838
         STH   TESTID,PARMID                                       1838
*        END ERRSETUP;                                             1839
*                                                                  1839
*                                                                  1839
@EL00024 DS    0H                                                  1839
@EF00024 DS    0H                                                  1839
@ER00024 LM    @14,@12,@SA00024                                    1839
         BR    @14                                                 1839
*        END NEEDNOTS;                                             1840
@EL00023 DS    0H                                                  1840
@EF00023 DS    0H                                                  1840
@ER00023 LM    @14,@12,@SA00023                                    1840
         BR    @14                                                 1840
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SKIPCMD                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE BYPASSES CHARACTERS UNTIL A COMMAND-END */
*/*             DELIMITER IS FOUND WHICH DOES NOT APPEAR WITHIN A    */
*/*             COMMENT.  IT IS INVOKED WHEN A SYNTAX OR SEMANTIC    */
*/*             ERROR HAS BEEN FOUND WHICH REQUIRES THAT THE CURRENT */
*/*             COMMAND BE BYPASSED.                                 */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS DETECTED.               */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT THE COMMAND HAS  */
*/*                    BEEN BYPASSED.                                */
*/*                                                                  */
*/********************************************************************/
*SKIPCMD:PROCEDURE;                                                1841
SKIPCMD  STM   @14,@12,@SA00025                                    1841
*        /************************************************************/
*        /*                                                          */
*        /* SKIPCMD PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL SKIPDONE BIT(1);          /*THE COMMAND HAS BEEN      1842
*                                        COMPLETELY BYPASSED.        */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SKIPCMD **  BYPASS CURRENT COMMAND                   */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1843
*          THEN;                                                   1843
         ICM   @02,15,GDTDBG(GDTPTR)                               1843
         BZ    @RT01843                                            1843
*          ELSE                                                    1845
*            CALL IDCDB010(GDTTBL,'RISK');                         1845
*                                                                  1845
         ST    GDTPTR,@AL00001                                     1845
         LA    @02,@CC01335                                        1845
         ST    @02,@AL00001+4                                      1845
         MVI   @AL00001+4,X'80'                                    1845
         L     @15,GDTDBG(,GDTPTR)                                 1845
         LA    @01,@AL00001                                        1845
         BALR  @14,@15                                             1845
*        COMMENT=NO;                                               1846
@RT01843 NI    COMMENT,B'10111111'                                 1846
*        SKIPDONE=NO;                                              1847
         NI    SKIPDONE,B'01111111'                                1847
*        SKIPPAST=YES;                                             1848
*                                                                  1848
         OI    SKIPPAST,B'00001000'                                1848
*        /************************************************************/
*        /*                                                          */
*        /* SCAN PAST CHARACTERS UNTIL THE COMMAND-END DELIMITER IS  */
*        /* FOUND.  THE DELIMITER WILL NEVER BE WITHIN A COMMENT.    */
*        /*                                                          */
*        /************************************************************/
*        DO WHILE(SKIPDONE=NO & RISTATUS^=EOFILE & RISTATUS^=SKIPREST);
         B     @DE01849                                            1849
@DL01849 DS    0H                                                  1850
*          IF COMMENT=NO                                           1850
*            THEN                                                  1850
         TM    COMMENT,B'01000000'                                 1850
         BNZ   @RF01850                                            1850
*              IF CHAR1=ENDDELIM                                   1851
*                THEN                                              1851
         CLI   CHAR1,C';'                                          1851
         BNE   @RF01851                                            1851
*                  SKIPDONE=YES;                                   1852
*                                                                  1852
         OI    SKIPDONE,B'10000000'                                1852
*                /****************************************************/
*                /*                                                  */
*                /* IF NOT COMMAND END, THEN CONTINUE SCANNING,      */
*                /* CHECKING TO SEE IF THE BEGINNING OF A COMMENT    */
*                /* HAS BEEN FOUND.                                  */
*                /*                                                  */
*                /****************************************************/
*                ELSE                                              1853
*                  IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)        1853
*                    THEN                                          1853
         B     @RC01851                                            1853
@RF01851 CLC   CHAR1(1),COMSTART                                   1853
         BNE   @RF01853                                            1853
         CLC   CHAR2(1),COMSTART+1                                 1853
         BNE   @RF01853                                            1853
*                      DO;                                         1854
*                                                                  1854
*                      CALL NEXTCHAR;                              1855
*                                                                  1855
         BAL   @14,NEXTCHAR                                        1855
*                      COMMENT=YES;                                1856
         OI    COMMENT,B'01000000'                                 1856
*                      END;                                        1857
*                    ELSE;                                         1858
@RF01853 DS    0H                                                  1859
*            ELSE                                                  1859
*                                                                  1859
*              /******************************************************/
*              /*                                                    */
*              /* IF CURRENTLY BYPASSING CHARACTERS WITHIN A COMMENT,*/
*              /* CHECK FOR THE COMMENT-END DELIMITER WHICH SIGNALS  */
*              /* END OF COMMENT.  IF AN R/I-GENERATED SEMICOLON IS  */
*              /* FOUND IN MID-COMMENT, CONSIDER THAT TO BE THE END  */
*              /* OF THE COMMAND.                                    */
*              /*                                                    */
*              /******************************************************/
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                1859
*                THEN                                              1859
         B     @RC01850                                            1859
@RF01850 CLC   CHAR1(1),COMEND                                     1859
         BNE   @RF01859                                            1859
         CLC   CHAR2(1),COMEND+1                                   1859
         BNE   @RF01859                                            1859
*                  DO;                                             1860
*                  COMMENT=NO;                                     1861
*                                                                  1861
         NI    COMMENT,B'10111111'                                 1861
*                  CALL NEXTCHAR;                                  1862
*                                                                  1862
         BAL   @14,NEXTCHAR                                        1862
*                  END;                                            1863
*                ELSE                                              1864
*                  IF CHAR1=ENDDELIM &                             1864
*                     (OPTSFLAG=ON  MORTOCOM=NO) &                1864
*                     SCANINDX >= SCNLIMIT                         1864
*                    THEN                                          1864
         B     @RC01859                                            1864
@RF01859 CLI   CHAR1,C';'                                          1864
         BNE   @RF01864                                            1864
         TM    OPTSFLAG,B'00100000'                                1864
         BO    @GL00108                                            1864
         TM    MORTOCOM,B'00010000'                                1864
         BNZ   @RF01864                                            1864
@GL00108 LH    @02,SCANINDX                                        1864
         CH    @02,SCNLIMIT                                        1864
         BL    @RF01864                                            1864
*                      SKIPDONE=YES;                               1865
*                                                                  1865
         OI    SKIPDONE,B'10000000'                                1865
*          /**********************************************************/
*          /*                                                        */
*          /* IF THE END OF THE COMMAND HAS NOT YET BEEN FOUND, GET  */
*          /* THE NEXT INPUT CHARACTER.                              */
*          /*                                                        */
*          /**********************************************************/
*          IF SKIPDONE=NO                                          1866
*            THEN                                                  1866
*                                                                  1866
@RF01864 DS    0H                                                  1866
@RC01859 DS    0H                                                  1866
@RC01850 TM    SKIPDONE,B'10000000'                                1866
         BNZ   @RF01866                                            1866
*              CALL NEXTCHAR;                                      1867
*                                                                  1867
         BAL   @14,NEXTCHAR                                        1867
*        END;                                                      1868
*                                                                  1868
@RF01866 DS    0H                                                  1868
@DE01849 TM    SKIPDONE,B'10000000'                                1868
         BNZ   @DC01849                                            1868
         LH    @02,RISTATUS                                        1868
         CH    @02,@CH00157                                        1868
         BE    @DC01849                                            1868
         CH    @02,@CH00042                                        1868
         BNE   @DL01849                                            1868
@DC01849 DS    0H                                                  1869
*        END SKIPCMD;                                              1869
@EL00025 DS    0H                                                  1869
@EF00025 DS    0H                                                  1869
@ER00025 LM    @14,@12,@SA00025                                    1869
         BR    @14                                                 1869
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SETFLAG                                        */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE SETS A FLAG IN AN ARRAY OF FLAGS TO   */
*/*             TO NOTE THAT A GIVEN PARAMETER HAS BEEN INPUT.  THE  */
*/*             NTH FLAG IS SET 'ON' WHEN THE PARAMETER WHOSE ID#=N  */
*/*             HAS BEEN FOUND AS INPUT (EITHER EXTRACTED FROM THE   */
*/*             INPUT RECORD OR INPUT BY DEFAULT).  ALSO, THE FDT    */
*/*             VECTOR POINTER FOR THE PARAMETER IS SET TO A NON-NULL*/
*/*             VALUE TO SIGNAL THE FSR THAT THE PARAMETER IS INPUT. */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          PARMID -  ID# OF THE PARAMETER BEING ACKNOWLEDGED       */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */
*/*          ARRYPTR - POINTER TO FDT PTR VECTOR FOR THIS PARAMETER  */
*/*                                                                  */
*/********************************************************************/
*SETFLAG:PROCEDURE;                                                1870
SETFLAG  STM   @14,@12,@SA00026                                    1870
*        /************************************************************/
*        /*                                                          */
*        /*  ** SETFLAG **  SET PARAMETER OCCURRENCE FLAG            */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1871
*          THEN;                                                   1871
         ICM   @02,15,GDTDBG(GDTPTR)                               1871
         BZ    @RT01871                                            1871
*          ELSE                                                    1873
*            CALL IDCDB010(GDTTBL,'RISF');                         1873
*                                                                  1873
         ST    GDTPTR,@AL00001                                     1873
         LA    @02,@CC01339                                        1873
         ST    @02,@AL00001+4                                      1873
         MVI   @AL00001+4,X'80'                                    1873
         L     @15,GDTDBG(,GDTPTR)                                 1873
         LA    @01,@AL00001                                        1873
         BALR  @14,@15                                             1873
*        /************************************************************/
*        /*                                                          */
*        /* IF THE FLAG IS ALREADY SET, THE PARAMETER HAS ALREADY    */
*        /* BEEN INPUT AND AN ERROR HAS OCCURRED.                    */
*        /*                                                          */
*        /************************************************************/
*        IF PARMFLAG(PARMID)=1                                     1874
*          THEN                                                    1874
*                                                                  1874
@RT01871 LH    @02,PARMID                                          1874
         MH    @02,@CH00038                                        1874
         L     @01,WORKPTR                                         1874
         BCTR  @01,0                                               1874
         BCTR  @01,0                                               1874
         SLR   @00,@00                                             1874
         IC    @00,PARMFLAG-10(@02,@01)                            1874
         CH    @00,@CH00228                                        1874
         BNE   @RF01874                                            1874
*            CALL ERROR2(BADKWD3,LENGTH(ERRFIELD),ADDR(ERRFIELD)); 1875
*                                                                  1875
         MVC   @AL00001(8),@AL01875                                1875
         LA    @02,ERRFIELD                                        1875
         ST    @02,@AFTEMPS+40                                     1875
         LA    @02,@AFTEMPS+40                                     1875
         ST    @02,@AL00001+8                                      1875
         LA    @01,@AL00001                                        1875
         BAL   @14,ERROR2                                          1875
*          ELSE                                                    1876
*            PARMFLAG(PARMID)=1;                                   1876
*                                                                  1876
         B     @RC01874                                            1876
@RF01874 LH    @02,PARMID                                          1876
         MH    @02,@CH00038                                        1876
         LA    @15,1                                               1876
         L     @14,WORKPTR                                         1876
         BCTR  @14,0                                               1876
         BCTR  @14,0                                               1876
         STC   @15,PARMFLAG-10(@02,@14)                            1876
*        /************************************************************/
*        /*                                                          */
*        /* SET THE PARAMETER'S DATA POINTER TO A NON-ZERO VALUE TO  */
*        /* SIGNAL THE FSR THAT THE PARAMETER HAS BEEN INPUT.        */
*        /* CALCULATE THE POINTER LOCATION FOR PARAMETERS THAT ARE   */
*        /* PART OF A REPEATED SUBPARAMETER LIST.                    */
*        /*                                                          */
*        /************************************************************/
*        IF OCCURNUM > 1                                           1877
*          THEN                                                    1877
@RC01874 LH    @02,PARMID                                          1877
         LR    @15,@02                                             1877
         MH    @15,@CH00038                                        1877
         L     @01,WORKPTR                                         1877
         AL    @01,@CF01440                                        1877
         L     @01,PARMPTR(@15,@01)                                1877
         CLC   OCCURNUM(3,@01),@CF00228+1                          1877
         BNH   @RF01877                                            1877
*            DO;                                                   1878
*            ARRYPTR=FDTPTR(PARMID);                               1879
*                                                                  1879
         LH    @05,PARMID                                          1879
         SLA   @05,2                                               1879
         L     @01,FDTADDR                                         1879
         L     ARRYPTR,FDTPTR-4(@05,@01)                           1879
*            CALL DSPLCALC(REPDEPTH);                              1880
*                                                                  1880
         LA    @05,REPDEPTH                                        1880
         ST    @05,@AL00001                                        1880
         LA    @01,@AL00001                                        1880
         BAL   @14,DSPLCALC                                        1880
*            REPPTR=ADDR(REPPTR);                                  1881
         LR    @05,ARRYPTR                                         1881
         ALR   @05,ARRYDSPL                                        1881
         ST    @05,REPPTR(,@05)                                    1881
*            END;                                                  1882
*          ELSE                                                    1883
*            IF REPEATED=NO                                        1883
*              THEN                                                1883
         B     @RC01877                                            1883
@RF01877 LH    @02,PARMID                                          1883
         LR    @15,@02                                             1883
         MH    @15,@CH00038                                        1883
         L     @01,WORKPTR                                         1883
         AL    @01,@CF01440                                        1883
         L     @01,PARMPTR(@15,@01)                                1883
         TM    REPEATED(@01),B'00100000'                           1883
         BNZ   @RF01883                                            1883
*                FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));              1884
*                                                                  1884
         L     @15,FDTADDR                                         1884
         SLA   @02,2                                               1884
         LA    @14,FDTPTR-4(@02,@15)                               1884
         ST    @14,FDTPTR-4(@02,@15)                               1884
*        END SETFLAG;                                              1885
@EL00026 DS    0H                                                  1885
@EF00026 DS    0H                                                  1885
@ER00026 LM    @14,@12,@SA00026                                    1885
         BR    @14                                                 1885
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - PACKCVB                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL DIGITS IN EBCDIC FORM  */
*/*             INTO FULLWORD BINARY FORM, AFTER CHECKING THAT THE   */
*/*             DECIMAL NUMBER IS SPECIFIED CORRECTLY.               */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          SYNUNIT - CONTAINS DECIMAL NUMBER IN EBCDIC FORM        */
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER IN EBCDIC FORM       */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          CNVRTWRD- CONVERTED NUMBER IN FULLWORD BINARY FORM      */
*/*                                                                  */
*/********************************************************************/
*PACKCVB:PROCEDURE;                                                1886
PACKCVB  STM   @14,@12,@SA00027                                    1886
*        /************************************************************/
*        /*                                                          */
*        /* PACKCVB PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL CVBNUM FIXED(31) REG(8);  /*REGISTER TO CONTAIN CONVERTED
*                                        FULLWORD NUMBERS            */
*        /************************************************************/
*        /*                                                          */
*        /* ** PACKCVB **  CONVERT DECIMAL NUMBER TO BINARY FULLWORD */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1888
*          THEN;                                                   1888
         ICM   @04,15,GDTDBG(GDTPTR)                               1888
         BZ    @RT01888                                            1888
*          ELSE                                                    1890
*            CALL IDCDB010(GDTTBL,'RIPC');                         1890
*                                                                  1890
         ST    GDTPTR,@AL00001                                     1890
         LA    @04,@CC01344                                        1890
         ST    @04,@AL00001+4                                      1890
         MVI   @AL00001+4,X'80'                                    1890
         L     @15,GDTDBG(,GDTPTR)                                 1890
         LA    @01,@AL00001                                        1890
         BALR  @14,@15                                             1890
*        ERRFIELD=SYNUNIT(1:UNITINDX);                             1891
@RT01888 MVI   ERRFIELD+1,C' '                                     1891
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1891
         LR    @04,UNITINDX                                        1891
         BCTR  @04,0                                               1891
         EX    @04,@SM01506                                        1891
*        /************************************************************/
*        /*                                                          */
*        /* RIGHT-JUSTIFY THE DECIMAL DIGITS IN 'CNVRTFLD'; THEN     */
*        /* CHECK THE DIGITS TO BE SURE THEY REPRESENT AN ACCEPTABLE */
*        /* DECIMAL NUMBER.                                          */
*        /*                                                          */
*        /************************************************************/
*        CNVRTFLD=BLANK;                                           1892
         MVI   CNVRTFLD+1,C' '                                     1892
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1892
         MVI   CNVRTFLD,C' '                                       1892
*        IF UNITINDX <= LENGTH(MXDECNUM)                           1893
*          THEN                                                    1893
         LA    @04,10                                              1893
         CR    UNITINDX,@04                                        1893
         BH    @RF01893                                            1893
*            DO;                                                   1894
*            CNVRTFLD(LENGTH(MXDECNUM)-UNITINDX+1:LENGTH(MXDECNUM))=
*                  SYNUNIT(1:UNITINDX);                            1895
         LA    @02,10                                              1895
         SLR   @02,UNITINDX                                        1895
         LA    @01,CNVRTFLD(@02)                                   1895
         SLR   @04,UNITINDX                                        1895
         LA    @02,9                                               1895
         SLR   @02,@04                                             1895
         EX    @02,@SM01447                                        1895
*            IF CNVRTFLD <= MXDECNUM                               1896
*              THEN                                                1896
         CLC   CNVRTFLD(10),@CC00782                               1896
         BH    @RF01896                                            1896
*                DO INDEX=LENGTH(MXDECNUM)-UNITINDX+1 TO           1897
*                        LENGTH(MXDECNUM) WHILE(RISTATUS=0);       1897
         AL    @04,@CF00228                                        1897
         B     @DE01897                                            1897
@DL01897 ICM   @02,3,RISTATUS                                      1897
         BNZ   @DC01897                                            1897
*                  IF CNVRTFLD(INDEX) < '0'                       1898
*                     CNVRTFLD(INDEX) > '9'                        1898
*                    THEN                                          1898
*                                                                  1898
         LA    @02,CNVRTFLD-1(@04)                                 1898
         CLI   0(@02),C'0'                                         1898
         BL    @RT01898                                            1898
         LA    @02,CNVRTFLD-1(@04)                                 1898
         CLI   0(@02),C'9'                                         1898
         BNH   @RF01898                                            1898
@RT01898 DS    0H                                                  1899
*                      CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),      1899
*                                  ADDR(ERRFIELD));                1899
*                                                                  1899
         MVC   @AL00001(8),@AL01899                                1899
         LA    @04,ERRFIELD                                        1899
         ST    @04,@AFTEMPS+44                                     1899
         LA    @04,@AFTEMPS+44                                     1899
         ST    @04,@AL00001+8                                      1899
         LA    @01,@AL00001                                        1899
         BAL   @14,ERROR2                                          1899
*                END;                                              1900
@RF01898 LA    @04,1                                               1900
         AH    @04,INDEX                                           1900
@DE01897 STH   @04,INDEX                                           1900
         CH    @04,@CH00040                                        1900
         BNH   @DL01897                                            1900
@DC01897 DS    0H                                                  1901
*              ELSE                                                1901
*                                                                  1901
*                CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),ADDR(ERRFIELD));
*                                                                  1901
         B     @RC01896                                            1901
@RF01896 MVC   @AL00001(8),@AL01901                                1901
         LA    @04,ERRFIELD                                        1901
         ST    @04,@AFTEMPS+44                                     1901
         LA    @04,@AFTEMPS+44                                     1901
         ST    @04,@AL00001+8                                      1901
         LA    @01,@AL00001                                        1901
         BAL   @14,ERROR2                                          1901
*            END;                                                  1902
*          ELSE                                                    1903
*                                                                  1903
*            CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),ADDR(ERRFIELD));
*                                                                  1903
         B     @RC01893                                            1903
@RF01893 MVC   @AL00001(8),@AL01903                                1903
         LA    @04,ERRFIELD                                        1903
         ST    @04,@AFTEMPS+44                                     1903
         LA    @04,@AFTEMPS+44                                     1903
         ST    @04,@AL00001+8                                      1903
         LA    @01,@AL00001                                        1903
         BAL   @14,ERROR2                                          1903
*        IF RISTATUS=0                                             1904
*          THEN                                                    1904
*                                                                  1904
@RC01893 ICM   @04,3,RISTATUS                                      1904
         BNZ   @RF01904                                            1904
*            /********************************************************/
*            /*                                                      */
*            /* PERFORM THE CONVERSION FROM EBCDIC TO BINARY FULLWORD*/
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1905
*            SYNUNIT=CNVRTFLD;                                     1906
         MVI   SYNUNIT+10,C' '                                     1906
         MVC   SYNUNIT+11(244),SYNUNIT+10                          1906
         MVC   SYNUNIT(10),CNVRTFLD                                1906
*            RESPECIFY(CVBNUM) RSTD;                               1907
*            GEN(PACK   CNVRTFLD(8),SYNUNIT(10));                  1908
         PACK   CNVRTFLD(8),SYNUNIT(10)
*            GEN(CVB    CVBNUM,CNVRTFLD);                          1909
         CVB    CVBNUM,CNVRTFLD
*            CNVRTWRD=CVBNUM;                                      1910
         ST    CVBNUM,CNVRTWRD                                     1910
*            RESPECIFY(CVBNUM) UNRSTD;                             1911
*            END;                                                  1912
*                                                                  1912
*        END PACKCVB;                                              1913
@EL00027 DS    0H                                                  1913
@EF00027 DS    0H                                                  1913
@ER00027 LM    @14,@12,@SA00027                                    1913
         BR    @14                                                 1913
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NXTFIELD                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT FIELD (VERB, KEYWORD, */
*/*             OR SCALAR) FROM THE INPUT COMMAND.  CHECKS ARE MADE  */
*/*             TO INSURE THAT LENGTH LIMITS ARE NOT EXCEEDED.       */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          FLDTYPE - CONTAINS CODE INDICATING THE TYPE OF FIELD    */
*/*                    TO BE EXTRACTED                               */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SYNUNIT - THE EXTRACTED SYNTACTIC UNIT (FIELD)          */
*/*          UNITINDX- LENGTH OF THE EXTRACTED FIELD                 */
*/*          EOFOK -   FLAG SET 'ON' WHEN INPUT END-OF-FILE MAY      */
*/*                    LEGITIMATELY BE ENCOUNTERED.                  */
*/*          ERRFIELD- FIRST 20 CHARACTERS OF EXTRACTED FIELD WHICH  */
*/*                    MAY BE USED IN AN ERROR MESSAGE LATER         */
*/*                                                                  */
*/********************************************************************/
*NXTFIELD:PROCEDURE(FLDTYPE);          /*PARAMETER INDICATES THE TYPE
*                                        OF FIELD TO BE EXTRACTED.   */
NXTFIELD STM   @14,@04,@SA00028                                    1914
         STM   @06,@12,@SA00028+28                                 1914
         MVC   @PC00028(4),0(@01)                                  1914
*        /************************************************************/
*        /*                                                          */
*        /* NXTFIELD PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL FLDTYPE  FIXED(31);       /*TYPE OF DATA FIELD EXPECTED
*                                        TO BE EXTRACTED NEXT        */
*        DCL PARENCNT FIXED(15);       /*NO. OF UNMATCHED    @YL026UL*/
*                                      /* LEFT PARENTHESES   @YL026UL*/
*                                      /* FOUND IN DSNAME    @YL026UL*/
*                                      /* NOW BEING SCANNED  @YL026UL*/
*                                                                  1917
*        /* STATIC ERROR MESSAGE CODE                                */
*        DCL QUOTSEMI FIXED(31)        /*SEMICOLON APPEARS WITHIN A  */
*                     CONSTANT(23);    /* QUOTED STRING              */
*        /************************************************************/
*        /*                                                          */
*        /*  ** NXTFIELD **  EXTRACT NEXT FIELD FROM INPUT RECORD    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1918
*        DELIM=NO;                                                 1918
         NI    DELIM,B'11110111'                                   1918
*        UNITINDX=0;                                               1919
         SLR   UNITINDX,UNITINDX                                   1919
*        SYNUNIT=BLANK;                                            1920
         MVI   SYNUNIT+1,C' '                                      1920
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1920
         MVI   SYNUNIT,C' '                                        1920
*        IF RISTATUS=0                                             1921
*          THEN                                                    1921
         ICM   @04,3,RISTATUS                                      1921
         BNZ   @RF01921                                            1921
*            EOFOK=NO;                                             1922
*                                                                  1922
         NI    EOFOK,B'10111111'                                   1922
*        /************************************************************/
*        /*                                                          */
*        /* IF A SIMPLE SCALAR FIELD IS TO BE EXTRACTED, THEN EXTRACT*/
*        /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE   */
*        /* OR BY A DELIMITING CHARACTER                             */
*        /*                                                          */
*        /************************************************************/
*        IF FLDTYPE=SIMPSCLR                                       1923
*          THEN                                                    1923
@RF01921 L     @04,@PC00028                                        1923
         CLC   FLDTYPE(4,@04),@CF00172                             1923
         BNE   @RF01923                                            1923
*            DO;                                                   1924
*            OLDERID2 = NEWERID2;                                  1925
         L     @04,GDTTR2(,GDTPTR)                                 1925
         MVC   @TS00001(95),NEWERID2(@04)                          1925
         MVC   OLDERID2(95,@04),@TS00001                           1925
*            NEWID2='RI49';                                        1926
         MVC   NEWID2(4,@04),@CC01353                              1926
*            PARENCNT=0;                                   /*@YL026UL*/
         SLR   PARENCNT,PARENCNT                                   1927
*            DO WHILE(DELIM=NO & RISTATUS=0);                      1928
         B     @DE01928                                            1928
@DL01928 DS    0H                                                  1929
*              IF CHAR1=BLANK                                     1929
*                 CHAR1=COMMA                                     1929
*                 CHAR1=OPENING & DSNAM=NO                        1929
*                 CHAR1=CLOSING & PARENCNT=0                      1929
*                 CHAR1=ENDDELIM                                  1929
*                 CHAR1=PWDDELIM                                  1929
*                 CHAR1=COMSTART(1) & CHAR2=COMSTART(2)            1929
*                THEN                                              1929
         CLI   CHAR1,C' '                                          1929
         BE    @RT01929                                            1929
         CLI   CHAR1,C','                                          1929
         BE    @RT01929                                            1929
         CLI   CHAR1,C'('                                          1929
         BNE   @GL00117                                            1929
         LA    @04,12                                              1929
         LR    @15,@04                                             1929
         MH    @15,PARMID                                          1929
         L     @01,WORKPTR                                         1929
         AL    @01,@CF01440                                        1929
         AL    @04,PARMPTR(@15,@01)                                1929
         TM    DSNAM(@04),B'00100000'                              1929
         BZ    @RT01929                                            1929
@GL00117 CLI   CHAR1,C')'                                          1929
         BNE   @GL00116                                            1929
         LTR   PARENCNT,PARENCNT                                   1929
         BZ    @RT01929                                            1929
@GL00116 CLI   CHAR1,C';'                                          1929
         BE    @RT01929                                            1929
         CLI   CHAR1,C'/'                                          1929
         BE    @RT01929                                            1929
         CLC   CHAR1(1),COMSTART                                   1929
         BNE   @RF01929                                            1929
         CLC   CHAR2(1),COMSTART+1                                 1929
         BNE   @RF01929                                            1929
@RT01929 DS    0H                                                  1930
*                  DELIM=YES;                              /*@YL026UL*/
         OI    DELIM,B'00001000'                                   1930
*                ELSE                                              1931
*                  DO;                                             1931
         B     @RC01929                                            1931
@RF01929 DS    0H                                                  1932
*                    UNITINDX=UNITINDX+1;                          1932
         AL    UNITINDX,@CF00228                                   1932
*                    IF UNITINDX > UNITMAX                         1933
*                      THEN                                        1933
*                                                                  1933
         CH    UNITINDX,@CH00790                                   1933
         BNH   @RF01933                                            1933
*                        CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),    1934
*                                    ADDR(SYNUNIT));               1934
*                                                                  1934
         MVC   @AL00001(8),@AL01934                                1934
         LA    @04,SYNUNIT                                         1934
         ST    @04,@AFTEMPS+48                                     1934
         LA    @04,@AFTEMPS+48                                     1934
         ST    @04,@AL00001+8                                      1934
         LA    @01,@AL00001                                        1934
         BAL   @14,ERROR2                                          1934
*                      ELSE                                        1935
*                                                                  1935
*                        /********************************************/
*                        /*                                          */
*                        /* SAVE THE CHARACTER AND NOTE IF   @YL026UL*/
*                        /* IT IS A MEMBER NAME DELIMITER    @YL026UL*/
*                        /* (A PARENTHESIS)                  @YL026UL*/
*                        /*                                          */
*                        /********************************************/
*                        DO;                                       1935
         B     @RC01933                                            1935
@RF01933 DS    0H                                                  1936
*                        SYNUNIT(UNITINDX)=CHAR1;                  1936
         LA    @04,SYNUNIT-1(UNITINDX)                             1936
         MVC   0(1,@04),CHAR1                                      1936
*                        IF CHAR1=OPENING                          1937
*                          THEN                                    1937
         CLI   CHAR1,C'('                                          1937
         BNE   @RF01937                                            1937
*                            PARENCNT=PARENCNT+1;          /*@YL026UL*/
         AL    PARENCNT,@CF00228                                   1938
*                          ELSE                                    1939
*                            IF CHAR1=CLOSING                      1939
*                              THEN                                1939
         B     @RC01937                                            1939
@RF01937 CLI   CHAR1,C')'                                          1939
         BNE   @RF01939                                            1939
*                                PARENCNT=PARENCNT-1;      /*@YL026UL*/
*                                                                  1940
         BCTR  PARENCNT,0                                          1940
*                        CALL NEXTCHAR;                            1941
*                                                                  1941
@RF01939 DS    0H                                                  1941
@RC01937 BAL   @14,NEXTCHAR                                        1941
*                        END;                                      1942
*                  END;                                            1943
@RC01933 DS    0H                                                  1944
*            END;                                                  1944
@RC01929 DS    0H                                                  1944
@DE01928 TM    DELIM,B'00001000'                                   1944
         BNZ   @DC01928                                            1944
         ICM   @04,3,RISTATUS                                      1944
         BZ    @DL01928                                            1944
@DC01928 DS    0H                                                  1945
*            END;                                                  1945
*                                                                  1945
*          /**********************************************************/
*          /*                                                        */
*          /* IF A KEYWORD FIELD IS TO BE EXTRACTED, THEN PICK UP    */
*          /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE */
*          /* OR BY A DELIMITING CHARACTER.  CHECK THAT THE MAXIMUM  */
*          /* KEYWORD LENGTH IS NOT EXCEEDED.                        */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    1946
*            IF FLDTYPE=KEYWORD                                    1946
*              THEN                                                1946
         B     @RC01923                                            1946
@RF01923 L     @04,@PC00028                                        1946
         CLC   FLDTYPE(4,@04),@CF00163                             1946
         BNE   @RF01946                                            1946
*                DO;                                               1947
*                OLDERID2 = NEWERID2;                              1948
         L     @04,GDTTR2(,GDTPTR)                                 1948
         MVC   @TS00001(95),NEWERID2(@04)                          1948
         MVC   OLDERID2(95,@04),@TS00001                           1948
*                NEWID2='RI50';                                    1949
         MVC   NEWID2(4,@04),@CC01354                              1949
*                DO WHILE(DELIM=NO & RISTATUS=0);                  1950
         B     @DE01950                                            1950
@DL01950 DS    0H                                                  1951
*                  IF CHAR1=BLANK  CHAR1=COMMA                   1951
*                     CHAR1=OPENING  CHAR1=CLOSING               1951
*                     CHAR1=COMSTART(1) & CHAR2=COMSTART(2)       1951
*                     CHAR1=ENDDELIM                               1951
*                    THEN                                          1951
         CLI   CHAR1,C' '                                          1951
         BE    @RT01951                                            1951
         CLI   CHAR1,C','                                          1951
         BE    @RT01951                                            1951
         CLI   CHAR1,C'('                                          1951
         BE    @RT01951                                            1951
         CLI   CHAR1,C')'                                          1951
         BE    @RT01951                                            1951
         CLC   CHAR1(1),COMSTART                                   1951
         BNE   @GL00124                                            1951
         CLC   CHAR2(1),COMSTART+1                                 1951
         BE    @RT01951                                            1951
@GL00124 CLI   CHAR1,C';'                                          1951
         BNE   @RF01951                                            1951
@RT01951 DS    0H                                                  1952
*                      DELIM=YES;                                  1952
         OI    DELIM,B'00001000'                                   1952
*                    ELSE                                          1953
*                      DO;                                         1953
         B     @RC01951                                            1953
@RF01951 DS    0H                                                  1954
*                        UNITINDX=UNITINDX+1;                      1954
         AL    UNITINDX,@CF00228                                   1954
*                        IF UNITINDX > KWDMAX                      1955
*                          THEN                                    1955
*                                                                  1955
         CH    UNITINDX,@CH00786                                   1955
         BNH   @RF01955                                            1955
*                            CALL ERROR2(BADKWD2,LENGTH(ERRFIELD), 1956
*                                        ADDR(SYNUNIT));           1956
*                                                                  1956
         MVC   @AL00001(8),@AL01956                                1956
         LA    @04,SYNUNIT                                         1956
         ST    @04,@AFTEMPS+48                                     1956
         LA    @04,@AFTEMPS+48                                     1956
         ST    @04,@AL00001+8                                      1956
         LA    @01,@AL00001                                        1956
         BAL   @14,ERROR2                                          1956
*                          ELSE                                    1957
*                            DO;                                   1957
         B     @RC01955                                            1957
@RF01955 DS    0H                                                  1958
*                            SYNUNIT(UNITINDX)=CHAR1;              1958
*                                                                  1958
         LA    @04,SYNUNIT-1(UNITINDX)                             1958
         MVC   0(1,@04),CHAR1                                      1958
*                            CALL NEXTCHAR;                        1959
*                                                                  1959
         BAL   @14,NEXTCHAR                                        1959
*                            END;                                  1960
*                      END;                                        1961
@RC01955 DS    0H                                                  1962
*                END;                                              1962
@RC01951 DS    0H                                                  1962
@DE01950 TM    DELIM,B'00001000'                                   1962
         BNZ   @DC01950                                            1962
         ICM   @04,3,RISTATUS                                      1962
         BZ    @DL01950                                            1962
@DC01950 DS    0H                                                  1963
*                END;                                              1963
*                                                                  1963
*              /******************************************************/
*              /*                                                    */
*              /* IF A SCALAR FIELD DELIMITED BY APOSTROPHES IS TO BE*/
*              /* EXTRACTED, THEN PICK UP CHARACTERS UNTIL THE FIELD */
*              /* IS DELIMITED BY END-OF-FILE OR BY A DELIMITING     */
*              /* INPUT CHARACTER.                                   */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1964
*                IF FLDTYPE=QUOTSCLR                               1964
*                  THEN                                            1964
         B     @RC01946                                            1964
@RF01946 L     @04,@PC00028                                        1964
         CLC   FLDTYPE(4,@04),@CF00052                             1964
         BNE   @RF01964                                            1964
*DOGRP182:           DO;                                           1965
DOGRP182 DS    0H                                                  1966
*                    OLDERID2 = NEWERID2;                          1966
         L     @04,GDTTR2(,GDTPTR)                                 1966
         MVC   @TS00001(95),NEWERID2(@04)                          1966
         MVC   OLDERID2(95,@04),@TS00001                           1966
*                    NEWID2='RI51';                                1967
         MVC   NEWID2(4,@04),@CC01357                              1967
*                    DO WHILE(DELIM=NO & RISTATUS=0);              1968
*                                                                  1968
         B     @DE01968                                            1968
@DL01968 DS    0H                                                  1969
*                      IF CHAR1=QUOTE & CHAR2^=QUOTE               1969
*                        THEN                                      1969
         CLI   CHAR1,C''''                                         1969
         BNE   @RF01969                                            1969
         CLI   CHAR2,C''''                                         1969
         BE    @RF01969                                            1969
*                          DELIM=YES;                              1970
         OI    DELIM,B'00001000'                                   1970
*                        ELSE                                      1971
*                                                                  1971
*                          /******************************************/
*                          /*                                        */
*                          /* ACCEPT THE CHARACTER AS PART OF THE    */
*                          /* SCALAR.  ISSUE AN ERROR MESSAGE IF THE */
*                          /* SCALAR HAS EXCEEDED THE LENGTH LIMIT.  */
*                          /* ISSUE A WARNING MESSAGE IF THE CHAR.   */
*                          /* IS A SEMICOLON.                        */
*                          /*                                        */
*                          /******************************************/
*                          DO;                                     1971
         B     @RC01969                                            1971
@RF01969 DS    0H                                                  1972
*                            IF CHAR1=ENDDELIM                     1972
*                              THEN                                1972
         CLI   CHAR1,C';'                                          1972
         BNE   @RF01972                                            1972
*                                DO;                               1973
*                                DARGSMOD=RISTID;                  1974
         L     @04,DDSTRU                                          1974
         MVC   DARGSMOD(3,@04),RISTID                              1974
*                                DARGSENT=QUOTSEMI;                1975
*                                                                  1975
         MVI   DARGSENT(@04),X'17'                                 1975
*                                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);
*                                                                  1976
         ST    GDTPTR,@AL00001                                     1976
         LA    @04,@CF00125                                        1976
         ST    @04,@AL00001+4                                      1976
         LA    @04,DDSTRU                                          1976
         ST    @04,@AL00001+8                                      1976
         MVI   @AL00001+8,X'80'                                    1976
         L     @15,GDTPRT(,GDTPTR)                                 1976
         LA    @01,@AL00001                                        1976
         BALR  @14,@15                                             1976
*                                END;                              1977
*                            UNITINDX=UNITINDX+1;                  1978
@RF01972 AL    UNITINDX,@CF00228                                   1978
*                            IF UNITINDX > UNITMAX                 1979
*                              THEN                                1979
*                                                                  1979
         CH    UNITINDX,@CH00790                                   1979
         BNH   @RF01979                                            1979
*                                CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),
*                                            ADDR(SYNUNIT));       1980
*                                                                  1980
         MVC   @AL00001(8),@AL01980                                1980
         LA    @04,SYNUNIT                                         1980
         ST    @04,@AFTEMPS+48                                     1980
         LA    @04,@AFTEMPS+48                                     1980
         ST    @04,@AL00001+8                                      1980
         LA    @01,@AL00001                                        1980
         BAL   @14,ERROR2                                          1980
*                              ELSE                                1981
*                                SYNUNIT(UNITINDX)=CHAR1;          1981
         B     @RC01979                                            1981
@RF01979 LA    @04,SYNUNIT-1(UNITINDX)                             1981
         MVC   0(1,@04),CHAR1                                      1981
*                          END;                                    1982
*                                                                  1982
@RC01979 DS    0H                                                  1983
*                      /**********************************************/
*                      /*                                            */
*                      /* IF A DOUBLE APOSTROPHE IS FOUND, SKIP PAST */
*                      /* BOTH OF THEM AND THEN CONTINUE SCANNING.   */
*                      /*                                            */
*                      /**********************************************/
*                      IF CHAR1=QUOTE & CHAR2=QUOTE                1983
*                        THEN                                      1983
*                                                                  1983
@RC01969 CLI   CHAR1,C''''                                         1983
         BNE   @RF01983                                            1983
         CLI   CHAR2,C''''                                         1983
         BNE   @RF01983                                            1983
*                          CALL NEXTCHAR;                          1984
*                                                                  1984
         BAL   @14,NEXTCHAR                                        1984
*                      /**********************************************/
*                      /*                                            */
*                      /* BYPASS THE CHARACTER JUST EXTRACTED, UNLESS*/
*                      /* AN ERROR CONDITION HAS BEEN ENCOUNTERED OR */
*                      /* THE END OF THE CURRENT COMMAND HAS JUST    */
*                      /* BEEN REACHED.                              */
*                      /*                                            */
*                      /**********************************************/
*                      IF RISTATUS=0                               1985
*                        THEN                                      1985
@RF01983 ICM   @04,3,RISTATUS                                      1985
         BNZ   @RF01985                                            1985
*                          IF CHAR1=ENDDELIM &                     1986
*                             (OPTSFLAG=ON  MORTOCOM=NO) &        1986
*                             SCANINDX >= SCNLIMIT                 1986
*                            THEN                                  1986
         CLI   CHAR1,C';'                                          1986
         BNE   @RF01986                                            1986
         TM    OPTSFLAG,B'00100000'                                1986
         BO    @GL00133                                            1986
         TM    MORTOCOM,B'00010000'                                1986
         BNZ   @RF01986                                            1986
@GL00133 LH    @04,SCANINDX                                        1986
         CH    @04,SCNLIMIT                                        1986
         BL    @RF01986                                            1986
*                              DELIM=YES;                          1987
         OI    DELIM,B'00001000'                                   1987
*                            ELSE                                  1988
*                                                                  1988
*                              CALL NEXTCHAR;                      1988
*                                                                  1988
         B     @RC01986                                            1988
@RF01986 BAL   @14,NEXTCHAR                                        1988
*                    END;                                          1989
@RC01986 DS    0H                                                  1989
@RF01985 DS    0H                                                  1989
@DE01968 TM    DELIM,B'00001000'                                   1989
         BNZ   @DC01968                                            1989
         ICM   @04,3,RISTATUS                                      1989
         BZ    @DL01968                                            1989
@DC01968 DS    0H                                                  1990
*                    END DOGRP182;                                 1990
*                                                                  1990
*                  /**************************************************/
*                  /*                                                */
*                  /* WHEN A VERB FIELD IS TO BE EXTRACTED, PICK     */
*                  /* UP CHARACTERS UNTIL THE FIELD IS DELIMITED BY  */
*                  /* END-OF-FILE OR BY A DELIMITING CHARACTER.      */
*                  /* CHECK THAT THE MAXIMUM VERB LENGTH HAS NOT     */
*                  /* BEEN EXCEEDED.                                 */
*                  /*                                                */
*                  /**************************************************/
*                  ELSE                                            1991
*                    DO WHILE(DELIM=NO & RISTATUS=0);              1991
         B     @RC01964                                            1991
@RF01964 B     @DE01991                                            1991
@DL01991 DS    0H                                                  1992
*                      IF CHAR1=BLANK  CHAR1=COMMA               1992
*                         CHAR1=COMSTART(1) & CHAR2=COMSTART(2)   1992
*                         CHAR1=ENDDELIM                           1992
*                        THEN                                      1992
         CLI   CHAR1,C' '                                          1992
         BE    @RT01992                                            1992
         CLI   CHAR1,C','                                          1992
         BE    @RT01992                                            1992
         CLC   CHAR1(1),COMSTART                                   1992
         BNE   @GL00137                                            1992
         CLC   CHAR2(1),COMSTART+1                                 1992
         BE    @RT01992                                            1992
@GL00137 CLI   CHAR1,C';'                                          1992
         BNE   @RF01992                                            1992
@RT01992 DS    0H                                                  1993
*                          DELIM=YES;                              1993
         OI    DELIM,B'00001000'                                   1993
*                        ELSE                                      1994
*                          DO;                                     1994
         B     @RC01992                                            1994
@RF01992 DS    0H                                                  1995
*                            UNITINDX=UNITINDX+1;                  1995
         AL    UNITINDX,@CF00228                                   1995
*                            IF UNITINDX > UNITMAX                 1996
*                              THEN                                1996
*                                                                  1996
         CH    UNITINDX,@CH00790                                   1996
         BNH   @RF01996                                            1996
*                                CALL ERROR2(BADVERB2,LENGTH(ERRFIELD),
*                                            ADDR(SYNUNIT));       1997
*                                                                  1997
         MVC   @AL00001(8),@AL01997                                1997
         LA    @04,SYNUNIT                                         1997
         ST    @04,@AFTEMPS+48                                     1997
         LA    @04,@AFTEMPS+48                                     1997
         ST    @04,@AL00001+8                                      1997
         LA    @01,@AL00001                                        1997
         BAL   @14,ERROR2                                          1997
*                              ELSE                                1998
*                                DO;                               1998
         B     @RC01996                                            1998
@RF01996 DS    0H                                                  1999
*                                SYNUNIT(UNITINDX)=CHAR1;          1999
*                                                                  1999
         LA    @04,SYNUNIT-1(UNITINDX)                             1999
         MVC   0(1,@04),CHAR1                                      1999
*                                CALL NEXTCHAR;                    2000
*                                                                  2000
         BAL   @14,NEXTCHAR                                        2000
*                                END;                              2001
*                          END;                                    2002
@RC01996 DS    0H                                                  2003
*                    END;                                          2003
*                                                                  2003
@RC01992 DS    0H                                                  2003
@DE01991 TM    DELIM,B'00001000'                                   2003
         BNZ   @DC01991                                            2003
         ICM   @04,3,RISTATUS                                      2003
         BZ    @DL01991                                            2003
@DC01991 DS    0H                                                  2004
*        /************************************************************/
*        /*                                                          */
*        /* AN ERROR HAS OCCURRED WHEN NO CHARACTERS OF THE          */
*        /* SYNTACTICAL UNIT WERE FOUND BEFORE HITTING A DELIMITER   */
*        /*                                                          */
*        /************************************************************/
*        IF UNITINDX=0 & RISTATUS=0                                2004
*          THEN                                                    2004
@RC01964 DS    0H                                                  2004
@RC01946 DS    0H                                                  2004
@RC01923 SLR   @04,@04                                             2004
         CR    UNITINDX,@04                                        2004
         BNE   @RF02004                                            2004
         CH    @04,RISTATUS                                        2004
         BNE   @RF02004                                            2004
*            IF FLDTYPE^=VERBFLD                                   2005
*              THEN                                                2005
*                                                                  2005
         L     @04,@PC00028                                        2005
         CLC   FLDTYPE(4,@04),@CF00228                             2005
         BE    @RF02005                                            2005
*                CALL ERROR2(BADELIM1,LENGTH(CHAR1),ADDR(CHAR1));  2006
*                                                                  2006
         MVC   @AL00001(8),@AL02006                                2006
         LA    @04,CHAR1                                           2006
         ST    @04,@AFTEMPS+48                                     2006
         LA    @04,@AFTEMPS+48                                     2006
         ST    @04,@AL00001+8                                      2006
         LA    @01,@AL00001                                        2006
         BAL   @14,ERROR2                                          2006
*              ELSE;                                               2007
*                                                                  2007
@RF02005 DS    0H                                                  2008
*          /**********************************************************/
*          /*                                                        */
*          /* IF CHARACTERS WERE EXTRACTED FOR THIS UNIT, SAVE UP TO */
*          /* THE FIRST 20 OF THEM FOR POSSIBLE LATER USE IN AN      */
*          /* ERROR MESSAGE.                                         */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    2008
*            ERRFIELD=SYNUNIT;                                     2008
*                                                                  2008
*                                                                  2008
         B     @RC02004                                            2008
@RF02004 MVC   ERRFIELD(20),SYNUNIT                                2008
*        END NXTFIELD;                                             2009
@EL00028 DS    0H                                                  2009
@EF00028 DS    0H                                                  2009
@ER00028 LM    @14,@04,@SA00028                                    2009
         LM    @06,@12,@SA00028+28                                 2009
         BR    @14                                                 2009
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SCANSEP                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS PAST THE COMMA(S) AND/OR BLANK(S) */
*/*             AND/OR COMMENT(S) WHICH OPTIONALLY SEPARATE COMMAND  */
*/*             SYNTACTIC UNITS.                                     */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          WITHCOM - FLAG SET 'OFF' WHEN A COMMA SHOULD NOT APPEAR */
*/*                    AS PART OF THE SEPARATOR                      */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND                   */
*/*          SCANONLY- FLAG SET 'ON' WHEN THE CURRENT COMMAND IS     */
*/*                    BEING SCANNED FOR SYNTAX CHECKING ONLY.       */
*/*                                                                  */
*/*  OUTPUT - NONE                                                   */
*/*                                                                  */
*/********************************************************************/
*SCANSEP:PROCEDURE(WITHCOM);           /*PARAMETER SIGNALS WHETHER 2010
*                                        A COMMA IS TO BE CONSIDERED
*                                        PART OF THE SEPARATOR OR NOT*/
SCANSEP  STM   @14,@12,@SA00029                                    2010
         MVC   @PC00029(4),0(@01)                                  2010
*        /************************************************************/
*        /*                                                          */
*        /* SCANSEP PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  2011
*        /* STATIC ERROR MESSAGE CODE                                */
*        DCL COMMAERR FIXED(31)        /*DOUBLE COMMA                */
*                     CONSTANT(7);                                 2011
*                                                                  2011
*        DCL COMMASW  BIT(1);          /*SIGNALS THAT A COMMA HAS BEEN
*                                        FOUND IN THIS SEPARATOR     */
*        DCL WITHCOM  BIT(1);          /*SIGNALS THAT A COMMA MAY  2013
*                                        APPEAR IN THIS SEPARATOR    */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SCANSEP **  SCAN PAST SEPARATOR CHARACTERS           */
*        /*                                                          */
*        /************************************************************/
*        IF WITHCOM=YES                                            2014
*          THEN                                                    2014
         L     @02,@PC00029                                        2014
         TM    WITHCOM(@02),B'10000000'                            2014
         BNO   @RF02014                                            2014
*            COMMASW=OFF;                                          2015
         NI    COMMASW,B'01111111'                                 2015
*          ELSE                                                    2016
*            COMMASW=ON;                                           2016
         B     @RC02014                                            2016
@RF02014 OI    COMMASW,B'10000000'                                 2016
*        DELIM=NO;                                                 2017
@RC02014 NI    DELIM,B'11110111'                                   2017
*        COMMENT=NO;                                               2018
         NI    COMMENT,B'10111111'                                 2018
*        DO WHILE(DELIM=NO & RISTATUS=0);                          2019
*                                                                  2019
         B     @DE02019                                            2019
@DL02019 DS    0H                                                  2020
*          /**********************************************************/
*          /*                                                        */
*          /* IF NOT CURRENTLY BYPASSING A COMMENT, LOOK FOR A CHAR. */
*          /* OTHER THAN A SEPARATOR CHARACTER OR THE BEGINNING OF A */
*          /* COMMENT TO SIGNAL THE BEGINNING OF THE NEXT SYNTACTIC  */
*          /* UNIT.  IF MORE THAN ONE COMMA HAS BEEN FOUND, ISSUE A  */
*          /* WARNING MESSAGE STATING THAT IT WILL BE IGNORED.       */
*          /*                                                        */
*          /**********************************************************/
*          IF COMMENT=NO                                           2020
*            THEN                                                  2020
         TM    COMMENT,B'01000000'                                 2020
         BNZ   @RF02020                                            2020
*              IF CHAR1 ^= BLANK                                   2021
*                THEN                                              2021
         CLI   CHAR1,C' '                                          2021
         BE    @RF02021                                            2021
*                  IF CHAR1=COMMA                                  2022
*                    THEN                                          2022
         CLI   CHAR1,C','                                          2022
         BNE   @RF02022                                            2022
*                      IF COMMASW=ON                               2023
*                        THEN                                      2023
         TM    COMMASW,B'10000000'                                 2023
         BNO   @RF02023                                            2023
*                          DO;                                     2024
*                          DARGSMOD=RISTID;                        2025
         L     @02,DDSTRU                                          2025
         MVC   DARGSMOD(3,@02),RISTID                              2025
*                          DARGSENT=COMMAERR;                      2026
*                                                                  2026
         MVI   DARGSENT(@02),X'07'                                 2026
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   2027
*                                                                  2027
         ST    GDTPTR,@AL00001                                     2027
         LA    @02,@CF00125                                        2027
         ST    @02,@AL00001+4                                      2027
         LA    @02,DDSTRU                                          2027
         ST    @02,@AL00001+8                                      2027
         MVI   @AL00001+8,X'80'                                    2027
         L     @15,GDTPRT(,GDTPTR)                                 2027
         LA    @01,@AL00001                                        2027
         BALR  @14,@15                                             2027
*                          END;                                    2028
*                        ELSE                                      2029
*                          COMMASW=ON;                             2029
         B     @RC02023                                            2029
@RF02023 OI    COMMASW,B'10000000'                                 2029
*                    ELSE                                          2030
*                      IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)    2030
*                        THEN                                      2030
         B     @RC02022                                            2030
@RF02022 CLC   CHAR1(1),COMSTART                                   2030
         BNE   @RF02030                                            2030
         CLC   CHAR2(1),COMSTART+1                                 2030
         BNE   @RF02030                                            2030
*                          DO;                                     2031
*                          COMMENT=YES;                            2032
*                                                                  2032
         OI    COMMENT,B'01000000'                                 2032
*                          CALL NEXTCHAR;                          2033
*                                                                  2033
         BAL   @14,NEXTCHAR                                        2033
*                          END;                                    2034
*                        ELSE                                      2035
*                          DELIM=YES;                              2035
         B     @RC02030                                            2035
@RF02030 OI    DELIM,B'00001000'                                   2035
*                ELSE;                                             2036
*                                                                  2036
@RF02021 DS    0H                                                  2037
*            /********************************************************/
*            /*                                                      */
*            /* IF CURRENTLY BYPASSING A COMMENT, LOOK FOR THE ENDING*/
*            /* COMMENT DELIMITER.  ALSO TEST TO SEE IF THE END OF   */
*            /* THE CURRENT COMMAND HAS BEEN FOUND WHILE SCANNING    */
*            /* WITHIN THE COMMENT.                                  */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  2037
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                2037
*                THEN                                              2037
         B     @RC02020                                            2037
@RF02020 CLC   CHAR1(1),COMEND                                     2037
         BNE   @RF02037                                            2037
         CLC   CHAR2(1),COMEND+1                                   2037
         BNE   @RF02037                                            2037
*                  DO;                                             2038
*                  COMMENT=NO;                                     2039
*                                                                  2039
         NI    COMMENT,B'10111111'                                 2039
*                  CALL NEXTCHAR;                                  2040
*                                                                  2040
         BAL   @14,NEXTCHAR                                        2040
*                  END;                                            2041
*                ELSE                                              2042
*                  IF CHAR1=ENDDELIM &                             2042
*                     (OPTSFLAG=ON  MORTOCOM=NO) &                2042
*                     SCANINDX >= SCNLIMIT                         2042
*                    THEN                                          2042
         B     @RC02037                                            2042
@RF02037 CLI   CHAR1,C';'                                          2042
         BNE   @RF02042                                            2042
         TM    OPTSFLAG,B'00100000'                                2042
         BO    @GL00145                                            2042
         TM    MORTOCOM,B'00010000'                                2042
         BNZ   @RF02042                                            2042
@GL00145 LH    @02,SCANINDX                                        2042
         CH    @02,SCNLIMIT                                        2042
         BL    @RF02042                                            2042
*                      DELIM=YES;                                  2043
*                                                                  2043
         OI    DELIM,B'00001000'                                   2043
*          /**********************************************************/
*          /*                                                        */
*          /* SCAN THE INPUT CHARACTERS ONE AT A TIME -- IF, AFTER   */
*          /* A CHARACTER HAS BEEN CHECKED, THE NEXT SYNTACTIC UNIT  */
*          /* HAS NOT BEEN REACHED, PICK UP THE NEXT CHARACTER.      */
*          /*                                                        */
*          /**********************************************************/
*          IF DELIM=NO                                             2044
*            THEN                                                  2044
*                                                                  2044
@RF02042 DS    0H                                                  2044
@RC02037 DS    0H                                                  2044
@RC02020 TM    DELIM,B'00001000'                                   2044
         BNZ   @RF02044                                            2044
*              CALL NEXTCHAR;                                      2045
*                                                                  2045
         BAL   @14,NEXTCHAR                                        2045
*        END;                                                      2046
*                                                                  2046
@RF02044 DS    0H                                                  2046
@DE02019 TM    DELIM,B'00001000'                                   2046
         BNZ   @DC02019                                            2046
         ICM   @02,3,RISTATUS                                      2046
         BZ    @DL02019                                            2046
@DC02019 DS    0H                                                  2047
*        END SCANSEP;                                              2047
@EL00029 DS    0H                                                  2047
@EF00029 DS    0H                                                  2047
@ER00029 LM    @14,@12,@SA00029                                    2047
         BR    @14                                                 2047
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NEXTCHAR                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT CHARACTER (PRIMARY    */
*/*             CHARACTER) FROM THE INPUT STREAM AND MAKES THE       */
*/*             CHARACTER LOGICALLY FOLLOWING IT (SECONDARY CHAR.)   */
*/*             AVAILABLE FOR REFERENCE. (THE NEXT INVOCATION OF     */
*/*             'NEXTCHAR' WILL TREAT THIS SECONDARY CHARACTER AS THE*/
*/*             PRIMARY CHARACTER). A NEW RECORD IS OBTAINED, IF     */
*/*             NECESSARY, TO PICK UP THE SECONDARY CHAR., AND THIS  */
*/*             NEW RECORD IS PREPARED FOR SCANNING BEFORE PROCESSING*/
*/*             OF IT BEGINS.                                        */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          FINALCHR- FLAG SET 'ON' WHEN INPUT END-OF-FILE HAS BEEN */
*/*                    REACHED.                                      */
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE LOCATION AND LENGTH OF */
*/*                    THE INPUT CHARACTERS TO BE SCANNED ARE        */
*/*                    SPECIFIED IN THE R/I HISTORICAL DATA AREA.    */
*/*          INRECPTR- PTR IN R/I HDA POINTING TO INPUT CHARACTERS   */
*/*                    NOT COMPLETELY SCANNED BY PREVIOUS INVOCATION */
*/*                    OF THE READER/INTERPRETER.                    */
*/*          INRECLEN- LENGTH OF ABOVE UNSCANNED STRING.             */
*/*          SCANINDX- INDEX INDICATING THE OFFSET INTO THE CURRENT  */
*/*                    INPUT RECORD OF THE LAST CHARACTER EXTRACTED. */
*/*          SCNLIMIT- OFFSET INTO THE CURRENT INPUT RECORD OF THE   */
*/*                    FINAL CHARACTER IN THE RECORD TO BE EXTRACTED.*/
*/*          INREC -   CONTAINS THE CURRENT INPUT RECORD             */
*/*          OPTSFLAG- FLAG SET 'ON' WHEN CURRENTLY SCANNING WITHIN  */
*/*                    THE PARAMETER OPTIONS STRING                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR IS FOUND.                 */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */
*/*          CHAR2 -   INPUT CHARACTER WHICH LOGICALLY FOLLOWS THE   */
*/*                    CHARACTER JUST EXTRACTED.                     */
*/*          FINALCHR- SEE 'INPUT'                                   */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*          FIRSTCHR- SEE 'INPUT'                                   */
*/*          RECRDPTR- POINTER TO CURRENT INPUT RECORD               */
*/*          SCNLIMIT- SEE 'INPUT'                                   */
*/*          SCANINDX- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*NEXTCHAR:PROCEDURE;                                               2048
NEXTCHAR STM   @14,@12,@SA00030                                    2048
*        /************************************************************/
*        /*                                                          */
*        /*  ** NEXTCHAR **  GET NEXT COMMAND CHARACTER              */
*        /*                                                          */
*        /************************************************************/
*                                                                  2049
*        /************************************************************/
*        /*                                                          */
*        /* NOTE WHETHER END-OF-FILE HAS BEEN REACHED OR NOT         */
*        /*                                                          */
*        /************************************************************/
*        IF FINALCHR=YES                                           2049
*          THEN                                                    2049
         TM    FINALCHR,B'00000010'                                2049
         BNO   @RF02049                                            2049
*            DO;                                                   2050
*            OLDERID2 = NEWERID2;                                  2051
         L     @02,GDTTR2(,GDTPTR)                                 2051
         MVC   @TS00001(95),NEWERID2(@02)                          2051
         MVC   OLDERID2(95,@02),@TS00001                           2051
*            NEWID2='RI56';                                        2052
         MVC   NEWID2(4,@02),@CC01368                              2052
*            RISTATUS=EOFILE;                                      2053
         MVC   RISTATUS(2),@CH00157                                2053
*            END;                                                  2054
*          ELSE                                                    2055
*DOGRP185:   DO;                                                   2055
*                                                                  2055
         B     @RC02049                                            2055
@RF02049 DS    0H                                                  2055
DOGRP185 DS    0H                                                  2056
*            /********************************************************/
*            /*                                                      */
*            /* IF THE FIRST CHARACTER OF A NEW COMMAND IS TO BE     */
*            /* EXTRACTED, THEN PREPARE TO OBTAIN THE NEXT INPUT     */
*            /* RECORD (PREPARATION INCLUDES WRITING A BLANK OUTPUT  */
*            /* RECORD, UNLESS A NULL COMMAND WAS JUST ENCOUNTERED). */
*            /* OTHERWISE, JUST POINT TO THE NEXT CHARACTER OF THE   */
*            /* CURRENT RECORD.                                      */
*            /*                                                      */
*            /********************************************************/
*            IF FIRSTCHR=YES                                       2056
*              THEN                                                2056
         TM    FIRSTCHR,B'00000100'                                2056
         BNO   @RF02056                                            2056
*                DO;                                               2057
*                OLDERID2 = NEWERID2;                              2058
         L     @02,GDTTR2(,GDTPTR)                                 2058
         MVC   @TS00001(95),NEWERID2(@02)                          2058
         MVC   OLDERID2(95,@02),@TS00001                           2058
*                NEWID2='RI57';                                    2059
         MVC   NEWID2(4,@02),@CC01371                              2059
*                FIRSTCHR=NO;                                      2060
         NI    FIRSTCHR,B'11111011'                                2060
*                SCNLIMIT=0;                                       2061
         SLR   @02,@02                                             2061
         STH   @02,SCNLIMIT                                        2061
*                SCANINDX=1;                                       2062
         MVC   SCANINDX(2),@CH00228                                2062
*                MORTOCOM=YES;                                     2063
*                                                                  2063
         OI    MORTOCOM,B'00010000'                                2063
*                IF NULLCMD=NO                                     2064
*                  THEN                                            2064
         TM    NULLCMD,B'01000000'                                 2064
         BNZ   @RF02064                                            2064
*                    DO;                                           2065
*                    DARGSMOD=RISTID;                              2066
         L     @02,DDSTRU                                          2066
         MVC   DARGSMOD(3,@02),RISTID                              2066
*                    DARGSENT=INRECID;                             2067
         MVI   DARGSENT(@02),X'27'                                 2067
*                    BLANKFLD=BLANK;                               2068
         MVI   BLANKFLD+1,C' '                                     2068
         MVC   BLANKFLD+2(8),BLANKFLD+1                            2068
         MVI   BLANKFLD,C' '                                       2068
*                    DARGDBP=ADDR(BLANKFLD);                       2069
         LA    @15,BLANKFLD                                        2069
         ST    @15,DARGDBP(,@02)                                   2069
*                    DARGILP=LENGTH(BLANKFLD);                     2070
*                                                                  2070
         MVC   DARGILP(2,@02),@CH00040                             2070
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         2071
*                                                                  2071
         ST    GDTPTR,@AL00001                                     2071
         LA    @02,@CF00125                                        2071
         ST    @02,@AL00001+4                                      2071
         LA    @02,DDSTRU                                          2071
         ST    @02,@AL00001+8                                      2071
         MVI   @AL00001+8,X'80'                                    2071
         L     @15,GDTPRT(,GDTPTR)                                 2071
         LA    @01,@AL00001                                        2071
         BALR  @14,@15                                             2071
*                    END;                                          2072
*                  ELSE                                            2073
*                    NULLCMD=NO;                                   2073
         B     @RC02064                                            2073
@RF02064 NI    NULLCMD,B'10111111'                                 2073
*                END;                                              2074
*              ELSE                                                2075
*                SCANINDX=SCANINDX+1;                              2075
*                                                                  2075
         B     @RC02056                                            2075
@RF02056 LH    @02,SCANINDX                                        2075
         LA    @02,1(,@02)                                         2075
         STH   @02,SCANINDX                                        2075
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE NEXT INPUT CHARACTER & ALSO OBTAIN THE   */
*            /* INPUT CHARACTER WHICH LOGICALLY FOLLOWS THIS NEXT    */
*            /* CHARACTER (GET THE NEXT RECORD IF NECESSARY).        */
*            /*                                                      */
*            /********************************************************/
*            IF SCNLIMIT > 0                                       2076
*              THEN                                                2076
@RC02056 ICM   @02,3,SCNLIMIT                                      2076
         BNP   @RF02076                                            2076
*                CHAR1=INREC(SCANINDX);                            2077
         LH    @02,SCANINDX                                        2077
         L     @01,RECRDPTR                                        2077
         ALR   @01,@02                                             2077
         BCTR  @01,0                                               2077
         MVC   CHAR1(1),INREC(@01)                                 2077
*            IF SCANINDX >= SCNLIMIT                               2078
*              THEN                                                2078
*                                                                  2078
@RF02076 LH    @02,SCANINDX                                        2078
         CH    @02,SCNLIMIT                                        2078
         BL    @RF02078                                            2078
*                /****************************************************/
*                /*                                                  */
*                /* OBTAIN THE NEXT INPUT RECORD IN ORDER TO PICK UP */
*                /* THE SECOND INPUT CHARACTER                       */
*                /*                                                  */
*                /****************************************************/
*DOGRP190:       DO;                                               2079
*                                                                  2079
DOGRP190 DS    0H                                                  2080
*                  /**************************************************/
*                  /*                                                */
*                  /* FABRICATE A COMMAND-END DELIMITER IF SCANNING  */
*                  /* HAS REACHED THE END OF A NON-CONTINUED COMMAND.*/
*                  /*                                                */
*                  /**************************************************/
*                  IF OPTSFLAG=ON  MORTOCOM=NO                    2080
*                    THEN                                          2080
         TM    OPTSFLAG,B'00100000'                                2080
         BO    @RT02080                                            2080
         TM    MORTOCOM,B'00010000'                                2080
         BNZ   @RF02080                                            2080
@RT02080 DS    0H                                                  2081
*                      DO;                                         2081
*                      CHAR1=ENDDELIM;                             2082
         MVI   CHAR1,C';'                                          2082
*                      CHAR2=BLANK;                                2083
         MVI   CHAR2,C' '                                          2083
*                      END;                                        2084
*                    ELSE                                          2085
*                      IF SCANINDX > SCNLIMIT                      2085
*                        THEN                                      2085
         B     @RC02080                                            2085
@RF02080 LH    @02,SCANINDX                                        2085
         CH    @02,SCNLIMIT                                        2085
         BNH   @RF02085                                            2085
*                          CHAR1=BLANK;                            2086
*                                                                  2086
         MVI   CHAR1,C' '                                          2086
*                  /**************************************************/
*                  /*                                                */
*                  /* READ IN RECORD(S), STRIPPING CHARACTERS NOT TO */
*                  /* BE SCANNED FROM BOTH ENDS OF THE NEW RECORD -- */
*                  /* READ IN RECORDS UNTIL ONE IS READ WHICH HAS    */
*                  /* CHARACTERS LEFT TO BE SCANNED AFTER STRIPPING. */
*                  /* READ NO MORE RECORDS IF A 'READ' CONDITION HAS */
*                  /* BEEN FOUND OR IF THE CURRENT COMMAND IS NOT    */
*                  /* CONTINUED ON TO THE NEXT INPUT RECORD.         */
*                  /*                                                */
*                  /**************************************************/
*                  INCOMM=NO;                                      2087
@RF02085 DS    0H                                                  2087
@RC02080 NI    INCOMM,B'11011111'                                  2087
*                  DO WHILE(SCNLIMIT-SCANINDX <= 0 &               2088
*                           OPTSFLAG=OFF & MORTOCOM=YES &          2088
*                           RISTATUS^=EOFILE & RISTATUS^=SKIPREST);
*                                                                  2088
         B     @DE02088                                            2088
@DL02088 DS    0H                                                  2089
*                    CALL GETRECRD;                                2089
*                                                                  2089
         BAL   @14,GETRECRD                                        2089
*                  END;                                            2090
*                                                                  2090
@DE02088 LH    @02,SCNLIMIT                                        2090
         SH    @02,SCANINDX                                        2090
         LTR   @02,@02                                             2090
         BP    @DC02088                                            2090
         TM    OPTSFLAG,B'00100000'                                2090
         BNZ   @DC02088                                            2090
         TM    MORTOCOM,B'00010000'                                2090
         BNO   @DC02088                                            2090
         LH    @02,RISTATUS                                        2090
         CH    @02,@CH00157                                        2090
         BE    @DC02088                                            2090
         CH    @02,@CH00042                                        2090
         BNE   @DL02088                                            2090
@DC02088 DS    0H                                                  2091
*                  /**************************************************/
*                  /*                                                */
*                  /* IF NO MORE INPUT RECORDS REMAIN, SET VALUES TO */
*                  /* INDICATE THIS CONDITION.                       */
*                  /*                                                */
*                  /**************************************************/
*                  IF RISTATUS = EOFILE                            2091
*                    THEN                                          2091
         CLC   RISTATUS(2),@CH00157                                2091
         BNE   @RF02091                                            2091
*                      DO;                                         2092
*                      OLDERID2 = NEWERID2;                        2093
         L     @02,GDTTR2(,GDTPTR)                                 2093
         MVC   @TS00001(95),NEWERID2(@02)                          2093
         MVC   OLDERID2(95,@02),@TS00001                           2093
*                      NEWID2='RI59';                              2094
         MVC   NEWID2(4,@02),@CC01375                              2094
*                      CHAR2=BLANK;                                2095
         MVI   CHAR2,C' '                                          2095
*                      FINALCHR=YES;                               2096
         OI    FINALCHR,B'00000010'                                2096
*                      RISTATUS=0;                                 2097
         SLR   @02,@02                                             2097
         STH   @02,RISTATUS                                        2097
*                      END;                                        2098
*                END DOGRP190;                                     2099
*                                                                  2099
@RF02091 DS    0H                                                  2100
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE 2ND INPUT CHARACTER FROM THE RECORD NOW  */
*            /* POINTED TO, UNLESS A NEW RECORD WAS NOT OBTAINED     */
*            /*                                                      */
*            /********************************************************/
*            IF FINALCHR=NO  &  SCANINDX < SCNLIMIT                2100
*              THEN                                                2100
@RF02078 TM    FINALCHR,B'00000010'                                2100
         BNZ   @RF02100                                            2100
         LH    @02,SCANINDX                                        2100
         CH    @02,SCNLIMIT                                        2100
         BNL   @RF02100                                            2100
*                CHAR2=INREC(SCANINDX+1);                          2101
         L     @01,RECRDPTR                                        2101
         ALR   @01,@02                                             2101
         MVC   CHAR2(1),INREC(@01)                                 2101
*            END DOGRP185;                                         2102
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETRECRD                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE OBTAINS THE NEXT INPUT RECORD, PRINTS   */
*/*             THE RECORD AND SETS UP REFERENCE TO IT TO ALLOW      */
*/*             SCANNING TO CONTINUE.  IF NO INPUT RECORDS REMAIN,   */
*/*             THE R/I INTERNAL STATUS CODE IS SET TO SIGNAL EOF.   */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          IOCDAD -  ADDRESS OF RECORD JUST READ                   */
*/*          IOCDLN -  LENGTH OF RECORD JUST READ                    */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          RECRDPTR- POINTER TO RECORD JUST READ                   */
*/*          SCNLIMIT- LENGTH OF RECORD JUST READ                    */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE IF EOF OR AN I/O ERROR OCCURS.           */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  2103
*GETRECRD:PROCEDURE;                                               2103
         B     @PB00031                                            2103
GETRECRD STM   @14,@12,@SA00031                                    2103
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETRECRD **  GET NEXT INPUT RECORD                   */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2104
*          THEN;                                                   2104
         ICM   @02,15,GDTDBG(GDTPTR)                               2104
         BZ    @RT02104                                            2104
*          ELSE                                                    2106
*            CALL IDCDB010(GDTTBL,'RIGR');                         2106
*                                                                  2106
         ST    GDTPTR,@AL00001                                     2106
         LA    @02,@CC01379                                        2106
         ST    @02,@AL00001+4                                      2106
         MVI   @AL00001+4,X'80'                                    2106
         L     @15,GDTDBG(,GDTPTR)                                 2106
         LA    @01,@AL00001                                        2106
         BALR  @14,@15                                             2106
*        /************************************************************/
*        /*                                                          */
*        /*  REQUEST NEXT RECORD AND NOTE IF THE RECORD COULD NOT    */
*        /*  BE OBTAINED.  ANY ABNORMAL CONDITION OTHER THAN END-OF- */
*        /*  FILE IS TREATED AS AN I/O ERROR                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  2107
*        CALL IDCIOGT0(GDTTBL,ADDRIOCS);                           2107
@RT02104 ST    GDTPTR,@AL00001                                     2107
         L     @02,GDTRIH(,GDTPTR)                                 2107
         LA    @02,ADDRIOCS(,@02)                                  2107
         ST    @02,@AL00001+4                                      2107
         MVI   @AL00001+4,X'80'                                    2107
         L     @15,GDTGET(,GDTPTR)                                 2107
         LA    @01,@AL00001                                        2107
         BALR  @14,@15                                             2107
*        RESPECIFY RTNREG RSTD;                                    2108
*        TESTRC = RTNREG;                                          2109
         STH   RTNREG,TESTRC                                       2109
*        RESPECIFY RTNREG UNRSTD;                                  2110
*                                                                  2110
*        IF TESTRC^=0                                              2111
*          THEN                                                    2111
         LH    @02,TESTRC                                          2111
         LTR   @02,@02                                             2111
         BZ    @RF02111                                            2111
*            IF TESTRC=16                                          2112
*              THEN                                                2112
         CH    @02,@CH00482                                        2112
         BNE   @RF02112                                            2112
*                RISTATUS=EOFILE;                                  2113
         MVC   RISTATUS(2),@CH00157                                2113
*              ELSE                                                2114
*                DO;                                               2114
         B     @RC02112                                            2114
@RF02112 DS    0H                                                  2115
*                LASTCC=TERMERR;                                   2115
         MVC   LASTCC(2),@CH00482                                  2115
*                RISTATUS=SKIPREST;                                2116
         MVC   RISTATUS(2),@CH00042                                2116
*                END;                                              2117
*                                                                  2117
*          /**********************************************************/
*          /*                                                        */
*          /*  WHEN RECORD IS OBTAINED, PRINT IT AND SET IT UP FOR   */
*          /*  SCANNING                                              */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    2118
*            DO;                                                   2118
         B     @RC02111                                            2118
@RF02111 DS    0H                                                  2119
*            RECRDPTR=ADDRIOCS->IOCDAD;                            2119
         L     @02,GDTRIH(,GDTPTR)                                 2119
         L     @02,ADDRIOCS(,@02)                                  2119
         L     @15,IOCDAD(,@02)                                    2119
         ST    @15,RECRDPTR                                        2119
*            SCNLIMIT=ADDRIOCS->IOCDLN;                            2120
*                                                                  2120
         L     @02,IOCDLN(,@02)                                    2120
         STH   @02,SCNLIMIT                                        2120
*            /********************************************************/
*            /*                                                      */
*            /* SET UP PRINT ROUTINE DATA STRUCTURES                 */
*            /*                                                      */
*            /********************************************************/
*            DARGDBP=RECRDPTR;                                     2121
         L     @14,DDSTRU                                          2121
         ST    @15,DARGDBP(,@14)                                   2121
*            DARGILP=SCNLIMIT;                                     2122
         STH   @02,DARGILP(,@14)                                   2122
*            DARGSMOD=RISTID;                                      2123
         MVC   DARGSMOD(3,@14),RISTID                              2123
*            DARGSENT=INRECID;                                     2124
*                                                                  2124
         MVI   DARGSENT(@14),X'27'                                 2124
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                 2125
*                                                                  2125
         ST    GDTPTR,@AL00001                                     2125
         LA    @02,@CF00125                                        2125
         ST    @02,@AL00001+4                                      2125
         LA    @02,DDSTRU                                          2125
         ST    @02,@AL00001+8                                      2125
         MVI   @AL00001+8,X'80'                                    2125
         L     @15,GDTPRT(,GDTPTR)                                 2125
         LA    @01,@AL00001                                        2125
         BALR  @14,@15                                             2125
*            CALL SCANENDS;                                        2126
*                                                                  2126
         BAL   @14,SCANENDS                                        2126
*            END;                                                  2127
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SCANENDS                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS BOTH ENDS OF A NEW INPUT RECORD,  */
*/*             CHECKING FOR CHARACTERS WHICH SHOULD NOT BE INCLUDED */
*/*             IN THE NORMAL COMMAND SCANNING.  ONLY THOSE CHAR'S   */
*/*             WITHIN THE SPECIFIED SOURCE MARGINS ARE ELIGIBLE FOR */
*/*             SCANNING.  ALSO, LEADING BLANKS AND COMMENTS ARE     */
*/*             IGNORED IF THE PREVIOUS RECORD ENDED WITH A FIELD    */
*/*             CONTINUATION CHARACTER (A PLUS SIGN); IF THE NEW     */
*/*             RECORD ENDS WITH A CONTINUATION CHARACTER, THEN ALL  */
*/*             CHARACTERS INCLUDING AND FOLLOWING IT ARE IGNORED.   */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          LEFTMGN - LEFT INPUT COMMAND SOURCE MARGIN              */
*/*          RIGHTMGN- RIGHT INPUT COMMAND SOURCE MARGIN             */
*/*          SCNLIMIT- LENGTH OF NEW INPUT RECORD                    */
*/*          CONTNEXT- FLAG SET 'ON' IF PREVIOUS RECORD ENDED WITH   */
*/*                    A FIELD CONTINUATION DELIMITER                */
*/*          INREC -   CONTAINS THE NEW INPUT RECORD                 */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SCANINDX- OFFSET INTO NEW RECORD AT WHICH NORMAL        */
*/*                    SCANNING IS TO BEGIN                          */
*/*          SCNLIMIT- OFFSET INTO NEW RECORD AT WHICH NORMAL        */
*/*                    SCANNING IS TO END                            */
*/*          CONTNEXT- FLAG SET 'ON' IF NEW RECORD ENDS WITH THE     */
*/*                    FIELD CONTINUATION DELIMITER                  */
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE NEW RECORD IS TO BE    */
*/*                    CONTINUED ON TO THE NEXT INPUT RECORD.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  2128
*SCANENDS:PROCEDURE;                                               2128
         B     @PB00032                                            2128
SCANENDS STM   @14,@12,@SA00032                                    2128
*        /************************************************************/
*        /*                                                          */
*        /* SCANENDS PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL ENDFOUND BIT(1);          /*SIGNALS THAT THE FINAL CHAR.
*                                        TO BE SCANNED IN THE NEW  2129
*                                        RECORD HAS BEEN DETERMINED. */
*        DCL SKIPLEAD BIT(1);          /*SIGNALS THAT LEADING BLANKS
*                                        ARE TO BE SKIPPED BEFORE  2130
*                                        SCANNING THE NEW RECORD.    */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SCANENDS **  SCAN RECORD FOR CONTINUATION INDICATION */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2131
*          THEN;                                                   2131
         ICM   @02,15,GDTDBG(GDTPTR)                               2131
         BZ    @RT02131                                            2131
*          ELSE                                                    2133
*            CALL IDCDB010(GDTTBL,'RISE');                         2133
*                                                                  2133
         ST    GDTPTR,@AL00001                                     2133
         LA    @02,@CC01386                                        2133
         ST    @02,@AL00001+4                                      2133
         MVI   @AL00001+4,X'80'                                    2133
         L     @15,GDTDBG(,GDTPTR)                                 2133
         LA    @01,@AL00001                                        2133
         BALR  @14,@15                                             2133
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE LEFT AND RIGHT SCANNING LIMITS OF NEW RECORD. */
*        /* THEN SCAN BACKWARD FROM THE END OF THE NEW RECORD,       */
*        /* CHECKING FOR A CONTINUATION DELIMITER                    */
*        /*                                                          */
*        /************************************************************/
*        SCANINDX=LEFTMGN;                                         2134
@RT02131 L     @02,GDTRIH(,GDTPTR)                                 2134
         MVC   SCANINDX(2),LEFTMGN(@02)                            2134
*        SCNLIMIT=MIN(RIGHTMGN,SCNLIMIT);                          2135
         LH    @02,RIGHTMGN(,@02)                                  2135
         LH    @15,SCNLIMIT                                        2135
         CR    @02,@15                                             2135
         BNH   *+6
         LR    @02,@15                                             2135
         STH   @02,SCNLIMIT                                        2135
*        IF CONTNEXT=YES                                           2136
*          THEN                                                    2136
         TM    CONTNEXT,B'00001000'                                2136
         BNO   @RF02136                                            2136
*            DO;                                                   2137
*            SKIPLEAD=YES;                                         2138
         OI    SKIPLEAD,B'10000000'                                2138
*            CONTNEXT=NO;                                          2139
         NI    CONTNEXT,B'11110111'                                2139
*            END;                                                  2140
*          ELSE                                                    2141
*            SKIPLEAD=NO;                                          2141
         B     @RC02136                                            2141
@RF02136 NI    SKIPLEAD,B'01111111'                                2141
*        MORTOCOM=NO;                                              2142
@RC02136 NI    MORTOCOM,B'11101111'                                2142
*        ENDFOUND=NO;                                              2143
         NI    ENDFOUND,B'01111111'                                2143
*        DO INDEX=SCNLIMIT TO SCANINDX BY -1 WHILE(ENDFOUND=NO);   2144
*                                                                  2144
         LH    @02,SCNLIMIT                                        2144
         STH   @02,INDEX                                           2144
         B     @DE02144                                            2144
@DL02144 TM    ENDFOUND,B'10000000'                                2144
         BNZ   @DC02144                                            2144
*          /**********************************************************/
*          /*                                                        */
*          /* SEARCH FOR THE LAST NON-BLANK CHARACTER OF THE NEW     */
*          /* RECORD, WHICH MAY INDICATE FIELD AND/OR COMMAND        */
*          /* CONTINUATION OR SIMPLY THE SCANNING LIMIT OF THE RECORD*/
*          /*                                                        */
*          /**********************************************************/
*          IF INREC(INDEX) ^= BLANK                                2145
*            THEN                                                  2145
         L     @15,RECRDPTR                                        2145
         ALR   @02,@15                                             2145
         BCTR  @02,0                                               2145
         CLI   INREC(@02),C' '                                     2145
         BE    @RF02145                                            2145
*              IF INREC(INDEX) = CMDCONT    INREC(INDEX) = FLDCONT
*                                                                  2146
*                /****************************************************/
*                /*                                                  */
*                /* A CONTINUATION DELIMITER DENOTES THAT THIS       */
*                /* COMMAND CONTINUES ON TO THE NEXT RECORD.         */
*                /*                                                  */
*                /****************************************************/
*                THEN                                              2146
         LH    @02,INDEX                                           2146
         ALR   @02,@15                                             2146
         BCTR  @02,0                                               2146
         CLI   INREC(@02),C'-'                                     2146
         BE    @RT02146                                            2146
         LH    @02,INDEX                                           2146
         ALR   @15,@02                                             2146
         BCTR  @15,0                                               2146
         CLI   INREC(@15),C'+'                                     2146
         BNE   @RF02146                                            2146
@RT02146 DS    0H                                                  2147
*                  DO;                                             2147
*                                                                  2147
*                  /**************************************************/
*                  /*                                                */
*                  /* IF FIELD CONTINUATION IS INDICATED, NOTE THAT  */
*                  /* LEADING COMMENTS AND BLANKS ARE TO BE IGNORED  */
*                  /* IN THE NEXT RECORD(S) UNTIL A NON-BLANK OR     */
*                  /* COMMAND TERMINATION IS FOUND, UNLESS THE SCAN  */
*                  /* IS ALREADY IN MID-COMMENT.                     */
*                  /*                                                */
*                  /**************************************************/
*                  IF INREC(INDEX)=FLDCONT                         2148
*                    THEN                                          2148
         LH    @02,INDEX                                           2148
         L     @01,RECRDPTR                                        2148
         ALR   @01,@02                                             2148
         BCTR  @01,0                                               2148
         CLI   INREC(@01),C'+'                                     2148
         BNE   @RF02148                                            2148
*                      CONTNEXT=YES;                               2149
         OI    CONTNEXT,B'00001000'                                2149
*                  MORTOCOM=YES;                                   2150
@RF02148 OI    MORTOCOM,B'00010000'                                2150
*                  ENDFOUND=YES;                                   2151
         OI    ENDFOUND,B'10000000'                                2151
*                  SCNLIMIT=INDEX-1;                               2152
         LH    @02,INDEX                                           2152
         BCTR  @02,0                                               2152
         STH   @02,SCNLIMIT                                        2152
*                  END;                                            2153
*                                                                  2153
*                /****************************************************/
*                /*                                                  */
*                /* WHEN NOT ONE OF THE ABOVE DELIMITERS, THE SCAN   */
*                /* LIMIT HAS BEEN FOUND.                            */
*                /*                                                  */
*                /****************************************************/
*                ELSE                                              2154
*                  ENDFOUND=YES;                                   2154
         B     @RC02146                                            2154
@RF02146 OI    ENDFOUND,B'10000000'                                2154
*        END;                                                      2155
*                                                                  2155
@RC02146 DS    0H                                                  2155
@RF02145 SLR   @02,@02                                             2155
         BCTR  @02,0                                               2155
         AH    @02,INDEX                                           2155
         STH   @02,INDEX                                           2155
@DE02144 CH    @02,SCANINDX                                        2155
         BNL   @DL02144                                            2155
@DC02144 DS    0H                                                  2156
*        /************************************************************/
*        /*                                                          */
*        /* BYPASS LEADING BLANKS AND/OR COMMENTS IF A FIELD         */
*        /* CONTINUATION DELIMITER WAS FOUND ENDING THE PRECEDING    */
*        /* INPUT RECORD.                                            */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPLEAD=YES & COMMENT=NO                              2156
*          THEN                                                    2156
         TM    SKIPLEAD,B'10000000'                                2156
         BNO   @RF02156                                            2156
         TM    COMMENT,B'01000000'                                 2156
         BNZ   @RF02156                                            2156
*DOGRP195:   DO;                                                   2157
DOGRP195 DS    0H                                                  2158
*              OLDERID2 = NEWERID2;                                2158
         L     @02,GDTTR2(,GDTPTR)                                 2158
         MVC   @TS00001(95),NEWERID2(@02)                          2158
         MVC   OLDERID2(95,@02),@TS00001                           2158
*              NEWID2='RI60';                                      2159
         MVC   NEWID2(4,@02),@CC01389                              2159
*DOLOOP45:     DO INDEX=SCANINDX TO SCNLIMIT WHILE(SKIPLEAD=YES);  2160
DOLOOP45 LH    @02,SCANINDX                                        2160
         B     @DE02160                                            2160
@DL02160 TM    SKIPLEAD,B'10000000'                                2160
         BNO   @DC02160                                            2160
*                IF INREC(INDEX) ^= BLANK                          2161
*                  THEN                                            2161
*                                                                  2161
         L     @15,RECRDPTR                                        2161
         ALR   @02,@15                                             2161
         BCTR  @02,0                                               2161
         CLI   INREC(@02),C' '                                     2161
         BE    @RF02161                                            2161
*                    /************************************************/
*                    /*                                              */
*                    /* IF BYPASSING A LEADING COMMENT, LOOK FOR THE */
*                    /* DELIMITER WHICH ENDS THE COMMENT.            */
*                    /*                                              */
*                    /************************************************/
*                    IF INCOMM=YES                                 2162
*                      THEN                                        2162
         TM    INCOMM,B'00100000'                                  2162
         BNO   @RF02162                                            2162
*                        IF INDEX < SCNLIMIT &                     2163
*                           INREC(INDEX:INDEX+1) = COMEND          2163
*                          THEN                                    2163
         LH    @02,INDEX                                           2163
         CH    @02,SCNLIMIT                                        2163
         BNL   @RF02163                                            2163
         ALR   @15,@02                                             2163
         BCTR  @15,0                                               2163
         CLC   INREC(2,@15),COMEND                                 2163
         BNE   @RF02163                                            2163
*                            DO;                                   2164
*                            OLDERID2 = NEWERID2;                  2165
         L     @15,GDTTR2(,GDTPTR)                                 2165
         MVC   @TS00001(95),NEWERID2(@15)                          2165
         MVC   OLDERID2(95,@15),@TS00001                           2165
*                            NEWID2='RI61';                        2166
         MVC   NEWID2(4,@15),@CC01392                              2166
*                            INDEX=INDEX+1;                        2167
         LA    @02,1(,@02)                                         2167
         STH   @02,INDEX                                           2167
*                            INCOMM=NO;                            2168
         NI    INCOMM,B'11011111'                                  2168
*                            END;                                  2169
*                          ELSE;                                   2170
*                                                                  2170
@RF02163 DS    0H                                                  2171
*                      /**********************************************/
*                      /*                                            */
*                      /* WHEN BYPASSING LEADING BLANKS, CHECK FOR   */
*                      /* LEADING COMMENTS AND FOR A NON-BLANK       */
*                      /* CHARACTER INDICATING STARTING SCAN POSITION*/
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        2171
*                        IF INDEX < SCNLIMIT &                     2171
*                           INREC(INDEX:INDEX+1) = COMSTART        2171
*                          THEN                                    2171
         B     @RC02162                                            2171
@RF02162 LH    @02,INDEX                                           2171
         CH    @02,SCNLIMIT                                        2171
         BNL   @RF02171                                            2171
         L     @01,RECRDPTR                                        2171
         ALR   @01,@02                                             2171
         BCTR  @01,0                                               2171
         CLC   INREC(2,@01),COMSTART                               2171
         BNE   @RF02171                                            2171
*                            DO;                                   2172
*                            OLDERID2 = NEWERID2;                  2173
         L     @15,GDTTR2(,GDTPTR)                                 2173
         MVC   @TS00001(95),NEWERID2(@15)                          2173
         MVC   OLDERID2(95,@15),@TS00001                           2173
*                            NEWID2='RI62';                        2174
         MVC   NEWID2(4,@15),@CC01393                              2174
*                            INCOMM=YES;                           2175
         OI    INCOMM,B'00100000'                                  2175
*                            INDEX=INDEX+1;                        2176
         LA    @02,1(,@02)                                         2176
         STH   @02,INDEX                                           2176
*                            END;                                  2177
*                          ELSE                                    2178
*                            DO;                                   2178
         B     @RC02171                                            2178
@RF02171 DS    0H                                                  2179
*                            SKIPLEAD=NO;                          2179
         NI    SKIPLEAD,B'01111111'                                2179
*                            SCANINDX=INDEX;                       2180
         MVC   SCANINDX(2),INDEX                                   2180
*                            END;                                  2181
*              END DOLOOP45;                                       2182
@RC02171 DS    0H                                                  2182
@RC02162 DS    0H                                                  2182
@RF02161 LA    @02,1                                               2182
         AH    @02,INDEX                                           2182
@DE02160 STH   @02,INDEX                                           2182
         CH    @02,SCNLIMIT                                        2182
         BNH   @DL02160                                            2182
@DC02160 DS    0H                                                  2183
*              /******************************************************/
*              /*                                                    */
*              /* IF ONLY BLANKS AND COMMENTS WERE FOUND IN THIS     */
*              /* RECORD FOLLOWING FIELD CONTINUATION, THEN CHECK TO */
*              /* SEE IF THE RECORD IS CONTINUED.  IF SO, NOTE THAT  */
*              /* IT SHOULD STILL BE CONSIDERED FIELD CONTINUATION.  */
*              /* IF NOT CONTINUED, SET 'CHAR2' TO BE BLANK UNTIL THE*/
*              /* NEXT CALL TO 'NEXTCHAR' CAN FABRICATE A SEMICOLON. */
*              /*                                                    */
*              /******************************************************/
*              IF SKIPLEAD=YES                                     2183
*                THEN                                              2183
         TM    SKIPLEAD,B'10000000'                                2183
         BNO   @RF02183                                            2183
*                  DO;                                             2184
*                  SCANINDX=INDEX+1;                               2185
         LH    @02,INDEX                                           2185
         LA    @02,1(,@02)                                         2185
         STH   @02,SCANINDX                                        2185
*                  IF MORTOCOM=YES                                 2186
*                    THEN                                          2186
         TM    MORTOCOM,B'00010000'                                2186
         BNO   @RF02186                                            2186
*                      CONTNEXT=YES;                               2187
         OI    CONTNEXT,B'00001000'                                2187
*                    ELSE                                          2188
*                      CHAR2=BLANK;                                2188
         B     @RC02186                                            2188
@RF02186 MVI   CHAR2,C' '                                          2188
*                  END;                                            2189
@RC02186 DS    0H                                                  2190
*            END DOGRP195;                                         2190
*                                                                  2190
@RF02183 DS    0H                                                  2191
*        /************************************************************/
*        /*                                                          */
*        /* ADJUST STARTING SCAN POSITION IN PREPARATION FOR         */
*        /* INCREMENTING OF THE SCAN POSITION POINTER.  ADJUST ENDING*/
*        /* SCAN LIMIT IF COMMAND CONTINUATION IS NOT INDICATED IN   */
*        /* PREPARATION FOR FABRICATING A COMMAND-ENDING DELIMITER.  */
*        /*                                                          */
*        /************************************************************/
*        SCANINDX=SCANINDX-1;                                      2191
@RF02156 LH    @02,SCANINDX                                        2191
         BCTR  @02,0                                               2191
         STH   @02,SCANINDX                                        2191
*        IF MORTOCOM=NO                                            2192
*          THEN                                                    2192
         TM    MORTOCOM,B'00010000'                                2192
         BNZ   @RF02192                                            2192
*            SCNLIMIT=SCNLIMIT+1;                                  2193
*                                                                  2193
         LH    @02,SCNLIMIT                                        2193
         LA    @02,1(,@02)                                         2193
         STH   @02,SCNLIMIT                                        2193
*        END SCANENDS;                                             2194
*                                                                  2194
*                                                                  2194
@EL00032 DS    0H                                                  2194
@EF00032 DS    0H                                                  2194
@ER00032 LM    @14,@12,@SA00032                                    2194
         BR    @14                                                 2194
*        END GETRECRD;                                     /*@YL026UL*/
*                                                                  2195
*                                                                  2195
@EL00031 DS    0H                                                  2195
@EF00031 DS    0H                                                  2195
@ER00031 LM    @14,@12,@SA00031                                    2195
         BR    @14                                                 2195
*        END NEXTCHAR;                                     /*@YL026UL*/
@EL00030 DS    0H                                                  2196
@EF00030 DS    0H                                                  2196
@ER00030 LM    @14,@12,@SA00030                                    2196
         BR    @14                                                 2196
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DSPLCALC                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CALCULATES THE OFFSET INTO THE CURRENT  */
*/*             PARAMETER'S FDT POINTER VECTOR AT WHICH A VALUE IS   */
*/*             TO BE INSERTED.  THE VALUE IS ONE WHICH IS RELATED   */
*/*             THE FDT POINTER STRUCTURE USED FOR REPEATED SUBLISTS */
*/*             AND THE OFFSET IS BASED UPON THE CURRENT REPEATED    */
*/*             SUBLIST NESTING LEVEL AND THE MAXIMUM NUMBER OF      */
*/*             SUBLIST REPETITIONS ALLOWED.                         */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          DEPTH -   CURRENT LEVEL OF REPEATED SUBLIST NESTING     */
*/*          REPLIMIT- LIST CONTAINING THE MAXIMUM NUMBER OF SUBLIST */
*/*                    REPETITIONS ALLOWED AT EACH REPEATEDNESS LEVEL*/
*/*          ARRYPTR - POINTER IN MAIN FDT POINTER VECTOR WHICH      */
*/*                    POINTS TO CURRENT PARAMETER'S SECONDARY PTR   */
*/*                    VECTOR.                                       */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          ARRYPTR - POINTER TO SECONDARY POINTER VECTOR, THE      */
*/*                    DISPLACEMENT INTO WHICH A VALUE WILL BE       */
*/*                    INSERTED AFTER THE RETURN FROM 'DSPLCALC'     */
*/*          ARRYDSPL- THE CALCULATED DISPLACEMENT                   */
*/*                                                                  */
*/********************************************************************/
*DSPLCALC:PROCEDURE(DEPTH);                                        2197
DSPLCALC STM   @14,@01,@SA00033                                    2197
         ST    @03,@SA00033+16                                     2197
         STM   @05,@12,@SA00033+20                                 2197
         MVC   @PC00033(4),0(@01)                                  2197
*        /************************************************************/
*        /*                                                          */
*        /* DSPLCALC PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL DEPTH FIXED(15);          /*DEPTH OF REPEATED LIST    2198
*                                        NESTING WITH WHICH THE COUNT
*                                        OR POINTER IS ASSOCIATED    */
*        DCL FACTOR   FIXED(15);       /*MULTIPLICATION FACTOR USED IN
*                                        CALCULATING ARRAY OFFSETS   */
*        /************************************************************/
*        /*                                                          */
*        /*  ** DSPLCALC ** CALCULATE DISPLACEMENT INTO PTR ARRAY    */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2200
*          THEN;                                                   2200
         ICM   @15,15,GDTDBG(GDTPTR)                               2200
         BZ    @RT02200                                            2200
*          ELSE                                                    2202
*            CALL IDCDB010(GDTTBL,'RIDC');                         2202
*                                                                  2202
         ST    GDTPTR,@AL00001                                     2202
         LA    @15,@CC01400                                        2202
         ST    @15,@AL00001+4                                      2202
         MVI   @AL00001+4,X'80'                                    2202
         L     @15,GDTDBG(,GDTPTR)                                 2202
         LA    @01,@AL00001                                        2202
         BALR  @14,@15                                             2202
*        ARRYDSPL=0;                                               2203
@RT02200 SLR   ARRYDSPL,ARRYDSPL                                   2203
*        IF DEPTH=0                                                2204
*          THEN                                                    2204
         L     @05,@PC00033                                        2204
         ICM   @15,3,DEPTH(@05)                                    2204
         BNZ   @RF02204                                            2204
*            ARRYPTR=ADDR(FDTPTR(PARMID));                 /*@YL026UL*/
         LH    @05,PARMID                                          2205
         SLA   @05,2                                               2205
         L     ARRYPTR,FDTADDR                                     2205
         LA    ARRYPTR,FDTPTR-4(@05,ARRYPTR)                       2205
*          ELSE                                                    2206
*            DO INDEX=1 TO DEPTH;                          /*@YL026UL*/
         B     @RC02204                                            2206
@RF02204 LA    @05,1                                               2206
         B     @DE02206                                            2206
@DL02206 DS    0H                                                  2207
*              FACTOR=1;                                   /*@YL026UL*/
         LA    @15,1                                               2207
         LR    FACTOR,@15                                          2207
*              DO LISTINDX=(INDEX+1) TO DEPTH;             /*@YL026UL*/
         LH    @14,INDEX                                           2208
         ALR   @14,@15                                             2208
         B     @DE02208                                            2208
@DL02208 DS    0H                                                  2209
*                FACTOR=FACTOR*REPLIMIT(LISTINDX);         /*@YL026UL*/
         LR    @15,@14                                             2209
         ALR   @15,@15                                             2209
         LR    @01,FACTOR                                          2209
         MH    @01,REPLIMIT-2(@15)                                 2209
         LR    FACTOR,@01                                          2209
*              END;                                        /*@YL026UL*/
         AL    @14,@CF00228                                        2210
@DE02208 STH   @14,LISTINDX                                        2210
         L     @15,@PC00033                                        2210
         CH    @14,DEPTH(,@15)                                     2210
         BNH   @DL02208                                            2210
*              ARRYDSPL=ARRYDSPL+FACTOR*PTRLNGTH*(REPCOUNT(INDEX)-1);
         LR    @01,FACTOR                                          2211
         SLA   @01,2                                               2211
         LH    @15,INDEX                                           2211
         LR    @14,@15                                             2211
         ALR   @14,@14                                             2211
         LH    @14,REPCOUNT-2(@14)                                 2211
         BCTR  @14,0                                               2211
         MR    @00,@14                                             2211
         ALR   ARRYDSPL,@01                                        2211
*            END;                                          /*@YL026UL*/
*                                                                  2212
         AL    @15,@CF00228                                        2212
         LR    @05,@15                                             2212
@DE02206 STH   @05,INDEX                                           2212
         L     @15,@PC00033                                        2212
         CH    @05,DEPTH(,@15)                                     2212
         BNH   @DL02206                                            2212
*        /************************************************************/
*        /*                                                          */
*        /* IF THE DATA POINTER IS FOR A PARAMETER IN A REPEATED     */
*        /* PARAMETER LIST (1ST LEVEL OF REPEATEDNESS), THEN THE     */
*        /* POINTER VECTOR IS BEING MAINTAINED AS A LIST OF VECTOR   */
*        /* BLOCKS.  SET UP TO POINT TO THE PROPER DATA POINTER IN   */
*        /* THE PROPER BLOCK IN THE LIST.                            */
*        /*                                                          */
*        /************************************************************/
*        IF DEPTH=1                                                2213
*          THEN                                                    2213
@RC02204 LA    @05,1                                               2213
         L     @15,@PC00033                                        2213
         CH    @05,DEPTH(,@15)                                     2213
         BNE   @RF02213                                            2213
*            DO;                                                   2214
*              OLDERID2 = NEWERID2;                                2215
         L     @15,GDTTR2(,GDTPTR)                                 2215
         MVC   @TS00001(95),NEWERID2(@15)                          2215
         MVC   OLDERID2(95,@15),@TS00001                           2215
*              NEWID2='RI66';                                      2216
         MVC   NEWID2(4,@15),@CC01401                              2216
*              VECTRNUM=ARRYDSPL/VECTRLEN+1;                       2217
         LH    @15,VECTRLEN                                        2217
         LR    @00,ARRYDSPL                                        2217
         SRDA  @00,32                                              2217
         DR    @00,@15                                             2217
         ALR   @01,@05                                             2217
         STH   @01,VECTRNUM                                        2217
*              ARRYDSPL=ARRYDSPL//VECTRLEN;                        2218
         LR    @00,ARRYDSPL                                        2218
         SRDA  @00,32                                              2218
         DR    @00,@15                                             2218
         LR    ARRYDSPL,@00                                        2218
*              DO INDEX2=1 TO VECTRNUM-1;                          2219
         B     @DE02219                                            2219
@DL02219 DS    0H                                                  2220
*                ARRYPTR=VECTRPTR;                                 2220
         LR    @15,ARRYPTR                                         2220
         AH    @15,VECTRLEN                                        2220
         L     @15,VECTRPTR(,@15)                                  2220
         LR    ARRYPTR,@15                                         2220
*              END;                                                2221
         AL    @05,@CF00228                                        2221
@DE02219 STH   @05,INDEX2                                          2221
         LH    @15,VECTRNUM                                        2221
         BCTR  @15,0                                               2221
         CR    @05,@15                                             2221
         BNH   @DL02219                                            2221
*            END;                                                  2222
*                                                                  2222
*        END DSPLCALC;                                             2223
@EL00033 DS    0H                                                  2223
@EF00033 DS    0H                                                  2223
@ER00033 LM    @14,@01,@SA00033                                    2223
         L     @03,@SA00033+16                                     2223
         LM    @05,@12,@SA00033+20                                 2223
         BR    @14                                                 2223
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - ERROR1                                         */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR WHICH*/
*/*             REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND. THIS */
*/*             TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE WITH   */
*/*             THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS        */
*/*             ENTIRELY OF STATIC TEXT.                             */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          ERRCODE1- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */
*/*                    WILL BE USED AS PART OF THE MESSAGE ID        */
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY     */
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */
*/*                    HAS BEEN SKIPPED                              */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PRINTED ERROR MESSAGE.                                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE ERROR    */
*/*                    CODE VALUE                                    */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*          SCANONLY- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*ERROR1: PROCEDURE(ERRCODE1);                                      2224
ERROR1   STM   @14,@12,@SA00034                                    2224
         MVC   @PC00034(4),0(@01)                                  2224
*        /************************************************************/
*        /*                                                          */
*        /* ERROR1 PROCEDURE DATA DEFINITIONS                        */
*        /*                                                          */
*        /************************************************************/
*        DCL ERRCODE1 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */
*        /************************************************************/
*        /*                                                          */
*        /*  ** ERROR1 **  HANDLE SYNTAX OR SEMANTIC ERROR           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2226
*          THEN;                                                   2226
         ICM   @02,15,GDTDBG(GDTPTR)                               2226
         BZ    @RT02226                                            2226
*          ELSE                                                    2228
*            CALL IDCDB010(GDTTBL,'RIE1');                         2228
*                                                                  2228
         ST    GDTPTR,@AL00001                                     2228
         LA    @02,@CC01407                                        2228
         ST    @02,@AL00001+4                                      2228
         MVI   @AL00001+4,X'80'                                    2228
         L     @15,GDTDBG(,GDTPTR)                                 2228
         LA    @01,@AL00001                                        2228
         BALR  @14,@15                                             2228
*        IF SCANONLY=NO                                            2229
*          THEN                                                    2229
@RT02226 TM    SCANONLY,B'00010000'                                2229
         BNZ   @RF02229                                            2229
*            LASTCC=BADERROR;                                      2230
         MVC   LASTCC(2),@CH00038                                  2230
*        RISTATUS=ERRCODE1;                                        2231
@RF02229 L     @02,@PC00034                                        2231
         L     @02,ERRCODE1(,@02)                                  2231
         STH   @02,RISTATUS                                        2231
*        IF ERRCODE1^=NOSPACE                                      2232
*          THEN                                                    2232
         CH    @02,@CH00811                                        2232
         BE    @RF02232                                            2232
*            DO;                                                   2233
*            DARGSMOD=RISTID;                                      2234
         L     @15,DDSTRU                                          2234
         MVC   DARGSMOD(3,@15),RISTID                              2234
*            DARGSENT=ERRCODE1;                                    2235
         STC   @02,DARGSENT(,@15)                                  2235
*            END;                                                  2236
*          ELSE                                                    2237
*            DO;                                                   2237
         B     @RC02232                                            2237
@RF02232 DS    0H                                                  2238
*            DARGSMOD='UV0';                                       2238
         L     @02,DDSTRU                                          2238
         MVC   DARGSMOD(3,@02),@CC01408                            2238
*            DARGSENT=4;                                           2239
         MVI   DARGSENT(@02),X'04'                                 2239
*            END;                                                  2240
*                                                                  2240
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     2241
*                                                                  2241
@RC02232 ST    GDTPTR,@AL00001                                     2241
         LA    @02,@CF00125                                        2241
         ST    @02,@AL00001+4                                      2241
         LA    @02,DDSTRU                                          2241
         ST    @02,@AL00001+8                                      2241
         MVI   @AL00001+8,X'80'                                    2241
         L     @15,GDTPRT(,GDTPTR)                                 2241
         LA    @01,@AL00001                                        2241
         BALR  @14,@15                                             2241
*        /************************************************************/
*        /*                                                          */
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPPAST=NO                                            2242
*          THEN                                                    2242
         TM    SKIPPAST,B'00001000'                                2242
         BNZ   @RF02242                                            2242
*            DO;                                                   2243
*                                                                  2243
*              CALL SKIPCMD;                                       2244
*                                                                  2244
         BAL   @14,SKIPCMD                                         2244
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2245
*                       RISTATUS^=SKIPREST);                       2245
*                                                                  2245
         B     @DE02245                                            2245
@DL02245 DS    0H                                                  2246
*                CALL NEXTCHAR;                                    2246
         BAL   @14,NEXTCHAR                                        2246
*                CALL SKIPCMD;                                     2247
*                                                                  2247
         BAL   @14,SKIPCMD                                         2247
*              END;                                                2248
@DE02245 TM    MORTOCOM,B'00010000'                                2248
         BNO   @DC02245                                            2248
         LH    @02,RISTATUS                                        2248
         CH    @02,@CH00157                                        2248
         BE    @DC02245                                            2248
         CH    @02,@CH00042                                        2248
         BNE   @DL02245                                            2248
@DC02245 DS    0H                                                  2249
*            END;                                                  2249
*                                                                  2249
*        END ERROR1;                                               2250
@EL00034 DS    0H                                                  2250
@EF00034 DS    0H                                                  2250
@ER00034 LM    @14,@12,@SA00034                                    2250
         BR    @14                                                 2250
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - ERROR2                                         */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR      */
*/*             WHICH REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND.*/
*/*             THIS TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE   */
*/*             WITH THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS   */
*/*             OF STATIC TEXT WITH AN ITEM FROM THE COMMAND TO HELP */
*/*             IDENTIFY THE SOURCE OF THE ERROR.                    */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          ERRCODE2- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */
*/*                    WHICH IS USED AS PART OF THE MESSAGE ID.      */
*/*          INSRTLEN- LENGTH OF THE COMMAND ITEM TO BE INSERTED     */
*/*                    INTO THE MESSAGE                              */
*/*          INSRTPTR- POINTER TO THE COMMAND ITEM TO BE INSERTED    */
*/*                    INTO THE MESSAGE.                             */
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY.    */
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */
*/*                    HAS BEEN SKIPPED.                             */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PRINTED ERROR MESSAGE.                                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE NON-ZERO */
*/*                    ERROR MESSAGE CODE VALUE                      */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*          SCANONLY- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*ERROR2: PROCEDURE(ERRCODE2,           /*STATIC ERROR MESSAGE ID#    */
*                  INSRTLEN,           /*INSERT DATA ITEM LENGTH     */
*                  INSRTPTR);          /*INSERT DATA ITEM ADDRESS    */
ERROR2   STM   @14,@12,@SA00035                                    2251
         MVC   @PC00035(12),0(@01)                                 2251
*        /************************************************************/
*        /*                                                          */
*        /* ERROR2 PROCEDURE DATA DEFINITIONS                        */
*        /*                                                          */
*        /************************************************************/
*        DCL ERRCODE2 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */
*        DCL INSRTLEN FIXED(31);       /*LENGTH OF DATA ITEM TO BE 2253
*                                        INSERTED INTO ERROR MESSAGE */
*        DCL INSRTPTR PTR(31);         /*PTR TO DATA ITEM TO BE    2254
*                                        INSERTED INTO ERROR MESSAGE */
*        /************************************************************/
*        /*                                                          */
*        /*  ** ERROR2 **  HANDLE SYNTAX OR SEMANTIC ERROR           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2255
*          THEN;                                                   2255
         ICM   @02,15,GDTDBG(GDTPTR)                               2255
         BZ    @RT02255                                            2255
*          ELSE                                                    2257
*            CALL IDCDB010(GDTTBL,'RIE2');                         2257
*                                                                  2257
         ST    GDTPTR,@AL00001                                     2257
         LA    @02,@CC01418                                        2257
         ST    @02,@AL00001+4                                      2257
         MVI   @AL00001+4,X'80'                                    2257
         L     @15,GDTDBG(,GDTPTR)                                 2257
         LA    @01,@AL00001                                        2257
         BALR  @14,@15                                             2257
*        IF SCANONLY=NO                                            2258
*          THEN                                                    2258
@RT02255 TM    SCANONLY,B'00010000'                                2258
         BNZ   @RF02258                                            2258
*            LASTCC=BADERROR;                                      2259
         MVC   LASTCC(2),@CH00038                                  2259
*        RISTATUS=ERRCODE2;                                        2260
@RF02258 L     @02,@PC00035                                        2260
         L     @02,ERRCODE2(,@02)                                  2260
         STH   @02,RISTATUS                                        2260
*        DARGDBP=INSRTPTR;                                         2261
         L     @15,DDSTRU                                          2261
         L     @14,@PC00035+8                                      2261
         MVC   DARGDBP(4,@15),INSRTPTR(@14)                        2261
*        DARGILP=INSRTLEN;                                         2262
         L     @14,@PC00035+4                                      2262
         MVC   DARGILP(2,@15),INSRTLEN+2(@14)                      2262
*        DARGSMOD=RISTID;                                          2263
         MVC   DARGSMOD(3,@15),RISTID                              2263
*        DARGSENT=ERRCODE2;                                        2264
*                                                                  2264
         STC   @02,DARGSENT(,@15)                                  2264
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     2265
*                                                                  2265
         ST    GDTPTR,@AL00001                                     2265
         LA    @02,@CF00125                                        2265
         ST    @02,@AL00001+4                                      2265
         LA    @02,DDSTRU                                          2265
         ST    @02,@AL00001+8                                      2265
         MVI   @AL00001+8,X'80'                                    2265
         L     @15,GDTPRT(,GDTPTR)                                 2265
         LA    @01,@AL00001                                        2265
         BALR  @14,@15                                             2265
*        /************************************************************/
*        /*                                                          */
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPPAST=NO                                            2266
*          THEN                                                    2266
         TM    SKIPPAST,B'00001000'                                2266
         BNZ   @RF02266                                            2266
*            DO;                                                   2267
*                                                                  2267
*              CALL SKIPCMD;                                       2268
*                                                                  2268
         BAL   @14,SKIPCMD                                         2268
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2269
*                       RISTATUS^=SKIPREST);                       2269
*                                                                  2269
         B     @DE02269                                            2269
@DL02269 DS    0H                                                  2270
*                CALL NEXTCHAR;                                    2270
         BAL   @14,NEXTCHAR                                        2270
*                CALL SKIPCMD;                                     2271
*                                                                  2271
         BAL   @14,SKIPCMD                                         2271
*              END;                                                2272
@DE02269 TM    MORTOCOM,B'00010000'                                2272
         BNO   @DC02269                                            2272
         LH    @02,RISTATUS                                        2272
         CH    @02,@CH00157                                        2272
         BE    @DC02269                                            2272
         CH    @02,@CH00042                                        2272
         BNE   @DL02269                                            2272
@DC02269 DS    0H                                                  2273
*            END;                                                  2273
*                                                                  2273
*        END ERROR2;                                               2274
*                                                                  2274
*                                                                  2274
@EL00035 DS    0H                                                  2274
@EF00035 DS    0H                                                  2274
@ER00035 LM    @14,@12,@SA00035                                    2274
         BR    @14                                                 2274
*        END IDCRI01                                               2275
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF25 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF26 )                                        *
*;                                                                 2275
@DATA    DS    0H
@CH00295 DC    H'5'
@CH00043 DC    H'7'
@CH00482 DC    H'16'
@CH00970 DC    H'28'
@CH00972 DC    H'29'
@CH00974 DC    H'30'
@CH00054 DC    H'31'
@CH00230 DC    H'32'
@CH00977 DC    H'33'
@CH00979 DC    H'38'
@CH01419 DC    H'66'
@CH00914 DC    H'72'
@CH00157 DC    H'100'
@CH00790 DC    H'255'
@SM01442 MVC   DATABLK(0,@15),DATABLK(@02)
@SM01447 MVC   0(0,@01),SYNUNIT
@SC01449 CLC   RELATION(0),MAXCCSYM(@15)
@SC01451 CLC   RELATION(0),LSTCCSYM(@15)
@SM01453 MVC   SYNUNIT(0),0(@01)
@SC01455 CLC   RELATION(0),MAXCCSYM(@02)
@SM01457 MVC   RELOPER(0),0(@01)
@SC01463 CLC   KWDITEM(0,KWDPTR),SYNUNIT
@SM01466 MVC   CHARS(0,@03),SYNUNIT
@SM01468 MVC   STRING(0,@04),SYNUNIT
@SM01470 MVC   LCHAR(0,@03),SYNUNIT
@SM01472 MVC   LSTRING(0,@04),SYNUNIT
@SM01476 MVC   CNVRTFLD(0),SYNUNIT
@SM01478 MVC   0(0,@02),CNVRTFLD
@SM01480 MVC   STRING+1(0,@14),DATABLK(@03)
@SM01482 MVC   LSTRING+1(0,@04),DATABLK(@15)
@SM01486 MVC   LMEMNAME-14(0,@15),0(@14)
@SM01488 MVC   MEMNAME(0,@05),0(@01)
@SM01493 MVC   LDSNAME-23(0,@15),SYNUNIT
@SM01495 MVC   DSNAME(0,@04),SYNUNIT
@SM01497 MVC   DATABLK(0,NEWPTR),DATABLK(@14)
@SM01500 MVC   SYNUNIT(0),DEFLTVAL+2(DEFLTPTR)
@SM01502 MVC   SYNUNIT(0),DEFLTVAL(DEFLTPTR)
@SM01504 MVC   ERRFIELD(0),KWDITEM(KWDPTR)
@SM01506 MVC   ERRFIELD(0),SYNUNIT
         DS    0F
@AL00384 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00539 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00541 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00634 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00650 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00736 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00804 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00810 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00851 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00882 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00940 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00945 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00971 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01000 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01572 DC    A(@CB00583)             LIST WITH   1 ARGUMENT(S)
@AL00477 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00497 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00632 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00957 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00985 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01013 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01076 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01082 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01093 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01099 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01548 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01617 DC    A(@CB00581)             LIST WITH   1 ARGUMENT(S)
@AL00490 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL02006 DC    A(@CF00166)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00228)
@AL00516 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00540 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00633 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00649 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00735 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00803 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00809 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00850 DC    A(@CF00228)             LIST WITH   1 ARGUMENT(S)
@AL00638 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01997 DC    A(@CF00786)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL00942 DC    A(@CF00041)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL00954 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01010 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL00987 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01956 DC    A(@CF00038)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL01016 DC    A(@CF00807)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL01055 DC    A(@CF00237)             LIST WITH   1 ARGUMENT(S)
@AL01075 DC    A(@CF00172)             LIST WITH   1 ARGUMENT(S)
@AL01085 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01102 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00457 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01492 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01522 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01597 DC    A(@CF00811)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00786)
@AL01123 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01440 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01092 DC    A(@CF00052)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00786)
@AL01131 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01146 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01186 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01211 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01238 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01275 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01341 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01903 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01934 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01980 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00894 DC    A(@CF00163)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00786)
@AL01170 DC    A(@CF00319)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL01244 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01292 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01304 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01316 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01899 DC    A(@CF00813)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL01333 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01901 DC    A(@CF00815)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@AL01576 DC    A(@CF01251)             LIST WITH   1 ARGUMENT(S)
@AL01631 DC    A(@CF00039)             LIST WITH   1 ARGUMENT(S)
@AL01875 DC    A(@CF00809)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00786)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    6F
@SA00002 DS    15F
@SA00003 DS    13F
@SA00004 DS    13F
@SA00029 DS    15F
@PC00029 DS    1F
@SA00034 DS    15F
@PC00034 DS    1F
@SA00035 DS    15F
@PC00035 DS    3F
@SA00021 DS    14F
@SA00023 DS    15F
@SA00030 DS    15F
@SA00025 DS    15F
@SA00009 DS    14F
@SA00010 DS    14F
@SA00020 DS    14F
@SA00028 DS    14F
@PC00028 DS    1F
@SA00006 DS    13F
@SA00005 DS    13F
@SA00008 DS    15F
@SA00007 DS    14F
@SA00027 DS    15F
@SA00026 DS    15F
@SA00011 DS    14F
@SA00033 DS    13F
@PC00033 DS    1F
@SA00013 DS    13F
@SA00012 DS    13F
@SA00014 DS    13F
@SA00018 DS    15F
@SA00015 DS    15F
@SA00016 DS    14F
@SA00019 DS    15F
@SA00017 DS    15F
@SA00022 DS    14F
@PC00022 DS    1F
@SA00024 DS    15F
@PC00024 DS    2F
@SA00031 DS    15F
@SA00032 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
@AFTEMPS DS    13F
IDCRI01  CSECT
         DS    0F
@CF00125 DC    F'0'
@CH00125 EQU   @CF00125+2
@CF00228 DC    F'1'
@CH00228 EQU   @CF00228+2
@CF00163 DC    F'2'
@CH00163 EQU   @CF00163+2
@CF00172 DC    F'3'
@CH00172 EQU   @CF00172+2
@CF00052 DC    F'4'
@CH00052 EQU   @CF00052+2
@CF00166 DC    F'6'
@CH00166 EQU   @CF00166+2
@CF00042 DC    F'8'
@CH00042 EQU   @CF00042+2
@CF00041 DC    F'9'
@CF00040 DC    F'10'
@CH00040 EQU   @CF00040+2
@CF00039 DC    F'11'
@CF00038 DC    F'12'
@CH00038 EQU   @CF00038+2
@CF00807 DC    F'13'
@CF00809 DC    F'14'
@CF00237 DC    F'15'
@CF00811 DC    F'18'
@CH00811 EQU   @CF00811+2
@CF01251 DC    F'19'
@CF00786 DC    F'20'
@CH00786 EQU   @CF00786+2
@CF00813 DC    F'21'
@CH00813 EQU   @CF00813+2
@CF00815 DC    F'22'
@CF00319 DC    F'24'
@CF01303 DC    F'26'
@CF01305 DC    F'27'
@CF01420 DC    F'36'
@CF00794 DC    F'48'
@CF01474 DC    F'-64'
@CF01475 DC    F'-63'
@CF01490 DC    F'-55'
@CF01484 DC    F'-53'
@CF01485 DC    F'-52'
@CF01491 DC    F'-44'
@CF01492 DC    F'-43'
@CF01440 DC    F'-12'
@CF01499 DC    F'-8'
@CF01441 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
GRPPTR   DS    A
DATAPTR  DS    A
PTRLOC   DS    A
AMTTOGET DS    F
BLKLEFT  DS    F
BLKPTR   DS    A
WORKPTR2 DS    A
WORKPTR3 DS    A
SETUPERR DS    F
ELTPTR   DS    A
OLDPTR   DS    A
FREEPTR  DS    A
SUBOCCUR DS    F
LISTPTR  DS    A
TESTRC   DS    H
PARMID   DS    H
VECTRNUM DS    H
SCLRCNT  DS    H
PARMLVL  DS    H
REPDEPTH DS    H
SPACELFT DS    H
SPACEAMT DS    H
INDEX    DS    H
INDEX2   DS    H
INDEX3   DS    H
LISTINDX DS    H
HWORDARG DS    H
CCVALUE  DS    H
DIGITPOS DS    H
SUBTOTAL DS    H
DIGTINDX DS    H
SEGLEN   DS    H
DATALEN  DS    H
SETRC    DS    H
CNVRTVAL DS    FL1
STARLOC  DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
COMMAREA DS    CL55
         ORG   COMMAREA
RECRDPTR DS    AL4
FDTADDR  DS    AL4
DESCPTR  DS    AL4
WORKPTR  DS    AL4
RISTATUS DS    FL2
SCANINDX DS    FL2
SCNLIMIT DS    FL2
LASTCC   DS    FL2
MAXCC    DS    FL2
FSRLNAME DS    CL8
POOLID   DS    CL4
VERBNAME DS    CL8
DESCNAME DS    CL8
GOODCMD  DS    BL1
EOFOK    EQU   COMMAREA+54
OPTSFLAG EQU   COMMAREA+54
SCANONLY EQU   COMMAREA+54
SKIPPAST EQU   COMMAREA+54
@NM00037 EQU   COMMAREA+54
         ORG   COMMAREA+55
         DS    CL1
RIPOOLID DS    CL4
         ORG   RIPOOLID
VLISTID1 DS    CL2
VLISTID  DS    FL2
         ORG   RIPOOLID+4
ORGSIGN  DS    CL1
         DS    CL3
SYNUNIT  DS    CL255
BLANKFLD DS    CL10
ERRFIELD DS    CL20
CHAR1    DS    CL1
CHAR2    DS    CL1
         DS    CL5
CNVRTFLD DS    CL10
SCANSWS  DS    CL2
         ORG   SCANSWS
PWORDSW  DS    BL1
COMMENT  EQU   SCANSWS+0
INCOMM   EQU   SCANSWS+0
MORTOCOM EQU   SCANSWS+0
CONTNEXT EQU   SCANSWS+0
FIRSTCHR EQU   SCANSWS+0
FINALCHR EQU   SCANSWS+0
JUSTONE  EQU   SCANSWS+0
ENDPAREN DS    BL1
NULLCMD  EQU   SCANSWS+1
FOUND    EQU   SCANSWS+1
SUBSYET  EQU   SCANSWS+1
DELIM    EQU   SCANSWS+1
         ORG   SCANSWS+2
OPENAREA DS    BL32
PRNTAREA DS    BL20
STMTEND  DS    BL1
RELATION DS    CL32
@NM00065 DS    CL1
         ORG   @NM00065
NONMODAL DS    BL1
REDOLVL0 EQU   @NM00065+0
EXPREND  EQU   @NM00065+0
SINGLCMD EQU   @NM00065+0
IFNEXT   EQU   @NM00065+0
GETVERB  EQU   @NM00065+0
         ORG   @NM00065+1
RELOPER  DS    CL2
KWDMATCH DS    BL1
ENDVALUE DS    BL1
CHSTRING DS    BL1
MEMBIT   DS    BL1
ONESTAR  DS    BL1
WITHMEM  DS    BL1
DFLTOK   DS    BL1
FOUNDONE DS    BL1
SKIPDONE DS    BL1
COMMASW  DS    BL1
ENDFOUND DS    BL1
SKIPLEAD DS    BL1
PRMFOUND DS    BL1
         DS    CL1
SUPERID  DS    10H
PPARMCNT DS    10H
REPCOUNT DS    3H
REPLIMIT DS    3H
ONEREP   DS    3BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRI01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00621 DC    V(IDCRI02)
@CV00622 DC    V(IDCRI03)
         DS    0D
VECTRLEN DC    AL2(4*9-4)
@CC00782 DC    C'2147483647'
@CC00820 DC    C'RI01'
@CC00901 DC    C'RIEX'
@CC00930 DC    C'RISC'
@CC00951 DC    C'RI02'
@CC00957 DC    C'RI03'
@CC00987 DC    C'RIGN'
@CC00997 DC    C'RI04'
@CC01000 DC    C'RI05'
@CC01004 DC    C'RIMS'
@CC01036 DC    C'RIMI'
@CC01046 DC    C'RIME'
@CC01050 DC    C'RIBT'
@CC01060 DC    C'RI09'
@CC01075 DC    C'RIPP'
@CC01084 DC    C'RI11'
@CC01087 DC    C'RI12'
@CC01095 DC    C'RIGQ'
@CC01181 DC    C'RICV'
@CC01186 DC    C'RI24'
@CC01192 DC    C'RI27'
@CC01195 DC    C'RI30'
@CC01221 DC    C'RIID'
@CC01230 DC    C'RINS'
@CC01244 DC    C'RIMC'
@CC01253 DC    C'RIIR'
@CC01254 DC    C'RI35'
@CC01265 DC    C'RI36'
@CC01269 DC    C'RIDF'
@CC01291 DC    C'RIST'
@CC01294 DC    C'RI44'
@CC01298 DC    C'RI45'
@CC01308 DC    C'RINN'
@CC01335 DC    C'RISK'
@CC01339 DC    C'RISF'
@CC01344 DC    C'RIPC'
@CC01353 DC    C'RI49'
@CC01354 DC    C'RI50'
@CC01357 DC    C'RI51'
@CC01368 DC    C'RI56'
@CC01371 DC    C'RI57'
@CC01375 DC    C'RI59'
@CC01379 DC    C'RIGR'
@CC01386 DC    C'RISE'
@CC01389 DC    C'RI60'
@CC01392 DC    C'RI61'
@CC01393 DC    C'RI62'
@CC01400 DC    C'RIDC'
@CC01401 DC    C'RI66'
@CC01407 DC    C'RIE1'
@CC01418 DC    C'RIE2'
@CC01408 DC    C'UV0'
@CC00902 EQU   @CC00820
@CC00968 DC    C'EQ'
@CC01019 DC    C'GT'
@CC01023 DC    C'LT'
@CC01025 DC    C'^='
@CC01027 DC    C'NE'
@CC01029 DC    C'>='
@CC01031 DC    C'GE'
@CC01033 DC    C'<='
@CC01035 DC    C'LE'
@CB00581 DC    B'10000000'
@CB00583 DC    B'00000000'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
COMSTART DC    CL2'/*'
COMEND   DC    CL2'*/'
MODID    DC    CL4'RI01'
FIXAREA  DS    CL1024
         ORG   FIXAREA
@NM00057 DS    CL256
         ORG   @NM00057
@NM00058 DC    256X'00'
         ORG   FIXAREA+256
@NM00059 DS    CL256
         ORG   @NM00059
@NM00060 DC    256X'00'
         ORG   FIXAREA+512
@NM00061 DS    CL256
         ORG   @NM00061
@NM00062 DC    256X'00'
         ORG   FIXAREA+768
@NM00063 DS    CL256
         ORG   @NM00063
@NM00064 DC    256X'00'
         ORG   FIXAREA+1024
LTBLNAME DC    CL8'IDCRILT '
KTBLNAME DC    CL8'IDCRIKT '
TWLVZERO DS    CL1
         ORG   TWLVZERO
@NM00074 DC    XL1'C0'
         ORG   TWLVZERO+1
HEXTABLE DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FACTOR   EQU   @05
PARENCNT EQU   @02
WORKVAR3 EQU   @02
DEFLTPTR EQU   @04
WORKVAR2 EQU   @02
AMTUSED  EQU   @04
MOVELEN  EQU   @02
NEWPTR   EQU   @05
SEGEND   EQU   @04
SEGSTART EQU   @02
TWOPOWER EQU   @02
WORKVAL  EQU   @04
WORKVAR1 EQU   @04
PART1LEN EQU   @04
RELSIZE  EQU   @02
GDTPTR   EQU   @03
PWORD    EQU   @02
UNITINDX EQU   @05
REPNEST  EQU   @02
ARRYDSPL EQU   @04
ARRYPTR  EQU   @02
TESTID   EQU   @04
KWDPTR   EQU   @02
OPNPTR   EQU   @02
RTNREG   EQU   @15
CVBNUM   EQU   @08
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTPRM   EQU   GDTTBL+4
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTRIH   EQU   GDTTBL+24
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSALD0 EQU   0
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOGT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPSI EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
HDAREA   EQU   0
LEFTMGN  EQU   HDAREA
RIGHTMGN EQU   HDAREA+2
LOADTPTR EQU   HDAREA+4
KWTBLPTR EQU   HDAREA+8
ADDRIOCS EQU   HDAREA+12
NESTLVL  EQU   HDAREA+16
MODLFLGS EQU   HDAREA+18
NULLDO   EQU   MODLFLGS
DOFLAG   EQU   MODLFLGS+1
THENFLAG EQU   MODLFLGS+1
ELSEFLAG EQU   MODLFLGS+1
SKIPFLAG EQU   MODLFLGS+1
VERBDATA EQU   0
MAXID    EQU   VERBDATA+10
POSDSPL  EQU   VERBDATA+20
DGRPDSPL EQU   VERBDATA+21
VNGRPDSP EQU   VERBDATA+22
NTGRPDSP EQU   VERBDATA+23
@NM00039 EQU   0
VPOSCNT  EQU   @NM00039
VPOSID   EQU   @NM00039+2
DGRPTOT  EQU   0
@NM00040 EQU   0
DGRPCNT  EQU   @NM00040
DGRPID   EQU   @NM00040+2
VNGRPTOT EQU   0
@NM00041 EQU   0
VNGRPCNT EQU   @NM00041
VNGRPID  EQU   @NM00041+2
@NM00042 EQU   0
NTGRPCNT EQU   @NM00042
NTGRPID  EQU   @NM00042+2
PARMDATA EQU   0
OCCURNUM EQU   PARMDATA+1
IDDSPL   EQU   PARMDATA+4
KWDDSPL  EQU   PARMDATA+5
NOTDSPL  EQU   PARMDATA+6
NGRPDSPL EQU   PARMDATA+7
PDEDSPL  EQU   PARMDATA+8
SCLRDATA EQU   PARMDATA+11
LEVEL1   EQU   PARMDATA+11
REPEATED EQU   PARMDATA+11
SCALAR   EQU   PARMDATA+11
LIST     EQU   PARMDATA+11
DEFAULT  EQU   PARMDATA+11
SUBLIST  EQU   PARMDATA+11
DSCRPTR1 EQU   0
SUBDSPL  EQU   DSCRPTR1+2
REPMAX   EQU   DSCRPTR1+3
DSCRPTR2 EQU   0
HIVALUE  EQU   DSCRPTR2
LOWVALUE EQU   DSCRPTR2+4
MAXLNGTH EQU   DSCRPTR2+8
LISTMAX  EQU   DSCRPTR2+9
NUMBER   EQU   DSCRPTR2+11
ANYSTRNG EQU   DSCRPTR2+11
DSNAM    EQU   DSCRPTR2+11
GENERIC  EQU   DSCRPTR2+11
VOLID    EQU   DSCRPTR2+11
PWORDOPT EQU   DSCRPTR2+11
DEFLT    EQU   0
DEFLTLEN EQU   DEFLT
DEFLTVAL EQU   DEFLT+1
@NM00047 EQU   0
@NM00048 EQU   @NM00047+2
KWDCOUNT EQU   0
@NM00049 EQU   0
KWDLEN   EQU   @NM00049
KWDITEM  EQU   @NM00049+1
@NM00050 EQU   0
SUBCOUNT EQU   @NM00050
@NM00051 EQU   @NM00050+2
PARMTYPE EQU   @NM00051
SUBID    EQU   @NM00051+2
NGRPTOT  EQU   0
@NM00052 EQU   0
NGRPCNT  EQU   @NM00052
NGRPID   EQU   @NM00052+2
@NM00053 EQU   0
NOTCOUNT EQU   @NM00053
NOTID    EQU   @NM00053+2
@NM00054 EQU   0
@NM00055 EQU   @NM00054+2
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
PARMINFO EQU   0
PARMPTR  EQU   PARMINFO
NTGRPPTR EQU   PARMINFO+4
SUPRPARM EQU   PARMINFO+8
PARMFLAG EQU   PARMINFO+10
LISTADDR EQU   0
REPTOTAL EQU   0
REPPTR   EQU   0
VECTRPTR EQU   0
KWDTABLE EQU   0
PARMSYM  EQU   KWDTABLE+1
SETSYM   EQU   KWDTABLE+11
IFSYM    EQU   KWDTABLE+21
THENSYM  EQU   KWDTABLE+31
ELSESYM  EQU   KWDTABLE+41
DOSYM    EQU   KWDTABLE+51
ENDSYM   EQU   KWDTABLE+61
LSTCCLN  EQU   KWDTABLE+70
LSTCCSYM EQU   KWDTABLE+71
MAXCCLN  EQU   KWDTABLE+80
MAXCCSYM EQU   KWDTABLE+81
DATABLK  EQU   0
INREC    EQU   0
OPTSPTR  EQU   0
PARMOPTS EQU   0
OPTSLEN  EQU   PARMOPTS
FULLWORD EQU   0
@NM00066 EQU   0
STRINGLN EQU   @NM00066
STRING   EQU   @NM00066+1
@NM00067 EQU   0
PASSWDLN EQU   @NM00067
PASSWORD EQU   @NM00067+1
CHARLN   EQU   @NM00067+9
CHARS    EQU   @NM00067+10
@NM00068 EQU   0
DSPWDLN  EQU   @NM00068
DSPWORD  EQU   @NM00068+1
STARPOS  EQU   @NM00068+9
MEMNAMLN EQU   @NM00068+11
MEMNAME  EQU   @NM00068+12
DSNAMELN EQU   @NM00068+20
DSNAME   EQU   @NM00068+21
@NM00069 EQU   0
FULLWDCT EQU   @NM00069
LFULLWD  EQU   @NM00069+4
@NM00070 EQU   0
STRINGCT EQU   @NM00070
LSTRINGL EQU   @NM00070+2
LSTRING  EQU   @NM00070+3
@NM00071 EQU   0
CHARCT   EQU   @NM00071
LCHRPWDL EQU   @NM00071+2
LCHRPWD  EQU   @NM00071+3
LCHARLN  EQU   @NM00071+11
LCHAR    EQU   @NM00071+12
@NM00072 EQU   0
DSNAMECT EQU   @NM00072
@NM00073 EQU   @NM00072+2
LDSNPWDL EQU   @NM00073
LDSNPWD  EQU   @NM00073+1
LSTARPOS EQU   @NM00073+9
LMEMNAML EQU   @NM00073+11
LMEMNAME EQU   @NM00073+12
LDSNAMEL EQU   @NM00073+20
LDSNAME  EQU   @NM00073+21
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NTGRPTOT EQU   0
GDTTBLX  EQU   0
FDTLOC   EQU   0
SPACEID  EQU   0
AMSMAX   EQU   0
AMSLAST  EQU   0
FUNCNAME EQU   0
DFLTPARM EQU   0
ERRMSGID EQU   0
ERRPRMID EQU   0
FLDTYPE  EQU   0
WITHCOM  EQU   0
DEPTH    EQU   0
ERRCODE1 EQU   0
ERRCODE2 EQU   0
INSRTLEN EQU   0
INSRTPTR EQU   0
RISTID   EQU   MODID
DIGITVAL EQU   SYNUNIT
CNVRTWRD EQU   SYNUNIT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
LUNQTFLG EQU   @NM00073+10
UNQTFLG  EQU   @NM00068+10
ENDSMLN  EQU   KWDTABLE+60
DOSMLN   EQU   KWDTABLE+50
ELSESMLN EQU   KWDTABLE+40
THENSMLN EQU   KWDTABLE+30
IFSMLN   EQU   KWDTABLE+20
SETSMLN  EQU   KWDTABLE+10
PARMSMLN EQU   KWDTABLE
@NM00056 EQU   PARMINFO+11
FDTVERB  EQU   FDTTBL
PDEOFST2 EQU   @NM00055+4
PDEPCLID EQU   @NM00055+2
PDEPRMID EQU   @NM00055
PDECNT   EQU   @NM00054
PDEOFST1 EQU   @NM00048+2
IDNUM    EQU   @NM00048
IDCOUNT  EQU   @NM00047
@NM00046 EQU   DSCRPTR2+11
USERID   EQU   DSCRPTR2+11
@NM00045 EQU   DSCRPTR2+10
PCLDSPL2 EQU   DSCRPTR1
@NM00044 EQU   PARMDATA+11
@NM00043 EQU   PARMDATA+10
KWDGRPID EQU   PARMDATA+9
PDEFLEN  EQU   PARMDATA
LOADNAME EQU   VERBDATA+12
PARMCNT  EQU   VERBDATA+8
VDATALEN EQU   VERBDATA+6
PCLDSPL1 EQU   VERBDATA+4
DESCID   EQU   VERBDATA
@NM00038 EQU   MODLFLGS+1
@NM00036 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00035 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00034 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00033 EQU   ERCNVTAB+4
@NM00032 EQU   ERCNVTAB+3
@NM00031 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00030 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00029 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00028 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00027 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00026 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00025 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00024 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00023 EQU   OPNAGL+43
@NM00022 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00319 EQU   @EL00002
@RF00342 EQU   @EL00002
@RC00337 EQU   @EL00002
@RC00481 EQU   @RC00467
@RT00479 EQU   @RC00467
@RC00489 EQU   @RC00488
@RC00495 EQU   @RC00488
@RF00494 EQU   @RC00488
@RC00509 EQU   @RC00505
@RC00556 EQU   @RC00549
@RC00554 EQU   @RC00549
@RC00552 EQU   @RC00549
@RC00550 EQU   @RC00549
@RC00563 EQU   @RC00562
@RC00582 EQU   @RC00581
@RC00593 EQU   @RC00579
@RF00678 EQU   @RC00673
@RF00697 EQU   @EL00005
@RF00700 EQU   @EL00005
@RF00768 EQU   @RC00763
@RC00806 EQU   @RC00805
@RC00811 EQU   @RC00805
@RC00818 EQU   @RC00805
@RT00830 EQU   @EL00006
@RF00829 EQU   @EL00006
@RT00865 EQU   @EL00007
@RF00864 EQU   @EL00007
@RF00877 EQU   @EL00008
@PB00008 EQU   @EL00004
@RT00936 EQU   @EL00009
@RF00895 EQU   @EL00009
@RC00933 EQU   @EL00009
@RT01001 EQU   @EL00010
@RC00997 EQU   @EL00010
@PB00010 EQU   @EL00003
@RC01048 EQU   @RC01047
@RC01079 EQU   @EL00012
@RF01078 EQU   @EL00012
@RF01077 EQU   @EL00012
@RC01096 EQU   @EL00013
@RF01095 EQU   @EL00013
@RF01094 EQU   @EL00013
@PB00013 EQU   @EL00011
@RC01119 EQU   @RC01118
@RC01237 EQU   @RC01236
@RF01247 EQU   @RC01236
@RC01342 EQU   @EL00015
@RC01340 EQU   @EL00015
@RC01331 EQU   @EL00015
@RF01330 EQU   @EL00015
@RC01419 EQU   @RC01418
@RF01452 EQU   @EL00017
@PB00017 EQU   @EL00016
@RC01521 EQU   @EL00019
@PB00019 EQU   @EL00014
@RC01596 EQU   @RC01585
@RC01620 EQU   @EL00020
@RC01611 EQU   @EL00020
@RC01569 EQU   @EL00020
@RF01714 EQU   @EL00022
@RF01724 EQU   @EL00022
@PB00022 EQU   @EL00021
@PB00024 EQU   @EL00023
@RC01851 EQU   @RC01850
@RF01883 EQU   @EL00026
@RC01877 EQU   @EL00026
@RC01896 EQU   @RC01893
@RF01904 EQU   @EL00027
@RC02004 EQU   @EL00028
@RC02021 EQU   @RC02020
@RC02064 EQU   @RC02056
@RF02192 EQU   @EL00032
@PB00032 EQU   @EL00031
@PB00031 EQU   @EL00030
@RF02213 EQU   @EL00033
@RF02242 EQU   @EL00034
@RF02266 EQU   @EL00035
@PB00035 EQU   @EL00001
@RF00585 EQU   @RC00582
@PB00007 EQU   @PB00008
@RC00938 EQU   @RC00933
@PB00009 EQU   @PB00010
@RC01003 EQU   @RC00997
@RC01053 EQU   @RC01048
@RF01052 EQU   @RC01048
@PB00012 EQU   @PB00013
@RC01334 EQU   @RC01331
@RC01332 EQU   @RC01331
@RC01427 EQU   @PB00017
@PB00018 EQU   @PB00019
@RC01575 EQU   @RC01569
@RF01624 EQU   @RC01620
@RC02030 EQU   @RC02021
@RC02022 EQU   @RC02021
@RC02049 EQU   @PB00031
@RF02100 EQU   @PB00031
@RC02111 EQU   @PB00032
@PB00034 EQU   @PB00035
@PB00006 EQU   @PB00007
@PB00004 EQU   @PB00009
@RC00941 EQU   @RC00938
@RC00947 EQU   @RC00938
@RF00946 EQU   @RC00938
@RF00965 EQU   @RC00938
@RC01007 EQU   @RC01003
@RF01006 EQU   @RC01003
@RC01428 EQU   @RC01427
@PB00016 EQU   @PB00018
@RC02023 EQU   @RC02022
@RC02112 EQU   @RC02111
@PB00033 EQU   @PB00034
@PB00005 EQU   @PB00006
@RC00951 EQU   @RC00947
@RF00950 EQU   @RC00947
@RC01008 EQU   @RC01007
@PB00015 EQU   @PB00016
@PB00030 EQU   @PB00033
@RC00952 EQU   @RC00951
@RC01166 EQU   @PB00015
@RC01128 EQU   @PB00015
@RC01212 EQU   @PB00015
@RC01210 EQU   @PB00015
@PB00029 EQU   @PB00030
@RC01129 EQU   @RC01128
@RF01147 EQU   @RC01128
@RC01161 EQU   @RC01128
@RC01149 EQU   @RC01128
@RC01204 EQU   @RC01166
@RC01188 EQU   @RC01166
@RF01187 EQU   @RC01166
@PB00028 EQU   @PB00029
@RC01132 EQU   @RC01129
@RC01130 EQU   @RC01129
@RC01151 EQU   @RC01149
@RF01201 EQU   @RC01188
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00023 EQU   @PB00025
@PB00021 EQU   @PB00023
@PB00020 EQU   @PB00021
@PB00014 EQU   @PB00020
@PB00011 EQU   @PB00014
@PB00003 EQU   @PB00011
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCRI01,(C'PLS1833',0701,76310)

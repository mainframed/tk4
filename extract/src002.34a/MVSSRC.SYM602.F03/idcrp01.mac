         TITLE '*************** IDCRP01: IDCAMS REPRO ROUTINE **********
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRP01   77.258'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @11,4095(,@10)                                      0002
         LA    @09,4095(,@11)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@09                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0002
         USING @DATD,@12                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @12,8(,@13)                                         0002
         LR    @13,@12                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0257
*                                                                  0258
*        /************************************************************/
*        /*                                                          */
*        /*ENTRY POINT TO IDCRP01- THIS IS THE ONLY ENTRY POINT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0258
*        CPRECID = '00'X;                                          0258
*                                                                  0258
         MVI   CPRECID,X'00'                                       0258
*        /************************************************************/
*        /*                                                          */
*        /*INITIALIZE CONTROL FLAG VALUES                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0259
*        STATFLG = NORMAL;                                         0259
         MVC   STATFLG(5),@CB00816                                 0259
*        FAILIOER = 0;                                             0260
         SLR   @08,@08                                             0260
         STH   @08,FAILIOER                                        0260
*        CATRELSW = '0'B;                                  /*@OZ00751*/
         NI    CATRELSW,B'01111111'                                0261
*        CATCOPSW = '0'B;                                  /*@OZ00751*/
         NI    CATCOPSW,B'01111111'                                0262
*        IOPOSSW = 'U';                                    /*@OZ00751*/
         MVI   IOPOSSW,C'U'                                        0263
*        EOFSW = 0;                                        /*@OZ00751*/
         STH   @08,EOFSW                                           0264
*        READSW = '0'B;                                    /*@OZ00751*/
         MVI   READSW,B'00000000'                                  0265
*        EMPTYSW = '0'B;                                   /*@OZ00751*/
         NI    EMPTYSW,B'01111111'                                 0266
*        FREENUM = 0;                                      /*@OZ00751*/
         ST    @08,FREENUM                                         0267
*        OPNWRN = '0'B;                                    /*@OZ20461*/
*                                                                  0268
         NI    OPNWRN,B'01111111'                                  0268
*        DDSTRU=ADDR(DARGL);           /* SET POINTER TO DARGLIST    */
*                                                                  0269
*                                                                  0269
         LA    @03,DARGL                                           0269
         ST    @03,DDSTRU                                          0269
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE THE OPEN ARGUMENT LIST FOR THE INPUT & OUTPUT */
*        /* DATA SETS. THE OPENAGL COMMUNICATES INFORMATION ABOUT    */
*        /* THE DATA SET TO THE AMS I/O ADAPTER. THE PTR TO THE IOCS */
*        /* FOR EACH DATA SET IS RETURNED VIA THE RESPECTIVE OPNAGL  */
*        /* INITIALIZE IOCS POINTERS TO ZERO                   YM6244*/
*        /* A THIRD OPEN ARGUMENT LIST IS CLEARED FOR USE    @OZ00751*/
*        /* IF THE TARGET IS FOUND TO BE A CATALOG.          @OZ00751*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0270
*        OPAGLST1 = ''B;                                           0270
         XC    OPAGLST1(48),OPAGLST1                               0270
*        OPAGLST2 = ''B;                                           0271
         XC    OPAGLST2(48),OPAGLST2                               0271
*        OPAGLST3 = ''B;                                   /*@OZ00751*/
*                                                                  0272
*                                                                  0272
         XC    OPAGLST3(48),OPAGLST3                               0272
*        IOCSINP = NULLPTR;                                  /*YM6244*/
         ST    @08,IOCSINP                                         0273
*        IOCSOUT = NULLPTR;                                  /*YM6244*/
*                                                                  0274
         ST    @08,IOCSOUT                                         0274
*        /************************************************************/
*        /*                                                          */
*        /*INITIALIZE THE OPNAGL FOR THE INPUT DATA SET              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0275
*        OPNPTR=ADDR(OPAGLST1);        /* REFERENCE INPUT OPNAGL     */
         LA    OPNPTR,OPAGLST1                                     0275
*        OPNOPTIN= ON;                 /* OPEN FOR INPUT             */
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0276
*        OPNIOC=ADDR(IOCSINP);         /* ADDR OF INPUT IOCS POINTER */
         LA    @03,IOCSINP                                         0277
         ST    @03,OPNIOC(,OPNPTR)                                 0277
*        /************************************************************/
*        /*                                                          */
*        /* THE INPUT DATA SET CAN BE DESCRIBED VIA A JCL STATMENT   */
*        /* OR, IN A SYSTEM WITH DYNAMIC ALLOCATION, ITS DATA SET    */
*        /* NAME. WHEN DESCRIBED BY ITS DATA SET NAME THE I/O ADAPTER*/
*        /* PERFORMS DYNAMIC ALLOCATION AS A PART OF THE UOPEN       */
*        /* PROCESS. THE I/O ADAPTER IS SENSITIVE TO THE MEANS OF    */
*        /* DESCRIPTION BY THE SETTING OF OPNDDN OR OPNDSN           */
*        /*                                                          */
*        /************************************************************/
*        IF (ADDR(INDN)) ^= NULLPTR                                0278
*          THEN                                                    0278
         L     @03,@PC00001+4                                      0278
         C     @08,FDTPTR(,@03)                                    0278
         BE    @RF00278                                            0278
*            DO;                                                   0279
*                                                                  0279
*            OPNDDN = ADDR(INPDDVAL);                              0280
*                                                                  0280
         L     @08,FDTPTR+32(,@03)                                 0280
         LA    @03,INPDDVAL(,@08)                                  0280
         ST    @03,OPNDDN(,OPNPTR)                                 0280
*            /********************************************************/
*            /*                                                      */
*            /* REFERENCE THE PASSWORD FROM THE OPNAGL               */
*            /*                                                      */
*            /********************************************************/
*                                                                  0281
*            IF INPDDPLN ^= 0                                      0281
*              THEN                                                0281
         CLI   INPDDPLN(@08),0                                     0281
         BE    @RF00281                                            0281
*                OPNPWA = ADDR(INPDDPAS);                          0282
*                                                                  0282
         LA    @08,INPDDPAS(,@08)                                  0282
         ST    @08,OPNPWA(,OPNPTR)                                 0282
*            END;                                                  0283
*          ELSE                                                    0284
*            IF (ADDR(INDS)) ^= NULLPTR                            0284
*              THEN                                                0284
         B     @RC00278                                            0284
@RF00278 L     @08,@PC00001+4                                      0284
         L     @08,FDTPTR+280(,@08)                                0284
         LTR   @08,@08                                             0284
         BZ    @RF00284                                            0284
*                DO;                                               0285
*                                                                  0285
*                /****************************************************/
*                /*                                          @YL026UG*/
*                /* IN TSO ENVIRONMENT THE DATA SET NAME MAY @YL026UG*/
*                /* BE UNQUALIFIED, ISSUE THE AMS UQUAL MACRO        */
*                /* IF INDSFUQ IS TURNED ON.                 @YL026UG*/
*                /*                                          @YL026UG*/
*                /****************************************************/
*                IF INDSFUQ = ON                                   0286
*                  THEN                                            0286
         TM    INDSFUQ(@08),B'10000000'                            0286
         BNO   @RF00286                                            0286
*QQUAL01:            DO;                                   /*@YL026UG*/
*                                                                  0287
QQUAL01  DS    0H                                                  0288
*                    QDSNPTR = ADDR(INDSVAL);              /*@YL026UG*/
         L     @08,@PC00001+4                                      0288
         L     @08,FDTPTR+280(,@08)                                0288
         LA    @03,INDSVAL(,@08)                                   0288
         ST    @03,QDSNPTR                                         0288
*                    QDSNLEN = INDSLEN;                    /*@YL026UG*/
         SLR   @03,@03                                             0289
         IC    @03,INDSLEN(,@08)                                   0289
         STH   @03,QDSNLEN                                         0289
*                    QCATPTR = NULLPTR;                    /*@YL026UG*/
*                                                                  0290
         SLR   @03,@03                                             0290
         ST    @03,QCATPTR                                         0290
*                    IF INDSPLN ^= NULLPTR                         0291
*                      THEN                                        0291
         CLI   INDSPLN(@08),0                                      0291
         BE    @RF00291                                            0291
*                        QCATPSWD = ADDR(INDSPAS);         /*@YL026UG*/
*                                                                  0292
         LA    @08,INDSPAS(,@08)                                   0292
         ST    @08,QCATPSWD                                        0292
*                      ELSE                                        0293
*                        QCATPSWD = NULLPTR;               /*@YL026UG*/
*                                                                  0293
         B     @RC00291                                            0293
@RF00291 SLR   @08,@08                                             0293
         ST    @08,QCATPSWD                                        0293
*                    CALL IDCSAQL0 (GDTTBL,                        0294
*                      QDSNPTR,        /* PTR TO DSNAME      @YL026UG*/
*                      QDSNLEN,        /* LENGTH OF DSNAME   @YL026UG*/
*                      QCATPTR,        /* PTR TO CATNAME     @YL026UG*/
*                      QCATPSWD);      /* PTR TO CAT PSWD    @YL026UG*/
*                                                                  0294
@RC00291 L     @08,@PC00001                                        0294
         ST    @08,@AL00001                                        0294
         LA    @03,QDSNPTR                                         0294
         ST    @03,@AL00001+4                                      0294
         LA    @03,QDSNLEN                                         0294
         ST    @03,@AL00001+8                                      0294
         LA    @03,QCATPTR                                         0294
         ST    @03,@AL00001+12                                     0294
         LA    @03,QCATPSWD                                        0294
         ST    @03,@AL00001+16                                     0294
         MVI   @AL00001+16,X'80'                                   0294
         L     @15,GDTQAL(,@08)                                    0294
         LA    @01,@AL00001                                        0294
         BALR  @14,@15                                             0294
*                    RESPECIFY RTNREG RSTD;                        0295
*                    TESTRC = RTNREG;                              0296
         STH   RTNREG,TESTRC                                       0296
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UG*/
*                                                                  0297
*                    IF TESTRC ^= 0                                0298
*                      THEN                                        0298
         LH    @08,TESTRC                                          0298
         LTR   @08,@08                                             0298
         BZ    @RF00298                                            0298
*                        STATFLG = TERMERR;                /*@YL026UG*/
*                                                                  0299
         MVC   STATFLG(5),@CB00819                                 0299
*                    END QQUAL01;                          /*@YL026UG*/
*                                                                  0300
@RF00298 DS    0H                                                  0301
*                OPNDSN = ADDR(INDSVAL);                           0301
*                                                                  0301
@RF00286 L     @08,@PC00001+4                                      0301
         L     @08,FDTPTR+280(,@08)                                0301
         LA    @03,INDSVAL(,@08)                                   0301
         ST    @03,OPNDSN(,OPNPTR)                                 0301
*                /****************************************************/
*                /*                                                  */
*                /* REFERENCE THE PASSWORD FROM THE OPNAGL   @YL026UG*/
*                /*                                                  */
*                /****************************************************/
*                                                                  0302
*                IF INDSPLN ^= 0                                   0302
*                  THEN                                            0302
         CLI   INDSPLN(@08),0                                      0302
         BE    @RF00302                                            0302
*                    OPNPWA = ADDR(INDSPAS);                       0303
*                                                                  0303
         LA    @08,INDSPAS(,@08)                                   0303
         ST    @08,OPNPWA(,OPNPTR)                                 0303
*                END;                                              0304
@RF00302 DS    0H                                                  0305
*                                                                  0305
*        /************************************************************/
*        /*                                                          */
*        /* WHEN RECORD NUMBERS OR KEY DELIMITERS ARE SPECIFIED,     */
*        /* INDICATE KEYED PROCESSING IN OPNAGL - THIS ALLOWS THE    */
*        /* I/O ADAPTER TO VERIFY THE DATA SET IS CONSISTENT WITH    */
*        /* KEYED PROCESSING AT OPEN TIME.                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0305
*        IF (ADDR(FMKYC) ^= NULLPTR ×                      /*@Y30SSJH*/
*            ADDR(TOKYC) ^= NULLPTR ×                      /*@Y30SSJH*/
*            ADDR(FMNUM) ^= NULLPTR ×                      /*@Y30SSJH*/
*            ADDR(TONUM) ^= NULLPTR )                      /*@Y30SSJH*/
*          THEN                                                    0305
@RF00284 DS    0H                                                  0305
@RC00278 SLR   @08,@08                                             0305
         L     @03,@PC00001+4                                      0305
         C     @08,FDTPTR+8(,@03)                                  0305
         BNE   @RT00305                                            0305
         C     @08,FDTPTR+20(,@03)                                 0305
         BNE   @RT00305                                            0305
         C     @08,FDTPTR+48(,@03)                                 0305
         BNE   @RT00305                                            0305
         C     @08,FDTPTR+52(,@03)                                 0305
         BE    @RF00305                                            0305
@RT00305 DS    0H                                                  0306
*            OPNOPTKS = ON;                                        0306
*                                                                  0306
         OI    OPNOPTKS(OPNPTR),B'00001000'                        0306
*          /**********************************************************/
*          /*                                                        */
*          /* WHEN BEGINNING OR ENDING RBA DELIMITERS ARE SPECIFIED, */
*          /* INDICATE CHRONOLOGIC PROCESSING IN OPNAGL - THIS ALLOWS*/
*          /* THE I/0 ADAPTER TO VERIFY THE DATA SET IS CONSISTENT   */
*          /* WITH RBA PROCESSING AT OPEN TIME.                      */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0307
*          ELSE                                                    0307
*            IF (ADDR(FMRBA)  ^= NULLPTR  ×                /*@Y30SSLO*/
*                ADDR(TORBA)  ^= NULLPTR  )                /*@Y30SSLO*/
*              THEN                                                0307
         B     @RC00305                                            0307
@RF00305 SLR   @08,@08                                             0307
         L     @03,@PC00001+4                                      0307
         C     @08,FDTPTR+12(,@03)                                 0307
         BNE   @RT00307                                            0307
         C     @08,FDTPTR+24(,@03)                                 0307
         BE    @RF00307                                            0307
@RT00307 DS    0H                                                  0308
*                OPNOPTCR = ON;                                    0308
*                                                                  0308
         OI    OPNOPTCR(OPNPTR),B'00000100'                        0308
*        /************************************************************/
*        /*                                                          */
*        /* SPECIFY THE ENVIRONMENT ATTRIBUTES FOR INPUT DATA SET    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0309
*        IF (ADDR(IENV)) ^= NULLPTR ×                      /*@OZ05582*/
*            ADDR(IDENV) ^= NULLPTR                                0309
*          THEN                                                    0309
*                                                                  0309
@RF00307 DS    0H                                                  0309
@RC00305 SLR   @08,@08                                             0309
         L     @03,@PC00001+4                                      0309
         C     @08,FDTPTR+60(,@03)                                 0309
         BNE   @RT00309                                            0309
         C     @08,FDTPTR+284(,@03)                                0309
         BE    @RF00309                                            0309
@RT00309 DS    0H                                                  0310
*            /********************************************************/
*            /*                                                      */
*            /* SPECIFY THAT DUMMY ISAM RECORDS ARE TO BE  COPIED    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0310
*            IF (ADDR(IDUMY)) ^= NULLPTR ×                         0310
*               ADDR(IDUM) ^= NULLPTR                      /*@OZ05582*/
*              THEN                                                0310
         SLR   @08,@08                                             0310
         L     @03,@PC00001+4                                      0310
         C     @08,FDTPTR+188(,@03)                                0310
         BNE   @RT00310                                            0310
         C     @08,FDTPTR+288(,@03)                                0310
         BE    @RF00310                                            0310
@RT00310 DS    0H                                                  0311
*                OPNMODPD = ON;                                    0311
*                                                                  0311
         OI    OPNMODPD(OPNPTR),B'10000000'                        0311
*                                                                  0312
*        /************************************************************/
*        /*                                                          */
*        /*INITIALIZE THE OPEN ARGLIST FOR THE OUTPUT DATA SET       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0312
*        OPNPTR=ADDR(OPAGLST2);        /* REFERENCE OUTPUT OPNAGL    */
@RF00310 DS    0H                                                  0312
@RF00309 LA    OPNPTR,OPAGLST2                                     0312
*        OPNOPTOT=ON;                  /* OPEN FOR OUTPUT            */
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0313
*        OPNIOC=ADDR(IOCSOUT);         /* ADDR OF OUTPUT IOCS POINTER*/
*                                                                  0314
         LA    @08,IOCSOUT                                         0314
         ST    @08,OPNIOC(,OPNPTR)                                 0314
*        /************************************************************/
*        /*                                                          */
*        /* THE OUTPUT DATA SET CAN BE DESCRIBED VIA A JCL STATEMENT */
*        /* OR, IN A SYSTEM WITH DYNAMIC ALLOCATION, ITS DATA SET    */
*        /* NAME.  WHEN DESCRIBED BY ITS DATA SET NAME THE I/O       */
*        /* ADAPTER PERFORMS DYNAMIC ALLOCATION AS A PART OF THE     */
*        /* UOPEN PROCESS. THE I/O ADAPTER IS SENSITIVE TO THE MEANS */
*        /* OF DESCRIPTION BY THE SETTING OF OPNDDN OR OPNDSN.       */
*        /*                                                          */
*        /************************************************************/
*        IF (ADDR(OUTDN)) ^= NULLPTR                               0315
*          THEN                                                    0315
         L     @08,@PC00001+4                                      0315
         L     @03,FDTPTR+4(,@08)                                  0315
         LTR   @03,@03                                             0315
         BZ    @RF00315                                            0315
*            DO;                                                   0316
*                                                                  0316
*            OPNDDN = ADDR(OUTDDVAL);                              0317
*                                                                  0317
         L     @08,FDTPTR+36(,@08)                                 0317
         LA    @03,OUTDDVAL(,@08)                                  0317
         ST    @03,OPNDDN(,OPNPTR)                                 0317
*            /********************************************************/
*            /*                                                      */
*            /* REFERENCE THE PASSWORD FROM THE OPNAGL               */
*            /*                                                      */
*            /********************************************************/
*                                                                  0318
*            IF OUTDDPLN ^= 0                                      0318
*              THEN                                                0318
         CLI   OUTDDPLN(@08),0                                     0318
         BE    @RF00318                                            0318
*                OPNPWA = ADDR(OUTDDPAS);                          0319
*                                                                  0319
         LA    @08,OUTDDPAS(,@08)                                  0319
         ST    @08,OPNPWA(,OPNPTR)                                 0319
*            END;                                                  0320
*                                                                  0320
*          ELSE                                                    0321
*            IF (ADDR(OUTDS)) ^= NULLPTR                           0321
*              THEN                                                0321
         B     @RC00315                                            0321
@RF00315 L     @08,@PC00001+4                                      0321
         L     @08,FDTPTR+44(,@08)                                 0321
         LTR   @08,@08                                             0321
         BZ    @RF00321                                            0321
*                DO;                                               0322
*                                                                  0322
*                /****************************************************/
*                /*                                          @YL026UG*/
*                /* IN TSO ENVIRONMENT THE DATA SET NAME MAY @YL026UG*/
*                /* BE UNQUALIFIED, ISSUE THE AMS UQUAL MACRO        */
*                /* IF OUTDSFUQ IS TURNED ON.                @YL026UG*/
*                /*                                          @YL026UG*/
*                /****************************************************/
*                IF OUTDSFUQ = ON                                  0323
*                  THEN                                            0323
         TM    OUTDSFUQ(@08),B'10000000'                           0323
         BNO   @RF00323                                            0323
*QQUAL02:            DO;                                   /*@YL026UG*/
*                                                                  0324
QQUAL02  DS    0H                                                  0325
*                    QDSNPTR = ADDR(OUTDSVAL);             /*@YL026UG*/
         L     @08,@PC00001+4                                      0325
         L     @08,FDTPTR+44(,@08)                                 0325
         LA    @03,OUTDSVAL(,@08)                                  0325
         ST    @03,QDSNPTR                                         0325
*                    QDSNLEN = OUTDSLEN;                   /*@YL026UG*/
         SLR   @03,@03                                             0326
         IC    @03,OUTDSLEN(,@08)                                  0326
         STH   @03,QDSNLEN                                         0326
*                    QCATPTR = NULLPTR;                    /*@YL026UG*/
*                                                                  0327
         SLR   @03,@03                                             0327
         ST    @03,QCATPTR                                         0327
*                    IF OUTDSPLN ^= 0                              0328
*                      THEN                                        0328
         CLI   OUTDSPLN(@08),0                                     0328
         BE    @RF00328                                            0328
*                        QCATPSWD = ADDR(OUTDSPAS);        /*@YL026UG*/
*                                                                  0329
         LA    @08,OUTDSPAS(,@08)                                  0329
         ST    @08,QCATPSWD                                        0329
*                      ELSE                                        0330
*                        QCATPSWD = NULLPTR;               /*@YL026UG*/
*                                                                  0330
         B     @RC00328                                            0330
@RF00328 SLR   @08,@08                                             0330
         ST    @08,QCATPSWD                                        0330
*                    CALL IDCSAQL0(GDTTBL,                         0331
*                      QDSNPTR,        /* PTR TO DSNAME      @YL026UG*/
*                      QDSNLEN,        /* LEN OF DSNAME      @YL026UG*/
*                      QCATPTR,        /* PTR TO CATNAME     @YL026UG*/
*                      QCATPSWD);      /* PTR TO CAT PSWD    @YL026UG*/
*                                                                  0331
@RC00328 L     @08,@PC00001                                        0331
         ST    @08,@AL00001                                        0331
         LA    @03,QDSNPTR                                         0331
         ST    @03,@AL00001+4                                      0331
         LA    @03,QDSNLEN                                         0331
         ST    @03,@AL00001+8                                      0331
         LA    @03,QCATPTR                                         0331
         ST    @03,@AL00001+12                                     0331
         LA    @03,QCATPSWD                                        0331
         ST    @03,@AL00001+16                                     0331
         MVI   @AL00001+16,X'80'                                   0331
         L     @15,GDTQAL(,@08)                                    0331
         LA    @01,@AL00001                                        0331
         BALR  @14,@15                                             0331
*                    RESPECIFY RTNREG RSTD;                        0332
*                    TESTRC = RTNREG;                              0333
         STH   RTNREG,TESTRC                                       0333
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UG*/
*                                                                  0334
*                    IF TESTRC ^= 0                                0335
*                      THEN                                        0335
         LH    @08,TESTRC                                          0335
         LTR   @08,@08                                             0335
         BZ    @RF00335                                            0335
*                        STATFLG = TERMERR;                /*@YL026UG*/
*                                                                  0336
         MVC   STATFLG(5),@CB00819                                 0336
*                    END QQUAL02;                          /*@YL026UG*/
*                                                                  0337
*                                                                  0337
@RF00335 DS    0H                                                  0338
*                /****************************************************/
*                /*                                                  */
*                /* REFERENCE THE PASSWORD FROM THE OPNAGL           */
*                /*                                                  */
*                /****************************************************/
*                IF OUTDSPLN ^= 0                                  0338
*                  THEN                                            0338
@RF00323 L     @08,@PC00001+4                                      0338
         L     @08,FDTPTR+44(,@08)                                 0338
         CLI   OUTDSPLN(@08),0                                     0338
         BE    @RF00338                                            0338
*                    OPNPWA = ADDR(OUTDSPAS);              /*@Y30SSEC*/
*                                                                  0339
         LA    @08,OUTDSPAS(,@08)                                  0339
         ST    @08,OPNPWA(,OPNPTR)                                 0339
*                /****************************************************/
*                /* CONSTRUCT AN ALLOCATE AGL AND CALL ROUTINE TO    */
*                /* INVOKE DYNAMIC ALLOCATION TO GET A DDNAME TO     */
*                /* PLACE IN THE OPEN ARGUMENT LIST          @Y30SSSB*/
*                /****************************************************/
*                RFY ALLAGL BASED(ALLAGLPT);               /*@Y30SSSB*/
@RF00338 DS    0H                                                  0341
*                ALLAGLPT=ADDR(ALLAGLWK);                  /*@Y30SSSB*/
         LA    @08,ALLAGLWK                                        0341
         ST    @08,ALLAGLPT                                        0341
*                ALLAGL=''B;                               /*@Y30SSSB*/
         XC    ALLAGL(31,@08),ALLAGL(@08)                          0342
*                ALLDSN=ADDR(OUTDSVAL);                    /*@Y30SSSB*/
         L     @03,@PC00001+4                                      0343
         L     @03,FDTPTR+44(,@03)                                 0343
         LA    @03,OUTDSVAL(,@03)                                  0343
         ST    @03,ALLDSN(,@08)                                    0343
*                ALLPWD=OPNPWA;                            /*@Y30SSSB*/
         MVC   ALLPWD(4,@08),OPNPWA(OPNPTR)                        0344
*                ALLOPTDS=ON;                              /*@Y30SSSB*/
         OI    ALLOPTDS(@08),B'01000000'                           0345
*                ALLSTSOD=ON;                              /*@Y30SSSB*/
         OI    ALLSTSOD(@08),B'00000001'                           0346
*                ALLDSPKP=ON;                              /*@Y30SSSB*/
*                                                                  0347
         OI    ALLDSPKP(@08),B'00001000'                           0347
*                CALL IDCSAAL0 (GDTTBL,ALLAGL);            /*@Y30SSSB*/
*                                                                  0348
         L     @03,@PC00001                                        0348
         ST    @03,@AL00001                                        0348
         ST    @08,@AL00001+4                                      0348
         MVI   @AL00001+4,X'80'                                    0348
         L     @15,GDTALC(,@03)                                    0348
         LA    @01,@AL00001                                        0348
         BALR  @14,@15                                             0348
*                RESPECIFY RTNREG RSTD;                            0349
*                TESTRC = RTNREG;                                  0350
         STH   RTNREG,TESTRC                                       0350
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSSB*/
*                IF TESTRC ^= 0                            /*@OZ05922*/
*                  THEN                                    /*@OZ05922*/
         LH    @08,TESTRC                                          0352
         LTR   @08,@08                                             0352
         BZ    @RF00352                                            0352
*                    STATFLG = TERMERR;                    /*@OZ05922*/
         MVC   STATFLG(5),@CB00819                                 0353
*                  ELSE                                    /*@OZ05922*/
*                    OPNDDN=ADDR(ALLDDN);                  /*@Y30SSSB*/
*                                                                  0354
         B     @RC00352                                            0354
@RF00352 L     @08,ALLAGLPT                                        0354
         LA    @08,ALLDDN(,@08)                                    0354
         ST    @08,OPNDDN(,OPNPTR)                                 0354
*                END;                                              0355
@RC00352 DS    0H                                                  0356
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /*  THE REUSABLE ATTRIBUTE IS NOTED IN THE OPNAGL   @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0356
*        IF (ADDR(RUS)) ^= NULLPTR                                 0356
*          THEN                                                    0356
@RF00321 DS    0H                                                  0356
@RC00315 L     @08,@PC00001+4                                      0356
         L     @08,FDTPTR+200(,@08)                                0356
         LTR   @08,@08                                             0356
         BZ    @RF00356                                            0356
*            OPNMODRS = ON;                                /*@Y30SSJH*/
         OI    OPNMODRS(OPNPTR),B'00000100'                        0357
*          ELSE;                                           /*@Y30SSJH*/
*                                                                  0358
@RF00356 DS    0H                                                  0359
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /*  REPLACE PROCESSING IS NOTED IN THE OPNAGL       @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0359
*        IF (ADDR(REP)) ^= NULLPTR                                 0359
*          THEN                                                    0359
         L     @08,@PC00001+4                                      0359
         L     @08,FDTPTR+192(,@08)                                0359
         LTR   @08,@08                                             0359
         BZ    @RF00359                                            0359
*            DO;                                           /*@Y30SSJH*/
*                                                                  0360
*              OPNMODRP = ON;                              /*@Y30SSJH*/
*                                                                  0361
         OI    OPNMODRP(OPNPTR),B'00000001'                        0361
*            END;                                          /*@Y30SSJH*/
*          ELSE;                                           /*@Y30SSJH*/
*                                                                  0363
@RF00359 DS    0H                                                  0364
*        /************************************************************/
*        /*                                                          */
*        /* OPEN THE INPUT AND OUTPUT DATA SETS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0364
*        IF STATFLG = NORMAL                                       0364
*          THEN                                                    0364
         CLC   STATFLG(5),@CB00816                                 0364
         BNE   @RF00364                                            0364
*            DO;                                           /*@YL026UG*/
*                                                                  0365
*            CALL IDCIOOP0 (GDTTBL,OPAGLST1,OPAGLST2);     /*@YL026UG*/
         L     @08,@PC00001                                        0366
         ST    @08,@AL00001                                        0366
         LA    @15,OPAGLST1                                        0366
         ST    @15,@AL00001+4                                      0366
         LA    @15,OPAGLST2                                        0366
         ST    @15,@AL00001+8                                      0366
         MVI   @AL00001+8,X'80'                                    0366
         L     @15,GDTOPN(,@08)                                    0366
         LA    @01,@AL00001                                        0366
         BALR  @14,@15                                             0366
*            RESPECIFY RTNREG RSTD;                                0367
*            TESTRC = RTNREG;                                      0368
         STH   RTNREG,TESTRC                                       0368
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UG*/
*                                                                  0369
*        /************************************************************/
*        /*                                                  @OZ20461*/
*        /* IF THE INPUT DATA SET WAS OPENED WITH A          @OZ20461*/
*        /* WARNING ERROR, PROCESSING WILL CONTINUE. ANY     @OZ20461*/
*        /* OTHER OPEN ERROR WILL CAUSE PROCESSING TO BE     @OZ20461*/
*        /* TERMINATED.                                      @OZ20461*/
*        /*                                                  @OZ20461*/
*        /************************************************************/
*                                                                  0370
*            IOCSPTR = IOCSINP;                            /*@OZ11053*/
*                                                                  0370
         L     @08,IOCSINP                                         0370
         ST    @08,IOCSPTR                                         0370
*            IF TESTRC ^= 0                                /*@OZ20461*/
*              THEN                                                0371
         LH    @15,TESTRC                                          0371
         SLR   @14,@14                                             0371
         CR    @15,@14                                             0371
         BE    @RF00371                                            0371
*                DO;                                       /*@YL026UG*/
*                                                                  0372
*                OLDERID2 = NEWERID2;                              0373
         L     @15,@PC00001                                        0373
         L     @15,GDTTR2(,@15)                                    0373
         MVC   @TS00001(95),NEWERID2(@15)                          0373
         MVC   OLDERID2(95,@15),@TS00001                           0373
*                NEWID2 = 'RP12';                          /*@YL026LO*/
         MVC   NEWID2(4,@15),@CC01127                              0374
*                IF IOCSINP = NULLPTR THEN                         0375
         CR    @08,@14                                             0375
         BNE   @RF00375                                            0375
*                    STATFLG = TERMERR;                    /*@OZ20461*/
         MVC   STATFLG(5),@CB00819                                 0376
*                ELSE                                      /*@OZ20461*/
*                  IF IOCMSGOP = OFF × IOCVRC > 116 THEN   /*@OZ20461*/
         B     @RC00375                                            0377
@RF00375 L     @08,IOCSPTR                                         0377
         TM    IOCMSGOP(@08),B'00100000'                           0377
         BZ    @RT00377                                            0377
         CLC   IOCVRC(4,@08),@CF01128                              0377
         BNH   @RF00377                                            0377
@RT00377 DS    0H                                                  0378
*                    STATFLG = TERMERR;                    /*@OZ20461*/
         MVC   STATFLG(5),@CB00819                                 0378
*                  ELSE                                    /*@OZ20461*/
*                    IF IOCVRC ^= 0 THEN                   /*@OZ20461*/
         B     @RC00377                                            0379
@RF00377 L     @08,IOCSPTR                                         0379
         L     @08,IOCVRC(,@08)                                    0379
         LTR   @08,@08                                             0379
         BZ    @RF00379                                            0379
*                      OPNWRN = ON;                        /*@OZ20461*/
         OI    OPNWRN,B'10000000'                                  0380
*                                                          /*@OZ20461*/
*                IOCSPTR = IOCSOUT;                        /*@OZ20461*/
@RF00379 DS    0H                                                  0381
@RC00377 DS    0H                                                  0381
@RC00375 L     @08,IOCSOUT                                         0381
         ST    @08,IOCSPTR                                         0381
*                IF STATFLG = NORMAL THEN                  /*@OZ20461*/
         CLC   STATFLG(5),@CB00816                                 0382
         BNE   @RF00382                                            0382
*                  IF IOCSOUT = NULLPTR THEN               /*@OZ20461*/
         LTR   @08,@08                                             0383
         BNZ   @RF00383                                            0383
*                    STATFLG = TERMERR;                    /*@OZ20461*/
         MVC   STATFLG(5),@CB00819                                 0384
*                  ELSE                                    /*@OZ20461*/
*                    IF IOCMSGOP = OFF × IOCVRC ^= 0 THEN  /*@OZ20461*/
         B     @RC00383                                            0385
@RF00383 L     @08,IOCSPTR                                         0385
         TM    IOCMSGOP(@08),B'00100000'                           0385
         BZ    @RT00385                                            0385
         L     @08,IOCVRC(,@08)                                    0385
         LTR   @08,@08                                             0385
         BZ    @RF00385                                            0385
@RT00385 DS    0H                                                  0386
*                      STATFLG = TERMERR;                  /*@OZ20461*/
         MVC   STATFLG(5),@CB00819                                 0386
*                                                          /*@OZ20461*/
*                END;                                      /*@YL026UG*/
*                                                                  0387
@RF00385 DS    0H                                                  0387
@RC00383 DS    0H                                                  0387
@RF00382 DS    0H                                                  0388
*            END;                                          /*@YL026UG*/
@RF00371 DS    0H                                                  0389
*                                                                  0389
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VALIDITY TEST -                                  @Y30SSJH*/
*        /*   CHECK FOR NON-RELATIVE RECORD INPUT DATA SET   @Y30SSJH*/
*        /*   TOGETHER WITH NON-EMPTY RELATIVE RECORD OUTPUT @Y30SSJH*/
*        /*   DATA SET.                                      @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0389
*        IF (IOCSOUT -> IOCHURBA ^= 0 &                            0389
*            IOCSOUT -> IOCMACRR = ON ) &                          0389
*            IOCSINP -> IOCMACRR = OFF &                           0389
*            STATFLG = NORMAL                                      0389
*          THEN                                                    0389
@RF00364 L     @08,IOCSOUT                                         0389
         L     @15,IOCHURBA(,@08)                                  0389
         LTR   @15,@15                                             0389
         BZ    @RF00389                                            0389
         TM    IOCMACRR(@08),B'00100000'                           0389
         BNO   @RF00389                                            0389
         L     @08,IOCSINP                                         0389
         TM    IOCMACRR(@08),B'00100000'                           0389
         BNZ   @RF00389                                            0389
         CLC   STATFLG(5),@CB00816                                 0389
         BNE   @RF00389                                            0389
*            DO;                                           /*@Y30SSJH*/
*                                                                  0390
*            STATFLG = TERMERR;                            /*@Y30SSJH*/
         MVC   STATFLG(5),@CB00819                                 0391
*            DARGL = ''B;                                  /*@Y30SSLO*/
         XC    DARGL(28),DARGL                                     0392
*            DARGSENT = 14;                                /*@Y30SSEC*/
         L     @08,DDSTRU                                          0393
         MVI   DARGSENT(@08),X'0E'                                 0393
*            DARGSMOD = 'PR0';                             /*@Y30SSJH*/
*                                                                  0394
         MVC   DARGSMOD(3,@08),@CC01129                            0394
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/
*                                                                  0395
         L     @08,@PC00001                                        0395
         ST    @08,@AL00001                                        0395
         LA    @15,@CF00115                                        0395
         ST    @15,@AL00001+4                                      0395
         LA    @15,DDSTRU                                          0395
         ST    @15,@AL00001+8                                      0395
         MVI   @AL00001+8,X'80'                                    0395
         L     @15,GDTPRT(,@08)                                    0395
         LA    @01,@AL00001                                        0395
         BALR  @14,@15                                             0395
*            END;                                          /*@Y30SSJH*/
*                                                                  0396
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* EACH DATA SET MUST BE INTERROGATED IN TURN TO SEE@OZ00751*/
*        /* IF IT IS A CATALOG. THIS IS DONE BY LOCATING THE @OZ00751*/
*        /* CATALOG ENTRY. DETERMINATION THAT THE OBJECT IS  @OZ00751*/
*        /* A CATALOG IS VIA THE TYPE AND/OR CONTROL INTERVAL@OZ00751*/
*        /* #. IF THE TARGET IS FOUND TO BE A CATALOG THEN   @OZ00751*/
*        /* CATRELSW IS TURNED ON                            @OZ00751*/
*        /* IF BOTH SOURCE AND TARGET ARE CATALOGS, THEN     @Y30SSEC*/
*        /* THE CATRELSW IS TURNED OFF AND CATCOPSW IS       @Y30SSEC*/
*        /* TURNED ON TO COPY CATALOGS. IF COPY CATALOG IS   @Y30SSEC*/
*        /* REQUIRED, THEN A CHECK IS MADE TO VERIFY THAT    @Y30SSEC*/
*        /* BOTH SOURCE AND TARGET ARE NOT RECOVERABLE.      @Y30SSEC*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0397
*        IF STATFLG=NORMAL                                         0397
*          THEN                                                    0397
*                                                                  0397
@RF00389 CLC   STATFLG(5),@CB00816                                 0397
         BNE   @RF00397                                            0397
*CATCPYCK:   DO;                                           /*@OZ00751*/
*                                                                  0398
CATCPYCK DS    0H                                                  0399
*            IOCSPTR = IOCSOUT;         /* PROCESS OUTPUT    @OZ00751*/
         MVC   IOCSPTR(4),IOCSOUT                                  0399
*            OPNPTR  = ADDR(OPAGLST2);                     /*@OZ00751*/
*                                                                  0400
         LA    OPNPTR,OPAGLST2                                     0400
*CATLGCHK:     DO J =1 TO 2;                               /*@OZ00751*/
*                                                                  0401
CATLGCHK LA    J,1                                                 0401
@DL00401 DS    0H                                                  0402
*                /****************************************************/
*                /*                                        /*@OZ00751*/
*                /* IF IOCS FLAG INDICATES THIS IS A VSAM    @OZ00751*/
*                /* DATA SET ORGANIZATION, CHECK TO SEE      @OZ00751*/
*                /* IF IT IS A CATALOG.                      @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0402
*                IF IOCDSOAM = ON                                  0402
*                  THEN                                            0402
         L     @08,IOCSPTR                                         0402
         TM    IOCDSOAM(@08),B'10000000'                           0402
         BNO   @RF00402                                            0402
*VSAMCHK:            DO;                                   /*@OZ00751*/
*                                                                  0403
VSAMCHK  DS    0H                                                  0404
*                    LOCATWKA = ''B;     /* ZERO LOCATE STRUC@OZ00751*/
         XC    LOCATWKA(180),LOCATWKA                              0404
*                    LOCCPLID = 'LOCATCPL';/* DUMP ID FOR CPL@OZ00751*/
         MVC   LOCCPLID(8),@CC01136                                0405
*                    CTGPLPTR = ADDR(LOCATCPL);/* SET CPL PTR@OZ00751*/
         LA    @08,LOCATCPL                                        0406
         ST    @08,CTGPLPTR                                        0406
*                    CTGFUNC  = CTGLOC;  /* SET LOCATE FLAG  @OZ00751*/
         NI    CTGFUNC(@08),B'00111111'                            0407
         OI    CTGFUNC(@08),B'00100000'                            0407
*                    CTGAM0   = ON;      /* SET VSAM FUNCTION@OZ00751*/
*                    CTGSRH   = OFF;     /* SEARCH VSAM CATLG@OZ00751*/
*                    CTGNUM   = ON;      /* ONLY VSAM CATLG  @OZ00751*/
         OI    CTGAM0(@08),B'00000011'                             0410
         NI    CTGSRH(@08),B'11111011'                             0410
*                    CTGNAME  = ON;      /* LOCATE BY NAME   @OZ00751*/
         OI    CTGNAME(@08),B'00000100'                            0411
*                    CTGNOFLD =  3;      /* NUMBER OF FPLS   @Y30SSEC*/
         MVI   CTGNOFLD(@08),X'03'                                 0412
*                    CTGWKA   = ADDR(LOCWKA); /* ADDR OF WKA @OZ00751*/
         LA    @07,LOCWKA                                          0413
         ST    @07,CTGWKA(,@08)                                    0413
*                    LOCWKALN = 40;      /* WKA LENGTH       @OZ00751*/
         MVC   LOCWKALN(2),@CH00812                                0414
*                    CTGENT   = IOCDSN;  /* ADDR OF NAME     @OZ00751*/
         L     @07,IOCSPTR                                         0415
         MVC   CTGENT(4,@08),IOCDSN(@07)                           0415
*                    IF J = 1                              /*@Y30SSEC*/
*                      THEN   /*  SET PASWORDS               @Y30SSEC*/
         CH    J,@CH00219                                          0416
         BNE   @RF00416                                            0416
*                        DO;                               /*@Y30SSEC*/
*                          IF ADDR(OUTDD) ^= 0 & OUTDDPLN ^= 0     0418
*                             THEN                         /*@Y30SSEC*/
         L     @07,@PC00001+4                                      0418
         L     @07,FDTPTR+36(,@07)                                 0418
         LTR   @07,@07                                             0418
         BZ    @RF00418                                            0418
         CLI   OUTDDPLN(@07),0                                     0418
         BE    @RF00418                                            0418
*                               CTGPSWD = ADDR(OUTDDPAS);  /*@Y30SSEC*/
         LA    @07,OUTDDPAS(,@07)                                  0419
         ST    @07,CTGPSWD(,@08)                                   0419
*                             ELSE                         /*@Y30SSEC*/
*                               IF ADDR(OUTDS) ^= 0 & OUTDSPLN ^= 0
*                                  THEN CTGPSWD = ADDR(OUTDSPAS);  0420
         B     @RC00418                                            0420
@RF00418 L     @08,@PC00001+4                                      0420
         L     @08,FDTPTR+44(,@08)                                 0420
         LTR   @08,@08                                             0420
         BZ    @RF00420                                            0420
         CLI   OUTDSPLN(@08),0                                     0420
         BE    @RF00420                                            0420
         LA    @08,OUTDSPAS(,@08)                                  0421
         L     @07,CTGPLPTR                                        0421
         ST    @08,CTGPSWD(,@07)                                   0421
*                                  ELSE;                   /*@Y30SSEC*/
@RF00420 DS    0H                                                  0423
*                          IF ADDR(INPDD) ^= 0 & INPDDPLN ^= 0     0423
*                             THEN                         /*@Y30SSEC*/
@RC00418 L     @08,@PC00001+4                                      0423
         L     @08,FDTPTR+32(,@08)                                 0423
         LTR   @08,@08                                             0423
         BZ    @RF00423                                            0423
         CLI   INPDDPLN(@08),0                                     0423
         BE    @RF00423                                            0423
*                               CTGPSWD = ADDR(INPDDPAS);  /*@Y30SSEC*/
         LA    @08,INPDDPAS(,@08)                                  0424
         L     @07,CTGPLPTR                                        0424
         ST    @08,CTGPSWD(,@07)                                   0424
*                             ELSE                         /*@Y30SSEC*/
*                               IF ADDR(INDS) ^= 0 & INDSPLN ^= 0  0425
*                                  THEN CTGPSWD = ADDR(INDSPAS);   0425
         B     @RC00423                                            0425
@RF00423 L     @08,@PC00001+4                                      0425
         L     @08,FDTPTR+280(,@08)                                0425
         LTR   @08,@08                                             0425
         BZ    @RF00425                                            0425
         CLI   INDSPLN(@08),0                                      0425
         BE    @RF00425                                            0425
         LA    @08,INDSPAS(,@08)                                   0426
         L     @07,CTGPLPTR                                        0426
         ST    @08,CTGPSWD(,@07)                                   0426
*                                  ELSE;                   /*@Y30SSEC*/
@RF00425 DS    0H                                                  0428
*                        END;                              /*@Y30SSEC*/
@RC00423 DS    0H                                                  0429
*                    /************************************************/
*                    /*                                      @OZ00751*/
*                    /* INITIALIZE ENTYPE AND ENTIDNO        @OZ00751*/
*                    /*        AND ACB FPLS                  @Y30SSEC*/
*                    /*                                      @OZ00751*/
*                    /************************************************/
*                                                                  0429
*                    CTGFLPTR = ADDR(ENTYPFPL);            /*@OZ00751*/
*                                                                  0429
@RF00416 LA    CTGFLPTR,ENTYPFPL                                   0429
*                      DO N = 1 TO 3;                      /*@Y30SSEC*/
*                                                                  0430
         LA    N,1                                                 0430
@DL00430 DS    0H                                                  0431
*                        CTGFLDNO = 1;                     /*@OZ00751*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0431
*                        CTGFLDNM = ADDR(TYPFIELD(N));     /*@OZ00751*/
         LR    @08,N                                               0432
         SLA   @08,3                                               0432
         LA    @08,TYPFIELD-8(@08)                                 0432
         ST    @08,CTGFLDNM(,CTGFLPTR)                             0432
*                        CTGFIELD(N) = CTGFLPTR;           /*@OZ00751*/
         LR    @08,N                                               0433
         SLA   @08,2                                               0433
         L     @04,CTGPLPTR                                        0433
         ST    CTGFLPTR,CTGFIELD-4(@08,@04)                        0433
*                        CTGFLPTR =                                0434
*                           CTGFLPTR + (LENGTH(CTGFL)+12); /*@OZ00751*/
         AH    CTGFLPTR,@CH01283                                   0434
*                      END;                                /*@OZ00751*/
*                                                                  0435
         AH    N,@CH00219                                          0435
         CH    N,@CH00162                                          0435
         BNH   @DL00430                                            0435
*                    /************************************************/
*                    /*                                      @OZ00751*/
*                    /* INVOKE VSAM CATALOG FOR LOCATE REQ   @OZ00751*/
*                    /*                                      @OZ00751*/
*                    /************************************************/
*                                                                  0436
*                    CALL IDCSACA0 (GDTTBL,CTGPLPTR);      /*@OZ00751*/
*                                                                  0436
         L     @08,@PC00001                                        0436
         ST    @08,@AL00001                                        0436
         LA    @07,CTGPLPTR                                        0436
         ST    @07,@AL00001+4                                      0436
         L     @15,GDTCAT(,@08)                                    0436
         LA    @01,@AL00001                                        0436
         BALR  @14,@15                                             0436
*                    CTGRTNCC = RTNREG;                    /*@OZ00751*/
*                                                                  0437
         LR    CTGRTNCC,RTNREG                                     0437
*                    /************************************************/
*                    /*                                      @OZ00751*/
*                    /* IF THE ENTRY IS LOCATED, CHECK TO    @OZ00751*/
*                    /* SEE IF THE ENTRY IS A CATALOG. IF    @OZ00751*/
*                    /* THE RTN CODE IS NON ZERO THERE IS    @OZ00751*/
*                    /* NO MESSAGE PRINTED                   @OZ00751*/
*                    /*                                      @OZ00751*/
*                    /************************************************/
*                                                                  0438
*                    IF CTGRTNCC = 0                               0438
*                      THEN                                        0438
         LTR   CTGRTNCC,CTGRTNCC                                   0438
         BNZ   @RF00438                                            0438
*                        DO;                               /*@OZ00751*/
*                                                                  0439
*                        /********************************************/
*                        /*                                  @OZ00751*/
*                        /* ONE OF TWO CONDITIONS INDICATE   @OZ00751*/
*                        /* THAT THIS ENTRY IS A CATALOG:    @OZ00751*/
*                        /*   : THE ENTRY TYPE IS 'U'        @OZ00751*/
*                        /*   : THE CI # IS 2                @Y30SSEC*/
*                        /* THE ENTIDNO AND ENTYPE FPLS      @OZ00751*/
*                        /* REFERENCE THE OBJECTS            @OZ00751*/
*                        /* CHARACTERISTICS                  @OZ00751*/
*                        /*                                  @OZ00751*/
*                        /********************************************/
*                                                                  0440
*                        CTGFLPTR = CTGFIELD(1);           /*@OZ00751*/
*                                                                  0440
         L     @08,CTGPLPTR                                        0440
         L     @03,CTGFIELD(,@08)                                  0440
         LR    CTGFLPTR,@03                                        0440
*                        IF CTGFLPT(1) -> ENTRYTYP = 'U' ×         0441
*                            (CTGFIELD(1)->CTGFLPT(1)->ENTRYTYP='C' &
*                             CTGFIELD(2) -> CTGFLPT(1)-> ENTRYCI# = 2)
*                          THEN                                    0441
         L     @01,CTGFLPT(,CTGFLPTR)                              0441
         CLI   ENTRYTYP(@01),C'U'                                  0441
         BE    @RT00441                                            0441
         L     @03,CTGFLPT(,@03)                                   0441
         CLI   ENTRYTYP(@03),C'C'                                  0441
         BNE   @RF00441                                            0441
         L     @08,CTGFIELD+4(,@08)                                0441
         L     @08,CTGFLPT(,@08)                                   0441
         CLC   ENTRYCI#(3,@08),@CF00153+1                          0441
         BNE   @RF00441                                            0441
@RT00441 DS    0H                                                  0442
*                            DO;                           /*@OZ00751*/
*                                                                  0442
*                            IF J=1                                0443
*                              THEN                                0443
         CH    J,@CH00219                                          0443
         BNE   @RF00443                                            0443
*                                CATRELSW = ON;            /*@OZ00751*/
*                                                                  0444
         OI    CATRELSW,B'10000000'                                0444
*                            IF J = 2   & CATRELSW = ON            0445
*                              THEN                                0445
@RF00443 CH    J,@CH00153                                          0445
         BNE   @RF00445                                            0445
         TM    CATRELSW,B'10000000'                                0445
         BNO   @RF00445                                            0445
*                                DO;                       /*@OZ00751*/
*                                                                  0446
*                                CATCOPSW = ON;            /*@OZ00751*/
         OI    CATCOPSW,B'10000000'                                0447
*                                CATRELSW = OFF;           /*@OZ00751*/
*                                                                  0448
         NI    CATRELSW,B'01111111'                                0448
*                                END;                      /*@OZ00751*/
*                                                                  0449
*                            CALL VERIFYC;                 /*@OZ00751*/
*                                                                  0450
@RF00445 BAL   @14,VERIFYC                                         0450
*                              /* SAVE ACB ADDR OF CATALOGS  @Y30SSEC*/
*                            HOLDACB(J) = CTGFIELD(3) -> CTGFLPT(1)
*                                         -> ACBADDR;      /*@Y30SSEC*/
         LR    @08,J                                               0451
         SLA   @08,2                                               0451
         L     @07,CTGPLPTR                                        0451
         L     @07,CTGFIELD+8(,@07)                                0451
         L     @07,CTGFLPT(,@07)                                   0451
         L     @07,ACBADDR(,@07)                                   0451
         ST    @07,HOLDACB-4(@08)                                  0451
*                            END;                          /*@OZ00751*/
*                                                                  0452
*                        END;                              /*@OZ00751*/
*                                                                  0453
@RF00441 DS    0H                                                  0454
*                    END VSAMCHK;                          /*@OZ00751*/
*                                                                  0454
*                                                                  0454
@RF00438 DS    0H                                                  0455
*                OPNPTR  = ADDR(OPAGLST1);                 /*@OZ00751*/
*                                                                  0455
@RF00402 LA    OPNPTR,OPAGLST1                                     0455
*                IOCSPTR = IOCSINP;                        /*@OZ00751*/
*                                                                  0456
         MVC   IOCSPTR(4),IOCSINP                                  0456
*              END CATLGCHK;                               /*@OZ00751*/
*                                                                  0457
         AH    J,@CH00219                                          0457
         CH    J,@CH00153                                          0457
         BNH   @DL00401                                            0457
*            /********************************************************/
*            /*                                              @OZ00751*/
*            /* IF TARGET WAS A CATALOG VERIFY THAT NO       @OZ00751*/
*            /* BEGINNING OR ENDING DELIMITERS WERE SPECIFIED@OZ00751*/
*            /* FOR THE REQUEST                              @OZ00751*/
*            /*                                              @OZ00751*/
*            /********************************************************/
*                                                                  0458
*            IF CATRELSW = ON  &                                   0458
*                 ( (ADDR(FMKYC)) ^= NULLPTR  ×                    0458
*                   (ADDR(FMRBA)) ^= NULLPTR  ×                    0458
*                   (ADDR(SKIP))  ^= NULLPTR  ×                    0458
*                   (ADDR(TOKYC)) ^= NULLPTR  ×                    0458
*                   (ADDR(TORBA)) ^= NULLPTR  ×                    0458
*                   (ADDR(COUNT)) ^= NULLPTR  )                    0458
*              THEN                                                0458
         TM    CATRELSW,B'10000000'                                0458
         BNO   @RF00458                                            0458
         SLR   @08,@08                                             0458
         L     @15,@PC00001+4                                      0458
         C     @08,FDTPTR+8(,@15)                                  0458
         BNE   @RT00458                                            0458
         C     @08,FDTPTR+12(,@15)                                 0458
         BNE   @RT00458                                            0458
         C     @08,FDTPTR+16(,@15)                                 0458
         BNE   @RT00458                                            0458
         C     @08,FDTPTR+20(,@15)                                 0458
         BNE   @RT00458                                            0458
         C     @08,FDTPTR+24(,@15)                                 0458
         BNE   @RT00458                                            0458
         C     @08,FDTPTR+28(,@15)                                 0458
         BE    @RF00458                                            0458
@RT00458 DS    0H                                                  0459
*                DO;                                       /*@OZ00751*/
*                                                                  0459
*                STATFLG = TERMERR;                        /*@OZ00751*/
*                                                                  0460
         MVC   STATFLG(5),@CB00819                                 0460
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* PUT OUT NO DELIMITERS ALLOWED WHEN TRYING@OZ00751*/
*                /* TO RELOAD A CATALOG MESSAGE              @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0461
*                DARGLIST = ''B;                           /*@OZ00751*/
         L     @08,DDSTRU                                          0461
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0461
*                DARGSMOD = 'PR0';                         /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            0462
*                DARGSENT = 18;                            /*@OZ00751*/
         MVI   DARGSENT(@08),X'12'                                 0463
*                CALL AMSTP011  (GDTTBL,PRTFILE,DDSTRU);   /*@OZ00751*/
*                                                                  0464
         L     @08,@PC00001                                        0464
         ST    @08,@AL00001                                        0464
         LA    @15,@CF00115                                        0464
         ST    @15,@AL00001+4                                      0464
         LA    @15,DDSTRU                                          0464
         ST    @15,@AL00001+8                                      0464
         MVI   @AL00001+8,X'80'                                    0464
         L     @15,GDTPRT(,@08)                                    0464
         LA    @01,@AL00001                                        0464
         BALR  @14,@15                                             0464
*                END;                                      /*@OZ00751*/
*                                                                  0465
*            IF CATRELSW = ON & STATFLG = NORMAL                   0466
*              THEN                                        /*@OZ00751*/
@RF00458 TM    CATRELSW,B'10000000'                                0466
         BNO   @RF00466                                            0466
         CLC   STATFLG(5),@CB00816                                 0466
         BNE   @RF00466                                            0466
*                DO;                                       /*@OZ00751*/
*                                                                  0467
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* CALL THE CATALOG RELOAD ROUTINE AFTER    @OZ00751*/
*                /* PUTTING OUT A MESSAGE INFORMING THE USER @OZ00751*/
*                /* THAT HE IS ABOUT TO RELOAD A CATALOG     @OZ00751*/
*                /* AND OPENING TARGET FOR UPDATE            @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0468
*                DARGLIST = ''B;                           /*@OZ00751*/
         L     @08,DDSTRU                                          0468
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0468
*                DARGSMOD = 'PR0';                         /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            0469
*                DARGSENT = 19;                            /*@OZ00751*/
         MVI   DARGSENT(@08),X'13'                                 0470
*                CALL AMSTP011  (GDTTBL,PRTFILE,DDSTRU);   /*@OZ00751*/
*                                                                  0471
         L     @08,@PC00001                                        0471
         ST    @08,@AL00001                                        0471
         LA    @03,@CF00115                                        0471
         ST    @03,@AL00001+4                                      0471
         LA    @03,DDSTRU                                          0471
         ST    @03,@AL00001+8                                      0471
         MVI   @AL00001+8,X'80'                                    0471
         L     @15,GDTPRT(,@08)                                    0471
         LA    @01,@AL00001                                        0471
         BALR  @14,@15                                             0471
*                OPAGLST3 = OPAGLST2;                      /*@OZ00751*/
         MVC   OPAGLST3(48),OPAGLST2                               0472
*                OPNPTR = ADDR(OPAGLST3);                  /*@OZ00751*/
         LA    OPNPTR,OPAGLST3                                     0473
*                OPNOPTOT = OFF;                           /*@OZ00751*/
*                OPNOPTUP = ON;                            /*@OZ00751*/
         OI    OPNOPTUP(OPNPTR),B'00100000'                        0475
         NI    OPNOPTOT(OPNPTR),B'10111111'                        0475
*                OPNIOC = ADDR(IOCSOUP);                   /*@OZ00751*/
*                                                                  0476
         LA    @08,IOCSOUP                                         0476
         ST    @08,OPNIOC(,OPNPTR)                                 0476
*                CALL IDCIOOP0 (GDTTBL,OPAGLST3);          /*@OZ00751*/
*                                                                  0477
         L     @08,@PC00001                                        0477
         ST    @08,@AL00001                                        0477
         LA    @15,OPAGLST3                                        0477
         ST    @15,@AL00001+4                                      0477
         MVI   @AL00001+4,X'80'                                    0477
         L     @15,GDTOPN(,@08)                                    0477
         LA    @01,@AL00001                                        0477
         BALR  @14,@15                                             0477
*                RESPECIFY RTNREG RSTD;                            0478
*                TESTRC = RTNREG;                                  0479
         STH   RTNREG,TESTRC                                       0479
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/
*                                                                  0480
*                IF TESTRC ^= 0                                    0481
*                  THEN                                            0481
         LH    @08,TESTRC                                          0481
         LTR   @08,@08                                             0481
         BZ    @RF00481                                            0481
*                    STATFLG = TERMERR;                    /*@OZ00751*/
*                                                                  0482
         MVC   STATFLG(5),@CB00819                                 0482
*                  ELSE                                            0483
*                    CALL CATRELOD;                        /*@OZ00751*/
*                                                                  0483
         B     @RC00481                                            0483
@RF00481 BAL   @14,CATRELOD                                        0483
*                END;                                      /*@OZ00751*/
*                                                                  0484
@RC00481 DS    0H                                                  0485
*            /********************************************************/
*            /*                                                      */
*            /*IF BOTH OBJECTS ARE CATALOGS AND NO DELIMETERS@OZ00751*/
*            /*HAVE BEEN SPECIFIED THEN SET THE APPROPRIATE  @OZ00751*/
*            /* IOCS FLAGS                                   @OZ00751*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0485
*            IF CATCOPSW = ON  &                                   0485
*                 ( (ADDR(FMKYC)) ^= NULLPTR  ×                    0485
*                   (ADDR(FMRBA)) ^= NULLPTR  ×                    0485
*                   (ADDR(SKIP))  ^= NULLPTR  ×                    0485
*                   (ADDR(TOKYC)) ^= NULLPTR  ×                    0485
*                   (ADDR(TORBA)) ^= NULLPTR  ×                    0485
*                   (ADDR(COUNT)) ^= NULLPTR  )                    0485
*              THEN                                                0485
@RF00466 TM    CATCOPSW,B'10000000'                                0485
         BNO   @RF00485                                            0485
         SLR   @08,@08                                             0485
         L     @15,@PC00001+4                                      0485
         C     @08,FDTPTR+8(,@15)                                  0485
         BNE   @RT00485                                            0485
         C     @08,FDTPTR+12(,@15)                                 0485
         BNE   @RT00485                                            0485
         C     @08,FDTPTR+16(,@15)                                 0485
         BNE   @RT00485                                            0485
         C     @08,FDTPTR+20(,@15)                                 0485
         BNE   @RT00485                                            0485
         C     @08,FDTPTR+24(,@15)                                 0485
         BNE   @RT00485                                            0485
         C     @08,FDTPTR+28(,@15)                                 0485
         BE    @RF00485                                            0485
@RT00485 DS    0H                                                  0486
*                STATFLG = CATDLMER;                       /*@OZ00751*/
         MVC   STATFLG(5),@CB00828                                 0486
*              ELSE                                                0487
*                IF CATCOPSW = ON                                  0487
*                  THEN                                            0487
         B     @RC00485                                            0487
@RF00485 TM    CATCOPSW,B'10000000'                                0487
         BNO   @RF00487                                            0487
*                    DO;                                   /*@OZ00751*/
*                                                                  0488
*                    CALL RECOVCAT; /* GO CHECK FOR RECOVERABLE ATTR */
         BAL   @14,RECOVCAT                                        0489
*                                                          /*@Y30SSEC*/
*                    IF STATFLG = NORMAL THEN                      0490
         CLC   STATFLG(5),@CB00816                                 0490
         BNE   @RF00490                                            0490
*                      DO;                                 /*@Y30SSEC*/
*                        IOCSINP -> IOCMACCC = ON;         /*@Y30SSEC*/
         L     @08,IOCSINP                                         0492
         OI    IOCMACCC(@08),B'00000010'                           0492
*                        IOCSOUT -> IOCMACCC = ON;         /*@Y30SSEC*/
         L     @08,IOCSOUT                                         0493
         OI    IOCMACCC(@08),B'00000010'                           0493
*                      END;                                /*@Y30SSEC*/
*                                                                  0494
*                    END;                                  /*@OZ00751*/
*                                                                  0495
@RF00490 DS    0H                                                  0496
*            END CATCPYCK;                                 /*@OZ00751*/
*                                                                  0496
@RF00487 DS    0H                                                  0496
@RC00485 DS    0H                                                  0497
*        /************************************************************/
*        /*                                                          */
*        /* INVOKE THE DATA SET DELIMITER(DELIMSET) -                */
*        /* POSITIONS TO THE BEGINNING OF INPUT DATA SET SUBSET      */
*        /* AND/OR REFERENCES THE ENDING DELIMITERS:                 */
*        /* . DELIMFLG - SET BY DELIMSET IF AN ENDING KEY OR RBA     */
*        /*   DELIMITER EXISTS.                                      */
*        /* . LOOPCNT  - SET BY DELIMSET IF A COUNT OF RECORDS IS TO */
*        /*   BE PROCESSED.                                          */
*        /* . LOOPINCR - WHEN COUNT PROCESSING EXISTS, DELIMSET SETS */
*        /*   THIS VALUE TO 1, OTHERWISE IT IS ALWAYS 0.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0497
*        IF STATFLG = NORMAL & CATRELSW ^= ON              /*@OZ00751*/
*          THEN                                                    0497
@RF00397 CLC   STATFLG(5),@CB00816                                 0497
         BNE   @RF00497                                            0497
         TM    CATRELSW,B'10000000'                                0497
         BO    @RF00497                                            0497
*            DO;                                                   0498
*                                                                  0498
*            IOCSPTR = IOCSINP;                                    0499
         MVC   IOCSPTR(4),IOCSINP                                  0499
*            CALL DELIMSET (DELIMFLG,LOOPCNT,LOOPINCR);            0500
*                                                                  0500
         LA    @08,DELIMFLG                                        0500
         ST    @08,@AL00001                                        0500
         LA    @08,LOOPCNT                                         0500
         ST    @08,@AL00001+4                                      0500
         LA    @08,LOOPINCR                                        0500
         ST    @08,@AL00001+8                                      0500
         LA    @01,@AL00001                                        0500
         BAL   @14,DELIMSET                                        0500
*            END;                                                  0501
*                                                                  0501
*                                                                  0501
*        /************************************************************/
*        /*                                                          */
*        /* COPY PROCESSING IS BY A UGET/UPUT LOOP WHEN AN ENDING    */
*        /* SUBSET DELIMITER IS SPECIFIED -                          */
*        /*  DELIMFLG OR LOOPINCR INDICATE THE EXISTANCE OF AN ENDING*/
*        /*  DELIMITER, THESE VALUES ARE SET BY 'DELIMSET'.          */
*        /* WHEN THERE IS NO ENDING DELIMITER THE UCOPY MACRO IS     */
*        /* INVOKED ONCE TO PERFORM THE ENTIRE COPY OPERATION        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0502
*        IF STATFLG = NORMAL & CATRELSW ^= ON              /*@OZ00751*/
*          THEN                                                    0502
@RF00497 CLC   STATFLG(5),@CB00816                                 0502
         BNE   @RF00502                                            0502
         TM    CATRELSW,B'10000000'                                0502
         BO    @RF00502                                            0502
* CPYLOOPA:  DO;                                                   0503
*                                                                  0503
CPYLOOPA DS    0H                                                  0504
*            OLDERID2 = NEWERID2;                                  0504
         L     @08,@PC00001                                        0504
         L     @08,GDTTR2(,@08)                                    0504
         MVC   @TS00001(95),NEWERID2(@08)                          0504
         MVC   OLDERID2(95,@08),@TS00001                           0504
*            NEWID2 = 'RP13';                              /*@Y30SSLO*/
         MVC   NEWID2(4,@08),@CC01144                              0505
*            CYCLEFLG = GO;                                        0506
*                                                                  0506
         MVI   CYCLEFLG,X'00'                                      0506
*            /********************************************************/
*            /*                                                      */
*            /* INITIALIZE KEY LENGTH USED IN DETERMINING ENDING SUB-*/
*            /* SET BOUNDARY. THE LENGTH MUST BE THE MINIMUM OF THE  */
*            /* VALUES SPECIFIED BY THE USER VERSUS THAT SPECIFIED   */
*            /* IN THE IOCS                                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0507
*            IF DELIMFLG = TOKYPOST                                0507
*              THEN                                                0507
         CLI   DELIMFLG,X'02'                                      0507
         BNE   @RF00507                                            0507
*                DO;                                               0508
*                                                                  0508
*                IOCSPTR = IOCSINP;                                0509
         L     @08,IOCSINP                                         0509
         ST    @08,IOCSPTR                                         0509
*                ENDKYLN = MIN(TOKYCLEN,IOCKYL);                   0510
*                                                                  0510
         L     @15,@PC00001+4                                      0510
         L     @01,FDTPTR+20(,@15)                                 0510
         SLR   @00,@00                                             0510
         IC    @00,TOKYCLEN(,@01)                                  0510
         SLR   @01,@01                                             0510
         IC    @01,IOCKYL(,@08)                                    0510
         CR    @00,@01                                             0510
         BNH   *+6
         LR    @00,@01                                             0510
         ST    @00,ENDKYLN                                         0510
*                END;                                              0511
*                                                                  0511
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* IF THE DATA SET IS RELATIVE RECORD ,INITIALIZE       */
*            /* OLDREL TO POINT TO THE SLOT PRIOR TO WHERE   @Y30SSJH*/
*            /* COPYING IS TO START.                         @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  0512
*            IF ( IOCSINP -> IOCMACRR = ON &                       0512
*                 ADDR(COUNT) ^= NULLPTR )                         0512
*              THEN                                                0512
@RF00507 L     @08,IOCSINP                                         0512
         TM    IOCMACRR(@08),B'00100000'                           0512
         BNO   @RF00512                                            0512
         SLR   @08,@08                                             0512
         L     @15,@PC00001+4                                      0512
         C     @08,FDTPTR+28(,@15)                                 0512
         BE    @RF00512                                            0512
*                DO;                                       /*@Y30SSJH*/
*                                                                  0513
*                IF ADDR(SKIP) ^= NULLPTR                          0514
*                  THEN                                            0514
         L     @15,FDTPTR+16(,@15)                                 0514
         CR    @15,@08                                             0514
         BE    @RF00514                                            0514
*                    OLDREL = SKIPVAL;                     /*@Y30SSJH*/
         MVC   OLDREL(4),SKIPVAL(@15)                              0515
*                  ELSE                                            0516
*                    IF ADDR(FMNUM) ^= NULLPTR                     0516
*                      THEN                                        0516
         B     @RC00514                                            0516
@RF00514 L     @08,@PC00001+4                                      0516
         L     @08,FDTPTR+48(,@08)                                 0516
         LTR   @08,@08                                             0516
         BZ    @RF00516                                            0516
*                        OLDREL = FMNUMVAL - 1;            /*@Y30SSJH*/
         L     @08,FMNUMVAL(,@08)                                  0517
         BCTR  @08,0                                               0517
         ST    @08,OLDREL                                          0517
*                      ELSE                                        0518
*                        OLDREL = 0;                       /*@Y30SSJH*/
*                                                                  0518
         B     @RC00516                                            0518
@RF00516 SLR   @08,@08                                             0518
         ST    @08,OLDREL                                          0518
*                END;                                      /*@Y30SSJH*/
*                                                                  0519
@RC00516 DS    0H                                                  0519
@RC00514 DS    0H                                                  0520
*            /********************************************************/
*            /*                                                      */
*            /* WHEN ENDING DELIMITERS ARE SPECIFIED AS INDICATED BY */
*            /* DELIMFLG OR LOOPINCR, CPYLOOPB IS USED TO GET AND    */
*            /* PUT RECORDS INDIVIDUALLY.                            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0520
*            IF DELIMFLG ^= STOP  ×                                0520
*               LOOPINCR ^= 0                                      0520
*              THEN                                                0520
*                                                                  0520
@RF00512 CLI   DELIMFLG,X'0F'                                      0520
         BNE   @RT00520                                            0520
         LH    @08,LOOPINCR                                        0520
         LTR   @08,@08                                             0520
         BZ    @RF00520                                            0520
@RT00520 DS    0H                                                  0521
*                /****************************************************/
*                /*                                                  */
*                /* UGET/UPUT LOOP IF ENDING DELIMITER HAS BEEN      */
*                /* SPECIFIED                                        */
*                /*                                                  */
*                /****************************************************/
*                                                                  0521
*CPYLOOPB:       DO N = 1 TO LOOPCNT BY LOOPINCR                   0521
*                  WHILE CYCLEFLG = GO;                            0521
*                                                                  0521
CPYLOOPB LA    N,1                                                 0521
         B     @DE00521                                            0521
@DL00521 CLI   CYCLEFLG,X'00'                                      0521
         BNE   @DC00521                                            0521
*                /****************************************************/
*                /*                                                  */
*                /* RETRIEVE THE INPUT RECORD                        */
*                /*                                                  */
*                /****************************************************/
*                                                                  0522
*                IOCSPTR = IOCSINP;                                0522
         MVC   IOCSPTR(4),IOCSINP                                  0522
*                CALL IDCIOGT0 (GDTTBL,IOCSPTR);                   0523
         L     @08,@PC00001                                        0523
         ST    @08,@AL00001                                        0523
         LA    @04,IOCSPTR                                         0523
         ST    @04,@AL00001+4                                      0523
         MVI   @AL00001+4,X'80'                                    0523
         L     @15,GDTGET(,@08)                                    0523
         LA    @01,@AL00001                                        0523
         BALR  @14,@15                                             0523
*                RESPECIFY RTNREG RSTD;                            0524
*                TESTRC = RTNREG;                                  0525
         STH   RTNREG,TESTRC                                       0525
*                RESPECIFY RTNREG UNRSTD;                          0526
*                CPRECID = '01'X;                                  0527
*                                                                  0527
         MVI   CPRECID,X'01'                                       0527
*                IF TESTRC = 0                                     0528
*                  THEN                                            0528
         LH    @08,TESTRC                                          0528
         LTR   @08,@08                                             0528
         BNZ   @RF00528                                            0528
* CPYLOOPC:          DO;                                           0529
*                                                                  0529
*                                                                  0529
CPYLOOPC DS    0H                                                  0530
*                    /************************************************/
*                    /*                                              */
*                    /* HAVE WE EXCEEDED THE RBA DELIMITER           */
*                    /*                                              */
*                    /************************************************/
*                                                                  0530
*                    IF DELIMFLG = TORBAPOS                        0530
*                      THEN                                        0530
         CLI   DELIMFLG,X'03'                                      0530
         BNE   @RF00530                                            0530
*                        IF IOCRBA > TORBAVAL                      0531
*                          THEN                                    0531
         L     @08,@PC00001+4                                      0531
         L     @08,FDTPTR+24(,@08)                                 0531
         L     @04,IOCSPTR                                         0531
         L     @04,IOCRBA(,@04)                                    0531
         C     @04,TORBAVAL(,@08)                                  0531
         BNH   @RF00531                                            0531
*                            CYCLEFLG = STOP;                      0532
*                                                                  0532
         MVI   CYCLEFLG,X'0F'                                      0532
*                          ELSE;                                   0533
*                                                                  0533
*                                                                  0533
@RF00531 DS    0H                                                  0534
*                      ELSE                                        0534
*                  /**************************************************/
*                  /*                                                */
*                  /* HAVE WE EXCEEDED THE KEY DELIMITER             */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0534
*                  IF DELIMFLG = TOKYPOST                          0534
*                    THEN                                          0534
         B     @RC00530                                            0534
@RF00530 CLI   DELIMFLG,X'02'                                      0534
         BNE   @RF00534                                            0534
*                      DO;                                         0535
*                                                                  0535
*                      IF TOKYCVAL < RECDKEY(1:ENDKYLN)            0536
*                        THEN                                      0536
         L     @08,@PC00001+4                                      0536
         L     @08,FDTPTR+20(,@08)                                 0536
         L     @04,IOCSPTR                                         0536
         L     @04,IOCKYA(,@04)                                    0536
         L     @15,ENDKYLN                                         0536
         BCTR  @15,0                                               0536
         EX    @15,@SC01302                                        0536
         BNL   @RF00536                                            0536
*                          CYCLEFLG = STOP;                        0537
*                                                                  0537
         MVI   CYCLEFLG,X'0F'                                      0537
*                      END;                                        0538
*                                                                  0538
*                          /******************************************/
*                          /*                                @Y30SSJH*/
*                          /* HAVE WE EXCEEDED THE RECORD    @Y30SSJH*/
*                          /* NUMBER DELIMITER               @Y30SSJH*/
*                          /*                                @Y30SSJH*/
*                          /******************************************/
*                                                                  0539
*                          ELSE                                    0539
*                            IF DELIMFLG = TORRNPOS                0539
*                              THEN                                0539
         B     @RC00534                                            0539
@RF00534 CLI   DELIMFLG,X'04'                                      0539
         BNE   @RF00539                                            0539
*                                DO;                       /*@Y30SSJH*/
*                                                                  0540
*                                IF IOCREL > TONUMVAL              0541
*                                  THEN                            0541
         L     @08,@PC00001+4                                      0541
         L     @08,FDTPTR+52(,@08)                                 0541
         L     @04,IOCSPTR                                         0541
         L     @04,IOCREL(,@04)                                    0541
         C     @04,TONUMVAL(,@08)                                  0541
         BNH   @RF00541                                            0541
*                                    CYCLEFLG = STOP;      /*@Y30SSJH*/
*                                                                  0542
         MVI   CYCLEFLG,X'0F'                                      0542
*                                END;                      /*@Y30SSJH*/
*                                                                  0543
*                              /**************************************/
*                              /*                            @Y30SSJH*/
*                              /* IF COUNT SPECIFIED WITH RELA-      */
*                              /* TIVE RECORD DATA SET, COPYING      */
*                              /* STOPS WHEN THE NUMBER OF   @Y30SSJH*/
*                              /* VALID RECORD SLOTS COPIED  @Y30SSJH*/
*                              /* PLUS THE NUMBER OF INVALID @Y30SSJH*/
*                              /* SLOTS BYPASSED EXCEEDS COUNTVAL.   */
*                              /*                            @Y30SSJH*/
*                              /**************************************/
*                                                                  0544
*                              ELSE                        /*@Y30SSJH*/
*                                IF IOCMACRR = ON   &              0544
*                                   ADDR(COUNT) ^= NULLPTR         0544
*                                  THEN                            0544
         B     @RC00539                                            0544
@RF00539 L     @08,IOCSPTR                                         0544
         TM    IOCMACRR(@08),B'00100000'                           0544
         BNO   @RF00544                                            0544
         L     @04,@PC00001+4                                      0544
         L     @04,FDTPTR+28(,@04)                                 0544
         LTR   @04,@04                                             0544
         BZ    @RF00544                                            0544
*                                    DO;                   /*@Y30SSJH*/
*                                                                  0545
*                                    N = N + IOCREL - OLDREL - 1;  0546
         L     @08,IOCREL(,@08)                                    0546
         LR    @04,N                                               0546
         ALR   @04,@08                                             0546
         SL    @04,OLDREL                                          0546
         BCTR  @04,0                                               0546
         LR    N,@04                                               0546
*                                    OLDREL = IOCREL;      /*@Y30SSJH*/
         ST    @08,OLDREL                                          0547
*                                    IF N > LOOPCNT                0548
*                                      THEN                        0548
         C     N,LOOPCNT                                           0548
         BNH   @RF00548                                            0548
*                                        CYCLEFLG = STOP;  /*@Y30SSJH*/
*                                                                  0549
         MVI   CYCLEFLG,X'0F'                                      0549
*                                    END;                  /*@Y30SSJH*/
*                                                                  0550
@RF00548 DS    0H                                                  0551
*                    /************************************************/
*                    /*                                              */
*                    /* ENDING DELIMITERS HAVE NOT BEEN EXCEEDED -   */
*                    /* WRITE RECORD TO OUTPUT DATA SET              */
*                    /*                                              */
*                    /************************************************/
*                                                                  0551
*                    IF CYCLEFLG = GO                              0551
*                      THEN                                        0551
@RF00544 DS    0H                                                  0551
@RC00539 DS    0H                                                  0551
@RC00534 DS    0H                                                  0551
@RC00530 CLI   CYCLEFLG,X'00'                                      0551
         BNE   @RF00551                                            0551
*                        DO;                                       0552
*                                                                  0552
*                        /********************************************/
*                        /*                                  @Y30SSJH*/
*                        /* WHEN COPYING FROM ONE RELATIVE   @Y30SSJH*/
*                        /* RECORD DATA SET TO A ANOTHER     @Y30SSJH*/
*                        /* RECORD NUMBERS ARE CONSTANT.     @Y30SSJH*/
*                        /*                                  @Y30SSJH*/
*                        /********************************************/
*                                                                  0553
*                        IF IOCMACRR = ON  &                       0553
*                           IOCSOUT -> IOCMACRR = ON               0553
*                          THEN                                    0553
         L     @08,IOCSPTR                                         0553
         TM    IOCMACRR(@08),B'00100000'                           0553
         BNO   @RF00553                                            0553
         L     @04,IOCSOUT                                         0553
         TM    IOCMACRR(@04),B'00100000'                           0553
         BNO   @RF00553                                            0553
*                            IOCSOUT -> IOCREL = IOCREL;   /*@Y30SSJH*/
         MVC   IOCREL(4,@04),IOCREL(@08)                           0554
*                          ELSE                            /*@Y30SSEC*/
*                          /*********************************@Y30SSEC*/
*                          /*                                        */
*                          /* IF ONLY THE OUTPUT IS RRDS,            */
*                          /* RECORD NUMBERS ARE 1,2,...., ETC.      */
*                          /*                                        */
*                          /*********************************@Y30SSEC*/
*                          IF IOCSOUT -> IOCMACRR = ON     /*@Y30SSEC*/
*                            THEN                                  0555
         B     @RC00553                                            0555
@RF00553 L     @08,IOCSOUT                                         0555
         TM    IOCMACRR(@08),B'00100000'                           0555
         BNO   @RF00555                                            0555
*                              IOCSOUT -> IOCREL = IOCSOUT -> IOCREL+1;
         LA    @04,1                                               0556
         AL    @04,IOCREL(,@08)                                    0556
         ST    @04,IOCREL(,@08)                                    0556
*                                                          /*@Y30SSEC*/
*                                                                  0557
*                        IOCSOUT -> IOCDAD = IOCDAD;               0557
@RF00555 DS    0H                                                  0557
@RC00553 L     @08,IOCSOUT                                         0557
         L     @04,IOCSPTR                                         0557
         MVC   IOCDAD(4,@08),IOCDAD(@04)                           0557
*                        IOCSOUT -> IOCDLN = IOCDLN;               0558
         MVC   IOCDLN(4,@08),IOCDLN(@04)                           0558
*                        IOCSPTR = IOCSOUT;                        0559
*                                                                  0559
         ST    @08,IOCSPTR                                         0559
*                        CALL IDCIOPT0 (GDTTBL,IOCSPTR,CPRECID);   0560
         L     @08,@PC00001                                        0560
         ST    @08,@AL00001                                        0560
         LA    @04,IOCSPTR                                         0560
         ST    @04,@AL00001+4                                      0560
         LA    @04,CPRECID                                         0560
         ST    @04,@AL00001+8                                      0560
         MVI   @AL00001+8,X'80'                                    0560
         L     @15,GDTPUT(,@08)                                    0560
         LA    @01,@AL00001                                        0560
         BALR  @14,@15                                             0560
*                        RESPECIFY RTNREG RSTD;                    0561
*                        TESTRC = RTNREG;                          0562
         STH   RTNREG,TESTRC                                       0562
*                        RESPECIFY RTNREG UNRSTD;                  0563
*                        CPRECID = '02'X;                          0564
*                                                                  0564
         MVI   CPRECID,X'02'                                       0564
*                        END;                                      0565
*                                                                  0565
*                    END CPYLOOPC;                                 0566
*                                                                  0566
@RF00551 DS    0H                                                  0567
*                  /**************************************************/
*                  /*                                                */
*                  /* CHECK FOR NON-RCOK RETURN CODES FROM UGET/UPUT */
*                  /* RCEODAD AND RCFAIL ARE THE TWO POSSIBLE CODES  */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0567
*                  IF TESTRC ^= 0                                  0567
*                    THEN                                          0567
@RF00528 LH    @08,TESTRC                                          0567
         LTR   @08,@08                                             0567
         BZ    @RF00567                                            0567
*CHCKLOOP:             DO;                                         0568
*                                                                  0568
CHCKLOOP DS    0H                                                  0569
*                      /**********************************************/
*                      /*                                            */
*                      /* NORMAL END OF DATA ON RECORD RETRIEVAL     */
*                      /*                                            */
*                      /**********************************************/
*                      IF TESTRC = 16  &                           0569
*                         CPRECID = '01'X                          0569
*                        THEN                                      0569
         CLC   TESTRC(2),@CH00476                                  0569
         BNE   @RF00569                                            0569
         CLI   CPRECID,X'01'                                       0569
         BNE   @RF00569                                            0569
*                          DO;                                     0570
*                                                                  0570
*                          CYCLEFLG = STOP;                        0571
*                                                                  0571
         MVI   CYCLEFLG,X'0F'                                      0571
*                        /********************************************/
*                        /*                                          */
*                        /* VERIFY THAT ENDING DELIMITER WAS NOT     */
*                        /* BEYOND END OF FILE - IF IT WAS SET       */
*                        /* LASTCC = 4                               */
*                        /*                                          */
*                        /********************************************/
*                        IF DELIMFLG = TOKYPOST  &                 0572
*                           TOKYCVAL > RECDKEY(1:ENDKYLN)          0572
*                          THEN                                    0572
         CLI   DELIMFLG,X'02'                                      0572
         BNE   @RF00572                                            0572
         L     @08,@PC00001+4                                      0572
         L     @08,FDTPTR+20(,@08)                                 0572
         L     @04,IOCSPTR                                         0572
         L     @04,IOCKYA(,@04)                                    0572
         L     @15,ENDKYLN                                         0572
         BCTR  @15,0                                               0572
         EX    @15,@SC01302                                        0572
         BNH   @RF00572                                            0572
*                            STATFLG = ABNCONDT;                   0573
*                                                                  0573
         MVC   STATFLG(5),@CB00813                                 0573
*                        IF DELIMFLG = TORBAPOS  &                 0574
*                           TORBAVAL > IOCRBA                      0574
*                          THEN                                    0574
@RF00572 CLI   DELIMFLG,X'03'                                      0574
         BNE   @RF00574                                            0574
         L     @08,@PC00001+4                                      0574
         L     @08,FDTPTR+24(,@08)                                 0574
         L     @08,TORBAVAL(,@08)                                  0574
         L     @04,IOCSPTR                                         0574
         C     @08,IOCRBA(,@04)                                    0574
         BNH   @RF00574                                            0574
*                            STATFLG = ABNCONDT;                   0575
*                                                                  0575
         MVC   STATFLG(5),@CB00813                                 0575
*                        IF DELIMFLG = TORRNPOS  &                 0576
*                           TONUMVAL > IOCREL                      0576
*                          THEN                                    0576
@RF00574 CLI   DELIMFLG,X'04'                                      0576
         BNE   @RF00576                                            0576
         L     @08,@PC00001+4                                      0576
         L     @08,FDTPTR+52(,@08)                                 0576
         L     @08,TONUMVAL(,@08)                                  0576
         L     @04,IOCSPTR                                         0576
         C     @08,IOCREL(,@04)                                    0576
         BNH   @RF00576                                            0576
*                            STATFLG = ABNCONDT;           /*@Y30SSJH*/
*                                                                  0577
         MVC   STATFLG(5),@CB00813                                 0577
*                        IF LOOPINCR ^= 0                          0578
*                          THEN                                    0578
@RF00576 LH    @08,LOOPINCR                                        0578
         LTR   @08,@08                                             0578
         BZ    @RF00578                                            0578
*                            STATFLG = ABNCONDT;                   0579
*                                                                  0579
         MVC   STATFLG(5),@CB00813                                 0579
*                        END;                                      0580
*                                                                  0581
*                        /********************************************/
*                        /*                                          */
*                        /* TESTRC = RCFAIL, IF BOTH DATA SETS ARE   */
*                        /* STILL OPEN FOR PROCESSING AND WE HAVE NOT*/
*                        /* ALREADY ENCOUNTERED 3 I/O ERRORS OF THIS */
*                        /* TYPE - PROCESSING CAN CONTINUE           */
*                        /*                                          */
*                        /********************************************/
*                        ELSE                                      0581
*                          IF (TESTRC  = 4  &                      0581
*                              IOCSINP -> IOCMSGOP = ON &          0581
*                              IOCSOUT -> IOCMSGOP = ON &          0581
*                              FAILIOER  < 3    )                  0581
*                                                                  0581
*                          THEN                                    0581
         B     @RC00569                                            0581
@RF00569 CLC   TESTRC(2),@CH00042                                  0581
         BNE   @RF00581                                            0581
         L     @08,IOCSINP                                         0581
         TM    IOCMSGOP(@08),B'00100000'                           0581
         BNO   @RF00581                                            0581
         L     @08,IOCSOUT                                         0581
         TM    IOCMSGOP(@08),B'00100000'                           0581
         BNO   @RF00581                                            0581
         LH    @08,FAILIOER                                        0581
         CH    @08,@CH00162                                        0581
         BNL   @RF00581                                            0581
*                            DO;                                   0582
*                                                                  0582
*                            FAILIOER = FAILIOER + 1;              0583
         LA    @08,1(,@08)                                         0583
         STH   @08,FAILIOER                                        0583
*                            STATFLG = ABNEVENT;                   0584
*                                                                  0584
         MVC   STATFLG(5),@CB00825                                 0584
*                            END;                                  0585
*                                                                  0585
*                          ELSE                                    0586
*                            DO;                                   0586
*                                                                  0586
         B     @RC00581                                            0586
@RF00581 DS    0H                                                  0587
*                            CYCLEFLG = STOP;                      0587
         MVI   CYCLEFLG,X'0F'                                      0587
*                            STATFLG = TERMERR;                    0588
*                                                                  0588
         MVC   STATFLG(5),@CB00819                                 0588
*                            END;                                  0589
*                      END CHCKLOOP;                               0590
*                                                                  0590
@RC00581 DS    0H                                                  0590
@RC00569 DS    0H                                                  0591
*                END CPYLOOPB;                                     0591
@RF00567 AH    N,LOOPINCR                                          0591
@DE00521 C     N,LOOPCNT                                           0591
         BNH   @DL00521                                            0591
@DC00521 DS    0H                                                  0592
*              /******************************************************/
*              /*                                                    */
*              /* THERE IS NO ENDING DELIMITER - INVOKE UCOPY TO     */
*              /* COPY ALL RECORDS FROM PRESENT POSITION TO END OF   */
*              /* THE INPUT DATA SET                                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0592
*              ELSE                                                0592
* CPYLOOPD:      DO;                                               0592
*                                                                  0592
         B     @RC00520                                            0592
@RF00520 DS    0H                                                  0592
CPYLOOPD DS    0H                                                  0593
*                CALL IDCIOCO0 (GDTTBL,IOCSINP,IOCSOUT);           0593
         L     @08,@PC00001                                        0593
         ST    @08,@AL00001                                        0593
         LA    @15,IOCSINP                                         0593
         ST    @15,@AL00001+4                                      0593
         LA    @15,IOCSOUT                                         0593
         ST    @15,@AL00001+8                                      0593
         MVI   @AL00001+8,X'80'                                    0593
         L     @15,GDTCPY(,@08)                                    0593
         LA    @01,@AL00001                                        0593
         BALR  @14,@15                                             0593
*                RESPECIFY RTNREG RSTD;                            0594
*                TESTRC = RTNREG;                                  0595
         STH   RTNREG,TESTRC                                       0595
*                RESPECIFY RTNREG UNRSTD;                          0596
*                                                                  0596
*                IOCSPTR = IOCSINP;                                0597
*                                                                  0597
         L     @08,IOCSINP                                         0597
         ST    @08,IOCSPTR                                         0597
*                IF TESTRC = 4                                     0598
*                  THEN                                            0598
*                                                                  0598
         LH    @15,TESTRC                                          0598
         CH    @15,@CH00042                                        0598
         BNE   @RF00598                                            0598
*                    /************************************************/
*                    /*                                              */
*                    /* COPY COMPLETED BUT WITH NON-TERMINAL ERRORS  */
*                    /*                                              */
*                    /************************************************/
*                                                                  0599
*                    IF ( IOCSINP -> IOCMSGOP = ON  &              0599
*                         IOCSOUT -> IOCMSGOP = ON  )              0599
*                      THEN                                        0599
         TM    IOCMSGOP(@08),B'00100000'                           0599
         BNO   @RF00599                                            0599
         L     @08,IOCSOUT                                         0599
         TM    IOCMSGOP(@08),B'00100000'                           0599
         BNO   @RF00599                                            0599
*                        STATFLG = ABNEVENT;                       0600
*                                                                  0600
         MVC   STATFLG(5),@CB00825                                 0600
*                      /**********************************************/
*                      /*                                            */
*                      /* UCOPY TERMINATED DUE TO ERROR              */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0601
*                      ELSE                                        0601
*                        STATFLG = TERMERR;                        0601
*                                                                  0601
         B     @RC00599                                            0601
@RF00599 MVC   STATFLG(5),@CB00819                                 0601
*                END CPYLOOPD;                                     0602
*                                                                  0602
*                                                                  0602
@RC00599 DS    0H                                                  0602
@RF00598 DS    0H                                                  0603
*            END CPYLOOPA;                                         0603
*                                                                  0603
@RC00520 DS    0H                                                  0604
*        /************************************************************/
*        /*                                                  @OZ20461*/
*        /* IF INPUT DATA SET WAS OPENED WITH WARNING,       @OZ20461*/
*        /* SET LASTCC TO 4                                  @OZ20461*/
*        /*                                                  @OZ20461*/
*        /************************************************************/
*                                                                  0604
*        IF STATFLG = NORMAL & OPNWRN = ON THEN                    0604
@RF00502 CLC   STATFLG(5),@CB00816                                 0604
         BNE   @RF00604                                            0604
         TM    OPNWRN,B'10000000'                                  0604
         BNO   @RF00604                                            0604
*          STATFLG = ABNCONDT;                             /*@OZ20461*/
         MVC   STATFLG(5),@CB00813                                 0605
*        /************************************************************/
*        /*                                                          */
*        /* TERMINATION PROCESSING - STATFLG GIVES COMPLETION STATUS */
*        /*  . WRITE MESSAGE INDICATING THE NUMBER OF RECORDS COPIED */
*        /*  . WRITE FUNCTION TERMINATION MESSAGE                    */
*        /*  . SET TERMINATION CONDITION IN LASTCC AND RETURN        */
*        /*  . CLOSE DATA SETS                               @Y30SSJH*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0606
*        OLDERID2 = NEWERID2;                                      0606
@RF00604 L     @08,@PC00001                                        0606
         L     @15,GDTTR2(,@08)                                    0606
         MVC   @TS00001(95),NEWERID2(@15)                          0606
         MVC   OLDERID2(95,@15),@TS00001                           0606
*        NEWID2 = 'RP18';                                  /*@Y30SSLO*/
         MVC   NEWID2(4,@15),@CC01154                              0607
*        IF GDTDBG = NULLPTR                                       0608
*          THEN;                                                   0608
         L     @08,GDTDBG(,@08)                                    0608
         LTR   @08,@08                                             0608
         BZ    @RT00608                                            0608
*          ELSE                                                    0610
*            CALL IDCDB010 (GDTTBL,'RP01');                        0610
         L     @08,@PC00001                                        0610
         ST    @08,@AL00001                                        0610
         LA    @15,@CC00831                                        0610
         ST    @15,@AL00001+4                                      0610
         MVI   @AL00001+4,X'80'                                    0610
         L     @15,GDTDBG(,@08)                                    0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*                                                          /*@Y30SSLO*/
*                                                                  0611
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE MESSAGE INDICATING NUMBER OF RECORDS COPIED        */
*        /* . THE I/O ADAPTER MAINTAINS A COUNT OF RECORDS SUCCESS-  */
*        /*   FULLY COPIED IN IOCRRN (SEE IOCS STRUCTURE),           */
*        /* FOR A CATALOG RELOAD THE INPUT ONLY CONTAINS     @OZ00751*/
*        /* THE VALID COUNT INFORMATION.                     @OZ00751*/
*        /*  MESSAGE IS NOT PRINTED WHEN COPYING CATALOGS.   @VS05903*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0611
*        IF CATRELSW = ON                                          0611
*          THEN                                                    0611
@RT00608 TM    CATRELSW,B'10000000'                                0611
         BNO   @RF00611                                            0611
*            IOCSPTR = IOCSINP;                            /*@OZ00751*/
         MVC   IOCSPTR(4),IOCSINP                                  0612
*          ELSE                                                    0613
*            IOCSPTR = IOCSOUT;                            /*@OZ00751*/
*                                                                  0613
         B     @RC00611                                            0613
@RF00611 MVC   IOCSPTR(4),IOCSOUT                                  0613
*        IF CATCOPSW = OFF                                         0614
*          THEN                                                    0614
@RC00611 TM    CATCOPSW,B'10000000'                                0614
         BNZ   @RF00614                                            0614
*            DO;                                           /*@VS05903*/
*                                                                  0615
*            DARGL = ''B;                                  /*@Y30SSLO*/
         XC    DARGL(28),DARGL                                     0616
*            DARGSMOD = 'UV0';                                     0617
         L     @08,DDSTRU                                          0617
         MVC   DARGSMOD(3,@08),@CC01155                            0617
*            DARGSENT = 5;                                         0618
*                                                                  0618
         MVI   DARGSENT(@08),X'05'                                 0618
*            IF IOCSOUT ^= NULLPTR                           /*YM6244*/
*              THEN                                          /*YM6244*/
         L     @15,IOCSOUT                                         0619
         LTR   @15,@15                                             0619
         BZ    @RF00619                                            0619
*                DO;                                         /*YM6244*/
*                  DARGDBP  = ADDR(IOCRRN);                  /*YM6244*/
         L     @01,IOCSPTR                                         0621
         LA    @15,IOCRRN(,@01)                                    0621
         ST    @15,DARGDBP(,@08)                                   0621
*                  DARGILP  = LENGTH(IOCRRN);                /*YM6244*/
         MVC   DARGILP(2,@08),@CH00042                             0622
*                END;                                        /*YM6244*/
*              ELSE                                          /*YM6244*/
*                DO;                                         /*YM6244*/
         B     @RC00619                                            0624
@RF00619 DS    0H                                                  0625
*                  DARGDBP = ADDR(NULLPTR);                  /*YM6244*/
         L     @08,DDSTRU                                          0625
         LA    @15,@CF00115                                        0625
         ST    @15,DARGDBP(,@08)                                   0625
*                  DARGILP = LENGTH(NULLPTR);                /*YM6244*/
         MVC   DARGILP(2,@08),@CH00042                             0626
*                END;                                        /*YM6244*/
*                                                                  0627
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0628
*                                                                  0628
@RC00619 L     @08,@PC00001                                        0628
         ST    @08,@AL00001                                        0628
         LA    @15,@CF00115                                        0628
         ST    @15,@AL00001+4                                      0628
         LA    @15,DDSTRU                                          0628
         ST    @15,@AL00001+8                                      0628
         MVI   @AL00001+8,X'80'                                    0628
         L     @15,GDTPRT(,@08)                                    0628
         LA    @01,@AL00001                                        0628
         BALR  @14,@15                                             0628
*            END;                                          /*@VS05903*/
*                                                                  0629
*        /************************************************************/
*        /*                                                          */
*        /* CLOSE THE TARGET AND SOURCE DATA SETS                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0630
*        CALL IDCIOCL0 (GDTTBL,IOCSINP,IOCSOUT);                   0630
*                                                                  0630
@RF00614 L     @08,@PC00001                                        0630
         ST    @08,@AL00001                                        0630
         LA    @15,IOCSINP                                         0630
         ST    @15,@AL00001+4                                      0630
         LA    @15,IOCSOUT                                         0630
         ST    @15,@AL00001+8                                      0630
         MVI   @AL00001+8,X'80'                                    0630
         L     @15,GDTCLS(,@08)                                    0630
         LA    @01,@AL00001                                        0630
         BALR  @14,@15                                             0630
*        RESPECIFY RTNREG RSTD;                                    0631
*        TESTRC = RTNREG;                                          0632
         STH   RTNREG,TESTRC                                       0632
*        RESPECIFY RTNREG UNRSTD;                                  0633
*                                                                  0633
*        /************************************************************/
*        /*                                                          */
*        /* A CLOSE ERROR OCCURRED. THE I/O ADAPTER PRINTS MESSAGES  */
*        /* INDICATING THIS CONDITION. THIS IS A NON-TERMINAL CONDIT-*/
*        /* ION, INDICATE CONDITION IN STATFLAG IF A MORE SERIOUS    */
*        /* CONDITION HAS NOT ALREADY OCCURRED.                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0634
*        IF TESTRC ^= 0                                            0634
*          THEN                                                    0634
         LH    @08,TESTRC                                          0634
         LTR   @08,@08                                             0634
         BZ    @RF00634                                            0634
*            IF STATFLG ^= TERMERR  &                      /*@YA04557*/
*               STATFLG ^= POSITERR                                0635
*              THEN                                                0635
*                                                                  0635
         CLC   STATFLG(5),@CB00819                                 0635
         BE    @RF00635                                            0635
         CLC   STATFLG(5),@CB00822                                 0635
         BE    @RF00635                                            0635
*                /****************************************************/
*                /*                                                  */
*                /* SET STATFLG IF A PREVIOUS TERMINAL ERROR HAS NOT */
*                /* OCCURRED                                         */
*                /*                                                  */
*                /****************************************************/
*                STATFLG = ABNEVENT;                               0636
         MVC   STATFLG(5),@CB00825                                 0636
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE UDEALLOC TO RELEASE THE DYNAMICALLY        @Y30SSEC*/
*        /* ALLOCATED OUTPUT DATA SET.                       @Y30SSEC*/
*        /*                                                  @Y30SSEC*/
*        /************************************************************/
*                                                                  0637
*        IF (ADDR(OUTDS)) ^= NULLPTR                               0637
*           THEN                                                   0637
@RF00635 DS    0H                                                  0637
@RF00634 L     @08,@PC00001+4                                      0637
         L     @08,FDTPTR+44(,@08)                                 0637
         LTR   @08,@08                                             0637
         BZ    @RF00637                                            0637
*             CALL IDCSADL0 (GDTTBL,ALLAGL);               /*@Y30SSEC*/
*                                                                  0638
         L     @08,@PC00001                                        0638
         ST    @08,@AL00001                                        0638
         L     @01,ALLAGLPT                                        0638
         ST    @01,@AL00001+4                                      0638
         MVI   @AL00001+4,X'80'                                    0638
         L     @15,GDTDLC(,@08)                                    0638
         LA    @01,@AL00001                                        0638
         BALR  @14,@15                                             0638
*        RESPECIFY RTNREG RSTD;                                    0639
@RF00637 DS    0H                                                  0640
*        TESTRC = RTNREG;                                          0640
         STH   RTNREG,TESTRC                                       0640
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSEC*/
*                                                                  0641
*        IF TESTRC ^= 0                                            0642
*          THEN                                                    0642
         LH    @08,TESTRC                                          0642
         LTR   @08,@08                                             0642
         BZ    @RF00642                                            0642
*            STATFLG = TERMERR;/* UDEALLOC ISSUES ERR MSG    @Y30SSEC*/
         MVC   STATFLG(5),@CB00819                                 0643
*                                                                  0644
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE TERMINATION MESSAGE                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0644
*        DARGL = ''B;                                      /*@Y30SSLO*/
@RF00642 XC    DARGL(28),DARGL                                     0644
*        DARGSENT = STATFLG2;                                      0645
         L     @08,DDSTRU                                          0645
         MVC   DARGSENT(1,@08),STATFLG2                            0645
*        DARGSMOD = STMODID;                                       0646
         MVC   DARGSMOD(3,@08),STMODID                             0646
*        LASTCC   = STATFLG1;                                      0647
         L     @15,@PC00001+8                                      0647
         SLR   @14,@14                                             0647
         IC    @14,STATFLG1                                        0647
         STH   @14,LASTCC(,@15)                                    0647
*        DARGDBP  = ADDR(LASTCC);                                  0648
         ST    @15,DARGDBP(,@08)                                   0648
*        DARGILP  = LENGTH(LASTCC);                                0649
         MVC   DARGILP(2,@08),@CH00153                             0649
*        IF GDTECT ^= 0 & LASTCC > 0                               0650
*          THEN                                                    0650
         SLR   @15,@15                                             0650
         L     @07,@PC00001                                        0650
         C     @15,GDTECT(,@07)                                    0650
         BE    @RF00650                                            0650
         CR    @14,@15                                             0650
         BNH   @RF00650                                            0650
*            DARGSENT = 15; /*ISSUE BRIEF MSG FOR TSO USER   @Y30SSEC*/
*                                                                  0651
         MVI   DARGSENT(@08),X'0F'                                 0651
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0652
*                                                                  0652
@RF00650 L     @08,@PC00001                                        0652
         ST    @08,@AL00001                                        0652
         LA    @15,@CF00115                                        0652
         ST    @15,@AL00001+4                                      0652
         LA    @15,DDSTRU                                          0652
         ST    @15,@AL00001+8                                      0652
         MVI   @AL00001+8,X'80'                                    0652
         L     @15,GDTPRT(,@08)                                    0652
         LA    @01,@AL00001                                        0652
         BALR  @14,@15                                             0652
*        /************************************************************/
*        /*                                                          */
*        /*     RETURN TO INVOKER OF IDCRP01                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0653
*        CALL IDCSAEP0(GDTTBL,MODID);                              0653
         L     @08,@PC00001                                        0653
         ST    @08,@AL00001                                        0653
         LA    @15,MODID                                           0653
         ST    @15,@AL00001+4                                      0653
         MVI   @AL00001+4,X'80'                                    0653
         L     @15,GDTEPL(,@08)                                    0653
         LA    @01,@AL00001                                        0653
         BALR  @14,@15                                             0653
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DELIMSET                                        */
*/*                                                                  */
*/* FUNCTION - DELIMSET ESTABLISHES THE BOUNDARIES FOR  COPYING A    */
*/*            SUBSET OF THE INPUT DATASET.                          */
*/*            BEGINNING AND/OR ENDING DELIMITERS SERVE TO SUBSET    */
*/*            THE DATA SET.  THESE DELIMITERS MAY BE IN THE FORM    */
*/*            OF KEYS, RBA'S, RECORD NUMBERS OR A RECORD COUNT      */
*/*                                                                  */
*/*            BEGINNING DELIMITERS:                                 */
*/*              FROMKEY - ISAM OR VSAM KEY AT WHICH COPYING BEGINS  */
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */
*/*              FROMADDRESS - RBA AT WHICH  COPYING IS TO BEGIN.    */
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */
*/*              FROMNUMBER - RELATIVE RECORD NUMBER AT      @Y30SSJH*/
*/*                WHICH COPYING IS TO BEGIN.                @Y30SSJH*/
*/*                POSITIONING VIA THE IDCAMS UPOSIT MACRO.  @Y30SSJH*/
*/*              SKIP - NUMBER OF LOGICAL RECORDS TO BE SKIPPED      */
*/*                BEFORE  COPYING IS BEGUN. DELIMSET EXECUTES A     */
*/*                LOOP OF UGET REQUESTS TO EFFECT POSITIONING       */
*/*                OR ISSUES A UPOSIT IF THE DATA SET IS     @Y30SSJH*/
*/*                RELATIVE RECORD                           @Y30SSJH*/
*/*                                                                  */
*/*            ENDING DELIMITERS:                                    */
*/*              TOKEY - KEY OF THE LAST RECORD TO BE  COPIED.       */
*/*                POSKYVAL IS SET TO THE VALUE OF THE KEY. IDCRP01  */
*/*                USES THIS VALUE TO CONTROL THE UGET/UPRINT LOOP.  */
*/*              TOADDRESS - THE RBA OF THE LAST VSAM RECORD TO BE   */
*/*                COPIED . POSRBADD IS SET TO THE THE VALUE OF THE  */
*/*                RBA. IDCRP01 USES THIS VALUE TO CONTROL THE       */
*/*                UGET/UPUT LOOP.                                   */
*/*              TONUMBER - RELATIVE RECORD NUMBER OF THE    @Y30SSJH*/
*/*                RECORD TO BE COPIED.                      @Y30SSJH*/
*/*              COUNT - NUMBER OF LOGICAL RECORDS TO BE  COPIED.    */
*/*                LOOPCNT IS SET TO CONTROL THE UGET/UPUT   LOOP IN */
*/*                IDCRP01.                                          */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      DELIMSET REFERENCES THE FDTTBL AND USES THE IOCS TO EFFECT  */
*/*      'UPOSIT' POSITIONING.                                       */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      DELMFLG - INDICATES KEY, RELATIVE RECORD NUMBER   /*@Y30SSJH*/
*/*      OR RBA DELIMITER                                  /*@Y30SSJH*/
*/*      DELMCNT - INDICATES NUMBER OF RECORDS TO BE PROCESSED       */
*/*      DELMINCR - UGET/UPUT  LOOP INCREMENT WHEN AN EXPLICIT       */
*/*                 NUMBER OF RECORDS ARE TO BE  COPIED              */
*/*      STATFLG - INDICATES THE TERMINATION CONDITION OF DELIMSET   */
*/*                                                                  */
*/********************************************************************/
*DELIMSET:                                                         0654
*        PROCEDURE (DELMFLG,DELMCNT,DELMINCR);                     0654
@EL00001 L     @13,4(,@13)                                         0654
@EF00001 L     @00,@SIZDATD                                        0654
         LR    @01,@12                                             0654
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0654
         BR    @14                                                 0654
DELIMSET STM   @14,@12,@SA00002                                    0654
         MVC   @PC00002(12),0(@01)                                 0654
*        /************************************************************/
*        /*                                                          */
*        /* ARGUMENTS OF INVOCATION (DEFINITIONS IN PROLOGUE)        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0655
*        DCL                                                       0655
*          DELMFLG   CHAR(1),                                      0655
*          DELMCNT   FIXED(31),                                    0655
*          DELMINCR  FIXED(15);                                    0655
*                                                                  0655
*        /************************************************************/
*        /*                                                          */
*        /* LOOP CONTROL VARIABLES TO SKIP TO BEGINNING OF SUBSET    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0656
*        DCL                                                       0656
*          SKIPFLAG  CHAR(1),          /* BEGINNING POSITION FLAG    */
*          SKIPLOOP  FIXED(31);        /* # OF RECORDS TO BE SKIPPED */
*                                                                  0656
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VARIABLES FOR VALIDITY ERROR MESSAGE             @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0657
*        DCL                                                       0657
*          MSGARY(6)  CHAR(11)                                     0657
*            INIT('FROMKEY' , 'TOKEY' , 'FROMADDRESS' ,            0657
*                 'TOADDRESS' , 'FROMNUMBER' , 'TONUMBER' ),       0657
*          MSGINDX    FIXED(31) ,                                  0657
*          MSGENTRY   PTR(8)      INIT(17);                /*@Y30SSLO*/
*                                                                  0657
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO DELIMSET- INTERNAL PROCEDURE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0658
*        OLDERID2 = NEWERID2;                                      0658
         L     @08,@PC00001                                        0658
         L     @08,GDTTR2(,@08)                                    0658
         MVC   @TS00001(95),NEWERID2(@08)                          0658
         MVC   OLDERID2(95,@08),@TS00001                           0658
*        NEWID2 = 'RP21';                                  /*@Y30SSLO*/
         MVC   NEWID2(4,@08),@CC01180                              0659
*        DELMFLG = STOP;                                           0660
         L     @08,@PC00002                                        0660
         MVI   DELMFLG(@08),X'0F'                                  0660
*        SKIPFLAG = GO;                                            0661
         MVI   SKIPFLAG,X'00'                                      0661
*        TESTRC = 0;                                               0662
         SLR   @08,@08                                             0662
         STH   @08,TESTRC                                          0662
*        DELMINCR = 0;                                             0663
         L     @03,@PC00002+8                                      0663
         STH   @08,DELMINCR(,@03)                                  0663
*        DELMCNT = 2;                                              0664
         L     @03,@PC00002+4                                      0664
         MVC   DELMCNT(4,@03),@CF00153                             0664
*        MSGINDX = 0;                                      /*@Y30SSJH*/
*                                                                  0665
         SLR   MSGINDX,MSGINDX                                     0665
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* DATA TYPE VALIDITY CHECKING:                     @Y30SSJH*/
*        /*   FMKEY/TOKEY INVALID WITH RRDS,                 @Y30SSJH*/
*        /*   FMRBA/TORBA INVALID WITH RRDS,                 @Y30SSJH*/
*        /*   FMNUM VALID ONLY WITH RRDS,                    @Y30SSJH*/
*        /*   TONUM VALID ONLY WITH RRDS.                    @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0666
*        IF (ADDR(FMKYC) ^= NULLPTR  &                             0666
*            IOCMACRR = ON )                                       0666
*          THEN                                                    0666
         L     @03,@PC00001+4                                      0666
         C     @08,FDTPTR+8(,@03)                                  0666
         BE    @RF00666                                            0666
         L     @08,IOCSPTR                                         0666
         TM    IOCMACRR(@08),B'00100000'                           0666
         BNO   @RF00666                                            0666
*            MSGINDX = 1;                                  /*@Y30SSJH*/
         LA    MSGINDX,1                                           0667
*          ELSE                                                    0668
*            IF (ADDR(TOKYC) ^= NULLPTR  &                         0668
*                IOCMACRR = ON)                                    0668
*              THEN                                                0668
         B     @RC00666                                            0668
@RF00666 L     @08,@PC00001+4                                      0668
         L     @08,FDTPTR+20(,@08)                                 0668
         LTR   @08,@08                                             0668
         BZ    @RF00668                                            0668
         L     @08,IOCSPTR                                         0668
         TM    IOCMACRR(@08),B'00100000'                           0668
         BNO   @RF00668                                            0668
*                MSGINDX = 2;                              /*@Y30SSJH*/
         LA    MSGINDX,2                                           0669
*              ELSE                                                0670
*                IF (ADDR(FMRBA) ^= NULLPTR  &                     0670
*                  IOCMACRR = ON)                                  0670
*                  THEN                                            0670
         B     @RC00668                                            0670
@RF00668 L     @08,@PC00001+4                                      0670
         L     @08,FDTPTR+12(,@08)                                 0670
         LTR   @08,@08                                             0670
         BZ    @RF00670                                            0670
         L     @08,IOCSPTR                                         0670
         TM    IOCMACRR(@08),B'00100000'                           0670
         BNO   @RF00670                                            0670
*                    MSGINDX = 3;                          /*@Y30SSJH*/
         LA    MSGINDX,3                                           0671
*                  ELSE                                            0672
*                    IF (ADDR(TORBA) ^= NULLPTR  &                 0672
*                        IOCMACRR= ON)                             0672
*                      THEN                                        0672
         B     @RC00670                                            0672
@RF00670 L     @08,@PC00001+4                                      0672
         L     @08,FDTPTR+24(,@08)                                 0672
         LTR   @08,@08                                             0672
         BZ    @RF00672                                            0672
         L     @08,IOCSPTR                                         0672
         TM    IOCMACRR(@08),B'00100000'                           0672
         BNO   @RF00672                                            0672
*                        MSGINDX = 4;                      /*@Y30SSJH*/
         LA    MSGINDX,4                                           0673
*                      ELSE                                        0674
*                        IF (ADDR(FMNUM) ^= NULLPTR  &             0674
*                            IOCMACRR = OFF)                       0674
*                          THEN                                    0674
         B     @RC00672                                            0674
@RF00672 L     @08,@PC00001+4                                      0674
         L     @08,FDTPTR+48(,@08)                                 0674
         LTR   @08,@08                                             0674
         BZ    @RF00674                                            0674
         L     @08,IOCSPTR                                         0674
         TM    IOCMACRR(@08),B'00100000'                           0674
         BNZ   @RF00674                                            0674
*                            MSGINDX = 5;                  /*@Y30SSJH*/
         LA    MSGINDX,5                                           0675
*                          ELSE                                    0676
*                            IF (ADDR(TONUM) ^= NULLPTR  &         0676
*                                IOCMACRR = OFF)                   0676
*                              THEN                                0676
         B     @RC00674                                            0676
@RF00674 L     @08,@PC00001+4                                      0676
         L     @08,FDTPTR+52(,@08)                                 0676
         LTR   @08,@08                                             0676
         BZ    @RF00676                                            0676
         L     @08,IOCSPTR                                         0676
         TM    IOCMACRR(@08),B'00100000'                           0676
         BNZ   @RF00676                                            0676
*                                MSGINDX = 6;              /*@Y30SSJH*/
         LA    MSGINDX,6                                           0677
*                              ELSE;                       /*@Y30SSJH*/
*                                                                  0678
@RF00676 DS    0H                                                  0679
*                                                                  0679
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* WRITE MESSAGE INDICATING INVALID USE OF          @Y30SSJH*/
*        /* DELIMITERS                                       @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0679
*        IF MSGINDX ^= 0                                           0679
*          THEN                                                    0679
@RC00674 DS    0H                                                  0679
@RC00672 DS    0H                                                  0679
@RC00670 DS    0H                                                  0679
@RC00668 DS    0H                                                  0679
@RC00666 LTR   MSGINDX,MSGINDX                                     0679
         BZ    @RF00679                                            0679
*            DO;                                           /*@Y30SSJH*/
*                                                                  0680
*            STATFLG = TERMERR;                            /*@Y30SSJH*/
         MVC   STATFLG(5),@CB00819                                 0681
*            DARGL = ''B;                                  /*@Y30SSLO*/
         XC    DARGL(28),DARGL                                     0682
*            DARGSENT = MSGENTRY;                          /*@Y30SSJH*/
         L     @08,DDSTRU                                          0683
         MVC   DARGSENT(1,@08),MSGENTRY                            0683
*            DARGSMOD = 'PR0';                             /*@Y30SSJH*/
         MVC   DARGSMOD(3,@08),@CC01129                            0684
*            DARGCNT = 1;                                  /*@Y30SSJH*/
         LA    @03,1                                               0685
         STH   @03,DARGCNT(,@08)                                   0685
*            DARGINS(1) = 1;                               /*@Y30SSLO*/
         STH   @03,DARGINS(,@08)                                   0686
*            DARGINL(1) = LENGTH(MSGARY(1));               /*@Y30SSLO*/
         LA    @03,11                                              0687
         STH   @03,DARGINL(,@08)                                   0687
*            DARGDTM(1) = ADDR(MSGARY(MSGINDX));           /*@Y30SSLO*/
*                                                                  0688
         LR    @01,@03                                             0688
         MR    @00,MSGINDX                                         0688
         LA    @03,MSGARY-11(@01)                                  0688
         ST    @03,DARGDTM(,@08)                                   0688
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/
*                                                                  0689
         L     @08,@PC00001                                        0689
         ST    @08,@AL00001                                        0689
         LA    @03,@CF00115                                        0689
         ST    @03,@AL00001+4                                      0689
         LA    @03,DDSTRU                                          0689
         ST    @03,@AL00001+8                                      0689
         MVI   @AL00001+8,X'80'                                    0689
         L     @15,GDTPRT(,@08)                                    0689
         LA    @01,@AL00001                                        0689
         BALR  @14,@15                                             0689
*            END;                                          /*@Y30SSJH*/
*                                                                  0690
*        /************************************************************/
*        /*                                                          */
*        /* POSITION TO THE BEGINNING OF THE SUBSET OF THE DATASET   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0691
*        IF ((ADDR(FMKYC)) ^= NULLPTR  ×                   /*@Y30SSJH*/
*            (ADDR(FMRBA)) ^= NULLPTR ×                    /*@Y30SSJH*/
*            (ADDR(FMNUM)) ^= NULLPTR )  &                 /*@Y30SSJH*/
*           MSGINDX = 0                                            0691
*                                                                  0691
*          /**********************************************************/
*          /*                                                        */
*          /* POSITION BY KEY, RBA OR RECORD NUMBER        /*@Y30SSJH*/
*          /*                                                        */
*          /**********************************************************/
*          THEN                                                    0691
@RF00679 SLR   @08,@08                                             0691
         L     @03,@PC00001+4                                      0691
         C     @08,FDTPTR+8(,@03)                                  0691
         BNE   @GL00055                                            0691
         C     @08,FDTPTR+12(,@03)                                 0691
         BNE   @GL00055                                            0691
         C     @08,FDTPTR+48(,@03)                                 0691
         BE    @RF00691                                            0691
@GL00055 SLR   @08,@08                                             0691
         CR    MSGINDX,@08                                         0691
         BNE   @RF00691                                            0691
*            DO;                                                   0692
*                                                                  0692
*            /********************************************************/
*            /*                                                      */
*            /* SET UP FOR KEY POSITIONING                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0693
*            IF (ADDR(FMKYC)) ^= NULLPTR                   /*@Y30SSJH*/
*              THEN                                                0693
         L     @03,@PC00001+4                                      0693
         L     @03,FDTPTR+8(,@03)                                  0693
         CR    @03,@08                                             0693
         BE    @RF00693                                            0693
*                DO;                                               0694
*                                                                  0694
*                IOCKYA = ADDR(FMKYCVAL);                          0695
         L     @08,IOCSPTR                                         0695
         LA    @15,FMKYCVAL(,@03)                                  0695
         ST    @15,IOCKYA(,@08)                                    0695
*                IOCPTL = FMKYCLEN;                                0696
*                                                                  0696
         SLR   @15,@15                                             0696
         IC    @15,FMKYCLEN(,@03)                                  0696
         STH   @15,IOCPTL(,@08)                                    0696
*                END;                                              0697
*                                                                  0697
*              /******************************************************/
*              /*                                                    */
*              /* SET UP FOR RBA POSITIONING                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0698
*              ELSE                                                0698
*                IF (ADDR(FMNUM)) ^= NULLPTR               /*@Y30SSJH*/
*                  THEN                                            0698
         B     @RC00693                                            0698
@RF00693 L     @08,@PC00001+4                                      0698
         L     @08,FDTPTR+48(,@08)                                 0698
         LTR   @08,@08                                             0698
         BZ    @RF00698                                            0698
*                    IOCREL = FMNUMVAL;                    /*@Y30SSJH*/
         L     @03,IOCSPTR                                         0699
         MVC   IOCREL(4,@03),FMNUMVAL(@08)                         0699
*                  ELSE                                            0700
*                IOCRBA = FMRBAVAL;                                0700
*                                                                  0700
         B     @RC00698                                            0700
@RF00698 L     @08,@PC00001+4                                      0700
         L     @08,FDTPTR+12(,@08)                                 0700
         L     @03,IOCSPTR                                         0700
         MVC   IOCRBA(4,@03),FMRBAVAL(@08)                         0700
*            CALL IDCIOPO0(GDTTBL,IOCSPTR);                        0701
*                                                                  0701
@RC00698 DS    0H                                                  0701
@RC00693 L     @08,@PC00001                                        0701
         ST    @08,@AL00001                                        0701
         LA    @03,IOCSPTR                                         0701
         ST    @03,@AL00001+4                                      0701
         MVI   @AL00001+4,X'80'                                    0701
         L     @15,GDTPOS(,@08)                                    0701
         LA    @01,@AL00001                                        0701
         BALR  @14,@15                                             0701
*            RESPECIFY RTNREG RSTD;                                0702
*            TESTRC = RTNREG;                                      0703
         STH   RTNREG,TESTRC                                       0703
*            RESPECIFY RTNREG UNRSTD;                              0704
*                                                                  0704
*            END;                                                  0705
*                                                                  0706
*          /**********************************************************/
*          /*                                                        */
*          /* POSITION BY SKIPPING TO BEGINING OF SUBSET, VIA A      */
*          /* REPETITION OF UGET REQUESTS EQUAL TO THE NUMBER OF     */
*          /* RECORDS TO BE SKIPPED.                                 */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    0706
*            IF MSGINDX = 0                                        0706
*              THEN                                                0706
         B     @RC00691                                            0706
@RF00691 SLR   @08,@08                                             0706
         CR    MSGINDX,@08                                         0706
         BNE   @RF00706                                            0706
*                DO;                                       /*@Y30SSJH*/
*                IF (ADDR(SKIP)) ^= NULLPTR                /*@Y30SSJH*/
*                  THEN                                            0708
         L     @03,@PC00001+4                                      0708
         L     @03,FDTPTR+16(,@03)                                 0708
         CR    @03,@08                                             0708
         BE    @RF00708                                            0708
*                    IF IOCMACRR = ON                              0709
*                      THEN                                        0709
         L     @08,IOCSPTR                                         0709
         TM    IOCMACRR(@08),B'00100000'                           0709
         BNO   @RF00709                                            0709
*                        DO;                               /*@Y30SSJH*/
*                                                                  0710
*                        IOCREL = SKIPVAL + 1;             /*@Y30SSJH*/
*                                                                  0711
         LA    @15,1                                               0711
         AL    @15,SKIPVAL(,@03)                                   0711
         ST    @15,IOCREL(,@08)                                    0711
*                        CALL IDCIOPO0(GDTTBL,IOCSPTR);    /*@Y30SSJH*/
         L     @08,@PC00001                                        0712
         ST    @08,@AL00001                                        0712
         LA    @03,IOCSPTR                                         0712
         ST    @03,@AL00001+4                                      0712
         MVI   @AL00001+4,X'80'                                    0712
         L     @15,GDTPOS(,@08)                                    0712
         LA    @01,@AL00001                                        0712
         BALR  @14,@15                                             0712
*                        RESPECIFY RTNREG RSTD;                    0713
*                        TESTRC = RTNREG;                          0714
         STH   RTNREG,TESTRC                                       0714
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSJH*/
*                                                                  0715
*                        END;                              /*@Y30SSJH*/
*                      ELSE                                        0717
*                        DO SKIPLOOP= 1 TO SKIPVAL                 0717
*                          WHILE SKIPFLAG = GO;            /*@Y30SSJH*/
*                                                                  0717
         B     @RC00709                                            0717
@RF00709 LA    SKIPLOOP,1                                          0717
         B     @DE00717                                            0717
@DL00717 CLI   SKIPFLAG,X'00'                                      0717
         BNE   @DC00717                                            0717
*                          CALL IDCIOGT0(GDTTBL,IOCSPTR);  /*@Y30SSJH*/
         L     @08,@PC00001                                        0718
         ST    @08,@AL00001                                        0718
         LA    @04,IOCSPTR                                         0718
         ST    @04,@AL00001+4                                      0718
         MVI   @AL00001+4,X'80'                                    0718
         L     @15,GDTGET(,@08)                                    0718
         LA    @01,@AL00001                                        0718
         BALR  @14,@15                                             0718
*                          RESPECIFY RTNREG RSTD;                  0719
*                          TESTRC = RTNREG;                        0720
         STH   RTNREG,TESTRC                                       0720
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30SSJH*/
*                                                                  0721
*                          /******************************************/
*                          /*                                @Y30SSJH*/
*                          /* FAILURE IN SKIPPING WILL CAUSE A       */
*                          /* TERMINAL ERROR                 @Y30SSJH*/
*                          /*                                @Y30SSJH*/
*                          /******************************************/
*                                                                  0722
*                          IF TESTRC ^= 0                          0722
*                            THEN                                  0722
         LH    @08,TESTRC                                          0722
         LTR   @08,@08                                             0722
         BZ    @RF00722                                            0722
*                              SKIPFLAG = STOP;            /*@Y30SSJH*/
*                                                                  0723
         MVI   SKIPFLAG,X'0F'                                      0723
*                        END;                              /*@Y30SSJH*/
@RF00722 AH    SKIPLOOP,@CH00219                                   0724
@DE00717 L     @08,@PC00001+4                                      0724
         L     @08,FDTPTR+16(,@08)                                 0724
         C     SKIPLOOP,SKIPVAL(,@08)                              0724
         BNH   @DL00717                                            0724
@DC00717 DS    0H                                                  0725
*                END;                                      /*@Y30SSJH*/
@RC00709 DS    0H                                                  0725
@RF00708 DS    0H                                                  0726
*        /************************************************************/
*        /*                                                          */
*        /* INSURE BEGINNING DELIMITER HAS BEEN SUCCESSFULLY SET     */
*        /* BEFORE SETTING THE ENDING DELIMITER                      */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC = 0  & MSGINDX = 0                              0726
*          THEN                                                    0726
@RF00706 DS    0H                                                  0726
@RC00691 SLR   @08,@08                                             0726
         CH    @08,TESTRC                                          0726
         BNE   @RF00726                                            0726
         CR    MSGINDX,@08                                         0726
         BNE   @RF00726                                            0726
*            DO;                                                   0727
*                                                                  0727
*                                                                  0727
*            /********************************************************/
*            /*                                                      */
*            /* SET ENDING KEY DELIMITER FLAG                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0728
*            IF (ADDR(TOKYC)) ^= NULLPTR                   /*@Y30SSJH*/
*              THEN                                                0728
         L     @15,@PC00001+4                                      0728
         C     @08,FDTPTR+20(,@15)                                 0728
         BE    @RF00728                                            0728
*                DELIMFLG = TOKYPOST;                              0729
*                                                                  0729
         MVI   DELIMFLG,X'02'                                      0729
*              ELSE                                                0730
*                /****************************************************/
*                /*                                                  */
*                /* SET ENDING RBA DELIMITER FLAG                    */
*                /*                                                  */
*                /****************************************************/
*                                                                  0730
*                IF (ADDR(TORBA)) ^= NULLPTR               /*@Y30SSJH*/
*                  THEN                                            0730
         B     @RC00728                                            0730
@RF00728 L     @08,@PC00001+4                                      0730
         L     @08,FDTPTR+24(,@08)                                 0730
         LTR   @08,@08                                             0730
         BZ    @RF00730                                            0730
*                    DELIMFLG = TORBAPOS;                          0731
*                                                                  0731
         MVI   DELIMFLG,X'03'                                      0731
*                  /**************************************************/
*                  /*                                        @Y30SSJH*/
*                  /* SET ENDING RECORD NUMBER  FLAG         @Y30SSJH*/
*                  /*                                        @Y30SSJH*/
*                  /**************************************************/
*                                                                  0732
*                  ELSE                                            0732
*                    IF (ADDR(TONUM)) ^= NULLPTR           /*@Y30SSJH*/
*                      THEN                                        0732
         B     @RC00730                                            0732
@RF00730 L     @08,@PC00001+4                                      0732
         L     @08,FDTPTR+52(,@08)                                 0732
         LTR   @08,@08                                             0732
         BZ    @RF00732                                            0732
*                        DELIMFLG = TORRNPOS;              /*@Y30SSJH*/
         MVI   DELIMFLG,X'04'                                      0733
*                    /************************************************/
*                    /*                                              */
*                    /* SET LOOP CONTROL FOR COPYING AN EXPLICIT     */
*                    /* NUMBER OR RECORDS                            */
*                    /* . DELMCNT - # OF RECORDS TO BE COPIED        */
*                    /* . DELMINCR - LOOP CONTROL INCREMENT, THIS    */
*                    /*   VALUE ENABLES LOOP CONTROL OF THE COUNT    */
*                    /*   PROCESSING IN CPYLOOPB.                    */
*                    /*                                              */
*                    /************************************************/
*                                                                  0734
*                    IF (ADDR(COUNT)) ^= NULLPTR           /*@Y30SSJH*/
*                      THEN                                        0734
@RF00732 DS    0H                                                  0734
@RC00730 DS    0H                                                  0734
@RC00728 L     @08,@PC00001+4                                      0734
         L     @08,FDTPTR+28(,@08)                                 0734
         LTR   @08,@08                                             0734
         BZ    @RF00734                                            0734
*                        DO;                                       0735
*                                                                  0735
*                        DELMCNT = COUNTVAL;                       0736
         L     @15,@PC00002+4                                      0736
         MVC   DELMCNT(4,@15),COUNTVAL(@08)                        0736
*                        DELMINCR = 1;                             0737
*                                                                  0737
         L     @08,@PC00002+8                                      0737
         MVC   DELMINCR(2,@08),@CH00219                            0737
*                        END;                                      0738
*                                                                  0738
*            END;                                                  0739
*          /**********************************************************/
*          /*                                                        */
*          /* BEGINNING POSITIONING FAILED                           */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    0740
*            IF MSGINDX = 0                                        0740
*              THEN                                                0740
         B     @RC00726                                            0740
@RF00726 LTR   MSGINDX,MSGINDX                                     0740
         BNZ   @RF00740                                            0740
*                DO;                                       /*@Y30SSJH*/
*                                                                  0741
*                STATFLG = POSITERR;                       /*@Y30SSJH*/
*                                                                  0742
         MVC   STATFLG(5),@CB00822                                 0742
*                END;                                      /*@Y30SSJH*/
*                                                                  0743
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO INVOKER OF DELIMSET                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0744
*        RETURN ;                                                  0744
@EL00002 DS    0H                                                  0744
@EF00002 DS    0H                                                  0744
@ER00002 LM    @14,@12,@SA00002                                    0744
         BR    @14                                                 0744
*END DELIMSET;                                                     0745
*                                                                  0745
         B     @EL00002                                            0745
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - CATRELOD                                @OZ00751*/
*/*                                                          @OZ00751*/
*/* FUNCTION - CATRELOD RECEIVES CONTROL FROM IDCRP01;THE    @OZ00751*/
*/*            FUNCTIONS PERFORMED ARE:                      @OZ00751*/
*/*              1 - VERIFY THAT BACKUP AND TARGET MATCH     @OZ00751*/
*/*                  WITH RESPECT TO NAME,VOLSER AND DEVICE  @OZ00751*/
*/*                  TYPE                                    @OZ00751*/
*/*              2   VERIFY THAT THERE IS ENOUGH SPACE TO    @OZ00751*/
*/*                  COPY THE CATALOG.                       @OZ00751*/
*/*              3 - BUILD CI TRANSLATE TABLE FROM BACKUP    @OZ00751*/
*/*                  AND TARGET HEADERS                      @OZ00751*/
*/*                                                                  */
*/*              4 - COPY THE BACKUP TO THE TARGET CATALOG   @OZ00751*/
*/*                  AND TRANSLATE THE INTERNAL CI# POINTERS.@OZ00751*/
*/*              5   AT END OF FILE AN UPDATED CATALOG       @OZ00751*/
*/*                  CONTROL RECORD IS WRITTEN.              @OZ00751*/
*/*                                                                  */
*/*  INPUT - THE OUTPUT DATA SET IS OPENED FOR OUTPUT AND    @OZ00751*/
*/*          UPDATE AND IS POSITIONED AT THE FIRST RECORD    @OZ00751*/
*/*          THE INPUT DATA SET IS OPEN AND SIMILARLY        @OZ00751*/
*/*          POSITIONED.                                     @OZ00751*/
*/*                                                                  */
*/* OUTPUT - THE INPUT DATA SET (THE BACKUP CATALOG) HAS     @OZ00751*/
*/*          BEEN COPIED (RELOADED) TO THE OUTPUT (THE TARGET@OZ00751*/
*/*          CATALOG) DATA SET.                              @OZ00751*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0746
*CATRELOD:                                                         0746
*        PROCEDURE;                                        /*@OZ00751*/
*                                                                  0746
CATRELOD STM   @14,@12,@SA00003                                    0746
*        OLDERID2 = NEWERID2;                                      0747
         L     @08,@PC00001                                        0747
         L     @08,GDTTR2(,@08)                                    0747
         MVC   @TS00001(95),NEWERID2(@08)                          0747
         MVC   OLDERID2(95,@08),@TS00001                           0747
*        NEWID2='RPT1';                                    /*@OZ00751*/
*                                                                  0748
         MVC   NEWID2(4,@08),@CC01184                              0748
*        K = NULL;                       /*ZERO MSG COUNTER  @OZ00751*/
         SLR   K,K                                                 0749
*        CFROLD = NULL;                 /*ZERO OLD CI STORE  @OZ00751*/
*                                                                  0750
*                                                                  0750
         SLR   @08,@08                                             0750
         ST    @08,@TF00001                                        0750
         MVC   CFROLD(3),@TF00001+1                                0750
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /*BEFORE STARTING UPDATTING OF THE TARGET THERE ARE @OZ00751*/
*        /* SEVERAL CHECKS TO BE MADE AND INFORMATION TO BE  @OZ00751*/
*        /* OBTAINED.                                        @OZ00751*/
*        /* 1 CHECK THAT TARGET HAS ENOUGH SPACE ALLOCATED.  @OZ00751*/
*        /* 2 CHECK THAT TARGET AND BACKUP NAMES AGREE.      @OZ00751*/
*        /* 3 MAP THE TRUENAME EXTENTS OF BACKUP AND TARGET. @OZ00751*/
*        /* 4 CHECK THAT THE VOLSER AND DEVTYPES AGREE.      @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0751
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /*POSITION TO THE THIRD RECORD ON BACKUP AND TARGET @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0751
*        DO I = 1 TO 3 WHILE TESTRC = 0;                   /*@OZ00751*/
*                                                                  0751
         LA    I,1                                                 0751
@DL00751 LH    @08,TESTRC                                          0751
         LTR   @08,@08                                             0751
         BNZ   @DC00751                                            0751
*          CALL GETPAIR;                                   /*@OZ00751*/
*                                                                  0752
         BAL   @14,GETPAIR                                         0752
*        END;                                              /*@OZ00751*/
*                                                                  0753
         AH    I,@CH00219                                          0753
         CH    I,@CH00162                                          0753
         BNH   @DL00751                                            0753
@DC00751 DS    0H                                                  0754
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* THESE NEXT RECORDS ARE THE CLUSTER RECORD FOR    @OZ00751*/
*        /* THE CATALOG. THE NAMES ARE COMPARED AND IF THEY  @OZ00751*/
*        /* DO NOT MATCH THEN A MESSAGE IS PRINTED AND       @OZ00751*/
*        /* TERMINAL ERROR IS SET                            @OZ00751*/
*        /* IF THE INPUT IS NOT POSITIONED AT THE THIRD      @OZ00751*/
*        /* RECORD THEN THE RETURN CODE IS SET NON ZERO.     @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0754
*        IF TESTRC = 0                                             0754
*          THEN                                                    0754
         LH    @08,TESTRC                                          0754
         LTR   @08,@08                                             0754
         BNZ   @RF00754                                            0754
*            DO;                                           /*@OZ00751*/
*                                                                  0755
*            IF IOCSINP -> IOCDAD -> RCDCINO ^= 2                  0756
*              THEN                                                0756
         L     @08,IOCSINP                                         0756
         L     @08,IOCDAD(,@08)                                    0756
         CLC   RCDCINO(3,@08),@CF00153+1                           0756
         BE    @RF00756                                            0756
*                TESTRC = 4;                               /*@OZ00751*/
*                                                                  0757
         MVC   TESTRC(2),@CH00042                                  0757
*            IF IOCSINP -> IOCDAD -> ENTNAME ^=                    0758
*               IOCSOUP -> IOCDAD -> ENTNAME                       0758
*              THEN                                                0758
@RF00756 L     @08,IOCSINP                                         0758
         L     @08,IOCDAD(,@08)                                    0758
         L     @04,IOCSOUP                                         0758
         L     @04,IOCDAD(,@04)                                    0758
         CLC   ENTNAME(44,@08),ENTNAME(@04)                        0758
         BE    @RF00758                                            0758
*                DO;                                       /*@OZ00751*/
*                                                                  0759
*                STATFLG = TERMERR;                        /*@OZ00751*/
         MVC   STATFLG(5),@CB00819                                 0760
*                DARGLIST = ''B;                           /*@OZ00751*/
         L     @08,DDSTRU                                          0761
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0761
*                DARGSMOD = 'PR0';                         /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            0762
*                DARGSENT = 21;                            /*@OZ00751*/
         MVI   DARGSENT(@08),X'15'                                 0763
*                DARGDBP = ADDR(CNAME);                    /*@Y30SSEC*/
         LA    @04,CNAME                                           0764
         ST    @04,DARGDBP(,@08)                                   0764
*                DARGILP = LENGTH(CNAME);                  /*@Y30SSEC*/
*                                                                  0765
         MVC   DARGILP(2,@08),@CH00156                             0765
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@OZ00751*/
*                                                                  0766
         L     @08,@PC00001                                        0766
         ST    @08,@AL00001                                        0766
         LA    @04,@CF00115                                        0766
         ST    @04,@AL00001+4                                      0766
         LA    @04,DDSTRU                                          0766
         ST    @04,@AL00001+8                                      0766
         MVI   @AL00001+8,X'80'                                    0766
         L     @15,GDTPRT(,@08)                                    0766
         LA    @01,@AL00001                                        0766
         BALR  @14,@15                                             0766
*                END;                                      /*@OZ00751*/
*                                                                  0767
*            END;                                          /*@OZ00751*/
*                                                                  0768
@RF00758 DS    0H                                                  0769
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* STORE CATALOG CONTROL RECORD FOR LATER USE       @OZ00751*/
*        /*                                                  @OZ00751*/
*        /***********************************************************/
*                                                                  0769
*        IF TESTRC = 0                                             0769
*          THEN                                                    0769
@RF00754 LH    @08,TESTRC                                          0769
         LTR   @08,@08                                             0769
         BNZ   @RF00769                                            0769
*            DO;                                           /*@OZ00751*/
*                                                                  0770
*            CALL GETPAIR;                                 /*@OZ00751*/
         BAL   @14,GETPAIR                                         0771
*            CCRECSTR = IOCSINP -> IOCDAD -> CATLREC(1:51);/*@OZ00751*/
*                                                                  0772
         L     @08,IOCSINP                                         0772
         L     @08,IOCDAD(,@08)                                    0772
         MVC   CCRECSTR(51),CATLREC(@08)                           0772
*        /************************************************************/
*        /*                                                  @OZ20462*/
*        /* SAVE NEXT AVAILABLE CI IN OUTPUT CATALG          @OZ20462*/
*        /*                                                  @OZ20462*/
*        /***********************************************************/
*                                                                  0773
*            OCCRNFCI = IOCSOUP -> IOCDAD -> CCRNFCI;      /*@OZ20462*/
*                                                                  0773
         L     @08,IOCSOUP                                         0773
         L     @08,IOCDAD(,@08)                                    0773
         MVC   OCCRNFCI(1),CCRNFCI+2(@08)                          0773
*            END;                                          /*@OZ00751*/
*                                                                  0774
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /*READ TO RECORD 5 ON BACKUP AND TARGET             @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0775
*        DO I = 1 TO 2;                                    /*@OZ00751*/
*                                                                  0775
@RF00769 LA    I,1                                                 0775
@DL00775 DS    0H                                                  0776
*          CALL GETPAIR;                                   /*@OZ00751*/
*                                                                  0776
         BAL   @14,GETPAIR                                         0776
*        END;                                              /*@OZ00751*/
*                                                                  0777
         AH    I,@CH00219                                          0777
         CH    I,@CH00153                                          0777
         BNH   @DL00775                                            0777
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* STORE FROM RECORD 5 THE HIGH USED AND HIGH       @OZ00751*/
*        /* ALLOCATED RBA'S OF THE BACKUP AND TARGET         @OZ00751*/
*        /* RESPECTIVELY.                                    @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0778
*        IF TESTRC = 0                                             0778
*          THEN                                                    0778
         LH    @08,TESTRC                                          0778
         LTR   @08,@08                                             0778
         BNZ   @RF00778                                            0778
*            DO;                                           /*@OZ00751*/
*                                                                  0779
*            HURBASAV = IOCSINP -> IOCDAD -> VOLHURBA;     /*@OZ00751*/
         L     @08,IOCSINP                                         0780
         L     @08,IOCDAD(,@08)                                    0780
         MVC   HURBASAV(4),VOLHURBA(@08)                           0780
*            HARBASAV = IOCSOUP -> IOCDAD -> VOLHARBA;     /*@OZ00751*/
*                                                                  0781
         L     @08,IOCSOUP                                         0781
         L     @08,IOCDAD(,@08)                                    0781
         MVC   HARBASAV(4),VOLHARBA(@08)                           0781
*            END;                                          /*@OZ00751*/
*                                                                  0782
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* READ TO RECORD 7 ON BACKUP-AND TARGET            @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0783
*        DO I=1 TO 2;                                      /*@OZ00751*/
@RF00778 LA    I,1                                                 0783
@DL00783 DS    0H                                                  0784
*          CALL GETPAIR;                                   /*@OZ00751*/
         BAL   @14,GETPAIR                                         0784
*        END;                                              /*@OZ00751*/
*                                                                  0785
         AH    I,@CH00219                                          0785
         CH    I,@CH00153                                          0785
         BNH   @DL00783                                            0785
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* RECORD 7 CONTAINS A DESCRIPTION OF THE HIGH KEY  @OZ00751*/
*        /* RANGE (TRUENAME) OF THE CATALOG. ANALYSIS OF     @OZ00751*/
*        /* THESE RECORDS DETERMINE THE TRANSLATION OF CI #S @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0786
*        IF TESTRC = 0                                             0786
*          THEN                                                    0786
         LH    @08,TESTRC                                          0786
         LTR   @08,@08                                             0786
         BNZ   @RF00786                                            0786
*            CALL TRUENAME;                                /*@OZ00751*/
*                                                                  0787
         BAL   @14,TRUENAME                                        0787
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /*COMPARISON OF THE HIGH USED RBA FOR THE LOW KEY   @OZ00751*/
*        /*RANGE OF THE BACKUP WITH THE HIGH ALLOCATED RBA   @OZ00751*/
*        /*OF THE LOW KEY RANGE OF THE TARGET WILL TELL      @OZ00751*/
*        /*IF THERE IS ENOUGH SPACE TO RELOAD THE CATALOG.   @OZ00751*/
*        /* THE HIGH USED VALUE IS FIRST TRANSLATED.         @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0788
*        IF TESTRC = 0                                             0788
*          THEN                                                    0788
@RF00786 LH    @08,TESTRC                                          0788
         LTR   @08,@08                                             0788
         BNZ   @RF00788                                            0788
*            DO;                                           /*@OZ00751*/
*                                                                  0789
*            RFY RCIADDR RSTD;                             /*@OZ00751*/
*            HURBASAV = (HURBASAV/CILEN) - 1;              /*@OZ00751*/
         L     @00,HURBASAV                                        0791
         SRDA  @00,32                                              0791
         D     @00,@CF01050                                        0791
         BCTR  @01,0                                               0791
         ST    @01,HURBASAV                                        0791
*            RCIADDR = ADDR(HURBASAV) +1;                  /*@OZ00751*/
         LA    RCIADDR,HURBASAV                                    0792
         AH    RCIADDR,@CH00219                                    0792
*            CALL CNVRTCI;                                 /*@OZ00751*/
         BAL   @14,CNVRTCI                                         0793
*            RFY RCIADDR UNRSTD;                           /*@OZ00751*/
*                                                                  0794
*            HURBASAV = HURBASAV* CILEN;                   /*@OZ00751*/
         L     @08,HURBASAV                                        0795
         SLA   @08,9                                               0795
         ST    @08,HURBASAV                                        0795
*            IF HURBASAV > HARBASAV                                0796
*              THEN                                                0796
         C     @08,HARBASAV                                        0796
         BNH   @RF00796                                            0796
*                DO;                                       /*@OZ00751*/
*                                                                  0797
*                /****************************************************/
*                /*                                                  */
*                /* SIGNAL TERMINAL ERROR AND PRINT NO SPACE @OZ00751*/
*                /* MESSAGE                                  @OZ00751*/
*                /*                                                  */
*                /****************************************************/
*                                                                  0798
*                STATFLG = TERMERR;                        /*@OZ00751*/
         MVC   STATFLG(5),@CB00819                                 0798
*                DARGLIST = ''B;                           /*@OZ00751*/
         L     @08,DDSTRU                                          0799
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0799
*                DARGSMOD = 'PR0';                         /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            0800
*                DARGSENT = '14'X;                         /*@OZ00751*/
*                                                                  0801
         MVI   DARGSENT(@08),X'14'                                 0801
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@OZ00751*/
*                                                                  0802
         L     @08,@PC00001                                        0802
         ST    @08,@AL00001                                        0802
         LA    @04,@CF00115                                        0802
         ST    @04,@AL00001+4                                      0802
         LA    @04,DDSTRU                                          0802
         ST    @04,@AL00001+8                                      0802
         MVI   @AL00001+8,X'80'                                    0802
         L     @15,GDTPRT(,@08)                                    0802
         LA    @01,@AL00001                                        0802
         BALR  @14,@15                                             0802
*                END;                                              0803
*                                                                  0803
*            END;                                          /*@OZ00751*/
@RF00796 DS    0H                                                  0805
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* READ FORWARD TO RECORD 9                         @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0805
*        DO I=1 TO 2;                                      /*@OZ00751*/
*                                                                  0805
@RF00788 LA    I,1                                                 0805
@DL00805 DS    0H                                                  0806
*          CALL GETPAIR;                                   /*@OZ00751*/
*                                                                  0806
         BAL   @14,GETPAIR                                         0806
*        END;                                              /*@OZ00751*/
*                                                                  0807
         AH    I,@CH00219                                          0807
         CH    I,@CH00153                                          0807
         BNH   @DL00805                                            0807
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* RECORD 9 CONTAINS  THE VOLUME SERIAL NUMBER AND  @OZ00751*/
*        /* THE DEVICE TYPE OF THE CATALOG. THE TWO RECORD   @OZ00751*/
*        /* NINES ARE COMPARED AND IF THE VOLUME SERIAL      @OZ00751*/
*        /* NUMBER OR DEVICE TYPES DO NOT AGREE THEN TERMINAL@OZ00751*/
*        /* ERROR IS SET AND A MESSAGE PRINTED.              @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0808
*        IF TESTRC = 0 &                                           0808
*           ((IOCSINP -> IOCDAD -> ENTNAME ^=                      0808
*           IOCSOUP -> IOCDAD -> ENTNAME) ×                        0808
*           (IOCSINP -> IOCDAD -> DEVCLASS ^=              /*@OZ17527*/
*           IOCSOUP -> IOCDAD -> DEVCLASS))                /*@OZ17527*/
*          THEN                                                    0808
         LH    @08,TESTRC                                          0808
         LTR   @08,@08                                             0808
         BNZ   @RF00808                                            0808
         L     @08,IOCSINP                                         0808
         L     @08,IOCDAD(,@08)                                    0808
         L     @04,IOCSOUP                                         0808
         L     @04,IOCDAD(,@04)                                    0808
         CLC   ENTNAME(44,@08),ENTNAME(@04)                        0808
         BNE   @RT00808                                            0808
         CLC   DEVCLASS(2,@08),DEVCLASS(@04)                       0808
         BE    @RF00808                                            0808
@RT00808 DS    0H                                                  0809
*            DO;                                           /*@OZ00751*/
*                                                                  0809
*            STATFLG = TERMERR;                            /*@OZ00751*/
         MVC   STATFLG(5),@CB00819                                 0810
*            DARGLIST = ''B;                               /*@OZ00751*/
         L     @08,DDSTRU                                          0811
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0811
*            DARGSMOD = 'PR0';                             /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            0812
*            DARGSENT = 21;                                /*@Y30SSEC*/
         MVI   DARGSENT(@08),X'15'                                 0813
*            IF IOCSINP -> IOCDAD -> ENTNAME ^=                    0814
*               IOCSOUP -> IOCDAD -> ENTNAME                       0814
*              THEN                                                0814
         L     @04,IOCSINP                                         0814
         L     @04,IOCDAD(,@04)                                    0814
         L     @01,IOCSOUP                                         0814
         L     @01,IOCDAD(,@01)                                    0814
         CLC   ENTNAME(44,@04),ENTNAME(@01)                        0814
         BE    @RF00814                                            0814
*               DO;                                        /*@Y30SSEC*/
*                 DARGDBP = ADDR(CVOLSER);                 /*@Y30SSEC*/
         LA    @04,CVOLSER                                         0816
         ST    @04,DARGDBP(,@08)                                   0816
*                 DARGILP = LENGTH(CVOLSER);               /*@Y30SSEC*/
*                                                                  0817
         MVC   DARGILP(2,@08),@CH00156                             0817
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);    /*@Y30SSEC*/
*                                                                  0818
         L     @08,@PC00001                                        0818
         ST    @08,@AL00001                                        0818
         LA    @04,@CF00115                                        0818
         ST    @04,@AL00001+4                                      0818
         LA    @04,DDSTRU                                          0818
         ST    @04,@AL00001+8                                      0818
         MVI   @AL00001+8,X'80'                                    0818
         L     @15,GDTPRT(,@08)                                    0818
         LA    @01,@AL00001                                        0818
         BALR  @14,@15                                             0818
*                 END;                                     /*@Y30SSEC*/
*            IF IOCSINP -> IOCDAD -> DEVCLASS ^=           /*@OZ17527*/
*               IOCSOUP -> IOCDAD -> DEVCLASS              /*@OZ17527*/
*              THEN                                                0820
@RF00814 L     @08,IOCSINP                                         0820
         L     @08,IOCDAD(,@08)                                    0820
         L     @04,IOCSOUP                                         0820
         L     @04,IOCDAD(,@04)                                    0820
         CLC   DEVCLASS(2,@08),DEVCLASS(@04)                       0820
         BE    @RF00820                                            0820
*               DO;                                        /*@Y30SSEC*/
*                 DARGDBP = ADDR(CDEVTYP);                 /*@Y30SSEC*/
         L     @08,DDSTRU                                          0822
         LA    @04,CDEVTYP                                         0822
         ST    @04,DARGDBP(,@08)                                   0822
*                 DARGILP = LENGTH(CDEVTYP);               /*@Y30SSEC*/
*                                                                  0823
         MVC   DARGILP(2,@08),@CH00156                             0823
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);    /*@Y30SSEC*/
*                                                                  0824
         L     @08,@PC00001                                        0824
         ST    @08,@AL00001                                        0824
         LA    @04,@CF00115                                        0824
         ST    @04,@AL00001+4                                      0824
         LA    @04,DDSTRU                                          0824
         ST    @04,@AL00001+8                                      0824
         MVI   @AL00001+8,X'80'                                    0824
         L     @15,GDTPRT(,@08)                                    0824
         LA    @01,@AL00001                                        0824
         BALR  @14,@15                                             0824
*                 END;                                     /*@Y30SSEC*/
*                                                                  0825
*            END;                                          /*@OZ00751*/
*                                                                  0826
*          ELSE                                                    0827
*            IF TESTRC = 0                                         0827
*              THEN DO;                                    /*@OZ20462*/
         B     @RC00808                                            0827
@RF00808 LH    @08,TESTRC                                          0827
         LTR   @08,@08                                             0827
         BNZ   @RF00827                                            0827
*                CALL CATRANS;                             /*@OZ00751*/
*                                                                  0829
         BAL   @14,CATRANS                                         0829
*        /************************************************************/
*        /*                                                  @OZ20462*/
*        /* DETERMINE THE NEXT AVAILABLE CI IN AN EMPTY      @OZ20462*/
*        /* CATALOG FOR THE OUTPUT DEVICE AS FOLLOWS:        @OZ20462*/
*        /*  CI OF V RECORD (9) + 1 + NUMBER OF BIT MAP      @OZ20462*/
*        /*  GROUP CODES (GC5) IN V RECORD                   @OZ20462*/
*        /*                                                  @OZ20462*/
*        /************************************************************/
*                                                                  0830
*                EMPTYCI = 10;                             /*@OZ20462*/
         MVI   EMPTYCI,X'0A'                                       0830
*                IOCSPTR = IOCSOUP;                        /*@OZ20462*/
         L     @08,IOCSOUP                                         0831
         ST    @08,IOCSPTR                                         0831
*                RFY RREC RSTD;                            /*@OZ20462*/
*                                                                  0832
*        /************************************************************/
*        /*                                                  @OZ20462*/
*        /* ESTABLISH THE NUMBER OF BIT MAP CIS BY           @OZ20462*/
*        /* COUNTING THE GROUP CODE 5'S IN THE OUTPUT        @OZ20462*/
*        /* CATALOG VOLUME RECORD                            @OZ20462*/
*        /*                                                  @OZ20462*/
*        /************************************************************/
*                                                                  0833
*                RREC = IOCDAD + NREPLF; /*PT PAST FIXED FLDS@OZ20462*/
         L     @08,IOCDAD(,@08)                                    0833
         SLR   RREC,RREC                                           0833
         IC    RREC,NREPLF(,@08)                                   0833
         ALR   RREC,@08                                            0833
*                RFY VARFIELD BASED(RREC);                 /*@OZ20462*/
*                DO I = 1 TO NREPCV;     /*PT PAST VAR FLDS  @OZ20462*/
         LA    I,1                                                 0835
         B     @DE00835                                            0835
@DL00835 DS    0H                                                  0836
*                  RREC = RREC + VARLEN + LENGTH(VARLEN);  /*@OZ20462*/
         LR    @08,RREC                                            0836
         AH    @08,VARLEN(,RREC)                                   0836
         AL    @08,@CF00153                                        0836
         LR    RREC,@08                                            0836
*                END;                                      /*@OZ20462*/
         AH    I,@CH00219                                          0837
@DE00835 L     @08,IOCSPTR                                         0837
         L     @08,IOCDAD(,@08)                                    0837
         MVC   @ZT00003+3(1),NREPCV(@08)                           0837
         C     I,@ZT00003                                          0837
         BNH   @DL00835                                            0837
*                RFY REPCNTRL BASED(RREC);                 /*@OZ20462*/
*                GOPLEN = LENGTH(CATGOPT) -                /*@OZ20462*/
*                  LENGTH(CATGOSEQ) + LENGTH(CATSN);       /*@OZ20462*/
         LA    GOPLEN,6                                            0839
*                                        /*SET VOL GOP LEN   @OZ20462*/
*                GOSTART = GOPLEN*REPCNT +                 /*@OZ20462*/
*                  ADDR(REPGOPT(1));                       /*@OZ20462*/
         SLR   @01,@01                                             0840
         IC    @01,REPCNT(,RREC)                                   0840
         MR    @00,GOPLEN                                          0840
         LA    GOSTART,REPGOPT(,RREC)                              0840
         ALR   @01,GOSTART                                         0840
         LR    GOSTART,@01                                         0840
*                L = GOSTART - GOPLEN;   /*SCAN GOPS FOR     @OZ20462*/
         LR    L,GOSTART                                           0841
         SLR   L,GOPLEN                                            0841
*                                        /*GC5'S             @OZ20462*/
*                DO RREC = ADDR(REPGOPT) TO L BY GOPLEN;   /*@OZ20462*/
         LA    @08,REPGOPT(,RREC)                                  0842
         LR    RREC,@08                                            0842
         B     @DE00842                                            0842
@DL00842 DS    0H                                                  0843
*                  RFY CATGOPT BASED(RREC);                /*@OZ20462*/
*                  IF CATGOGC = '0101'B THEN               /*@OZ20462*/
         TM    CATGOGC(RREC),B'00000101'                           0844
         BNO   @RF00844                                            0844
         TM    CATGOGC(RREC),B'00001010'                           0844
         BNZ   @RF00844                                            0844
*                    EMPTYCI = EMPTYCI + 1;                /*@OZ20462*/
         IC    @08,EMPTYCI                                         0845
         LA    @08,1(,@08)                                         0845
         STC   @08,EMPTYCI                                         0845
*                END;                                      /*@OZ20462*/
*                                                                  0846
@RF00844 ALR   RREC,GOPLEN                                         0846
@DE00842 CR    RREC,L                                              0846
         BNH   @DL00842                                            0846
*        /************************************************************/
*        /*                                                  @OZ20462*/
*        /* IF THE NEXT AVAILABLE CI JUST DETERMINED         @OZ20462*/
*        /* MATCHES THE ACTUAL OUTPUT CATALOG NEXT           @OZ20462*/
*        /* AVAILABLE CI, THEN THE CATALOG IS EMPTY          @OZ20462*/
*        /*                                                  @OZ20462*/
*        /************************************************************/
*                                                                  0847
*                IF OCCRNFCI = EMPTYCI THEN                /*@OZ20462*/
         CLC   OCCRNFCI(1),EMPTYCI                                 0847
         BNE   @RF00847                                            0847
*                  EMPTYSW = ON;                           /*@OZ20462*/
         OI    EMPTYSW,B'10000000'                                 0848
*                IOCSPTR = IOCSINP;                        /*@OZ20462*/
@RF00847 MVC   IOCSPTR(4),IOCSINP                                  0849
*                RFY RREC UNRSTD;                          /*@OZ20462*/
*            END;                                          /*@OZ20462*/
*                                                                  0851
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* IF THE RETURN CODE FROM ANY READ WAS NONE ZERO   @OZ00751*/
*        /* THEN TERMINAL ERROR SHOULD BE SIGNALLED          @OZ00751*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0852
*        IF GDTDBG = NULLPTR                                       0852
*          THEN;                                                   0852
@RF00827 DS    0H                                                  0852
@RC00808 L     @08,@PC00001                                        0852
         L     @08,GDTDBG(,@08)                                    0852
         LTR   @08,@08                                             0852
         BZ    @RT00852                                            0852
*          ELSE                                                    0854
*            CALL IDCDB010 (GDTTBL,'RPD1');                        0854
         L     @08,@PC00001                                        0854
         ST    @08,@AL00001                                        0854
         LA    @04,@CC01195                                        0854
         ST    @04,@AL00001+4                                      0854
         MVI   @AL00001+4,X'80'                                    0854
         L     @15,GDTDBG(,@08)                                    0854
         LA    @01,@AL00001                                        0854
         BALR  @14,@15                                             0854
*                                                          /*@OZ00751*/
*                                                                  0855
*        IF TESTRC ^= 0                                            0855
*          THEN                                                    0855
@RT00852 LH    @08,TESTRC                                          0855
         LTR   @08,@08                                             0855
         BZ    @RF00855                                            0855
*            STATFLG = TERMERR;                            /*@OZ00751*/
*                                                                  0856
         MVC   STATFLG(5),@CB00819                                 0856
*                                                                  0857
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* THIS NEXT SECTION OF THE PROGRAM IS THE MAIN PROCESSING  @OZ00751*/
*/* LOOP AND IS LEFT ONLY WHEN ALL RECORDS HAVE BEEN READ.   @OZ00751*/
*/* A COPY OF THE BACKUP CATALOG IS MADE. I. E.              @OZ00751*/
*/*   RECORDS ARE DELETED,ADDED OR UPDATED AS NECESSARY.     @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  0857
*                                                                  0857
*      /**************************************************************/
*      /*                                                    @OZ00751*/
*      /* THE SOURCE AND/OR TARGET IS READ DEPENDING ON THE  @OZ00751*/
*      /* VALUE OF READSW-- READS,READT AND READB MEAN       @OZ00751*/
*      /* READ A BACKUP RECORD ONLY,READ A TARGET RECORD     @OZ00751*/
*      /* ONLY,READ A BACKUP AND TARGET RECORD RESPECTIVELY. @OZ00751*/
*      /*                                                    @OZ00751*/
*      /**************************************************************/
*                                                                  0857
*MAIN: DO WHILE STATFLG ^= TERMERR &                               0857
*                   EOFSW ^= EOF;                          /*@OZ00751*/
*                                                                  0857
@RF00855 DS    0H                                                  0857
MAIN     B     @DE00857                                            0857
@DL00857 DS    0H                                                  0858
*        IF READSW = READS ×                                       0858
*            READSW = READB                                        0858
*                                                                  0858
*          THEN                                                    0858
         CLI   READSW,X'01'                                        0858
         BE    @RT00858                                            0858
         CLI   READSW,X'03'                                        0858
         BNE   @RF00858                                            0858
@RT00858 DS    0H                                                  0859
*            DO;                                           /*@OZ00751*/
*                                                                  0859
*            CALL SORSREAD;                                /*@OZ00751*/
*                                                                  0860
         BAL   @14,SORSREAD                                        0860
*            IF TESTRC = 0                                         0861
*              THEN                                                0861
         LH    @08,TESTRC                                          0861
         LTR   @08,@08                                             0861
         BNZ   @RF00861                                            0861
*                CALL CATRANS;                             /*@OZ00751*/
*                                                                  0862
*                                                                  0862
         BAL   @14,CATRANS                                         0862
*            END;                                          /*@OZ00751*/
*                                                                  0863
@RF00861 DS    0H                                                  0864
*        IF READSW = READT ×                                       0864
*            READSW = READB                                        0864
*          THEN                                                    0864
@RF00858 CLI   READSW,X'02'                                        0864
         BE    @RT00864                                            0864
         CLI   READSW,X'03'                                        0864
         BNE   @RF00864                                            0864
@RT00864 DS    0H                                                  0865
*            DO;                                           /*@OZ00751*/
*                                                                  0865
*            CALL TARGREAD;                                /*@OZ00751*/
*                                                                  0866
*                                                                  0866
         BAL   @14,TARGREAD                                        0866
*           END;                                           /*@OZ00751*/
*                                                                  0867
*        /************************************************************/
*        /*                                                          */
*        /* IF A RECORD EXISTED ON THE TARGET CATALOG BUT    @OZ00751*/
*        /* NOT ON THE SOURCE THEN IT SHOULD BE :            @OZ00751*/
*        /* DELETED IF IT IS A TRUENAME RECORD OR---         @OZ00751*/
*        /*MADE INTO A CATALOG FREE RECORD IF IT IS IN THE   @OZ00751*/
*        /* LOW KEY RANGE.                                   @OZ00751*/
*        /* A NEW TARGET RECORD IS READ AND THE COMPARE      @OZ00751*/
*        /*  PROCEDURE IS CALLED.                            @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0868
*        IF IOCSINP->IOCDAD->RCDKEYTY^=NULL &              /*@Y30SSSB*/
*           IOCSINP -> IOCDAD -> RECKEY  >                         0868
*           IOCSOUP -> IOCDAD -> RECKEY                            0868
*                                                                  0868
*          THEN                                                    0868
@RF00864 L     @08,IOCSINP                                         0868
         L     @08,IOCDAD(,@08)                                    0868
         CLI   RCDKEYTY(@08),0                                     0868
         BE    @RF00868                                            0868
         L     @04,IOCSOUP                                         0868
         L     @04,IOCDAD(,@04)                                    0868
         CLC   RECKEY(44,@08),RECKEY(@04)                          0868
         BNH   @RF00868                                            0868
*            IF IOCSOUP -> IOCDAD -> RCDKEYTY ^= NULL              0869
*              THEN                                                0869
         CLI   RCDKEYTY(@04),0                                     0869
         BE    @RF00869                                            0869
*                DO;                                       /*@OZ00751*/
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /*  CALL THE COMPARE PROCEDURE .            @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0871
*                READSW = READT;                           /*@OZ00751*/
         MVI   READSW,X'02'                                        0871
*                CALL CATCOMP;                             /*@OZ00751*/
*                                                                  0872
         BAL   @14,CATCOMP                                         0872
*                IF IOPOSSW = 'I'                                  0873
*                  THEN                                            0873
         CLI   IOPOSSW,C'I'                                        0873
         BNE   @RF00873                                            0873
*                    DO;                                           0874
*                                                                  0874
*                    /************************************************/
*                    /*                                      @OZ00751*/
*                    /* IF THE LAST REQUEST WAS FOR AN INSERT@OZ00751*/
*                    /* THEN THE INSERT RPL HAS TO BE        @OZ00751*/
*                    /* QUIESCED AND THE UPDATE RPL          @OZ00751*/
*                    /* REPOSITIONED.                        @OZ00751*/
*                    /*                                      @OZ00751*/
*                    /************************************************/
*                                                                  0875
*                    REG1 = IOCSOUT -> IOCEXT -> IOCRPL;   /*@OZ00751*/
         L     @08,IOCSOUT                                         0875
         L     @08,IOCEXT(,@08)                                    0875
         L     REG1,IOCRPL(,@08)                                   0875
*                    GEN(ENDREQ RPL=(1) );                 /*@OZ00751*/
*                                                                  0876
         ENDREQ RPL=(1)
*                    IOCSOUP -> IOCKYA = ADDR(CURRKEYT);   /*@OZ00751*/
         LA    @08,CURRKEYT                                        0877
         L     @04,IOCSOUP                                         0877
         ST    @08,IOCKYA(,@04)                                    0877
*                    CALL IDCIOPO0 (GDTTBL,IOCSOUP);       /*@OZ00751*/
         L     @08,@PC00001                                        0878
         ST    @08,@AL00001                                        0878
         LA    @04,IOCSOUP                                         0878
         ST    @04,@AL00001+4                                      0878
         MVI   @AL00001+4,X'80'                                    0878
         L     @15,GDTPOS(,@08)                                    0878
         LA    @01,@AL00001                                        0878
         BALR  @14,@15                                             0878
*                    RESPECIFY RTNREG RSTD;                        0879
*                    TESTRC = RTNREG;                              0880
         STH   RTNREG,TESTRC                                       0880
*                    RESPECIFY RTNREG UNRSTD;              /*@OZ00751*/
*                                                                  0881
*                    IF TESTRC = 0                                 0882
*                      THEN;                               /*@OZ00751*/
         LH    @08,TESTRC                                          0882
         LTR   @08,@08                                             0882
         BZ    @RT00882                                            0882
*                      ELSE                                        0884
*                        STATFLG = TERMERR;                /*@OZ00751*/
*                                                                  0884
         MVC   STATFLG(5),@CB00819                                 0884
*                    CALL IDCIOGT0   (GDTTBL,IOCSOUP);     /*@OZ00751*/
@RT00882 L     @08,@PC00001                                        0885
         ST    @08,@AL00001                                        0885
         LA    @04,IOCSOUP                                         0885
         ST    @04,@AL00001+4                                      0885
         MVI   @AL00001+4,X'80'                                    0885
         L     @15,GDTGET(,@08)                                    0885
         LA    @01,@AL00001                                        0885
         BALR  @14,@15                                             0885
*                    RESPECIFY RTNREG RSTD;                        0886
*                    TESTRC = RTNREG;                              0887
         STH   RTNREG,TESTRC                                       0887
*                    RESPECIFY RTNREG UNRSTD;              /*@OZ00751*/
*                                                                  0888
*                    IF TESTRC = 0                                 0889
*                      THEN;                               /*@OZ00751*/
         LH    @08,TESTRC                                          0889
         LTR   @08,@08                                             0889
         BZ    @RT00889                                            0889
*                      ELSE                                        0891
*                        STATFLG = TERMERR;                /*@OZ00751*/
*                                                                  0891
         MVC   STATFLG(5),@CB00819                                 0891
*                    END;                                  /*@OZ00751*/
*                                                                  0892
@RT00889 DS    0H                                                  0893
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* DELETE THE TRUENAME AND SET THE LAST     @OZ00751*/
*                /* OPERATION WAS UPDATE.                    @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0893
*                DMNAME1 = 'DLOUTREC';                     /*@OZ00751*/
@RF00873 MVC   DMNAME1(8),@CC01201                                 0893
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@OZ00751*/
*                                                                  0894
         L     @08,IOCSOUP                                         0894
         MVC   DMADDR1(4),IOCDAD(@08)                              0894
*                REG1 = IOCSOUP -> IOCEXT -> IOCRPL;       /*@OZ00751*/
         L     @08,IOCEXT(,@08)                                    0895
         L     REG1,IOCRPL(,@08)                                   0895
*                GEN(ERASE RPL=(1) );                      /*@OZ00751*/
         ERASE RPL=(1)
*                RESPECIFY RTNREG RSTD;                            0897
*                TESTRC = RTNREG;                                  0898
         STH   RTNREG,TESTRC                                       0898
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/
*                                                                  0899
*                IF TESTRC = 0                                     0900
*                  THEN;                                   /*@OZ00751*/
         LH    @08,TESTRC                                          0900
         LTR   @08,@08                                             0900
         BZ    @RT00900                                            0900
*                  ELSE                                            0902
*                    STATFLG = TERMERR;                    /*@OZ00751*/
*                                                                  0902
         MVC   STATFLG(5),@CB00819                                 0902
*                IOPOSSW = 'U';                            /*@OZ00751*/
*                                                                  0903
@RT00900 MVI   IOPOSSW,C'U'                                        0903
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@OZ00751*/
*                                                                  0904
         L     @08,IOCSOUP                                         0904
         MVC   IOCDAD(4,@08),DMADDR1                               0904
*                IF GDTDBG = NULLPTR                               0905
*                  THEN;                                   /*@OZ00751*/
         L     @08,@PC00001                                        0905
         L     @08,GDTDBG(,@08)                                    0905
         LTR   @08,@08                                             0905
         BZ    @RT00905                                            0905
*                  ELSE                                            0907
*                    CALL DUMPIT;                          /*@OZ00751*/
*                                                                  0907
         BAL   @14,DUMPIT                                          0907
*                IF TESTRC ^= 0                                    0908
*                  THEN                                            0908
@RT00905 LH    @08,TESTRC                                          0908
         LTR   @08,@08                                             0908
         BZ    @RF00908                                            0908
*                    STATFLG = TERMERR;                    /*@OZ00751*/
*                                                                  0909
         MVC   STATFLG(5),@CB00819                                 0909
*                END;                                      /*@OZ00751*/
*                                                                  0910
*              ELSE                                                0911
*                DO;                                       /*@OZ00751*/
*                                                                  0911
         B     @RC00869                                            0911
@RF00869 DS    0H                                                  0912
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* MAKE A FREE RECORD OF THE TARGET RECORD  @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0912
*                IOCSPTR=IOCSOUP;                          /*@OZ00751*/
*                                                                  0912
         L     @08,IOCSOUP                                         0912
         ST    @08,IOCSPTR                                         0912
*                CLEARA = ''B; /* CLEAR 1ST PART OF FREE REC @Y30SSEC*/
         L     @04,IOCDAD(,@08)                                    0913
         XC    CLEARA(216,@04),CLEARA(@04)                         0913
*                CLEARB = ''B; /* CLEAR 2ND PART             @Y30SSEC*/
*                                                                  0914
         XC    CLEARB(245,@04),CLEARB(@04)                         0914
*                RCDID= 'F';                               /*@OZ00751*/
         MVI   RCDID(@04),C'F'                                     0915
*                CFRNEXT= CFROLD;                          /*@OZ00751*/
         MVC   CFRNEXT+45(3,@04),CFROLD                            0916
*                CFROLD= RCDCINO;                          /*@OZ00751*/
         MVC   CFROLD(3),RCDCINO(@04)                              0917
*                FREENUM= FREENUM + 1;                     /*@OZ00751*/
*                                                                  0918
         LA    @04,1                                               0918
         AL    @04,FREENUM                                         0918
         ST    @04,FREENUM                                         0918
*                IOCSPTR = IOCSINP;                        /*@OZ00751*/
*                                                                  0919
         MVC   IOCSPTR(4),IOCSINP                                  0919
*                READSW = READT;                           /*@OZ00751*/
*                                                                  0920
         MVI   READSW,X'02'                                        0920
*                DMNAME1 = 'FUPOTREC';                     /*@OZ00751*/
         MVC   DMNAME1(8),@CC01203                                 0921
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@OZ00751*/
*                                                                  0922
         MVC   DMADDR1(4),IOCDAD(@08)                              0922
*                CALL IDCIOPT0 (GDTTBL,IOCSOUP);           /*@OZ00751*/
         L     @08,@PC00001                                        0923
         ST    @08,@AL00001                                        0923
         LA    @04,IOCSOUP                                         0923
         ST    @04,@AL00001+4                                      0923
         MVI   @AL00001+4,X'80'                                    0923
         L     @15,GDTPUT(,@08)                                    0923
         LA    @01,@AL00001                                        0923
         BALR  @14,@15                                             0923
*                RESPECIFY RTNREG RSTD;                            0924
*                TESTRC = RTNREG;                                  0925
         STH   RTNREG,TESTRC                                       0925
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/
*                                                                  0926
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@OZ00751*/
*                                                                  0927
         L     @08,IOCSOUP                                         0927
         MVC   IOCDAD(4,@08),DMADDR1                               0927
*                IOPOSSW = 'U';                            /*@OZ00751*/
*                                                                  0928
         MVI   IOPOSSW,C'U'                                        0928
*                IF GDTDBG = NULLPTR                               0929
*                  THEN;                                   /*@OZ00751*/
         L     @08,@PC00001                                        0929
         L     @08,GDTDBG(,@08)                                    0929
         LTR   @08,@08                                             0929
         BZ    @RT00929                                            0929
*                  ELSE                                            0931
*                    CALL DUMPIT;                          /*@OZ00751*/
*                                                                  0931
         BAL   @14,DUMPIT                                          0931
*                IF TESTRC ^= 0                                    0932
*                  THEN                                            0932
@RT00929 LH    @08,TESTRC                                          0932
         LTR   @08,@08                                             0932
         BZ    @RF00932                                            0932
*                    STATFLG = TERMERR;                    /*@OZ00751*/
*                                                                  0933
         MVC   STATFLG(5),@CB00819                                 0933
*                END;                                      /*@OZ00751*/
*                                                                  0934
@RF00932 DS    0H                                                  0935
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* IF A RECORD EXISTS ON THE BACKUP CATALOG BUT NOT @OZ00751*/
*        /* ON THE TARGET THEN IT SHOULD BE INSERTED INTO    @OZ00751*/
*        /* THE TARGET,TRANSLATING THE CI #S IF NECESSARY.   @OZ00751*/
*        /* A CATALOG COMPARE SHOULD BE DONE IF DESIRED AND  @OZ00751*/
*        /* A NEW SOURE RECORD READ IS INDICATED.            @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  0935
*        IF IOCSOUP->IOCDAD->RCDKEYTY^=NULL &              /*@Y30SSSB*/
*           IOCSINP -> IOCDAD -> RECKEY <                          0935
*           IOCSOUP -> IOCDAD -> RECKEY                            0935
*          THEN                                                    0935
@RC00869 DS    0H                                                  0935
@RF00868 L     @08,IOCSOUP                                         0935
         L     @08,IOCDAD(,@08)                                    0935
         CLI   RCDKEYTY(@08),0                                     0935
         BE    @RF00935                                            0935
         L     @04,IOCSINP                                         0935
         L     @04,IOCDAD(,@04)                                    0935
         CLC   RECKEY(44,@04),RECKEY(@08)                          0935
         BNL   @RF00935                                            0935
*            DO;                                           /*@OZ00751*/
*                                                                  0936
*            READSW = READS;                               /*@OZ00751*/
*                                                                  0937
         MVI   READSW,X'01'                                        0937
*            CALL CATCOMP;                                 /*@OZ00751*/
*                                                                  0938
         BAL   @14,CATCOMP                                         0938
*            IF IOPOSSW = 'U'                                      0939
*              THEN                                                0939
         CLI   IOPOSSW,C'U'                                        0939
         BNE   @RF00939                                            0939
*                DO;                                       /*@OZ00751*/
*                                                                  0940
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* IF THE LAST REQUEST WAS FOR AN UPDATE    @OZ00751*/
*                /* THEN QUIESCE THE UPDATE RPL.             @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0941
*                REG1 = IOCSOUP -> IOCEXT -> IOCRPL;       /*@OZ00751*/
         L     @08,IOCSOUP                                         0941
         L     @08,IOCEXT(,@08)                                    0941
         L     REG1,IOCRPL(,@08)                                   0941
*                GEN(ENDREQ RPL=(1) );                     /*@OZ00751*/
*                                                                  0942
         ENDREQ RPL=(1)
*                END;                                      /*@OZ00751*/
*                                                                  0943
*            /********************************************************/
*            /*                                              @OZ00751*/
*            /* PERFORM THE INSERT AND SET THE LAST I/O      @OZ00751*/
*            /* AS AN INSERT.                                @OZ00751*/
*            /*                                              @OZ00751*/
*            /********************************************************/
*                                                                  0944
*            IOCSOUT -> IOCDAD = IOCDAD;                   /*@OZ00751*/
@RF00939 L     @08,IOCSOUT                                         0944
         L     @04,IOCSPTR                                         0944
         L     @15,IOCDAD(,@04)                                    0944
         ST    @15,IOCDAD(,@08)                                    0944
*            IOCSOUT -> IOCDLN = IOCDLN;                   /*@OZ00751*/
*                                                                  0945
         MVC   IOCDLN(4,@08),IOCDLN(@04)                           0945
*            DMNAME1 = 'INSOTREC';                         /*@OZ00751*/
         MVC   DMNAME1(8),@CC01204                                 0946
*            DMADDR1 = IOCSOUT -> IOCDAD;                  /*@OZ00751*/
*                                                                  0947
         ST    @15,@TF00001                                        0947
         MVC   DMADDR1(4),@TF00001                                 0947
*            CALL IDCIOPT0 (GDTTBL,IOCSOUT);               /*@OZ00751*/
         L     @08,@PC00001                                        0948
         ST    @08,@AL00001                                        0948
         LA    @04,IOCSOUT                                         0948
         ST    @04,@AL00001+4                                      0948
         MVI   @AL00001+4,X'80'                                    0948
         L     @15,GDTPUT(,@08)                                    0948
         LA    @01,@AL00001                                        0948
         BALR  @14,@15                                             0948
*            RESPECIFY RTNREG RSTD;                                0949
*            TESTRC = RTNREG;                                      0950
         STH   RTNREG,TESTRC                                       0950
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/
*                                                                  0951
*            IOPOSSW = 'I';                                /*@OZ00751*/
*                                                                  0952
         MVI   IOPOSSW,C'I'                                        0952
*            IF GDTDBG = NULLPTR                                   0953
*              THEN;                                       /*@OZ00751*/
         L     @08,@PC00001                                        0953
         L     @08,GDTDBG(,@08)                                    0953
         LTR   @08,@08                                             0953
         BZ    @RT00953                                            0953
*              ELSE                                                0955
*                CALL DUMPIT;                              /*@OZ00751*/
*                                                                  0955
         BAL   @14,DUMPIT                                          0955
*            IF TESTRC ^= 0                                        0956
*              THEN                                                0956
@RT00953 LH    @08,TESTRC                                          0956
         LTR   @08,@08                                             0956
         BZ    @RF00956                                            0956
*                STATFLG = TERMERR;                        /*@OZ00751*/
*                                                                  0957
         MVC   STATFLG(5),@CB00819                                 0957
*            END;                                          /*@OZ00751*/
*                                                                  0958
@RF00956 DS    0H                                                  0959
*        /************************************************************/
*        /* IF A RECORD EXISTS ON BOTH BACKUP AND TARGET     @OZ00751*/
*        /* THEN THE TARGET HAS TO BE UPDATED.               @OZ00751*/
*        /*  A NEW BACKUP AND TARGET RECORD WILL             @OZ00751*/
*        /* BE READ NEXT                                     @OZ00751*/
*        /************************************************************/
*                                                                  0959
*        IF ((IOCSINP->IOCDAD->RCDKEYTY=NULL &             /*@Y30SSSB*/
*             IOCSOUP->IOCDAD->RCDKEYTY=NULL) ×            /*@Y30SSSB*/
*            IOCSINP -> IOCDAD -> RECKEY =                 /*@Y30SSSB*/
*            IOCSOUP -> IOCDAD -> RECKEY) &                /*@Y30SSSB*/
*           EOFSW  ^= EOF                                          0959
*          THEN                                                    0959
@RF00935 L     @08,IOCSINP                                         0959
         L     @08,IOCDAD(,@08)                                    0959
         CLI   RCDKEYTY(@08),0                                     0959
         BNE   @GL00066                                            0959
         L     @08,IOCSOUP                                         0959
         L     @08,IOCDAD(,@08)                                    0959
         CLI   RCDKEYTY(@08),0                                     0959
         BE    @GL00065                                            0959
@GL00066 L     @08,IOCSINP                                         0959
         L     @08,IOCDAD(,@08)                                    0959
         L     @04,IOCSOUP                                         0959
         L     @04,IOCDAD(,@04)                                    0959
         CLC   RECKEY(44,@08),RECKEY(@04)                          0959
         BNE   @RF00959                                            0959
@GL00065 CLC   EOFSW(2),@CH00162                                   0959
         BE    @RF00959                                            0959
*            DO;                                           /*@OZ00751*/
*                                                                  0960
*            READSW = READB;                               /*@OZ00751*/
*                                                                  0961
         MVI   READSW,X'03'                                        0961
*            IF IOPOSSW = 'I'                                      0962
*              THEN                                                0962
         CLI   IOPOSSW,C'I'                                        0962
         BNE   @RF00962                                            0962
*                DO;                                       /*@OZ00751*/
*                                                                  0963
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* IF THE LAST REQUEST WAS FOR AN INSERT    @OZ00751*/
*                /* THEN THE INSERT RPL HAS TO BE            @OZ00751*/
*                /* QUIESCED AND THE UPDATE RPL              @OZ00751*/
*                /* REPOSITIONED.                            @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  0964
*                REG1 = IOCSOUT -> IOCEXT -> IOCRPL;       /*@OZ00751*/
         L     @08,IOCSOUT                                         0964
         L     @08,IOCEXT(,@08)                                    0964
         L     REG1,IOCRPL(,@08)                                   0964
*                GEN(ENDREQ RPL=(1) );                     /*@OZ00751*/
*                                                                  0965
         ENDREQ RPL=(1)
*                IOCSOUP -> IOCKYA = ADDR(CURRKEYT);       /*@OZ00751*/
         LA    @08,CURRKEYT                                        0966
         L     @04,IOCSOUP                                         0966
         ST    @08,IOCKYA(,@04)                                    0966
*                CALL IDCIOPO0 (GDTTBL,IOCSOUP);           /*@OZ00751*/
         L     @08,@PC00001                                        0967
         ST    @08,@AL00001                                        0967
         LA    @04,IOCSOUP                                         0967
         ST    @04,@AL00001+4                                      0967
         MVI   @AL00001+4,X'80'                                    0967
         L     @15,GDTPOS(,@08)                                    0967
         LA    @01,@AL00001                                        0967
         BALR  @14,@15                                             0967
*                RESPECIFY RTNREG RSTD;                            0968
*                TESTRC = RTNREG;                                  0969
         STH   RTNREG,TESTRC                                       0969
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/
*                                                                  0970
*                IF TESTRC = 0                                     0971
*                  THEN;                                   /*@OZ00751*/
         LH    @08,TESTRC                                          0971
         LTR   @08,@08                                             0971
         BZ    @RT00971                                            0971
*                  ELSE                                            0973
*                    STATFLG = TERMERR;                    /*@OZ00751*/
*                                                                  0973
         MVC   STATFLG(5),@CB00819                                 0973
*                CALL IDCIOGT0   (GDTTBL,IOCSOUP);         /*@OZ00751*/
@RT00971 L     @08,@PC00001                                        0974
         ST    @08,@AL00001                                        0974
         LA    @04,IOCSOUP                                         0974
         ST    @04,@AL00001+4                                      0974
         MVI   @AL00001+4,X'80'                                    0974
         L     @15,GDTGET(,@08)                                    0974
         LA    @01,@AL00001                                        0974
         BALR  @14,@15                                             0974
*                RESPECIFY RTNREG RSTD;                            0975
*                TESTRC = RTNREG;                                  0976
         STH   RTNREG,TESTRC                                       0976
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/
*                                                                  0977
*                IF TESTRC = 0                                     0978
*                  THEN;                                   /*@OZ00751*/
         LH    @08,TESTRC                                          0978
         LTR   @08,@08                                             0978
         BZ    @RT00978                                            0978
*                  ELSE                                            0980
*                    STATFLG = TERMERR;                    /*@OZ00751*/
*                                                                  0980
         MVC   STATFLG(5),@CB00819                                 0980
*                END;                                      /*@OZ00751*/
*                                                                  0981
@RT00978 DS    0H                                                  0982
*            IF  IOCSINP -> IOCDLN = 47                            0982
*              THEN                                                0982
@RF00962 L     @08,IOCSINP                                         0982
         CLC   IOCDLN(4,@08),@CF01205                              0982
         BNE   @RF00982                                            0982
*                IOCSOUP -> IOCDAD -> CATLREC(1:47) =              0983
*                IOCSINP -> IOCDAD -> CATLREC(1:47);       /*@OZ00751*/
         L     @04,IOCSOUP                                         0983
         L     @04,IOCDAD(,@04)                                    0983
         L     @08,IOCDAD(,@08)                                    0983
         MVC   CATLREC(47,@04),CATLREC(@08)                        0983
*              ELSE                                                0984
*                IF EMPTYSW = ON & IOCSOUP -> IOCDAD ->            0984
*                    RCDCINO < EMPTYCI                     /*@OZ20462*/
*                    & (IOCSOUP -> IOCDAD -> RCDID = 'V'           0984
*                    × IOCSOUP -> IOCDAD -> RCDID = 'W' )  /*@OZ17949*/
*                  THEN;                                   /*@OZ00751*/
         B     @RC00982                                            0984
@RF00982 TM    EMPTYSW,B'10000000'                                 0984
         BNO   @RF00984                                            0984
         L     @08,IOCSOUP                                         0984
         L     @08,IOCDAD(,@08)                                    0984
         MVC   @ZT00001+1(3),RCDCINO(@08)                          0984
         L     @04,@ZT00001                                        0984
         MVC   @ZT00003+3(1),EMPTYCI                               0984
         C     @04,@ZT00003                                        0984
         BNL   @RF00984                                            0984
         CLI   RCDID(@08),C'V'                                     0984
         BE    @RT00984                                            0984
         CLI   RCDID(@08),C'W'                                     0984
         BE    @RT00984                                            0984
*                  ELSE                                    /*@OZ17081*/
*                    IF IOCSINP->IOCDAD->RECKEY=                   0986
*                       IOCSOUP->IOCDAD->RECKEY THEN               0986
@RF00984 L     @08,IOCSINP                                         0986
         L     @08,IOCDAD(,@08)                                    0986
         L     @04,IOCSOUP                                         0986
         L     @04,IOCDAD(,@04)                                    0986
         CLC   RECKEY(44,@08),RECKEY(@04)                          0986
         BNE   @RF00986                                            0986
*                                       /*DO FULL KEYS MATCH @Y30SSSB*/
*                      DO;              /*YES                @Y30SSSB*/
*                                                                  0987
*                        IOCSOUP -> IOCDAD -> CATLREC(1:255) =     0988
*                        IOCSINP->IOCDAD -> CATLREC(1:255);/*@Y30SSSB*/
         MVC   CATLREC(255,@04),CATLREC(@08)                       0988
*                        IOCSOUP -> IOCDAD -> CATLREC(256:505) =   0989
*                        IOCSINP->IOCDAD->CATLREC(256:505);/*@Y30SSSB*/
*                                                                  0989
         MVC   CATLREC+255(250,@04),CATLREC+255(@08)               0989
*                      END;                                /*@Y30SSSB*/
*                                                                  0990
*           IF IOCSINP -> IOCDLN ^= 47 & EMPTYSW = ON &            0991
*              IOCSOUP -> IOCDAD -> RCDCINO < EMPTYCI      /*@OZ20462*/
*              & (IOCSOUP -> IOCDAD -> RCDID = 'V'                 0991
*                   × IOCSOUP -> IOCDAD -> RCDID = 'W' )           0991
*              THEN;                                       /*@OZ17081*/
@RF00986 DS    0H                                                  0991
@RT00984 DS    0H                                                  0991
@RC00982 L     @08,IOCSINP                                         0991
         CLC   IOCDLN(4,@08),@CF01205                              0991
         BE    @RF00991                                            0991
         TM    EMPTYSW,B'10000000'                                 0991
         BNO   @RF00991                                            0991
         L     @08,IOCSOUP                                         0991
         L     @08,IOCDAD(,@08)                                    0991
         MVC   @ZT00001+1(3),RCDCINO(@08)                          0991
         L     @04,@ZT00001                                        0991
         MVC   @ZT00003+3(1),EMPTYCI                               0991
         C     @04,@ZT00003                                        0991
         BNL   @RF00991                                            0991
         CLI   RCDID(@08),C'V'                                     0991
         BE    @RT00991                                            0991
         CLI   RCDID(@08),C'W'                                     0991
         BE    @RT00991                                            0991
*           ELSE                                                   0993
*             DO;                                          /*@OZ17081*/
@RF00991 DS    0H                                                  0994
*            IF IOCSINP->IOCDAD->RECKEY^=                          0994
*               IOCSOUP->IOCDAD->RECKEY THEN /*DO FULL KEYS MATCH  0994
*                                                            @Y30SSSB*/
         L     @08,IOCSINP                                         0994
         L     @08,IOCDAD(,@08)                                    0994
         L     @04,IOCSOUP                                         0994
         L     @15,IOCDAD(,@04)                                    0994
         CLC   RECKEY(44,@08),RECKEY(@15)                          0994
         BE    @RF00994                                            0994
*              DO;                           /*NO            @Y30SSSB*/
*                /* DELETE THE RECORD FROM THE TARGET & THEN @Y30SSSB*/
*                /* INSERT THE RECORD FROM THE SOURCE.       @Y30SSSB*/
*                /* SET LAST OPERATION TO INSERT.            @Y30SSSB*/
*                DMNAME1 = 'DLOUTREC';                     /*@Y30SSSB*/
         MVC   DMNAME1(8),@CC01201                                 0996
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@Y30SSSB*/
*                                                                  0997
         ST    @15,@TF00001                                        0997
         MVC   DMADDR1(4),@TF00001                                 0997
*                REG1 = IOCSOUP -> IOCEXT -> IOCRPL;       /*@Y30SSSB*/
         L     @08,IOCEXT(,@04)                                    0998
         L     REG1,IOCRPL(,@08)                                   0998
*                GEN(ERASE RPL=(1) );                      /*@Y30SSSB*/
         ERASE RPL=(1)
*                RESPECIFY RTNREG RSTD;                            1000
*                TESTRC = RTNREG;                                  1001
         STH   RTNREG,TESTRC                                       1001
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSSB*/
*                                                                  1002
*                IF TESTRC = 0                                     1003
*                  THEN;                                   /*@Y30SSSB*/
         LH    @08,TESTRC                                          1003
         LTR   @08,@08                                             1003
         BZ    @RT01003                                            1003
*                  ELSE                                            1005
*                    STATFLG = TERMERR;                    /*@Y30SSSB*/
*                                                                  1005
         MVC   STATFLG(5),@CB00819                                 1005
*                IOPOSSW = 'U';                            /*@Y30SSSB*/
*                                                                  1006
@RT01003 MVI   IOPOSSW,C'U'                                        1006
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@Y30SSSB*/
*                                                                  1007
         L     @08,IOCSOUP                                         1007
         MVC   IOCDAD(4,@08),DMADDR1                               1007
*                IF TESTRC=0 THEN            /*I/O ERROR     @Y30SSSB*/
         LH    @04,TESTRC                                          1008
         LTR   @04,@04                                             1008
         BNZ   @RF01008                                            1008
*                  DO;                       /* NO           @Y30SSSB*/
*                                                                  1009
*                    /* QUIESCE THE UPDATE RPL               @Y30SSSB*/
*                                                                  1010
*                    REG1 = IOCSOUP -> IOCEXT -> IOCRPL;   /*@Y30SSSB*/
         L     @08,IOCEXT(,@08)                                    1010
         L     REG1,IOCRPL(,@08)                                   1010
*                    GEN(ENDREQ RPL=(1) );                 /*@Y30SSSB*/
*                                                                  1011
         ENDREQ RPL=(1)
*                    /* PERFORM THE INSERT AND SET LAST I/O  @Y30SSSB*/
*                    /* AS AN INSERT.                        @Y30SSSB*/
*                                                                  1012
*                    IOCSOUT -> IOCDAD = IOCDAD;           /*@Y30SSSB*/
         L     @08,IOCSOUT                                         1012
         L     @04,IOCSPTR                                         1012
         L     @15,IOCDAD(,@04)                                    1012
         ST    @15,IOCDAD(,@08)                                    1012
*                    IOCSOUT -> IOCDLN = IOCDLN;           /*@Y30SSSB*/
*                                                                  1013
         MVC   IOCDLN(4,@08),IOCDLN(@04)                           1013
*                    DMNAME1 = 'INSOTREC';                 /*@Y30SSSB*/
         MVC   DMNAME1(8),@CC01204                                 1014
*                    DMADDR1 = IOCSOUT -> IOCDAD;          /*@Y30SSSB*/
*                                                                  1015
         ST    @15,@TF00001                                        1015
         MVC   DMADDR1(4),@TF00001                                 1015
*                    CALL IDCIOPT0 (GDTTBL,IOCSOUT);       /*@Y30SSSB*/
         L     @08,@PC00001                                        1016
         ST    @08,@AL00001                                        1016
         LA    @04,IOCSOUT                                         1016
         ST    @04,@AL00001+4                                      1016
         MVI   @AL00001+4,X'80'                                    1016
         L     @15,GDTPUT(,@08)                                    1016
         LA    @01,@AL00001                                        1016
         BALR  @14,@15                                             1016
*                    RESPECIFY RTNREG RSTD;                        1017
*                    TESTRC = RTNREG;                              1018
         STH   RTNREG,TESTRC                                       1018
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSSB*/
*                                                                  1019
*                    IOPOSSW = 'I';                        /*@Y30SSSB*/
         MVI   IOPOSSW,C'I'                                        1020
*                    IF TESTRC=0 THEN        /*I/O ERROR     @Y30SSSB*/
         LH    @08,TESTRC                                          1021
         LTR   @08,@08                                             1021
         BNZ   @RF01021                                            1021
*                      DO;                   /* NO           @Y30SSSB*/
*                                                                  1022
*                        /* QUIESCE THE INSERT RPL AND       @Y30SSSB*/
*                        /* REPOSITION THE UPDATE RPL        @Y30SSSB*/
*                                                                  1023
*                        REG1=IOCSOUT->IOCEXT->IOCRPL;     /*@Y30SSSB*/
         L     @08,IOCSOUT                                         1023
         L     @08,IOCEXT(,@08)                                    1023
         L     REG1,IOCRPL(,@08)                                   1023
*                        GEN(ENDREQ RPL=(1) );             /*@Y30SSSB*/
*                                                                  1024
         ENDREQ RPL=(1)
*                        CURRKEYT=IOCSINP->IOCDAD->                1025
*                         CATLREC(1:44);                   /*@Y30SSSB*/
*                                                                  1025
         L     @08,IOCSINP                                         1025
         L     @08,IOCDAD(,@08)                                    1025
         MVC   CURRKEYT(44),CATLREC(@08)                           1025
*                        IOCSOUP->IOCKYA=ADDR(CURRKEYT);   /*@Y30SSSB*/
         LA    @08,CURRKEYT                                        1026
         L     @04,IOCSOUP                                         1026
         ST    @08,IOCKYA(,@04)                                    1026
*                        CALL IDCIOPO0 (GDTTBL,IOCSOUP);   /*@Y30SSSB*/
         L     @08,@PC00001                                        1027
         ST    @08,@AL00001                                        1027
         LA    @04,IOCSOUP                                         1027
         ST    @04,@AL00001+4                                      1027
         MVI   @AL00001+4,X'80'                                    1027
         L     @15,GDTPOS(,@08)                                    1027
         LA    @01,@AL00001                                        1027
         BALR  @14,@15                                             1027
*                        RESPECIFY RTNREG RSTD;                    1028
*                        TESTRC = RTNREG;                          1029
         STH   RTNREG,TESTRC                                       1029
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSSB*/
*                                                                  1030
*                        IF TESTRC=0 THEN    /*I/O ERROR     @Y30SSSB*/
         LH    @08,TESTRC                                          1031
         LTR   @08,@08                                             1031
         BNZ   @RF01031                                            1031
*                          DO;               /* NO           @Y30SSSB*/
*                                                                  1032
*                            CALL IDCIOGT0   (GDTTBL,IOCSOUP);/*   1033
*                                                            @Y30SSSB*/
         L     @08,@PC00001                                        1033
         ST    @08,@AL00001                                        1033
         LA    @04,IOCSOUP                                         1033
         ST    @04,@AL00001+4                                      1033
         MVI   @AL00001+4,X'80'                                    1033
         L     @15,GDTGET(,@08)                                    1033
         LA    @01,@AL00001                                        1033
         BALR  @14,@15                                             1033
*                            RESPECIFY RTNREG RSTD;                1034
*                            TESTRC = RTNREG;                      1035
         STH   RTNREG,TESTRC                                       1035
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSSB*/
*                                                                  1036
*                          END;                            /*@Y30SSSB*/
*                        IOPOSSW='U';                      /*@Y30SSSB*/
@RF01031 MVI   IOPOSSW,C'U'                                        1038
*                      END;                                /*@Y30SSSB*/
*                  END;                                    /*@Y30SSSB*/
*              END;                                        /*@Y30SSSB*/
*            ELSE                       /*FULL KEYS DO MATCH @Y30SSSB*/
*              DO;                                         /*@Y30SSSB*/
*                                                                  1042
         B     @RC00994                                            1042
@RF00994 DS    0H                                                  1043
*                /* UPDATE THE TRUENAME AND SET THE LAST     @Y30SSSB*/
*                /* OPERATION WAS UPDATE.                    @Y30SSSB*/
*                                                                  1043
*                DMNAME1 = 'UPOUTREC';                     /*@Y30SSSB*/
         MVC   DMNAME1(8),@CC01207                                 1043
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@Y30SSSB*/
*                                                                  1044
         L     @08,IOCSOUP                                         1044
         MVC   DMADDR1(4),IOCDAD(@08)                              1044
*                CALL IDCIOPT0 (GDTTBL,IOCSOUP);           /*@Y30SSSB*/
         L     @08,@PC00001                                        1045
         ST    @08,@AL00001                                        1045
         LA    @04,IOCSOUP                                         1045
         ST    @04,@AL00001+4                                      1045
         MVI   @AL00001+4,X'80'                                    1045
         L     @15,GDTPUT(,@08)                                    1045
         LA    @01,@AL00001                                        1045
         BALR  @14,@15                                             1045
*                RESPECIFY RTNREG RSTD;                            1046
*                TESTRC = RTNREG;                                  1047
         STH   RTNREG,TESTRC                                       1047
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSSB*/
*                                                                  1048
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@Y30SSSB*/
*                                                                  1049
         L     @08,IOCSOUP                                         1049
         MVC   IOCDAD(4,@08),DMADDR1                               1049
*                IOPOSSW = 'U';                            /*@Y30SSSB*/
         MVI   IOPOSSW,C'U'                                        1050
*              END;                                        /*@Y30SSSB*/
*            END;                                          /*@OZ17081*/
@RC00994 DS    0H                                                  1053
*            IF GDTDBG = NULLPTR                                   1053
*              THEN;                                       /*@OZ00751*/
@RT00991 L     @08,@PC00001                                        1053
         L     @08,GDTDBG(,@08)                                    1053
         LTR   @08,@08                                             1053
         BZ    @RT01053                                            1053
*              ELSE                                                1055
*                CALL DUMPIT;                              /*@OZ00751*/
*                                                                  1055
         BAL   @14,DUMPIT                                          1055
*            IF TESTRC ^= 0                                        1056
*              THEN                                                1056
@RT01053 LH    @08,TESTRC                                          1056
         LTR   @08,@08                                             1056
         BZ    @RF01056                                            1056
*                STATFLG = TERMERR;                        /*@OZ00751*/
*                                                                  1057
         MVC   STATFLG(5),@CB00819                                 1057
*            END;                                          /*@OZ00751*/
*                                                                  1058
@RF01056 DS    0H                                                  1059
*      END MAIN;                                           /*@OZ00751*/
*                                                                  1059
@RF00959 DS    0H                                                  1059
@DE00857 CLC   STATFLG(5),@CB00819                                 1059
         BE    @DC00857                                            1059
         CLC   EOFSW(2),@CH00162                                   1059
         BNE   @DL00857                                            1059
@DC00857 DS    0H                                                  1060
*/********************************************************************/
*/*                                                                  */
*/* THE MAIN JOB LEFT TO BE DONE AFTER ALL BACKUP RECORDS    @OZ00751*/
*/* HAVE BEEN WRITTEN TO THE TARGET IS TO UPDATE THE CATALOG @OZ00751*/
*/* CONTROL RECORD. THE CATALOG FREE RECORD POINTERS AND     @OZ00751*/
*/* COUNTERS HAVE TO BE UPDATED, ALSO THE RBA FIELDS SHOULD  @OZ00751*/
*/* BE CLEARED. CATALOG MANAGEMENT WILL SET UP THE NEW RBA   @OZ00751*/
*/* POINTERS NEXT TIME THE CATALOG IS OPENED.                @OZ00751*/
*/* ANOTHER TASK TO BE DONE IS TO PUT OUT A MESSAGE          @OZ00751*/
*/* INDICATING THAT THE CATALOGS MATCHED OK IF CATALOG       @OZ00751*/
*/* COMPARISON WAS POSSIBLE                                  @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1060
*    IF STATFLG ^= TERMERR                                         1060
*      THEN                                                        1060
         CLC   STATFLG(5),@CB00819                                 1060
         BE    @RF01060                                            1060
*EOJ:    DO;                                               /*@OZ00751*/
*                                                                  1061
EOJ      DS    0H                                                  1062
*        IF IOPOSSW = 'I'                                          1062
*          THEN                                                    1062
         CLI   IOPOSSW,C'I'                                        1062
         BNE   @RF01062                                            1062
*            DO;                                           /*@OZ00751*/
*                                                                  1063
*            /********************************************************/
*            /*                                              @OZ00751*/
*            /* IF THE LAST REQUEST WAS FOR AN INSERT        @OZ00751*/
*            /* THEN THE INSERT RPL HAS TO BE                @OZ00751*/
*            /* QUIESCED AND THE UPDATE RPL                  @OZ00751*/
*            /* REPOSITIONED.                                @OZ00751*/
*            /*                                              @OZ00751*/
*            /********************************************************/
*                                                                  1064
*            REG1 = IOCSOUT -> IOCEXT -> IOCRPL;           /*@OZ00751*/
         L     @08,IOCSOUT                                         1064
         L     @08,IOCEXT(,@08)                                    1064
         L     REG1,IOCRPL(,@08)                                   1064
*            GEN(ENDREQ RPL=(1) );                         /*@OZ00751*/
*                                                                  1065
         ENDREQ RPL=(1)
*            END;                                                  1066
*                                                                  1066
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* THE FIRST THING TO DO IS TO POSITION AT THE      @OZ00751*/
*        /* CATALOG CONTROL RECORD OF THE TARGET             @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1067
*        IOCSOUP -> IOCEXT -> IOCFLGEF = OFF;              /*@Y30SSEC*/
*                                                                  1067
*                                                                  1067
@RF01062 L     @08,IOCSOUP                                         1067
         L     @01,IOCEXT(,@08)                                    1067
         NI    IOCFLGEF(@01),B'11011111'                           1067
*        IOCSOUP -> IOCKYA = ADDR(CCRECSTR);               /*@OZ00751*/
         LA    @15,CCRECSTR                                        1068
         ST    @15,IOCKYA(,@08)                                    1068
*        CALL IDCIOPO0 (GDTTBL,IOCSOUP);                   /*@OZ00751*/
         L     @08,@PC00001                                        1069
         ST    @08,@AL00001                                        1069
         LA    @15,IOCSOUP                                         1069
         ST    @15,@AL00001+4                                      1069
         MVI   @AL00001+4,X'80'                                    1069
         L     @15,GDTPOS(,@08)                                    1069
         LA    @01,@AL00001                                        1069
         BALR  @14,@15                                             1069
*        RESPECIFY RTNREG RSTD;                                    1070
*        TESTRC = RTNREG;                                          1071
         STH   RTNREG,TESTRC                                       1071
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/
*                                                                  1072
*        IF TESTRC = 0                                             1073
*          THEN                                                    1073
         LH    @08,TESTRC                                          1073
         LTR   @08,@08                                             1073
         BNZ   @RF01073                                            1073
*            CALL IDCIOGT0 (GDTTBL,IOCSOUP);               /*@OZ00751*/
         L     @08,@PC00001                                        1074
         ST    @08,@AL00001                                        1074
         LA    @15,IOCSOUP                                         1074
         ST    @15,@AL00001+4                                      1074
         MVI   @AL00001+4,X'80'                                    1074
         L     @15,GDTGET(,@08)                                    1074
         LA    @01,@AL00001                                        1074
         BALR  @14,@15                                             1074
*        RESPECIFY RTNREG RSTD;                                    1075
@RF01073 DS    0H                                                  1076
*        TESTRC = RTNREG;                                          1076
         STH   RTNREG,TESTRC                                       1076
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/
*                                                                  1077
*        IF GDTDBG = NULLPTR                                       1078
*          THEN;                                           /*@OZ00751*/
         L     @08,@PC00001                                        1078
         L     @08,GDTDBG(,@08)                                    1078
         LTR   @08,@08                                             1078
         BZ    @RT01078                                            1078
*          ELSE                                                    1080
*            DO;                                           /*@OZ00751*/
*                                                                  1080
*            DMNAME1 = 'RDCCREC';                          /*@OZ00751*/
         MVI   DMNAME1+7,C' '                                      1081
         MVC   DMNAME1(7),@CC01210                                 1081
*            DMADDR1 = IOCSOUP -> IOCDAD;                  /*@OZ00751*/
         L     @08,IOCSOUP                                         1082
         MVC   DMADDR1(4),IOCDAD(@08)                              1082
*            CALL DUMPIT;                                  /*@OZ00751*/
*                                                                  1083
         BAL   @14,DUMPIT                                          1083
*            END;                                          /*@OZ00751*/
*                                                                  1084
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* THE CATALOG CONTROL RECORD CI #S SHOULD BE       @OZ00751*/
*        /* UPDATED AND THEN WRITTEN OUT                     @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1085
*        IF TESTRC = 0                                             1085
*          THEN                                                    1085
@RT01078 LH    @08,TESTRC                                          1085
         LTR   @08,@08                                             1085
         BNZ   @RF01085                                            1085
*            DO;                                           /*@OZ00751*/
*                                                                  1086
*            IOCSPTR = IOCSOUP;                            /*@OZ00751*/
*                                                                  1087
         MVC   IOCSPTR(4),IOCSOUP                                  1087
*            RFY RCIADDR RSTD;                             /*@OZ00751*/
*            RCIADDR = ADDR(NFCISTOR);                     /*@OZ00751*/
         LA    RCIADDR,NFCISTOR                                    1089
*            CALL CNVRTCI;                                 /*@OZ00751*/
         BAL   @14,CNVRTCI                                         1090
*            RFY RCIADDR UNRSTD;                           /*@OZ00751*/
*                                                                  1091
*            IF CCRNFCI < NFCISTOR                                 1092
*              THEN                                                1092
         L     @08,IOCSPTR                                         1092
         L     @08,IOCDAD(,@08)                                    1092
         CLC   CCRNFCI(3,@08),NFCISTOR                             1092
         BNL   @RF01092                                            1092
*                CCRNFCI = NFCISTOR;                       /*@OZ00751*/
*                                                                  1093
         MVC   CCRNFCI(3,@08),NFCISTOR                             1093
*            CCRNUM = FREENUM;                             /*@OZ00751*/
@RF01092 L     @08,IOCSPTR                                         1094
         L     @08,IOCDAD(,@08)                                    1094
         MVC   CCRNUM(3,@08),FREENUM+1                             1094
*            CCRFDCI = CFROLD;                             /*@OZ00751*/
*                                                                  1095
         MVC   CCRFDCI(3,@08),CFROLD                               1095
*            IOCSPTR = IOCSINP;                            /*@OZ00751*/
*                                                                  1096
         MVC   IOCSPTR(4),IOCSINP                                  1096
*            IOCSOUP -> IOCDAD -> RBAFIELD = ''B;          /*@OZ00751*/
*                                                                  1097
         L     @08,IOCSOUP                                         1097
         L     @08,IOCDAD(,@08)                                    1097
         XC    RBAFIELD(48,@08),RBAFIELD(@08)                      1097
*            DMNAME1 = 'UPCCREC';                          /*@OZ00751*/
         MVI   DMNAME1+7,C' '                                      1098
         MVC   DMNAME1(7),@CC01211                                 1098
*            DMADDR1 = IOCSOUP -> IOCDAD;                  /*@OZ00751*/
*                                                                  1099
         ST    @08,@TF00001                                        1099
         MVC   DMADDR1(4),@TF00001                                 1099
*            CALL IDCIOPT0      (GDTTBL,IOCSOUP);          /*@OZ00751*/
         L     @08,@PC00001                                        1100
         ST    @08,@AL00001                                        1100
         LA    @15,IOCSOUP                                         1100
         ST    @15,@AL00001+4                                      1100
         MVI   @AL00001+4,X'80'                                    1100
         L     @15,GDTPUT(,@08)                                    1100
         LA    @01,@AL00001                                        1100
         BALR  @14,@15                                             1100
*            RESPECIFY RTNREG RSTD;                                1101
*            TESTRC = RTNREG;                                      1102
         STH   RTNREG,TESTRC                                       1102
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/
*                                                                  1103
*            IF GDTDBG = NULLPTR                                   1104
*              THEN;                                       /*@OZ00751*/
         L     @08,@PC00001                                        1104
         L     @08,GDTDBG(,@08)                                    1104
         LTR   @08,@08                                             1104
         BZ    @RT01104                                            1104
*              ELSE                                                1106
*                CALL DUMPIT;                              /*@OZ00751*/
*                                                                  1106
         BAL   @14,DUMPIT                                          1106
*            END;                                          /*@OZ00751*/
@RT01104 DS    0H                                                  1108
*        IF TESTRC ^= 0                                            1108
*          THEN                                                    1108
@RF01085 LH    @08,TESTRC                                          1108
         LTR   @08,@08                                             1108
         BZ    @RF01108                                            1108
*            STATFLG = TERMERR;                            /*@OZ00751*/
*                                                                  1109
         MVC   STATFLG(5),@CB00819                                 1109
*        END EOJ;                                          /*@OZ00751*/
*                                                                  1110
@RF01108 DS    0H                                                  1111
*        CALL IDCIOCL0 (GDTTBL,IOCSOUP);/*                         1111
*                                     CLOSE UPDATE FILE      @OZ00751*/
*                                                                  1111
*                                                                  1111
@RF01060 L     @08,@PC00001                                        1111
         ST    @08,@AL00001                                        1111
         LA    @15,IOCSOUP                                         1111
         ST    @15,@AL00001+4                                      1111
         MVI   @AL00001+4,X'80'                                    1111
         L     @15,GDTCLS(,@08)                                    1111
         LA    @01,@AL00001                                        1111
         BALR  @14,@15                                             1111
*        RETURN;                                           /*@OZ00751*/
*                                                                  1112
*                                                                  1112
@EL00003 DS    0H                                                  1112
@EF00003 DS    0H                                                  1112
@ER00003 LM    @14,@12,@SA00003                                    1112
         BR    @14                                                 1112
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - SORSREAD                                @OZ00751*/
*/*                                                          @OZ00751*/
*/* THIS IS A CATALOG RELOAD PROCEDURE TO READ A RECORD FROM @OZ00751*/
*/* THE BACKUP CATALOG AND TAKE ACTION IF THE RETURN CODE IS @OZ00751*/
*/* NON ZERO.                                                @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1113
*SORSREAD:                                                         1113
*        PROC;                                             /*@OZ00751*/
*                                                                  1113
SORSREAD STM   @14,@12,@SA00004                                    1113
*        CALL IDCIOGT0 (GDTTBL,IOCSINP);                   /*@OZ00751*/
         L     @08,@PC00001                                        1114
         ST    @08,@AL00001                                        1114
         LA    @15,IOCSINP                                         1114
         ST    @15,@AL00001+4                                      1114
         MVI   @AL00001+4,X'80'                                    1114
         L     @15,GDTGET(,@08)                                    1114
         LA    @01,@AL00001                                        1114
         BALR  @14,@15                                             1114
*        RESPECIFY RTNREG RSTD;                                    1115
*        TESTRC = RTNREG;                                          1116
         STH   RTNREG,TESTRC                                       1116
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/
*                                                                  1117
*        IF GDTDBG = NULLPTR                                       1118
*          THEN;                                           /*@OZ00751*/
         L     @08,@PC00001                                        1118
         L     @08,GDTDBG(,@08)                                    1118
         LTR   @08,@08                                             1118
         BZ    @RT01118                                            1118
*          ELSE                                                    1120
*            DO;                                           /*@OZ00751*/
*                                                                  1120
*            DMNAME1 = 'RDINPREC';                         /*@OZ00751*/
         MVC   DMNAME1(8),@CC01215                                 1121
*            DMADDR1 = IOCSINP -> IOCDAD;                  /*@OZ00751*/
         L     @08,IOCSINP                                         1122
         MVC   DMADDR1(4),IOCDAD(@08)                              1122
*            CALL DUMPIT;                                  /*@OZ00751*/
*                                                                  1123
         BAL   @14,DUMPIT                                          1123
*            END;                                          /*@OZ00751*/
*                                                                  1124
*        IF TESTRC = 4                                             1125
*          THEN                                                    1125
@RT01118 CLC   TESTRC(2),@CH00042                                  1125
         BNE   @RF01125                                            1125
*          STATFLG = TERMERR;                              /*@OZ00751*/
*                                                                  1126
         MVC   STATFLG(5),@CB00819                                 1126
*      IF TESTRC = 16                                              1127
*        THEN                                                      1127
@RF01125 CLC   TESTRC(2),@CH00476                                  1127
         BNE   @RF01127                                            1127
*          DO;                                             /*@OZ00751*/
*                                                                  1128
*          IOCSINP -> IOCDAD -> RECKEY = 'FE'X;            /*@OZ00751*/
         L     @08,IOCSINP                                         1129
         L     @08,IOCDAD(,@08)                                    1129
         XC    RECKEY+1(43,@08),RECKEY+1(@08)                      1129
         MVI   RECKEY(@08),X'FE'                                   1129
*          EOFSW = EOFSW + SORSEOF;                        /*@OZ00751*/
*                                                                  1130
         LH    @08,EOFSW                                           1130
         LA    @08,1(,@08)                                         1130
         STH   @08,EOFSW                                           1130
*          END;                                            /*@OZ00751*/
*                                                                  1131
*        END SORSREAD;                                             1132
*                                                                  1132
@EL00004 DS    0H                                                  1132
@EF00004 DS    0H                                                  1132
@ER00004 LM    @14,@12,@SA00004                                    1132
         BR    @14                                                 1132
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - TARGREAD                                @OZ00751*/
*/*                                                          @OZ00751*/
*/* THIS IS A CATALOG RELOAD PROCEEDURE TO READ A RECORD FROM@OZ00751*/
*/* THE TARGET CATALOG AND TAKE ACTION IF THE RETURN CODE IS @OZ00751*/
*/* NON ZERO                                                 @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1133
*TARGREAD:                                                         1133
*        PROC;                                             /*@OZ00751*/
*                                                                  1133
TARGREAD STM   @14,@12,@SA00005                                    1133
*        CALL IDCIOGT0  (GDTTBL,IOCSOUP);                  /*@OZ00751*/
         L     @08,@PC00001                                        1134
         ST    @08,@AL00001                                        1134
         LA    @15,IOCSOUP                                         1134
         ST    @15,@AL00001+4                                      1134
         MVI   @AL00001+4,X'80'                                    1134
         L     @15,GDTGET(,@08)                                    1134
         LA    @01,@AL00001                                        1134
         BALR  @14,@15                                             1134
*        RESPECIFY RTNREG RSTD;                                    1135
*        TESTRC = RTNREG;                                          1136
         STH   RTNREG,TESTRC                                       1136
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/
*                                                                  1137
*        CURRKEYT =IOCSOUP -> IOCDAD -> CATLREC(1:44);     /*@OZ00751*/
*                                                                  1138
         L     @08,IOCSOUP                                         1138
         L     @08,IOCDAD(,@08)                                    1138
         MVC   CURRKEYT(44),CATLREC(@08)                           1138
*        IF GDTDBG = NULLPTR                                       1139
*          THEN;                                           /*@OZ00751*/
         L     @08,@PC00001                                        1139
         L     @08,GDTDBG(,@08)                                    1139
         LTR   @08,@08                                             1139
         BZ    @RT01139                                            1139
*          ELSE                                                    1141
*            DO;                                           /*@OZ00751*/
*                                                                  1141
*            DMNAME1 = 'RDOUTREC';                         /*@OZ00751*/
         MVC   DMNAME1(8),@CC01220                                 1142
*            DMADDR1 = IOCSOUP -> IOCDAD;                  /*@OZ00751*/
         L     @08,IOCSOUP                                         1143
         MVC   DMADDR1(4),IOCDAD(@08)                              1143
*            CALL DUMPIT;                                  /*@OZ00751*/
*                                                                  1144
         BAL   @14,DUMPIT                                          1144
*            END;                                          /*@OZ00751*/
*                                                                  1145
*        IF TESTRC = 4                                             1146
*          THEN                                                    1146
@RT01139 CLC   TESTRC(2),@CH00042                                  1146
         BNE   @RF01146                                            1146
*            STATFLG = TERMERR;                            /*@OZ00751*/
*                                                                  1147
         MVC   STATFLG(5),@CB00819                                 1147
*        IF TESTRC = 16                                            1148
*          THEN                                                    1148
@RF01146 CLC   TESTRC(2),@CH00476                                  1148
         BNE   @RF01148                                            1148
*            DO;                                           /*@OZ00751*/
*                                                                  1149
*            IOCSOUP -> IOCDAD -> RECKEY = 'FE'X;          /*@OZ00751*/
         L     @08,IOCSOUP                                         1150
         L     @08,IOCDAD(,@08)                                    1150
         XC    RECKEY+1(43,@08),RECKEY+1(@08)                      1150
         MVI   RECKEY(@08),X'FE'                                   1150
*            EOFSW = EOFSW + TARGEOF;                      /*@OZ00751*/
*                                                                  1151
         LH    @08,EOFSW                                           1151
         LA    @08,2(,@08)                                         1151
         STH   @08,EOFSW                                           1151
*            END;                                          /*@OZ00751*/
*                                                                  1152
*        END TARGREAD;                                     /*@OZ00751*/
*                                                                  1153
@EL00005 DS    0H                                                  1153
@EF00005 DS    0H                                                  1153
@ER00005 LM    @14,@12,@SA00005                                    1153
         BR    @14                                                 1153
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - GETPAIR                                 @OZ00751*/
*/*                                                          @OZ00751*/
*/* A SIMPLE PROCEEDURE TO READ A BACKUP AND TARGET RECORD   @OZ00751*/
*/* PROVIDED THE RETURN CODE IS ZERO                         @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1154
* GETPAIR:                                                         1154
*        PROC;                                             /*@OZ00751*/
*                                                                  1154
GETPAIR  STM   @14,@12,@SA00006                                    1154
*        IF TESTRC = 0                                     /*@OZ00751*/
*          THEN                                                    1155
         LH    @08,TESTRC                                          1155
         LTR   @08,@08                                             1155
         BNZ   @RF01155                                            1155
*            DO;                                           /*@OZ00751*/
*                                                                  1156
*            CALL IDCIOGT0 (GDTTBL,IOCSINP);               /*@OZ00751*/
         L     @08,@PC00001                                        1157
         ST    @08,@AL00001                                        1157
         LA    @15,IOCSINP                                         1157
         ST    @15,@AL00001+4                                      1157
         MVI   @AL00001+4,X'80'                                    1157
         L     @15,GDTGET(,@08)                                    1157
         LA    @01,@AL00001                                        1157
         BALR  @14,@15                                             1157
*            RESPECIFY RTNREG RSTD;                                1158
*            TESTRC = RTNREG;                                      1159
         STH   RTNREG,TESTRC                                       1159
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/
*                                                                  1160
*            IF GDTDBG = NULLPTR                                   1161
*              THEN;                                       /*@OZ00751*/
         L     @08,@PC00001                                        1161
         L     @08,GDTDBG(,@08)                                    1161
         LTR   @08,@08                                             1161
         BZ    @RT01161                                            1161
*              ELSE                                                1163
*                DO;                                       /*@OZ00751*/
*                                                                  1163
*                DMNAME1 = 'RDINPREC';                     /*@OZ00751*/
         MVC   DMNAME1(8),@CC01215                                 1164
*                DMADDR1= IOCSINP ->  IOCDAD;              /*@OZ00751*/
         L     @08,IOCSINP                                         1165
         MVC   DMADDR1(4),IOCDAD(@08)                              1165
*                CALL DUMPIT;                              /*@OZ00751*/
*                                                                  1166
         BAL   @14,DUMPIT                                          1166
*                END;                                      /*@OZ00751*/
*                                                                  1167
*            END;                                          /*@OZ00751*/
*                                                                  1168
@RT01161 DS    0H                                                  1169
*        IF TESTRC = 0                                             1169
*          THEN                                                    1169
@RF01155 LH    @08,TESTRC                                          1169
         LTR   @08,@08                                             1169
         BNZ   @RF01169                                            1169
*            DO;                                           /*@OZ00751*/
*                                                                  1170
*            CALL IDCIOGT0 (GDTTBL,IOCSOUP);               /*@OZ00751*/
         L     @08,@PC00001                                        1171
         ST    @08,@AL00001                                        1171
         LA    @15,IOCSOUP                                         1171
         ST    @15,@AL00001+4                                      1171
         MVI   @AL00001+4,X'80'                                    1171
         L     @15,GDTGET(,@08)                                    1171
         LA    @01,@AL00001                                        1171
         BALR  @14,@15                                             1171
*            RESPECIFY RTNREG RSTD;                                1172
*            TESTRC = RTNREG;                                      1173
         STH   RTNREG,TESTRC                                       1173
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/
*                                                                  1174
*            IF GDTDBG = NULLPTR                                   1175
*              THEN;                                       /*@OZ00751*/
         L     @08,@PC00001                                        1175
         L     @08,GDTDBG(,@08)                                    1175
         LTR   @08,@08                                             1175
         BZ    @RT01175                                            1175
*              ELSE                                                1177
*                DO;                                       /*@OZ00751*/
*                                                                  1177
*                DMNAME1 = 'RDOUTREC';                     /*@OZ00751*/
         MVC   DMNAME1(8),@CC01220                                 1178
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@OZ00751*/
         L     @08,IOCSOUP                                         1179
         MVC   DMADDR1(4),IOCDAD(@08)                              1179
*                CALL DUMPIT;                              /*@OZ00751*/
*                                                                  1180
         BAL   @14,DUMPIT                                          1180
*                END;                                      /*@OZ00751*/
*                                                                  1181
*            END;                                                  1182
*                                                                  1182
*        END GETPAIR;                                      /*@OZ00751*/
*                                                                  1183
@EL00006 DS    0H                                                  1183
@EF00006 DS    0H                                                  1183
@ER00006 LM    @14,@12,@SA00006                                    1183
         BR    @14                                                 1183
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - DUMPIT                                  @OZ00751*/
*/*                                                          @OZ00751*/
*/* FUNCTION - THIS ROUTINE IS ACTIVATED BY THE AMS PARM     @OZ00751*/
*/*            TEST FUNCTION. IT WILL TRACE ALL I/O FOR      @OZ00751*/
*/*            CATALOG RELOAD IF THE AREAS(RP) SUB PARAMETER @OZ00751*/
*/*            IS USED.                                      @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1184
*DUMPIT:                                                           1184
*        PROC;                                             /*@OZ00751*/
DUMPIT   STM   @14,@12,@SA00007                                    1184
*        DMPINDEX = ADDR(DUMPAREA);                        /*@OZ00751*/
         LA    @08,DUMPAREA                                        1185
         ST    @08,DMPINDEX                                        1185
*        IF DMADDR1 -> RCDKEYTY ^= NULL                            1186
*          THEN                                                    1186
         MVC   @TF00001(4),DMADDR1                                 1186
         L     @01,@TF00001                                        1186
         CLI   RCDKEYTY(@01),0                                     1186
         BE    @RF01186                                            1186
*            DO;                                           /*@OZ00751*/
*                                                                  1187
*            DMPITMLN = 47;                                /*@OZ00751*/
         MVC   DMPITMLN(2,@08),@CH01205                            1188
*            DMPITMTP = 'C';                               /*@OZ00751*/
*                                                                  1189
         MVI   DMPITMTP(@08),C'C'                                  1189
*            END;                                                  1190
*          ELSE                                                    1191
*            DO;                                           /*@OZ00751*/
*                                                                  1191
         B     @RC01186                                            1191
@RF01186 DS    0H                                                  1192
*            DMPITMLN = 255;                               /*@OZ00751*/
         LA    @08,255                                             1192
         L     @15,DMPINDEX                                        1192
         STH   @08,DMPITMLN(,@15)                                  1192
*            DMPITMTP = 'H';                               /*@OZ00751*/
         MVI   DMPITMTP(@15),C'H'                                  1193
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/
         AH    @15,@CH00476                                        1194
         ST    @15,DMPINDEX                                        1194
*            DMPITMNM = '2ND-HALF';                        /*@OZ00751*/
         MVC   DMPITMNM(8,@15),@CC01228                            1195
*            DMPITMPT = DMADDR1 + 255;                     /*@OZ00751*/
         MVC   @TF00001(4),DMADDR1                                 1196
         AL    @08,@TF00001                                        1196
         ST    @08,DMPITMPT(,@15)                                  1196
*            DMPITMLN = 250;                               /*@OZ00751*/
         MVC   DMPITMLN(2,@15),@CH01229                            1197
*            DMPITMTP = 'H';                               /*@OZ00751*/
*                                                                  1198
         MVI   DMPITMTP(@15),C'H'                                  1198
*            END;                                          /*@OZ00751*/
*                                                                  1199
*        DMPINDEX = DMPINDEX + DMPELEMT;                   /*@OZ00751*/
@RC01186 LA    @08,16                                              1200
         L     @15,DMPINDEX                                        1200
         ALR   @15,@08                                             1200
         ST    @15,DMPINDEX                                        1200
*        DMPITMNM = 'RET-CODE';                            /*@OZ00751*/
         MVC   DMPITMNM(8,@15),@CC01230                            1201
*        DMPITMPT = ADDR(TESTRC);                          /*@OZ00751*/
         LA    @14,TESTRC                                          1202
         ST    @14,DMPITMPT(,@15)                                  1202
*        DMPITMLN = 2;                                     /*@OZ00751*/
         MVC   DMPITMLN(2,@15),@CH00153                            1203
*        DMPITMTP = 'F';                                   /*@OZ00751*/
         MVI   DMPITMTP(@15),C'F'                                  1204
*        DMPINDEX = DMPINDEX + DMPELEMT;                   /*@OZ00751*/
         ALR   @15,@08                                             1205
         ST    @15,DMPINDEX                                        1205
*        DMPTRM = DMPTRMVL;                                /*@OZ00751*/
*                                                                  1206
         MVI   DMPTRM(@15),X'FF'                                   1206
*        IF GDTDBG = NULLPTR                                       1207
*          THEN;                                                   1207
         L     @08,@PC00001                                        1207
         L     @08,GDTDBG(,@08)                                    1207
         LTR   @08,@08                                             1207
         BZ    @RT01207                                            1207
*          ELSE                                                    1209
*            CALL IDCDB010 (GDTTBL,'RPIO',ADDR(DUMPAREA));         1209
         L     @08,@PC00001                                        1209
         ST    @08,@AL00001                                        1209
         LA    @15,@CC01231                                        1209
         ST    @15,@AL00001+4                                      1209
         LA    @15,DUMPAREA                                        1209
         ST    @15,@AFTEMPS                                        1209
         LA    @15,@AFTEMPS                                        1209
         ST    @15,@AL00001+8                                      1209
         MVI   @AL00001+8,X'80'                                    1209
         L     @15,GDTDBG(,@08)                                    1209
         LA    @01,@AL00001                                        1209
         BALR  @14,@15                                             1209
*                                                          /*@OZ00751*/
*                                                                  1210
*        END DUMPIT;                                       /*@OZ00751*/
*                                                                  1210
@EL00007 DS    0H                                                  1210
@EF00007 DS    0H                                                  1210
@ER00007 LM    @14,@12,@SA00007                                    1210
         BR    @14                                                 1210
*TRUENAME:                                                         1211
*        PROC;                                             /*@OZ00751*/
*                                                                  1211
TRUENAME STM   @14,@12,@SA00008                                    1211
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - TRUENAME                                @OZ00751*/
*/*                                                          @OZ00751*/
*/* FUNCTION - TRUENAME MAPS THE RBA BOUNDARIES OF THE       @OZ00751*/
*/*            BACKUP AND TARGET CATALOG TRUENAME RANGES.    @OZ00751*/
*/*            THIS IS NECESSARY SINCE A VSAM CATALOG        @OZ00751*/
*/*            (RATHER LIKE THE OS SVCLIB) CONTAINS INTERNAL @OZ00751*/
*/*            POINTERS AND IF THE CATALOG IS MOVED THEN     @OZ00751*/
*/*            THE INTERNAL POINTERS MUST BE ADJUSTED        @OZ00751*/
*/*            CORRECTLY.                                    @OZ00751*/
*/*              WHEN A CATALOG IS DEFINED THEN THE SPACE    @OZ00751*/
*/*            GIVEN IS SPLIT INTO A LOW KEY RANGE AND A HIGH@OZ00751*/
*/*            KEY RANGE (ALSO CALLED THE TRUENAME RANGE). A @OZ00751*/
*/*            CATALOG WOULD LOOK LIKE THIS WHEN FIRST       @OZ00751*/
*/*            DEFINED.                                      @OZ00751*/
*/*                          -------------                   @OZ00751*/
*/*                      *   ×  LOW-KEY  ×  FIRST DATA       @OZ00751*/
*/*                 DATA *   ×  RANGE    ×  EXTENT           @OZ00751*/
*/*                      *   ×           ×                   @OZ00751*/
*/*                          -------------                   @OZ00751*/
*/*                INDEX *   × INDEX     ×  FIRST INDX EXTENT@OZ00751*/
*/*                          -------------                   @OZ00751*/
*/*                      *   × TRUENAME  ×  SECOND DATA      @OZ00751*/
*/*                 DATA *   × RANGE     ×                   @OZ00751*/
*/*                          -------------                   @OZ00751*/
*/*            TO TAKE A COMPLICATED EXAMPLE:                @OZ00751*/
*/*            AFTER A PERIOD OF USE THE BACKUP CATALOG      @OZ00751*/
*/*            AND A NEWLY DEFINED TARGET ON THE SAME        @OZ00751*/
*/*            VOLUME WITH THE SAME NAME MIGHT HAVE A        @OZ00751*/
*/*            STRUCTURE LIKE.                               @OZ00751*/
*/*   BACKUP                            TARGET               @OZ00751*/
*/*   DATA STRUCTURE                    DATA STRUCTURE       @OZ00751*/
*/*                                                          @OZ00751*/
*/*-----------                       -----------             @OZ00751*/
*/*× 1ST LKR ×                       ×         ×             @OZ00751*/
*/*×---------× *                     ×         ×             @OZ00751*/
*/*× 1ST HKR × *LET X= RBA RANGE     ×         ×             @OZ00751*/
*/*×---------× *                     × 1ST LKR ×             @OZ00751*/
*/*× 2ND LKR ×                       ×         ×             @OZ00751*/
*/*×---------×                       ×         ×             @OZ00751*/
*/*× 3RD LKR ×                       ×---------×*            @OZ00751*/
*/*×---------× *                     × 1ST HKR ×*LET Z= RBA  @OZ00751*/
*/*× 2ND HKR × *LET Y= RBA RANGE     ×         ×* RANGE      @OZ00751*/
*/*×---------× *                     ×---------×*            @OZ00751*/
*/*× 4TH LKR ×                                               @OZ00751*/
*/*×---------×                                               @OZ00751*/
*/*            IT CAN BE SEEN,FOR EXAMPLE,THAT A POINTER     @OZ00751*/
*/*            TO A RECORD IN THE 4TH LOW KEY RANGE ON THE   @OZ00751*/
*/*            BACKUP WOULD HAVE TO BE ADJUSTED WHEN THE     @OZ00751*/
*/*            DATA SET IS COPIED,SINCE IT IS COPIED IN      @OZ00751*/
*/*            KEY SEQUENCE.                                 @OZ00751*/
*/*              IF THE NEW RECORD POSITION IS BELOW THE     @OZ00751*/
*/*            TRUENAME RANGE OF THE TARGET THEN THE         @OZ00751*/
*/*            ADJUSTMENT WOULD BE                           @OZ00751*/
*/*                                                          @OZ00751*/
*/*              NEW RBA  = OLD RBA -X -Y                    @OZ00751*/
*/*              IF THE RECORD WILL NOT FIT THEN A NEW DATA  @OZ00751*/
*/*            EXTENT IS OBTAINED FOR THE LOW KEY RANGE AND  @OZ00751*/
*/*            THE ADJUSTMENT WOULD BE                       @OZ00751*/
*/*                                                          @OZ00751*/
*/*              NEW RBA  = OLD RBA -X -Y +Z                 @OZ00751*/
*/*******                                                    *********/
*/* INPUT -    CATALOG CI # 7  RECORDS SERVE AS THE          @OZ00751*/
*/*            INFORMATION TO BUILD THE TRUENAME             @OZ00751*/
*/*            EXTENTS                                       @OZ00751*/
*/*                                                          @OZ00751*/
*/* OUTPUT-    STBL WHICH IS A SOURCE TABLE AND STBLDIM      @OZ00751*/
*/*            WHICH IS THE NUMBER OF ENTRIES IN THE TABLE   @OZ00751*/
*/*            ARE INITIALISED. SIMILARLY FOR THE TAGET TABLE@OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*        /************************************************************/
*         /*                                                 @OZ00751*/
*        /* POINT TO THE INPUT RECORD7 AND THENCE TO         @OZ00751*/
*        /* THE FIRST EXTENT FIELD. SET NUMBER OF ENTRIES    @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1212
*        RFY RREC RSTD;                                    /*@OZ00751*/
*                                                                  1212
*        OLDERID2 = NEWERID2;                                      1213
         L     @08,@PC00001                                        1213
         L     @08,GDTTR2(,@08)                                    1213
         MVC   @TS00001(95),NEWERID2(@08)                          1213
         MVC   OLDERID2(95,@08),@TS00001                           1213
*        NEWID2='RPT2';                                    /*@OZ00751*/
*                                                                  1214
         MVC   NEWID2(4,@08),@CC01235                              1214
*        RREC = IOCSINP -> IOCDAD;                         /*@OZ00751*/
         L     @08,IOCSINP                                         1215
         L     RREC,IOCDAD(,@08)                                   1215
*        RREC = ADDR(REC7INDX) + REC7OFFS + 6;             /*@OZ00751*/
         LA    @08,REC7INDX(,RREC)                                 1216
         MVC   @ZT00003+3(1),REC7OFFS(RREC)                        1216
         AL    @08,@ZT00003                                        1216
         AH    @08,@CH00156                                        1216
         LR    RREC,@08                                            1216
*        STBLDIM = REC7LNEX/LENGTH(REC7XTNT);              /*@OZ00751*/
*                                                                  1217
         MVC   @TF00001(2),REC7LNEX(RREC)                          1217
         LH    @00,@TF00001                                        1217
         SRDA  @00,32                                              1217
         D     @00,@CF01276                                        1217
         ST    @01,STBLDIM                                         1217
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* LOOP UP THE EXTENT ENTRIES CALCULATING AND       @OZ00751*/
*        /* STORING THE HIGH CI #S. AND THE ASSOCIATED       @OZ00751*/
*        /* GAP MEASURED IN CI 3S                            @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1218
*        DO I = 1 TO STBLDIM;                              /*@OZ00751*/
*                                                                  1218
         LA    I,1                                                 1218
         B     @DE01218                                            1218
@DL01218 DS    0H                                                  1219
*          STBLHI(I) = REC7HRBA(I)/CILEN;                  /*@OZ00751*/
         LR    @08,I                                               1219
         SLA   @08,3                                               1219
         LA    @15,512                                             1219
         LR    @14,I                                               1219
         MH    @14,@CH01276                                        1219
         ST    @14,@TF00001                                        1219
         ALR   @14,RREC                                            1219
         BCTR  @14,0                                               1219
         BCTR  @14,0                                               1219
         MVC   @TF00002(4),REC7HRBA-18(@14)                        1219
         L     @14,@TF00002                                        1219
         LR    @00,@14                                             1219
         SRDA  @00,32                                              1219
         DR    @00,@15                                             1219
         ST    @01,STBLHI-8(@08)                                   1219
*          STBLGAP(I) = (REC7HRBA(I) - REC7LRBA(I))/CILEN          1220
*                      +1 ;                                /*@OZ00751*/
*                                                                  1220
         LR    @01,RREC                                            1220
         AL    @01,@TF00001                                        1220
         AL    @01,@CF01305                                        1220
         MVC   @TF00001(4),REC7LRBA-14(@01)                        1220
         SL    @14,@TF00001                                        1220
         ST    @15,@TF00001                                        1220
         SRDA  @14,32                                              1220
         D     @14,@TF00001                                        1220
         AH    @15,@CH00219                                        1220
         ST    @15,STBLGAP-8(@08)                                  1220
*        END;                                              /*@OZ00751*/
*                                                                  1221
         AH    I,@CH00219                                          1221
@DE01218 C     I,STBLDIM                                           1221
         BNH   @DL01218                                            1221
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* THE ABOVE SOURCE TABLE INITIALISING IS           @OZ00751*/
*        /* REPEATED IN A SIMILAR MANNER FOR THE             @OZ00751*/
*        /* TARGET                                           @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1222
*        RREC = IOCSOUP -> IOCDAD;                         /*@OZ00751*/
         L     @08,IOCSOUP                                         1222
         L     RREC,IOCDAD(,@08)                                   1222
*        RREC = ADDR(REC7INDX) + REC7OFFS + 6;             /*@OZ00751*/
         LA    @08,REC7INDX(,RREC)                                 1223
         MVC   @ZT00003+3(1),REC7OFFS(RREC)                        1223
         AL    @08,@ZT00003                                        1223
         AH    @08,@CH00156                                        1223
         LR    RREC,@08                                            1223
*        TTBLDIM = REC7LNEX/LENGTH(REC7XTNT);              /*@OZ00751*/
*                                                                  1224
         MVC   @TF00001(2),REC7LNEX(RREC)                          1224
         LH    @00,@TF00001                                        1224
         SRDA  @00,32                                              1224
         D     @00,@CF01276                                        1224
         ST    @01,TTBLDIM                                         1224
*        DO I = 1 TO TTBLDIM;                              /*@OZ00751*/
*                                                                  1225
         LA    I,1                                                 1225
         B     @DE01225                                            1225
@DL01225 DS    0H                                                  1226
*          TTBLHI(I) = REC7HRBA(I)/CILEN;                  /*@OZ00751*/
         LR    @08,I                                               1226
         SLA   @08,3                                               1226
         LA    @15,512                                             1226
         LR    @14,I                                               1226
         MH    @14,@CH01276                                        1226
         ST    @14,@TF00001                                        1226
         ALR   @14,RREC                                            1226
         BCTR  @14,0                                               1226
         BCTR  @14,0                                               1226
         MVC   @TF00002(4),REC7HRBA-18(@14)                        1226
         L     @14,@TF00002                                        1226
         LR    @00,@14                                             1226
         SRDA  @00,32                                              1226
         DR    @00,@15                                             1226
         ST    @01,TTBLHI-8(@08)                                   1226
*          TTBLGAP(I) = (REC7HRBA(I) - REC7LRBA(I))/CILEN          1227
*                      +1;                                 /*@OZ00751*/
*                                                                  1227
         LR    @01,RREC                                            1227
         AL    @01,@TF00001                                        1227
         AL    @01,@CF01305                                        1227
         MVC   @TF00001(4),REC7LRBA-14(@01)                        1227
         SL    @14,@TF00001                                        1227
         ST    @15,@TF00001                                        1227
         SRDA  @14,32                                              1227
         D     @14,@TF00001                                        1227
         AH    @15,@CH00219                                        1227
         ST    @15,TTBLGAP-8(@08)                                  1227
*        END;                                              /*@OZ00751*/
*                                                                  1228
         AH    I,@CH00219                                          1228
@DE01225 C     I,TTBLDIM                                           1228
         BNH   @DL01225                                            1228
*        IF GDTDBG = NULLPTR                               /*@OZ00751*/
*          THEN;                                           /*@OZ00751*/
         L     @08,@PC00001                                        1229
         L     @08,GDTDBG(,@08)                                    1229
         LTR   @08,@08                                             1229
         BZ    @RT01229                                            1229
*          ELSE                                                    1231
*            DO;                                           /*@OZ00751*/
*                                                                  1231
*            DMPINDEX = ADDR(DUMPAREA);                    /*@OZ00751*/
         LA    @08,DUMPAREA                                        1232
         ST    @08,DMPINDEX                                        1232
*            DMPITMNM = 'SORSTABL';                        /*@OZ00751*/
         MVC   DMPITMNM(8,@08),@CC01236                            1233
*            DMPITMPT = ADDR(STBL);                        /*@OZ00751*/
         LA    @02,STBL                                            1234
         ST    @02,DMPITMPT(,@08)                                  1234
*            DMPITMLN = STBLDIM * 8;                       /*@OZ00751*/
         L     @02,STBLDIM                                         1235
         SLA   @02,3                                               1235
         STH   @02,DMPITMLN(,@08)                                  1235
*            DMPITMTP = 'H';                               /*@OZ00751*/
         MVI   DMPITMTP(@08),C'H'                                  1236
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/
         LA    @02,16                                              1237
         ALR   @08,@02                                             1237
         ST    @08,DMPINDEX                                        1237
*            DMPITMNM = 'TARGTABL';                        /*@OZ00751*/
         MVC   DMPITMNM(8,@08),@CC01237                            1238
*            DMPITMPT = ADDR(TTBL);                        /*@OZ00751*/
         LA    @15,TTBL                                            1239
         ST    @15,DMPITMPT(,@08)                                  1239
*            DMPITMLN = TTBLDIM * 8;                       /*@OZ00751*/
         L     @15,TTBLDIM                                         1240
         SLA   @15,3                                               1240
         STH   @15,DMPITMLN(,@08)                                  1240
*            DMPITMTP = 'H';                               /*@OZ00751*/
         MVI   DMPITMTP(@08),C'H'                                  1241
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/
         ALR   @08,@02                                             1242
         ST    @08,DMPINDEX                                        1242
*            DMPTRM =  DMPTRMVL;                           /*@OZ00751*/
         MVI   DMPTRM(@08),X'FF'                                   1243
*            IF GDTDBG = NULLPTR                                   1244
*              THEN;                                               1244
         L     @08,@PC00001                                        1244
         L     @08,GDTDBG(,@08)                                    1244
         LTR   @08,@08                                             1244
         BZ    @RT01244                                            1244
*              ELSE                                                1246
*                CALL IDCDB010 (GDTTBL,'RPTU',ADDR(DUMPAREA));     1246
         L     @08,@PC00001                                        1246
         ST    @08,@AL00001                                        1246
         LA    @02,@CC01238                                        1246
         ST    @02,@AL00001+4                                      1246
         LA    @02,DUMPAREA                                        1246
         ST    @02,@AFTEMPS+4                                      1246
         LA    @02,@AFTEMPS+4                                      1246
         ST    @02,@AL00001+8                                      1246
         MVI   @AL00001+8,X'80'                                    1246
         L     @15,GDTDBG(,@08)                                    1246
         LA    @01,@AL00001                                        1246
         BALR  @14,@15                                             1246
*                                                          /*@OZ00751*/
*                                                                  1247
*            END;                                          /*@OZ00751*/
*                                                                  1247
*        END TRUENAME;                                             1248
@EL00008 DS    0H                                                  1248
@EF00008 DS    0H                                                  1248
@ER00008 LM    @14,@12,@SA00008                                    1248
         BR    @14                                                 1248
*                                                                  1249
*CATRANS:                                                          1249
*        PROC;                                             /*@OZ00751*/
*                                                                  1249
CATRANS  STM   @14,@12,@SA00009                                    1249
*        OLDERID2 = NEWERID2;                                      1250
         L     @08,@PC00001                                        1250
         L     @08,GDTTR2(,@08)                                    1250
         MVC   @TS00001(95),NEWERID2(@08)                          1250
         MVC   OLDERID2(95,@08),@TS00001                           1250
*        NEWID2='RPT3';                                    /*@OZ00751*/
*                                                                  1251
         MVC   NEWID2(4,@08),@CC01242                              1251
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - CATRANS                                 @OZ00751*/
*/* FUNCTION -                                               @OZ00751*/
*/*                                                          @OZ00751*/
*/* THE BASIC JOB OF THE CATRANS PROCEEDURE IS TO FIND       @OZ00751*/
*/* EACH CI NUMBER IN A CATALOG RECORD AND CONVERT THE       @OZ00751*/
*/* NUMBER FROM ITS SOURCE CATALOG VALUE TO THE APPROPRIATE  @OZ00751*/
*/* VALUE FOR THE TARGET CATALOG.                            @OZ00751*/
*/*                                                          @OZ00751*/
*/* INPUT - THE BACKUP CATALOG RECORD.                       @OZ00751*/
*/* OUTPUT - THE CONVERTED BACKUP RECORD                     @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1252
*                                                                  1252
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* IF THE RECORD IS IN THE HIGH KEY RANGE TRANSLATE @OZ00751*/
*        /* IT.                                              @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1252
*        IF RCDKEYTY ^= NULL                                       1252
*          THEN                                                    1252
         L     @08,IOCSPTR                                         1252
         L     @08,IOCDAD(,@08)                                    1252
         CLI   RCDKEYTY(@08),0                                     1252
         BE    @RF01252                                            1252
*            DO;                                           /*@OZ00751*/
*                                                                  1253
*            RCIADDR = ADDR(HKCINO);                       /*@OZ00751*/
         LA    RCIADDR,HKCINO(,@08)                                1254
*            CALL CNVRTCI;                                 /*@OZ00751*/
         BAL   @14,CNVRTCI                                         1255
*            END;                                          /*@OZ00751*/
*                                                                  1256
*          ELSE                                                    1257
*            DO;                                           /*@OZ00751*/
*                                                                  1257
         B     @RC01252                                            1257
@RF01252 DS    0H                                                  1258
*            /********************************************************/
*            /*                                              @OZ00751*/
*            /* IF RECORD IS IN THE LOW KEY RANGE TRANSLATE  @OZ00751*/
*            /* THE ENTRY ID.                                @OZ00751*/
*            /*                                              @OZ00751*/
*            /********************************************************/
*                                                                  1258
*            RCIADDR = ADDR(RCDCINO);                      /*@OZ00751*/
         L     @08,IOCSPTR                                         1258
         L     RCIADDR,IOCDAD(,@08)                                1258
         LA    RCIADDR,RCDCINO(,RCIADDR)                           1258
*            CALL CNVRTCI;                                 /*@OZ00751*/
*                                                                  1259
*                                                                  1259
         BAL   @14,CNVRTCI                                         1259
*            /********************************************************/
*            /*                                                      */
*            /* IF  THE RECORD IS A CATALOG FREE RECORD THEN         */
*            /* THE POINTER TO THE NEXT CI NUMBER IN THE             */
*            /* DELETE CHAIN HAS TO BE CONVERTED.                    */
*            /*                                                      */
*            /********************************************************/
*                                                                  1260
*            IF RCDID = 'F'                                        1260
*              THEN                                                1260
         L     @08,IOCSPTR                                         1260
         L     @08,IOCDAD(,@08)                                    1260
         CLI   RCDID(@08),C'F'                                     1260
         BNE   @RF01260                                            1260
*                DO;                                       /*@OZ00751*/
*                                                                  1261
*                CFRNEXT = CFROLD;                         /*@OZ00751*/
         MVC   CFRNEXT+45(3,@08),CFROLD                            1262
*                CFROLD  = RCDCINO;                        /*@OZ00751*/
         MVC   CFROLD(3),RCDCINO(@08)                              1263
*                FREENUM = FREENUM + 1;                    /*@OZ00751*/
*                                                                  1264
         LA    @08,1                                               1264
         AL    @08,FREENUM                                         1264
         ST    @08,FREENUM                                         1264
*                END;                                      /*@OZ00751*/
*                                                                  1265
*              ELSE                                                1266
*                DO;                                       /*@OZ00751*/
*                                                                  1266
         B     @RC01260                                            1266
@RF01260 DS    0H                                                  1267
*                /****************************************************/
*                /*                                          @OZ00751*/
*                /* CHECK FOR VALID RECORD TYPE USING RCIADDR@OZ00751*/
*                /* AS THE INDICATION TO LEAVE THE LOOP.     @OZ00751*/
*                /*                                          @OZ00751*/
*                /****************************************************/
*                                                                  1267
*                RFY RCIADDR RSTD;                         /*@OZ00751*/
*                RCIADDR = NULL;                           /*@OZ00751*/
*                                                                  1268
         SLR   RCIADDR,RCIADDR                                     1268
*                  DO COMFTBLX = 1 TO 13                   /*@Y30SSEC*/
*                    WHILE RCIADDR = NULL;                 /*@OZ00751*/
*                                                                  1269
         LA    COMFTBLX,1                                          1269
@DL01269 LTR   RCIADDR,RCIADDR                                     1269
         BNZ   @DC01269                                            1269
*                    IF RCDID = COMFTBL(COMFTBLX)                  1270
*                      THEN                                        1270
         L     @08,IOCSPTR                                         1270
         L     @08,IOCDAD(,@08)                                    1270
         LA    @02,COMFTBL-1(COMFTBLX)                             1270
         CLC   RCDID(1,@08),0(@02)                                 1270
         BNE   @RF01270                                            1270
*                        DO;                               /*@OZ00751*/
*                                                                  1271
*                        /********************************************/
*                        /*                                  @OZ00751*/
*                        /* FIND THE EXTENSION RECORD POINTER@OZ00751*/
*                        /* AND THEN CONVERT IT. TO FIND THE @OZ00751*/
*                        /* POINTER, POINT PAST THE FIXED    @OZ00751*/
*                        /* FIELDS AND BUMP PAST EACH        @OZ00751*/
*                        /* VARIABLE FIELD TO THE REPEATING  @OZ00751*/
*                        /* CONTROL INFO FIELDS.             @OZ00751*/
*                        /*                                  @OZ00751*/
*                        /********************************************/
*                                                                  1272
*                        RFY RREC RSTD;                    /*@OZ00751*/
*                                                                  1272
*                        RREC = IOCDAD + NREPLF;           /*@OZ00751*/
*                                                                  1273
         SLR   RREC,RREC                                           1273
         IC    RREC,NREPLF(,@08)                                   1273
         ALR   RREC,@08                                            1273
*                        RFY VARFIELD BASED(RREC);         /*@OZ00751*/
*                                                                  1274
*                          DO I   = 1 TO NREPCV;           /*@OZ00751*/
         LA    I,1                                                 1275
         B     @DE01275                                            1275
@DL01275 DS    0H                                                  1276
*                            RREC = RREC + VARLEN                  1276
*                            + LENGTH(VARLEN);             /*@OZ00751*/
         LR    @08,RREC                                            1276
         AH    @08,VARLEN(,RREC)                                   1276
         AL    @08,@CF00153                                        1276
         LR    RREC,@08                                            1276
*                          END;                            /*@OZ00751*/
*                                                                  1277
*                                                                  1277
         AH    I,@CH00219                                          1277
@DE01275 L     @08,IOCSPTR                                         1277
         L     @08,IOCDAD(,@08)                                    1277
         MVC   @ZT00003+3(1),NREPCV(@08)                           1277
         C     I,@ZT00003                                          1277
         BNH   @DL01275                                            1277
*                        RFY REPCNTRL BASED(RREC);         /*@OZ00751*/
*                                                                  1278
*                        RCIADDR = ADDR(EXTGOCI);          /*@OZ00751*/
         LR    RCIADDR,RREC                                        1279
*                        CALL CNVRTCI;                     /*@OZ00751*/
*                                                                  1280
         BAL   @14,CNVRTCI                                         1280
*                        /********************************************/
*                        /*                                  @OZ00751*/
*                        /* THE NEXT THING TO BE PROCESSED IS@OZ00751*/
*                        /* THE GROUP OCCURRENCE POINTERS.   @OZ00751*/
*                        /* THE FIRST STEP IS CALCULATE THE  @OZ00751*/
*                        /* G.O.P. LENGTH SINCE THE VOLUME   @OZ00751*/
*                        /* G.O.P. LENGTH IS DIFFERENT       @OZ00751*/
*                        /*                                  @OZ00751*/
*                        /********************************************/
*                                                                  1281
*                        IF RCDID = 'V'  ×                         1281
*                           RCDID = 'W'                            1281
*                          THEN                                    1281
         L     @08,IOCSPTR                                         1281
         L     @08,IOCDAD(,@08)                                    1281
         CLI   RCDID(@08),C'V'                                     1281
         BE    @RT01281                                            1281
         CLI   RCDID(@08),C'W'                                     1281
         BNE   @RF01281                                            1281
@RT01281 DS    0H                                                  1282
*                            GOPLEN = LENGTH(CATGOPT)              1282
*                                   - LENGTH(CATGOSEQ)             1282
*                                   + LENGTH(CATSN);       /*@OZ00751*/
*                                                                  1282
         LA    GOPLEN,6                                            1282
*                          ELSE                                    1283
*                            GOPLEN = LENGTH(CATGOPT);     /*@OZ00751*/
*                                                                  1283
         B     @RC01281                                            1283
@RF01281 LA    GOPLEN,5                                            1283
*                        /********************************************/
*                        /*                                  @OZ00751*/
*                        /* THE NEXT STEP IS TO SET THE START@OZ00751*/
*                        /* OF THE GROUP OCCURRENCES. SINCE  @OZ00751*/
*                        /* THIS IS ALSO THE END OF THE GOPS @OZ00751*/
*                        /* THIS GIVES US THE TOTAL LENGTH   @OZ00751*/
*                        /* OF GOPS.                         @OZ00751*/
*                        /*                                  @OZ00751*/
*                        /********************************************/
*                                                                  1284
*                        GOSTART = GOPLEN * REPCNT                 1284
*                                 + ADDR(REPGOPT(1));      /*@OZ00751*/
@RC01281 SLR   @01,@01                                             1284
         IC    @01,REPCNT(,RREC)                                   1284
         MR    @00,GOPLEN                                          1284
         LA    GOSTART,REPGOPT(,RREC)                              1284
         ALR   @01,GOSTART                                         1284
         LR    GOSTART,@01                                         1284
*                        L = GOSTART - GOPLEN;             /*@OZ00751*/
*                                                                  1285
         LR    L,GOSTART                                           1285
         SLR   L,GOPLEN                                            1285
*                          DO RREC = ADDR(REPGOPT) TO L            1286
*                                           BY GOPLEN;     /*@OZ00751*/
         LA    @08,REPGOPT(,RREC)                                  1286
         LR    RREC,@08                                            1286
         B     @DE01286                                            1286
@DL01286 DS    0H                                                  1287
*                            RFY CATGOPT BASED(RREC);      /*@OZ00751*/
*                                                                  1287
*                            /****************************************/
*                            /*                              @OZ00751*/
*                            /* IF THE GOP HAS ITS GO ON     @OZ00751*/
*                            /* ANOTHER RECORD THEN THE      @OZ00751*/
*                            /* EXTENSION POINTER IN THE     @OZ00751*/
*                            /* GOP HAS TO BE TRANSLATED.    @OZ00751*/
*                            /*                              @OZ00751*/
*                            /****************************************/
*                                                                  1288
*                            IF CATGOEXT = ON                      1288
*                              THEN                                1288
         TM    CATGOEXT(RREC),B'10000000'                          1288
         BNO   @RF01288                                            1288
*                                DO;                       /*@OZ00751*/
*                                                                  1289
*                                RCIADDR = ADDR(CATGOCI);  /*@OZ00751*/
         LR    RCIADDR,RREC                                        1290
*                                CALL CNVRTCI;             /*@OZ00751*/
         BAL   @14,CNVRTCI                                         1291
*                                END;                      /*@OZ00751*/
*                                                                  1292
*                              ELSE                                1293
*                                                                  1293
*                                /************************************/
*                                /*                          @OZ00751*/
*                                /* IF THE G.O. IS ON THIS   @OZ00751*/
*                                /* SAME RECORD AND IF IT IS @OZ00751*/
*                                /* A DATA SET DIRECTORY OR  @OZ00751*/
*                                /* ASSOCIATION G.O. THEN THE@OZ00751*/
*                                /* G.O.HAS A POINTER TO     @OZ00751*/
*                                /* CONVERT                  @OZ00751*/
*                                /*                          @OZ00751*/
*                                /************************************/
*                                                                  1293
*                                IF CATGOGC1 = DSDGC               1293
*                                  THEN                            1293
         B     @RC01288                                            1293
@RF01288 CLI   CATGOGC1(RREC),8                                    1293
         BNE   @RF01293                                            1293
*                                    DO;                   /*@OZ00751*/
*                                                                  1294
*                                    RCIADDR = GOSTART             1295
*                                       + CATGODSP;        /*@OZ00751*/
         LR    RCIADDR,GOSTART                                     1295
         MVC   @TF00001(2),CATGODSP(RREC)                          1295
         AH    RCIADDR,@TF00001                                    1295
*                                    RFY CNTRLINF                  1296
*                                       BASED(RCIADDR);    /*@OZ00751*/
*                                    RCIADDR = ADDR(DSDCI);/*@OZ00751*/
         LA    @08,DSDCI+1(,RCIADDR)                               1297
         LR    RCIADDR,@08                                         1297
*                                    CALL CNVRTCI;         /*@OZ00751*/
*                                                                  1298
         BAL   @14,CNVRTCI                                         1298
*                                    END;                  /*@OZ00751*/
*                                                                  1299
*                                IF CATGOGC1 = ASGC                1300
*                                  THEN                            1300
@RF01293 DS    0H                                                  1300
@RC01288 CLI   CATGOGC1(RREC),2                                    1300
         BNE   @RF01300                                            1300
*                                    DO;                   /*@OZ00751*/
*                                                                  1301
*                                    RCIADDR = GOSTART             1302
*                                       + CATGODSP;        /*@OZ00751*/
         LR    RCIADDR,GOSTART                                     1302
         MVC   @TF00001(2),CATGODSP(RREC)                          1302
         AH    RCIADDR,@TF00001                                    1302
*                                    RFY CNTRLINF                  1303
*                                       BASED(RCIADDR);    /*@OZ00751*/
*                                    RCIADDR = ADDR(ASCI); /*@OZ00751*/
         LA    @08,ASCI+1(,RCIADDR)                                1304
         LR    RCIADDR,@08                                         1304
*                                    CALL CNVRTCI;         /*@OZ00751*/
*                                                                  1305
         BAL   @14,CNVRTCI                                         1305
*                                /************************************/
*                                /*                          @Y30SSEC*/
*                                /* CHECK FOR REL 2 GROUP CODE LEN.  */
*                                /* IF SO, PROCESS SECOND CI ENTRY.  */
*                                /*                          @Y30SSEC*/
*                                /************************************/
*                                    RCIADDR = RCIADDR             1306
*                                              - LENGTH(CNTRLINF)  1306
*                                              - LENGTH(ASTYPE);   1306
         SH    RCIADDR,@CH00162                                    1306
*                                    IF (LENFIX = REL2UPGP) &      1307
*                                       (ASTYPE = CTGTDATA)/*@OZ09375*/
*                                     THEN DO;             /*@Y30SSEC*/
         CLI   LENFIX(RCIADDR),10                                  1307
         BNE   @RF01307                                            1307
         CLI   ASTYPE+1(RCIADDR),196                               1307
         BNE   @RF01307                                            1307
*                                      RCIADDR = RCIADDR           1309
*                                               + LENGTH(CNTRLINF) 1309
*                                               + LENGTH(ASGO)     1309
*                                               + LENGTH(ASTYPE);  1309
         AH    RCIADDR,@CH00466                                    1309
*                                      CALL CNVRTCI;       /*@Y30SSEC*/
         BAL   @14,CNVRTCI                                         1310
*                                      END;                /*@Y30SSEC*/
*                                     ELSE;                /*@Y30SSEC*/
@RF01307 DS    0H                                                  1313
*                                    END;                  /*@OZ00751*/
*                          END;                            /*@OZ00751*/
@RF01300 ALR   RREC,GOPLEN                                         1314
@DE01286 CR    RREC,L                                              1314
         BNH   @DL01286                                            1314
*                        END;                              /*@OZ00751*/
*                                                                  1315
*                      RFY RREC UNRSTD;                    /*@OZ00751*/
*                                                                  1316
@RF01270 DS    0H                                                  1317
*                  END;                                    /*@OZ00751*/
         AH    COMFTBLX,@CH00219                                   1317
         CH    COMFTBLX,@CH00624                                   1317
         BNH   @DL01269                                            1317
@DC01269 DS    0H                                                  1318
*                END;                                      /*@OZ00751*/
*                                                                  1318
*            RFY RCIADDR UNRSTD;                           /*@OZ00751*/
*                                                                  1319
@RC01260 DS    0H                                                  1320
*            END;                                          /*@OZ00751*/
*                                                                  1320
*        RETURN;                                           /*@OZ00751*/
@EL00009 DS    0H                                                  1321
@EF00009 DS    0H                                                  1321
@ER00009 LM    @14,@12,@SA00009                                    1321
         BR    @14                                                 1321
*CNVRTCI:                                                          1322
*        PROC;                                                     1322
*                                                                  1322
CNVRTCI  STM   @14,@12,@SA00010                                    1322
*        RFY RCIADDR RSTD;                                         1323
*                                                                  1323
*        OLDERID2 = NEWERID2;                                      1324
         L     @08,@PC00001                                        1324
         L     @08,GDTTR2(,@08)                                    1324
         MVC   @TS00001(95),NEWERID2(@08)                          1324
         MVC   OLDERID2(95,@08),@TS00001                           1324
*        NEWID2='RPT4';                                    /*@OZ00751*/
*                                                                  1325
         MVC   NEWID2(4,@08),@CC01251                              1325
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - CONVRTCI                                @OZ00751*/
*/*                                                          @OZ00751*/
*/* FUNCTION -                                               @OZ00751*/
*/* THIS ROUTINE CONVERTS A CONTROL INTERVAL NUMBER          @OZ00751*/
*/* CONTAINED IN THE BACKUP CATALOG RECORD TO THE            @OZ00751*/
*/* APPROPRIATE VALUE FOR THE TARGET CATALOG. THE            @OZ00751*/
*/* ADDRESS OF THE CI # TO BE CONVERTED SHOULD BE            @OZ00751*/
*/* PASSED IN 'RCIADDR'. ZERO CI # WILL NOT BE               @OZ00751*/
*/* CONVERTED. TERMINAL ERROR WILL BE SET IF                 @OZ00751*/
*/* CONVERSION IS NOT POSSIBLE.                              @OZ00751*/
*/* INPUT - RCIADDR CONTAINS THE ADDRESS OF THE CI # TO BE   @OZ00751*/
*/*         CONVERTED.                                       @OZ00751*/
*/* OUTPUT - THE CI # IS CONVERTED                           @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1326
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* BYPASS ANY FURTHER PROCESSING FOR A ZERO CI #.   @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1326
*        NEWCINUM = NULL;                                  /*@OZ00751*/
*                                                                  1326
         SLR   @08,@08                                             1326
         ST    @08,NEWCINUM                                        1326
*        IF CINUM ^= NULL                                          1327
*          THEN                                                    1327
         LR    @08,RCIADDR                                         1327
         BCTR  @08,0                                               1327
         L     @08,CINUM(,@08)                                     1327
         LA    @08,0(,@08)                                         1327
         LTR   @08,@08                                             1327
         BZ    @RF01327                                            1327
*            DO;                                           /*@OZ00751*/
*                                                                  1328
*            /********************************************************/
*            /*                                              @OZ00751*/
*            /* SET J WITH A VALUE MINUS ONE TO ACT AS A LOOP@OZ00751*/
*            /* EXIT SWITCH. SCAN THE SOURCE TABLE CI #  TO  @OZ00751*/
*            /* THE END  OR A LOW COMPARISON IS OBTAINED.    @OZ00751*/
*            /*                                              @OZ00751*/
*            /********************************************************/
*                                                                  1329
*            WRKCINUM = CINUM;                             /*@OZ00751*/
         LR    WRKCINUM,@08                                        1329
*            J = MINUS1;                                   /*@OZ00751*/
*                                                                  1330
         SLR   J,J                                                 1330
         BCTR  J,0                                                 1330
*              DO  I = 1 TO STBLDIM                                1331
*                WHILE J  < NULL;                          /*@OZ00751*/
*                                                                  1331
         LA    I,1                                                 1331
         B     @DE01331                                            1331
@DL01331 LTR   J,J                                                 1331
         BNM   @DC01331                                            1331
*                IF CINUM > STBLHI(I)                              1332
*                  THEN                                            1332
         LR    @08,I                                               1332
         SLA   @08,3                                               1332
         LR    @07,RCIADDR                                         1332
         BCTR  @07,0                                               1332
         L     @07,CINUM(,@07)                                     1332
         LA    @07,0(,@07)                                         1332
         C     @07,STBLHI-8(@08)                                   1332
         BNH   @RF01332                                            1332
*                    WRKCINUM = WRKCINUM - STBLGAP(I);     /*@OZ00751*/
         SL    WRKCINUM,STBLGAP-8(@08)                             1333
*                  ELSE                                            1334
*                    J = 1;                                /*@OZ00751*/
*                                                                  1334
         B     @RC01332                                            1334
@RF01332 LA    J,1                                                 1334
*              END;                                        /*@OZ00751*/
*                                                                  1335
@RC01332 AH    I,@CH00219                                          1335
@DE01331 C     I,STBLDIM                                           1335
         BNH   @DL01331                                            1335
@DC01331 DS    0H                                                  1336
*            NEWCINUM = WRKCINUM;                          /*@OZ00751*/
*                                                                  1336
         ST    WRKCINUM,NEWCINUM                                   1336
*            /********************************************************/
*            /*                                              @OZ00751*/
*            /* SET J  WITH A VALUE MINUS ONE IN ORDER TO ACT@OZ00751*/
*            /* AS A LOOP EXIT SWITCH. SCAN THE TARGET TABLE @OZ00751*/
*            /* CI #S TILL EITHER A LOW COMPARISON OR THE    @OZ00751*/
*            /* END OF THE TABLE IS REACHED.                 @OZ00751*/
*            /*                                              @OZ00751*/
*            /********************************************************/
*                                                                  1337
*            J = MINUS1;                                   /*@OZ00751*/
*                                                                  1337
         SLR   J,J                                                 1337
         BCTR  J,0                                                 1337
*              DO  I = 1 TO TTBLDIM                                1338
*                WHILE J < NULL;                           /*@OZ00751*/
*                                                                  1338
         LA    I,1                                                 1338
         B     @DE01338                                            1338
@DL01338 LTR   J,J                                                 1338
         BNM   @DC01338                                            1338
*                IF NEWCINUM > TTBLHI(I) - TTBLGAP(I)              1339
*                  THEN                                            1339
         LR    @08,I                                               1339
         SLA   @08,3                                               1339
         L     @07,TTBLGAP-8(@08)                                  1339
         L     @08,TTBLHI-8(@08)                                   1339
         SLR   @08,@07                                             1339
         C     @08,NEWCINUM                                        1339
         BNL   @RF01339                                            1339
*                    WRKCINUM = WRKCINUM + TTBLGAP(I);     /*@OZ00751*/
*                                                                  1340
         ALR   WRKCINUM,@07                                        1340
*                  ELSE                                            1341
*                    J = 1;                                /*@OZ00751*/
*                                                                  1341
         B     @RC01339                                            1341
@RF01339 LA    J,1                                                 1341
*              END;                                        /*@OZ00751*/
*                                                                  1342
@RC01339 AH    I,@CH00219                                          1342
@DE01338 C     I,TTBLDIM                                           1342
         BNH   @DL01338                                            1342
@DC01338 DS    0H                                                  1343
*            NEWCINUM = WRKCINUM;                          /*@OZ00751*/
*                                                                  1343
         ST    WRKCINUM,NEWCINUM                                   1343
*            END;                                          /*@OZ00751*/
*                                                                  1344
*        IF GDTDBG = NULLPTR                                       1345
*          THEN;                                           /*@OZ00751*/
@RF01327 L     @08,@PC00001                                        1345
         L     @08,GDTDBG(,@08)                                    1345
         LTR   @08,@08                                             1345
         BZ    @RT01345                                            1345
*          ELSE                                                    1347
*            DO;                                           /*@OZ00751*/
*                                                                  1347
*            DMPINDEX = ADDR(DUMPAREA);                    /*@OZ00751*/
         LA    @08,DUMPAREA                                        1348
         ST    @08,DMPINDEX                                        1348
*            DMPITMNM = 'OLDCI#';                          /*@OZ00751*/
         MVI   DMPITMNM+6(@08),C' '                                1349
         MVI   DMPITMNM+7(@08),C' '                                1349
         MVC   DMPITMNM(6,@08),@CC01252                            1349
*            DMPITMPT = RCIADDR;                           /*@OZ00751*/
         ST    RCIADDR,DMPITMPT(,@08)                              1350
*            DMPITMLN = 3;                                 /*@OZ00751*/
         MVC   DMPITMLN(2,@08),@CH00162                            1351
*            DMPITMTP = 'F';                               /*@OZ00751*/
         MVI   DMPITMTP(@08),C'F'                                  1352
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/
         LA    @05,16                                              1353
         ALR   @08,@05                                             1353
         ST    @08,DMPINDEX                                        1353
*            DMPITMNM = 'NEWCI#';                          /*@OZ00751*/
         MVI   DMPITMNM+6(@08),C' '                                1354
         MVI   DMPITMNM+7(@08),C' '                                1354
         MVC   DMPITMNM(6,@08),@CC01253                            1354
*            DMPITMPT = ADDR(NEWCINUM);                    /*@OZ00751*/
         LA    @15,NEWCINUM                                        1355
         ST    @15,DMPITMPT(,@08)                                  1355
*            DMPITMLN = 4;                                 /*@OZ00751*/
         MVC   DMPITMLN(2,@08),@CH00042                            1356
*            DMPITMTP = 'F';                               /*@OZ00751*/
         MVI   DMPITMTP(@08),C'F'                                  1357
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/
         ALR   @08,@05                                             1358
         ST    @08,DMPINDEX                                        1358
*            DMPTRM = DMPTRMVL;                            /*@OZ00751*/
         MVI   DMPTRM(@08),X'FF'                                   1359
*            IF GDTDBG = NULLPTR                                   1360
*              THEN;                                               1360
         L     @08,@PC00001                                        1360
         L     @08,GDTDBG(,@08)                                    1360
         LTR   @08,@08                                             1360
         BZ    @RT01360                                            1360
*              ELSE                                                1362
*                CALL IDCDB010 (GDTTBL,'RPCI',ADDR(DUMPAREA));     1362
         L     @08,@PC00001                                        1362
         ST    @08,@AL00001                                        1362
         LA    @05,@CC01254                                        1362
         ST    @05,@AL00001+4                                      1362
         LA    @05,DUMPAREA                                        1362
         ST    @05,@AFTEMPS+8                                      1362
         LA    @05,@AFTEMPS+8                                      1362
         ST    @05,@AL00001+8                                      1362
         MVI   @AL00001+8,X'80'                                    1362
         L     @15,GDTDBG(,@08)                                    1362
         LA    @01,@AL00001                                        1362
         BALR  @14,@15                                             1362
*                                                          /*@OZ00751*/
*                                                                  1363
*            END;                                          /*@OZ00751*/
*                                                                  1363
@RT01360 DS    0H                                                  1364
*        IF CINUM ^= NULL                                          1364
*          THEN                                                    1364
@RT01345 LR    @08,RCIADDR                                         1364
         BCTR  @08,0                                               1364
         L     @08,CINUM(,@08)                                     1364
         LA    @08,0(,@08)                                         1364
         LTR   @08,@08                                             1364
         BZ    @RF01364                                            1364
*            CINUM = NEWCINUM;                             /*@OZ00751*/
*                                                                  1365
         MVC   CINUM(3,RCIADDR),NEWCINUM+1                         1365
*        END CNVRTCI;                                      /*@OZ00751*/
*                                                                  1366
@EL00010 DS    0H                                                  1366
@EF00010 DS    0H                                                  1366
@ER00010 LM    @14,@12,@SA00010                                    1366
         BR    @14                                                 1366
*        END CATRANS;                                      /*@OZ00751*/
         B     @EL00009                                            1367
*CATCOMP: PROC;                                                    1368
*                                                                  1368
CATCOMP  STM   @14,@04,@SA00011                                    1368
         STM   @06,@12,@SA00011+28                                 1368
*        OLDERID2 = NEWERID2;                                      1369
         L     @08,@PC00001                                        1369
         L     @08,GDTTR2(,@08)                                    1369
         MVC   @TS00001(95),NEWERID2(@08)                          1369
         MVC   OLDERID2(95,@08),@TS00001                           1369
*        NEWID2='RPT5';                                    /*@OZ00751*/
*                                                                  1370
         MVC   NEWID2(4,@08),@CC01258                              1370
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - CATCOMP                                 @OZ00751*/
*/*                                                          @OZ00751*/
*/* FUNCTION.                                                @OZ00751*/
*/*                                                          @OZ00751*/
*/*      CATCOMP IS INVOKED WHEN THE CATALOG TRUENAME        @OZ00751*/
*/*      RECORDS ARE TO BE COMPARED                          @OZ00751*/
*/*                                                          @OZ00751*/
*/*      1. TO INDICATE DIFFERENCES IN TRUENAME ENTRIES      @OZ00751*/
*/*         BETWEEN THE BACKUP AND THE TARGET CATALOG.       @OZ00751*/
*/*                                                          @OZ00751*/
*/* INPUT - THE BACKUP AND TARGET RECORDS HAVE BEEN READ     @OZ00751*/
*/*OUTRUT - A MESSAGE INDICATING THE DIFFERENCE              @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1371
*        /************************************************************/
*        /*                                                          */
*        /* IF EITHER IS A TRUENAME RECORD THEN DO TRUENAME          */
*        /* PROCESSING.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1371
*        IF                                                        1371
*           IOCSOUP -> IOCDAD -> RCDKEYTY ^= NULL &                1371
*           READSW = READT &                                       1371
*           ( K < LIMIT × IOCSOUP -> IOCDAD -> RECKEY(9) = '00'X)  1371
*                                                                  1371
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* IF LESS THAN 100 COMPARE MSGS AND  THERE EXISTS  @OZ00751*/
*        /* A TARGET TRUENAME RECORD WITHOUT A CORRESPONDING @OZ00751*/
*        /* BACKUP A COMPARE MESSAGE IS PRINTED AND          @OZ00751*/
*        /* THE STATUS FLAG IS SET TO WARNING                @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1371
*          THEN                                                    1371
         L     @08,IOCSOUP                                         1371
         L     @08,IOCDAD(,@08)                                    1371
         CLI   RCDKEYTY(@08),0                                     1371
         BE    @RF01371                                            1371
         CLI   READSW,X'02'                                        1371
         BNE   @RF01371                                            1371
         CH    K,@CH00147                                          1371
         BL    @RT01371                                            1371
         CLI   RECKEY+8(@08),X'00'                                 1371
         BNE   @RF01371                                            1371
@RT01371 DS    0H                                                  1372
*            DO;                                           /*@OZ00751*/
*                                                                  1372
*            /* VOL ENTRY IN A TRUENAME RECORD HAS 6 CHAR NAME       */
*            IF IOCSOUP -> IOCDAD -> RECKEY(7) = NULL       /*Y30SSEC*/
*              THEN                                         /*Y30SSEC*/
         L     @08,IOCSOUP                                         1373
         L     @08,IOCDAD(,@08)                                    1373
         CLI   RECKEY+6(@08),0                                     1373
         BNE   @RF01373                                            1373
*                DARGINL(1) = 6;  /* VOL ENTRY LENGTH        @Y30SSEC*/
         L     @08,DDSTRU                                          1374
         MVC   DARGINL(2,@08),@CH00156                             1374
*              ELSE                                         /*Y30SSEC*/
*                DARGINL(1) = 44; /* TRUE NAME LENGTH        @Y30SSEC*/
         B     @RC01373                                            1375
@RF01373 L     @08,DDSTRU                                          1375
         MVC   DARGINL(2,@08),@CH00622                             1375
*            DARGLIST = ''B;                               /*@OZ00751*/
@RC01373 L     @08,DDSTRU                                          1376
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1376
*            DARGSMOD = 'PR0';                             /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            1377
*            DARGSENT = '17'X;                             /*@OZ00751*/
         MVI   DARGSENT(@08),X'17'                                 1378
*            DARGCNT  = 2;                                 /*@OZ00751*/
         LA    @15,2                                               1379
         STH   @15,DARGCNT(,@08)                                   1379
*            DARGINS(1) = 1;                               /*@OZ00751*/
         MVC   DARGINS(2,@08),@CH00219                             1380
*            DARGDTM(1) =                   /*ADDRESS OF     @OZ00751*/
*            ADDR (IOCSOUP -> IOCDAD -> RECKEY ); /*TRUENAME @OZ00751*/
         L     @01,IOCSOUP                                         1381
         MVC   DARGDTM(4,@08),IOCDAD(@01)                          1381
*            DARGINS(2) = 2;                               /*@OZ00751*/
         STH   @15,DARGINS+8(,@08)                                 1382
*            DARGINL(2) = 6;                               /*@OZ00751*/
         MVC   DARGINL+8(2,@08),@CH00156                           1383
*            DARGDTM(2) = ADDR(CTARGET);    /*CONSTANT TARGET@OZ00751*/
*                                                                  1384
         LA    @15,CTARGET                                         1384
         ST    @15,DARGDTM+8(,@08)                                 1384
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@OZ00751*/
*                                                                  1385
         L     @08,@PC00001                                        1385
         ST    @08,@AL00001                                        1385
         LA    @15,@CF00115                                        1385
         ST    @15,@AL00001+4                                      1385
         LA    @15,DDSTRU                                          1385
         ST    @15,@AL00001+8                                      1385
         MVI   @AL00001+8,X'80'                                    1385
         L     @15,GDTPRT(,@08)                                    1385
         LA    @01,@AL00001                                        1385
         BALR  @14,@15                                             1385
*            STATFLG = ABNCONDT;                           /*@OZ00751*/
*                                                                  1386
         MVC   STATFLG(5),@CB00813                                 1386
*            K = K + 1;                                    /*@OZ00751*/
*                                                                  1387
         AH    K,@CH00219                                          1387
*            END;                                          /*@OZ00751*/
*                                                                  1388
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* IF THERE ARE LESS THAN 100 COMPARE MESSAGES AND  @OZ00751*/
*        /* THERE IS A BACKUP TRUENAME RECORD WITHOUT A      @OZ00751*/
*        /* CORRESPONDING TARGET. A MESSAGE IS PRINTED AND   @OZ00751*/
*        /* THE STATUS SET AS BEFORE                         @OZ00751*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1389
*        IF READSW = READS & (K < LIMIT ×                          1389
*            IOCSINP -> IOCDAD -> RECKEY(9) = '00'X ) &            1389
*            IOCSINP -> IOCDAD -> RCDKEYTY ^= NULL                 1389
*                                                                  1389
*          THEN                                                    1389
@RF01371 CLI   READSW,X'01'                                        1389
         BNE   @RF01389                                            1389
         CH    K,@CH00147                                          1389
         BL    @GL00081                                            1389
         L     @08,IOCSINP                                         1389
         L     @08,IOCDAD(,@08)                                    1389
         CLI   RECKEY+8(@08),X'00'                                 1389
         BNE   @RF01389                                            1389
@GL00081 L     @08,IOCSINP                                         1389
         L     @08,IOCDAD(,@08)                                    1389
         CLI   RCDKEYTY(@08),0                                     1389
         BE    @RF01389                                            1389
*            DO;                                           /*@OZ00751*/
*                                                                  1390
*            /* VOL ENTRY IN A TRUENAME RECORD HAS 6 CHAR NAME       */
*            IF IOCSINP -> IOCDAD -> RECKEY(7) = NULL      /*@Y30SSEC*/
*              THEN                                        /*@Y30SSEC*/
         CLI   RECKEY+6(@08),0                                     1391
         BNE   @RF01391                                            1391
*                DARGINL(1) = 6;  /* VOL ENTRY LENGTH        @Y30SSEC*/
         L     @08,DDSTRU                                          1392
         MVC   DARGINL(2,@08),@CH00156                             1392
*              ELSE                                        /*@Y30SSEC*/
*                DARGINL(1) = 44; /* TRUE NAME LENGTH        @Y30SSEC*/
         B     @RC01391                                            1393
@RF01391 L     @08,DDSTRU                                          1393
         MVC   DARGINL(2,@08),@CH00622                             1393
*            DARGLIST = ''B;                               /*@OZ00751*/
@RC01391 L     @08,DDSTRU                                          1394
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1394
*            DARGSMOD = 'PR0';                             /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            1395
*            DARGSENT = '17'X;                             /*@OZ00751*/
         MVI   DARGSENT(@08),X'17'                                 1396
*            DARGCNT  = 2;                                 /*@OZ00751*/
         LA    @15,2                                               1397
         STH   @15,DARGCNT(,@08)                                   1397
*            DARGINS(1) = 1;                               /*@OZ00751*/
         MVC   DARGINS(2,@08),@CH00219                             1398
*            DARGDTM(1) =              /*ADDRESS OF TRUENAME @OZ00751*/
*            ADDR(IOCSINP -> IOCDAD -> RECKEY );           /*@OZ00751*/
         L     @01,IOCSINP                                         1399
         MVC   DARGDTM(4,@08),IOCDAD(@01)                          1399
*            DARGINS(2) = 2;                               /*@OZ00751*/
         STH   @15,DARGINS+8(,@08)                                 1400
*            DARGINL(2) = 6;                               /*@OZ00751*/
         MVC   DARGINL+8(2,@08),@CH00156                           1401
*            DARGDTM(2) = ADDR(CBACKUP);                   /*@OZ00751*/
*                                                                  1402
         LA    @15,CBACKUP                                         1402
         ST    @15,DARGDTM+8(,@08)                                 1402
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@OZ00751*/
*                                                                  1403
         L     @08,@PC00001                                        1403
         ST    @08,@AL00001                                        1403
         LA    @15,@CF00115                                        1403
         ST    @15,@AL00001+4                                      1403
         LA    @15,DDSTRU                                          1403
         ST    @15,@AL00001+8                                      1403
         MVI   @AL00001+8,X'80'                                    1403
         L     @15,GDTPRT(,@08)                                    1403
         LA    @01,@AL00001                                        1403
         BALR  @14,@15                                             1403
*            STATFLG = ABNCONDT;                           /*@OZ00751*/
*                                                                  1404
         MVC   STATFLG(5),@CB00813                                 1404
*            K = K + 1;                                    /*@OZ00751*/
*                                                                  1405
         AH    K,@CH00219                                          1405
*            END;                                          /*@OZ00751*/
*                                                                  1406
*        /***********************************************************/
*        /*                                                  @OZ00751*/
*        /* IF THE NUMBER OF COMPARE MESSAGES IS MORE THAN   @OZ00751*/
*        /* 100  THEN PRINT A MESSAGE INDICATING THE         @OZ00751*/
*        /* COMPARE FUNCTION IS NO LONGER OPERATING.        
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1407
*        IF K = LIMIT                                              1407
*          THEN                                                    1407
@RF01389 CH    K,@CH00147                                          1407
         BNE   @RF01407                                            1407
*            DO;                                           /*@OZ00751*/
*                                                                  1408
*            DARGLIST = ''B;                               /*@OZ00751*/
         L     @08,DDSTRU                                          1409
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1409
*            DARGSMOD = 'PR0';                             /*@OZ00751*/
         MVC   DARGSMOD(3,@08),@CC01129                            1410
*            DARGSENT = '16'X;                             /*@OZ00751*/
*                                                                  1411
         MVI   DARGSENT(@08),X'16'                                 1411
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@OZ00751*/
*                                                                  1412
         L     @08,@PC00001                                        1412
         ST    @08,@AL00001                                        1412
         LA    @15,@CF00115                                        1412
         ST    @15,@AL00001+4                                      1412
         LA    @15,DDSTRU                                          1412
         ST    @15,@AL00001+8                                      1412
         MVI   @AL00001+8,X'80'                                    1412
         L     @15,GDTPRT(,@08)                                    1412
         LA    @01,@AL00001                                        1412
         BALR  @14,@15                                             1412
*            K = K + 1;                                    /*@OZ00751*/
*                                                                  1413
         AH    K,@CH00219                                          1413
*            STATFLG=ABNCONDT;                             /*@OZ00751*/
*                                                                  1414
         MVC   STATFLG(5),@CB00813                                 1414
*            END;                                          /*@OZ00751*/
*                                                                  1415
*        END CATCOMP;                                      /*@OZ00751*/
*                                                                  1416
@EL00011 DS    0H                                                  1416
@EF00011 DS    0H                                                  1416
@ER00011 LM    @14,@04,@SA00011                                    1416
         LM    @06,@12,@SA00011+28                                 1416
         BR    @14                                                 1416
*VERIFYC:                                                          1417
*        PROC;                                             /*@OZ00751*/
*                                                                  1417
VERIFYC  STM   @14,@12,@SA00012                                    1417
*        OLDERID2 = NEWERID2;                                      1418
         L     @08,@PC00001                                        1418
         L     @07,GDTTR2(,@08)                                    1418
         MVC   @TS00001(95),NEWERID2(@07)                          1418
         MVC   OLDERID2(95,@07),@TS00001                           1418
*        NEWID2='RPT6';                                    /*@OZ00751*/
*                                                                  1419
         MVC   NEWID2(4,@07),@CC01264                              1419
*/********************************************************************/
*/*                                                          @OZ00751*/
*/* PROCEDURE NAME - VERIFYC                                 @OZ00751*/
*/*                                                          @OZ00751*/
*/* FUNCTION- THE OBJECT CATALOG MUST BE VERIFIED BEFORE     @OZ00751*/
*/*            PROCESSING. THE SEQUENCE OF EVENTS IS:        @OZ00751*/
*/*         .  CLOSE THE OBJECT(IGNORE ANY CLOSE ERRORS)     @OZ00751*/
*/*         .  REOPEN FOR CI PROCESSING                      @OZ00751*/
*/*         .  CALL VERIFY FOR THE OBJECT                    @OZ00751*/
*/*         .  CLOSE THE OBJECT                              @OZ00751*/
*/*         .  REOPEN AS BEFORE                              @OZ00751*/
*/*                                                          @OZ00751*/
*/* INPUT - POINTER TO A CATALOG OPENED ALREADY AS A VSAM    @OZ00751*/
*/*         DATA SET.                                        @OZ00751*/
*/*       - THE LOOP COUNTER J WILL HAVE VALUE 1 IF THE      @OZ00751*/
*/*         OUTPUT IS BEING VERIFIED AND VALUE 2 IF INPUT    @OZ00751*/
*/* OUTPUT - THE CATALOG HAS BEEN VERIFIED.                  @OZ00751*/
*/*                                                          @OZ00751*/
*/********************************************************************/
*                                                                  1420
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* CLOSE THE OBJECT CATALOG                         @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1420
*        CALL IDCIOCL0 (GDTTBL,IOCSPTR);                   /*@OZ00751*/
*                                                                  1420
         ST    @08,@AL00001                                        1420
         LA    @07,IOCSPTR                                         1420
         ST    @07,@AL00001+4                                      1420
         MVI   @AL00001+4,X'80'                                    1420
         L     @15,GDTCLS(,@08)                                    1420
         LA    @01,@AL00001                                        1420
         BALR  @14,@15                                             1420
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* RESET THE OPNAGL SO THAT THE CATALOG WILL BE     @OZ00751*/
*        /* OPENED FOR CI PROCESSING.                        @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1421
*        OPNOPTIN = OFF;                                   /*@OZ00751*/
*        OPNOPTOT = ON;                                    /*@OZ00751*/
*        OPNOPTBK = ON;                                    /*@OZ00751*/
*        OPNOPTCR = ON;                                    /*@OZ00751*/
*                                                                  1424
         OI    OPNOPTOT(OPNPTR),B'01010100'                        1424
         NI    OPNOPTIN(OPNPTR),B'01111111'                        1424
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* OPEN FOR CI PROCESSING                           @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1425
*        CALL IDCIOOP0 (GDTTBL,OPAGLST);                   /*@OZ00751*/
         L     @08,@PC00001                                        1425
         ST    @08,@AL00001                                        1425
         ST    OPNPTR,@AL00001+4                                   1425
         MVI   @AL00001+4,X'80'                                    1425
         L     @15,GDTOPN(,@08)                                    1425
         LA    @01,@AL00001                                        1425
         BALR  @14,@15                                             1425
*        RESPECIFY RTNREG RSTD;                                    1426
*        TESTRC = RTNREG;                                          1427
         STH   RTNREG,TESTRC                                       1427
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/
*                                                                  1428
*        IF TESTRC ^= 0                                            1429
*          THEN                                                    1429
         LH    @08,TESTRC                                          1429
         LTR   @08,@08                                             1429
         BZ    @RF01429                                            1429
*            DO;                                           /*@OZ00751*/
*                                                                  1430
*            OLDERID2 = NEWERID2;                          /*@OZ00751*/
         L     @08,@PC00001                                        1431
         L     @08,GDTTR2(,@08)                                    1431
         MVC   @TS00001(95),NEWERID2(@08)                          1431
         MVC   OLDERID2(95,@08),@TS00001                           1431
*            NEWID2 = 'CP14';                              /*@OZ00751*/
         MVC   NEWID2(4,@08),@CC01265                              1432
*            STATFLG = TERMERR;                            /*@OZ00751*/
         MVC   STATFLG(5),@CB00819                                 1433
*            RETURN;                                       /*@OZ00751*/
*                                                                  1434
@EL00012 DS    0H                                                  1434
@EF00012 DS    0H                                                  1434
@ER00012 LM    @14,@12,@SA00012                                    1434
         BR    @14                                                 1434
*            END;                                          /*@OZ00751*/
*                                                                  1435
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* VERIFY THE OBJECT CATALOG                        @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1436
*       IF J = 2                                                   1436
*          THEN                                                    1436
@RF01429 CH    J,@CH00153                                          1436
         BNE   @RF01436                                            1436
*            IOCSPTR = IOCSINP;                            /*@OZ00751*/
         MVC   IOCSPTR(4),IOCSINP                                  1437
*          ELSE                                                    1438
*            IOCSPTR = IOCSOUT;                            /*@OZ00751*/
*                                                                  1438
         B     @RC01436                                            1438
@RF01436 MVC   IOCSPTR(4),IOCSOUT                                  1438
*        IF STATFLG = NORMAL                                       1439
*          THEN                                                    1439
@RC01436 CLC   STATFLG(5),@CB00816                                 1439
         BNE   @RF01439                                            1439
*            DO;                                           /*@OZ00751*/
*                                                                  1440
*            CALL IDCIOVY0 (GDTTBL,IOCSPTR);               /*@OZ00751*/
         L     @08,@PC00001                                        1441
         ST    @08,@AL00001                                        1441
         LA    @07,IOCSPTR                                         1441
         ST    @07,@AL00001+4                                      1441
         MVI   @AL00001+4,X'80'                                    1441
         L     @15,GDTVFY(,@08)                                    1441
         LA    @01,@AL00001                                        1441
         BALR  @14,@15                                             1441
*            RESPECIFY RTNREG RSTD;                                1442
*            TESTRC = RTNREG;                                      1443
         STH   RTNREG,TESTRC                                       1443
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/
*                                                                  1444
*            IF TESTRC ^= 0                                        1445
*              THEN                                                1445
*                                                                  1445
         LH    @08,TESTRC                                          1445
         LTR   @08,@08                                             1445
         BZ    @RF01445                                            1445
*                STATFLG = TERMERR;                        /*@OZ00751*/
         MVC   STATFLG(5),@CB00819                                 1446
*            END;                                          /*@OZ00751*/
*                                                                  1447
@RF01445 DS    0H                                                  1448
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* CLOSE AND RESET THE OPEN OPTIONS                 @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1448
*        CALL IDCIOCL0 (GDTTBL,IOCSPTR);                   /*@OZ00751*/
*                                                                  1448
@RF01439 L     @08,@PC00001                                        1448
         ST    @08,@AL00001                                        1448
         LA    @07,IOCSPTR                                         1448
         ST    @07,@AL00001+4                                      1448
         MVI   @AL00001+4,X'80'                                    1448
         L     @15,GDTCLS(,@08)                                    1448
         LA    @01,@AL00001                                        1448
         BALR  @14,@15                                             1448
*        IF J = 2                                                  1449
*          THEN                                                    1449
         CH    J,@CH00153                                          1449
         BNE   @RF01449                                            1449
*            DO;                                           /*@OZ00751*/
*            OPNOPTIN = ON;                                /*@OZ00751*/
*            OPNOPTOT = OFF;                               /*@OZ00751*/
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1452
         NI    OPNOPTOT(OPNPTR),B'10111111'                        1452
*            END;                                                  1453
*                                                                  1453
*        OPNOPTBK = OFF;                                   /*@OZ00751*/
@RF01449 DS    0H                                                  1455
*        OPNOPTCR = OFF;                                   /*@OZ00751*/
*        OPNOPTKS = ON;                                    /*@OZ00751*/
*                                                                  1456
         OI    OPNOPTKS(OPNPTR),B'00001000'                        1456
         NI    OPNOPTBK(OPNPTR),B'11101011'                        1456
*        /************************************************************/
*        /*                                                  @OZ00751*/
*        /* REOPEN FOR NORMAL KEYED PROCESSING.              @OZ00751*/
*        /*                                                  @OZ00751*/
*        /************************************************************/
*                                                                  1457
*        IF STATFLG = NORMAL                                       1457
*          THEN                                                    1457
         CLC   STATFLG(5),@CB00816                                 1457
         BNE   @RF01457                                            1457
*            DO;                                           /*@OZ00751*/
*            CALL IDCIOOP0 (GDTTBL,OPAGLST);               /*@OZ00751*/
         L     @08,@PC00001                                        1459
         ST    @08,@AL00001                                        1459
         ST    OPNPTR,@AL00001+4                                   1459
         MVI   @AL00001+4,X'80'                                    1459
         L     @15,GDTOPN(,@08)                                    1459
         LA    @01,@AL00001                                        1459
         BALR  @14,@15                                             1459
*            RESPECIFY RTNREG RSTD;                                1460
*            TESTRC = RTNREG;                                      1461
         STH   RTNREG,TESTRC                                       1461
*            RESPECIFY RTNREG UNRSTD;                              1462
*                                                                  1462
*            IF TESTRC ^= 0                                        1463
*              THEN                                                1463
         LH    @08,TESTRC                                          1463
         LTR   @08,@08                                             1463
         BZ    @RF01463                                            1463
*                DO;                                       /*@OZ00751*/
*                                                                  1464
*                OLDERID2 = NEWERID2;                      /*@OZ00751*/
         L     @08,@PC00001                                        1465
         L     @08,GDTTR2(,@08)                                    1465
         MVC   @TS00001(95),NEWERID2(@08)                          1465
         MVC   OLDERID2(95,@08),@TS00001                           1465
*                NEWID2   = 'CP14';                        /*@OZ00751*/
         MVC   NEWID2(4,@08),@CC01265                              1466
*                STATFLG  = TERMERR;                       /*@OZ00751*/
         MVC   STATFLG(5),@CB00819                                 1467
*                END;                                      /*@OZ00751*/
*            END;                                          /*@OZ00751*/
*                                                                  1469
*        END VERIFYC;                                      /*@OZ00751*/
*                                                                  1470
         B     @EL00012                                            1470
*        END CATRELOD;                                     /*@OZ00751*/
*                                                                  1471
*/*******************************************************************/
*/*                                                          @Y30SSEC*/
*/*PROCEDURE NAME - RECOVCAT                                 @Y30SSEC*/
*/*                                                          @Y30SSEC*/
*/* FUNCTION - RECOVCAT RECEIVES CONTROL FROM IDCRP01 WHEN A @Y30SSEC*/
*/* CATALOG COPY OPERATION IS TO TAKE PLACE. BOTH CATALOGS   @Y30SSEC*/
*/* ARE CHECKED FOR THE RECOVERABLE ATTRIBUTE VIA A LOCATE   @Y30SSEC*/
*/* OF THE DATA COMPONENT ENTRY FOR EACH CATALOG.            @Y30SSEC*/
*/*                                                          @Y30SSEC*/
*/* INPUT - ASSUMES THAT BOTH CATALOGS ARE OPEN AND THE ACB  @Y30SSEC*/
*/*         ADDRESS IS AVAILABLE IN HOLDACB(J). ALSO, THAT   @Y30SSEC*/
*/*         THE DATA COMPONET CI NUMBER REMAINS = 0.         @Y30SSEC*/
*/* OUTPUT - IF EITHER  OF THE CATALOGS ARE                  @Y30SSEC*/
*/*          RECOVERABLE AN ERROR MESSAGE IS ISSUED.         @Y30SSEC*/
*/*                                                          @Y30SSEC*/
*/********************************************************************/
*RECOVCAT:                                                         1472
*        PROCEDURE ;                                       /*@Y30SSEC*/
RECOVCAT STM   @14,@12,@SA00013                                    1472
*        /************************************************** @Y30SSEC*/
*        /*                                                  @Y30SSEC*/
*        /* SET UP CTGPL AND CTGFPL TO GET DATA COMPONENT    @Y30SSEC*/
*        /* OF CATALOG ENTRIES TO BE COPIED.                 @Y30SSEC*/
*        /*                                                  @Y30SSEC*/
*        /************************************************** @Y30SSEC*/
*        IF STATFLG = NORMAL                                       1473
*          THEN                                                    1473
         CLC   STATFLG(5),@CB00816                                 1473
         BNE   @RF01473                                            1473
*ATTRLOOP:   DO J = 1 TO 2 WHILE STATFLG ^= TERMERR;       /*@Y30SSEC*/
*                                                                  1474
ATTRLOOP LA    J,1                                                 1474
@DL01474 CLC   STATFLG(5),@CB00819                                 1474
         BE    @DC01474                                            1474
*            LOCATWKA = ''B;  /* ZERO LOCATE WORK AREA       @Y30SSEC*/
         XC    LOCATWKA(180),LOCATWKA                              1475
*            LOCCPLID = 'LOCATTR1';  /* DUMP ID              @Y30SSEC*/
         MVC   LOCCPLID(8),@CC01271                                1476
*            CTGPLPTR = ADDR(LOCATCPL);  /* SET CPL PTR      @Y30SSEC*/
         LA    @08,LOCATCPL                                        1477
         ST    @08,CTGPLPTR                                        1477
*            CTGFUNC = '001'B;  /* SET LOCATE FLAG           @Y30SSEC*/
         NI    CTGFUNC(@08),B'00111111'                            1478
         OI    CTGFUNC(@08),B'00100000'                            1478
*            CTGAM0 = ON; /* SET VSAM FUNC                   @Y30SSEC*/
*            CTGSRH = OFF; /* SEARCH VSAM CATLG              @Y30SSEC*/
*            CTGNUM = ON;  /* ONLY VSAM CATLG                @Y30SSEC*/
         OI    CTGAM0(@08),B'00000011'                             1481
         NI    CTGSRH(@08),B'11111011'                             1481
*            CTGCNAME = OFF;  /* LOCATE BY ACB               @Y30SSEC*/
         NI    CTGCNAME(@08),B'11111101'                           1482
*            CTGCAT = ADDR(HOLDACB(J));  /* POINT TO CAT ACB @Y30SSEC*/
         LR    @07,J                                               1483
         SLA   @07,2                                               1483
         LA    @07,HOLDACB-4(@07)                                  1483
         ST    @07,CTGCAT(,@08)                                    1483
*            CTGNAME = OFF;  /* LOCATE BY CI NUMBER          @Y30SSEC*/
         NI    CTGNAME(@08),B'11111011'                            1484
*            CTGENT = ADDR(DATACI#); /* DATA COMP CI NUMBER  @Y30SSEC*/
         LA    @07,DATACI#                                         1485
         ST    @07,CTGENT(,@08)                                    1485
*            CTGNOFLD = 1;  /* NUMBER OF FPLS                @Y30SSEC*/
         MVI   CTGNOFLD(@08),X'01'                                 1486
*            CTGWKA = ADDR(LOCWKA);  /* ADDR OF WORK AREA    @Y30SSEC*/
         LA    @07,LOCWKA                                          1487
         ST    @07,CTGWKA(,@08)                                    1487
*            LOCWKALN = LENGTH(LOCWKA); /* SET LENGTH        @Y30SSEC*/
*                                                                  1488
         MVC   LOCWKALN(2),@CH00631                                1488
*            /*********************************************  @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /* SET UP PASSWORD FIELDS                       @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /*********************************************  @Y30SSEC*/
*                    IF J = 1                              /*@Y30SSEC*/
*                      THEN   /*  SET PASWORDS               @Y30SSEC*/
         CH    J,@CH00219                                          1489
         BNE   @RF01489                                            1489
*                        DO;                               /*@Y30SSEC*/
*                          IF ADDR(OUTDD) ^= 0 & OUTDDPLN ^= 0     1491
*                             THEN                         /*@Y30SSEC*/
         L     @07,@PC00001+4                                      1491
         L     @07,FDTPTR+36(,@07)                                 1491
         LTR   @07,@07                                             1491
         BZ    @RF01491                                            1491
         CLI   OUTDDPLN(@07),0                                     1491
         BE    @RF01491                                            1491
*                               CTGPSWD = ADDR(OUTDDPAS);  /*@Y30SSEC*/
         LA    @07,OUTDDPAS(,@07)                                  1492
         ST    @07,CTGPSWD(,@08)                                   1492
*                             ELSE                         /*@Y30SSEC*/
*                               IF ADDR(OUTDS) ^= 0 & OUTDSPLN ^= 0
*                                  THEN CTGPSWD = ADDR(OUTDSPAS);  1493
         B     @RC01491                                            1493
@RF01491 L     @08,@PC00001+4                                      1493
         L     @08,FDTPTR+44(,@08)                                 1493
         LTR   @08,@08                                             1493
         BZ    @RF01493                                            1493
         CLI   OUTDSPLN(@08),0                                     1493
         BE    @RF01493                                            1493
         LA    @08,OUTDSPAS(,@08)                                  1494
         L     @07,CTGPLPTR                                        1494
         ST    @08,CTGPSWD(,@07)                                   1494
*                                  ELSE;                   /*@Y30SSEC*/
@RF01493 DS    0H                                                  1496
*                          IF ADDR(INPDD) ^= 0 & INPDDPLN ^= 0     1496
*                             THEN                         /*@Y30SSEC*/
@RC01491 L     @08,@PC00001+4                                      1496
         L     @08,FDTPTR+32(,@08)                                 1496
         LTR   @08,@08                                             1496
         BZ    @RF01496                                            1496
         CLI   INPDDPLN(@08),0                                     1496
         BE    @RF01496                                            1496
*                               CTGPSWD = ADDR(INPDDPAS);  /*@Y30SSEC*/
         LA    @08,INPDDPAS(,@08)                                  1497
         L     @07,CTGPLPTR                                        1497
         ST    @08,CTGPSWD(,@07)                                   1497
*                             ELSE                         /*@Y30SSEC*/
*                               IF ADDR(INDS) ^= 0 & INDSPLN ^= 0  1498
*                                  THEN CTGPSWD = ADDR(INDSPAS);   1498
         B     @RC01496                                            1498
@RF01496 L     @08,@PC00001+4                                      1498
         L     @08,FDTPTR+280(,@08)                                1498
         LTR   @08,@08                                             1498
         BZ    @RF01498                                            1498
         CLI   INDSPLN(@08),0                                      1498
         BE    @RF01498                                            1498
         LA    @08,INDSPAS(,@08)                                   1499
         L     @07,CTGPLPTR                                        1499
         ST    @08,CTGPSWD(,@07)                                   1499
*                                  ELSE;                   /*@Y30SSEC*/
@RF01498 DS    0H                                                  1501
*                        END;                              /*@Y30SSEC*/
*                                                                  1501
@RC01496 DS    0H                                                  1502
*            /*********************************************  @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /* INITIALIZE FPL                               @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /*********************************************  @Y30SSEC*/
*            DSATRFPL = ''B;  /* ZERO OUT FPL                @Y30SSEC*/
@RF01489 XC    DSATRFPL(28),DSATRFPL                               1502
*            CTGFLPTR = ADDR(DSATRFPL);  /* SET CTG PTR      @Y30SSEC*/
         LA    CTGFLPTR,DSATRFPL                                   1503
*            CTGFLDNM = ADDR(DSATRNAM); /* POINT TO FPL NAME @Y30SSEC*/
         LA    @08,DSATRNAM                                        1504
         ST    @08,CTGFLDNM(,CTGFLPTR)                             1504
*            CTGFIELD(1) = CTGFLPTR;  /* POINT TO FPL        @Y30SSEC*/
         L     @08,CTGPLPTR                                        1505
         ST    CTGFLPTR,CTGFIELD(,@08)                             1505
*            /*********************************************  @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /* SET UP DUMP PARMS FOR CTGPL AND CTGFPL AREAS @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /*********************************************  @Y30SSEC*/
*            IF GDTDBG = NULLPTR                                   1506
*               THEN;                                      /*@Y30SSEC*/
         L     @08,@PC00001                                        1506
         L     @08,GDTDBG(,@08)                                    1506
         LTR   @08,@08                                             1506
         BZ    @RT01506                                            1506
*               ELSE                                               1508
*                 DO;                                      /*@Y30SSEC*/
*                 DMPINDEX = ADDR(DMPLST1); /* POINT TO DUMP LIST    */
         LA    @08,DMPLST1                                         1509
         ST    @08,DMPINDEX                                        1509
*                 DMPITMNM = 'DSATRCPL';  /* NAME FIRST DUMP @Y30SSEC*/
         MVC   DMPITMNM(8,@08),@CC01272                            1510
*                 DMPITMPT = CTGPLPTR; /* POINT TO AREA      @Y30SSEC*/
         MVC   DMPITMPT(4,@08),CTGPLPTR                            1511
*                 DMPITMLN = LENGTH(CTGPL) + 4;            /*@Y30SSEC*/
         MVC   DMPITMLN(2,@08),@CH00221                            1512
*                 DMPITMTP = 'H';  /* SET TYPE OF DUMP       @Y30SSEC*/
         MVI   DMPITMTP(@08),C'H'                                  1513
*                 DMPINDEX = DMPINDEX + DMPELEMT; /* NEXT LIST ENTRY */
         LA    @05,16                                              1514
         LR    @15,@08                                             1514
         ALR   @15,@05                                             1514
         ST    @15,DMPINDEX                                        1514
*                 DMPITMNM = 'DSATRFPL';  /* NAME 2DN ENTRY  @Y30SSEC*/
         MVC   DMPITMNM(8,@15),@CC01273                            1515
*                 DMPITMPT = CTGFLPTR;  /* POINT TO AREA     @Y30SSEC*/
         ST    CTGFLPTR,DMPITMPT(,@15)                             1516
*                 DMPITMLN = LENGTH(CTGFL) + 8;/* SET LENGTH @Y30SSEC*/
         MVC   DMPITMLN(2,@15),@CH00310                            1517
*                 DMPITMTP = 'H';  /* SET TYPE OF DUMP       @Y30SSEC*/
         MVI   DMPITMTP(@15),C'H'                                  1518
*                 DMPINDEX = DMPINDEX + DMPELEMT; /* NEXT LIST ENTRY */
         ALR   @15,@05                                             1519
         ST    @15,DMPINDEX                                        1519
*                 DMPTRM = DMPTRMVL;  /* SET END OF LIST CODE */   1520
         MVI   DMPTRM(@15),X'FF'                                   1520
*                 DMPINDEX = ADDR(DMPLST1); /* POINT TO DUMP LIST    */
         ST    @08,DMPINDEX                                        1521
*                 IF GDTDBG = NULLPTR                              1522
*                   THEN;                                          1522
         L     @08,@PC00001                                        1522
         L     @08,GDTDBG(,@08)                                    1522
         LTR   @08,@08                                             1522
         BZ    @RT01522                                            1522
*                   ELSE                                           1524
*                     CALL IDCDB010 (GDTTBL,'RPRV',DMPINDEX);      1524
         L     @08,@PC00001                                        1524
         ST    @08,@AL00001                                        1524
         LA    @05,@CC01274                                        1524
         ST    @05,@AL00001+4                                      1524
         LA    @05,DMPINDEX                                        1524
         ST    @05,@AL00001+8                                      1524
         MVI   @AL00001+8,X'80'                                    1524
         L     @15,GDTDBG(,@08)                                    1524
         LA    @01,@AL00001                                        1524
         BALR  @14,@15                                             1524
*                                                          /*@Y30SSEC*/
*                 END;                                     /*@Y30SSEC*/
@RT01522 DS    0H                                                  1526
*            /*********************************************  @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /* INVOKE CATALOG MGT TO LOCATE CAT DATA COMP   @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /*********************************************  @Y30SSEC*/
*            CALL IDCSACA0 (GDTTBL,CTGPLPTR);              /*@Y30SSEC*/
@RT01506 L     @08,@PC00001                                        1526
         ST    @08,@AL00001                                        1526
         LA    @15,CTGPLPTR                                        1526
         ST    @15,@AL00001+4                                      1526
         L     @15,GDTCAT(,@08)                                    1526
         LA    @01,@AL00001                                        1526
         BALR  @14,@15                                             1526
*            CTGRTNCC = RTNREG; /* SAVE RETURN CODE          @Y30SSEC*/
         LR    CTGRTNCC,RTNREG                                     1527
*            /*********************************************  @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /* IF THE CATALOG ENTRY IS LOCATED CHECK TO SEE @Y30SSEC*/
*            /* IF IT HAS THE RECOVERABLE ATTRIBUTE.         @Y30SSEC*/
*            /* IF IT IS RECOVERABLE PRINT AN ERROR MESSAGE. @Y30SSEC*/
*            /* OTHERWISE CONTINUE WITH NORMAL PROCESSING.   @Y30SSEC*/
*            /*                                              @Y30SSEC*/
*            /*********************************************  @Y30SSEC*/
*            IF CTGRTNCC = 0                                       1528
*              THEN                                                1528
         LTR   CTGRTNCC,CTGRTNCC                                   1528
         BNZ   @RF01528                                            1528
*                DO;                                       /*@Y30SSEC*/
*                IF CTGFLPT(1) -> RECOVHIT = ON                    1530
*                  THEN                                            1530
         L     @08,CTGFLPT(,CTGFLPTR)                              1530
         TM    RECOVHIT(@08),B'00001000'                           1530
         BNO   @RF01530                                            1530
*                    DO;                                   /*@Y30SSEC*/
*                    STATFLG = TERMERR;                    /*@Y30SSEC*/
         MVC   STATFLG(5),@CB00819                                 1532
*                    DARGLIST = ''B; /* CLEAR PARM AREA      @Y30SSEC*/
         L     @08,DDSTRU                                          1533
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1533
*                    DARGSMOD = 'PR0';  /* STATIC TEXT MOD   @Y30SSEC*/
         MVC   DARGSMOD(3,@08),@CC01129                            1534
*                    DARGSENT = 24;  /* STATIC TEXT ENTRY    @Y30SSEC*/
         MVI   DARGSENT(@08),X'18'                                 1535
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30SSEC*/
         L     @08,@PC00001                                        1536
         ST    @08,@AL00001                                        1536
         LA    @07,@CF00115                                        1536
         ST    @07,@AL00001+4                                      1536
         LA    @07,DDSTRU                                          1536
         ST    @07,@AL00001+8                                      1536
         MVI   @AL00001+8,X'80'                                    1536
         L     @15,GDTPRT(,@08)                                    1536
         LA    @01,@AL00001                                        1536
         BALR  @14,@15                                             1536
*                    END;                                  /*@Y30SSEC*/
*                  ELSE;                                   /*@Y30SSEC*/
@RF01530 DS    0H                                                  1539
*                END;                                      /*@Y30SSEC*/
*                ELSE                                      /*@Y30SSEC*/
*                  STATFLG = TERMERR;                      /*@Y30SSEC*/
         B     @RC01528                                            1540
@RF01528 MVC   STATFLG(5),@CB00819                                 1540
*            END ATTRLOOP;                                 /*@Y30SSEC*/
@RC01528 AH    J,@CH00219                                          1541
         CH    J,@CH00153                                          1541
         BNH   @DL01474                                            1541
@DC01474 DS    0H                                                  1542
*        END RECOVCAT;                                     /*@Y30SSEC*/
@EL00013 DS    0H                                                  1542
@EF00013 DS    0H                                                  1542
@ER00013 LM    @14,@12,@SA00013                                    1542
         BR    @14                                                 1542
*        END IDCRP01                                       /*@OZ00751*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRP )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        *
*;                                                                 1543
@DATA    DS    0H
@CH00219 DC    H'1'
@CH00162 DC    H'3'
@CH00042 DC    H'4'
@CH00156 DC    H'6'
@CH00466 DC    H'7'
@CH00624 DC    H'13'
@CH00476 DC    H'16'
@CH00310 DC    H'24'
@CH01283 DC    H'28'
@CH00221 DC    H'32'
@CH00812 DC    H'40'
@CH00622 DC    H'44'
@CH00631 DC    H'48'
@CH00147 DC    H'100'
@CH01229 DC    H'250'
@SC01302 CLC   TOKYCVAL(0,@08),RECDKEY(@04)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00012 DS    15F
@SA00003 DS    15F
@SA00013 DS    15F
@SA00002 DS    15F
@PC00002 DS    3F
@SA00006 DS    15F
@SA00008 DS    15F
@SA00010 DS    15F
@SA00009 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00011 DS    14F
@SA00007 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
@TF00002 DS    F
@AFTEMPS DS    3F
@ZTEMPS  DS    0F
@ZT00001 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IDCRP01  CSECT
         DS    0F
@CF00115 DC    F'0'
@CF00153 DC    F'2'
@CH00153 EQU   @CF00153+2
@CF01276 DC    F'20'
@CH01276 EQU   @CF01276+2
@CF01205 DC    F'47'
@CH01205 EQU   @CF01205+2
@CF01128 DC    F'116'
@CF01050 DC    F'512'
@CF01305 DC    F'-6'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CTGPLPTR DS    A
IOCSINP  DS    A
IOCSOUT  DS    A
IOCSOUP  DS    A
LOOPCNT  DS    F
OLDREL   DS    F
ENDKYLN  DS    F
STBLDIM  DS    F
TTBLDIM  DS    F
QCATPSWD DS    A
QCATPTR  DS    A
QDSNPTR  DS    A
HURBASAV DS    F
HARBASAV DS    F
NEWCINUM DS    F
FREENUM  DS    F
ALLAGLPT DS    A
LISTPTR  DS    A
TESTRC   DS    H
LOOPINCR DS    H
FAILIOER DS    H
EOFSW    DS    H
QDSNLEN  DS    H
SETRC    DS    H
CFROLD   DS    AL3
EMPTYCI  DS    FL1
OCCRNFCI DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL3
OPNARGS  DS    CL144
         ORG   OPNARGS
OPAGLST1 DS    BL48
OPAGLST2 DS    BL48
OPAGLST3 DS    BL48
         ORG   OPNARGS+144
DARGL    DS    CL28
CPRECID  DS    CL1
DELIMFLG DS    CL1
CYCLEFLG DS    CL1
         DS    CL1
STATFLG  DS    CL5
         ORG   STATFLG
STMODID  DS    CL3
STATFLG1 DS    AL1
STATFLG2 DS    AL1
         ORG   STATFLG+5
         DS    CL3
LOCATWKA DS    CL180
         ORG   LOCATWKA
LOCCPLID DS    CL8
LOCATCPL DS    CL28
@NM00046 DS    CL12
ENTYPFPL DS    CL16
@NM00047 DS    CL12
ENTIDFPL DS    CL16
@NM00048 DS    CL12
ACBFPL   DS    CL16
@NM00049 DS    CL12
LOCWKA   DS    CL48
         ORG   LOCWKA
LOCWKALN DS    FL2
         ORG   LOCATWKA+180
DSATRFPL DS    CL28
DMPLST1  DS    CL36
CATRELSW DS    BL1
CATCOPSW DS    BL1
OPNWRN   DS    BL1
IOPOSSW  DS    CL1
READSW   DS    BL1
CCRECSTR DS    CL51
         ORG   CCRECSTR
@NM00063 DS    CL48
NFCISTOR DS    AL3
         ORG   CCRECSTR+51
CURRKEYT DS    CL44
EMPTYSW  DS    BL1
DUMPAREA DS    CL49
         ORG   DUMPAREA
DMNAME1  DS    CL8
DMADDR1  DS    AL4
DMLEN1   DS    FL2
DMTYP2   DS    CL1
         ORG   DUMPAREA+49
ALLAGLWK DS    CL31
SKIPFLAG DS    CL1
         DS    CL2
HOLDACB  DS    2A
STBL     DS    CL8
         ORG   STBL+0
STBLHI   DS    FL4
STBLGAP  DS    FL4
         ORG   STBL+128
TTBL     DS    CL8
         ORG   TTBL+0
TTBLHI   DS    FL4
TTBLGAP  DS    FL4
         ORG   TTBL+128
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
DATACI#  DC    A(0)
MSGENTRY DC    AL1(17)
@CC01136 DC    C'LOCATCPL'
@CC01201 DC    C'DLOUTREC'
@CC01203 DC    C'FUPOTREC'
@CC01204 DC    C'INSOTREC'
@CC01207 DC    C'UPOUTREC'
@CC01215 DC    C'RDINPREC'
@CC01220 DC    C'RDOUTREC'
@CC01228 DC    C'2ND-HALF'
@CC01230 DC    C'RET-CODE'
@CC01236 DC    C'SORSTABL'
@CC01237 DC    C'TARGTABL'
@CC01271 DC    C'LOCATTR1'
@CC01272 DC    C'DSATRCPL'
@CC01273 DC    C'DSATRFPL'
@CC01210 DC    C'RDCCREC'
@CC01211 DC    C'UPCCREC'
@CC01252 DC    C'OLDCI#'
@CC01253 DC    C'NEWCI#'
@CC00831 DC    C'RP01'
@CC01127 DC    C'RP12'
@CC01144 DC    C'RP13'
@CC01154 DC    C'RP18'
@CC01180 DC    C'RP21'
@CC01184 DC    C'RPT1'
@CC01195 DC    C'RPD1'
@CC01231 DC    C'RPIO'
@CC01235 DC    C'RPT2'
@CC01238 DC    C'RPTU'
@CC01242 DC    C'RPT3'
@CC01251 DC    C'RPT4'
@CC01254 DC    C'RPCI'
@CC01258 DC    C'RPT5'
@CC01264 DC    C'RPT6'
@CC01265 DC    C'CP14'
@CC01274 DC    C'RPRV'
@CC01129 DC    C'PR0'
@CC01155 DC    C'UV0'
@CB00813 DC    X'E4E5F00409'
@CB00816 DC    X'E4E5F00001'
@CB00819 DC    X'E4E5F00C03'
@CB00822 DC    X'E4E5F00C06'
@CB00825 DC    X'E4E5F00809'
@CB00828 DC    X'D7D9F00C10'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'RP01'
FIXAREA  DS    CL256
         ORG   FIXAREA
@NM00044 DS    CL256
         ORG   @NM00044
@NM00045 DC    256X'00'
         ORG   FIXAREA+256
DSATRNAM DC    CL8'DSATTR'
CTARGET  DC    CL7'TARGET'
CBACKUP  DC    CL7'BACKUP'
CDEVTYP  DC    CL6'DEVTYP'
CNAME    DC    CL6'NAME  '
CVOLSER  DC    CL6'VOLSER'
TYPFIELD DC    CL8'ENTYPE'
         DC    CL8'ENTIDNO'
         DC    CL8'CATACB'
COMFTBL  DC    CL1'A'
         DC    CL1'D'
         DC    CL1'I'
         DC    CL1'C'
         DC    CL1'U'
         DC    CL1'B'
         DC    CL1'X'
         DC    CL1'E'
         DC    CL1'V'
         DC    CL1'W'
         DC    CL1'G'
         DC    CL1'R'
         DC    CL1'Y'
MSGARY   DC    CL11'FROMKEY'
         DC    CL11'TOKEY'
         DC    CL11'FROMADDRESS'
         DC    CL11'TOADDRESS'
         DC    CL11'FROMNUMBER'
         DC    CL11'TONUMBER'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MSGINDX  EQU   @02
SKIPLOOP EQU   @05
COMFTBLX EQU   @05
WRKCINUM EQU   @05
GOSTART  EQU   @07
GOPLEN   EQU   @02
CTGRTNCC EQU   @05
K        EQU   @05
L        EQU   @06
J        EQU   @06
I        EQU   @02
N        EQU   @05
CTGFLPTR EQU   @07
OPNPTR   EQU   @02
RTNREG   EQU   @15
REG1     EQU   @01
RREC     EQU   @03
RCIADDR  EQU   @04
REG0     EQU   @00
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSACA0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSAQL0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLPWD   EQU   ALLAGL+20
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPO0 EQU   0
IDCIOGT0 EQU   0
IDCIOPT0 EQU   0
IDCIOCO0 EQU   0
IDCIOVY0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCKYL   EQU   IOCSTR+12
IOCDSO   EQU   IOCSTR+16
IOCDSOAM EQU   IOCDSO
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMACCC EQU   IOCMAC
IOCMAC2  EQU   IOCSTR+19
IOCMACRR EQU   IOCMAC2
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCHURBA EQU   IOCSTR+28
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCVRC   EQU   IOCTTR
IOCMEM   EQU   IOCSTR+44
IOCKYA   EQU   IOCMEM
IOCNWM   EQU   IOCSTR+48
IOCPTL   EQU   IOCNWM
IOCRRN   EQU   IOCSTR+52
IOCREL   EQU   IOCSTR+60
IOCEXT   EQU   IOCSTR+64
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNMODPD EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODRP EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
INDN     EQU   0
OUTDN    EQU   0
FMKYC    EQU   0
FMKYCLEN EQU   FMKYC
FMKYCVAL EQU   FMKYC+1
FMRBA    EQU   0
FMRBAVAL EQU   FMRBA
SKIP     EQU   0
SKIPVAL  EQU   SKIP
TOKYC    EQU   0
TOKYCLEN EQU   TOKYC
TOKYCVAL EQU   TOKYC+1
TORBA    EQU   0
TORBAVAL EQU   TORBA
COUNT    EQU   0
COUNTVAL EQU   COUNT
INPDD    EQU   0
INPDDPLN EQU   INPDD
INPDDPAS EQU   INPDD+1
INPDDVAL EQU   INPDD+10
OUTDD    EQU   0
OUTDDPLN EQU   OUTDD
OUTDDPAS EQU   OUTDD+1
OUTDDVAL EQU   OUTDD+10
OUTDS    EQU   0
OUTDSPLN EQU   OUTDS
OUTDSPAS EQU   OUTDS+1
OUTDSFLG EQU   OUTDS+10
OUTDSFUQ EQU   OUTDSFLG
OUTDSLEN EQU   OUTDS+20
OUTDSVAL EQU   OUTDS+21
FMNUM    EQU   0
FMNUMVAL EQU   FMNUM
TONUM    EQU   0
TONUMVAL EQU   TONUM
IENV     EQU   0
IDUMY    EQU   0
REP      EQU   0
RUS      EQU   0
INDS     EQU   0
INDSPLN  EQU   INDS
INDSPAS  EQU   INDS+1
INDSFLG  EQU   INDS+10
INDSFUQ  EQU   INDSFLG
INDSLEN  EQU   INDS+20
INDSVAL  EQU   INDS+21
IDENV    EQU   0
IDUM     EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLPT  EQU   CTGFLDAT+4
OPAGLST  EQU   0
RECDKEY  EQU   0
ACBADDR  EQU   0
DATRMASK EQU   0
@NM00050 EQU   DATRMASK
RECOVHIT EQU   @NM00050
ENTRYTYP EQU   0
ENTRYCI# EQU   0
IODATA   EQU   0
IODSID   EQU   IODATA+16
IOCSEX   EQU   0
IOCRPL   EQU   IOCSEX+4
IOCXAD   EQU   IOCSEX+16
IOCXPM   EQU   IOCSEX+20
IOCFLG   EQU   IOCSEX+32
IOCFLGEF EQU   IOCFLG
IOCDEV   EQU   IOCSEX+33
IOCINF   EQU   IOCSEX+34
IOCMOD   EQU   IOCSEX+35
IOCDLM   EQU   IOCSEX+36
IOCRCV   EQU   IOCSEX+44
CCREC    EQU   0
CCRCI    EQU   CCREC
CCRHACI  EQU   CCRCI+45
CCRNFCI  EQU   CCRCI+48
CCRNUM   EQU   CCRCI+51
CCRFDCI  EQU   CCRCI+54
RBAFIELD EQU   CCREC+57
CATLREC  EQU   0
RECKEY   EQU   CATLREC
RCDKEYTY EQU   RECKEY
RCDCINO  EQU   RECKEY+1
RCDID    EQU   CATLREC+44
NREPCV   EQU   CATLREC+47
NREPLF   EQU   CATLREC+48
ENTNAME  EQU   CATLREC+49
VOLDVCHR EQU   CATLREC+101
DEVCLASS EQU   VOLDVCHR+2
FREEREC  EQU   0
CLEARA   EQU   FREEREC+44
CLEARB   EQU   FREEREC+260
REC7     EQU   0
REC7INDX EQU   REC7+60
REC7OFFS EQU   REC7+61
VOLHURBA EQU   REC7+80
VOLHARBA EQU   REC7+84
REC7STRT EQU   0
REC7LNEX EQU   REC7STRT
REC7XTNT EQU   REC7STRT+2
REC7LRBA EQU   REC7XTNT+12
REC7HRBA EQU   REC7XTNT+16
CINUM    EQU   0
HKRR     EQU   0
HKCINO   EQU   HKRR+44
CFR      EQU   0
CFRNEXT  EQU   CFR
ASGO     EQU   1
ASTYPE   EQU   ASGO
ASCI     EQU   ASGO+1
DSDGO    EQU   1
DSDCI    EQU   DSDGO
CATGOPT  EQU   0
CATGOCI  EQU   CATGOPT
CATGODSP EQU   CATGOCI+1
CATGOGC1 EQU   CATGOPT+3
CATGOEXT EQU   CATGOGC1
CATGOGC  EQU   CATGOGC1
CATGOSEQ EQU   CATGOPT+4
CATSN    EQU   0
REPCNTRL EQU   0
@NM00072 EQU   REPCNTRL
EXTGOCI  EQU   @NM00072
REPCNT   EQU   REPCNTRL+5
REPGOPT  EQU   REPCNTRL+6
VARFIELD EQU   0
VARLEN   EQU   VARFIELD
CNTRLINF EQU   0
LENFIX   EQU   CNTRLINF+1
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOIT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIO050 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IDS      EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NREP     EQU   0
NRUS     EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTIOH   EQU   GDTTBL+36
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
DELMFLG  EQU   0
DELMCNT  EQU   0
DELMINCR EQU   0
@NM00042 EQU   CTGDDNM
CTGPROB  EQU   @NM00042
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00073 EQU   CNTRLINF
@NM00071 EQU   CATGOGC1
@NM00070 EQU   CATGOCI
HKNAME   EQU   HKRR
@NM00069 EQU   REC7XTNT
@NM00068 EQU   REC7+62
@NM00067 EQU   REC7
@NM00066 EQU   FREEREC+505
@NM00065 EQU   FREEREC
DEVFLAGS EQU   VOLDVCHR
X        EQU   CATLREC+93
@NM00064 EQU   CATLREC+45
@NM00062 EQU   CCRCI
@NM00061 EQU   IOCRCV
IOCRCVRA EQU   IOCRCV
IOCRCVXM EQU   IOCRCV
IOCVLN   EQU   IOCSEX+42
IOCDNM   EQU   IOCSEX+40
IOCDDN   EQU   IOCDLM
IOCMODEX EQU   IOCMOD
IOCMODRP EQU   IOCMOD
IOCMODXM EQU   IOCMOD
IOCMODUB EQU   IOCMOD
IOCMODRG EQU   IOCMOD
IOCMODDY EQU   IOCMOD
IOCMODRR EQU   IOCMOD
IOCMODPD EQU   IOCMOD
IOCINFR1 EQU   IOCINF
IOCINFCT EQU   IOCINF
IOCINFDO EQU   IOCINF
IOCINFAC EQU   IOCINF
IOCINFQX EQU   IOCINF
IOCINFND EQU   IOCINF
IOCINFAE EQU   IOCINF
IOCINFPT EQU   IOCINF
@NM00060 EQU   IOCDEV
IOCDEVUR EQU   IOCDEV
IOCDEVMT EQU   IOCDEV
IOCDEVDA EQU   IOCDEV
@NM00059 EQU   IOCFLG
IOCFLGSP EQU   IOCFLG
IOCFLGOE EQU   IOCFLG
IOCFLGOP EQU   IOCFLG
IOCFLGIO EQU   IOCFLG
IOCFLGDF EQU   IOCFLG
IOCFLGEX EQU   IOCFLG
IOCSID   EQU   IOCSEX+28
IOCNIO   EQU   IOCSEX+24
@NM00058 EQU   IOCXPM+2
IOCEXL   EQU   IOCXPM
IOCEXA   EQU   IOCXAD
IOCWKA   EQU   IOCSEX+12
IOCLRP   EQU   IOCSEX+10
IOCCBL   EQU   IOCSEX+8
IOCDEC   EQU   IOCRPL
IOCCBA   EQU   IOCSEX
@NM00057 EQU   IODATA+64
IODAEI   EQU   IODATA+60
@NM00056 EQU   IODATA+56
IODIOX   EQU   IODATA+52
IODOCS   EQU   IODATA+48
IODICS   EQU   IODATA+44
IODOSO   EQU   IODATA+40
IODOSS   EQU   IODATA+36
IODEOD   EQU   IODATA+32
@NM00055 EQU   IODATA+30
@NM00054 EQU   IODATA+28
IODOEV   EQU   IODATA+24
IODIEV   EQU   IODATA+20
IODINC   EQU   IODSID+2
IODMID   EQU   IODSID
IODXTN   EQU   IODATA+12
IODADD   EQU   IODATA+8
IODMSG   EQU   IODATA+4
IODIOC   EQU   IODATA
@NM00053 EQU   DATRMASK+1
@NM00052 EQU   @NM00050
@NM00051 EQU   @NM00050
CTGFLNG  EQU   CTGFLDAT
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00043 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
@NM00041 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00040 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00039 EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
@NM00038 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00037 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
INDSMEM  EQU   INDS+12
INDSMLN  EQU   INDS+11
INDSPOS  EQU   INDS+9
OUTDSMEM EQU   OUTDS+12
OUTDSMLN EQU   OUTDS+11
OUTDSPOS EQU   OUTDS+9
OUTDDLEN EQU   OUTDD+9
INPDDLEN EQU   INPDD+9
@NM00036 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00035 EQU   DMPITM+15
@NM00034 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00033 EQU   ERCNVTAB+4
@NM00032 EQU   ERCNVTAB+3
@NM00031 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00030 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00029 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00028 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00027 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00026 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00025 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00024 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00023 EQU   OPNAGL+43
@NM00022 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNMODUB EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
IOCWORK  EQU   IOCSTR+56
IOCPNM   EQU   IOCNWM+2
IOCCBP   EQU   IOCSTR+36
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00281 EQU   @RC00278
@RF00318 EQU   @RC00315
@RF00536 EQU   @RC00534
@RF00541 EQU   @RC00539
@RF00578 EQU   @RC00569
@RF00740 EQU   @EL00002
@RC00726 EQU   @EL00002
@RF00820 EQU   @RC00808
@RF00908 EQU   @RC00869
@RF01008 EQU   @RC00994
@RF01021 EQU   @RC00994
@RF01127 EQU   @EL00004
@RF01148 EQU   @EL00005
@RF01169 EQU   @EL00006
@RT01175 EQU   @EL00006
@RT01207 EQU   @EL00007
@RT01229 EQU   @EL00008
@RT01244 EQU   @EL00008
@RC01252 EQU   @EL00009
@RF01364 EQU   @EL00010
@RF01407 EQU   @EL00011
@RF01457 EQU   @EL00012
@RF01463 EQU   @EL00012
@RF01473 EQU   @EL00013
@PB00013 EQU   @EL00001
@RF00734 EQU   @RC00726
@PB00003 EQU   @PB00013
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCRP01,(C'PLS2233',0701,77258)

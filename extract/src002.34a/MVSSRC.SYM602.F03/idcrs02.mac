         TITLE '************** IDCRS02: IDCAMS RESETCAT ROUTINE ********
               *********'
IDCRS02  CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IDCRS02   77.115'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@09                                   0001
         USING @DATD,@08  DATA BASE REGISTER
         L     @15,@SIZDATD  SIZE OF AUTOMATIC DATA
         LA    @15,0(0,@15)  CLEAR SUBPOOL
         STM   @09,@12,RS02RG09(REG6)  SAVE BASE REGISTERS
*        RETURN CODE(REG15);  /*REG 15 HAS LENGTH OF AUTO DATA*/   0297
         L     @14,12(,@13)                                        0297
         LM    @00,@12,20(@13)                                     0297
         BR    @14                                                 0297
*/********************************************************************/
*/*                                                                  */
*/*            RESETCAT LOCAL DECLARATIONS                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0298
*DCL MODID CHAR(4) CONSTANT('RS02');   /*MODID FOR UEPIL             */
*                                                                  0298
*DCL                                                               0299
*   1 PATCH    CHAR(800)               /*PATCH AREA                  */
*              LOCAL STATIC BDY(WORD), /* 5 PERCENT                  */
*     2 *      CHAR(36)                /*PATCHAREA                   */
*              INIT('PATCHAREA 800 BYTES LAST USED 000000'), /*ID    */
*     2 *(764) CHAR(1)                 /*FORMAT UNUSED AREA          */
*              INIT((764)'00'X);       /*WITH ZEROS                  */
*  DECLARE                                                         0300
*      AIXNR    CHAR(1) CONSTANT('2'), /*AIX NONRESET ASSOC TBL ID   */
*      CLNR     CHAR(1) CONSTANT('1'), /*CLUSTER NONRESET ASSOC ID   */
*      NV       CHAR(1) CONSTANT('3'); /*GDG DATA SET ASSOC TBL ID   */
*  DECLARE                                                         0301
*      EXTRAB   FIXED(15) CONSTANT(4); /* EXTENSION RAB              */
*      /**************************************************************/
*      /*                                                            */
*      /* THE FOLLOWING TABLES ARE USED BY ASSOC AND ITS             */
*      /* SUBPROCESSORS TO PROCESS A SET OF RECORDS. ONE TABLE       */
*      /* FOR EACH SET OF RECORDS TO BE PROCESSED. EACH TABLE        */
*      /* CONTAINS ALL VALID RECORD TYPES FOR THIS SET OF RECORDS    */
*      /* PLUS WHETHER THAT TYPE SHOULD BE READ AND SCANNED          */
*      /* AND VERIFIED. IT ALSO CONTAINS THE RAB TO BE USED          */
*      /* IN DOING THE READ.                                         */
*      /*                                                            */
*      /* NOTE * THERE IS A DEPENDENCY THAT THE RAB SPECIFIED FOR    */
*      /*     THE FIRST SUBTYPE WITHIN THE SET OF RECORDS (I.E., THE */
*      /*     BASE RECORD) BE UNIQUE FOR THAT SET OF RECORDS.        */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0302
*  DECLARE                                                         0302
*    1 ASSOCC  BDY(WORD) STATIC LOCAL, /*CLUSTER TABLE               */
*      2 *        CHAR(1)   INIT('C'), /*  ID = C                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(7),   /*  7 ENTRIES                 */
*      2 ASSOCC1  CHAR(4),             /*CLUSTER                     */
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSOCC2  CHAR(4),             /*DATA                        */
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */
*      2 ASSOCC3  CHAR(4),             /*INDEX                       */
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */
*      2 ASSOCC4  CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOCC5  CHAR(4),             /*PATH                        */
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOCC6  CHAR(4),             /*ALTERNATEINDEX              */
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOCC7  CHAR(4),             /*UPGRADE                     */
*        3 *        CHAR(1) INIT('Y'), /*  RECORD TYPE = Y           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15);         /*  UNUSED                    */
*                                                                  0302
*  DECLARE                                                         0303
*    1 ASSOG   BDY(WORD) STATIC LOCAL, /*ALTERNATEINDEX TABLE        */
*      2 *        CHAR(1)   INIT('G'), /*  ID = G                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(6),   /*  6 ENTRIES                 */
*      2 ASSOG1   CHAR(4),             /*ALTERNATEINDEX              */
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSOG2   CHAR(4),             /*DATA                        */
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */
*      2 ASSOG3   CHAR(4),             /*INDEX                       */
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */
*      2 ASSOG4   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOG5   CHAR(4),             /*PATH                        */
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOG6   CHAR(4),             /*CLUSTER                     */
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */
*        3 *        FIXED(15);         /*  UNUSED                    */
*  DECLARE                                                         0304
*    1 ASSOR   BDY(WORD) STATIC LOCAL, /*PATH TABLE                  */
*      2 *        CHAR(1)   INIT('R'), /*  ID = R                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(6),   /*  6 ENTRIES                 */
*      2 ASSOR1   CHAR(4),             /*PATH                        */
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */
*      2 ASSOR2   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOR3   CHAR(4),             /*CLUSTER                     */
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOR4   CHAR(4),             /*DATA                        */
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOR5   CHAR(4),             /*INDEX                       */
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOR6   CHAR(4),             /*ALTERNATEINDEX              */
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */
*        3 *        FIXED(15);         /*  UNUSED                    */
*  DECLARE                                                         0305
*    1 ASSOY   BDY(WORD) STATIC LOCAL, /*UPGRADE TABLE               */
*      2 *        CHAR(1)   INIT('Y'), /*  ID = Y                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(4),   /*  4 ENTRIES                 */
*      2 ASSOY1   CHAR(4),             /*UPGRADE                     */
*        3 *        CHAR(1) INIT('Y'), /*  RECORD TYPE = Y           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOY2   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOY3   CHAR(4),             /*DATA                        */
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSOY4   CHAR(4),             /*INDEX                       */
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15);         /*  UNUSED                    */
*  DECLARE                                                         0306
*    1 ASSOA   BDY(WORD) STATIC LOCAL, /*NON-VSAM TABLE              */
*      2 *        CHAR(1)   INIT('A'), /*  ID = A                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(4),   /*  4 ENTRIES                 */
*      2 ASSOA1   CHAR(4),             /*NON-VSAM                    */
*        3 *        CHAR(1) INIT('A'), /*  RECORD TYPE = A           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSOA2   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOA3   CHAR(4),             /*ALIAS                       */
*        3 *        CHAR(1) INIT('X'), /*  RECORD TYPE = X           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */
*      2 ASSOA4   CHAR(4),             /*GDG BASE                    */
*        3 *        CHAR(1) INIT('B'), /*  RECORD TYPE = B           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE - DELETE IF FOUND  */
*        3 *        FIXED(15);         /*  UNUSED                    */
*  DECLARE                                                         0307
*    1 ASSOB   BDY(WORD) STATIC LOCAL, /*GDG BASE TABLE              */
*      2 *        CHAR(1)   INIT('B'), /*  ID = B                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(3),   /*  3 ENTRIES                 */
*      2 ASSOB1   CHAR(4),             /*GDG BASE                    */
*        3 *        CHAR(1) INIT('B'), /*  RECORD TYPE = B           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSOB2   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOB3   CHAR(4),             /*NON-VSAM                    */
*        3 *        CHAR(1) INIT('A'), /*  RECORD TYPE = A           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15);         /*  UNUSED                    */
*  DECLARE                                                         0308
*    1 ASSO3A  BDY(WORD) STATIC LOCAL EXTERNAL,                    0308
*                                      /*GDG DATA SET ENTRY TABLE    */
*      2 *        CHAR(1)   INIT('3'), /*  ID = 3                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(4),   /*  4 ENTRIES                 */
*      2 ASSO3A1  CHAR(4),             /*NON-VSAM                    */
*        3 *        CHAR(1) INIT('A'), /*  RECORD TYPE = A           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */
*      2 ASSO3A2  CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSO3A3  CHAR(4),             /*ALIAS                       */
*        3 *        CHAR(1) INIT('X'), /*  RECORD TYPE = X           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */
*      2 ASSO3A4  CHAR(4),             /*GDG BASE                    */
*        3 *        CHAR(1) INIT('B'), /*  RECORD TYPE = B           */
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */
*        3 *        FIXED(15);         /*  UNUSED                    */
*  DECLARE                                                         0309
*    1 ASSOU   BDY(WORD) STATIC LOCAL, /*USERCATALOG TABLE           */
*      2 *        CHAR(1)   INIT('A'), /*  ID = U                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(3),   /*  3 ENTRIES                 */
*      2 ASSOU1   CHAR(4),             /*USERCATALOG                 */
*        3 *        CHAR(1) INIT('U'), /*  RECORD TYPE = U           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSOU2   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSOU3   CHAR(4),             /*ALIAS                       */
*        3 *        CHAR(1) INIT('X'), /*  RECORD TYPE = X           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(3); /*  RAB3                      */
*  DECLARE                                                         0310
*    1 ASSOV   BDY(WORD) STATIC LOCAL, /*VOLUME TABLE                */
*      2 *        CHAR(1)   INIT('V'), /*  ID = V                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(2),   /*  2 ENTRIES                 */
*      2 ASSOV1   CHAR(4),             /*VOLUME                      */
*        3 *        CHAR(1) INIT('V'), /*  RECORD TYPE = V           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSOV2   CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('W'), /*  RECORD TYPE = W           */
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */
*        3 *        FIXED(15) INIT(4); /*  RAB4                      */
*  DECLARE                                                         0311
*    1 ASSO1C BDY(WORD) STATIC LOCAL,  /*CLUSTER TABLE - NON-RESET   */
*      2 *        CHAR(1)   INIT('1'), /*  ID = 1                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(7),   /*  7 ENTRIES                 */
*      2 ASSO1C1 CHAR(4),              /*CLUSTER                     */
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSO1C2 CHAR(4),              /*DATA                        */
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */
*      2 ASSO1C3 CHAR(4),              /*INDEX                       */
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */
*      2 ASSO1C4 CHAR(4),              /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSO1C5 CHAR(4),              /*PATH                        */
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSO1C6 CHAR(4),              /*ALTERNATEINDEX              */
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSO1C7 CHAR(4),              /*UPGRADE                     */
*        3 *        CHAR(1) INIT('Y'), /*  RECORD TYPE = Y           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15);         /*  UNUSED                    */
*                                                                  0311
*  DECLARE                                                         0312
*    1 ASSO2G  BDY(WORD) STATIC LOCAL, /*ALTERNATEINDEX TBL - NRESET */
*      2 *        CHAR(1)   INIT('2'), /*  ID = 2                    */
*      2 *        CHAR(1),             /*  UNUSED                    */
*      2 *        FIXED(15) INIT(6),   /*  6 ENTRIES                 */
*      2 ASSO2G1  CHAR(4),             /*ALTERNATEINDEX              */
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */
*      2 ASSO2G2  CHAR(4),             /*DATA                        */
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */
*      2 ASSO2G3  CHAR(4),             /*INDEX                       */
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */
*      2 ASSO2G4  CHAR(4),             /*EXTENSION                   */
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */
*      2 ASSO2G5  CHAR(4),             /*PATH                        */
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */
*        3 *        FIXED(15),         /*  UNUSED                    */
*      2 ASSO2G6  CHAR(4),             /*CLUSTER                     */
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */
*        3 *        CHAR(1) INIT('00'X), /*IGNORE IT                 */
*        3 *        FIXED(15);         /*  UNUSED                    */
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - ASSOC                                           */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    THIS SEGMENT CONTROLS THE CHECKING OF ALL CONTROL INTERVAL    */
*/*    NUMBERS (CINS) IN ALL RECORDS BEING RESET. IT FURTHER         */
*/*    ENSURES THAT A COMPLETE SET OF RECORDS IS RESET. FINALLY,     */
*/*    THE VOLUMES BEING RESET ARE CHECKED TO ENSURE THAT THERE      */
*/*    ARE NO CONFLICTING SPACE REQUESTS.                            */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    PRIMARY INPUT CONSISTS OF THE WORKFILE RECORDS.               */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    ALL CINS IN THE LKR RECORDS HAVE BEEN UPDATE IF               */
*/*    REASSIGNMENT TOOK PLACE.                                      */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0313
         DS    0F
NAME0002 DC    CL8'ASSOC'
*ASSOC: PROCEDURE                                                  0314
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0314
*                                                                  0314
         B     @PB00002                                            0314
ASSOC    DS    0H                                                  0315
*      GENERATE REFS(RS02RG08, REG6);                              0315
*                                                                  0315
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY ASSOC  ENTRY POINT
         LM    @08,@12,RS02RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0002  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      0316
         L     @07,GDTTR2(,REG5)                                   0316
         MVC   @TS00001(95),NEWERID2(@07)                          0316
         MVC   OLDERID2(95,@07),@TS00001                           0316
*        NEWID2 = 'RSAS';                                          0317
*                                                                  0317
         MVC   NEWID2(4,@07),@CC03741                              0317
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZATION - CLEAR WORKFILE GRAB                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0318
*        RSGRABCU = ADDR(GRABSWF);                                 0318
         L     @07,RSIOTBL(,REG6)                                  0318
         ST    @07,RSGRABCU(,REG6)                                 0318
*        GRABAFLS = ''B;                                           0319
*                                                                  0319
         XC    GRABAFLS(2,@07),GRABAFLS(@07)                       0319
*        DO;                                                       0320
*          RSRECREQ = ''B;                                         0321
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0321
*          RSRTERM = ON;     /* TERMRCD */                         0322
         OI    RSRTERM(REG6),B'00000010'                           0322
*          RSRWF = ON;       /* WORKFILE */                        0323
*                                                                  0323
         OI    RSRWF(REG6),B'10000000'                             0323
*        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT             */
*        CALL RECMGMT;                                             0324
         L     @15,@CV03458                                        0324
         BALR  @14,@15                                             0324
*          RFY RTNREG RSTD;                                        0325
*          TESTRC = RTNREG;                                        0326
         STH   RTNREG,TESTRC(,REG6)                                0326
*          RFY RTNREG UNRSTD;                                      0327
*        END;                                                      0328
*                                                                  0328
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZATION - SET UP THE LENGTH AND SIZE OF           */
*        /* THE CITAB, DITAB, AND PTWORK                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0329
*        RSPTWKLN = LENGTH(PTWORK);                                0329
         MVC   RSPTWKLN(4,REG6),@CF03934                           0329
*        RSPTWKUG = POOL10;                                        0330
*                                                                  0330
         MVC   RSPTWKUG(4,REG6),@CC00903                           0330
*        RSGCITLN = LENGTH(GCITS);                                 0331
         LA    @07,4080                                            0331
         ST    @07,RSGCITLN(,REG6)                                 0331
*        RSGCITEN = LENGTH(CITABE);                                0332
         MVC   RSGCITEN(2,REG6),@CH00931                           0332
*        RSGCITUG = POOL10;                                        0333
*                                                                  0333
         MVC   RSGCITUG(4,REG6),@CC00903                           0333
*        RSGDITLN = LENGTH(GDITS);                                 0334
         ST    @07,RSGDITLN(,REG6)                                 0334
*        RSGDITEN = LENGTH(DITABE);                                0335
         MVC   RSGDITEN(2,REG6),@CH00471                           0335
*        RSGDITUG = POOL10;                                        0336
*                                                                  0336
         MVC   RSGDITUG(4,REG6),@CC00903                           0336
*        /************************************************************/
*        /*                                                          */
*        /* FOR EACH RESET CRA VOLUME, LOCATE THE VOLUME RECORD      */
*        /* AND THEN FO TO PROCTYPE TO ENSURE THAT THE BASE V        */
*        /* RECORD IS O.K. THIS SCAN WILL VERIFY THE V AND ITS       */
*        /* EXTENSIONS; IT WILL NOT VERIFY THE DATA SET              */
*        /* DIRECTORIES (DSDIRS).                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0337
*        RSASSTBL = ADDR(ASSOV);       /*USE VOLUME ASSOC TABLE      */
         LA    @07,ASSOV                                           0337
         ST    @07,RSASSTBL(,REG6)                                 0337
*        RSSRNSCN = OFF;               /*SET TO START SCAN OF RESVOL */
         NI    RSSRNSCN(REG6),B'10111111'                          0338
*        RFY RESVOL BASED(RSENTPT);                                0339
*        RFY VOLSERTB BASED(RSVTBENT);                             0340
*                                                                  0340
* VOLSRCHK:                                                        0341
*        DO UNTIL(RSENTPT = 0);        /*CHECK EACH RESET VOLUME     */
*                                                                  0341
VOLSRCHK DS    0H                                                  0341
@DL00341 DS    0H                                                  0342
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST           */
*          CALL IDCRS5SR('N','A',RSENTPT,NULLPTR);                 0342
         MVC   @AL00001(16),@AL00342                               0342
         LA    @07,RSENTPT(,REG6)                                  0342
         ST    @07,@AL00001+8                                      0342
         L     @15,@CV03445                                        0342
         LA    @01,@AL00001                                        0342
         BALR  @14,@15                                             0342
*                                      /* GET NEXT RESET VOLSER      */
*                                                                  0343
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS ALL RESET VOLUMES.                           */
*        /*       ALLOW FOR NO VOLUME RECORD. THIS OCCURS WHEN A CRA */
*        /*       IS BEING RESET AND NO VOLUME RECORD WAS FOUND IN   */
*        /*       THE CRA.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0343
*          IF RSENTPT ^= 0 & RESVLBAD = OFF THEN                   0343
         L     @07,RSENTPT(,REG6)                                  0343
         LTR   @07,@07                                             0343
         BZ    @RF00343                                            0343
         TM    RESVLBAD(@07),B'00010000'                           0343
         BNZ   @RF00343                                            0343
*            DO;                                                   0344
*              RSCRVL = ADDR(RESVLSER);                            0345
         LA    @07,RESVLSER(,@07)                                  0345
         ST    @07,RSCRVL(,REG6)                                   0345
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNVLST       */
*              CALL IDCRS5SV(RSVTBENT,RSCRVL);                     0346
         LA    @07,RSVTBENT(,REG6)                                 0346
         ST    @07,@AL00001                                        0346
         LA    @07,RSCRVL(,REG6)                                   0346
         ST    @07,@AL00001+4                                      0346
         L     @15,@CV03444                                        0346
         LA    @01,@AL00001                                        0346
         BALR  @14,@15                                             0346
*                                      /*LOCATE THE VOLUME RECORD    */
*                                                                  0347
*        /************************************************************/
*        /*                                                          */
*        /*     GET THE VOLUME RECORD                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0347
*              GRABCURR = GRABRAB1;    /* USE RAB 1                  */
*                                                                  0347
         L     @07,RSGRABCU(,REG6)                                 0347
         L     @04,GRABRAB1(,@07)                                  0347
         ST    @04,GRABCURR(,@07)                                  0347
*              DO;                                                 0348
*                RSRTYPE = ''B;                                    0349
         MVI   RSRTYPE(REG6),X'00'                                 0349
*                RSRGET = ON;      /* GETRCD  */                   0350
         OI    RSRGET(REG6),B'10000000'                            0350
*                RSRUPD = ON;      /* UPDATE  */                   0351
         OI    RSRUPD(REG6),B'00001000'                            0351
*                RSRDS = ''B;                                      0352
         NI    RSRDS(REG6),B'00011111'                             0352
*                RSRWF = ON;       /* WORKFILE  */                 0353
*                RSRDIR = ON;      /* DIRECT  */                   0354
*                RSRKEY = ON;      /* KEY  */                      0355
         OI    RSRWF(REG6),B'10010100'                             0355
*                RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/           0356
         OI    RSVIAFCR(REG6),B'10000000'                          0356
*                RSVIACRA = VOLSRSER; /*SET VOLSER */              0357
         L     @07,RSVTBENT(,REG6)                                 0357
         MVC   RSVIACRA(6,REG6),VOLSRSER(@07)                      0357
*                RSVIACIN = VOLSRCI; /*SET CI NUMBER */            0358
*                                                                  0358
         MVC   RSVIACIN(3,REG6),VOLSRCI+1(@07)                     0358
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA        */
*              CALL GETVIA;                                        0359
         L     @15,@CV03442                                        0359
         BALR  @14,@15                                             0359
*              END;                                                0360
*                                                                  0360
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS THE VOLUME RECORD TO ENSURE                  */
*        /*     THAT A TIGHT CONNECTION EXISTS BETWEEN               */
*        /*     THE VOLUME RECORD AND ITS EXTENSIONS.                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0361
*              CALL PROCTYPE;                                      0361
*                                                                  0361
         BAL   @14,PROCTYPE                                        0361
*        /************************************************************/
*        /*                                                          */
*        /*     FREE ALL RPLS NOT FREED                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0362
*                                                                  0362
*              DO;                                                 0362
*                RSRECREQ = ''B;                                   0363
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0363
*                RSRTERM = ON;     /* TERMRCD */                   0364
         OI    RSRTERM(REG6),B'00000010'                           0364
*                RSRWF = ON;       /* WORKFILE */                  0365
*                                                                  0365
         OI    RSRWF(REG6),B'10000000'                             0365
*              /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT       */
*              CALL RECMGMT;                                       0366
         L     @15,@CV03458                                        0366
         BALR  @14,@15                                             0366
*                RFY RTNREG RSTD;                                  0367
*                TESTRC = RTNREG;                                  0368
         STH   RTNREG,TESTRC(,REG6)                                0368
*                RFY RTNREG UNRSTD;                                0369
*              END;                                                0370
*            END;                      /*END OF THIS VOLUME          */
*        END VOLSRCHK;                 /* END OF VOLUME CHECK        */
@RF00343 DS    0H                                                  0372
@DE00341 L     @07,RSENTPT(,REG6)                                  0372
         LTR   @07,@07                                             0372
         BNZ   @DL00341                                            0372
*        RFY RESVOL;                   /*REVERT                      */
*        RFY VOLSERTB;                 /*REVERT                      */
*        /************************************************************/
*        /*                                                          */
*        /* ASSOCIATION CHECK -                                      */
*        /*     CHECK ALL RESET RECORDS FOR VALID ASSOCIATIONS,      */
*        /*     UPDATE REASSIGNED CINS, AND VERIFY SPACE             */
*        /*     REQUESTS AGAINST RESET CRAS FROM NON-RESET           */
*        /*     RECORDS.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0375
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS CURRENT CATALOG EXTENTS IN THE WORKFILE.     */
*        /*     THE END OF THE CATALOG EXTENTS TO BE CHECKED         */
*        /*     IS UP TO THE FIRST UNFORMATTED FREE CIN.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0375
* ASSOCCHK:                                                        0375
*        DO RSASSEXT = 1 TO DIM(RSXCIENT)                          0375
*          WHILE(RSXCIBEG(RSASSEXT) < RSCAFUCI);                   0375
*                                                                  0375
ASSOCCHK LA    @07,1                                               0375
         STH   @07,RSASSEXT(,REG6)                                 0375
@DL00375 LH    @07,RSASSEXT(,REG6)                                 0375
         SLA   @07,4                                               0375
         L     @04,RSCIXLTA(,REG6)                                 0375
         LA    @01,0(@07,@04)                                      0375
         AL    @01,@CF03953                                        0375
         L     @15,RSXCIBEG-8(,@01)                                0375
         C     @15,RSCAFUCI(,REG6)                                 0375
         BNL   @DC00375                                            0375
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS EACH LOW KEY RANGE(LKR) RECORD UNTIL THE     */
*        /*     FIRST UNFORMATTED FREE CIN IS HIT.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0376
*          RSASSEND = RSXCIBEG(RSASSEXT) + RSXCILN(RSASSEXT) - 1;  0376
         LR    @14,@15                                             0376
         LA    @01,0(@07,@04)                                      0376
         AL    @01,@CF03954                                        0376
         AL    @14,RSXCILN-12(,@01)                                0376
         BCTR  @14,0                                               0376
         ST    @14,RSASSEND(,REG6)                                 0376
*                                      /*HIGH CIN IN THIS EXTENT     */
*          IF RSXCIRNG(RSASSEXT) = OFF THEN /*IF LKR                 */
         ALR   @04,@07                                             0377
         TM    RSXCIRNG-16(@04),B'10000000'                        0377
         BNZ   @RF00377                                            0377
*            DO RSASSCIN = RSXCIBEG(RSASSEXT) TO RSASSEND          0378
*              WHILE(RSASSCIN < RSCAFUCI); /*PROCESS THIS EXTENT     */
*                                                                  0378
         B     @DE00378                                            0378
@DL00378 CLC   RSASSCIN(4,REG6),RSCAFUCI(REG6)                     0378
         BNL   @DC00378                                            0378
*        /************************************************************/
*        /*                                                          */
*        /*     THERE ARE TWO PASSES FOR NON-VSAM. THE FIRST         */
*        /*     PASS WILL HANDLE THE GDG BASE RECORD IF ONE          */
*        /*     EXISTS AND THE SECOND PASS WILL RE-PROCESS           */
*        /*     THE NON-VSAM ENTRY AS A NON-VSAM ENTRY.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0379
*              RSASSEPA = ON;          /*ALLOW AT LEAST 1 PASS       */
         OI    RSASSEPA(REG6),B'10000000'                          0379
*              DO RSASSPAS = 1 TO 2 WHILE(RSASSEPA=ON);            0380
         LA    @07,1                                               0380
         STH   @07,RSASSPAS(,REG6)                                 0380
@DL00380 TM    RSASSEPA(REG6),B'10000000'                          0380
         BNO   @DC00380                                            0380
*                RSASSEPA = OFF;       /*ONE PASS UNLESS REQUESTED   */
*                                                                  0381
         NI    RSASSEPA(REG6),B'01111111'                          0381
*        /************************************************************/
*        /*                                                          */
*        /*     GET THE NEXT RECORD IN THIS EXTENT.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0382
*                RSGRABCU = ADDR(GRABSWF); /*READ FROM WORK FILE     */
         L     @07,RSIOTBL(,REG6)                                  0382
         ST    @07,RSGRABCU(,REG6)                                 0382
*                GRABCURR = GRABRAB1;  /*USE FIRST BUFFER            */
         L     @04,GRABRAB1(,@07)                                  0383
         ST    @04,GRABCURR(,@07)                                  0383
*                RABRCDA = RSASSCIN;   /*SEQUENTIAL SCAN             */
*                                                                  0384
         L     @07,RSASSCIN(,REG6)                                 0384
         ST    @07,RABRCDA(,@04)                                   0384
*                DO;                                               0385
*                  RSRTYPE = ''B;                                  0386
         MVI   RSRTYPE(REG6),X'00'                                 0386
*                  RSRGET = ON;      /* GETRCD  */                 0387
         OI    RSRGET(REG6),B'10000000'                            0387
*                  RSRUPD = ON;      /* UPDATE  */                 0388
         OI    RSRUPD(REG6),B'00001000'                            0388
*                  RSRDS = ''B;                                    0389
         NI    RSRDS(REG6),B'00011111'                             0389
*                  RSRWF = ON;       /* WORKFILE  */               0390
*                  RSRDIR = ON;      /* DIRECT  */                 0391
*                  RSRKEY = ON;      /* KEY  */                    0392
*                                                                  0392
         OI    RSRWF(REG6),B'10010100'                             0392
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */
*                CALL RECMGMT;                                     0393
         L     @15,@CV03458                                        0393
         BALR  @14,@15                                             0393
*                  RFY RTNREG RSTD;                                0394
*                  TESTRC = RTNREG;                                0395
         STH   RTNREG,TESTRC(,REG6)                                0395
*                  RFY RTNREG UNRSTD;                              0396
*                END;                                              0397
*                                                                  0397
*        /************************************************************/
*        /*                                                          */
*        /*     IF NOT ALREADY ASSOCIATION CHECKED AND THE           */
*        /*     RECORD CAME FROM A CRA BEING RESET, THEN CHECK       */
*        /*     IT OUT.                                              */
*        /*     IGNORE INVALID CINS - THEY/VE BEEN REASSIGNED TO     */
*        /*     NEW CIN VALUES AND WILL EVENTUALLY BE FOUND.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0398
*                RSASSTBL = 0;         /*NO ASSOCIATION TO PERFORM   */
         SLR   @07,@07                                             0398
         ST    @07,RSASSTBL(,REG6)                                 0398
*                IF RSWASSCK=OFF & RSWFCRA=ON & RSWINVCI=OFF THEN  0399
         L     @07,RSGRABCU(,REG6)                                 0399
         L     @07,GRABCURR(,@07)                                  0399
         TM    RSWFCRA(@07),B'10000000'                            0399
         BNO   @RF00399                                            0399
         TM    RSWASSCK(@07),B'00000010'                           0399
         BNZ   @RF00399                                            0399
         TM    RSWINVCI(@07),B'10000000'                           0399
         BNZ   @RF00399                                            0399
*                  DO;                                             0400
*                                                                  0400
*        /************************************************************/
*        /*                                                          */
*        /*     ASSOCIATION CHECK A SET OF RECORDS. ORIENT ON THE    */
*        /*     CLUSTER(C), GDG BASE(B), USERCATALOG(U), AND         */
*        /*     NON-VSAM(A). FROM THESE BASES ALL SUBSETS WILL BE    */
*        /*     CHECKED.  NOTE THAT THE VOLUME RECORD (V-W) WAS      */
*        /*     ALREADY PROCESSED.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0401
*                    IF RCDID=CLID THEN                            0401
         CLI   RCDID+8(@07),C'C'                                   0401
         BNE   @RF00401                                            0401
*                      RSASSTBL=ADDR(ASSOCC); /*CLUSTER TABLE        */
         LA    @07,ASSOCC                                          0402
         ST    @07,RSASSTBL(,REG6)                                 0402
*                    IF RCDID=GDGID THEN                           0403
@RF00401 L     @07,RSGRABCU(,REG6)                                 0403
         L     @07,GRABCURR(,@07)                                  0403
         CLI   RCDID+8(@07),C'B'                                   0403
         BNE   @RF00403                                            0403
*                      RSASSTBL=ADDR(ASSOB); /*GDG BASE TABLE        */
         LA    @07,ASSOB                                           0404
         ST    @07,RSASSTBL(,REG6)                                 0404
*                    IF RCDID=UCATID THEN                          0405
@RF00403 L     @07,RSGRABCU(,REG6)                                 0405
         L     @07,GRABCURR(,@07)                                  0405
         CLI   RCDID+8(@07),C'U'                                   0405
         BNE   @RF00405                                            0405
*                      RSASSTBL=ADDR(ASSOU); /*USERCATALOG TABLE     */
         LA    @07,ASSOU                                           0406
         ST    @07,RSASSTBL(,REG6)                                 0406
*                    IF RCDID=NVID THEN                            0407
@RF00405 L     @07,RSGRABCU(,REG6)                                 0407
         L     @04,GRABCURR(,@07)                                  0407
         CLI   RCDID+8(@04),C'A'                                   0407
         BNE   @RF00407                                            0407
*                                      /*CHECK FOR NON-VSAM ENTRY    */
*                      IF RSASSPAS = 1 THEN /*IF FIRST PASS          */
         CLC   RSASSPAS(2,REG6),@CH00212                           0408
         BNE   @RF00408                                            0408
*                        DO;                                       0409
*                                                                  0409
*        /************************************************************/
*        /*                                                          */
*        /*     ON THE FIRST PASS CHECK TO SEE IF THE NON-VSAM       */
*        /*     ENTRY IS A GDG DATA SET. IF IT IS, PROCESS THE       */
*        /*     GDG BASE ENTRY FIRST. ON THE SECOND PASS,           */
*        /*     PROCESS THE NON-VSAM ENTRY, IF THE BASE FAILED       */
*        /*     ASSOCIATION CHECKING OR THE NON-VSAM ENTRY IS        */
*        /*     NOT A GDG.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0410
*                          RSASSEPA = ON; /*SECOND PASS REQUIRED     */
*                                                                  0410
         OI    RSASSEPA(REG6),B'10000000'                          0410
*        /************************************************************/
*        /*                                                          */
*        /*     GET ALL OF THE ASSOCIATIONS FOR THIS NON-VSAM ENTRY  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0411
*                                                                  0411
*                           DO;                                    0411
*                             GRABBB = GRABCURR;                   0412
         ST    @04,GRABBB(,@07)                                    0412
*                             RSWGCODE = ASGC;                     0413
         MVI   RSWGCODE(REG6),X'02'                                0413
*                                      /*SPECIFY GROUP CODE          */
*                             RSWFONE = OFF;                       0414
         NI    RSWFONE(REG6),B'01111111'                           0414
*                                      /*FIND ALL OCCURRENCES        */
*                             /* CALL THE FIND SUBROUTINE */       0415
*                                                                  0415
*                           /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIN
*                                                                    */
*                           CALL FIND;                             0415
         L     @15,@CV03441                                        0415
         BALR  @14,@15                                             0415
*                           END;                                   0416
*                                      /*FIND ALL ASSOCIATIONS       */
*                                                                  0417
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK IF THIS IS A GDG DATA SET                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0417
*                          RSFAENT = RSFCADR; /*GET FIRST ASSOC      */
         L     @07,RSWASNVT(,REG6)                                 0417
         L     @04,RSFCADR(,@07)                                   0417
         ST    @04,RSFAENT(,@07)                                   0417
*                          IF RSFENTLN ^= 0 THEN                   0418
         CLI   RSFENTLN(@07),0                                     0418
         BE    @RF00418                                            0418
*                            DO;       /*CHECK ALL ASSOCIATIONS      */
*                              DO RSFCNDX = 1 TO RSFHNDX           0420
*                                WHILE(SNTYPE^='B');               0420
         LA    @07,1                                               0420
         B     @DE00420                                            0420
@DL00420 L     @07,RSWASNVT(,REG6)                                 0420
         L     @04,RSFAENT(,@07)                                   0420
         CLI   SNTYPE(@04),C'B'                                    0420
         BE    @DC00420                                            0420
*                                RSFAENT = RSFAENT + RSFENTLN;     0421
         SLR   @15,@15                                             0421
         IC    @15,RSFENTLN(,@07)                                  0421
         ALR   @04,@15                                             0421
         ST    @04,RSFAENT(,@07)                                   0421
*                              END;                                0422
*                                                                  0422
         L     @04,RSWASNVT(,REG6)                                 0422
         LA    @07,1                                               0422
         AH    @07,RSFCNDX(,@04)                                   0422
@DE00420 L     @04,RSWASNVT(,REG6)                                 0422
         STH   @07,RSFCNDX(,@04)                                   0422
         L     @04,RSWASNVT(,REG6)                                 0422
         CH    @07,RSFHNDX(,@04)                                   0422
         BNH   @DL00420                                            0422
@DC00420 DS    0H                                                  0423
*        /************************************************************/
*        /*                                                          */
*        /*     IF A GDG ASSOCIATION WAS FOUND THEN PROCESS THE      */
*        /*     GDG BASE.                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0423
*                              IF SNTYPE = GDGID THEN              0423
         L     @07,RSWASNVT(,REG6)                                 0423
         L     @07,RSFAENT(,@07)                                   0423
         CLI   SNTYPE(@07),C'B'                                    0423
         BNE   @RF00423                                            0423
*                                DO;                               0424
*                                                                  0424
*                                  DO;                             0425
*                                    RSRTYPE = ''B;                0426
         MVI   RSRTYPE(REG6),X'00'                                 0426
*                                    RSRFREE = ON;     /* FREERCD  */
         OI    RSRFREE(REG6),B'00000001'                           0427
*                                    RSRUPD = ON;      /* UPDATE  */
         OI    RSRUPD(REG6),B'00001000'                            0428
*                                    RSRDS = ''B;                  0429
         NI    RSRDS(REG6),B'00011111'                             0429
*                                    RSRWF = ON;       /* WORKFILE  */
*                                    RSRDIR = ON;      /* DIRECT  */
*                                    RSRKEY = ON;      /* KEY  */  0432
*                                                                  0432
         OI    RSRWF(REG6),B'10010100'                             0432
*                                  /* CALL TO MODULE IDCRS06 FOR PROCED
*RE RECMGMT                                                          */
*                                  CALL RECMGMT;                   0433
         L     @15,@CV03458                                        0433
         BALR  @14,@15                                             0433
*                                    RFY RTNREG RSTD;              0434
*                                    TESTRC = RTNREG;              0435
         STH   RTNREG,TESTRC(,REG6)                                0435
*                                    RFY RTNREG UNRSTD;            0436
*                                  END; /*FREE BFR 1             */
*                                                                  0437
*                                  DO;                             0438
*                                    RSRTYPE = ''B;                0439
         MVI   RSRTYPE(REG6),X'00'                                 0439
*                                    RSRGET = ON;      /* GETRCD  */
         OI    RSRGET(REG6),B'10000000'                            0440
*                                    RSRUPD = ON;      /* UPDATE  */
         OI    RSRUPD(REG6),B'00001000'                            0441
*                                    RSRDS = ''B;                  0442
         NI    RSRDS(REG6),B'00011111'                             0442
*                                    RSRWF = ON;       /* WORKFILE  */
*                                    RSRDIR = ON;      /* DIRECT  */
*                                    RSRKEY = ON;      /* KEY  */  0445
         OI    RSRWF(REG6),B'10010100'                             0445
*                                    RSVIAFCR = ON;  /*INDICATE CRA SEA
*CH*/                                RSVIACRA = RCDCRAVL; /*SET VOLSER
*/                                   RSVIACIN = SNNAME; /*SET CI NUMBER
**/                                                                0446
         OI    RSVIAFCR(REG6),B'10000000'                          0446
         L     @07,RSGRABCU(,REG6)                                 0447
         L     @07,GRABCURR(,@07)                                  0447
         MVC   RSVIACRA(6,REG6),RCDCRAVL+8(@07)                    0447
         L     @07,RSWASNVT(,REG6)                                 0448
         L     @07,RSFAENT(,@07)                                   0448
         MVC   RSVIACIN(3,REG6),SNNAME(@07)                        0448
*                                  /* CALL TO MODULE IDCRS05 FOR PROCED
*RE GETVIA                                                           */
*                                  CALL GETVIA;                    0449
         L     @15,@CV03442                                        0449
         BALR  @14,@15                                             0449
*                                  END;                            0450
*                                      /*GET THE GDG BASE RECORD     */
*                                                                  0451
*        /************************************************************/
*        /*                                                          */
*        /*       PROCESS THE GDG IF THE GDG IS FOUND AND            */
*        /*         NOT ALREADY ASSOCIATION CHECKED.                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0451
*                                  IF RABNRF=OFF & RCDID=GDGID &   0451
*                                   RSWASSCK=OFF THEN              0451
         L     @07,RSGRABCU(,REG6)                                 0451
         L     @07,GRABCURR(,@07)                                  0451
         TM    RABNRF(@07),B'00000010'                             0451
         BNZ   @RF00451                                            0451
         CLI   RCDID+8(@07),C'B'                                   0451
         BNE   @RF00451                                            0451
         TM    RSWASSCK(@07),B'00000010'                           0451
         BNZ   @RF00451                                            0451
*                                    RSASSTBL = ADDR(ASSOB);       0452
         LA    @07,ASSOB                                           0452
         ST    @07,RSASSTBL(,REG6)                                 0452
*                                  RABNRF = OFF;                   0453
@RF00451 L     @07,RSGRABCU(,REG6)                                 0453
         L     @07,GRABCURR(,@07)                                  0453
         NI    RABNRF(@07),B'11111101'                             0453
*                                      /*RESET NO RECORD FOUND INDR  */
*                                END;  /*END OF B CHECKING           */
*                            END;      /*END OF SNTABLE CHECKING     */
@RF00423 DS    0H                                                  0456
*                          RSFENTLN = 0; /*FREE ASSN SNTAB           */
@RF00418 L     @07,RSWASNVT(,REG6)                                 0456
         MVI   RSFENTLN(@07),X'00'                                 0456
*                        END;          /*END OF PASS 1 - GDG         */
*                                                                  0457
*        /************************************************************/
*        /*                                                          */
*        /*     NON-VSAM PASS2 - CHECK THE NON-VSAM ENTRY            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0458
*                      ELSE                                        0458
*                        RSASSTBL = ADDR(ASSOA);                   0458
*                                                                  0458
         B     @RC00408                                            0458
@RF00408 LA    @07,ASSOA                                           0458
         ST    @07,RSASSTBL(,REG6)                                 0458
*        /************************************************************/
*        /*                                                          */
*        /*     IF THE RECORD IS THE BASE FOR DOING AN ASSOCIATION   */
*        /*     CHECK THEN GO TO PROCTYPE TO DO IT                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0459
*                    IF RSASSTBL ^= 0 THEN                         0459
@RC00408 DS    0H                                                  0459
@RF00407 L     @07,RSASSTBL(,REG6)                                 0459
         LTR   @07,@07                                             0459
         BZ    @RF00459                                            0459
*                      DO;                                         0460
*                        CALL PROCTYPE;                            0461
*                                                                  0461
         BAL   @14,PROCTYPE                                        0461
*                        DO;                                       0462
*                          RSRECREQ = ''B;                         0463
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0463
*                          RSRTERM = ON;     /* TERMRCD */         0464
         OI    RSRTERM(REG6),B'00000010'                           0464
*                          RSRWF = ON;       /* WORKFILE */        0465
*                                                                  0465
         OI    RSRWF(REG6),B'10000000'                             0465
*                        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGM
*                                                                    */
*                        CALL RECMGMT;                             0466
         L     @15,@CV03458                                        0466
         BALR  @14,@15                                             0466
*                          RFY RTNREG RSTD;                        0467
*                          TESTRC = RTNREG;                        0468
         STH   RTNREG,TESTRC(,REG6)                                0468
*                          RFY RTNREG UNRSTD;                      0469
*                        END;                                      0470
*                                      /*FREE ANY RPLS STILL HELD    */
*                      END;                                        0471
*                                                                  0471
*                  END;                                            0472
*                                      /*END OF CHECK FOR ASSOC TYPE */
*                                                                  0473
*        /************************************************************/
*        /*                                                          */
*        /*     IF NON-RESET CLUSTER OR ALTERNATEINDEX THEN CHECK    */
*        /*     THE DATA AND INDEX TO ENSURE THAT IF THERE IS A      */
*        /*     A CLAIM FOR SPACE ON A VOLUME BEING RESET THAT       */
*        /*     THERE EXISTS A DATA SET DIRECTORY ENTRY (DSDIR)      */
*        /*     ON THAT VOLUME RECORD FOR THIS DATA OR INDEX.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0473
*                ELSE                                              0473
*                  IF RSWFCRA=OFF & RSWDLCAT=OFF THEN              0473
         B     @RC00399                                            0473
@RF00399 L     @07,RSGRABCU(,REG6)                                 0473
         L     @07,GRABCURR(,@07)                                  0473
         TM    RSWFCRA(@07),B'11000000'                            0473
         BNZ   @RF00473                                            0473
*                    DO;                                           0474
*                      IF RCDID=CLID THEN                          0475
         CLI   RCDID+8(@07),C'C'                                   0475
         BNE   @RF00475                                            0475
*                        RSASSTBL=ADDR(ASSO1C); /*NONRESET CLUSTER   */
         LA    @07,ASSO1C                                          0476
         ST    @07,RSASSTBL(,REG6)                                 0476
*                      IF RCDID=AIXID THEN                         0477
@RF00475 L     @07,RSGRABCU(,REG6)                                 0477
         L     @07,GRABCURR(,@07)                                  0477
         CLI   RCDID+8(@07),C'G'                                   0477
         BNE   @RF00477                                            0477
*                        RSASSTBL=ADDR(ASSO2G); /*NONRESET AIX       */
         LA    @07,ASSO2G                                          0478
         ST    @07,RSASSTBL(,REG6)                                 0478
*                      IF RSASSTBL^=0 THEN                         0479
@RF00477 L     @07,RSASSTBL(,REG6)                                 0479
         LTR   @07,@07                                             0479
         BZ    @RF00479                                            0479
*                        DO;                                       0480
*                          CALL PROCTYPE;                          0481
*                                                                  0481
         BAL   @14,PROCTYPE                                        0481
*                          DO;                                     0482
*                            RSRECREQ = ''B;                       0483
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0483
*                            RSRTERM = ON;     /* TERMRCD */       0484
         OI    RSRTERM(REG6),B'00000010'                           0484
*                            RSRWF = ON;       /* WORKFILE */      0485
*                                                                  0485
         OI    RSRWF(REG6),B'10000000'                             0485
*                          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECM
*MT                                                                  */
*                          CALL RECMGMT;                           0486
         L     @15,@CV03458                                        0486
         BALR  @14,@15                                             0486
*                            RFY RTNREG RSTD;                      0487
*                            TESTRC = RTNREG;                      0488
         STH   RTNREG,TESTRC(,REG6)                                0488
*                            RFY RTNREG UNRSTD;                    0489
*                          END;                                    0490
*                                      /*FREE ANY HELD RPLS          */
*                        END;                                      0491
*                    END;                                          0492
*                                                                  0492
@RF00479 DS    0H                                                  0493
*        /************************************************************/
*        /*                                                          */
*        /*     FREE THE RPL HELD BY THE SEQUENTIAL WORKFILE SCAN.   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0493
*                GRABCURR = GRABRAB1;  /*BUFFER1                     */
*                                                                  0493
@RF00473 DS    0H                                                  0493
@RC00399 L     @07,RSGRABCU(,REG6)                                 0493
         L     @04,GRABRAB1(,@07)                                  0493
         ST    @04,GRABCURR(,@07)                                  0493
*                DO;                                               0494
*                  RSRTYPE = ''B;                                  0495
         MVI   RSRTYPE(REG6),X'00'                                 0495
*                  RSRFREE = ON;     /* FREERCD  */                0496
         OI    RSRFREE(REG6),B'00000001'                           0496
*                  RSRUPD = ON;      /* UPDATE  */                 0497
         OI    RSRUPD(REG6),B'00001000'                            0497
*                  RSRDS = ''B;                                    0498
         NI    RSRDS(REG6),B'00011111'                             0498
*                  RSRWF = ON;       /* WORKFILE  */               0499
*                  RSRDIR = ON;      /* DIRECT  */                 0500
*                  RSRKEY = ON;      /* KEY  */                    0501
*                                                                  0501
         OI    RSRWF(REG6),B'10010100'                             0501
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */
*                CALL RECMGMT;                                     0502
         L     @15,@CV03458                                        0502
         BALR  @14,@15                                             0502
*                  RFY RTNREG RSTD;                                0503
*                  TESTRC = RTNREG;                                0504
         STH   RTNREG,TESTRC(,REG6)                                0504
*                  RFY RTNREG UNRSTD;                              0505
*                END;                                              0506
*              END;                    /*END OF PASS                 */
         LA    @07,1                                               0507
         AH    @07,RSASSPAS(,REG6)                                 0507
         STH   @07,RSASSPAS(,REG6)                                 0507
         C     @07,@CF00149                                        0507
         BNH   @DL00380                                            0507
@DC00380 DS    0H                                                  0508
*            END;                      /*END OF LKR EXTENT           */
         LA    @15,1                                               0508
         AL    @15,RSASSCIN(,REG6)                                 0508
@DE00378 ST    @15,RSASSCIN(,REG6)                                 0508
         C     @15,RSASSEND(,REG6)                                 0508
         BNH   @DL00378                                            0508
@DC00378 DS    0H                                                  0509
*        END ASSOCCHK;                 /*END OF LKR                  */
*                                                                  0509
@RF00377 LA    @07,1                                               0509
         AH    @07,RSASSEXT(,REG6)                                 0509
         STH   @07,RSASSEXT(,REG6)                                 0509
         C     @07,@CF01845                                        0509
         BNH   @DL00375                                            0509
@DC00375 DS    0H                                                  0510
*        /************************************************************/
*        /*                                                          */
*        /* FREE ALL STORAGE FOR ASSOC AND ITS SUBPROCESSORS         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0510
*        CALL IDCSAFP0(GDTTBL,POOL10);                             0510
         ST    REG5,@AL00001                                       0510
         LA    @07,@CC00903                                        0510
         ST    @07,@AL00001+4                                      0510
         MVI   @AL00001+4,X'80'                                    0510
         L     @15,GDTFPL(,REG5)                                   0510
         LA    @01,@AL00001                                        0510
         BALR  @14,@15                                             0510
*        /************************************************************/
*        /*                                                          */
*        /* SPACE CHECK                                              */
*        /*     FOR EVERY VOLUME, CHECK CLAIMS FOR SPACE BY          */
*        /*     PROCESSING ALL OF THE DATA SET DIRECTORY ENTRIES     */
*        /*     (DSDIRS) FOR THAT VOLUME.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0511
* SPCCHK:                                                          0511
*                                                                  0511
*        DO;                                                       0511
SPCCHK   DS    0H                                                  0512
*          RSRECREQ = ''B;                                         0512
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0512
*          RSRTERM = ON;     /* TERMRCD */                         0513
         OI    RSRTERM(REG6),B'00000010'                           0513
*          RSRWF = ON;       /* WORKFILE */                        0514
*                                                                  0514
         OI    RSRWF(REG6),B'10000000'                             0514
*        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT             */
*        CALL RECMGMT;                                             0515
         L     @15,@CV03458                                        0515
         BALR  @14,@15                                             0515
*          RFY RTNREG RSTD;                                        0516
*          TESTRC = RTNREG;                                        0517
         STH   RTNREG,TESTRC(,REG6)                                0517
*          RFY RTNREG UNRSTD;                                      0518
*        END;               /*CLEAR ALL RPLS              */       0519
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE PROCVOL             */
*        CALL PROCVOL;                                             0520
*                                                                  0520
         L     @15,@CV03434                                        0520
         BALR  @14,@15                                             0520
*        /************************************************************/
*        /*                                                          */
*        /* DUMP POINT PRIOR TO EXIT                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0521
*        IF GDTDBG = NULLPTR                                       0521
*          THEN;                                                   0521
         L     @07,GDTDBG(,REG5)                                   0521
         LTR   @07,@07                                             0521
         BZ    @RT00521                                            0521
*          ELSE                                                    0523
*            CALL IDCDB010(GDTTBL,'RSA1');                         0523
*                                                                  0523
         ST    REG5,@AL00001                                       0523
         LA    @07,@CC03754                                        0523
         ST    @07,@AL00001+4                                      0523
         MVI   @AL00001+4,X'80'                                    0523
         L     @15,GDTDBG(,REG5)                                   0523
         LA    @01,@AL00001                                        0523
         BALR  @14,@15                                             0523
*        /************************************************************/
*        /*                                                          */
*        /* FREE ALL STORAGE FOR FIND/MODGO/DELGO                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0524
*        CALL IDCSAFP0(GDTTBL,POOL4);                              0524
@RT00521 ST    REG5,@AL00001                                       0524
         LA    @07,@CC00901                                        0524
         ST    @07,@AL00001+4                                      0524
         MVI   @AL00001+4,X'80'                                    0524
         L     @15,GDTFPL(,REG5)                                   0524
         LA    @01,@AL00001                                        0524
         BALR  @14,@15                                             0524
*        RSWAFINF = 0;                 /*CLEAR ANCHOR FOR WORK AREA  */
*                                                                  0525
         SLR   @07,@07                                             0525
         ST    @07,RSWAFINF(,REG6)                                 0525
*  CALL EXIT;  /*TERMINATE*/                                       0526
         BAL   @14,EXIT                                            0526
*  END ASSOC; /*END OF PROCEDURE*/                                 0527
@EL00002 DS    0H                                                  0527
@EF00002 DS    0H                                                  0527
@ER00002 BR    @14                                                 0527
@PB00002 DS    0H                                                  0528
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - CINALTER                                        */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     CINALTER MODIFIES CONTROL INTERVAL NUMBERS (CINS) IN         */
*/*     CATALOG RECORDS FOR HORIZONTAL EXTENSION POINTERS,           */
*/*     GROUP OCCURRENCE POINTERS(GOPS), AND GROUP OCCURRENCES       */
*/*     (GOS) OR DELETES HORIZONTAL EXTENSION POINTERS AND GOPS.     */
*/*                                                                  */
*/* INPUT -                                                          */
*/*     PTCITWK - ADDRESS OF THE CITABE FOR REASSIGNED CIN          */
*/*     PTDITCUR - ADDRESS OF THE DITABE FOR DELETE OR MODIFY        */
*/*       DITDEL - DELETE THE HORIZ EXT PTR, OR GOP                  */
*/*     GRABCURR - ADDRESS OF RECORD IN BUFFER                       */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*     THE RECORD IS UPDATE IN THE BUFFER.                          */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0528
         DS    0F
NAME0032 DC    CL8'CINALTER'
*CINALTER: PROCEDURE                                               0529
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0529
*                                                                  0529
         B     @PB00003                                            0529
CINALTER DS    0H                                                  0530
*      GENERATE REFS(RS02RG08, REG6);                              0530
*                                                                  0530
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0032  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      0531
         L     @07,GDTTR2(,REG5)                                   0531
         MVC   @TS00001(95),NEWERID2(@07)                          0531
         MVC   OLDERID2(95,@07),@TS00001                           0531
*        NEWID2 = 'RSCA';                                          0532
         MVC   NEWID2(4,@07),@CC03760                              0532
*        RFY CITABE BASED(PTCITWK);                                0533
*                                                                  0533
*        /************************************************************/
*        /*                                                          */
*        /* GET BASE POINTERS FOR THE CATALOG RECORD                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0534
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU            */
*        CALL CATRCDSU;                                            0534
*                                                                  0534
         L     @15,@CV03430                                        0534
         BALR  @14,@15                                             0534
*        /************************************************************/
*        /*                                                          */
*        /* MARK RECORD FOR UPDATE IN CATALOG AND CRA                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0535
*        RSWUPCAT = ON;                                            0535
         L     @07,RSGRABCU(,REG6)                                 0535
         L     @07,GRABCURR(,@07)                                  0535
         OI    RSWUPCAT(@07),B'00100000'                           0535
*        /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR             */
*        CALL ADDUPCR;                                             0536
*                                                                  0536
         L     @15,@CV03448                                        0536
         BALR  @14,@15                                             0536
*        /************************************************************/
*        /*                                                          */
*        /*     POINT TO THE GOP                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0537
*        RSCPE5 = RSCPE1 + DITOFS;                                 0537
         L     @07,RSPTWKC(,REG6)                                  0537
         L     @07,PTDITCUR(,@07)                                  0537
         LH    @04,DITOFS(,@07)                                    0537
         AL    @04,RSCPE1(,REG6)                                   0537
         ST    @04,RSCPE5(,REG6)                                   0537
*        IF DITFB256 = ON THEN                                     0538
         TM    DITFB256(@07),B'00000001'                           0538
         BNO   @RF00538                                            0538
*          RSCPE5 = RSCPE5 +  256;                                 0539
*                                                                  0539
         AL    @04,@CF03188                                        0539
         ST    @04,RSCPE5(,REG6)                                   0539
*        /************************************************************/
*        /*                                                          */
*        /*     DELETE CIN IN HORIZONTAL OR GROUP OCCURRENCE         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0540
*        IF DITFADEL = ON THEN                                     0540
@RF00538 L     @07,RSPTWKC(,REG6)                                  0540
         L     @07,PTDITCUR(,@07)                                  0540
         TM    DITFADEL(@07),B'00010000'                           0540
         BNO   @RF00540                                            0540
*          IF DITFBHEP = ON THEN                                   0541
         TM    DITFBHEP(@07),B'10000000'                           0541
         BNO   @RF00541                                            0541
*            EXTGOCI = 0;              /*DELETE HORIZONTAL           */
         L     @07,RSCPE2(,REG6)                                   0542
         SLR   @04,@04                                             0542
         STCM  @04,7,EXTGOCI(@07)                                  0542
*          ELSE                                                    0543
*            IF DITFBGOE = ON THEN                                 0543
         B     @RC00541                                            0543
@RF00541 L     @07,RSPTWKC(,REG6)                                  0543
         L     @07,PTDITCUR(,@07)                                  0543
         TM    DITFBGOE(@07),B'01000000'                           0543
         BNO   @RF00543                                            0543
*              DO;                                                 0544
*                CATGODEL = ON;        /*DELETE GOP                  */
         L     @07,RSCPE5(,REG6)                                   0545
         OI    CATGODEL(@07),B'01000000'                           0545
*                CATGOCI = 0;          /*CLEAR CIN                   */
         SLR   @04,@04                                             0546
         STCM  @04,7,CATGOCI(@07)                                  0546
*              END;                                                0547
*            ELSE                                                  0548
*                                                                  0548
*              DO;                                                 0548
         B     @RC00543                                            0548
@RF00543 DS    0H                                                  0549
*              /*CALL CKERR*/                                      0549
*                RSCKERR = RSCKERR && RSCKERR;                     0549
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0549
*                RSCKERN = RSE100;                                 0550
         MVC   RSCKERN(2,REG6),@CH00143                            0550
*                RSCKTERM = 'TERM';                                0551
*                                                                  0551
         MVC   RSCKTERM(4,REG6),@CC03762                           0551
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */
*              CALL CKERR;                                         0552
         L     @15,@CV03449                                        0552
         BALR  @14,@15                                             0552
*              END; /*BUG                        */                0553
*                                                                  0553
*        /************************************************************/
*        /*                                                          */
*        /*     UPDATE REASSIGNED CIN                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0554
*        ELSE                                                      0554
*          IF DITFBHEP = ON THEN                                   0554
         B     @RC00540                                            0554
@RF00540 L     @07,RSPTWKC(,REG6)                                  0554
         L     @04,PTDITCUR(,@07)                                  0554
         TM    DITFBHEP(@04),B'10000000'                           0554
         BNO   @RF00554                                            0554
*            EXTGOCI = CITRCIN;        /*HORIZONTAL REASSIGNED       */
         L     @04,RSCPE2(,REG6)                                   0555
         L     @07,PTCITWK(,@07)                                   0555
         MVC   EXTGOCI(3,@04),CITRCIN(@07)                         0555
*          ELSE                                                    0556
*            IF DITFBGOE = ON THEN                                 0556
         B     @RC00554                                            0556
@RF00554 L     @07,RSPTWKC(,REG6)                                  0556
         L     @04,PTDITCUR(,@07)                                  0556
         TM    DITFBGOE(@04),B'01000000'                           0556
         BNO   @RF00556                                            0556
*              CATGOCI = CITRCIN;      /*GOP REASSIGNED              */
         L     @04,RSCPE5(,REG6)                                   0557
         L     @07,PTCITWK(,@07)                                   0557
         MVC   CATGOCI(3,@04),CITRCIN(@07)                         0557
*            ELSE                                                  0558
*              DO;                                                 0558
         B     @RC00556                                            0558
@RF00556 DS    0H                                                  0559
*                RSCPE6 = RSCPE3 + CATGODSP; /*POINT TO GO           */
         L     @07,RSCPE5(,REG6)                                   0559
         ICM   @07,12,CATGODSP(@07)                                0559
         SRA   @07,16                                              0559
         AL    @07,RSCPE3(,REG6)                                   0559
         ST    @07,RSCPE6(,REG6)                                   0559
*                IF DITFBAS1 = ON THEN                             0560
         L     @04,RSPTWKC(,REG6)                                  0560
         L     @04,PTDITCUR(,@04)                                  0560
         TM    DITFBAS1(@04),B'00100000'                           0560
         BNO   @RF00560                                            0560
*                  IF DITCITAB = 0 THEN                            0561
         L     @04,DITCITAB-1(,@04)                                0561
         LA    @04,0(,@04)                                         0561
         LTR   @04,@04                                             0561
         BNZ   @RF00561                                            0561
*                    ASCI = 0;         /*REPAIR ALIAS CHAIN          */
         SLR   @04,@04                                             0562
         STCM  @04,7,ASCI(@07)                                     0562
*                  ELSE                                            0563
*                    ASCI = CITRCIN;   /*ASSN NAME1 REASSIGNED       */
         B     @RC00561                                            0563
@RF00561 L     @07,RSCPE6(,REG6)                                   0563
         L     @04,RSPTWKC(,REG6)                                  0563
         L     @04,PTCITWK(,@04)                                   0563
         MVC   ASCI(3,@07),CITRCIN(@04)                            0563
*                ELSE                                              0564
*                  IF DITFBAS2 = ON THEN                           0564
         B     @RC00560                                            0564
@RF00560 L     @07,RSPTWKC(,REG6)                                  0564
         L     @04,PTDITCUR(,@07)                                  0564
         TM    DITFBAS2(@04),B'00010000'                           0564
         BNO   @RF00564                                            0564
*                    ASCI2 = CITRCIN;  /*ASSN NAME2 REASSIGNED       */
         L     @04,RSCPE6(,REG6)                                   0565
         L     @07,PTCITWK(,@07)                                   0565
         MVC   ASCI2(3,@04),CITRCIN(@07)                           0565
*                  ELSE                                            0566
*                                                                  0566
*                    DO;                                           0566
         B     @RC00564                                            0566
@RF00564 DS    0H                                                  0567
*                    /*CALL CKERR*/                                0567
*                      RSCKERR = RSCKERR && RSCKERR;               0567
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0567
*                      RSCKERN = RSE100;                           0568
         MVC   RSCKERN(2,REG6),@CH00143                            0568
*                      RSCKTERM = 'TERM';                          0569
*                                                                  0569
         MVC   RSCKTERM(4,REG6),@CC03762                           0569
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */
*                    CALL CKERR;                                   0570
         L     @15,@CV03449                                        0570
         BALR  @14,@15                                             0570
*                    END; /*BAD DITABE           */                0571
*              END;                                                0572
*                                                                  0572
@RC00564 DS    0H                                                  0572
@RC00560 DS    0H                                                  0573
*        RFY CITABE;                   /*REVERT                      */
@RC00556 DS    0H                                                  0573
@RC00554 DS    0H                                                  0573
@RC00540 DS    0H                                                  0574
* CALL EXIT;  /*TERMINATE*/                                        0574
         BAL   @14,EXIT                                            0574
* END CINALTER; /*END OF PROCEDURE*/                               0575
@EL00003 DS    0H                                                  0575
@EF00003 DS    0H                                                  0575
@ER00003 BR    @14                                                 0575
@PB00003 DS    0H                                                  0576
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - LOCDIT                                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    LOCDIT LOCATES A DITABE; I.E., A CIN WITHIN A RECORD.         */
*/*    IT HAS 2 MODES:                                               */
*/*      (1) START SCAN - PTLOC IS ALL ZEROS EXCEPT:                 */
*/*              PTLBCIT - INDEX OF BASE CITABE                      */
*/*              PTLDITFB - FLAG B MATCH                             */
*/*              PTLDITTYP - RECORD TYPE MATCH                       */
*/*      (2) CONTINUE SCAN - SUBSEQUENT CALL, SCANS FROM THE LAST    */
*/*              ENTRY RETURNED PREVIOUSLY.                          */
*/*                                                                  */
*/*    LOCDIT WILL TRY TO LOCATE A DITABE OFF THE BASE WITH A        */
*/*    MATCHING FLAG BYTE AND MATCHING RECORD TYPE.                  */
*/*    FOR UNCONDITIONAL NEXT ENTRY REQUESTS SET PTLDITFB AND        */
*/*    PTLDITTYP TO ZERO.                                            */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    PTLBCITX - INDEX OF CITABE TO SCAN                            */
*/*    PTLDITFB - FLAB BYTE B MASK FOR DITABE                        */
*/*               IF ANY MATCH OR THIS IS 0 THEN ENTRY IS DESIRED.   */
*/*    PTLDITTYP - RECORD ID                                         */
*/*               IF SAME AS DITABE OR ZERO THEN ENTRY IS DESIRED.   */
*/*    PTLSN - SEQUENCE NUMBER DESIRED                               */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    PTLCDIT - ADDRESS OF DITABE                                   */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0576
         DS    0F
NAME0040 DC    CL8'LOCDIT'
*LOCDIT: PROCEDURE                                                 0577
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0577
*                                                                  0577
         B     @PB00004                                            0577
LOCDIT   DS    0H                                                  0578
*      GENERATE REFS(RS02RG08, REG6);                              0578
*                                                                  0578
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY LOCDIT  ENTRY POINT
         LM    @08,@12,RS02RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0040  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      0579
         L     @07,GDTTR2(,REG5)                                   0579
         MVC   @TS00001(95),NEWERID2(@07)                          0579
         MVC   OLDERID2(95,@07),@TS00001                           0579
*        NEWID2 = 'RSLO';                                          0580
*                                                                  0580
         MVC   NEWID2(4,@07),@CC03767                              0580
*        RFY CITABE BASED(PTLCCIT);                                0581
*                                                                  0581
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS IS THE START OF THE SCAN THEN START THE SCAN     */
*        /* AT THE BASE RECORD SPECIFIED.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0582
*        IF PTLCCIT = 0 THEN                                       0582
         L     @07,RSPTWKC(,REG6)                                  0582
         L     @04,PTLCCIT(,@07)                                   0582
         LTR   @04,@04                                             0582
         BNZ   @RF00582                                            0582
*          DO;                                                     0583
*            RSTANCHR = ADDR(RSGCITS); /*CI TABLE SCAN               */
         LA    @04,RSGCITS(,REG6)                                  0584
         ST    @04,RSTANCHR(,REG6)                                 0584
*            RSTENTIX = PTLBCITX;      /*SCAN OF BASE                */
         MVC   RSTENTIX(3,REG6),PTLBCITX(@07)                      0585
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE        */
*            CALL GETNEXTE;                                        0586
         L     @15,@CV03436                                        0586
         BALR  @14,@15                                             0586
*            PTLCCIT = RSTENTAD;       /*CITABE ADDRESS              */
         L     @07,RSPTWKC(,REG6)                                  0587
         L     @04,RSTENTAD(,REG6)                                 0587
         ST    @04,PTLCCIT(,@07)                                   0587
*            PTLNDIT = CITDITAB;       /*FIRST DITABE INDEX          */
         MVC   PTLNDIT(3,@07),CITDITAB(@04)                        0588
*          END;                                                    0589
*                                                                  0589
*        /************************************************************/
*        /*                                                          */
*        /*  IF CONTINUOUS SCAN, THEN POINT TO THE NEXT CIN IN THE   */
*        /*  RECORD (OR OUT OF THE RECORD)                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0590
*        ELSE                                                      0590
*          PTLNDIT = PTLNDIT + 1;                                  0590
*                                                                  0590
         B     @RC00582                                            0590
@RF00582 L     @07,RSPTWKC(,REG6)                                  0590
         LA    @04,1                                               0590
         L     @15,PTLNDIT-1(,@07)                                 0590
         LA    @15,0(,@15)                                         0590
         ALR   @04,@15                                             0590
         STCM  @04,7,PTLNDIT(@07)                                  0590
*        /************************************************************/
*        /*                                                          */
*        /* SCAN THE RECORD AND ALL OF ITS EXTENSIONS FOR THE        */
*        /* DESIRED ENTRY.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0591
*        PTF1HIT = OFF;                /*INDICATE ENTRY NOT FOUND    */
@RC00582 L     @07,RSPTWKC(,REG6)                                  0591
         NI    PTF1HIT(@07),B'01111111'                            0591
*        DO WHILE (PTF1HIT=OFF & PTLCCIT^=0);                      0592
*                                                                  0592
         B     @DE00592                                            0592
@DL00592 DS    0H                                                  0593
*        /************************************************************/
*        /*                                                          */
*        /*     SCAN ALL CINS IN THIS RECORD FOR A MATCH             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0593
*        RFY DITABE BASED(PTLCDIT);                                0593
*          IF (PTLNDIT ^= 0) & (PTLNDIT =< (CITDITAB + CITDICNT - 1))
*           THEN                                                   0594
*                                                                  0594
         L     @07,RSPTWKC(,REG6)                                  0594
         L     @04,PTLNDIT-1(,@07)                                 0594
         LA    @04,0(,@04)                                         0594
         LTR   @04,@04                                             0594
         BZ    @RF00594                                            0594
         L     @07,PTLCCIT(,@07)                                   0594
         L     @15,CITDITAB-1(,@07)                                0594
         LA    @15,0(,@15)                                         0594
         SLR   @14,@14                                             0594
         IC    @14,CITDICNT(,@07)                                  0594
         ALR   @15,@14                                             0594
         BCTR  @15,0                                               0594
         CR    @04,@15                                             0594
         BH    @RF00594                                            0594
*            DO PTLNDIT = PTLNDIT TO (CITDITAB + CITDICNT - 1)     0595
*             WHILE(PTF1HIT=OFF);                                  0595
*                                                                  0595
         B     @DE00595                                            0595
@DL00595 L     @07,RSPTWKC(,REG6)                                  0595
         TM    PTF1HIT(@07),B'10000000'                            0595
         BNZ   @DC00595                                            0595
*        /************************************************************/
*        /*                                                          */
*        /*     GET THE NEXT CIN IN THE RECORD                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0596
*              RSTANCHR = ADDR(RSGDITS);                           0596
         LA    @04,RSGDITS(,REG6)                                  0596
         ST    @04,RSTANCHR(,REG6)                                 0596
*              RSTENTIX = PTLNDIT;     /*DITABE LOCATE               */
         MVC   RSTENTIX(3,REG6),PTLNDIT(@07)                       0597
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      0598
         L     @15,@CV03436                                        0598
         BALR  @14,@15                                             0598
*              PTLCDIT = RSTENTAD;     /*SAVE ENTRY ADDRESS          */
*                                                                  0599
         L     @07,RSPTWKC(,REG6)                                  0599
         L     @04,RSTENTAD(,REG6)                                 0599
         ST    @04,PTLCDIT(,@07)                                   0599
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK FOR MATCHING TYPE                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0600
*              IF (PTLDITFB='00'X)  ((PTLDITFB&DITFLB)^='00'X)    0600
*               THEN                                               0600
*                                                                  0600
         CLI   PTLDITFB(@07),X'00'                                 0600
         BE    @RT00600                                            0600
         MVC   @TS00001(1),PTLDITFB(@07)                           0600
         NC    @TS00001(1),DITFLB(@04)                             0600
         CLI   @TS00001,X'00'                                      0600
         BE    @RF00600                                            0600
@RT00600 DS    0H                                                  0601
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK FOR MATCHING RECORD ID                         */
*        /*       IGNORE ENTRY TYPE CHECK FOR ALIAS ASSOCIATION      */
*        /*       FORWARD OR BACKWARD CHAIN OF 0. THERE IS NO        */
*        /*       CITABLE ENTRY FOR THIS ASSOCIATION.                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0601
*                DO;                                               0601
*                  IF PTLDITID = '00'X                            0602
*                   (PTLDITID = ALIASID & DITCITAB = 0)            0602
*                   THEN;              /*UNCOND OR ALIAS END         */
         L     @07,RSPTWKC(,REG6)                                  0602
         CLI   PTLDITID(@07),X'00'                                 0602
         BE    @RT00602                                            0602
         CLI   PTLDITID(@07),C'X'                                  0602
         BNE   @RF00602                                            0602
         L     @07,PTLCDIT(,@07)                                   0602
         L     @07,DITCITAB-1(,@07)                                0602
         LA    @07,0(,@07)                                         0602
         LTR   @07,@07                                             0602
         BZ    @RT00602                                            0602
*                  ELSE                /*CONDITIONAL LOCATE          */
*                    DO;                                           0604
@RF00602 DS    0H                                                  0605
*                      RSTANCHR = ADDR(RSGCITS); /*FIND CITABE       */
         LA    @07,RSGCITS(,REG6)                                  0605
         ST    @07,RSTANCHR(,REG6)                                 0605
*                      RSTENTIX = DITCITAB; /*INDEX OF CI TAB ENTRY  */
         L     @07,RSPTWKC(,REG6)                                  0606
         L     @07,PTLCDIT(,@07)                                   0606
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      0606
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE
*                                                                    */
*                      CALL GETNEXTE;                              0607
         L     @15,@CV03436                                        0607
         BALR  @14,@15                                             0607
*                    END;                                          0608
*                  IF (PTLDITID='00'X)                            0609
*                   (PTLDITID = ALIASID & DITCITAB = 0)           0609
*                   (RSTENTAD->CITTYPE=PTLDITID) THEN              0609
*                                                                  0609
@RT00602 L     @07,RSPTWKC(,REG6)                                  0609
         CLI   PTLDITID(@07),X'00'                                 0609
         BE    @RT00609                                            0609
         CLI   PTLDITID(@07),C'X'                                  0609
         BNE   @GL00009                                            0609
         L     @07,PTLCDIT(,@07)                                   0609
         L     @07,DITCITAB-1(,@07)                                0609
         LA    @07,0(,@07)                                         0609
         LTR   @07,@07                                             0609
         BZ    @RT00609                                            0609
@GL00009 L     @07,RSTENTAD(,REG6)                                 0609
         L     @04,RSPTWKC(,REG6)                                  0609
         CLC   CITTYPE(1,@07),PTLDITID(@04)                        0609
         BNE   @RF00609                                            0609
@RT00609 DS    0H                                                  0610
*                    IF (PTLSN=0)  (PTLSN=DITSN) THEN             0610
         L     @07,RSPTWKC(,REG6)                                  0610
         LH    @04,PTLSN(,@07)                                     0610
         LTR   @04,@04                                             0610
         BZ    @RT00610                                            0610
         L     @07,PTLCDIT(,@07)                                   0610
         CH    @04,DITSN(,@07)                                     0610
         BNE   @RF00610                                            0610
@RT00610 DS    0H                                                  0611
*                      PTF1HIT = ON; /*FOUND MATCH                   */
*                                                                  0611
         L     @07,RSPTWKC(,REG6)                                  0611
         OI    PTF1HIT(@07),B'10000000'                            0611
*                END;                                              0612
@RF00610 DS    0H                                                  0612
@RF00609 DS    0H                                                  0613
*            END;                                                  0613
@RF00600 L     @07,RSPTWKC(,REG6)                                  0613
         LA    @04,1                                               0613
         L     @07,PTLNDIT-1(,@07)                                 0613
         LA    @07,0(,@07)                                         0613
         ALR   @04,@07                                             0613
         L     @07,RSPTWKC(,REG6)                                  0613
         STCM  @04,7,PTLNDIT(@07)                                  0613
@DE00595 L     @07,RSPTWKC(,REG6)                                  0613
         L     @07,PTLCCIT(,@07)                                   0613
         L     @01,RSPTWKC(,REG6)                                  0613
         L     @01,PTLCCIT(,@01)                                   0613
         L     @07,CITDITAB-1(,@07)                                0613
         LA    @07,0(,@07)                                         0613
         SLR   @00,@00                                             0613
         IC    @00,CITDICNT(,@01)                                  0613
         ALR   @07,@00                                             0613
         BCTR  @07,0                                               0613
         CR    @04,@07                                             0613
         BNH   @DL00595                                            0613
@DC00595 DS    0H                                                  0614
*        RFY DITABE;                   /*REVERT                      */
*                                                                  0614
@RF00594 DS    0H                                                  0615
*        /************************************************************/
*        /*                                                          */
*        /*     IF ENTRY NOT FOUND, CONTINUE AT EXTENSION.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0615
*          PTLNDIT = PTLNDIT - 1;      /*GET TRUE DITABE INDEX       */
         L     @07,RSPTWKC(,REG6)                                  0615
         L     @04,PTLNDIT-1(,@07)                                 0615
         LA    @04,0(,@04)                                         0615
         BCTR  @04,0                                               0615
         STCM  @04,7,PTLNDIT(@07)                                  0615
*          IF PTF1HIT = OFF THEN                                   0616
         TM    PTF1HIT(@07),B'10000000'                            0616
         BNZ   @RF00616                                            0616
*            IF CITEXTCH = 0 THEN      /*NO MORE EXTENSIONS          */
         L     @04,PTLCCIT(,@07)                                   0617
         L     @04,CITEXTCH-1(,@04)                                0617
         LA    @04,0(,@04)                                         0617
         LTR   @04,@04                                             0617
         BNZ   @RF00617                                            0617
*              PTLCCIT = 0;                                        0618
         SLR   @04,@04                                             0618
         ST    @04,PTLCCIT(,@07)                                   0618
*            ELSE                      /*EXTENSION EXISTS            */
*              DO;                                                 0619
         B     @RC00617                                            0619
@RF00617 DS    0H                                                  0620
*                RSTANCHR = ADDR(RSGCITS);                         0620
         LA    @07,RSGCITS(,REG6)                                  0620
         ST    @07,RSTANCHR(,REG6)                                 0620
*                RSTENTIX = CITEXTCH;                              0621
         L     @07,RSPTWKC(,REG6)                                  0621
         L     @07,PTLCCIT(,@07)                                   0621
         MVC   RSTENTIX(3,REG6),CITEXTCH(@07)                      0621
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */
*                CALL GETNEXTE;                                    0622
         L     @15,@CV03436                                        0622
         BALR  @14,@15                                             0622
*                PTLCCIT = RSTENTAD;   /*EXTENSION RECORD            */
         L     @07,RSPTWKC(,REG6)                                  0623
         L     @04,RSTENTAD(,REG6)                                 0623
         ST    @04,PTLCCIT(,@07)                                   0623
*                PTLNDIT = CITDITAB;   /*FIRST CIN IN THE RECORD     */
         MVC   PTLNDIT(3,@07),CITDITAB(@04)                        0624
*              END;                                                0625
*        END;                                                      0626
*                                                                  0626
@RC00617 DS    0H                                                  0626
@RF00616 DS    0H                                                  0626
@DE00592 L     @07,RSPTWKC(,REG6)                                  0626
         TM    PTF1HIT(@07),B'10000000'                            0626
         BNZ   @DC00592                                            0626
         L     @07,PTLCCIT(,@07)                                   0626
         LTR   @07,@07                                             0626
         BNZ   @DL00592                                            0626
@DC00592 DS    0H                                                  0627
*        /************************************************************/
*        /*                                                          */
*        /*  IF NO ENTRY FOUND, INDICATE NO DITABE                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0627
*        IF PTF1HIT = OFF THEN                                     0627
         L     @07,RSPTWKC(,REG6)                                  0627
         TM    PTF1HIT(@07),B'10000000'                            0627
         BNZ   @RF00627                                            0627
*          PTLCDIT = 0;                                            0628
         SLR   @04,@04                                             0628
         ST    @04,PTLCDIT(,@07)                                   0628
*        RFY CITABE;                   /*REVERT                      */
@RF00627 DS    0H                                                  0630
* CALL EXIT;  /*TERMINATE*/                                        0630
         BAL   @14,EXIT                                            0630
* END LOCDIT; /*END OF PROCEDURE*/                                 0631
@EL00004 DS    0H                                                  0631
@EF00004 DS    0H                                                  0631
@ER00004 BR    @14                                                 0631
@PB00004 DS    0H                                                  0632
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - PROCCI                                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    PROCCI RECEIVES A CIN FROM A RECORD ON A CALL FROM SCANCI.    */
*/*    A DITABE (DISPLACEMENT TABLE ENTRY) WILL BE CREATED TO        */
*/*    REPRESENT THIS CIN IN THE RECORD BEING PROCESSED BY SCANCI.   */
*/*    THE DITABE DESCRIBES THE OFFSET INTO THE RECORD TO THE CIN    */
*/*    AND WHAT THE CIN REPRESENTS (E.G., ASSOCIATION). THE CITABE   */
*/*    (CI TABLE) FOR THIS SET OF RECORDS IS SCANNED TO DETERMINE    */
*/*    IF THE CIN ALREADY EXISTS IN ANOTHER RECORD; IT NOT A CITAB   */
*/*    (CI TABLE ENTRY) IS CREATED FOR THIS CIN. THE DITABE WILL     */
*/*    POINT TO THE CIN IT REPRESENTS AND THE CITABE FOR THE RECORD  */
*/*    BEING PROCESSED WILL POINT TO THE FIRST DITABE FOR THAT       */
*/*    RECORD.                                                       */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    RSCPE5 - ADDRESS OF THE CIN(HORIZONTAL) OR GOP                */
*/*    RSCITDUM - THE DUMMY CITABE CREATED TO REPRESENT THIS CIN.    */
*/*    PTCITCUR - ADDRESS OF THE CITABE FOR THE RECORD BEING SCANNED */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    NO INFORMATION IS RETURNED. THE ENTRY IS ADDED PER THE        */
*/*    FUNCTION DESCRIPTION.                                         */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0632
         DS    0F
NAME0046 DC    CL8'PROCCI'
*PROCCI: PROCEDURE                                                 0633
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0633
*                                                                  0633
         B     @PB00005                                            0633
PROCCI   DS    0H                                                  0634
*      GENERATE REFS(RS02RG08, REG6);                              0634
*                                                                  0634
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0046  PROCNAME TO REGSAVE
*         OLDERID2 = NEWERID2;                                     0635
         L     @07,GDTTR2(,REG5)                                   0635
         MVC   @TS00001(95),NEWERID2(@07)                          0635
         MVC   OLDERID2(95,@07),@TS00001                           0635
*         NEWID2 = 'RSPT';                                         0636
*                                                                  0636
         MVC   NEWID2(4,@07),@CC03774                              0636
*        /************************************************************/
*        /*                                                          */
*        /* GET A DITABE FOR THIS CIN                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0637
*        RSTANCHR = ADDR(RSGDITS);     /*POINT TO DITAB BASE         */
*                                                                  0637
         LA    @07,RSGDITS(,REG6)                                  0637
         ST    @07,RSTANCHR(,REG6)                                 0637
*        /* GET A FREE DITABE */                                   0638
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETFIT              */
*        CALL GETFIT;                                              0638
*                                                                  0638
         L     @15,@CV03435                                        0638
         BALR  @14,@15                                             0638
*        IF PTDITI = 0 THEN            /*FIRST GDIT - RECORD         */
         L     @07,RSPTWKC(,REG6)                                  0639
         L     @04,PTDITI-1(,@07)                                  0639
         LA    @04,0(,@04)                                         0639
         LTR   @04,@04                                             0639
         BNZ   @RF00639                                            0639
*          DO;                                                     0640
*            PTDITI = RSGDITNU;        /*INDEX OF FIRST DITABE       */
         MVC   PTDITI(3,@07),RSGDITNU(REG6)                        0641
*            PTDITF = RSTENTAD;        /*ADDRESS OF FIRST DITABE     */
         L     @04,RSTENTAD(,REG6)                                 0642
         ST    @04,PTDITF(,@07)                                    0642
*          END;                                                    0643
*        PTDITL = RSGDITNU;            /*LAST ENTRY INDEX            */
@RF00639 L     @07,RSPTWKC(,REG6)                                  0644
         MVC   PTDITL(3,@07),RSGDITNU(REG6)                        0644
*        PTDITNC = RSGDITNU;           /*DITABE CURR = ONE ALLOCATED */
         MVC   PTDITNC(3,@07),RSGDITNU(REG6)                       0645
*        PTDITCUR = RSTENTAD;          /*POINT TO NEW DITABE         */
*                                                                  0646
         L     @04,RSTENTAD(,REG6)                                 0646
         ST    @04,PTDITCUR(,@07)                                  0646
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS IS THE FIRST DISPACEMENT TABLE ENTRY FOR         */
*        /* THIS RECORD THEN CHAIN THE CI TABLE ENTRY TO THIS        */
*        /* DISPLACEMENT TABLE ENTRY.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0647
*        IF CITDICNT = 0 THEN                                      0647
         L     @04,PTCITCUR(,@07)                                  0647
         CLI   CITDICNT(@04),0                                     0647
         BNE   @RF00647                                            0647
*          CITDITAB = PTDITNC;         /*INDEX OF 1ST DITABE         */
         MVC   CITDITAB(3,@04),PTDITNC(@07)                        0648
*        CITDICNT = CITDICNT + 1;      /*INCR NUM DITABE FOR THIS RCD*/
*                                                                  0649
@RF00647 L     @07,RSPTWKC(,REG6)                                  0649
         L     @04,PTCITCUR(,@07)                                  0649
         LA    @15,1                                               0649
         SLR   @14,@14                                             0649
         IC    @14,CITDICNT(,@04)                                  0649
         ALR   @15,@14                                             0649
         STC   @15,CITDICNT(,@04)                                  0649
*        /************************************************************/
*        /*                                                          */
*        /* FORMAT A DISPLACEMENT TABLE ENTRY                        */
*        /*   INDICATE HORIZONTAL EXTENSION                          */
*        /*   INDICATE GOP(GROUP OCCURRENCE POINTER)                 */
*        /*   SET THE OFFSET TO THE CIN IN THE RECORD                */
*        /*       FOR HORIZONTAL - OFFSET TO HORIZONTAL              */
*        /*       FOR GOP - OFFSET TO GOP                            */
*        /*       FOR GO - OFFSET TO GOP(YES THAT'S GOP)             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0650
*        RFY DITABE BASED(PTDITCUR);   /*PT NEW DITABE               */
*        RFY CITABE BASED(ADDR(RSCITDUM)); /*PT DUMMY CITABE THIS CIN*/
*                                                                  0651
*        DITABE = DITABE&&DITABE;                                  0652
         L     @07,PTDITCUR(,@07)                                  0652
         XC    DITABE(16,@07),DITABE(@07)                          0652
*        IF CITFAHEP = ON THEN         /*HORIZONTAL EXTENSION        */
         TM    CITFAHEP+48(REG6),B'00010000'                       0653
         BNO   @RF00653                                            0653
*          DITFBHEP = ON;                                          0654
         OI    DITFBHEP(@07),B'10000000'                           0654
*        IF CITFAGOE = ON THEN         /*GOP - GROUP OCCUR PTR       */
@RF00653 TM    CITFAGOE+48(REG6),B'00001000'                       0655
         BNO   @RF00655                                            0655
*          DITFBGOE = ON;                                          0656
         L     @07,RSPTWKC(,REG6)                                  0656
         L     @07,PTDITCUR(,@07)                                  0656
         OI    DITFBGOE(@07),B'01000000'                           0656
*        IF (RSCPE5-RSCPE1) >=  256 THEN /*CHECK OFFSET OVER 255     */
@RF00655 LA    @07,256                                             0657
         L     @04,RSCPE5(,REG6)                                   0657
         SL    @04,RSCPE1(,REG6)                                   0657
         CR    @04,@07                                             0657
         BL    @RF00657                                            0657
*          DO;                                                     0658
*            DITFB256 = ON;                                        0659
         L     @01,RSPTWKC(,REG6)                                  0659
         L     @15,PTDITCUR(,@01)                                  0659
         OI    DITFB256(@15),B'00000001'                           0659
*            DITOFS = RSCPE5 - RSCPE1 -  256;                      0660
         SLR   @04,@07                                             0660
         STH   @04,DITOFS(,@15)                                    0660
*          END;                                                    0661
*        ELSE                                                      0662
*          DITOFS = RSCPE5 - RSCPE1;                               0662
         B     @RC00657                                            0662
@RF00657 L     @07,RSPTWKC(,REG6)                                  0662
         L     @07,PTDITCUR(,@07)                                  0662
         L     @04,RSCPE5(,REG6)                                   0662
         SL    @04,RSCPE1(,REG6)                                   0662
         STH   @04,DITOFS(,@07)                                    0662
*          IF CITFAHEP = OFF THEN      /*MUST BE GOP OR GO           */
@RC00657 TM    CITFAHEP+48(REG6),B'00010000'                       0663
         BNZ   @RF00663                                            0663
*            IF RSGOPLEN = CATGOPLN THEN                           0664
         CLC   RSGOPLEN(2,REG6),@CH00280                           0664
         BNE   @RF00664                                            0664
*              DITOSN = CATGOSEQ;      /*CAT GOP SEQUENCE NUM        */
         L     @07,RSPTWKC(,REG6)                                  0665
         L     @07,PTDITCUR(,@07)                                  0665
         L     @04,RSCPE5(,REG6)                                   0665
         IC    @15,CATGOSEQ(,@04)                                  0665
         STC   @15,DITOSN(,@07)                                    0665
*            ELSE                                                  0666
*              DITVSN = CATSN;        /*VOL GOP SEQUENCE NUMBER      */
*                                                                  0666
         B     @RC00664                                            0666
@RF00664 L     @07,RSPTWKC(,REG6)                                  0666
         L     @07,PTDITCUR(,@07)                                  0666
         L     @04,RSCPE5(,REG6)                                   0666
         MVC   DITVSN(2,@07),CATSN+4(@04)                          0666
*        /************************************************************/
*        /*                                                          */
*        /* IF THE CIN IS AN ASSOCIATION FOR AN ALIAS RECORD         */
*        /* THE CIN VALUE MAY BE ZERO. SINCE ALIAS ASSOCIATIONS      */
*        /* FORWARD AND BACKWARD CHAIN TO ONE ANOTHER, THE           */
*        /* FIRST BACK CHAIN IS 0 AND THE LAST FORWARD CHAIN         */
*        /* IS 0. HENCE THE DITABE ENTRY WILL BE MADE BUT WITHOUT    */
*        /* A CONNECTOR TO A CITABE.                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0667
*        IF PTCITCUR->CITTYPE = ALIASID & CITCIN = 0 THEN;         0667
@RC00664 DS    0H                                                  0667
@RF00663 L     @07,RSPTWKC(,REG6)                                  0667
         L     @07,PTCITCUR(,@07)                                  0667
         CLI   CITTYPE(@07),C'X'                                   0667
         BNE   @RF00667                                            0667
         L     @07,CITCIN+47(,REG6)                                0667
         LA    @07,0(,@07)                                         0667
         LTR   @07,@07                                             0667
         BZ    @RT00667                                            0667
*                                      /*IGNORE 0 CIN IN ALIAS RECORD *
*                                                                  0669
*        /************************************************************/
*        /*                                                          */
*        /* TRY TO LOCATE AN EXISTING CI TABLE ENTRY FOR             */
*        /* THIS CIN.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0669
*        ELSE                                                      0669
*          DO;                                                     0669
@RF00667 DS    0H                                                  0670
*            RSTANCHR = ADDR(RSGCITS);                             0670
         LA    @07,RSGCITS(,REG6)                                  0670
         ST    @07,RSTANCHR(,REG6)                                 0670
*            PTF1HIT = OFF;            /*INIT NOT FOUND              */
*                                                                  0671
         L     @07,RSPTWKC(,REG6)                                  0671
         NI    PTF1HIT(@07),B'01111111'                            0671
*            DO RSTENTIX = PTCITI TO PTCITL WHILE(PTF1HIT=OFF);    0672
         L     @07,PTCITI-1(,@07)                                  0672
         LA    @07,0(,@07)                                         0672
         B     @DE00672                                            0672
@DL00672 L     @07,RSPTWKC(,REG6)                                  0672
         TM    PTF1HIT(@07),B'10000000'                            0672
         BNZ   @DC00672                                            0672
*                                      /*SEARCH FOR EXISTING CITABE  */
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;       /*GET CITABE                  */
         L     @15,@CV03436                                        0673
         BALR  @14,@15                                             0673
*              IF RSTENTAD->CITCIN = CITCIN THEN /*EXISTING ENTRY    */
         L     @07,RSTENTAD(,REG6)                                 0674
         CLC   CITCIN(3,@07),CITCIN+48(REG6)                       0674
         BNE   @RF00674                                            0674
*                PTF1HIT = ON;                                     0675
         L     @07,RSPTWKC(,REG6)                                  0675
         OI    PTF1HIT(@07),B'10000000'                            0675
*            END;                                                  0676
*                                                                  0676
@RF00674 LA    @07,1                                               0676
         L     @04,RSTENTIX-1(,REG6)                               0676
         LA    @04,0(,@04)                                         0676
         ALR   @07,@04                                             0676
@DE00672 STCM  @07,7,RSTENTIX(REG6)                                0676
         L     @04,RSPTWKC(,REG6)                                  0676
         L     @04,PTCITL-1(,@04)                                  0676
         LA    @04,0(,@04)                                         0676
         CR    @07,@04                                             0676
         BNH   @DL00672                                            0676
@DC00672 DS    0H                                                  0677
*        /************************************************************/
*        /*                                                          */
*        /* IF CI TABLE ENTRY NOT FOUND THEN CREATE A NEW ONE        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0677
*            IF PTF1HIT = OFF THEN                                 0677
         L     @07,RSPTWKC(,REG6)                                  0677
         TM    PTF1HIT(@07),B'10000000'                            0677
         BNZ   @RF00677                                            0677
*              DO;                                                 0678
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETFIT      */
*                CALL GETFIT;       /*GET NEW CITABE              */
         L     @15,@CV03435                                        0679
         BALR  @14,@15                                             0679
*                RSTENTAD->CITABE = CITABE; /*MOVE IN NEW ENTRY      */
         L     @07,RSTENTAD(,REG6)                                 0680
         MVC   CITABE(20,@07),CITABE+48(REG6)                      0680
*                PTCITL = RSGCITNU;    /*SET LAST CITABE             */
         L     @04,RSPTWKC(,REG6)                                  0681
         MVC   PTCITL(3,@04),RSGCITNU(REG6)                        0681
*                DITCITAB = RSGCITNU;  /*HOOK DITABE TO CITABE       */
*                                                                  0682
         L     @04,PTDITCUR(,@04)                                  0682
         MVC   DITCITAB(3,@04),RSGCITNU(REG6)                      0682
*        /************************************************************/
*        /*                                                          */
*        /* IF EXTENSION RECORD THEN FORWARD CHAIN FROM              */
*        /* THE BASE RECORD TO THIS ONE - THE CHAIN IS A             */
*        /* FORWARD CHAIN THROUGH ALL THE EXTENSION RECORDS          */
*        /* FOR THIS BASE.                                           */
*        /* ALSO POINT THE EXTENSION TO THE BASE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0683
*                IF RSTENTAD->CITTYPE = VOLEXTID                  0683
*                  RSTENTAD->CITTYPE = CATEXTID THEN               0683
         CLI   CITTYPE(@07),C'W'                                   0683
         BE    @RT00683                                            0683
         CLI   CITTYPE(@07),C'E'                                   0683
         BNE   @RF00683                                            0683
@RT00683 DS    0H                                                  0684
*                  DO;                                             0684
*                    IF PTCITCUR->CITEXTBA = 0 THEN                0685
         L     @07,RSPTWKC(,REG6)                                  0685
         L     @04,PTCITCUR(,@07)                                  0685
         L     @04,CITEXTBA-1(,@04)                                0685
         LA    @04,0(,@04)                                         0685
         LTR   @04,@04                                             0685
         BNZ   @RF00685                                            0685
*                                      /*CURRENT CI IS THE BASE      */
*                      RSTENTAD->CITEXTBA = PTCITNC;               0686
         L     @04,RSTENTAD(,REG6)                                 0686
         MVC   CITEXTBA(3,@04),PTCITNC(@07)                        0686
*                    ELSE              /*BORROW BASE FROM EXTENSION  */
*                      RSTENTAD->CITEXTBA = PTCITCUR->CITEXTBA;    0687
*                                                                  0687
         B     @RC00685                                            0687
@RF00685 L     @07,RSTENTAD(,REG6)                                 0687
         L     @04,RSPTWKC(,REG6)                                  0687
         L     @04,PTCITCUR(,@04)                                  0687
         MVC   CITEXTBA(3,@07),CITEXTBA(@04)                       0687
*                    PTCITWK = PTCITCUR; /*POINT TO CURRENT CIT      */
@RC00685 L     @07,RSPTWKC(,REG6)                                  0688
         L     @04,PTCITCUR(,@07)                                  0688
         ST    @04,PTCITWK(,@07)                                   0688
*                    DO WHILE (PTCITWK->CITEXTCH ^= 0);            0689
         B     @DE00689                                            0689
@DL00689 DS    0H                                                  0690
*                      RSTENTIX = PTCITWK->CITEXTCH;               0690
         L     @07,RSPTWKC(,REG6)                                  0690
         L     @07,PTCITWK(,@07)                                   0690
         MVC   RSTENTIX(3,REG6),CITEXTCH(@07)                      0690
*                                      /*GET EXTENSION INDEX         */
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE
*                                                                    */
*                      CALL GETNEXTE;                              0691
         L     @15,@CV03436                                        0691
         BALR  @14,@15                                             0691
*                      PTCITWK = RSTENTAD;                         0692
         L     @07,RSPTWKC(,REG6)                                  0692
         L     @04,RSTENTAD(,REG6)                                 0692
         ST    @04,PTCITWK(,@07)                                   0692
*                                      /*EXTENSION CITABE            */
*                    END;                                          0693
@DE00689 L     @07,RSPTWKC(,REG6)                                  0693
         L     @07,PTCITWK(,@07)                                   0693
         L     @04,CITEXTCH-1(,@07)                                0693
         LA    @04,0(,@04)                                         0693
         LTR   @04,@04                                             0693
         BNZ   @DL00689                                            0693
*                    PTCITWK->CITEXTCH = RSGCITNU; /*ADD EXT TO CHAIN*/
         MVC   CITEXTCH(3,@07),RSGCITNU(REG6)                      0694
*                  END;                                            0695
*                                                                  0695
*              END;                                                0696
*                                                                  0696
*        /************************************************************/
*        /*                                                          */
*        /* HOOK DISPLACEMENT TABLE ENTRY INTO CI TABLE ENTRY        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0697
*            ELSE                                                  0697
*              DITCITAB = RSTENTIX - 1; /*HOOK TO PREV CITABE        */
*                                                                  0697
         B     @RC00677                                            0697
@RF00677 L     @07,RSPTWKC(,REG6)                                  0697
         L     @07,PTDITCUR(,@07)                                  0697
         L     @04,RSTENTIX-1(,REG6)                               0697
         LA    @04,0(,@04)                                         0697
         BCTR  @04,0                                               0697
         STCM  @04,7,DITCITAB(@07)                                 0697
*          END;                                                    0698
*                                                                  0698
@RC00677 DS    0H                                                  0699
*        IF GDTDBG = NULLPTR                                       0699
*          THEN;                                                   0699
@RT00667 L     @07,GDTDBG(,REG5)                                   0699
         LTR   @07,@07                                             0699
         BZ    @RT00699                                            0699
*          ELSE                                                    0701
*            CALL IDCDB010(GDTTBL,'RSP4');                         0701
         ST    REG5,@AL00001                                       0701
         LA    @07,@CC03778                                        0701
         ST    @07,@AL00001+4                                      0701
         MVI   @AL00001+4,X'80'                                    0701
         L     @15,GDTDBG(,REG5)                                   0701
         LA    @01,@AL00001                                        0701
         BALR  @14,@15                                             0701
*        RFY CITABE;                   /*REVERT                      */
@RT00699 DS    0H                                                  0703
*        RFY DITABE;                   /*REVERT                      */
*  CALL EXIT;  /*TERMINATE*/                                       0704
         BAL   @14,EXIT                                            0704
*  END PROCCI; /*END OF PROCEDURE*/                                0705
@EL00005 DS    0H                                                  0705
@EF00005 DS    0H                                                  0705
@ER00005 BR    @14                                                 0705
@PB00005 DS    0H                                                  0706
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - PROCTYPE                                        */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    PROCTYPE PROCESSES A SET OF RECORDS; THIS IS THE PRINCIPAL    */
*/*    DRIVER OF ASSOCIATION CHECKING ON A SET OF RECORDS. FIRST     */
*/*    RECORDS ARE SCANNED FOR CONTROL INTERVAL NUMBERS (CINS),      */
*/*    TO DETERMINE WHICH OTHER RECORDS ARE MEMBERS OF THIS          */
*/*    SET AND TO DETERMINE WHERE, WITHIN THE SET OF RECORDS,        */
*/*    CINS EXIST. VERCI IS CALLED TO VERIFY ASSOCIATIONS AND        */
*/*    DETERMINE SUBSET OF RECORDS PROCESSING. SETCI WILL UPDATE     */
*/*    ALL CINS IN A SET OF RECORDS, WHICH HAVE BEEN REASSIGNED OR   */
*/*    ARE INVALID. FINALLY, VERDSDIR IS CALLED FOR CLUSTER AND      */
*/*    ALTERNATEINDEXES, TO VERIFY DATA SET DIRECTORY ENTRIES        */
*/*    (DSDIRS).                                                     */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    GRABCURR - CONTAINS THE ADDRESS OF THE CURRENT RAB WHICH      */
*/*               HAS THE BASE RECORD IN THE BUFFER                  */
*/*    RSASSTBL - CONTAINS THE ADDRESS OF THE ASSOCIATION TABLE      */
*/*               FOR THIS SET OF RECORDS.                           */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    NONE.                                                         */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0706
         DS    0F
NAME0052 DC    CL8'PROCTYPE'
*PROCTYPE: PROCEDURE                                               0707
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0707
*                                                                  0707
         B     @PB00006                                            0707
PROCTYPE DS    0H                                                  0708
*      GENERATE REFS(RS02RG08, REG6);                              0708
*                                                                  0708
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY PROCTYPE  ENTRY POINT
         LM    @08,@12,RS02RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0052  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      0709
         L     @07,GDTTR2(,REG5)                                   0709
         MVC   @TS00001(95),NEWERID2(@07)                          0709
         MVC   OLDERID2(95,@07),@TS00001                           0709
*        NEWID2 = 'RSPT';                                          0710
*                                                                  0710
         MVC   NEWID2(4,@07),@CC03774                              0710
*        /************************************************************/
*        /*                                                          */
*        /* GET A WORK AREA FOR THIS RECURSION                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0711
*        RSTANCHR = ADDR(RSPSTACK);    /*PTWORK STACK                */
         LA    @07,RSPSTACK(,REG6)                                 0711
         ST    @07,RSTANCHR(,REG6)                                 0711
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETTAB              */
*        CALL GETTAB;                                              0712
         L     @15,@CV03437                                        0712
         BALR  @14,@15                                             0712
*        PTYPEDTA = PTYPEDTA && PTYPEDTA; /*CLEAR PTWORK             */
*                                                                  0713
         L     @07,RSPTWKC(,REG6)                                  0713
         XC    PTYPEDTA(192,@07),PTYPEDTA(@07)                     0713
*        /************************************************************/
*        /*                                                          */
*        /* SAVE THE ASSOC TABLE AND BASE RECORD FOR THIS            */
*        /* RECURSION.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0714
*        PTASSOC = RSASSTBL;                                       0714
         L     @04,RSASSTBL(,REG6)                                 0714
         ST    @04,PTASSOC(,@07)                                   0714
*        RFY TASSO BASED(PTASSOC);                                 0715
*        PTBASE = ADDR(RABBUF);                                    0716
         L     @04,RSGRABCU(,REG6)                                 0716
         L     @04,GRABCURR(,@04)                                  0716
         LA    @15,RABBUF(,@04)                                    0716
         ST    @15,PTBASE(,@07)                                    0716
*        PTCRAVL = RCDCRAVL;           /*SAVE THE DEFAULT CRA VOLSER */
*                                                                  0717
         MVC   PTCRAVL(6,@07),RCDCRAVL+8(@04)                      0717
*        /************************************************************/
*        /*                                                          */
*        /* READ AND SCAN                                            */
*        /*     EACH RECORD MUST BE READ AND SCANNED FOR CINS,       */
*        /*     AS INDICATED IN THE ASSOCIATION TABLE. THE           */
*        /*     TABLE INDICATES BY RECORD TYPE WHETHER IT            */
*        /*     SHOULD BE READ AND SCANNED.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0718
*  READSCAN:                                                       0718
*        DO PTCITNC = PTCITNC TO PTCITL;                           0718
READSCAN L     @07,RSPTWKC(,REG6)                                  0718
         L     @07,PTCITNC-1(,@07)                                 0718
         LA    @07,0(,@07)                                         0718
         B     @DE00718                                            0718
@DL00718 DS    0H                                                  0719
*                                      /*PROCESS EACH CITABLE ENTRY  */
*                                                                  0719
*        /************************************************************/
*        /*                                                          */
*        /*     THE FIRST RECORD ALREADY EXISTS IN THE CURRENT RAB   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0719
*          PTASSCUR = ADDR(TASSEN(1)); /*DEFAULT TO FIRST SUBTYPE    */
         L     @07,RSPTWKC(,REG6)                                  0719
         L     @04,PTASSOC(,@07)                                   0719
         LA    @04,TASSEN(,@04)                                    0719
         ST    @04,PTASSCUR(,@07)                                  0719
*          IF PTCITCUR = 0 THEN;                                   0720
*                                                                  0720
         L     @07,PTCITCUR(,@07)                                  0720
         LTR   @07,@07                                             0720
         BZ    @RT00720                                            0720
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK TO SEE IF THE NEXT CITABLE ENTRY SHOULD        */
*        /*     BE READ.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0722
*          ELSE                                                    0722
*            DO;                                                   0722
*              RSTANCHR = ADDR(RSGCITS);                           0723
         LA    @07,RSGCITS(,REG6)                                  0723
         ST    @07,RSTANCHR(,REG6)                                 0723
*              RSTENTIX = PTCITNC;     /*ENTRY INDEX                 */
         L     @07,RSPTWKC(,REG6)                                  0724
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       0724
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      0725
         L     @15,@CV03436                                        0725
         BALR  @14,@15                                             0725
*              PTCITCUR = RSTENTAD;                                0726
         L     @07,RSPTWKC(,REG6)                                  0726
         L     @04,RSTENTAD(,REG6)                                 0726
         ST    @04,PTCITCUR(,@07)                                  0726
*                                      /*GET THE NEXT CITAB ENTRY    */
*                                                                  0727
*        /************************************************************/
*        /*                                                          */
*        /*       SEARCH FOR THE ASSOCIATION TABLE ENTRY             */
*        /*       FOR THIS RECORD TYPE BEING PROCESSED               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0727
*              PTASSCUR = PTASSCUR + LENGTH(TASSENT);              0727
         LA    @04,4                                               0727
         AL    @04,PTASSCUR(,@07)                                  0727
         ST    @04,PTASSCUR(,@07)                                  0727
*                                      /*ADDRESS OF FIRST SUBTYPE    */
*              DO PTINDX1 = 2 TO TASSNENT                          0728
*                WHILE(TASSTYPE ^= CITTYPE);                       0728
         LA    @07,2                                               0728
         B     @DE00728                                            0728
@DL00728 L     @07,RSPTWKC(,REG6)                                  0728
         L     @04,PTASSCUR(,@07)                                  0728
         L     @01,PTCITCUR(,@07)                                  0728
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        0728
         BE    @DC00728                                            0728
*                PTASSCUR = PTASSCUR + LENGTH(TASSEN);             0729
         AL    @04,@CF00038                                        0729
         ST    @04,PTASSCUR(,@07)                                  0729
*                                      /*ADDRESS OF NEXT ASSOC ENT   */
*              END;                                                0730
         L     @04,RSPTWKC(,REG6)                                  0730
         LA    @07,1                                               0730
         AH    @07,PTINDX1(,@04)                                   0730
@DE00728 L     @04,RSPTWKC(,REG6)                                  0730
         STH   @07,PTINDX1(,@04)                                   0730
         L     @04,RSPTWKC(,REG6)                                  0730
         L     @04,PTASSOC(,@04)                                   0730
         CH    @07,TASSNENT(,@04)                                  0730
         BNH   @DL00728                                            0730
@DC00728 DS    0H                                                  0731
*              IF PTINDX1 > TASSNENT THEN                          0731
         L     @07,RSPTWKC(,REG6)                                  0731
         L     @04,PTASSOC(,@07)                                   0731
         LH    @15,PTINDX1(,@07)                                   0731
         CH    @15,TASSNENT(,@04)                                  0731
         BNH   @RF00731                                            0731
*                                      /*INV ASSOC IF TYPE NOT KNOWN */
*                CITFAINV = ON;                                    0732
         L     @07,PTCITCUR(,@07)                                  0732
         OI    CITFAINV(@07),B'00000010'                           0732
*        /************************************************************/
*        /*                                                          */
*        /*     READ                                                 */
*        /*       CHECK TO SEE IF THIS ENTRY TYPE IS TO BE READ.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0733
*  READCIT:                                                        0733
*              IF CITFAINV=OFF & TASSREAD=ON THEN                  0733
@RF00731 DS    0H                                                  0733
READCIT  L     @07,RSPTWKC(,REG6)                                  0733
         L     @04,PTCITCUR(,@07)                                  0733
         TM    CITFAINV(@04),B'00000010'                           0733
         BNZ   @RF00733                                            0733
         L     @04,PTASSCUR(,@07)                                  0733
         TM    TASSREAD(@04),B'10000000'                           0733
         BNO   @RF00733                                            0733
*                DO;                                               0734
*                                                                  0734
*        /************************************************************/
*        /*                                                          */
*        /*       SCAN ALL PREVIOUS CI TABLES TO DETERMINE IF        */
*        /*       THIS RECORD HAS ALREADY BEEN READ AND SCANNED      */
*        /*       AT A HIGHER LEVEL. IF SO, THEN COPY THE ENTRY      */
*        /*       TO THIS TABLE AND USE IT.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0735
*                  RSTANCHR = ADDR(RSGCITS);                       0735
         LA    @04,RSGCITS(,REG6)                                  0735
         ST    @04,RSTANCHR(,REG6)                                 0735
*                  RSTENTIX = 0;       /*ORIENT TO FIRST ENTRY       */
         SLR   @04,@04                                             0736
         STCM  @04,7,RSTENTIX(REG6)                                0736
*                  PTF1HIT = OFF;      /*CLEAR FOUND INDR            */
         NI    PTF1HIT(@07),B'01111111'                            0737
*                  DO UNTIL(RSTENTAD=PTCITCUR  PTF1HIT=ON);       0738
@DL00738 DS    0H                                                  0739
*                                      /*SCAN UNTIL FND OR THIS ENTRY *
*                    RSTENTIX = RSTENTIX + 1; /*NEXT ENTRY           */
         LA    @07,1                                               0739
         L     @04,RSTENTIX-1(,REG6)                               0739
         LA    @04,0(,@04)                                         0739
         ALR   @07,@04                                             0739
         STCM  @07,7,RSTENTIX(REG6)                                0739
*                    /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE*/
*                    CALL GETNEXTE;                                0740
         L     @15,@CV03436                                        0740
         BALR  @14,@15                                             0740
*                                      /*GET THE NEXT CITABE         */
*                    IF RSTENTAD->CITCIN=PTCITCUR->CITCIN &        0741
*                      RSTENTAD->CITTYPE = PTCITCUR->CITTYPE &     0741
*                      RSTENTAD->CITFASCA=ON THEN                  0741
         L     @07,RSTENTAD(,REG6)                                 0741
         L     @04,RSPTWKC(,REG6)                                  0741
         L     @15,PTCITCUR(,@04)                                  0741
         CLC   CITCIN(3,@07),CITCIN(@15)                           0741
         BNE   @RF00741                                            0741
         CLC   CITTYPE(1,@07),CITTYPE(@15)                         0741
         BNE   @RF00741                                            0741
         TM    CITFASCA(@07),B'00000100'                           0741
         BNO   @RF00741                                            0741
*                                      /*CHK FOR CIN AND SCANNED     */
*                      DO;                                         0742
*                        PTF1HIT = ON; /*ENTRY ALREADY SCANNED       */
         OI    PTF1HIT(@04),B'10000000'                            0743
*                        PTCITCUR->CITABE=RSTENTAD->CITABE;        0744
         MVC   CITABE(20,@15),CITABE(@07)                          0744
*                                      /*COPY THE CITAB ENTRY        */
*                      END;                                        0745
*                  END;                                            0746
*                                                                  0746
@RF00741 DS    0H                                                  0746
@DE00738 L     @07,RSPTWKC(,REG6)                                  0746
         CLC   RSTENTAD(4,REG6),PTCITCUR(@07)                      0746
         BE    @DC00738                                            0746
         TM    PTF1HIT(@07),B'10000000'                            0746
         BNO   @DL00738                                            0746
@DC00738 DS    0H                                                  0747
*        /************************************************************/
*        /*                                                          */
*        /*       IF THE ENTRY SHOULD HAVE BEEN FOUND IN A HIGHER    */
*        /*       SCAN, THEN THE BASE RECORD CONTAINS AN INVALID     */
*        /*       ASSOCIATION TO THIS ENTRY.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0747
*                  IF TASSIS = ON THEN                             0747
         L     @07,RSPTWKC(,REG6)                                  0747
         L     @04,PTASSCUR(,@07)                                  0747
         TM    TASSIS(@04),B'00010000'                             0747
         BNO   @RF00747                                            0747
*                    IF PTF1HIT = OFF THEN                         0748
         TM    PTF1HIT(@07),B'10000000'                            0748
         BNZ   @RF00748                                            0748
*                      CITFAINV = ON;                              0749
         L     @07,PTCITCUR(,@07)                                  0749
         OI    CITFAINV(@07),B'00000010'                           0749
*                    ELSE;                                         0750
*                                                                  0750
@RF00748 DS    0H                                                  0751
*        /************************************************************/
*        /*                                                          */
*        /*           *******READ THE RECORD*******                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0751
*                  ELSE                                            0751
*                    DO;                                           0751
         B     @RC00747                                            0751
@RF00747 DS    0H                                                  0752
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */
*                                                                  0752
         L     @07,RSGRABCU(,REG6)                                 0752
         L     @04,RSPTWKC(,REG6)                                  0752
         L     @01,PTASSCUR(,@04)                                  0752
         LH    @15,TASSRAB(,@01)                                   0752
         SLA   @15,2                                               0752
         L     @15,RABARRAY-4(@15,@07)                             0752
         ST    @15,GRABCURR(,@07)                                  0752
*                      DO;                                         0753
*                        RSRTYPE = ''B;                            0754
         MVI   RSRTYPE(REG6),X'00'                                 0754
*                        RSRGET = ON;      /* GETRCD  */           0755
         OI    RSRGET(REG6),B'10000000'                            0755
*                        RSRUPD = ON;      /* UPDATE  */           0756
         OI    RSRUPD(REG6),B'00001000'                            0756
*                        RSRDS = ''B;                              0757
         NI    RSRDS(REG6),B'00011111'                             0757
*                        RSRWF = ON;       /* WORKFILE  */         0758
*                        RSRDIR = ON;      /* DIRECT  */           0759
*                        RSRKEY = ON;      /* KEY  */              0760
         OI    RSRWF(REG6),B'10010100'                             0760
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   0761
         OI    RSVIAFCR(REG6),B'10000000'                          0761
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       0762
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       0762
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     0763
*                                                                  0763
         L     @07,PTCITCUR(,@04)                                  0763
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        0763
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/
*                      CALL GETVIA;                                0764
         L     @15,@CV03442                                        0764
         BALR  @14,@15                                             0764
*                      END;                                        0765
*                                                                  0765
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE THE RECORD TYPE READ IS THE ONE EXPECTED. IF  */
*        /*     NOT, TREAT AS NO RECORD FOUND.                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0766
*                      IF RABNRF = OFF & RCDID ^= CITTYPE THEN     0766
         L     @07,RSGRABCU(,REG6)                                 0766
         L     @07,GRABCURR(,@07)                                  0766
         TM    RABNRF(@07),B'00000010'                             0766
         BNZ   @RF00766                                            0766
         L     @04,RSPTWKC(,REG6)                                  0766
         L     @04,PTCITCUR(,@04)                                  0766
         CLC   RCDID+8(1,@07),CITTYPE(@04)                         0766
         BE    @RF00766                                            0766
*                        RABNRF = ON;                              0767
*                                                                  0767
         OI    RABNRF(@07),B'00000010'                             0767
*        /************************************************************/
*        /*                                                          */
*        /*       IF THE RECORD WAS NOT FOUND MARK AS INVALID.       */
*        /*       IF THE RECORD IS AN EXTENSION RECORD, ISSUE        */
*        /*       MESSAGE IDC21022I.                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0768
*                      IF RABNRF = ON THEN                         0768
@RF00766 L     @07,RSGRABCU(,REG6)                                 0768
         L     @07,GRABCURR(,@07)                                  0768
         TM    RABNRF(@07),B'00000010'                             0768
         BNO   @RF00768                                            0768
*                        DO;                                       0769
*                          RABNRF = OFF; /*RESET NO RECORD FOUND     */
         NI    RABNRF(@07),B'11111101'                             0770
*                          CITFAINV = ON; /*INVALID                  */
         L     @07,RSPTWKC(,REG6)                                  0771
         L     @07,PTCITCUR(,@07)                                  0771
         OI    CITFAINV(@07),B'00000010'                           0771
*                          IF CITTYPE = CATEXTID                  0772
*                           CITTYPE = VOLEXTID THEN                0772
         CLI   CITTYPE(@07),C'E'                                   0772
         BE    @RT00772                                            0772
         CLI   CITTYPE(@07),C'W'                                   0772
         BNE   @RF00772                                            0772
@RT00772 DS    0H                                                  0773
*                            IF TASSID = VOLID THEN                0773
*                                                                  0773
         L     @07,RSPTWKC(,REG6)                                  0773
         L     @04,PTASSOC(,@07)                                   0773
         CLI   TASSID(@04),C'V'                                    0773
         BNE   @RF00773                                            0773
*                              DO;                                 0774
*                              /*CALL CKERR*/                      0775
*                                RSCKERR = RSCKERR && RSCKERR;     0775
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0775
*                                RSCKERN = RSE063;                 0776
         MVC   RSCKERN(2,REG6),@CH01010                            0776
*                                RSCKTERM = 'RETU';                0777
         MVC   RSCKTERM(4,REG6),@CC03787                           0777
*                                RSCKMVAR(1) = ADDR(PTBASE->CNAME);
         L     @04,PTBASE(,@07)                                    0778
         LA    @15,CNAME(,@04)                                     0778
         ST    @15,RSCKMVAR(,REG6)                                 0778
*                                RSCKMVAR(2) = ADDR(PTBASE->RCDID);
         LA    @04,RCDID(,@04)                                     0779
         ST    @04,RSCKMVAR+4(,REG6)                               0779
*                                RSCKMVAR(3) = ADDR(CITCIN);       0780
         L     @07,PTCITCUR(,@07)                                  0780
         LA    @04,CITCIN(,@07)                                    0780
         ST    @04,RSCKMVAR+8(,REG6)                               0780
*                                RSCKMVAR(4) = ADDR(CITTYPE);      0781
*                                                                  0781
         LA    @07,CITTYPE(,@07)                                   0781
         ST    @07,RSCKMVAR+12(,REG6)                              0781
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*KERR                                                                */
*                              CALL CKERR;                         0782
         L     @15,@CV03449                                        0782
         BALR  @14,@15                                             0782
*                              END;                                0783
*                            ELSE                                  0784
*                              IF TASSID = UPGID THEN              0784
*                                                                  0784
         B     @RC00773                                            0784
@RF00773 L     @07,RSPTWKC(,REG6)                                  0784
         L     @04,PTASSOC(,@07)                                   0784
         CLI   TASSID(@04),C'Y'                                    0784
         BNE   @RF00784                                            0784
*                                DO;                               0785
*                                /*CALL CKERR*/                    0786
*                                  RSCKERR = RSCKERR && RSCKERR;   0786
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0786
*                                  RSCKERN = RSE025;               0787
         MVC   RSCKERN(2,REG6),@CH00940                            0787
*                                  RSCKTERM = 'RETU';              0788
         MVC   RSCKTERM(4,REG6),@CC03787                           0788
*                                  RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RA
*BUF)->CNAME);                                                     0789
         L     @04,RSGRABCU(,REG6)                                 0789
         L     @04,GRABRAB5(,@04)                                  0789
         LA    @04,CNAME+8(,@04)                                   0789
         ST    @04,RSCKMVAR(,REG6)                                 0789
*                                  RSCKMVAR(2) = ADDR(PTBASE->RCDID);
         L     @04,PTBASE(,@07)                                    0790
         LA    @04,RCDID(,@04)                                     0790
         ST    @04,RSCKMVAR+4(,REG6)                               0790
*                                  RSCKMVAR(3) = ADDR(CITCIN);     0791
         L     @07,PTCITCUR(,@07)                                  0791
         LA    @04,CITCIN(,@07)                                    0791
         ST    @04,RSCKMVAR+8(,REG6)                               0791
*                                  RSCKMVAR(4) = ADDR(CITTYPE);    0792
*                                                                  0792
         LA    @07,CITTYPE(,@07)                                   0792
         ST    @07,RSCKMVAR+12(,REG6)                              0792
*                                /* CALL TO MODULE IDCRS05 FOR PROCEDUR
* CKERR                                                              */
*                                CALL CKERR;                       0793
         L     @15,@CV03449                                        0793
         BALR  @14,@15                                             0793
*                                END;                              0794
*                               ELSE                               0795
*                                                                  0795
*                                 DO;                              0795
         B     @RC00784                                            0795
@RF00784 DS    0H                                                  0796
*                                 /*CALL CKERR*/                   0796
*                                   RSCKERR = RSCKERR && RSCKERR;  0796
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0796
*                                   RSCKERN = RSE025;              0797
         MVC   RSCKERN(2,REG6),@CH00940                            0797
*                                   RSCKTERM = 'RETU';             0798
         MVC   RSCKTERM(4,REG6),@CC03787                           0798
*                                   RSCKMVAR(1) = ADDR(PTBASE->CNAME);
         L     @07,RSPTWKC(,REG6)                                  0799
         L     @04,PTBASE(,@07)                                    0799
         LA    @15,CNAME(,@04)                                     0799
         ST    @15,RSCKMVAR(,REG6)                                 0799
*                                   RSCKMVAR(2) = ADDR(PTBASE->RCDID);
         LA    @04,RCDID(,@04)                                     0800
         ST    @04,RSCKMVAR+4(,REG6)                               0800
*                                   RSCKMVAR(3) = ADDR(CITCIN);    0801
         L     @07,PTCITCUR(,@07)                                  0801
         LA    @04,CITCIN(,@07)                                    0801
         ST    @04,RSCKMVAR+8(,REG6)                               0801
*                                   RSCKMVAR(4) = ADDR(CITTYPE);   0802
*                                                                  0802
         LA    @07,CITTYPE(,@07)                                   0802
         ST    @07,RSCKMVAR+12(,REG6)                              0802
*                                 /* CALL TO MODULE IDCRS05 FOR PROCEDU
*E CKERR                                                             */
*                                 CALL CKERR;                      0803
         L     @15,@CV03449                                        0803
         BALR  @14,@15                                             0803
*                                 END;                             0804
*                        END;                                      0805
*        /************************************************************/
*        /*                                                          */
*        /*     IF RECORD FOUND, INDICATE WHETHER IT WAS REASSIGNED  */
*        /*                                                          */
*        /************************************************************/
*                      ELSE                                        0806
*                        IF RSWRASCI = ON THEN                     0806
         B     @RC00768                                            0806
@RF00768 L     @07,RSGRABCU(,REG6)                                 0806
         L     @07,GRABCURR(,@07)                                  0806
         TM    RSWRASCI(@07),B'00000100'                           0806
         BNO   @RF00806                                            0806
*                          DO;                                     0807
*                            CITFARAS = ON;                        0808
         L     @04,RSPTWKC(,REG6)                                  0808
         L     @04,PTCITCUR(,@04)                                  0808
         OI    CITFARAS(@04),B'00100000'                           0808
*                            CITRCIN = RABRCDA; /*NEW CIN            */
         MVC   CITRCIN(3,@04),RABRCDA+1(@07)                       0809
*                          END;                                    0810
*                                                                  0810
*                    END;                                          0811
@RF00806 DS    0H                                                  0811
@RC00768 DS    0H                                                  0812
*                END;                                              0812
@RC00747 DS    0H                                                  0813
*              END;                    /*END OF READCIT              */
@RF00733 DS    0H                                                  0814
*        /************************************************************/
*        /*                                                          */
*        /*     SCAN                                                 */
*        /*       IF SCAN INDICATED AND NOT ALREADY DONE THEN        */
*        /*       SCAN THE RECORD FOR CINS.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0814
*  SCANCIT:                                                        0814
*          IF PTCITCUR=0                                          0814
*            (CITFAINV=OFF & CITFASCA=OFF & TASSSCAN = ON) THEN    0814
@RT00720 DS    0H                                                  0814
SCANCIT  L     @07,RSPTWKC(,REG6)                                  0814
         L     @04,PTCITCUR(,@07)                                  0814
         LTR   @04,@04                                             0814
         BZ    @RT00814                                            0814
         TM    CITFAINV(@04),B'00000110'                           0814
         BNZ   @RF00814                                            0814
         L     @07,PTASSCUR(,@07)                                  0814
         TM    TASSSCAN(@07),B'01000000'                           0814
         BNO   @RF00814                                            0814
@RT00814 DS    0H                                                  0815
*            DO;                                                   0815
*              CALL SCANCI;                                        0816
         BAL   @14,SCANCI                                          0816
*              CITFASCA = ON;          /*INDICATE SCAN COMPLETE      */
         L     @07,RSPTWKC(,REG6)                                  0817
         L     @07,PTCITCUR(,@07)                                  0817
         OI    CITFASCA(@07),B'00000100'                           0817
*            END;                                                  0818
*                                                                  0818
*        END READSCAN;                                             0819
@RF00814 L     @04,RSPTWKC(,REG6)                                  0819
         LA    @07,1                                               0819
         L     @04,PTCITNC-1(,@04)                                 0819
         LA    @04,0(,@04)                                         0819
         ALR   @07,@04                                             0819
         L     @04,RSPTWKC(,REG6)                                  0819
         STCM  @07,7,PTCITNC(@04)                                  0819
@DE00718 L     @04,RSPTWKC(,REG6)                                  0819
         L     @04,PTCITL-1(,@04)                                  0819
         LA    @04,0(,@04)                                         0819
         CR    @07,@04                                             0819
         BNH   @DL00718                                            0819
*        /************************************************************/
*        /*                                                          */
*        /* THE CI TABLE NOW REFLECTS ALL CINS FOR THIS SET OF       */
*        /* RECORDS. THE DI TABLE DESCRIBES THE CINS INSIDE EACH     */
*        /* RECORD. CALL VERCI TO VERIFY EACH RECORD TYPE. VERCI     */
*        /* IS SENSITIVE TO EACH RECORD'S SUBSETS AND CONTROLS THE   */
*        /* CHECKING OF EACH SUBSET FOR PROPER ASSOCIATIONS AND      */
*        /* ADEQUATE BASE RECORDS TO PERMIT THE ENTRY TO EXIST       */
*        /* IN THE CATALOG.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0820
*        IF ADDR(PTASSOC->TASSEN(1))->TASSVER=ON THEN              0820
         L     @07,RSPTWKC(,REG6)                                  0820
         L     @07,PTASSOC(,@07)                                   0820
         LA    @07,TASSEN(,@07)                                    0820
         TM    TASSVER(@07),B'00100000'                            0820
         BNO   @RF00820                                            0820
*                                      /*IF THIS SHOULD BE VERIFIED  */
*          CALL VERCI;                                             0821
*                                                                  0821
         BAL   @14,VERCI                                           0821
*        RSASSTBL = PTASSOC;           /*RESTORE ASSOC TABLE ADDR    */
*                                                                  0822
@RF00820 L     @07,RSPTWKC(,REG6)                                  0822
         L     @07,PTASSOC(,@07)                                   0822
         ST    @07,RSASSTBL(,REG6)                                 0822
*        /************************************************************/
*        /*                                                          */
*        /* THE SET OF RECORDS BEING VERIFIED MAY REFERENCE          */
*        /* REASSIGNED OR INVALID CINS. SETCI WILL UPDATE OR DELETE  */
*        /* THESE CINS. FURTHER, SETCI WILL MARK ALL PREVIOUS        */
*        /* CI TABLES WITH THE RESULTS FOR COMMON ENTRIES. SETCI     */
*        /* IS THE ONE WHO INDICATES IN THE WORKFILE RECORDS THAT    */
*        /* THE RECORD HAS PASSED ASSOCIATION CHECKING.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0823
*        IF ADDR(PTASSOC->TASSEN(1))->TASSVER=ON THEN              0823
         LA    @07,TASSEN(,@07)                                    0823
         TM    TASSVER(@07),B'00100000'                            0823
         BNO   @RF00823                                            0823
*          CALL SETCI;                                             0824
*                                                                  0824
         BAL   @14,SETCI                                           0824
*        /************************************************************/
*        /*                                                          */
*        /* FOR NON-RESET CLUSTERS AND ALTERNATEINDEXES,             */
*        /* PROCTYPE SCANNED FOR CINS AND READ THE CLUSTER, OR       */
*        /* AIX AND THE DATA AND INDEX.                              */
*        /*                                                          */
*        /* BOTH RESET AND NON-RESET CLUSTER AND AIXS ARE CHECKED AT */
*        /* THIS POINT FOR SPACE CLAIMS. NONRESET ENTRIES ARE        */
*        /* CHECKED FOR EACH RESET VOLUME THAT THEY CLAIM SPACE ON   */
*        /* TO ENSURE THAT A CORRESPONDING DSDIR EXISTS. RESET       */
*        /* ENTRIES ARE CHECKED FOR ALL VOLUMES THAT THEY CLAIM      */
*        /* SPACE ON TO ENSURE THAT A CORRESPONDING DSDIR EXISTS.    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0825
*        IF (PTCITF->CITFAVER=ON & (TASSID=CLID  TASSID=AIXID))  0825
*         (TASSID=CLNR  TASSID=AIXNR) THEN                        0825
@RF00823 L     @07,RSPTWKC(,REG6)                                  0825
         L     @04,PTCITF(,@07)                                    0825
         TM    CITFAVER(@04),B'01000000'                           0825
         BNO   @GL00024                                            0825
         L     @07,PTASSOC(,@07)                                   0825
         CLI   TASSID(@07),C'C'                                    0825
         BE    @RT00825                                            0825
         CLI   TASSID(@07),C'G'                                    0825
         BE    @RT00825                                            0825
@GL00024 L     @07,RSPTWKC(,REG6)                                  0825
         L     @07,PTASSOC(,@07)                                   0825
         CLI   TASSID(@07),C'1'                                    0825
         BE    @RT00825                                            0825
         CLI   TASSID(@07),C'2'                                    0825
         BNE   @RF00825                                            0825
@RT00825 DS    0H                                                  0826
*          CALL VERDSDIR;                                          0826
         BAL   @14,VERDSDIR                                        0826
*        /************************************************************/
*        /*                                                          */
*        /* DUMP AFTER PROCESSING A SET OF RECORDS                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0827
*          IF GDTDBG = NULLPTR                                     0827
*            THEN;                                                 0827
@RF00825 L     @07,GDTDBG(,REG5)                                   0827
         LTR   @07,@07                                             0827
         BZ    @RT00827                                            0827
*            ELSE                                                  0829
*              CALL IDCDB010(GDTTBL,'RSP3');                       0829
*                                                                  0829
         ST    REG5,@AL00001                                       0829
         LA    @07,@CC03794                                        0829
         ST    @07,@AL00001+4                                      0829
         MVI   @AL00001+4,X'80'                                    0829
         L     @15,GDTDBG(,REG5)                                   0829
         LA    @01,@AL00001                                        0829
         BALR  @14,@15                                             0829
*        /************************************************************/
*        /*                                                          */
*        /* FREE THE RESOURCES USED ON THIS RECURSION.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0830
*        RSTANCHR = ADDR(RSGCITS);     /*GCITS                       */
@RT00827 LA    @07,RSGCITS(,REG6)                                  0830
         ST    @07,RSTANCHR(,REG6)                                 0830
*        RSTENTIX = PTCITI - 1;        /*PREVIOUS LAST ENTRY         */
         L     @07,RSPTWKC(,REG6)                                  0831
         L     @07,PTCITI-1(,@07)                                  0831
         LA    @07,0(,@07)                                         0831
         BCTR  @07,0                                               0831
         STCM  @07,7,RSTENTIX(REG6)                                0831
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE            */
*        CALL GETNEXTE;                                            0832
         L     @15,@CV03436                                        0832
         BALR  @14,@15                                             0832
*                                      /*GET THE GCIT                */
*        TABC = RSTABAD;               /*RESET CURRENT TABLE         */
         L     @07,RSTANCHR(,REG6)                                 0833
         L     @04,RSTABAD(,REG6)                                  0833
         ST    @04,TABC(,@07)                                      0833
*        TABCURR = RSTWKIX;            /*RESET LAST ALLOC ENTRY      */
         L     @07,RSTWKIX-1(,REG6)                                0834
         LA    @07,0(,@07)                                         0834
         STH   @07,TABCURR(,@04)                                   0834
*        RSGCITNU = PTCITI - 1;        /*RESET NUM ENTRIES USED      */
*                                                                  0835
         L     @07,RSPTWKC(,REG6)                                  0835
         L     @04,PTCITI-1(,@07)                                  0835
         LA    @04,0(,@04)                                         0835
         BCTR  @04,0                                               0835
         STCM  @04,7,RSGCITNU(REG6)                                0835
*        IF PTDITI ^= 0 THEN           /*FREE GDIT IF GOTTEN         */
         L     @07,PTDITI-1(,@07)                                  0836
         LA    @07,0(,@07)                                         0836
         LTR   @07,@07                                             0836
         BZ    @RF00836                                            0836
*          DO;                                                     0837
*            RSTANCHR = ADDR(RSGDITS); /*GDITS                       */
         LA    @04,RSGDITS(,REG6)                                  0838
         ST    @04,RSTANCHR(,REG6)                                 0838
*            RSTENTIX = PTDITI - 1;    /*PREVIOUS LAST ENTRY         */
         BCTR  @07,0                                               0839
         STCM  @07,7,RSTENTIX(REG6)                                0839
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE        */
*            CALL GETNEXTE;                                        0840
         L     @15,@CV03436                                        0840
         BALR  @14,@15                                             0840
*                                      /*GET THE GDIT                */
*            TABC = RSTABAD;           /*RESET CURRENT TABLE         */
         L     @07,RSTANCHR(,REG6)                                 0841
         L     @04,RSTABAD(,REG6)                                  0841
         ST    @04,TABC(,@07)                                      0841
*            TABCURR = RSTWKIX;        /*RESET LAST ALLOC ENTRY      */
         L     @07,RSTWKIX-1(,REG6)                                0842
         LA    @07,0(,@07)                                         0842
         STH   @07,TABCURR(,@04)                                   0842
*            RSGDITNU = PTDITI - 1;    /*RESET NUM ENTRIES USED      */
         L     @07,RSPTWKC(,REG6)                                  0843
         L     @07,PTDITI-1(,@07)                                  0843
         LA    @07,0(,@07)                                         0843
         BCTR  @07,0                                               0843
         STCM  @07,7,RSGDITNU(REG6)                                0843
*          END;                                                    0844
*                                                                  0844
*        RSPTWKC = RSPTWKC->TABBACKW;  /*RETURN PTWORK               */
*                                                                  0845
@RF00836 L     @07,RSPTWKC(,REG6)                                  0845
         L     @07,TABBACKW(,@07)                                  0845
         ST    @07,RSPTWKC(,REG6)                                  0845
*        RFY TASSO;                    /*REVERT                      */
* CALL EXIT;  /*TERMINATE*/                                        0847
         BAL   @14,EXIT                                            0847
* END PROCTYPE; /*END OF PROCEDURE*/                               0848
@EL00006 DS    0H                                                  0848
@EF00006 DS    0H                                                  0848
@ER00006 BR    @14                                                 0848
@PB00006 DS    0H                                                  0849
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - SCANCI                                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    FOR A GIVEN CATALOG RECORD THIS SUBFUNCTION IS CALLED BY      */
*/*    PROCTYPE TO SCAN THE RECORD FOR CONTROL INTERVAL NUMBERS      */
*/*    (CIN) AND FOR EACH CIN FOUND CALLS PROCCI TO SAVE INFORMATION */
*/*    ABOUT THAT CIN.                                               */
*/*                                                                  */
*/*    FOR A SET OF RECORDS, A CI TABLE WILL BE BUILT. EACH CIN      */
*/*    WITHIN THAT SET OF RECORDS WILL HAVE ONE AND ONLY ONE CI      */
*/*    PROCESSED, AND, AS CINS ARE FOUND IN THAT RECORD, DISPLACEMENT*/
*/*    TABLE ENTRIES ARE MADE (POINTED TO BY THE CI TABLE ENTRY)     */
*/*    WHICH DESCRIBE THE CIN IN THAT RECORD. WHENEVER A CIN IS      */
*/*    FOUND WHICH IS NOT YET DESCRIBED IN THE CI TABLE, A CI        */
*/*    TABLE ENTRY WILL BE CREATED.                                  */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    RSGRABCU->GRABCURR->(RAB AND RECORD TO BE PROCESSED)          */
*/*    PTWORK - THE WORK AREA FOR PROCTYPE & SUBFUNCTIONS.           */
*/*             THE PRIMARY DATA IN PTWORK IS:                       */
*/*      PTCITCUR->CITABE(CURRENT CI TABLE ENTRY FOR THE RECORD      */
*/*                     TO BE PROCESSED).                            */
*/*         IF PTCITCUR = 0, THIS INDICATES THAT THIS IS THE         */
*/*         FIRST RECORD PROCESSED IN A SET OF RECORDS, AND A        */
*/*         NEW CI TABLE WILL BE GOTTEN.                             */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    OUTPUT FROM SCANCI CONSISTS OF CHANGES TO THE INPUT TABLES    */
*/*    (CITABE/DITABE) TO REFLECT INFORMATION ABOUT THE CIN FOUND    */
*/*    BY SCANCI IN THE INPUT RECORD (SEE PROCCI). ALSO PTWORK       */
*/*    (PTCITN) WILL BE UPDATED TO CONTAIN THE TOTAL NUMBER OR       */
*/*    CI TABLE ENTRIES.                                             */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0849
         DS    0F
NAME0071 DC    CL8'SCANCI'
*SCANCI: PROCEDURE                                                 0850
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0850
*                                                                  0850
         B     @PB00007                                            0850
SCANCI   DS    0H                                                  0851
*      GENERATE REFS(RS02RG08, REG6);                              0851
*                                                                  0851
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0071  PROCNAME TO REGSAVE
*         OLDERID2 = NEWERID2;                                     0852
         L     @07,GDTTR2(,REG5)                                   0852
         MVC   @TS00001(95),NEWERID2(@07)                          0852
         MVC   OLDERID2(95,@07),@TS00001                           0852
*         NEWID2 = 'RSSC';                                         0853
*                                                                  0853
         MVC   NEWID2(4,@07),@CC03798                              0853
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS IS THE FIRST RECORD IN A SET OF RECORDS          */
*        /* THEN GO AND GET A CI TABLE FOR THIS SET OF RECORDS.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0854
*        IF PTCITCUR = 0 THEN          /*FIRST RCD OF A SET OF RCDS  */
         L     @07,RSPTWKC(,REG6)                                  0854
         L     @07,PTCITCUR(,@07)                                  0854
         LTR   @07,@07                                             0854
         BNZ   @RF00854                                            0854
*          DO;                                                     0855
*            RSTANCHR = ADDR(RSGCITS);                             0856
*                                                                  0856
         LA    @07,RSGCITS(,REG6)                                  0856
         ST    @07,RSTANCHR(,REG6)                                 0856
*            /* GET FIRST CITABE */                                0857
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETFIT          */
*            CALL GETFIT;                                          0857
*                                                                  0857
         L     @15,@CV03435                                        0857
         BALR  @14,@15                                             0857
*            PTCITCUR = RSTENTAD;                                  0858
         L     @07,RSPTWKC(,REG6)                                  0858
         L     @04,RSTENTAD(,REG6)                                 0858
         ST    @04,PTCITCUR(,@07)                                  0858
*            PTCITI = RSGCITNU;        /*INDEX OF FIRST CITABE       */
         MVC   PTCITI(3,@07),RSGCITNU(REG6)                        0859
*            PTCITL = RSGCITNU;        /*INIT LAST CIN FOUND         */
         MVC   PTCITL(3,@07),RSGCITNU(REG6)                        0860
*            PTCITNC = RSGCITNU;       /*CURRENT CIN ENTRY = FIRST   */
         MVC   PTCITNC(3,@07),RSGCITNU(REG6)                       0861
*            PTCITF = PTCITCUR;        /*ADDRESS OF FIRST CITABE     */
*                                                                  0862
         ST    @04,PTCITF(,@07)                                    0862
*        /************************************************************/
*        /*                                                          */
*        /* FORMAT THE FIRST RECORD IN THE CI TABLE                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0863
*            CITABE = CITABE && CITABE;                            0863
         XC    CITABE(20,@04),CITABE(@04)                          0863
*            CITCIN = RCDCINO;         /*ENTER CI NUMBER             */
         L     @07,RSGRABCU(,REG6)                                 0864
         L     @07,GRABCURR(,@07)                                  0864
         LA    @15,8                                               0864
         ALR   @15,@07                                             0864
         MVC   CITCIN(3,@04),RCDCINO(@15)                          0864
*            CITTYPE = RCDID;          /*ENTER RECORD TYPE           */
*                                                                  0865
         MVC   CITTYPE(1,@04),RCDID(@15)                           0865
*        /************************************************************/
*        /*                                                          */
*        /* UPDATE INFORMATION ABOUT THE CURRENT RECORD BEING        */
*        /* PROCESSED IN ITS RESPECTIVE CI TABLE ENTRY.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0866
*            IF RSWRASCI = ON THEN     /*CIN REASSIGNED              */
         TM    RSWRASCI(@07),B'00000100'                           0866
         BNO   @RF00866                                            0866
*              DO;                                                 0867
*                CITFARAS = ON;        /*INDICATE REASSIGNED CIN     */
         OI    CITFARAS(@04),B'00100000'                           0868
*                CITRCIN = RABRCDA;    /*SAVE THE NEWLY ASSIGNED CIN */
         MVC   CITRCIN(3,@04),RABRCDA+1(@07)                       0869
*              END;                                                0870
*          END;                                                    0871
*                                                                  0871
@RF00866 DS    0H                                                  0872
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS THE RECORD FOR ALL CINS IN THE RECORD.           */
*        /* THIS INCLUDES THE FOLLOWING:                             */
*        /*     HORIZONTAL EXTENSION POINTER                         */
*        /*     CIN IN GOP                                           */
*        /*     CIN IN ASSOCIATION GROUP OCCURRENCES                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0872
*        /* GET ADDRESS OF GOPS AND GOS FOR LKR RECORD */          0872
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU            */
*        CALL CATRCDSU;                                            0872
*                                                                  0872
@RF00854 L     @15,@CV03430                                        0872
         BALR  @14,@15                                             0872
*        RFY CITABE BASED(ADDR(RSCITDUM)); /*DUMMY CITABE FR PROCCI  */
*                                                                  0873
*        /************************************************************/
*        /*                                                          */
*        /* HORIZONTAL EXTENSION                                     */
*        /*     IF A HORIZONTAL EXTENSION IS PRESENT CALL            */
*        /*     PROCCI TO HANDLE IT.                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0874
*        IF EXTGOCI ^= 0 THEN                                      0874
         L     @07,RSCPE2(,REG6)                                   0874
         ICM   @04,7,EXTGOCI(@07)                                  0874
         BZ    @RF00874                                            0874
*          DO;                                                     0875
*            CITABE = CITABE && CITABE;                            0876
         LA    @07,48                                              0876
         ALR   @07,REG6                                            0876
         XC    CITABE(20,@07),CITABE(@07)                          0876
*            CITFAHEP = ON;            /*INDICATE HORIZONTAL EXT     */
         OI    CITFAHEP(@07),B'00010000'                           0877
*            IF PTCITCUR->CITTYPE = VOLID                         0878
*              PTCITCUR->CITTYPE = VOLEXTID THEN                   0878
         L     @07,RSPTWKC(,REG6)                                  0878
         L     @07,PTCITCUR(,@07)                                  0878
         CLI   CITTYPE(@07),C'V'                                   0878
         BE    @RT00878                                            0878
         CLI   CITTYPE(@07),C'W'                                   0878
         BNE   @RF00878                                            0878
@RT00878 DS    0H                                                  0879
*              CITTYPE = VOLEXTID;     /*VOL RCD EXTENSION TYPE W    */
         MVI   CITTYPE+48(REG6),C'W'                               0879
*            ELSE                                                  0880
*              CITTYPE = CATEXTID;     /*EXTENSION RECORD TYPE       */
         B     @RC00878                                            0880
@RF00878 MVI   CITTYPE+48(REG6),C'E'                               0880
*            CITCIN = EXTGOCI;         /*SET CIN IN CITABE           */
@RC00878 L     @07,RSCPE2(,REG6)                                   0881
         MVC   CITCIN+48(3,REG6),EXTGOCI(@07)                      0881
*            RSCPE5 = ADDR(EXTGOCI);   /*ADDR OFFSET DATA FOR PROCCI */
*                                                                  0882
         ST    @07,RSCPE5(,REG6)                                   0882
*            /* PROCESS THIS CIN */                                0883
*            CALL PROCCI;                                          0883
*                                                                  0883
         BAL   @14,PROCCI                                          0883
*          END;                                                    0884
*                                                                  0884
*        /************************************************************/
*        /*                                                          */
*        /* GOP (GROUP OCCURRENCE POINTER)                           */
*        /*     SCAN THROUGH ALL OF THE GOPS IN THIS RECORD.         */
*        /*     IF THE GOP POINTS TO AN EXTENSION RECORD (CIN)       */
*        /*     THEN CALL PROCCI FOR THAT CIN. IF THE GOP            */
*        /*     POINTS TO A GO (GROUP OCCURRENCE) IN THIS RECORD     */
*        /*     THEN CHECK TO SEE IF THE GO IS EITHER AN             */
*        /*     ASSOCIATION GO OR A DATA SET DIRECTORY GO.           */
*        /*     IF IT IS EITHER ONE OF THESE THEN IT CONTAINS A      */
*        /*     CIN AS PART OF ITS DATA.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0885
*        RSCPE5 = ADDR(REPGOPT);       /*POINT TO FIRST GOP          */
*                                                                  0885
@RF00874 L     @07,RSCPE2(,REG6)                                   0885
         LA    @07,REPGOPT(,@07)                                   0885
         ST    @07,RSCPE5(,REG6)                                   0885
*        DO RSIDX = 1 TO REPCNT;       /*SCAN THE GOPS               */
*                                                                  0886
         LA    @07,1                                               0886
         B     @DE00886                                            0886
@DL00886 DS    0H                                                  0887
*        /************************************************************/
*        /*                                                          */
*        /*  ASPT - AVAILABLE SPACE POINTER.                         */
*        /*     ALWAYS FLAGGED DELETED. THIS IS THE FIRST GOP AND HAS *
*        /*     A GROUP CODE OF ZERO. IF THE CIN IS NON-ZERO, THIS   */
*        /*     INDICATES THAT THE VERTICAL EXISTS.                  */
*        /*  OTHERWISE - IF GOP FLAGGED DELETED, DON'T PROCESS IT.   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0887
*          IF (RSIDX=1 & CATGOEXT=ON & CATGODEL=ON &               0887
*              (CATGOCI&TRUEGC)='00'X & CATGOCI ^= 0)             0887
*             CATGODEL = OFF THEN                                  0887
         CLC   RSIDX(2,REG6),@CH00212                              0887
         BNE   @GL00029                                            0887
         L     @07,RSCPE5(,REG6)                                   0887
         TM    CATGOEXT(@07),B'11000000'                           0887
         BNO   @GL00029                                            0887
         MVC   @TS00001(1),CATGOCI(@07)                            0887
         NI    @TS00001,X'3F'                                      0887
         CLI   @TS00001,X'00'                                      0887
         BNE   @GL00029                                            0887
         ICM   @04,7,CATGOCI(@07)                                  0887
         BNZ   @RT00887                                            0887
@GL00029 L     @07,RSCPE5(,REG6)                                   0887
         TM    CATGODEL(@07),B'01000000'                           0887
         BNZ   @RF00887                                            0887
@RT00887 DS    0H                                                  0888
*            DO;                                                   0888
*              IF CATGOEXT = ON THEN   /*CHECK IF POINTER TO EXT     */
         L     @07,RSCPE5(,REG6)                                   0889
         TM    CATGOEXT(@07),B'10000000'                           0889
         BNO   @RF00889                                            0889
*                DO;                                               0890
*                                                                  0890
*        /************************************************************/
*        /*                                                          */
*        /* GOP CONTAINS A CIN                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0891
*                  CITABE = CITABE && CITABE;                      0891
         LA    @07,48                                              0891
         ALR   @07,REG6                                            0891
         XC    CITABE(20,@07),CITABE(@07)                          0891
*                  CITFAGOE = ON;      /*INDICATE GOP HAS EXT PTR    */
         OI    CITFAGOE(@07),B'00001000'                           0892
*                  IF PTCITCUR->CITTYPE = VOLID                   0893
*                    PTCITCUR->CITTYPE = VOLEXTID THEN             0893
         L     @07,RSPTWKC(,REG6)                                  0893
         L     @07,PTCITCUR(,@07)                                  0893
         CLI   CITTYPE(@07),C'V'                                   0893
         BE    @RT00893                                            0893
         CLI   CITTYPE(@07),C'W'                                   0893
         BNE   @RF00893                                            0893
@RT00893 DS    0H                                                  0894
*                    CITTYPE = VOLEXTID; /*VOL RCD EXTENSION TYPE W  */
         MVI   CITTYPE+48(REG6),C'W'                               0894
*                  ELSE                                            0895
*                    CITTYPE = CATEXTID; /*NORMAL EXTENSION RECORD   */
         B     @RC00893                                            0895
@RF00893 MVI   CITTYPE+48(REG6),C'E'                               0895
*                  CITCIN = CATGOCI;   /*PUT CIN IN CI TABLE         */
*                                                                  0896
@RC00893 L     @07,RSCPE5(,REG6)                                   0896
         MVC   CITCIN+48(3,REG6),CATGOCI(@07)                      0896
*                  /* PROCESS THIS CIN */                          0897
*                  CALL PROCCI;                                    0897
*                                                                  0897
         BAL   @14,PROCCI                                          0897
*                END;                                              0898
*                                                                  0898
*        /************************************************************/
*        /*                                                          */
*        /* ASSOCIATION GO (GROUP OCCURRENCE)                        */
*        /*     CHECK IF THE GROUP CODE IS 2(ASSOCIATION), IF        */
*        /*     SO THEN THE GO (GROUP OCCURRENCE CONTAINS A CIN.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0899
*              ELSE                                                0899
*                IF (CATGOGC1&TRUEGC) = ASGC THEN                  0899
         B     @RC00889                                            0899
@RF00889 L     @07,RSCPE5(,REG6)                                   0899
         LA    @04,63                                              0899
         SLR   @15,@15                                             0899
         IC    @15,CATGOGC1(,@07)                                  0899
         NR    @04,@15                                             0899
         C     @04,@CF00149                                        0899
         BNE   @RF00899                                            0899
*                  DO;                                             0900
*                    RSCPE6 = RSCPE3 + CATGODSP; /*ADDRESS OF GO     */
         ICM   @07,12,CATGODSP(@07)                                0901
         SRA   @07,16                                              0901
         AL    @07,RSCPE3(,REG6)                                   0901
         ST    @07,RSCPE6(,REG6)                                   0901
*                    CITABE = CITABE && CITABE;                    0902
         LA    @04,48                                              0902
         ALR   @04,REG6                                            0902
         XC    CITABE(20,@04),CITABE(@04)                          0902
*                    CITTYPE = ASTYPE; /*SET TYPE OF RECORD          */
         IC    @15,ASTYPE(,@07)                                    0903
         STC   @15,CITTYPE(,@04)                                   0903
*                    CITCIN = ASCI;    /*PUT CIN IN CI TABLE         */
*                                                                  0904
         MVC   CITCIN(3,@04),ASCI(@07)                             0904
*                    /* PROCESS THIS CIN */                        0905
*                    CALL PROCCI;                                  0905
*                                                                  0905
         BAL   @14,PROCCI                                          0905
*                    PTDITCUR->DITFBAS1 = ON; /*IND ASSOCIATION 1    */
*                                                                  0906
         L     @07,RSPTWKC(,REG6)                                  0906
         L     @04,PTDITCUR(,@07)                                  0906
         OI    DITFBAS1(@04),B'00100000'                           0906
*        /************************************************************/
*        /*                                                          */
*        /* ASSOCIATION GO (GROUP OCCURRENCE)                        */
*        /*     IF THIS IS AN UPGRADE ASSOCIATION IT CONTAINS 2      */
*        /*     CINS IN THE DATA.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0907
*                    IF LENFIX>(LENGTH(CNTRLINF)+LENGTH(ASG1)) &   0907
*                     PTCITF->CITTYPE = UPGID THEN                 0907
         L     @04,RSCPE6(,REG6)                                   0907
         CLI   LENFIX(@04),6                                       0907
         BNH   @RF00907                                            0907
         L     @07,PTCITF(,@07)                                    0907
         CLI   CITTYPE(@07),C'Y'                                   0907
         BNE   @RF00907                                            0907
*                      DO;                                         0908
*                        CITABE = CITABE && CITABE;                0909
         LA    @07,48                                              0909
         ALR   @07,REG6                                            0909
         XC    CITABE(20,@07),CITABE(@07)                          0909
*                        CITTYPE = ASTYPE2; /*CIN RCD TYPE           */
         IC    @15,ASTYPE2(,@04)                                   0910
         STC   @15,CITTYPE(,@07)                                   0910
*                        CITCIN = ASCI2; /*PUT CIN IN CI TABLE       */
*                                                                  0911
         MVC   CITCIN(3,@07),ASCI2(@04)                            0911
*                        /* PROCESS THIS CIN */                    0912
*                        CALL PROCCI;                              0912
*                                                                  0912
         BAL   @14,PROCCI                                          0912
*                        PTDITCUR->DITFBAS2 = ON; /*IND ASSOC 2      */
         L     @07,RSPTWKC(,REG6)                                  0913
         L     @07,PTDITCUR(,@07)                                  0913
         OI    DITFBAS2(@07),B'00010000'                           0913
*                      END;                                        0914
*                                                                  0914
*        /************************************************************/
*        /*                                                          */
*        /*  ASSOCIATION GO (GROUP OCCURRENCE)                       */
*        /*       IF THIS IS A GDG BASE ASSOCIATION, THEN SAVE       */
*        /*       THE GDG LEVEL NUMBER.                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0915
*                    IF (PTCITF->CITTYPE = GDGID                  0915
*                     PTCITF->CITTYPE = NVID) &                    0915
*                     LENFIX = LENGTH(ASGOGDG)                     0915
*                     THEN                                         0915
@RF00907 L     @07,RSPTWKC(,REG6)                                  0915
         L     @07,PTCITF(,@07)                                    0915
         CLI   CITTYPE(@07),C'B'                                   0915
         BE    @GL00035                                            0915
         CLI   CITTYPE(@07),C'A'                                   0915
         BNE   @RF00915                                            0915
@GL00035 L     @07,RSCPE6(,REG6)                                   0915
         CLI   LENFIX(@07),10                                      0915
         BNE   @RF00915                                            0915
*                      PTDITCUR->DITDGML = ASGDGLVL;               0916
*                                                                  0916
         L     @04,RSPTWKC(,REG6)                                  0916
         L     @04,PTDITCUR(,@04)                                  0916
         MVC   DITDGML(4,@04),ASGDGLVL(@07)                        0916
*                  END;                /*END OF ASSOCIATIONS DO      */
*                                                                  0917
@RF00915 DS    0H                                                  0918
*        /************************************************************/
*        /*                                                          */
*        /* THE GOP OR GO HAS BEEN PROCESSED NOW GET THE NEXT        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0918
*            END;                                                  0918
*                                                                  0918
@RF00899 DS    0H                                                  0918
@RC00889 DS    0H                                                  0919
*          RSCPE5 = RSCPE5 + RSGOPLEN;   /*POINT TO NEXT GOP         */
*                                                                  0919
@RF00887 LH    @07,RSGOPLEN(,REG6)                                 0919
         AL    @07,RSCPE5(,REG6)                                   0919
         ST    @07,RSCPE5(,REG6)                                   0919
*        END;                          /*NO MORE GOPS OR GOS         */
*                                                                  0920
         LA    @07,1                                               0920
         AH    @07,RSIDX(,REG6)                                    0920
@DE00886 STH   @07,RSIDX(,REG6)                                    0920
         L     @04,RSCPE2(,REG6)                                   0920
         SLR   @15,@15                                             0920
         IC    @15,REPCNT(,@04)                                    0920
         CR    @07,@15                                             0920
         BNH   @DL00886                                            0920
*        RFY CITABE;                   /*REVERT                      */
*  CALL EXIT;  /*TERMINATE*/                                       0922
         BAL   @14,EXIT                                            0922
*  END SCANCI; /*END OF PROCEDURE*/                                0923
@EL00007 DS    0H                                                  0923
@EF00007 DS    0H                                                  0923
@ER00007 BR    @14                                                 0923
@PB00007 DS    0H                                                  0924
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - SETCI                                                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     . IF THE BASE WAS VERIFIED, MARK ALL VALID RECORDS AS        */
*/*       ASSOCIATION CHECKED.                                       */
*/*     . UPDATE ALL CINS IN VERIFIED RECORDS TO THEIR REASSIGNED    */
*/*       VALUE                                                      */
*/*     . DELETE ALL CINS WHICH FAILED CHECKING IN ALL VERIFIED      */
*/*       RECORDS                                                    */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE CLUSTER                         */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*     RSWASSCK - SET ON IN ALL RECORDS TO BE VERIFIED              */
*/*                THAT PASSED ASSOCIATION CHECKING                  */
*/*     WORKFILE RECORDS - UPDATED PER THE FUNCTION DEXCRIPTION      */
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*     IDC21026I - ENTRY DELETED                                    */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0924
         DS    0F
NAME0079 DC    CL8'SETCI'
*SETCI: PROCEDURE                                                  0925
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0925
*                                                                  0925
         B     @PB00008                                            0925
SETCI    DS    0H                                                  0926
*      GENERATE REFS(RS02RG08, REG6);                              0926
*                                                                  0926
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0079  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      0927
         L     @07,GDTTR2(,REG5)                                   0927
         MVC   @TS00001(95),NEWERID2(@07)                          0927
         MVC   OLDERID2(95,@07),@TS00001                           0927
*        NEWID2 = 'RSSE';                                          0928
*                                                                  0928
         MVC   NEWID2(4,@07),@CC03804                              0928
*        RFY TASSO BASED(PTASSOC);     /*RECURSIVE ASSOC TABLE       */
*        RFY DITABE BASED(PTLCDIT);    /*SCAN DITABE                 */
*                                                                  0930
*        /************************************************************/
*        /*                                                          */
*        /* IF THE BASE VERIFIED THEN UPDATE ALL OF THE              */
*        /* CINS IN THIS SET OF RECORDS.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0931
*        PTF1DELT = OFF;               /*INDICATE NO DELETE REQD     */
         L     @07,RSPTWKC(,REG6)                                  0931
         NI    PTF1DELT(@07),B'11101111'                           0931
*        IF PTCITF->CITFAVER=ON THEN                               0932
         L     @07,PTCITF(,@07)                                    0932
         TM    CITFAVER(@07),B'01000000'                           0932
         BNO   @RF00932                                            0932
*  SETPROC:                                                        0933
*          DO;                                                     0933
*                                                                  0933
SETPROC  DS    0H                                                  0934
*        /************************************************************/
*        /*                                                          */
*        /* GET EACH CI TABLE ENTRY DESCRIBING A RECORD IN THIS      */
*        /* SET OF RECORDS.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0934
*  SETCIT:                                                         0934
*            DO PTCITNC = PTCITI TO PTCITL;                        0934
SETCIT   L     @07,RSPTWKC(,REG6)                                  0934
         L     @07,PTCITI-1(,@07)                                  0934
         LA    @07,0(,@07)                                         0934
         B     @DE00934                                            0934
@DL00934 DS    0H                                                  0935
*              RSTANCHR = ADDR(RSGCITS);                           0935
         LA    @07,RSGCITS(,REG6)                                  0935
         ST    @07,RSTANCHR(,REG6)                                 0935
*              RSTENTIX = PTCITNC;                                 0936
         L     @07,RSPTWKC(,REG6)                                  0936
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       0936
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      0937
         L     @15,@CV03436                                        0937
         BALR  @14,@15                                             0937
*              PTCITCUR = RSTENTAD;    /*SAVE THE CITABE ADDRESS     */
*                                                                  0938
         L     @07,RSPTWKC(,REG6)                                  0938
         L     @04,RSTENTAD(,REG6)                                 0938
         ST    @04,PTCITCUR(,@07)                                  0938
*        /************************************************************/
*        /*                                                          */
*        /* IF THE RECORD IS NOT VALID, IGNORE IT                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0939
*              IF CITFAINV = ON THEN;                              0939
*                                                                  0939
         TM    CITFAINV(@04),B'00000010'                           0939
         BO    @RT00939                                            0939
*        /************************************************************/
*        /*                                                          */
*        /* LOCATE THE ASSOC TABLE ENTRY FOR THIS RECORD TYPE        */
*        /* TO DETERMINE IF THIS RECORD WAS TO BE VERIFIED WITHIN    */
*        /* THIS SET OF RECORDS.                                     */
*        /* THERE IS LOGIC FOR THE FORCE SETTING OF CINS (CURRENTLY  */
*        /* NO ONE USES IT).                                         */
*        /*                                                          */
*        /*  NOTE * FOR VERIFIED SETS OF RECORDS ALL RECORDS, EXCEPT */
*        /*     EXTENSIONS, MUST INDICATE VERIFIED.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0941
*              ELSE                                                0941
*                DO;                                               0941
*                  PTASSCUR = ADDR(TASSEN(1)); /*FIRST ASSOC ENTRY   */
         L     @07,RSPTWKC(,REG6)                                  0942
         L     @04,PTASSOC(,@07)                                   0942
         LA    @04,TASSEN(,@04)                                    0942
         ST    @04,PTASSCUR(,@07)                                  0942
*                  DO PTINDX3 = 1 TO TASSNENT                      0943
*                   WHILE(TASSTYPE ^= CITTYPE);                    0943
         LA    @07,1                                               0943
         B     @DE00943                                            0943
@DL00943 L     @07,RSPTWKC(,REG6)                                  0943
         L     @04,PTASSCUR(,@07)                                  0943
         L     @01,PTCITCUR(,@07)                                  0943
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        0943
         BE    @DC00943                                            0943
*                    PTASSCUR = PTASSCUR + LENGTH(TASSENT);        0944
         AL    @04,@CF00038                                        0944
         ST    @04,PTASSCUR(,@07)                                  0944
*                  END;                                            0945
         L     @04,RSPTWKC(,REG6)                                  0945
         LA    @07,1                                               0945
         AH    @07,PTINDX3(,@04)                                   0945
@DE00943 L     @04,RSPTWKC(,REG6)                                  0945
         STH   @07,PTINDX3(,@04)                                   0945
         L     @04,RSPTWKC(,REG6)                                  0945
         L     @04,PTASSOC(,@04)                                   0945
         CH    @07,TASSNENT(,@04)                                  0945
         BNH   @DL00943                                            0945
@DC00943 DS    0H                                                  0946
*                  IF (TASSVER=ON & (TASSTYPE=VOLEXTID            0946
*                   TASSTYPE=CATEXTID  CITFAVER=ON))             0946
*                   TASSSET=ON THEN                                0946
         L     @07,RSPTWKC(,REG6)                                  0946
         L     @04,PTASSCUR(,@07)                                  0946
         TM    TASSVER(@04),B'00100000'                            0946
         BNO   @GL00037                                            0946
         CLI   TASSTYPE(@04),C'W'                                  0946
         BE    @RT00946                                            0946
         CLI   TASSTYPE(@04),C'E'                                  0946
         BE    @RT00946                                            0946
         L     @07,PTCITCUR(,@07)                                  0946
         TM    CITFAVER(@07),B'01000000'                           0946
         BO    @RT00946                                            0946
@GL00037 L     @07,RSPTWKC(,REG6)                                  0946
         L     @07,PTASSCUR(,@07)                                  0946
         TM    TASSSET(@07),B'00001000'                            0946
         BNO   @RF00946                                            0946
@RT00946 DS    0H                                                  0947
*  TOBEVER:                                                        0947
*                    DO;                                           0947
*                                                                  0947
TOBEVER  DS    0H                                                  0948
*        /************************************************************/
*        /*                                                          */
*        /*     GET THE RECORD INTO STORAGE                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0948
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */
*                                                                  0948
         L     @07,RSGRABCU(,REG6)                                 0948
         L     @04,RSPTWKC(,REG6)                                  0948
         L     @01,PTASSCUR(,@04)                                  0948
         LH    @15,TASSRAB(,@01)                                   0948
         SLA   @15,2                                               0948
         L     @15,RABARRAY-4(@15,@07)                             0948
         ST    @15,GRABCURR(,@07)                                  0948
*                      DO;                                         0949
*                        RSRTYPE = ''B;                            0950
         MVI   RSRTYPE(REG6),X'00'                                 0950
*                        RSRGET = ON;      /* GETRCD  */           0951
         OI    RSRGET(REG6),B'10000000'                            0951
*                        RSRUPD = ON;      /* UPDATE  */           0952
         OI    RSRUPD(REG6),B'00001000'                            0952
*                        RSRDS = ''B;                              0953
         NI    RSRDS(REG6),B'00011111'                             0953
*                        RSRWF = ON;       /* WORKFILE  */         0954
*                        RSRDIR = ON;      /* DIRECT  */           0955
*                        RSRKEY = ON;      /* KEY  */              0956
         OI    RSRWF(REG6),B'10010100'                             0956
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   0957
         OI    RSVIAFCR(REG6),B'10000000'                          0957
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       0958
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       0958
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     0959
*                                                                  0959
         L     @07,PTCITCUR(,@04)                                  0959
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        0959
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/
*                      CALL GETVIA;                                0960
         L     @15,@CV03442                                        0960
         BALR  @14,@15                                             0960
*                      END;                                        0961
*                      IF RABNRF = ON THEN                         0962
*                                                                  0962
         L     @07,RSGRABCU(,REG6)                                 0962
         L     @07,GRABCURR(,@07)                                  0962
         TM    RABNRF(@07),B'00000010'                             0962
         BNO   @RF00962                                            0962
*                        DO;                                       0963
*                        /*CALL CKERR*/                            0964
*                          RSCKERR = RSCKERR && RSCKERR;           0964
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0964
*                          RSCKERN = RSE100;                       0965
         MVC   RSCKERN(2,REG6),@CH00143                            0965
*                          RSCKTERM = 'TERM';                      0966
*                                                                  0966
         MVC   RSCKTERM(4,REG6),@CC03762                           0966
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               0967
         L     @15,@CV03449                                        0967
         BALR  @14,@15                                             0967
*                        END;                                      0968
*                                      /*SHOULD ALWAYS FIND RCD      */
*                                                                  0969
*        /************************************************************/
*        /*                                                          */
*        /*     FOR RECORDS TO BE VERIFIED, MARK ASSOCIATION         */
*        /*     CHECKED                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0969
*                      IF TASSVER = ON THEN                        0969
@RF00962 L     @07,RSPTWKC(,REG6)                                  0969
         L     @04,PTASSCUR(,@07)                                  0969
         TM    TASSVER(@04),B'00100000'                            0969
         BNO   @RF00969                                            0969
*                        DO;                                       0970
*                          CITFAVER = ON; /*MARK EXT VERIFIED        */
         L     @07,PTCITCUR(,@07)                                  0971
         OI    CITFAVER(@07),B'01000000'                           0971
*                          RSWASSCK = ON;                          0972
         L     @07,RSGRABCU(,REG6)                                 0972
         L     @07,GRABCURR(,@07)                                  0972
         OI    RSWASSCK(@07),B'00000010'                           0972
*                        END;                                      0973
*                                                                  0973
*        /************************************************************/
*        /*                                                          */
*        /*     SCAN ALL CINS IN THIS RECORD TO UPDATE ANY THAT      */
*        /*     HAVE BEEN REASSIGNED OR DELETE ANY NO LONGER VALID   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0974
*                      PTLOC = PTLOC && PTLOC;                     0974
@RF00969 L     @07,RSPTWKC(,REG6)                                  0974
         XC    PTLOC(20,@07),PTLOC(@07)                            0974
*                      PTLBCITX = PTCITNC;                         0975
         MVC   PTLBCITX(3,@07),PTCITNC(@07)                        0975
*                      IF CITDICNT ^= 0 THEN                       0976
         L     @07,PTCITCUR(,@07)                                  0976
         CLI   CITDICNT(@07),0                                     0976
         BE    @RF00976                                            0976
*  SETDIT:                                                         0977
*                        DO PTDITNC=CITDITAB TO (CITDITAB+CITDICNT-1);
*                                                                  0977
SETDIT   L     @07,RSPTWKC(,REG6)                                  0977
         L     @07,PTCITCUR(,@07)                                  0977
         L     @07,CITDITAB-1(,@07)                                0977
         LA    @07,0(,@07)                                         0977
         B     @DE00977                                            0977
@DL00977 DS    0H                                                  0978
*        /************************************************************/
*        /*                                                          */
*        /*     GET A CIN IN THE RECORD (DITABE)                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0978
*                          CALL LOCDIT;                            0978
*                                                                  0978
         BAL   @14,LOCDIT                                          0978
*        /************************************************************/
*        /*                                                          */
*        /*     GET CORRESPONDING CITABLE ENTRY AND CHECK FOR        */
*        /*     REASSIGNMENT OF THE CIN.                             */
*        /*     NOTE * FOR ALIAS, IF CHAIN HAS BEEN REPAIRED, THEN   */
*        /*     VERX ALTERED DITCITAB AND FORCED REASSIGN(DITFARAS)  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0979
*                          IF DITCITAB = 0 THEN                    0979
         L     @07,RSPTWKC(,REG6)                                  0979
         L     @04,PTLCDIT(,@07)                                   0979
         L     @04,DITCITAB-1(,@04)                                0979
         LA    @04,0(,@04)                                         0979
         LTR   @04,@04                                             0979
         BNZ   @RF00979                                            0979
*                                      /*ALLOW FOR 0 IN ALIAS CHAIN  */
*                            PTCITWK = 0;                          0980
         SLR   @04,@04                                             0980
         ST    @04,PTCITWK(,@07)                                   0980
*                          ELSE                                    0981
*                            DO;                                   0981
         B     @RC00979                                            0981
@RF00979 DS    0H                                                  0982
*                              RSTANCHR = ADDR(RSGCITS);           0982
         LA    @07,RSGCITS(,REG6)                                  0982
         ST    @07,RSTANCHR(,REG6)                                 0982
*                              RSTENTIX = DITCITAB;                0983
         L     @07,RSPTWKC(,REG6)                                  0983
         L     @07,PTLCDIT(,@07)                                   0983
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      0983
*                              /* CALL TO MODULE IDCRS03 FOR PROCEDURE
*ETNEXTE                                                             */
*                              CALL GETNEXTE;                      0984
         L     @15,@CV03436                                        0984
         BALR  @14,@15                                             0984
*                              PTCITWK = RSTENTAD;                 0985
         L     @07,RSPTWKC(,REG6)                                  0985
         L     @04,RSTENTAD(,REG6)                                 0985
         ST    @04,PTCITWK(,@07)                                   0985
*                              IF PTCITWK->CITFARAS=ON THEN        0986
         TM    CITFARAS(@04),B'00100000'                           0986
         BNO   @RF00986                                            0986
*                                DITFARAS = ON;                    0987
         L     @07,PTLCDIT(,@07)                                   0987
         OI    DITFARAS(@07),B'00100000'                           0987
*                            END;                                  0988
*                                                                  0988
@RF00986 DS    0H                                                  0989
*        /************************************************************/
*        /*                                                          */
*        /*     IF THE CIN IN THE RECORD BEING SET IS AN ASSOCIATION */
*        /*     AND THE ASSOCIATION WAS NOT CHECKED, THEN            */
*        /*     FLAG THE GROUP OCCURRENCE FOR DELETION.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0989
*                          IF DITFBAS1=ON  DITFBAS2=ON THEN       0989
@RC00979 L     @07,RSPTWKC(,REG6)                                  0989
         L     @04,PTLCDIT(,@07)                                   0989
         TM    DITFBAS1(@04),B'00110000'                           0989
         BZ    @RF00989                                            0989
*                            IF DITFAVER=OFF THEN                  0990
         TM    DITFAVER(@04),B'01000000'                           0990
         BNZ   @RF00990                                            0990
*                              DO;                                 0991
*                                DITFBDGO=ON;                      0992
         OI    DITFBDGO(@04),B'00000100'                           0992
*                                PTF1DELT=ON;                      0993
*                                                                  0993
         OI    PTF1DELT(@07),B'00010000'                           0993
*        /************************************************************/
*        /*                                                          */
*        /*       MARK THE BASE RECORD FOR DELETE OF GO              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0994
*                                IF CITEXTBA^=0 THEN               0994
         L     @07,PTCITCUR(,@07)                                  0994
         L     @04,CITEXTBA-1(,@07)                                0994
         LA    @04,0(,@04)                                         0994
         LTR   @04,@04                                             0994
         BZ    @RF00994                                            0994
*                                  DO; /*GET BASE FOR MARKING        */
*                                    RSTANCHR=ADDR(RSGCITS);       0996
         LA    @04,RSGCITS(,REG6)                                  0996
         ST    @04,RSTANCHR(,REG6)                                 0996
*                                    RSTENTIX=CITEXTBA;            0997
         MVC   RSTENTIX(3,REG6),CITEXTBA(@07)                      0997
*                                    /* CALL TO MODULE IDCRS03 FOR PROC
*DURE GETNEXTE                                                       */
*                                    CALL GETNEXTE;                0998
         L     @15,@CV03436                                        0998
         BALR  @14,@15                                             0998
*                                  END;                            0999
*                                ELSE  /*THIS IS BASE FOR MARKING    */
*                                  RSTENTAD = PTCITCUR;            1000
*                                                                  1000
         B     @RC00994                                            1000
@RF00994 L     @07,RSPTWKC(,REG6)                                  1000
         L     @07,PTCITCUR(,@07)                                  1000
         ST    @07,RSTENTAD(,REG6)                                 1000
*                                RSTENTAD->CITFADGO=ON; /*FLG DELGO  */
@RC00994 L     @07,RSTENTAD(,REG6)                                 1001
         OI    CITFADGO(@07),B'00000001'                           1001
*                              END;                                1002
*                            ELSE;                                 1003
*                                                                  1003
@RF00990 DS    0H                                                  1004
*        /************************************************************/
*        /*                                                          */
*        /*     IF THE CIN IN THE RECORD BEING RESET IS THE CIN OF   */
*        /*     AN EXTENSION AND THE EXTENSION RECORD IS NOT VALID,  */
*        /*     FLAG THE GOP FOR DELETION.                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1004
*                          ELSE                                    1004
*                            IF PTCITWK->CITFAINV=ON THEN          1004
         B     @RC00989                                            1004
@RF00989 L     @07,RSPTWKC(,REG6)                                  1004
         L     @04,PTCITWK(,@07)                                   1004
         TM    CITFAINV(@04),B'00000010'                           1004
         BNO   @RF01004                                            1004
*                              DITFADEL=ON; /*DELETE GOP             */
*                                                                  1005
         L     @07,PTLCDIT(,@07)                                   1005
         OI    DITFADEL(@07),B'00010000'                           1005
*        /************************************************************/
*        /*                                                          */
*        /*     DELETE GOPS AND UPDATE REASSIGNED CINS               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1006
*  SETMOD:                                                         1006
*                          IF DITFBDGO=OFF &                       1006
*                           (DITFADEL=ON  DITFARAS=ON) THEN       1006
@RF01004 DS    0H                                                  1006
@RC00989 DS    0H                                                  1006
SETMOD   L     @07,RSPTWKC(,REG6)                                  1006
         L     @04,PTLCDIT(,@07)                                   1006
         TM    DITFBDGO(@04),B'00000100'                           1006
         BNZ   @RF01006                                            1006
         TM    DITFADEL(@04),B'00110000'                           1006
         BZ    @RF01006                                            1006
*                            DO;                                   1007
*                              PTDITCUR=PTLCDIT; /*DITABE FOR ALTER  */
         ST    @04,PTDITCUR(,@07)                                  1008
*                              CALL CINALTER;                      1009
         BAL   @14,CINALTER                                        1009
*                            END;                                  1010
*                        END SETDIT;                               1011
*                                                                  1011
@RF01006 L     @04,RSPTWKC(,REG6)                                  1011
         LA    @07,1                                               1011
         L     @04,PTDITNC-1(,@04)                                 1011
         LA    @04,0(,@04)                                         1011
         ALR   @07,@04                                             1011
@DE00977 L     @04,RSPTWKC(,REG6)                                  1011
         STCM  @07,7,PTDITNC(@04)                                  1011
         L     @04,RSPTWKC(,REG6)                                  1011
         L     @04,PTCITCUR(,@04)                                  1011
         L     @01,RSPTWKC(,REG6)                                  1011
         L     @01,PTCITCUR(,@01)                                  1011
         L     @04,CITDITAB-1(,@04)                                1011
         LA    @04,0(,@04)                                         1011
         SLR   @00,@00                                             1011
         IC    @00,CITDICNT(,@01)                                  1011
         ALR   @04,@00                                             1011
         BCTR  @04,0                                               1011
         CR    @07,@04                                             1011
         BNH   @DL00977                                            1011
*        /************************************************************/
*        /*                                                          */
*        /*     UPDATE THE RECORD                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1012
*                                                                  1012
*                      DO;                                         1012
@RF00976 DS    0H                                                  1013
*                        RSRTYPE = ''B;                            1013
         MVI   RSRTYPE(REG6),X'00'                                 1013
*                        RSRUPDT = ON;     /* UPDRCD  */           1014
         OI    RSRUPDT(REG6),B'00100000'                           1014
*                        RSRUPD = ON;      /* UPDATE  */           1015
         OI    RSRUPD(REG6),B'00001000'                            1015
*                        RSRDS = ''B;                              1016
         NI    RSRDS(REG6),B'00011111'                             1016
*                        RSRWF = ON;       /* WORKFILE  */         1017
*                        RSRDIR = ON;      /* DIRECT  */           1018
*                                                                  1018
         OI    RSRWF(REG6),B'10000100'                             1018
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                      CALL RECMGMT;                               1019
         L     @15,@CV03458                                        1019
         BALR  @14,@15                                             1019
*                        RFY RTNREG RSTD;                          1020
*                        TESTRC = RTNREG;                          1021
         STH   RTNREG,TESTRC(,REG6)                                1021
*                        RFY RTNREG UNRSTD;                        1022
*                      END;                                        1023
*                                                                  1023
*        /************************************************************/
*        /*                                                          */
*        /*     UPDATE ALL LOWER TABLES DEPENDENT ON THIS RECORD'S   */
*        /*     STATUS                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1024
*                      IF PTCITI = 1 THEN;                         1024
         L     @07,RSPTWKC(,REG6)                                  1024
         CLC   PTCITI(3,@07),@CF00212+1                            1024
         BE    @RT01024                                            1024
*                                      /*NO SCAN FOR FIRST TBL       */
*                      ELSE                                        1026
*                        DO;                                       1026
*                          RSTANCHR = ADDR(RSGCITS);               1027
         LA    @07,RSGCITS(,REG6)                                  1027
         ST    @07,RSTANCHR(,REG6)                                 1027
*                          DO RSTENTIX=1 TO (PTCITI-1);            1028
         LA    @07,1                                               1028
         B     @DE01028                                            1028
@DL01028 DS    0H                                                  1029
*                            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GE
*NEXTE                                                               */
*                            CALL GETNEXTE;                        1029
         L     @15,@CV03436                                        1029
         BALR  @14,@15                                             1029
*                            IF RSTENTAD->CITCIN=CITCIN THEN       1030
         L     @07,RSTENTAD(,REG6)                                 1030
         L     @04,RSPTWKC(,REG6)                                  1030
         L     @04,PTCITCUR(,@04)                                  1030
         CLC   CITCIN(3,@07),CITCIN(@04)                           1030
         BNE   @RF01030                                            1030
*                              /*ENTRY SAME AS OURS                  */
*                              DO;                                 1031
*                                IF CITFAVER=ON THEN               1032
         TM    CITFAVER(@04),B'01000000'                           1032
         BNO   @RF01032                                            1032
*                                        /*XFER VERIFIED INDR        */
*                                  RSTENTAD->CITFAVER=ON;          1033
         OI    CITFAVER(@07),B'01000000'                           1033
*                                IF CITFARAS=ON THEN               1034
@RF01032 L     @07,RSPTWKC(,REG6)                                  1034
         L     @07,PTCITCUR(,@07)                                  1034
         TM    CITFARAS(@07),B'00100000'                           1034
         BNO   @RF01034                                            1034
*                                        /*XFER REASSIGNED INDR      */
*                                  RSTENTAD->CITFARAS=ON;          1035
         L     @07,RSTENTAD(,REG6)                                 1035
         OI    CITFARAS(@07),B'00100000'                           1035
*                                      /*XFER REASSIGN CIN           */
*                                RSTENTAD->CITRCIN=CITRCIN;        1036
@RF01034 L     @07,RSTENTAD(,REG6)                                 1036
         L     @04,RSPTWKC(,REG6)                                  1036
         L     @04,PTCITCUR(,@04)                                  1036
         MVC   CITRCIN(3,@07),CITRCIN(@04)                         1036
*                              END;                                1037
*                          END;                                    1038
@RF01030 LA    @07,1                                               1038
         L     @04,RSTENTIX-1(,REG6)                               1038
         LA    @04,0(,@04)                                         1038
         ALR   @07,@04                                             1038
@DE01028 STCM  @07,7,RSTENTIX(REG6)                                1038
         L     @04,RSPTWKC(,REG6)                                  1038
         L     @04,PTCITI-1(,@04)                                  1038
         LA    @04,0(,@04)                                         1038
         BCTR  @04,0                                               1038
         CR    @07,@04                                             1038
         BNH   @DL01028                                            1038
*                        END;                                      1039
*                    END TOBEVER;                                  1040
*        /************************************************************/
*        /*                                                          */
*        /*  IF THIS RECORD IS NOT TO BE VERIFIED, FREE THE BUFFER   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1041
*                  ELSE                                            1041
*                    IF TASSREAD=ON & TASSIS=OFF THEN              1041
         B     @RC00946                                            1041
@RF00946 L     @07,RSPTWKC(,REG6)                                  1041
         L     @07,PTASSCUR(,@07)                                  1041
         TM    TASSREAD(@07),B'10000000'                           1041
         BNO   @RF01041                                            1041
         TM    TASSIS(@07),B'00010000'                             1041
         BNZ   @RF01041                                            1041
*                      DO;                                         1042
*                        GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR */
*                                                                  1043
         L     @04,RSGRABCU(,REG6)                                 1043
         LH    @07,TASSRAB(,@07)                                   1043
         SLA   @07,2                                               1043
         L     @07,RABARRAY-4(@07,@04)                             1043
         ST    @07,GRABCURR(,@04)                                  1043
*                        DO;                                       1044
*                          RSRTYPE = ''B;                          1045
         MVI   RSRTYPE(REG6),X'00'                                 1045
*                          RSRFREE = ON;     /* FREERCD  */        1046
         OI    RSRFREE(REG6),B'00000001'                           1046
*                          RSRUPD = ON;      /* UPDATE  */         1047
         OI    RSRUPD(REG6),B'00001000'                            1047
*                          RSRDS = ''B;                            1048
         NI    RSRDS(REG6),B'00011111'                             1048
*                          RSRWF = ON;       /* WORKFILE  */       1049
*                          RSRDIR = ON;      /* DIRECT  */         1050
*                          RSRKEY = ON;      /* KEY  */            1051
*                                                                  1051
         OI    RSRWF(REG6),B'10010100'                             1051
*                        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGM
*                                                                    */
*                        CALL RECMGMT;                             1052
         L     @15,@CV03458                                        1052
         BALR  @14,@15                                             1052
*                          RFY RTNREG RSTD;                        1053
*                          TESTRC = RTNREG;                        1054
         STH   RTNREG,TESTRC(,REG6)                                1054
*                          RFY RTNREG UNRSTD;                      1055
*                        END;                                      1056
*                      END;                                        1057
*                END;                                              1058
@RF01041 DS    0H                                                  1058
@RC00946 DS    0H                                                  1059
*            END SETCIT;                                           1059
*                                                                  1059
@RT00939 L     @04,RSPTWKC(,REG6)                                  1059
         LA    @07,1                                               1059
         L     @04,PTCITNC-1(,@04)                                 1059
         LA    @04,0(,@04)                                         1059
         ALR   @07,@04                                             1059
@DE00934 L     @04,RSPTWKC(,REG6)                                  1059
         STCM  @07,7,PTCITNC(@04)                                  1059
         L     @04,RSPTWKC(,REG6)                                  1059
         L     @04,PTCITL-1(,@04)                                  1059
         LA    @04,0(,@04)                                         1059
         CR    @07,@04                                             1059
         BNH   @DL00934                                            1059
*        /************************************************************/
*        /*                                                          */
*        /*  DELETE ALL GROUP OCCURRENCES MARKED FOR DELETION        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1060
*            IF PTF1DELT = ON THEN                                 1060
         L     @07,RSPTWKC(,REG6)                                  1060
         TM    PTF1DELT(@07),B'00010000'                           1060
         BNO   @RF01060                                            1060
*  SETDELGO:                                                       1061
*              DO;                                                 1061
SETDELGO DS    0H                                                  1062
*                GRABCURR = RABARRAY(EXTRAB); /*EXTENSION RAB        */
*                                                                  1062
         L     @07,RSGRABCU(,REG6)                                 1062
         L     @04,RABARRAY+12(,@07)                               1062
         ST    @04,GRABCURR(,@07)                                  1062
*                DO;                                               1063
*                  RSRTYPE = ''B;                                  1064
         MVI   RSRTYPE(REG6),X'00'                                 1064
*                  RSRFREE = ON;     /* FREERCD  */                1065
         OI    RSRFREE(REG6),B'00000001'                           1065
*                  RSRUPD = ON;      /* UPDATE  */                 1066
         OI    RSRUPD(REG6),B'00001000'                            1066
*                  RSRDS = ''B;                                    1067
         NI    RSRDS(REG6),B'00011111'                             1067
*                  RSRWF = ON;       /* WORKFILE  */               1068
*                  RSRDIR = ON;      /* DIRECT  */                 1069
*                  RSRKEY = ON;      /* KEY  */                    1070
*                                                                  1070
         OI    RSRWF(REG6),B'10010100'                             1070
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */
*                CALL RECMGMT;                                     1071
         L     @15,@CV03458                                        1071
         BALR  @14,@15                                             1071
*                  RFY RTNREG RSTD;                                1072
*                  TESTRC = RTNREG;                                1073
         STH   RTNREG,TESTRC(,REG6)                                1073
*                  RFY RTNREG UNRSTD;                              1074
*                END;      /*FREE POSSIBLE EXTENSION     */        1075
*                                                                  1075
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESS ALL RECORDS IN THIS SET                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1076
*                DO PTCITNC = PTCITI TO PTCITL;                    1076
         L     @07,RSPTWKC(,REG6)                                  1076
         L     @07,PTCITI-1(,@07)                                  1076
         LA    @07,0(,@07)                                         1076
         B     @DE01076                                            1076
@DL01076 DS    0H                                                  1077
*                  RSTANCHR = ADDR(RSGCITS);                       1077
         LA    @07,RSGCITS(,REG6)                                  1077
         ST    @07,RSTANCHR(,REG6)                                 1077
*                  RSTENTIX = PTCITNC; /*GET NEXT RECORD DESCRIPTOR  */
         L     @07,RSPTWKC(,REG6)                                  1078
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1078
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */
*                  CALL GETNEXTE;                                  1079
         L     @15,@CV03436                                        1079
         BALR  @14,@15                                             1079
*                  PTCITCUR = RSTENTAD; /*ADDR OF CITABE FOR RECORD  */
*                                                                  1080
         L     @07,RSPTWKC(,REG6)                                  1080
         L     @04,RSTENTAD(,REG6)                                 1080
         ST    @04,PTCITCUR(,@07)                                  1080
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS ONLY BASE RECORDS MARKED FOR DELETE OF GO    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1081
*                  IF CITFADGO = ON THEN                           1081
         TM    CITFADGO(@04),B'00000001'                           1081
         BNO   @RF01081                                            1081
*  SETDEL1:                                                        1082
*                    DO;                                           1082
*                                                                  1082
SETDEL1  DS    0H                                                  1083
*        /************************************************************/
*        /*                                                          */
*        /*     LOCATE ASSOCIATION ENTRY AND READ IN THE BASE RECORD */
*        /*                                                          */
*        /************************************************************/
*                                                                  1083
*                      PTASSCUR = ADDR(TASSEN(1));                 1083
         L     @07,RSPTWKC(,REG6)                                  1083
         L     @04,PTASSOC(,@07)                                   1083
         LA    @04,TASSEN(,@04)                                    1083
         ST    @04,PTASSCUR(,@07)                                  1083
*                      DO PTINDX3 = 1 TO TASSNENT                  1084
*                       WHILE(TASSTYPE^=CITTYPE);                  1084
         LA    @07,1                                               1084
         B     @DE01084                                            1084
@DL01084 L     @07,RSPTWKC(,REG6)                                  1084
         L     @04,PTASSCUR(,@07)                                  1084
         L     @01,PTCITCUR(,@07)                                  1084
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        1084
         BE    @DC01084                                            1084
*                        PTASSCUR = PTASSCUR + LENGTH(TASSENT);    1085
         AL    @04,@CF00038                                        1085
         ST    @04,PTASSCUR(,@07)                                  1085
*                      END;                                        1086
         L     @04,RSPTWKC(,REG6)                                  1086
         LA    @07,1                                               1086
         AH    @07,PTINDX3(,@04)                                   1086
@DE01084 L     @04,RSPTWKC(,REG6)                                  1086
         STH   @07,PTINDX3(,@04)                                   1086
         L     @04,RSPTWKC(,REG6)                                  1086
         L     @04,PTASSOC(,@04)                                   1086
         CH    @07,TASSNENT(,@04)                                  1086
         BNH   @DL01084                                            1086
@DC01084 DS    0H                                                  1087
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */
*                                                                  1087
         L     @07,RSGRABCU(,REG6)                                 1087
         L     @04,RSPTWKC(,REG6)                                  1087
         L     @01,PTASSCUR(,@04)                                  1087
         LH    @15,TASSRAB(,@01)                                   1087
         SLA   @15,2                                               1087
         L     @15,RABARRAY-4(@15,@07)                             1087
         ST    @15,GRABCURR(,@07)                                  1087
*                      DO;                                         1088
*                        RSRTYPE = ''B;                            1089
         MVI   RSRTYPE(REG6),X'00'                                 1089
*                        RSRGET = ON;      /* GETRCD  */           1090
         OI    RSRGET(REG6),B'10000000'                            1090
*                        RSRUPD = ON;      /* UPDATE  */           1091
         OI    RSRUPD(REG6),B'00001000'                            1091
*                        RSRDS = ''B;                              1092
         NI    RSRDS(REG6),B'00011111'                             1092
*                        RSRWF = ON;       /* WORKFILE  */         1093
*                        RSRDIR = ON;      /* DIRECT  */           1094
*                        RSRKEY = ON;      /* KEY  */              1095
         OI    RSRWF(REG6),B'10010100'                             1095
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1096
         OI    RSVIAFCR(REG6),B'10000000'                          1096
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       1097
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       1097
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     1098
*                                                                  1098
         L     @07,PTCITCUR(,@04)                                  1098
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        1098
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/
*                      CALL GETVIA;                                1099
         L     @15,@CV03442                                        1099
         BALR  @14,@15                                             1099
*                      END;                                        1100
*                                                                  1100
*        /************************************************************/
*        /*                                                          */
*        /*     EXTRACT ALL ASSOCIATIONS.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1101
*                                                                  1101
*                      DO;                                         1101
*                        GRABBB = GRABCURR;                        1102
         L     @07,RSGRABCU(,REG6)                                 1102
         L     @04,GRABCURR(,@07)                                  1102
         ST    @04,GRABBB(,@07)                                    1102
*                        RSWGCODE = ASGC;                          1103
         MVI   RSWGCODE(REG6),X'02'                                1103
*                                      /*SPECIFY GROUP CODE          */
*                        RSWFONE = OFF;/*FIND ALL OCCURRENCES        */
         NI    RSWFONE(REG6),B'01111111'                           1104
*                        /* CALL THE FIND SUBROUTINE */            1105
*                                                                  1105
*                      /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND  */
*                      CALL FIND;                                  1105
         L     @15,@CV03441                                        1105
         BALR  @14,@15                                             1105
*                      END;                                        1106
*                                                                  1106
*        /************************************************************/
*        /*                                                          */
*        /*     FIND OR ASSOC ERROR IF NO ENTRIES FOUND              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1107
*                      IF RSFENTLN = 0 THEN                        1107
*                                                                  1107
         L     @07,RSWASNVT(,REG6)                                 1107
         CLI   RSFENTLN(@07),0                                     1107
         BNE   @RF01107                                            1107
*                        DO;                                       1108
*                        /*CALL CKERR*/                            1109
*                          RSCKERR = RSCKERR && RSCKERR;           1109
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1109
*                          RSCKERN = RSE100;                       1110
         MVC   RSCKERN(2,REG6),@CH00143                            1110
*                          RSCKTERM = 'TERM';                      1111
*                                                                  1111
         MVC   RSCKTERM(4,REG6),@CC03762                           1111
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               1112
         L     @15,@CV03449                                        1112
         BALR  @14,@15                                             1112
*                        END;                                      1113
*                                                                  1113
*        /************************************************************/
*        /*                                                          */
*        /*     SCAN ALL CIN ENTRIES IN THE BASE AND ITS             */
*        /*     EXTENSIONS                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1114
*                      PTLOC = PTLOC && PTLOC;                     1114
@RF01107 L     @07,RSPTWKC(,REG6)                                  1114
         XC    PTLOC(20,@07),PTLOC(@07)                            1114
*                      PTLBCITX = PTCITNC; /*BASE RECORD FOR SCAN    */
         MVC   PTLBCITX(3,@07),PTCITNC(@07)                        1115
*                      PTLFBDGO = ON;  /*SCAN FOR DELETE GO ONLY     */
         OI    PTLFBDGO(@07),B'00000100'                           1116
*                      DO UNTIL(PTLCDIT=0);                        1117
*                                                                  1117
@DL01117 DS    0H                                                  1118
*        /************************************************************/
*        /*                                                          */
*        /*     GET GO TO BE DELETED                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1118
*                        CALL LOCDIT;                              1118
*                                                                  1118
         BAL   @14,LOCDIT                                          1118
*        /************************************************************/
*        /*                                                          */
*        /*     LOCATE MATCHING FIND ENTRY BY GO SEQUENCE NUMBER.    */
*        /*     IF FOUND, DELETE THE GO.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1119
*                        IF PTLCDIT ^= 0 THEN                      1119
         L     @07,RSPTWKC(,REG6)                                  1119
         L     @07,PTLCDIT(,@07)                                   1119
         LTR   @07,@07                                             1119
         BZ    @RF01119                                            1119
*                                      /*CHK IF ANY FOUND            */
*                          DO;                                     1120
*                            RSFAENT = RSFCADR; /*FIRST ASSN         */
         L     @07,RSWASNVT(,REG6)                                 1121
         L     @04,RSFCADR(,@07)                                   1121
         ST    @04,RSFAENT(,@07)                                   1121
*                            DO RSFCNDX = 1 TO RSFHNDX             1122
*                             WHILE(SNSN^=DITSN);                  1122
         LA    @07,1                                               1122
         B     @DE01122                                            1122
@DL01122 L     @07,RSWASNVT(,REG6)                                 1122
         L     @04,RSFAENT(,@07)                                   1122
         L     @01,RSPTWKC(,REG6)                                  1122
         L     @01,PTLCDIT(,@01)                                   1122
         SLR   @00,@00                                             1122
         ICM   @00,3,SNSN(@04)                                     1122
         CH    @00,DITSN(,@01)                                     1122
         BE    @DC01122                                            1122
*                              RSFAENT = RSFAENT + RSFENTLN;       1123
         SLR   @15,@15                                             1123
         IC    @15,RSFENTLN(,@07)                                  1123
         ALR   @04,@15                                             1123
         ST    @04,RSFAENT(,@07)                                   1123
*                            END;                                  1124
*                                                                  1124
         L     @04,RSWASNVT(,REG6)                                 1124
         LA    @07,1                                               1124
         AH    @07,RSFCNDX(,@04)                                   1124
@DE01122 L     @04,RSWASNVT(,REG6)                                 1124
         STH   @07,RSFCNDX(,@04)                                   1124
         L     @04,RSWASNVT(,REG6)                                 1124
         CH    @07,RSFHNDX(,@04)                                   1124
         BNH   @DL01122                                            1124
@DC01122 DS    0H                                                  1125
*                            IF RSFCNDX > RSFHNDX  SNFDEL=ON THEN;
         L     @07,RSWASNVT(,REG6)                                 1125
         LH    @04,RSFCNDX(,@07)                                   1125
         CH    @04,RSFHNDX(,@07)                                   1125
         BH    @RT01125                                            1125
         L     @07,RSFAENT(,@07)                                   1125
         TM    SNFDEL(@07),B'01000000'                             1125
         BO    @RT01125                                            1125
*                                      /*IGNORE ALREADY DELETED      */
*                            ELSE                                  1127
*                              /* CALL TO MODULE IDCRS04 FOR PROCEDURE
*ELGO                                                                */
*                              CALL DELGO;                         1127
         L     @15,@CV03440                                        1127
         BALR  @14,@15                                             1127
*                                      /*DELETE THE GO               */
*                          END;                                    1128
@RT01125 DS    0H                                                  1129
*                      END;                                        1129
*                                                                  1129
@RF01119 DS    0H                                                  1129
@DE01117 L     @07,RSPTWKC(,REG6)                                  1129
         L     @04,PTLCDIT(,@07)                                   1129
         LTR   @04,@04                                             1129
         BNZ   @DL01117                                            1129
*        /************************************************************/
*        /*                                                          */
*        /*     FREE THE BASE RECORD                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1130
*                      GRABCURR = RABARRAY(TASSRAB); /*BASE BUFFER   */
*                                                                  1130
         L     @04,RSGRABCU(,REG6)                                 1130
         L     @07,PTASSCUR(,@07)                                  1130
         LH    @07,TASSRAB(,@07)                                   1130
         SLA   @07,2                                               1130
         L     @07,RABARRAY-4(@07,@04)                             1130
         ST    @07,GRABCURR(,@04)                                  1130
*                      DO;                                         1131
*                        RSRTYPE = ''B;                            1132
         MVI   RSRTYPE(REG6),X'00'                                 1132
*                        RSRFREE = ON;     /* FREERCD  */          1133
         OI    RSRFREE(REG6),B'00000001'                           1133
*                        RSRUPD = ON;      /* UPDATE  */           1134
         OI    RSRUPD(REG6),B'00001000'                            1134
*                        RSRDS = ''B;                              1135
         NI    RSRDS(REG6),B'00011111'                             1135
*                        RSRWF = ON;       /* WORKFILE  */         1136
*                        RSRDIR = ON;      /* DIRECT  */           1137
*                        RSRKEY = ON;      /* KEY  */              1138
*                                                                  1138
         OI    RSRWF(REG6),B'10010100'                             1138
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                      CALL RECMGMT;                               1139
         L     @15,@CV03458                                        1139
         BALR  @14,@15                                             1139
*                        RFY RTNREG RSTD;                          1140
*                        TESTRC = RTNREG;                          1141
         STH   RTNREG,TESTRC(,REG6)                                1141
*                        RFY RTNREG UNRSTD;                        1142
*                      END;                                        1143
*                                                                  1143
*        /************************************************************/
*        /*                                                          */
*        /*     FREE THE SN TABLE FOR REUSE BY FIND                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1144
*                      RSFENTLN = 0;                               1144
*                                                                  1144
         L     @07,RSWASNVT(,REG6)                                 1144
         MVI   RSFENTLN(@07),X'00'                                 1144
*                    END SETDEL1;                                  1145
*                END;                                              1146
@RF01081 L     @04,RSPTWKC(,REG6)                                  1146
         LA    @07,1                                               1146
         L     @04,PTCITNC-1(,@04)                                 1146
         LA    @04,0(,@04)                                         1146
         ALR   @07,@04                                             1146
@DE01076 L     @04,RSPTWKC(,REG6)                                  1146
         STCM  @07,7,PTCITNC(@04)                                  1146
         L     @04,RSPTWKC(,REG6)                                  1146
         L     @04,PTCITL-1(,@04)                                  1146
         LA    @04,0(,@04)                                         1146
         CR    @07,@04                                             1146
         BNH   @DL01076                                            1146
*            END SETDELGO;                                         1147
*          END SETPROC;                                            1148
*        /************************************************************/
*        /*                                                          */
*        /* IF BASE NOT VERIFIED AND SHOULD HAVE BEEN, THEN ISSUE    */
*        /* MESSAGE FOR ENTRY DELETED - IDC21026I                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1149
*        ELSE                                                      1149
*  SETNVER:                                                        1149
*          DO;                                                     1149
         B     @RC00932                                            1149
@RF00932 DS    0H                                                  1149
SETNVER  DS    0H                                                  1150
*            GRABCURR = (RABARRAY(ADDR(PTASSOC->TASSEN(1))->TASSRAB));
         L     @07,RSGRABCU(,REG6)                                 1150
         L     @04,RSPTWKC(,REG6)                                  1150
         L     @04,PTASSOC(,@04)                                   1150
         LA    @04,TASSEN(,@04)                                    1150
         LH    @04,TASSRAB(,@04)                                   1150
         SLA   @04,2                                               1150
         L     @04,RABARRAY-4(@04,@07)                             1150
         ST    @04,GRABCURR(,@07)                                  1150
*                                      /*BASE BUFFER                 */
*                                                                  1151
*            DO;                                                   1151
*            /*CALL CKERR*/                                        1152
*              RSCKERR = RSCKERR && RSCKERR;                       1152
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1152
*              RSCKERN = RSE029;                                   1153
         MVC   RSCKERN(2,REG6),@CH00948                            1153
*              RSCKTERM = 'RETU';                                  1154
         MVC   RSCKTERM(4,REG6),@CC03787                           1154
*              RSCKMVAR(1) = ADDR(CNAME);                          1155
         AL    @04,@CF00175                                        1155
         LA    @07,CNAME(,@04)                                     1155
         ST    @07,RSCKMVAR(,REG6)                                 1155
*              RSCKMVAR(2) = ADDR(RCDID);                          1156
*                                                                  1156
         LA    @07,RCDID(,@04)                                     1156
         ST    @07,RSCKMVAR+4(,REG6)                               1156
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1157
         L     @15,@CV03449                                        1157
         BALR  @14,@15                                             1157
*            END;                                                  1158
*                                                                  1158
*        /************************************************************/
*        /*                                                          */
*        /*   FREE ALL BUFFERS POSSIBLY USED                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1159
*            PTASSCUR = ADDR(TASSEN(1)); /*FIRST ASSOC TBL ENTRY     */
         L     @07,RSPTWKC(,REG6)                                  1159
         L     @04,PTASSOC(,@07)                                   1159
         LA    @04,TASSEN(,@04)                                    1159
         ST    @04,PTASSCUR(,@07)                                  1159
*            DO PTINDX3 = 1 TO TASSNENT;                           1160
         LA    @07,1                                               1160
         B     @DE01160                                            1160
@DL01160 DS    0H                                                  1161
*              IF TASSREAD=ON & TASSIS=OFF THEN                    1161
         L     @07,RSPTWKC(,REG6)                                  1161
         L     @07,PTASSCUR(,@07)                                  1161
         TM    TASSREAD(@07),B'10000000'                           1161
         BNO   @RF01161                                            1161
         TM    TASSIS(@07),B'00010000'                             1161
         BNZ   @RF01161                                            1161
*                DO;                                               1162
*                  GRABCURR = RABARRAY(TASSRAB);                   1163
*                                                                  1163
         L     @04,RSGRABCU(,REG6)                                 1163
         LH    @07,TASSRAB(,@07)                                   1163
         SLA   @07,2                                               1163
         L     @07,RABARRAY-4(@07,@04)                             1163
         ST    @07,GRABCURR(,@04)                                  1163
*                   DO;                                            1164
*                     RSRTYPE = ''B;                               1165
         MVI   RSRTYPE(REG6),X'00'                                 1165
*                     RSRFREE = ON;     /* FREERCD  */             1166
         OI    RSRFREE(REG6),B'00000001'                           1166
*                     RSRUPD = ON;      /* UPDATE  */              1167
         OI    RSRUPD(REG6),B'00001000'                            1167
*                     RSRDS = ''B;                                 1168
         NI    RSRDS(REG6),B'00011111'                             1168
*                     RSRWF = ON;       /* WORKFILE  */            1169
*                     RSRDIR = ON;      /* DIRECT  */              1170
*                     RSRKEY = ON;      /* KEY  */                 1171
*                                                                  1171
         OI    RSRWF(REG6),B'10010100'                             1171
*                   /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  */
*                   CALL RECMGMT;                                  1172
         L     @15,@CV03458                                        1172
         BALR  @14,@15                                             1172
*                     RFY RTNREG RSTD;                             1173
*                     TESTRC = RTNREG;                             1174
         STH   RTNREG,TESTRC(,REG6)                                1174
*                     RFY RTNREG UNRSTD;                           1175
*                   END;                                           1176
*                END;                                              1177
*              PTASSCUR = PTASSCUR + LENGTH(TASSENT);              1178
@RF01161 L     @07,RSPTWKC(,REG6)                                  1178
         LA    @04,4                                               1178
         AL    @04,PTASSCUR(,@07)                                  1178
         ST    @04,PTASSCUR(,@07)                                  1178
*            END;                                                  1179
         L     @04,RSPTWKC(,REG6)                                  1179
         LA    @07,1                                               1179
         AH    @07,PTINDX3(,@04)                                   1179
@DE01160 L     @04,RSPTWKC(,REG6)                                  1179
         STH   @07,PTINDX3(,@04)                                   1179
         L     @04,RSPTWKC(,REG6)                                  1179
         L     @04,PTASSOC(,@04)                                   1179
         CH    @07,TASSNENT(,@04)                                  1179
         BNH   @DL01160                                            1179
*          END SETNVER;                                            1180
*                                                                  1180
*        /************************************************************/
*        /*                                                          */
*        /*                       THAT'S ALL FOLKS                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1181
*        IF GDTDBG = NULLPTR                                       1181
*          THEN;                                                   1181
@RC00932 L     @07,GDTDBG(,REG5)                                   1181
         LTR   @07,@07                                             1181
         BZ    @RT01181                                            1181
*          ELSE                                                    1183
*            CALL IDCDB010(GDTTBL,'RSS2');                         1183
         ST    REG5,@AL00001                                       1183
         LA    @07,@CC03823                                        1183
         ST    @07,@AL00001+4                                      1183
         MVI   @AL00001+4,X'80'                                    1183
         L     @15,GDTDBG(,REG5)                                   1183
         LA    @01,@AL00001                                        1183
         BALR  @14,@15                                             1183
*        RFY TASSO;                    /*REVERT                      */
@RT01181 DS    0H                                                  1185
*        RFY DITABE;                   /*REVERT                      */
*                                                                  1185
* CALL EXIT;  /*TERMINATE*/                                        1186
         BAL   @14,EXIT                                            1186
* END SETCI; /*END OF PROCEDURE*/                                  1187
@EL00008 DS    0H                                                  1187
@EF00008 DS    0H                                                  1187
@ER00008 BR    @14                                                 1187
@PB00008 DS    0H                                                  1188
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERA                                                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     VERIFY ANY ALIASES FOR ALIENS.                               */
*/*     VERIFY GDG ASSOCIATIONS.                                     */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE PATH                            */
*/*     RSGDGLN - LENGTH OF THE BASE NAME.                           */
*/*     RSGDGNM - GDG BASE NAME.                                     */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*     CITFAVER - SET ON IN USERCATALOG RECORD TO                   */
*/*                INDICATE THAT THE ENTRY IS GOOD.                  */
*/*     DITFAVER - SET ON IN THE GDG BASE ASSOCIATION IF VERIFIED    */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1188
         DS    0F
NAME0112 DC    CL8'VERA'
*VERA: PROCEDURE                                                   1189
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1189
*                                                                  1189
         B     @PB00009                                            1189
VERA     DS    0H                                                  1190
*      GENERATE REFS(RS02RG08, REG6);                              1190
*                                                                  1190
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0112  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      1191
         L     @07,GDTTR2(,REG5)                                   1191
         MVC   @TS00001(95),NEWERID2(@07)                          1191
         MVC   OLDERID2(95,@07),@TS00001                           1191
*        NEWID2 = 'RSVA';                                          1192
*                                                                  1192
         MVC   NEWID2(4,@07),@CC03828                              1192
*        /************************************************************/
*        /*                                                          */
*        /*  INDICATE THE NON-VSAM RECORD AS VERIFIED                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1193
*        PTCITF->CITFAVER = ON;                                    1193
*                                                                  1193
         L     @07,RSPTWKC(,REG6)                                  1193
         L     @07,PTCITF(,@07)                                    1193
         OI    CITFAVER(@07),B'01000000'                           1193
*        /************************************************************/
*        /*                                                          */
*        /*  VERIFY ANY ALIASES OF THE ALIEN                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1194
*        CALL VERX;                                                1194
*                                                                  1194
         BAL   @14,VERX                                            1194
*        /************************************************************/
*        /*                                                          */
*        /*   VERIFY GDG ASSOCIATIONS                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1195
*        IF RSPTWKF->PTCITF->CITTYPE = GDGID THEN                  1195
         L     @07,RSPTWKF(,REG6)                                  1195
         L     @07,PTCITF(,@07)                                    1195
         CLI   CITTYPE(@07),C'B'                                   1195
         BNE   @RF01195                                            1195
*  VERAB:                                                          1196
*          DO;                                                     1196
*                                                                  1196
VERAB    DS    0H                                                  1197
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE ASSOCIATION TO THE GDG BASE (A->B)            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1197
*            PTF1OK = OFF;             /*ASSUME GUILTY               */
         L     @07,RSPTWKC(,REG6)                                  1197
         NI    PTF1OK(@07),B'11011111'                             1197
*            PTLOC = PTLOC && PTLOC;                               1198
         XC    PTLOC(20,@07),PTLOC(@07)                            1198
*            PTLBCITX = PTCITI;        /*SCAN THE ALIEN              */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1199
*            PTLFBAS1 = ON;            /*SCAN FOR ASSOCIATION        */
         OI    PTLFBAS1(@07),B'00100000'                           1200
*            PTLDITID = GDGID;         /*TO THE GDG BASE             */
         MVI   PTLDITID(@07),C'B'                                  1201
*            CALL LOCDIT;                                          1202
         BAL   @14,LOCDIT                                          1202
*                                      /*FIND A->B                   */
*            IF PTLCDIT ^= 0 THEN      /*ENSURE BASE SAME AS OURS    */
         L     @07,RSPTWKC(,REG6)                                  1203
         L     @07,PTLCDIT(,@07)                                   1203
         LTR   @07,@07                                             1203
         BZ    @RF01203                                            1203
*              DO;                                                 1204
*                RSTENTAD = ADDR(RSGCITS);                         1205
         LA    @04,RSGCITS(,REG6)                                  1205
         ST    @04,RSTENTAD(,REG6)                                 1205
*                RSTENTIX = PTLCDIT->DITCITAB;                     1206
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1206
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */
*                CALL GETNEXTE;                                    1207
         L     @15,@CV03436                                        1207
         BALR  @14,@15                                             1207
*                IF RSTENTAD->CITCIN ^= RSPTWKF->PTCITF->CITCIN THEN
         L     @07,RSTENTAD(,REG6)                                 1208
         L     @04,RSPTWKF(,REG6)                                  1208
         L     @04,PTCITF(,@04)                                    1208
         CLC   CITCIN(3,@07),CITCIN(@04)                           1208
         BE    @RF01208                                            1208
*                  PTLCDIT = 0;        /*INDICATE BASE INVALID       */
         L     @07,RSPTWKC(,REG6)                                  1209
         SLR   @04,@04                                             1209
         ST    @04,PTLCDIT(,@07)                                   1209
*              END;                                                1210
@RF01208 DS    0H                                                  1211
*            IF PTLCDIT = 0 THEN;      /*BASE INVALID                */
*                                                                  1211
@RF01203 L     @07,RSPTWKC(,REG6)                                  1211
         L     @07,PTLCDIT(,@07)                                   1211
         LTR   @07,@07                                             1211
         BZ    @RT01211                                            1211
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE THE GDG DATA SET NAME IS CORRECT              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1213
*            ELSE                                                  1213
*  VERAGDGN:                                                       1213
*              DO;                                                 1213
VERAGDGN DS    0H                                                  1214
*                PTASSDIT(1) = PTLCDIT; /*SAVE A->B                  */
         L     @07,RSPTWKC(,REG6)                                  1214
         L     @04,PTLCDIT(,@07)                                   1214
         ST    @04,PTASSDIT(,@07)                                  1214
*                                      /* FORM EXPECTED NAME         */
*                RSGDGNM(RSGDGLN+1:RSGDGLN+2) = '.G';              1215
         LH    @15,RSGDGLN(,REG6)                                  1215
         ALR   @15,REG6                                            1215
         MVC   RSGDGNM(2,@15),@CC03834                             1215
*                RSGDGNM(RSGDGLN+3:RSGDGLN+6) = PTLCDIT->DITDGML;  1216
         LH    @15,RSGDGLN(,REG6)                                  1216
         ALR   @15,REG6                                            1216
         MVC   RSGDGNM+2(4,@15),DITDGML(@04)                       1216
*                RSGDGNM(RSGDGLN+7:RSGDGLN+9) = 'V00';             1217
         LH    @04,RSGDGLN(,REG6)                                  1217
         ALR   @04,REG6                                            1217
         MVC   RSGDGNM+6(3,@04),@CC03835                           1217
*                GRABCURR=RABARRAY(ADDR(PTASSOC->TASSEN(1))->TASSRAB);
         L     @04,RSGRABCU(,REG6)                                 1218
         L     @07,PTASSOC(,@07)                                   1218
         LA    @07,TASSEN(,@07)                                    1218
         LH    @07,TASSRAB(,@07)                                   1218
         SLA   @07,2                                               1218
         L     @07,RABARRAY-4(@07,@04)                             1218
         ST    @07,GRABCURR(,@04)                                  1218
*                                      /*DEFAULT TO ALIEN BUFFER     */
*                DO PTINDX3 = 1 TO RSGDGLN + LENGTH(G0000V00)      1219
*                 WHILE (RSGDGNM(PTINDX3:PTINDX3) =                1219
*                       CNAME(PTINDX3:PTINDX3));                   1219
         LA    @07,1                                               1219
         B     @DE01219                                            1219
@DL01219 L     @07,RSPTWKC(,REG6)                                  1219
         LH    @07,PTINDX3(,@07)                                   1219
         L     @04,RSGRABCU(,REG6)                                 1219
         L     @04,GRABCURR(,@04)                                  1219
         ST    @07,@TF00001                                        1219
         ALR   @07,REG6                                            1219
         AL    @04,@TF00001                                        1219
         CLC   RSGDGNM-1(1,@07),CNAME+7(@04)                       1219
         BNE   @DC01219                                            1219
*                END;                                              1220
         L     @04,RSPTWKC(,REG6)                                  1220
         LA    @07,1                                               1220
         AH    @07,PTINDX3(,@04)                                   1220
@DE01219 L     @04,RSPTWKC(,REG6)                                  1220
         STH   @07,PTINDX3(,@04)                                   1220
         LA    @04,9                                               1220
         AH    @04,RSGDGLN(,REG6)                                  1220
         CR    @07,@04                                             1220
         BNH   @DL01219                                            1220
@DC01219 DS    0H                                                  1221
*                IF PTINDX3 ^= RSGDGLN + LENGTH(G0000V00) + 1 THEN;
         L     @07,RSPTWKC(,REG6)                                  1221
         LA    @04,10                                              1221
         AH    @04,RSGDGLN(,REG6)                                  1221
         CH    @04,PTINDX3(,@07)                                   1221
         BNE   @RT01221                                            1221
*                                      /*ERROR WRONG NAME            */
*                                                                  1223
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE THE ASSOCIATION FROM THE GDG BASE TO THE      */
*        /*     ALIEN IS GOOD. (B->A)                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1223
*                ELSE                                              1223
*                  DO;                                             1223
*                    PTLOC = PTLOC && PTLOC;                       1224
         L     @07,RSPTWKC(,REG6)                                  1224
         XC    PTLOC(20,@07),PTLOC(@07)                            1224
*                    PTLBCITX = RSPTWKF->PTCITI; /*SCAN GDG BASE     */
         L     @04,RSPTWKF(,REG6)                                  1225
         MVC   PTLBCITX(3,@07),PTCITI(@04)                         1225
*                    PTLFBAS1 = ON;    /*ASSOCIATION SCAN            */
         OI    PTLFBAS1(@07),B'00100000'                           1226
*                    PTLDITID = NVID;  /*FIND B->A                   */
         MVI   PTLDITID(@07),C'A'                                  1227
*                    PTF1ENDA = OFF;   /* LOOP CONTROL               */
*                                                                  1228
         NI    PTF1ENDA(@07),B'11111110'                           1228
*                    DO WHILE(PTF1ENDA=OFF);                       1229
         B     @DE01229                                            1229
@DL01229 DS    0H                                                  1230
*                      CALL LOCDIT;                                1230
         BAL   @14,LOCDIT                                          1230
*                                      /*FIND NEXT ALIEN ASSN ON GDG */
*                      IF PTLCDIT = 0 THEN /*NO B->A                 */
*                                                                  1231
         L     @07,RSPTWKC(,REG6)                                  1231
         L     @07,PTLCDIT(,@07)                                   1231
         LTR   @07,@07                                             1231
         BNZ   @RF01231                                            1231
*                        DO;                                       1232
*                        /*CALL CKERR*/                            1233
*                          RSCKERR = RSCKERR && RSCKERR;           1233
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1233
*                          RSCKERN = RSE100;                       1234
         MVC   RSCKERN(2,REG6),@CH00143                            1234
*                          RSCKTERM = 'TERM';                      1235
*                                                                  1235
         MVC   RSCKTERM(4,REG6),@CC03762                           1235
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               1236
         L     @15,@CV03449                                        1236
         BALR  @14,@15                                             1236
*                        END; /*NEVER HAPPEN     */                1237
*                                                                  1237
*                      RSTANCHR = ADDR(RSGCITS);                   1238
@RF01231 LA    @07,RSGCITS(,REG6)                                  1238
         ST    @07,RSTANCHR(,REG6)                                 1238
*                      RSTENTIX = PTLCDIT->DITCITAB; /*ALIEN CITAB   */
         L     @07,RSPTWKC(,REG6)                                  1239
         L     @07,PTLCDIT(,@07)                                   1239
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1239
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE
*                                                                    */
*                      CALL GETNEXTE; /*GET NON-VSAM CITABE       */
         L     @15,@CV03436                                        1240
         BALR  @14,@15                                             1240
*                      IF RSTENTAD->CITCIN = PTCITF->CITCIN THEN   1241
         L     @07,RSTENTAD(,REG6)                                 1241
         L     @04,RSPTWKC(,REG6)                                  1241
         L     @01,PTCITF(,@04)                                    1241
         CLC   CITCIN(3,@07),CITCIN(@01)                           1241
         BNE   @RF01241                                            1241
*                        DO;           /*B->OUR A                    */
*                          PTF1ENDA = ON; /*FOUND B->A               */
*                                                                  1243
         OI    PTF1ENDA(@04),B'00000001'                           1243
*        /************************************************************/
*        /*                                                          */
*        /*     VERIFY GEN LEVEL - MUST BE THE SAME AS THE           */
*        /*     ONE VERIFIED IN THE ALIEN ASSOCIATION TO THE BASE    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1244
*                          IF PTLCDIT->DITDGML = PTASSDIT(1)->DITDGML
*                           THEN                                   1244
         L     @07,PTLCDIT(,@04)                                   1244
         L     @15,PTASSDIT(,@04)                                  1244
         CLC   DITDGML(4,@07),DITDGML(@15)                         1244
         BNE   @RF01244                                            1244
*                            DO;                                   1245
*                              PTLCDIT->DITFAVER=ON; /*B->A OK       */
         OI    DITFAVER(@07),B'01000000'                           1246
*                              PTASSDIT(1)->DITFAVER=ON; /*A->B OK   */
         OI    DITFAVER(@15),B'01000000'                           1247
*                              PTF1OK = ON; /*GDG OK                 */
*                              PTF1ENDA = ON; /*GDG OK               */
         OI    PTF1OK(@04),B'00100001'                             1249
*                            END;                                  1250
*                        END;                                      1251
@RF01244 DS    0H                                                  1252
*                    END;                                          1252
@RF01241 DS    0H                                                  1252
@DE01229 L     @07,RSPTWKC(,REG6)                                  1252
         TM    PTF1ENDA(@07),B'00000001'                           1252
         BZ    @DL01229                                            1252
*                  END;                                            1253
*              END VERAGDGN;                                       1254
*                                                                  1254
@RT01221 DS    0H                                                  1255
*        /************************************************************/
*        /*                                                          */
*        /*     IF GDG DATA SET FAILED ASSOCIATION CHECK, ISSUE      */
*        /*     MESSAGE IDC21032I.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1255
*            IF PTF1OK = OFF THEN      /*ERROR FOR THIS GDG          */
*                                                                  1255
@RT01211 L     @07,RSPTWKC(,REG6)                                  1255
         TM    PTF1OK(@07),B'00100000'                             1255
         BNZ   @RF01255                                            1255
*              DO;                                                 1256
*              /*CALL CKERR*/                                      1257
*                RSCKERR = RSCKERR && RSCKERR;                     1257
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1257
*                RSCKERN = RSE041;                                 1258
         MVC   RSCKERN(2,REG6),@CH00969                            1258
*                RSCKTERM = 'RETU';                                1259
         MVC   RSCKTERM(4,REG6),@CC03787                           1259
*                RSCKMVAR(1) = ADDR(PTBASE->CNAME);                1260
         L     @07,PTBASE(,@07)                                    1260
         LA    @07,CNAME(,@07)                                     1260
         ST    @07,RSCKMVAR(,REG6)                                 1260
*                RSCKMVAR(2) = ADDR(NVID);                         1261
         LA    @07,@CC00808                                        1261
         ST    @07,RSCKMVAR+4(,REG6)                               1261
*                RSCKMVAR(3) = ADDR(GDGID);                        1262
*                                                                  1262
         LA    @07,@CC00810                                        1262
         ST    @07,RSCKMVAR+8(,REG6)                               1262
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */
*              CALL CKERR;                                         1263
         L     @15,@CV03449                                        1263
         BALR  @14,@15                                             1263
*              END;                                                1264
*          END VERAB;                                              1265
*                                                                  1265
*        /************************************************************/
*        /*                                                          */
*        /*   FOR NON-GDG, VERIFY THAT NO GDG ASSOCIATION EXISTS     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1266
*        ELSE                                                      1266
*  VERANOB:                                                        1266
*          DO;                                                     1266
         B     @RC01195                                            1266
@RF01195 DS    0H                                                  1266
VERANOB  DS    0H                                                  1267
*            PTLOC = PTLOC && PTLOC;                               1267
         L     @07,RSPTWKC(,REG6)                                  1267
         XC    PTLOC(20,@07),PTLOC(@07)                            1267
*            PTLBCITX = PTCITI;        /*SCAN NON-VSAM               */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1268
*            PTLFBAS1 = ON;            /*FOR AN ASSOCIATION          */
         OI    PTLFBAS1(@07),B'00100000'                           1269
*            PTLDITID = GDGID;         /*TO A GDG BASE RECORD        */
         MVI   PTLDITID(@07),C'B'                                  1270
*            CALL LOCDIT;                                          1271
         BAL   @14,LOCDIT                                          1271
*            IF PTLCDIT ^= 0 THEN      /*ERROR IF GDG ASSN           */
*                                                                  1272
         L     @07,RSPTWKC(,REG6)                                  1272
         L     @04,PTLCDIT(,@07)                                   1272
         LTR   @04,@04                                             1272
         BZ    @RF01272                                            1272
*              DO;                                                 1273
*              /*CALL CKERR*/                                      1274
*                RSCKERR = RSCKERR && RSCKERR;                     1274
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1274
*                RSCKERN = RSE041;                                 1275
         MVC   RSCKERN(2,REG6),@CH00969                            1275
*                RSCKTERM = 'RETU';                                1276
         MVC   RSCKTERM(4,REG6),@CC03787                           1276
*                RSCKMVAR(1) = ADDR(PTBASE->CNAME);                1277
         L     @07,PTBASE(,@07)                                    1277
         LA    @07,CNAME(,@07)                                     1277
         ST    @07,RSCKMVAR(,REG6)                                 1277
*                RSCKMVAR(2) = ADDR(NVID);                         1278
         LA    @07,@CC00808                                        1278
         ST    @07,RSCKMVAR+4(,REG6)                               1278
*                RSCKMVAR(3) = ADDR(GDGID);                        1279
*                                                                  1279
         LA    @07,@CC00810                                        1279
         ST    @07,RSCKMVAR+8(,REG6)                               1279
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */
*              CALL CKERR;                                         1280
         L     @15,@CV03449                                        1280
         BALR  @14,@15                                             1280
*              END;                                                1281
*          END;                                                    1282
*                                                                  1282
@RF01272 DS    0H                                                  1283
* CALL EXIT;  /*TERMINATE*/                                        1283
@RC01195 BAL   @14,EXIT                                            1283
* END VERA; /*END OF PROCEDURE*/                                   1284
@EL00009 DS    0H                                                  1284
@EF00009 DS    0H                                                  1284
@ER00009 BR    @14                                                 1284
@PB00009 DS    0H                                                  1285
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERC                                                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    VERIFY CLUSTER BASE ASSOCIATIONS.                             */
*/*    FOR AN ESDS OR RRDS                                           */
*/*      CLUSTER<->DATA                                              */
*/*    FOR A KSDS                                                    */
*/*      CLUSTER<->DATA AND CLUSTER<->INDEX                          */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE CLUSTER                         */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    CITFAVER - SET ON IN CLUSTER, DATA, AND INDEX FOR THE RECORD  */
*/*               IF ASSOCIATION CHECKED                             */
*/*    DITFAVER - SET ON IN CLUSTER, DATA, AND INDEX FOR THE ASSN    */
*/*               IF ASSOCIATION CHECKED                             */
*/*    PTF2KSDS - SET ON IF CLUSTER IS KSDS                          */
*/*    GRABRAB5 - THE CLUSTER RECORD IS COPIED TO RAB5 FOR ALL       */
*/*               LOWER LEVEL ASSOCIATION CHECKING                   */
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*    IDC11023I - INVALID ASSOCIATION.                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1285
         DS    0F
NAME0126 DC    CL8'VERC'
*VERC: PROCEDURE                                                   1286
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1286
*                                                                  1286
         B     @PB00010                                            1286
VERC     DS    0H                                                  1287
*      GENERATE REFS(RS02RG08, REG6);                              1287
*                                                                  1287
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0126  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      1288
         L     @07,GDTTR2(,REG5)                                   1288
         MVC   @TS00001(95),NEWERID2(@07)                          1288
         MVC   OLDERID2(95,@07),@TS00001                           1288
*        NEWID2 = 'RSVC';                                          1289
*                                                                  1289
         MVC   NEWID2(4,@07),@CC03842                              1289
*        RFY DITABE BASED(PTLCDIT);                                1290
*                                                                  1290
*        /************************************************************/
*        /*                                                          */
*        /* SAVE CLUSTER RECORD IN BUFFER 5 TO BE REFERENCED         */
*        /* FOR MESSAGES                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1291
*        RSGRABCU = ADDR(GRABSWF);                                 1291
         L     @07,RSIOTBL(,REG6)                                  1291
         ST    @07,RSGRABCU(,REG6)                                 1291
*        RSWFBP1 = GRABRAB5;                                       1292
         L     @04,GRABRAB5(,@07)                                  1292
         ST    @04,RSWFBP1(,REG6)                                  1292
*        RSWFBP2 = GRABRAB1;                                       1293
         L     @07,GRABRAB1(,@07)                                  1293
         ST    @07,RSWFBP2(,REG6)                                  1293
*        WFBUF1(1:256) = WFBUF2(1:256);                            1294
         MVC   WFBUF1(256,@04),WFBUF2(@07)                         1294
*        WFBUF1(257:CELEN) = WFBUF2(257:CELEN);                    1295
*                                                                  1295
         MVC   WFBUF1+256(249,@04),WFBUF2+256(@07)                 1295
*        /************************************************************/
*        /*                                                          */
*        /* CLUSTER<->DATA                                           */
*        /*     ENSURE TWO WAY ASSOCIATION BETWEEN CLUSTER AND DATA  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1296
*        PTASSOE1 = PTASSOE1 && PTASSOE1; /*CLEAR ERROR ASSN         */
         L     @07,RSPTWKC(,REG6)                                  1296
         XC    PTASSOE1(40,@07),PTASSOE1(@07)                      1296
*        PTF1OK = ON;                  /*INNOCENT UNTIL PROVEN GUILTY*/
*                                                                  1297
         OI    PTF1OK(@07),B'00100000'                             1297
*        /************************************************************/
*        /*                                                          */
*        /*     GET FIRST ASSOCIATION FROM CLUSTER                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1298
*        PTLOC = PTLOC && PTLOC;                                   1298
         XC    PTLOC(20,@07),PTLOC(@07)                            1298
*        PTLBCITX = PTCITI;            /*CLUSTER INDEX               */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1299
*        PTLFBAS1 = ON;                /*ASSOCIATION ONLY SCAN       */
         OI    PTLFBAS1(@07),B'00100000'                           1300
*        PTLSN = 1;                    /*1ST ASSOCIATION             */
         MVC   PTLSN(2,@07),@CH00212                               1301
*        CALL LOCDIT;                                              1302
*                                                                  1302
         BAL   @14,LOCDIT                                          1302
*        /************************************************************/
*        /*                                                          */
*        /*     IF NO DATA ASSOCIATION, ISSUE MESSAGE IDC11023I      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1303
*        IF PTLCDIT = 0 THEN                                       1303
         L     @07,RSPTWKC(,REG6)                                  1303
         L     @04,PTLCDIT(,@07)                                   1303
         LTR   @04,@04                                             1303
         BNZ   @RF01303                                            1303
*          DO;                                                     1304
*            PTF1OK = OFF;             /*BAD ASSOCIATION             */
*                                                                  1305
         NI    PTF1OK(@07),B'11011111'                             1305
*            DO;                                                   1306
*            /*CALL CKERR*/                                        1307
*              RSCKERR = RSCKERR && RSCKERR;                       1307
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1307
*              RSCKERN = RSE041;                                   1308
         MVC   RSCKERN(2,REG6),@CH00969                            1308
*              RSCKTERM = 'RETU';                                  1309
         MVC   RSCKTERM(4,REG6),@CC03787                           1309
*              RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RABBUF)->CNAME);  1310
         L     @07,RSGRABCU(,REG6)                                 1310
         L     @07,GRABRAB5(,@07)                                  1310
         LA    @07,CNAME+8(,@07)                                   1310
         ST    @07,RSCKMVAR(,REG6)                                 1310
*              RSCKMVAR(2) = ADDR(CLID);                           1311
         LA    @07,@CC00800                                        1311
         ST    @07,RSCKMVAR+4(,REG6)                               1311
*              RSCKMVAR(3) = ADDR(DATAID);                         1312
*                                                                  1312
         LA    @07,@CC00802                                        1312
         ST    @07,RSCKMVAR+8(,REG6)                               1312
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1313
         L     @15,@CV03449                                        1313
         BALR  @14,@15                                             1313
*            END;                                                  1314
*          END;                                                    1315
*                                                                  1315
*        /************************************************************/
*        /*                                                          */
*        /*     GET DATA RECORD ENTRY                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1316
*        ELSE                                                      1316
*  VERCDATA:                                                       1316
*          DO;                                                     1316
         B     @RC01303                                            1316
@RF01303 DS    0H                                                  1316
VERCDATA DS    0H                                                  1317
*            RSTANCHR = ADDR(RSGCITS);                             1317
         LA    @07,RSGCITS(,REG6)                                  1317
         ST    @07,RSTANCHR(,REG6)                                 1317
*            RSTENTIX = DITCITAB;      /*DATA RECORD                 */
         L     @07,RSPTWKC(,REG6)                                  1318
         L     @07,PTLCDIT(,@07)                                   1318
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1318
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE        */
*            CALL GETNEXTE;                                        1319
         L     @15,@CV03436                                        1319
         BALR  @14,@15                                             1319
*            PTCITCUR = RSTENTAD;                                  1320
*                                                                  1320
         L     @07,RSPTWKC(,REG6)                                  1320
         L     @04,RSTENTAD(,REG6)                                 1320
         ST    @04,PTCITCUR(,@07)                                  1320
*        /************************************************************/
*        /*                                                          */
*        /*     IF NOT DATA RECORD, ISSUE MESSAGE IDC11023I          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1321
*            IF CITTYPE ^= DATAID THEN                             1321
         CLI   CITTYPE(@04),C'D'                                   1321
         BE    @RF01321                                            1321
*              DO;                                                 1322
*                PTF1OK = OFF;         /*BAD ASSOCIATION             */
*                                                                  1323
         NI    PTF1OK(@07),B'11011111'                             1323
*                DO;                                               1324
*                /*CALL CKERR*/                                    1325
*                  RSCKERR = RSCKERR && RSCKERR;                   1325
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1325
*                  RSCKERN = RSE041;                               1326
         MVC   RSCKERN(2,REG6),@CH00969                            1326
*                  RSCKTERM = 'RETU';                              1327
         MVC   RSCKTERM(4,REG6),@CC03787                           1327
*                  RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RABBUF)->CNAME);
         L     @07,RSGRABCU(,REG6)                                 1328
         L     @07,GRABRAB5(,@07)                                  1328
         LA    @07,CNAME+8(,@07)                                   1328
         ST    @07,RSCKMVAR(,REG6)                                 1328
*                  RSCKMVAR(2) = ADDR(CLID);                       1329
         LA    @07,@CC00800                                        1329
         ST    @07,RSCKMVAR+4(,REG6)                               1329
*                  RSCKMVAR(3) = ADDR(DATAID);                     1330
*                                                                  1330
         LA    @07,@CC00802                                        1330
         ST    @07,RSCKMVAR+8(,REG6)                               1330
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */
*                CALL CKERR;                                       1331
         L     @15,@CV03449                                        1331
         BALR  @14,@15                                             1331
*                END;                                              1332
*              END;                                                1333
*                                                                  1333
*        /************************************************************/
*        /*                                                          */
*        /*     IF DATA, ENSURE VALID RECORD                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1334
*            ELSE                                                  1334
*              DO;                                                 1334
         B     @RC01321                                            1334
@RF01321 DS    0H                                                  1335
*                PTASSCIT(1) = PTCITCUR; /*SAVE DATA CI ENTRY        */
         L     @07,RSPTWKC(,REG6)                                  1335
         L     @04,PTCITCUR(,@07)                                  1335
         ST    @04,PTASSCIT(,@07)                                  1335
*                IF CITFAINV = ON THEN                             1336
         TM    CITFAINV(@04),B'00000010'                           1336
         BNO   @RF01336                                            1336
*                  PTF1OK = OFF;                                   1337
*                                                                  1337
         NI    PTF1OK(@07),B'11011111'                             1337
*        /************************************************************/
*        /*                                                          */
*        /*     CLUSTER->DATA, MARK ASSOCIATION CHECKED              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1338
*                ELSE                                              1338
*                  DO;                                             1338
         B     @RC01336                                            1338
@RF01336 DS    0H                                                  1339
*                    DITFAVER = ON;                                1339
*                                                                  1339
         L     @07,RSPTWKC(,REG6)                                  1339
         L     @04,PTLCDIT(,@07)                                   1339
         OI    DITFAVER(@04),B'01000000'                           1339
*        /************************************************************/
*        /*                                                          */
*        /*     GET FIRST ASSOCIATION FROM DATA                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1340
*                    PTCITWK = DITCITAB; /*SAVE INDEX DATA CIT       */
         L     @04,DITCITAB-1(,@04)                                1340
         LA    @04,0(,@04)                                         1340
         ST    @04,PTCITWK(,@07)                                   1340
*                    PTLOC = PTLOC && PTLOC;                       1341
         XC    PTLOC(20,@07),PTLOC(@07)                            1341
*                    PTLBCITX = PTCITWK; /*DATA RECORD SCAN          */
         STCM  @04,7,PTLBCITX(@07)                                 1342
*                    PTLFBAS1 = ON;    /*ASSOCIATION ONLY SCAN       */
         OI    PTLFBAS1(@07),B'00100000'                           1343
*                    PTLSN = 1;        /*1ST ASSOCIATION             */
         MVC   PTLSN(2,@07),@CH00212                               1344
*                    CALL LOCDIT;                                  1345
*                                                                  1345
         BAL   @14,LOCDIT                                          1345
*        /************************************************************/
*        /*                                                          */
*        /*     IF NO CLUSTER ASSOCIATION, MARK ERROR                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1346
*                    IF PTLCDIT = 0 THEN                           1346
         L     @07,RSPTWKC(,REG6)                                  1346
         L     @04,PTLCDIT(,@07)                                   1346
         LTR   @04,@04                                             1346
         BNZ   @RF01346                                            1346
*                      PTF1OK = OFF;                               1347
*                                                                  1347
         NI    PTF1OK(@07),B'11011111'                             1347
*        /************************************************************/
*        /*                                                          */
*        /*     INDEX->CLUSTER, MARK ASSOCIATION CHECKED             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1348
*                    ELSE                                          1348
*                      IF DITCITAB = PTCITI THEN                   1348
         B     @RC01346                                            1348
@RF01346 L     @07,RSPTWKC(,REG6)                                  1348
         L     @04,PTLCDIT(,@07)                                   1348
         CLC   DITCITAB(3,@04),PTCITI(@07)                         1348
         BNE   @RF01348                                            1348
*                        DO;                                       1349
*                          DITFAVER = ON;                          1350
         OI    DITFAVER(@04),B'01000000'                           1350
*                          CITFAVER = ON; /*DATA VERIFIED            */
         L     @07,PTCITCUR(,@07)                                  1351
         OI    CITFAVER(@07),B'01000000'                           1351
*                        END;                                      1352
*                      ELSE                                        1353
*                        PTF1OK = OFF; /*DATA ^->CLUSTER             */
         B     @RC01348                                            1353
@RF01348 L     @07,RSPTWKC(,REG6)                                  1353
         NI    PTF1OK(@07),B'11011111'                             1353
*                  END;                                            1354
@RC01348 DS    0H                                                  1354
@RC01346 DS    0H                                                  1355
*              END;                                                1355
@RC01336 DS    0H                                                  1356
*          END VERCDATA;                                           1356
*                                                                  1356
@RC01321 DS    0H                                                  1357
*        /************************************************************/
*        /*                                                          */
*        /* CLUSTER<->INDEX                                          */
*        /*     IF CLUSTER<->DATA, CHECK FOR CLUSTER<->INDEX         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1357
*        IF PTF1OK = ON THEN                                       1357
@RC01303 L     @07,RSPTWKC(,REG6)                                  1357
         TM    PTF1OK(@07),B'00100000'                             1357
         BNO   @RF01357                                            1357
*  VERCINDX:                                                       1358
*          DO;                                                     1358
*                                                                  1358
VERCINDX DS    0H                                                  1359
*        /************************************************************/
*        /*                                                          */
*        /*     GET SECOND ASSOCIATION FROM CLUSTER                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1359
*            PTASSCIT(1) = 0;          /*RESET ASSN FOUND FOR ERROR  */
         L     @07,RSPTWKC(,REG6)                                  1359
         SLR   @04,@04                                             1359
         ST    @04,PTASSCIT(,@07)                                  1359
*            PTLOC = PTLOC && PTLOC;                               1360
         XC    PTLOC(20,@07),PTLOC(@07)                            1360
*            PTLBCITX = PTCITI;        /*CLUSTER INDEX               */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1361
*            PTLFBAS1 = ON;            /*ASSOCIATION ONLY SCAN       */
         OI    PTLFBAS1(@07),B'00100000'                           1362
*            PTLSN = 2;                /*SECOND ASSOCIATION ONLY     */
         MVC   PTLSN(2,@07),@CH00149                               1363
*            CALL LOCDIT;                                          1364
         BAL   @14,LOCDIT                                          1364
*                                      /* GET 2ND ASSOCIATION        */
*                                                                  1365
*        /************************************************************/
*        /*                                                          */
*        /*     IF NO ASSOCIATION, MUST BE ESDS OR RRDS              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1365
*            IF PTLCDIT = 0 THEN;                                  1365
*                                                                  1365
         L     @07,RSPTWKC(,REG6)                                  1365
         L     @07,PTLCDIT(,@07)                                   1365
         LTR   @07,@07                                             1365
         BZ    @RT01365                                            1365
*        /************************************************************/
*        /*                                                          */
*        /*     GET ASSOCIATION RECORD ENTRY                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1367
*            ELSE                                                  1367
*              DO;                                                 1367
*                RSTANCHR = ADDR(RSGCITS);                         1368
         LA    @07,RSGCITS(,REG6)                                  1368
         ST    @07,RSTANCHR(,REG6)                                 1368
*                RSTENTIX = DITCITAB;                              1369
         L     @07,RSPTWKC(,REG6)                                  1369
         L     @07,PTLCDIT(,@07)                                   1369
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1369
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */
*                CALL GETNEXTE;                                    1370
         L     @15,@CV03436                                        1370
         BALR  @14,@15                                             1370
*                PTCITCUR = RSTENTAD;                              1371
*                                                                  1371
         L     @07,RSPTWKC(,REG6)                                  1371
         L     @04,RSTENTAD(,REG6)                                 1371
         ST    @04,PTCITCUR(,@07)                                  1371
*        /************************************************************/
*        /*                                                          */
*        /*     IF NOT INDEX, MUST BE ESDS OR RRDS                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1372
*                IF CITTYPE ^= INDEXID THEN;                       1372
*                                                                  1372
         CLI   CITTYPE(@04),C'I'                                   1372
         BNE   @RT01372                                            1372
*        /************************************************************/
*        /*                                                          */
*        /*     KSDS - CHECK FOR VALID RECORD                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1374
*                ELSE                                              1374
*                  DO;                                             1374
*                    PTASSCIT(1) = PTCITCUR; /*SAVE INDEX CI ENTRY   */
         L     @07,RSPTWKC(,REG6)                                  1375
         L     @04,PTCITCUR(,@07)                                  1375
         ST    @04,PTASSCIT(,@07)                                  1375
*                    IF CITFAINV = ON THEN                         1376
         TM    CITFAINV(@04),B'00000010'                           1376
         BNO   @RF01376                                            1376
*                      PTF1OK = OFF;                               1377
*                                                                  1377
         NI    PTF1OK(@07),B'11011111'                             1377
*        /************************************************************/
*        /*                                                          */
*        /*     CLUSTER->INDEX, MARK ASSOCIATION CHECKED             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1378
*                    ELSE                                          1378
*                      DO;                                         1378
         B     @RC01376                                            1378
@RF01376 DS    0H                                                  1379
*                        DITFAVER = ON;                            1379
         L     @07,RSPTWKC(,REG6)                                  1379
         L     @04,PTLCDIT(,@07)                                   1379
         OI    DITFAVER(@04),B'01000000'                           1379
*                        PTF2KSDS = ON; /*NOTE THIS IS KSDS          */
*                                                                  1380
         OI    PTF2KSDS(@07),B'10000000'                           1380
*        /************************************************************/
*        /*                                                          */
*        /*     GET FIRST ASSOCIATION FROM INDEX                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1381
*                        PTCITWK = DITCITAB; /*SAVE INDEX INDEX CIT  */
         L     @04,DITCITAB-1(,@04)                                1381
         LA    @04,0(,@04)                                         1381
         ST    @04,PTCITWK(,@07)                                   1381
*                        PTLOC = PTLOC && PTLOC;                   1382
         XC    PTLOC(20,@07),PTLOC(@07)                            1382
*                        PTLBCITX = PTCITWK; /*INDEX AS BASE FOR SCAN*/
         STCM  @04,7,PTLBCITX(@07)                                 1383
*                        PTLFBAS1 = ON; /*ASSOCIATION ONLY           */
         OI    PTLFBAS1(@07),B'00100000'                           1384
*                        PTLSN = 1;    /*1ST ASSOCIATION             */
         MVC   PTLSN(2,@07),@CH00212                               1385
*                        CALL LOCDIT;                              1386
*                                                                  1386
         BAL   @14,LOCDIT                                          1386
*        /************************************************************/
*        /*                                                          */
*        /*     IF NO CLUSTER ASSOCIATION, MARK ERROR                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1387
*                        IF PTLCDIT = 0 THEN                       1387
         L     @07,RSPTWKC(,REG6)                                  1387
         L     @04,PTLCDIT(,@07)                                   1387
         LTR   @04,@04                                             1387
         BNZ   @RF01387                                            1387
*                          PTF1OK = OFF;                           1388
*                                                                  1388
         NI    PTF1OK(@07),B'11011111'                             1388
*        /************************************************************/
*        /*                                                          */
*        /*     INDEX->CLUSTER, MARK ASSOCIATION CHECKED             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1389
*                        ELSE                                      1389
*                          IF DITCITAB = PTCITI THEN               1389
         B     @RC01387                                            1389
@RF01387 L     @07,RSPTWKC(,REG6)                                  1389
         L     @04,PTLCDIT(,@07)                                   1389
         CLC   DITCITAB(3,@04),PTCITI(@07)                         1389
         BNE   @RF01389                                            1389
*                            DO;                                   1390
*                              DITFAVER = ON;                      1391
         OI    DITFAVER(@04),B'01000000'                           1391
*                              CITFAVER = ON; /*MARK VERIFIED        */
         L     @07,PTCITCUR(,@07)                                  1392
         OI    CITFAVER(@07),B'01000000'                           1392
*                            END;                                  1393
*                          ELSE                                    1394
*                            PTF1OK = OFF; /*INDEX^->CLUSTER         */
         B     @RC01389                                            1394
@RF01389 L     @07,RSPTWKC(,REG6)                                  1394
         NI    PTF1OK(@07),B'11011111'                             1394
*                      END;                                        1395
@RC01389 DS    0H                                                  1395
@RC01387 DS    0H                                                  1396
*                  END;                                            1396
@RC01376 DS    0H                                                  1397
*              END;                                                1397
@RT01372 DS    0H                                                  1398
*          END VERCINDX;                                           1398
*                                                                  1398
@RT01365 DS    0H                                                  1399
*        /************************************************************/
*        /*                                                          */
*        /* IF ERROR AND NO MESSAGE YET, ISSUE IDC11023I             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1399
*        IF PTF1OK=OFF & PTASSCIT(1)^=0 THEN                       1399
*                                                                  1399
@RF01357 L     @07,RSPTWKC(,REG6)                                  1399
         TM    PTF1OK(@07),B'00100000'                             1399
         BNZ   @RF01399                                            1399
         L     @07,PTASSCIT(,@07)                                  1399
         LTR   @07,@07                                             1399
         BZ    @RF01399                                            1399
*          DO;                                                     1400
*          /*CALL CKERR*/                                          1401
*            RSCKERR = RSCKERR && RSCKERR;                         1401
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1401
*            RSCKERN = RSE026;                                     1402
         MVC   RSCKERN(2,REG6),@CH00942                            1402
*            RSCKTERM = 'RETU';                                    1403
         MVC   RSCKTERM(4,REG6),@CC03787                           1403
*            RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RABBUF)->CNAME);    1404
         L     @04,RSGRABCU(,REG6)                                 1404
         L     @04,GRABRAB5(,@04)                                  1404
         LA    @04,CNAME+8(,@04)                                   1404
         ST    @04,RSCKMVAR(,REG6)                                 1404
*            RSCKMVAR(2) = ADDR(CLID);                             1405
         LA    @04,@CC00800                                        1405
         ST    @04,RSCKMVAR+4(,REG6)                               1405
*            RSCKMVAR(3) = ADDR(PTASSCIT(1)->CITCIN);              1406
         LA    @04,CITCIN(,@07)                                    1406
         ST    @04,RSCKMVAR+8(,REG6)                               1406
*            RSCKMVAR(4) = ADDR(PTASSCIT(1)->CITTYPE);             1407
*                                                                  1407
         LA    @07,CITTYPE(,@07)                                   1407
         ST    @07,RSCKMVAR+12(,REG6)                              1407
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */
*          CALL CKERR;                                             1408
         L     @15,@CV03449                                        1408
         BALR  @14,@15                                             1408
*          END;                                                    1409
*                                                                  1409
*        /************************************************************/
*        /*                                                          */
*        /* IF NO ERROR, MARK THE CLUSTER VERIFIED                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1410
*        IF PTF1OK = ON THEN                                       1410
@RF01399 L     @07,RSPTWKC(,REG6)                                  1410
         TM    PTF1OK(@07),B'00100000'                             1410
         BNO   @RF01410                                            1410
*          PTCITF->CITFAVER = ON;                                  1411
*                                                                  1411
         L     @07,PTCITF(,@07)                                    1411
         OI    CITFAVER(@07),B'01000000'                           1411
*        RFY DITABE;                   /*REVERT                      */
@RF01410 DS    0H                                                  1413
* CALL EXIT;  /*TERMINATE*/                                        1413
         BAL   @14,EXIT                                            1413
* END VERC; /*END OF PROCEDURE*/                                   1414
@EL00010 DS    0H                                                  1414
@EF00010 DS    0H                                                  1414
@ER00010 BR    @14                                                 1414
@PB00010 DS    0H                                                  1415
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERCI                                                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     VERCI IS THE MAIN DRIVER FOR VERIFYING ASSOCIATIONS. THE     */
*/*     BASE RECORDS ON WHICH ALL OTHER RECORDS DEPEND ON  ARE       */
*/*     CLUSTER(C), GDG BASE(B), NON-VSAM(A), USERCATALOG(U), AND    */
*/*     VOLUME(V). ASSOC LOCATED ONE OF THESE RECORDS AND PASSED     */
*/*     CONTROL TO PROCTYPE ALONG WITH A TABLE INDICATING ALL        */
*/*     OTHER VALID RECORD TYPES FOR THIS PARTICULAR BASE RECORD AND */
*/*     WHAT PROCESSING WAS TO BE PERFORMED. PROCTYPE SCANNED ALL    */
*/*     ASSOCIATED RECORDS FOR ASSOCIATIONS (AMONG OTHER THINGS) AND */
*/*     EVENTUALLY GIVES CONTROL TO VERCI.                           */
*/*                                                                  */
*/*     FOR EACH PARTICULAR BASE RECORD, ASSOCIATIONS ARE            */
*/*     CHECKED IN A MANNER TO AVOID THE LOSS OF AS LITTLE DATA      */
*/*     AS POSSIBLE. THE BASE ASSOCIATIONS ARE VERIFIED (E.G.,       */
*/*     CLUSTER<->DATA). AFTER A SOLID BASE IS DISCOVERED, ALL       */
*/*     SECONDARY SETS OF RECORDS OFF THE BASE ARE VERIFIED          */
*/*     (E.G., AIX'S, PATHS, UPGRADE SET). EACH SECONDARY SET IS     */
*/*     VERIFIED INDEPENDENTLY OF THE OTHER SECONDARY SETS.          */
*/*                                                                  */
*/*     FOR EXAMPLE, THE BASE CLUSTER IS VERIFIED; I.E., THE         */
*/*     CLUSTER TO DATA AND INDEX RELATIONSHIP ARE VERIFIED. IF      */
*/*     THIS IS IN ERROR, THEN THE CLUSTER AND ALL THINGS DEPENDENT  */
*/*     ON THE CLUSTER (E.G., AIX) WILL BE DELETED FROM THE CATALOG  */
*/*     (BY UPDCAT) AND ANY SUBALLOCATED SPACE WILL BE RETURNED FOR  */
*/*     SUBALLOCATION (BY PROCVOL). IF THE BASE IS FINE, THEN EACH   */
*/*     PATH OVER THE CLUSTER IS VERIFIED. IF A PATH FAILS IN        */
*/*     ASSOCIATION CHECKING, THEN THAT PATH WILL BE DELETED AND     */
*/*     PROCESSING CONTINUED ON THE CLUSTER; HENCE, IF A PATH        */
*/*     IS BAD, IT HAS NO EFFECT ON OTHER PATHS OR AIXS OR THE       */
*/*     UPGRADE SET. THEN EACH AIX IS CHECKED INDEPENDENTLY, ETC.    */
*/*     THIS IS TO ILLUSTRATE THAT AS MUCH AS POSSIBLE IS SAVED.     */
*/*     ALSO, THAT NO INCOMPLETE OBJECT WILL BE RESTORED IN THE      */
*/*     CATALOG.                                                   1415
*/*                                                                  */
*/*     VERCI PROCESSES THE FOLLOWING TYPES. EACH TYPE HAS A COMMENT */
*/*     TO INDICATE THE ORDER OF PROCESSING FOR THAT TYPE; SEE       */
*/*     THE LABEL CORRESPONDING TO THE TYPE FOR THE COMMENT.         */
*/*                                                                  */
*/*          RECORD-TYPE                    LABEL                    */
*/*                                                                  */
*/*          CLUSTER                        VERCL                    */
*/*          PATH                           VERPATH                  */
*/*          UPGRADE                        VERUPG                   */
*/*          AIX                            VERAIX                   */
*/*          GDG BASE                       VERGDG                   */
*/*          NON-VSAM                       VERNONV                  */
*/*          USERCATALOG                    VERUCAT                  */
*/*          VOLUME                         VERVOLR                  */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE OBJECT                          */
*/*    PTASSOC - ADDRESS OF THE ASSOCIATION TABLE FOR THE OBJECT     */
*/*    RSPTWKC - ADDRESS OF PTWORK (MAIN WORK AREA FOR ASSOCIATIONS) */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    CITFAVER - SET ON FOR RECORD IF ASSOCIATION CHECKED           */
*/*    DITFAVER - SET ON FOR ASSOCIATION IF ASSOCIATION CHECKED      */
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*    IDC21032I - ASSOCIATION TO RECORD WHICH DOESN'T EXIST         */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1415
         DS    0F
NAME0140 DC    CL8'VERCI'
*VERCI: PROCEDURE                                                  1416
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1416
*                                                                  1416
         B     @PB00011                                            1416
VERCI    DS    0H                                                  1417
*      GENERATE REFS(RS02RG08, REG6);                              1417
*                                                                  1417
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0140  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      1418
         L     @07,GDTTR2(,REG5)                                   1418
         MVC   @TS00001(95),NEWERID2(@07)                          1418
         MVC   OLDERID2(95,@07),@TS00001                           1418
*        NEWID2 = 'RSVE';                                          1419
         MVC   NEWID2(4,@07),@CC03852                              1419
*        RFY TASSO BASED(PTASSOC);     /*USE RECURSION TABLE         */
*                                                                  1420
*        /*************************CLUSTER****************************/
*        /* PROCESS A CLUSTER ENTRY                                  */
*        /*     VERIFY THE CLUSTER BASE ASSOCIATIONS                 */
*        /*     PROCESS ALL PATHS                                    */
*        /*     PROCESS THE UPGRADE SET IF FOUND                     */
*        /*     PROCESS ALL AIXS IF NO UPGRADE                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1421
*  VERCL:                                                          1421
*        IF TASSID = CLID THEN                                     1421
VERCL    L     @07,RSPTWKC(,REG6)                                  1421
         L     @07,PTASSOC(,@07)                                   1421
         CLI   TASSID(@07),C'C'                                    1421
         BNE   @RF01421                                            1421
*          DO;                                                     1422
*            CALL VERC;             /*VERIFY CLUSTER ASSOCIATIONS */
         BAL   @14,VERC                                            1423
*            IF PTCITF->CITFAVER = ON THEN                         1424
         L     @07,RSPTWKC(,REG6)                                  1424
         L     @07,PTCITF(,@07)                                    1424
         TM    CITFAVER(@07),B'01000000'                           1424
         BNO   @RF01424                                            1424
*                                      /*CHECK SUBSETS IF CLUSTER OK */
*              DO;                                                 1425
*                                                                  1425
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS ALL PATHS ON THE CLUSTER                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1426
*  VERCPATH:                                                       1426
*                DO PTCITNC = PTCITI TO PTCITL;                    1426
VERCPATH L     @07,RSPTWKC(,REG6)                                  1426
         L     @07,PTCITI-1(,@07)                                  1426
         LA    @07,0(,@07)                                         1426
         B     @DE01426                                            1426
@DL01426 DS    0H                                                  1427
*                  RSTANCHR = ADDR(RSGCITS); /*SCAN CITABE FOR PATHS */
         LA    @07,RSGCITS(,REG6)                                  1427
         ST    @07,RSTANCHR(,REG6)                                 1427
*                  RSTENTIX = PTCITNC;                             1428
         L     @07,RSPTWKC(,REG6)                                  1428
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1428
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */
*                  CALL GETNEXTE;                                  1429
         L     @15,@CV03436                                        1429
         BALR  @14,@15                                             1429
*                                      /*GET NEXT CITABE             */
*                  PTCITCUR = RSTENTAD; /*SAVE CITABE ADDRESS        */
*                                                                  1430
         L     @07,RSPTWKC(,REG6)                                  1430
         L     @04,RSTENTAD(,REG6)                                 1430
         ST    @04,PTCITCUR(,@07)                                  1430
*        /************************************************************/
*        /*                                                          */
*        /*       PATH FOUND - READ THE PATH RECORD                  */
*        /*       IF RECORD INVALID, ISSUE MESSAGE IDC21032I         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1431
*                  IF CITTYPE = PATHID THEN                        1431
         CLI   CITTYPE(@04),C'R'                                   1431
         BNE   @RF01431                                            1431
*                    DO;                                           1432
*                      IF CITFAINV = OFF THEN                      1433
         TM    CITFAINV(@04),B'00000010'                           1433
         BNZ   @RF01433                                            1433
*                        DO;                                       1434
*                          RSASSTBL = ADDR(ASSOR); /*PATH ASSOC TBL  */
         LA    @15,ASSOR                                           1435
         ST    @15,RSASSTBL(,REG6)                                 1435
*                          PTASSCUR=ADDR(RSASSTBL->TASSEN(1)); /*PATH*/
         LA    @15,TASSEN(,@15)                                    1436
         ST    @15,PTASSCUR(,@07)                                  1436
*                          GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADR*/
*                                                                  1437
         L     @14,RSGRABCU(,REG6)                                 1437
         LH    @15,TASSRAB(,@15)                                   1437
         SLA   @15,2                                               1437
         L     @15,RABARRAY-4(@15,@14)                             1437
         ST    @15,GRABCURR(,@14)                                  1437
*                          DO;                                     1438
*                            RSRTYPE = ''B;                        1439
         MVI   RSRTYPE(REG6),X'00'                                 1439
*                            RSRGET = ON;      /* GETRCD  */       1440
         OI    RSRGET(REG6),B'10000000'                            1440
*                            RSRUPD = ON;      /* UPDATE  */       1441
         OI    RSRUPD(REG6),B'00001000'                            1441
*                            RSRDS = ''B;                          1442
         NI    RSRDS(REG6),B'00011111'                             1442
*                            RSRWF = ON;       /* WORKFILE  */     1443
*                            RSRDIR = ON;      /* DIRECT  */       1444
*                            RSRKEY = ON;      /* KEY  */          1445
         OI    RSRWF(REG6),B'10010100'                             1445
*                            RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/
         OI    RSVIAFCR(REG6),B'10000000'                          1446
*                            RSVIACRA = PTCRAVL; /*SET VOLSER */   1447
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1447
*                            RSVIACIN = CITCIN; /*SET CI NUMBER */ 1448
*                                                                  1448
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1448
*                          /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETV
*A                                                                   */
*                          CALL GETVIA;                            1449
         L     @15,@CV03442                                        1449
         BALR  @14,@15                                             1449
*                          END;                                    1450
*                        END;                                      1451
*                      IF CITFAINV=ON  RABNRF=ON  CITTYPE^=RCDID 1452
*                       THEN                                       1452
@RF01433 L     @07,RSPTWKC(,REG6)                                  1452
         L     @07,PTCITCUR(,@07)                                  1452
         TM    CITFAINV(@07),B'00000010'                           1452
         BO    @RT01452                                            1452
         L     @04,RSGRABCU(,REG6)                                 1452
         L     @04,GRABCURR(,@04)                                  1452
         TM    RABNRF(@04),B'00000010'                             1452
         BO    @RT01452                                            1452
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1452
         BE    @RF01452                                            1452
@RT01452 DS    0H                                                  1453
*                                      /*NO RCD FOUND OR BAD TYPE    */
*                        DO;                                       1453
*                          RABNRF = OFF; /*RESET NO RCD FOUND        */
         L     @07,RSGRABCU(,REG6)                                 1454
         L     @04,GRABCURR(,@07)                                  1454
         NI    RABNRF(@04),B'11111101'                             1454
*                          CITFAINV = ON; /*MARK INVALID             */
*                                                                  1455
         L     @04,RSPTWKC(,REG6)                                  1455
         L     @04,PTCITCUR(,@04)                                  1455
         OI    CITFAINV(@04),B'00000010'                           1455
*                          DO;                                     1456
*                          /*CALL CKERR*/                          1457
*                            RSCKERR = RSCKERR && RSCKERR;         1457
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1457
*                            RSCKERN = RSE042;                     1458
         MVC   RSCKERN(2,REG6),@CH00971                            1458
*                            RSCKTERM = 'RETU';                    1459
         MVC   RSCKTERM(4,REG6),@CC03787                           1459
*                            RSCKMVAR(1) = ADDR(PATHID);           1460
         LA    @04,@CC00818                                        1460
         ST    @04,RSCKMVAR(,REG6)                                 1460
*                            RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABBUF)-
*CNAME);                                                           1461
         L     @07,GRABRAB5(,@07)                                  1461
         LA    @07,CNAME+8(,@07)                                   1461
         ST    @07,RSCKMVAR+4(,REG6)                               1461
*                            RSCKMVAR(3) = ADDR(CLID);             1462
*                                                                  1462
         LA    @07,@CC00800                                        1462
         ST    @07,RSCKMVAR+8(,REG6)                               1462
*                          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKER
*                                                                    */
*                          CALL CKERR;                             1463
         L     @15,@CV03449                                        1463
         BALR  @14,@15                                             1463
*                          END;                                    1464
*                        END;                                      1465
*                                                                  1465
*        /************************************************************/
*        /*                                                          */
*        /*       IF PATH WAS READ, PROCESS IT                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1466
*                      ELSE                                        1466
*                        CALL PROCTYPE;                            1466
         B     @RC01452                                            1466
@RF01452 BAL   @14,PROCTYPE                                        1466
*                    END;                                          1467
@RC01452 DS    0H                                                  1468
*                END VERCPATH;                                     1468
@RF01431 L     @04,RSPTWKC(,REG6)                                  1468
         LA    @07,1                                               1468
         L     @04,PTCITNC-1(,@04)                                 1468
         LA    @04,0(,@04)                                         1468
         ALR   @07,@04                                             1468
@DE01426 L     @04,RSPTWKC(,REG6)                                  1468
         STCM  @07,7,PTCITNC(@04)                                  1468
         L     @04,RSPTWKC(,REG6)                                  1468
         L     @04,PTCITL-1(,@04)                                  1468
         LA    @04,0(,@04)                                         1468
         CR    @07,@04                                             1468
         BNH   @DL01426                                            1468
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS UPGRADE IF UPGRADE EXISTS                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1469
*        /************************************************************/
*        /*                                                          */
*        /*         SCAN CLUSTER FOR DATA ASSOCIATION                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1469
*                PTF1HIT2 = OFF;       /*ASSUME NO UPGRADE           */
         L     @07,RSPTWKC(,REG6)                                  1469
         NI    PTF1HIT2(@07),B'10111111'                           1469
*                PTLOC = PTLOC && PTLOC;                           1470
         XC    PTLOC(20,@07),PTLOC(@07)                            1470
*                PTLBCITX = PTCITI;    /*SCAN THE CLUSTER BASE       */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1471
*                PTLFBAS1 = ON;        /*FOR THE ASSOCIATION TO DATA */
         OI    PTLFBAS1(@07),B'00100000'                           1472
*                PTLSN = 1;                                        1473
         MVC   PTLSN(2,@07),@CH00212                               1473
*                CALL LOCDIT;                                      1474
         BAL   @14,LOCDIT                                          1474
*                PTCITCUR = PTLCDIT->DITCITAB; /*DATA CITABLE ENT    */
*                                                                  1475
         L     @07,RSPTWKC(,REG6)                                  1475
         L     @04,PTLCDIT(,@07)                                   1475
         L     @04,DITCITAB-1(,@04)                                1475
         LA    @04,0(,@04)                                         1475
         ST    @04,PTCITCUR(,@07)                                  1475
*        /************************************************************/
*        /*                                                          */
*        /*         SCAN DATA FOR UPGRADE ASSOCIATION                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1476
*                PTLOC = PTLOC && PTLOC;                           1476
         XC    PTLOC(20,@07),PTLOC(@07)                            1476
*                PTLBCITX = PTCITCUR;  /*SCAN DATA RECORD            */
         STCM  @04,7,PTLBCITX(@07)                                 1477
*                PTLFBAS1 = ON;        /*FOR ASSN TO UPGRADE         */
         OI    PTLFBAS1(@07),B'00100000'                           1478
*                PTLSN = 0;                                        1479
         SLR   @04,@04                                             1479
         STH   @04,PTLSN(,@07)                                     1479
*                PTLDITID = UPGID;                                 1480
         MVI   PTLDITID(@07),C'Y'                                  1480
*                CALL LOCDIT;                                      1481
*                                                                  1481
         BAL   @14,LOCDIT                                          1481
*        /************************************************************/
*        /*                                                          */
*        /*       IF UPGRADE SET, READ IT                            */
*        /*       IF INVALID, ISSUE MESSAGE IDC21032I                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1482
*                IF PTLCDIT ^= 0 THEN                              1482
         L     @07,RSPTWKC(,REG6)                                  1482
         L     @04,PTLCDIT(,@07)                                   1482
         LTR   @04,@04                                             1482
         BZ    @RF01482                                            1482
*                  DO;                                             1483
*                    PTF1HIT2 = ON;    /*FOUND UPGRADE               */
         OI    PTF1HIT2(@07),B'01000000'                           1484
*                    RSTANCHR = ADDR(RSGCITS);                     1485
         LA    @07,RSGCITS(,REG6)                                  1485
         ST    @07,RSTANCHR(,REG6)                                 1485
*                    RSTENTIX = PTLCDIT->DITCITAB; /*GET CIT FOR UPG */
         MVC   RSTENTIX(3,REG6),DITCITAB(@04)                      1486
*                    /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE*/
*                    CALL GETNEXTE;                                1487
         L     @15,@CV03436                                        1487
         BALR  @14,@15                                             1487
*                    PTCITCUR = RSTENTAD;                          1488
         L     @07,RSPTWKC(,REG6)                                  1488
         L     @04,RSTENTAD(,REG6)                                 1488
         ST    @04,PTCITCUR(,@07)                                  1488
*                    IF CITFAINV = OFF THEN /*DON'T PROCESS INVALIDS */
         TM    CITFAINV(@04),B'00000010'                           1489
         BNZ   @RF01489                                            1489
*                      DO;                                         1490
*                        RSASSTBL = ADDR(ASSOY); /*UPGRADE ASSOC TBL */
         LA    @15,ASSOY                                           1491
         ST    @15,RSASSTBL(,REG6)                                 1491
*                        PTASSCUR = ADDR(RSASSTBL->TASSEN(1)); /*UPG */
         LA    @15,TASSEN(,@15)                                    1492
         ST    @15,PTASSCUR(,@07)                                  1492
*                        GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR */
*                                                                  1493
         L     @14,RSGRABCU(,REG6)                                 1493
         LH    @15,TASSRAB(,@15)                                   1493
         SLA   @15,2                                               1493
         L     @15,RABARRAY-4(@15,@14)                             1493
         ST    @15,GRABCURR(,@14)                                  1493
*                        DO;                                       1494
*                          RSRTYPE = ''B;                          1495
         MVI   RSRTYPE(REG6),X'00'                                 1495
*                          RSRGET = ON;      /* GETRCD  */         1496
         OI    RSRGET(REG6),B'10000000'                            1496
*                          RSRUPD = ON;      /* UPDATE  */         1497
         OI    RSRUPD(REG6),B'00001000'                            1497
*                          RSRDS = ''B;                            1498
         NI    RSRDS(REG6),B'00011111'                             1498
*                          RSRWF = ON;       /* WORKFILE  */       1499
*                          RSRDIR = ON;      /* DIRECT  */         1500
*                          RSRKEY = ON;      /* KEY  */            1501
         OI    RSRWF(REG6),B'10010100'                             1501
*                          RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/ 1502
         OI    RSVIAFCR(REG6),B'10000000'                          1502
*                          RSVIACRA = PTCRAVL; /*SET VOLSER */     1503
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1503
*                          RSVIACIN = CITCIN; /*SET CI NUMBER */   1504
*                                                                  1504
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1504
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA
*                                                                    */
*                        CALL GETVIA;                              1505
         L     @15,@CV03442                                        1505
         BALR  @14,@15                                             1505
*                        END;                                      1506
*                      END;                                        1507
*                    IF CITFAINV=ON  RABNRF=ON  CITTYPE^=RCDID   1508
*                     THEN                                         1508
@RF01489 L     @07,RSPTWKC(,REG6)                                  1508
         L     @07,PTCITCUR(,@07)                                  1508
         TM    CITFAINV(@07),B'00000010'                           1508
         BO    @RT01508                                            1508
         L     @04,RSGRABCU(,REG6)                                 1508
         L     @04,GRABCURR(,@04)                                  1508
         TM    RABNRF(@04),B'00000010'                             1508
         BO    @RT01508                                            1508
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1508
         BE    @RF01508                                            1508
@RT01508 DS    0H                                                  1509
*                                      /*NO RCD FOUND OR BAD TYPE    */
*                      DO;                                         1509
*                        RABNRF = OFF; /*RESET NO RCD FOUND          */
         L     @07,RSGRABCU(,REG6)                                 1510
         L     @04,GRABCURR(,@07)                                  1510
         NI    RABNRF(@04),B'11111101'                             1510
*                        CITFAINV = ON; /*MARK INVALID               */
         L     @04,RSPTWKC(,REG6)                                  1511
         L     @01,PTCITCUR(,@04)                                  1511
         OI    CITFAINV(@01),B'00000010'                           1511
*                        PTF1HIT2 = OFF; /*FAKE NO UPGRADE           */
*                                                                  1512
         NI    PTF1HIT2(@04),B'10111111'                           1512
*                        DO;                                       1513
*                        /*CALL CKERR*/                            1514
*                          RSCKERR = RSCKERR && RSCKERR;           1514
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1514
*                          RSCKERN = RSE042;                       1515
         MVC   RSCKERN(2,REG6),@CH00971                            1515
*                          RSCKTERM = 'RETU';                      1516
         MVC   RSCKTERM(4,REG6),@CC03787                           1516
*                          RSCKMVAR(1) = ADDR(UPGID);              1517
         LA    @04,@CC00816                                        1517
         ST    @04,RSCKMVAR(,REG6)                                 1517
*                          RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABBUF)->C
*AME);                                                             1518
         L     @07,GRABRAB5(,@07)                                  1518
         LA    @07,CNAME+8(,@07)                                   1518
         ST    @07,RSCKMVAR+4(,REG6)                               1518
*                          RSCKMVAR(3) = ADDR(CLID);               1519
*                                                                  1519
         LA    @07,@CC00800                                        1519
         ST    @07,RSCKMVAR+8(,REG6)                               1519
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               1520
         L     @15,@CV03449                                        1520
         BALR  @14,@15                                             1520
*                        END;                                      1521
*                      END;                                        1522
*                                                                  1522
*        /************************************************************/
*        /*                                                          */
*        /*       IF UPGRADE READ, PROCESS IT                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1523
*                    ELSE                                          1523
*                      DO;                                         1523
         B     @RC01508                                            1523
@RF01508 DS    0H                                                  1524
*                        CALL PROCTYPE;                            1524
         BAL   @14,PROCTYPE                                        1524
*                        PTLCDIT->DITFAVER = ON; /*MARK D->Y OK      */
         L     @07,RSPTWKC(,REG6)                                  1525
         L     @07,PTLCDIT(,@07)                                   1525
         OI    DITFAVER(@07),B'01000000'                           1525
*                      END;                                        1526
*                  END;                                            1527
@RC01508 DS    0H                                                  1528
*                                                                  1528
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS ALTERNATE INDEXES IF AIXS EXIST              */
*        /*     BUT ONLY IF NO UPGRADE WAS PROCESSED. IF AN          */
*        /*     UPGRADE WAS PROCESSED, THE AIXS WERE PROCESSED BY    */
*        /*     THE UPGRADE.                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1528
*                IF PTF1HIT2 = OFF THEN                            1528
@RF01482 L     @07,RSPTWKC(,REG6)                                  1528
         TM    PTF1HIT2(@07),B'01000000'                           1528
         BNZ   @RF01528                                            1528
*                  DO;                                             1529
*  VERCAIX:                                                        1530
*                    DO PTCITNC = PTCITI TO PTCITL;                1530
VERCAIX  L     @07,RSPTWKC(,REG6)                                  1530
         L     @07,PTCITI-1(,@07)                                  1530
         LA    @07,0(,@07)                                         1530
         B     @DE01530                                            1530
@DL01530 DS    0H                                                  1531
*                      RSTANCHR = ADDR(RSGCITS);                   1531
         LA    @07,RSGCITS(,REG6)                                  1531
         ST    @07,RSTANCHR(,REG6)                                 1531
*                      RSTENTIX = PTCITNC; /*NEXT CITABE             */
         L     @07,RSPTWKC(,REG6)                                  1532
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1532
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE
*                                                                    */
*                      CALL GETNEXTE;                              1533
         L     @15,@CV03436                                        1533
         BALR  @14,@15                                             1533
*                      PTCITCUR = RSTENTAD; /*CI TABLE ENTRY         */
*                                                                  1534
         L     @07,RSPTWKC(,REG6)                                  1534
         L     @04,RSTENTAD(,REG6)                                 1534
         ST    @04,PTCITCUR(,@07)                                  1534
*        /************************************************************/
*        /*                                                          */
*        /*       IF AIX, READ IT                                    */
*        /*       IF INVALID, ISSUE MESSAGE IDC21032I.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1535
*                      IF CITTYPE = AIXID THEN                     1535
         CLI   CITTYPE(@04),C'G'                                   1535
         BNE   @RF01535                                            1535
*                        DO;                                       1536
*                          IF CITFAINV = OFF THEN /*PROCESS VALIDS   */
         TM    CITFAINV(@04),B'00000010'                           1537
         BNZ   @RF01537                                            1537
*                            DO;                                   1538
*                              RSASSTBL = ADDR(ASSOG); /*AIX ASSOC TB*/
         LA    @15,ASSOG                                           1539
         ST    @15,RSASSTBL(,REG6)                                 1539
*                              PTASSCUR = ADDR(RSASSTBL->TASSEN(1));
         LA    @15,TASSEN(,@15)                                    1540
         ST    @15,PTASSCUR(,@07)                                  1540
*                              GRABCURR = RABARRAY(TASSRAB); /*BFRADR*/
*                                                                  1541
         L     @14,RSGRABCU(,REG6)                                 1541
         LH    @15,TASSRAB(,@15)                                   1541
         SLA   @15,2                                               1541
         L     @15,RABARRAY-4(@15,@14)                             1541
         ST    @15,GRABCURR(,@14)                                  1541
*                              DO;                                 1542
*                                RSRTYPE = ''B;                    1543
         MVI   RSRTYPE(REG6),X'00'                                 1543
*                                RSRGET = ON;      /* GETRCD  */   1544
         OI    RSRGET(REG6),B'10000000'                            1544
*                                RSRUPD = ON;      /* UPDATE  */   1545
         OI    RSRUPD(REG6),B'00001000'                            1545
*                                RSRDS = ''B;                      1546
         NI    RSRDS(REG6),B'00011111'                             1546
*                                RSRWF = ON;       /* WORKFILE  */ 1547
*                                RSRDIR = ON;      /* DIRECT  */   1548
*                                RSRKEY = ON;      /* KEY  */      1549
         OI    RSRWF(REG6),B'10010100'                             1549
*                                RSVIAFCR = ON;  /*INDICATE CRA SEARCH*
         OI    RSVIAFCR(REG6),B'10000000'                          1550
*                                RSVIACRA = PTCRAVL; /*SET VOLSER */
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1551
*                                RSVIACIN = CITCIN; /*SET CI NUMBER */
*                                                                  1552
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1552
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*ETVIA                                                               */
*                              CALL GETVIA;                        1553
         L     @15,@CV03442                                        1553
         BALR  @14,@15                                             1553
*                              END;                                1554
*                                      /*TRY TO READ THE AIX         */
*                            END;                                  1555
*                          IF CITFAINV=ON  RABNRF=ON  CITTYPE^=RCDID
*                           THEN                                   1556
@RF01537 L     @07,RSPTWKC(,REG6)                                  1556
         L     @07,PTCITCUR(,@07)                                  1556
         TM    CITFAINV(@07),B'00000010'                           1556
         BO    @RT01556                                            1556
         L     @04,RSGRABCU(,REG6)                                 1556
         L     @04,GRABCURR(,@04)                                  1556
         TM    RABNRF(@04),B'00000010'                             1556
         BO    @RT01556                                            1556
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1556
         BE    @RF01556                                            1556
@RT01556 DS    0H                                                  1557
*                                      /*NO RCD FOUND OR BAD TYPE    */
*                            DO;                                   1557
*                              RABNRF = OFF; /*RESET NO RCD FND      */
         L     @07,RSGRABCU(,REG6)                                 1558
         L     @04,GRABCURR(,@07)                                  1558
         NI    RABNRF(@04),B'11111101'                             1558
*                              CITFAINV = ON; /*MARK INVALID         */
*                                                                  1559
         L     @04,RSPTWKC(,REG6)                                  1559
         L     @04,PTCITCUR(,@04)                                  1559
         OI    CITFAINV(@04),B'00000010'                           1559
*                              DO;                                 1560
*                              /*CALL CKERR*/                      1561
*                                RSCKERR = RSCKERR && RSCKERR;     1561
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1561
*                                RSCKERN = RSE042;                 1562
         MVC   RSCKERN(2,REG6),@CH00971                            1562
*                                RSCKTERM = 'RETU';                1563
         MVC   RSCKTERM(4,REG6),@CC03787                           1563
*                                RSCKMVAR(1) = ADDR(AIXID);        1564
         LA    @04,@CC00806                                        1564
         ST    @04,RSCKMVAR(,REG6)                                 1564
*                                RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABB
*F)->CNAME);                                                       1565
         L     @07,GRABRAB5(,@07)                                  1565
         LA    @07,CNAME+8(,@07)                                   1565
         ST    @07,RSCKMVAR+4(,REG6)                               1565
*                                RSCKMVAR(3) = ADDR(CLID);         1566
*                                                                  1566
         LA    @07,@CC00800                                        1566
         ST    @07,RSCKMVAR+8(,REG6)                               1566
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*KERR                                                                */
*                              CALL CKERR;                         1567
         L     @15,@CV03449                                        1567
         BALR  @14,@15                                             1567
*                              END;                                1568
*                            END;                                  1569
*                                                                  1569
*        /************************************************************/
*        /*                                                          */
*        /*       IF AIX READ, PROCESS IT                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1570
*                          ELSE                                    1570
*                            CALL PROCTYPE;                        1570
         B     @RC01556                                            1570
@RF01556 BAL   @14,PROCTYPE                                        1570
*                        END;          /*END AIX RECORD              */
@RC01556 DS    0H                                                  1572
*                    END VERCAIX;                                  1572
@RF01535 L     @04,RSPTWKC(,REG6)                                  1572
         LA    @07,1                                               1572
         L     @04,PTCITNC-1(,@04)                                 1572
         LA    @04,0(,@04)                                         1572
         ALR   @07,@04                                             1572
@DE01530 L     @04,RSPTWKC(,REG6)                                  1572
         STCM  @07,7,PTCITNC(@04)                                  1572
         L     @04,RSPTWKC(,REG6)                                  1572
         L     @04,PTCITL-1(,@04)                                  1572
         LA    @04,0(,@04)                                         1572
         CR    @07,@04                                             1572
         BNH   @DL01530                                            1572
*                  END;                /*END OF VERIFY AIX           */
*              END;                    /*END OF VALID CLUSTER        */
@RF01528 DS    0H                                                  1575
*          END;                        /*END OF ALL CLUSTER          */
@RF01424 DS    0H                                                  1576
*        /***************************PATH*****************************/
*        /*                                                          */
*        /*     PROCESS A PATH                                       */
*        /*       VERIFY THE PATH ASSOCIATIONS                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1576
* VERPATH:                                                         1576
*        IF TASSID = PATHID THEN                                   1576
@RF01421 DS    0H                                                  1576
VERPATH  L     @07,RSPTWKC(,REG6)                                  1576
         L     @07,PTASSOC(,@07)                                   1576
         CLI   TASSID(@07),C'R'                                    1576
         BNE   @RF01576                                            1576
*          CALL VERR;                                              1577
         BAL   @14,VERR                                            1577
*        /************************UPGRADE*****************************/
*        /*                                                          */
*        /*     PROCESS AN UPGRADE SET                               */
*        /*       BUILD CI TABLE FOR ALL ASSOCIATIONS (DONE ALREADY) */
*        /*       PROCESS ALL AIXS WHICH INDICATE VALID DATA         */
*        /*        AND INDEX IN THE UPGRADE TABLE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1578
*  VERUPG:                                                         1578
*        IF TASSID = UPGID THEN                                    1578
@RF01576 DS    0H                                                  1578
VERUPG   L     @07,RSPTWKC(,REG6)                                  1578
         L     @04,PTASSOC(,@07)                                   1578
         CLI   TASSID(@04),C'Y'                                    1578
         BNE   @RF01578                                            1578
*          DO;                                                     1579
*            PTCITF->CITFAVER = ON;    /*MARK UPGRADE VERIFIED       */
*                                                                  1580
         L     @07,PTCITF(,@07)                                    1580
         OI    CITFAVER(@07),B'01000000'                           1580
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS ALL AIXS ON THE CLUSTER                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1581
*  VERYAIX:                                                        1581
*            DO PTCITNC = RSPTWKF->PTCITI TO RSPTWKF->PTCITL;      1581
VERYAIX  L     @07,RSPTWKF(,REG6)                                  1581
         L     @07,PTCITI-1(,@07)                                  1581
         LA    @07,0(,@07)                                         1581
         B     @DE01581                                            1581
@DL01581 DS    0H                                                  1582
*                                      /*SCAN CLUSTER TABLE FOR AIXS */
*              RSTANCHR = ADDR(RSGCITS);                           1582
         LA    @07,RSGCITS(,REG6)                                  1582
         ST    @07,RSTANCHR(,REG6)                                 1582
*              RSTENTIX = PTCITNC;     /*NEXT CITABE                 */
         L     @07,RSPTWKC(,REG6)                                  1583
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1583
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      1584
         L     @15,@CV03436                                        1584
         BALR  @14,@15                                             1584
*              PTCITCUR = RSTENTAD;    /*CI TABLE ENTRY              */
*                                                                  1585
         L     @07,RSPTWKC(,REG6)                                  1585
         L     @04,RSTENTAD(,REG6)                                 1585
         ST    @04,PTCITCUR(,@07)                                  1585
*        /************************************************************/
*        /*                                                          */
*        /*       IF AIX, READ IT                                    */
*        /*       IF INVALID, ISSUE MESSAGE IDC21032I.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1586
*              IF CITTYPE = AIXID THEN                             1586
         CLI   CITTYPE(@04),C'G'                                   1586
         BNE   @RF01586                                            1586
*                DO;                                               1587
*                  IF CITFAINV = OFF THEN /*PROCESS VALID RECORDS    */
         TM    CITFAINV(@04),B'00000010'                           1588
         BNZ   @RF01588                                            1588
*                    DO;                                           1589
*                      RSASSTBL = ADDR(ASSOG); /*AIX ASSOC TABLE     */
         LA    @15,ASSOG                                           1590
         ST    @15,RSASSTBL(,REG6)                                 1590
*                      PTASSCUR = ADDR(RSASSTBL->TASSEN(1)); /*AIX EN*/
         LA    @15,TASSEN(,@15)                                    1591
         ST    @15,PTASSCUR(,@07)                                  1591
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */
*                                                                  1592
         L     @14,RSGRABCU(,REG6)                                 1592
         LH    @15,TASSRAB(,@15)                                   1592
         SLA   @15,2                                               1592
         L     @15,RABARRAY-4(@15,@14)                             1592
         ST    @15,GRABCURR(,@14)                                  1592
*                      DO;                                         1593
*                        RSRTYPE = ''B;                            1594
         MVI   RSRTYPE(REG6),X'00'                                 1594
*                        RSRGET = ON;      /* GETRCD  */           1595
         OI    RSRGET(REG6),B'10000000'                            1595
*                        RSRUPD = ON;      /* UPDATE  */           1596
         OI    RSRUPD(REG6),B'00001000'                            1596
*                        RSRDS = ''B;                              1597
         NI    RSRDS(REG6),B'00011111'                             1597
*                        RSRWF = ON;       /* WORKFILE  */         1598
*                        RSRDIR = ON;      /* DIRECT  */           1599
*                        RSRKEY = ON;      /* KEY  */              1600
         OI    RSRWF(REG6),B'10010100'                             1600
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1601
         OI    RSVIAFCR(REG6),B'10000000'                          1601
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       1602
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1602
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     1603
*                                                                  1603
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1603
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/
*                      CALL GETVIA;                                1604
         L     @15,@CV03442                                        1604
         BALR  @14,@15                                             1604
*                      END;                                        1605
*                    END;                                          1606
*                  IF CITFAINV=ON  RABNRF=ON  CITTYPE^=RCDID THEN
@RF01588 L     @07,RSPTWKC(,REG6)                                  1607
         L     @07,PTCITCUR(,@07)                                  1607
         TM    CITFAINV(@07),B'00000010'                           1607
         BO    @RT01607                                            1607
         L     @04,RSGRABCU(,REG6)                                 1607
         L     @04,GRABCURR(,@04)                                  1607
         TM    RABNRF(@04),B'00000010'                             1607
         BO    @RT01607                                            1607
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1607
         BE    @RF01607                                            1607
@RT01607 DS    0H                                                  1608
*                                      /*NO RCD FOUND OR BAD TYPE    */
*                    DO;                                           1608
*                      RABNRF = OFF;   /*RESET NO RCD FND            */
         L     @07,RSGRABCU(,REG6)                                 1609
         L     @04,GRABCURR(,@07)                                  1609
         NI    RABNRF(@04),B'11111101'                             1609
*                      CITFAINV = ON;  /*MARK INVALID                */
*                                                                  1610
         L     @04,RSPTWKC(,REG6)                                  1610
         L     @04,PTCITCUR(,@04)                                  1610
         OI    CITFAINV(@04),B'00000010'                           1610
*                      DO;                                         1611
*                      /*CALL CKERR*/                              1612
*                        RSCKERR = RSCKERR && RSCKERR;             1612
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1612
*                        RSCKERN = RSE042;                         1613
         MVC   RSCKERN(2,REG6),@CH00971                            1613
*                        RSCKTERM = 'RETU';                        1614
         MVC   RSCKTERM(4,REG6),@CC03787                           1614
*                        RSCKMVAR(1) = ADDR(AIXID);                1615
         LA    @04,@CC00806                                        1615
         ST    @04,RSCKMVAR(,REG6)                                 1615
*                        RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABBUF)->CNA
*E);                                                               1616
         L     @07,GRABRAB5(,@07)                                  1616
         LA    @07,CNAME+8(,@07)                                   1616
         ST    @07,RSCKMVAR+4(,REG6)                               1616
*                        RSCKMVAR(3) = ADDR(CLID);                 1617
*                                                                  1617
         LA    @07,@CC00800                                        1617
         ST    @07,RSCKMVAR+8(,REG6)                               1617
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR */
*                      CALL CKERR;                                 1618
         L     @15,@CV03449                                        1618
         BALR  @14,@15                                             1618
*                      END;                                        1619
*                    END;                                          1620
*                                                                  1620
*        /************************************************************/
*        /*                                                          */
*        /*       IF AIX READ, PROCESS IT                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1621
*                  ELSE                                            1621
*                    CALL PROCTYPE;                                1621
         B     @RC01607                                            1621
@RF01607 BAL   @14,PROCTYPE                                        1621
*                END;                  /*END AIX RECORD              */
@RC01607 DS    0H                                                  1623
*            END VERYAIX;                                          1623
*                                                                  1623
@RF01586 L     @04,RSPTWKC(,REG6)                                  1623
         LA    @07,1                                               1623
         L     @04,PTCITNC-1(,@04)                                 1623
         LA    @04,0(,@04)                                         1623
         ALR   @07,@04                                             1623
@DE01581 L     @04,RSPTWKC(,REG6)                                  1623
         STCM  @07,7,PTCITNC(@04)                                  1623
         L     @04,RSPTWKF(,REG6)                                  1623
         L     @04,PTCITL-1(,@04)                                  1623
         LA    @04,0(,@04)                                         1623
         CR    @07,@04                                             1623
         BNH   @DL01581                                            1623
*        /************************************************************/
*        /*                                                          */
*        /* MARK ALL VERIFIED DATA & INDEX PAIRS ASSOCIATION CHECKED */
*        /*                                                          */
*        /************************************************************/
*                                                                  1624
*            PTLOC = PTLOC && PTLOC;                               1624
         L     @07,RSPTWKC(,REG6)                                  1624
         XC    PTLOC(20,@07),PTLOC(@07)                            1624
*            PTLBCITX = PTCITI;        /*SCAN ASSOCIATIONS FRM UPGRAD*/
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1625
*            PTLFBAS1 = ON;                                        1626
*            PTLFBAS2 = ON;                                        1627
         OI    PTLFBAS1(@07),B'00110000'                           1627
*            PTF1OK = OFF;                                         1628
*                                                                  1628
         NI    PTF1OK(@07),B'11011111'                             1628
*        /************************************************************/
*        /*                                                          */
*        /* SCAN FOR THE NEXT ASSOCIATION                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1629
*            DO UNTIL(PTLCDIT=0);                                  1629
@DL01629 DS    0H                                                  1630
*              CALL LOCDIT;                                        1630
         BAL   @14,LOCDIT                                          1630
*              IF (PTLCDIT ^= 0) THEN                              1631
         L     @07,RSPTWKC(,REG6)                                  1631
         L     @07,PTLCDIT(,@07)                                   1631
         LTR   @07,@07                                             1631
         BZ    @RF01631                                            1631
*                DO;                                               1632
*                  RSTANCHR = ADDR(RSGCITS);                       1633
         LA    @04,RSGCITS(,REG6)                                  1633
         ST    @04,RSTANCHR(,REG6)                                 1633
*                  RSTENTIX = PTLCDIT->DITCITAB;                   1634
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1634
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */
*                  CALL GETNEXTE;                                  1635
         L     @15,@CV03436                                        1635
         BALR  @14,@15                                             1635
*                  IF RSTENTAD->CITFAVER = ON THEN                 1636
         L     @07,RSTENTAD(,REG6)                                 1636
         TM    CITFAVER(@07),B'01000000'                           1636
         BNO   @RF01636                                            1636
*                    PTLCDIT->DITFAVER = ON; /*DI GOOD - ASSOC CHK  */
         L     @07,RSPTWKC(,REG6)                                  1637
         L     @07,PTLCDIT(,@07)                                   1637
         OI    DITFAVER(@07),B'01000000'                           1637
*                END;                                              1638
@RF01636 DS    0H                                                  1639
*            END;                                                  1639
*                                                                  1639
@RF01631 DS    0H                                                  1639
@DE01629 L     @07,RSPTWKC(,REG6)                                  1639
         L     @07,PTLCDIT(,@07)                                   1639
         LTR   @07,@07                                             1639
         BNZ   @DL01629                                            1639
*          END;                        /*END OF VERIFY UPGRADE       */
*        /********************ALTERNATEINDEX**************************/
*        /*                                                          */
*        /*     PROCESS AN ALTERNATEINDEX                            */
*        /*       VERIFY THE AIX ASSOCIATIONS                        */
*        /*       PROCESS ALL PATHS ON THE AIX                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1641
*  VERAIX:                                                         1641
*        IF TASSID = AIXID THEN                                    1641
@RF01578 DS    0H                                                  1641
VERAIX   L     @07,RSPTWKC(,REG6)                                  1641
         L     @07,PTASSOC(,@07)                                   1641
         CLI   TASSID(@07),C'G'                                    1641
         BNE   @RF01641                                            1641
*          DO;                                                     1642
*            CALL VERG;             /*VERIFY AIX ASSOCIATIONS     */
         BAL   @14,VERG                                            1643
*            IF PTCITF->CITFAVER = ON THEN                         1644
         L     @07,RSPTWKC(,REG6)                                  1644
         L     @07,PTCITF(,@07)                                    1644
         TM    CITFAVER(@07),B'01000000'                           1644
         BNO   @RF01644                                            1644
*                                      /*CHECK SUBSETS IF AIX OK     */
*                                                                  1645
*        /************************************************************/
*        /*                                                          */
*        /*       PROCESS ALL PATHS ON THE ALTERNATEINDEX            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1645
*  VERGPATH:                                                       1645
*              DO PTCITNC = PTCITI TO PTCITL;                      1645
VERGPATH L     @07,RSPTWKC(,REG6)                                  1645
         L     @07,PTCITI-1(,@07)                                  1645
         LA    @07,0(,@07)                                         1645
         B     @DE01645                                            1645
@DL01645 DS    0H                                                  1646
*                RSTANCHR = ADDR(RSGCITS); /*SCAN CITABE FOR PATHS   */
         LA    @07,RSGCITS(,REG6)                                  1646
         ST    @07,RSTANCHR(,REG6)                                 1646
*                RSTENTIX = PTCITNC;                               1647
         L     @07,RSPTWKC(,REG6)                                  1647
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1647
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */
*                CALL GETNEXTE;                                    1648
         L     @15,@CV03436                                        1648
         BALR  @14,@15                                             1648
*                                      /*GET NEXT CITABE             */
*                PTCITCUR = RSTENTAD;  /*SAVE CITABE ADDRESS         */
*                                                                  1649
         L     @07,RSPTWKC(,REG6)                                  1649
         L     @04,RSTENTAD(,REG6)                                 1649
         ST    @04,PTCITCUR(,@07)                                  1649
*        /************************************************************/
*        /*                                                          */
*        /*       PATH FOUND - READ THE PATH RECORD                  */
*        /*       IF RECORD INVALID, ISSUE MESSAGE IDC21032I         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1650
*                IF CITTYPE = PATHID THEN                          1650
         CLI   CITTYPE(@04),C'R'                                   1650
         BNE   @RF01650                                            1650
*                  DO;                                             1651
*                    IF CITFAINV = OFF THEN                        1652
         TM    CITFAINV(@04),B'00000010'                           1652
         BNZ   @RF01652                                            1652
*                      DO;                                         1653
*                        RSASSTBL = ADDR(ASSOR); /*PATH ASSOC TABLE  */
         LA    @15,ASSOR                                           1654
         ST    @15,RSASSTBL(,REG6)                                 1654
*                        PTASSCUR=ADDR(RSASSTBL->TASSEN(1)); /*PATH  */
         LA    @15,TASSEN(,@15)                                    1655
         ST    @15,PTASSCUR(,@07)                                  1655
*                        GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR */
*                                                                  1656
         L     @14,RSGRABCU(,REG6)                                 1656
         LH    @15,TASSRAB(,@15)                                   1656
         SLA   @15,2                                               1656
         L     @15,RABARRAY-4(@15,@14)                             1656
         ST    @15,GRABCURR(,@14)                                  1656
*                        DO;                                       1657
*                          RSRTYPE = ''B;                          1658
         MVI   RSRTYPE(REG6),X'00'                                 1658
*                          RSRGET = ON;      /* GETRCD  */         1659
         OI    RSRGET(REG6),B'10000000'                            1659
*                          RSRUPD = ON;      /* UPDATE  */         1660
         OI    RSRUPD(REG6),B'00001000'                            1660
*                          RSRDS = ''B;                            1661
         NI    RSRDS(REG6),B'00011111'                             1661
*                          RSRWF = ON;       /* WORKFILE  */       1662
*                          RSRDIR = ON;      /* DIRECT  */         1663
*                          RSRKEY = ON;      /* KEY  */            1664
         OI    RSRWF(REG6),B'10010100'                             1664
*                          RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/ 1665
         OI    RSVIAFCR(REG6),B'10000000'                          1665
*                          RSVIACRA = PTCRAVL; /*SET VOLSER */     1666
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1666
*                          RSVIACIN = CITCIN; /*SET CI NUMBER */   1667
*                                                                  1667
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1667
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA
*                                                                    */
*                        CALL GETVIA;                              1668
         L     @15,@CV03442                                        1668
         BALR  @14,@15                                             1668
*                        END;                                      1669
*                      END;                                        1670
*                    IF CITFAINV=ON  RABNRF=ON  CITTYPE^=RCDID THEN
@RF01652 L     @07,RSPTWKC(,REG6)                                  1671
         L     @07,PTCITCUR(,@07)                                  1671
         TM    CITFAINV(@07),B'00000010'                           1671
         BO    @RT01671                                            1671
         L     @04,RSGRABCU(,REG6)                                 1671
         L     @04,GRABCURR(,@04)                                  1671
         TM    RABNRF(@04),B'00000010'                             1671
         BO    @RT01671                                            1671
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1671
         BE    @RF01671                                            1671
@RT01671 DS    0H                                                  1672
*                                      /*NO RCD FOUND OR BAD TYPE    */
*                      DO;                                         1672
*                        RABNRF = OFF; /*RESET NO RCD FOUND          */
         L     @07,RSGRABCU(,REG6)                                 1673
         L     @04,GRABCURR(,@07)                                  1673
         NI    RABNRF(@04),B'11111101'                             1673
*                        CITFAINV = ON; /*MARK INVALID               */
*                                                                  1674
         L     @04,RSPTWKC(,REG6)                                  1674
         L     @04,PTCITCUR(,@04)                                  1674
         OI    CITFAINV(@04),B'00000010'                           1674
*                        DO;                                       1675
*                        /*CALL CKERR*/                            1676
*                          RSCKERR = RSCKERR && RSCKERR;           1676
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1676
*                          RSCKERN = RSE042;                       1677
         MVC   RSCKERN(2,REG6),@CH00971                            1677
*                          RSCKTERM = 'RETU';                      1678
         MVC   RSCKTERM(4,REG6),@CC03787                           1678
*                          RSCKMVAR(1) = ADDR(PATHID);             1679
         LA    @04,@CC00818                                        1679
         ST    @04,RSCKMVAR(,REG6)                                 1679
*                          RSCKMVAR(2) = ADDR(ADDR(GRABRAB1->RABBUF)->C
*AME);                                                             1680
         L     @07,GRABRAB1(,@07)                                  1680
         LA    @07,CNAME+8(,@07)                                   1680
         ST    @07,RSCKMVAR+4(,REG6)                               1680
*                          RSCKMVAR(3) = ADDR(AIXID);              1681
*                                                                  1681
         LA    @07,@CC00806                                        1681
         ST    @07,RSCKMVAR+8(,REG6)                               1681
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               1682
         L     @15,@CV03449                                        1682
         BALR  @14,@15                                             1682
*                        END;                                      1683
*                      END;                                        1684
*                                                                  1684
*        /************************************************************/
*        /*                                                          */
*        /*       IF PATH WAS READ, PROCESS IT                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1685
*                    ELSE                                          1685
*                      CALL PROCTYPE;                              1685
         B     @RC01671                                            1685
@RF01671 BAL   @14,PROCTYPE                                        1685
*                  END;                                            1686
@RC01671 DS    0H                                                  1687
*              END VERGPATH;                                       1687
@RF01650 L     @04,RSPTWKC(,REG6)                                  1687
         LA    @07,1                                               1687
         L     @04,PTCITNC-1(,@04)                                 1687
         LA    @04,0(,@04)                                         1687
         ALR   @07,@04                                             1687
@DE01645 L     @04,RSPTWKC(,REG6)                                  1687
         STCM  @07,7,PTCITNC(@04)                                  1687
         L     @04,RSPTWKC(,REG6)                                  1687
         L     @04,PTCITL-1(,@04)                                  1687
         LA    @04,0(,@04)                                         1687
         CR    @07,@04                                             1687
         BNH   @DL01645                                            1687
*          END;                        /*END OF AIX PROCESSING       */
@RF01644 DS    0H                                                  1689
*                                                                  1689
*        /**********************GDG BASE******************************/
*        /*                                                          */
*        /*     PROCESS THE GDG BASE                                 */
*        /*       PROCESS ALL GDG DATA SETS                          */
*        /*       RECONSTRUCT THE GDG GENLEVELS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1689
*  VERGDG:                                                         1689
*        IF TASSID = GDGID THEN                                    1689
@RF01641 DS    0H                                                  1689
VERGDG   L     @07,RSPTWKC(,REG6)                                  1689
         L     @07,PTASSOC(,@07)                                   1689
         CLI   TASSID(@07),C'B'                                    1689
         BNE   @RF01689                                            1689
*          /* CALL TO MODULE IDCRS03 FOR PROCEDURE VERB              */
*          CALL VERB;                                              1690
         L     @15,@CV03438                                        1690
         BALR  @14,@15                                             1690
*                                      /*VERIFY GDG                  */
*        /********************NON-VSAM********************************/
*        /*                                                          */
*        /*     PROCESS NON-VSAM ENTRIES                             */
*        /*       VERIFY ASSOCIATIONS AND ALIASES                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1691
*  VERNONV:                                                        1691
*        IF TASSID=NVID  TASSID=NV THEN                           1691
@RF01689 DS    0H                                                  1691
VERNONV  L     @07,RSPTWKC(,REG6)                                  1691
         L     @07,PTASSOC(,@07)                                   1691
         CLI   TASSID(@07),C'A'                                    1691
         BE    @RT01691                                            1691
         CLI   TASSID(@07),C'3'                                    1691
         BNE   @RF01691                                            1691
@RT01691 DS    0H                                                  1692
*          CALL VERA;               /*VERIFY NON-VSAM             */
         BAL   @14,VERA                                            1692
*        /********************USERCATALOG*****************************/
*        /*                                                          */
*        /*     PROCESS USERCATALOG ENTRIES                          */
*        /*       VERIFY ALIASES                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1693
*  VERUCAT:                                                        1693
*        IF TASSID = UCATID THEN                                   1693
@RF01691 DS    0H                                                  1693
VERUCAT  L     @07,RSPTWKC(,REG6)                                  1693
         L     @07,PTASSOC(,@07)                                   1693
         CLI   TASSID(@07),C'U'                                    1693
         BNE   @RF01693                                            1693
*          CALL VERU;                                              1694
         BAL   @14,VERU                                            1694
*        /************************VOLUME******************************/
*        /*                                                          */
*        /*     PROCESS A VOLUME RECORD                              */
*        /*       MARK BASE VERIFIED                                 */
*        /*       THIS PROCESS ONLY VERIFIES V-W CONNECTIONS         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1695
*  VERVOLR:                                                        1695
*        IF TASSID = VOLID THEN                                    1695
@RF01693 DS    0H                                                  1695
VERVOLR  L     @07,RSPTWKC(,REG6)                                  1695
         L     @04,PTASSOC(,@07)                                   1695
         CLI   TASSID(@04),C'V'                                    1695
         BNE   @RF01695                                            1695
*          DO;                                                     1696
*                                                                  1696
*        /************************************************************/
*        /*                                                          */
*        /*       SCAN FOR ANY BAD EXTENSION RECORDS.                */
*        /*       IF ANY INDICATE FAILURE.                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1697
*            DO PTCITNC = PTCITI TO PTCITL WHILE (RESVLBAD=OFF);   1697
         L     @07,PTCITI-1(,@07)                                  1697
         LA    @07,0(,@07)                                         1697
         B     @DE01697                                            1697
@DL01697 L     @07,RSENTPT(,REG6)                                  1697
         TM    RESVLBAD(@07),B'00010000'                           1697
         BNZ   @DC01697                                            1697
*              RSTANCHR = ADDR(RSGCITS);                           1698
         LA    @07,RSGCITS(,REG6)                                  1698
         ST    @07,RSTANCHR(,REG6)                                 1698
*              RSTENTIX = PTCITNC;                                 1699
         L     @07,RSPTWKC(,REG6)                                  1699
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1699
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      1700
         L     @15,@CV03436                                        1700
         BALR  @14,@15                                             1700
*              IF RSTENTAD->CITFAINV = ON THEN /*INVALID EXTENSION   */
         L     @07,RSTENTAD(,REG6)                                 1701
         TM    CITFAINV(@07),B'00000010'                           1701
         BNO   @RF01701                                            1701
*                DO;                                               1702
*                  RESVLBAD = ON;      /*FLAG THIS VOL AS BAD        */
         L     @07,RSENTPT(,REG6)                                  1703
         OI    RESVLBAD(@07),B'00010000'                           1703
*                  RSBADVOL = ON;      /*INDICATE A BAD VOL          */
         OI    RSBADVOL(REG6),B'00000010'                          1704
*                END;                                              1705
*            END;                                                  1706
*                                                                  1706
@RF01701 L     @04,RSPTWKC(,REG6)                                  1706
         LA    @07,1                                               1706
         L     @04,PTCITNC-1(,@04)                                 1706
         LA    @04,0(,@04)                                         1706
         ALR   @07,@04                                             1706
@DE01697 L     @04,RSPTWKC(,REG6)                                  1706
         STCM  @07,7,PTCITNC(@04)                                  1706
         L     @04,RSPTWKC(,REG6)                                  1706
         L     @04,PTCITL-1(,@04)                                  1706
         LA    @04,0(,@04)                                         1706
         CR    @07,@04                                             1706
         BNH   @DL01697                                            1706
@DC01697 DS    0H                                                  1707
*        /************************************************************/
*        /*                                                          */
*        /*       MARK THE VOLUME RECORD AS VERIFIED TO RECOVER      */
*        /*       AS MUCH AS POSSIBLE.                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1707
*            PTCITF->CITFAVER = ON;    /*MARK VOL VERIFIED           */
         L     @07,RSPTWKC(,REG6)                                  1707
         L     @07,PTCITF(,@07)                                    1707
         OI    CITFAVER(@07),B'01000000'                           1707
*          END;                                                    1708
*                                                                  1708
*                                                                  1708
*        IF GDTDBG = NULLPTR                                       1709
*          THEN;                                                   1709
@RF01695 L     @07,GDTDBG(,REG5)                                   1709
         LTR   @07,@07                                             1709
         BZ    @RT01709                                            1709
*          ELSE                                                    1711
*            CALL IDCDB010(GDTTBL,'RSV3');                         1711
*                                                                  1711
         ST    REG5,@AL00001                                       1711
         LA    @07,@CC03881                                        1711
         ST    @07,@AL00001+4                                      1711
         MVI   @AL00001+4,X'80'                                    1711
         L     @15,GDTDBG(,REG5)                                   1711
         LA    @01,@AL00001                                        1711
         BALR  @14,@15                                             1711
*        RFY TASSO;                    /*REVERT                      */
@RT01709 DS    0H                                                  1713
* CALL EXIT;  /*TERMINATE*/                                        1713
         BAL   @14,EXIT                                            1713
* END VERCI; /*END OF PROCEDURE*/                                  1714
@EL00011 DS    0H                                                  1714
@EF00011 DS    0H                                                  1714
@ER00011 BR    @14                                                 1714
@PB00011 DS    0H                                                  1715
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERDSDIR                                             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     VERDSDIR VERIFIES DATA SET DIRECTORY ENTRIES(DSDIRS).        */
*/*     FOR EACH RESET CLUSTER OR ALTERNATEINDEX, ALL VOLUMES ON     */
*/*     WHICH THEY CLAIM SPACE ARE CHECKED FOR MATCHING DSDIRS.      */
*/*                                                                  */
*/*     FOR EACH NON-RESET CLUSTER AND ALTERNATEINDEX, ALL RESET     */
*/*     VOLUMES ON WHICH THEY CLAIM SPACE ARE CHECKED FOR MATCHING   */
*/*     DSDIRS.                                                      */
*/*                                                                  */
*/*     IF A DSDIR MATCH FAILS, THE VOLUME GROUP OCCURRENCE IS       */
*/*     MARKED UNUSABLE AND THE BASE RECORD IS FLAGGED FOR NO        */
*/*     UPDATE.                                                      */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE CLUSTER OR AIX                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*     WORKFILE RECORDS MARKED UNUSABLE PER THE FUNCTION.           */
*/*     RSWDSDIR - FLAGGED ON IN EACH DATA OR INDEX PROCESSED.       */
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*     IDC21030I - INVALID SPACE DESCRIPTION                        */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1715
         DS    0F
NAME0183 DC    CL8'VERDSDIR'
*VERDSDIR: PROCEDURE                                               1716
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1716
*                                                                  1716
         B     @PB00012                                            1716
VERDSDIR DS    0H                                                  1717
*      GENERATE REFS(RS02RG08, REG6);                              1717
*                                                                  1717
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0183  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      1718
         L     @07,GDTTR2(,REG5)                                   1718
         MVC   @TS00001(95),NEWERID2(@07)                          1718
         MVC   OLDERID2(95,@07),@TS00001                           1718
*        NEWID2 = 'RSVE';                                          1719
*                                                                  1719
         MVC   NEWID2(4,@07),@CC03852                              1719
*        RFY TASSO BASED(PTASSOC);                                 1720
*                                                                  1720
*        /************************************************************/
*        /*                                                          */
*        /* ASSUME CATALOG CLUSTER IS FINE FOR THIS CHECK            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1721
*        IF PTCITF->CITCIN = CLUSCI THEN;                          1721
*                                                                  1721
         L     @07,RSPTWKC(,REG6)                                  1721
         L     @07,PTCITF(,@07)                                    1721
         CLC   CITCIN(3,@07),@CF00149+1                            1721
         BE    @RT01721                                            1721
*        /************************************************************/
*        /*                                                          */
*        /* FREE POSSIBLE EXTENSION RECORD FOR MODGO                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1723
*        ELSE                                                      1723
*  VERDSD:                                                         1723
*          DO;                                                     1723
VERDSD   DS    0H                                                  1724
*            GRABCURR = RABARRAY(EXTRAB);                          1724
*                                                                  1724
         L     @07,RSGRABCU(,REG6)                                 1724
         L     @04,RABARRAY+12(,@07)                               1724
         ST    @04,GRABCURR(,@07)                                  1724
*            DO;                                                   1725
*              RSRTYPE = ''B;                                      1726
         MVI   RSRTYPE(REG6),X'00'                                 1726
*              RSRFREE = ON;     /* FREERCD  */                    1727
         OI    RSRFREE(REG6),B'00000001'                           1727
*              RSRUPD = ON;      /* UPDATE  */                     1728
         OI    RSRUPD(REG6),B'00001000'                            1728
*              RSRDS = ''B;                                        1729
         NI    RSRDS(REG6),B'00011111'                             1729
*              RSRWF = ON;       /* WORKFILE  */                   1730
*              RSRDIR = ON;      /* DIRECT  */                     1731
*              RSRKEY = ON;      /* KEY  */                        1732
*                                                                  1732
         OI    RSRWF(REG6),B'10010100'                             1732
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */
*            CALL RECMGMT;                                         1733
         L     @15,@CV03458                                        1733
         BALR  @14,@15                                             1733
*              RFY RTNREG RSTD;                                    1734
*              TESTRC = RTNREG;                                    1735
         STH   RTNREG,TESTRC(,REG6)                                1735
*              RFY RTNREG UNRSTD;                                  1736
*            END;                                                  1737
*                                                                  1737
*        /************************************************************/
*        /*                                                          */
*        /* FOR BOTH DATA AND INDEX (IF IT EXISTS), FIND ALL         */
*        /* VOLUME GROUP OCCURRENCES.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1738
*            PTVALL = PTVALL && PTVALL; /*CLEAR D-I INFORMATION      */
         L     @07,RSPTWKC(,REG6)                                  1738
         XC    PTVALL(24,@07),PTVALL(@07)                          1738
*            PTF1OK = ON;              /*ASSUME D-I OK               */
         OI    PTF1OK(@07),B'00100000'                             1739
*            PTVCNT = 1;               /*ASSUME ESDS OR RRDS FORMAT  */
         MVC   PTVCNT(2,@07),@CH00212                              1740
*  VERDSDSN:                                                       1741
*            DO PTINDX3 = 1 TO 2 WHILE(PTF1OK=ON);                 1741
*                                                                  1741
VERDSDSN LA    @07,1                                               1741
         L     @04,RSPTWKC(,REG6)                                  1741
         STH   @07,PTINDX3(,@04)                                   1741
@DL01741 L     @07,RSPTWKC(,REG6)                                  1741
         TM    PTF1OK(@07),B'00100000'                             1741
         BNO   @DC01741                                            1741
*        /************************************************************/
*        /*                                                          */
*        /*     LOCATE THE DATA OR INDEX ASSOCIATION ON THE          */
*        /*     CLUSTER OR AIX.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1742
*              PTLOC = PTLOC && PTLOC;                             1742
         XC    PTLOC(20,@07),PTLOC(@07)                            1742
*              PTLBCITX = PTCITI;                                  1743
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1743
*              PTLSN = PTINDX3;        /*1ST OR 2ND ASSOCIATION      */
         LH    @04,PTINDX3(,@07)                                   1744
         STH   @04,PTLSN(,@07)                                     1744
*              PTLFBAS1 = ON;          /*ASSOCIATION SCAN            */
         OI    PTLFBAS1(@07),B'00100000'                           1745
*              CALL LOCDIT;                                        1746
*                                                                  1746
         BAL   @14,LOCDIT                                          1746
*        /************************************************************/
*        /*                                                          */
*        /*     NO VOLUME CHECKING IF NOT DATA OR INDEX              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1747
*              IF PTLCDIT = 0 THEN                                 1747
         L     @07,RSPTWKC(,REG6)                                  1747
         L     @04,PTLCDIT(,@07)                                   1747
         LTR   @04,@04                                             1747
         BNZ   @RF01747                                            1747
*                PTF1OK = OFF;                                     1748
*                                                                  1748
         NI    PTF1OK(@07),B'11011111'                             1748
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE ASSOCIATION FOR DATA OR INDEX                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1749
*              ELSE                                                1749
*                DO;                                               1749
         B     @RC01747                                            1749
@RF01747 DS    0H                                                  1750
*                  RSTANCHR = ADDR(RSGCITS); /*SCAN OF CITABLE       */
         LA    @07,RSGCITS(,REG6)                                  1750
         ST    @07,RSTANCHR(,REG6)                                 1750
*                  RSTENTIX = PTLCDIT->DITCITAB; /*FIND D-I CITABE   */
         L     @07,RSPTWKC(,REG6)                                  1751
         L     @07,PTLCDIT(,@07)                                   1751
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1751
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */
*                  CALL GETNEXTE;                                  1752
         L     @15,@CV03436                                        1752
         BALR  @14,@15                                             1752
*                  PTCITCUR = RSTENTAD; /*CITABE ADDR FOR READ       */
         L     @07,RSPTWKC(,REG6)                                  1753
         L     @04,RSTENTAD(,REG6)                                 1753
         ST    @04,PTCITCUR(,@07)                                  1753
*                  PTVDICIT(PTINDX3) = RSTENTAD; /*SAVE FOR VGO SCAN */
*                                                                  1754
         LH    @15,PTINDX3(,@07)                                   1754
         LR    @14,@15                                             1754
         MH    @14,@CH00032                                        1754
         ST    @04,PTVDICIT-12(@14,@07)                            1754
*                  IF PTINDX3 = 1 THEN /*1ST ASSOC MUST BE DATA      */
         C     @15,@CF00212                                        1755
         BNE   @RF01755                                            1755
*                    IF CITTYPE ^= DATAID THEN                     1756
         CLI   CITTYPE(@04),C'D'                                   1756
         BE    @RF01756                                            1756
*                      PTF1OK = OFF;   /*ERROR IF NOT DATA           */
         NI    PTF1OK(@07),B'11011111'                             1757
*                    ELSE;                                         1758
@RF01756 DS    0H                                                  1759
*                  ELSE                                            1759
*                    IF CITTYPE ^= INDEXID THEN                    1759
         B     @RC01755                                            1759
@RF01755 L     @07,RSPTWKC(,REG6)                                  1759
         L     @04,PTCITCUR(,@07)                                  1759
         CLI   CITTYPE(@04),C'I'                                   1759
         BE    @RF01759                                            1759
*                      PTF1OK = OFF;   /*NOT KSDS                    */
*                                                                  1760
         NI    PTF1OK(@07),B'11011111'                             1760
*        /************************************************************/
*        /*                                                          */
*        /*     PROCEED FOR DATA OR INDEX - GET BUFFER ADDRESS       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1761
*                  IF PTF1OK = OFF THEN;                           1761
@RF01759 DS    0H                                                  1761
@RC01755 L     @07,RSPTWKC(,REG6)                                  1761
         TM    PTF1OK(@07),B'00100000'                             1761
         BZ    @RT01761                                            1761
*                  ELSE                                            1763
*                    DO;                                           1763
*                      PTASSCUR = ADDR(TASSEN(1)); /*FIRST ASSOC ENT */
         L     @07,RSPTWKC(,REG6)                                  1764
         L     @04,PTASSOC(,@07)                                   1764
         LA    @04,TASSEN(,@04)                                    1764
         ST    @04,PTASSCUR(,@07)                                  1764
*                      DO PTINDX4 = 1 TO TASSNENT                  1765
*                       WHILE(TASSTYPE^=CITTYPE);                  1765
         LA    @07,1                                               1765
         B     @DE01765                                            1765
@DL01765 L     @07,RSPTWKC(,REG6)                                  1765
         L     @04,PTASSCUR(,@07)                                  1765
         L     @01,PTCITCUR(,@07)                                  1765
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        1765
         BE    @DC01765                                            1765
*                        PTASSCUR = PTASSCUR + LENGTH(TASSEN);     1766
         AL    @04,@CF00038                                        1766
         ST    @04,PTASSCUR(,@07)                                  1766
*                                      /*ADDR OF NEXT ASSOC ENTRY    */
*                      END;                                        1767
*                                                                  1767
         L     @04,RSPTWKC(,REG6)                                  1767
         LA    @07,1                                               1767
         AH    @07,PTINDX4(,@04)                                   1767
@DE01765 L     @04,RSPTWKC(,REG6)                                  1767
         STH   @07,PTINDX4(,@04)                                   1767
         L     @04,RSPTWKC(,REG6)                                  1767
         L     @04,PTASSOC(,@04)                                   1767
         CH    @07,TASSNENT(,@04)                                  1767
         BNH   @DL01765                                            1767
@DC01765 DS    0H                                                  1768
*        /************************************************************/
*        /*                                                          */
*        /*     GET DATA OR INDEX RECORD                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1768
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */
*                                                                  1768
         L     @07,RSGRABCU(,REG6)                                 1768
         L     @04,RSPTWKC(,REG6)                                  1768
         L     @01,PTASSCUR(,@04)                                  1768
         LH    @15,TASSRAB(,@01)                                   1768
         SLA   @15,2                                               1768
         L     @15,RABARRAY-4(@15,@07)                             1768
         ST    @15,GRABCURR(,@07)                                  1768
*                      DO;                                         1769
*                        RSRTYPE = ''B;                            1770
         MVI   RSRTYPE(REG6),X'00'                                 1770
*                        RSRGET = ON;      /* GETRCD  */           1771
         OI    RSRGET(REG6),B'10000000'                            1771
*                        RSRUPD = ON;      /* UPDATE  */           1772
         OI    RSRUPD(REG6),B'00001000'                            1772
*                        RSRDS = ''B;                              1773
         NI    RSRDS(REG6),B'00011111'                             1773
*                        RSRWF = ON;       /* WORKFILE  */         1774
*                        RSRDIR = ON;      /* DIRECT  */           1775
*                        RSRKEY = ON;      /* KEY  */              1776
         OI    RSRWF(REG6),B'10010100'                             1776
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1777
         OI    RSVIAFCR(REG6),B'10000000'                          1777
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       1778
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       1778
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     1779
*                                                                  1779
         L     @07,PTCITCUR(,@04)                                  1779
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        1779
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/
*                      CALL GETVIA;                                1780
         L     @15,@CV03442                                        1780
         BALR  @14,@15                                             1780
*                      END;                                        1781
*                                                                  1781
*        /************************************************************/
*        /*                                                          */
*        /*     NO RECORD FOUND POSSIBLE FOR BAD NON-RESET           */
*        /*     DATA OR INDEX                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1782
*                      IF RABNRF = ON THEN                         1782
         L     @07,RSGRABCU(,REG6)                                 1782
         L     @07,GRABCURR(,@07)                                  1782
         TM    RABNRF(@07),B'00000010'                             1782
         BNO   @RF01782                                            1782
*                        DO;                                       1783
*                          RABNRF = OFF; /*RESET NO RCD FOUND        */
         NI    RABNRF(@07),B'11111101'                             1784
*                          PTF1OK = OFF; /*NO PROCESSING             */
         L     @07,RSPTWKC(,REG6)                                  1785
         NI    PTF1OK(@07),B'11011111'                             1785
*                        END;                                      1786
*                                                                  1786
*        /************************************************************/
*        /*                                                          */
*        /*     FIND ALL VOLUME GROUP OCCURRENCES                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1787
*                      ELSE                                        1787
*                        DO;                                       1787
         B     @RC01782                                            1787
@RF01782 DS    0H                                                  1788
*                          PTVDIASS(PTINDX3) = PTASSCUR; /* ASSOC ENT*/
         L     @07,RSPTWKC(,REG6)                                  1788
         LH    @04,PTINDX3(,@07)                                   1788
         MH    @04,@CH00032                                        1788
         L     @15,PTASSCUR(,@07)                                  1788
         ST    @15,PTVDIASS-12(@04,@07)                            1788
*                                      /*THS ENT NON-ZERO FR RCD READ*/
*                                                                  1789
*                          DO;                                     1789
*                            GRABBB = GRABCURR;                    1790
         L     @07,RSGRABCU(,REG6)                                 1790
         L     @04,GRABCURR(,@07)                                  1790
         ST    @04,GRABBB(,@07)                                    1790
*                            RSWGCODE = GCVOLGO;                   1791
         MVI   RSWGCODE(REG6),X'03'                                1791
*                                      /*SPECIFY GROUP CODE          */
*                            RSWFONE = OFF;                        1792
         NI    RSWFONE(REG6),B'01111111'                           1792
*                                      /*FIND ALL OCCURRENCES        */
*                            /* CALL THE FIND SUBROUTINE */        1793
*                                                                  1793
*                          /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND
*                                                                    */
*                          CALL FIND;                              1793
         L     @15,@CV03441                                        1793
         BALR  @14,@15                                             1793
*                          END;                                    1794
*                          PTVDISNT(PTINDX3) = RSWASNVT;           1795
         L     @07,RSPTWKC(,REG6)                                  1795
         LH    @04,PTINDX3(,@07)                                   1795
         MH    @04,@CH00032                                        1795
         L     @15,RSWASNVT(,REG6)                                 1795
         ST    @15,PTVDISNT-12(@04,@07)                            1795
*                                      /*SAVE SN VECTOR TABLE        */
*                          IF RSFENTLN = 0 THEN /*NO ENTRIES         */
         CLI   RSFENTLN(@15),0                                     1796
         BNE   @RF01796                                            1796
*                            PTVDISNT(PTINDX3) = 0;                1797
         SLR   @15,@15                                             1797
         ST    @15,PTVDISNT-12(@04,@07)                            1797
*                        END;                                      1798
@RF01796 DS    0H                                                  1799
*                    END;                                          1799
@RC01782 DS    0H                                                  1800
*                END;                                              1800
@RT01761 DS    0H                                                  1801
*            END VERDSDSN;                                         1801
@RC01747 L     @04,RSPTWKC(,REG6)                                  1801
         LA    @07,1                                               1801
         AH    @07,PTINDX3(,@04)                                   1801
         L     @04,RSPTWKC(,REG6)                                  1801
         STH   @07,PTINDX3(,@04)                                   1801
         C     @07,@CF00149                                        1801
         BNH   @DL01741                                            1801
@DC01741 DS    0H                                                  1802
*        /************************************************************/
*        /*                                                          */
*        /* FOR EACH VOLUME IN DATA AND INDEX, ENSURE THAT           */
*        /* A DATA SET DIRECTORY EXISTES FOR ALL CLAIMS ON A RESET   */
*        /* VOLUME OR, ON ANY VOLUME BY A RESET DATA OR INDEX.       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1802
*            DO PTINDX3 = 1 TO 2;                                  1802
*                                                                  1802
         LA    @07,1                                               1802
         L     @04,RSPTWKC(,REG6)                                  1802
         STH   @07,PTINDX3(,@04)                                   1802
@DL01802 DS    0H                                                  1803
*        /************************************************************/
*        /*                                                          */
*        /*     NO SN TABLE - NO VOLUMES                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1803
*             RSWASNVT = PTVDISNT(PTINDX3);  /*SET D-I VGO SNTABLE   */
         L     @07,RSPTWKC(,REG6)                                  1803
         LH    @04,PTINDX3(,@07)                                   1803
         MH    @04,@CH00032                                        1803
         L     @07,PTVDISNT-12(@04,@07)                            1803
         ST    @07,RSWASNVT(,REG6)                                 1803
*             IF RSWASNVT=0 THEN;                                  1804
*                                                                  1804
         LTR   @07,@07                                             1804
         BZ    @RT01804                                            1804
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK EACH VOLUME GROUP OCCURRENCE                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1806
*             ELSE                                                 1806
* VERVOLGO:                                                        1806
*              DO;                                                 1806
VERVOLGO DS    0H                                                  1807
*                GRABCURR = RABARRAY(PTVDIASS(PTINDX3)->TASSRAB);  1807
         L     @07,RSGRABCU(,REG6)                                 1807
         L     @04,RSPTWKC(,REG6)                                  1807
         LH    @15,PTINDX3(,@04)                                   1807
         MH    @15,@CH00032                                        1807
         L     @04,PTVDIASS-12(@15,@04)                            1807
         LH    @04,TASSRAB(,@04)                                   1807
         SLA   @04,2                                               1807
         L     @04,RABARRAY-4(@04,@07)                             1807
         ST    @04,GRABCURR(,@07)                                  1807
*                                      /*CURR BFR ADDR FOR MARKUNUS  */
*                DO RSFCNDX = 1 TO RSFHNDX;                        1808
         LA    @07,1                                               1808
         B     @DE01808                                            1808
@DL01808 DS    0H                                                  1809
*                  RSFAENT = RSFCADR + RSFENTLN * (RSFCNDX - 1);   1809
         L     @07,RSWASNVT(,REG6)                                 1809
         LH    @04,RSFCNDX(,@07)                                   1809
         BCTR  @04,0                                               1809
         LR    @01,@04                                             1809
         SLR   @04,@04                                             1809
         IC    @04,RSFENTLN(,@07)                                  1809
         MR    @00,@04                                             1809
         AL    @01,RSFCADR(,@07)                                   1809
         ST    @01,RSFAENT(,@07)                                   1809
*                                      /*GET VGO SNTAB               */
*                                                                  1810
*        /************************************************************/
*        /*                                                          */
*        /*     IF ALREADY UNUSABLE OR ALREADY PROCESSED - IGNORE IT */
*        /*                                                          */
*        /************************************************************/
*                                                                  1810
*                  IF SDSDIRSN = 0  SNFPROC = ON THEN;            1810
*                                                                  1810
         ICM   @07,3,SDSDIRSN(@01)                                 1810
         BZ    @RT01810                                            1810
         TM    SNFPROC(@01),B'00010000'                            1810
         BO    @RT01810                                            1810
*        /************************************************************/
*        /*                                                          */
*        /*     LOCATE THE VOLUME RECORD FOR THIS VOLUME             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1812
*                  ELSE                                            1812
*                   DO;                                            1812
*                    PTF1CKVL = OFF;   /*ASSUME NO VOL CHECKING      */
         L     @07,RSPTWKC(,REG6)                                  1813
         NI    PTF1CKVL(@07),B'11110111'                           1813
*                    RSASDSDI = OFF;   /*ASSUME NO DSDIR             */
         NI    RSASDSDI(REG6),B'10111111'                          1814
*                    RSCRVL = ADDR(SNVOLSER);                      1815
         L     @07,RSWASNVT(,REG6)                                 1815
         L     @07,RSFAENT(,@07)                                   1815
         LA    @07,SNVOLSER(,@07)                                  1815
         ST    @07,RSCRVL(,REG6)                                   1815
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNVLST */
*                    CALL IDCRS5SV(RSVTBENT,RSCRVL);               1816
         LA    @07,RSVTBENT(,REG6)                                 1816
         ST    @07,@AL00001                                        1816
         LA    @07,RSCRVL(,REG6)                                   1816
         ST    @07,@AL00001+4                                      1816
         L     @15,@CV03444                                        1816
         LA    @01,@AL00001                                        1816
         BALR  @14,@15                                             1816
*                    IF RSVTBENT = 0 THEN /*NO VOLUME RECORD         */
         L     @07,RSVTBENT(,REG6)                                 1817
         LTR   @07,@07                                             1817
         BNZ   @RF01817                                            1817
*                      IF TASSID = CLID  TASSID = AIXID THEN      1818
         L     @07,RSPTWKC(,REG6)                                  1818
         L     @07,PTASSOC(,@07)                                   1818
         CLI   TASSID(@07),C'C'                                    1818
         BE    @RT01818                                            1818
         CLI   TASSID(@07),C'G'                                    1818
         BNE   @RF01818                                            1818
@RT01818 DS    0H                                                  1819
*                                      /*MARK RESET C OR G UNUSABLE  */
*                        /* CALL TO MODULE IDCRS03 FOR PROCEDURE MARKUN
*S                                                                   */
*                        CALL MARKUNUS;                            1819
         L     @15,@CV03431                                        1819
         BALR  @14,@15                                             1819
*                      ELSE;           /*IGNORE NON-RESET ERROR      */
*                                                                  1820
@RF01818 DS    0H                                                  1821
*        /************************************************************/
*        /*                                                          */
*        /*     FOR NON-RESET CLUSTER OR AIX, CHECK ONLY RESET       */
*        /*     VOLUMES FOR MATCHING DSDIRS                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1821
*                    ELSE                                          1821
*                      IF TASSID = CLNR  TASSID = AIXNR THEN      1821
         B     @RC01817                                            1821
@RF01817 L     @07,RSPTWKC(,REG6)                                  1821
         L     @07,PTASSOC(,@07)                                   1821
         CLI   TASSID(@07),C'1'                                    1821
         BE    @RT01821                                            1821
         CLI   TASSID(@07),C'2'                                    1821
         BNE   @RF01821                                            1821
@RT01821 DS    0H                                                  1822
*                        DO;                                       1822
*                          /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNR
*ST                                                                  */
*                          CALL IDCRS5SR('V','A',RSENTPT,RSCRVL);  1823
         LA    @07,@CC00828                                        1823
         ST    @07,@AL00001                                        1823
         LA    @07,@CC00808                                        1823
         ST    @07,@AL00001+4                                      1823
         LA    @07,RSENTPT(,REG6)                                  1823
         ST    @07,@AL00001+8                                      1823
         LA    @07,RSCRVL(,REG6)                                   1823
         ST    @07,@AL00001+12                                     1823
         L     @15,@CV03445                                        1823
         LA    @01,@AL00001                                        1823
         BALR  @14,@15                                             1823
*                          IF RSENTPT ^= 0 THEN                    1824
         L     @07,RSENTPT(,REG6)                                  1824
         LTR   @07,@07                                             1824
         BZ    @RF01824                                            1824
*                            PTF1CKVL=ON; /*CHECK VGO                */
         L     @07,RSPTWKC(,REG6)                                  1825
         OI    PTF1CKVL(@07),B'00001000'                           1825
*                        END;                                      1826
*                                                                  1826
*        /************************************************************/
*        /*                                                          */
*        /*     FOR RESET CLUSTER OR AIX, CHECK ALL VOLUME GROUP     */
*        /*     OCCURRENCES FOR MATCHING DSDIRS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1827
*                      ELSE                                        1827
*                        PTF1CKVL = ON; /*CHECK ALL RESET VGOS       */
*                                                                  1827
         B     @RC01821                                            1827
@RF01821 L     @07,RSPTWKC(,REG6)                                  1827
         OI    PTF1CKVL(@07),B'00001000'                           1827
*        /************************************************************/
*        /*                                                          */
*        /*     FOR INDEX (SEQUENCE SET WITH DATA) SCAN THE DATA     */
*        /*     SN TABLE FOR A MATCHING DSDIR, SINCE THE DSDIR       */
*        /*     FOR THE IMBED ONLY POINTS TO THE DATA. MARK THE      */
*        /*     INDEX SEQUENCE SET UNUSABLE, IF THE DATA DOES        */
*        /*     NOT EXIST OR IS MARKED UNUSABLE.                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1828
*                    IF PTF1CKVL = ON THEN                         1828
@RC01821 DS    0H                                                  1828
@RC01817 L     @07,RSPTWKC(,REG6)                                  1828
         TM    PTF1CKVL(@07),B'00001000'                           1828
         BNO   @RF01828                                            1828
*  VERDSDVG:                                                       1829
*                      DO;                                         1829
VERDSDVG DS    0H                                                  1830
*                        IF SNSSWD = ON THEN                       1830
         L     @07,RSWASNVT(,REG6)                                 1830
         L     @07,RSFAENT(,@07)                                   1830
         TM    SNSSWD(@07),B'10000000'                             1830
         BNO   @RF01830                                            1830
*                          DO;                                     1831
*        RFY RSFSNVT BASED(PTVDISNT(1));                           1832
*                              /*USE DATA'S VGO SNTABLE              */
*                            IF PTVDISNT(1) ^= 0 THEN              1833
         L     @07,RSPTWKC(,REG6)                                  1833
         L     @07,PTVDISNT(,@07)                                  1833
         LTR   @07,@07                                             1833
         BZ    @RF01833                                            1833
*                              DO;                                 1834
*                                RSFAENT = RSFCADR; /*SCAN ALL VGOS  */
         L     @04,RSFCADR(,@07)                                   1835
         ST    @04,RSFAENT(,@07)                                   1835
*                                DO RSFCNDX = 1 TO RSFHNDX         1836
*                                 WHILE((SDSDIRSN ^=               1836
*                                 RSWASNVT->RSFAENT->SDSDIRSN)    1836
*                                 (SNVOLSER ^=                     1836
*                                 RSWASNVT->RSFAENT->SNVOLSER));   1836
         LA    @07,1                                               1836
         B     @DE01836                                            1836
@DL01836 L     @07,RSPTWKC(,REG6)                                  1836
         L     @07,PTVDISNT(,@07)                                  1836
         L     @07,RSFAENT(,@07)                                   1836
         L     @04,RSWASNVT(,REG6)                                 1836
         L     @04,RSFAENT(,@04)                                   1836
         CLC   SDSDIRSN(2,@07),SDSDIRSN(@04)                       1836
         BNE   @DB01836                                            1836
         CLC   SNVOLSER(6,@07),SNVOLSER(@04)                       1836
         BE    @DC01836                                            1836
@DB01836 DS    0H                                                  1837
*                                      /*SCAN FOR MATCHING VGO       */
*                                  RSFAENT = RSFAENT + RSFENTLN;   1837
         L     @07,RSPTWKC(,REG6)                                  1837
         L     @07,PTVDISNT(,@07)                                  1837
         SLR   @04,@04                                             1837
         IC    @04,RSFENTLN(,@07)                                  1837
         AL    @04,RSFAENT(,@07)                                   1837
         ST    @04,RSFAENT(,@07)                                   1837
*                                      /*TRY THE NEXT VGO            */
*                                END;                              1838
         L     @04,RSPTWKC(,REG6)                                  1838
         L     @04,PTVDISNT(,@04)                                  1838
         LA    @07,1                                               1838
         AH    @07,RSFCNDX(,@04)                                   1838
@DE01836 L     @04,RSPTWKC(,REG6)                                  1838
         L     @04,PTVDISNT(,@04)                                  1838
         STH   @07,RSFCNDX(,@04)                                   1838
         L     @04,RSPTWKC(,REG6)                                  1838
         L     @04,PTVDISNT(,@04)                                  1838
         CH    @07,RSFHNDX(,@04)                                   1838
         BNH   @DL01836                                            1838
@DC01836 DS    0H                                                  1839
*                              END;                                1839
*                                                                  1839
*                            IF (PTVDISNT(1)=0)  (RSFCNDX>RSFHNDX)
*                             THEN                                 1840
@RF01833 L     @07,RSPTWKC(,REG6)                                  1840
         L     @07,PTVDISNT(,@07)                                  1840
         LTR   @07,@07                                             1840
         BZ    @RT01840                                            1840
         LH    @04,RSFCNDX(,@07)                                   1840
         CH    @04,RSFHNDX(,@07)                                   1840
         BNH   @RF01840                                            1840
@RT01840 DS    0H                                                  1841
*                                      /*SSWDTA UNUSABLE IF DATA BAD */
*                              /* CALL TO MODULE IDCRS03 FOR PROCEDURE
*ARKUNUS                                                             */
*                              CALL MARKUNUS;                      1841
*                                                                  1841
         L     @15,@CV03431                                        1841
         BALR  @14,@15                                             1841
*        RFY RSFSNVT;                  /*REINSTATE INDEX VGO         */
@RF01840 DS    0H                                                  1843
*                          END;                                    1843
*                                                                  1843
*        /************************************************************/
*        /*                                                          */
*        /*     GET THE VOLUME RECORD TO VERIFY THE DSDIR            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1844
*                        ELSE                                      1844
*                          DO;                                     1844
         B     @RC01830                                            1844
@RF01830 DS    0H                                                  1845
*                            GRABCURR = GRABRAB1; /*USE BUFFER 1     */
*                                                                  1845
         L     @07,RSGRABCU(,REG6)                                 1845
         L     @04,GRABRAB1(,@07)                                  1845
         ST    @04,GRABCURR(,@07)                                  1845
*                              DO;                                 1846
*                                RSRTYPE = ''B;                    1847
         MVI   RSRTYPE(REG6),X'00'                                 1847
*                                RSRGET = ON;      /* GETRCD  */   1848
         OI    RSRGET(REG6),B'10000000'                            1848
*                                RSRUPD = OFF;     /* NO UPDATE  */
         NI    RSRUPD(REG6),B'11110111'                            1849
*                                RSRDS = ''B;                      1850
         NI    RSRDS(REG6),B'00011111'                             1850
*                                RSRWF = ON;       /* WORKFILE  */ 1851
*                                RSRDIR = ON;      /* DIRECT  */   1852
*                                RSRKEY = ON;      /* KEY  */      1853
         OI    RSRWF(REG6),B'10010100'                             1853
*                                RSVIAFCR = ON;  /*INDICATE CRA SEARCH*
         OI    RSVIAFCR(REG6),B'10000000'                          1854
*                                RSVIACRA = SNVOLSER; /*SET VOLSER */
         L     @07,RSWASNVT(,REG6)                                 1855
         L     @07,RSFAENT(,@07)                                   1855
         MVC   RSVIACRA(6,REG6),SNVOLSER(@07)                      1855
*                                RSVIACIN = VOLSRCI; /*SET CI NUMBER */
*                                                                  1856
         L     @07,RSVTBENT(,REG6)                                 1856
         MVC   RSVIACIN(3,REG6),VOLSRCI+1(@07)                     1856
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*ETVIA                                                               */
*                              CALL GETVIA;                        1857
         L     @15,@CV03442                                        1857
         BALR  @14,@15                                             1857
*                              END;                                1858
*                                                                  1858
*        /************************************************************/
*        /*                                                          */
*        /*     ATTEMPT TO EXTRACT THE DSDIR                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1859
*                                                                  1859
*                            DO;                                   1859
*                              GRABBB = GRABCURR;                  1860
         L     @07,RSGRABCU(,REG6)                                 1860
         L     @04,GRABCURR(,@07)                                  1860
         ST    @04,GRABBB(,@07)                                    1860
*                              RSWGCODE = GCDSDIR;                 1861
         MVI   RSWGCODE(REG6),X'08'                                1861
*                                      /*SPECIFY GROUP CODE          */
*                              RSWFONE = ON;                       1862
*                                      /*FIND ONE OCCURRENCE         */
*                              RSWFIRST = OFF;                     1863
         OI    RSWFONE(REG6),B'10000000'                           1863
         NI    RSWFIRST(REG6),B'10111111'                          1863
*                                      /*FIND A SPECIFIC OCCURRENCE  */
*                              RSWSEQNR = SDSDIRSN;                1864
         L     @07,RSWASNVT(,REG6)                                 1864
         L     @07,RSFAENT(,@07)                                   1864
         MVC   RSWSEQNR(2,REG6),SDSDIRSN(@07)                      1864
*                                      /*SEQUENCE NUMBER OF GO       */
*                              /* CALL THE FIND SUBROUTINE */      1865
*                                                                  1865
*                            /* CALL TO MODULE IDCRS04 FOR PROCEDURE FI
*D                                                                   */
*                            CALL FIND;                            1865
         L     @15,@CV03441                                        1865
         BALR  @14,@15                                             1865
*                            END;                                  1866
*                            PTVDSSNT = RSWASNVT; /*SNTABLE FOR DSDIR*/
         L     @07,RSPTWKC(,REG6)                                  1867
         L     @04,RSWASNVT(,REG6)                                 1867
         ST    @04,PTVDSSNT(,@07)                                  1867
*                            RSFAENT = RSFCADR; /*DSDIR SNTAB        */
         L     @15,RSFCADR(,@04)                                   1868
         ST    @15,RSFAENT(,@04)                                   1868
*                            RSFCNDX = 1; /*CURR SNTAB ENTRY = 1ST   */
*                                                                  1869
         MVC   RSFCNDX(2,@04),@CH00212                             1869
*        /************************************************************/
*        /*                                                          */
*        /*     RESTORE DATA OR INDEX SN ENVIRONMENT FOR MARKUNUS    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1870
*                            RSWASNVT = PTVDISNT(PTINDX3); /*D-I SNT */
         LH    @15,PTINDX3(,@07)                                   1870
         MH    @15,@CH00032                                        1870
         L     @14,PTVDISNT-12(@15,@07)                            1870
         ST    @14,RSWASNVT(,REG6)                                 1870
*                            GRABCURR =                            1871
*                             RABARRAY(PTVDIASS(PTINDX3)->TASSRAB);
*                                                                  1871
         L     @14,RSGRABCU(,REG6)                                 1871
         L     @07,PTVDIASS-12(@15,@07)                            1871
         LH    @07,TASSRAB(,@07)                                   1871
         SLA   @07,2                                               1871
         L     @07,RABARRAY-4(@07,@14)                             1871
         ST    @07,GRABCURR(,@14)                                  1871
*        /************************************************************/
*        /*                                                          */
*        /*     MARK UNUSABLE IF NO DSDIR                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1872
*                            IF PTVDSSNT->RSFENTLN = 0 THEN        1872
         CLI   RSFENTLN(@04),0                                     1872
         BNE   @RF01872                                            1872
*                              /* CALL TO MODULE IDCRS03 FOR PROCEDURE
*ARKUNUS                                                             */
*                              CALL MARKUNUS;                      1873
*                                                                  1873
         L     @15,@CV03431                                        1873
         BALR  @14,@15                                             1873
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE DSDIR IS FOR THIS DATA OR INDEX AND           */
*        /*     THAT THE SUM TT IS CORRECT.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1874
*                            ELSE                                  1874
*                              DO;                                 1874
         B     @RC01872                                            1874
@RF01872 DS    0H                                                  1875
*        RFY SNDSDIR BASED(PTVDSSNT->RSFCADR); /*DSDIR SN ENTRY      */
*                                RSCDSNT8 = PTVDSSNT; /*DSDIR SNTAB  */
         L     @07,RSPTWKC(,REG6)                                  1876
         L     @04,PTVDSSNT(,@07)                                  1876
         ST    @04,RSCDSNT8(,REG6)                                 1876
*                                RSCDSNT3 = PTVDISNT(PTINDX3); /*VGO */
         LH    @04,PTINDX3(,@07)                                   1877
         MH    @04,@CH00032                                        1877
         L     @07,PTVDISNT-12(@04,@07)                            1877
         ST    @07,RSCDSNT3(,REG6)                                 1877
*                                RSCDVOLR = GRABRAB1; /*VOL RCD      */
         L     @07,RSGRABCU(,REG6)                                 1878
         L     @04,GRABRAB1(,@07)                                  1878
         ST    @04,RSCDVOLR(,REG6)                                 1878
*                                RSCDDIR = GRABCURR; /*D-I RCD       */
         L     @07,GRABCURR(,@07)                                  1879
         ST    @07,RSCDDIR(,REG6)                                  1879
*                                /* CALL TO MODULE IDCRS03 FOR PROCEDUR
* CHKDSDIR                                                           */
*                                CALL CHKDSDIR;                    1880
*                                                                  1880
         L     @15,@CV03432                                        1880
         BALR  @14,@15                                             1880
*        RFY SNDSDIR;                  /*REVERT                      */
*                                PTVDSSNT->RSFENTLN = 0;           1882
         L     @07,RSPTWKC(,REG6)                                  1882
         L     @07,PTVDSSNT(,@07)                                  1882
         MVI   RSFENTLN(@07),X'00'                                 1882
*                                      /*FREE DSDIR SN TABLE         */
*                              END;                                1883
*                          END;                                    1884
@RC01872 DS    0H                                                  1885
*                      END VERDSDVG;   /*END VOL GO CHECKED          */
@RC01830 DS    0H                                                  1886
*                   END;                                           1886
@RF01828 DS    0H                                                  1887
*                END;                                              1887
@RT01810 L     @04,RSWASNVT(,REG6)                                 1887
         LA    @07,1                                               1887
         AH    @07,RSFCNDX(,@04)                                   1887
@DE01808 L     @04,RSWASNVT(,REG6)                                 1887
         STH   @07,RSFCNDX(,@04)                                   1887
         L     @04,RSWASNVT(,REG6)                                 1887
         CH    @07,RSFHNDX(,@04)                                   1887
         BNH   @DL01808                                            1887
*              END VERVOLGO;                                       1888
*            END;                                                  1889
*                                                                  1889
@RT01804 L     @04,RSPTWKC(,REG6)                                  1889
         LA    @07,1                                               1889
         AH    @07,PTINDX3(,@04)                                   1889
         L     @04,RSPTWKC(,REG6)                                  1889
         STH   @07,PTINDX3(,@04)                                   1889
         C     @07,@CF00149                                        1889
         BNH   @DL01802                                            1889
*        /************************************************************/
*        /*                                                          */
*        /*  MARK ALL PROCESSED DATA AND INDEX AS CHECKED FOR        */
*        /*  DSDIRS AND FREE THE SN TABLES                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1890
*  VERCLNUP:                                                       1890
*            DO PTINDX3 = 1 TO 2;                                  1890
VERCLNUP LA    @07,1                                               1890
         L     @04,RSPTWKC(,REG6)                                  1890
         STH   @07,PTINDX3(,@04)                                   1890
@DL01890 DS    0H                                                  1891
*              IF PTVDIASS(PTINDX3) ^= 0 THEN                      1891
         L     @07,RSPTWKC(,REG6)                                  1891
         LH    @04,PTINDX3(,@07)                                   1891
         MH    @04,@CH00032                                        1891
         L     @07,PTVDIASS-12(@04,@07)                            1891
         LTR   @07,@07                                             1891
         BZ    @RF01891                                            1891
*                DO;                                               1892
*                  GRABCURR = RABARRAY(PTVDIASS(PTINDX3)->TASSRAB);
         L     @04,RSGRABCU(,REG6)                                 1893
         LH    @07,TASSRAB(,@07)                                   1893
         SLA   @07,2                                               1893
         L     @07,RABARRAY-4(@07,@04)                             1893
         ST    @07,GRABCURR(,@04)                                  1893
*                                      /*BUFFER ADDRESS FOR D OR I   */
*                  RSWDSDIR = ON;      /*IND DSDIRS CHECKED          */
*                                                                  1894
         OI    RSWDSDIR(@07),B'00001000'                           1894
*                  DO;                                             1895
*                    RSRTYPE = ''B;                                1896
         MVI   RSRTYPE(REG6),X'00'                                 1896
*                    RSRUPDT = ON;     /* UPDRCD  */               1897
         OI    RSRUPDT(REG6),B'00100000'                           1897
*                    RSRUPD = ON;      /* UPDATE  */               1898
         OI    RSRUPD(REG6),B'00001000'                            1898
*                    RSRDS = ''B;                                  1899
         NI    RSRDS(REG6),B'00011111'                             1899
*                    RSRWF = ON;       /* WORKFILE  */             1900
*                    RSRDIR = ON;      /* DIRECT  */               1901
*                                                                  1901
         OI    RSRWF(REG6),B'10000100'                             1901
*                  /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT   */
*                  CALL RECMGMT;                                   1902
         L     @15,@CV03458                                        1902
         BALR  @14,@15                                             1902
*                    RFY RTNREG RSTD;                              1903
*                    TESTRC = RTNREG;                              1904
         STH   RTNREG,TESTRC(,REG6)                                1904
*                    RFY RTNREG UNRSTD;                            1905
*                  END;                                            1906
*                                      /*UPDATE THE WORKFILE RECORD  */
*                  IF PTVDISNT(PTINDX3) ^= 0 THEN                  1907
         L     @07,RSPTWKC(,REG6)                                  1907
         LH    @04,PTINDX3(,@07)                                   1907
         MH    @04,@CH00032                                        1907
         L     @07,PTVDISNT-12(@04,@07)                            1907
         LTR   @07,@07                                             1907
         BZ    @RF01907                                            1907
*                    PTVDISNT(PTINDX3)->RSFENTLN = 0;              1908
         MVI   RSFENTLN(@07),X'00'                                 1908
*                                      /*FREE SNTAB FOR D-I VGO      */
*                END;                                              1909
@RF01907 DS    0H                                                  1910
*            END VERCLNUP;                                         1910
*                                                                  1910
@RF01891 L     @04,RSPTWKC(,REG6)                                  1910
         LA    @07,1                                               1910
         AH    @07,PTINDX3(,@04)                                   1910
         L     @04,RSPTWKC(,REG6)                                  1910
         STH   @07,PTINDX3(,@04)                                   1910
         C     @07,@CF00149                                        1910
         BNH   @DL01890                                            1910
*        /************************************************************/
*        /*                                                          */
*        /*                  TERMINATE                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1911
*          END VERDSD;                                             1911
*                                                                  1911
*        IF GDTDBG = NULLPTR                                       1912
*          THEN;                                                   1912
@RT01721 L     @07,GDTDBG(,REG5)                                   1912
         LTR   @07,@07                                             1912
         BZ    @RT01912                                            1912
*          ELSE                                                    1914
*            CALL IDCDB010(GDTTBL,'RSV2');                         1914
*                                                                  1914
         ST    REG5,@AL00001                                       1914
         LA    @07,@CC03900                                        1914
         ST    @07,@AL00001+4                                      1914
         MVI   @AL00001+4,X'80'                                    1914
         L     @15,GDTDBG(,REG5)                                   1914
         LA    @01,@AL00001                                        1914
         BALR  @14,@15                                             1914
*        RFY TASSO;                    /*REVERT                      */
@RT01912 DS    0H                                                  1916
* CALL EXIT;  /*TERMINATE*/                                        1916
         BAL   @14,EXIT                                            1916
* END VERDSDIR; /*END OF PROCEDURE*/                               1917
@EL00012 DS    0H                                                  1917
@EF00012 DS    0H                                                  1917
@ER00012 BR    @14                                                 1917
@PB00012 DS    0H                                                  1918
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERG                                                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    VERIFY ALTERNATEINDEX(AIX) BASE ASSOCIATIONS.                 */
*/*      AIX<->DATA                                                  */
*/*      AIX<->INDEX                                                 */
*/*      AIX<->CLUSTER                                               */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE AIX                             */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    CITFAVER - SET ON IN AIX CITABE IF ASSOCIATION CHECKED        */
*/*    DITFAVER - SET ON IN ALL DITABE WHERE ASSOCIATION CHECKED.    */
*/*               NOTE CLUSTER->AIX IS CHECKED LAST SO THAT A PARTIAL*/
*/*               STRUCTURE IS NOT LEFT CONNECTED TO THE CLUSTER.    */
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*    IDC11023I - INVALID ASSOCIATION                               */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1918
         DS    0F
NAME0205 DC    CL8'VERG'
*VERG: PROCEDURE                                                   1919
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1919
*                                                                  1919
         B     @PB00013                                            1919
VERG     DS    0H                                                  1920
*      GENERATE REFS(RS02RG08, REG6);                              1920
*                                                                  1920
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0205  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      1921
         L     @07,GDTTR2(,REG5)                                   1921
         MVC   @TS00001(95),NEWERID2(@07)                          1921
         MVC   OLDERID2(95,@07),@TS00001                           1921
*        NEWID2 = 'RSRG';                                          1922
         MVC   NEWID2(4,@07),@CC03904                              1922
*        RFY CITABE BASED(RSTENTAD);                               1923
*        RFY DITABE BASED(PTLCDIT);                                1924
*                                                                  1924
*        /************************************************************/
*        /*                                                          */
*        /* EXPECTED ASSOCIATIONS TABLE                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1925
*        DECLARE                                                   1925
*          AIXTBL CHAR(3) INIT('DIC'); /*AIX ASSOCIATIONS            */
*                                                                  1925
*        /************************************************************/
*        /*                                                          */
*        /* CLEAR ERROR TABLE ARRAY FOR ALL ASSOCIATIONS             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1926
*        PTASSOE1 = PTASSOE1 && PTASSOE1;                          1926
*                                                                  1926
         L     @07,RSPTWKC(,REG6)                                  1926
         XC    PTASSOE1(40,@07),PTASSOE1(@07)                      1926
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS ALL ASSOCIATIONS EXPECTED                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1927
*        PTF1OK = ON;                  /*OK SO FAR                   */
         OI    PTF1OK(@07),B'00100000'                             1927
*        DO PTINDXV = 1 TO LENGTH(AIXTBL) WHILE(PTF1OK=ON);        1928
*                                                                  1928
         LA    @07,1                                               1928
         L     @04,RSPTWKC(,REG6)                                  1928
         STH   @07,PTINDXV(,@04)                                   1928
@DL01928 L     @07,RSPTWKC(,REG6)                                  1928
         TM    PTF1OK(@07),B'00100000'                             1928
         BNO   @DC01928                                            1928
*        /************************************************************/
*        /*                                                          */
*        /*     LOCATE EXPECTED ASSOCIATION BY SEQUENCE NUMBER       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1929
*          PTLOC = PTLOC && PTLOC;                                 1929
         XC    PTLOC(20,@07),PTLOC(@07)                            1929
*          PTLBCITX = PTCITI;          /*AIX BASE FOR LOCATE         */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1930
*          PTLFBAS1 = ON;              /*SCAN ASSOCIATIONS ONLY      */
         OI    PTLFBAS1(@07),B'00100000'                           1931
*          PTLSN = PTINDXV;            /*SEQUENCE # OF ASSN          */
         LH    @04,PTINDXV(,@07)                                   1932
         STH   @04,PTLSN(,@07)                                     1932
*          CALL LOCDIT;                                            1933
*                                                                  1933
         BAL   @14,LOCDIT                                          1933
*        /************************************************************/
*        /*                                                          */
*        /*     IF NO ASSOCIATION, ERROR                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1934
*          IF PTLCDIT = 0 THEN                                     1934
         L     @07,RSPTWKC(,REG6)                                  1934
         L     @04,PTLCDIT(,@07)                                   1934
         LTR   @04,@04                                             1934
         BNZ   @RF01934                                            1934
*            PTF1OK = OFF;                                         1935
*                                                                  1935
         NI    PTF1OK(@07),B'11011111'                             1935
*        /************************************************************/
*        /*                                                          */
*        /*     GET ASSOCIATION'S CI TABLE ENTRY                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1936
*          ELSE                                                    1936
*  VERGASSO:                                                       1936
*            DO;                                                   1936
         B     @RC01934                                            1936
@RF01934 DS    0H                                                  1936
VERGASSO DS    0H                                                  1937
*              RSTANCHR = ADDR(RSGCITS);                           1937
         LA    @07,RSGCITS(,REG6)                                  1937
         ST    @07,RSTANCHR(,REG6)                                 1937
*              RSTENTIX = DITCITAB;    /*ASSOCIATION INDEX           */
         L     @07,RSPTWKC(,REG6)                                  1938
         L     @07,PTLCDIT(,@07)                                   1938
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1938
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      1939
*                                                                  1939
         L     @15,@CV03436                                        1939
         BALR  @14,@15                                             1939
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK IF RECORD VALID AND TYPE SAME AS EXPECTED      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1940
*              IF CITFAINV=ON  CITTYPE^=AIXTBL(PTINDXV:PTINDXV) THEN
         L     @07,RSTENTAD(,REG6)                                 1940
         TM    CITFAINV(@07),B'00000010'                           1940
         BO    @RT01940                                            1940
         L     @04,RSPTWKC(,REG6)                                  1940
         LH    @04,PTINDXV(,@04)                                   1940
         LA    @01,AIXTBL-1(@04)                                   1940
         CLC   CITTYPE(1,@07),0(@01)                               1940
         BE    @RF01940                                            1940
@RT01940 DS    0H                                                  1941
*                PTF1OK = OFF;                                     1941
*                                                                  1941
         L     @07,RSPTWKC(,REG6)                                  1941
         NI    PTF1OK(@07),B'11011111'                             1941
*        /************************************************************/
*        /*                                                          */
*        /*     AIX->ASSOCIATION IS VERIFIED - MARK DITABE           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1942
*              ELSE                                                1942
*                DO;                                               1942
         B     @RC01940                                            1942
@RF01940 DS    0H                                                  1943
*                  DITFAVER = ON;                                  1943
         L     @07,RSPTWKC(,REG6)                                  1943
         L     @04,PTLCDIT(,@07)                                   1943
         OI    DITFAVER(@04),B'01000000'                           1943
*                  PTASSDIT(PTINDXV) = PTLCDIT; /*SAVE IN CASE OF ERR*/
         LH    @15,PTINDXV(,@07)                                   1944
         LR    @14,@15                                             1944
         SLA   @14,3                                               1944
         ST    @04,PTASSDIT-8(@14,@07)                             1944
*                  PTASSCIT(PTINDXV) = RSTENTAD; /*HAS CIN OF ASSN   */
*                                                                  1945
         L     @04,RSTENTAD(,REG6)                                 1945
         ST    @04,PTASSCIT-8(@14,@07)                             1945
*        /************************************************************/
*        /*                                                          */
*        /*     FOR DATA AND INDEX ASSOCIATION, MARK THE DATA        */
*        /*     AND INDEX AS VERIFIED.                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1946
*                  IF AIXTBL(PTINDXV:PTINDXV) = DATAID            1946
*                   AIXTBL(PTINDXV:PTINDXV) = INDEXID THEN         1946
         LA    @07,AIXTBL-1(@15)                                   1946
         CLI   0(@07),C'D'                                         1946
         BE    @RT01946                                            1946
         LA    @07,AIXTBL-1(@15)                                   1946
         CLI   0(@07),C'I'                                         1946
         BNE   @RF01946                                            1946
@RT01946 DS    0H                                                  1947
*                    CITFAVER = ON;                                1947
*                                                                  1947
         L     @07,RSTENTAD(,REG6)                                 1947
         OI    CITFAVER(@07),B'01000000'                           1947
*        /************************************************************/
*        /*                                                          */
*        /*     ALL ASSOCIATIONS ARE TWO WAY FOR BASE AIX. SCAN THE  */
*        /*     ASSOCIATION RECORD TO FIND THE RECIPROCAL ASSOCIATION*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1948
*                  PTCITWK = DITCITAB; /*SAVE D OR I OR C            */
@RF01946 L     @07,RSPTWKC(,REG6)                                  1948
         L     @04,PTLCDIT(,@07)                                   1948
         L     @04,DITCITAB-1(,@04)                                1948
         LA    @04,0(,@04)                                         1948
         ST    @04,PTCITWK(,@07)                                   1948
*                  PTLOC = PTLOC && PTLOC;                         1949
         XC    PTLOC(20,@07),PTLOC(@07)                            1949
*                  PTLBCITX = PTCITWK; /*D-I-C INDEX                 */
         STCM  @04,7,PTLBCITX(@07)                                 1950
*                  PTLFBAS1 = ON;      /*ASSOCIATION ONLY SCAN       */
         OI    PTLFBAS1(@07),B'00100000'                           1951
*                  IF AIXTBL(PTINDXV:PTINDXV) = CLID THEN          1952
         LH    @04,PTINDXV(,@07)                                   1952
         LA    @01,AIXTBL-1(@04)                                   1952
         CLI   0(@01),C'C'                                         1952
         BNE   @RF01952                                            1952
*                    PTLSN = 0;        /*ASSN FROM C NOT POSITIONAL  */
         SLR   @04,@04                                             1953
         STH   @04,PTLSN(,@07)                                     1953
*                  ELSE                                            1954
*                    PTLSN = 1;        /*FIRST ASSOCIATION ORIENT    */
         B     @RC01952                                            1954
@RF01952 L     @07,RSPTWKC(,REG6)                                  1954
         MVC   PTLSN(2,@07),@CH00212                               1954
*                  PTF1ENDG=OFF;       /*LOOP TERMINATOR             */
*                                                                  1955
@RC01952 L     @07,RSPTWKC(,REG6)                                  1955
         NI    PTF1ENDG(@07),B'11111101'                           1955
*  VERGAIX:                                                        1956
*                  DO WHILE(PTF1OK=ON & PTF1ENDG=OFF);             1956
VERGAIX  B     @DE01956                                            1956
@DL01956 DS    0H                                                  1957
*                    CALL LOCDIT;                                  1957
*                                                                  1957
         BAL   @14,LOCDIT                                          1957
*        /************************************************************/
*        /*                                                          */
*        /*     NO ASSOCIATION FOUND                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1958
*                    IF PTLCDIT = 0 THEN                           1958
         L     @07,RSPTWKC(,REG6)                                  1958
         L     @04,PTLCDIT(,@07)                                   1958
         LTR   @04,@04                                             1958
         BNZ   @RF01958                                            1958
*                      PTF1OK = OFF;                               1959
*                                                                  1959
         NI    PTF1OK(@07),B'11011111'                             1959
*        /************************************************************/
*        /*                                                          */
*        /*     ASSOCIATION FOUND - GET CI TABLE ENTRY               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1960
*                    ELSE                                          1960
*                      DO;                                         1960
         B     @RC01958                                            1960
@RF01958 DS    0H                                                  1961
*                        RSTANCHR = ADDR(RSGCITS);                 1961
         LA    @07,RSGCITS(,REG6)                                  1961
         ST    @07,RSTANCHR(,REG6)                                 1961
*                        RSTENTIX = DITCITAB;                      1962
         L     @07,RSPTWKC(,REG6)                                  1962
         L     @07,PTLCDIT(,@07)                                   1962
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1962
*                        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEX
*E                                                                   */
*                        CALL GETNEXTE;                            1963
*                                                                  1963
         L     @15,@CV03436                                        1963
         BALR  @14,@15                                             1963
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE ASSOCIATION BACK TO AIX                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1964
*                        IF CITTYPE=AIXID &                        1964
*                         CITCIN=PTCITF->CITCIN THEN               1964
         L     @07,RSTENTAD(,REG6)                                 1964
         CLI   CITTYPE(@07),C'G'                                   1964
         BNE   @RF01964                                            1964
         L     @04,RSPTWKC(,REG6)                                  1964
         L     @01,PTCITF(,@04)                                    1964
         CLC   CITCIN(3,@07),CITCIN(@01)                           1964
         BNE   @RF01964                                            1964
*                          DO;                                     1965
*                            DITFAVER = ON; /*ASSN VERIFIED          */
         L     @07,PTLCDIT(,@04)                                   1966
         OI    DITFAVER(@07),B'01000000'                           1966
*                            PTF1ENDG = ON; /*KILL THIS LOOP         */
         OI    PTF1ENDG(@04),B'00000010'                           1967
*                          END;                                    1968
*                                                                  1968
*        /************************************************************/
*        /*                                                          */
*        /*     IF BAD ASSOCIATION AND NOT CLUSTER SCAN, THEN        */
*        /*     MARK AS ERROR.                                       */
*        /*     IF CLUSTER SCAN, THE AIX ASSOCIATION IS NOT          */
*        /*     POSITIONAL.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1969
*                        ELSE                                      1969
*                          IF AIXTBL(PTINDXV:PTINDXV)^=CLID THEN   1969
         B     @RC01964                                            1969
@RF01964 L     @07,RSPTWKC(,REG6)                                  1969
         LH    @04,PTINDXV(,@07)                                   1969
         LA    @01,AIXTBL-1(@04)                                   1969
         CLI   0(@01),C'C'                                         1969
         BE    @RF01969                                            1969
*                            PTF1OK = OFF;                         1970
         NI    PTF1OK(@07),B'11011111'                             1970
*                      END;                                        1971
@RF01969 DS    0H                                                  1971
@RC01964 DS    0H                                                  1972
*                  END VERGAIX;                                    1972
@RC01958 DS    0H                                                  1972
@DE01956 L     @07,RSPTWKC(,REG6)                                  1972
         TM    PTF1OK(@07),B'00100000'                             1972
         BNO   @DC01956                                            1972
         TM    PTF1ENDG(@07),B'00000010'                           1972
         BZ    @DL01956                                            1972
@DC01956 DS    0H                                                  1973
*                END;                                              1973
*            END VERGASSO;                                         1974
@RC01940 DS    0H                                                  1975
*        END;                                                      1975
*                                                                  1975
@RC01934 L     @04,RSPTWKC(,REG6)                                  1975
         LA    @07,1                                               1975
         AH    @07,PTINDXV(,@04)                                   1975
         L     @04,RSPTWKC(,REG6)                                  1975
         STH   @07,PTINDXV(,@04)                                   1975
         C     @07,@CF00158                                        1975
         BNH   @DL01928                                            1975
@DC01928 DS    0H                                                  1976
*        /************************************************************/
*        /*                                                          */
*        /* IF INVALID ASSOCIATION, ISSUE MESSAGE IDC11023I          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1976
*        PTINDXV = PTINDXV - 1;        /*TRUE ENTRY NUMBER           */
         L     @07,RSPTWKC(,REG6)                                  1976
         LH    @04,PTINDXV(,@07)                                   1976
         BCTR  @04,0                                               1976
         STH   @04,PTINDXV(,@07)                                   1976
*        IF PTF1OK = OFF THEN                                      1977
         TM    PTF1OK(@07),B'00100000'                             1977
         BNZ   @RF01977                                            1977
*          IF PTASSCIT(PTINDXV) = 0 THEN /*MISSING ASSOCIATION       */
*                                                                  1978
         LR    @15,@04                                             1978
         SLA   @15,3                                               1978
         L     @15,PTASSCIT-8(@15,@07)                             1978
         LTR   @15,@15                                             1978
         BNZ   @RF01978                                            1978
*            DO;                                                   1979
*            /*CALL CKERR*/                                        1980
*              RSCKERR = RSCKERR && RSCKERR;                       1980
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1980
*              RSCKERN = RSE041;                                   1981
         MVC   RSCKERN(2,REG6),@CH00969                            1981
*              RSCKTERM = 'RETU';                                  1982
         MVC   RSCKTERM(4,REG6),@CC03787                           1982
*              RSCKMVAR(1) = ADDR(PTBASE->CNAME);                  1983
         L     @07,PTBASE(,@07)                                    1983
         LA    @07,CNAME(,@07)                                     1983
         ST    @07,RSCKMVAR(,REG6)                                 1983
*              RSCKMVAR(2) = ADDR(AIXID);                          1984
         LA    @07,@CC00806                                        1984
         ST    @07,RSCKMVAR+4(,REG6)                               1984
*              RSCKMVAR(3) = ADDR(AIXTBL(PTINDXV:PTINDXV));        1985
*                                                                  1985
         LA    @07,AIXTBL-1(@04)                                   1985
         ST    @07,RSCKMVAR+8(,REG6)                               1985
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1986
         L     @15,@CV03449                                        1986
         BALR  @14,@15                                             1986
*            END;                                                  1987
*          ELSE                                                    1988
*                                                                  1988
*            DO;                                                   1988
         B     @RC01978                                            1988
@RF01978 DS    0H                                                  1989
*            /*CALL CKERR*/                                        1989
*              RSCKERR = RSCKERR && RSCKERR;                       1989
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1989
*              RSCKERN = RSE026;                                   1990
         MVC   RSCKERN(2,REG6),@CH00942                            1990
*              RSCKTERM = 'RETU';                                  1991
         MVC   RSCKTERM(4,REG6),@CC03787                           1991
*              RSCKMVAR(1) = ADDR(PTBASE->CNAME);                  1992
         L     @07,RSPTWKC(,REG6)                                  1992
         L     @04,PTBASE(,@07)                                    1992
         LA    @04,CNAME(,@04)                                     1992
         ST    @04,RSCKMVAR(,REG6)                                 1992
*              RSCKMVAR(2) = ADDR(AIXID);                          1993
         LA    @04,@CC00806                                        1993
         ST    @04,RSCKMVAR+4(,REG6)                               1993
*              RSCKMVAR(3) = ADDR(PTASSCIT(PTINDXV)->CITCIN);      1994
         LH    @04,PTINDXV(,@07)                                   1994
         SLA   @04,3                                               1994
         L     @07,PTASSCIT-8(@04,@07)                             1994
         LA    @04,CITCIN(,@07)                                    1994
         ST    @04,RSCKMVAR+8(,REG6)                               1994
*              RSCKMVAR(4) = ADDR(PTASSCIT(PTINDXV)->CITTYPE);     1995
*                                                                  1995
         LA    @07,CITTYPE(,@07)                                   1995
         ST    @07,RSCKMVAR+12(,REG6)                              1995
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1996
         L     @15,@CV03449                                        1996
         BALR  @14,@15                                             1996
*            END;                                                  1997
*                                                                  1997
*        /************************************************************/
*        /*                                                          */
*        /*                AIX VERIFIED                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1998
*        ELSE                                                      1998
*          PTCITF->CITFAVER = ON;                                  1998
*                                                                  1998
         B     @RC01977                                            1998
@RF01977 L     @07,RSPTWKC(,REG6)                                  1998
         L     @07,PTCITF(,@07)                                    1998
         OI    CITFAVER(@07),B'01000000'                           1998
*        RFY CITABE;                   /*REVERT                      */
@RC01977 DS    0H                                                  2000
*        RFY DITABE;                   /*REVERT                      */
*                                                                  2000
* CALL EXIT;  /*TERMINATE*/                                        2001
         BAL   @14,EXIT                                            2001
* END VERG; /*END OF PROCEDURE*/                                   2002
@EL00013 DS    0H                                                  2002
@EF00013 DS    0H                                                  2002
@ER00013 BR    @14                                                 2002
@PB00013 DS    0H                                                  2003
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERR                                                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    VERIFY PATH ASSOCIATIONS FOR A PATH OVER A CLUSTER:           */
*/*      PATH<->CLUSTER                                              */
*/*      PATH->DATA                                                  */
*/*      PATH->INDEX(IF KSDS)                                        */
*/*    VERIFY PATH ASSOCIATIONS FOR A PATH OVER AN ALTERNATEINDEX    */
*/*      PATH<->ALTERNATEINDEX                                       */
*/*      PATH->DATA(AIX)                                             */
*/*      PATH->INDEX(AIX)                                            */
*/*      PATH->DATA(CLUSTER)                                         */
*/*      PATH->INDEX(CLUSTER IF KSDS)                                */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE PATH                            */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*    CITFAVER - SET ON IN PATH CITABE IF ASSOCIATION CHECKED.      */
*/*    DITFAVER - SET ON IN ALL DITABE WHERE THE ASSOCIATION CHECKED.*/
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*    IDC11023I - INVALID ASSOCIATION                               */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   2003
         DS    0F
NAME0215 DC    CL8'VERR'
*VERR: PROCEDURE                                                   2004
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2004
*                                                                  2004
         B     @PB00014                                            2004
VERR     DS    0H                                                  2005
*      GENERATE REFS(RS02RG08, REG6);                              2005
*                                                                  2005
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0215  PROCNAME TO REGSAVE
*        /************************************************************/
*        /*                                                          */
*        /* DATA TABLES DENOTING THE ORDER OF ASSOCIATIONS FOR       */
*        /* PATH OVER CLUSTER AND PATH OVER ALTERNATEINDEX           */
*        /*                                                          */
*        /************************************************************/
*                                                                  2006
*        DECLARE                                                   2006
*          PATHCTBL CHAR(3) INIT('CDI'); /*PATH OVER CLUSTER         */
*        DECLARE                                                   2007
*          PATHGTBL CHAR(5) INIT('GDIDI'); /*PATH OVER AIX           */
*                                                                  2007
*        OLDERID2 = NEWERID2;                                      2008
         L     @07,GDTTR2(,REG5)                                   2008
         MVC   @TS00001(95),NEWERID2(@07)                          2008
         MVC   OLDERID2(95,@07),@TS00001                           2008
*        NEWID2 = 'RSVR';                                          2009
*                                                                  2009
         MVC   NEWID2(4,@07),@CC03920                              2009
*        /************************************************************/
*        /*                                                          */
*        /* GET THE NUMBER OF ASSOCIATIONS EXPECTED AND THEIR TYPES. */
*        /*                                                          */
*        /************************************************************/
*                                                                  2010
*        IF RSPTWKC->TABBACKW->PTCITF->CITTYPE=CLID THEN           2010
         L     @07,RSPTWKC(,REG6)                                  2010
         L     @04,TABBACKW(,@07)                                  2010
         L     @04,PTCITF(,@04)                                    2010
         CLI   CITTYPE(@04),C'C'                                   2010
         BNE   @RF02010                                            2010
*                                      /*PATH OVER A CLUSTER         */
*          DO;                                                     2011
*            PTASSEXP = ADDR(PATHCTBL); /*EXPECTED ASSOCIATIONS      */
         LA    @04,PATHCTBL                                        2012
         ST    @04,PTASSEXP(,@07)                                  2012
*            PTINDXV = LENGTH(PATHCTBL); /*NUMBER OF EXPECTED ASSNS  */
         MVC   PTINDXV(2,@07),@CH00158                             2013
*          END;                                                    2014
*        ELSE                                                      2015
*          DO;                                                     2015
         B     @RC02010                                            2015
@RF02010 DS    0H                                                  2016
*            PTASSEXP = ADDR(PATHGTBL); /*EXPECTED ASSOCIATIONS      */
         L     @07,RSPTWKC(,REG6)                                  2016
         LA    @04,PATHGTBL                                        2016
         ST    @04,PTASSEXP(,@07)                                  2016
*            PTINDXV = LENGTH(PATHGTBL); /*NUMBER OF EXPECTED ASSNS  */
         MVC   PTINDXV(2,@07),@CH00280                             2017
*          END;                                                    2018
*                                                                  2018
*        /************************************************************/
*        /*                                                          */
*        /* IF BASE CLUSTER IS NOT A KSDS, NO ASSOCIATION TO INDEX   */
*        /*                                                          */
*        /************************************************************/
*                                                                  2019
*        IF RSPTWKF->PTF2KSDS = OFF THEN                           2019
@RC02010 L     @07,RSPTWKF(,REG6)                                  2019
         TM    PTF2KSDS(@07),B'10000000'                           2019
         BNZ   @RF02019                                            2019
*          PTINDXV = PTINDXV - 1;                                  2020
*                                                                  2020
         L     @07,RSPTWKC(,REG6)                                  2020
         LH    @04,PTINDXV(,@07)                                   2020
         BCTR  @04,0                                               2020
         STH   @04,PTINDXV(,@07)                                   2020
*        /************************************************************/
*        /*                                                          */
*        /* GET ALL ASSOCIATION ENTRIES EXPECTED FROM PATH           */
*        /*                                                          */
*        /************************************************************/
*                                                                  2021
*        PTASSOE1 = PTASSOE1 && PTASSOE1; /*CLEAR CIT-DIT TABLES     */
@RF02019 L     @07,RSPTWKC(,REG6)                                  2021
         XC    PTASSOE1(40,@07),PTASSOE1(@07)                      2021
*        PTASSOEA = ADDR(PTASSOE1);    /*FIRST DITABE ENTRY POINTER  */
         LA    @04,PTASSOE1(,@07)                                  2022
         ST    @04,PTASSOEA(,@07)                                  2022
*        PTF1OK = ON;                  /*LOOP UNTIL ERROR            */
*                                                                  2023
         OI    PTF1OK(@07),B'00100000'                             2023
*        DO PTINDX4 = 1 TO PTINDXV WHILE(PTF1OK=ON);               2024
         LA    @07,1                                               2024
         B     @DE02024                                            2024
@DL02024 L     @07,RSPTWKC(,REG6)                                  2024
         TM    PTF1OK(@07),B'00100000'                             2024
         BNO   @DC02024                                            2024
*          PTLOC = PTLOC && PTLOC;                                 2025
         XC    PTLOC(20,@07),PTLOC(@07)                            2025
*          PTLBCITX = PTCITI;          /*SCAN PATH                   */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         2026
*          PTLFBAS1 = ON;              /*SCAN ASSOCIATIONS ONLY      */
         OI    PTLFBAS1(@07),B'00100000'                           2027
*          PTLSN = PTINDX4;            /*SEQ NO. OF ASSOCIATION      */
         LH    @04,PTINDX4(,@07)                                   2028
         STH   @04,PTLSN(,@07)                                     2028
*          CALL LOCDIT;                                            2029
*                                                                  2029
         BAL   @14,LOCDIT                                          2029
*        /************************************************************/
*        /*                                                          */
*        /* IF NO ASSOCIATION - ERROR                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  2030
*          IF PTLCDIT = 0 THEN                                     2030
         L     @07,RSPTWKC(,REG6)                                  2030
         L     @04,PTLCDIT(,@07)                                   2030
         LTR   @04,@04                                             2030
         BNZ   @RF02030                                            2030
*            PTF1OK = OFF;             /*ERROR: EXPECTED ASSN NOT FND*/
*                                                                  2031
         NI    PTF1OK(@07),B'11011111'                             2031
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF ASSOCIATION TO EXPECTED OBJECT                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  2032
*          ELSE                                                    2032
*            DO;                                                   2032
         B     @RC02030                                            2032
@RF02030 DS    0H                                                  2033
*              PTASDIT1 = PTLCDIT;     /*SAVE ASSOCIATION            */
         L     @07,RSPTWKC(,REG6)                                  2033
         L     @04,PTASSOEA(,@07)                                  2033
         L     @07,PTLCDIT(,@07)                                   2033
         ST    @07,PTASDIT1(,@04)                                  2033
*              RSTANCHR = ADDR(RSGCITS);                           2034
         LA    @04,RSGCITS(,REG6)                                  2034
         ST    @04,RSTANCHR(,REG6)                                 2034
*              RSTENTIX = PTLCDIT->DITCITAB; /*GET ASSN CITABE INDX  */
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      2035
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      2036
         L     @15,@CV03436                                        2036
         BALR  @14,@15                                             2036
*              IF RSTENTAD->CITFAVER=OFF                          2037
*               RSTENTAD->CITTYPE^=PTASSEX(PTINDX4:PTINDX4) THEN   2037
         L     @07,RSTENTAD(,REG6)                                 2037
         TM    CITFAVER(@07),B'01000000'                           2037
         BZ    @RT02037                                            2037
         L     @04,RSPTWKC(,REG6)                                  2037
         LH    @01,PTINDX4(,@04)                                   2037
         L     @04,PTASSEXP(,@04)                                  2037
         ALR   @04,@01                                             2037
         BCTR  @04,0                                               2037
         CLC   CITTYPE(1,@07),PTASSEX(@04)                         2037
         BE    @RF02037                                            2037
@RT02037 DS    0H                                                  2038
*                PTF1OK=OFF;                                       2038
         L     @07,RSPTWKC(,REG6)                                  2038
         NI    PTF1OK(@07),B'11011111'                             2038
*              ELSE                                                2039
*                                      /* ASSOCIATION VERIFIED       */
*                DO;                                               2039
         B     @RC02037                                            2039
@RF02037 DS    0H                                                  2040
*                  PTASDIT1->DITFAVER = ON; /*MARK ASSN VERIFIED     */
         L     @07,RSPTWKC(,REG6)                                  2040
         L     @04,PTASSOEA(,@07)                                  2040
         L     @01,PTASDIT1(,@04)                                  2040
         OI    DITFAVER(@01),B'01000000'                           2040
*                  PTASSOEA = PTASSOEA + LENGTH(PTASOE); /*NEXT ENTRY*/
         AL    @04,@CF00175                                        2041
         ST    @04,PTASSOEA(,@07)                                  2041
*                END;                                              2042
*            END;                                                  2043
@RC02037 DS    0H                                                  2044
*        END;                                                      2044
*                                                                  2044
@RC02030 L     @04,RSPTWKC(,REG6)                                  2044
         LA    @07,1                                               2044
         AH    @07,PTINDX4(,@04)                                   2044
@DE02024 L     @04,RSPTWKC(,REG6)                                  2044
         STH   @07,PTINDX4(,@04)                                   2044
         L     @04,RSPTWKC(,REG6)                                  2044
         CH    @07,PTINDXV(,@04)                                   2044
         BNH   @DL02024                                            2044
@DC02024 DS    0H                                                  2045
*        /************************************************************/
*        /*                                                          */
*        /* IF ERROR ISSUE MESSAGE IDC11023I                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  2045
*        PTINDX4 = PTINDX4 - 1;        /*LAST ENTRY PROCESSED        */
         L     @07,RSPTWKC(,REG6)                                  2045
         LH    @04,PTINDX4(,@07)                                   2045
         BCTR  @04,0                                               2045
         STH   @04,PTINDX4(,@07)                                   2045
*        IF PTF1OK = OFF THEN                                      2046
         TM    PTF1OK(@07),B'00100000'                             2046
         BNZ   @RF02046                                            2046
*                                      /*ASSOCIATION MISSING         */
*                                                                  2047
*          DO;                                                     2047
*          /*CALL CKERR*/                                          2048
*            RSCKERR = RSCKERR && RSCKERR;                         2048
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2048
*            RSCKERN = RSE041;                                     2049
         MVC   RSCKERN(2,REG6),@CH00969                            2049
*            RSCKTERM = 'RETU';                                    2050
         MVC   RSCKTERM(4,REG6),@CC03787                           2050
*            RSCKMVAR(1) = ADDR(PTBASE->CNAME);                    2051
         L     @01,PTBASE(,@07)                                    2051
         LA    @15,CNAME(,@01)                                     2051
         ST    @15,RSCKMVAR(,REG6)                                 2051
*            RSCKMVAR(2) = ADDR(PATHID);                           2052
         LA    @15,@CC00818                                        2052
         ST    @15,RSCKMVAR+4(,REG6)                               2052
*            RSCKMVAR(3) = ADDR(PTASSEX(PTINDX4:PTINDX4));         2053
*                                                                  2053
         L     @07,PTASSEXP(,@07)                                  2053
         BCTR  @07,0                                               2053
         LA    @07,PTASSEX(@04,@07)                                2053
         ST    @07,RSCKMVAR+8(,REG6)                               2053
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */
*          CALL CKERR;                                             2054
         L     @15,@CV03449                                        2054
         BALR  @14,@15                                             2054
*          END;                                                    2055
*                                                                  2055
*        /************************************************************/
*        /*                                                          */
*        /* ASSOCIATION CHECKED - MARK PATH VERIFIED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2056
*        ELSE                                                      2056
*          DO;                                                     2056
         B     @RC02046                                            2056
@RF02046 DS    0H                                                  2057
*            PTCITF->CITFAVER = ON;                                2057
*                                                                  2057
         L     @07,RSPTWKC(,REG6)                                  2057
         L     @04,PTCITF(,@07)                                    2057
         OI    CITFAVER(@04),B'01000000'                           2057
*        /************************************************************/
*        /*                                                          */
*        /* SCAN BASE FOR ASSOCIATION TO PATH                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  2058
*            PTF1OK = OFF;                                         2058
         NI    PTF1OK(@07),B'11011111'                             2058
*            PTLOC = PTLOC && PTLOC;                               2059
         XC    PTLOC(20,@07),PTLOC(@07)                            2059
*            PTLBCITX = PTASSDIT(1)->DITCITAB; /*C OR G CITABE       */
         L     @04,PTASSDIT(,@07)                                  2060
         MVC   PTLBCITX(3,@07),DITCITAB(@04)                       2060
*            PTLFBAS1 = ON;            /*ASSOCIATION ONLY SCAN       */
         OI    PTLFBAS1(@07),B'00100000'                           2061
*            PTLDITID = PATHID;        /*SCAN FOR PATH ONLY          */
         MVI   PTLDITID(@07),C'R'                                  2062
*            DO WHILE (PTF1OK = OFF);                              2063
         B     @DE02063                                            2063
@DL02063 DS    0H                                                  2064
*              CALL LOCDIT;                                        2064
         BAL   @14,LOCDIT                                          2064
*                                      /*GET NEXT BASE ASSN FOR PATH */
*              IF PTLCDIT = 0 THEN     /*SHOULD FIND PATH ASSN       */
*                                                                  2065
         L     @07,RSPTWKC(,REG6)                                  2065
         L     @07,PTLCDIT(,@07)                                   2065
         LTR   @07,@07                                             2065
         BNZ   @RF02065                                            2065
*                DO;                                               2066
*                /*CALL CKERR*/                                    2067
*                  RSCKERR = RSCKERR && RSCKERR;                   2067
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2067
*                  RSCKERN = RSE100;                               2068
         MVC   RSCKERN(2,REG6),@CH00143                            2068
*                  RSCKTERM = 'TERM';                              2069
*                                                                  2069
         MVC   RSCKTERM(4,REG6),@CC03762                           2069
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */
*                CALL CKERR;                                       2070
         L     @15,@CV03449                                        2070
         BALR  @14,@15                                             2070
*                END;                                              2071
*              RSTANCHR = ADDR(RSGCITS);                           2072
@RF02065 LA    @07,RSGCITS(,REG6)                                  2072
         ST    @07,RSTANCHR(,REG6)                                 2072
*              RSTENTIX = PTLCDIT->DITCITAB; /*A PATH CI TABLE ENTRY */
         L     @07,RSPTWKC(,REG6)                                  2073
         L     @07,PTLCDIT(,@07)                                   2073
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      2073
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */
*              CALL GETNEXTE;                                      2074
         L     @15,@CV03436                                        2074
         BALR  @14,@15                                             2074
*                                      /*GET PATH ENTRY              */
*                                                                  2075
*        /************************************************************/
*        /*                                                          */
*        /* IF BASE->PATH FOUND, MARK AS VERIFIED                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  2075
*              IF RSTENTAD->CITCIN = PTCITF->CITCIN THEN           2075
         L     @07,RSTENTAD(,REG6)                                 2075
         L     @04,RSPTWKC(,REG6)                                  2075
         L     @01,PTCITF(,@04)                                    2075
         CLC   CITCIN(3,@07),CITCIN(@01)                           2075
         BNE   @RF02075                                            2075
*                DO;                                               2076
*                  PTLCDIT->DITFAVER = ON; /*MARK C OR G ->PATH VER  */
         L     @07,PTLCDIT(,@04)                                   2077
         OI    DITFAVER(@07),B'01000000'                           2077
*                  PTF1OK = ON;                                    2078
         OI    PTF1OK(@04),B'00100000'                             2078
*                END;                                              2079
*            END;                                                  2080
@RF02075 DS    0H                                                  2080
@DE02063 L     @07,RSPTWKC(,REG6)                                  2080
         TM    PTF1OK(@07),B'00100000'                             2080
         BZ    @DL02063                                            2080
*          END;                                                    2081
*                                                                  2081
* CALL EXIT;  /*TERMINATE*/                                        2082
@RC02046 BAL   @14,EXIT                                            2082
* END VERR; /*END OF PROCEDURE*/                                   2083
@EL00014 DS    0H                                                  2083
@EF00014 DS    0H                                                  2083
@ER00014 BR    @14                                                 2083
@PB00014 DS    0H                                                  2084
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERU                                                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     VERIFY ANY ALIASES FOR USERCATALOGS                          */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE PATH                            */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*     CITFAVER - SET ON IN USERCATALOG RECORD TO                   */
*/*                INDICATE THAT THE ENTRY IS GOOD.                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   2084
         DS    0F
NAME0225 DC    CL8'VERU'
*VERU: PROCEDURE                                                   2085
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2085
*                                                                  2085
         B     @PB00015                                            2085
VERU     DS    0H                                                  2086
*      GENERATE REFS(RS02RG08, REG6);                              2086
*                                                                  2086
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0225  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      2087
         L     @07,GDTTR2(,REG5)                                   2087
         MVC   @TS00001(95),NEWERID2(@07)                          2087
         MVC   OLDERID2(95,@07),@TS00001                           2087
*        NEWID2 = 'RSVU';                                          2088
*                                                                  2088
         MVC   NEWID2(4,@07),@CC03924                              2088
*        /************************************************************/
*        /*                                                          */
*        /*  INDICATE THE USERCATALOG RECORD AS VERIFIED             */
*        /*                                                          */
*        /************************************************************/
*                                                                  2089
*        PTCITF->CITFAVER = ON;                                    2089
*                                                                  2089
         L     @07,RSPTWKC(,REG6)                                  2089
         L     @07,PTCITF(,@07)                                    2089
         OI    CITFAVER(@07),B'01000000'                           2089
*        /************************************************************/
*        /*                                                          */
*        /*  VERIFY ANY ALIASES OF THE USERCATALOG                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  2090
*        CALL VERX;                                                2090
         BAL   @14,VERX                                            2090
* CALL EXIT;  /*TERMINATE*/                                        2091
         BAL   @14,EXIT                                            2091
* END VERU; /*END OF PROCEDURE*/                                   2092
@EL00015 DS    0H                                                  2092
@EF00015 DS    0H                                                  2092
@ER00015 BR    @14                                                 2092
@PB00015 DS    0H                                                  2093
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE - VERX                                                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     VERIFY ALIAS CHAINS FOR NONVSAM AND USERCATALOG RECORDS.     */
*/*     IF THERE IS AN ERROR, REPAIR THE ALIAS CHAIN.                */
*/*                                                                  */
*/* INPUT -                                                          */
*/*    CI TABLE AND DI TABLE FOR THE BASE A OR U                     */
*/*     PTBASE - ADDRESS OF THE BASE RECORD                          */
*/*     PTCITI - CITABE INDEX FOR THE BASE A OR U                    */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*     CITFAVER - SET ON IN ALL VERIFIED ALIASES                    */
*/*     DITFAVER - SET ON IN ALL VERIFIED ASSOCIATIONS               */
*/*                                                                  */
*/* MESSAGES -                                                       */
*/*     IDC21024I - BAD ALIAS CHAIN                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   2093
         DS    0F
NAME0228 DC    CL8'VERX'
*VERX: PROCEDURE                                                   2094
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2094
*                                                                  2094
         B     @PB00016                                            2094
VERX     DS    0H                                                  2095
*      GENERATE REFS(RS02RG08, REG6);                              2095
*                                                                  2095
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0228  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      2096
         L     @07,GDTTR2(,REG5)                                   2096
         MVC   @TS00001(95),NEWERID2(@07)                          2096
         MVC   OLDERID2(95,@07),@TS00001                           2096
*        NEWID2 = 'RSVX';                                          2097
*                                                                  2097
         MVC   NEWID2(4,@07),@CC03928                              2097
*        /************************************************************/
*        /*                                                          */
*        /*  SCAN THE BASE NONVSAM OR USERCATALOG FOR AN             */
*        /*  ASSOCIATION TO AN ALIAS.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  2098
*        PTLOC = PTLOC && PTLOC;                                   2098
         L     @07,RSPTWKC(,REG6)                                  2098
         XC    PTLOC(20,@07),PTLOC(@07)                            2098
*        PTLBCITX = PTCITI;            /*SCAN A OR U                 */
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         2099
*        PTLFBAS1 = ON;                /*ASSOCIATION ONLY            */
         OI    PTLFBAS1(@07),B'00100000'                           2100
*        PTLDITID = ALIASID;           /*TO AN ALIAS                 */
         MVI   PTLDITID(@07),C'X'                                  2101
*        CALL LOCDIT;                                              2102
*                                                                  2102
         BAL   @14,LOCDIT                                          2102
*        /************************************************************/
*        /*                                                          */
*        /*  PERFORM ALIAS CHECKING                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  2103
*        IF PTLCDIT ^= 0 THEN                                      2103
         SLR   @07,@07                                             2103
         L     @04,RSPTWKC(,REG6)                                  2103
         L     @15,PTLCDIT(,@04)                                   2103
         CR    @15,@07                                             2103
         BE    @RF02103                                            2103
*          DO;                                                     2104
*                                                                  2104
*        /************************************************************/
*        /*                                                          */
*        /*     SET UP THE INITIAL ALIAS                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  2105
*            PTXUX1D = PTLCDIT;        /*U OR A PTR 1ST ALIAS        */
         ST    @15,PTXUX1D(,@04)                                   2105
*            PTXX1C = 0;               /*CURRENT ALIAS = NONE        */
         STH   @07,PTXX1C(,@04)                                    2106
*            PTXX2C = PTXUX1D->DITCITAB; /*NEXT ALIAS RECORD         */
*                                                                  2107
         L     @07,DITCITAB-1(,@15)                                2107
         LA    @07,0(,@07)                                         2107
         STH   @07,PTXX2C(,@04)                                    2107
*        /************************************************************/
*        /*                                                          */
*        /*     PROCESS ALL VALID ALIASES                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  2108
*  ALIASCHK:                                                       2108
*            DO UNTIL (PTXEND = ON);                               2108
ALIASCHK DS    0H                                                  2108
@DL02108 DS    0H                                                  2109
*              PTXEND = ON;            /*UNLESS VALID X - KILL IT    */
*                                                                  2109
         L     @07,RSPTWKC(,REG6)                                  2109
         OI    PTXEND(@07),B'10000000'                             2109
*        /************************************************************/
*        /*                                                          */
*        /*     CHANGE CURRENT X TO PREVIOUS X                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  2110
*              PTXX0C = PTXX1C;                                    2110
         LH    @04,PTXX1C(,@07)                                    2110
         STH   @04,PTXX0C(,@07)                                    2110
*              PTXX0X1D = PTXX1X2D;    /*PREV FORWARD ASSOCIATION    */
*                                                                  2111
         L     @15,PTXX1X2D(,@07)                                  2111
         ST    @15,PTXX0X1D(,@07)                                  2111
*        /************************************************************/
*        /*                                                          */
*        /*     CHANGE NEXT X TO CURRENT X                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  2112
*              PTXX1C = PTXX2C;                                    2112
*                                                                  2112
         LH    @15,PTXX2C(,@07)                                    2112
         STH   @15,PTXX1C(,@07)                                    2112
*        /************************************************************/
*        /*                                                          */
*        /*     CLEAR ASSOCIATIONS FOR CURRENT ALIAS                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2113
*              PTXX1AUD = 0;                                       2113
         SLR   @14,@14                                             2113
         ST    @14,PTXX1AUD(,@07)                                  2113
*              PTXX1X2D = 0;                                       2114
         ST    @14,PTXX1X2D(,@07)                                  2114
*              PTXX1X0D = 0;                                       2115
*                                                                  2115
         ST    @14,PTXX1X0D(,@07)                                  2115
*        /************************************************************/
*        /*                                                          */
*        /*     GET THE CURRENT ALIAS RECORD CI TABLE ENTRY          */
*        /*                                                          */
*        /************************************************************/
*                                                                  2116
*              IF PTXX0C = 0 & PTXX2C = 0 THEN;                    2116
         CR    @04,@14                                             2116
         BNE   @RF02116                                            2116
         CR    @15,@14                                             2116
         BE    @RT02116                                            2116
*                                      /*BAD BASE ASSOCIATION        */
*              ELSE                                                2118
*                DO;                                               2118
@RF02116 DS    0H                                                  2119
*                  RSTANCHR = ADDR(RSGCITS);                       2119
         LA    @07,RSGCITS(,REG6)                                  2119
         ST    @07,RSTANCHR(,REG6)                                 2119
*                  RSTENTIX = PTXX1C;                              2120
         L     @07,RSPTWKC(,REG6)                                  2120
         LH    @07,PTXX1C(,@07)                                    2120
         STCM  @07,7,RSTENTIX(REG6)                                2120
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */
*                  CALL GETNEXTE;                                  2121
         L     @15,@CV03436                                        2121
         BALR  @14,@15                                             2121
*                  PTXCITX1 = RSTENTAD;                            2122
*                                                                  2122
         L     @07,RSPTWKC(,REG6)                                  2122
         L     @04,RSTENTAD(,REG6)                                 2122
         ST    @04,PTXCITX1(,@07)                                  2122
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE VALID RECORD                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  2123
*                  IF PTXCITX1->CITFAINV = ON THEN;                2123
*                                                                  2123
         TM    CITFAINV(@04),B'00000010'                           2123
         BO    @RT02123                                            2123
*        /************************************************************/
*        /*                                                          */
*        /*     VERIFY ALIAS ASSOCIATION TO THE BASE                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2125
*                  ELSE                                            2125
*                    DO;                                           2125
*                      PTLOC = PTLOC && PTLOC;                     2126
         L     @07,RSPTWKC(,REG6)                                  2126
         XC    PTLOC(20,@07),PTLOC(@07)                            2126
*                      PTLBCITX = PTXX1C; /*SCAN ALIAS               */
         LH    @04,PTXX1C(,@07)                                    2127
         STCM  @04,7,PTLBCITX(@07)                                 2127
*                      PTLFBAS1 = ON;  /*ASSOCIATION ONLY            */
         OI    PTLFBAS1(@07),B'00100000'                           2128
*                      PTLDITID = PTCITF->CITTYPE; /*TO BASE         */
         L     @04,PTCITF(,@07)                                    2129
         MVC   PTLDITID(1,@07),CITTYPE(@04)                        2129
*                      PTLSN = 1;                                  2130
         MVC   PTLSN(2,@07),@CH00212                               2130
*                      CALL LOCDIT;                                2131
         BAL   @14,LOCDIT                                          2131
*                      PTXX1AUD = PTLCDIT;                         2132
*                                                                  2132
         L     @07,RSPTWKC(,REG6)                                  2132
         L     @04,PTLCDIT(,@07)                                   2132
         ST    @04,PTXX1AUD(,@07)                                  2132
*        /************************************************************/
*        /*                                                          */
*        /*       ERROR ** NO ASSOCIATION TO THE BASE                */
*        /*                                                          */
*        /************************************************************/
*                                                                  2133
*                      IF (PTLCDIT = 0)                           2133
*                       (PTLCDIT->DITCITAB ^= PTCITI) THEN;        2133
*                                                                  2133
         LTR   @04,@04                                             2133
         BZ    @RT02133                                            2133
         CLC   DITCITAB(3,@04),PTCITI(@07)                         2133
         BNE   @RT02133                                            2133
*        /************************************************************/
*        /*                                                          */
*        /*     VERIFY ALIAS BACK CHAIN TO PREVIOUS ALIAS            */
*        /*                                                          */
*        /************************************************************/
*                                                                  2135
*                      ELSE                                        2135
*                        DO;                                       2135
*                          PTLOC = PTLOC && PTLOC;                 2136
         L     @07,RSPTWKC(,REG6)                                  2136
         XC    PTLOC(20,@07),PTLOC(@07)                            2136
*                          PTLBCITX = PTXX1C; /*SCAN ALIAS           */
         LH    @04,PTXX1C(,@07)                                    2137
         STCM  @04,7,PTLBCITX(@07)                                 2137
*                          PTLFBAS1 = ON; /*ASSOCIATION ONLY         */
         OI    PTLFBAS1(@07),B'00100000'                           2138
*                          PTLDITID = ALIASID; /*TO AN ALIAS         */
         MVI   PTLDITID(@07),C'X'                                  2139
*                          PTLSN = 3; /*THIRD ASSOCIATION            */
         MVC   PTLSN(2,@07),@CH00158                               2140
*                          CALL LOCDIT;                            2141
         BAL   @14,LOCDIT                                          2141
*                          PTXX1X0D = PTLCDIT;                     2142
*                                                                  2142
         L     @07,RSPTWKC(,REG6)                                  2142
         L     @04,PTLCDIT(,@07)                                   2142
         ST    @04,PTXX1X0D(,@07)                                  2142
*        /************************************************************/
*        /*                                                          */
*        /*       ERROR ** NO ASSOCIATION BACK TO PREVIOUS ALIAS OR  */
*        /*       ASSOCIATION DOES NOT POINT TO PREVIOUS ALIAS       */
*        /*                                                          */
*        /************************************************************/
*                                                                  2143
*                          IF (PTXX1X0D = 0)                      2143
*                           (PTXX1X0D->DITCITAB ^= PTXX0C) THEN;   2143
*                                                                  2143
         LTR   @04,@04                                             2143
         BZ    @RT02143                                            2143
         L     @04,DITCITAB-1(,@04)                                2143
         LA    @04,0(,@04)                                         2143
         CH    @04,PTXX0C(,@07)                                    2143
         BNE   @RT02143                                            2143
*        /************************************************************/
*        /*                                                          */
*        /*     VERIFY ALIAS FORWARD CHAIN EXISTS                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  2145
*                          ELSE                                    2145
*                            DO;                                   2145
*                              PTLOC = PTLOC && PTLOC;             2146
         L     @07,RSPTWKC(,REG6)                                  2146
         XC    PTLOC(20,@07),PTLOC(@07)                            2146
*                              PTLBCITX = PTXX1C; /*SCAN ALIAS       */
         LH    @04,PTXX1C(,@07)                                    2147
         STCM  @04,7,PTLBCITX(@07)                                 2147
*                              PTLFBAS1 = ON; /*ASSOCIATION ONLY     */
         OI    PTLFBAS1(@07),B'00100000'                           2148
*                              PTLDITID = ALIASID; /*TO AN ALIAS     */
         MVI   PTLDITID(@07),C'X'                                  2149
*                              PTLSN = 2; /*2ND ASSOCIATION          */
         MVC   PTLSN(2,@07),@CH00149                               2150
*                              CALL LOCDIT;                        2151
         BAL   @14,LOCDIT                                          2151
*                              PTXX1X2D = PTLCDIT; /*SAVE FORW ASSN  */
*                                                                  2152
         L     @07,RSPTWKC(,REG6)                                  2152
         L     @04,PTLCDIT(,@07)                                   2152
         ST    @04,PTXX1X2D(,@07)                                  2152
*        /************************************************************/
*        /*                                                          */
*        /*       ERROR ** NO ASSOCIATION FORWARD                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  2153
*                              IF PTLCDIT = 0 THEN;                2153
*                                                                  2153
         LTR   @04,@04                                             2153
         BZ    @RT02153                                            2153
*        /************************************************************/
*        /*                                                          */
*        /*     GOOD ALIAS - MARK ALL ASSOCIATION CHECKED AND        */
*        /*       THE ALIAS RECORD ITSELF AS VERIFIED.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  2155
*                              ELSE                                2155
*                                DO;                               2155
*                                  PTXX2C = PTLCDIT->DITCITAB; /*NXT */
         L     @07,RSPTWKC(,REG6)                                  2156
         L     @04,PTLCDIT(,@07)                                   2156
         L     @04,DITCITAB-1(,@04)                                2156
         LA    @04,0(,@04)                                         2156
         STH   @04,PTXX2C(,@07)                                    2156
*                                  PTXCITX1->CITFAVER=ON; /*ALIAS OK */
         L     @04,PTXCITX1(,@07)                                  2157
         OI    CITFAVER(@04),B'01000000'                           2157
*                                  PTXX1AUD->DITFAVER=ON; /*X->BASE  */
         L     @04,PTXX1AUD(,@07)                                  2158
         OI    DITFAVER(@04),B'01000000'                           2158
*                                  PTXX1X0D->DITFAVER=ON; /*X BACK CH*/
         L     @04,PTXX1X0D(,@07)                                  2159
         OI    DITFAVER(@04),B'01000000'                           2159
*                                  PTXX1X2D->DITFAVER=ON; /*X FORW CH*/
*                                                                  2160
         L     @04,PTXX1X2D(,@07)                                  2160
         OI    DITFAVER(@04),B'01000000'                           2160
*        /************************************************************/
*        /*                                                          */
*        /*       MARK BASE ASSOCIATION TO 1ST ALIAS AS VERIFIED     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2161
*                                  IF PTXX0C = 0 THEN              2161
         LH    @04,PTXX0C(,@07)                                    2161
         LTR   @04,@04                                             2161
         BNZ   @RF02161                                            2161
*                                    PTXUX1D->DITFAVER = ON;       2162
*                                                                  2162
         L     @07,PTXUX1D(,@07)                                   2162
         OI    DITFAVER(@07),B'01000000'                           2162
*        /************************************************************/
*        /*                                                          */
*        /*     IF NOT LAST ENTRY - PROCESS THE NEXT ALIAS           */
*        /*                                                          */
*        /************************************************************/
*                                                                  2163
*                                  IF PTXX2C ^= 0 THEN             2163
@RF02161 L     @07,RSPTWKC(,REG6)                                  2163
         LH    @04,PTXX2C(,@07)                                    2163
         LTR   @04,@04                                             2163
         BZ    @RF02163                                            2163
*                                    PTXEND = OFF;                 2164
         NI    PTXEND(@07),B'01111111'                             2164
*                                END;                              2165
@RF02163 DS    0H                                                  2166
*                            END;                                  2166
@RT02153 DS    0H                                                  2167
*                        END;                                      2167
@RT02143 DS    0H                                                  2168
*                    END;                                          2168
@RT02133 DS    0H                                                  2169
*                END;                                              2169
@RT02123 DS    0H                                                  2170
*            END ALIASCHK;                                         2170
*                                                                  2170
@RT02116 DS    0H                                                  2170
@DE02108 L     @07,RSPTWKC(,REG6)                                  2170
         TM    PTXEND(@07),B'10000000'                             2170
         BNO   @DL02108                                            2170
*        /************************************************************/
*        /*                                                          */
*        /*  REPAIR THE ALIAS CHAIN IF ERROR                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  2171
*            IF PTXX2C ^= 0 THEN       /*NEVER PROCESSED THE LAST    */
         LH    @04,PTXX2C(,@07)                                    2171
         LTR   @04,@04                                             2171
         BZ    @RF02171                                            2171
*              DO;                                                 2172
*                                                                  2172
*        /************************************************************/
*        /*                                                          */
*        /*     ISSUE MESSAGE IDC21024I                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  2173
*                                                                  2173
*                DO;                                               2173
*                /*CALL CKERR*/                                    2174
*                  RSCKERR = RSCKERR && RSCKERR;                   2174
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2174
*                  RSCKERN = RSE027;                               2175
         MVC   RSCKERN(2,REG6),@CH00944                            2175
*                  RSCKTERM = 'RETU';                              2176
         MVC   RSCKTERM(4,REG6),@CC03787                           2176
*                  RSCKMVAR(1) = ADDR(PTBASE->CNAME);              2177
         L     @07,PTBASE(,@07)                                    2177
         LA    @04,CNAME(,@07)                                     2177
         ST    @04,RSCKMVAR(,REG6)                                 2177
*                  RSCKMVAR(2) = ADDR(PTBASE->RCDID);              2178
*                                                                  2178
         LA    @07,RCDID(,@07)                                     2178
         ST    @07,RSCKMVAR+4(,REG6)                               2178
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */
*                CALL CKERR;                                       2179
         L     @15,@CV03449                                        2179
         BALR  @14,@15                                             2179
*                END;                                              2180
*                                                                  2180
*        /************************************************************/
*        /*                                                          */
*        /*     REPAIR THE LAST GOOD ALIAS'S FORWARD CHAIN PTR.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  2181
*                IF PTXX0C ^= 0 THEN   /*AT LEAST 1 GOOD ALIAS EXISTS*/
         SLR   @07,@07                                             2181
         L     @04,RSPTWKC(,REG6)                                  2181
         CH    @07,PTXX0C(,@04)                                    2181
         BE    @RF02181                                            2181
*                  DO;                                             2182
*                    PTXX0X1D->DITCITAB = 0;                       2183
         L     @04,PTXX0X1D(,@04)                                  2183
         STCM  @07,7,DITCITAB(@04)                                 2183
*                    PTXX0X1D->DITFARAS = ON; /*FORCE MODIFY         */
         OI    DITFARAS(@04),B'00100000'                           2184
*                  END;                                            2185
*              END;                                                2186
@RF02181 DS    0H                                                  2187
*          END;                                                    2187
@RF02171 DS    0H                                                  2188
* CALL EXIT;  /*TERMINATE*/                                        2188
@RF02103 BAL   @14,EXIT                                            2188
* END VERX; /*END OF PROCEDURE*/                                   2189
*                                                                  2189
@EL00016 DS    0H                                                  2189
@EF00016 DS    0H                                                  2189
@ER00016 BR    @14                                                 2189
@PB00016 DS    0H                                                  2190
*      GENERATE;                                                   2190
         DS    0F
         DC    CL8'EXIT'
*EXIT: PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                       2191
*                                                                  2191
         B     @PB00017                                            2191
EXIT     DS    0H                                                  2192
*        GEN(L     @13,4(,@13)); /*RESTORE CALLER'S REG SAVE*/     2192
         L     @13,4(,@13)
*        GEN(LM    @14,@12,12(@13));  /*RESTORE REGS*/             2193
         LM    @14,@12,12(@13)
*        GEN(MVI   12(@13),255);  /*MARK END OF SAVE LIST*/        2194
         MVI   12(@13),255
*        GEN(BR    14);  /*RETURN*/                                2195
         BR    14
*END EXIT;  /*END OF PROC EXIT*/                                   2196
*                                                                  2196
@EL00017 DS    0H                                                  2196
@EF00017 DS    0H                                                  2196
@ER00017 BR    @14                                                 2196
*END IDCRS02   /*END OF MODULE*/                                   2197
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IDCDF64 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRS )                                        *
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (AMCBS   )                                        *
*/*%INCLUDE SYSLIB  (IGGCAXWA)                                        *
*/*%INCLUDE SYSLIB  (IFGACB  )                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*;                                                                 2197
@EL00001 DS    0H                                                  2197
@EF00001 DS    0H                                                  2197
@ER00001 LM    @14,@12,12(@13)                                     2197
         BR    @14                                                 2197
@DATA    DS    0H
@CH00280 DC    H'5'
@CH00032 DC    H'12'
@CH00471 DC    H'16'
@CH00931 DC    H'20'
@CH00940 DC    H'25'
@CH00942 DC    H'26'
@CH00944 DC    H'27'
@CH00948 DC    H'29'
@CH00969 DC    H'41'
@CH00971 DC    H'42'
@CH01010 DC    H'63'
@CH00143 DC    H'100'
         DS    0F
@AL00342 DC    A(@CC03747)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CC00808)
         DS    F
         DC    A(@CF00111)
@DATD    DSECT
         DS    0F
@AL00001 DS    4A
@TF00001 DS    F
IDCRS02  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00212 DC    F'1'
@CH00212 EQU   @CF00212+2
@CF00149 DC    F'2'
@CH00149 EQU   @CF00149+2
@CF00158 DC    F'3'
@CH00158 EQU   @CF00158+2
@CF00038 DC    F'4'
@CF00175 DC    F'8'
@CF01845 DC    F'127'
@CF03934 DC    F'224'
@CF03188 DC    F'256'
@CF03953 DC    F'-8'
@CF03954 DC    F'-4'
@DATD    DSECT
         DS    0D
@TS00001 DS    CL95
         DS    CL1
FDTTBL   DS    CL8
         ORG   FDTTBL
FDTVERB  DS    CL8
FDTPTR   DS    0A
         ORG   FDTTBL+8
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRS02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV03430 DC    V(CATRCDSU)
@CV03431 DC    V(MARKUNUS)
@CV03432 DC    V(CHKDSDIR)
@CV03434 DC    V(PROCVOL)
@CV03435 DC    V(GETFIT)
@CV03436 DC    V(GETNEXTE)
@CV03437 DC    V(GETTAB)
@CV03438 DC    V(VERB)
@CV03440 DC    V(DELGO)
@CV03441 DC    V(FIND)
@CV03442 DC    V(GETVIA)
@CV03444 DC    V(IDCRS5SV)
@CV03445 DC    V(IDCRS5SR)
@CV03448 DC    V(ADDUPCR)
@CV03449 DC    V(CKERR)
@CV03458 DC    V(RECMGMT)
@CV03450 DC    V(ADDTN)
@CV03467 DC    V(CATEOV)
@CV03428 DC    V(CATINIT)
@CV03466 DC    V(CNVTCCHH)
@CV03462 DC    V(CRAEOV)
@CV03452 DC    V(CRAUPCHN)
@CV03451 DC    V(DELTN)
@CV03461 DC    V(ENSURECI)
@CV03464 DC    V(FRCRCCR)
@CV03453 DC    V(GENNAME)
@CV03447 DC    V(IDCRS5BR)
@CV03446 DC    V(IDCRS5BV)
@CV03443 DC    V(IDCRS5EN)
@CV03460 DC    V(IDCRS6CD)
@CV03459 DC    V(IDCRS6CM)
@CV03457 DC    V(IDCRS6DC)
@CV03456 DC    V(IDCRS6DO)
@CV03468 DC    V(IDCRS7SP)
@CV03439 DC    V(MODGO)
@CV03463 DC    V(RENAMEF)
@CV03469 DC    V(RENAMEP)
@CV03465 DC    V(UPDCCR)
@CV03433 DC    V(VOLCHK)
@CV03454 DC    V(WFDEF)
@CV03455 DC    V(WFDEL)
@CV03429 DC    V(WRAPUP)
         DS    0D
MAXCINO  DC    XL4'3FFFFF'
@CC00901 DC    C'RS04'
@CC00903 DC    C'RS10'
@CC03741 DC    C'RSAS'
@CC03754 DC    C'RSA1'
@CC03760 DC    C'RSCA'
@CC03762 DC    C'TERM'
@CC03767 DC    C'RSLO'
@CC03774 DC    C'RSPT'
@CC03778 DC    C'RSP4'
@CC03787 DC    C'RETU'
@CC03794 DC    C'RSP3'
@CC03798 DC    C'RSSC'
@CC03804 DC    C'RSSE'
@CC03823 DC    C'RSS2'
@CC03828 DC    C'RSVA'
@CC03842 DC    C'RSVC'
@CC03852 DC    C'RSVE'
@CC03881 DC    C'RSV3'
@CC03900 DC    C'RSV2'
@CC03904 DC    C'RSRG'
@CC03920 DC    C'RSVR'
@CC03924 DC    C'RSVU'
@CC03928 DC    C'RSVX'
@CC03835 DC    C'V00'
@CC03834 DC    C'.G'
@CC00800 DC    C'C'
@CC00802 DC    C'D'
@CC00806 DC    C'G'
@CC00808 DC    C'A'
@CC00810 DC    C'B'
@CC00816 DC    C'Y'
@CC00818 EQU   @CC00901
@CC00828 EQU   @CC03835
@CC03747 DC    C'N'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
TNTYPES  DC    CL11'CDIAXBVUMGR'
MAXEXPDT DC    X'99999F'
DUMMYNM  DC    X'FFFFFFFFFFFFFFFF'
RDFCIDF  DC    X'0001F901F90000'
PACKF    DC    X'0F'
DSCB1ID  DC    X'F1'
VOLUNUSE DC    X'0000'
NULLDIG  DC    X'00'
BADVOLSW DC    X'00'
FMT3NULL DC    X'0000000000'
DS4DSNM  DS    CL44
         ORG   DS4DSNM
@NM00040 DC    44X'04'
         ORG   DS4DSNM+44
         DS    CL1
PATCH    DS    CL800
         ORG   PATCH
@NM00216 DC    CL36'PATCHAREA 800 BYTES LAST USED 000000'
@NM00217 DC    764X'00'
         ORG   PATCH+800
ASSOCC   DS    CL32
         ORG   ASSOCC
@NM00218 DC    CL1'C'
@NM00219 DS    CL1
@NM00220 DC    H'7'
ASSOCC1  DS    CL4
         ORG   ASSOCC1
@NM00221 DC    CL1'C'
@NM00222 DC    X'E0'
@NM00223 DC    H'1'
         ORG   ASSOCC+8
ASSOCC2  DS    CL4
         ORG   ASSOCC2
@NM00224 DC    CL1'D'
@NM00225 DC    X'E0'
@NM00226 DC    H'2'
         ORG   ASSOCC+12
ASSOCC3  DS    CL4
         ORG   ASSOCC3
@NM00227 DC    CL1'I'
@NM00228 DC    X'E0'
@NM00229 DC    H'3'
         ORG   ASSOCC+16
ASSOCC4  DS    CL4
         ORG   ASSOCC4
@NM00230 DC    CL1'E'
@NM00231 DC    X'E0'
@NM00232 DC    H'4'
         ORG   ASSOCC+20
ASSOCC5  DS    CL4
         ORG   ASSOCC5
@NM00233 DC    CL1'R'
@NM00234 DC    X'00'
@NM00235 DS    FL2
         ORG   ASSOCC+24
ASSOCC6  DS    CL4
         ORG   ASSOCC6
@NM00236 DC    CL1'G'
@NM00237 DC    X'00'
@NM00238 DS    FL2
         ORG   ASSOCC+28
ASSOCC7  DS    CL4
         ORG   ASSOCC7
@NM00239 DC    CL1'Y'
@NM00240 DC    X'00'
@NM00241 DS    FL2
         ORG   ASSOCC+32
ASSOG    DS    CL28
         ORG   ASSOG
@NM00242 DC    CL1'G'
@NM00243 DS    CL1
@NM00244 DC    H'6'
ASSOG1   DS    CL4
         ORG   ASSOG1
@NM00245 DC    CL1'G'
@NM00246 DC    X'E0'
@NM00247 DC    H'1'
         ORG   ASSOG+8
ASSOG2   DS    CL4
         ORG   ASSOG2
@NM00248 DC    CL1'D'
@NM00249 DC    X'E0'
@NM00250 DC    H'2'
         ORG   ASSOG+12
ASSOG3   DS    CL4
         ORG   ASSOG3
@NM00251 DC    CL1'I'
@NM00252 DC    X'E0'
@NM00253 DC    H'3'
         ORG   ASSOG+16
ASSOG4   DS    CL4
         ORG   ASSOG4
@NM00254 DC    CL1'E'
@NM00255 DC    X'E0'
@NM00256 DC    H'4'
         ORG   ASSOG+20
ASSOG5   DS    CL4
         ORG   ASSOG5
@NM00257 DC    CL1'R'
@NM00258 DC    X'00'
@NM00259 DS    FL2
         ORG   ASSOG+24
ASSOG6   DS    CL4
         ORG   ASSOG6
@NM00260 DC    CL1'C'
@NM00261 DC    X'90'
@NM00262 DS    FL2
         ORG   ASSOG+28
ASSOR    DS    CL28
         ORG   ASSOR
@NM00263 DC    CL1'R'
@NM00264 DS    CL1
@NM00265 DC    H'6'
ASSOR1   DS    CL4
         ORG   ASSOR1
@NM00266 DC    CL1'R'
@NM00267 DC    X'E0'
@NM00268 DC    H'3'
         ORG   ASSOR+8
ASSOR2   DS    CL4
         ORG   ASSOR2
@NM00269 DC    CL1'E'
@NM00270 DC    X'E0'
@NM00271 DC    H'4'
         ORG   ASSOR+12
ASSOR3   DS    CL4
         ORG   ASSOR3
@NM00272 DC    CL1'C'
@NM00273 DC    X'90'
@NM00274 DS    FL2
         ORG   ASSOR+16
ASSOR4   DS    CL4
         ORG   ASSOR4
@NM00275 DC    CL1'D'
@NM00276 DC    X'90'
@NM00277 DS    FL2
         ORG   ASSOR+20
ASSOR5   DS    CL4
         ORG   ASSOR5
@NM00278 DC    CL1'I'
@NM00279 DC    X'90'
@NM00280 DS    FL2
         ORG   ASSOR+24
ASSOR6   DS    CL4
         ORG   ASSOR6
@NM00281 DC    CL1'G'
@NM00282 DC    X'90'
@NM00283 DS    FL2
         ORG   ASSOR+28
ASSOY    DS    CL20
         ORG   ASSOY
@NM00284 DC    CL1'Y'
@NM00285 DS    CL1
@NM00286 DC    H'4'
ASSOY1   DS    CL4
         ORG   ASSOY1
@NM00287 DC    CL1'Y'
@NM00288 DC    X'E0'
@NM00289 DC    H'4'
         ORG   ASSOY+8
ASSOY2   DS    CL4
         ORG   ASSOY2
@NM00290 DC    CL1'E'
@NM00291 DC    X'E0'
@NM00292 DC    H'4'
         ORG   ASSOY+12
ASSOY3   DS    CL4
         ORG   ASSOY3
@NM00293 DC    CL1'D'
@NM00294 DC    X'00'
@NM00295 DS    FL2
         ORG   ASSOY+16
ASSOY4   DS    CL4
         ORG   ASSOY4
@NM00296 DC    CL1'I'
@NM00297 DC    X'00'
@NM00298 DS    FL2
         ORG   ASSOY+20
ASSOA    DS    CL20
         ORG   ASSOA
@NM00299 DC    CL1'A'
@NM00300 DS    CL1
@NM00301 DC    H'4'
ASSOA1   DS    CL4
         ORG   ASSOA1
@NM00302 DC    CL1'A'
@NM00303 DC    X'E0'
@NM00304 DC    H'1'
         ORG   ASSOA+8
ASSOA2   DS    CL4
         ORG   ASSOA2
@NM00305 DC    CL1'E'
@NM00306 DC    X'E0'
@NM00307 DC    H'4'
         ORG   ASSOA+12
ASSOA3   DS    CL4
         ORG   ASSOA3
@NM00308 DC    CL1'X'
@NM00309 DC    X'E0'
@NM00310 DC    H'2'
         ORG   ASSOA+16
ASSOA4   DS    CL4
         ORG   ASSOA4
@NM00311 DC    CL1'B'
@NM00312 DC    X'00'
@NM00313 DS    FL2
         ORG   ASSOA+20
ASSOB    DS    CL16
         ORG   ASSOB
@NM00314 DC    CL1'B'
@NM00315 DS    CL1
@NM00316 DC    H'3'
ASSOB1   DS    CL4
         ORG   ASSOB1
@NM00317 DC    CL1'B'
@NM00318 DC    X'E0'
@NM00319 DC    H'1'
         ORG   ASSOB+8
ASSOB2   DS    CL4
         ORG   ASSOB2
@NM00320 DC    CL1'E'
@NM00321 DC    X'E0'
@NM00322 DC    H'4'
         ORG   ASSOB+12
ASSOB3   DS    CL4
         ORG   ASSOB3
@NM00323 DC    CL1'A'
@NM00324 DC    X'00'
@NM00325 DS    FL2
         ORG   ASSOB+16
ASSO3A   DS    CL20
         ORG   ASSO3A
@NM00326 DC    CL1'3'
@NM00327 DS    CL1
@NM00328 DC    H'4'
ASSO3A1  DS    CL4
         ORG   ASSO3A1
@NM00329 DC    CL1'A'
@NM00330 DC    X'E0'
@NM00331 DC    H'2'
         ORG   ASSO3A+8
ASSO3A2  DS    CL4
         ORG   ASSO3A2
@NM00332 DC    CL1'E'
@NM00333 DC    X'E0'
@NM00334 DC    H'4'
         ORG   ASSO3A+12
ASSO3A3  DS    CL4
         ORG   ASSO3A3
@NM00335 DC    CL1'X'
@NM00336 DC    X'E0'
@NM00337 DC    H'3'
         ORG   ASSO3A+16
ASSO3A4  DS    CL4
         ORG   ASSO3A4
@NM00338 DC    CL1'B'
@NM00339 DC    X'90'
@NM00340 DS    FL2
         ORG   ASSO3A+20
ASSOU    DS    CL16
         ORG   ASSOU
@NM00341 DC    CL1'A'
@NM00342 DS    CL1
@NM00343 DC    H'3'
ASSOU1   DS    CL4
         ORG   ASSOU1
@NM00344 DC    CL1'U'
@NM00345 DC    X'E0'
@NM00346 DC    H'1'
         ORG   ASSOU+8
ASSOU2   DS    CL4
         ORG   ASSOU2
@NM00347 DC    CL1'E'
@NM00348 DC    X'E0'
@NM00349 DC    H'4'
         ORG   ASSOU+12
ASSOU3   DS    CL4
         ORG   ASSOU3
@NM00350 DC    CL1'X'
@NM00351 DC    X'E0'
@NM00352 DC    H'3'
         ORG   ASSOU+16
ASSOV    DS    CL12
         ORG   ASSOV
@NM00353 DC    CL1'V'
@NM00354 DS    CL1
@NM00355 DC    H'2'
ASSOV1   DS    CL4
         ORG   ASSOV1
@NM00356 DC    CL1'V'
@NM00357 DC    X'E0'
@NM00358 DC    H'1'
         ORG   ASSOV+8
ASSOV2   DS    CL4
         ORG   ASSOV2
@NM00359 DC    CL1'W'
@NM00360 DC    X'E0'
@NM00361 DC    H'4'
         ORG   ASSOV+12
ASSO1C   DS    CL32
         ORG   ASSO1C
@NM00362 DC    CL1'1'
@NM00363 DS    CL1
@NM00364 DC    H'7'
ASSO1C1  DS    CL4
         ORG   ASSO1C1
@NM00365 DC    CL1'C'
@NM00366 DC    X'C0'
@NM00367 DC    H'1'
         ORG   ASSO1C+8
ASSO1C2  DS    CL4
         ORG   ASSO1C2
@NM00368 DC    CL1'D'
@NM00369 DC    X'C0'
@NM00370 DC    H'2'
         ORG   ASSO1C+12
ASSO1C3  DS    CL4
         ORG   ASSO1C3
@NM00371 DC    CL1'I'
@NM00372 DC    X'C0'
@NM00373 DC    H'3'
         ORG   ASSO1C+16
ASSO1C4  DS    CL4
         ORG   ASSO1C4
@NM00374 DC    CL1'E'
@NM00375 DC    X'C0'
@NM00376 DC    H'4'
         ORG   ASSO1C+20
ASSO1C5  DS    CL4
         ORG   ASSO1C5
@NM00377 DC    CL1'R'
@NM00378 DC    X'00'
@NM00379 DS    FL2
         ORG   ASSO1C+24
ASSO1C6  DS    CL4
         ORG   ASSO1C6
@NM00380 DC    CL1'G'
@NM00381 DC    X'00'
@NM00382 DS    FL2
         ORG   ASSO1C+28
ASSO1C7  DS    CL4
         ORG   ASSO1C7
@NM00383 DC    CL1'Y'
@NM00384 DC    X'00'
@NM00385 DS    FL2
         ORG   ASSO1C+32
ASSO2G   DS    CL28
         ORG   ASSO2G
@NM00386 DC    CL1'2'
@NM00387 DS    CL1
@NM00388 DC    H'6'
ASSO2G1  DS    CL4
         ORG   ASSO2G1
@NM00389 DC    CL1'G'
@NM00390 DC    X'C0'
@NM00391 DC    H'1'
         ORG   ASSO2G+8
ASSO2G2  DS    CL4
         ORG   ASSO2G2
@NM00392 DC    CL1'D'
@NM00393 DC    X'C0'
@NM00394 DC    H'2'
         ORG   ASSO2G+12
ASSO2G3  DS    CL4
         ORG   ASSO2G3
@NM00395 DC    CL1'I'
@NM00396 DC    X'C0'
@NM00397 DC    H'3'
         ORG   ASSO2G+16
ASSO2G4  DS    CL4
         ORG   ASSO2G4
@NM00398 DC    CL1'E'
@NM00399 DC    X'C0'
@NM00400 DC    H'4'
         ORG   ASSO2G+20
ASSO2G5  DS    CL4
         ORG   ASSO2G5
@NM00401 DC    CL1'R'
@NM00402 DC    X'00'
@NM00403 DS    FL2
         ORG   ASSO2G+24
ASSO2G6  DS    CL4
         ORG   ASSO2G6
@NM00404 DC    CL1'C'
@NM00405 DC    X'00'
@NM00406 DS    FL2
         ORG   ASSO2G+28
AIXTBL   DC    CL3'DIC'
PATHCTBL DC    CL3'CDI'
PATHGTBL DC    CL5'GDIDI'
TRTBLE   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
DEFNMTAB DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'PASSWALL'
         DC    CL8'AMDSBCAT'
         DC    CL8'DSATTR'
         DC    CL8'LRECL'
         DC    CL8'SPACPARM'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG5     EQU   @05
REG6     EQU   @06
REG8     EQU   @08
REG13    EQU   @13
REG15    EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG14    EQU   @14
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG7     EQU   @07
REG9     EQU   @09
         ENTRY ASSO3A
CVTPTR   EQU   16
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTIOH   EQU   GDTTBL+36
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
IOCEXT   EQU   IOCSTR+64
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CATNM    EQU   0
CATNMFLG EQU   CATNM+10
CATDN    EQU   0
MRPW     EQU   0
WCAT     EQU   0
WCATFLG  EQU   WCAT+10
CRADN    EQU   0
CRAVL    EQU   0
CRADV    EQU   0
WFILE    EQU   0
IODATA   EQU   0
IODSID   EQU   IODATA+16
IOCSEX   EQU   0
IOCRPL   EQU   IOCSEX+4
IOCXAD   EQU   IOCSEX+16
IOCXPM   EQU   IOCSEX+20
IOCFLG   EQU   IOCSEX+32
IOCDEV   EQU   IOCSEX+33
IOCINF   EQU   IOCSEX+34
IOCMOD   EQU   IOCSEX+35
IOCDLM   EQU   IOCSEX+36
IOCRCV   EQU   IOCSEX+44
CATIEXT  EQU   0
VOLSERTB EQU   0
VOLSRCI  EQU   VOLSERTB+4
VOLSRFLG EQU   VOLSERTB+8
VOLSRSER EQU   VOLSERTB+14
RESVOL   EQU   0
RESVLFLG EQU   RESVOL+8
RESVLBAD EQU   RESVLFLG
RESVLSER EQU   RESVOL+14
RSF1RNTB EQU   0
RSWORK   EQU   0
RSCABHP1 EQU   RSWORK+12
RSCABLP1 EQU   RSWORK+16
RSCAFUCI EQU   RSWORK+28
RSCITDUM EQU   RSWORK+48
RSCPE1   EQU   RSWORK+68
RSCPE2   EQU   RSWORK+72
RSCPE3   EQU   RSWORK+76
RSCPE5   EQU   RSWORK+84
RSCPE6   EQU   RSWORK+88
RSCPE7   EQU   RSWORK+92
RSCRVL   EQU   RSWORK+104
RSGCITS  EQU   RSWORK+108
RSGCITC  EQU   RSGCITS+8
RSGCITLN EQU   RSGCITS+12
RSGCITEN EQU   RSGCITS+18
@NM00045 EQU   RSGCITS+20
RSGCITNU EQU   @NM00045+1
RSGCITUG EQU   RSGCITS+24
RSGDITS  EQU   RSWORK+136
RSGDITC  EQU   RSGDITS+8
RSGDITLN EQU   RSGDITS+12
RSGDITEN EQU   RSGDITS+18
@NM00048 EQU   RSGDITS+20
RSGDITNU EQU   @NM00048+1
RSGDITUG EQU   RSGDITS+24
RSPSTACK EQU   RSWORK+164
RSPTWKF  EQU   RSPSTACK
RSPTWKC  EQU   RSPSTACK+8
RSPTWKLN EQU   RSPSTACK+12
RSPTWKUG EQU   RSPSTACK+24
RSTAB    EQU   RSWORK+192
RSTANCHR EQU   RSTAB
RSTENTAD EQU   RSTAB+4
@NM00053 EQU   RSTAB+8
RSTENTIX EQU   @NM00053+1
@NM00055 EQU   RSTAB+12
RSTWKIX  EQU   @NM00055+1
RSTABAD  EQU   RSTAB+16
RSXXREGS EQU   RSWORK+212
RS01REGS EQU   RSXXREGS
RS02REGS EQU   RSXXREGS+20
RS02RG08 EQU   RS02REGS
RS02RG09 EQU   RS02REGS+4
RS03REGS EQU   RSXXREGS+40
RS04REGS EQU   RSXXREGS+60
RS05REGS EQU   RSXXREGS+80
RS06REGS EQU   RSXXREGS+100
RS07REGS EQU   RSXXREGS+120
RSCRBP1  EQU   RSWORK+372
RSIOTBL  EQU   RSWORK+412
RSRABWA  EQU   RSWORK+416
RSGRABCU EQU   RSWORK+428
RSRMBP   EQU   RSWORK+432
RSWFBP1  EQU   RSWORK+436
RSWFBP2  EQU   RSWORK+440
RSENTPT  EQU   RSWORK+484
RSVTBENT EQU   RSWORK+532
CAXWAPTR EQU   RSWORK+568
CBSPTR   EQU   RSWORK+572
CTGPLPTR EQU   RSWORK+576
CTGFLPTR EQU   RSWORK+580
RSCIXLTA EQU   RSWORK+600
RSUIRPT  EQU   RSWORK+612
RSF1RNCU EQU   RSWORK+656
RSORVLLS EQU   RSWORK+668
RSGOPLEN EQU   RSWORK+682
RSIDX    EQU   RSWORK+686
RSUIOPT  EQU   RSWORK+700
RSNEWCAT EQU   RSWORK+965
RSFLAGSN EQU   RSWORK+979
RSFLAGN1 EQU   RSFLAGSN
RSFLAGN2 EQU   RSFLAGSN+1
RSFLAGSI EQU   RSWORK+981
RSFLAGI1 EQU   RSFLAGSI
RSFLAGI2 EQU   RSFLAGSI+1
RSSRNSCN EQU   RSFLAGI2+1
RSBADVOL EQU   RSFLAGI2+1
RSRECREQ EQU   RSWORK+984
RSRTYPE  EQU   RSRECREQ
RSRGET   EQU   RSRTYPE
RSRUPDT  EQU   RSRTYPE
RSRTERM  EQU   RSRTYPE
RSRFREE  EQU   RSRTYPE
RSROPT   EQU   RSRECREQ+1
RSRDS    EQU   RSROPT
RSRWF    EQU   RSRDS
RSRBY    EQU   RSROPT
RSRKEY   EQU   RSRBY
RSRFOR   EQU   RSROPT
RSRUPD   EQU   RSRFOR
RSRUSE   EQU   RSROPT
RSRDIR   EQU   RSRUSE
RSASSOC  EQU   RSWORK+988
RSASSTBL EQU   RSASSOC
RSASSCIN EQU   RSASSOC+4
RSASSEND EQU   RSASSOC+8
RSASSEXT EQU   RSASSOC+12
RSASSPAS EQU   RSASSOC+14
RSASSFLG EQU   RSASSOC+16
RSASSFL1 EQU   RSASSFLG
RSASSEPA EQU   RSASSFL1
RSASDSDI EQU   RSASSFL1
RSGDG    EQU   RSASSOC+20
RSGDGTB  EQU   RSGDG
RSGDGLN  EQU   RSGDG+8
RSGDGNM  EQU   RSGDG+10
RSPROCVL EQU   RSWORK+1064
RSMAPS   EQU   RSPROCVL
RSSBMAP  EQU   RSMAPS+8
RSPCBMAP EQU   RSMAPS+12
RSMAPAD  EQU   RSPROCVL+20
RSPVSNT  EQU   RSPROCVL+48
RSPVTTNN EQU   RSPROCVL+68
@NM00062 EQU   RSPROCVL+84
RSPVSETB EQU   @NM00062
RSPVFLG1 EQU   @NM00062+1
RSPVFLG2 EQU   @NM00062+2
RSEOVWA  EQU   RSWORK+1152
@NM00065 EQU   RSEOVWA+8
@NM00067 EQU   RSEOVWA+12
RSEOVFLG EQU   @NM00067+1
RSGETVIA EQU   RSWORK+1168
RSVIACRA EQU   RSGETVIA
@NM00072 EQU   RSGETVIA+12
RSVIAFLG EQU   @NM00072
RSVIAFCR EQU   RSVIAFLG
RSVIACIN EQU   @NM00072+1
@NM00074 EQU   RSGETVIA+16
RSREASW  EQU   RSWORK+1188
RSCKERR  EQU   RSWORK+1192
RSCKERN  EQU   RSCKERR
RSCKTERM EQU   RSCKERR+4
RSCKMVAR EQU   RSCKERR+8
RSCKERRW EQU   RSWORK+1240
RSLASTCC EQU   RSCKERRW
RSCKTIME EQU   RSCKERRW+8
RSCKFLAG EQU   RSCKERRW+50
RSCIWA   EQU   RSWORK+1292
RSCIEXPT EQU   RSCIWA
RSINWA   EQU   RSWORK+1340
RSINDVL  EQU   RSINWA+24
RSINATR1 EQU   RSINWA+53
RSINFLGS EQU   RSINWA+54
RSRNWA   EQU   RSWORK+1488
RSRNPLST EQU   RSRNWA
RSRNFLGS EQU   RSRNWA+46
RSRNVL   EQU   RSRNWA+99
RSRNUL   EQU   RSRNWA+106
RSRWORK  EQU   RSWORK+1604
RSRFLGS  EQU   RSRWORK+64
RSWFWA   EQU   RSWORK+1672
RSADWA   EQU   RSWORK+1724
RSADVL   EQU   RSADWA+32
RSADUL   EQU   RSADWA+39
RSCRWA   EQU   RSWORK+1772
RSGENWRK EQU   RSWORK+1780
RSGENDTE EQU   RSGENWRK+12
RSVOLWA  EQU   RSWORK+1796
RSVF1TS  EQU   RSVOLWA+52
RSVF1EXT EQU   RSVOLWA+75
RSVFLAGS EQU   RSVOLWA+140
RSDF00W  EQU   RSWORK+1940
LISTSCAN EQU   RSDF00W+4
IOCSPTR  EQU   RSDF00W+8
OPNPTR   EQU   RSDF00W+12
DDSTRU   EQU   RSDF00W+16
FSADDR   EQU   RSDF00W+20
ERCNVADR EQU   RSDF00W+24
DMPINDEX EQU   RSDF00W+28
TESTRC   EQU   RSDF00W+34
RSCNVTCC EQU   RSWORK+1980
RSCCHHP  EQU   RSCNVTCC+4
RSTTNN   EQU   RSCNVTCC+8
RSCNVTCF EQU   RSCNVTCC+12
RSCNVTF1 EQU   RSCNVTCF
RSWFNDWA EQU   RSWORK+1996
RSWAFINF EQU   RSWFNDWA
RSWASNVT EQU   RSWFNDWA+4
RSWSNFLG EQU   RSWFNDWA+8
RSWFONE  EQU   RSWSNFLG
RSWFIRST EQU   RSWSNFLG
RSWGCODE EQU   RSWFNDWA+9
RSWSEQNR EQU   RSWFNDWA+10
RSGENMWA EQU   RSWORK+2052
RSGENAM  EQU   RSGENMWA+9
RSGDATE  EQU   RSGENAM+21
RSGTIME  EQU   RSGENAM+26
RSCDSDWA EQU   RSWORK+2108
RSCDSDIN EQU   RSCDSDWA
RSCDSNT8 EQU   RSCDSDIN
RSCDSNT3 EQU   RSCDSDIN+4
RSCDVOLR EQU   RSCDSDIN+8
RSCDDIR  EQU   RSCDSDIN+12
RSCDSDW  EQU   RSCDSDWA+16
RSMARKUN EQU   RSWORK+2144
RSCSWA   EQU   RSWORK+2152
GRAB     EQU   0
GRABFLGS EQU   GRAB
GRABAFLS EQU   GRABFLGS+1
GRABAFL1 EQU   GRABAFLS
GRABAFL2 EQU   GRABAFLS+1
GRABBB   EQU   GRAB+4
GRABCURR EQU   GRAB+12
GRABRABS EQU   GRAB+16
GRABRAB1 EQU   GRABRABS
GRABRAB5 EQU   GRABRABS+16
RSRAB    EQU   0
RABFLGS  EQU   RSRAB
RABFLG1  EQU   RABFLGS
RABNRF   EQU   RABFLG1
RABRCDA  EQU   RSRAB+4
RABBUF   EQU   RSRAB+8
RABPROC  EQU   RSRAB+520
RMB      EQU   0
RMBCTL   EQU   RMB
RMBFLAGS EQU   RMBCTL+8
RSXCIXLT EQU   0
RSXCIENT EQU   RSXCIXLT+8
RSXCIBEG EQU   RSXCIENT
RSXCILN  EQU   RSXCIENT+4
RSXCIFLG EQU   RSXCIENT+8
RSXCIFL1 EQU   RSXCIFLG
RSXCIRNG EQU   RSXCIFL1
UIODSN   EQU   0
UIOVOL   EQU   0
RECIOWA  EQU   0
GRABSWF  EQU   RECIOWA
ALLUL    EQU   RECIOWA+784
ALLVL    EQU   RECIOWA+796
RSCAMINN EQU   RECIOWA+816
UCATWA   EQU   RECIOWA+874
WFBUF1   EQU   0
WFBUF2   EQU   0
RSCNCCHH EQU   0
TASSENT  EQU   0
TASSTYPE EQU   TASSENT
TASSFL1  EQU   TASSENT+1
TASSREAD EQU   TASSFL1
TASSSCAN EQU   TASSFL1
TASSVER  EQU   TASSFL1
TASSIS   EQU   TASSFL1
TASSSET  EQU   TASSFL1
TASSRAB  EQU   TASSENT+2
TASSO    EQU   0
TASSID   EQU   TASSO
TASSNENT EQU   TASSO+2
TASSEN   EQU   TASSO+4
TABANCHR EQU   0
TABC     EQU   TABANCHR+8
@NM00102 EQU   TABANCHR+20
TABHEAD  EQU   0
THEAD    EQU   TABHEAD
TABBACKW EQU   THEAD
TABCURR  EQU   THEAD+10
PTWORK   EQU   0
PTYPEDTA EQU   PTWORK+12
PTGCIT   EQU   PTYPEDTA
@NM00104 EQU   PTGCIT
PTCITI   EQU   @NM00104+1
@NM00106 EQU   PTGCIT+4
PTCITL   EQU   @NM00106+1
@NM00108 EQU   PTGCIT+8
PTCITNC  EQU   @NM00108+1
PTCITCUR EQU   PTGCIT+12
PTCITF   EQU   PTGCIT+16
PTCITWK  EQU   PTGCIT+20
PTGDIT   EQU   PTYPEDTA+24
@NM00110 EQU   PTGDIT
PTDITI   EQU   @NM00110+1
@NM00112 EQU   PTGDIT+4
PTDITL   EQU   @NM00112+1
@NM00114 EQU   PTGDIT+8
PTDITNC  EQU   @NM00114+1
PTDITCUR EQU   PTGDIT+12
PTDITF   EQU   PTGDIT+16
PTASSO   EQU   PTYPEDTA+48
PTASSOC  EQU   PTASSO
PTASSCUR EQU   PTASSO+4
PTASSOEA EQU   PTASSO+8
PTASSOE1 EQU   PTASSO+12
PTASSOE  EQU   PTASSOE1
PTASSDIT EQU   PTASSOE
PTASSCIT EQU   PTASSOE+4
PTASSEXP EQU   PTASSO+52
PTINDX   EQU   PTYPEDTA+104
PTINDX1  EQU   PTINDX
PTINDX3  EQU   PTINDX+4
PTINDXV  EQU   PTINDX+6
PTINDX4  EQU   PTINDX+8
PTBASE   EQU   PTYPEDTA+116
PTVERDI  EQU   PTYPEDTA+120
PTVALL   EQU   PTVERDI
PTVDI    EQU   PTVALL
PTVDICIT EQU   PTVDI
PTVDISNT EQU   PTVDI+4
PTVDIASS EQU   PTVDI+8
PTVCNT   EQU   PTVERDI+24
PTVDSSNT EQU   PTVERDI+28
PTXALIAS EQU   PTYPEDTA+152
PTXUX1D  EQU   PTXALIAS
PTXX0X1D EQU   PTXALIAS+4
PTXX1AUD EQU   PTXALIAS+8
PTXX1X2D EQU   PTXALIAS+12
PTXX1X0D EQU   PTXALIAS+16
PTXCITX1 EQU   PTXALIAS+20
PTXX0C   EQU   PTXALIAS+24
PTXX1C   EQU   PTXALIAS+26
PTXX2C   EQU   PTXALIAS+28
PTXFLAGS EQU   PTXALIAS+30
PTXFLAG1 EQU   PTXFLAGS
PTXEND   EQU   PTXFLAG1
PTCRAVL  EQU   PTYPEDTA+184
PTFLAGS  EQU   PTYPEDTA+190
PTF1     EQU   PTFLAGS
PTF1HIT  EQU   PTF1
PTF1HIT2 EQU   PTF1
PTF1OK   EQU   PTF1
PTF1DELT EQU   PTF1
PTF1CKVL EQU   PTF1
PTF1ENDG EQU   PTF1
PTF1ENDA EQU   PTF1
PTF2     EQU   PTFLAGS+1
PTF2KSDS EQU   PTF2
PTLOC    EQU   PTWORK+204
@NM00120 EQU   PTLOC
PTLBCITX EQU   @NM00120+1
PTLCCIT  EQU   PTLOC+4
PTLCDIT  EQU   PTLOC+8
@NM00122 EQU   PTLOC+12
PTLNDIT  EQU   @NM00122+1
PTLSN    EQU   PTLOC+16
PTLDITFB EQU   PTLOC+18
PTLFBAS1 EQU   PTLDITFB
PTLFBAS2 EQU   PTLDITFB
PTLFBDGO EQU   PTLDITFB
PTLDITID EQU   PTLOC+19
PTASOE   EQU   0
PTASDIT1 EQU   PTASOE
PTASSEX  EQU   0
GCITS    EQU   0
CITABE   EQU   0
CITFLA   EQU   CITABE
CITFAVER EQU   CITFLA
CITFARAS EQU   CITFLA
CITFAHEP EQU   CITFLA
CITFAGOE EQU   CITFLA
CITFASCA EQU   CITFLA
CITFAINV EQU   CITFLA
CITFADGO EQU   CITFLA
CITCIN   EQU   CITABE+1
@NM00127 EQU   CITABE+4
CITTYPE  EQU   @NM00127
CITRCIN  EQU   @NM00127+1
@NM00128 EQU   CITABE+8
CITDICNT EQU   @NM00128
CITDITAB EQU   @NM00128+1
@NM00129 EQU   CITABE+12
CITEXTCH EQU   @NM00129+1
@NM00131 EQU   CITABE+16
CITEXTBA EQU   @NM00131+1
GDITS    EQU   0
DITABE   EQU   0
DITFA    EQU   DITABE
DITFAVER EQU   DITFA
DITFARAS EQU   DITFA
DITFADEL EQU   DITFA
DITFLB   EQU   DITABE+1
DITFBHEP EQU   DITFLB
DITFBGOE EQU   DITFLB
DITFBAS1 EQU   DITFLB
DITFBAS2 EQU   DITFLB
DITFBDGO EQU   DITFLB
DITFB256 EQU   DITFLB
DITOFS   EQU   DITABE+2
@NM00140 EQU   DITABE+4
DITSN    EQU   @NM00140
DITVSN   EQU   DITSN
DITOSN   EQU   DITVSN+1
@NM00143 EQU   DITABE+8
DITCITAB EQU   @NM00143+1
DITDGML  EQU   DITABE+12
GDGLDS   EQU   0
GDGLHEAD EQU   GDGLDS
GDGFLG   EQU   GDGLHEAD+30
GDGLENTS EQU   GDGLDS+32
GDGENT   EQU   GDGLENTS
RSFSNVT  EQU   0
RSFLAGS  EQU   RSFSNVT+1
RSFENTLN EQU   RSFSNVT+3
RSFHNDX  EQU   RSFSNVT+4
RSFCNDX  EQU   RSFSNVT+6
RSFAENT  EQU   RSFSNVT+8
RSFATTNN EQU   RSFSNVT+16
RSFCADR  EQU   RSFSNVT+24
SNTAB    EQU   0
SNFIXED  EQU   SNTAB
SNFLAG   EQU   SNFIXED
SNFDEL   EQU   SNFLAG
SNFPROC  EQU   SNFLAG
SNSN     EQU   SNFIXED+1
SNENTRY  EQU   SNTAB+24
SNVDATA  EQU   SNENTRY
SSPHDFLG EQU   SNVDATA+8
SSPEXTNT EQU   SNVDATA+10
SNASSOC  EQU   0
SNTYPE   EQU   SNASSOC+24
SNNAME   EQU   SNASSOC+25
SNGLEV   EQU   SNASSOC+28
SNVGO    EQU   0
SNVOLSER EQU   SNVGO+28
SITYPEXT EQU   SNVGO+34
SNSSWD   EQU   SITYPEXT
SDSDIRSN EQU   SNVGO+35
SNEXTENT EQU   SNVGO+43
SNVSBM   EQU   0
SNDSDIR  EQU   0
SDSIDFLG EQU   SNDSDIR+24
SNTTNN   EQU   0
CATGOPT  EQU   0
CATGOCI  EQU   CATGOPT
CATGOFLG EQU   CATGOCI
CATGODSP EQU   CATGOCI+1
CATGOGC1 EQU   CATGOPT+3
CATGOEXT EQU   CATGOGC1
CATGODEL EQU   CATGOGC1
CATGOSEQ EQU   CATGOPT+4
CATSN    EQU   0
CATRCD   EQU   0
RCDCINO  EQU   CATRCD+1
RCDCRAVL EQU   CATRCD+5
RCDID    EQU   CATRCD+44
REPCNTRL EQU   0
EXTRCDPT EQU   REPCNTRL
EXTGOCI  EQU   EXTRCDPT
REPCNT   EQU   REPCNTRL+5
REPGOPT  EQU   REPCNTRL+6
VARFIELD EQU   0
VARLEN   EQU   VARFIELD
CNTRLINF EQU   0
LENFIX   EQU   CNTRLINF+1
CTGRBASE EQU   0
CNAME    EQU   CTGRBASE+49
CATTR    EQU   CTGRBASE+107
CATTR1   EQU   CATTR
CATTR2   EQU   CATTR+1
COPEN    EQU   CTGRBASE+109
CSPACPRM EQU   CTGRBASE+114
CCR      EQU   0
ASGO     EQU   0
ASG1     EQU   ASGO+2
ASTYPE   EQU   ASG1
ASCI     EQU   ASG1+1
ASG2     EQU   ASGO+6
ASTYPE2  EQU   ASG2
ASCI2    EQU   ASG2+1
ASGOGDG  EQU   0
ASGDGLVL EQU   ASGOGDG+6
DSDIR    EQU   0
SPACEPRM EQU   0
SPCOPTNS EQU   SPACEPRM+6
RGATTRFL EQU   0
RGATTR1  EQU   RGATTRFL
RGATTSG1 EQU   RGATTRFL+1
VOLGO    EQU   0
GDGRCD   EQU   0
GENLVLS  EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGGTNXT EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGDSORG EQU   CTGPL+16
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGFL    EQU   0
CTGFLDRE EQU   CTGFL+3
CTGFLDAT EQU   CTGFL+16
CTGFV    EQU   0
CTGFVPRO EQU   CTGFV+1
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVLMT EQU   CTGFV+72
CTGFVGAT EQU   CTGFV+76
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
AMCBS    EQU   0
CBSCMP   EQU   AMCBS+16
CBSVSRT  EQU   AMCBS+32
IGGCAXWA EQU   0
CAXFLGS  EQU   IGGCAXWA+8
CAXFLG2  EQU   IGGCAXWA+9
CAXFLG3  EQU   IGGCAXWA+10
CAXCCR   EQU   IGGCAXWA+32
CAXCNAM  EQU   IGGCAXWA+52
CAXOPLST EQU   IGGCAXWA+96
COPTS    EQU   CAXOPLST
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBDVIND EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBVVIC  EQU   ACBINFLG
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
ALLP     EQU   0
ALLPPTR  EQU   0
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
BMAP     EQU   0
CABUFH1  EQU   0
CABUFL1  EQU   0
CAT      EQU   0
CFILE    EQU   0
CFILECNT EQU   0
CIN      EQU   0
CRADNPTR EQU   0
CRADVPTR EQU   0
CRAVLPTR EQU   0
CRBUF1   EQU   0
CVOL     EQU   0
CVOLCNT  EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IGN      EQU   0
LASTCC   EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NIGN     EQU   0
NONE     EQU   0
NONEPTR  EQU   0
RABS     EQU   0
WFDN     EQU   0
RSWFLD   EQU   RABPROC
RSWFKG1  EQU   RSWFLD+8
RSWFCRA  EQU   RSWFKG1
RSWDLCAT EQU   RSWFKG1
RSWUPCAT EQU   RSWFKG1
RSWRASCI EQU   RSWFKG1
RSWASSCK EQU   RSWFKG1
RSWFLG2  EQU   RSWFLD+9
RSWINVCI EQU   RSWFLG2
RSWDSDIR EQU   RSWFLG2
RABARRAY EQU   GRABRABS
@NM00165 EQU   CATTR1
CCATTR   EQU   @NM00165
@NM00166 EQU   CCATTR
@NM00168 EQU   CATTR1
CRGATTR  EQU   @NM00168
CUPG     EQU   CRGATTR
DEVCHARS EQU   RABBUF+101
@NM00177 EQU   DEVCHARS
RTDEVUCB EQU   @NM00177
RTBOKAB  EQU   @NM00177+14
RTDVFLGS EQU   @NM00177+17
@NM00191 EQU   CTGDDNM
CTGPROB  EQU   @NM00191
CTGREASN EQU   CTGPROB+2
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
BMAPARRY EQU   RSMAPS
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
RTTOLFCT EQU   @NM00177+18
RTTOLFLG EQU   RTDVFLGS
@NM00180 EQU   RTDVFLGS
RTKABFLG EQU   RTDVFLGS
@NM00179 EQU   RTDVFLGS
RTBONK   EQU   @NM00177+16
RTBOKLB  EQU   RTBOKAB+1
RTBOKNLB EQU   RTBOKAB
RTTRKSIZ EQU   @NM00177+12
RTNOTRKS EQU   @NM00177+10
RTNOCYLS EQU   @NM00177+8
RTMXDBLK EQU   @NM00177+4
RTCLSTYP EQU   RTDEVUCB+2
@NM00178 EQU   RTDEVUCB
@NM00169 EQU   CRGATTR
CUPD     EQU   CUPG
CPGSP    EQU   @NM00166
@NM00167 EQU   @NM00166
@NM00094 EQU   RSWFLG2
RSWCHRA  EQU   RSWFLG2
RSWCHNRR EQU   RSWFLG2
RSWUPCCH EQU   RSWFLG2
RSWDICHK EQU   RSWFLG2
RSWDUPRR EQU   RSWFLG2
RSWDUPCI EQU   RSWFKG1
@NM00093 EQU   RSWFKG1
RSWUPCRA EQU   RSWFKG1
RSWDUPTR EQU   RSWFLD+4
RSWCHPTR EQU   RSWFLD
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00215 EQU   IDAAMDSB+41
@NM00214 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDCINV  EQU   IDAAMDSB+20
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDKEYLN EQU   IDAAMDSB+8
AMDRKP   EQU   IDAAMDSB+6
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00213 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
@NM00212 EQU   ACBINFLG+1
ACBBYPSS EQU   ACBINFLG
ACBSDS   EQU   ACBVVIC
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00211 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00210 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00209 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00208 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00207 EQU   ACBDSORG
ACBOPTJ  EQU   ACBDVIND
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00206 EQU   ACBCCTYP
ACBTRCID EQU   ACBCCTYP
@NM00205 EQU   ACBRECFM
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00204 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00203 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00202 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
CAXCRACB EQU   IGGCAXWA+112
CAXJDE   EQU   IGGCAXWA+108
CAXCCA   EQU   IGGCAXWA+104
CAXOPEWA EQU   IGGCAXWA+100
COPACB   EQU   CAXOPLST+1
@NM00201 EQU   COPTS
CENLST   EQU   COPTS
@NM00200 EQU   CAXCNAM+22
CAXRADDN EQU   CAXCNAM+14
CAXRATEP EQU   CAXCNAM+10
CAXRACTS EQU   CAXCNAM+6
CAXVOLID EQU   CAXCNAM
CAXRPL   EQU   IGGCAXWA+48
CAXRPLCT EQU   IGGCAXWA+46
CAXASID  EQU   IGGCAXWA+44
CAXFDCI  EQU   CAXCCR+9
CAXCDCI  EQU   CAXCCR+6
CAXNFCI  EQU   CAXCCR+3
CAXHACI  EQU   CAXCCR
CAXUCB   EQU   IGGCAXWA+28
CAXACB   EQU   IGGCAXWA+24
CAXDRWP  EQU   IGGCAXWA+20
CAXSCHWA EQU   IGGCAXWA+16
CAXATIOT EQU   IGGCAXWA+12
CAXACT   EQU   IGGCAXWA+11
@NM00199 EQU   CAXFLG3
CAXF3B6  EQU   CAXFLG3
CAXF3B5  EQU   CAXFLG3
@NM00198 EQU   CAXFLG3
CAXF3ANE EQU   CAXFLG3
CAXF3AT  EQU   CAXFLG3
CAXF2VTU EQU   CAXFLG2
CAXF2REC EQU   CAXFLG2
CAXF2CA  EQU   CAXFLG2
CAXF2CLR EQU   CAXFLG2
CAXF2IOE EQU   CAXFLG2
CAXF2NCR EQU   CAXFLG2
CAXF2NDD EQU   CAXFLG2
CAXF2DT  EQU   CAXFLG2
CAXSCR   EQU   CAXFLGS
CAXCMR   EQU   CAXFLGS
CAXMCT   EQU   CAXFLGS
CAXCMP   EQU   CAXFLGS
CAXEOV   EQU   CAXFLGS
CAXCLS   EQU   CAXFLGS
CAXOPN   EQU   CAXFLGS
CAXBLD   EQU   CAXFLGS
CAXCHN   EQU   IGGCAXWA+4
@NM00197 EQU   IGGCAXWA+1
CAXID    EQU   IGGCAXWA
CBSVPTR  EQU   CBSVSRT+4
CBSVUSE  EQU   CBSVSRT
CBSCRTCB EQU   AMCBS+28
CBSCRACA EQU   AMCBS+24
CBSCAXCN EQU   AMCBS+20
CBSMCUCB EQU   CBSCMP
CBSCBP   EQU   AMCBS+12
CBSACB   EQU   AMCBS+8
CBSMCSTA EQU   AMCBS+4
CBSSIZ   EQU   AMCBS+2
CBSID    EQU   AMCBS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00196 EQU   CVTFIX+248
@NM00195 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
CTGFVWKA EQU   CTGFV+88
CTGFVPWD EQU   CTGFV+84
CTGFVNAM EQU   CTGFV+80
CTGFVUPG EQU   CTGFVGAT
CTGFVEXT EQU   CTGFVLMT
CTGFVLRS EQU   CTGFV+68
CTGFVBUF EQU   CTGFV+64
CTGFVATR EQU   CTGFV+60
CTGFVFSN EQU   CTGFVAMD
CTGFVTTR EQU   CTGFVSPC
CTGFVDVT EQU   CTGFV+48
CTGFVRNG EQU   CTGFV+44
CTGFVVLT EQU   CTGFV+40
CTGFVCRE EQU   CTGFV+36
CTGFVEXP EQU   CTGFV+32
CTGFVOWN EQU   CTGFV+28
CTGFVSTY EQU   CTGFV+24
CTGFVENT EQU   CTGFV+20
CTGFVIND EQU   CTGFV+16
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
CTGFVDCH EQU   CTGFV+4
@NM00194 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00193 EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
CTGFVTYP EQU   CTGFV
CTGFLPT  EQU   CTGFLDAT+4
CTGFLNG  EQU   CTGFLDAT
CTGFLCHN EQU   CTGFL+12
CTGFLDNM EQU   CTGFL+8
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00192 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
CTGFLDNO EQU   CTGFL
CTGFIELD EQU   CTGPL+28
CTGPSWD  EQU   CTGJSCB
@NM00190 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGNOFLD EQU   CTGPL+19
CTGTYPE  EQU   CTGPL+18
@NM00189 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGWKA   EQU   CTGPL+12
CTGCVOL  EQU   CTGCAT
@NM00188 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00187 EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGAM0   EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
CTGFUNC  EQU   CTGOPTN3
@NM00186 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGUCRAX EQU   CTGGTNXT
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
GDGLVL   EQU   GENLVLS+2
@NM00185 EQU   GENLVLS
@NM00184 EQU   GDGRCD+108
GDGLIMIT EQU   GDGRCD+107
@NM00183 EQU   GDGRCD
@NM00182 EQU   VOLGO+34
NOBLKTRK EQU   VOLGO+32
@NM00181 EQU   VOLGO
@NM00176 EQU   RGATTSG1
RGATSUP1 EQU   RGATTSG1
@NM00175 EQU   RGATTR1
RGATTUPG EQU   RGATTR1
SPCROUND EQU   SPCOPTNS
SPCALXRQ EQU   SPCOPTNS
SPCMXIGR EQU   SPCOPTNS
SPCCNTIG EQU   SPCOPTNS
@NM00174 EQU   SPCOPTNS
SPCRQTYP EQU   SPCOPTNS
SPCSECDQ EQU   SPACEPRM+3
SPCPRIMQ EQU   SPACEPRM
DSSUMTT  EQU   DSDIR+9
DSCRETS  EQU   DSDIR+5
DSIDNO   EQU   DSDIR+2
@NM00173 EQU   DSDIR
@NM00172 EQU   ASGOGDG+2
@NM00171 EQU   ASGOGDG
@NM00170 EQU   ASGO
CCRRBAS  EQU   CCR+57
CCRFDCI  EQU   CCR+54
CCRCDCI  EQU   CCR+51
CCRNFCI  EQU   CCR+48
CCRHACI  EQU   CCR+45
CCRID    EQU   CCR+44
CCRKEY   EQU   CCR
CEXT     EQU   CTGRBASE+135
CDOSUINF EQU   CTGRBASE+133
CLRECL   EQU   CTGRBASE+129
CHIA     EQU   CTGRBASE+125
CHIU     EQU   CTGRBASE+121
CSORT    EQU   CSPACPRM+6
CSEC     EQU   CSPACPRM+3
CPRIM    EQU   CSPACPRM
CBUF     EQU   CTGRBASE+110
@NM00164 EQU   COPEN
COPENDS  EQU   COPEN
CNUS     EQU   CATTR2
@NM00163 EQU   CATTR2
CATTRSSH EQU   CATTR2
CATTRISH EQU   CATTR2
CTRKOV   EQU   CATTR1
CTEMP    EQU   CATTR1
CINHIB   EQU   CATTR1
CRECOV   EQU   CATTR1
CERASE   EQU   CATTR1
CREUSE   EQU   CATTR1
CUNIQ    EQU   CATTR1
CSP      EQU   CATTR1
CEXP     EQU   CTGRBASE+104
CCRE     EQU   CTGRBASE+101
COWNID   EQU   CTGRBASE+93
@NM00162 EQU   CTGRBASE
CNTVAR   EQU   CNTRLINF
VARINFO  EQU   VARFIELD+2
@NM00161 EQU   EXTRCDPT+3
NREPLF   EQU   CATRCD+48
NREPCV   EQU   CATRCD+47
RCDSIZ   EQU   CATRCD+45
@NM00160 EQU   CATRCD+26
RCDDICTS EQU   CATRCD+22
RCDRACTS EQU   CATRCD+18
RCDCRADT EQU   CATRCD+14
RCDCRACI EQU   CATRCD+11
RCDRELID EQU   CATRCD+4
RCDKEYTY EQU   CATRCD
CATGOGC  EQU   CATGOGC1
@NM00159 EQU   CATGOFLG
SNNN     EQU   SNTTNN+2
SNTT     EQU   SNTTNN
SDSSUMTT EQU   SNDSDIR+32
SDSCRETS EQU   SNDSDIR+28
SDSIDNO  EQU   SNDSDIR+25
@NM00158 EQU   SDSIDFLG
SDSEXT   EQU   SDSIDFLG
@NM00157 EQU   SNDSDIR
SNLBM    EQU   SNVSBM+28
SNABM    EQU   SNVSBM+24
@NM00156 EQU   SNVSBM
@NM00155 EQU   SNEXTENT+16
@NM00154 EQU   SNEXTENT+12
NTR      EQU   SNEXTENT+10
@NM00153 EQU   SNEXTENT+8
@NM00152 EQU   SNEXTENT+6
SHH      EQU   SNEXTENT+4
SCC      EQU   SNEXTENT+2
SS       EQU   SNEXTENT
SNEXTI   EQU   SNVGO+42
SNTTNNMC EQU   SNVGO+41
SNTTNNC  EQU   SNVGO+40
SNTTNNX  EQU   SNVGO+39
SNVGOSS  EQU   SNVGO+37
SNDEVTYP EQU   SNVGO+24
@NM00151 EQU   SNVGO
SNNAME2  EQU   SNGLEV+1
SNTYPE2  EQU   SNGLEV
@NM00150 EQU   SNASSOC
SSPEXTNN EQU   SSPEXTNT
SNODSPXT EQU   SNVDATA+9
SNVSPCAT EQU   SSPHDFLG
@NM00149 EQU   SSPHDFLG
SNVSPUNQ EQU   SSPHDFLG
SDSCBTS  EQU   SNVDATA
SNVGOEL  EQU   SNFIXED+20
SNEGOP   EQU   SNFIXED+16
SNECI    EQU   SNFIXED+13
SNAGOP   EQU   SNFIXED+11
SNACI    EQU   SNFIXED+8
SNGOP    EQU   SNFIXED+6
SNCI     EQU   SNFIXED+3
@NM00148 EQU   SNFLAG
SNFINC   EQU   SNFLAG
SNFMOD   EQU   SNFLAG
SNFALT   EQU   SNFLAG
SNFUSE   EQU   SNFLAG
RSFCILST EQU   RSFSNVT+28
RSFABMAP EQU   RSFSNVT+20
RSFLENBM EQU   RSFSNVT+14
RSFCNTTN EQU   RSFSNVT+12
RSFGCODE EQU   RSFSNVT+2
@NM00147 EQU   RSFLAGS
RSFINVTY EQU   RSFLAGS
RSFNRF   EQU   RSFLAGS
@NM00146 EQU   RSFSNVT
GDGLVLT  EQU   GDGENT
@NM00145 EQU   GDGFLG
GDGWRAP  EQU   GDGFLG
GDGPAK   EQU   GDGLHEAD+22
GDGMVL   EQU   GDGLHEAD+20
GDGFRE   EQU   GDGLHEAD+18
GDGFRS   EQU   GDGLHEAD+16
GDGTOE   EQU   GDGLHEAD+14
GDGTOS   EQU   GDGLHEAD+12
GDGPLEV  EQU   GDGLHEAD+10
GDGVALB  EQU   GDGLHEAD+8
GDGCNT   EQU   GDGLHEAD+6
GDGLMT   EQU   GDGLHEAD+4
GDGVAL   EQU   GDGLHEAD
@NM00144 EQU   @NM00143
@NM00142 EQU   @NM00140+2
@NM00141 EQU   DITVSN
@NM00139 EQU   DITFLB
@NM00138 EQU   DITFLB
@NM00137 EQU   DITFA
@NM00136 EQU   DITFA
@NM00135 EQU   DITFA
@NM00134 EQU   DITFA
@NM00133 EQU   DITFA
GDIENTRY EQU   GDITS+12
GDITHEAD EQU   GDITS
@NM00132 EQU   @NM00131
@NM00130 EQU   @NM00129
@NM00126 EQU   CITFLA
CITABENT EQU   GCITS+12
GCITHEAD EQU   GCITS
PTASCIT1 EQU   PTASOE+4
@NM00125 EQU   PTLDITFB
@NM00124 EQU   PTLDITFB
PTLFBGOE EQU   PTLDITFB
PTLFBHEP EQU   PTLDITFB
@NM00123 EQU   @NM00122
@NM00121 EQU   @NM00120
@NM00119 EQU   PTF2
PTF1END  EQU   PTF1
@NM00118 EQU   PTXFLAGS+1
@NM00117 EQU   PTXFLAG1
PTXEXIST EQU   PTXFLAG1
@NM00116 EQU   PTVERDI+26
PTINDX5  EQU   PTINDX+10
PTINDX2  EQU   PTINDX+2
PTDITWK  EQU   PTGDIT+20
@NM00115 EQU   @NM00114
@NM00113 EQU   @NM00112
@NM00111 EQU   @NM00110
@NM00109 EQU   @NM00108
@NM00107 EQU   @NM00106
@NM00105 EQU   @NM00104
PTHEAD   EQU   PTWORK
TENTRY   EQU   TABHEAD+12
TABMAXT  EQU   THEAD+8
TABFORW  EQU   THEAD+4
TABUG    EQU   TABANCHR+24
TABNU    EQU   @NM00102+1
@NM00103 EQU   @NM00102
TABEN    EQU   TABANCHR+18
@NM00101 EQU   TABANCHR+16
TABSIZ   EQU   TABANCHR+12
TABL     EQU   TABANCHR+4
TABF     EQU   TABANCHR
@NM00100 EQU   TASSO+1
@NM00099 EQU   TASSFL1
RSCNHH2  EQU   RSCNCCHH+6
RSCNCC2  EQU   RSCNCCHH+4
RSCNHH1  EQU   RSCNCCHH+2
RSCNCC1  EQU   RSCNCCHH
RECPTRCD EQU   RECIOWA+978
UCATWRET EQU   UCATWA+4
UCATWRLN EQU   UCATWA+2
UCATWTLN EQU   UCATWA
RSSCRLST EQU   RECIOWA+872
UCBAREA  EQU   RECIOWA+861
RSCAMIND EQU   RSCAMINN+1
RSCAMINL EQU   RSCAMINN
RSCAMAJN EQU   RECIOWA+808
ALLVLSR  EQU   ALLVL+4
ALLVLLN  EQU   ALLVL+2
ALLVLC   EQU   ALLVL
ALLULNM  EQU   ALLUL+4
ALLULLN  EQU   ALLUL+2
ALLULC   EQU   ALLUL
RSVOLENT EQU   RECIOWA+692
RSVUENT  EQU   RECIOWA+664
RSALLAGL EQU   RECIOWA+632
RSOPNAGL EQU   RECIOWA+248
CATHRMB  EQU   RECIOWA+192
CATLRMB  EQU   RECIOWA+180
CRARMB   EQU   RECIOWA+168
WFSRMB   EQU   RECIOWA+156
WFDRMB   EQU   RECIOWA+120
GRABSCR  EQU   RECIOWA+80
GRABSCA  EQU   RECIOWA+40
UIOVLS   EQU   UIOVOL+4
UIOVLN   EQU   UIOVOL+2
UIOVID   EQU   UIOVOL
UIODNM   EQU   UIODSN+4
UIODLN   EQU   UIODSN+2
UIODID   EQU   UIODSN
RSXCIREL EQU   RSXCIENT+12
@NM00098 EQU   RSXCIFL1
@NM00097 EQU   RSXCIXLT+4
RSXCIID  EQU   RSXCIXLT
RMBKEYA  EQU   RMB+12
@NM00096 EQU   RMBFLAGS
RMBGETU  EQU   RMBFLAGS
RMBKEQ   EQU   RMBFLAGS
RMBKEY   EQU   RMBFLAGS
RMBUPD   EQU   RMBFLAGS
RMBDIR   EQU   RMBFLAGS
RMBSEQ   EQU   RMBFLAGS
RMBARG   EQU   RMBCTL+4
RMBRPL   EQU   RMBCTL
@NM00095 EQU   RSRAB+530
RABFLG4  EQU   RABFLGS+3
RABFLG3  EQU   RABFLGS+2
RABFLG2  EQU   RABFLGS+1
RABDUP   EQU   RABFLG1
RABIOIGN EQU   RABFLG1
RABKEY   EQU   RABFLG1
RABRRN   EQU   RABFLG1
RABADD   EQU   RABFLG1
RABUPD   EQU   RABFLG1
RABINUSE EQU   RABFLG1
GRABRAB6 EQU   GRABRABS+20
GRABRAB4 EQU   GRABRABS+12
GRABRAB3 EQU   GRABRABS+8
GRABRAB2 EQU   GRABRABS+4
GRABRABE EQU   GRAB+8
GRABSN   EQU   GRAB+3
GRABSNRF EQU   GRABAFL2
GRABSDUP EQU   GRABAFL1
GRABSNRN EQU   GRABAFL1
GRABSIOT EQU   GRABAFL1
GRABSIOF EQU   GRABAFL1
GRABSIOI EQU   GRABAFL1
GRABSEFN EQU   GRABAFL1
GRABSNRA EQU   GRABAFL1
GRABSFXT EQU   GRABAFL1
GRABFLG1 EQU   GRABFLGS
@NM00092 EQU   RSCSWA+6
RSCSFCN  EQU   RSCSWA+4
RSCSFAE  EQU   RSCSWA
@NM00091 EQU   RSMARKUN+6
RSMA3FCN EQU   RSMARKUN+4
RSMA3FAE EQU   RSMARKUN
@NM00090 EQU   RSCDSDW+18
RSCDINDX EQU   RSCDSDW+16
RSCDSUMT EQU   RSCDSDW+12
RSCD8FCN EQU   RSCDSDW+10
RSCD3FCN EQU   RSCDSDW+8
RSCD8FAE EQU   RSCDSDW+4
RSCD3FAE EQU   RSCDSDW
RSGTMEB  EQU   RSGTIME+11
RSGDELM2 EQU   RSGTIME+9
@NM00089 EQU   RSGTIME+2
RSGDELM1 EQU   RSGTIME
RSGDAY   EQU   RSGDATE+2
RSGYEAR  EQU   RSGDATE
RSGFIXID EQU   RSGENAM+8
RSGTMEA  EQU   RSGENAM+1
RSGDELM  EQU   RSGENAM
RSGUNPK  EQU   RSGENMWA
RSFCPE7  EQU   RSWFNDWA+52
RSFCPE6  EQU   RSWFNDWA+48
RSFCPE5  EQU   RSWFNDWA+44
RSFCPE4  EQU   RSWFNDWA+40
RSFCPE3  EQU   RSWFNDWA+36
RSFCPE2  EQU   RSWFNDWA+32
RSFCPE1  EQU   RSWFNDWA+28
@NM00088 EQU   RSWFNDWA+26
RSWFBMLN EQU   RSWFNDWA+24
RSWFBMAP EQU   RSWFNDWA+20
RSWFBUF  EQU   RSWFNDWA+16
RSWFCIN  EQU   RSWFNDWA+13
RSWFRCSN EQU   RSWFNDWA+12
@NM00087 EQU   RSWSNFLG
@NM00086 EQU   RSCNVTCF+1
@NM00085 EQU   RSCNVTF1
RSCFINN  EQU   RSCNVTF1
RSNN     EQU   RSTTNN+2
RSTT     EQU   RSTTNN
RSCIOCS  EQU   RSCNVTCC
LISTLN   EQU   RSDF00W+36
SETRC    EQU   RSDF00W+32
LISTPTR  EQU   RSDF00W
RSVF4TT  EQU   RSVOLWA+142
@NM00084 EQU   RSVOLWA+141
@NM00083 EQU   RSVFLAGS
RSVWFUPD EQU   RSVFLAGS
RSVREPOS EQU   RSVFLAGS
RSVGTEOF EQU   RSVFLAGS
RSVEXTS  EQU   RSVOLWA+139
RSVF1TTN EQU   RSVF1EXT
RSVF1CTS EQU   RSVOLWA+67
RSVF1PAD EQU   RSVF1TS+14
RSVF1TS2 EQU   RSVF1TS+7
RSVF1TS1 EQU   RSVF1TS
RSVSVTTR EQU   RSVOLWA+48
RSVSCRNM EQU   RSVOLWA+4
RSVSCRPT EQU   RSVOLWA
RSGENDT  EQU   RSGENDTE+1
@NM00082 EQU   RSGENDTE
RSGENTME EQU   RSGENWRK+4
RSGENTPT EQU   RSGENWRK
RSCRGRBP EQU   RSCRWA+4
RSCRENTP EQU   RSCRWA
@NM00081 EQU   RSADUL+10
RSADSTP  EQU   RSADUL+10
RSADFLGS EQU   RSADUL+9
RSADULNM EQU   RSADUL+1
RSADULC  EQU   RSADUL
RSADVLSR EQU   RSADVL+1
RSADVLC  EQU   RSADVL
RSADDDNP EQU   RSADWA+28
RSADULP  EQU   RSADWA+24
RSADVLP  EQU   RSADWA+20
RSADENP  EQU   RSADWA+16
RSADVSRP EQU   RSADWA+12
RSADGRBP EQU   RSADWA+8
RSADDDN  EQU   RSADWA
RSWFAMDP EQU   RSWFWA+48
RSWFLR   EQU   RSWFWA+44
RSWFDFAR EQU   RSWFWA+40
RSWFFPLP EQU   RSWFWA+12
RSWFFVTP EQU   RSWFWA+4
RSWFSVCP EQU   RSWFWA
@NM00080 EQU   RSRWORK+65
RSRSKPSW EQU   RSRFLGS
RSRXSW   EQU   RSRFLGS
RSRXTRY  EQU   RSRFLGS
RSROKSW  EQU   RSRFLGS
RSRX     EQU   RSRWORK+63
RSRIXNO  EQU   RSRWORK+62
RSRU     EQU   RSRWORK+61
RSRI     EQU   RSRWORK+60
RSRLG    EQU   RSRWORK+59
RSRLU    EQU   RSRWORK+58
RSRSVFLG EQU   RSRWORK+48
RSMSGCI  EQU   RSRWORK+45
RSMSGRC  EQU   RSRWORK+42
RSRRLN   EQU   RSRWORK+40
RSRRCPY  EQU   RSRWORK+38
RSRWFRN  EQU   RSRWORK+36
RSRCATRN EQU   RSRWORK+34
RSRCRARN EQU   RSRWORK+32
RSRXLFND EQU   RSRWORK+28
RSRXLSV  EQU   RSRWORK+24
RSRRPL   EQU   RSRWORK+20
RSRSVARG EQU   RSRWORK+16
RSRFAD   EQU   RSRWORK+12
RSRDAD   EQU   RSRWORK+8
RSRRC    EQU   RSRWORK+4
RSRGRBPT EQU   RSRWORK
RSRNULNM EQU   RSRNUL+1
RSRNULC  EQU   RSRNUL
RSRNVLSR EQU   RSRNVL+1
RSRNVLC  EQU   RSRNVL
RSRNDDNM EQU   RSRNWA+91
RSRNOLDN EQU   RSRNWA+47
RSRNNOF1 EQU   RSRNFLGS
RSRNVDUP EQU   RSRNFLGS
RSRNSTP  EQU   RSRNFLGS
RSRNFAIL EQU   RSRNFLGS
RSRNRCRS EQU   RSRNFLGS
RSRNEVC  EQU   RSRNWA+44
RSRNEVP  EQU   RSRNWA+40
RSRNULP  EQU   RSRNWA+36
RSRNVLP  EQU   RSRNWA+32
RSRNVSPT EQU   RSRNWA+28
RSRNDDPT EQU   RSRNWA+24
RSRNVLPT EQU   RSRNWA+20
RSRNGRBP EQU   RSRNWA+16
RSRNPVLS EQU   RSRNPLST+12
RSRNPNDS EQU   RSRNPLST+8
RSRNPODS EQU   RSRNPLST+4
RSRNPFLG EQU   RSRNPLST
RSSVENT  EQU   RSINWA+55
RSINALL  EQU   RSINFLGS
@NM00079 EQU   RSINATR1
RSINRCV  EQU   RSINATR1
@NM00078 EQU   RSINATR1
RSINTS   EQU   RSINWA+45
RSINVLSR EQU   RSINWA+39
RSINSVVL EQU   RSINWA+33
RSINDVLV EQU   RSINDVL+1
RSINDVLL EQU   RSINDVL
RSINDDPT EQU   RSINWA+20
RSINDNPT EQU   RSINWA+16
RSINDVPT EQU   RSINWA+12
RSINCVPT EQU   RSINWA+8
RSINWACB EQU   RSINWA+4
RSINUAP  EQU   RSINWA
RSCISVLK EQU   RSCIWA+44
RSCIEXT  EQU   RSCIWA+24
RSCIDFCI EQU   RSCIWA+20
RSCIRMEN EQU   RSCIWA+16
RSCILCI  EQU   RSCIWA+12
RSCINXCI EQU   RSCIWA+8
RSCIEXCU EQU   RSCIWA+4
@NM00077 EQU   RSCKFLAG
RSCKTSW  EQU   RSCKFLAG
RSCKIDX3 EQU   RSCKERRW+48
RSCKIDX2 EQU   RSCKERRW+46
RSCKIDX1 EQU   RSCKERRW+44
RSCATRC  EQU   RSCKERRW+42
RSOURCC  EQU   RSCKERRW+40
RSCKMDTB EQU   RSCKTIME+20
RSCKMDY  EQU   RSCKTIME+14
RSCKHMS  EQU   RSCKTIME+8
RSCKPDAY EQU   RSCKTIME+4
RSCKDAYS EQU   RSCKTIME
RSCKTPTR EQU   RSCKERRW+4
RSCKERNO EQU   RSCKERR+2
@NM00076 EQU   RSREASW
REASSW2  EQU   RSREASW
REASSW1  EQU   RSREASW
@NM00075 EQU   @NM00074+3
RSVIAGRB EQU   @NM00074
@NM00073 EQU   RSVIAFLG
RSVIARRN EQU   RSVIAFLG
RSVIAUPD EQU   RSVIAFLG
RSVIAIS  EQU   RSVIAFLG
RSVIAFND EQU   RSVIAFLG
RSVIADUP EQU   RSVIAFLG
@NM00071 EQU   RSGETVIA+8
RSVIAIDX EQU   RSGETVIA+6
@NM00070 EQU   RSVIACRA+4
RSVIADSC EQU   RSVIACRA
@NM00069 EQU   @NM00067+3
RSEOVERR EQU   @NM00067+2
@NM00068 EQU   RSEOVFLG
RSEOVPHY EQU   RSEOVFLG
RSEOVLOG EQU   RSEOVFLG
RSEOVEND EQU   RSEOVFLG
RSEOVFND EQU   RSEOVFLG
RSEOVXIO EQU   @NM00067
RSCATARG EQU   @NM00065+1
@NM00066 EQU   @NM00065
RSCATRPL EQU   RSEOVWA+4
RSEOVRAB EQU   RSEOVWA
RSPVFLG3 EQU   @NM00062+3
@NM00064 EQU   RSPVFLG2
RSBDVOLS EQU   RSPVFLG2
RSRETSPC EQU   RSPVFLG2
RSSETERR EQU   RSPVFLG2
RSSERROR EQU   RSPVFLG2
RSPERROR EQU   RSPVFLG2
RSVLCATE EQU   RSPVFLG2
RSMUNUS  EQU   RSPVFLG2
RSCK1TO1 EQU   RSPVFLG1
RSCKBERR EQU   RSPVFLG1
RSPVRSC  EQU   RSPVFLG1
RSPVRPC  EQU   RSPVFLG1
RSPVNRP  EQU   RSPVFLG1
RSPVDELT EQU   RSPVFLG1
RSPVRVOL EQU   RSPVFLG1
RSCHKCON EQU   RSPVFLG1
@NM00063 EQU   RSPVSETB
RSST1TO1 EQU   RSPVSETB
RSPVCLBM EQU   RSPVSETB
RSSETMAP EQU   RSPVSETB
RSSETCRA EQU   RSPVSETB
@NM00061 EQU   RSPVTTNN+15
RSMASK   EQU   RSPVTTNN+14
RSPVKNEX EQU   RSPVTTNN+12
RSPVNN   EQU   RSPVTTNN+10
RSBITPOS EQU   RSPVTTNN+8
RSPVTNEX EQU   RSPVTTNN+6
RSPVNEXT EQU   RSPVTTNN+4
RSSETTT  EQU   RSPVTTNN
RSPVSNT8 EQU   RSPVSNT+16
RSPVSNT6 EQU   RSPVSNT+12
RSPVSNT5 EQU   RSPVSNT+8
RSPVSNT3 EQU   RSPVSNT+4
RSPVSNTC EQU   RSPVSNT
TMPSZ    EQU   RSPROCVL+44
RSMAPSIZ EQU   RSPROCVL+40
RSFROMAP EQU   RSMAPAD+16
RSTOMAP  EQU   RSMAPAD+12
RSSTBMAP EQU   RSMAPAD+8
RSCKBMAP EQU   RSMAPAD+4
RSTGBMAP EQU   RSMAPAD
RSSCBMAP EQU   RSMAPS+16
RSCRBMAP EQU   RSPCBMAP
RSCABMAP EQU   RSSBMAP
RSPBMAP  EQU   RSMAPS+4
RSWKBMAP EQU   RSMAPS
RSGDGLL  EQU   RSGDG+4
@NM00060 EQU   RSASSFLG+1
@NM00059 EQU   RSASSFL1
RSRCHK   EQU   RSROPT
RSREND   EQU   RSROPT
RSRCRA   EQU   RSRDS
RSRCAT   EQU   RSRDS
RSRINIT  EQU   RSRTYPE
RSRDEL   EQU   RSRTYPE
RSRPOS   EQU   RSRTYPE
RSRADD   EQU   RSRTYPE
@NM00058 EQU   RSFLAGI2+1
RSUCDTN  EQU   RSFLAGI2+1
RSUCATN  EQU   RSFLAGI2+1
RSHAVECR EQU   RSFLAGI2+1
RSFDELET EQU   RSFLAGI2+1
RSOPDYN  EQU   RSFLAGI2+1
RSUCCCR  EQU   RSFLAGI2
RSUCTWWF EQU   RSFLAGI2
RSUCWFTN EQU   RSFLAGI2
RSUCCATN EQU   RSFLAGI2
RSMEBYV  EQU   RSFLAGI2
RSMEOP   EQU   RSFLAGI2
RSMETRM  EQU   RSFLAGI2
RSCCVFND EQU   RSFLAGI2
@NM00057 EQU   RSFLAGI1
RSDUPNRR EQU   RSFLAGI1
RSRENRR  EQU   RSFLAGI1
RSREARR  EQU   RSFLAGI1
RSCREXC  EQU   RSFLAGN2
RSCREOV  EQU   RSFLAGN2
RSTERM   EQU   RSFLAGN2
RSALLC   EQU   RSFLAGN2
RSCRAUA  EQU   RSFLAGN2
RSWFCREA EQU   RSFLAGN2
RSCAEOV  EQU   RSFLAGN2
RSENUFCI EQU   RSFLAGN2
RSIGNR   EQU   RSFLAGN1
RSCARES  EQU   RSFLAGN1
RSREASND EQU   RSFLAGN1
RSVTOPN  EQU   RSFLAGN1
RSCAOPN  EQU   RSFLAGN1
RSCROPN  EQU   RSFLAGN1
RSWFOPN  EQU   RSFLAGN1
RSWFDEF  EQU   RSFLAGN1
RSNCTS   EQU   RSNEWCAT+10
RSNCDEVT EQU   RSNEWCAT+6
RSNCVLSR EQU   RSNEWCAT
RSWFPS   EQU   RSWORK+957
RSWCATPS EQU   RSWORK+949
RSWCATNM EQU   RSWORK+905
RSDFVLSR EQU   RSWORK+875
RSDFVLCT EQU   RSWORK+874
RSWFDSN  EQU   RSWORK+830
RSWFDDNM EQU   RSWORK+822
RSMRPS   EQU   RSWORK+814
RSCATVLS EQU   RSWORK+808
RSCATNCI EQU   RSWORK+805
RSCATTN  EQU   RSWORK+761
RSCATPS  EQU   RSWORK+753
RSCATDSN EQU   RSWORK+709
RSCATDDN EQU   RSWORK+701
RSUCCINO EQU   RSWORK+697
RSNOBLKT EQU   RSWORK+694
RSIDX3   EQU   RSWORK+692
RSIDX2   EQU   RSWORK+690
RSIDX1   EQU   RSWORK+688
RSCAFUCN EQU   RSWORK+684
RSORSTAT EQU   RSORVLLS+12
RSORNVOL EQU   RSORVLLS+6
RSORNDEV EQU   RSORVLLS+2
RSORVLCT EQU   RSORVLLS
RSCRAVLN EQU   RSWORK+664
RSCHCRAN EQU   RSWORK+660
RSF1RNAM EQU   RSWORK+652
RSCIREMC EQU   RSWORK+648
RSCATSCN EQU   RSWORK+644
RSSUBSSZ EQU   RSWORK+640
RSSUBSTP EQU   RSWORK+636
RSSUBENP EQU   RSWORK+632
RSSUBGRP EQU   RSWORK+628
RSSUBRC  EQU   RSWORK+624
RSPROCRC EQU   RSWORK+620
RSUGLEN  EQU   RSWORK+616
RSCRADD  EQU   RSWORK+608
RSCIXLTB EQU   RSWORK+604
RSCATUCB EQU   RSWORK+596
RSCATACB EQU   RSWORK+592
RSCAPAS  EQU   RSWORK+588
CTGFVPTR EQU   RSWORK+584
RSUCNXT  EQU   RSWORK+564
RSTNNXT  EQU   RSWORK+560
RSDUPNXT EQU   RSWORK+556
RSRENEXT EQU   RSWORK+552
RSECPA   EQU   RSWORK+548
RSECBF1  EQU   RSWORK+544
RSWFIOCS EQU   RSWORK+540
RSVTIOCS EQU   RSWORK+536
RSWFDS   EQU   RSWORK+528
RSWFPAS  EQU   RSWORK+524
RSWFDD   EQU   RSWORK+520
RSWCPAS  EQU   RSWORK+516
RSWCDS   EQU   RSWORK+512
RSMRPAS  EQU   RSWORK+508
RSGDT    EQU   RSWORK+504
RSXRREND EQU   RSWORK+500
RSXCIEND EQU   RSWORK+496
RSENTNXT EQU   RSWORK+492
RSENTFBK EQU   RSWORK+488
RSENTST  EQU   RSWORK+480
RSTNCHN  EQU   RSWORK+476
RSREASS  EQU   RSWORK+472
RSREASSN EQU   RSWORK+468
RSVOLLUS EQU   RSWORK+464
RSVOLLST EQU   RSWORK+460
RSRESLUS EQU   RSWORK+456
RSVOLALL EQU   RSWORK+452
RSWFHURR EQU   RSWORK+448
RSWFNEXT EQU   RSWORK+444
RSWFSCND EQU   RSWORK+424
RSWFPRIM EQU   RSWORK+420
RSFPL    EQU   RSWORK+392
RSFDT    EQU   RSWORK+388
RSCURRN  EQU   RSWORK+384
RSCURCI  EQU   RSWORK+380
RSCREND  EQU   RSWORK+376
RSCANFCN EQU   RSWORK+368
RSCMRR   EQU   RSWORK+364
RSCACDE  EQU   RSWORK+360
RSAVNEXT EQU   RSWORK+356
RSAVAILN EQU   RSWORK+352
RS07RG12 EQU   RS07REGS+16
RS07RG11 EQU   RS07REGS+12
RS07RG10 EQU   RS07REGS+8
RS07RG09 EQU   RS07REGS+4
RS07RG08 EQU   RS07REGS
RS06RG12 EQU   RS06REGS+16
RS06RG11 EQU   RS06REGS+12
RS06RG10 EQU   RS06REGS+8
RS06RG09 EQU   RS06REGS+4
RS06RG08 EQU   RS06REGS
RS05RG12 EQU   RS05REGS+16
RS05RG11 EQU   RS05REGS+12
RS05RG10 EQU   RS05REGS+8
RS05RG09 EQU   RS05REGS+4
RS05RG08 EQU   RS05REGS
RS04RG12 EQU   RS04REGS+16
RS04RG11 EQU   RS04REGS+12
RS04RG10 EQU   RS04REGS+8
RS04RG09 EQU   RS04REGS+4
RS04RG08 EQU   RS04REGS
RS03RG12 EQU   RS03REGS+16
RS03RG11 EQU   RS03REGS+12
RS03RG10 EQU   RS03REGS+8
RS03RG09 EQU   RS03REGS+4
RS03RG08 EQU   RS03REGS
RS02RG12 EQU   RS02REGS+16
RS02RG11 EQU   RS02REGS+12
RS02RG10 EQU   RS02REGS+8
RS01RG12 EQU   RS01REGS+16
RS01RG11 EQU   RS01REGS+12
RS01RG10 EQU   RS01REGS+8
RS01RG09 EQU   RS01REGS+4
RS01RG08 EQU   RS01REGS
@NM00056 EQU   @NM00055
@NM00054 EQU   @NM00053
@NM00052 EQU   RSPSTACK+20
@NM00051 EQU   RSPSTACK+18
@NM00050 EQU   RSPSTACK+16
RSPTWKL  EQU   RSPSTACK+4
@NM00049 EQU   @NM00048
@NM00047 EQU   RSGDITS+16
RSGDITL  EQU   RSGDITS+4
RSGDITF  EQU   RSGDITS
@NM00046 EQU   @NM00045
@NM00044 EQU   RSGCITS+16
RSGCITL  EQU   RSGCITS+4
RSGCITF  EQU   RSGCITS
RSCRIOCS EQU   RSWORK+100
RSCPE8   EQU   RSWORK+96
RSCPE4   EQU   RSWORK+80
RSCANFCI EQU   RSWORK+44
RSCAIOCS EQU   RSWORK+40
RSCAHALC EQU   RSWORK+36
RSCAHACI EQU   RSWORK+32
RSCADS   EQU   RSWORK+24
RSCADD   EQU   RSWORK+20
RSAVAIL  EQU   RSWORK+8
RSALLAGP EQU   RSWORK+4
RSA      EQU   RSWORK
RSF1RNNM EQU   RSF1RNTB+14
RSF1RNDV EQU   RSF1RNTB+10
RSF1RNVL EQU   RSF1RNTB+4
RSF1RNNX EQU   RSF1RNTB
RESVLEXT EQU   RESVOL+28
RESVLDDN EQU   RESVOL+20
@NM00043 EQU   RESVOL+12
RESVLNEX EQU   RESVOL+10
@NM00042 EQU   RESVLFLG
RESVLLAS EQU   RESVLFLG
RESVLALE EQU   RESVLFLG
RESVLMNT EQU   RESVLFLG
RESVLUPD EQU   RESVOL+4
RESVLNXT EQU   RESVOL
VOLSRTS  EQU   VOLSERTB+20
VOLSRNTK EQU   VOLSERTB+12
VOLSRLAS EQU   VOLSRFLG
VOLSRNXT EQU   VOLSERTB
CATIHRBA EQU   CATIEXT+16
CATILRBA EQU   CATIEXT+12
@NM00041 EQU   CATIEXT
@NM00039 EQU   IOCRCV
IOCRCVRA EQU   IOCRCV
IOCRCVXM EQU   IOCRCV
IOCVLN   EQU   IOCSEX+42
IOCDNM   EQU   IOCSEX+40
IOCDDN   EQU   IOCDLM
IOCMODEX EQU   IOCMOD
IOCMODRP EQU   IOCMOD
IOCMODXM EQU   IOCMOD
IOCMODUB EQU   IOCMOD
IOCMODRG EQU   IOCMOD
IOCMODDY EQU   IOCMOD
IOCMODRR EQU   IOCMOD
IOCMODPD EQU   IOCMOD
IOCINFR1 EQU   IOCINF
IOCINFCT EQU   IOCINF
IOCINFDO EQU   IOCINF
IOCINFAC EQU   IOCINF
IOCINFQX EQU   IOCINF
IOCINFND EQU   IOCINF
IOCINFAE EQU   IOCINF
IOCINFPT EQU   IOCINF
@NM00038 EQU   IOCDEV
IOCDEVUR EQU   IOCDEV
IOCDEVMT EQU   IOCDEV
IOCDEVDA EQU   IOCDEV
@NM00037 EQU   IOCFLG
IOCFLGSP EQU   IOCFLG
IOCFLGOE EQU   IOCFLG
IOCFLGOP EQU   IOCFLG
IOCFLGIO EQU   IOCFLG
IOCFLGEF EQU   IOCFLG
IOCFLGDF EQU   IOCFLG
IOCFLGEX EQU   IOCFLG
IOCSID   EQU   IOCSEX+28
IOCNIO   EQU   IOCSEX+24
@NM00036 EQU   IOCXPM+2
IOCEXL   EQU   IOCXPM
IOCEXA   EQU   IOCXAD
IOCWKA   EQU   IOCSEX+12
IOCLRP   EQU   IOCSEX+10
IOCCBL   EQU   IOCSEX+8
IOCDEC   EQU   IOCRPL
IOCCBA   EQU   IOCSEX
@NM00035 EQU   IODATA+64
IODAEI   EQU   IODATA+60
@NM00034 EQU   IODATA+56
IODIOX   EQU   IODATA+52
IODOCS   EQU   IODATA+48
IODICS   EQU   IODATA+44
IODOSO   EQU   IODATA+40
IODOSS   EQU   IODATA+36
IODEOD   EQU   IODATA+32
@NM00033 EQU   IODATA+30
@NM00032 EQU   IODATA+28
IODOEV   EQU   IODATA+24
IODIEV   EQU   IODATA+20
IODINC   EQU   IODSID+2
IODMID   EQU   IODSID
IODXTN   EQU   IODATA+12
IODADD   EQU   IODATA+8
IODMSG   EQU   IODATA+4
IODIOC   EQU   IODATA
WFILEVAL EQU   WFILE+10
WFILELEN EQU   WFILE+9
WFILEPAS EQU   WFILE+1
WFILEPLN EQU   WFILE
CRADVVAL EQU   CRADV+1
CRADVLEN EQU   CRADV
CRAVLVAL EQU   CRAVL+1
CRAVLLEN EQU   CRAVL
CRADNVAL EQU   CRADN+1
CRADNLEN EQU   CRADN
WCATVAL  EQU   WCAT+21
WCATLEN  EQU   WCAT+20
WCATMEM  EQU   WCAT+12
WCATMLN  EQU   WCAT+11
WCATFUQ  EQU   WCATFLG
WCATPOS  EQU   WCAT+9
WCATPAS  EQU   WCAT+1
WCATPLN  EQU   WCAT
MRPWVAL  EQU   MRPW+1
MRPWLEN  EQU   MRPW
CATDNVAL EQU   CATDN+1
CATDNLEN EQU   CATDN
CATNMVAL EQU   CATNM+21
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
CATNMPAS EQU   CATNM+1
CATNMPLN EQU   CATNM
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00459 EQU   @RC00399
@RC00543 EQU   @RC00540
@RC00541 EQU   @RC00540
@RC00561 EQU   @RC00560
@RF00683 EQU   @RC00677
@RC00784 EQU   @RC00768
@RC00773 EQU   @RC00768
@RF00772 EQU   @RC00768
@RT01024 EQU   @RC00946
@RF01060 EQU   @RC00932
@RF01255 EQU   @RC01195
@RF01824 EQU   @RC01821
@RC01978 EQU   @RC01977
@PB00017 EQU   @EL00001
@ENDDATA EQU   *
         END   IDCRS02,(C'PLS2315',0701,77115)
